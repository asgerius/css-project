[{"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1455753521, "post_id": 35470063, "comment_id": 58635898, "body": "re: <i>&#39;... this causes every simulation to run simultaneously ...&#39;</i> - I&#39;d like to see that please."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455754021, "post_id": 35470063, "comment_id": 58636036, "body": "Seconded -  please show your actual code.  Does the executable quit when it&#39;s done processing the file?  If Yes you could use WMI to count how many instances are running and launch a new one when the count drops below your threshold.  Do that in a loop using <code>OnTime</code>  <a href=\"http://www.codeproject.com/Tips/478621/VBScript-Count-Instances-of-a-Process\" rel=\"nofollow noreferrer\">codeproject.com/Tips/478621/&hellip;</a>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1455757031, "post_id": 35470063, "comment_id": 58636973, "body": "Look at creating a batch file and shelling that out.  In the batch file <code>call</code> the exe. As in <code>Call c:\\temp\\some.exe File1AsArgument</code> the next line <code>Call c:\\temp\\some.exe File2AsArgument</code>  The <code>call</code> instruction will cause the command line to wait for the current process to finish before the next call is sent."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1455808853, "post_id": 35470063, "comment_id": 58664159, "body": "@MatthewD I wanted to eliminate the need to include multiple files in a subfolder to run a simulation (this will be used by others, so I want it to be a simple set up). Do you mean having another exe file alongside the rest to run each?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1455809058, "post_id": 35470063, "comment_id": 58664313, "body": "No. I mean write all the files you want to process to a batch file. One file per line.  Then shell out the .bat file. That will execute them one at a time."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1455809314, "post_id": 35470063, "comment_id": 58664527, "body": "@MatthewD OK so something like call [exe] [txt1], call [exe] [txt2] etc.? In that case, how would I set it to run maybe say 5 at a time?"}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455809415, "post_id": 35470063, "comment_id": 58664608, "body": "@TimWilliams are the <code>Set objWMIService</code> and <code>Set colProcess</code> both usable as is? Also, if I&#39;m using 64-bit, is it (&quot;Select * from x64_Process&quot;) or something? Or still 32 bit for this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455810664, "post_id": 35470063, "comment_id": 58665596, "body": "Most of the VBscript WMI examples will translate directly to VBA.  I don&#39;t know the answer to your 64-bit question.  64 bit OS, Excel, and/or exe ?  I would just try it out and see what you get."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455815079, "post_id": 35470063, "comment_id": 58668985, "body": "@TimWilliams when I run it, I get &quot;Run-time error &#39;424&#39;: Object required&quot; because of <code>WScript.Echo &quot;There are currently &quot; &amp; &quot;(&quot; &amp; instances &amp; &quot;) &quot; &amp; &quot;&quot;&quot;&quot; &amp; processName &amp; &quot;&quot;&quot;&quot; &amp; &quot; Instances running!&quot;</code>. Is this because I am using VBA rather than VB? How can I correct this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455815157, "post_id": 35470063, "comment_id": 58669036, "body": "Since you&#39;re using VBA you can use <code>Msgbox</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455837431, "post_id": 35487625, "comment_id": 58681343, "body": "Thanks, this is awesome. I like the simplicity of the Do While loop here. I wonder, does it require more CPU just to leave the loop as <code>Do While ProcCount(&quot;myproc.exe&quot;) &gt;= 5 Loop</code> rather than having a .Wait in there? It seems to me that .Wait requires the CPU to check the time constantly anyway, or am I wrong?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455896355, "post_id": 35487625, "comment_id": 58709128, "body": "@teepee I do read sleep does not require CPU cycles while Wait does. But have not verified that. <code>Private Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)</code> &#39;following in your code in place of the Wait command: <code>Sleep 5*1000*60</code>  &#39;Sleep uses milliseconds so to convert into 5 minutes..."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455896693, "post_id": 35487625, "comment_id": 58709376, "body": "And there is seems to be some difference for 32 vs 64 bit systems but I haven&#39;t verified that either.  <code>#If VBA7 Then       Public Declare PtrSafe Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As LongPtr) &#39;For 64 Bit Systems   #Else       Public Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds as Long) &#39;For 32 Bit Systems   #End If</code>"}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455898931, "post_id": 35487625, "comment_id": 58710909, "body": "Thanks, that&#39;s good to know. I did do a couple tests, and found if I use .wait within the loop, Excel&#39;s CPU usage jumps up to 25 during most of the process. If I leave the loop blank, essentially just allowing it to repeatedly check the number of simulations running, then its CPU usage remains 0. I wonder if sleep would help things even more, I&#39;ll try."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1455827576, "last_edit_date": 1455827576, "creation_date": 1455814384, "answer_id": 35487625, "question_id": 35470063, "link": "https://stackoverflow.com/questions/35470063/limiting-number-of-instances-of-executables-called-by-a-for-loop/35487625#35487625", "title": "Limiting number of instances of executables called by a for loop", "body": "<p>Could the answer be as simple as waiting a certain amount of time in your loop. That could control the number of processes to some degree.  This will kick one off, wait five minutes, kick off the next, wait five minutes, kick off the next etc..</p>\n\n<pre><code>Function RunSimulations() As Boolean\n    For k = 0 To myListBox.ListCount - 1\n        If myListBox.Selected(k) = True Then\n            SimulateOne(myListBox.List(k))\n            Application.Wait (Now + TimeValue(\"0:05:00\"))\n        End If\n    Next k\nEnd Function\n</code></pre>\n\n<p>If that isn't good enough I have some VBA functions that can be used.</p>\n\n<pre><code>'API Calls - place these at the top of your code with your globals\nPrivate Declare Function OpenProcess Lib \"kernel32\" ( _\n    ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long\nPrivate Declare Function CloseHandle Lib \"kernel32\" ( _\n    ByVal hObject As Long) As Long\nPrivate Declare Function EnumProcesses Lib \"PSAPI.DLL\" ( _\n    lpidProcess As Long, ByVal cb As Long, cbNeeded As Long) As Long\nPrivate Declare Function EnumProcessModules Lib \"PSAPI.DLL\" ( _\n    ByVal hProcess As Long, lphModule As Long, ByVal cb As Long, lpcbNeeded As Long) As Long\nPrivate Declare Function GetModuleBaseName Lib \"PSAPI.DLL\" Alias \"GetModuleBaseNameA\" ( _\n    ByVal hProcess As Long, ByVal hModule As Long, ByVal lpFileName As String, ByVal nSize As Long) As Long\nPrivate Const PROCESS_VM_READ = &amp;H10\nPrivate Const PROCESS_QUERY_INFORMATION = &amp;H400\n</code></pre>\n\n<p>Just feed the proc name b = IsProcessRunning(\"ProcName.exe\")</p>\n\n<pre><code>Private Function IsProcessRunning(ByVal sProcess As String) As Boolean\n'Check to see if a process is currently running\nConst MAX_PATH      As Long = 260\nDim lProcesses()    As Long\nDim lModules()      As Long\nDim N               As Long\nDim lRet            As Long\nDim hProcess        As Long\nDim sName           As String\n\nsProcess = UCase$(sProcess)\nReDim lProcesses(1023) As Long\n\nIf EnumProcesses(lProcesses(0), 1024 * 4, lRet) Then\n    For N = 0 To (lRet \\ 4) - 1\n        hProcess = OpenProcess(PROCESS_QUERY_INFORMATION Or PROCESS_VM_READ, 0, lProcesses(N))\n        If hProcess Then\n            ReDim lModules(1023)\n            If EnumProcessModules(hProcess, lModules(0), 1024 * 4, lRet) Then\n                sName = String$(MAX_PATH, vbNullChar)\n                GetModuleBaseName hProcess, lModules(0), sName, MAX_PATH\n                sName = Left$(sName, InStr(sName, vbNullChar) - 1)\n                If sProcess = UCase$(sName) Then\n                    IsProcessRunning = True\n                    Exit Function\n                End If\n            End If\n        End If\n        CloseHandle hProcess\n    Next N\nEnd If\nEnd Function\n</code></pre>\n\n<p>You probably want this one. It will return the number of time it finds the process. If it is more than you want running. Don't kick off another.</p>\n\n<pre><code>Private Function ProcessRunningCount(ByVal sProcess As String) As Long\n'Check to see if how many occurences of a process are currently running\nConst MAX_PATH      As Long = 260\nDim lProcesses()    As Long\nDim lModules()      As Long\nDim N               As Long\nDim lRet            As Long\nDim hProcess        As Long\nDim sName           As String\nDim lCount          As Long\n\n    sProcess = UCase$(sProcess)\n    ReDim lProcesses(1023) As Long\n    lCount = 0\n\n    If EnumProcesses(lProcesses(0), 1024 * 4, lRet) Then\n        For N = 0 To (lRet \\ 4) - 1\n            hProcess = OpenProcess(PROCESS_QUERY_INFORMATION Or PROCESS_VM_READ, 0, lProcesses(N))\n            If hProcess Then\n                ReDim lModules(1023)\n                If EnumProcessModules(hProcess, lModules(0), 1024 * 4, lRet) Then\n                    sName = String$(MAX_PATH, vbNullChar)\n                    GetModuleBaseName hProcess, lModules(0), sName, MAX_PATH\n                    sName = Left$(sName, InStr(sName, vbNullChar) - 1)\n                    If sProcess = UCase$(sName) Then\n                        lCount = lCount + 1\n                    End If\n                End If\n            End If\n            CloseHandle hProcess\n        Next N\n    End If\n    ProcessRunningCount = lCount\n\nEnd Function\n</code></pre>\n\n<p>Something like this</p>\n\n<pre><code>Function RunSimulations() As Boolean\n    For k = 0 To myListBox.ListCount - 1\n\n        Do While ProcessRunningCount(\"chrome.exe\") &gt;= 5 'Enter you proc name here\n            Application.Wait (Now + TimeValue(\"0:00:10\"))\n        Loop\n\n        If myListBox.Selected(k) = True Then\n            SimulateOne(myListBox.List(k))\n        End If\n    Next k\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455831737, "post_id": 35488068, "comment_id": 58678588, "body": "this function worked great for counting processes, thanks! Now I&#39;m finding using Application.Wait(&quot;00:00:10&quot;) is causing it to pause forever, because I think it&#39;s looping through them all at once and pausing the application for a long time, is that possible?"}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455836590, "post_id": 35488068, "comment_id": 58681014, "body": "That looks really great. I did not know you could call a function from within itself. Meanwhile I had got things working using a function that loops while monitoring the number of processes running (see edit to my question). Although I imagine my method costs more in processing power, or maybe not? What is the difference in efficiency?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1455837591, "post_id": 35488068, "comment_id": 58681402, "body": "I think Wait uses the processor more than OnTime: I don&#39;t know if that would make a significant difference though."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1455835439, "last_edit_date": 1455835439, "creation_date": 1455815565, "answer_id": 35488068, "question_id": 35470063, "link": "https://stackoverflow.com/questions/35470063/limiting-number-of-instances-of-executables-called-by-a-for-loop/35488068#35488068", "title": "Limiting number of instances of executables called by a for loop", "body": "<p><strong>EDIT</strong>:  OK here is a tested implementation of the sort of thing you want to do.  I'm using a simple vbscript to simulate your exe (so I'm monitoring \"wscript.exe\")</p>\n\n<pre><code>Dim colFiles As Collection 'has items to be processed\n\n'sets up the items to be processed and kicks off the runs\nSub InitSimulations()\n    Dim x As Long, arr(1 To 20) As String\n    Set colFiles = New Collection\n    For x = 1 To 20\n        colFiles.Add \"File_\" &amp; x\n    Next x\n    RunSimulations\nEnd Sub\n\n'Initially called by InitSimulations, then calls itself periodically \n'    to check whether a new run needs to be started\nSub RunSimulations()\n    Const MAX_PROCESSES As Long = 5\n    Dim sFile As String\n\n    'below our threshold?\n    If HowMany(\"wscript.exe\") &lt; MAX_PROCESSES Then\n        'any left to process?\n        If colFiles.Count &gt; 0 Then\n            sFile = colFiles(1)\n            colFiles.Remove 1\n            SimulateOne sFile\n            Debug.Print Now, \"Kicked off \" &amp; sFile\n        End If\n    End If\n\n    'Calls itself again in one second if any still remaining to process\n    '  if your processes are long-running then can adjust for longer delay\n    If colFiles.Count &gt; 0 Then\n        Application.OnTime Now + TimeSerial(0, 0, 1), \"RunSimulations\", , True\n    End If\n\nEnd Sub\n\n'Launch a simulation process\nSub SimulateOne(FileName)\n    Shell \"wscript.exe \"\"C:\\_Stuff\\Test.vbs\"\"\"\n    'not doing anything with FileName...\n    'test vbs has one line:  WScript.Sleep 10000\nEnd Sub\n\n'Count how many \"procName\" processes are running\nFunction HowMany(procName As String) As Long\n    Dim objWMIService, colProcess, processName\n    Set objWMIService = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\")\n    Set colProcess = objWMIService.ExecQuery _\n    (\"Select * from Win32_Process where Name = '\" &amp; procName &amp; \"'\")\n    HowMany = colProcess.Count\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 35488068, "answer_count": 2, "score": 0, "last_activity_date": 1455836778, "creation_date": 1455752822, "last_edit_date": 1455836778, "question_id": 35470063, "link": "https://stackoverflow.com/questions/35470063/limiting-number-of-instances-of-executables-called-by-a-for-loop", "title": "Limiting number of instances of executables called by a for loop", "body": "<p>I have a program that exports text files which which are then used by an executable to run simulations which take generally 5 to 10 minutes each.</p>\n\n<p>I have created a for loop which runs this process <code>For Each</code> text file. I originally wrote code for a separate executable, which the VBA macro would call, and this would run each simulation in series. I wanted to be able to run more in parallel, so I transferred the macro directly to VBA, but this causes every simulation to run simultaneously and brings the processor to a crawl.</p>\n\n<p>Is there a way to allow for a limited number of simulations to run at one time?</p>\n\n<p>EDIT: Sorry, I wrote this using a phone, because my computer was bogged down with this exact problem at the time. Here is the code. I have a function for running one simulation which moves the required exe (same for every simulation) and input.txt file into its own subfolder, and a second function which runs the first function on a loop over listbox selections:</p>\n\n<pre><code>Function RunSimulations() As Boolean\n    For k = 0 To myListBox.ListCount - 1\n        If myListBox.Selected(k) = True Then\n               SimulateOne(myListBox.List(k))\n            End If\n        End If\n    Next k\nEnd Function\n\nFunction SimulateOne(inputFName As String) As Boolean\n    Dim currPath As String, inptPath As String, simsPath As String\n    Dim destPath As String, origFile As String, destFile As String\n\n    'Defines various folder paths\n    currPath = ThisWorkbook.Path &amp; \"\\\"\n    inptPath = currPath &amp; INPUT_FOLDERNAME &amp; \"\\\"\n    simsPath = currPath &amp; SIMS_FOLDERNAME &amp; \"\\\"\n        If Len(Dir(simsPath, vbDirectory)) = 0 Then MkDir simsPath\n    destPath = simsPath &amp; Replace(inputFName, \".txt\", \"\") &amp; \"\\\"\n        If Len(Dir(destPath, vbDirectory)) = 0 Then MkDir destPath\n\n    'Move input files from \"input_files\" to subfolders within \"simulations\"\n    origFile = inptPath &amp; inputFName\n    destFile = destPath &amp; INPUT_FILENAME  'Changes name to \"INPUT.TXT\"\n    If Len(Dir(destFile)) &lt;&gt; 0 Then SetAttr destFile, vbNormal: Kill destFile\n    If Len(Dir(origFile)) &lt;&gt; 0 Then\n        FileCopy origFile, destFile\n    Else\n        SimulateOne = False\n        Exit Function\n    End If\n\n    If Len(Dir(currPath &amp; EXE_FILENAME)) &lt;&gt; 0 Then\n        'Moves exe files to new subfolder within \"simulations\"\n        FileCopy currPath &amp; EXE_FILENAME, destPath &amp; EXE_FILENAME\n\n        'Run exe\n        ChDrive Left(destPath, 1)\n        ChDir destPath\n        Shell (destPath &amp; EXE_FILENAME)\n        SimulateOne = True\n    Else\n        SimulateOne = False\n        Exit Function\n    End If\n\nEnd Function\n</code></pre>\n\n<p>EDIT: Implemented this loop recently. Wondering about the efficiency (or lack thereof) of the loop that goes constantly until the processor count drops low enough.</p>\n\n<pre><code>For k = 0 To myListBox.ListCount - 1\n    Do While ProcessRunningCount(EXE_FILENAME) &gt;= processLimit\n        Application.Wait (Now + TimeValue(\"0:00:05\"))\n    Loop\n    If myListBox.Selected(k) = True Then  runResult = SimulateOne(myListBox.List(k))\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455750666, "post_id": 35469621, "comment_id": 58634799, "body": "Why not show your current code so we can make suggestions?"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455751552, "post_id": 35469621, "comment_id": 58635152, "body": "Or you could just format the cells to wrap the text"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1455773726, "creation_date": 1455773726, "answer_id": 35473631, "question_id": 35469621, "link": "https://stackoverflow.com/questions/35469621/if-content-in-a-cell-is-too-long-show-multiple-instead-of-letting-the-text-ov/35473631#35473631", "title": "If content in a cell is too long, show &quot;Multiple&quot; instead of letting the text overflow in Excel", "body": "<p>You can do this with conditional formatting AND keep the original underlying string as a raw value for other purposes.</p>\n\n<ol>\n<li>Select the cells with the formula and create a conditional formatting rule based on a formula.<br/>\u00a0<br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<code>=LEN(C2)-LEN(SUBSTITUTE(C2, \",\", \"\"))&gt;1</code><br/>\u00a0<br/></li>\n<li>Click Format and go to the <strong>Numbers</strong> tab. Choose <strong>Custom</strong> from the list down the left side and supply the following for the <strong>Type:</strong><br/>\u00a0<br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<code>;;;[color13]_((\\multipl\\e)</code><br/>\u00a0<br/>\u00a0\u00a0I've opted to also make the font dark blue (colorindex # 13) and indent from the left.</li>\n</ol>\n\n<p>Click <kbd>OK</kbd> to accept the formatting and then <kbd>OK</kbd> again to create the new rule.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/MF60b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MF60b.png\" alt=\"multiple_strings\"></a></p>\n\n<p>As you can see in the sample image above, the underlying raw value remains (shown in the formula bar) but <a href=\"https://support.office.com/en-us/article/Number-format-codes-5026BBD6-04BC-48CD-BF33-80F18B4EAE68\" rel=\"nofollow noreferrer\">(multiple)</a> is displayed.</p>\n\n<hr>\n\n<p><sub>More on custom number formatting codes at <a href=\"https://support.office.com/en-us/article/Number-format-codes-5026BBD6-04BC-48CD-BF33-80F18B4EAE68\" rel=\"nofollow noreferrer\">Number format codes</a></sub></p>\n"}], "owner": {"reputation": 37, "user_id": 5139612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad54abc2b4c28d5d10fa28118810180c?s=128&d=identicon&r=PG&f=1", "display_name": "krnactry", "link": "https://stackoverflow.com/users/5139612/krnactry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1455773726, "creation_date": 1455750600, "question_id": 35469621, "link": "https://stackoverflow.com/questions/35469621/if-content-in-a-cell-is-too-long-show-multiple-instead-of-letting-the-text-ov", "title": "If content in a cell is too long, show &quot;Multiple&quot; instead of letting the text overflow in Excel", "body": "<p>So, I have a custom function that concatenate different cells and put a comma between words.</p>\n\n<p>For example, say I have \"ABCD\" \"BC\" then, this function will\noutput ABCD, BC. Now the problem is that the text will overflow in a cell and overlap with the cell next to that. In order to solve this problem,</p>\n\n<p>I am thinking of just replacing the concatenated word with \"Multiple\" if more than 3 words are combined. Is there anyway to do this in a cell?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1455750830, "post_id": 35469504, "comment_id": 58634856, "body": "If you are going to use autofilter, that isn&#39;t the same as sorting. You only need to write <code>ActiveWorkbook.Worksheets(&quot;ReportData&quot;).AutoFilter</code> to reset any sorting. Based on your current code, just remove <code>.AutoFilter</code> from everywhere and fix a range to sort and you will be able to get it to run."}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": false, "score": 0, "last_activity_date": 1455751426, "creation_date": 1455751426, "answer_id": 35469779, "question_id": 35469504, "link": "https://stackoverflow.com/questions/35469504/runtime-error-91-when-sorting/35469779#35469779", "title": "Runtime Error 91 when sorting", "body": "<pre><code>startCell = Range(\"A1\").Address\nendCell = Range(\"E100000\").End(xlUp).Address\nActiveWorkbook.Worksheets(\"ReportData\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"ReportData\").Sort.SortFields.Add Key:=Range(\"E1\"), SortOn:=xlSortOnValues, Order:=xlDescending,  DataOption:=xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"ReportData\").Sort\n    .SetRange Range(startCell,endCell)\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>Obviously this is rough, you will need to make it your own, but it will allow you to sort the E column which is what your initial code looks like it was trying to do.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1455761119, "last_edit_date": 1455761119, "creation_date": 1455759090, "answer_id": 35471147, "question_id": 35469504, "link": "https://stackoverflow.com/questions/35469504/runtime-error-91-when-sorting/35471147#35471147", "title": "Runtime Error 91 when sorting", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow\">Range.Sort method</a> can be used for a quick one column sort and discards much of the verbose code produced when recording a worksheet sort operation. Without an active <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844.aspx\" rel=\"nofollow\">AutoFilter</a>, this is the better way to go.</p>\n\n<pre><code>Sub getAnalystsCount()\n    Dim el As Long, ws As Worksheet\n    Dim dict As Object\n    Dim varray As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    'don't know what is in column E but this might be helpful\n    'dict.comparemode = vbTextCompare  'non-case-sensitive\n\n    Set ws = ThisWorkbook.Worksheets(\"ReportData\")\n    With ws\n        'this is not necessary inside a With ... End With block\n        'Worksheets(\"ReportData\").Activate\n        With .Range(\"A1\").CurrentRegion\n            'this quick code line is all you need\n            .Cells.Sort Key1:=.Columns(5), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n            'resize to # of rows -1 \u00d7 1 column and shift 1 row down and over to column E\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 4)\n                'store the raw values\n                varray = .Value2\n            End With\n        End With\n    End With 'done with the ReportData worksheet\n\n    'Generate unique list and count\n    'I prefer to work with LBound and UBound\n    For el = LBound(varray, 1) To UBound(varray, 1)\n        If dict.Exists(varray(el, 1)) Then\n            dict.Item(varray(el, 1)) = dict.Item(varray(el, 1)) + 1\n        Else\n            dict.Add Key:=varray(el, 1), Item:=1\n        End If\n    Next el\n\n    Set ws = ThisWorkbook.Worksheets(\"Analysts\")\n    With ws\n        'this is not necessary inside a With ... End With block\n        'Worksheets(\"Analysts\").Activate\n\n        'might want to clear the destination cell contents first if there is something there\n        if application.counta(.Range(\"A3:B3\") = 2 then _\n            .Range(\"A3:B\" &amp; .Cells(Rows.Count, \"B\").End(xlUp).Row).ClearContents\n\n        'Paste report somewhere\n        .Range(\"A3\").Resize(dict.Count, 1).Value = _\n            WorksheetFunction.Transpose(dict.Keys)\n        .Range(\"B3\").Resize(dict.Count, 1).Value = _\n            WorksheetFunction.Transpose(dict.Items)\n    End With 'done with the Analysts worksheet\n\nEnd Sub\n</code></pre>\n\n<p>I prefer to work with the <a href=\"https://msdn.microsoft.com/en-us/library/t9a7w1ac(v=vs.90).aspx\" rel=\"nofollow\">LBound</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278658.aspx\" rel=\"nofollow\">UBound</a> functions to determine the scope of an array.</p>\n\n<p>When you are inside a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>, use the <code>.</code> to note the parent worksheet and discard the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681.aspx\" rel=\"nofollow\">Range .Activate</a> method and <code>ws</code> variable.</p>\n"}, {"comments": [{"owner": {"reputation": 231, "user_id": 3930696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f605470ee3219b3a0fb2693a62a2c4d?s=128&d=identicon&r=PG&f=1", "display_name": "user3930696", "link": "https://stackoverflow.com/users/3930696/user3930696"}, "edited": false, "score": 0, "creation_date": 1455806701, "post_id": 35474667, "comment_id": 58662541, "body": "The above code worked.Thank you all for your replies guys. i really appreciate all your help."}, {"owner": {"reputation": 474, "user_id": 4974853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb5e04f840c39e06ce7a16fc83de8e08?s=128&d=identicon&r=PG&f=1", "display_name": "nirmalraj17", "link": "https://stackoverflow.com/users/4974853/nirmalraj17"}, "reply_to_user": {"reputation": 231, "user_id": 3930696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f605470ee3219b3a0fb2693a62a2c4d?s=128&d=identicon&r=PG&f=1", "display_name": "user3930696", "link": "https://stackoverflow.com/users/3930696/user3930696"}, "edited": false, "score": 0, "creation_date": 1455807687, "post_id": 35474667, "comment_id": 58663298, "body": "Thanks @user3930696. Please accept and vote up the answer :)"}], "tags": [], "owner": {"reputation": 474, "user_id": 4974853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb5e04f840c39e06ce7a16fc83de8e08?s=128&d=identicon&r=PG&f=1", "display_name": "nirmalraj17", "link": "https://stackoverflow.com/users/4974853/nirmalraj17"}, "is_accepted": false, "score": 1, "last_activity_date": 1455778093, "creation_date": 1455778093, "answer_id": 35474667, "question_id": 35469504, "link": "https://stackoverflow.com/questions/35469504/runtime-error-91-when-sorting/35474667#35474667", "title": "Runtime Error 91 when sorting", "body": "<p>Replace your below code </p>\n\n<pre><code>Columns(\"E:E\").Select\n    ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort.SortFields.Add Key:= _\n        Range(\"E1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n\n<p>With the below code</p>\n\n<pre><code>Columns(\"E:E\").Select\nlastrow1 = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\nActiveWorkbook.Worksheets(\"ReportData\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"ReportData\").Sort.SortFields.Add Key:=Range(\"E1\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"ReportData\").Sort\n    .SetRange Range(\"E2:E\" &amp; lastrow1)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 3930696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f605470ee3219b3a0fb2693a62a2c4d?s=128&d=identicon&r=PG&f=1", "display_name": "user3930696", "link": "https://stackoverflow.com/users/3930696/user3930696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2733, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455921980, "creation_date": 1455750073, "last_edit_date": 1455921980, "question_id": 35469504, "link": "https://stackoverflow.com/questions/35469504/runtime-error-91-when-sorting", "title": "Runtime Error 91 when sorting", "body": "<p>I am writing a subroutine to dynamically copy 2 columns from one sheet to another. These column lengths might change from one report to another.</p>\n\n<p>Here is the code:</p>\n\n<hr>\n\n<pre><code>Sub getAnalystsCount()\n\n    Dim rng As Range\n    Dim dict As Object\n    Set dict = CreateObject(\"scripting.dictionary\")\n    Dim varray As Variant, element As Variant\n\n    Set ws = ThisWorkbook.Worksheets(\"ReportData\")\n\n    With ws\n        Worksheets(\"ReportData\").Activate\n\n    Columns(\"E:E\").Select\n    ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort.SortFields.Add Key:= _\n        Range(\"E1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    lastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n\n    '~~&gt; Set First row\n    firstrow = 2\n\n    '~~&gt; Set your range\n    Set rng = .Range(\"E\" &amp; firstrow &amp; \":E\" &amp; lastrow)\n\n    varray = rng.Value\n\n    'Generate unique list and count\n    For Each element In varray\n        If dict.Exists(element) Then\n            dict.Item(element) = dict.Item(element) + 1\n        Else\n            dict.Add element, 1\n        End If\n    Next\nEnd With\n\nSet ws = ThisWorkbook.Worksheets(\"Analysts\")\n\nWith ws\n    Worksheets(\"Analysts\").Activate\n\n    'Paste report somewhere\n    ws.Range(\"A3\").Resize(dict.Count, 1).Value = _\n        WorksheetFunction.Transpose(dict.Keys)\n    ws.Range(\"B3\").Resize(dict.Count, 1).Value = _\n        WorksheetFunction.Transpose(dict.Items)\n     ......\n</code></pre>\n\n<p>the error is in this line:</p>\n\n<pre><code>    ActiveWorkbook.Worksheets(\"ReportData\").AutoFilter.Sort.SortFields.Clear\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1455749626, "post_id": 35469265, "comment_id": 58634327, "body": "Help us to help you.....post more details"}, {"owner": {"reputation": 2939, "user_id": 4320738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47f691b009d906bf13e2e6c0fb1451?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/4320738/munir"}, "edited": false, "score": 1, "creation_date": 1455749917, "post_id": 35469265, "comment_id": 58634455, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10849177/easiest-way-to-loop-through-a-filtered-list-with-vba\" title=\"easiest way to loop through a filtered list with vba\">stackoverflow.com/questions/10849177/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 4784315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12bbce77d35dacdb618719f7737428e?s=128&d=identicon&r=PG&f=1", "display_name": "wesree", "link": "https://stackoverflow.com/users/4784315/wesree"}, "reply_to_user": {"reputation": 2939, "user_id": 4320738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47f691b009d906bf13e2e6c0fb1451?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/4320738/munir"}, "edited": false, "score": 0, "creation_date": 1455804250, "post_id": 35469265, "comment_id": 58660618, "body": "@munircontractor posted a link that helped me, thank you all!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1455754393, "creation_date": 1455754393, "answer_id": 35470364, "question_id": 35469265, "link": "https://stackoverflow.com/questions/35469265/having-vba-macro-work-with-filtering/35470364#35470364", "title": "Having VBA Macro Work With Filtering", "body": "<p>Use </p>\n\n<p><code>SpecialCells(xlCellTypeVisible)</code></p>\n"}], "owner": {"reputation": 57, "user_id": 4784315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f12bbce77d35dacdb618719f7737428e?s=128&d=identicon&r=PG&f=1", "display_name": "wesree", "link": "https://stackoverflow.com/users/4784315/wesree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 35470364, "answer_count": 1, "score": 0, "last_activity_date": 1455754393, "creation_date": 1455749105, "last_edit_date": 1531164843, "question_id": 35469265, "link": "https://stackoverflow.com/questions/35469265/having-vba-macro-work-with-filtering", "title": "Having VBA Macro Work With Filtering", "body": "<p>I have a macro that works on an entire worksheet, including data that has been hidden by filtering. How can I go about having my code only apply to data that is showing after a filter is applied?</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455748140, "post_id": 35468981, "comment_id": 58633671, "body": "Just put it in as (time_calculator / 24) then format it when pulling it out, whether by code with <code>Range.NumberFormat</code> or on the worksheet with a custom format."}, {"owner": {"reputation": 29, "user_id": 5942866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9TP9.jpg?s=128&g=1", "display_name": "sexyuser1", "link": "https://stackoverflow.com/users/5942866/sexyuser1"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455751794, "post_id": 35468981, "comment_id": 58635248, "body": "Hello @ScottCraner . If I only keep the (time_calculator / 24), is it going to affect my data for my future calculation. I must multiply my data (ready_time(i)) with other integer. I think everything under 24:00:00 will be fine, but if it is something like 1900-01-01 02:00:00, I think it won&#39;t be ok.. am I right?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5942866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9TP9.jpg?s=128&g=1", "display_name": "sexyuser1", "link": "https://stackoverflow.com/users/5942866/sexyuser1"}, "edited": false, "score": 0, "creation_date": 1455806332, "post_id": 35470330, "comment_id": 58662213, "body": "Thank you sir for your time/answer!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 29, "user_id": 5942866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9TP9.jpg?s=128&g=1", "display_name": "sexyuser1", "link": "https://stackoverflow.com/users/5942866/sexyuser1"}, "edited": false, "score": 0, "creation_date": 1455806419, "post_id": 35470330, "comment_id": 58662281, "body": "@sexyuser1 I hope it helped.  It was too much for a comment."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1455754249, "creation_date": 1455754249, "answer_id": 35470330, "question_id": 35468981, "link": "https://stackoverflow.com/questions/35468981/switching-a-decimal-higher-than-24-into-hhmmss-format/35470330#35470330", "title": "Switching a decimal higher than 24 into [hh]:mm:ss format?", "body": "<p>As per my comments:</p>\n\n<pre><code>Sub ttooo()\n\nDim t() As Double\n\nReDim t(1 To 2) As Double\n\nt(1) = 36 / 24\nt(2) = 23 / 24\n\nRange(\"A1\") = t(1)\nRange(\"A2\") = t(2)\n\nRange(\"A1:A2\").NumberFormat = \"[hh]:mm:ss\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rF9DO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rF9DO.png\" alt=\"![enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 5942866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9TP9.jpg?s=128&g=1", "display_name": "sexyuser1", "link": "https://stackoverflow.com/users/5942866/sexyuser1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455754249, "creation_date": 1455747822, "last_edit_date": 1455748384, "question_id": 35468981, "link": "https://stackoverflow.com/questions/35468981/switching-a-decimal-higher-than-24-into-hhmmss-format", "title": "Switching a decimal higher than 24 into [hh]:mm:ss format?", "body": "<p>I have an integer greater than 24 and I would like to switch it in date format. All I can get is a mistmatch error.</p>\n\n<pre><code>Dim ready_time() as Date\n\nDim time_calculator as Integer\n</code></pre>\n\n<p>Here I have code that will increment the time_calculator</p>\n\n<pre><code>ready_time(i) = Format((time_calculator / 24), \"[hh]:mm:ss\")\n</code></pre>\n\n<p>If time_calculator = 36, i want to have 36:00:00. This value will be used later, so it is important that I don't use the TEXT/String function.</p>\n\n<p>Thank you for your help, I'm trying to solve this for 5 hours now!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1455745974, "post_id": 35468412, "comment_id": 58632665, "body": "Hmm, hide every sheet expect the first, then unhide the ones on your list? Or iterate through all the sheets, if it&#39;s name is on the list, unhide, else hide it."}, {"owner": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1455746394, "post_id": 35468412, "comment_id": 58632899, "body": "The problem is that the list is not fix. I need a double loop ?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1455746731, "post_id": 35468412, "comment_id": 58633049, "body": "No, why would you? As a matter of fact, I don&#39;t see how your second loop does any good in your original code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1455748054, "post_id": 35468412, "comment_id": 58633649, "body": "Side note, comments should say <i>why</i> not <i>what</i> - <code>LastRowData</code> and <code>LastColumnData</code> are very good identifiers already, their respective comments tell nothing that the variable names don&#39;t already say - I&#39;d remove them. Also your code looks like it can use a peer review - feel free to come over and post your <b>working</b> code to <a href=\"https://codereview.stackexchange.com\">Code Review</a> for help making your code more efficient and easier to read and maintain. (e.g. <code>Worksheets.Add</code> returns a worksheet reference, you should be using it instead of referring to <code>ActiveSheet</code> on the next line)."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "edited": false, "score": 0, "creation_date": 1455748689, "post_id": 35468715, "comment_id": 58633903, "body": "It works but i don&#39;t want to hide the sheet Data. What is IIF ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "edited": false, "score": 0, "creation_date": 1455749538, "post_id": 35468715, "comment_id": 58634286, "body": "If you don&#39;t want to hide the &quot;Data&quot; sheet then you can check the sheet name before performing the Match lookup.  <code>IIf()</code> is a function - you can look it up but it works similarly to the worksheet <code>IF()</code>"}, {"owner": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "edited": false, "score": 0, "creation_date": 1455749901, "post_id": 35468715, "comment_id": 58634446, "body": "I added : Data.Visible = True Thank you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1455746721, "creation_date": 1455746721, "answer_id": 35468715, "question_id": 35468412, "link": "https://stackoverflow.com/questions/35468412/check-if-a-value-from-a-name-sheet-exist-in-a-cell-vba/35468715#35468715", "title": "Check if a value from a name sheet exist in a cell vba", "body": "<p>Untested but something like this:</p>\n\n<pre><code>Dim sName As String, m, sht As Worksheet\n\nLastRowData = Data.Cells(Data.Rows.Count, \"A\").End(xlUp).Row\nLastColumnData = Data.Cells(1, Data.Columns.Count).End(xlToLeft).Column\n\n'Hide any unmatched sheets (and unhide any matched ones)\nFor Each sht In Perftitres.Worksheets\n    m = Application.Match(sht.Name, Data.Cells(2, 9).Resize(LastRowData, 1), 0)\n    sht.Visible = IIf(IsError(m), xlSheetHidden, xlSheetVisible)\nNext sht\n\n'add any missing sheets\nFor i = 2 To LastRowData\n    sName = Data.Cells(i, 9).Value\n    If Not SheetExists(sName, Perftitres) Then\n        With Perftitres.Worksheets.Add(After:=Perftitres.Worksheets(2))\n            .Name = sName\n        End With\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "accepted_answer_id": 35468715, "answer_count": 1, "score": 0, "last_activity_date": 1455779379, "creation_date": 1455745510, "last_edit_date": 1455779379, "question_id": 35468412, "link": "https://stackoverflow.com/questions/35468412/check-if-a-value-from-a-name-sheet-exist-in-a-cell-vba", "title": "Check if a value from a name sheet exist in a cell vba", "body": "<p>I have a problem of code conception.</p>\n\n<p>I just coded something that look into a column (with 500+cells)\nand if the value of a cell doesn't exist as a sheet name (in the same wb) then create the worksheet with the name of the value in that cell.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>' Si le ticker existe mais pas l'onglet,cr\u00e9\u00e9 l'onglet\n LastRowData = Data.Cells(Data.Rows.Count, \"A\").End(xlUp).Row 'trouve la derni\u00e8re ligne de Data\n LastColumnData = Data.Cells(1, Data.Columns.Count).End(xlToLeft).Column 'trouve la derni\u00e8re colonne de Data\n\nFor i = 2 To LastRowData\n    For Each sht In Perftitres.Worksheets\n         If Not SheetExists(Data.Cells(i, 9), Perftitres) Then\n         Worksheets.Add.Name = Data.Cells(i, 9)\n         ActiveSheet.Move After:=Worksheets(2)\n         End If\n    Next sht\nNext i\n</code></pre>\n\n<p>This code work. SheetExist is a function that say true if sheet exist and false if not.</p>\n\n<p>Nevertheless, i want to do the inverse now :</p>\n\n<p>If a worksheet as a name that isn't in the column then hide this sheet.\nI can't figure it out ...\nI want to look in every worksheet exept the first one (which is data).\nIf the name appear in the column, do nothing. If it's not then hide the sheet. </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1455743671, "post_id": 35467867, "comment_id": 58631295, "body": "See <a href=\"http://stackoverflow.com/questions/3630496/how-do-you-get-a-range-to-return-its-name\">HERE</a> it is one line no need for separate  function"}, {"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455748637, "post_id": 35467867, "comment_id": 58633884, "body": "yes, that was the key concept, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": true, "score": 1, "last_activity_date": 1455746352, "creation_date": 1455746352, "answer_id": 35468640, "question_id": 35467867, "link": "https://stackoverflow.com/questions/35467867/get-named-range-from-row-number/35468640#35468640", "title": "Get Named Range From Row Number", "body": "<p>So according to the reference supplied by Scott something like the following might do:</p>\n\n<pre><code>Public Function getRowNamedRange(rowNum as integer) as string\n    getRowNamedRange = Activesheet.rows(rowNum).Name.Name\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 35468640, "answer_count": 1, "score": 0, "last_activity_date": 1455785406, "creation_date": 1455743574, "last_edit_date": 1455785406, "question_id": 35467867, "link": "https://stackoverflow.com/questions/35467867/get-named-range-from-row-number", "title": "Get Named Range From Row Number", "body": "<p>My worksheet contains rows that have been assigned named ranges. For example, row 10 of sheet(1) has been named \"Kumquats\". I want to write a function that returns the name of the named range when the row # is passed to it. So the function call would be:</p>\n\n<pre><code>getRowNamedRange(rowNum as integer) as string\n</code></pre>\n\n<p>and the function would return the string \"Kumquats\" if passed the number 10.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "ms-access", "pdf", "hyperlink", "attachment"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5942468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db94d99971c23a1aed5ecbdb44ccce64?s=128&d=identicon&r=PG&f=1", "display_name": "wes", "link": "https://stackoverflow.com/users/5942468/wes"}, "edited": false, "score": 0, "creation_date": 1455812424, "post_id": 35474146, "comment_id": 58667002, "body": "I did try what you have suggested. i replaced the line of code above and to point out the field containing the hyperlink is now called doc_attachment and is set up as a hyperlink column in the underlining table.    now when i run the code i get the error on                             &#39;Set rsChild = rsParent.Field(&quot;Doc_Attachment&quot;).Value&#39;                                                 object doesent support this property or method"}, {"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "reply_to_user": {"reputation": 11, "user_id": 5942468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db94d99971c23a1aed5ecbdb44ccce64?s=128&d=identicon&r=PG&f=1", "display_name": "wes", "link": "https://stackoverflow.com/users/5942468/wes"}, "edited": false, "score": 0, "creation_date": 1455957506, "post_id": 35474146, "comment_id": 58731895, "body": "1) You say that your field &#39;doc_attachment&#39; contains your hyperlink. Please read my boded note above. 2) You cannot define a recordset (rsChild) as an Hyperlink! Pls edit your question with your table definition."}], "tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1455775965, "creation_date": 1455775965, "answer_id": 35474146, "question_id": 35467632, "link": "https://stackoverflow.com/questions/35467632/save-hyperlinked-files-to-a-folder-vba/35474146#35474146", "title": "Save hyperlinked files to a folder vba", "body": "<p>Assuming that the field containing your file URL is named <code>FileURL</code> , change</p>\n\n<pre><code>rsChild.Fields(\"FileData\").SaveToFile ([filePath] &amp; [newFolder])\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Filecopy rsChild.Fields(\"FileURL\"), [filePath] &amp; [newFolder]\n</code></pre>\n\n<p><strong>Note: Instead of <code>Hyperlink</code>, define your <code>FileURL</code> field as a normal string containing the full qualified filename.</strong></p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 11, "user_id": 5942468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db94d99971c23a1aed5ecbdb44ccce64?s=128&d=identicon&r=PG&f=1", "display_name": "wes", "link": "https://stackoverflow.com/users/5942468/wes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594460248, "creation_date": 1455742778, "last_edit_date": 1594460248, "question_id": 35467632, "link": "https://stackoverflow.com/questions/35467632/save-hyperlinked-files-to-a-folder-vba", "title": "Save hyperlinked files to a folder vba", "body": "<p>I have a parts database and we have been using the Access 2010 attachment feature to attach PDFs to each part number. I have some working code that did what I was looking to do, which was to query a given list of parts and save just the attached PDF files to a folder. I now changed the [PDF] column to a hyperlink column, because I was worried I would eventually exceed the 3GB limit. </p>\n\n<p>Is there a way I can modify this code to work with a hyperlink field instead of the attachment type field?</p>\n\n<p>The ultimate goal here is to make a CD with all part documents (PDFs) for our customer.</p>\n\n<pre><code>Private Sub Command32_Click()\n'this creates a folder for me\nIf Dir([filePath] &amp; [newFolder], vbDirectory) = \"\" Then\nMkDir [filePath] &amp; [newFolder]\nElse\n\nMsgBox (\"Folder:\" &amp; \" \" &amp; [newFolder] &amp; \" \" &amp; \"already Exists\")\nExit Sub\nEnd If\n\n'code to loop through present list and save attached files to the new folder\n\nDim db As DAO.Database\nDim rsParent As DAO.Recordset2\nDim rsChild As DAO.Recordset2\n\nSet db = CurrentDb\nSet rsParent = Me.Recordset\n\nWith rsParent\n.MoveFirst 'This ensures that regardless of your current record, the loop will start with the first record\n\nDo While Not .EOF\n\nSet rsChild = rsParent.Fields(\"pdf\").Value\n\n    With rsChild\n    Do While Not .EOF\n        If rsChild.RecordCount &lt;&gt; 0 Then\n            rsChild.OpenRecordset\n            rsChild.Fields(\"FileData\").SaveToFile ([filePath] &amp; [newFolder])\n            Me.Refresh\n            .MoveNext\n     Else\n        .MoveNext\n     End If\n    Loop\n  End With\n\n.MoveNext\nLoop\nEnd With\nExit_SaveImage:\n\nExit Sub\n' error stuff\nErr_SaveImage:\nIf Err = 3839 Then\n    MsgBox (\"All Done\")\n    Resume Next\nElse\n    MsgBox \"There's been an error!\", Err.Number, Err.DESCRIPTION\n    Resume Exit_SaveImage\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "reference", "user-defined-functions", "countif", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455742716, "post_id": 35467478, "comment_id": 58630784, "body": "In this instance both would be absolute, you are not autofilling you are asking the formula to return one answer so it does not matter.  vba does not do absolute, because you would simply declare it.  It is only when using the actual formula, wether in a <code>Evaluate()</code> or setting the formula to a cell where it would matter."}, {"owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455743756, "post_id": 35467478, "comment_id": 58631346, "body": "It&#39;s a user defined function.  It will have a range of answers."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455743886, "post_id": 35467478, "comment_id": 58631409, "body": "You would change <code>(Range(HCA &amp; &quot;:&quot; &amp; HC), r)</code> to <code>(HC, r)</code> and then you would call it <code>=Fred(A1,$B$1:B1)</code>  The absolute needs to be on the worksheet side not the vba side.  As stated earlier vba does not do absolute."}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455744026, "creation_date": 1455742296, "last_edit_date": 1531161705, "question_id": 35467478, "link": "https://stackoverflow.com/questions/35467478/excel-vba-how-to-use-a-relative-variable-range-as-an-absolute-range", "title": "EXCEL VBA - How to use a relative variable range as an absolute range?", "body": "<p>I've looked online and have not come across an answer that seems to work in this specific instance.  </p>\n\n<p>In VBA, I am creating a formula that will reference a header row and the range beneath it... $B$1:B1.  This will be used in an UDF (user defined function).</p>\n\n<p>The header cell (B1) will be a user defined input, variable \"HC\" (for header cell).<br>\nI want to create the absolute range of HC and call it HCA (absolute HC)  </p>\n\n<p>It will go into a VBA formula like this, unless you know of a better way:</p>\n\n<pre><code>Public Function Fred(r as Range, HC as Range) as Long\na = application.worksheetfunction.countif(Range(HCA &amp; \":\" &amp; HC), r)\n</code></pre>\n\n<p>where \"r\" is another range.</p>\n\n<p>The user will enter <code>=Fred(r,HC)</code> into a cell in an Excel worksheet, then fill down as far as needed.  </p>\n\n<p>Anyone know how to make a relative variable into an absolute variable?</p>\n\n<p>The UDF is based on this formula: <a href=\"http://www.get-digital-help.com/2009/04/14/create-a-unique-alphabetically-sorted-list-extracted-from-a-column/\" rel=\"nofollow\">Create a unique distinct alphabetically sorted list, extracted from a column in excel</a></p>\n\n<p><code>=INDEX(List, MATCH(MIN(IF(COUNTIF($B$1:B1, List)=0, 1, MAX((COUNTIF(List, \"&lt;\"&amp;List)+1)*2))*(COUNTIF(List, \"&lt;\"&amp;List)+1)), COUNTIF(List, \"&lt;\"&amp;List)+1, 0))</code></p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1683, "user_id": 3299157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd2850c64bf866ed6e6b448eca08f0ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ageonix", "link": "https://stackoverflow.com/users/3299157/ageonix"}, "edited": false, "score": 0, "creation_date": 1455742286, "post_id": 35467444, "comment_id": 58630566, "body": "What problems are you having with line 2?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455742517, "post_id": 35467444, "comment_id": 58630683, "body": "&quot;Not working&quot;...what does that mean? Do you get an error message? Is the error message in the title of your question? Wouldn&#39;t it be simpler to use an insert statement?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1455744912, "post_id": 35467444, "comment_id": 58632019, "body": "If you manually open <code>tbl_login</code> in Datasheet View from the Navigation pane, can you add a new row there?"}], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1455744799, "post_id": 35468113, "comment_id": 58631957, "body": "When you want <code>RecordsAffected</code>, you have use an object variable set to <code>CurrentDb</code> instead of <code>CurrentDb</code> directly.  <code>CurrentDB.RecordsAffected</code> always gives you zero."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1455783058, "post_id": 35468113, "comment_id": 58646269, "body": "If the original code fails, so will yours, of course, using the same values. The issue is elsewhere."}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 1, "last_activity_date": 1455744449, "creation_date": 1455744449, "answer_id": 35468113, "question_id": 35467444, "link": "https://stackoverflow.com/questions/35467444/openrecordset-from-access-using-sql-back-end-invalid-argument-error/35468113#35468113", "title": "OpenRecordset from Access using SQL back end -- &quot;Invalid Argument&quot; Error", "body": "<p>You're doing this the hard way.  You just need this:</p>\n\n<pre><code>strsql = \"INSERT INTO tbl_login (loginname) VALUES ('joe2')\"\nCurrentDB.Execute strsql, dbFailOnError\n</code></pre>\n\n<p>Using the Execute method has some additional benefits; for one, you don't need to specify SetWarnings.  Additionally, you can trap errors and retain additional information.  For example, you could do something like this:</p>\n\n<pre><code>strsql = \"INSERT INTO tbl_login (loginname) VALUES ('joe2')\"\nCurrentDB.Execute strsql, dbFailOnError\nDebug.Print CurrentDB.RecordsAffected &amp; \" records were added\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5942563, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208416254673526/picture?type=large", "display_name": "Joe Vaccone", "link": "https://stackoverflow.com/users/5942563/joe-vaccone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455744449, "creation_date": 1455742170, "question_id": 35467444, "link": "https://stackoverflow.com/questions/35467444/openrecordset-from-access-using-sql-back-end-invalid-argument-error", "title": "OpenRecordset from Access using SQL back end -- &quot;Invalid Argument&quot; Error", "body": "<p>I have been in the process of converting our access database to SQL and having problems with my OpenRecordset statement on line 2 .. \n(This code I have used for other SQL systems.. just not working now) Frustrating\nThanks for any help :) .. the SQL has a primary key and Identity field. thanks!\nJoe</p>\n\n<pre><code>strsql = \"SELECT * FROM tbl_login\"\nSet addrec = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)\naddrec.addNew\naddrec.loginname = \"Joe2\"\naddrec.Update\naddrec.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455744570, "post_id": 35467443, "comment_id": 58631816, "body": "Let me add more details to specify in greater detail.  When I receive the file it has 1 worksheet with a custom name on it. When I run the whole code it adds a new worksheet named sheet1 with a pivot table and text is certain cells. &quot;E29&quot; is on sheet1 and that&#39;s where I want the result of the countifs formula. The formula itself is referencing a data in the original custom named worksheet. How can I set up code so when I run the code in future workbooks it will reference the changed worksheet name and provide the updated results without having to give the specific worksheet name every time?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455744848, "post_id": 35467443, "comment_id": 58631990, "body": "@GCG is it the first worksheet in the workbook?  You can use <code>Sheets(1).Name</code>"}, {"owner": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455745014, "post_id": 35467443, "comment_id": 58632074, "body": "Range(&quot;E29&quot;).Select         ActiveCell.FormulaR1C1 = _         &quot;=COUNTIFS(&#39;Sheets(1).Name&#39;!C,&quot;&quot;failed to upgrade&quot;&quot;)&quot;         Range(&quot;E30&quot;).Select  When I try this it opens up an update values window"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455745113, "post_id": 35467443, "comment_id": 58632143, "body": "@GCG see edit, you need to quote out the vba from the worksheet formula."}, {"owner": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455745451, "post_id": 35467443, "comment_id": 58632342, "body": "corrected. now when I run the code it gives me 0 as the total because it is reference the new &quot;sheet1&quot; that gets added when running the rest of the code. When I look in the VBE it says Sheet1 (altered name) and Sheet2 (Sheet1). I take that as the code name of the original worksheet is sheet 1 and the added sheet 1 is sheet 2"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455745579, "post_id": 35467443, "comment_id": 58632435, "body": "@GCG Then is the sheet you want to reference the second sheet?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455745625, "post_id": 35467443, "comment_id": 58632463, "body": "@GCG when I say the second sheet I mean looking at the tabs at the bottom is it the second in order from left to right?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "edited": false, "score": 0, "creation_date": 1455755334, "post_id": 35467443, "comment_id": 58636436, "body": "@GCG please mark as correct by clicking on the green check mark by the answer.  It is something only you can do."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1455745632, "last_edit_date": 1455745632, "creation_date": 1455742161, "answer_id": 35467443, "question_id": 35467350, "link": "https://stackoverflow.com/questions/35467350/excel-vba-countifs-formula-referencing-a-changing-worksheet-name/35467443#35467443", "title": "excel vba countifs formula referencing a changing worksheet name", "body": "<p>First you do not need to select the cell to use it.</p>\n\n<p>Second you would quote out the parts that are vba:</p>\n\n<pre><code>    Range(\"E29\").FormulaR1C1 = _\n     \"=COUNTIFS('\" &amp; Sheets(2).Name &amp; \"'!C,\"\"failed to upgrade\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5942432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43646955c09004d59326740d1187420?s=128&d=identicon&r=PG&f=1", "display_name": "GCG", "link": "https://stackoverflow.com/users/5942432/gcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 35467443, "answer_count": 1, "score": 1, "last_activity_date": 1455745632, "creation_date": 1455741898, "question_id": 35467350, "link": "https://stackoverflow.com/questions/35467350/excel-vba-countifs-formula-referencing-a-changing-worksheet-name", "title": "excel vba countifs formula referencing a changing worksheet name", "body": "<p>New member and new to VBA. Looking forward to learning as much as possible.</p>\n\n<p>Right now I and trying to use the countifs formula to count the number of occurrences in a column on a different worksheet. Unfortunately it is for a weekly report and when I open it the worksheet name is different every week.</p>\n\n<p>Here is the portion that I am having trouble with:</p>\n\n<pre><code>Range(\"E29\").Select\n    ActiveCell.FormulaR1C1 = _\n    \"=COUNTIFS('DynamicNameHere'!C,\"\"failed to upgrade\"\")\"\n    Range(\"E30\").Select\n</code></pre>\n\n<p>When I put the specific worksheet name in the code works perfectly fine. I tried looking up how to use the worksheet code name but haven't been successful.\nIs there a way to specify the changing worksheet name without having to reference it by its actual name?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "math"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455741542, "post_id": 35467194, "comment_id": 58630151, "body": "<a href=\"https://support.microsoft.com/en-us/kb/78113\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/78113</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1455741543, "creation_date": 1455741543, "answer_id": 35467251, "question_id": 35467194, "link": "https://stackoverflow.com/questions/35467194/zero-in-excel-but-not-zero-in-vba/35467251#35467251", "title": "zero in excel but not zero in vba", "body": "<p>2.546E-09 = 0.000000002546. The reason this exists even though you were doing simple arithmetic is simply the nature of a floating point error. The simplest way to resolve this in your case is to make your comparison to 0 rounded, like so:</p>\n\n<pre><code>If Round(myArr(I,1) - myArr(J,3) - myArr(k,3), 0) = 0 Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5942076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffab0ac2b95457e3329b03e0d30ad25?s=128&d=identicon&r=PG&f=1", "display_name": "salynn", "link": "https://stackoverflow.com/users/5942076/salynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455741543, "creation_date": 1455741346, "question_id": 35467194, "link": "https://stackoverflow.com/questions/35467194/zero-in-excel-but-not-zero-in-vba", "title": "zero in excel but not zero in vba", "body": "<p>In vba i manipulated 2 ranges to populate 2 different 2-d arrays of variant type, tempArr(,1) numeric result of formula (rounded to 2dp), tempArr(,2) string data type </p>\n\n<p>i have copied the arrays into new worksheet:</p>\n\n<pre><code>Dim tempArr(1 to 50, 1 to 2) as Variant\nRange(\"A1:A50\") = tempArr\nRange(\"C1:C100\") =tempArr1\n</code></pre>\n\n<p>I then have a subroutine to perform a comparison:</p>\n\n<pre><code>Dim myRg as Range\nDim myArr() as Variant\nSet myRg = Range(\"A1\",Cells(lastrow,4))\nmyArr = myRg\n</code></pre>\n\n<p>but when i loop (I,J,K) through the numeric column A with column C trying to match:</p>\n\n<pre><code>If myArr(I,1)- myArr(J,3)-myArr(k,3) = 0 Then ' perform action\n</code></pre>\n\n<p>...the logic fails in only one instance where in excel worksheet the calculation is clearly 0 but in vba the value is 2.546E-09</p>\n\n<p>First question relates to why numbers in excel worksheet which are to 2dp would in vba create a value, after addition/subtraction calculation, with 9th decimal place or more. Or is 2.546E-09 result caused by something else?</p>\n\n<p>Secondly I have used array of variant type to efficiently handle the 2 data types, but perhaps not the best when it comes to performing math. operations..Would creating a variable of Double data type be the solution for the above issue..? i have just started using variant array method to manipulate range data which has speeded up my routines considerably but any general advice would be appreciated. This is my first post so pls bear with me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455745927, "post_id": 35466984, "comment_id": 58632642, "body": "are you sure &quot;Location Code&quot; is the name of one of your columns in the new data set? (I also added a link to your previous question - please remove if you think it should not be there, but I think it helps for context)."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455803782, "post_id": 35466984, "comment_id": 58660246, "body": "@ScottHoltzman &quot;Location Code&quot; is a column in the &quot;Working&quot; worksheet. And I want to add a field with this name to the pivot table. This is said about RowFields parameter: Specifies a field name (or an array of field names) to be added as rows, or to be added to the category axis."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455806080, "post_id": 35466984, "comment_id": 58662015, "body": "I can&#39;t reproduce the error with your code. Make sure <code>Location Code</code> is spelled correctly and has the same amount of space in the middle as inside the source data range for the PT."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455806936, "post_id": 35466984, "comment_id": 58662735, "body": "@ScottHoltzman Strange, this worked before my previous change was made, i.e. with UsedRange."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455808274, "post_id": 35466984, "comment_id": 58663731, "body": "Yes. I did a mini test with the code and a table I created and it worked perfectly."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455811392, "post_id": 35466984, "comment_id": 58666168, "body": "@ScottHoltzman I noticed that after         lColumn = .Range(&quot;A&quot; &amp; .Columns.Count).End(xlToLeft).Column, lColumn is 1, which doesn&#39;t seem to be right."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455812222, "post_id": 35466984, "comment_id": 58666855, "body": "@ScottHoltzman If I replace that line with         lColumn = .Cells(1, Columns.Count).End(xlToLeft).Column, then lColumn is 47, which is right, but I get the same error as before: Runtime error 13: Type mismatch on ActiveWorkbook.PivotCaches.Add... line."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455826691, "post_id": 35466984, "comment_id": 58675882, "body": "David. can you post a screenshot of the actual data set?"}], "owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 746, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455745966, "creation_date": 1455740650, "last_edit_date": 1495542200, "question_id": 35466984, "link": "https://stackoverflow.com/questions/35466984/excel-vba-failed-method-on-pivot-table", "title": "Excel VBA: Failed method on pivot table", "body": "<p>I am creating a VBA macro. Among other things, it makes a pivot table:</p>\n\n<pre><code>With Worksheets(\"Working\")\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    lColumn = .Range(\"A\" &amp; .Columns.Count).End(xlToLeft).Column\n    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:=.Range(.Cells(1, 1), .Cells(lRow, lColumn))).CreatePivotTable TableDestination:=\"\", TableName:=\"HDPivotTable\", DefaultVersion:=xlPivotTableVersion10\nEnd With\n\nActiveSheet.Name = \"HD Pivot\"\nActiveSheet.PivotTableWizard TableDestination:=ActiveSheet.Cells(1, 1)\nActiveSheet.PivotTables(\"HDPivotTable\").AddFields RowFields:=\"Location Code\"\n</code></pre>\n\n<p>For some reason, I am getting Run-time error '1004': AddFields method of PivotTable class failed</p>\n\n<p>Could you please help?</p>\n\n<p>Question related to this <a href=\"https://stackoverflow.com/questions/35461122/vba-error-on-creating-a-pivot-table/35462162#35462162\">previous question</a>.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "vb.net", "excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1455741672, "post_id": 35466874, "comment_id": 58630203, "body": "You said this is &quot;inside Excel&quot;. Doesn&#39;t that mean your code is VBA and not VB.Net? If that is the case, please edit your question to replace the vb.net tag with excel-vba. That will bring your question to the attention of people who code VBA in Excel."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1455746087, "post_id": 35466874, "comment_id": 58632728, "body": "json is not just a fancy string, it is serialized data from an object. Use Json.NET to deserialize it instead of parsing it"}], "owner": {"reputation": 1207, "user_id": 1704282, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/74521b29996d85bfb60333d41efa23ae?s=128&d=identicon&r=PG", "display_name": "pelos", "link": "https://stackoverflow.com/users/1704282/pelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455742980, "creation_date": 1455740274, "last_edit_date": 1455742980, "question_id": 35466874, "link": "https://stackoverflow.com/questions/35466874/vba-on-error-trying-to-parse-a-null-variant-instead-a-string", "title": "vba on error trying to parse a null variant instead a string", "body": "<p>inside excel i am looping a series of json strings that look like this.   but some times one of the values will come with null   instead a string.\nso i try to do some error recognition but i am not getting the right stuff.<br>\ni would like to get a list    where the first item will be \"Tool Training\"  and since null fail with Type Mismatch in the second, i am trying a try except or an on error like this.</p>\n\n<pre><code>    Dim return_value As String     \nOn Error GoTo 22\n    return_value = jstring(\"fields\")(\"customfield_18711\")(\"value\")\n22:\n    return_value = \"empty\"\n\nResume Next\n</code></pre>\n\n<p>should only use resume? with out the next?\nor i dont even use the resume at all?</p>\n\n<p>this is how the json strings look like</p>\n\n<pre><code>{\n\"expand\": \"operations,editmeta,changelog,transitions,renderedFields\",\n\"id\": \"452637\",\n\"self\": \"example.com/rest/api/2/issue/452637\",\n\"key\": \"MP-16098\",\n\"fields\": {\n\"summary\": \"my summary\",\n\"customfield_18711\": {\n\"self\": \"example.com/rest/api/2/customFieldOption/48120\",\n\"value\": \"Tool Training\",\n\"id\": \"48120\"\n}\n}\n}\n\n\n\n\n{\n\"expand\": \"operations,editmeta,changelog,transitions,renderedFields\",\n\"id\": \"452637\",\n\"self\": \"example.com/rest/api/2/issue/452637\",\n\"key\": \"MP-16098\",\n\"fields\": {\n\"summary\": \"my summary\",\n\"customfield_18711\": {\n\"self\": \"example.com/rest/api/2/customFieldOption/48120\",\n\"value\": null,\n\"id\": \"48120\"\n}\n}\n}\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455740196, "post_id": 35466823, "comment_id": 58629356, "body": "You need to give concrete examples of what your data looks like when it works, and when it doesn&#39;t work. &quot;Sometimes it skips over cells or doesn&#39;t work&quot; is not helpful, and basically means that to answer your question someone would need to debug it from scratch, including putting the code in a worksheet and trying to make up some data which recreates your problem."}, {"owner": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455740395, "post_id": 35466823, "comment_id": 58629483, "body": "Ok, thank you for the quick feedback. I will try to remove any personal data from my actual data and provide a real before/after example."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455740661, "post_id": 35466823, "comment_id": 58629659, "body": "Great - when you respond to someone&#39;s comment, you should always type &quot;@&quot; and then their username. That pings that person so they know you&#39;ve said something to them. After you&#39;ve edited your question, if you want me to take a look at it, make a comment that includes @Grade and press Tab to make the site type out my whole username."}, {"owner": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455741527, "post_id": 35466823, "comment_id": 58630140, "body": "@Grade&#39;Eh&#39;Bacon - Thank you! I just finished editing with better before/after pictures to better show the problem."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "edited": false, "score": 0, "creation_date": 1455742606, "post_id": 35467469, "comment_id": 58630726, "body": "Hmm I will take a look at my opening &quot;If&quot; statement for the loop. My goal was for it to check if the cell beneath was empty, but also if the cell down one row in column B has data. This way the loop would stop naturally once it reaches the last cell in column A. Maybe I am going about this entirely wrong? Either way thank you for the help!"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "edited": false, "score": 0, "creation_date": 1455742928, "post_id": 35467469, "comment_id": 58630895, "body": "The way I read your workbook, it already knows the last row, based on how you&#39;ve defined LR. So instead, you could just check to see whether you&#39;re below that point. ie: if LR is 70, and your loop is at A69, and you want to see whether you&#39;re below the bottom of your data loop, you could stop at checking A69 + 1 more row."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1455742263, "creation_date": 1455742263, "answer_id": 35467469, "question_id": 35466823, "link": "https://stackoverflow.com/questions/35466823/how-do-i-merge-cells-that-have-data-with-blank-cells-in-the-same-column/35467469#35467469", "title": "How do I merge cells that have data with blank cells in the same column?", "body": "<p>Take a look at your initial If statement, as follows:</p>\n\n<pre><code>If Sheets(DataSheet).Cells(i, 1).Value &lt;&gt; \"\" And Sheets(DataSheet).Cells(i + 1, 1).Value = \"\" And Sheets(DataSheet).Cells(i + 1, 2).Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>In English, this says, \"If the current row is NOT blank, and the next row IS blank, and the 3rd row is NOT blank, then...\"</p>\n\n<p>But you can see that both of cells A55 &amp; A56 are blank, following A54 which says \"Anti-Virus\". So, you've failed the test that you set for yourself, and it ignores this section. If you want it to work for this section, you will need to code it to actually count how many blank cells there are in a row, following a non-blank cell. That will tell you how many to merge together.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1455761550, "creation_date": 1455761550, "answer_id": 35471533, "question_id": 35466823, "link": "https://stackoverflow.com/questions/35466823/how-do-i-merge-cells-that-have-data-with-blank-cells-in-the-same-column/35471533#35471533", "title": "How do I merge cells that have data with blank cells in the same column?", "body": "<p>I finally figured it out! \nBoth \"if\" statements were working for certain portions when they should have been exclusive, so I changed the second \"if\" statement to an \"else\". I also found that when I was setting \"i = u\" I forgot to take into account that \"next i\" would increase \"i\" once more than I needed, so I changed that to \"i = u - 1\" to compensate.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>'This is the section that I'm having trouble with!\n'loop to merge titles with blank cells and add borders\nLR = Sheets(DataSheet).Cells(Rows.Count, \"B\").End(xlUp).Row\nFor i = 1 To LR\n    If Sheets(DataSheet).Cells(i, 1).Value &lt;&gt; \"\" And Sheets(DataSheet).Cells(i + 1, 1).Value = \"\" And i &lt;&gt; LR Then\n       u = i + 1\n       Do While Sheets(DataSheet).Cells(u, 1).Value = \"\" And Sheets(DataSheet).Cells(u, 2) &lt;&gt; \"\"\n            u = u + 1\n        Loop\n        Sheets(DataSheet).Range(\"A\" &amp; i &amp; \":A\" &amp; (u - 1)).Select\n        With Selection\n            .Merge\n            .BorderAround Weight:=xlMedium\n            .WrapText = True\n            '.VerticalAlignment = x1VAlignTop\n            '.HorizontalAlignment = xlLeft\n        End With\n        Sheets(DataSheet).Range(\"B\" &amp; i &amp; \":B\" &amp; (u - 1)).BorderAround Weight:=xlMedium\n        i = u - 1\n    Else\n        Sheets(DataSheet).Cells(i, 1).BorderAround Weight:=xlMedium\n        Sheets(DataSheet).Cells(i, 1).WrapText = True\n        Sheets(DataSheet).Cells(i, 2).BorderAround Weight:=xlMedium\n        Sheets(DataSheet).Cells(i, 2).WrapText = True\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5942400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16180c4eaef05e8d22fe9237af42a6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5942400/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1889, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1455761550, "creation_date": 1455740069, "last_edit_date": 1455741447, "question_id": 35466823, "link": "https://stackoverflow.com/questions/35466823/how-do-i-merge-cells-that-have-data-with-blank-cells-in-the-same-column", "title": "How do I merge cells that have data with blank cells in the same column?", "body": "<p>I'm in the middle of writing a macro for Excel that will merge cells in column \"A\" containing titles with blank cells beneath it.</p>\n\n<p>Here is an example of what I'm dealing with:<a href=\"http://i.stack.imgur.com/MSzLx.png\" rel=\"nofollow\">Actual Before</a></p>\n\n<p>Here is the desired result: <a href=\"http://i.stack.imgur.com/OQj0O.png\" rel=\"nofollow\">Actual After</a></p>\n\n<p>So far I've managed to get my code to work, but I noticed that it will always skip over the \"antivirus\" section.</p>\n\n<p>Here is what I got so far:</p>\n\n<pre><code>    'loop to merge titles with blank cells and add borders\nLR = Sheets(DataSheet).Cells(Rows.Count, \"B\").End(xlUp).Row\nFor i = 1 To LR\n    If Sheets(DataSheet).Cells(i, 1).Value &lt;&gt; \"\" And Sheets(DataSheet).Cells(i + 1, 1).Value = \"\" And Sheets(DataSheet).Cells(i + 1, 2).Value &lt;&gt; \"\" Then\n       u = i + 1\n       Do While Sheets(DataSheet).Cells(u, 1).Value = \"\" And Sheets(DataSheet).Cells(u, 2) &lt;&gt; \"\"\n            u = u + 1\n        Loop\n        Sheets(DataSheet).Range(\"A\" &amp; i &amp; \":A\" &amp; (u - 1)).Select\n        With Selection\n            .Merge\n            .BorderAround Weight:=xlMedium\n            .WrapText = True\n            '.VerticalAlignment = x1VAlignTop\n            '.HorizontalAlignment = xlLeft\n        End With\n        Sheets(DataSheet).Range(\"B\" &amp; i &amp; \":B\" &amp; (u - 1)).BorderAround Weight:=xlMedium\n        i = u + 1\n    End If\n    If Sheets(DataSheet).Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(DataSheet).Cells(i, 1).BorderAround Weight:=xlMedium\n        Sheets(DataSheet).Cells(i, 1).WrapText = True\n        Sheets(DataSheet).Cells(i, 2).BorderAround Weight:=xlMedium\n        Sheets(DataSheet).Cells(i, 2).WrapText = True\n    End If\nNext i\n</code></pre>\n\n<p>Please excuse any sloppiness with my code, I'm very new at this. I don't know what I am missing, but any help would be greatly appreciated!\nThanks</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1455739815, "post_id": 35466713, "comment_id": 58629129, "body": "The proper event is <code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1455740996, "post_id": 35466713, "comment_id": 58629857, "body": "Well for one thing you need to have error-handling.  Otherwise, if you get an error, you could end up leaving all of your events disabled."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4151126, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8731541ee1be68210908a7ae034cfe5a?s=128&d=identicon&r=PG&f=1", "display_name": "rkent", "link": "https://stackoverflow.com/users/4151126/rkent"}, "edited": false, "score": 0, "creation_date": 1455741541, "post_id": 35466837, "comment_id": 58630150, "body": "Once again, you nailed what I was needing. Thanks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31, "user_id": 4151126, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8731541ee1be68210908a7ae034cfe5a?s=128&d=identicon&r=PG&f=1", "display_name": "rkent", "link": "https://stackoverflow.com/users/4151126/rkent"}, "edited": false, "score": 0, "creation_date": 1455741553, "post_id": 35466837, "comment_id": 58630156, "body": "@rkent see edit I put in an error check to ensure that the events get turned back on."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1455741628, "last_edit_date": 1455741628, "creation_date": 1455740107, "answer_id": 35466837, "question_id": 35466713, "link": "https://stackoverflow.com/questions/35466713/converting-excel-vba-for-a-single-sheet-to-workbook-wide/35466837#35466837", "title": "Converting Excel VBA for a single sheet to workbook wide", "body": "<p>Put this in your <code>ThisWorkbook</code> Code:</p>\n\n<pre><code>    Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nDim hr As Boolean\nDim sheets As Variant: sheets = Array(\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\")\nDim sheet As Variant\nOn Error GoTo ext\nFor Each sheet In sheets\n    If sheet = Sh.Name Then\n        hr = True\n    End If\nNext sheet\n\nIf Not Intersect(Sh.Range(\"F:F\"), Target) Is Nothing And hr Then\n    Application.EnableEvents = False\n    Target = Int(Target) + (Target - Int(Target)) * 100 / 60\n    If Int(Target) = 0 Then\n        Target.ClearContents\n    End If\nEnd If\nApplication.EnableEvents = True\nExit Sub\next:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I believe this will do what you were trying.</p>\n\n<p>Edit:</p>\n\n<p>As per @RBarryYoung, it was also missing the error check to ensure that it turns back on the Events.</p>\n"}], "owner": {"reputation": 31, "user_id": 4151126, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8731541ee1be68210908a7ae034cfe5a?s=128&d=identicon&r=PG&f=1", "display_name": "rkent", "link": "https://stackoverflow.com/users/4151126/rkent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 35466837, "answer_count": 1, "score": 0, "last_activity_date": 1455741628, "creation_date": 1455739699, "question_id": 35466713, "link": "https://stackoverflow.com/questions/35466713/converting-excel-vba-for-a-single-sheet-to-workbook-wide", "title": "Converting Excel VBA for a single sheet to workbook wide", "body": "<p>I have the following VBA code that functions properly when put in the code sheet for a single worksheet within an Excel workbook:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Range(\"E:E\"), Target) Is Nothing Then\n        Target = Int(Target) + (Target - Int(Target)) * 100 / 60\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I want to change the code so that I can put it in the workbook code sheet rather than the code sheet of each individual worksheet, and to do so came up with the following that I thought would function. However, it does not.</p>\n\n<pre><code>Private Sub Workbook_Change(ByVal Sh As Object, ByVal Target As Range)\n\n    ' Do nothing if not entering data in time cell\n    If (Intersect(Target, Sh.Range(\"F:F\")) Is Nothing) Then Exit Sub\n\n    Application.EnableEvents = False\n\n    Dim ws As Worksheet\n    Dim sheets As Variant: sheets = Array(\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\")\n    Dim sheet As Variant     \n\n    For Each sheet In sheets\n        Set ws = ThisWorkbook.Worksheets(ActiveSheet)\n        If Not Intersect(ws.Range(\"F:F\"), Target) Is Nothing Then\n            Target = Int(Target) + (Target - Int(Target)) * 100 / 60\n        End If\n        If Int(Target) = 0 Then\n            Target.ClearContents\n        End If\n    Next\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Is there an obvious error there so that I can be pointed in the correct direction?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455739616, "post_id": 35466662, "comment_id": 58629006, "body": "Look into the <code>Application.EnableEvents</code> function.  You can then toggle whether the Worksheet event fires or not."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4563174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0deaf9a2761235247134e46a9ac8f76a?s=128&d=identicon&r=PG&f=1", "display_name": "user4563174", "link": "https://stackoverflow.com/users/4563174/user4563174"}, "edited": false, "score": 0, "creation_date": 1455747968, "post_id": 35466766, "comment_id": 58633615, "body": "Uooo! Really intelligent method! I will try it! Thanks"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 1, "last_activity_date": 1455739878, "creation_date": 1455739878, "answer_id": 35466766, "question_id": 35466662, "link": "https://stackoverflow.com/questions/35466662/run-event-macro-from-a-particular-sub/35466766#35466766", "title": "Run Event Macro from a particular Sub", "body": "<p>You could add in logic branching to your event change macro, so that it checks for a certain parameter before it runs. First, make a Global Boolean variable, which either holds True or False - then make your sub A9 switch it to True. For example:</p>\n\n<pre><code>Global Start_Event_Code as Boolean\n\nSub A9\n    'Other Code\n    Start_Event_Code = True\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Start_Event_Code Then\n        'Do stuff\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then you could make it so that the A10 sub switches it off again:</p>\n\n<pre><code>Sub A9\n    Start_Event_Code = False\n    'Other Code\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4563174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0deaf9a2761235247134e46a9ac8f76a?s=128&d=identicon&r=PG&f=1", "display_name": "user4563174", "link": "https://stackoverflow.com/users/4563174/user4563174"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 35466766, "answer_count": 1, "score": 0, "last_activity_date": 1455739878, "creation_date": 1455739523, "question_id": 35466662, "link": "https://stackoverflow.com/questions/35466662/run-event-macro-from-a-particular-sub", "title": "Run Event Macro from a particular Sub", "body": "<p>I have a module with a lot of sub's:</p>\n\n<pre><code>Sub a1\nSub a2\nSub a3\n...\nSub a10\n</code></pre>\n\n<p>And in the worksheet, I have a Event Macro: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n...\nEnd Sub\n</code></pre>\n\n<p>Sub a1 to a9 makes changes in the worksheet (add columns, change values...)</p>\n\n<p>I wish that the event macro starts to work when a1-a9 it will be done (only for a10).\nIs this posible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455736553, "post_id": 35465571, "comment_id": 58626988, "body": "In mine I just say MkDir Path"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455736743, "post_id": 35465571, "comment_id": 58627115, "body": "I&#39;d start by putting the result of path into explorer and see if it pulls up the file"}, {"owner": {"reputation": 583, "user_id": 5942174, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1638f64a483b158f18d1d085a8b1b140?s=128&d=identicon&r=PG&f=1", "display_name": "basaltanglia", "link": "https://stackoverflow.com/users/5942174/basaltanglia"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455736944, "post_id": 35465571, "comment_id": 58627225, "body": "Note that this doesn&#39;t happen on every entry, just some (seem to be the same cells each time, but often they&#39;re the exact same String being used as one that DOES work!).Only SOME are causing the &quot;no path&quot; BS. And the Path is sometimes there, sometimes not, when the error throws; the ones I actually want it to trigger on WOULDN&#39;T exist by definition however."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1455738276, "post_id": 35465571, "comment_id": 58628132, "body": "Using <code>Call</code> makes no difference whatsoever. It&#39;s just an obsolete keyword."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1455738987, "last_edit_date": 1455738987, "creation_date": 1455738496, "answer_id": 35466320, "question_id": 35465571, "link": "https://stackoverflow.com/questions/35465571/mkdir-not-accepting-variable-argument-excel-vba/35466320#35466320", "title": "MkDir not accepting variable argument (EXCEL-VBA)", "body": "<p>This works for me:</p>\n\n<pre><code>Sub ytrewq()\n    Dim s As String, s2 As String\n\n    s = \"C:\\TestFolder\\zzzz\\\"\n    On Error Resume Next\n        MkDir s\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>Examine the argument to <em>Dir()</em> before using it.</p>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 5942174, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1638f64a483b158f18d1d085a8b1b140?s=128&d=identicon&r=PG&f=1", "display_name": "basaltanglia", "link": "https://stackoverflow.com/users/5942174/basaltanglia"}, "is_accepted": true, "score": 0, "last_activity_date": 1456328436, "last_edit_date": 1456328436, "creation_date": 1455743423, "answer_id": 35467826, "question_id": 35465571, "link": "https://stackoverflow.com/questions/35465571/mkdir-not-accepting-variable-argument-excel-vba/35467826#35467826", "title": "MkDir not accepting variable argument (EXCEL-VBA)", "body": "<p>My problem was that some of my input strings contained illegal characters under windows file system rules, I just turned them into spaces with Replace() and the problem resolved (This worked as a function or a sub)</p>\n\n<pre><code>      Function Replacement(Clean As String)\n           Clean = Replace(Clean, Chr(10), \" \")\n           Clean = Replace(Clean, Chr(13), \" \")\n           Clean = Replace(Clean, Chr(13) &amp; Chr(10), \" \")\n           Clean = Replace(Clean, \"?\", \" \")\n           Clean = Replace(Clean, \"/\", \" \")\n           Clean = Replace(Clean, \"\"\"\", \" \")\n           Clean = Replace(Clean, \":\", \" \")\n           Clean = Replace(Clean, \"&lt;\", \" \")\n           Clean = Replace(Clean, \"&gt;\", \" \")\n           Clean = Replace(Clean, \"|\", \" \")\n           Clean = Replace(Clean, \"*\", \" \")\n           Replacement = Clean\n      End Function\n</code></pre>\n\n<p>Thanks for your help (There's probably a better way to Replace() across all of those with some regex, but [] weren't working in my Replace() statements)</p>\n\n<p>EDIT NOTE: To get best results, I added the Chr10/13/10&amp;13 lines to remove various kinds of line-return metamarks, they are also disallowed in Windows directory names.</p>\n"}], "owner": {"reputation": 583, "user_id": 5942174, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1638f64a483b158f18d1d085a8b1b140?s=128&d=identicon&r=PG&f=1", "display_name": "basaltanglia", "link": "https://stackoverflow.com/users/5942174/basaltanglia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "accepted_answer_id": 35467826, "answer_count": 2, "score": 0, "last_activity_date": 1456328436, "creation_date": 1455736190, "last_edit_date": 1495542668, "question_id": 35465571, "link": "https://stackoverflow.com/questions/35465571/mkdir-not-accepting-variable-argument-excel-vba", "title": "MkDir not accepting variable argument (EXCEL-VBA)", "body": "<p>Someone else asked a similar but distinct <a href=\"https://stackoverflow.com/questions/20661393/excel-vba-mkdir-returns-path-not-found-when-using-variable\">question.</a>\nBut their methods did not work for me.</p>\n\n<p>I am writing a Sub to iterate over a list, turning the plaintext into hyperlinks based on the cell contents. It just appends the String \"CellContents\" to the end of a Constant \"MyPath\".</p>\n\n<p>I wrote an If statement to make the linked directory if it doesn't exist, but I am getting myriad errors when I introduce it. The usual one at the moment is \"Error 76: path not found\".</p>\n\n<pre><code>            Path = Trim(MyPath &amp; CellContents &amp; \"\\\")\n            If Dir(Path, vbDirectory) = \"\" Then\n                Call MkDir(Path)\n            End If\n</code></pre>\n\n<p>I've also tried</p>\n\n<pre><code>             If Dir(Path, vbDirectory) = \"\" Then\n                MkDir Path\n             End If\n</code></pre>\n\n<p>I know for certain that the containing folder exists, and I've tried using Call MkDir and MkDir alone. I've also tried Trim()/no Trim() on Path, which does not solve it (and the inputs are strings so Str() causes its own error). I've also tried Len(Dir(Path)=0 in the conditional, none of which helps MkDir recognize that Path is a valid path! Why is it not being recognized correctly?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1455736553, "post_id": 35465631, "comment_id": 58626989, "body": "This is the best answer possible; the function is purpose-built in Excel for exactly this calculation."}, {"owner": {"reputation": 383, "user_id": 5639779, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/gvFHH.png?s=128&g=1", "display_name": "theteague", "link": "https://stackoverflow.com/users/5639779/theteague"}, "edited": false, "score": 0, "creation_date": 1455736632, "post_id": 35465631, "comment_id": 58627043, "body": "May you be blessed with a plentiful supply of great beer, frequent hugs and general happiness for you and your family."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 383, "user_id": 5639779, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/gvFHH.png?s=128&g=1", "display_name": "theteague", "link": "https://stackoverflow.com/users/5639779/theteague"}, "edited": false, "score": 0, "creation_date": 1455736717, "post_id": 35465631, "comment_id": 58627096, "body": "@bteague in a few minutes you will be able to mark this as correct by clicking the green check mark by the answer.  It is something only you can do.  Please come back and do so.  It will mark this question as answered."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1455736586, "last_edit_date": 1455736586, "creation_date": 1455736400, "answer_id": 35465631, "question_id": 35465524, "link": "https://stackoverflow.com/questions/35465524/excel-formula-or-vba-to-calculate-remaining-interest-on-loan-mid-term/35465631#35465631", "title": "Excel Formula (or VBA) to Calculate Remaining Interest on Loan mid-term", "body": "<p>You would use the <a href=\"https://support.office.com/en-us/article/CUMIPMT-function-61067bb0-9016-427d-b95b-1a752af0e606\" rel=\"nofollow\">CUMIPMT() Function</a></p>\n\n<pre><code>=CUMIPMT(0.0299/12,48,30000,21,48,0)\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 5639779, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/gvFHH.png?s=128&g=1", "display_name": "theteague", "link": "https://stackoverflow.com/users/5639779/theteague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 35465631, "answer_count": 1, "score": 1, "last_activity_date": 1466065532, "creation_date": 1455736062, "last_edit_date": 1466065532, "question_id": 35465524, "link": "https://stackoverflow.com/questions/35465524/excel-formula-or-vba-to-calculate-remaining-interest-on-loan-mid-term", "title": "Excel Formula (or VBA) to Calculate Remaining Interest on Loan mid-term", "body": "<p>Good afternoon!</p>\n\n<p>I have 13000 loan records. My sheet has the following headers\n| OrigLoanAmt | RemainingBalance | OrigLoanTermInMonths | RemainingTermInMonths | RegularMonthlyPmt | InterestRate |</p>\n\n<p>What is a formula or VBA that will take the information I have, throw it into an amortization table, look at the current loan period, and output the total remaining interest scheduled on a loan assuming the borrower has made, and will continue to make, the minimum monthly payment for the entire term?</p>\n\n<p>Example: 19 months ago I borrowed $30,000 on a 48 month term with a 2.99% rate. After I make my next payment, my new balance will be $17,933.87. From that point, per the amortization schedule, I will still have $655.19 interest to pay over the remaining 28 months.</p>\n\n<p>So, my question restated would be: What formula, or VBA script, could I use to calculate that $655 figure for 13,000 loan records?</p>\n\n<p>Thank you very much for your consideration on this issue!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1455736813, "post_id": 35465034, "comment_id": 58627151, "body": "Have you tried recording a macro to see what code gets generated when you do it manually?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1455739897, "post_id": 35465034, "comment_id": 58629173, "body": "Just curious, are the links Hyperlinks? Would it be better to loop through the pics and delete the hyperlinks?  This is using the macro recorder to delete hyperlink for one pic...<code>ActiveSheet.Shapes.Range(Array(&quot;Picture 1&quot;)).Select: Selection.ShapeRange.Item(1).Hyperlink.Delete</code> You would just need to loop through the pics using this method. If that is the links you are referring to."}], "owner": {"reputation": 203, "user_id": 3837438, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ed0a2a24d198fa1448b1fc2c65d40b86?s=128&d=identicon&r=PG&f=1", "display_name": "spaindc", "link": "https://stackoverflow.com/users/3837438/spaindc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455783282, "creation_date": 1455734585, "last_edit_date": 1455783282, "question_id": 35465034, "link": "https://stackoverflow.com/questions/35465034/paste-pictures-as-non-links-and-retain-their-location", "title": "Paste pictures as non-links and retain their location", "body": "<p>I have a sheet with many pictures, but the pictures are links and I need to send the file outside our company, to someone who won't have access to the link location. </p>\n\n<p>I am trying to write code to paste the images as non-links and retain their current location in the excel sheet. </p>\n\n<p>The following code fails on the .<strong><code>PasteSpecial</code></strong> line. </p>\n\n<pre><code>Sub test()\nDim Pic As Shape,Lt As Double, Tp As Double\nFor Each Pic In ActiveSheet.Shapes\n\n   Lt = Pic.Left\n   Tp = Pic.Top\n   Pic.Cut\n\n   ActiveSheet.PasteSpecial Format:=\"Picture (JPEG)\", Link:=False, _\n        DisplayAsIcon:=False\n\n        Selection.Top = Tp\n        Selection.Left = Lt\n\n    Selection.Placement = xlMoveAndSize\n\nNext Pic\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455731368, "post_id": 35463923, "comment_id": 58623907, "body": "does this work <code>(&quot;=INDEX(Offset(A:A,0,5+i),(MATCH...</code> added 5 because the offset function will already consider column A as 1."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455731648, "post_id": 35463923, "comment_id": 58624075, "body": "@ScottHoltzman the I will need to be removed from the quotes as it is VBA not worksheet function."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455732741, "post_id": 35463923, "comment_id": 58624707, "body": "good point out @ScottCraner"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1455733600, "post_id": 35463923, "comment_id": 58625204, "body": "See methods to do that generally [convert letters to numbers] here: <a href=\"http://stackoverflow.com/q/10106465/5090027\">stackoverflow.com/q/10106465/5090027</a>"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455738491, "post_id": 35463923, "comment_id": 58628269, "body": "@ScottHoltzman It didn&#39;t work, I get &quot;?NAME&quot; as a result."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455738797, "post_id": 35463923, "comment_id": 58628470, "body": "The problem is the 5+i part, I tried (&quot;=INDEX(Offset(A:A,0,6),(MATCH... to see if it works, and it did, I got the value I was looking for... any ideas on how to fix it?"}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455742668, "post_id": 35466495, "comment_id": 58630759, "body": "do you happen to come up with a faster way to look up values meeting several criteria in a sheet than this method?"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455744387, "post_id": 35466495, "comment_id": 58631695, "body": "I&#39;ve never used evaluate in the way you do, so to-be-honest I do not properly understand what the code is doing. I do know that the fastest structures to use in vba are arrays: can you please add more of an explanation to your original question so I can understand what the code needs to do."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455813301, "post_id": 35466495, "comment_id": 58667686, "body": "Done, take a look at the post"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455813633, "post_id": 35466495, "comment_id": 58667933, "body": "still confused! Say in A2:A4 we have | 1 | 1 | 2 | 3 | then what should show in A5? Or say in B2:B4 we have | 11 | 7 | 11 | 7 | then what should show in B5?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455816686, "post_id": 35466495, "comment_id": 58670013, "body": "anything, in that table there could be anything... I just want to get the values from that table... the values that match the conditions that I&#39;m looking for... like a VLOOKUP, but with multiple criteria"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1455817697, "post_id": 35466495, "comment_id": 58670610, "body": "well you could load all the values in the range(&quot;A1:D234999&quot;) into a variant array in vba; then you could loop through that array testing your conditions...and adding the answers into a second, initially empty, variant array. Once the loop is finished the array is added to the answer sheet. Have a play and then ask another SO question - mention speed and variant arrays and you should get lots of help. Please post a link back here as I&#39;ll be interested."}], "tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": true, "score": 1, "last_activity_date": 1455739040, "last_edit_date": 1495539901, "creation_date": 1455739040, "answer_id": 35466495, "question_id": 35463923, "link": "https://stackoverflow.com/questions/35463923/columns-as-numbers-in-evaluate-function/35466495#35466495", "title": "Columns as numbers in Evaluate function", "body": "<p>Can you not just make the string dynamic?</p>\n\n<p>As is:<br>\n <code>\"...=INDEX(6+i,(MATCH(1,...\"</code></p>\n\n<p>New version:<br>\n <code>\"...=INDEX(\" &amp; Col_Letter(6+i)) &amp; \":\" &amp;  Col_Letter(6+i)) &amp; \",(MATCH(1,...\"</code></p>\n\n<p>Use this to get the letter. It is from this SO post <a href=\"https://stackoverflow.com/questions/12796973/function-to-convert-column-number-to-letter\">Function to convert column number to letter?</a></p>\n\n<pre><code>Function Col_Letter(lngCol As Long) As String\nDim vArr\nvArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\nCol_Letter = vArr(0)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 35466495, "answer_count": 1, "score": 0, "last_activity_date": 1455803655, "creation_date": 1455730955, "last_edit_date": 1455803655, "question_id": 35463923, "link": "https://stackoverflow.com/questions/35463923/columns-as-numbers-in-evaluate-function", "title": "Columns as numbers in Evaluate function", "body": "<p>I would like to use the following code in vba:</p>\n\n<pre><code>Dim negocio As String\nDim feeder As String\nDim origenAWB As String\nDim destinoAWB As String\n\nSet WS = ActiveSheet\n\nnegocio = Cells(6, 6).Value\nfeeder = Cells(8, 6).Value\norigenAWB = Cells(10, 6).Value\ndestinoAWB = Cells(12, 6).Value\n\nFor i = 1 To 53\n    WS.Cells(24, 1 + i) _\n       = Sheets(\"Proyeccion\").Evaluate(\"=INDEX(6+i,(MATCH(1,(B:B=\"\"\" &amp; negocio &amp; \"\"\") * (C:C=\"\"\" &amp; feeder &amp; \"\"\") * (D:D=\"\"\" &amp; origenAWB &amp; \"\"\") * (E:E=\"\"\" &amp; destinoAWB &amp; \"\"\"),0))\")\nNext i\n</code></pre>\n\n<p>For the INDEX part, I need to get the value of the 6+i th column, but I don't know how to do it, since columns are labeled with letters. </p>\n\n<p>What I need to do is to find values that match multiple criteria in a \"table\". For example, if I have the following table:</p>\n\n<pre><code>   A    B   C   D   E\n1  a1  a2  a3  a4  a5\n2  b1  b2  b3  b4  b5\n3  .   .            .\n4  .   .            .\n5  .   .            .\n. \n.\n.\n</code></pre>\n\n<p>I need the get the value in column E that match the values in columns A, B, C and D. For example, for values a1, a2, a3 and a4 I should get a5. All this, using VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 8, "creation_date": 1455730052, "post_id": 35463594, "comment_id": 58623088, "body": "<code>Selection</code> is a range object that refers to the range that is currently selected."}, {"owner": {"reputation": 13, "user_id": 5941804, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206018440320219/picture?type=large", "display_name": "Alessandra Midori", "link": "https://stackoverflow.com/users/5941804/alessandra-midori"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455730226, "post_id": 35463594, "comment_id": 58623207, "body": "Perfect! it works, thanks"}], "owner": {"reputation": 13, "user_id": 5941804, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206018440320219/picture?type=large", "display_name": "Alessandra Midori", "link": "https://stackoverflow.com/users/5941804/alessandra-midori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5777, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1581015554, "creation_date": 1455729983, "last_edit_date": 1581015554, "question_id": 35463594, "link": "https://stackoverflow.com/questions/35463594/vba-use-active-range-of-cells-as-reference", "title": "VBA - use active range of cells as reference", "body": "<p>I want to use a macro, but instead of using it in the <code>ActiveCell</code> I want it to be a range of cells I've selected (but they are not specific). How do I do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455730744, "post_id": 35463525, "comment_id": 58623524, "body": "Why not use formulas? <code>=IF(OR(H2=1,H2=-1),1,G1+1)</code>"}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455731474, "post_id": 35463525, "comment_id": 58623970, "body": "This logic will be used for a more complex formula later on. Row(A1) is a bit of a holding formula."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1455732994, "post_id": 35463525, "comment_id": 58624856, "body": "<i>This logic will be used for a more complex formula later on.</i> The idea of autofilling whole range with complex formula multiple times in a loop doesn&#39;t look like a good approach. For me it&#39;s XY problem."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455731403, "post_id": 35463851, "comment_id": 58623928, "body": "Hi Scott, thanks for the reply. Still giving me #REF! for those cells minus the last one."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455731720, "post_id": 35463851, "comment_id": 58624131, "body": "see my results. that is what I got when I ran the code in my answer as is."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455732222, "post_id": 35463851, "comment_id": 58624426, "body": "I tried it on a completely new spreadsheet with that data in columns G and H but I got a different result. Your code seems correct but I don&#39;t understand why I am getting all these #REF! results. Added updated picture"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455732453, "post_id": 35463851, "comment_id": 58624548, "body": "@AltoidsBenefitsH - see my 2nd piece of code in my answer. it&#39;s much simpler and will work as well."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455732774, "post_id": 35463851, "comment_id": 58624731, "body": "I am still new to VBA programming, is there problems with code across versions? The new code and the original code seems to not be behaving well.. the new code goes up to the first row and starts running."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455732862, "post_id": 35463851, "comment_id": 58624776, "body": "@AltoidsBenefitsH - the problem is <code>endRow</code> you are evaluating it based on the last data point in column B. If you are using a testing sheet and column B is blank <code>endrow</code> will equal 1. Adjust for this and it will work. For example, use column H instead."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1455732980, "post_id": 35463851, "comment_id": 58624848, "body": "That fixed it! Thank-you so much for your time sir"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1455732417, "last_edit_date": 1495535427, "creation_date": 1455730771, "answer_id": 35463851, "question_id": 35463525, "link": "https://stackoverflow.com/questions/35463525/errors-with-autofilling-equations-vba/35463851#35463851", "title": "Errors with AutoFilling Equations VBA", "body": "<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid using Select in and ActiveCell</a> (unless absolutely necessary).</p>\n\n<p>Try this code:</p>\n\n<pre><code>Sub Reflector()\n\nDim ws as Worksheet\nSet ws = WOrksheets(\"Sheet1\") 'change as needed\n\nDim i As Integer\nDim endRow As Integer\nendRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n\nFor i = 2 To 40\n\n    If ws.Range(\"H\" &amp; i).Value = \"1\" Or ws.Range(\"H\" &amp; i).Value = \"-1\" Then\n\n        With ws.Range(\"G\" &amp; i)\n            .Formula = \"=ROW(A1)\"\n            .AutoFill Destination:=ws.Range(ws.Range(\"G\"&amp;i),ws.Range(\"G\" &amp; endRow))\n        End With\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>To @ScottCraner's point this bit of code will also work and is easier to read / maintain.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Worksheets(\"Sheet1\") 'change as needed\n\nDim endRow As Long\nendRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n\nWith ws.Range(\"G2:G\" &amp; endRow)\n    .FormulaR1C1 = \"=IF(OR(RC[1]=1,RC[1]=-1),1,R[-1]C+1)\"\nEnd With\n</code></pre>\n\n<p>Screenshot of tested code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ljMTA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ljMTA.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 35463851, "answer_count": 1, "score": 1, "last_activity_date": 1455735197, "creation_date": 1455729772, "last_edit_date": 1531161705, "question_id": 35463525, "link": "https://stackoverflow.com/questions/35463525/errors-with-autofilling-equations-vba", "title": "Errors with AutoFilling Equations VBA", "body": "<pre><code>Sub Reflector()\n\nDim i As Integer\nDim endRow As Integer\nendRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\nRange(\"G2\").Select\n\nFor i = 2 To 40\n\nRange(\"G\" &amp; i).Select\n\n    If Range(\"H\" &amp; i).Value = \"1\" Or Range(\"H\" &amp; i).Value = \"-1\" Then\n\n    ActiveCell.Formula = \"=ROW(A1)\"\n\n    ActiveCell.AutoFill Destination:=Range(ActiveCell.Address &amp; \":G\" &amp; endRow)\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>What I'd like is for the Macro to check values in column H and keep a tally of times it has NOT -1 or 1 then write that tally in column G. If it hits a value with 1 or -1 in column G, I'd like it to restart the count there.</p>\n\n<p>The process is that I will check Column H and autofill to last row of data and \"bounce back up\" to check the next value and then autofill again if it meets a 1 or -1.</p>\n\n<p>Here is the error I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dl47d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dl47d.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/KMdC4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KMdC4.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729041, "post_id": 35463087, "comment_id": 58622425, "body": "Could mean you don&#39;t have a workbook with that exact name..."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729152, "post_id": 35463087, "comment_id": 58622492, "body": "I do though. I have it saved in my Documents folder, is that a problem?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455729263, "post_id": 35463087, "comment_id": 58622561, "body": "is the workbook open when you run this code? If not, you need to open it first. It doesn&#39;t matter where it&#39;s saved so long as its open."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729389, "post_id": 35463087, "comment_id": 58622631, "body": "Paste this <code>Workbooks(&quot;Book1.xls&quot;).Activate</code> into the Immediate pane in the VB editor and hit enter - what happens ?"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1455729405, "post_id": 35463087, "comment_id": 58622640, "body": "I also have it opened. I opened excel before outlook and vice versa but it&#39;s still not working"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729454, "post_id": 35463087, "comment_id": 58622681, "body": "@TimWilliams Immediate pane? I&#39;m editing this in outlook"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729573, "post_id": 35463087, "comment_id": 58622754, "body": "Outlook doesn&#39;t know anything about <code>Worksheetfunction</code> or <code>Workbooks</code>..."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729576, "post_id": 35463087, "comment_id": 58622756, "body": "@TimWilliams I pasted the code into my code and it&#39;s throwing a Subscript out of range error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729661, "post_id": 35463087, "comment_id": 58622811, "body": "&quot;I&#39;m creating a macro that will go inside a workbook&quot; - make your mind up: are you editing this code in Excel, or in Outlook?  It <i>looks</i> like it belongs in Excel."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729678, "post_id": 35463087, "comment_id": 58622831, "body": "@TimWilliams I added in the reference Microsoft Excel Objects library. Do i have to do more for Worksheetfunction and Workbooks to work?"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455729796, "post_id": 35463087, "comment_id": 58622927, "body": "@TimWilliams Why would it belong in excel? The macro works with outlook and excel"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455729921, "post_id": 35463087, "comment_id": 58623018, "body": "Nowhere in your code do you actually create a reference to Excel - it&#39;s not enough to add the reference in the VBproject, you actually need an instance of excel to work with.   <a href=\"http://www.mrexcel.com/forum/excel-questions/408511-controlling-excel-through-outlook-visual-basic-applications-range-pasting-problems.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455730194, "post_id": 35463087, "comment_id": 58623184, "body": "@TimWilliams Ok i understand you now. I created an outlook object which is why it &quot;looks&quot; like it belongs in excel. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 2046, "user_id": 3775431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/u3ZuC.jpg?s=128&g=1", "display_name": "bvmcode", "link": "https://stackoverflow.com/users/3775431/bvmcode"}, "is_accepted": false, "score": 1, "last_activity_date": 1455731543, "last_edit_date": 1455731543, "creation_date": 1455730262, "answer_id": 35463692, "question_id": 35463087, "link": "https://stackoverflow.com/questions/35463087/subscript-out-of-range-when-trying-to-get-number-of-entries-in-column/35463692#35463692", "title": "Subscript out of range when trying to get number of entries in column", "body": "<p>try this loop instead, assuming the email addresses start at row 2. Set up excel objects first</p>\n\n<pre><code>'setup excel objects\nDim xlApp As Object\nDim WB As Workbook\nDim WS As Worksheet\nSet xlApp = CreateObject(\"Excel.Application\")\nSet WB = Workbooks.Open(\"C:\\Users\\me\\Desktop\\Book1.xlsx\")\nSet WS = WB.Worksheets(\"Sheet1\")\nWB.Activate\n\n'loop through ColA to merge email addresses\nDim last As Long\nlast = WS.Range(\"A1\").CurrentRegion.Rows.Count\nSDest = \"\"\nFor i = 2 To last\n    SDest = SDest + Range(\"A\" &amp; i).Value &amp; \";\"\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "is_accepted": false, "score": 1, "last_activity_date": 1455730965, "creation_date": 1455730965, "answer_id": 35463929, "question_id": 35463087, "link": "https://stackoverflow.com/questions/35463087/subscript-out-of-range-when-trying-to-get-number-of-entries-in-column/35463929#35463929", "title": "Subscript out of range when trying to get number of entries in column", "body": "<p>Fixed the error and got it working (Thank you Tim). I did not add an excel object and the file name was incorrect which is why it kept throwing the out of bounds error. This is my new code:</p>\n\n<pre><code>Public Sub emailList()\n   'Setting up the Excel variables.\n   Dim olApp As Object\n   Dim olMailItm As Object\n   Dim iCounter As Integer\n   Dim Dest As Variant\n   Dim SDest As String\n   Dim Excel As Object\n\n   'Create the Outlook application and the empty email.\n   Set olApp = CreateObject(\"Outlook.Application\")\n   Set olMailItm = olApp.CreateItem(0)\n\n      'Create excel object.\n   Set Excel = CreateObject(\"excel.application\")\n   Excel.Visible = True\n   Excel.Workbooks.Open (\"C:\\Users\\Deryl Lam\\Documents\\Book1.xlsx\")\n   Excel.Workbooks(\"Book1.xlsx\").Activate\n\n   'Using the email, add multiple recipients, using a list of addresses in column A.\n   With olMailItm\n       SDest = \"\"\n       For iCounter = 1 To WorksheetFunction.CountA(Workbooks(\"Book1.xlsx\").Sheets(1).Columns(1))\n           If SDest = \"\" Then\n               SDest = Cells(iCounter, 1).Value\n           Else\n               SDest = SDest &amp; \";\" &amp; Cells(iCounter, 1).Value\n           End If\n       Next iCounter\n\n    'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.\n       .BCC = SDest\n       .Subject = \"FYI\"\n       .Body = ActiveSheet.TextBoxes(1).Text\n       .Send\n   End With\n\n   'Clean up the Outlook application.\n   Set olMailItm = Nothing\n   Set olApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455731543, "creation_date": 1455728592, "question_id": 35463087, "link": "https://stackoverflow.com/questions/35463087/subscript-out-of-range-when-trying-to-get-number-of-entries-in-column", "title": "Subscript out of range when trying to get number of entries in column", "body": "<p>I'm new to VBA and I've come across an error that doesn't make sense to me. I'm creating a macro that will go inside a workbook and take all the entries in the first column and create an email using the entries as email addresses. This is my code:</p>\n\n<pre><code>Public Sub emailList()\n   'Setting up the Excel variables.\n   Dim olApp As Object\n   Dim olMailItm As Object\n   Dim iCounter As Integer\n   Dim Dest As Variant\n   Dim SDest As String\n\n   'Create the Outlook application and the empty email.\n   Set olApp = CreateObject(\"Outlook.Application\")\n   Set olMailItm = olApp.CreateItem(0)\n\n   'Using the email, add multiple recipients, using a list of addresses in column A.\n   With olMailItm\n       SDest = \"\"\n       For iCounter = 1 To WorksheetFunction.CountA(Workbooks(\"Book1.xls\").Sheets(1).Columns(1))\n           If SDest = \"\" Then\n               SDest = Cells(iCounter, 1).Value\n           Else\n               SDest = SDest &amp; \";\" &amp; Cells(iCounter, 1).Value\n           End If\n       Next iCounter\n\n    'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.\n       .BCC = SDest\n       .Subject = \"FYI\"\n       .Body = ActiveSheet.TextBoxes(1).Text\n       .Send\n   End With\n\n   'Clean up the Outlook application.\n   Set olMailItm = Nothing\n   Set olApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>The line that says: </p>\n\n<pre><code>For iCounter = 1 To WorksheetFunction.CountA(Workbooks(\"Book1.xls\").Sheets(1).Columns(1))\n</code></pre>\n\n<p>is throwing a Subscript Out Of Range error but i have three entries in column 1 so I dont see why it's throwing an out of bounds error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455729704, "post_id": 35462972, "comment_id": 58622850, "body": "why not use built Excel functions inside the vba. Specifically. Advanced Filter &gt; Copy Unique Values for Column G, then count the unique values. Why make life harder when you don&#39;t have to?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5914757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1072449819443816/picture?type=large", "display_name": "Frederik Munck Bigom", "link": "https://stackoverflow.com/users/5914757/frederik-munck-bigom"}, "edited": false, "score": 0, "creation_date": 1455789163, "post_id": 35463088, "comment_id": 58650047, "body": "Thanks a lot! Yes minor typo with 1+1, i actually meant i+1 :)."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1455728595, "creation_date": 1455728595, "answer_id": 35463088, "question_id": 35462972, "link": "https://stackoverflow.com/questions/35462972/compare-each-and-every-cell-in-a-colum-by-custom-macro-unhandy-for-loop/35463088#35463088", "title": "Compare each and every cell in a colum by custom macro (unhandy for loop)", "body": "<p>Try this:</p>\n\n<pre><code>Sub findidentical()\n\nDim i As Integer\nDim j As Integer\nDim x As Integer\nDim ColumnG As Integer\n\nx = 0\nColumnG = Application.WorksheetFunction.CountA(Range(\"G:G\"))\n'ColumnG is 14K cells long'\nFor i = 2 To ColumnG\n    For j = i + 1 To ColumnG\n        If Cells(i, 7).Value = Cells(j, 7).Value Then\n            x = x + 1\n            Cells(i, 7).Font.Bold = True\n            Cells(j, 7).Font.Bold = True\n        End If\n    Next j\nNext i\n\nRange(\"L25\").Text = \"Amount of duplicates\"\nRange(\"L26\").Value = x\n\nEnd Sub\n</code></pre>\n\n<p>First you need to make each command in the if statement its own line or separate them with <code>:</code> instead of <code>&amp;</code>.  <code>&amp;</code> is a string concatenation not a command separator.</p>\n\n<p>Second there is no reason to start Loop j at 2 it has already been compared to everything above.  So start it at <code>i+1</code></p>\n"}], "owner": {"reputation": 15, "user_id": 5914757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1072449819443816/picture?type=large", "display_name": "Frederik Munck Bigom", "link": "https://stackoverflow.com/users/5914757/frederik-munck-bigom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 35463088, "answer_count": 1, "score": 0, "last_activity_date": 1455728595, "creation_date": 1455728226, "last_edit_date": 1531161705, "question_id": 35462972, "link": "https://stackoverflow.com/questions/35462972/compare-each-and-every-cell-in-a-colum-by-custom-macro-unhandy-for-loop", "title": "Compare each and every cell in a colum by custom macro (unhandy for loop)", "body": "<p>i'm currently trying to compare each and every cell in a column with each other in order to find duplicates. I wrote below code, i know it as possible via default Excel functions, but i would like to write a macro with the above mentioned function. Excel currently doesn't respond when i run my code, my guess is that i run a double for loop with 14K cells to compare is each resulting in 14.000*14.000 loops, which is kinda unhandy. Any help will be appreciated :).</p>\n\n<pre><code>Sub findidentical()\n\nDim i As Integer\nDim j As Integer\nDim x As Integer\nDim ColumnG As Integer\n\nx = 0\nColumnG = Application.WorksheetFunction.CountA(Range(\"G:G\"))\n'ColumnG is 14K cells long'\nFor i = 2 To ColumnG\n    For j = 1 + 1 To ColumnG\n        If Cells(i, 7).Value = Cells(j, 7).Value Then\n            x = x + 1 &amp; Cells(i, 7).Font.Bold = True &amp; Cells(j, 7).Font.Bold = True\n        End If\n    Next j\nNext i\n\nRange(\"L25\").Text = \"Amount of duplicates\"\nRange(\"L26\").Value = x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455733819, "post_id": 35463377, "comment_id": 58625330, "body": "I have read this as well, and even seen the &quot;Two Refresh&quot; trick, but unfortunately it didn&#39;t work. As I stated above, I have already uncheck the &quot;Enable Background Refresh&quot; option, and while this slows it down and allows for the query to refresh, for some reason the table does not refresh."}], "tags": [], "owner": {"reputation": 3165, "user_id": 87464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9156d0b855e89ec91870d67d4df1b499?s=128&d=identicon&r=PG", "display_name": "nvuono", "link": "https://stackoverflow.com/users/87464/nvuono"}, "is_accepted": false, "score": 1, "last_activity_date": 1455729366, "creation_date": 1455729366, "answer_id": 35463377, "question_id": 35462559, "link": "https://stackoverflow.com/questions/35462559/refreshing-tables-with-vba/35463377#35463377", "title": "Refreshing Tables with VBA", "body": "<p>By default Excel will \"Enable Background Refresh\" which will allow Excel to move on and continue execution before the query refresh is actually finished. Some people have been able to get it to work by calling <code>.Refresh</code> twice but it's pretty much random/arbitrary timing.</p>\n\n<p>There should be an Excel option to uncheck in the Data Tables properties or you might be able to update the BackgroundQuery = False property from VBA through a reference to it</p>\n\n<p>If you disable background refreshing then your code will sit and wait for the refresh to complete before moving on.</p>\n"}, {"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1455733884, "post_id": 35463665, "comment_id": 58625379, "body": "I see that you are updating the query table instead of the list object which i think is the solution."}, {"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455736061, "post_id": 35463665, "comment_id": 58626660, "body": "Thanks for the thorough response, but unfortunately this still does not solve my issue. When testing your code, it seems to simply place the name of the city in the Data Table, rather than actually refreshing the table based on the city."}, {"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455737965, "post_id": 35463665, "comment_id": 58627946, "body": "I&#39;ve done some further testing, and I&#39;ve noticed that if I get rid of the loop and hard code 2 cities into VBA like so: <code>ws1.Cells(3, 4).Value = &quot;ARIZONA MESA&quot;</code> and <code>ws1.Cells(3, 4).Value = &quot;CALIFORNIA CARLSBAD&quot;</code>, with a wait in the middle, then it will only update the Data Table based on the last city. The first city is completely ignored."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455743159, "post_id": 35463665, "comment_id": 58631022, "body": "@Jcmoney1010 -- I know this is unconventional, but is there any way you can post your spreadsheet somewhere?  I went ahead and ran this as a little test (admittedly my initial post was not fully tested -- only for syntax), and it works.  I can&#39;t help but think there is a simple fix"}, {"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455746154, "post_id": 35463665, "comment_id": 58632763, "body": "@Hambone unfortunately, I&#39;m not sure I should do that. The data itself has client information that I don&#39;t want to share, and the connection string to my database includes the username and password to our database. If I were to strip out all this information, then I would essentially just be sending you a blank excel worksheet. Could you share your workbook test that worked, and maybe I can reverse engineer it?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1455746743, "post_id": 35463665, "comment_id": 58633055, "body": "That&#39;s a good idea...  okay here is my attempt.  I had to zip it because gdocs kept opening it up in gsheets, and I&#39;m thinking you need to download the file instead.  <a href=\"https://drive.google.com/file/d/0B_ZPaExmpBm0VFFQMGQtZFM3Y1E/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B_ZPaExmpBm0VFFQMGQtZFM3Y1E/&hellip;</a>"}, {"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1455804805, "post_id": 35463665, "comment_id": 58661004, "body": "For some reason It won&#39;t let me open it/download it. Maybe Pictures of what you are doing lol?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1455806382, "post_id": 35463665, "comment_id": 58662247, "body": "At the top center of the page there is an icon of an arrow pointing down to download...  admittedly, I am the document owner, so of course I won&#39;t have issues, and the issue with you not being able to download might be on my end (never done this before).  I&#39;m using Chrome.  I can <i>try</i> to post pictures, but I think it would help if you could F8 through the code and see it a step at a time."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 3, "last_activity_date": 1455730592, "last_edit_date": 1455730592, "creation_date": 1455730205, "answer_id": 35463665, "question_id": 35462559, "link": "https://stackoverflow.com/questions/35462559/refreshing-tables-with-vba/35463665#35463665", "title": "Refreshing Tables with VBA", "body": "<p>There are a couple of things I think you need to do -- maybe you've already done them.</p>\n\n<ol>\n<li>When you set up your parameter/bind variable (which you have done), point it to a specific cell.  Then, within your SQL Server query, make sure the parameter is bound to that range every time:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/AGYE5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AGYE5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Forgive me if I'm overstating the obvious, but for those that don't know you get to this dialog by right-clicking the table and selecting Table->Parameters.</p>\n\n<ol start=\"2\">\n<li>From there, as you iterate through your main table (the one with the cities in it), you can just take the value from each row in that table and update the cell with the binding parameter.</li>\n</ol>\n\n<p>Something like this should work:</p>\n\n<pre><code>Sub RefreshAllCities()\n\n  Dim ws1, ws2 As Worksheet\n  Dim loCities, loDataTable As ListObject\n  Dim lr As ListRow\n\n  Set ws1 = ActiveWorkbook.Worksheets(\"Sheet1\")\n  Set ws2 = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n  Set loCities = ws1.ListObjects(\"CityList\")\n  Set loDataTable = ws2.ListObjects(\"DataTable\")\n\n  ' get rid of those pesky warnings to overwrite files\n  Application.DisplayAlerts = False\n\n  For Each lr In loCities.ListRows\n    ws2.Cells(1, 2).Value = lr.Range(1, 1).Value\n    loDataTable.QueryTable.Refresh BackgroundQuery:=False\n\n    ActiveWorkbook.SaveAs Filename:=\"C:\\temp\\\" &amp; lr.Range(1, 1).Value &amp; \".xlsx\", _\n        FileFormat:= xlOpenXMLWorkbook\n  Next lr\n\n  Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I assume you wanted <code>.xlsx</code> files in this example.  This will clobber any embedded VBA, which is actually a nice bonus, as the recipients of the filtered datasets won't have to be exposed to that.  If you want <code>xlsm</code> or <code>xlsb</code>, that's easy enough to change.</p>\n"}], "owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19110, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1455730592, "creation_date": 1455727047, "question_id": 35462559, "link": "https://stackoverflow.com/questions/35462559/refreshing-tables-with-vba", "title": "Refreshing Tables with VBA", "body": "<p>I have two tables, one with a list of cities( we'll call this City List), and another with data points that correspond with those cities ( Call this The Data Table). The Data Table, is connected to a Select query that I built in MS SQL Server. This Select query/ Data Table has a single <code>Where</code> clause in which I have substituted the SQL criteria and replaced a <code>?</code> in order to make it a parameter when connected to Excel. </p>\n\n<p>Now that I have that out of the way, I'll explain what I'm trying to accomplish. I want to loop through the City List and for each city in the list, update The Data Table to reflect the data points for the city. Ultimately, I would like to loop through and each time The Data Table is refreshed, it saves a copy of the workbook with that specific table.</p>\n\n<p>I have posted my current code down below, but my issue is that the table never refreshes with the current data that corresponds with the city that is currently selected via the loop. With that being said, if I hit the <code>escape</code> key to break out of the VBA macro, the table will then refresh with whatever the last city was before I stopped the macro. </p>\n\n<p>Code:</p>\n\n<pre><code>Sub Macro1()\nDim WS As Worksheet\nDim WS2 As Worksheet\nDim CT As Variant\nDim MSG As String\n\nSet WS = Sheets(\"Sheet1\")\nSet WS2 = Sheets(\"Sheet2\")\nCT = Range(\"A1\").CurrentRegion\nFor i = 2 To UBound(CT, 1)\n    MSG = \"\"\n    For J = 1 To UBound(CT, 2)\n        WS.Range(\"$D$2\").Value = CT(i, J) //Places the city into Cell $D$2 which is where The Data Table looks to for the parameter.\n\n    Exit For\n\n\n    Next J\n\n        ActiveWorkbook.Connections(\"Query from Database\").Refresh\n\n          WS2.ListObjects(1).Refresh\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>It's almost as though the macro is running too fast for the table to catch up and refresh. I've tried adding some wait times into the code, in hopes that it would give it enough time to allow the table to refresh, but that had no affect. I have also turned off <code>Background Refresh</code>, and that doesn't seem to do anything either. Right now it just loops through the city table, and with each city it shows that the query is refreshing, but after the query is finished refreshing, it goes onto the next city without ever updating The Data Table. HELP!</p>\n"}, {"tags": ["ms-access", "vba", "filedialog"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455727315, "post_id": 35462429, "comment_id": 58621303, "body": "It sounds like you want <a href=\"http://stackoverflow.com/a/9477733/77335\">Application.FileDialog</a> Since you want the full path, retrieve <code>.SelectedItems(1)</code> instead of <code>Dir(.SelectedItems(1))</code>"}, {"owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "edited": false, "score": 0, "creation_date": 1455738062, "post_id": 35462429, "comment_id": 58628007, "body": "You should have really Googled this first. I don&#39;t have to look at this to know that it is a duplicate on many, many levels."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "edited": false, "score": 0, "creation_date": 1455789434, "post_id": 35462817, "comment_id": 58650264, "body": "Hi Cisco, just noticed what you said underneath that code. I&#39;ve checked and I have &#39;Microsoft Office 14.0 Object Library&#39; selected. I have the option to move it up in priority as it is currently 4th. Would that make any difference?"}, {"owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "edited": false, "score": 0, "creation_date": 1455789983, "post_id": 35462817, "comment_id": 58650684, "body": "I have enabled &#39;Microsoft Excel 14.0 Object library&#39; and &#39;Microsoft 15 Object Library&#39;. The error now gets past the previous error but now gives &#39;Method or data member not found&#39; with <code>Me.txtFileSelect.RowSource = &quot;&quot;</code>. I&#39;ve double checked the names of the text box and cmd button and they are as shown in the code."}], "tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1455727828, "creation_date": 1455727828, "answer_id": 35462817, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access/35462817#35462817", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>Of course, it is possible to call the file Dialog API in VBA!</p>\n\n<p>An example direct from Microsoft VBA documentation:</p>\n\n<pre><code>Private Sub cmdFileDialog_Click() \n\n   ' Requires reference to Microsoft Office XY.0 Object Library. \n\n   Dim fDialog As Office.FileDialog \n   Dim varFile As Variant \n\n   ' Clear listbox contents. \n   Me.FileList.RowSource = \"\" \n\n   ' Set up the File Dialog. \n   Set fDialog = Application.FileDialog(msoFileDialogFilePicker) \n\n   With fDialog \n\n      ' Allow user to make multiple selections in dialog box \n      .AllowMultiSelect = True \n\n      ' Set the title of the dialog box. \n      .Title = \"Please select one or more files\" \n\n      ' Clear out the current filters, and add our own. \n      .Filters.Clear \n      .Filters.Add \"Access Databases\", \"*.MDB\" \n      .Filters.Add \"Access Projects\", \"*.ADP\" \n      .Filters.Add \"All Files\", \"*.*\" \n\n      ' Show the dialog box. If the .Show method returns True, the \n      ' user picked at least one file. If the .Show method returns \n      ' False, the user clicked Cancel. \n      If .Show = True Then \n\n         'Loop through each file selected and add it to our list box. \n         For Each varFile In .SelectedItems \n            Me.FileList.AddItem varFile \n         Next \n\n      Else \n         MsgBox \"You clicked Cancel in the file dialog box.\" \n      End If \n   End With \nEnd Sub\n</code></pre>\n\n<p>Please note you have to include a reference to Microsoft Office 11.0 Library\n(in code window, select menu option <code>Tools, Reference</code> and select your library for the correct version of your Office Version)</p>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1456182277, "post_id": 35477978, "comment_id": 58819701, "body": "If the compile error highlights <code>Office.FileDialog</code>, you can switch to late binding as described in this answer: <a href=\"http://stackoverflow.com/a/35556719/77335\">&#39;FileDialog&#39; type is not defined in MS Access</a>"}], "tags": [], "owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "is_accepted": false, "score": 0, "last_activity_date": 1455788932, "creation_date": 1455788932, "answer_id": 35477978, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access/35477978#35477978", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>Thanks for the response.</p>\n\n<p>I did google it first and tried everything I came across. I also came across the very set of code pasted above. I Played around with it for a while and whatever I did returned errors. I decided to try the code in Excel instead of Access and it worked straight away. The only thing I could think was that the code wasn't applicable to access. Following all of that I asked the question here.</p>\n\n<pre><code>Private Sub cmdDialog_Click()\n\n   Dim fDialog As Office.FileDialog\n   Dim varFile As Variant\n\n   Me.txtFileSelect.RowSource = \"\"\n\n   Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fDialog\n\n      .AllowMultiSelect = False\n      .Title = \"Please select one or more files\"\n\n      .Filters.Clear\n      .Filters.Add \"Excel Files\", \"*.XLSX\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n\n         For Each varFile In .SelectedItems\n            Me.txtFileSelect.AddItem varFile\n         Next\n\n      Else\n         MsgBox \"You clicked Cancel in the file dialog box.\"\n      End If\n   End With\nEnd Sub\n</code></pre>\n\n<p>With this code I get:\nCompile error;\nUser-defined type not identified</p>\n"}, {"tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1455960041, "last_edit_date": 1455960041, "creation_date": 1455959538, "answer_id": 35521205, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access/35521205#35521205", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>Try this code, for single file:</p>\n\n<pre><code>MyFileURL = aBrowseForFile(\"C:\\users\\\") \n\n\nPublic Function aBrowseForFile(aStartFolder As String) As String\n\n' Needs a reference to Microsoft Office Object Library 15.0\n\nOn Error GoTo Err_txtBrowseForFile\n\nDim fDialog As Office.FileDialog\nDim varfile As Variant\nDim strPath As String\nDim strFilter As String, strFileName As String\nDim Main_Dir As String, DefFolder As String\n\n\nSet fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n\nWith fDialog\n    .InitialView = msoFileDialogViewThumbnail\n    .AllowMultiSelect = False\n    .Title = \"Please select one or more files\"\n    .InitialFileName = aStartFolder\n    .InitialView = msoFileDialogViewThumbnail\n    .Filters.Clear\n    .Filters.Add \"all files\", \"*.*\"\n\n\n     ' Show the dialog box. If the .Show method returns True, the\n     ' user picked at least one file. If the .Show method returns\n     ' False, the user clicked Cancel.\n\n    If .Show = True Then\n         aBrowseForFile = .SelectedItems(1)\n    Else\n        'MsgBox \"You clicked Cancel in the file dialog box.\"\n    End If\n  End With\n\nExit_txtBrowseForFile:\n       Exit Function\n\nErr_txtBrowseForFile:\n       MsgBox Err.Description, vbCritical, \"MyApp\"\n       Resume Exit_txtBrowseForFile\n\n    End Function\n</code></pre>\n\n<p>Put this function in a module, as it is.\nDo not put some other code inside, so you can call it in other projects and build your own tools set.</p>\n\n<p>Call it as shown above in your form.</p>\n\n<p>This code runs well and it is tested.</p>\n\n<p>If you want to check this code, in the debug window type</p>\n\n<pre><code>debug.print aBrowseForFile(\"C:\\users\\\") \n</code></pre>\n\n<p>and see what happens. If you have other run-time or compile errors, please post another question.</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "is_accepted": false, "score": 0, "last_activity_date": 1456495349, "creation_date": 1456495349, "answer_id": 35653729, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access/35653729#35653729", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>Thanks for the response.</p>\n\n<p>I solved the problem in the end, I hadn't selected the object database. I found the following code to work:</p>\n\n<pre><code>Private Sub cmdInput_Click()\n\n   Dim fDialog As Office.FileDialog\n   Dim varFile As Variant\n\n   Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fDialog\n\n      .AllowMultiSelect = False\n      .Title = \"Please select a file\"\n\n      .Filters.Clear\n      .Filters.Add \"Excel Files\", \"*.XLSX\"\n      .Filters.Add \"All Files\", \"*.*\"\n\nIf .Show = True Then\n\nFor Each varFile In .SelectedItems\n\n    DoCmd.TransferSpreadsheet acImport, 10, \"InputData\", varFile, True, \"\"\n    Beep\n\n    MsgBox \"Import Complete!\", vbExclamation, \"\"\n\nNext\nElse\n         MsgBox \"You clicked Cancel in the file dialog box.\"\nEnd If\n\n   End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11803935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sbbII2kqvto/AAAAAAAAAAI/AAAAAAAABK4/WWHLUavD-M8/photo.jpg?sz=128", "display_name": "Manuel Victorio", "link": "https://stackoverflow.com/users/11803935/manuel-victorio"}, "is_accepted": false, "score": 1, "last_activity_date": 1563477205, "last_edit_date": 1563477205, "creation_date": 1563464405, "answer_id": 57098206, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access/57098206#57098206", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>This code and worked for me:</p>\n\n<pre><code>Private Sub Comando32_Click()\n    Dim f As Object\n    Dim strFile As String\n    Dim strFolder As String\n    Dim varItem As Variant\n\n    Set f = Application.FileDialog(3)\n    f.AllowMultiSelect = False\n\n    If f.Show Then\n        For Each varItem In f.SelectedItems\n            strFile = Dir(varItem)\n            strFolder = Left(varItem, Len(varItem) - Len(strFile))\n            MsgBox \"Folder: \" &amp; strFolder &amp; vbCrLf &amp; _\n                \"File: \" &amp; strFile\n            Me.certidao.Value = varItem\n        Next\n    End If\n    Set f = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6852, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1594567896, "creation_date": 1455726678, "last_edit_date": 1594567896, "question_id": 35462429, "link": "https://stackoverflow.com/questions/35462429/how-to-use-filedialogbox-to-save-filepath-in-string-using-vba-in-access", "title": "How to use filedialogbox to save filepath in string, using VBA, in Access", "body": "<p>I have an Access file which I will be using for quality assurance of data.</p>\n\n<p>I will be inputting data from three Excel files, each into its own Access table.</p>\n\n<p>At present, I have three buttons and corresponding text boxes. I manually enter the file path and name into the text box, click the button and it completes the rest of my macro, importing the data.</p>\n\n<p>Instead of having to manually input the file path and name into the text box, I'd like to use the file picker dialog box to populate the textbox with the path.</p>\n\n<p>Is this possible in Access?</p>\n\n<p>Thank you in advance for your help.</p>\n\n<p>Adam</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455727027, "post_id": 35462275, "comment_id": 58621110, "body": "@Grade&#39;Eh&#39;Bacon - your possible duplicate is written in <a href=\"https://stackoverflow.com/questions/tagged/c%23\">c#</a>. That said, there is surely a duplicate VBA question on SO. OP - see <code>Find</code> excel formula. No need for VBA for this at all."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1455727145, "post_id": 35462275, "comment_id": 58621196, "body": "it seems that all of the string preceeding the part of your interest is constant and always the same ... so you may want to use the search/replace function to search for that constant part and replace it by an empty string."}], "answers": [{"tags": [], "owner": {"reputation": 15496, "user_id": 5792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8b7f62698a5d33a0bf49f47118d32b?s=128&d=identicon&r=PG&f=1", "display_name": "Dave2e", "link": "https://stackoverflow.com/users/5792244/dave2e"}, "is_accepted": false, "score": 0, "last_activity_date": 1455733263, "creation_date": 1455733263, "answer_id": 35464642, "question_id": 35462275, "link": "https://stackoverflow.com/questions/35462275/extracting-bits-of-data-to-make-an-excel-graph/35464642#35464642", "title": "Extracting bits of data to make an Excel graph", "body": "<p>If you are only looking part after the underscore try this bit of code:</p>\n\n<pre><code> Sub Macro1()\n     mystring = Cells(1, 1)\n     mytitle = Right(mystring, Len(mystring) - InStr(mystring, \"_\"))\n End Sub\n</code></pre>\n\n<p>This will extract the part of the string after the dash.  Be careful the InStr function will return 0 if the the \"_\" is not found in the original string.  I will let you modify the cell reference and the error checking.</p>\n\n<p>To use this function in the worksheet and not in the VBA function replace the \"InStr\" with the \"FIND\" function.  This is one of the mismatches between the workbook and VBA.</p>\n"}], "owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455733263, "creation_date": 1455726293, "last_edit_date": 1531164843, "question_id": 35462275, "link": "https://stackoverflow.com/questions/35462275/extracting-bits-of-data-to-make-an-excel-graph", "title": "Extracting bits of data to make an Excel graph", "body": "<p>I have several columns populated with data and they have headings as follows:</p>\n\n<pre><code>RP hEPO Gradient Elution Optimization004:10_Cond\nRP hEPO Gradient Elution Optimization004:10_pH\nRP hEPO Gradient Elution Optimization004:10_Pressure\n</code></pre>\n\n<p>This is raw data and I am not creating these titles. I am interested in the last bit of it: Cond, pH, and Pressure. I want to create a graph with conductivity, pH and pressure and I want my program to be able to identify the correct column for the plot labels.  Is there a way to search for \"Cond\" within that cell so I can use it in an <code>if</code> function or something?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 3, "creation_date": 1455725367, "post_id": 35461795, "comment_id": 58619893, "body": "You should show your attempt at a loop - because your question right now is basically just &quot;how do I loop in VBA&quot;, and if you type that into google or this site, you will find many answers."}], "answers": [{"comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 1, "creation_date": 1455725587, "post_id": 35461978, "comment_id": 58620058, "body": "you&#39;re too quick ...I&#39;d got this far <code>for x = 2 to 10...</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1455725503, "creation_date": 1455725503, "answer_id": 35461978, "question_id": 35461795, "link": "https://stackoverflow.com/questions/35461795/creating-a-loop-to-compare-two-cells-in-excel/35461978#35461978", "title": "Creating a Loop to Compare two cells in Excel", "body": "<p>Here is a typical loop:</p>\n\n<pre><code>Public Sub Practice1()\n    Dim UpLim As Double, LowLim As Double\n    Dim outcome As String, i As Long\n    For i = 2 To 10\n        UpLim = Range(\"d\" &amp; i).Value\n        LowLim = Range(\"j\" &amp; i).Value\n\n\n        If UpLim &gt; LowLim Then\n            result = \"Headroom\"\n\n        Else\n            result = \"NoHeadroom\"\n        End If\n\n        Range(\"e\" &amp; i).Value = result\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Pick the <strong>i</strong> limits to suit your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 0, "last_activity_date": 1455725690, "creation_date": 1455725690, "answer_id": 35462052, "question_id": 35461795, "link": "https://stackoverflow.com/questions/35461795/creating-a-loop-to-compare-two-cells-in-excel/35462052#35462052", "title": "Creating a Loop to Compare two cells in Excel", "body": "<p>Slight alternative approach</p>\n\n<pre><code>Public Sub Practice1()\n\n    dim result as string\n    dim x as integer\n    for x = 2 to 10\n      If (cells(x,4) &gt; cells(x,10)) Then\n          cells(x,5)= \"Headroom\"\n      Else\n          cells(x,5)= \"NoHeadroom\"\n      End If\n    next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5941419, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1167da0e87c78c55d19a168dc399a49b?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie2145", "link": "https://stackoverflow.com/users/5941419/rookie2145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 35461978, "answer_count": 2, "score": 0, "last_activity_date": 1455726026, "creation_date": 1455725006, "last_edit_date": 1455725203, "question_id": 35461795, "link": "https://stackoverflow.com/questions/35461795/creating-a-loop-to-compare-two-cells-in-excel", "title": "Creating a Loop to Compare two cells in Excel", "body": "<p>I have written some code to compare two cells. At the moment the code compares D2 with J2. I need to compare D3 with J3, D4 with J4 etc. I know the easiest way to do it is with a loop but cannot get it working. Any help is much appreciated.</p>\n\n<p>Here is the code so far:</p>\n\n<pre><code>Public Sub Practice1()\n    Dim UpLim As Double, LowLim As Double\n    Dim outcome As String\n\n    UpLim = Range(\"d2\").Value\n    LowLim = Range(\"j2\").Value\n\n\n    If UpLim &gt; LowLim Then\n        result = \"Headroom\"\n\n    Else\n        result = \"NoHeadroom\"\n    End If\n\n    Range(\"e2\").Value = result\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1455724344, "post_id": 35461410, "comment_id": 58619072, "body": "You are defining the cell by Offset; this means it is calculated relative to the active cell. Are you sure you&#39;re always on the correct cell before you press the button?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1455724603, "post_id": 35461410, "comment_id": 58619274, "body": "do you know that <code>InStr()</code> by default is case-sensitive? therefore <code>Dagligvare</code> and <code>dagligvare</code> will give different results"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455724617, "post_id": 35461410, "comment_id": 58619292, "body": "consider the <code>Worksheet_Change</code> event which will fire every time you make a change in the worksheet, but can also be limited to firing when only certain cells change. Or consider a simple formula <code>IF</code> statement and scrap vba altogether (saying that without knowing the full scope of your efforts)."}, {"owner": {"reputation": 67, "user_id": 4869714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153271656261346/picture?type=large", "display_name": "sCuper", "link": "https://stackoverflow.com/users/4869714/scuper"}, "edited": false, "score": 0, "creation_date": 1455728528, "post_id": 35461410, "comment_id": 58622103, "body": "Thank you! All of you! It was what Grade &#39;Eh&#39; Bacon said that was my main problem, I thought the cell I currently was in was the one with the button. But all the other answers worked for other problems.  Scott: I could have used one if I knew how. I am used to programming in Python and find VBA easier to learn than all the commands in excel. How would you make one?"}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": true, "score": 1, "last_activity_date": 1455725236, "creation_date": 1455725236, "answer_id": 35461876, "question_id": 35461410, "link": "https://stackoverflow.com/questions/35461410/changing-value-of-cell-based-on-category-in-a-budget/35461876#35461876", "title": "Changing value of cell based on Category in a budget", "body": "<p>You could add a further msgbox to ensure user has the correct activecell</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim celltxt As String\n\n    if (activecell.column = 10) then '&lt;&lt;change 10 to appropriate column\n\n      celltxt = ActiveCell.Offset(0, -5).Text\n      If InStr(1, celltxt, \"Dagligvare\") Then\n           Range(\"C9\") = 3\n      Else\n           MsgBox (\"Nope\")\n      End If\n    else\n           MsgBox (\"Oi! You need to have a cell in column 10 selected\")\n    end\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4869714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153271656261346/picture?type=large", "display_name": "sCuper", "link": "https://stackoverflow.com/users/4869714/scuper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 35461876, "answer_count": 1, "score": 0, "last_activity_date": 1455725236, "creation_date": 1455724116, "question_id": 35461410, "link": "https://stackoverflow.com/questions/35461410/changing-value-of-cell-based-on-category-in-a-budget", "title": "Changing value of cell based on Category in a budget", "body": "<p>I'm trying to make a simple budget in excel and I want a macro to see which category I have made changes to and then add the change to an overall overview of the money used in that category.</p>\n\n<p>That is I have at the top of my sheet a cell for the category \"Food\".\nFurther down the sheet I put in the following:\nDate;    Category;    Amount of money used.</p>\n\n<p>My code has been used by a button until now.The button checks if the cell 5 places to the left has the value \"Dagligvare\" and then changes a value somewhere else in the sheet.\nMy problem is that sometimes the Button recognize the word and sometimes it doesn't. So my question is: Can anybody see why it only works sometimes even though I don't change anything?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim celltxt As String\n    celltxt = ActiveCell.Offset(0, -5).Text\n    If InStr(1, celltxt, \"Dagligvare\") Then\n         Range(\"C9\") = 3\n    Else\n         MsgBox (\"Nope\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455724992, "post_id": 35461163, "comment_id": 58619601, "body": "Use the <code>Repeat Item Labels</code> option in the <code>Layout &amp; Printing</code> tab of the Field Settings to fill all the zip codes. Then use <a href=\"http://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal\">Reverse Pivot</a> to flatten the table. VBA eliminated :)"}, {"owner": {"reputation": 19, "user_id": 5937525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea934cda57f7ecc9327b958f9de7020a?s=128&d=identicon&r=PG&f=1", "display_name": "MsRestlesstraeler", "link": "https://stackoverflow.com/users/5937525/msrestlesstraeler"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455811860, "post_id": 35461163, "comment_id": 58666551, "body": "It magically worked! Thank you so much :-) I wanted VBA so that I can learn to code a bit but this made what I wanted happen. I appreciate it!"}], "owner": {"reputation": 19, "user_id": 5937525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea934cda57f7ecc9327b958f9de7020a?s=128&d=identicon&r=PG&f=1", "display_name": "MsRestlesstraeler", "link": "https://stackoverflow.com/users/5937525/msrestlesstraeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1950, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478267104, "creation_date": 1455723483, "last_edit_date": 1531161705, "question_id": 35461163, "link": "https://stackoverflow.com/questions/35461163/vba-to-convert-pivot-table-format-to-normal-data-table", "title": "VBA to convert PIVOT table format to normal data table", "body": "<p>I have a data from Pivot table that looks like this (Column A is empty) <br></p>\n\n<pre><code>10001   100.00% \n1   33.33% \n2   33.33%\n3   33.33%\n10002   100.00%\n1   1.45%\n2   6.60%\n3   3.26%\n</code></pre>\n\n<p>and I want to make it in this format so that I can work with data. (Column A has ZIPCODE, B and C have same data from the table above)</p>\n\n<pre><code>      10001 100.00%\n10001   1   33.33%\n10001   2   33.33%\n10001   3   33.33%\n    10002   100.00%\n10002   1   1.45%\n10002   2   6.60%\n</code></pre>\n\n<p>I wanted to write a code that reads through column B that the length meets 5 (ZIPCODE) then copypaste the ZIPCODE where the length isn't 5 then repeat till next ZIP. </p>\n\n<p>Any wisdom would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1455724477, "post_id": 35461122, "comment_id": 58619170, "body": "what if you make <code>TableName</code> random/unique each time you run the code?"}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1455724849, "post_id": 35461122, "comment_id": 58619487, "body": "@KazimierzJawor You see, I could run the code as many times as needed without problems. The problem started when I replaced the data..."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1455821968, "post_id": 35461122, "comment_id": 58673182, "body": "I found the solution here: <a href=\"https://stackoverflow.com/questions/25870193/type-mismatch-during-creation-of-pivot-table-excel-vba\" title=\"type mismatch during creation of pivot table excel vba\">stackoverflow.com/questions/25870193/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455732813, "post_id": 35462162, "comment_id": 58624750, "body": "Thanks, Scott. Please see my addition to the original question."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455734928, "post_id": 35462162, "comment_id": 58625988, "body": "@DavidShochet - if this answer correctly solved your initial question, please mark it as answered and create a new question for your new problem (which was not in the original question)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455735325, "post_id": 35462162, "comment_id": 58626216, "body": "@DavidShochet - you can mark as answered by clicking the green check mark to the left of the answer."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455738089, "post_id": 35462162, "comment_id": 58628028, "body": "I thought it was a part of my original question, as before I changed the data, everything worked. But if you think (or know) that it is a completely new problem, I can add a new question. Please let me know."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455745797, "post_id": 35462162, "comment_id": 58632570, "body": "Anyway, I added a new question here: <a href=\"https://stackoverflow.com/questions/35466984/excel-vba-failed-method-on-pivot-table\" title=\"excel vba failed method on pivot table\">stackoverflow.com/questions/35466984/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455745868, "post_id": 35462162, "comment_id": 58632613, "body": "@DavidShochet - I considered it a new question because you added additional lines of code than in the original which presented a separate problem. (just so you understand why I said that)."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455821256, "post_id": 35462162, "comment_id": 58672769, "body": "It seems like this solution only hides the problem. lColumn is 1 in this case, which is not right. But if I use .Cells(1, Columns.Count).End(xlToLeft).Column, the lColumn is correct, but the same error about type mismatch occurs again."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "edited": false, "score": 0, "creation_date": 1455823197, "post_id": 35462162, "comment_id": 58673864, "body": "@DavidShochet good catch. I edited the answer appropriately. I just tried playing with your other question a bit more, but ran into issues myself with the rest of the code."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1455823157, "last_edit_date": 1455823157, "creation_date": 1455725973, "answer_id": 35462162, "question_id": 35461122, "link": "https://stackoverflow.com/questions/35461122/vba-error-on-creating-a-pivot-table/35462162#35462162", "title": "VBA: Error on creating a pivot table", "body": "<p>Most likely what is causing the error is the use of <code>UsedRange</code>. While a nifty tool, it also has its drawbacks, especially since you are now replacing data.</p>\n\n<p>For example, if the new data has less columns then the old data, or even less rows, the <code>UsedRange</code> will most likely reflect the old range with data. Furthermore, depending upon what you have been doing with your worksheet there may be cells that contain formatting or other characters that you cannot see with the naked-eye, that will affect the <code>UsedRange</code>.</p>\n\n<p>If you make the following adjustments in your code, it should work every time.</p>\n\n<pre><code>Dim ws as Worksheet\nSet ws = Worksheets(\"Working\")\n\nDim lRow as Long, lColumn as Long\n\n'assumes data table of contiguous rows/columns starting in A1\nWith ws\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlup).Row\n    lColumn = .Cells(1, .Columns.Count).End(xltoLeft).Column\nEnd With\n\nActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:=ws.Range(ws.Cells(1,1),ws.Cells(lRow,lColumn)) ...\n</code></pre>\n"}], "owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455823157, "creation_date": 1455723407, "last_edit_date": 1455732779, "question_id": 35461122, "link": "https://stackoverflow.com/questions/35461122/vba-error-on-creating-a-pivot-table", "title": "VBA: Error on creating a pivot table", "body": "<p>I am creating a VBA macro. Among other things, it makes a pivot table:</p>\n\n<pre><code>    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:=Sheets(\"Working\").UsedRange).CreatePivotTable TableDestination:=\"\", TableName:=\"HDPivotTable\", DefaultVersion:=xlPivotTableVersion10\n</code></pre>\n\n<p>This works, but when I delete all data from the Excel spreadsheet and replace it with new data of the same structure, I get an error on the above line:</p>\n\n<p>Run-time error '13': Type mismatch</p>\n\n<p>Could you please help me on this?</p>\n\n<p>Thanks.</p>\n\n<p>EDITED:</p>\n\n<p>After applying Scott's suggestion, I get another error:</p>\n\n<pre><code>With Worksheets(\"Working\")\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    lColumn = .Range(\"A\" &amp; .Columns.Count).End(xlToLeft).Column\n    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:=.Range(.Cells(1, 1), .Cells(lRow, lColumn))).CreatePivotTable TableDestination:=\"\", TableName:=\"HDPivotTable\", DefaultVersion:=xlPivotTableVersion10\nEnd With\n\nActiveSheet.Name = \"HD Pivot\"\nActiveSheet.PivotTableWizard TableDestination:=ActiveSheet.Cells(1, 1)\nActiveSheet.PivotTables(\"HDPivotTable\").AddFields RowFields:=\"Location Code\"\n</code></pre>\n\n<p>The error is:\nRun-time error '1004': AddFields method of PivotTable class failed</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 0, "creation_date": 1455723313, "post_id": 35461024, "comment_id": 58618246, "body": "What&#39;s the error you get? What line is it on? Please edit your question to include those details. Thank you."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455723419, "post_id": 35461024, "comment_id": 58618322, "body": "Well. You never specify the object <code>TextBox1</code> belongs to it? Is it on a Worksheet? If so, which one? Is it on a UserForm? If so, which one? For example <code>X = Me.TextBox1</code> or <code>X = Sheets(&quot;Sheet1&quot;).TextBox1</code>"}, {"owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "edited": false, "score": 0, "creation_date": 1455724128, "post_id": 35461024, "comment_id": 58618921, "body": "Error is on X = TextBox1    The textbox is on a worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 3, "last_activity_date": 1455725445, "creation_date": 1455725445, "answer_id": 35461962, "question_id": 35461024, "link": "https://stackoverflow.com/questions/35461024/vba-excel-textbox1-assign-object-to-varaible/35461962#35461962", "title": "VBA - Excel TextBox1 assign object to varaible", "body": "<p>You've got a few issues.  See comments for details in the code</p>\n\n<pre><code>Sub TB1()\n   Dim X As TextBox\n   Dim Y As String\n\n   Set X = Me.TextBoxes(\"Textbox 1\")   \n   'You need to have some sort of reference to get to the textbox.  \n   'Me in this case is a worksheet object I tested in the Sheet1 module.  \n   'It has a collection of textboxes which you can refer to by name.  Click on your textbox in excel to see the name in the upper left corner.\n   'The `Set` syntax is necessary for objects \n\n   If Len(X.Text) &lt; 4 Then\n     Y = X.Text \n     'Have to explicitly refer to the text in the textbox since it has other properties you can change like height and width\n     Do\n        Y = \"0\" &amp; Y\n     Loop Until Len(Y) &gt;= 4\n     X.Text = Y 'Explicitly refer to the textbox text again to reassign\n   End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 35461962, "answer_count": 1, "score": 0, "last_activity_date": 1455725445, "creation_date": 1455723149, "question_id": 35461024, "link": "https://stackoverflow.com/questions/35461024/vba-excel-textbox1-assign-object-to-varaible", "title": "VBA - Excel TextBox1 assign object to varaible", "body": "<p>I get error when I try to assign TextBox1 to variable X.</p>\n\n<pre><code>Sub TB1()\n   Dim X As TextBox\n   Dim Y As String\n   X = TextBox1\n   If Len(X) &lt; 4 Then\n     Y = X\n     Do\n        Y = \"0\" &amp; Y\n     Loop Until Len(Y) &gt;= 4\n     X = Y\n   End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-addins"], "comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1455723780, "post_id": 35460812, "comment_id": 58618610, "body": "In the VBA Editor click on ThisWorkbook for your Add-In. In the Properties Window, make sure that IsAddin is set to True."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1455723955, "post_id": 35460812, "comment_id": 58618766, "body": "Are the functions in your addin marked as <code>Public</code>?"}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1455725511, "post_id": 35460812, "comment_id": 58619992, "body": "@IronMan: That did it.  Of course just saving the file as an Add-in wouldn&#39;t be enough. :/  If you want the SO cred, post this as the answer and I will accept it.  Thanks."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1455726859, "post_id": 35460812, "comment_id": 58620986, "body": "Also, click the check mark to show that you have accepted this answer and it resolved your issue. Thanks."}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1455726979, "post_id": 35460812, "comment_id": 58621073, "body": "@nwhaught: Yes.  Thanks.  I don&#39;t have enough rep yet to upvote your comment."}], "answers": [{"tags": [], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1455726313, "creation_date": 1455726313, "answer_id": 35462285, "question_id": 35460812, "link": "https://stackoverflow.com/questions/35460812/excel-vba-add-in-reference-not-listed/35462285#35462285", "title": "Excel VBA Add-in reference not listed", "body": "<p>In the VBA Editor click on ThisWorkbook for your Add-In. In the Properties Window, make sure that IsAddin is set to True. This also makes it easier to edit your addin. When you need to make changes to the add-in code, follow these steps:</p>\n\n<ol>\n<li>Set the property to <code>False</code></li>\n<li>Make your edits</li>\n<li>Change the property back to <code>True</code></li>\n<li>Click on the Save icon</li>\n<li>Close Excel.</li>\n<li>You will be prompted if you want to save the changes made to\n\"addin.xlam\", click yes.</li>\n</ol>\n\n<p>And as @nwhaught suggested, make sure your functions are set to Public and not Private.</p>\n"}], "owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 0, "accepted_answer_id": 35462285, "answer_count": 1, "score": 1, "last_activity_date": 1455726313, "creation_date": 1455722688, "last_edit_date": 1455723531, "question_id": 35460812, "link": "https://stackoverflow.com/questions/35460812/excel-vba-add-in-reference-not-listed", "title": "Excel VBA Add-in reference not listed", "body": "<p>I saved an Excel project as type \"Excel Add-in\" to the default directory under AppData/Roaming/Microsoft/AddIns.  The extension is .xlam.  Upon reopening Excel, this Add-in was listed under File-->Options-->Add-ins and I toggled the checkbox to select it.</p>\n\n<p>In the VBA editor, this Add-in is displayed along with the other Add-ins listed under File-->Options-->Add-ins but none of the code can be called.  It is not listed in the available references and, when I use this window to browse for it, it is not detected in the AddIns directory -- despite clearly being there.</p>\n\n<p>I notice that all of the other Add-in projects that were installed without problem are .xla file extensions.  We are using Excel 2010 but the problem is identical when I save the project as type \"Excel 97-2003 Add-in\" with an extension of .xla.</p>\n\n<p>Advice is appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455723055, "post_id": 35460783, "comment_id": 58618024, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling\">VBA Excel simple Error Handling</a>"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455723095, "post_id": 35460783, "comment_id": 58618049, "body": "You may feel that this is not a duplicate question, however the standard response would be to include error handling, and also to check for the validity of a search term before executing the remainder of your code."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1455723123, "post_id": 35460783, "comment_id": 58618080, "body": "You could use <code>DCount</code> to check whether the ID exists.  If  <code>DCount(&quot;*&quot;,&quot;tbl_Downtime&quot;, &quot;ID = &quot; &amp; Forms![DTForm]![Text135]) = 0</code>, then no matching ID is present."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455723130, "post_id": 35460783, "comment_id": 58618091, "body": "@Grade&#39;Eh&#39;Bacon Looking through your suggested answer now."}, {"owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455723552, "post_id": 35460783, "comment_id": 58618419, "body": "@Grade&#39;Eh&#39;Bacon: IMO your duplicate question isn&#39;t really a duplicate in this specific case. I agree with your point about error handling, but apparently the OP <b>does</b> know about error handling - he&#39;s already trying to do it in his code in the question (<code>If Me.Text135 = Nothing Then ...</code>). He just doesn&#39;t know how to do it right in MS Access."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "edited": false, "score": 1, "creation_date": 1455723621, "post_id": 35460783, "comment_id": 58618483, "body": "@ChristianSpecht The OP may understand error handling [and I don&#39;t mean to imply otherwise], but he is not using the VBA GoTo error handling method, which is somewhat unique and, in my opinion, counter-intuitive."}, {"owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1455724178, "post_id": 35460783, "comment_id": 58618954, "body": "@Grade&#39;Eh&#39;Bacon: At least he doesn&#39;t use <code>On Error GoTo X</code>, but just <code>GoTo Last_Line:</code>, but it&#39;s not necessary in this example at all - and you&#39;re right, I always try to avoid it when I can just check beforehand if the field is empty. But as I understood it, the OP doesn&#39;t want to know about <code>On Error GoTo X</code>...he just wants to know the Access syntax to check two very specific things."}], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1455723981, "post_id": 35461027, "comment_id": 58618793, "body": "This seems to be ok, but I need it to stop executing the sub entirely if the field is blank. This is giving me an error because even though the field is blank, it keeps executing the rest of the sub."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1455724659, "post_id": 35461027, "comment_id": 58619332, "body": "Right, it definitely goes to <code>End If</code> if the field is blank. However, I placed the SQL statement and the rest of the code <i>underneath</i> that. So after it reaches the <code>End If</code>, it must go to the next section."}], "tags": [], "owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "is_accepted": false, "score": 1, "last_activity_date": 1455724492, "last_edit_date": 1455724492, "creation_date": 1455723155, "answer_id": 35461027, "question_id": 35460783, "link": "https://stackoverflow.com/questions/35460783/access-vb-validating-blank-values-and-incorrect-values-in-a-textbox/35461027#35461027", "title": "Access VB: Validating blank values and incorrect values in a textbox", "body": "<ol>\n<li><p>Completely stop executing the sub when the field is blank:</p>\n\n<pre><code>If Nz(Me.Text135) = \"\" Then 'Text135 is null or empty\n\n    Exit Sub\n\nEnd If\n</code></pre>\n\n<p>But if the code in your question is your actual code <em>(and not just a shortened example)</em>, you need neither the <code>Exit Sub</code> nor the <code>GoTo Last_Line:</code> part, because after the message box, the code execution will jump to the <code>End If</code> anyway.</p></li>\n<li><p>Check whether the Recordset contains any rows:</p>\n\n<pre><code>Set db = CurrentDb\nSet rs = db.OpenRecordset(sql)\n\nIf rs.EOF Then\n\n    'rs.EOF is True when there are no rows\n    MsgBox \"ID is not valid\"\n\nElse\n\n    'do stuff\n\nEnd If\n\nSet db = Nothing\nSet rs = Nothing\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642677, "creation_date": 1455722634, "last_edit_date": 1594642677, "question_id": 35460783, "link": "https://stackoverflow.com/questions/35460783/access-vb-validating-blank-values-and-incorrect-values-in-a-textbox", "title": "Access VB: Validating blank values and incorrect values in a textbox", "body": "<p>I have a textbox where the user inputs the ID of a row to be updated/edited. I got it to work properly when they enter an ID that exists, but I get an error when they input an ID that <em>doesn't</em> exist or when they leave it blank. </p>\n\n<p>Goals:</p>\n\n<ol>\n<li><p>Allow blank - if the user leaves the field blank, then I need to wipe the form and simply let the user continue (no message box needed).</p></li>\n<li><p>Warn user when ID is not valid with a message box.</p></li>\n</ol>\n\n<p><strong>Current Code</strong></p>\n\n<pre><code>Private Sub Text135_LostFocus()\n\n    If Me.Text135 = Nothing Then\n\n    MsgBox \"Nothing entered into the ID field. Query will not run\"\n\n    GoTo Last_Line:\n\n    Else\n\n    sql = \"SELECT * FROM tbl_Downtime WHERE ID = \" &amp; Forms![DTForm]![Text135] &amp; \";\"\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(sql)\n\n    Me.Text126.Value = rs!production_date\n    Me.Text144.Value = rs!shift\n    Me.Text116.Value = rs!job\n    Me.Text118.Value = rs!suffix\n    Me.Text121.Value = rs!reason\n    Me.Text123.Value = rs!downtime_minutes\n    Me.Text4.Value = rs!people_missing\n    Me.Text128.Value = rs!comment\n    Set db = Nothing\n    Set rs = Nothing\n\n    Last_Line:\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "ms-access", "vba", "listboxitems"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1455726007, "post_id": 35460691, "comment_id": 58620378, "body": "Try Dim-ing the array as Variant.  Arrays defined as String need to have a specified size (i.e. Dim folderarray(5) As String), whereas Variant allows for a non-specified size."}, {"owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1455726477, "post_id": 35460691, "comment_id": 58620722, "body": "Still get &quot;Can&#39;t assign to array&quot; :("}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1455726913, "post_id": 35460691, "comment_id": 58621025, "body": "place &quot;ReDim&quot; statement before assigning values to &quot;folderarray()&quot;, otherwise it is unable to be assigned any value. then, when assigning &quot;folderarray()&quot; one single value you must use an index (folderarray(i)=...). if you want to assign an entire list to an array, then you must declare the array as of &quot;Variant&quot; type"}, {"owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "edited": false, "score": 0, "creation_date": 1455727459, "post_id": 35460691, "comment_id": 58621404, "body": "I get Run-time error &#39;13: Type mismatch  even with the variable set to either, Variant or String"}, {"owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "edited": false, "score": 0, "creation_date": 1455728073, "post_id": 35460691, "comment_id": 58621832, "body": "The line that triggers the error is this: folderarray(i) = Join(list, &quot;,&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1455727204, "creation_date": 1455727204, "answer_id": 35462615, "question_id": 35460691, "link": "https://stackoverflow.com/questions/35460691/access-vba-loop-through-listbox-select-items-and-add-to-array/35462615#35462615", "title": "Access VBA loop through listbox select items and add to array", "body": "<p>1) declare the array. Take a look at <a href=\"https://msdn.microsoft.com/en-us/library/wak0wfyt.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/wak0wfyt.aspx</a></p>\n\n<p>2) No need of support variable</p>\n\n<p>3) Assign the values to your array with the correct syntax</p>\n\n<pre><code>Private Sub exportfolders_Click()\n\nDim folderarray() As String\nDim i As Interger\n\nRedim folderarray (Me.selectedfolders.ListCount-1)\n\nFor i = 0 To Me.selectedfolders.ListCount - 1\n    folderarray(i) = Me.selectedfolders.Column(0, i)\nNext i\n\n' Write here what you want to do with your array\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "is_accepted": false, "score": 0, "last_activity_date": 1455727538, "creation_date": 1455727538, "answer_id": 35462710, "question_id": 35460691, "link": "https://stackoverflow.com/questions/35460691/access-vba-loop-through-listbox-select-items-and-add-to-array/35462710#35462710", "title": "Access VBA loop through listbox select items and add to array", "body": "<p>You could try something like this:</p>\n\n<pre><code>Private Sub ListToArray()\n    Dim folderArray() As Variant\n    Dim currentValue As String\n    Dim currentIndex As Integer\n    Dim topIndex As Integer\n\n    topIndex = Me.selectedfolders.ListCount - 1\n    ReDim folderArray(0 To topIndex, 0 To 1)\n\n    For i = 0 To topIndex\n        currentValue = Me.selectedfolders.Column(0, i)\n        folderArray(i, 0) = i\n        folderArray(i, 1) = currentValue\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note my example is a multi-dimensional array which will give you the ability to add more than one item should you chose to do so. In this example I added the value of \"i\" as a placeholder/ index.</p>\n"}, {"comments": [{"owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "edited": false, "score": 0, "creation_date": 1455729324, "post_id": 35463064, "comment_id": 58622595, "body": "+1 for simplicity and thinking outside the box. If I was the questioner I would definitely award this one!"}, {"owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "edited": false, "score": 0, "creation_date": 1455786434, "post_id": 35463064, "comment_id": 58648134, "body": "Thanks for that! it worked :) , and my plan was to use it in a SQL statement to export more detailed results based on the data that is added to the listbox. As there can be many variations that can be added to the listbox."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1455728889, "last_edit_date": 1455728889, "creation_date": 1455728521, "answer_id": 35463064, "question_id": 35460691, "link": "https://stackoverflow.com/questions/35460691/access-vba-loop-through-listbox-select-items-and-add-to-array/35463064#35463064", "title": "Access VBA loop through listbox select items and add to array", "body": "<p>You can concatenate the list box items into a string, and then use <code>Split()</code> to load your array.  That way, the array is sized automagically without you needing to <code>ReDim</code>.</p>\n\n<p>I tested this code in Access 2010:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim folderarray() As String\nDim i As Long\nDim strList As String\n\nFor i = 0 To Me!selectedfolders.ListCount - 1\n    strList = strList &amp; \",\" &amp; Me!selectedfolders.Column(0, i)\nNext\n' use Mid() to exclude the first comma ...\nfolderarray = Split(Mid(strList, 2), \",\")\n</code></pre>\n\n<p>Note I don't know what you want to do with the array after loading it.  <code>MsgBox folderarray</code> would throw <em>Type mismatch</em> error.  <code>MsgBox Mid(strList, 2)</code> would be valid, but if that's what you want, you wouldn't need the array.</p>\n"}], "owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3136, "favorite_count": 0, "accepted_answer_id": 35463064, "answer_count": 3, "score": 2, "last_activity_date": 1455728889, "creation_date": 1455722416, "last_edit_date": 1455728648, "question_id": 35460691, "link": "https://stackoverflow.com/questions/35460691/access-vba-loop-through-listbox-select-items-and-add-to-array", "title": "Access VBA loop through listbox select items and add to array", "body": "<p>I'm trying to loop through a listbox and add the contents to an array....</p>\n\n<p>My code is this: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub exportfolders_Click()\n\nDim list As String\nDim folderlist As String\nDim folderarray() As String\n'Dim i As Interger\n\nFor i = 0 To Me.selectedfolders.ListCount - 1\n    'folderlist = (Me.selectedfolders.Column(0, i))\n    'folderarray() = Join(Me.selectedfolders.Column(0, i), \",\")\n    list = (Me.selectedfolders.Column(0, i))\n    folderarray() = Join(list, \",\")\n    ReDim Preserve folderarray(i)\nNext i\n   folderlist = folderarray\n    'folderarray() = Join(folderlist, \",\")\n    MsgBox (folderlist)\n\nEnd Sub\n</code></pre>\n\n<p>You can see the bits I have commented out, trying all sorts to get it to work. But I keep getting the message \"Can't assign to array\" at <code>folderarray(i) = Join(list, \",\")</code>.  Any pointers as to where I am failing? </p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1455722621, "post_id": 35460557, "comment_id": 58617681, "body": "Welcome to SO. Please post the actual code you have written. Then we can help more. As far as <i>I am not successful because the table name keeps changing each time the data is imported</i> is concerned, it&#39;s very possible to assign the table to a variable that you can assign (and thus not have to use the <code>name</code> all the time). I would even suggest changing the title of your question because the problem you have is the changing table name, not sorting by ColorIndex."}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 3954542, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aea0e3f211cfe50112cd8405e2b46233?s=128&d=identicon&r=PG&f=1", "display_name": "Damien Asseya", "link": "https://stackoverflow.com/users/3954542/damien-asseya"}, "is_accepted": false, "score": 1, "last_activity_date": 1455725805, "creation_date": 1455725805, "answer_id": 35462103, "question_id": 35460557, "link": "https://stackoverflow.com/questions/35460557/vba-excel-table-how-to-sort-based-on-colorindex/35462103#35462103", "title": "VBA excel table - How to sort based on ColorIndex", "body": "<p>I resolved my issue with this code.</p>\n\n<pre><code>Sub SortTable()\nDim lo As Excel.ListObject\n\nWith ActiveSheet\n     .ListObjects(1).Name = \"MyTableName\"\nEnd With\n\nSet lo = ActiveWorkbook.Worksheets(\"Alpha\").ListObjects(\"MyTableName\")\nWith lo\n     .Sort.SortFields.Clear\n     .Sort.SortFields.Add(Range(\"MyTableName[LastName]\"), _\n     xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.ColorIndex = 4\nWith .Sort\n     .Header = xlYes\n     .MatchCase = False\n     .Orientation = xlTopToBottom\n     .SortMethod = xlPinYin\n    .Apply\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1431, "user_id": 3954542, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aea0e3f211cfe50112cd8405e2b46233?s=128&d=identicon&r=PG&f=1", "display_name": "Damien Asseya", "link": "https://stackoverflow.com/users/3954542/damien-asseya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455725805, "creation_date": 1455722072, "question_id": 35460557, "link": "https://stackoverflow.com/questions/35460557/vba-excel-table-how-to-sort-based-on-colorindex", "title": "VBA excel table - How to sort based on ColorIndex", "body": "<p>I am importing data from sharepoint as an excel table. After importing the data, I highlight some of the rows based on specific criteria.\nI try to sort the excel table based on colorIndex using vba code, but I am not successful because the table name keeps changing each time the data is imported from sharepoint.\nDo you have any suggestions for me? </p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455722072, "post_id": 35460423, "comment_id": 58617265, "body": "Replacing single quotes with two single quotes is a feeble attempt at preventing sql injection. Instead you should use parameterized queries. It is safe for your database and a LOT simpler for you to code it."}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455728116, "post_id": 35460423, "comment_id": 58621858, "body": "Sean, I don&#39;t understand.  Could you show an example of the parameter qurey the you describe, Please"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455728525, "post_id": 35460423, "comment_id": 58622100, "body": "@SeanLange - replacing a single quote with two quotes is for <i>escaping the single quote</i> so a string can be used in SQL.  Nothing to do with SQL injection, which is definitely something which needs to be considered, but is not something which always needs to be assumed will happen."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455728609, "post_id": 35460423, "comment_id": 58622148, "body": "@TimWilliams yes that is correct but still...it is just the wrong way to go about it as it is a textbook example of sql injection."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455728685, "post_id": 35460423, "comment_id": 58622204, "body": "This article will do a far better job of explaining this than a forum post will. <a href=\"https://support.microsoft.com/en-us/kb/181734\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/181734</a> You can also check out google for &quot;vba parameterized query&quot;. You will get thousands of good examples."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455728702, "post_id": 35460423, "comment_id": 58622217, "body": "It is not for sure &quot;wrong&quot; unless you know the context the OP is working in."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455728801, "post_id": 35460423, "comment_id": 58622280, "body": "Ummm ok. They are taking the value of a textbox and directly executing it. There are pretty much no times that should be acceptable. It is so simple to parameterize queries once you know how to do it that not doing it is negligent."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455728951, "post_id": 35460423, "comment_id": 58622370, "body": "I&#39;m not trying to understate the potential risk of SQL injection, only stating an opinion that without understanding the actual risk given the expected use, it is over-reaching to claim that <i>any</i> SQL concatenation is unacceptable."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455729104, "post_id": 35460423, "comment_id": 58622463, "body": "But in this case using parameterized sql solves the current issue AND makes it more secure. And even better, the OP will hopefully learn a less brittle technique for dealing with data. It is so simple to do that arguing that it doesn&#39;t matter in some situations is just silly."}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1455730023, "post_id": 35460423, "comment_id": 58623075, "body": "I just want to know what to do to make the query run, like whats wrong with the Replace in UpDtFlag = &quot;UPDATE [Range Card Master Mailer] SET [Range Card Master Mailer].RedeemDate = Now(), [Range Card Master Mailer].RedeemFlag = &#39;Y&#39; &quot; &amp; _     &quot;WHERE ((([Range Card Master Mailer].Master_ID) = &#39;&quot; &amp; _      Replace(Me!scanTxtBox, &quot;&#39;&quot;, &quot;&#39;&#39;&quot;) &amp; &quot;&#39;))&quot; or am example of the parameter query."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455730147, "post_id": 35460423, "comment_id": 58623150, "body": "@user3216034 did you look at the link I posted? It shows you how to do this pretty clearly."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1455730869, "post_id": 35460423, "comment_id": 58623606, "body": "Ahh just noticed you are using DoCmd. This should help. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194182.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194182.aspx</a>"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1455732128, "post_id": 35460423, "comment_id": 58624364, "body": "Sean, I read the posts and tried the following but it gave me an error stating I need sql.  Here is what I tried: DoCmd.SetParameter &quot;strTxtBox&quot;, Me.scanTxtBox.  Put in the sql and failure.  I am no expert at this so an example would be greatly appreciated.  Thanks"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455746004, "post_id": 35460423, "comment_id": 58632679, "body": "<code>Debug.Print UpDtFlag</code> and check the output is what you expect, then try running that SQL directly in the actual Db and see what you get.  If you&#39;re trying to run an update in SQL server then <code>Now()</code> might need to be replaced with <code>getdate()</code> or something similar."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1455796543, "post_id": 35460423, "comment_id": 58655021, "body": "what type is the Master_ID ? number, string?"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1455833634, "post_id": 35460423, "comment_id": 58679646, "body": "I don&#39;t know how to close this, but I got it running with the following&quot;Dim UpDtFlag As String         UpDtFlag = &quot;UPDATE [Range Card Master Mailer] SET [Range Card Master Mailer].RedeemDate = Now(), [Range Card Master Mailer].RedeemFlag = &#39;Y&#39; &quot; &amp; _         &quot;WHERE ((([Range Card Master Mailer].Master_ID) = &#39;&quot; &amp; _          Replace(Me!scanTxtBox, &quot;&#39;&quot;, &quot;&#39;&#39;&quot;) &amp; &quot;&#39;))&quot;    &#39;DoCmd.RunSQL UpDtFlag &#39;Reset after testing of printer"}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "is_accepted": false, "score": 0, "last_activity_date": 1455837037, "last_edit_date": 1455837037, "creation_date": 1455833752, "answer_id": 35493537, "question_id": 35460423, "link": "https://stackoverflow.com/questions/35460423/replace-in-sql-in-vba/35493537#35493537", "title": "Replace in SQL in VBA", "body": "<p>I got it running with the following:</p>\n\n<pre><code>Dim UpDtFlag As String\nUpDtFlag = \"UPDATE [Range Card Master Mailer] SET [Range Card Master Mailer].RedeemDate = Now(), [Range Card Master Mailer].RedeemFlag = 'Y' \" &amp; _\n    \"WHERE ((([Range Card Master Mailer].Master_ID) = '\" &amp; _\n     Replace(Me!scanTxtBox, \"'\", \"''\") &amp; \"'))\"\nDoCmd.RunSQL UpDtFlag 'Reset after testing of printer\n</code></pre>\n\n<p>Thanks</p>\n\n<p>jpl</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 906, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455837037, "creation_date": 1455721745, "question_id": 35460423, "link": "https://stackoverflow.com/questions/35460423/replace-in-sql-in-vba", "title": "Replace in SQL in VBA", "body": "<p>Still Having problems with replace. Using the following sql:</p>\n\n<pre><code>Dim UpDtFlag As String\n    UpDtFlag = \"UPDATE [Range Card Master Mailer] SET [Range Card Master Mailer].RedeemDate = Now(), [Range Card Master Mailer].RedeemFlag = 'Y' \" &amp; _\n    \"WHERE ((([Range Card Master Mailer].Master_ID) = '\" &amp; _\n     Replace(Me!scanTxtBox, \"'\", \"''\") &amp; \"'))\"\nDoCmd.RunSQL UpDtFlag \n</code></pre>\n\n<p>The problem is in the Me!scanTxtBox.  Got help and and used it successfully in the following:</p>\n\n<pre><code> Dim RCMSql As String\n    RCMSql = \"SELECT [Range Card Master Mailer].Master_ID,\" &amp; _\n    \"[Range Card Master Mailer].MaxOfDate_of_Transaction,\" &amp; _\n    \"[Range Card Master Mailer].FirstName,\" &amp; _\n    \"[Range Card Master Mailer].LastName,\" &amp; _\n    \"[Range Card Master Mailer].Email_Address,\" &amp; _\n    \"[Range Card Master Mailer].Address_Line_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_2,\" &amp; _\n    \"[Range Card Master Mailer].Date_Sent,\" &amp; _\n    \"[Range Card Master Mailer].CouponValue,\" &amp; _\n    \"[Range Card Master Mailer].RedeemDate,\" &amp; _\n    \"[Range Card Master Mailer].RedeemFlag \" &amp; _\n    \"FROM [Range Card Master Mailer] \" &amp; _\n    \"WHERE ((([Range Card Master Mailer].Master_ID) = '\" &amp; _\n     Replace(Me!scanTxtBox, \"'\", \"''\") &amp; \"'))\"\n     RCMRs.Open RCMSql                       \n</code></pre>\n\n<p>Tried to copy the replace into the problem query the problem query and obviously don't understand punctuation or something else. Also tried to use concatenation like BalanceStr = \"'\"&amp;scanTxtBox&amp;\"'\" and then use Balancestr in sql. Didn't work</p>\n\n<p>Thanks</p>\n\n<p>jpl</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1455723674, "post_id": 35460387, "comment_id": 58618522, "body": "<code>.FormulaR1C1</code> attempts to create a <code>R1C1</code> notation formula in the specified cell. As written, the code is attempting to set a R1C1 formula to  the result of a <code>vlookup</code> formula (which may in itself be incorrect). If you are trying to set a cell value, use <code>.Value</code> in place of <code>.FormulaR1C1</code>. In looking at your vlookup, you are returning the same value as your lookup value (via the 1 column argument), so what&#39;s the point?"}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": true, "score": 1, "last_activity_date": 1455727178, "creation_date": 1455727178, "answer_id": 35462606, "question_id": 35460387, "link": "https://stackoverflow.com/questions/35460387/application-worksheetfunction-vlookup-error-1004/35462606#35462606", "title": "application.worksheetfunction.vlookup error 1004?", "body": "<p>Scott has highlighted the problem line.</p>\n\n<p>You could try amending so an actual formula is inserted into the cell.<br>\nSo instead of the following:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _ \n    Application.WorksheetFunction.VLookup( &amp; _\n        Range(scashradicalcolumnnam &amp; ActiveCell.Row) &amp; _\n      , Range(scashradicalcolumnnam &amp; immsstart &amp; \":\" &amp; scashradicalcolumnnam &amp; immsfinal), 1, False)\n</code></pre>\n\n<p>Something like:</p>\n\n<pre><code>ActiveCell = \"=vlookup(\" &amp; scashradicalcolumnnam &amp; ActiveCell.Row &amp; _\n                 \",\" &amp; scashradicalcolumnnam &amp; immsstart &amp; \":\" &amp; _\n                 scashradicalcolumnnam &amp; immsfinal &amp; _\n                 \", 1, False)\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 35462606, "answer_count": 1, "score": 0, "last_activity_date": 1455727178, "creation_date": 1455721672, "question_id": 35460387, "link": "https://stackoverflow.com/questions/35460387/application-worksheetfunction-vlookup-error-1004", "title": "application.worksheetfunction.vlookup error 1004?", "body": "<p>i have a debug in my code, but i cannot figure out why it is happening, could you please review the code and see where i messed up? Note the error debug is happening on the ActiveCell.FormulaR1C1 line.</p>\n\n<pre><code>    'ENRICHMENT CODE FOR VARIOUS TITLES\nFor Each wbtitle In wbrange\n    sThisWorkTitle = wbtitle\n    sThisWorkColumnNum = wbtitle.Column\n    sThisWorkColumnNam = Split(Cells(, sThisWorkColumnNum).Address, \"$\")(1)\n\n                'identifying CASH RADICAL COLUMN LETTER\n                If sThisWorkTitle = \"Account Cash Radical\" Then\n                scashradicalcolumnnam = Split(Cells(, sThisWorkColumnNum).Address, \"$\")(1)\n                Else\n                'do nothing\n                End If\n\n\n                ''' CASH RELATED?\n                    If sThisWorkTitle = \"Cash Related?\" Then\n                        wbtitle.Select\n                        Range(sThisWorkColumnNam + gspstart).Select\n                        ActiveCell.FormulaR1C1 = Application.WorksheetFunction.VLookup(Range(scashradicalcolumnnam &amp; ActiveCell.Row), Range(scashradicalcolumnnam &amp; immsstart &amp; \":\" &amp; scashradicalcolumnnam &amp; immsfinal), 1, False)\n                        ActiveCell.AutoFill Range(ActiveCell.Address, Cells(gspfinal))\n                        Columns(sThisWorkTitle).Select\n                        Selection.Copy\n                        Selection.PasteSpecial Paste:=xlPasteValues\n                     Else\n                     'do nothing\n                    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "save", "create-directory"], "comments": [{"owner": {"reputation": 1, "user_id": 5937109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bdca565d29397296bcc93b68f7c2b4?s=128&d=identicon&r=PG&f=1", "display_name": "mdillmon", "link": "https://stackoverflow.com/users/5937109/mdillmon"}, "edited": false, "score": 0, "creation_date": 1455748445, "post_id": 35460383, "comment_id": 58633816, "body": "I succeeded creating the folder, thanks to your help, but I am having trouble saving the file to the folder. I updated the post above with the changes."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455836466, "post_id": 35460383, "comment_id": 58680954, "body": "Please do not change your question. That invalidates the original question as well as the answers (and effort!) others have put into helping you. If you have a new question, ask a new question, with full information including HOW the code is not working."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455836514, "post_id": 35460383, "comment_id": 58680982, "body": "And just by the way: That should NOT be &quot;Exit Function&quot; at the end. Your code won&#39;t work that way. It should be End Function."}], "answers": [{"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1455724312, "post_id": 35461238, "comment_id": 58619046, "body": "that will not create the folder on the <i>current user</i>&#39;s desktop"}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1455725532, "post_id": 35461238, "comment_id": 58620013, "body": "Updated to take current user in to account"}, {"owner": {"reputation": 1, "user_id": 5937109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bdca565d29397296bcc93b68f7c2b4?s=128&d=identicon&r=PG&f=1", "display_name": "mdillmon", "link": "https://stackoverflow.com/users/5937109/mdillmon"}, "edited": false, "score": 0, "creation_date": 1455748223, "post_id": 35461238, "comment_id": 58633717, "body": "This was great for creating the folder, thank you. For some reason, it&#39;s not saving the document in that folder, though."}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1455783414, "post_id": 35461238, "comment_id": 58646426, "body": "Where is it saving? Are you getting any errors? On the off chance, try adding .xlsm to the file name. Also just seeing your edited code, have you declared the path strings? Add \\ after desktop in strPath."}], "tags": [], "owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "is_accepted": false, "score": 0, "last_activity_date": 1455726870, "last_edit_date": 1455726870, "creation_date": 1455723683, "answer_id": 35461238, "question_id": 35460383, "link": "https://stackoverflow.com/questions/35460383/edit-macro-to-create-folder-on-desktop-for-any-user/35461238#35461238", "title": "Edit Macro to create folder on desktop for any user", "body": "<pre><code>strPath = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\\"\nstrFolderName = \"test1\"\nstrFullPath = strPath &amp; strFolderName &amp; \"\\\"\n\n    If Dir(strPath &amp; strFolderName, vbDirectory) = \"\" Then\n    MkDir strFullPath\n    End If\n\nActiveWorkbook.SaveAs Filename:=strFullPath &amp; \"workbookname1\", _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1455724243, "creation_date": 1455724243, "answer_id": 35461461, "question_id": 35460383, "link": "https://stackoverflow.com/questions/35460383/edit-macro-to-create-folder-on-desktop-for-any-user/35461461#35461461", "title": "Edit Macro to create folder on desktop for any user", "body": "<pre><code>mkdir CreateObject(\"wscript.shell\").specialfolders(\"desktop\") &amp; \"\\MyFolder\"\n</code></pre>\n\n<p>should do the trick</p>\n"}], "owner": {"reputation": 1, "user_id": 5937109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bdca565d29397296bcc93b68f7c2b4?s=128&d=identicon&r=PG&f=1", "display_name": "mdillmon", "link": "https://stackoverflow.com/users/5937109/mdillmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3311, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455836652, "creation_date": 1455721667, "last_edit_date": 1455836652, "question_id": 35460383, "link": "https://stackoverflow.com/questions/35460383/edit-macro-to-create-folder-on-desktop-for-any-user", "title": "Edit Macro to create folder on desktop for any user", "body": "<p>I have a spreadsheet with a save button on every sheet. The buttons currently save the sheets onto any user's desktop as a PDF file. I was asked if I could possibly make the button create a new folder titled \"BSInHouseAssets\" on the desktop when doing this.  I am guessing that we would utilize MKdir at some point...but I need help.\nHere is the current portion of the macro that saves the file.</p>\n\n<pre><code>Function SpecialFolderPath() As String\n\n  Dim objWSHShell As Object\n  Dim strSpecialFolderPath\n\n  'On Error GoTo ErrorHandler\n  ' Create a shell object\n  Set objWSHShell = CreateObject(\"WScript.Shell\")\n  ' Find out the path to the passed special folder,\n  '  just change the \"Desktop\" for one of the other options\n  SpecialFolderPath = objWSHShell.SpecialFolders(\"desktop\")\n  ' Clean up\n  Set objWSHShell = Nothing\n  Exit Function\nErrorHandler:\n\n  MsgBox \"Error finding \" &amp; strSpecialFolder, vbCritical + vbOKOnly, \"Error\"\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "vb6"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5828099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8a37543882c7b52c7f823f1ab24e89a?s=128&d=identicon&r=PG&f=1", "display_name": "SamSam7", "link": "https://stackoverflow.com/users/5828099/samsam7"}, "edited": false, "score": 0, "creation_date": 1455740025, "post_id": 35462914, "comment_id": 58629258, "body": "Thanks, I&#39;ve actually decided to skip ACCESS all together. Going right from VB to Excel."}], "tags": [], "owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "is_accepted": true, "score": 0, "last_activity_date": 1455728084, "creation_date": 1455728084, "answer_id": 35462914, "question_id": 35460293, "link": "https://stackoverflow.com/questions/35460293/access-and-sql-server-for-reporting/35462914#35462914", "title": "Access and SQL Server for reporting", "body": "<p>Sounds like a great deal of jumping through hoops.</p>\n\n<p>A VB6 program or even a VBA macro can use Jet/ACE to connect to and extract data from SQL Server and then write the result as a Worksheet or Range in an Excel workbook, creating the workbook if necessary.  Probably a single SQL statement involved for a simple extract/export.  No need for Excel Automation at all.</p>\n"}], "owner": {"reputation": 51, "user_id": 5828099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8a37543882c7b52c7f823f1ab24e89a?s=128&d=identicon&r=PG&f=1", "display_name": "SamSam7", "link": "https://stackoverflow.com/users/5828099/samsam7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 35462914, "answer_count": 1, "score": -1, "last_activity_date": 1455728084, "creation_date": 1455721439, "question_id": 35460293, "link": "https://stackoverflow.com/questions/35460293/access-and-sql-server-for-reporting", "title": "Access and SQL Server for reporting", "body": "<p>Hopefully someone can help me understand/help how to proceed here. What I'm trying to do is this...I have a legacy VB6 application that has data stored in SQL Server, and all tables are connected to MS Access. I previously had a report done in Access however, the user requested that it be an extract in Excel. At this time I have a process in Access (Vba) that populates a tmp_table and my report uses the data from this table for the report. I'm trying to skip the Access report, and link the temp_table back to SQL Server 2012, so I can select the data and and create an Excel Extract. So what I'm hoping to do is this..</p>\n\n<ol>\n<li>Users click report button (pass two dates [from] and [to] to an empty form in Access</li>\n<li>Dates are used to run the process and populate the temp_table</li>\n<li>Link this table to SQL-SERVER 2012</li>\n<li>Select data, and manually build an extract in Excel</li>\n</ol>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1455721058, "post_id": 35460001, "comment_id": 58616488, "body": "Does it work this way? -&gt; <code>INSERT INTO [Standard Data] ([Entry Date]) SELECT [Entry Date] FROM [Task Copy] WHERE [Route Step]=&#39;Example Step&#39;</code>"}, {"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455721529, "post_id": 35460001, "comment_id": 58616850, "body": "Unfortunately it doesn&#39;t seem like that changed anything :( Thanks for the effort, though!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455721768, "post_id": 35460001, "comment_id": 58617035, "body": "Have you confirmed the <code>SELECT</code> piece returns at least one row?  In the Access query designer, <code>SELECT Count(*) FROM [Task Copy] WHERE [Route Step]=&#39;Example Step&#39;</code>"}, {"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455723118, "post_id": 35460001, "comment_id": 58618077, "body": "Actually your first comment was correct. My friend had modified the wrong button when he told me that didn&#39;t work.   Submit that as an answer and I&#39;ll accept it :)"}], "answers": [{"comments": [{"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "edited": false, "score": 0, "creation_date": 1455723134, "post_id": 35460550, "comment_id": 58618093, "body": "I agree completely about the name, sadly I inherited this :("}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1455732414, "post_id": 35460550, "comment_id": 58624535, "body": "I believe you meant <code>([Entry Date])</code>, not <code>[(Entry Date)]</code>."}], "tags": [], "owner": {"reputation": 2218, "user_id": 426733, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/S0V0P.jpg?s=128&g=1", "display_name": "GabrielVa", "link": "https://stackoverflow.com/users/426733/gabrielva"}, "is_accepted": false, "score": 0, "last_activity_date": 1455722058, "creation_date": 1455722058, "answer_id": 35460550, "question_id": 35460001, "link": "https://stackoverflow.com/questions/35460001/bracket-notation-for-sql-not-working-in-microsoft-access/35460550#35460550", "title": "Bracket notation for SQL not working in Microsoft Access", "body": "<p>Try this assuming you have the Database connection setup in Access:</p>\n\n<pre><code>INSERT INTO dbo.[Standard Data] [(Entry Date)] SELECT [Entry Date] FROM dbo.[Task Copy]  WHERE dbo.[Task Copy].[Route Step] = 'Example Step';\n</code></pre>\n\n<p>Not sure why your SQL tables have spaces in them, I would redo them and make them one word like StandardData for example. </p>\n"}, {"comments": [{"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "edited": false, "score": 0, "creation_date": 1455724001, "post_id": 35461346, "comment_id": 58618811, "body": "Thanks a lot for showing me how to enable warnings, it was so frustrating!  Thanks!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "edited": false, "score": 0, "creation_date": 1455724201, "post_id": 35461346, "comment_id": 58618972, "body": "You&#39;re welcome.  That approach requires more code than  <code>DoCmd.RunSQL</code>, but it&#39;s worthwhile because it can make troubleshooting much easier and faster.  And I <b>never</b> run code with <code>SetWarnings</code> off (False) --- that suppresses useful information."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1455723941, "creation_date": 1455723941, "answer_id": 35461346, "question_id": 35460001, "link": "https://stackoverflow.com/questions/35460001/bracket-notation-for-sql-not-working-in-microsoft-access/35461346#35461346", "title": "Bracket notation for SQL not working in Microsoft Access", "body": "<p>Specify the destination field name.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO [Standard Data] ([Entry Date])\nSELECT [Entry Date]\nFROM [Task Copy]\nWHERE [Route Step]='Example Step'\n</code></pre>\n\n<p>You confirmed that change was all you needed to make the <code>INSERT</code> work.</p>\n\n<p>However, I suggest you use a different approach to execute the <code>INSERT</code>.  This will give you better feedback than <code>DoCmd.RunSQL</code> ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim strInsert As String\nDoCmd.SetWarnings True\nstrInsert = \"INSERT INTO [Standard Data] ([Entry Date]) \" &amp; _\n    \"SELECT [Entry Date] FROM [Task Copy] WHERE [Route Step]='Example Step'\"\nDebug.Print strInsert '&lt;- inspect this in Immediate window; Ctrl+g will take you there\nSet db = CurrentDb\ndb.Execute strInsert, dbFailOnError\nDebug.Print db.RecordsAffected &amp; \" row(s) added\"\n</code></pre>\n"}], "owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 35461346, "answer_count": 2, "score": 2, "last_activity_date": 1455724034, "creation_date": 1455720756, "last_edit_date": 1455724034, "question_id": 35460001, "link": "https://stackoverflow.com/questions/35460001/bracket-notation-for-sql-not-working-in-microsoft-access", "title": "Bracket notation for SQL not working in Microsoft Access", "body": "<p>I'm working on the following SQL Statement used in VBA, in a Microsoft Access application.</p>\n\n<p>Our original code that works looks like this.</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO [Standard Data] SELECT * FROM [Task Copy] WHERE [Route Step]='Example Step'\"\n</code></pre>\n\n<p>Our problem is that we don't want the <code>ID</code> to be copied from <code>Standard Data</code>. So we want to do something like </p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO [Standard Data] SELECT FirstCol,SecondCol FROM [Task Copy] WHERE [Route Step]='Example Step'\"\n</code></pre>\n\n<p>This also works, the problem comes when we try to select a column with a space in it.\nThe code </p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO [Standard Data] SELECT [Entry Date] FROM [Task Copy] WHERE [Route Step]='Example Step'\"\n</code></pre>\n\n<p>Does not execute. When I click the button that triggers this code it never asks me to aprove the append to the table. </p>\n\n<p>Is there something wrong with the formating of my last statement? </p>\n"}, {"tags": ["sql-server", "vba", "db2", "ado"], "answers": [{"comments": [{"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1455780260, "post_id": 35464817, "comment_id": 58644811, "body": "Thanks for you answers. I should have mentioned that I do not actually have administrator rights to the database (its a work thing), so I am not capable of making those changes. It seems like I have to prompt the user for password when they connect to the DB2 database."}], "tags": [], "owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "is_accepted": false, "score": 0, "last_activity_date": 1455734267, "last_edit_date": 1455734267, "creation_date": 1455733792, "answer_id": 35464817, "question_id": 35459801, "link": "https://stackoverflow.com/questions/35459801/connect-to-db2-with-windows-credentials/35464817#35464817", "title": "Connect to DB2 with Windows credentials", "body": "<p>I'm assuming we are talking about DB2 for LUW.</p>\n\n<p>A simple way of doing this is to enable client-side authentication. Set the following instance configuration parameters on the DB2 server:</p>\n\n<pre><code>update dbm cfg using authentication client trust_clntauth client trust_allclnts yes\n</code></pre>\n\n<p>You will need to restart the instance for the changes to take effect (<code>db2stop</code>/<code>db2start</code>). </p>\n\n<p>On the client catalog the database in question with client-side authentication:</p>\n\n<pre><code>uncatalog db yourdb\ncatalog db yourdb at node whatever authentication client\n</code></pre>\n\n<p>These last two steps (<code>uncatalog</code>/<code>catalog</code>) may not be necessary if the database is currently cataloged without explicit server-side authentication option. </p>\n\n<p>Note that such configuration is not very secure, because it allows any Windows user to connect to the database (any database on the DB2 server, actually) without authentication once they log in to Windows. You may want to tighten up security on the database by revoking all grants from the PUBLIC pseudo-group and grant specific permissions to the application login ID only.</p>\n\n<p>Alternatively, you can enable Kerberos authentication, but it is a much more involved process, as <a href=\"http://www-01.ibm.com/support/knowledgecenter/SSEPGG_10.1.0/com.ibm.db2.luw.admin.sec.doc/doc/c0011990.html?lang=en\" rel=\"nofollow\">described in the manual</a>.</p>\n"}], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1123, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455734267, "creation_date": 1455720193, "question_id": 35459801, "link": "https://stackoverflow.com/questions/35459801/connect-to-db2-with-windows-credentials", "title": "Connect to DB2 with Windows credentials", "body": "<p>I am working on a VBA project, in which I need to connect to both and SQL- and a DB2-Database. I am using ADODB connection in both cases. The SQL works fine, and is using the Windows credentials. I can get the DB2 connection to work by passing the username and password, but not using Windows credentials (they are the same). Please see the connection string for examples:</p>\n\n<p><em>This SQL connection string works fine:</em></p>\n\n<pre><code>objConnection.connectionString = \"Provider=SQLOLEDB.1; Integrated Security=SSPI; Persist Security Info=False;Data Source= \" &amp; strServer &amp; \";Initial Catalog=\" &amp; strDatabase\n</code></pre>\n\n<p><em>This DB2 connection string works as well, as long as I pass the password in the open method:</em></p>\n\n<pre><code>strConnection = \"Provider=IBMDADB2.1; User ID=\" + nlUsername + \"; Data Source=DB_\" + strDatabase + \"; Persist Security Info=False\"\nobjConnection.Open(strConnection, nlUsername, nlPassword)\n</code></pre>\n\n<p><em>I wanted the SQL method on DB2 - So I tried this, which does <strong>NOT</strong> work:</em></p>\n\n<pre><code>objConnection.connectionString = \"Provider=IBMDADB2.1; Integrated Security=SSPI; Persist Security Info=False; Data Source=DB_\" &amp; strDatabase\n</code></pre>\n\n<p>Is it even possible to connect to DB2, without passing a username and password? I do I have to prompt the user for these in order to connect?</p>\n"}, {"tags": ["vba", "ms-access"], "owner": {"reputation": 83, "user_id": 5835602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vU53N.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5835602/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6951, "favorite_count": 0, "closed_date": 1550774552, "answer_count": 0, "score": 4, "locked_date": 1550774705, "last_activity_date": 1526583707, "creation_date": 1455719521, "question_id": 35459541, "link": "https://stackoverflow.com/questions/35459541/adding-line-numbers-to-vba-code-microsoft-access-2016", "closed_reason": "Duplicate", "title": "Adding line numbers to VBA code (Microsoft Access 2016)", "body": "<p>I want to be able to add line numbers to my VBA code so that I can use the erl function for error checking.  There is a tool-kit from www.fmsinc.com that might do the trick, but ideally, I'd like to be able code it myself so that I can also strip out the numbering if I need to.</p>\n\n<p>Is there a way that I can read/modify the VBA code from within the application (it's an .accdb file)?  Assuming that there is, I should be able to prefix specific lines containing code with a number.</p>\n"}, {"tags": ["vba", "excel", "class", "subclass"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1455726918, "post_id": 35459305, "comment_id": 58621030, "body": "Should the dataset hold a collection of patient objects in the end?"}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 2, "last_activity_date": 1455728423, "last_edit_date": 1455728423, "creation_date": 1455727828, "answer_id": 35462816, "question_id": 35459305, "link": "https://stackoverflow.com/questions/35459305/instantiating-objects-within-another-class-in-excel-vba/35462816#35462816", "title": "Instantiating objects within another class in Excel VBA", "body": "<p>The dataset will be better appointed something like this.</p>\n\n<p>I would call the class what it is intended to be, so <code>Patients</code>:</p>\n\n<pre><code>private colPatients as new collection\n\npublic function add(aPatient as patient)\n  colPatients.add aPatient, aPatient.Id\nend function\n\npublic property get count() as long\n  count = colPatients.count\nend property \n\npublic property get items() as collection\n  set items = colPatients\nend property \n\npublic property get item(vItem as variant) as patient\n  set item = colPatients(vItem)\nend property \n\npublic sub remove(vItem as variant)\n  colPatients.remove vItem\nend sub \n</code></pre>\n\n<p>So to use:</p>\n\n<pre><code>dim patientCollection as patients\nSub main()\n\nSet patientCollection = New patients\n\n'code to instantiate array of patient within data1 here\nIDs = Array(1,2,3)\ntreats = array(\"x\",\"y\",\"z\")\n\ndim x as integer\ndim p as patient\nfor x = lbound(IDs) to Ubound(IDs)\n   set p= new patient\n   p.id = IDs(x)\n   p.treatment = treats(x)\n   patientCollection.add p\n   set p = nothing\nnext x\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 4877640, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155546539710383/picture?type=large", "display_name": "Alex Wilding", "link": "https://stackoverflow.com/users/4877640/alex-wilding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1455728423, "creation_date": 1455719006, "last_edit_date": 1531164843, "question_id": 35459305, "link": "https://stackoverflow.com/questions/35459305/instantiating-objects-within-another-class-in-excel-vba", "title": "Instantiating objects within another class in Excel VBA", "body": "<p>I'm working on a project using Excel VBA where I have a number of datasets, each populated with a number of 'patients' which have a number of parameters (such as treatment, outcome etc.). To handle this, I intend to create a class called 'patient', with properties such as treatment and outcome. Then create a class called 'dataset', with a public property of 'patient'. I've created the classes, and I can instantiate a dataset object. But how do I go about instantiating patient object, or ideally an array of patient objects within the dataset object?</p>\n\n<p>Dataset class module:</p>\n\n<pre><code>Private pNumber As Integer\nPublic Patient As Patient\n\nPublic Property Get Number() As Integer\n    Number = pNumber\nEnd Property\nPublic Property Let Number(p As Integer)\n    pNumber = p\nEnd Property\n</code></pre>\n\n<p>Patient class module:</p>\n\n<pre><code>Private pID As Integer\nPrivate pTreatment As Boolean\nPrivate pResponse As Single\n\nPublic Property Get ID() As Integer\n    ID = pID\nEnd Property\nPublic Property Let ID(p As Integer)\n    pID = p\nEnd Property\n\nPublic Property Get Treatment() As Boolean\n    Treatment = pTreatment\nEnd Property\nPublic Property Let Treatment(p As Boolean)\n    pTreatment = p\nEnd Property\n\nPublic Property Get Response() As Single\n    Response = pResponse\nEnd Property\nPublic Property Let Response(p As Single)\n    pResponse = p\nEnd Property\n</code></pre>\n\n<p>Main Module</p>\n\n<pre><code>Sub main()\n\nDim data1 As Dataset\nSet data1 = New Dataset\n\n'code to instantiate array of patient within data1 here\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1455718902, "post_id": 35459239, "comment_id": 58614721, "body": "<b>1)</b> Is the file open? <b>2)</b> If so, try <code>Workbooks(mNummer &amp; &quot;_&quot; &amp; Jahr &amp; &quot;_&quot; &amp; Welle &amp; &quot;.xlsm&quot;).Activate</code> <b>3)</b> Even better try <code>Set wb = Workbooks(mNummer &amp; &quot;_&quot; &amp; Jahr &amp; &quot;_&quot; &amp; Welle &amp; &quot;.xlsm&quot;)</code> and work directly with the <code>wb</code> object (Dim wb as Workbook). <b>4)</b> Lastly, double-check that the string you build indeed produces a valid Workbook name according to your files."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455719178, "post_id": 35459239, "comment_id": 58614936, "body": "You might want to check in the direct window of the VBE what you&#39;re looking for: <code>?Windows(1).Caption</code>."}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1455719921, "post_id": 35459239, "comment_id": 58615588, "body": "? automatically converted to print and i got an error saying it is not allowed to use it"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1455725754, "post_id": 35459239, "comment_id": 58620184, "body": "Are you sure the variable name creates the correct string? Test this by making a String variable, making it equal to your formula, and then print it so you can see what it looks like [this is also what @Ralph was recommending, using the VB Editor window]."}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 0, "last_activity_date": 1455728535, "creation_date": 1455728535, "answer_id": 35463071, "question_id": 35459239, "link": "https://stackoverflow.com/questions/35459239/activating-a-variable-named-file/35463071#35463071", "title": "activating a variable named file", "body": "<p>Maybe change <code>Windows</code> to <code>Workbooks</code></p>\n"}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455728535, "creation_date": 1455718823, "question_id": 35459239, "link": "https://stackoverflow.com/questions/35459239/activating-a-variable-named-file", "title": "activating a variable named file", "body": "<pre><code>   Windows(mNummer &amp; \"_\" &amp; Jahr &amp; \"_\" &amp; Welle &amp; \".xlsm\").Activate\n</code></pre>\n\n<p>So here is my code;  mNummer,Jahr,Welle are variables and xlsm is the file type as you all know. I get an error when i want to activate this file. What is the reason for this ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455718407, "post_id": 35458823, "comment_id": 58614356, "body": "I recomment to use <code>ThisWorkbook</code> instead of <code>ActiveWorkbook</code>. <code>ActiveWorkbook</code> is not explicit whereas <code>ThisWorkbook</code> is and always refers to the Workbook / Excel File containing the macro which is being executed."}], "answers": [{"tags": [], "owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "is_accepted": false, "score": 0, "last_activity_date": 1455718114, "creation_date": 1455718114, "answer_id": 35458948, "question_id": 35458823, "link": "https://stackoverflow.com/questions/35458823/dealing-with-a-worksheet-name-with-spaces/35458948#35458948", "title": "Dealing with a worksheet name with spaces", "body": "<p>The code you posted should work fine, provided the workbook in question is the active workbook and has a worksheet named \"my worksheet name\" without any leading or trailing spaces.</p>\n\n<p>Try examining the worksheet names as follows:</p>\n\n<pre><code>For Each myWorksheet In myBook.Sheets\n    Debug.Print \"\"\"\" &amp; myWorksheet.Name &amp; \"\"\"\"\nNext myWorksheet\n</code></pre>\n\n<p>This encloses the name in quotes so you can easily see if the name has leading or trailing spaces.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11725513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cdaedfc5c9443170ee6ab22b96d5baf?s=128&d=identicon&r=PG&f=1", "display_name": "user11725513", "link": "https://stackoverflow.com/users/11725513/user11725513"}, "is_accepted": false, "score": 0, "last_activity_date": 1576658986, "last_edit_date": 1576658986, "creation_date": 1576657750, "answer_id": 59388120, "question_id": 35458823, "link": "https://stackoverflow.com/questions/35458823/dealing-with-a-worksheet-name-with-spaces/59388120#59388120", "title": "Dealing with a worksheet name with spaces", "body": "<p>Try using sheet name between single quotes as follows:</p>\n\n<pre><code>Set myWorksheet = myBook.Sheets(\"'my worksheet name'\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5931452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf58d87b8e1adda69f468c76ac028ca4?s=128&d=identicon&r=PG&f=1", "display_name": "infoseclearner1", "link": "https://stackoverflow.com/users/5931452/infoseclearner1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8558, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1616562100, "creation_date": 1455717802, "last_edit_date": 1531164843, "question_id": 35458823, "link": "https://stackoverflow.com/questions/35458823/dealing-with-a-worksheet-name-with-spaces", "title": "Dealing with a worksheet name with spaces", "body": "<p>I'm able to set a worksheet name without spaces and manipulate it with out issue. However, everything I've tried with spaces doesn't work. </p>\n\n<pre><code>Dim myBook As Workbook\nDim myWorksheet As Worksheet\nSet myBook = ActiveWorkbook\nSet myWorksheet = myBook.Sheets(\"my worksheet name\")\n</code></pre>\n\n<p>I've tried setting single quotes around it alone. </p>\n"}, {"tags": ["vba", "excel", "formula"], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 5356724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-aL7L8SwJhJs/AAAAAAAAAAI/AAAAAAAAADs/cpK5dDfxNLQ/photo.jpg?sz=128", "display_name": "Alen \u0160imunic", "link": "https://stackoverflow.com/users/5356724/alen-%c5%a0imunic"}, "edited": false, "score": 0, "creation_date": 1455721224, "post_id": 35458922, "comment_id": 58616612, "body": "Thank you Sir, you just made my day :)"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 5, "last_activity_date": 1455718042, "creation_date": 1455718042, "answer_id": 35458922, "question_id": 35458791, "link": "https://stackoverflow.com/questions/35458791/inserting-formula-in-excel-cell-with-vba-gone-wrong/35458922#35458922", "title": "Inserting formula in excel cell with VBA gone wrong?", "body": "<p>Use this line instead:</p>\n\n<pre><code>ActiveCell.Formula = \"=INDEX(MIBIE!D:D,MATCH(A3,MIBIE!A:A,0))\"\n</code></pre>\n\n<p>If you wanted to set the <code>FormulaR1C1</code> then you'd have to write something like this:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=INDEX(MIBIE!C[3],MATCH(R[2]C,MIBIE!C,0))\"\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 5356724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-aL7L8SwJhJs/AAAAAAAAAAI/AAAAAAAAADs/cpK5dDfxNLQ/photo.jpg?sz=128", "display_name": "Alen \u0160imunic", "link": "https://stackoverflow.com/users/5356724/alen-%c5%a0imunic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 35458922, "answer_count": 1, "score": 1, "last_activity_date": 1455718042, "creation_date": 1455717743, "question_id": 35458791, "link": "https://stackoverflow.com/questions/35458791/inserting-formula-in-excel-cell-with-vba-gone-wrong", "title": "Inserting formula in excel cell with VBA gone wrong?", "body": "<p>It seems that the formula I'm trying to insert using VBA isn't inserted correctly:</p>\n\n<pre><code>Range(\"H3\").Select\nActiveCell.FormulaR1C1 = \"=INDEX(MIBIE!D:D,MATCH(A3,MIBIE!A:A,0))\"\n</code></pre>\n\n<p>What I end up with in my cell is this:</p>\n\n<pre><code>=INDEX(MIBIE!D:(D);MATCH('A3';MIBIE!A:(A);0))\n</code></pre>\n\n<p>Which of course doesn't work, but what I'd need is the following:</p>\n\n<pre><code>=INDEX(MIBIE!D:D;MATCH(A3;MIBIE!A:A;0))\n</code></pre>\n\n<p>Any ideas how to fix this? I'm unfortunately unable to use cell reference using C[#] and R[#] as I have many cells I want to edit and it is unable to use columns and rows as a reference, but only the letters of those.</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["arrays", "excel", "vba", "userform"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455716830, "post_id": 35458356, "comment_id": 58613130, "body": "There is no way to save it in memory? I was hoping to avoid input to worksheet and then output to userform."}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 2, "creation_date": 1455716907, "post_id": 35458356, "comment_id": 58613204, "body": "I think one important thing to remember is that when there is no VBA code running all the information that you stored in memory is gone. So if you have no code running after the form is closed, you have lost your settings. You could choose to store that information in a textfile in the temp folder for instance. Makes it harder to retrieve the settings though."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1455722615, "post_id": 35458356, "comment_id": 58617675, "body": "@Tom Could you please delete your comment, or edit to reflect the fact that while a Dim&#39;d variable is lost after code stops, Public&#39;d variables are maintained as long as the workbook is open [and the module code is unedited]? See my answer below for details."}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1455720562, "post_id": 35458702, "comment_id": 58616107, "body": "Note that when a sub finishes executing, data remains available if variables have been declared public; however when a workbook is closed, even publicly declared variables are wiped out."}], "tags": [], "owner": {"reputation": 194, "user_id": 4133779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8629d548e974a439b6662f880ba45?s=128&d=identicon&r=PG&f=1", "display_name": "Sorcefyre", "link": "https://stackoverflow.com/users/4133779/sorcefyre"}, "is_accepted": false, "score": 1, "last_activity_date": 1455722783, "last_edit_date": 1455722783, "creation_date": 1455717482, "answer_id": 35458702, "question_id": 35458356, "link": "https://stackoverflow.com/questions/35458356/calling-an-array-upon-user-form-terminate-close-vba/35458702#35458702", "title": "Calling an Array Upon User Form Terminate/Close VBA", "body": "<p>Unfortunately, VBA doesn't support persistent memory storage when code goes out of scope (e.g., subroutine finishes executing).  There are some very archaic ways to write values directly to memory, but they are cumbersome and dangerous for those not familiar with the methodology.</p>\n\n<p>Possible solutions I can think of would be to take the data from the form, either directly or via an array, and write it to a hidden worksheet in Excel.  You could also store the data in a database or write it to a text file.  </p>\n\n<p>A hidden worksheet is easier to code since you're already working in the Excel reference library.  Writing to a database or a text file means setting or creating references to the applicable reference libraries and knowing the syntax of how to do those things.</p>\n"}, {"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1455723821, "post_id": 35458717, "comment_id": 58618646, "body": "So referring back to my original post, if store the values of the array as a public variable(outside a sub) then this might actually work? Super cool. I will def try it and see if this works."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1455723830, "post_id": 35458717, "comment_id": 58618658, "body": "Maybe you want to (even more so) elaborate upon your answer and state at the top that Doug could preserve the content of the form by merely hiding it and NOT unloading it. Also, he would have to remove the &quot;initialize&quot; sub. But I believe this is essentially what he is looking for (as long as the excel file stays open, no error occurs, and the form does not get changed)."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1455724327, "post_id": 35458717, "comment_id": 58619057, "body": "Thanks guys, I did do the research the in general details related to this issue (before asking) , and had played around with the hiding/unhiding option, but I was curious to this solution as well."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1455725281, "post_id": 35458717, "comment_id": 58619836, "body": "@DougCoats There may be reasons to close the userform, but if you can make it invisible instead, that will likely be easiest - keep in mind that even then, the userform will be lost when the file is closed."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 3, "last_activity_date": 1455723996, "last_edit_date": 1455723996, "creation_date": 1455717513, "answer_id": 35458717, "question_id": 35458356, "link": "https://stackoverflow.com/questions/35458356/calling-an-array-upon-user-form-terminate-close-vba/35458717#35458717", "title": "Calling an Array Upon User Form Terminate/Close VBA", "body": "<p><strong>For userforms in particular</strong></p>\n\n<p>As pointed out by @Ralph, instead of closing down the userform, you can merely make the userform invisible. This will retain all information on the form without you needing to transfer the data to other variables, and is likely the simplest option presuming closing the form is not necessary.</p>\n\n<p><strong>If your variables only need to survive while the workbook is open:</strong></p>\n\n<p>You can maintain variables after a sub has run, by declaring that variable as Public, at the module level, before declaring a Sub. For example, the below module code holds the value of i throughout the duration of the workbook, and every time either button is clicked, i is manipulated and retained for further use.</p>\n\n<pre><code>Public i As Integer\n\nSub Button1_Click()\n    i = i + 1\n    Range(\"A1\").Value = i\nEnd Sub\n\nSub Button2_Click()\n    i = i + 1\n    Range(\"A1\").Value = i\nEnd Sub\n</code></pre>\n\n<p>Note that it is generally considered good practice to limit the use of public variables as long as possible; sticking with variables declared at the subroutine level allow a user to more easily identify which variables are actually required for code to be run, particularly because it is common (although poor practice) to use a variable in VBA that has not yet been declared. Unnecessary usage of public variables may encourage laziness.</p>\n\n<p><strong>If your variables need to survive the workbook closing and opening:</strong></p>\n\n<p>If you want to store data like this in between opening and closing a workbook, you have a few options to make it so the data is not visible to your users [for various reasons]:</p>\n\n<p>-You can keep an empty sheet which drops in the array values, and then have that sheet hidden  and protected. This is one of the simplest ways to store an array of data, as long as confidentiality is not a concern [because data stored in a worksheet can be trivially accessed by a committed user, whether the workbook is password protected or not]</p>\n\n<p>-You can store the data in another file, which Excel then pulls into an array on starting. This has the advantage of keeping your original file smaller, and if confidentiality is a concern, you can have the additional file stored in a network location to which only some users have access.</p>\n\n<p>-You can create invisible shapes and edit internal properties of those shapes, such as their titles. This data is potentially accessible but unobtrusive to the user; probably not a great option for an array of data, but it may be.</p>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1474002618, "creation_date": 1455716510, "last_edit_date": 1474002618, "question_id": 35458356, "link": "https://stackoverflow.com/questions/35458356/calling-an-array-upon-user-form-terminate-close-vba", "title": "Calling an Array Upon User Form Terminate/Close VBA", "body": "<p>I have an issue where I'd like to store the contents of a userform in an array when the userform is closed. I thought I had the syntax correct but it seems not to repopulate upon userform initialize. I tried putting the array in its own module and this did not work either. Anyone care to enlighten me?</p>\n\n<p>Sample code:</p>\n\n<pre><code>Public Sub DPArrayStuff()\n\nDim DP(2)\nDP(0) = Block1\nDP(1) = Block2\nDP(2) = Block3\n\nEnd Sub\n\nPrivate Sub userform_terminate()\n\nIf Block1.Value &lt;&gt; vbNullString Then Call DPArrayStuff\n\nEnd Sub\n\nPrivate Sub userform_Initialize()\n\nIf DP(0) &lt;&gt; vbNUllString Then \n    Block1 = DP(0)\n    Block2 = DP(1)\n    Block3 = DP(2)\nEnd If\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1082, "user_id": 3129954, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f43a71ffc579d42bc321f7cf49734fa6?s=128&d=identicon&r=PG&f=1", "display_name": "IgorM", "link": "https://stackoverflow.com/users/3129954/igorm"}, "edited": false, "score": 0, "creation_date": 1455716489, "post_id": 35457990, "comment_id": 58612886, "body": "&quot;WHERE [OD] BETWEEN (&quot; &amp; ArgCount - 5 &amp; &quot; AND &quot; &amp; ArgCount + 5 &amp; &quot;)&quot;"}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "reply_to_user": {"reputation": 1082, "user_id": 3129954, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f43a71ffc579d42bc321f7cf49734fa6?s=128&d=identicon&r=PG&f=1", "display_name": "IgorM", "link": "https://stackoverflow.com/users/3129954/igorm"}, "edited": false, "score": 0, "creation_date": 1455783458, "post_id": 35457990, "comment_id": 58646459, "body": "Hi Igor, can you explain where to add this in to the above code, I&#39;ve tried on the addtowhere [OD],&quot;[OD]&quot; ..... line, but it doesnt seem to work"}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1455786945, "post_id": 35461234, "comment_id": 58648456, "body": "hi Gustav, how do i introduce this into the code above?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1455790156, "post_id": 35461234, "comment_id": 58650811, "body": "You may have to modify your <code>AddToWhere</code> function to take care of that."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1455723675, "creation_date": 1455723675, "answer_id": 35461234, "question_id": 35457990, "link": "https://stackoverflow.com/questions/35457990/how-to-add-search-criteria-for-a-range-of-values-in-msaccess-2003/35461234#35461234", "title": "how to add search criteria for a range of values in msaccess 2003", "body": "<blockquote>\n  <p>the user enters 60 as the [OD] - I want the code to return records\n  with an [OD] between 55 and 65 ([60] +/- 5).</p>\n</blockquote>\n\n<p>You can use <em>Abs</em> for this:</p>\n\n<pre><code>Where Abs([Enter OD] - [OD]) &lt;= 5\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455723675, "creation_date": 1455715510, "question_id": 35457990, "link": "https://stackoverflow.com/questions/35457990/how-to-add-search-criteria-for-a-range-of-values-in-msaccess-2003", "title": "how to add search criteria for a range of values in msaccess 2003", "body": "<p>I am using the code below to filter a query to return values entered in search fields on a form.</p>\n\n<p>how can I modify the code, to allow my user to search for records with values greater than or less than a number in the search field.</p>\n\n<p>for example the user enters 60 as the [OD] - I want the code to return records with an [OD] between 55 and 65 ([60] +/- 5).</p>\n\n<p>since i'm using the addtowhere function below, I don't know how to modify this code.</p>\n\n<p>can anyone help?</p>\n\n<pre><code>Public Sub cmdSearch_Click()\n\n'  Create a WHERE clause using search criteria entered by user and\n'  set RecordSource property of SEARCH QUOTE SUBform.\nIf Me.[Goodsinsub].Form.Recordset.RecordCount = 0 Then Me.Goodsinsub.Form.Command95.Visible = False Else Me.Goodsinsub.Form.Command95.Visible = True\nDim MySQL As String, MyCriteria As String, myrecordsource As String\nDim ArgCount As Integer\nDim tmp As Variant\nDim mycontrol As Control\n\n'  Initialize argument count.\nArgCount = 0\n\n'  Initialize SELECT statement.\nMySQL = \"SELECT * FROM [qry_tubes out] WHERE\"\nMyCriteria = \"\"\n\n'  Use values entered in text boxes in form header to create criteria for WHERE clause.\nAddToWhere [Combo30], \"[product]\", MyCriteria, ArgCount\nAddToWhere [OD], \"[OD]\", MyCriteria, ArgCount\nAddToWhere [ID], \"[ID]\", MyCriteria, ArgCount\nAddToWhere [LG], \"[LG]\", MyCriteria, ArgCount\n\n'  If no criterion specifed, return all records.\nIf MyCriteria = \"\" Then\n    MyCriteria = \"True\"\nEnd If\n\n'  Create SELECT statement.\nmyrecordsource = MySQL &amp; MyCriteria\n\n'  Set RecordSource property of Find Customers Subform.\nMe![Goodsinsub].Form.RecordSource = myrecordsource\n\n'  If no records match criteria, display message.\n'  Move focus to Clear button.\nIf Me![Goodsinsub].Form.RecordsetClone.RecordCount = 0 Then\ntmp = EnableControls(\"detail\", True)\nMsgBox \"No records found\"\nElse\n    '  Enable control in detail section.\n    tmp = EnableControls(\"Detail\", True)\n    '  Move insertion point to Find Customers Subform.\n    Me![Goodsinsub].Visible = True\n\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ftp", "sftp"], "comments": [{"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1455904542, "post_id": 35457719, "comment_id": 58714233, "body": "Not directly related to your question, but you should use <code>Resume</code> to exit your error handling block, not <code>GoTo</code>. Using <code>GoTo</code> like this means you can&#39;t use any error handling after that point."}, {"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "reply_to_user": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1455920713, "post_id": 35457719, "comment_id": 58722974, "body": "@Kyle I can use it under the next goto can&#39;t i?"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1456468500, "post_id": 35457719, "comment_id": 58970747, "body": "@Kyle is correct - by using GoTo here, you cannot have any further error handling in the subroutine as Excel considers all code from that point onward to be part of the initial error handling. To be clear, this means that if you encounter another error after the &quot;ContinuePoint&quot; reference, Excel will not handle it properly. If you change the line to &quot;Resume ContinuePoint&quot; then you will have proper error handling. See <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/errorhandling.htm</a> for more information on error handling (note the &quot;The Resume Statement&quot; section)."}], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1456138026, "last_edit_date": 1456138026, "creation_date": 1456106969, "answer_id": 35544724, "question_id": 35457719, "link": "https://stackoverflow.com/questions/35457719/upload-with-vba-via-sftp-ftp-log-outputs-to-detect-errors/35544724#35544724", "title": "Upload with VBA via sFTP &amp; FTP, log outputs to detect errors", "body": "<p>OK.. after some trial and error finally I found the problem, with assumption that all value in given parameters is valid the problem are:</p>\n\n<ol>\n<li>missing the <code>-l</code> option before <code>username</code> (<code>line 34</code>)</li>\n<li>missing the <code>hostname</code> (<code>line 34</code>)</li>\n<li><code>sFolder</code> not set or empty string (<code>line 40</code>) - may cause a problem - file not found</li>\n</ol>\n\n<p>Code on <code>line 34</code>:</p>\n\n<pre><code> sFTPDetails = \"C:\\psftp.exe -b C:\\commands.tmp user@ex.server.com -pw password\"\n</code></pre>\n\n<p>The right code should be:</p>\n\n<pre><code> sFTPDetails = \"C:\\psftp.exe -b C:\\commands.tmp -l user@ex.server.com -pw password ftp.server.com\"\n</code></pre>\n\n<p>As prevention may be you can generate your command using parameter/variable that described earlier in the code. Also there is a little hint to debug your code by <em>write</em> it directly to <code>Cells</code> value so later can be tested in command prompt</p>\n\n<pre><code>   ' UPLOAD SECOND FILE VIA SFTP\n\n    'Build up the necessary parameters\n    sHost = \"ftp.server.com\"\n    sUser = \"user@server.com\"\n    sPass = \"password\"\n    sSrc = \"\"\"\" &amp; Environ(\"TEMP\") &amp; \"\\\" + file &amp; \".txt\" &amp; \"\"\"\"\n    sDest = \"/remote/folder/\"\n    sFolder = \"C:\"\n    sFTP = \"C:\\psftp.exe\"\n\n    sFTPCmds2 = sFolder &amp; \"\\\" &amp; \"commands.tmp\"\n    sFTPDetails = sFTP &amp; \" -b \" &amp; sFTPCmds2 &amp; \" -1 \" &amp; sUser &amp; \" -pw \" &amp; sPass &amp; \" \" &amp; sHost\n\n    'FOR DEBUG\n    Sheets(1).Cells(1,1) = sFTPDetails\n\n    'Write the FTP commands to a file\n    iFNum = FreeFile\n    Open sFTPCmds2 For Output As #iFNum\n        Print #iFNum, \"cd \" &amp; sDest\n        Print #iFNum, \"put \" &amp; sSrc\n        Print #iFNum, \"quit\"\n        Print #iFNum, \"bye\"\n    Close #iFNum\n\n    'Upload the file\n    Call Shell(sFTPDetails, vbNormalFocus)\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n</code></pre>\n\n<p>If this code not running then may be something wrong with parameter values, to see that you can just copy paste value in <code>Sheet1!A1</code> and run it manually from command prompt..and don't forget to comment out <code>line 58</code> before debugging so the file needed not deleted</p>\n"}, {"comments": [{"owner": {"reputation": 2344, "user_id": 757661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22d55e7c13896272c09c997eeba72318?s=128&d=identicon&r=PG", "display_name": "gordon613", "link": "https://stackoverflow.com/users/757661/gordon613"}, "edited": false, "score": 1, "creation_date": 1580912384, "post_id": 35644297, "comment_id": 106254078, "body": "Great code! Thank you. I made two minor changes to work with my system. Firstly my WinSCP is stored in Program Files so I needed to add quotation marks. <code>sWinSCP = Chr(34) + &quot;C:\\Program Files (x86)\\WinSCP\\WinSCP.exe&quot; + Chr(34)</code> and secondly I use Explicit encryption, so I added <code>&amp; &quot; -explicittls&quot; </code> to the line beginning <code>ObjFile.writeline &quot;open &quot; &amp; sType &amp; sUser</code>"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": false, "score": 3, "last_activity_date": 1456465152, "creation_date": 1456465152, "answer_id": 35644297, "question_id": 35457719, "link": "https://stackoverflow.com/questions/35457719/upload-with-vba-via-sftp-ftp-log-outputs-to-detect-errors/35644297#35644297", "title": "Upload with VBA via sFTP &amp; FTP, log outputs to detect errors", "body": "<p>Is it a requirement to use Putty? I recommend <a href=\"https://winscp.net/eng/download.php\" rel=\"nofollow\">WinSCP</a> for FTP operations within VBA. There is actually a .NET assembly/COM library available for easy automation with VBA (even easier than my below example). That said, my corporate environment prohibits users from installing .NET/COM (for good reason), so I wrote my own code, simplified below.</p>\n\n<p>To use the below, download the Portable executables from the above link as you will need WinSCP.com for the scripting.</p>\n\n<p>This example has the following features:</p>\n\n<ul>\n<li>Uses the same protocol (WinSCP) for both FTP and SFTP transfers</li>\n<li>Writes a condensed, machine-readable XML log as well as a full text\nlog to files</li>\n<li>Uses batch files rather than direct Shell() executions; this allows\nyou to pause the code (or comment out the final Kill statements) to\nview original command and batch files for easy debugging.</li>\n<li>Displays a user-friendly error message from attempts to parse the XML\nlog; retains the XML and txt log (with no password data) for later\nreview.</li>\n</ul>\n\n<p>Sub to upload the FTP and SFTP data:</p>\n\n<pre><code>Public Sub FTPUpload()\n'Execute the upload commands\n\n'Create the commands file\nDim ObjFSO As Object\nDim ObjFile As Object\nDim ObjShell As Object\nDim ErrorCode As Integer\nDim sTempDir As String\nDim sType As String\nDim sUser As String\nDim sPass As String\nDim sServer As String\nDim sHostKey As String\nDim file As String 'Using your variable name here.\nDim sLocal As String\nDim sRemote As String\nDim sWinSCP As String\n\n''''''''''''''''''''''''''''''''''''''''''''\n'Set FTP Options\n''''''''''''''''''''''''''''''''''''''''''''\nsTempDir = Environ(\"TEMP\") &amp; \"\\\" 'Log/batch files will be stored here.\nsType = \"ftp://\" 'Or use \"sftp://\"\nsUser = \"user\"\nsPass = \"password\"\nfile = \"example.txt\" 'Assuming you will set this earlier in your code\nsServer = \"ftp.server.com\"\nsLocal = Chr(34) &amp; Environ(\"TEMP\") &amp; \"\\\" &amp; file &amp; Chr(34) 'Note that I included the full filename in the file variable; change this as necessary.\nsRemote = \"/remote/folder\"\nsWinSCP = \"C:\\Path\\To\\WinSCP\\WinSCP.com\"\n'''''''''''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''\n'Create batch file and command script\n'''''''''''''''''''''''''''''''''''''''''''''\nOn Error Resume Next\n'Delete existing files\nKill sTempDir &amp; \"winscp.txt\"\nKill sTempDir &amp; \"winscp.bat\"\nKill sTempDir &amp; \"winscplog.xml\"\nKill sTempDir &amp; \"winscplog.txt\"\nOn Error GoTo 0\n\nSet ObjFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet ObjFile = ObjFSO.CreateTextFile(sTempDir &amp; \"winscp.txt\", True)\nObjFile.writeline \"open \" &amp; sType &amp; sUser &amp; \":\" &amp; sPass &amp; \"@\" &amp; sServer &amp; \"/\" &amp; IIf(sHostKey &lt;&gt; vbNullString, \" -hostkey=\" &amp; Chr(34) &amp; sHostKey &amp; Chr(34), vbNullString)\nObjFile.writeline \"put \" &amp; sLocal &amp; \" \" &amp; sRemote\nObjFile.writeline \"close\"\nObjFile.writeline \"exit\"\nObjFile.Close\nSet ObjFile = Nothing\nSet ObjFile = ObjFSO.CreateTextFile(sTempDir &amp; \"\\winscp.bat\", True)\nObjFile.writeline sWinSCP &amp; \" /script=\" &amp; sTempDir &amp; \"winscp.txt /xmllog=\" &amp; sTempDir &amp; \"winscplog.xml /log=\" &amp; sTempDir &amp; \"winscplog.txt\"\nObjFile.Close\nSet ObjFile = Nothing\nSet ObjFSO = Nothing\n'''''''''''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''\n'Execute batch file and process output log\n'''''''''''''''''''''''''''''''''''''''''''''\nSet ObjShell = VBA.CreateObject(\"WScript.Shell\")\nErrorCode = ObjShell.Run(sTempDir &amp; \"\\winscp.bat\", 0, True)\nSet ObjShell = Nothing\nIf CheckOutput(sTempDir) &lt;&gt; \"All FTP operations completed successfully.\" Then\n    MsgBox CheckOutput(sTempDir)\nElseIf ErrorCode &gt; 0 Then\n    MsgBox \"Excel encountered an error when attempting to run the FTP program. Error code: \" &amp; ErrorCode\nElse\n    MsgBox \"All FTP operations completed successfully.\"\nEnd If\n'''''''''''''''''''''''''''''''''''''''''''''\n\n'Done with the FTP transfer. If you want to SFTP transfer immediately thereafter, use the below code\n''''''''''''''''''''''''''''''''''''''''''''\n'Re-set FTP Options\n''''''''''''''''''''''''''''''''''''''''''''\nsType = \"sftp://\"\n'sHostKey = \"ssh-rsa 1024 9d:d9:e9:69:db:cf:9c:71:8d:cb:da:a5:cf:a7:41:a7\" 'Set this if you have a hostkey that should be auto-accepted\n'I assume all other options are the same, but you can change user, password, server, etc. here as well. \n'Note that all code from here down is exactly the same as above; only the options have changed.\n''''''''''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''\n'Create batch file and command script\n'''''''''''''''''''''''''''''''''''''''''''''\nOn Error Resume Next\n'Delete existing files\nKill sTempDir &amp; \"winscp.txt\"\nKill sTempDir &amp; \"winscp.bat\"\nKill sTempDir &amp; \"winscplog.xml\"\nKill sTempDir &amp; \"winscplog.txt\"\nOn Error GoTo 0\n\nSet ObjFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet ObjFile = ObjFSO.CreateTextFile(sTempDir &amp; \"winscp.txt\", True)\nObjFile.writeline \"open \" &amp; sType &amp; sUser &amp; \":\" &amp; sPass &amp; \"@\" &amp; sServer &amp; \"/\" &amp; IIf(sHostKey &lt;&gt; vbNullString, \" -hostkey=\" &amp; Chr(34) &amp; sHostKey &amp; Chr(34), vbNullString)\nObjFile.writeline \"put \" &amp; sLocal &amp; \" \" &amp; sRemote\nObjFile.writeline \"close\"\nObjFile.writeline \"exit\"\nObjFile.Close\nSet ObjFile = Nothing\nSet ObjFile = ObjFSO.CreateTextFile(sTempDir &amp; \"\\winscp.bat\", True)\nObjFile.writeline sWinSCP &amp; \" /script=\" &amp; sTempDir &amp; \"winscp.txt /xmllog=\" &amp; sTempDir &amp; \"winscplog.xml /log=\" &amp; sTempDir &amp; \"winscplog.txt\"\nObjFile.Close\nSet ObjFile = Nothing\nSet ObjFSO = Nothing\n'''''''''''''''''''''''''''''''''''''''''''''\n\n'''''''''''''''''''''''''''''''''''''''''''''\n'Execute batch file and process output log\n'''''''''''''''''''''''''''''''''''''''''''''\nSet ObjShell = VBA.CreateObject(\"WScript.Shell\")\nErrorCode = ObjShell.Run(sTempDir &amp; \"\\winscp.bat\", 0, True)\nSet ObjShell = Nothing\nIf CheckOutput(sTempDir) &lt;&gt; \"All FTP operations completed successfully.\" Then\n    MsgBox CheckOutput(sTempDir)\nElseIf ErrorCode &gt; 0 Then\n    MsgBox \"Excel encountered an error when attempting to run the FTP program. Error code: \" &amp; ErrorCode\nElse\n    MsgBox \"All FTP operations completed successfully.\"\nEnd If\n'''''''''''''''''''''''''''''''''''''''''''''\n\nExit_Upload:\n    On Error Resume Next\n    'Clean up (leave log files)\n    Kill sTempDir &amp; \"winscp.txt\" 'Remove scripting commands (note: this file will contain the password)\n    Kill sTempDir &amp; \"winscp.bat\" 'Remove batch file\n    'Clear all objects\n    Set ObjFSO = Nothing\n    Set ObjFile = Nothing\n    Set ObjShell = Nothing\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Function to check the output log and return a message for the user:</p>\n\n<pre><code>Private Function CheckOutput(sLogDir As String) As String\n\nDim ObjFSO As Object\nDim ObjFile As Object\nDim StrLog As String\n\n'Open log file\nSet ObjFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet ObjFile = ObjFSO.OpenTextFile(sLogDir &amp; \"winscplog.xml\")\nStrLog = ObjFile.readall\nObjFile.Close\nSet ObjFile = Nothing\nSet ObjFSO = Nothing\n\n'Check log file for issues\nIf InStr(1, StrLog, \"&lt;message&gt;Authentication failed.&lt;/message&gt;\") &gt; 0 Then\n    CheckOutput = \"The supplied password was rejected by the server. Please try again.\"\nElseIf InStr(1, StrLog, \"&lt;failure&gt;\") Then\n    If InStr(1, StrLog, \"&lt;message&gt;Can't get attributes of file\") &gt; 0 Then\n        CheckOutput = \"The requested file does not exist on the FTP server or local folder.\"\n    Else\n        CheckOutput = \"One or more attempted FTP operations has failed.\"\n    End If\nElseIf InStr(1, StrLog, \" &lt;result success=\" &amp; Chr(34) &amp; \"false\" &amp; Chr(34)) &gt; 0 Then\n    CheckOutput = \"One or more attempted FTP operations has failed.\"\nElseIf InStr(1, StrLog, \" &lt;result success=\" &amp; Chr(34) &amp; \"true\" &amp; Chr(34)) = 0 Then\n    CheckOutput = \"No FTP operations were performed. This may indicate that no files matching the file mask were found.\"\nEnd If\n\n'Enter success message or append log file details.\nIf CheckOutput = vbNullString Then\n    CheckOutput = \"All FTP operations completed successfully.\"\nElse\n    CheckOutput = CheckOutput &amp; vbLf &amp; vbLf &amp; \"Please see the below files for additional information. Note that passwords are not logged for security reasons.\" &amp; _\n    vbLf &amp; \"Condensed log: \" &amp; sLogDir &amp; \"winscplog.xml\" &amp; vbLf &amp; \"Complete log: \" &amp; sLogDir &amp; \"winscplog.txt\"\nEnd If\n\nExit_CheckOutput:\nOn Error Resume Next\nSet ObjFile = Nothing\nSet ObjFSO = Nothing\nExit Function\n\nEnd Function\n</code></pre>\n\n<p>Note: the actual code that I use is significantly more detailed, as it allows for more (S)FTP operations than uploading, uses an FTP class to utilize objects instead, and more. I think that goes a bit beyond a SO answer, but I am happy to post if it would be helpful.</p>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9311, "favorite_count": 2, "accepted_answer_id": 35544724, "answer_count": 2, "score": 4, "last_activity_date": 1456465152, "creation_date": 1455714711, "last_edit_date": 1456023656, "question_id": 35457719, "link": "https://stackoverflow.com/questions/35457719/upload-with-vba-via-sftp-ftp-log-outputs-to-detect-errors", "title": "Upload with VBA via sFTP &amp; FTP, log outputs to detect errors", "body": "<p>I wrote the following code to try and upload to two different servers one via ftp and one via sftp.</p>\n\n<p>I would like to know if there is a better way to upload via SFTP because the current method as I have it doesn't trigger the FTP error if it fails on any part.</p>\n\n<p>I guess a work around and something I would like to have is for both of them to log the output to a text file and then from that I can see what the error was manually and if I want setup a simple read log, check error, if x do y...</p>\n\n<pre><code>        On Error GoTo Err_FTPFile\n\n        ' UPLOAD FIRST FILE VIA FTP\n\n        'Build up the necessary parameters\n        sHost = \"ftp.server.com\"\n        sUser = \"user@server.com\"\n        sPass = \"password\"\n        sSrc = \"\"\"\" + Environ(\"TEMP\") + \"\\\" + file + \".txt\" + \"\"\"\"\n        sDest = \"/remote/folder/\"\n\n        'Write the FTP commands to a file\n        iFNum = FreeFile\n        sFTPCmds1 = Environ(\"TEMP\") &amp; \"\\\" &amp; \"FTPCmd1.tmp\"\n        Open sFTPCmds1 For Output As #iFNum\n            Print #iFNum, \"ftp\"\n            Print #iFNum, \"open \" &amp; sHost\n            Print #iFNum, sUser\n            Print #iFNum, sPass\n            Print #iFNum, \"cd \" &amp; sDest\n            Print #iFNum, \"put \" &amp; sSrc\n            Print #iFNum, \"disconnect\"\n            Print #iFNum, \"bye\"\n        Close #iFNum\n\n        'Upload the file\n        Shell Environ(\"WINDIR\") &amp; \"\\System32\\ftp.exe -s:\" &amp; sFTPCmds1\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n\n        ' UPLOAD SECOND FILE VIA SFTP\n\n        'Build up the necessary parameters\n        sFTPDetails = \"C:\\psftp.exe -b C:\\commands.tmp user@ex.server.com -pw password\"\n        sSrc = \"\"\"\" + Environ(\"TEMP\") + \"\\\" + file + \".txt\" + \"\"\"\"\n        sDest = \"/remote/folder/\"\n\n        'Write the FTP commands to a file\n        iFNum = FreeFile\n        sFTPCmds2 = sFolder &amp; \"\\\" &amp; \"commands.tmp\"\n        Open sFTPCmds2 For Output As #iFNum\n            Print #iFNum, \"cd \" &amp; sDest\n            Print #iFNum, \"put \" &amp; sSrc\n            Print #iFNum, \"quit\"\n            Print #iFNum, \"bye\"\n        Close #iFNum\n\n        'Upload the file\n        Call Shell(sFTPDetails, vbNormalFocus)\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n\nExit_FTPFile:\n        On Error Resume Next\n        Close #iFNum\n\n        'Delete the temp FTP command file\n        Kill sFTPCmds1\n        Kill sFTPCmds2\n        Kill Environ(\"TEMP\") + file + \".txt\"\n\n        GoTo ContinuePoint\n\nErr_FTPFile:\n        Shell \"C:\\FailPushBullet.exe\"\n        MsgBox Err.Number &amp; \" - \" &amp; Err.Description &amp; \" Failed.\", vbOKOnly, \"Error\"\n        GoTo ContinuePoint\n\nContinuePoint:\n' Do stuff\n</code></pre>\n\n<p>I ideally would like the SFTP one at the bottom to work and function exactly like the FTP one from above.</p>\n\n<p>I tried the following and this runs:</p>\n\n<pre><code>    sClient = \"C:\\psftp.exe\"\n    sArgs = \"user@website.com -pw passexample -b C:\\commands.tmp\"\n    sFull = sClient &amp; \" \" &amp; sArgs\n\n    sSrc = \"\"\"\" + Environ(\"TEMP\") + \"\\\" + \"test\" + \".txt\" + \"\"\"\"\n    sDest = \"folder\"\n\n    'Write the FTP commands to a text file\n    iFNum = FreeFile\n    sFTPCmds = \"C:\\\" &amp; \"commands.tmp\"\n    Open sFTPCmds For Output As #iFNum\n        Print #iFNum, \"cd \" &amp; sDest\n        Print #iFNum, \"put \" &amp; sSrc\n        Print #iFNum, \"quit\"\n        Print #iFNum, \"bye\"\n    Close #iFNum\n\n    'Upload the file\n    Call Shell(sFull, vbNormalFocus)\n</code></pre>\n\n<p>But if I change the sArgs to <code>sArgs = \"user@website.com -pw passexample -b C:\\commands.tmp 1&gt; log.txt\"</code> it doesn't run, it just closes without doing anything. I thought <code>1&gt; log.txt</code> is supposed to put the output into a file</p>\n"}, {"tags": ["excel", "date", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455715423, "post_id": 35457661, "comment_id": 58612164, "body": "try this <code>Format(Plan1.Cells(pos, 5).Value, &quot;dd&#47;mm&#47;yyyy&quot;)</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1455716070, "post_id": 35457661, "comment_id": 58612622, "body": "Dates are not stored in worksheets as &quot;dmy&quot; or &quot;mdy&quot; or &quot;ymd&quot;.  They are stored as the number of days since 1900.  For 5Mar2016 that number is 42434.  Excel displays 42434 as a date because the number format tells it to.  What does <code>Plan1.Cells(pos, 5).Value</code> contain."}, {"owner": {"reputation": 15, "user_id": 5806349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03685709489174081ef097aea76572e?s=128&d=identicon&r=PG&f=1", "display_name": "Philipe Atela", "link": "https://stackoverflow.com/users/5806349/philipe-atela"}, "edited": false, "score": 0, "creation_date": 1455716952, "post_id": 35457661, "comment_id": 58613233, "body": "I actually also still had a problem with my writing from the userform to the worksheet, so of my some dates were actually being written to the worksheet on the wrong format. That made me think the problem as on the conversion from sheet to userform, when actually the format was already wrong on the worksheet. Thank you all for your help! (And for suggesting that I confirmed what was written on that cell)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1455717644, "post_id": 35457661, "comment_id": 58613784, "body": "<code>? Format(42434,&quot;dd&#47;mm&#47;yyyy&quot;)</code> in the Immediate Window produces <code>05&#47;03&#47;2016</code>.  To me it appears <code>Plan1.Cells(pos, 5).Value</code> does not contain 42434."}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1455716288, "last_edit_date": 1455716288, "creation_date": 1455715676, "answer_id": 35458042, "question_id": 35457661, "link": "https://stackoverflow.com/questions/35457661/dates-from-excel-worksheet-to-userform-in-dd-mm-yyy-format/35458042#35458042", "title": "Dates from excel worksheet to userform in dd/mm/yyy format?", "body": "<p>I (personally) favor the solution of constructing the format myself. This is probably due to the fact that I have worked for several year in a corporate environment where I had to deal with Russian, Hungarian, German, USA, Chinese, and many other date formats. Some of them follow strange formats such as <code>YYYY. MMMM D.</code>. Anyway, in your case I would therefore propose the following:</p>\n\n<pre><code>Dim dttDate As Date\n\ndttDate = CDate(Plan1.Cells(pos, 5).Value)\nMe.Label2_Prazo.Caption = Right(\"0\" &amp; Day(dttDate), 2) &amp; \"/\" &amp; Right(\"0\" &amp; Month(dttDate), 2) &amp; \"/\" &amp; Year(dttDate)\n</code></pre>\n\n<p>On another note: while in VBA I try to construct most of my dates using <code>DateSerial</code> ONLY to ensure that I am really generating the date I intend to (and don't get mixed up in the various different date formats).</p>\n"}], "owner": {"reputation": 15, "user_id": 5806349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03685709489174081ef097aea76572e?s=128&d=identicon&r=PG&f=1", "display_name": "Philipe Atela", "link": "https://stackoverflow.com/users/5806349/philipe-atela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1208, "favorite_count": 0, "accepted_answer_id": 35458042, "answer_count": 1, "score": 0, "last_activity_date": 1455716288, "creation_date": 1455714568, "last_edit_date": 1531164843, "question_id": 35457661, "link": "https://stackoverflow.com/questions/35457661/dates-from-excel-worksheet-to-userform-in-dd-mm-yyy-format", "title": "Dates from excel worksheet to userform in dd/mm/yyy format?", "body": "<p>So, this is really driving me crazy now, I have had a lot of problems working with dates on VBA due to formatting issues, since I need my dates to be in dd/mm/yyyy format. I did a lot of searching on the internet, and I found a lot of discussion about these date formats in VBA, however I could not find a solution to my problem.</p>\n\n<p><strong>The problem</strong>: I have some dates stored on a worksheet, formatted as dd/mm/yyyy - I stored them there through userforms, and I had some problems with the formatting but it worked out fine in the end -, and I want to display one of those dates on a userform label. Here is the code I wrote for that:</p>\n\n<pre><code> Me.Label2_Prazo.Caption = Format(Plan1.Cells(pos, 5), \"dd/mm/yyyy\")\n</code></pre>\n\n<p>However, it still displays the date incorrectly. On my worksheet, the date is stored as \"05/03/2016\" (As in march 5th, 2016), but still whenever I try to display it on the userform it appears as \"03/05/2016\".</p>\n\n<p>I have already tried many different ways to make this work, but I can't seem to solve this. </p>\n\n<p>Thanks in advance for any help you can provide!</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1455714537, "post_id": 35457595, "comment_id": 58611526, "body": "<i>What have you tried so far</i>?  Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> and revise your Q with appropriate details and specific problem(s)."}, {"owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1455735168, "post_id": 35457595, "comment_id": 58626122, "body": "I am so sorry sir, I havent read this section, but here will go attemptings so far:"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1455735214, "post_id": 35457595, "comment_id": 58626147, "body": "You will need to <i>edit</i> your original question to include the code. Code does not fit or display properly in the comments."}, {"owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1455738671, "post_id": 35457595, "comment_id": 58628380, "body": "That&#39;s the code above"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1455747761, "creation_date": 1455747761, "answer_id": 35468961, "question_id": 35457595, "link": "https://stackoverflow.com/questions/35457595/creating-vba-charts/35468961#35468961", "title": "Creating VBA charts", "body": "<blockquote>\n  <p>I believe that my great problem is create some loop with charts</p>\n</blockquote>\n\n<p>Use appropriate object variables:</p>\n\n<pre><code>Dim cObj as ChartObject\nDim cht as Chart\n</code></pre>\n\n<p>Then loop using <code>For/Next</code>:</p>\n\n<pre><code>For each cObj in ...\n    Set cht = cObj.Chart '## Chart is child of ChartObject\nNext\n</code></pre>\n\n<p>Like this, maybe (I am not sure <em>where</em> you need to loop or what other logic you may require):</p>\n\n<pre><code>Dim cObj As ChartObject\nDim cht As Chart\nDim srs As Series\nDim x as Long\nDim y as Long\n\nx = 751\ny = 1\n\nIf Sheets(\"Data\").Cells(x, 7).Value = Me.ComboBox1.Value Then\n\nFor each cht in Sheets(\"An\u00e1lises\").ChartObjects\n    Set srs = cht.SeriesCollection.NewSeries\n    srs.Name = Sheets(\"Data\").Cells(x, 7).Value\n\n    If Sheets(\"Data\").Cells(x, 7 + y).Value &gt; 0.01 Then\n\n    '## NOTE: I suspect these ranges also need to change for each chart\n    '         That is going to be better suited for a SEPARATE question.\n\n    srs.Values = \"=Data!$L$752,Data!$N$752,Data!$R$752,Data!$T$752\"\n    srs.XValues = \"=Data!$H$10\"\n    srs.XValues = \"=Data!$H$10,Data!$J$10,Data!$L$10,Data!$N$10\"\n\n    End If\nNext\n\nElse\n\nx = x + 1\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1455811187, "creation_date": 1455714403, "last_edit_date": 1455811187, "question_id": 35457595, "link": "https://stackoverflow.com/questions/35457595/creating-vba-charts", "title": "Creating VBA charts", "body": "<p>I am in the middle of a problem: I need to use the combobox value as I key to search a data in other plan and when I find the same value, capture some some cells values in the same row and plot this. Could someone help me? I believe that my great problem is create some loop with charts, because I need to verify if this value is greater than 0.01 to capture it.\nAttempts so far:</p>\n\n<pre><code>Private Sub ComboBox1_Click()\n\nx = 751\ny = 1\n\nIf Sheets(\"Data\").Cells(x, 7).Value = Me.ComboBox1.Value Then\n\nSheets(\"An\u00e1lises\").ChartObjects(\"Chart 3\").Activate\nChartObjects(\"Chart 3\").SeriesCollection.NewSeries\nChartObjects(\"Chart 3\").SeriesCollection(1).Name = Sheets(\"Data\").Cells(x, 7).Value\n\nIf Sheets(\"Data\").Cells(x, 7 + y).Value &gt; 0.01 Then\n\nActiveChart.SeriesCollection(1).Values = \"=Data!$L$752,Data!$N$752,Data!$R$752,Data!$T$752\"\nActiveChart.SeriesCollection(1).XValues = \"=Data!$H$10\"\nActiveChart.SeriesCollection(1).XValues = \"=Data!$H$10,Data!$J$10,Data!$L$10,Data!$N$10\"\n\nEnd If\n\nElse\n\nx = x + 1\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I know this dont make much sense. I performed a macro to see how works with charts, but I realized this way I am trying to do, wont work. Somehow I need to pick up as value for my chart some cells (they are not sequencial) which will depend from ComboBox1 choose.</p>\n\n<p>I already found how I capture the range with a loop, just need to put in chart now:</p>\n\n<pre><code>Sub ComboBox1_Change()\n\nDim rng As Range\nDim x As Integer\nDim y As Integer\n\ny = 8\n\nFor x = 751 To 1000 Step 1\n\nIf Me.ComboBox1.Value = Worksheets(\"Data\").Cells(x, y - 1).Text Then\n\n Set rng = Worksheets(\"Data\").Cells(x, y)\n\n    Do Until y &gt; 36\n\n    y = y + 2\n\n    Set rng = Application.Union(rng, Worksheets(\"Data\").Cells(x, y))\n\n    Loop\n\n   rng.Copy\n\n End If\n\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 192, "user_id": 4903736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-qq1_NX5szB4/AAAAAAAAAAI/AAAAAAAAAAA/djRU3LH0sC4/photo.jpg?sz=128", "display_name": "Simon Wray", "link": "https://stackoverflow.com/users/4903736/simon-wray"}, "edited": false, "score": 0, "creation_date": 1455714281, "post_id": 35457354, "comment_id": 58611337, "body": "What specific error are you getting?"}, {"owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "edited": false, "score": 0, "creation_date": 1455714344, "post_id": 35457354, "comment_id": 58611379, "body": "Hi User, Do the bookmarks &quot;Graph1&quot; or &quot;Chart 3&quot; exists? its very hard to error search this code. I tried to use your code and recreate the tabs in the excelfile also the docx file. Thank you in advance"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455715832, "post_id": 35457354, "comment_id": 58612445, "body": "Please review <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to Avoid Select in VBA</a> then qualify all your sheet objects and work <b>directly</b> with them. Most likely the <code>ActiveSheet</code> is not what you think it is and thus does not have the <code>ChartObject</code>. As an added benefit, reviewing the link I provided will save you tons of future coding bugs :)"}, {"owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455716553, "post_id": 35457354, "comment_id": 58612933, "body": "Exact error is code 13 type missmatch.  Thanks for the comments. I understand re: Avoiding select however the sheet &quot;Pretty Display (2)&quot; is most definitely the active sheet and this code did work previously.  Graph1 is a bookmark that does exist and chart 3 is the name of a chart that exists within that spreadsheet.  Thanks for the help, greatly appreciated."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1455719122, "post_id": 35457354, "comment_id": 58614883, "body": "can you give an example of what gets stored in &quot;Y&quot;?"}, {"owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455721861, "post_id": 35457354, "comment_id": 58617102, "body": "Variable Y would contain the name of an organisation, for the sake of argument let&#39;s say that could contain &quot;Game Warehouse&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455722023, "post_id": 35459185, "comment_id": 58617235, "body": "Sorry for the dumb question, explicit flag?  The X will not be going above the integer limit however I have now set it as Long.  I have also now specifically Activated the sheet that it is pulling from, still getting the same error."}, {"owner": {"reputation": 194, "user_id": 4133779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8629d548e974a439b6662f880ba45?s=128&d=identicon&r=PG&f=1", "display_name": "Sorcefyre", "link": "https://stackoverflow.com/users/4133779/sorcefyre"}, "reply_to_user": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455722555, "post_id": 35459185, "comment_id": 58617618, "body": "&lt;code&gt;Option Explicit&lt;/code&gt; at the top of your module (before any subroutines or functions) is a flag that enforces that all variables be dimensioned before being used (e.g., Dim X As Long has to exist before you can use X anywhere in your sub)."}, {"owner": {"reputation": 194, "user_id": 4133779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8629d548e974a439b6662f880ba45?s=128&d=identicon&r=PG&f=1", "display_name": "Sorcefyre", "link": "https://stackoverflow.com/users/4133779/sorcefyre"}, "reply_to_user": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455722657, "post_id": 35459185, "comment_id": 58617710, "body": "The only other thing I can think of would be to step through the code line by line (F8 to begin debugging and step line-by-line) and see where the error is being thrown."}, {"owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455724139, "post_id": 35459185, "comment_id": 58618931, "body": "Ok, I have set explicit and set all types (as long as wordapp should be an object) I am still getting the type mismatch on the same line of code.   I might just throw the computer out of the window at this point."}], "tags": [], "owner": {"reputation": 194, "user_id": 4133779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8629d548e974a439b6662f880ba45?s=128&d=identicon&r=PG&f=1", "display_name": "Sorcefyre", "link": "https://stackoverflow.com/users/4133779/sorcefyre"}, "is_accepted": false, "score": 0, "last_activity_date": 1455718685, "creation_date": 1455718685, "answer_id": 35459185, "question_id": 35457354, "link": "https://stackoverflow.com/questions/35457354/vba-type-missmatch/35459185#35459185", "title": "VBA Type missmatch", "body": "<p>My advice is to set the Explicit flag and try to decompile the code.  Any variables that you didn't dimension will throw an error.  This is a good time to dimension the variable and type the data appropriately.  </p>\n\n<p>If that doens't throw an error, which it should since you have at least one variable <code>LoopCounter</code> that isn't dimensioned and could therefore cause data type errors then try changing <code>Public X As Integer</code> to <code>Public X As Long</code> so as to avoid values beyond the limit of the Integer data type.</p>\n\n<p><code>.Activate</code> is sometimes necessary even when using <code>.Select</code> from my experience.  Selecting a worksheet should make it the active worksheet, but that's not always the case.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "edited": false, "score": 0, "creation_date": 1455727985, "post_id": 35461257, "comment_id": 58621779, "body": "This worked great, thank you. I still am not sure why it worked a day before and doesn&#39;t now, the pasting worked like a charm and I picked up a few tips to clean up my code from this - great answer!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1455723722, "creation_date": 1455723722, "answer_id": 35461257, "question_id": 35457354, "link": "https://stackoverflow.com/questions/35457354/vba-type-missmatch/35461257#35461257", "title": "VBA Type missmatch", "body": "<p>try this</p>\n\n<pre><code>Option Explicit\n\nPublic X As Integer\nPublic Y As String\n\nSub Macro2()\n\nDim wordApp As Object\nDim LoopCounter As Integer\nDim Mystring As String\nDim ws As Worksheet, pd As Worksheet\n\nSet ws = Sheets(\"CPD data 13-14\")\nSet pd = Sheets(\"Pretty Display (2)\")\n\n'Set up variables that are required\nY = \"\"\nLoopCounter = 2\n\n' open one Word session for all the documents to be processed\nSet wordApp = CreateObject(\"word.Application\")\n\nDo Until Y = \"STOP\"\n\n    'Grab the value from a list\n    Y = ws.Range(\"A\" &amp; LoopCounter).Value\n\n    With pd\n        .Range(\"A1\").Value = Y 'Change the chart values\n        .ChartObjects(\"Chart 3\").Copy ' Copy the chart\n    End With\n\n    'act on Word application\n    With wordApp\n        'open word template\n        .documents.Open \"LOCATION\"\n        .Visible = True\n\n        ' paste into bookmarks, \"save as\" document and close it\n        With .ActiveDocument\n            .Bookmarks(\"InstitutionName\").Range = Y\n            .Bookmarks(\"Graph1\").Range.PasteSpecial\n\n            Mystring = Replace(Y, \" \", \"\")\n            .SaveAs Filename:=\"LOCATION\" &amp; Mystring &amp; \".docx\"\n            .Close\n        End With\n    End With\n\n    'Increase count and loop\n    LoopCounter = LoopCounter + 1\nLoop\n\n'Close Word\nwordApp.Quit\nSet wordApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I couldn't have a word \"Range\" object directly set to an Excel \"Chart\" object</p>\n\n<p>So I had to copy the chart and use \"PasteSpecial\" method of the Word \"Range\" object</p>\n\n<p>Furthemore I worked with one Word session only, which'd result in a faster job</p>\n\n<p>Finally I also made some \"comsetics\" to make the code more readable/maintanable</p>\n\n<p>just as a suggestion: I'd always use \"Option Explicit\" statement. that'll force you some extra work to explicitly declare each and every variable you use, but that will also give much more control over your work and result in less debbugging issues, thus saving time at the end</p>\n"}], "owner": {"reputation": 9, "user_id": 958551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d32f647a60b00470048812aa736267d?s=128&d=identicon&r=PG", "display_name": "user958551", "link": "https://stackoverflow.com/users/958551/user958551"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 35461257, "answer_count": 2, "score": 0, "last_activity_date": 1455723722, "creation_date": 1455713706, "last_edit_date": 1455717176, "question_id": 35457354, "link": "https://stackoverflow.com/questions/35457354/vba-type-missmatch", "title": "VBA Type missmatch", "body": "<p>I have wrote some VBA code which I was fairly happy with. It went through a list on a worksheet, switched to another and set a variable (and thus changed some graphs) and then opened word, copied in the graphs to various bookmarks and saved the document as the variable name. </p>\n\n<p>It worked like a charm and I was a happy boy (saved a good week and a bit of work for someone). I have not touched it since - or the worksheets for that matter - opened it today and it is giving me a type missmatch on the first lot. I would really love some advice as it has left me scratching my head.</p>\n\n<pre><code>Public X As Integer\nPublic Y As String\nSub Macro2()\n\n\n    'Set up variables that are required\n    Y = \"\"\n    LoopCounter = 2\n\n\n    Do Until Y = \"STOP\"\n\n        'Grab the value from a list\n        Sheets(\"CPD data 13-14\").Select\n        Range(\"A\" &amp; LoopCounter).Select\n        Y = Range(\"A\" &amp; LoopCounter).Value\n\n        'Change the chart values\n        Sheets(\"Pretty Display (2)\").Select\n        Range(\"A1\").Value = Y\n\n        'Open word template\n        Set wordapp = CreateObject(\"word.Application\")\n        wordapp.documents.Open \"LOCATION\"\n        wordapp.Visible = True\n        wordapp.Activate\n\n        wordapp.ActiveDocument.Bookmarks(\"InstitutionName\").Range = Y\n        wordapp.ActiveDocument.Bookmarks(\"Graph1\").Range = ActiveSheet.ChartObjects(\"Chart 3\")\n\n\n        'Close document\n        Mystring = Replace(Y, \" \", \"\")\n        wordapp.ActiveDocument.SaveAs Filename:=\"LOCATION\" &amp; Mystring &amp; \".docx\"\n        wordapp.Quit\n        Set wordapp = Nothing\n\n\n        'Increase count and loop\n        LoopCounter = LoopCounter + 1\n    Loop\n</code></pre>\n\n<p>The error hits on the following line:</p>\n\n<pre><code>            wordapp.ActiveDocument.Bookmarks(\"Graph1\").Range = ActiveSheet.ChartObjects(\"Chart 3\")\n</code></pre>\n\n<p>EDIT</p>\n\n<p>As suggested I have updated my code not to use select so it now reads:</p>\n\n<pre><code>Set ws = Sheets(\"CPD data 13-14\")\nSet pd = Sheets(\"Pretty Display (2)\")\n\n'Set up variables that are required\nY = \"\"\nLoopCounter = 2\n\n\nDo Until Y = \"STOP\"\n\n    'Grab the value from a list\n    Y = ws.Range(\"A\" &amp; LoopCounter).Value\n\n    'Change the chart values\n\n    pd.Range(\"A1\").Value = Y\n\n    'Open word template\n    Set wordapp = CreateObject(\"word.Application\")\n    wordapp.documents.Open \"LOCATION\"\n    wordapp.Visible = True\n    wordapp.Activate\n\n    wordapp.ActiveDocument.Bookmarks(\"InstitutionName\").Range = Y\n    wordapp.ActiveDocument.Bookmarks(\"Graph1\").Range = pd.ChartObjects(\"Chart 3\")\n\n\n    'Close document\n    Mystring = Replace(Y, \" \", \"\")\n    wordapp.ActiveDocument.SaveAs Filename:=\"LOCATION\" &amp; Mystring &amp; \".docx\"\n    wordapp.Quit\n    Set wordapp = Nothing\n\n\n    'Increase count and loop\n    LoopCounter = LoopCounter + 1\nLoop\n</code></pre>\n\n<p>I still get the same runtime error at the same point.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 4903736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-qq1_NX5szB4/AAAAAAAAAAI/AAAAAAAAAAA/djRU3LH0sC4/photo.jpg?sz=128", "display_name": "Simon Wray", "link": "https://stackoverflow.com/users/4903736/simon-wray"}, "is_accepted": true, "score": 1, "last_activity_date": 1455712736, "last_edit_date": 1455712736, "creation_date": 1455712016, "answer_id": 35456722, "question_id": 35456109, "link": "https://stackoverflow.com/questions/35456109/excel-vba-create-list-of-subfolders-and-files-within-source-folder/35456722#35456722", "title": "Excel VBA: Create list of subfolders and files within source folder", "body": "<p>You can see the list of properties that the <code>File</code> Object supports here: <a href=\"https://msdn.microsoft.com/en-us/library/1ft05taf(v=vs.84).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/1ft05taf(v=vs.84).aspx</a></p>\n\n<p>So you can enhance your code, where it is taking the <code>.Name</code> property and putting that in a cell formula, to do something similar with other properties, such as the <code>.Type</code> of the file.</p>\n\n<pre><code>For Each FileItem In SourceFolder.Files\n  Cells(r, 1).Formula = FileItem.Name\n  Cells(r, 2).Value = FileItem.Type\n  ActiveSheet.Hyperlinks.Add Anchor:=Cells(r, 3), Address:= _\n    FileItem.Path, TextToDisplay:=FileItem.Name \n  r = r + 1\n  X = SourceFolder.Path\nNext FileItem\n</code></pre>\n\n<p>n.b. I've used Value instead of Formula, but in this case the result will be the same.</p>\n\n<p>In a similar manner, you can add another <code>Cells(r, 3).Value =</code> line to set the value of cell in the current row <code>r</code> and column <code>3</code> to whatever your hyperlink is.</p>\n"}, {"tags": [], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "is_accepted": false, "score": 1, "last_activity_date": 1455713445, "creation_date": 1455713445, "answer_id": 35457257, "question_id": 35456109, "link": "https://stackoverflow.com/questions/35456109/excel-vba-create-list-of-subfolders-and-files-within-source-folder/35457257#35457257", "title": "Excel VBA: Create list of subfolders and files within source folder", "body": "<p>I wrote a little script for this purpose to my colleague for a time ago...</p>\n\n<p>See my code below:</p>\n\n<pre><code>Sub FolderNames()\n'Written by Daniel Elmnas Last update 2016-02-17\nApplication.ScreenUpdating = False\nDim xPath As String\nDim xWs As Worksheet\nDim fso As Object, j As Long, folder1 As Object\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the folder\"\n    .Show\nEnd With\nOn Error Resume Next\nxPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1) &amp; \"\\\"\nApplication.Workbooks.Add\nSet xWs = Application.ActiveSheet\nxWs.Cells(1, 1).Value = xPath\nxWs.Cells(2, 1).Resize(1, 5).Value = Array(\"Subfolder\", \"Hostfolder\", \"Filename\", \"Date Created\", \"Date Last Modified\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet folder1 = fso.getFolder(xPath)\ngetSubFolder folder1\nxWs.Cells(2, 1).Resize(1, 5).Interior.Color = 65535\nxWs.Cells(2, 1).Resize(1, 5).EntireColumn.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\nSub getSubFolder(ByRef prntfld As Object)\nDim SubFolder As Object\nDim subfld As Object\nDim xRow As Long\nFor Each SubFolder In prntfld.SubFolders\n    xRow = Range(\"A1\").End(xlDown).Row + 1\n    Cells(xRow, 1).Resize(1, 5).Value = Array(SubFolder.Path, Left(SubFolder.Path, InStrRev(SubFolder.Path, \"\\\")), SubFolder.Name, SubFolder.DateCreated, SubFolder.DateLastModified)\nNext SubFolder\nFor Each subfld In prntfld.SubFolders\n    getSubFolder subfld\nNext subfld\nEnd Sub\n</code></pre>\n\n<p>Here is the result:\n<a href=\"https://i.stack.imgur.com/hVFPx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVFPx.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can modify it a bit though.</p>\n\n<p>If you example dont want to use a window-dialog and instead use \n\"W:\\ISO 9001\\INTEGRATED_PLANNING\\\"</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11671, "favorite_count": 0, "accepted_answer_id": 35456722, "answer_count": 2, "score": 1, "last_activity_date": 1455713445, "creation_date": 1455710336, "question_id": 35456109, "link": "https://stackoverflow.com/questions/35456109/excel-vba-create-list-of-subfolders-and-files-within-source-folder", "title": "Excel VBA: Create list of subfolders and files within source folder", "body": "<p>I am using the following code to list all files in a host folder and it's sub folders. The code works great but, do you know how I can update the code to also list some the file attributes.</p>\n\n<pre><code>Sub file_list()\n\nCall ListFilesInFolder(\"W:\\ISO 9001\\INTEGRATED_PLANNING\\\", True)\n\nEnd Sub\n\nSub ListFilesInFolder(ByVal SourceFolderName As String, ByVal IncludeSubfolders As Boolean)\n\nDim FSO As Object\nDim SourceFolder As Object\nDim SubFolder As Object\nDim FileItem As Object\nDim r As Long\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet SourceFolder = FSO.getFolder(SourceFolderName)\nr = Range(\"A65536\").End(xlUp).Row + 1\nFor Each FileItem In SourceFolder.Files\n\n  Cells(r, 1).Formula = FileItem.Name\n  r = r + 1\n  X = SourceFolder.Path\nNext FileItem\nIf IncludeSubfolders Then\n  For Each SubFolder In SourceFolder.Subfolders\n    ListFilesInFolder SubFolder.Path, True\n  Next SubFolder\nEnd If\n\nSet FileItem = Nothing\nSet SourceFolder = Nothing\nSet FSO = Nothing\n\nEnd Sub\n\nFunction GetFileOwner(ByVal FilePath As String, ByVal FileName As String)\n\nDim objFolder As Object\nDim objFolderItem As Object\nDim objShell As Object\nFileName = StrConv(FileName, vbUnicode)\nFilePath = StrConv(FilePath, vbUnicode)\nSet objShell = CreateObject(\"Shell.Application\")\nSet objFolder = objShell.Namespace(StrConv(FilePath, vbFromUnicode))\nIf Not objFolder Is Nothing Then\n  Set objFolderItem = objFolder.ParseName(StrConv(FileName, vbFromUnicode))\nEnd If\nIf Not objFolderItem Is Nothing Then\n  GetFileOwner = objFolder.GetDetailsOf(objFolderItem, 8)\nElse\n  GetFileOwner = \"\"\nEnd If\nSet objShell = Nothing\nSet objFolder = Nothing\nSet objFolderItem = Nothing\n\nEnd Function\n</code></pre>\n\n<p>What I would really like to see is;</p>\n\n<p>Column A = Host folder/subfolder</p>\n\n<p>Column B = File name</p>\n\n<p>Column C = hyperlink to file</p>\n\n<p>Is this possible?</p>\n\n<p>I do have a code that created hyperlinks but, I do not know how to add to the existing code.</p>\n\n<pre><code>Sub startIt()\n\n  Dim FileSystem As Object\n  Dim HostFolder As String\n\n  HostFolder = \"W:\\ISO 9001\\INTEGRATED_PLANNING\\\"\n\n  Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n  DoFolder FileSystem.GetFolder(HostFolder)\n\nEnd Sub\n\nSub DoFolder(Folder)\n\n  Dim SubFolder\n  For Each SubFolder In Folder.Subfolders\n    DoFolder SubFolder\n  Next\n\n  i = Cells(Rows.Count, 1).End(xlUp).Row + 1\n  Dim File\n  For Each File In Folder.Files\n    ActiveSheet.Hyperlinks.Add Anchor:=Cells(i, 1), Address:= _\n        File.Path, TextToDisplay:=File.Name\n    i = i + 1\n\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "url"], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 3169049, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9be7e02d44421c30df4611e53fc88574?s=128&d=identicon&r=PG", "display_name": "Moogle", "link": "https://stackoverflow.com/users/3169049/moogle"}, "edited": false, "score": 0, "creation_date": 1455716630, "post_id": 35456927, "comment_id": 58612991, "body": "Works perfectly, thank you. And thank you for the explanation."}], "tags": [], "owner": {"reputation": 131, "user_id": 3569501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/710d23da3ba16a56dab6bfaeba3f93f3?s=128&d=identicon&r=PG&f=1", "display_name": "duncanc", "link": "https://stackoverflow.com/users/3569501/duncanc"}, "is_accepted": true, "score": 3, "last_activity_date": 1455713426, "last_edit_date": 1495540235, "creation_date": 1455712595, "answer_id": 35456927, "question_id": 35455884, "link": "https://stackoverflow.com/questions/35455884/copy-url-from-browser-into-excel/35456927#35456927", "title": "Copy url from browser into Excel", "body": "<p>I believe this will do what you want:</p>\n\n<pre><code>Set webClient = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nwebClient.Option(6) = False\nwebClient.Open \"GET\", Cells(1, 1), False\nwebClient.send (\"\")\nCells(1, 2) = webClient.GetResponseHeader(\"Location\")\n</code></pre>\n\n<p>I got the idea from this <a href=\"https://stackoverflow.com/questions/161343/how-do-i-prevent-serverxmlhttp-from-automatically-following-redirects-http-303\">other answer</a>.</p>\n\n<p>What you are trying to do is get the location you're redirecting to.</p>\n\n<p>Redirects follow a standard process described <a href=\"https://en.wikipedia.org/wiki/HTTP_301\" rel=\"nofollow noreferrer\">here</a>... and I'm just grabbing the appropriate header from the response.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1455716698, "creation_date": 1455716698, "answer_id": 35458429, "question_id": 35455884, "link": "https://stackoverflow.com/questions/35455884/copy-url-from-browser-into-excel/35458429#35458429", "title": "Copy url from browser into Excel", "body": "<p>You want the <code>.LocationURL</code> property</p>\n\n<pre><code>Const READYSTATE_COMPLETE As Long = 4\nDim IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Navigate Cells(1, 1).Value\n\n'// Wait for page to finish loading\nWhile IE.Busy Or IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\nCells(1, 2).Value = IE.LocationURL\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 3169049, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9be7e02d44421c30df4611e53fc88574?s=128&d=identicon&r=PG", "display_name": "Moogle", "link": "https://stackoverflow.com/users/3169049/moogle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4211, "favorite_count": 0, "accepted_answer_id": 35456927, "answer_count": 2, "score": 1, "last_activity_date": 1455716698, "creation_date": 1455709737, "last_edit_date": 1455710068, "question_id": 35455884, "link": "https://stackoverflow.com/questions/35455884/copy-url-from-browser-into-excel", "title": "Copy url from browser into Excel", "body": "<p>My company uses short URLs for marketing campaigns, which redirect to URLs with tracking. For example:</p>\n\n<blockquote>\n  <p>example.com/campaign</p>\n</blockquote>\n\n<p>will redirect to:</p>\n\n<blockquote>\n  <p>example.com/utm_source=<strong>one</strong>&amp;utm_medium=<strong>two</strong>&amp;utm_term=<strong>three</strong>&amp;utm_content=<strong>four</strong>&amp;utm_campaign=<strong>five</strong></p>\n</blockquote>\n\n<p>I have an excel file with a list of short URLs, but the tracking URLs are not listed. The current process is to manually open each link and copy the URL.</p>\n\n<p><strong>Is there a way to copy the tracking URLs into excel using VBA?</strong></p>\n\n<p>So far I've explored the following:</p>\n\n<pre><code>Dim ie As Object\nSet ie = CreateObject(\"Internetexplorer.Application\")\nie.Navigate Cells(1, 1)\n</code></pre>\n\n<p>But I can't find a way to then copy the new URL back into excel.</p>\n\n<p>I've also tried:</p>\n\n<pre><code>Dim link As Hyperlink\nCells(1, 1).Select\nSet link = ActiveSheet.Hyperlinks.Add(Anchor:=Cells(1, 1), Address:=Cells(1, 1))\nlink.Follow\nCells(1, 2) = link.Address\n</code></pre>\n\n<p>However this just (unsurprisingly) brings back the original hyperlink.</p>\n\n<p>How can I bring back the tracking URL? Ideally without having to install any other software (as my company's IT department is a nightmare) but if that's the only option then so be it.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1455713583, "post_id": 35455833, "comment_id": 58610839, "body": "You are always exporting the same <code>ActiveSheet</code>, you might want to change the sheet you export according to the value of c. Maybe <code>Sheet(c.Value).ExportAsFixedFormat ...</code>, but not sure since you didn&#39;t explained what the contents of inputrange is."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1455722167, "post_id": 35455833, "comment_id": 58617326, "body": "The drop down list has company names. And when a new company is selected from the list, the page updates with that companies information. So I am always working with Sheet1 which will always be the ActiveSheet. ActiveSheet is the only method so far that produces the sheet on a pdf the trouble is it apparently doesn&#39;t loop through the list as is only ever gives the first companies&#39; info?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1455729042, "post_id": 35455833, "comment_id": 58622426, "body": "Your code doesn&#39;t update the sheet because it doesn&#39;t update the choice made in the combobox, you are only running through the values available in the combobox. You can try to update the value of AD5 cell and calculate the sheet for each value before exporting."}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "is_accepted": false, "score": 0, "last_activity_date": 1455711308, "creation_date": 1455711308, "answer_id": 35456442, "question_id": 35455833, "link": "https://stackoverflow.com/questions/35455833/why-does-this-not-loop-through-drop-down-list/35456442#35456442", "title": "why does this not loop through drop down list", "body": "<p>You may have forgot to modify the value of your dropdown list ( variable called c ?). This value is read and added into the pdf name, but not modified.</p>\n\n<p>As it is now, in the for loop there is only one instruction for creating pdf, therefore, it is the only action performed.</p>\n\n<p>Try to add a modification of the field into the loop.</p>\n\n<p>Hope it can help you.</p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1455720470, "post_id": 35459104, "comment_id": 58616024, "body": "I get the same thing but with my values. I am thinking that the problem is that whilst selecting the next value in the drop down list, it may not be activating/refreshing the sheet. Is there a way to &quot;activate/refresh&quot; the page after the next item from the list is selected? or would perhaps saving the sheet after selection work?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1455720785, "post_id": 35459104, "comment_id": 58616287, "body": "@IIJHFII  Your code export the <b>entire sheet</b> fifty times.........you are not exporting a range <b>within</b> the sheet!"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1455720956, "post_id": 35459104, "comment_id": 58616415, "body": "oh!. the cell AD5 in my sheet is a drop down list where each item changes the values in Sheet1 of my workbook. The plan is to export Sheet1 for each of the values in the drop down list! How could I modify the code for that purpose?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1455721183, "post_id": 35459104, "comment_id": 58616581, "body": "@IIJHFII  See my <b>EDIT1</b>"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1455721580, "post_id": 35459104, "comment_id": 58616889, "body": "Unfortunately c.ExportAsFixedFormat just prints a pdf with the value of c from the list. I then tried c.Worksheet.ExportAsFixedFormat but this also does not print the Sheet 1 worksheet. The dropdown list is in sheet 1 which is why i though Active.Worksheet would work. Is there a line of code to essentially &quot;refresh&quot; the page after selecting the c value? btw i really appreciate your help thus far :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1455722860, "last_edit_date": 1455722860, "creation_date": 1455718472, "answer_id": 35459104, "question_id": 35455833, "link": "https://stackoverflow.com/questions/35455833/why-does-this-not-loop-through-drop-down-list/35459104#35459104", "title": "why does this not loop through drop down list", "body": "<p>Your coding should work if the <em>Data Validation</em> has been set up to support it.  It is easy to verify this.<br><br>If I set up <em>DV</em> like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZFgTo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZFgTo.png\" alt=\"enter image description here\"></a></p>\n\n<p>and run this shortened version of your code:</p>\n\n<pre><code>Sub qwerty()\n    Dim inputRange As Range\n    Dim c As Range, msg As String\n\n    Set inputRange = Evaluate(Range(\"AD5\").Validation.Formula1)\n\n    msg = inputRange.Address &amp; vbCrLf &amp; vbCrLf\n    For Each c In inputRange\n        msg = msg &amp; c.Address &amp; vbTab &amp; \"C:\\test\\\" &amp; c.Value &amp; vbCrLf\n    Next c\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p>I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fonip.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fonip.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Try my short program first.</strong></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>From your comments, try replacing:</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat _\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>c.ExportAsFixedFormat _\n</code></pre>\n\n<p><strong>EDIT#2:</strong></p>\n\n<p>We may be getting close.  I am thinking that each <strong>c</strong> represents a <strong>single cell</strong> in the <em>DV</em> list and that each <strong>c</strong> contains the address of the block of cells to be exported.  If that is the case then replace:</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat _\n</code></pre>\n\n<p>with the lines:</p>\n\n<pre><code>    Dim rng As Range\n    Set rng = Range(c.Text)\n    rng.ExportAsFixedFormat _\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 1715763, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f96afddd63a795a78d85b8f016d01d98?s=128&d=identicon&r=PG", "display_name": "Jorgeley", "link": "https://stackoverflow.com/users/1715763/jorgeley"}, "is_accepted": false, "score": 0, "last_activity_date": 1455725705, "creation_date": 1455725705, "answer_id": 35462063, "question_id": 35455833, "link": "https://stackoverflow.com/questions/35455833/why-does-this-not-loop-through-drop-down-list/35462063#35462063", "title": "why does this not loop through drop down list", "body": "<p>maybe this could help you:</p>\n\n<pre><code>        Public mainSheets(3) As String\n\n    Public Function setMainSheets()\n        mainSheets(0) = \"sheet1\"\n        mainSheets(1) = \"sheet2\"\n        mainSheets(2) = \"sheet3\"\n    End Function\n\n    Public Function hasMainSheet(search As String, arrey As Variant) As Boolean\n      hasMainSheet = (UBound(Filter(arrey, search)) &gt; -1)\n    End Function\n\n    function yourFunction()\n    setMainSheets\n        For Each plan In Worksheets\n                If (Not hasMainSheet(plan.Name, mainSheets)) Then\n    your code here\n    end if\n    next\nend function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1456137887, "post_id": 35463439, "comment_id": 58791244, "body": "Thank you kind sir :) an additional question if I may though! if i wanted to modify this to save the active sheet as a new excel workbook. I have tried ActiveSheet.SaveAs fileformat:=52, filename:=...... etc but get an error of &quot;Object required?"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1455729540, "creation_date": 1455729540, "answer_id": 35463439, "question_id": 35455833, "link": "https://stackoverflow.com/questions/35455833/why-does-this-not-loop-through-drop-down-list/35463439#35463439", "title": "why does this not loop through drop down list", "body": "<p>Here is the code corresponding to my last comment.\nIt should retrieve the validation values (the values from the ComboBox) and change the value in [AD5] for each possible value, and then compute the sheet and export it.</p>\n\n<pre><code>Sub Create_pdf_pack()\n    Dim inputRange As Range\n    Dim c As Range\n    Set inputRange = Evaluate(Range(\"AD5\").Validation.Formula1)\n    For Each c In inputRange\n        [AD5] = c.Value\n        'you might need to refresh the sheet here\n        ActiveSheet.Calculate\n        ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            fileName:=\"C:\\test\\\" &amp; c.Value, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 35463439, "answer_count": 4, "score": -1, "last_activity_date": 1455729540, "creation_date": 1455709617, "last_edit_date": 1455710869, "question_id": 35455833, "link": "https://stackoverflow.com/questions/35455833/why-does-this-not-loop-through-drop-down-list", "title": "why does this not loop through drop down list", "body": "<p>I have this code which should loop through each item in a drop down list. When the next item is selected it should update the main worksheet. Then Create a pdf of the worksheet. What happens is it creates a pdf NAMED after each item but the contents don't change from the first item. I basically have 50 pdfs of item 1 called 50 different things. Whereas I want 50 pdfs of 50 things named after each thing? any help appreciated</p>\n\n<pre><code>Sub Create_pdf_pack()\n\n Dim inputRange As Range\n Dim c As Range\n Set inputRange = Evaluate(Range(\"AD5\").Validation.Formula1)\n For Each c In inputRange\n    ActiveSheet.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    fileName:=\"C:\\test\\\" &amp; c.Value, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5934703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bc2301bcc3247a390e0e85dd538c79?s=128&d=identicon&r=PG&f=1", "display_name": "laudo", "link": "https://stackoverflow.com/users/5934703/laudo"}, "edited": false, "score": 0, "creation_date": 1455709484, "post_id": 35455691, "comment_id": 58607956, "body": "Perhaps my question is easier to understand if you can look at the data file. You can find it here: <a href=\"http://www.filedropper.com/examplemergingdatatables\" rel=\"nofollow noreferrer\">filedropper.com/examplemergingdatatables</a> (scanned for viruses)"}, {"owner": {"reputation": 192, "user_id": 4903736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-qq1_NX5szB4/AAAAAAAAAAI/AAAAAAAAAAA/djRU3LH0sC4/photo.jpg?sz=128", "display_name": "Simon Wray", "link": "https://stackoverflow.com/users/4903736/simon-wray"}, "edited": false, "score": 0, "creation_date": 1455713624, "post_id": 35455691, "comment_id": 58610860, "body": "I&#39;m struggling to understand what you need to do with the SIC code table - what specifically are you doing with the SIC table input data to get to the output data? Your output SIC table has duplicate values in it, so you&#39;ve not removed the duplicates as your question states you require..."}, {"owner": {"reputation": 192, "user_id": 4903736, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-qq1_NX5szB4/AAAAAAAAAAI/AAAAAAAAAAA/djRU3LH0sC4/photo.jpg?sz=128", "display_name": "Simon Wray", "link": "https://stackoverflow.com/users/4903736/simon-wray"}, "edited": false, "score": 0, "creation_date": 1455713985, "post_id": 35455691, "comment_id": 58611122, "body": "You may want to structure your data as proper Excel Tables (<a href=\"http://www.contextures.com/xlExcelTable01.html\" rel=\"nofollow noreferrer\">contextures.com/xlExcelTable01.html</a>), which often helps with forumlae. And you may want to look at using the COUNTIFS &amp; SUMIFS functions: <a href=\"http://stackoverflow.com/questions/1880168/excel-structured-reference-table-syntax/11065490#11065490\" title=\"excel structured reference table syntax\">stackoverflow.com/questions/1880168/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 328, "user_id": 5868641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7085f1535bce8e6bd5abb90b4ffdc741?s=128&d=identicon&r=PG&f=1", "display_name": "M.L", "link": "https://stackoverflow.com/users/5868641/m-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1455717542, "last_edit_date": 1455717542, "creation_date": 1455717128, "answer_id": 35458581, "question_id": 35455691, "link": "https://stackoverflow.com/questions/35455691/merging-two-tables-while-deleting-duplicates-in-the-first-table-and/35458581#35458581", "title": "Merging two tables while deleting duplicates in the first table and", "body": "<p>This is the way to go about it. In 2 parts: get a list of unique SIC codes in each row, and, sum up the unique corresponding values to them.</p>\n\n<p><strong>Part I</strong>:\nGeneral logic to this part: nested <code>INDEX</code> functions.</p>\n\n<p>Let's assume your output table (range including headers <code>A25:J45</code>) is exactly below your main/input table (range including headers <code>A1:J21</code>). Assuming only 20 rows of data, but you can drag the formulae to as many rows.</p>\n\n<p>The first column should always be picking up values from the corresponding first column of input table. A26 <code>=A2</code> and so on.</p>\n\n<p>For B26, use this formula <code>=INDEX($A2:$J2,MATCH(0,INDEX(COUNTIF($A26:A26,$A2:$J2),0,0),0))</code></p>\n\n<p>You can drag this formula across to J45/end of output table. (You can use \"Evaluate Formula\" in excel to understand the workings of the logic)\nThis should populate your output table with unique SIC codes for each row.</p>\n\n<p><strong>Part II</strong>:\nGeneral logic to this part: <code>SUM</code> and Arrays</p>\n\n<p>Let's assume your output table (range including headers <code>L25:U45</code>) is exactly below your main/input table (range including headers <code>L1:U21</code>). Assuming only 20 rows of data, but you can drag the formulae to as many rows.</p>\n\n<p>In cell L26, which is the first row, left most element in the output table, you will need an array formula (<code>Ctrl</code>+<code>Shift</code>+<code>Enter</code>). If you don't know what array formula are read <a href=\"https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Formula for L26 <code>{=SUM(IFERROR($A2:$J2=A26,0)*IFERROR($L2:$U2,0))}</code>. </p>\n\n<p>You will need to enter only this in L26 <code>=SUM(IFERROR($A2:$J2=A26,0)*IFERROR($L2:$U2,0))</code>, and hit <code>Ctrl</code>+<code>Shift</code>+<code>Enter</code>. Excel will put the curly brackets around it on its own self.\nCopy paste the formula in the rest of the output table.</p>\n\n<p>Screenshot for reference based on your Excel file.\n<a href=\"https://i.stack.imgur.com/Ubyed.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ubyed.png\" alt=\"Reference Image 1\"></a>\n<a href=\"https://i.stack.imgur.com/7wp40.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7wp40.png\" alt=\"Reference Image 2\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4322509, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p3kuZ4vimxg/AAAAAAAAAAI/AAAAAAAAABo/WdTPmlPmiyQ/photo.jpg?sz=128", "display_name": "BuddingProgrammer", "link": "https://stackoverflow.com/users/4322509/buddingprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1455729745, "creation_date": 1455729745, "answer_id": 35463512, "question_id": 35455691, "link": "https://stackoverflow.com/questions/35455691/merging-two-tables-while-deleting-duplicates-in-the-first-table-and/35463512#35463512", "title": "Merging two tables while deleting duplicates in the first table and", "body": "<p>There is a remove duplicates function in excel 2010 on the Data Tab <a href=\"http://i.stack.imgur.com/XgCKa.png\" rel=\"nofollow\">Screenshot</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5934703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7bc2301bcc3247a390e0e85dd538c79?s=128&d=identicon&r=PG&f=1", "display_name": "laudo", "link": "https://stackoverflow.com/users/5934703/laudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1455729745, "creation_date": 1455709237, "last_edit_date": 1531161705, "question_id": 35455691, "link": "https://stackoverflow.com/questions/35455691/merging-two-tables-while-deleting-duplicates-in-the-first-table-and", "title": "Merging two tables while deleting duplicates in the first table and", "body": "<p>This is my first post here and your help would be greatly appreciated! I've read a lot of other posts on this site, however I cannot find the answer to my specific question. I tried using <code>VLOOKUP</code>, <code>INDEX</code>, <code>MATCH</code>, Pivottables, etc. However it doesn't work out the way I want.</p>\n\n<p>Background information: for my thesis I'm studying the difference in cost of capital among single segment and multi segment firms. My dataset contains two tables, one with the SIC codes of the firm's segments and one with the corresponding sales of that segment. The issue with these tables is that there are duplicate SIC codes in the first table. I want to remove the duplicates from the first table and simultaneously calculate the sum of the sales of these duplicate SIC codes in the second table.</p>\n\n<p>My data looks as follows: </p>\n\n<p>The SIC codes per segment and the sales per segment:\n<a href=\"http://i.stack.imgur.com/9R7ST.png\" rel=\"nofollow\">Input of SIC codes and sales per segment (one company for 20 years)</a></p>\n\n<p>What I want to do is eliminate the duplicate SIC codes. If I change the table with SIC codes I also need the table with sales to change accordingly. However, the sales of duplicate segments should not be deleted but added to the first duplicate segment. I can computed this manually for one company, however for 1800 companies would this would be very time consuming. The manually computed output for the SIC codes and for Sales looks like this (so I don't need to merge the table, the output is still in two different tables):\n<a href=\"http://i.stack.imgur.com/KR8at.png\" rel=\"nofollow\">Required output for the SIC codes table and Sales table (one company for 20 years</a></p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3095, "user_id": 28828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77e04a75ca5020461c4670e190d8922?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/28828/oliver"}, "edited": false, "score": 0, "creation_date": 1455719844, "post_id": 35455673, "comment_id": 58615521, "body": "Just as a side note: The line &quot;Dim wbXLnew, wbXLcore As Excel.Workbook&quot; does NOT declare wbXLnew as Excel.Workbook but as Variant. You need to use: &quot;Dim wbXLnew As Excel.Workbook, wbXLcore As Excel.Workbook&quot; instead."}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 3095, "user_id": 28828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77e04a75ca5020461c4670e190d8922?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/28828/oliver"}, "edited": false, "score": 0, "creation_date": 1455720843, "post_id": 35455673, "comment_id": 58616333, "body": "Ah whoops, thank you - fixed!"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "edited": false, "score": 0, "creation_date": 1455721250, "post_id": 35459285, "comment_id": 58616629, "body": "Thanks Steven, this has removed the Subscript out of range error. Ended up repeating <code>Set wbXLcore = appXL.Workbooks(&quot;ResultsOverall.xlsm&quot;)</code> after the If section (since handler skips over this I think?) - I&#39;m sure there&#39;s a much cleaner way of doing this but ah well! Thank you very much :)"}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "edited": false, "score": 0, "creation_date": 1455721976, "post_id": 35459285, "comment_id": 58617191, "body": "Yes, in fact just finished switching things around a little bit (trying to &#39;Get&#39; Excel first as in the link you posted was a much better idea!) and all seems to be working well - will post up the fixed code now. Thank you again!"}], "tags": [], "owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "is_accepted": true, "score": 1, "last_activity_date": 1455719603, "last_edit_date": 1495540234, "creation_date": 1455718957, "answer_id": 35459285, "question_id": 35455673, "link": "https://stackoverflow.com/questions/35455673/access-vba-working-with-an-existing-excel-workbook-run-time-error-9-if-file-i/35459285#35459285", "title": "Access VBA: working with an existing excel workbook (Run-Time error 9, if file is already open)", "body": "<p>Sorry I'm on my phone so I can't go in to too much detail or do much with the code but at a glance I think you might need to add an error handler so that if the file is already open, a different line of code is executed. </p>\n\n<p>Add 'On error go to handler' (before creating the excel object) and at the bottom\nOf your code add 'handler:'. In the error handler, use get object rather than create object. </p>\n\n<p>You will have to ensure you use exit sub before the error handler or it will run the handler every time you run the code. </p>\n\n<p>You can see an example of what I mean here: <a href=\"https://stackoverflow.com/questions/35434772/how-to-insert-chart-or-graph-into-body-of-outlook-mail?noredirect=1#comment58606368_35434772\">How to insert chart or graph into body of Outlook mail</a></p>\n\n<p>Although please note in this example it's the other way round (if error 'getting' outlook, then create it).</p>\n\n<p>Example in link:</p>\n\n<p>Set myOutlook = GetObject(, \"Outlook.Application\")\nSet myMessage = myOutlook.CreateItem(olMailItem)</p>\n\n<p> rest of code here </p>\n\n<p>Exit Sub</p>\n\n<p>'If Outlook is not open, open it</p>\n\n<p>Handler:</p>\n\n<p>Set myOutlook = CreateObject(\"Outlook.Application\")\nErr.Clear\nResume Next</p>\n\n<p>End sub </p>\n"}, {"comments": [{"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "edited": false, "score": 0, "creation_date": 1455720823, "post_id": 35459592, "comment_id": 58616312, "body": "hmm unfortunately not, that was one of the things I had tried too and didn&#39;t affect the Subscript out of range error - thanks though, would probably have caused another error after fixing this one I guess! :D Changed now."}], "tags": [], "owner": {"reputation": 3095, "user_id": 28828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77e04a75ca5020461c4670e190d8922?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/28828/oliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1455719667, "creation_date": 1455719667, "answer_id": 35459592, "question_id": 35455673, "link": "https://stackoverflow.com/questions/35455673/access-vba-working-with-an-existing-excel-workbook-run-time-error-9-if-file-i/35459592#35459592", "title": "Access VBA: working with an existing excel workbook (Run-Time error 9, if file is already open)", "body": "<p>If you move the <code>appXL.Workbooks</code> statement to the debugging window, you will find that the names of the items in that collection are without extension.</p>\n\n<p>So in your case, I'm guessing the line should read:</p>\n\n<pre><code>wbXLcore = appXL.Workbooks(\"ResultsOverall\")\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 0, "accepted_answer_id": 35459285, "answer_count": 2, "score": 1, "last_activity_date": 1455722308, "creation_date": 1455709173, "last_edit_date": 1455722308, "question_id": 35455673, "link": "https://stackoverflow.com/questions/35455673/access-vba-working-with-an-existing-excel-workbook-run-time-error-9-if-file-i", "title": "Access VBA: working with an existing excel workbook (Run-Time error 9, if file is already open)", "body": "<p>I'm writing a macro in Access that (hopefully) will:</p>\n\n<ul>\n<li><p>create an Excel worksheet</p></li>\n<li><p>set up and format it based on information in the Access database</p></li>\n<li><p>after user input, will feed entered data into an existing Excel master file</p></li>\n</ul>\n\n<p>Opening the blank sheet etc. is working absolutely fine, but I'm stuck trying to <strong>set the existing master file up as a variable</strong>:</p>\n\n<pre><code>Sub XLData_EnterSurvey()\n\nDim appXL As Excel.Application\nDim wbXLnew, wbXLcore As Excel.Workbook\nDim wsXL As Excel.Worksheet\nDim wbXLname As String\n\nSet appXL = CreateObject(\"Excel.Application\")\nappXL.Visible = True\n\nwbXLname = \"G:\\[*full reference to file*].xlsm\"\n\nIsWBOpen = fnIsWBOpen(wbXLname)\n'separate function (Boolean), using 'attempt to open file and lock it' method\n'from Microsoft site.\n\nIf IsWBOpen = False Then\n    Set wbXLcore = appXL.Workbooks.Open(wbXLname, True, False)\n    'open file and set as variable.\nElseIf IsWBOpen = True Then\n    wbXLcore = appXL.Workbooks(\"ResultsOverall.xlsm\")  'ERROR HERE.\n    'file is already open, so just set as variable.\nEnd If\n\nDebug.Print wbXLcore.Name\nDebug.Print IsWBOpen\n\nSet appXL = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When the file is closed, this works perfectly. However, when it's open I get:</p>\n\n<p>Run-Time error '9':\n<strong>Subscript out of range</strong></p>\n\n<p>I'm only just starting to teach myself VBA (very trial and error!) and nothing else I've seen in answers here / Google quite seems to fit the problem, so I'm a bit lost...</p>\n\n<p>Considering that it <strong>works fine when the file is closed</strong>, I suspect I've just made some silly error in referring to the file - perhaps something to do with the 'createobject' bit and different excel instances??</p>\n\n<p>Any suggestions would be much appreciated! Thanks</p>\n\n<hr>\n\n<p>Thank you @StevenWalker</p>\n\n<p>Here's the working code:</p>\n\n<pre><code>Sub XLData_EnterSurvey()\n\nDim appXL As Excel.Application\nDim wbXLnew As Excel.Workbook, wbXLcore As Excel.Workbook\nDim wsXL As Excel.Worksheet\n\nOn Error GoTo Handler\nSet appXL = GetObject(, \"Excel.Application\")\nappXL.Visible = True\n\nDim wbXLname As String\nwbXLname = \"G:\\ [...] .xlsm\"\n\nIsWBOpen = fnIsWBOpen(wbXLname)\n\nIf IsWBOpen = False Then\n    Set wbXLcore = appXL.Workbooks.Open(wbXLname, True, False)\nElseIf IsWBOpen = True Then\n    Set wbXLcore = appXL.Workbooks(\"ResultsOverall.xlsm\")\nEnd If\n\nSet appXL = Nothing\n\n'-------------------Error handling------------------\nExit Sub\n\n' For if excel is not yet open.\nHandler:\nSet appXL = CreateObject(\"Excel.Application\")\nErr.Clear\nResume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2022458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa625dde6b078e3674aae4aaefa2bd?s=128&d=identicon&r=PG", "display_name": "user2022458", "link": "https://stackoverflow.com/users/2022458/user2022458"}, "edited": false, "score": 0, "creation_date": 1455806856, "post_id": 35455163, "comment_id": 58662669, "body": "Thank you very much for the detailed answer. When running your code above I get the same error for the line &quot;Loop While fnd.Address &lt;&gt; frst&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1455707821, "creation_date": 1455707821, "answer_id": 35455163, "question_id": 35454216, "link": "https://stackoverflow.com/questions/35454216/superscript-r-throughout-workbook-vba/35455163#35455163", "title": "Superscript (R) throughout workbook - VBA", "body": "<p>You cannot get nothing from a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> once you've established that you have found something unless you change the content significantly enough that the Find will not Find it again. You are not actually changing the content, just modifying the formatting. The check against the address is to make sure you do not go through all of the matches and end up back at the beginning which you will eventually do but the .Find is never going to be nothing.</p>\n\n<pre><code>Sub Superscript()\n    Dim sht As Worksheet\n    Dim fnd As Range, frst As String, pos As Long, cnt As Integer\n\n    For Each sht In Worksheets\n        With sht\n            Set fnd = .Cells.Find(Chr(174), LookIn:=xlValues, lookat:=xlPart)    ' Find the first match in the active sheet\n            If Not fnd Is Nothing Then\n                frst = fnd.Address\n                Do\n                    pos = InStr(1, fnd.Value, Chr(174))\n                   Do\n                        fnd.Characters(start:=pos, Length:=1).Font.Superscript = True\n                        pos = InStr(pos + 1, fnd.Value, Chr(174))\n                   Loop While pos &gt; 0\n                   Set fnd = .Cells.FindNext(after:=fnd)\n                Loop While fnd.Address &lt;&gt; frst\n            End If\n        End With\n    Next sht\n\nEnd Sub\n</code></pre>\n\n<p>I don't like to see variables with the same names as reserved words so I have made some superficial changes to the var names as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 2022458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afa625dde6b078e3674aae4aaefa2bd?s=128&d=identicon&r=PG", "display_name": "user2022458", "link": "https://stackoverflow.com/users/2022458/user2022458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455711199, "creation_date": 1455705328, "last_edit_date": 1455711199, "question_id": 35454216, "link": "https://stackoverflow.com/questions/35454216/superscript-r-throughout-workbook-vba", "title": "Superscript (R) throughout workbook - VBA", "body": "<p>I have an Excel workbook containing 10-15 sheets, throughout the workbook I have a number of registered trademark symbols, typed as text in cells (displayed as \u00ae). I need a macro that can run through the content of all cells, find the \u00ae and superscript that part of the cell.</p>\n\n<p>I have made a draft below, but I get a 'Object variable or with block variable not set' error.</p>\n\n<pre><code>Sub Superscript()\n    Application.ScreenUpdating = False\n    Dim sht As Worksheet\n    For Each sht In Worksheets\n    sht.Activate\n    Dim Match As Variant, start As Variant, pos As Long, cnt As Integer\n    With ActiveSheet\n        Set Match = .Cells.Find(\"\u00ae\", LookIn:=xlValues, lookat:=xlPart)    ' Find the first match in the active sheet\n        If Not Match Is Nothing Then\n            start = Match.Address\n            Do\n               cnt = Len(Match.Value) - Len(WorksheetFunction.Substitute(Match.Value, \"\u00ae\", \"\"))\n               pos = InStr(Match.Value, \"\u00ae\")\n            Do\n                Match.Characters(pos, 1).Font.Superscript = True\n                pos = InStr(pos + 1, Match.Value, \"\u00ae\")\n                cnt = cnt - 1\n               Loop While cnt &gt; 0\n               Set Match = .Cells.FindNext(Match)\n            Loop While Not Match Is Nothing And Match.Address &lt;&gt; start\n        End If\n    End With\n    Next sht\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1455704665, "creation_date": 1455704665, "answer_id": 35453947, "question_id": 35453664, "link": "https://stackoverflow.com/questions/35453664/return-highlight-from-userform-to-worksheet-with-vba-in-excel-2010/35453947#35453947", "title": "return &quot;highlight&quot; from userform to worksheet with vba in excel 2010", "body": "<p>How about this:</p>\n\n<pre><code>AppActivate Application.Caption\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 35453947, "answer_count": 1, "score": 1, "last_activity_date": 1455704665, "creation_date": 1455703974, "question_id": 35453664, "link": "https://stackoverflow.com/questions/35453664/return-highlight-from-userform-to-worksheet-with-vba-in-excel-2010", "title": "return &quot;highlight&quot; from userform to worksheet with vba in excel 2010", "body": "<p>I have a worksheet and a userform shown in vbModeless mode, as I need it to be visible all the time. The userform includes a button. This button does a specific job, depending on the current selected cell at the worksheet. After pressing the button, highlight stays at the userform.</p>\n\n<p>What I need is, after pressing the button, highlight to return at the worksheet and be able to scroll at the worksheet or use the arrows (keyboard), without having to clic at the worksheet first.\nI tried this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    ...\n    Worksheets(1).Activate\nEnd Sub\n</code></pre>\n\n<p>but it doesn't do what I want. I also tried the recorder but I got an error. What's the code for doing this?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455704006, "post_id": 35453080, "comment_id": 58604000, "body": "Yes you can, but... If I understand your need you want to create a report with a subset of fields defined in tblC4 depending on user-choices stored in a record of tblConfig. If so a better solution is to work on your query and not at report-level.  Try to build a SQL statement depending on tblConfig data, in VBA, create a query and feed your report with this &#39;dynamic&#39; query."}, {"owner": {"reputation": 11, "user_id": 5707277, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce92bb68cd44920699da28066a6776f7?s=128&d=identicon&r=PG&f=1", "display_name": "Pia A", "link": "https://stackoverflow.com/users/5707277/pia-a"}, "reply_to_user": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455704204, "post_id": 35453080, "comment_id": 58604123, "body": "I understand your suggestion, but how does this afects the format? and when you say to feed my report with a dinamic query, means set a criteria ? or actually create a query in VBA code?"}, {"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455710296, "post_id": 35453080, "comment_id": 58608511, "body": "Create a query is exactly what I do. Hiding Textboxes, changing Recordsource on the fly, too much VBA in the Report itself becomes very quickly a maintenance nightmare. Before you open your report you can delete your query (if it exists), recreate it and then open your report, always linked to the same query."}, {"owner": {"reputation": 11, "user_id": 5707277, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce92bb68cd44920699da28066a6776f7?s=128&d=identicon&r=PG&f=1", "display_name": "Pia A", "link": "https://stackoverflow.com/users/5707277/pia-a"}, "reply_to_user": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455711795, "post_id": 35453080, "comment_id": 58609532, "body": "but the problem is the multicriteria, if i want my query to accomplish 2 conditions for the same field, is no possible to make it wuth a Query... thats why i try to fix tby objects, and code...and thats why i look for an alternate solution..."}, {"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455728801, "post_id": 35453080, "comment_id": 58622279, "body": "What do you mean with Format? Please post the definition of the table so that we can understand a little bit more."}, {"owner": {"reputation": 11, "user_id": 5707277, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce92bb68cd44920699da28066a6776f7?s=128&d=identicon&r=PG&f=1", "display_name": "Pia A", "link": "https://stackoverflow.com/users/5707277/pia-a"}, "reply_to_user": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "edited": false, "score": 0, "creation_date": 1455778171, "post_id": 35453080, "comment_id": 58643862, "body": "By Format i mean the way the text displays. Is no ways to fix the text into justified into these reports?"}], "owner": {"reputation": 11, "user_id": 5707277, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce92bb68cd44920699da28066a6776f7?s=128&d=identicon&r=PG&f=1", "display_name": "Pia A", "link": "https://stackoverflow.com/users/5707277/pia-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459412869, "creation_date": 1455702455, "last_edit_date": 1459412869, "question_id": 35453080, "link": "https://stackoverflow.com/questions/35453080/dynamically-populated-access-report", "title": "Dynamically populated Access Report", "body": "<p>I am building a sub-report and feeding it a query. The information in the query comes from 2 tables. One is constant information (tblC4) and the other is variable information (tblConfig), which comes from a form the user fills. </p>\n\n<p>The problem I'm running into is the <strong>format.</strong> First, I tried to place the fields manually, and by coding VBA, make them visible or not. But that gives me some blank spots, in the format in case the fields are not visible. Then I tried grouping the report (to show only the fields that i want to show according to the selection the user makes). But when i grouped it, It only showed me 2 options of the fields to group... any ideas?</p>\n\n<p>Is there any other way to show different fields in a Report according, to selections made by the user in a form, say like dynamically populated reports?</p>\n"}, {"tags": ["vba", "internet-explorer-8", "html-object"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 5558552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1fb71588edd29af3db4ed7b650b3dee0?s=128&d=identicon&r=PG&f=1", "display_name": "jrdev22", "link": "https://stackoverflow.com/users/5558552/jrdev22"}, "is_accepted": true, "score": 0, "last_activity_date": 1455704235, "creation_date": 1455704235, "answer_id": 35453778, "question_id": 35452661, "link": "https://stackoverflow.com/questions/35452661/vba-html-objects-click-invisible-dropdown/35453778#35453778", "title": "VBA &amp; HTML Objects - click invisible dropdown", "body": "<p>Here's the answer but if someone could explain <strong>why</strong> this is working, i'd be very happy. Thanks</p>\n\n<pre><code>myIE.Navigate (\"javascript:main.filaPopupV3_1.select('alta');\")\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5558552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1fb71588edd29af3db4ed7b650b3dee0?s=128&d=identicon&r=PG&f=1", "display_name": "jrdev22", "link": "https://stackoverflow.com/users/5558552/jrdev22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 35453778, "answer_count": 1, "score": 0, "last_activity_date": 1455704235, "creation_date": 1455701360, "question_id": 35452661, "link": "https://stackoverflow.com/questions/35452661/vba-html-objects-click-invisible-dropdown", "title": "VBA &amp; HTML Objects - click invisible dropdown", "body": "<p>I'm trying to trigger the event <code>main.filaPopupV3_1.select('alta');</code> via VBA in IE8</p>\n\n<p>The dropdown <code>main.filaPopupV3_1</code> is invisible until another button is clicked. I can get the dropdown to become visible but i can't access any of the options in it.</p>\n\n<pre><code>'alta'\n</code></pre>\n\n<p>Is one of the options i want to click.</p>\n\n<p>Thats my code which isn't working.</p>\n\n<pre><code>'IE References at start are\nSet myIE = New InternetExplorerMedium\nSet Document = myIE.Document\n</code></pre>\n\n<p>I skip the navigation etc.</p>\n\n<pre><code>    Document.getElementById(\"BViewElementCSSIcon5\").FireEvent (\"onmouseover\")\n    Document.getElementById(\"BViewElementCSSIcon5\").FireEvent (\"onclick\")\n    Document.getElementById(\"main_filaPopupV3_1_main_filaPopupV3_1_root\").FireEvent (\"onmouseover\")\n    Document.getElementById (\"main.filaPopupV3_1._cancelHide=1;\")\n    Document.getElementById (\"main.filaPopupV3_1.hideMenu('alta');event.cancelBubble=true;\")\n    Document.getElementById(\"main.filaPopupV3_1('alta')\").FireEvent (\"onmouseover\")\n    Document.getElementById (\"main.filaPopupV3_1.select('alta');\")\n    Document.getElementById(\"alta\").Click\n</code></pre>\n\n<p>I know that some lines are unnecassary. Thats just me trying so far</p>\n\n<p><a href=\"http://i.stack.imgur.com/L7DJa.png\" rel=\"nofollow\">HTML source code</a></p>\n"}, {"tags": ["excel", "vba", "filedialog"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1455700058, "post_id": 35451938, "comment_id": 58601052, "body": "If your folder&#39;s path is static you can just set xPath to the path of your folder and remove the FileDialog related lines."}], "answers": [{"comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1455708959, "post_id": 35452140, "comment_id": 58607575, "body": "Yes, thats the way to do it.  Alternatively remove those 3 new lines, remove the <code>Dim xPath</code>, put <code>Const TOPLVL As String = &quot;W:\\ISO 9001\\INTEGRATED_PLANNING\\&quot;</code> at the very top of the the module and just use <code>TOPLVL</code> instead of <code>xPath</code>"}], "tags": [], "owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "is_accepted": false, "score": 1, "last_activity_date": 1455700051, "creation_date": 1455700051, "answer_id": 35452140, "question_id": 35451938, "link": "https://stackoverflow.com/questions/35451938/excel-vba-remove-filedialog/35452140#35452140", "title": "Excel VBA - remove FileDialog", "body": "<p>Sorry all, think I'm being daft - I've answered my own question. \nNot sure if this is the best way but, this seems to work OK.</p>\n\n<p>I replace the following;</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the folder\"\n    .Show\nEnd With\nOn Error Resume Next\nxPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1) &amp; \"\\\"\n</code></pre>\n\n<p>With;</p>\n\n<pre><code>Dim toplvl As String\ntoplvl = \"W:\\ISO 9001\\INTEGRATED_PLANNING\"\nxPath = toplvl &amp; \"\\\"\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455700051, "creation_date": 1455699439, "question_id": 35451938, "link": "https://stackoverflow.com/questions/35451938/excel-vba-remove-filedialog", "title": "Excel VBA - remove FileDialog", "body": "<p>I am using the following code to list files in a folder.</p>\n\n<p>The code works great but, I don't need the user to select the folder, the folder will be the same every time.</p>\n\n<p>Can I remove the FileDialog box? </p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the folder\"\n    .Show\nEnd With\n</code></pre>\n\n<p>And what do I need to replace it with in order to list the files within the same folder each time?</p>\n\n<pre><code>Sub FolderNames()\n\nApplication.ScreenUpdating = False\nDim xPath As String\nDim xWs As Worksheet\nDim fso As Object, j As Long, folder1 As Object\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the folder\"\n    .Show\nEnd With\nOn Error Resume Next\nxPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1) &amp; \"\\\"\nApplication.Workbooks.Add\nSet xWs = Application.ActiveSheet\nxWs.Cells(1, 1).Value = xPath\nxWs.Cells(2, 1).Resize(1, 5).Value = Array(\"Path\", \"Dir\", \"Name\", \"Date Created\", \"Date Last Modified\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet folder1 = fso.getFolder(xPath)\ngetSubFolder folder1\nxWs.Cells(2, 1).Resize(1, 5).Interior.Color = 65535\nxWs.Cells(2, 1).Resize(1, 5).EntireColumn.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\nSub getSubFolder(ByRef prntfld As Object)\nDim SubFolder As Object\nDim subfld As Object\nDim xRow As Long\nFor Each SubFolder In prntfld.SubFolders\n    xRow = Range(\"A1\").End(xlDown).Row + 1\n    Cells(xRow, 1).Resize(1, 5).Value = Array(SubFolder.Path, Left(SubFolder.Path, InStrRev(SubFolder.Path, \"\\\")), SubFolder.Name, SubFolder.DateCreated, SubFolder.DateLastModified)\nNext SubFolder\nFor Each subfld In prntfld.SubFolders\n    getSubFolder subfld\nNext subfld\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 744, "user_id": 1680468, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e3cbf1638016c020bc3f3a0aaff18e8c?s=128&d=identicon&r=PG", "display_name": "GinjaNinja", "link": "https://stackoverflow.com/users/1680468/ginjaninja"}, "edited": false, "score": 1, "creation_date": 1455699127, "post_id": 35451779, "comment_id": 58600437, "body": "Please post your code"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5871957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6cd297e547ba840b6ccd9103f69d972?s=128&d=identicon&r=PG&f=1", "display_name": "newforummember", "link": "https://stackoverflow.com/users/5871957/newforummember"}, "edited": false, "score": 0, "creation_date": 1455701854, "post_id": 35451975, "comment_id": 58602308, "body": "If I dont use a for ,it will overwrite the data selected only in the i=2 row..Even if I increment the index.How can I transfer the data after?"}], "tags": [], "owner": {"reputation": 111, "user_id": 5917820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e68e9ea28162536231c86deff9c253?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Savin", "link": "https://stackoverflow.com/users/5917820/ivan-savin"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699546, "creation_date": 1455699546, "answer_id": 35451975, "question_id": 35451779, "link": "https://stackoverflow.com/questions/35451779/macro-insert-data-into-another-empty-sheet-wont-insert/35451975#35451975", "title": "Macro: Insert data into another empty sheet, won&#39;t insert", "body": "<p>Why do you do <strong>for</strong> to define empty sheet. If you create a new empty sheet, I recoment just to write its number or name.  </p>\n"}], "owner": {"reputation": 3, "user_id": 5871957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6cd297e547ba840b6ccd9103f69d972?s=128&d=identicon&r=PG&f=1", "display_name": "newforummember", "link": "https://stackoverflow.com/users/5871957/newforummember"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455700328, "creation_date": 1455698990, "last_edit_date": 1455700328, "question_id": 35451779, "link": "https://stackoverflow.com/questions/35451779/macro-insert-data-into-another-empty-sheet-wont-insert", "title": "Macro: Insert data into another empty sheet, won&#39;t insert", "body": "<p>I want to inset data into a new empty sheet,but when I define the loop to read the new sheet,it won't do the insertion.</p>\n\n<blockquote>\n  <p>I do the first <strong>For</strong> to define the empty sheet and the second <strong>For</strong> to read the data of the sheet that contains the data.\n  Then I do the logic.But i won't do the importation.\n  Whats wrong? Do I need to reset the empty sheet or something?</p>\n</blockquote>\n\n<p>`</p>\n\n<p><code>For i= 2 To last_row(ws_EmptySheet)</code></p>\n\n<pre><code>   For j = 2 To last_row(ws_Data)\n\n       Set Range_Data = ws_Data.Range(\"A\" &amp; j, \"N\" &amp; Rows.Count)\n</code></pre>\n\n<p><code>If ws_Data.Range(\"D\" &amp; j) = 3 Then</code></p>\n\n<p><code>supplier = ws_Data.Range(\"A\" &amp; j)\n    ind = j\n    indF = j + 1</code></p>\n\n<pre><code>For Each supplier In ws_Data\n\n\nstate = ws_Data.Range(\"K\" &amp; ind, \"N\" &amp; Rows.Count).Find(What:=\"State\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Offset(0, 3)\n  If (state&lt;&gt; \"\") Then\n       r = ws_Data.Range(\"K\" &amp; ind, \"N\" &amp; Rows.Count).Find(What:=\"Nazione\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Row\n</code></pre>\n\n<p><code>'IndI = r</code></p>\n\n<pre><code>    Set rngEmpty = ws_EmptySheet.Range(\"A\" &amp; i)\n\n    i2 = i\n</code></pre>\n\n<p><code>i = i + 1</code></p>\n\n<p><code>indF = indF + 1</code></p>\n\n<p><code>On Error Resume Next</code></p>\n\n<pre><code>If Err.Number &lt;&gt; 0 Then\n</code></pre>\n\n<p><code>rngEmpty = \"\"</code></p>\n\n<pre><code> Else\n</code></pre>\n\n<p><code>supplier = ws_Data.Range(\"A\" &amp; r)</code></p>\n\n<p><code>supplierEmpty = ws_EmptySheet.Cells(1, 1).EntireRow.Find(What:=\"STATE\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Column\n        rngEmpty.Offset(0, supplierEmpty - 1) = supplier</code></p>\n\n<p><code>city = ws_Data.Range(\"B\" &amp; r, \"N\" &amp; indF)</code></p>\n\n<p><code>cityEmpty = ws_AltreSedi.Cells(1, 1).EntireRow.Find(What:=\"CITY\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Column\n          rngEmpty.Offset(0, cityEmpty - 1) = city</code></p>\n\n<p><code>End If</code></p>\n\n<pre><code>     End If\n\n      Next\n\n       End If\n     j = j + 1\n  Next\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1455709829, "last_edit_date": 1455709829, "creation_date": 1455699521, "answer_id": 35451967, "question_id": 35451187, "link": "https://stackoverflow.com/questions/35451187/outlook-recipient-address-in-to-field/35451967#35451967", "title": "Outlook Recipient address in to field", "body": "<p>I imagine it's not returning the <code>SMTP</code> e-mail address as you're using returning the <code>.SenderEmailAddress</code> property on an internal e-mail address (which means it will be <code>EX</code> type address, instead of <code>SMTP</code>).</p>\n\n<p>The below will return the <code>SMTP</code> address for both internal and external.</p>\n\n<pre><code>Dim oOutlook As Outlook.Application\nDim senderAddress As String, recipEntryId As String, SmtpMailAddress As String\nDim oAddressEntry As Outlook.AddressEntry, oExchangeUser As Outlook.ExchangeUser\nDim oReply As Outlook.MailItem, oRecipient As Outlook.Recipient\nDim objItem As Outlook.MailItem\n\nIf objItem.SenderEmailType = \"SMTP\" Then\n\n    senderAddress = objItem.SenderEmailAddress\n\nElse\n\n    Set oReply = objItem.Reply()\n    Set oRecipient = oReply.Recipients.Item(1)\n\n    recipEntryId = oRecipient.EntryID\n\n    oReply.Close OlInspectorClose.olDiscard\n\n    recipEntryId = oRecipient.EntryID\n\n    Set oAddressEntry = oOutlook.GetAddressEntryFromID(recipEntryId)\n    Set oExchangeUser = oAddressEntry.GetExchangeUser()\n\n    senderAddress = oExchangeUser.PrimarySmtpAddress()\n\nEnd If\n\nSmtpMailAddress = senderAddress\n</code></pre>\n\n<p>You can then use the <code>getSmtpMailAddress</code> variable as the <code>.To</code> e-mail address.</p>\n\n<p>If you're using Outlook 2010 or later, there's a way of using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868823.aspx\" rel=\"nofollow\"><code>.PropertyAccessor</code> Property</a>. I've never used this, but it could be worth looking into.</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1455946973, "last_edit_date": 1455946973, "creation_date": 1455706529, "answer_id": 35454671, "question_id": 35451187, "link": "https://stackoverflow.com/questions/35451187/outlook-recipient-address-in-to-field/35454671#35454671", "title": "Outlook Recipient address in to field", "body": "<p>I do not think <code>RecipientEmailAddress</code> is valid in VBA.</p>\n\n<p>Try <strong><code>SenderEmailAddress.</code></strong></p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1455850561, "creation_date": 1455850561, "answer_id": 35496503, "question_id": 35451187, "link": "https://stackoverflow.com/questions/35451187/outlook-recipient-address-in-to-field/35496503#35496503", "title": "Outlook Recipient address in to field", "body": "<p>To move all the recipient address to <strong><code>.To</code></strong> field an example would be.</p>\n\n<pre><code>Option Explicit\nSub Example()\n    Dim olItem As Outlook.MailItem\n    Dim olReply As MailItem ' Reply\n    Dim Recipient As Outlook.Recipient\n    Dim olRecip As String\n\n    If Application.ActiveExplorer.Selection.Count = 0 Then\n        MsgBox \"No Item was Selected \"\n        Exit Sub\n    End If\n\n    For Each olItem In Application.ActiveExplorer.Selection\n        Set olReply = olItem.Reply\n\n        For Each Recipient In olItem.Recipients\n            olRecip = Recipient.address &amp; \";\" &amp; olRecip\n        Next Recipient\n\n        With olReply\n            .To = olRecip ' all the Recipient\n            .Subject = \"Aangaande uw bestelling bij \"\n                       .HTMLBody = \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\" &amp; _\n                        \"&lt;hr width=\"\"50%\"\" size=\"\"2\"\" noshade /&gt;\" &amp; _\n                        \"&lt;font color=\"\"#6699ff\"\"&gt;\" &amp; _\n                        olReply.HTMLBody &amp; \"&lt;/font&gt;\"\n            .Display\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>To add Sender address <strong><code>.To = olRecip &amp; \";\" &amp; olItem.SenderEmailAddress</code></strong></p>\n"}], "owner": {"reputation": 21, "user_id": 5939161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e5781cd93015dfcf3a5612bfe5fbca?s=128&d=identicon&r=PG&f=1", "display_name": "Max van D.", "link": "https://stackoverflow.com/users/5939161/max-van-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1249, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1593073387, "creation_date": 1455696915, "last_edit_date": 1593073387, "question_id": 35451187, "link": "https://stackoverflow.com/questions/35451187/outlook-recipient-address-in-to-field", "title": "Outlook Recipient address in to field", "body": "<p>I'm creating a custom reply were the outlook send from account is changed and some field are automatically filled.</p>\n\n<p>First I'll explain how it works we receive an e-mail. The e-mail address that receives this e-mail is in the CC. I created a button in the top-bar. When i press this button a new e-mail screen opens with some information already filled in and the remaining information we will need to fill in our self.</p>\n\n<p>For the most I have everything setup. But one thing I can't get to work. I want the new e-mail to be send to the original TO (recipient) Address.</p>\n\n<p>For now i have this code:</p>\n\n<pre><code>Sub ReplyUsingAccount()\nDim oAccount As Outlook.Account\nDim objItem As Outlook.MailItem\nDim oMail As Outlook.MailItem\nDim strAcc As String\nDim i As Long\nSet objItem = ActiveExplorer.Selection.Item(1)\nstrAcc = \"myemail@email.nl\"\nFor Each oAccount In Application.Session.Accounts\n    If oAccount.DisplayName = strAcc Then\n        Set oMail = Application.CreateItem(olMailItem)\n        With oMail\n            .SendUsingAccount = oAccount\n            .To = objItem.RecipientEmailAddress\n            .Subject = \"Aangaande uw bestelling bij \"\n                       .HTMLBody = \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\" &amp; _\n                        \"&lt;hr width=\"\"50%\"\" size=\"\"2\"\" noshade /&gt;\" &amp; _\n                        \"&lt;font color=\"\"#6699ff\"\"&gt;\" &amp; _\n                        objItem.HTMLBody &amp; \"&lt;/font&gt;\"\n            .Display\n        End With\n    End If\nNext oAccount\nSet oAccount = Nothing\nSet objItem = Nothing\nSet oMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>The <strong><code>.To = objItem.RecipientEmailAddress</code></strong> won't work.\nAnyone got a solution for that.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "excel", "vba", "epplus", "worksheet"], "comments": [{"owner": {"reputation": 395, "user_id": 3295071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9214af25efea6d18eb983fc9541b2a55?s=128&d=identicon&r=PG&f=1", "display_name": "kilkfoe", "link": "https://stackoverflow.com/users/3295071/kilkfoe"}, "edited": false, "score": 0, "creation_date": 1467242907, "post_id": 35450653, "comment_id": 63656927, "body": "Did you ever find a solution to this? I have been trying to use this to copy a worksheet from one file to another and it copies the data and formulas over correctly, but it isn&#39;t formatted as a table like in the first file and it gives errors when opening."}, {"owner": {"reputation": 1640, "user_id": 553593, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/iW9MU.jpg?s=128&g=1", "display_name": "subsci", "link": "https://stackoverflow.com/users/553593/subsci"}, "edited": false, "score": 0, "creation_date": 1500864307, "post_id": 35450653, "comment_id": 77506580, "body": "Using EPPlus 4.1, an exception occurs on using the <code>Worksheets.Add</code> method to copy a worksheet from one file to another. My workaround is to use the <code>ExcelPackage.SaveAs</code> method to make a copy of the template file. Then I customize the new template file as required."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4566383, "user_type": "registered", "profile_image": "https://graph.facebook.com/956835324335561/picture?type=large", "display_name": "ozan", "link": "https://stackoverflow.com/users/4566383/ozan"}, "is_accepted": false, "score": 0, "last_activity_date": 1467374780, "creation_date": 1467374780, "answer_id": 38145013, "question_id": 35450653, "link": "https://stackoverflow.com/questions/35450653/epplus-copy-worksheet-from-template-to-another-excelpackage-doesnt-work-c/38145013#38145013", "title": "EPPlus - copy worksheet from template to another excelpackage doesnt work (C#)", "body": "<p>My compromise looks like this:</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// Creates an temporary excel-file for the report and returns it as byte-array\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"reportResults\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"reportDetails\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private static byte[] GetReportExcelFile(Dictionary&lt;string, DataSet&gt; reportResults, ReportDetails reportDetails)\n    {\n        var tmpGuid = Guid.NewGuid();\n        var tempFolderForExcelFile = $\"{DefaultFolderForExcelFiles}{tmpGuid}\";\n        var exportFilePath = $\"{tempFolderForExcelFile}\\\\{DefaultExcelFileName}\";\n        var templateFilePath = string.Empty;\n\n        try\n        {\n            Cleanup.DeleteOldFiles(DefaultFolderForExcelFiles, 5, false, true);\n            if (!Directory.Exists(tempFolderForExcelFile))\n            {\n                Directory.CreateDirectory(tempFolderForExcelFile);\n            }\n\n            var excelExportManager = new ExcelExportManager();\n\n            if (!string.IsNullOrEmpty(reportDetails.Template))\n            {\n                // Create resultfile from template\n                exportFilePath = $\"{tempFolderForExcelFile}\\\\OutputReport_{reportDetails.Template}\";\n                templateFilePath = $\"{tempFolderForExcelFile}\\\\Template_{reportDetails.Template}\";\n                File.WriteAllBytes(templateFilePath, reportDetails.TemplateContent);\n            }\n\n            excelExportManager.AddDataSetToExcelFile(reportResults, exportFilePath, templateFilePath);\n\n            using (var filstr = File.Open(exportFilePath, FileMode.Open))\n            {\n                using (var ms = new MemoryStream())\n                {\n                    ms.SetLength(filstr.Length);\n                    filstr.Read(ms.GetBuffer(), 0, (int)filstr.Length);\n                    ms.Flush();\n                    return ms.ToArray();\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            throw new ReportingException(ex.Message);\n        }\n        finally\n        {\n            if (!string.IsNullOrEmpty(tempFolderForExcelFile))\n            {\n                Directory.Delete(tempFolderForExcelFile, true);\n            }\n        }\n    }\n\n    public void AddDataSetToExcelFile(Dictionary&lt;string, DataSet&gt; resultSet, string exportFilePath, string templateFilePath = null)\n    {\n        var excelToExport = new FileInfo(exportFilePath);\n        FileInfo template = null;\n        if (!string.IsNullOrEmpty(templateFilePath))\n        {\n            template = new FileInfo(templateFilePath);\n        }\n        using (var excelPackage = string.IsNullOrEmpty(templateFilePath) ? new ExcelPackage(excelToExport) : new ExcelPackage(excelToExport, template))\n        {\n            foreach (var result in resultSet)\n            {\n                var sheetCount = 1;\n                var sourceName = result.Key;\n                foreach (DataTable resultTable in result.Value.Tables)\n                {\n                    var proposedSheetName = result.Value.Tables.Count == 1 ? sourceName : string.Format(\"{0}_{1}\", sourceName, sheetCount);\n                    var worksheet = excelPackage.Workbook.Worksheets.FirstOrDefault(ws =&gt; ws.Name == proposedSheetName);\n                    if (worksheet == null)\n                    {\n                        worksheet = excelPackage.Workbook.Worksheets.Add(proposedSheetName);\n                        FillWorksheetWithDataTableContent(ref worksheet, resultTable, TableStyles.Medium27);\n                    }\n                    else\n                    {\n                        FillWorksheetWithDataTableContent(ref worksheet, resultTable);\n                    }\n                    sheetCount++;\n                }\n            }\n            excelPackage.SaveAs(excelToExport);\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4566383, "user_type": "registered", "profile_image": "https://graph.facebook.com/956835324335561/picture?type=large", "display_name": "ozan", "link": "https://stackoverflow.com/users/4566383/ozan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3787, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467374780, "creation_date": 1455695105, "last_edit_date": 1455695671, "question_id": 35450653, "link": "https://stackoverflow.com/questions/35450653/epplus-copy-worksheet-from-template-to-another-excelpackage-doesnt-work-c", "title": "EPPlus - copy worksheet from template to another excelpackage doesnt work (C#)", "body": "<p>I'm having a DataSet filled with different DataTables SQL-Results. Some of the DataTables are connected with a  Excel-Template-File. So in the end in want to have an excelfile with a mixture of new worksheets and copied worksheets from some template.</p>\n\n<p>That's why my code looks like this:</p>\n\n<pre><code>public void CopyResultToExcelFileWithTemplate(DataSet sourceResult, string exportFilePath, string sourceName, string templateExcelFilePath, string sheetName = null)\n{\n    var excelFile = new FileInfo(exportFilePath);\n    var templateFile = new FileInfo(templateExcelFilePath);\n    if (string.IsNullOrEmpty(sheetName))\n    {\n        sheetName = sourceName;\n    }\n\n    // Open and get worksheets from template\n    using (var template = new ExcelPackage(templateFile))\n    {\n        var excelWorksheets = template.Workbook.Worksheets;\n        var sheetCount = 1;\n        foreach (DataTable resultTable in sourceResult.Tables)\n        {\n            var proposedSheetName = sourceResult.Tables.Count == 1 ? sheetName : string.Format(\"{0}_{1}\", sheetName, sheetCount);\n            var currentWorksheet = excelWorksheets.FirstOrDefault(w =&gt; string.Equals(w.Name, proposedSheetName, StringComparison.CurrentCultureIgnoreCase)) ?? excelWorksheets.Add(proposedSheetName);\n            FillWorksheetWithDataTableContent(currentWorksheet, resultTable);\n            using (var excelToExport = new ExcelPackage(excelFile))\n            {\n                excelToExport.Workbook.Worksheets.Add(currentWorksheet.Name, currentWorksheet);\n                excelToExport.Save();\n            }\n            sheetCount++;\n        }\n    }\n}\n\npublic void CopyResultToExcelFile(DataSet resultSet, string exportFilePath, string sourceName, string sheetName = null)\n{\n    if (string.IsNullOrEmpty(sheetName))\n    {\n        sheetName = sourceName;\n    }\n    var excelToExport = new FileInfo(exportFilePath);\n    using (var excelPackage = new ExcelPackage(excelToExport))\n    {\n        var sheetCount = 1;\n        foreach (DataTable resultTable in resultSet.Tables)\n        {\n            var proposedSheetName = resultSet.Tables.Count == 1 ? sheetName : string.Format(\"{0}_{1}\", sourceName, sheetCount);\n            var worksheet = excelPackage.Workbook.Worksheets.Add(proposedSheetName);\n            FillWorksheetWithDataTableContent(worksheet, resultTable);\n            sheetCount++;\n        }\n        excelPackage.Save();\n    }\n}\n</code></pre>\n\n<p>So I fill the temporary created excelfile with a combination of worksheet-copys from a template and with new worksheets. It works fine, it shows the content of all DataTables in the excelfile in their own worksheet, BUT when the excelfile  contains copied worksheets there are two error message appearing and the copied worksheets arent formatted.</p>\n\n<p><a href=\"http://i.stack.imgur.com/p2jUL.png\" rel=\"nofollow\">excelfilecorrupt</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/fZvBu.png\" rel=\"nofollow\">worksheetunreadable</a></p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455727849, "post_id": 35450580, "comment_id": 58621677, "body": "Part (or maybe all) of your problem comes from VBA not being able to distinnguish to which object model your Range, Cell and perhaps Table objects belong. Both Word and Excel use these terms, so you need to make it clear to VBA which is meant. This is done in the &quot;Dim&quot; statements. Instead of Dim x as Range use Dim x as Word.Range or as Excel.Range, as appropriate. Same for Cell and for Table. Actually, it&#39;s a good habit to always fully qualify object declarations. Also, make sure you&#39;ve set a Reference to the Excel library (Tools/References)."}, {"owner": {"reputation": 173, "user_id": 5826539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153892599364570/picture?type=large", "display_name": "Mert Karakaya", "link": "https://stackoverflow.com/users/5826539/mert-karakaya"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455728165, "post_id": 35450580, "comment_id": 58621889, "body": "@cindy I have actually tried it that way as well, but I still get the error 5941, unfortunately. Also, one more regard, I don&#39;t get the error immediatly, code runs through the loop several times but gives 5941 after 4th run."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455734511, "post_id": 35450580, "comment_id": 58625715, "body": "You can&#39;t set an Excel.Range to a Word.Range - the name is the same, so it&#39;s tempting, but the objects don&#39;t correspond. You want the text from Excel in the Word cell? Show us the other code variation with oCell.Value so that we can see what you&#39;re doing there. I think what you want is something like rText.Text = oCell.Value2..."}, {"owner": {"reputation": 173, "user_id": 5826539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153892599364570/picture?type=large", "display_name": "Mert Karakaya", "link": "https://stackoverflow.com/users/5826539/mert-karakaya"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1455779834, "post_id": 35450580, "comment_id": 58644602, "body": "I actually want to get text from the word tables depending on the header of the tables, and input them into certain columns in Excel. I have several documents with text and tables, so I want to get the headers and sub-headers (identifies in tables) and input those input along with the assigned text of sub-headers in the tables."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 5826539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153892599364570/picture?type=large", "display_name": "Mert Karakaya", "link": "https://stackoverflow.com/users/5826539/mert-karakaya"}, "edited": false, "score": 0, "creation_date": 1456130662, "post_id": 35490406, "comment_id": 58786618, "body": "Thanks for the answer, however even with these changes it gives errors, so I have decided to transfer tables into a new excel worksheet as is and sort them out in excel instead."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1455973362, "last_edit_date": 1455973362, "creation_date": 1455822824, "answer_id": 35490406, "question_id": 35450580, "link": "https://stackoverflow.com/questions/35450580/transferring-word-table-data-to-excel-table/35490406#35490406", "title": "Transferring Word Table Data to Excel Table", "body": "<p>That you're getting the error inconsistently doesn't help, of course, but there are a number of things wrong with how you're going about integrating the Excel and Word object models. I can see why someone would try to approach it the way you do. VBA tries to be very forgiving and guess what people mean, but it doesn't always get it right, which may be the reason the code is failing intermittently rather than consistently.</p>\n\n<ol>\n<li><p>A basic issue is that you should use the Text property of a Word.Range when you want the text content. VBA will often do it for you, at least while everything is in Word, but you shouldn't take it for granted. For example: <code>If rHeader.Text = \"Position\" Then</code></p></li>\n<li><p>You try: <code>Set oWrks.Cells(oWrks.Rows.Count, 1) = rText</code> </p>\n\n<p>Use the <code>Set</code> keyword to assign an object to an object variable. It would be possible for you to do this: <code>Set oCell = oWrks.Cells(oWrks.Rows.Count, 1).Range</code>. See the difference? <code>oCell</code> is an object variable. Doing this allows you to work with <code>oCell</code> instead of always typing out <code>oWrks.Cells(oWrks.Rows.Count, 1)</code>.</p></li>\n<li><p>As mentioned in comments, you cannot assign a Word.Range object to an object in Excel. Building on (2), it's <em>not</em> possible for you to do this: <code>Set oCell = rText</code>. While both are Range objects, one is Excel and the other is Word - they are <em>not</em> the same thing, even though the name appears the same.</p></li>\n<li><p>In order to assign the text in a Word.Range to a cell/Range in Excel you need something more like this: <code>oCell.Text = rText.Text</code> (It could perhaps also be <code>oCell.Value = rText.Text</code>)</p></li>\n</ol>\n\n<p>I think if you make these changes throughout your code execution should be more consistent.</p>\n"}], "owner": {"reputation": 173, "user_id": 5826539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153892599364570/picture?type=large", "display_name": "Mert Karakaya", "link": "https://stackoverflow.com/users/5826539/mert-karakaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 35490406, "answer_count": 1, "score": 0, "last_activity_date": 1562649435, "creation_date": 1455694892, "last_edit_date": 1562649435, "question_id": 35450580, "link": "https://stackoverflow.com/questions/35450580/transferring-word-table-data-to-excel-table", "title": "Transferring Word Table Data to Excel Table", "body": "<p>I have written/compiled the code using several sources and my own knowledge, however it keeps giving me errors. I am new on Word VBA so struggling to debug it. Tables on Word contains headers and the excel template I am using have a different layout than the word tables, hence I need to sort values according to headers and insert them into the appropriate column in excel template. The template at the end should be saved as a different workbook, and values in the template should be cleaned out.</p>\n\n<p>Error I am getting is: I am getting compile errors on \"oCell.Value\" parts if I set oCell as range, however, when I set oCell as object I get error 5941 on \"Set rText = oTable.Cell(i, n).Range\". I can't figure out how. Also, if you tell me that to implement such code in Excel VBA would be easier, I am happy to do the same procedure on Excel as well.</p>\n\n<p>Edit: I have added \"Application.Templates.LoadBuildingBlocks\" however it still gives the same error.</p>\n\n<pre><code>Sub Word2ExcelRTM()\n    Dim oDoc As Word.Document, oXlm As Excel.Workbook\n    Dim oTable As Word.Table\n    Dim oRng As Word.Range\n    Dim sFname As String\n    Dim rText As Word.Range\n    Dim rHeader As Word.Range\n    Dim oWrks As Excel.Worksheet\n    Dim oCell As Excel.Range\n\n    Application.Templates.LoadBuildingBlocks\n\n    'Change the path in the line below to reflect the name and path of the table document\n\n    sFname = \"C:\\Users\\KarakaMe\\Desktop\\transfer requirements into RTM     excel\\transfer requirements into RTM excel\\RTM Template.xlsx\"\n    Set oDoc = ActiveDocument\n    Set oXlm = Workbooks.Open(FileName:=sFname)\n    Set oWrks = oXlm.Worksheets(\"RTM_FD\")\n\n    'Searches each table in Word Doc\n\n    For Each oTable In oDoc.Tables\n        If oTable.Rows.Count &gt; 1 And oTable.Columns.Count &gt; 1 Then\n            For i = 2 To oTable.Rows.Count - 1\n                For n = 1 To oTable.Columns.Count - 1\n                   Set oRng = oDoc.Range\n                   Set rText = oTable.Cell(i, n).Range\n                   rText.End = rText.End - 1\n                   Set rHeader = oTable.Cell(1, n).Range\n                   rHeader = rHeader.End - 1\n                   If rHeader = \"Position\" Then\n                        Set oWrks.Cells(oWrks.Rows.Count, 1) = rText\n                   ElseIf rHeader = \"Anforderung Lastenheft\" Then\n                        Set oWrks.Cells(oWrks.Rows.Count, 2) = rText\n                   ElseIf rHeader = \"Kommentar zum Lastenheft\" Then\n                        Set oWrks.Cells(oWrks.Rows.Count, 3) = rText\n                   ElseIf rHeader = \"Q TA P t.b.d.*\" Then\n                        If rText = \"P\" Then\n                            Set oCell = oWrks.Cells(oWrks.Rows.Count, 9)\n                            oCell.Value = \"X\"\n                            oCell.Range.HighlightColorIndex = wdDarkYellow\n                        ElseIf rText = \"Q\" Then\n                            Set oCell = oWrks.Cells(oWrks.Rows.Count, 7)\n                            oCell.Value = \"X\"\n                            oCell.Range.HighlightColorIndex = wdDarkYellow\n                        ElseIf rText = \"TA\" Then\n                            Set oCell = oWrks.Cells(oWrks.Rows.Count, 8)\n                            oCell.Value = \"X\"\n                            oCell.Range.HighlightColorIndex = wdDarkYellow\n                        Else\n                        End If\n                   Else\n                   End If\n                Next n\n            Next i\n        End If\n    Next oTable\n    oXlm.SaveAs (InputBox(\"Please enter the name of the new file\"))\n    MsgBox \"Your file is saved\"\n    oXlm.Close (False)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "dir"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5939025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30cc5023a0d24d9d3e88b1fc8a7673c?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Phillips", "link": "https://stackoverflow.com/users/5939025/ryan-phillips"}, "edited": false, "score": 0, "creation_date": 1455695614, "post_id": 35450558, "comment_id": 58598467, "body": "Great, thank you. What command will remove the directory regardless of whether it has files or not?"}, {"owner": {"reputation": 888, "user_id": 1179915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30828426c333660c5bfdd8712a1b3729?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1179915/daniel"}, "edited": false, "score": 1, "creation_date": 1455696677, "post_id": 35450558, "comment_id": 58599011, "body": "first, <b>Kill directory &amp; &quot;*.*&quot;</b> &#39;delete all files in the folder C:\\directory\\*.*"}, {"owner": {"reputation": 888, "user_id": 1179915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30828426c333660c5bfdd8712a1b3729?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1179915/daniel"}, "edited": false, "score": 1, "creation_date": 1455696693, "post_id": 35450558, "comment_id": 58599017, "body": "then <b>RmDir</b> directory &#39;delete folder C:\\directory\\"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 888, "user_id": 1179915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30828426c333660c5bfdd8712a1b3729?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1179915/daniel"}, "edited": false, "score": 0, "creation_date": 1455698061, "post_id": 35450558, "comment_id": 58599815, "body": "Thank you @daniel; I had taken the OP at his/her word that <i>&#39;I know how to delete a single directory&#39;</i>."}, {"owner": {"reputation": 1, "user_id": 5939025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30cc5023a0d24d9d3e88b1fc8a7673c?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Phillips", "link": "https://stackoverflow.com/users/5939025/ryan-phillips"}, "edited": false, "score": 0, "creation_date": 1455700212, "post_id": 35450558, "comment_id": 58601162, "body": "Thank you for your input."}, {"owner": {"reputation": 1, "user_id": 5939025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30cc5023a0d24d9d3e88b1fc8a7673c?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Phillips", "link": "https://stackoverflow.com/users/5939025/ryan-phillips"}, "edited": false, "score": 0, "creation_date": 1455716121, "post_id": 35450558, "comment_id": 58612648, "body": "@Jeeped After some trial and error I realized that my csv was not importing the &quot;\\&quot; at the end of the directory. The code is working, but how do you delete all sub directories and contents as well? I have tried variations but with no luck. &#39;code&#39; |Sub deletedir()  On Error Resume Next With Worksheets(&quot;Folders&quot;)     For Dr = 1 To .Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row         If CBool(Len(.Cells(Dr, &quot;A&quot;).Value2)) Then                 Kill .Cells(Dr, &quot;A&quot;).Value2 &amp; &quot;<i>.</i>&quot;                 RmDir .Cells(Dr, &quot;A&quot;).Value2 &amp; &quot;\\&quot;             End If     Next Dr     On Error GoTo 0 End With  End Sub"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1455698109, "last_edit_date": 1455698109, "creation_date": 1455694802, "answer_id": 35450558, "question_id": 35450429, "link": "https://stackoverflow.com/questions/35450429/vba-delete-list-of-folders-in-excel-spreadsheet/35450558#35450558", "title": "VBA delete list of folders in Excel spreadsheet", "body": "<p>This loop will walk down column A from row 2 to the last populated row. Each cell is first examined to see if it is non-blank then it is examined to see if it exists as a folder with the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278779.aspx\" rel=\"nofollow\">Dir function</a>.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    For dr = 2 To .Cells(Rows.Count, \"A\").End(xlUp).Row\n        If CBool(Len(.Cells(dr, \"A\").Value2)) Then\n            If CBool(Len(Dir(.Cells(dr, \"A\").Value2, vbdirectrory))) Then\n                Kill .Cells(dr, \"A\").Value2 &amp; Chr(92) * Chr(42)\n                RmDir .Cells(dr, \"A\").Value2 \n            End If\n        End If\n    Next dr\nEnd With\n</code></pre>\n\n<p>If both tests pass, then the folder is removed with the <a href=\"https://msdn.microsoft.com/en-us/library/ey1w10ch.aspx\" rel=\"nofollow\">Kill function</a>. If the folder is populated with files, they should be removed first.</p>\n"}], "owner": {"reputation": 1, "user_id": 5939025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30cc5023a0d24d9d3e88b1fc8a7673c?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Phillips", "link": "https://stackoverflow.com/users/5939025/ryan-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455698109, "creation_date": 1455694299, "last_edit_date": 1455695093, "question_id": 35450429, "link": "https://stackoverflow.com/questions/35450429/vba-delete-list-of-folders-in-excel-spreadsheet", "title": "VBA delete list of folders in Excel spreadsheet", "body": "<p>I am using an application called \"All Dup\" to find duplicate files, normally matching by CRC checksum. Once I have run the scan I am left with a list of about 10000 duplicate files. I can then export the results as a csv file. What I would like to do is have a Macro that will go and delete all the specified folders in a column, i.e, I have all the folders in column A.</p>\n\n<p>I know how to delete a single directory, but would really appreciate some help with a \"loop\" function or something along those lines.</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1455695259, "post_id": 35450314, "comment_id": 58598275, "body": "I run your code and found no unwanted beheaviour. pressing button &quot;RESET&quot; would always have other buttons enabled"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1455697909, "post_id": 35450314, "comment_id": 58599728, "body": "I run the code too and have the same behavior as Frank Zed, both with Excel 2007 and Excel 2016."}], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 2815904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33fa3fda9c436e7bd0748d8c1da7fed0?s=128&d=identicon&r=PG&f=1", "display_name": "CoveGeek", "link": "https://stackoverflow.com/users/2815904/covegeek"}, "is_accepted": false, "score": 1, "last_activity_date": 1455732377, "creation_date": 1455732377, "answer_id": 35464356, "question_id": 35450314, "link": "https://stackoverflow.com/questions/35450314/disable-a-button-via-a-function/35464356#35464356", "title": "Disable a button via a function?", "body": "<p>If you have trouble calling through an indirrect reference, then use a static parameter.</p>\n\n<pre><code>Private Sub ONE_Click()\n    Calc \"TWO\"\nEnd Sub\n\nPrivate Sub TWO_Click()\n    Calc \"ONE\"\nEnd Sub\n</code></pre>\n\n<p>Now you can use that parameter to act on the object.</p>\n\n<pre><code>Function Calc(B As String)\nIf B = \"ONE\" Then\n    ONE.Enabled = False\nElseIf B = \"TWO\" Then\n    TWO.Enabled = False\nElse\n    Exit Function\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5938254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64885bb381fbd69e48c5e5be3e66a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Zed", "link": "https://stackoverflow.com/users/5938254/frank-zed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1455732377, "creation_date": 1455693864, "last_edit_date": 1531164843, "question_id": 35450314, "link": "https://stackoverflow.com/questions/35450314/disable-a-button-via-a-function", "title": "Disable a button via a function?", "body": "<p>Currently using vba with excel 2007...</p>\n\n<p>I am currently testing the capabilities of functions and am a little stuck using buttons. I have two buttons, named ONE and TWO. Pressing either calls up a function Calc with each button passing the variable of the others name. As follows:</p>\n\n<pre><code>Private Sub ONE_Click()\nCalc TWO\nEnd Sub\n\nPrivate Sub TWO_Click()\nCalc ONE\nEnd Sub\n\nFunction Calc(B As CommandButton)\nB.Enabled = False\nEnd Function\n</code></pre>\n\n<p>My understanding is that pressing button ONE passes the variable TWO to the Function Calc, and then disables button TWO.</p>\n\n<p>I also have a button labeled Reset which serves as follows:</p>\n\n<pre><code>Private Sub Reset_Click()\nONE.Enabled = True\nTWO.Enabled = True\nEnd Sub\n</code></pre>\n\n<p>The results of this, if I press button ONE, button TWO greys out and appears \"disabled\". However when I hit the reset button, it stays grey. Investigating the properties of the button reveals that it doesn't actually get disabled. I installed another button that directly disables button two, i.e. TWO.Enabled = False, instead of using a variable to do so.</p>\n\n<p>When the button is directly disabled using the direct button, resetting enables the button as it should, and the properties reflect that the button is disabled.</p>\n\n<p>Would anyone know why using a variable to disable a button like this results in an illusionary disabling?\nAnd better yet, how to overcome the issue?</p>\n"}, {"tags": ["excel", "vba", "google-chrome", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5389196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7c2e389cd15daa27eaba9424d85551?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt01", "link": "https://stackoverflow.com/users/5389196/hunt01"}, "edited": false, "score": 0, "creation_date": 1456498135, "post_id": 35519374, "comment_id": 58989800, "body": "Thank you so much for your clear explanation, florentbr. I tried your codes and extended the waiting time a bit then it works good. Thank you again."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 5, "last_activity_date": 1455944937, "creation_date": 1455944937, "answer_id": 35519374, "question_id": 35449770, "link": "https://stackoverflow.com/questions/35449770/selenium-vba-to-control-chrome/35519374#35519374", "title": "Selenium + VBA to Control Chrome", "body": "<blockquote>\n  <p>I am confused why I have to send 2 times of \"Ctrl+t\" keys to successfully open new tab.</p>\n</blockquote>\n\n<p>The modifier key should be in the first argument and the key in the second one:</p>\n\n<pre><code>driver.SendKeys Keys.Control, \"t\"\n</code></pre>\n\n<p>In your case, a better way would be to open a new window with some Javascript:</p>\n\n<pre><code>Private Keys As New selenium.Keys\nPrivate driver As New selenium.ChromeDriver\n\nSub test()\n  Const JS_NEW_WINDOW = \"window.open(arguments[0], name);\"\n\n  driver.Get \"http://www.google.com/\"\n  For i = 0 To 9\n    If i Then\n      driver.ExecuteScript JS_NEW_WINDOW, \"http://www.google.com/\"\n      driver.SwitchToNextWindow\n      driver.FindElementById(\"lst-ib\").SendKeys \"some text \" &amp; i\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Why that I have to add selenium.SwitchToNextWindow after opening new tab, or the next url will be opened on the original tab, not new tab?</p>\n</blockquote>\n\n<p>The context of the driver remains the same when a new window is opened. You have to explicitly tell the driver that you want to operate on another window.</p>\n\n<blockquote>\n  <p>Quite often after opening 3~5 urls, vba pops up \"not enough memory\" error and stops loading the next url. But if I run the codes line by line in debugging environment, all 10 urls can be successfully opened. Why's that?</p>\n</blockquote>\n\n<p>Probably because some of the memory is released once the page is fully loaded. But since you are loading all the pages in a row, it may not leave the browser enough time to manage it's memory.\nI would try to disable the plugins if any  (especially Flash) and add some waiting:</p>\n\n<pre><code>Dim driver As New Selenium.ChromeDriver\ndriver.SetPreference \"plugins.plugins_disabled\", Array(\"Adobe Flash Player\")\nFor i = 0 To 9\n  driver.Get \"http://www.google.com/\"\n  Waiter.wait 500  ' waits 500ms\nNext\n</code></pre>\n\n<blockquote>\n  <p>I googled that if I want chrome not to exit after finishing running macro, I have to declare object selenium outside the sub though I do not quite get the reason. Could anyone help explain me in plain way?</p>\n</blockquote>\n\n<p>The driver is automatically terminated once the variable holding the driver is no longer used.\nCheck this link to get more information about variable and scopes: <a href=\"https://support.microsoft.com/en-gb/kb/141693\" rel=\"noreferrer\">https://support.microsoft.com/en-gb/kb/141693</a> .\nSo to keep the driver alive outside of a procedure, it must be declared outside:</p>\n\n<pre><code>Dim driver As Selenium.ChromeDriver\n\nSub Main\n  Set driver = New Selenium.ChromeDriver\n  driver.Get \"http://www.google.com/\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5389196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7c2e389cd15daa27eaba9424d85551?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt01", "link": "https://stackoverflow.com/users/5389196/hunt01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19550, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455944937, "creation_date": 1455691818, "question_id": 35449770, "link": "https://stackoverflow.com/questions/35449770/selenium-vba-to-control-chrome", "title": "Selenium + VBA to Control Chrome", "body": "<p>I use selenium + vba to launch chrome to open 10 urls listed in cells range(\"A1:A10\").\nI am not familiar with selenium, after trying a lot of times I finally come out below clunky codes.</p>\n\n<pre><code>Private selenium As New ChromeDriver\n\nSub test()\nDim cell As Range\nDim keys As New selenium.keys\nDim pageNo As Integer\n\n    pageNo = 0\n    selenium.Start \"chrome\", \"http://www.google.com/\"\n    For Each cell In Range(\"A1:A10\")\n        If pageNo &gt;= 1 Then\n            selenium.SendKeys keys.Control &amp; \"t\" + keys.Control &amp; \"t\"\n            selenium.SwitchToNextWindow\n        End If\n        selenium.Get cell.Value\n        pageNo = pageNo + 1\n    Next\nEnd Sub\n</code></pre>\n\n<p>Several troubles and questions raised:</p>\n\n<ol>\n<li><p>I am confused why I have to send 2 times of \"Ctrl+t\" keys to successfully open new tab.</p></li>\n<li><p>Why that I have to add selenium.SwitchToNextWindow after opening new tab, or the next url will be opened on the original tab, not new tab?</p></li>\n<li><p>Quite often after opening 3~5 urls, vba pops up \"not enough memory\" error and stops loading the next url. But if I run the codes line by line in debugging environment, all 10 urls can be successfully opened. Why's that?</p></li>\n<li><p>I googled that if I want chrome not to exit after finishing running macro, I have to declare object selenium outside the sub though I do not quite get the reason. Could anyone help explain me in plain way?</p></li>\n</ol>\n\n<p>If any experts can help me optimize my codes, that would be much appreciated! My system is Win7 64bit + Excel 2010.</p>\n\n<p>Thanks with best regards.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455689443, "post_id": 35449071, "comment_id": 58595565, "body": "<code>rng3.SparkLineGroups.Add ...</code> since rng3 is already a Range object."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455690536, "post_id": 35449071, "comment_id": 58596034, "body": "<code>rng3.SparklineGroups.Add Type:=xlSparkLine, SourceData:=CStr(rng4.Address)</code>  Gives me an error of &quot;Method &#39;Add&#39; of object &#39;SparklineGroups&#39; failed&quot;"}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1455693825, "post_id": 35449071, "comment_id": 58597568, "body": "Have you debugged the code with breakpoints to see where the actual error occurs, and to check if the variables you have used up until then contains the expected values?  Also from what I remember, merged cells are rather poorly implemented and don&#39;t always behave the way you would expect."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "reply_to_user": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1455718699, "post_id": 35449071, "comment_id": 58614584, "body": "@johankr Yes, I&#39;ve debugged the code and the reference to rng3 and rng4 both work until I enter the sparkline code. And on top of that, I&#39;m using MAC Excel 2016- not sure if that changes the necessary range references."}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 1, "creation_date": 1455721020, "post_id": 35449071, "comment_id": 58616452, "body": "I get the below code sample to work (with and without the formatting) so there doesn&#39;t seem to be anything wrong with the code iteself.  <code>Sub AddSparkline()     Dim i As Integer     Dim rng3 As Range     Dim rng4 As Range       i = 3     Set rng3 = Worksheets(&quot;Sheet1&quot;).Range(&quot;Section&quot; &amp; i)     Set rng4 = Worksheets(&quot;Sheet1&quot;).Range(&quot;TBLCOL&quot; &amp; i)          rng3.SparklineGroups.Add Type:=xlSparkColumn, SourceData:=CStr(rng4.Address) End Sub</code>  Can&#39;t think of any data in the range that could create a problem either."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "reply_to_user": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1455721477, "post_id": 35449071, "comment_id": 58616812, "body": "@johankr Just tried that exact code and am getting this error: (Run-time error &#39;1004&#39;: Method &#39;Add&#39; of object &#39;SparklineGroups&#39; failed.) Wondering if MAC Excel 2016 is the culprit?"}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1455721768, "post_id": 35449071, "comment_id": 58617034, "body": "I think it is the merged cells that is causing the problem. Try adding the sparkline somewhere else and see if that works."}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1455721824, "post_id": 35449071, "comment_id": 58617076, "body": "Or try unmerging the cells first, and see what happens. I managed to add sparklines to a merged cell though, so that can&#39;t be the whole story either way though."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1455722263, "post_id": 35449071, "comment_id": 58617388, "body": "It is the merged cell- just tried it without the merged cell and it worked. Okay back to the drawing board. Thanks for the pointers."}], "owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2595, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455690724, "creation_date": 1455689045, "last_edit_date": 1455690724, "question_id": 35449071, "link": "https://stackoverflow.com/questions/35449071/vba-excel-creating-sparkline", "title": "VBA Excel Creating Sparkline", "body": "<p>Creating Sparkline in a merged cell referenced as \"Section3\". The Data I want to reference for the Sparkline chart is located in a named field \"TBLCOL3\".</p>\n\n<pre><code>&lt;Sub Macro14()\nDim ws As Worksheet\nDim i As Integer\nDim rng3 As Range\nDim rng4 As Range\n\nSet ws = ActiveSheet\ni = 3\n\nSet rng3 = ActiveSheet.Range(\"Section\" &amp; i)\nSet rng4 = ActiveSheet.Range(\"TBLCOL\" &amp; i)\n\nrng3.SparklineGroups.Add Type:=xlSparkLine, SourceData:=CStr(rng4.Address)\nSelection.SparklineGroups.Item(1).SeriesColor.ThemeColor = 5\nSelection.SparklineGroups.Item(1).SeriesColor.TintAndShade = -0.499984740745262\nSelection.SparklineGroups.Item(1).Points.Negative.Color.ThemeColor = 6\nSelection.SparklineGroups.Item(1).Points.Negative.Color.TintAndShade = 0\nSelection.SparklineGroups.Item(1).Points.Markers.Color.ThemeColor = 5\nSelection.SparklineGroups.Item(1).Points.Markers.Color.TintAndShade = - _\n    0.499984740745262\nSelection.SparklineGroups.Item(1).Points.Highpoint.Color.ThemeColor = 5\nSelection.SparklineGroups.Item(1).Points.Highpoint.Color.TintAndShade = 0\nSelection.SparklineGroups.Item(1).Points.Lowpoint.Color.ThemeColor = 5\nSelection.SparklineGroups.Item(1).Points.Lowpoint.Color.TintAndShade = 0\nSelection.SparklineGroups.Item(1).Points.Firstpoint.Color.ThemeColor = 5\nSelection.SparklineGroups.Item(1).Points.Firstpoint.Color.TintAndShade = _\n    0.399975585192419\nSelection.SparklineGroups.Item(1).Points.Lastpoint.Color.ThemeColor = 5\nSelection.SparklineGroups.Item(1).Points.Lastpoint.Color.TintAndShade = _\n    0.399975585192419\nEnd Sub&gt;\n</code></pre>\n\n<p>I'm using i=3 as this is the foundation for a loop that I will create. I have already created the code that goes through every table and creates one merged cell 2 columns to the right of my Table, Names the merged Cell as \"Section\" &amp; i. And then finds the 3rd data column in my Table and names it \"TBLCOL\" &amp; i.</p>\n\n<p>This is the last piece to the puzzle- any feedback would be much appreciated. The above code returns the global failure error message. I know that corresponds to the variable reference but am unable to resolve on my own.</p>\n\n<p><em>Edit: Modified for first comment and added formatting gathered during \"Record Macro\"</em></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 0, "creation_date": 1455690412, "post_id": 35449162, "comment_id": 58595979, "body": "Hi,it seems that works as seem as what I have done before. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1455690636, "post_id": 35449162, "comment_id": 58596073, "body": "My apologies; I forgot to strip off the Date portion of Now to leave only the Time portion. Rectified above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 0, "creation_date": 1455690895, "post_id": 35449162, "comment_id": 58596180, "body": "Thank you so much Jeeped for the guidance! It is now working well!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1455690590, "last_edit_date": 1455690590, "creation_date": 1455689473, "answer_id": 35449162, "question_id": 35449036, "link": "https://stackoverflow.com/questions/35449036/comparing-input-time-and-current-time/35449162#35449162", "title": "Comparing input time and current time", "body": "<p>You need the to convert a string representing time to an actual time value with <a href=\"https://msdn.microsoft.com/en-us/library/hz2ahtzs%28v=vs.90%29.aspx\" rel=\"nofollow\">TimeValue</a>. It seems your process was a little backwards. You wanted to get a true numerical time value to compare against Now; not a string to compare against a string representing Now.</p>\n\n<pre><code>dim tm as date\ntm = TimeValue(\"11:59:59 AM\")\nIf TimeValue(Now) &lt;= tm Then\n    test = \"Good morning!\"\nElse\n    test = \"Good Afternoon!\"\nEnd If\n</code></pre>\n\n<p>It's never a good idea to work with a variable that has the same name as a reserved word.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2661, "favorite_count": 1, "accepted_answer_id": 35449162, "answer_count": 1, "score": 2, "last_activity_date": 1576161567, "creation_date": 1455688894, "last_edit_date": 1576161567, "question_id": 35449036, "link": "https://stackoverflow.com/questions/35449036/comparing-input-time-and-current-time", "title": "Comparing input time and current time", "body": "<p>How do I check if the input time is less than or equal to the current time in Excel VBA?</p>\n\n<p>Below is my code snippet:</p>\n\n<pre><code>time = \"11:59:59 AM\"\nIf Format(TimeValue(Now)) &lt;= time Then\n    test = \"Good morning!\"\nElse\n    test = \"Good Afternoon!\"\nEnd If\n</code></pre>\n\n<p>This always returns \"Good Afternoon!\"</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1455717010, "post_id": 35448905, "comment_id": 58613283, "body": "Do you have <code>DoCmd.Echo True</code> somewhere later in the code?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4017361, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a6ba9ac70ed13b8f118e1790a58b3224?s=128&d=identicon&r=PG&f=1", "display_name": "P H", "link": "https://stackoverflow.com/users/4017361/p-h"}, "edited": false, "score": 0, "creation_date": 1462152427, "post_id": 35454445, "comment_id": 61503295, "body": "Thanks, everything works fine,  the only problem is that after the DB check I have a command of <code>DoCmd.OpenForm &quot;MyMainForm&quot;</code> which is ignored, (if the file is opened by double-clicking) only if I close the DB from the Access&#39;s main menu and then re-open it from the &#39;recent files list&#39; then it will work properly why is that???"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 35, "user_id": 4017361, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a6ba9ac70ed13b8f118e1790a58b3224?s=128&d=identicon&r=PG&f=1", "display_name": "P H", "link": "https://stackoverflow.com/users/4017361/p-h"}, "edited": false, "score": 0, "creation_date": 1462168317, "post_id": 35454445, "comment_id": 61506792, "body": "@EH: Please ask a new question for that. --- If this question is answered, please <a href=\"http://stackoverflow.com/help/someone-answers\">accept</a> the answer, so the question is marked solved."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1455705969, "last_edit_date": 1525816189, "creation_date": 1455705969, "answer_id": 35454445, "question_id": 35448905, "link": "https://stackoverflow.com/questions/35448905/ms-access-database-vba-back-end-check-makes-project-stop/35454445#35454445", "title": "MS Access Database VBA back-end check makes project stop", "body": "<p>I don't see anything obviously wrong, also not sure what \"it makes the whole application stop\" means - an endless loop?</p>\n\n<p>You should remove the <code>DoCmd.SetWarnings False / True</code> statements, they are not needed. </p>\n\n<p>And it is a good habit when using <code>On Error Resume Next</code> to check for error immediately after the possible error line. And: always reset it as soon as possible, don't run multiple code lines without error handling. </p>\n\n<p>So your code should be:</p>\n\n<pre><code>For Each tdf In db.TableDefs\n     If Len(tdf.Connect) &gt; 0 Then\n        ''Linked table - test link is current\n            DoCmd.Echo False, \"Checking link for table \" &amp; tdf.Name\n            On Error Resume Next 'Do not stop script on error\n            Set rsCheckLink = db.OpenRecordset(tdf.Name) ' OPEN TABLE\n            If Err.Number &lt;&gt; 0 Then ' COULD NOT OPEN TABLE\n                On Error Goto 0\n                Relink_Tables = True\n                'GoTo Relink_Tables ' RECONNECT TO APPROPIATE DATABASE\n            Else\n                On Error Goto 0\n                rsCheckLink.Close ' CLOSE TABLE THAT DID OPEN\n                Set rsCheckLink = Nothing\n            End If\n    End If\nNext\n</code></pre>\n\n<p>If the problem is still there, use: <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a></p>\n"}], "owner": {"reputation": 35, "user_id": 4017361, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a6ba9ac70ed13b8f118e1790a58b3224?s=128&d=identicon&r=PG&f=1", "display_name": "P H", "link": "https://stackoverflow.com/users/4017361/p-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 35454445, "answer_count": 1, "score": 0, "last_activity_date": 1455706002, "creation_date": 1455688313, "last_edit_date": 1455706002, "question_id": 35448905, "link": "https://stackoverflow.com/questions/35448905/ms-access-database-vba-back-end-check-makes-project-stop", "title": "MS Access Database VBA back-end check makes project stop", "body": "<p>I'm trying to lookup if back-end DB is located correctly\nafter I run My code, if it returned with an error, everything is fine, but when it comes back without an error hence it makes the whole application stop.\nfollowing is my VBA code:</p>\n\n<pre><code>Function CheckLinkedDb()\ncDBPath = Application.CurrentProject.Path\nSet db = CurrentDb\nDim Relink_Tables\nDim rsCheckLink As Recordset\nRelink_Tables = False\nFor Each tdf In db.TableDefs\n      If Len(tdf.Connect) &gt; 0 Then\n        ''Linked table - test link is current\n            DoCmd.SetWarnings False\n            On Error Resume Next 'Do not stop script on error\n            Set rsCheckLink = db.OpenRecordset(tdf.Name) ' OPEN TABLE\n            DoCmd.Echo False, \"Checking link for table \" &amp; tdf.Name\n            DoCmd.SetWarnings True\n            If Err Then ' COULD NOT OPEN TABLE\n                Relink_Tables = True\n                'GoTo Relink_Tables ' RECONNECT TO APPROPIATE DATABASE\n            Else\n                rsCheckLink.Close ' CLOSE TABLE THAT DID OPEN\n                Set rsCheckLink = Nothing\n        End If\n    End If\nNext\n\nIf Relink_Tables = True Then\n    goto RelinkT....\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1455692278, "post_id": 35449398, "comment_id": 58596835, "body": "This is pasting just one row? The code had to modified since data is being copied from WB2.sheet1 to WB1.CR Details."}, {"owner": {"reputation": 633, "user_id": 5560651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d6e7d6b999194513ce84305296a655?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5560651/jonathan"}, "reply_to_user": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1455717185, "post_id": 35449398, "comment_id": 58613420, "body": "You&#39;re right there was an issue with it. I&#39;ve corrected it."}], "tags": [], "owner": {"reputation": 633, "user_id": 5560651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d6e7d6b999194513ce84305296a655?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5560651/jonathan"}, "is_accepted": false, "score": 3, "last_activity_date": 1455717142, "last_edit_date": 1495541960, "creation_date": 1455690480, "answer_id": 35449398, "question_id": 35448682, "link": "https://stackoverflow.com/questions/35448682/copy-range-until-lastrow-and-paste-in-another-worksheet/35449398#35449398", "title": "Copy Range until lastRow and paste in another worksheet", "body": "<p>The file size is a results of using the entire columns. This <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">link</a> covers some ways to find then end of a range of data. In your sub you can do this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim WB1 As Workbook\nDim WB2 As Workbook\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(WB1.Path &amp; \"\\RawData.xlsm\")\n\n'Find the last row with data\nWith WB1.Sheets(\"CR Details\")\n    LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\nWB1.Sheets(\"CR Details\").Range(\"A1:AW\" &amp; LastRow).Copy\nWB2.Sheets(\"sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n\nWB2.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 5494666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3a2feba01e4fa63a7403bdaf4d88e0?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas Johansson", "link": "https://stackoverflow.com/users/5494666/niklas-johansson"}, "is_accepted": true, "score": 0, "last_activity_date": 1455701198, "last_edit_date": 1495540124, "creation_date": 1455701198, "answer_id": 35452598, "question_id": 35448682, "link": "https://stackoverflow.com/questions/35448682/copy-range-until-lastrow-and-paste-in-another-worksheet/35452598#35452598", "title": "Copy Range until lastRow and paste in another worksheet", "body": "<p>The short answer to your question is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim WB1 As Workbook\nDim WB2 As Workbook\nDim LastRow As Long\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(WB1.Path &amp; \"\\RawData.xlsm\")\n\nWith WB1.Sheets(\"CR Details\")\n    'Find the last cell's row with data in any column\n    '(You can also use \".Cells(Rows.Count, 1).End(xlUp).row\")\n    LastRow = .Range(\"A:AW\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).row\n    'Copy the values\n    WB2.Sheets(\"sheet1\").Range(\"A1\", \"AW\" &amp; LastRow) = .Range(\"A1\", \"AW\" &amp; LastRow).Value\nEnd With\n\nWB2.Close\nEnd Sub\n</code></pre>\n\n<p><strong>A more detailed explanation:</strong></p>\n\n<p>A very common code snippet to find the last used row is to use:</p>\n\n<p>(will use column A to look for last used row)    </p>\n\n<pre><code>Dim LastRow as Long\n\nWith ThisWorkbook.Sheets(\"CR Details\")\n    LastRow = .Cells(Rows.Count, 1).End(xlUp).row \nEnd With\n</code></pre>\n\n<p>Change \"1\" to the column number you want to look in.</p>\n\n<p>To find the row of the last used cell in any column in the <code>range(\"A:AW\")</code>, then you would need something like this:</p>\n\n<pre><code>Dim LastRow as Long\n\nWith ThisWorkbook.Sheets(\"CR Details\").Range(\"A:AW\")\n    LastRow = .Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).row\nEnd With\n</code></pre>\n\n<p>That's it. <a href=\"http://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">Ron de Buin</a> has a great page explaining this. The answers can also be found on <a href=\"https://stackoverflow.com/questions/71180/how-can-i-find-last-row-that-contains-data-in-the-excel-sheet-with-a-macro\">Stack Overflow</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40805, "favorite_count": 1, "accepted_answer_id": 35452598, "answer_count": 2, "score": 0, "last_activity_date": 1455717142, "creation_date": 1455687224, "question_id": 35448682, "link": "https://stackoverflow.com/questions/35448682/copy-range-until-lastrow-and-paste-in-another-worksheet", "title": "Copy Range until lastRow and paste in another worksheet", "body": "<p><strong>I'm presently using the below code to copy paste the range, but it creates a really large file once the data is pasted, how can I modify this to copy paste only till the last active row? Or is the file getting big because of some other factor?\nNew to VB, any help would be much appreciated.</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim WB1 As Workbook\nDim WB2 As Workbook\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(WB1.Path &amp; \"\\RawData.xlsm\")\n\nWB1.Sheets(\"CR Details\").Columns(\"A:AW\").Value = WB2.Sheets(\"sheet1\").Columns(\"A:AW\").Value\n\nWB2.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3095, "user_id": 28828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77e04a75ca5020461c4670e190d8922?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/28828/oliver"}, "edited": false, "score": 0, "creation_date": 1455703504, "post_id": 35453202, "comment_id": 58603601, "body": "Or better, just search for &quot;With Events&quot; in that document. This will lead to directly to the code sample. Note that you will still need a few lines per &quot;Year&quot;-Control to hook it up with the common event handler class. IF all these controls are in Subforms you can maybe get away with putting the setup code in the Main form."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1455702787, "creation_date": 1455702787, "answer_id": 35453202, "question_id": 35448624, "link": "https://stackoverflow.com/questions/35448624/ms-access-2013-event-trigger-in-module-not-class-module/35453202#35453202", "title": "MS Access 2013 event trigger in module, not class module", "body": "<p>You are looking for <code>WithEvents</code>. Documentation is poor, but a nice intro is here. Browse to the header <em>A Little History</em>:</p>\n\n<p><a href=\"http://jwcolby.blogspot.dk/\" rel=\"nofollow\">A Little History</a></p>\n"}], "owner": {"reputation": 5422, "user_id": 3123109, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/95c33442a31305c50683b2db05d49106?s=128&d=identicon&r=PG&f=1", "display_name": "cjones", "link": "https://stackoverflow.com/users/3123109/cjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35453202, "answer_count": 1, "score": 1, "last_activity_date": 1455702787, "creation_date": 1455686884, "question_id": 35448624, "link": "https://stackoverflow.com/questions/35448624/ms-access-2013-event-trigger-in-module-not-class-module", "title": "MS Access 2013 event trigger in module, not class module", "body": "<p>I have a number of forms that have the same controls, Year for example, that are used for different reports. There are dozens of forms with the control named Year with GotFocus / OnFocus event triggers. I am trying to avoid writing a bunch of class modules with pretty much the same code which would require something like:</p>\n\n<pre><code>Private Sub Year_OnFocus()\n</code></pre>\n\n<p>I would like to write a function in a module so I can refer to Year relative to the form it is one with:</p>\n\n<pre><code>Forms!Home!NavigationSubForm.Form.Year.OnGotFocus\n</code></pre>\n\n<p>This does not seem to work, let alone behave the same way as the <code>Private Sub Year_GotFocus</code>. So was wondering if anyone has any constructive suggestions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1455695243, "post_id": 35448249, "comment_id": 58598268, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5938412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nuXLq3mZAOg/AAAAAAAAAAI/AAAAAAAAAAA/a61KylBY1g8/photo.jpg?sz=128", "display_name": "AUGUSTO IO", "link": "https://stackoverflow.com/users/5938412/augusto-io"}, "edited": false, "score": 0, "creation_date": 1455697029, "post_id": 35448579, "comment_id": 58599184, "body": "sorry i use no 201 and drag it and fill right down the ask is  202 Orange apple apple ok4 no thing no thing no thing"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 1, "user_id": 5938412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nuXLq3mZAOg/AAAAAAAAAAI/AAAAAAAAAAA/a61KylBY1g8/photo.jpg?sz=128", "display_name": "AUGUSTO IO", "link": "https://stackoverflow.com/users/5938412/augusto-io"}, "edited": false, "score": 0, "creation_date": 1455700022, "post_id": 35448579, "comment_id": 58601028, "body": "Do you press <code>Ctrl+Shift+Enter</code> after entering formula?"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1455686701, "creation_date": 1455686701, "answer_id": 35448579, "question_id": 35448249, "link": "https://stackoverflow.com/questions/35448249/vlookup-two-difference-data-corresponding-to-two-non-adjacent-fields/35448579#35448579", "title": "vlookup two difference data corresponding to two non-adjacent fields", "body": "<p>Use this array formula. This formula will filter all data what you will put in <code>I1</code> cell.</p>\n\n<pre><code>=IFERROR(INDEX($A$1:$E$25,SMALL(IF($A$1:$A$25=$I$1,ROW($A$1:$A$25)),ROWS($A$1:$A1)),COLUMNS($A$1:A$1)),\"\")\n</code></pre>\n\n<p>As it is a array formula, Press <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd> to evaluate the formula.</p>\n\n<p>Sample Screenshot:\n<a href=\"https://i.stack.imgur.com/3HPJq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3HPJq.png\" alt=\"Sample Screenshot\"></a></p>\n\n<p>After putting formula in <code>G4</code> cell (As my screenshot) drag and fill right and down as you need.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1455697941, "last_edit_date": 1495535427, "creation_date": 1455697941, "answer_id": 35451485, "question_id": 35448249, "link": "https://stackoverflow.com/questions/35448249/vlookup-two-difference-data-corresponding-to-two-non-adjacent-fields/35451485#35451485", "title": "vlookup two difference data corresponding to two non-adjacent fields", "body": "<p>Array formulas\u00b2 and the cyclic processing produced by functions like the <a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43B9278E-6AA7-4F17-92B6-E19993FA26DF\" rel=\"nofollow noreferrer\">AGGREGATE\u00b9 function</a> produce calculation lag. The ranges they reference should be kept to a minimum number of rows. It is time consuming to maintain a minimum number of relevant rows on data that receives frequent additions and deletions.</p>\n\n<p>The following formula looks much more complicated but it dynamically tracks the exact number of rows in the <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a>'s <em>array</em>. To simplify the formula, I've allowed one extra row; that being row 1 containing the column header labels.</p>\n\n<p>In I10 as a standard formula,</p>\n\n<pre><code>=INDEX(B:B, AGGREGATE(15, 6, ROW($A$1:INDEX($A:$A, MATCH(1E+99,$A:$A )))/($A$1:INDEX($A:$A, MATCH(1E+99,$A:$A ))=$H10), ROW(1:1)))\n</code></pre>\n\n<p>Fill right and down.</p>\n\n<p>For your string concatenation. I plucked this VBA User Defined Function\u00b3 (aka UDF) from <a href=\"https://stackoverflow.com/questions/32110321/concatenate-cell-data-into-another-data-if-values-matches/32110527#32110527\">one of my previous answers</a> to a similar problem.</p>\n\n<pre><code>Public Function conditional_concat_strs(rSTRs As Range, rCRITs As Range, rCRIT As Range, Optional sDELIM As String = \", \")\n    Dim c As Long, sTMP As String\n\n    Set rSTRs = Intersect(rSTRs, rSTRs.Parent.UsedRange)\n    Set rCRITs = Intersect(rCRITs, rCRITs.Parent.UsedRange)\n\n    Set rSTRs = rSTRs.Cells(1, 1).Resize(rCRITs.Rows.Count, rCRITs.Columns.Count)\n    For c = 1 To rCRITs.Cells.Count\n        If rCRITs(c).Value2 = rCRIT Then _\n            sTMP = sTMP &amp; rSTRs(c).Value &amp; sDELIM\n    Next c\n    conditional_concat_strs = Left(sTMP, Application.Max(Len(sTMP) - Len(sDELIM), 0))\nEnd Function\n</code></pre>\n\n<p>In I2 as,</p>\n\n<pre><code>=conditional_concat_strs(E:E,A:A, I1)\n</code></pre>\n\n<p>The full column references are truncated at the extents of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow noreferrer\">Worksheet.UsedRange property</a>. There is no calculation penalty for using them.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/QmpJI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QmpJI.png\" alt=\"conditonal_concat\"></a></p>\n\n<hr>\n\n<p>\u00b9 <sub>Array formulas need to be finalized with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter\u21b5</kbd>. Once entered into the first cell correctly, they can be filled or copied down or right just like any other formula. Try and reduce your full-column references to ranges more closely representing the extents of your actual data. Array formulas chew up calculation cycles logarithmically so it is good practise to narrow the referenced ranges to a minimum. See <a href=\"https://support.office.com/en-ca/article/guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">Guidelines and examples of array formulas</a> for more information.</sub></p>\n\n<p>\u00b2 <sub>The <a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43B9278E-6AA7-4F17-92B6-E19993FA26DF\" rel=\"nofollow noreferrer\">AGGREGATE function</a> was introduced with Excel 2010. It is not available in earlier versions.</sub></p>\n\n<p>\u00b3 <sub>A User Defined Function (aka UDF) is placed into a standard module code sheet. Tap <kbd>Alt</kbd>+<kbd>F11</kbd> and when the VBE opens, immediately use the pull-down menus to <strong>Insert \u25ba Module</strong> (<kbd>Alt</kbd>+<kbd>I</kbd>,<kbd>M</kbd>). Paste the function code into the new module code sheet titled something like <em>Book1 - Module1 (Code)</em>. Tap <kbd>Alt</kbd>+<kbd>Q</kbd> to return to your worksheet(s).</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 5938412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nuXLq3mZAOg/AAAAAAAAAAI/AAAAAAAAAAA/a61KylBY1g8/photo.jpg?sz=128", "display_name": "AUGUSTO IO", "link": "https://stackoverflow.com/users/5938412/augusto-io"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455697941, "creation_date": 1455685050, "last_edit_date": 1455689787, "question_id": 35448249, "link": "https://stackoverflow.com/questions/35448249/vlookup-two-difference-data-corresponding-to-two-non-adjacent-fields", "title": "vlookup two difference data corresponding to two non-adjacent fields", "body": "<p>I want to do a VLOOKUP in the \"No\"\nget the value no\"201\" where the \"no\" and \"box\" from the Purchases sheet match</p>\n\n<p>Screenshot\n<a href=\"https://i.stack.imgur.com/TjMxh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TjMxh.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>=IFERROR(INDEX($B2:$B100,MATCH(1,($A2:$A100=$H1)*($E2:$E100=I$1),0),3),\"NONO\")\n</code></pre>\n\n<p>can have another option better than VLOOKUP, that's fine too. Thanks!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455679071, "post_id": 35446998, "comment_id": 58592168, "body": "So what&#39;s the problem with your code?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5820793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b92fc800af9c1e1ae9134fc0d78418cb?s=128&d=identicon&r=PG&f=1", "display_name": "DRod", "link": "https://stackoverflow.com/users/5820793/drod"}, "edited": false, "score": 0, "creation_date": 1455841244, "post_id": 35450531, "comment_id": 58682658, "body": "Could you clarify what you mean in relation to the wsGet range, and your suggest re activating or not activating a sheet?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21, "user_id": 5820793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b92fc800af9c1e1ae9134fc0d78418cb?s=128&d=identicon&r=PG&f=1", "display_name": "DRod", "link": "https://stackoverflow.com/users/5820793/drod"}, "edited": false, "score": 0, "creation_date": 1455890634, "post_id": 35450531, "comment_id": 58705116, "body": "&#39;wsGet.Range(&quot;N:R&quot;)&#39; returns all the cells belonging to columns from &quot;N&quot; to &quot;R&quot;.   &#39;wsGet.Range.Resize(1)&#39; would return range &quot;N1:R1&quot;.     you can simply use &#39;wsGet.Range(&quot;D17:D21&quot;).PasteSpecial...&#39; with no need to activate the destination sheet"}, {"owner": {"reputation": 21, "user_id": 5820793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b92fc800af9c1e1ae9134fc0d78418cb?s=128&d=identicon&r=PG&f=1", "display_name": "DRod", "link": "https://stackoverflow.com/users/5820793/drod"}, "edited": false, "score": 0, "creation_date": 1456134469, "post_id": 35450531, "comment_id": 58789006, "body": "On the &quot;.Range&quot; this comes up with an error - &quot;Argument not optional&quot;, is there a way around that?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21, "user_id": 5820793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b92fc800af9c1e1ae9134fc0d78418cb?s=128&d=identicon&r=PG&f=1", "display_name": "DRod", "link": "https://stackoverflow.com/users/5820793/drod"}, "edited": false, "score": 0, "creation_date": 1456136482, "post_id": 35450531, "comment_id": 58790308, "body": "please update your code and mark out where it throws the &quot;Argument not optional&quot; error"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1455694711, "creation_date": 1455694711, "answer_id": 35450531, "question_id": 35446998, "link": "https://stackoverflow.com/questions/35446998/vba-copy-data-across-worksheets/35450531#35450531", "title": "VBA - Copy data across worksheets", "body": "<p>there are some mistakes</p>\n\n<ul>\n<li><p><code>wsGet.Range(\"N[ ]:R[ ]\")</code> is not a valid syntax.</p>\n\n<p>while <code>wsGet.Range(\"N:R\")</code>is.</p>\n\n<p>still, that way you get the entire columns, and not just the row you need of them.</p>\n\n<p>you could use \"Instersect()\" method or the \"Resize()\" method on that range to get the range you need</p></li>\n<li><p>with <code>wsGet.Range(\"N[ ]:R[ ]\").Copy</code> you're using \".Copy\" method on a \"wsGet\" sheet range.</p>\n\n<p>use it on the same range (corrected as per the preceeding suggestion) of the \"ws\" sheet instead</p></li>\n<li><p>with <code>LCell.Activate</code>, you're activating a \"cell\" instead of a \"sheet\".</p>\n\n<p>you should use <code>wb.Sheets(LCell.Text).Activate</code> instead</p>\n\n<p>but you don't need any sheet activation since you have already set \"wsGet\" as the \"destination\" sheet, so simply use \".PasteSpecial\" method on it</p></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 5820793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b92fc800af9c1e1ae9134fc0d78418cb?s=128&d=identicon&r=PG&f=1", "display_name": "DRod", "link": "https://stackoverflow.com/users/5820793/drod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455694711, "creation_date": 1455677566, "last_edit_date": 1455682575, "question_id": 35446998, "link": "https://stackoverflow.com/questions/35446998/vba-copy-data-across-worksheets", "title": "VBA - Copy data across worksheets", "body": "<p>I'm looking to copy data across multiple worksheets. The names of the worksheets are in column L, I want to pick up the data from columns N:R, for that particular line, and then copy that into cells D17:D21 in the corresponding sheet. </p>\n\n<p>Any assistance would be great. </p>\n\n<p>Cheers\nDRod</p>\n\n<pre><code>Sub Macro2()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim wsGet As Worksheet\n    Dim LCell As Range\n    Dim sDataCol As String\n    Dim lHeaderRow As Long\n\n    sDataCol = \"L\"  'Change to be the column you want to match sheet names agains\n    lHeaderRow = 5  'Change to be what your actual header row is\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"Sheet1\")    'Change this to be your Summary sheet\n\n    'Check for values in sDataCol\n    With ws.Range(sDataCol &amp; lHeaderRow + 1, ws.Cells(ws.Rows.Count, sDataCol).End(xlUp))\n        If .Row &lt;= lHeaderRow Then Exit Sub 'No data\n\n        'Loop through sDataCol values\n        For Each LCell In .Cells\n        If LCell.Text &lt;&gt; \"\" Then\n            'Check if sheet named that value exists\n            If Evaluate(\"ISREF('\" &amp; LCell.Text &amp; \"'!A1)\") Then\n                'Found a matching sheet, copy data from columns N:R to cells D17:D21 in the corresponding sheet\n                Set wsGet = wb.Sheets(LCell.Text)\n                wsGet.Range(\"N[ ]:R[ ]\").Copy\n                LCell.Activate\n                Range(\"D17:D21\").PasteSpecial Paste:=xlPasteValues, Transpose:=True\n            End If\n        End If\n        Next LCell\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455671115, "post_id": 35446022, "comment_id": 58589968, "body": "The Range object has a <code>Find()</code> method which you can use to match a value."}, {"owner": {"reputation": 9, "user_id": 5937870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12a989794dd068c064f3859e2c6a5bc?s=128&d=identicon&r=PG&f=1", "display_name": "endanai299", "link": "https://stackoverflow.com/users/5937870/endanai299"}, "edited": false, "score": 0, "creation_date": 1455672158, "post_id": 35446022, "comment_id": 58590270, "body": "For Each cell In Range(&quot;A9:A210&quot;) If cell.Value = Range(&quot;b10&quot;).Value Then cell.Select End If  Next End Sub"}, {"owner": {"reputation": 9, "user_id": 5937870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12a989794dd068c064f3859e2c6a5bc?s=128&d=identicon&r=PG&f=1", "display_name": "endanai299", "link": "https://stackoverflow.com/users/5937870/endanai299"}, "edited": false, "score": 0, "creation_date": 1455672546, "post_id": 35446022, "comment_id": 58590367, "body": "Im making a barcode scanner check in/check out sheet for tools at work. I have it made. but a co worker came up with an idea to make checkin easier. which is essentially when A9 equals checkin and b9 equals a value in range A10:A200 on. to select that cell. for sake of argument it will be A10 then i will active cell offset and autofill the time and technician who signed it in. im new to vba and literally started yesterday. i have been googling like a mad man but i figured it might be easier to post the question for this."}, {"owner": {"reputation": 102, "user_id": 5821186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z0a2g.jpg?s=128&g=1", "display_name": "Sayyed Abbas Rizvi", "link": "https://stackoverflow.com/users/5821186/sayyed-abbas-rizvi"}, "edited": false, "score": 0, "creation_date": 1455683936, "post_id": 35446022, "comment_id": 58593579, "body": "probably a duplicate question of <a href=\"http://stackoverflow.com/a/35225453/5821186\">this</a>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1455687044, "post_id": 35446022, "comment_id": 58594634, "body": "You can edit your original question and add the new information from your comments into the question"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1455687099, "post_id": 35446022, "comment_id": 58594660, "body": "Do you want it to be the activecell or do you want to do something with the cell?"}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 1801242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b7da0ef49d8a9660f57771a0f84e15?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/1801242/justin"}, "is_accepted": false, "score": 0, "last_activity_date": 1455672761, "creation_date": 1455672761, "answer_id": 35446347, "question_id": 35446022, "link": "https://stackoverflow.com/questions/35446022/how-to-select-a-cell-that-matches-another-cell-value-vba/35446347#35446347", "title": "how to select a cell that matches another cell value vba", "body": "<p>Might it be easier to use a formula like match to do it?  If you want to call it from VBA you could use worksheetfunction.match.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5937870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12a989794dd068c064f3859e2c6a5bc?s=128&d=identicon&r=PG&f=1", "display_name": "endanai299", "link": "https://stackoverflow.com/users/5937870/endanai299"}, "edited": false, "score": 0, "creation_date": 1455675681, "post_id": 35446477, "comment_id": 58591231, "body": "thanks Tim i will give your suggestion a shot tomorrow when i head in for work. currently my spreadsheet is at work and was merely trying to get a game plan for tomorrow. sorry i wasn&#39;t very detailed with my initial question. if it doesn&#39;t work i will bring it home and be much more specific and detailed with my question so that the community can assist. thanks again!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1455673679, "creation_date": 1455673679, "answer_id": 35446477, "question_id": 35446022, "link": "https://stackoverflow.com/questions/35446022/how-to-select-a-cell-that-matches-another-cell-value-vba/35446477#35446477", "title": "how to select a cell that matches another cell value vba", "body": "<p>Put this code in the sheet code module for the worksheet holding your data:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, f As Range, v\n    Set rng = Application.Intersect(Target, Me.Range(\"B9\"))\n\n    If Not rng Is Nothing Then\n\n        v = Trim(rng.Value)\n\n        If Len(v) &gt; 0 Then\n            Set f = Me.Range(\"A10:A500\").Find(what:=rng.Value, _\n                                              lookat:=xlWhole)\n\n            If Not f Is Nothing Then\n                If Me.Range(\"A9\").Value = \"checkin\" Then\n                    f.Offset(0, 1).Value = Now\n                    f.Offset(0, 2).Value = \"userName\" 'from where?\n                    f.Offset(0, 3).Value = \"Checked In\" \n                End If\n            Else\n                MsgBox \"Scanned value '\" &amp; rng.Value &amp; \"' not found !\", _\n                        vbExclamation\n            End If 'found a match\n\n        End If 'cell has a value\n\n    End If 'checking this value\n\nEnd Sub\n</code></pre>\n\n<p>Adjust ranges to suit...</p>\n"}], "owner": {"reputation": 9, "user_id": 5937870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12a989794dd068c064f3859e2c6a5bc?s=128&d=identicon&r=PG&f=1", "display_name": "endanai299", "link": "https://stackoverflow.com/users/5937870/endanai299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "closed_date": 1487598547, "answer_count": 2, "score": -2, "last_activity_date": 1455673679, "creation_date": 1455670800, "question_id": 35446022, "link": "https://stackoverflow.com/questions/35446022/how-to-select-a-cell-that-matches-another-cell-value-vba", "closed_reason": "Needs details or clarity", "title": "how to select a cell that matches another cell value vba", "body": "<p>Does anyone know how i might select any cell in a range that matches another?\nfor Example:</p>\n\n<p>comparing range (\"A9:A200\") to range(\"B9\")</p>\n\n<p>if say range (\"A10\") is \"bellingham\" and range (\"B9\") is also bellingham </p>\n\n<p>I want A10 to be the active cell. </p>\n\n<p>any help would be most apreciated. thank you.</p>\n"}, {"tags": ["excel", "powerpoint", "vba"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1455724114, "creation_date": 1455724114, "answer_id": 35461409, "question_id": 35445727, "link": "https://stackoverflow.com/questions/35445727/change-powerpoint-link-to-different-folder/35461409#35461409", "title": "Change Powerpoint Link to Different Folder", "body": "<p>Have a look at the code here:</p>\n\n<p>Batch Search and Replace for Hyperlinks, OLE links, movie links and sound links\n<a href=\"http://www.pptfaq.com/FAQ00773_Batch_Search_and_Replace_for_Hyperlinks-_OLE_links-_movie_links_and_sound_links.htm\" rel=\"nofollow\">http://www.pptfaq.com/FAQ00773_Batch_Search_and_Replace_for_Hyperlinks-_OLE_links-_movie_links_and_sound_links.htm</a></p>\n\n<p>It'll let you, for example, replace the path to the linked file (ie, different folder name) but not change the name of the linked file.  </p>\n\n<p>Important:  You must have the file to be relinked in the folder you're trying to relink TO before running the code.  If you change a link to point to a file that's not there, PPT will just smile at you and say \"OK\" but it won't change anything.</p>\n"}], "owner": {"reputation": 532, "user_id": 4213255, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5276100c38b060a21437e9aa472406b6?s=128&d=identicon&r=PG&f=1", "display_name": "jbest", "link": "https://stackoverflow.com/users/4213255/jbest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2824, "favorite_count": 1, "accepted_answer_id": 35461409, "answer_count": 1, "score": 1, "last_activity_date": 1455973896, "creation_date": 1455669095, "last_edit_date": 1531164843, "question_id": 35445727, "link": "https://stackoverflow.com/questions/35445727/change-powerpoint-link-to-different-folder", "title": "Change Powerpoint Link to Different Folder", "body": "<p>I want to transfer the link in the graphs of a PowerPoint presentation to another folder. Found some code but it only selects specific file to change link to, not folders, which I can't use because my PowerPoint is link to two different Excel files (in the same folder).</p>\n\n<pre><code>Sub M1()\nDim sld As Slide\nDim sh As Shape\nDim strNms As String\nDim intI As Integer\nDim strNewPath\nDim ExcelFile\nDim exl As Object\nSet exl = CreateObject(\"Excel.Application\")\n\n'Open a dialog box to promt for the new source file.\nExcelFile = exl.Application.GetOpenFilename(, , \"Select Excel File\")\nFor Each sld In ActivePresentation.aSlides\n    For Each sh In sld.Shapes\n        If sh.Type = msoLinkedOLEObject Then\n            With sh.LinkFormat\n                strNms = .SourceFullName\n                intI = InStr(1, strNms, \"!\")\n                strNewPath = ExcelFile &amp; Mid(strNms, intI, Len(strNms) - intI + 1)\n                .SourceFullName = strNewPath\n            End With\n        End If\n    Next sh\nNext sld\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1455667909, "post_id": 35445399, "comment_id": 58589002, "body": "If you can do it with formulas then I am wondering why you posted the question. If not, then you&#39;ll probably have to look into VBA: it seems to me that you will have to capture the <code>Change</code> event on that sheet in case &quot;someone is overwriting&quot; your formulas with data. For more information on that topic you might want to look at the following answer: <a href=\"http://stackoverflow.com/questions/30513655/using-vba-how-do-i-detect-when-any-value-in-a-worksheet-changes\" title=\"using vba how do i detect when any value in a worksheet changes\">stackoverflow.com/questions/30513655/&hellip;</a> Let us know once you are running into a specific coding error so we can offer more specific help."}, {"owner": {"reputation": 1, "user_id": 5937702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac6216af28f8144f6270e4610a925b0c?s=128&d=identicon&r=PG&f=1", "display_name": "veneratio", "link": "https://stackoverflow.com/users/5937702/veneratio"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455723771, "post_id": 35445399, "comment_id": 58618604, "body": "With the number of variables and conditions, would it not be better to use a VBA script? I&#39;m not very knowledgeable in this field and because there is a new sheet updated quarterly based on the results of the previous quarter&#39;s sheet, I didn&#39;t want to have formulas but rather actual results. That way they each stay independant of each other rather than having formula results based on a multitude of previous formula results."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1455724170, "post_id": 35445399, "comment_id": 58618950, "body": "A good starting point to get acquainted with VBA might be the following site: <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">homeandlearn.org</a>. Together with the above referenced solution you should have all that you need to come up with a VBA solution. Let us know if you run into a specific VBA error while writing the solution (in which case you should also post all of the VBA code you have written thus far)."}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1533067215, "post_id": 35445399, "comment_id": 90207777, "body": "&quot;I hoping some geniuses here can help.&quot; &lt;-- a very nice credit indeed.. ( :"}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1533068396, "post_id": 35445399, "comment_id": 90208343, "body": "Dear OP, if you really get stuck with vba.. I&#39;ll recommend to use a &#39;hidden&#39; column/sheet with formula instead."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 1801242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b7da0ef49d8a9660f57771a0f84e15?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/1801242/justin"}, "is_accepted": false, "score": 1, "last_activity_date": 1455673294, "creation_date": 1455673294, "answer_id": 35446418, "question_id": 35445399, "link": "https://stackoverflow.com/questions/35445399/adding-1-to-existing-number-in-a-cell-based-on-value-of-another-cell/35446418#35446418", "title": "Adding 1 to existing number in a cell based on value of another cell", "body": "<p>After you have a Change event you could have some logic to check:\n- if <strong>user is adding a new value</strong> in the correct column, you would load the previous data into a variant to perform the logic that you have given to populate the addition cells\n- if not, let the user update the values.</p>\n"}], "owner": {"reputation": 1, "user_id": 5937702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac6216af28f8144f6270e4610a925b0c?s=128&d=identicon&r=PG&f=1", "display_name": "veneratio", "link": "https://stackoverflow.com/users/5937702/veneratio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455723832, "creation_date": 1455667274, "last_edit_date": 1531164843, "question_id": 35445399, "link": "https://stackoverflow.com/questions/35445399/adding-1-to-existing-number-in-a-cell-based-on-value-of-another-cell", "title": "Adding 1 to existing number in a cell based on value of another cell", "body": "<p>Alright so I looked through for other solutions but I didn't get anything close enough with my limited knowledge to make it work so I hoping some geniuses here can help.</p>\n\n<p>Basically I am using excel to autoupdate some data based on the value of another cell. A simplified version of my table looks like the below:</p>\n\n<pre><code>ID            Step       Count\n526985       - Step 1      8\n123569       + Step 3      3\n589745       - Not in AMP  1\n589465       + Step 2      5\n</code></pre>\n\n<ol>\n<li>IDs are unique and always 6 digits (just fyi if that helps anything). There will never be a Step column or count column value without an ID value</li>\n<li>I would like to use the change val in vba so it changes as I go along automatically</li>\n<li>The goal is for the user to not have to update manually the value in the \"Count\" column</li>\n<li>When the user starts working on the sheet, the \"Step\" column will be blank and will be selected from a drop down menu but the \"Count\" and \"ID\" will be populated already</li>\n</ol>\n\n<p>What I need:</p>\n\n<ol>\n<li>When a value of \"+ Step 1\", \"+ Step 2\", \"+ Step 3\", \"+ Step 3 ext\", \"- Step 2\", \"- Step 1\" is selected in the \"Step\" column for an ID, I need \"+1\" added to whatever the current value is in the \"count\" column</li>\n<li>When a value of \"- Not in AMP\" is selected from the \"Step\" column, I need the value to be 0 in the \"Count\" column</li>\n<li>There will be other values selectable from the \"Step\" column which I need to be ignored (Keep the same \"Count\" column value)</li>\n<li>After a step value has been selected in the \"Step\" column and the \"count\" column has been updated. I still need to be able to go back and change that value to any other number manually.</li>\n</ol>\n\n<p>I think that's about it. I thought of using formulas which I could do but the issue is where I need to be able to overwrite the value with another, it will delete the formula. I'm open to anything that makes this work though. Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455665649, "post_id": 35445096, "comment_id": 58588274, "body": "Workbooks(&quot;Book1.xls&quot;).Sheets(1).Columns(1)"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455665697, "post_id": 35445096, "comment_id": 58588292, "body": "@Ralph Sheet1 will work if the sheet is indeed named Sheet1, which it is by default."}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1455665785, "post_id": 35445096, "comment_id": 58588332, "body": "The code you&#39;ve shown in working with outlook and the line you&#39;ve shown giving you the problem is working with Excel. Can you show the complete code?"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455665870, "post_id": 35445096, "comment_id": 58588364, "body": "@Ralph Just tried it and im getting an error that says &quot;Sub or function not defined&quot;"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1455665908, "post_id": 35445096, "comment_id": 58588377, "body": "@ScottMarcus Sorry, my mistake. Deryl: Are you looking for the last row in a particular column? Then this solution should prove helpful: <a href=\"http://stackoverflow.com/questions/18952362/excel-vba-select-range-at-last-row-and-column\" title=\"excel vba select range at last row and column\">stackoverflow.com/questions/18952362/&hellip;</a>"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1455665943, "post_id": 35445096, "comment_id": 58588392, "body": "@deryl That implies that you haven&#39;t referenced the excel library correctly. Can you post all of your code and clarify if you are writing your VBA in Outlook or Excel."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1455666077, "post_id": 35445096, "comment_id": 58588444, "body": "@ScottMarcus just edited the post to provide you with more info. Im running the code in outlook and excel is open. Haven&#39;t done anything with excel except opened it"}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455666145, "post_id": 35445096, "comment_id": 58588459, "body": "@Ralph no sorry. I&#39;m trying to code to automatically email people by getting the email addresses from the first column of a spreadsheet. All the email addresses will be in the first column"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 2, "creation_date": 1455666160, "post_id": 35445096, "comment_id": 58588463, "body": "@deryl In Outlook, you will need to add a reference to the Excel object library, which is done in the VBA editor, under Tools / Add References. Just having Excel open isn&#39;t enough. Also, please post all of your code, soi we can see if you are using the Excel object model correctly."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1455666406, "post_id": 35445096, "comment_id": 58588538, "body": "Error is gone! Thank you. I posted the whole thing and feel free to criticize it."}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1455666536, "post_id": 35445096, "comment_id": 58588577, "body": "@deryl Glad to help. By the way, you may not need this line Set olApp = CreateObject(&quot;Outlook.Application&quot;) since you are already in outlook. Instead try replacing olApp with Application. Also, would you mind marking the answer below as correct and voting it up?"}], "answers": [{"tags": [], "owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "is_accepted": true, "score": 3, "last_activity_date": 1455666565, "creation_date": 1455666565, "answer_id": 35445291, "question_id": 35445096, "link": "https://stackoverflow.com/questions/35445096/how-do-i-get-a-worksheet-object-using-outlook-vba/35445291#35445291", "title": "How do I get a worksheet object using Outlook VBA?", "body": "<p>You will need to add a reference to the Excel object library, which is done in the VBA editor, under Tools / Add References. Just having Excel open isn't enough. </p>\n"}], "owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 35445291, "answer_count": 1, "score": 1, "last_activity_date": 1611561895, "creation_date": 1455665520, "last_edit_date": 1611561895, "question_id": 35445096, "link": "https://stackoverflow.com/questions/35445096/how-do-i-get-a-worksheet-object-using-outlook-vba", "title": "How do I get a worksheet object using Outlook VBA?", "body": "<p>I'm trying to get all the cells from my Excel worksheet in column 1.</p>\n<p>My code throws an error.</p>\n<blockquote>\n<p>&quot;object required&quot;</p>\n</blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub emailList()\n    'Setting up the Excel variables.\n    Dim olApp As Object\n    Dim olMailItm As Object\n    Dim iCounter As Integer\n    Dim Dest As Variant\n    Dim SDest As String\n       \n    'Create the Outlook application and the empty email.\n    Set olApp = CreateObject(&quot;Outlook.Application&quot;)\n    Set olMailItm = olApp.CreateItem(0)\n       \n    'Using the email, add multiple recipients, using a list of addresses in column A.\n    With olMailItm\n        SDest = &quot;&quot;\n        For iCounter = 1 To WorksheetFunction.CountA(Workbooks(&quot;Book1.xls&quot;).Sheets(1).Columns(1))\n            If SDest = &quot;&quot; Then\n                SDest = Range.Cells(iCounter, 1).Value\n            Else\n                SDest = SDest &amp; &quot;;&quot; &amp; Range.Cells(iCounter, 1).Value\n            End If\n        Next iCounter\n           \n        'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.\n        .BCC = SDest\n        .Subject = &quot;FYI&quot;\n        .Body = ActiveSheet.TextBoxes(1).Text\n        .Send\n    End With\n       \n    'Clean up the Outlook application.\n    Set olMailItm = Nothing\n    Set olApp = Nothing\nEnd Sub\n</code></pre>\n<p>How do I get a worksheet object?</p>\n<p>I tried</p>\n<pre><code>Workbooks(&quot;Book1.xls&quot;).Sheet1.Columns(1)\n</code></pre>\n<p>but this also throws an error.</p>\n<p>I'm running the code in Outlook and have an open Excel window.</p>\n"}, {"tags": ["vba", "dictionary", "collections"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1455664995, "creation_date": 1455664995, "answer_id": 35445001, "question_id": 35444816, "link": "https://stackoverflow.com/questions/35444816/vba-can-i-put-a-collection-inside-a-scripting-dictionary/35445001#35445001", "title": "vba can i put a collection inside a scripting.dictionary", "body": "<p>To store a collection in a dictionary you can use a two-step process of first creating the collection and then adding it to the dictionary:</p>\n\n<pre><code>Sub test()\n    Dim C As Collection\n    Dim D As Object\n    Dim v As Variant\n\n    Set D = CreateObject(\"Scripting.Dictionary\")\n\n    Set C = New Collection\n    C.Add \"a\"\n    C.Add \"b\"\n    C.Add \"c\"\n\n    D.Add \"key1\", C\n\n    Set C = New Collection 'Old collection safely stored in D\n    D.Add \"key2\", C 'Now D(\"key2\") holds a collection\n    D(\"key2\").Add \"d\"\n    D(\"key2\").Add \"e\"\n\n    Debug.Print \"Collection for key1:\"\n    For Each v In D(\"key1\")\n        Debug.Print v\n    Next v\n\n    Debug.Print \"Collection for key2:\"\n    For Each v In D(\"key2\")\n        Debug.Print v\n    Next v\n\nEnd Sub\n</code></pre>\n\n<p>The code illustrates how you can add recycle the collection variable <code>C</code> to add multiple collections, and how you can add empty collections to the dictionary to be later modified.</p>\n\n<p>Output:</p>\n\n<pre><code>Collection for key1:\na\nb\nc\nCollection for key2:\nd\ne\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1563054445, "last_edit_date": 1563054445, "creation_date": 1563053793, "answer_id": 57023019, "question_id": 35444816, "link": "https://stackoverflow.com/questions/35444816/vba-can-i-put-a-collection-inside-a-scripting-dictionary/57023019#57023019", "title": "vba can i put a collection inside a scripting.dictionary", "body": "<p>Putting a collection inside a dictionary is an intersting problem in VBA. It is even more interesting, when we do not know the number of the keys and the values in advance. Let's imagine that this is our input in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/n2EY8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n2EY8.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the requested output looks like this in the immediate window <kbd>Ctrl</kbd>+<kbd>G</kbd>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1dTzS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1dTzS.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code, that would deliver it (Run <code>Main</code>):</p>\n\n<pre><code>Public Sub Main()\n\n    Dim teamDictionary As New Dictionary\n    fillTeamDictionary teamDictionary\n\n    Dim myKey As Variant\n    Dim myVals As Variant\n\n    For Each myKey In teamDictionary\n        Debug.Print myKey; \":\"\n        For Each myVals In teamDictionary(myKey)\n            Debug.Print vbTab; myVals\n        Next\n        Debug.Print \"----------------\"\n    Next\n\nEnd Sub\n\nPublic Sub fillTeamDictionary(teamDictionary As Dictionary)\n\n    Dim myCell As Range\n    Dim teamRange As Range\n\n    With tblTeam\n        Set teamRange = .Range(\"A1:A8\") 'range could be flexible...\n    End With\n\n    Dim myKey As String\n    Dim myVal As String\n\n    For Each myCell In teamRange\n        myKey = myCell\n        myVal = myCell.Offset(ColumnOffset:=1)\n\n        If teamDictionary.Exists(myKey) Then\n            teamDictionary(myKey).Add (myVal)\n        Else\n            Dim newList As Collection\n            Set newList = New Collection\n            newList.Add (myVal)\n            teamDictionary.Add myKey, newList\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>The \"trick\" is to initialize a new Collection for each unique key of the dictionary, every time we need it:</p>\n\n<pre><code>Dim newList As Collection\nSet newList = New Collection\nnewList.Add (myVal)\nteamDictionary.Add myKey, newList\n</code></pre>\n\n<p>Then add to the collection, whenever the key exists:</p>\n\n<pre><code>If teamDictionary.Exists(myKey) Then\n    teamDictionary(myKey).Add (myVal)\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 1704282, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/74521b29996d85bfb60333d41efa23ae?s=128&d=identicon&r=PG", "display_name": "pelos", "link": "https://stackoverflow.com/users/1704282/pelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5372, "favorite_count": 1, "accepted_answer_id": 35445001, "answer_count": 2, "score": 2, "last_activity_date": 1563054445, "creation_date": 1455664161, "question_id": 35444816, "link": "https://stackoverflow.com/questions/35444816/vba-can-i-put-a-collection-inside-a-scripting-dictionary", "title": "vba can i put a collection inside a scripting.dictionary", "body": "<p>I am trying to create a collection and put inside</p>\n\n<pre><code>mydict = my_key:[\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>and then iterate over.</p>\n\n<pre><code>    For Each V In mydict.keys\n        Debug.Print V\n        for z in mydict.Item(V)       \n            Debug.Print  z\n        next z\n    Next V\n</code></pre>\n\n<p>the output should look like\nmy_key\na\nb\nc</p>\n\n<p>but i having problems and errors,  is it posible to store a collection inside a  scripting.dictionary?</p>\n\n<p>or is just  storing strings  such  \"my_key\":\"a\",  \"my_key2\":\"b\"?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1455663652, "post_id": 35444600, "comment_id": 58587472, "body": "Welcome back,  Sorry to hear that the formula answer did not scale for you.  If I had known it was 60,000 by 60 I would never have suggested formulas.  But as it is SO is not a code for me site.  Look into putting ranges in to arrays and transposing the array back into another range."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1455667228, "post_id": 35444600, "comment_id": 58588791, "body": "<a href=\"http://stackoverflow.com/a/20543651/2127508\">This answer</a> on how to unpivot data may be helpful"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1455668933, "post_id": 35444600, "comment_id": 58589269, "body": "See <a href=\"http://dailydoseofexcel.com/archives/tag/unpivot/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/tag/unpivot</a> for a selection of VBA approaches."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5919012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a3962a2d38a539a248d3da4aed7dce?s=128&d=identicon&r=PG&f=1", "display_name": "Porkythepig", "link": "https://stackoverflow.com/users/5919012/porkythepig"}, "edited": false, "score": 0, "creation_date": 1455722353, "post_id": 35446685, "comment_id": 58617445, "body": "Thanks again Scott, really grateful for the comments as it helped me understand the code more clearly!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1455675195, "creation_date": 1455675195, "answer_id": 35446685, "question_id": 35444600, "link": "https://stackoverflow.com/questions/35444600/copy-partial-table-and-insert-n-times-then-transpose-second-part-of-table/35446685#35446685", "title": "Copy Partial Table and Insert N-times, then Transpose second part of table", "body": "<p>Because I feel bad about not suggesting vba in the last post and had the OP spending time on something that would not work:</p>\n\n<pre><code>Sub trnspose()\n    Dim rng As Range\n    Dim mainArr() As Variant\n    Dim oWs As Worksheet\n    Dim tws As Worksheet\n    Dim dataClmStrt As Long\n\n    'put the months in this array\n    mainArr = Array(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\")\n\n    Set oWs = Sheets(\"Sheet3\") 'Change to the sheet with your data\n    Set tws = Sheets(\"Sheet4\") 'Change to the sheet for your output\n\n    With oWs\n        'find column where monthly values start.\n        dataClmStrt = .Range(\"1:1\").Find(\"Jan\", , , xlPart).Column - 1\n\n        For Each rng In .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp))\n            'skip any blank rows\n            If rng &lt;&gt; \"\" Then\n                'Copy the data down 12 rows\n                tws.Cells(tws.Rows.Count, 1).End(xlUp).Offset(1).Resize(12, dataClmStrt).Value = rng.Resize(, dataClmStrt).Value\n                'add the months array\n                tws.Cells(tws.Rows.Count, dataClmStrt + 1).End(xlUp).Offset(1).Resize(12, 1).Value = Application.Transpose(mainArr)\n                'Transpose the monthly amounts\n                tws.Cells(tws.Rows.Count, dataClmStrt + 2).End(xlUp).Offset(1).Resize(12, 1).Value = Application.Transpose(rng.Offset(, dataClmStrt).Resize(, 12))\n            End If\n        Next rng\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5919012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a3962a2d38a539a248d3da4aed7dce?s=128&d=identicon&r=PG&f=1", "display_name": "Porkythepig", "link": "https://stackoverflow.com/users/5919012/porkythepig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 35446685, "answer_count": 1, "score": 0, "last_activity_date": 1455675195, "creation_date": 1455663228, "last_edit_date": 1531164843, "question_id": 35444600, "link": "https://stackoverflow.com/questions/35444600/copy-partial-table-and-insert-n-times-then-transpose-second-part-of-table", "title": "Copy Partial Table and Insert N-times, then Transpose second part of table", "body": "<p>This is a continuation from a previous <a href=\"https://stackoverflow.com/questions/35365242/excel-or-vba-conditional-transposing-rows\">request:</a>. I was able to make the formulas work, but my excel keeps crashing after dragging down the formula for 60,000 rows. Now I'm trying to figure out a way to automate it using VBA to save memory. I've found <a href=\"http://ccm.net/forum/affich-107673-copy-row-and-insert-n-times\" rel=\"nofollow noreferrer\">this thread</a> helpful for the first part but don't know how to modify the formula to more than 3 columns (my actual raw data has 45-50 columns varying between versions). </p>\n\n<p>Sample Input</p>\n\n<pre><code>Col1  Col2 Col3....Col48 Jan($) Feb ($) Mar ($) .... Dec ($) \n111     AAA   CT      a    $55    $100   $125         $100       \n112     BBB   NJ      b    $50    $34    $125         $125  \n113     CCC   NV      c    $55    $100   $125         $155  \n114     DDD   VT      d    $95    $108   $75          $199  \n115     EEE   NJ      e    $20    $100   $125         $120  \n</code></pre>\n\n<p>Sample Output:</p>\n\n<pre><code>Col1 Col2 Col3 ...  Month Spend\n111   AAA   CT       1/1   $55\n111   AAA   CT       2/1   $100\n111   AAA   CT       3/1   $125\n111   AAA   CT       4/1   $80\n111   AAA   CT       5/1   $70\n.\n.\n.\n115   EEE   NJ       11/1  $50\n115   EEE   NJ       12/1  $120\n</code></pre>\n"}, {"tags": ["vba", "selection", "counter"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1455664861, "post_id": 35444584, "comment_id": 58587980, "body": "For Each s in Selection, where did you specify what s and Selection are?"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1455664943, "post_id": 35444584, "comment_id": 58588011, "body": "Actually, all of your variables, where are they declared?"}, {"owner": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455686070, "post_id": 35444584, "comment_id": 58594290, "body": "Variables are declared on top of the module 1 (where these macros are written). The variables are as follows:    Dim TotAmt As Double, MonthlyAmount(13), AccumAmount As Double, SpreadTotal As Double, SpreadFactors(12)"}, {"owner": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455686256, "post_id": 35444584, "comment_id": 58594356, "body": "s and Selection are not declared. Can you make a recommendation pls."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455688954, "post_id": 35444584, "comment_id": 58595379, "body": "You should declare s as Range."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "edited": false, "score": 0, "creation_date": 1455686455, "post_id": 35446152, "comment_id": 58594424, "body": "thanks Tim. I tried this, however it provided same error msg 1004 on row beginning with.INTERIOR. Pls see my response to the declarations above..i am beginning to think this is the problem area!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "edited": false, "score": 0, "creation_date": 1455688661, "post_id": 35446152, "comment_id": 58595267, "body": "What are the values of <code>s.Row</code> and <code>counter</code> when it fails ? Any merged cells?"}, {"owner": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "edited": false, "score": 0, "creation_date": 1455770246, "post_id": 35446152, "comment_id": 58640793, "body": "Thanks Tim for your assistance! Despite the cells i am trying to modify being unprotected on a work sheet that is protected, by unprotecting the work sheet first, then applying this macro, then re protecting it, it now appears working."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1455671524, "creation_date": 1455671524, "answer_id": 35446152, "question_id": 35444584, "link": "https://stackoverflow.com/questions/35444584/vba-to-fill-or-colour-cells-in-a-range/35446152#35446152", "title": "VBA to fill or colour cells in a range", "body": "<pre><code>With Cells(s.Row, counter + 21)\n    .Value = MonthlyAmount(counter)\n    .Interior.Color = RGB(230, 162, 94)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3602995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69857fa11a424475820279688bb0f3a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3602995", "link": "https://stackoverflow.com/users/3602995/user3602995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455671524, "creation_date": 1455663166, "question_id": 35444584, "link": "https://stackoverflow.com/questions/35444584/vba-to-fill-or-colour-cells-in-a-range", "title": "VBA to fill or colour cells in a range", "body": "<p>Introduction\nThis macro applies a spread amount (EG Annual budget amount less total forecast) to the remaining forecast months, EG Say 3 months left in a year October, Nov and Dec each in different columns.\nThe user selects a row, triggers the macro, the then a different macro (not shown as all working fine) determines the spread factors per month and then calls the macro below to calculate the amount per month.\nThe Macro below is working fine as is, however i now need to colour the target cells. Hence i have tried 3 options to modify the code per below, however receive error messages as described below: </p>\n\n<p>Existing Macro:</p>\n\n<pre><code>Sub CalcMonthlyAmounts_Bdgt()\n\nFor Each s In Selection\nAccumAmount = 0\nAB = Cells(s.Row, 39).Value 'Total Budgets column\nBC = Cells(s.Row, 35).Value 'Total Actuals column\nTotAmt = (AB - BC)\n\nFor counter = (13 - Range(\"NO_OF_MONTHS\").Value) To 11\n\n\nMonthlyAmount(counter) = (TotAmt * SpreadFactors(counter) /    SpreadTotal)\nCells(s.Row, counter + 21).Value = MonthlyAmount(counter) \n\nNext counter\n\nNext s\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Option 1 - Add the following WITH . END WITH statement above the row 'Next Counter'. This results in error code 1004</p>\n\n<pre><code>With Cells(s.Row, counter + 21).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = RGB(230, 162, 94)\n        .TintAndShade = 0\nEnd With\n</code></pre>\n\n<p>Option 2 - Add the following line above the row 'Next Counter'. This results in error code 1004</p>\n\n<pre><code>Cells(s.Row, counter + 21).Interior.color=RGB(RGB(230, 162, 94)\n</code></pre>\n\n<p>Option 3 - Declare the object range (Cells(s.Row, counter + 21)) with DIM and SEt. This Ended with error code 424</p>\n\n<pre><code>Dim cell_range as range\nSet cell_range = Cells(s.Row, counter + 21)\n</code></pre>\n\n<p>Thanks for any ideas. Funny thing is that option 1 worked for a short time, then broke...it must be quite close!</p>\n"}, {"tags": ["vba", "ms-access", "error-handling", "compiler-errors"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1455663277, "post_id": 35444379, "comment_id": 58587319, "body": "The VBA compiler doesn&#39;t show syntax errors in SQL strings. You should show us your <i>actual</i> code."}], "answers": [{"tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": false, "score": 1, "last_activity_date": 1455662924, "last_edit_date": 1495542200, "creation_date": 1455662924, "answer_id": 35444531, "question_id": 35444379, "link": "https://stackoverflow.com/questions/35444379/trap-syntax-error-during-compile/35444531#35444531", "title": "Trap Syntax Error During Compile", "body": "<p>The compiler can't go so far as to insert your code into the listbox field and check the outcome.  But, some good practices will help you trouble shoot this.  </p>\n\n<pre><code>Dim strRowSourceSQL as String\n\nstrRowSourceSQL  = \"SELECT ... FROM ... RIGHT JOIN ...\"\n\nIf MyValue = \"\" then\n    strRowSourceSQL = strRowSourceSQL &amp; \"MORE SQL HERE\"\nelse\n    strRowSourceSQL = strRowSourceSQL &amp; \"DIFFERENT SQL HERE\"\nend if\n\nMe.MyList.RowSource = strRowSourceSQL\n</code></pre>\n\n<p>This arrangement will let you inspect <code>strRowSourceSQL</code>.  Set a break point and...</p>\n\n<pre><code>Debug.Print strRowSourceSQL\n</code></pre>\n\n<p>Once you have that, drop into the Query editor and fix what's wrong.  Also, follow <a href=\"https://stackoverflow.com/a/1099570/122139\">these principles</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 1873607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e69706965d41d00d032d8c496cf444de?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/1873607/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1455721877, "creation_date": 1455721877, "answer_id": 35460479, "question_id": 35444379, "link": "https://stackoverflow.com/questions/35444379/trap-syntax-error-during-compile/35460479#35460479", "title": "Trap Syntax Error During Compile", "body": "<p>Thanks for the suggestions, but I found the problem.</p>\n\n<p>It turned out that I had a left-over query definition in the <strong>Property Sheet</strong> for the list box that had the offending HAVING clause.  When I removed the definition from the Property Sheet, the form opened without the annoying syntax error.  The vba code I included in my original post was just fine.</p>\n"}], "owner": {"reputation": 117, "user_id": 1873607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e69706965d41d00d032d8c496cf444de?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/1873607/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1455721877, "creation_date": 1455662245, "last_edit_date": 1455662845, "question_id": 35444379, "link": "https://stackoverflow.com/questions/35444379/trap-syntax-error-during-compile", "title": "Trap Syntax Error During Compile", "body": "<p>I am setting a list box row source conditionally based on a value:</p>\n\n<p>If MyValue = \"\" then<br>\n\u00a0\u00a0\u00a0Me.MyList.RowSource = \"SELECT...<br>\n\u00a0\u00a0\u00a0FROM...<br>\n\u00a0\u00a0\u00a0RIGHT JOIN...<br>\n\u00a0\u00a0\u00a0GROUP BY...<br>\n\u00a0\u00a0\u00a0ORDER BY...<br>\nElse<br>\n\u00a0\u00a0\u00a0Me.MyList.RowSource = \"SELECT...<br>\n\u00a0\u00a0\u00a0FROM...<br>\n\u00a0\u00a0\u00a0RIGHT JOIN...<br>\n\u00a0\u00a0\u00a0GROUP BY...<br>\n\u00a0\u00a0\u00a0<strong>HAVING MyValue</strong><br>\n\u00a0\u00a0\u00a0ORDER BY...<br>\nEnd if</p>\n\n<p>Where MyValue is some criteria for the HAVING part.\nThis works fine as long as MyValue is not \"\" (blank).  However during compile, I get a Microsoft Access error:  \"Syntax error on HAVING clause.\"  During runtime, the \"else\" with HAVING does not occur so no error there.  How can I avoid or trap the \"Syntax error on HAVING clause.\" during compile?  The usual \"On error...\" does not trap during compile.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["string", "vba", "ms-word", "compare"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1455686302, "post_id": 35444209, "comment_id": 58594369, "body": "What does Len() return for the two? The other thing you could do is to loop each character in the original Range and list its ANSI value (the ASC function), then compare those two lists."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1455708087, "post_id": 35444209, "comment_id": 58606957, "body": "If you loop through all characters and you are in an international environment then I would once again favor <code>AscW</code> over <code>Asc</code>."}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1455728160, "post_id": 35445013, "comment_id": 58621882, "body": "These are internal documents from the United States and the two strings are from the same document anyways. <code>strg1</code> is the selected text and <code>strg2</code> is the selected texts sentence. I compared the length as suggested by Cindy Meister and found that <code>strg1</code> is 42 characters and <code>strg2</code> is 43 characters. I am currently working on a way to find out what that extra character is with AscW"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1455731045, "last_edit_date": 1455731045, "creation_date": 1455665049, "answer_id": 35445013, "question_id": 35444209, "link": "https://stackoverflow.com/questions/35444209/vba-how-are-strings-compared/35445013#35445013", "title": "VBA how are strings compared", "body": "<p>There are two things I can think of which prevent both strings to be equal:</p>\n\n<p>(1) You might want to look into this the different comparison options in VBA. Look at the following for more help on that:\n<a href=\"https://msdn.microsoft.com/en-us/library/8t3khw5f.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/8t3khw5f.aspx</a>.</p>\n\n<p>(2) If you are working internationally then <code>a</code> looks like <code>a</code> but they are in fact not the same. While the first one can be achieved with <code>Selection.Value = ChrW(97)</code> (using the latin alphabet) the second one is <code>Selection.Value = ChrW(1072)</code> (from the cyrillic keyboard). They both look (visually) the same but they are in fact different to VBA.</p>\n\n<p>Note: don't try the second in the direct window as you will probably see only a <code>?</code> for ChrW(1072). Instead assign the two values (as shown above) to two different cells in a sheet and you will see that they seem the same but are in fact not:</p>\n\n<pre><code>Public Sub Comparison()\n\nSheets(1).Cells(2, 1).Value = ChrW(97)\nSheets(1).Cells(2, 2).Value = ChrW(1072)\nSheets(1).Cells(2, 3).Formula = \"=$A$1=$B$2\"\n\nEnd Sub\n</code></pre>\n\n<p>As the final option you can compare letter by letter to find out the difference manually. The following sub will do just that (somewhat verbose):</p>\n\n<pre><code>Option Compare Binary\n\nPublic Sub StringCompare()\nDim strText As String\nDim strSentence As String\n\nstrText = \"Table 4.662: MIMCAP Design Rules (Part 2)\"      'First string to compare to.\nstrSentence = \"Table 4.662: MIMCAP Design Rules (Part 2)\"  'Second string to compare to.\n\nDim lngLetterCount As Long\n\nFor lngLetterCount = 1 To IIf(Len(strText) &gt; Len(strSentence), Len(strText), Len(strSentence))\n    Debug.Print \"Letter \" &amp; Right(\"  \" &amp; lngLetterCount, 3) &amp; \": \" _\n        &amp; Mid(strText, lngLetterCount, 1) _\n        &amp; \" (\" &amp; Right(\"00\" &amp; AscW(Mid(strText, lngLetterCount, 1)), 3) &amp; \")\" _\n        &amp; \" - \" _\n        &amp; Mid(strSentence, lngLetterCount, 1) _\n        &amp; \" (\" &amp; Right(\"00\" &amp; AscW(Mid(strSentence, lngLetterCount, 1)), 3) &amp; \") \" _\n        &amp; IIf(AscW(Mid(strText, lngLetterCount, 1)) = AscW(Mid(strSentence, lngLetterCount, 1)), \"\", \"&lt;-- Err\")\nNext lngLetterCount\nIf Len(strText) &gt;= lngLetterCount Then\n    Debug.Print \"The text string is longer than the sentence string. Ther is no match for '\" &amp; Mid(strText, lngLetterCount) &amp; \"' in sentence.\"\nEnd If\nIf Len(strSentence) &gt;= lngLetterCount Then\n    Debug.Print \"The sentence string is longer than the text string. Ther is no match for '\" &amp; Mid(strSentence, lngLetterCount) &amp; \"' in text.\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 35445013, "answer_count": 1, "score": 0, "last_activity_date": 1455731045, "creation_date": 1455661504, "last_edit_date": 1455669253, "question_id": 35444209, "link": "https://stackoverflow.com/questions/35444209/vba-how-are-strings-compared", "title": "VBA how are strings compared", "body": "<p>I am trying to figure out why two strings are not equal to each other. This is my immediate window:</p>\n\n<pre><code>?strg2\nTable 4.662: MIMCAP Design Rules (Part 2)\n\n?strg1\nTable 4.662: MIMCAP Design Rules (Part 2)\n\n?strg1 = strg2\nFalse\n?strg2 &gt; strg1\nTrue\n</code></pre>\n\n<p>Here are how my variables are determined:</p>\n\n<pre><code>strg1 = objSelectionChange.Text\nstrg1 = Replace(strg1, vbNewLine, \"\")\nstrg1 = Trim(strg1)\n\nstrg2 = objSelectionChange.Sentences(1).Text\nstrg2 = Replace(strg2, vbNewLine, \"\")\nstrg2 = Trim(strg2)\n</code></pre>\n\n<p>There is a subsequent <code>If ((Len(strg2) &lt; 230) And (strg2 &lt;&gt; strg1))</code> test that these particular values should not be passing because they are supposed to be equal. I assumed it was some white space, so I used <code>Trim</code> and <code>Replace</code>, but the two strings are still are technically not equal for some reason. Any ideas?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1455696086, "post_id": 35444038, "comment_id": 58598724, "body": "So you want to copy data entered in fields on 1 form to a different form, is that correct? If both forms are open at the same time it&#39;s quite easy to do that without the need for sql or changing data in tables. Let me know if this is what you&#39;re trying to do and I&#39;ll post a proper answer."}, {"owner": {"reputation": 3, "user_id": 5914533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfbe4d78fa6367823f10790be9eea1c?s=128&d=identicon&r=PG&f=1", "display_name": "grasshopper", "link": "https://stackoverflow.com/users/5914533/grasshopper"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1455728084, "post_id": 35444038, "comment_id": 58621840, "body": "Yes, except I will need to close the first form after the data is copied to the second form. Much of the time the data will need to be copied to three or four more records."}, {"owner": {"reputation": 3, "user_id": 5914533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfbe4d78fa6367823f10790be9eea1c?s=128&d=identicon&r=PG&f=1", "display_name": "grasshopper", "link": "https://stackoverflow.com/users/5914533/grasshopper"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1455730339, "post_id": 35444038, "comment_id": 58623280, "body": "It would be better to have the code both open and close that initial form."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1455664105, "last_edit_date": 1495542201, "creation_date": 1455664105, "answer_id": 35444799, "question_id": 35444038, "link": "https://stackoverflow.com/questions/35444038/ms-access-2013-copy-a-specific-number-of-fields-and-paste-into-a-new-record/35444799#35444799", "title": "MS Access 2013 copy a specific number of fields and paste into a new record", "body": "<p><code>INSERT INTO table (...) VALUES (...)</code> cannot have a FROM or WHERE clause. You insert a single record with fixed values, not data from another table.</p>\n\n<p>But once you delete these clauses, you will have other errors, because you need to format your string and date values correctly to get the INSERT query to work.</p>\n\n<p>And then you will still be prone to SQL injection errors. It is safer to use <code>Recordset.AddNew</code> and <code>.Update</code> to add records.</p>\n\n<p>See e.g. here: <a href=\"https://stackoverflow.com/a/34969410/3820271\">https://stackoverflow.com/a/34969410/3820271</a><br>\n(but without the loop)</p>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "is_accepted": true, "score": 0, "last_activity_date": 1455787326, "creation_date": 1455787326, "answer_id": 35477362, "question_id": 35444038, "link": "https://stackoverflow.com/questions/35444038/ms-access-2013-copy-a-specific-number-of-fields-and-paste-into-a-new-record/35477362#35477362", "title": "MS Access 2013 copy a specific number of fields and paste into a new record", "body": "<p>Here's a <a href=\"https://drive.google.com/file/d/0B-J5B7nFljZicHBuWWVaUDl0QnM/view?usp=sharing\" rel=\"nofollow noreferrer\">mock-up Access file</a> illustrating a way to do what you're doing without using SQL:</p>\n\n<p>With <strong>Form 1</strong> open...</p>\n\n<p><a href=\"https://i.stack.imgur.com/xAcY4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xAcY4.png\" alt=\"enter image description here\"></a></p>\n\n<p>...complete the various fields:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wpAiZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wpAiZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click the <em>Copy to Form 2</em> button and this will open <strong>Form 2</strong> and populate its fields with the data from <strong>Form 1</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1adhd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1adhd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the VBA code on the <em>Copy to Form 2</em> button's OnClick event:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdCopyToFrm2_Click()\n\n    Dim frm As Form\n\n    DoCmd.OpenForm \"Form2\"\n\n    Set frm = Forms!Form2\n\n    With frm\n\n        !AuditRef = Me.cboFP1Audit\n        !AuditMonth = Me.txtAuditMonth\n        !AuditYear = Me.txtAuditYear\n        !AuditUsername = Me.txtAuditUsername\n        !Location = Me.txtLocation\n        !Reviewer = Me.txtReviewer\n        !AuditDate = Me.txtAuditDate\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note that when <strong>Form 2</strong> opens, the textbox that the cursor defaults to might not seem to show any data; if you move away from that textbox it should magically show (don't know why it does this, but there you go).</p>\n"}], "owner": {"reputation": 3, "user_id": 5914533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfbe4d78fa6367823f10790be9eea1c?s=128&d=identicon&r=PG&f=1", "display_name": "grasshopper", "link": "https://stackoverflow.com/users/5914533/grasshopper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2196, "favorite_count": 0, "accepted_answer_id": 35477362, "answer_count": 2, "score": -1, "last_activity_date": 1594642672, "creation_date": 1455660821, "last_edit_date": 1594642672, "question_id": 35444038, "link": "https://stackoverflow.com/questions/35444038/ms-access-2013-copy-a-specific-number-of-fields-and-paste-into-a-new-record", "title": "MS Access 2013 copy a specific number of fields and paste into a new record", "body": "<p>I have found similar answers to this question, even on this site, however, the syntax has not worked for my database and I'm not sure what needs to be done. This data base is used to house audits for staff performance and accuracy. I am now in the midst of creating the forms and getting them to flow properly for the user.</p>\n\n<p>When conducting an audit, the user will need to enter six specific fields into the first form. Those forms are Audit, Month, Year, Username, Location, Reviewer, and Date. The user will need to complete multiple audits, however, these six fields will always be the same.</p>\n\n<p>I would like to copy these fields in the first form and carry them into the second form so the user does not have to repeat the information. Here is my current code (set to run on the click of a command button on the bottom of screen 1):</p>\n\n<pre><code>Dim strSQL As String\nstrSQL = \"INSERT INTO [tblTripMem] (Audit, Month, Year, Username, Location, Reviewer, Date)\"\nstrSQL = strSQL &amp; \" Values (\" &amp; Me.cboFP1Audit &amp; \",\" &amp; Me.Month &amp; \",\" &amp; Me.Year &amp; \",\" &amp; Me.Username &amp; \",\" &amp; Me.Location &amp; \",\" &amp; Me.Reviewer &amp; \",\" &amp; Me.Date &amp; \") FROM [FPScreen1]\"\nstrSQL = strSQL &amp; \"WHERE (currentrecord = \" &amp; Me.CurrentRecord &amp; \")\"\nDoCmd.RunSQL (strSQL)\n</code></pre>\n\n<p>Each time I run this I receive the following error: \"Invalid SQL statement; expected 'DELETE', 'INSERT', 'PROCEDURE', 'SELECT', or 'UPDATE'.</p>\n\n<p>I am new to Access and am unsure of what this means or how to fix it. All I know is that I'm not finding a solution. Can anyone help? I'd greatly appreciate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1455725079, "post_id": 35443886, "comment_id": 58619679, "body": "Did one of the answers work for you?  If so please mark it as correct.  Click on the green check mark by the answer you used.  It is something only you can do.  It will mark this question as being answered."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1455660430, "creation_date": 1455660430, "answer_id": 35443931, "question_id": 35443886, "link": "https://stackoverflow.com/questions/35443886/vba-2-criteria-index-match-lookup-using-evaluate-excel/35443931#35443931", "title": "VBA 2 criteria index match lookup using evaluate, Excel", "body": "<p>Try this:</p>\n\n<pre><code>imTest = ws.Evaluate(\"Index($c$2:$c$5, Match(\" &amp; criteria1  &amp; criteria2 &amp; \" , $A$2:$A$5&amp;$B$2:$B$5, 0))\")\n</code></pre>\n\n<p>You need to quote out the part that is vba from the part that is formula</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1455670315, "creation_date": 1455670315, "answer_id": 35445940, "question_id": 35443886, "link": "https://stackoverflow.com/questions/35443886/vba-2-criteria-index-match-lookup-using-evaluate-excel/35445940#35445940", "title": "VBA 2 criteria index match lookup using evaluate, Excel", "body": "<p>This should work.  Note there is a difference between using <code>Application.Evaluate</code> and <code>Worksheet.Evaluate</code>: the first will evaluate the formula in the context of whichever sheet happens to be active.  If that's not what you'd want then you should use the WorkSheet version.</p>\n\n<pre><code>Sub test()\n\n    Dim imTest As Variant\n    Dim school As String\n    Dim place As String\n    Dim Criteria1 As String\n    Dim Criteria2 As String\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    school = ws.Cells(2, 8)\n    place = ws.Cells(2, 9)\n    Criteria1 = school\n    Criteria2 = place\n\n    'note ws.Evaluate or you will get bad results when \n    '   Sheet1 is not the active sheet\n    imTest = ws.Evaluate(\"Index($c$2:$c$5, Match(\"\"\" &amp;  criteria1 &amp; \"\"\"&amp;\"\"\" &amp; _\n                          criteria2 &amp; \"\"\", $A$2:$A$5&amp;$B$2:$B$5, 0))\")\n\n    If IsError(imTest) Then\n        ws.Cells(2, 10) = \"Err\"\n    Else\n        ws.Cells(2, 10) = imTest\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5880998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d9609e0d13b0d098e4323bdcaf7e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Leoruns", "link": "https://stackoverflow.com/users/5880998/leoruns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 35445940, "answer_count": 2, "score": 0, "last_activity_date": 1455670315, "creation_date": 1455660218, "question_id": 35443886, "link": "https://stackoverflow.com/questions/35443886/vba-2-criteria-index-match-lookup-using-evaluate-excel", "title": "VBA 2 criteria index match lookup using evaluate, Excel", "body": "<p>Say I am trying to get a lookup with 2 criteria in the example picture below: </p>\n\n<p><a href=\"http://i.stack.imgur.com/1hghr.png\" rel=\"nofollow\">example picture</a></p>\n\n<p>Can anyone tell me what is wrong with this code? I am trying to use a index/match lookup with 2 criteria. </p>\n\n<pre><code>Sub test()\nDim imTest As Variant\nDim school As String\nDim place As String\nDim Criteria1 As String\nDim Criteria2 As String\n\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nschool = ws.Cells(2, 8)\nplace = ws.Cells(2, 9)\nCriteria1 = school\nCriteria2 = place\n\n'error here\nimTest = Evaluate(\"Index($c$2:$c$5, Match( criteria1  &amp; criteria2 , $A$2:$A$5&amp;$B$2:$B$5, 0))\")\nIf IsError(imTest) Then\nws.Cells(2, 10) = \"Err\"\nElse\nws.Cells(2, 10) = imTest\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>But however, this code works, by editing the evaluate line like so: </p>\n\n<pre><code>Sub test()\nDim imTest As Variant\nDim school As String\nDim place As String\nDim Criteria1 As String\nDim Criteria2 As String\n\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nschool = ws.Cells(2, 8)\nplace = ws.Cells(2, 9)\nCriteria1 = school\nCriteria2 = place\n\n'this changed and no more error\nimTest = Evaluate(\"Index($c$2:$c$5, Match( \"\"John\"\"  &amp; \"\"NJ\"\" , $A$2:$A$5&amp;$B$2:$B$5, 0))\")\nIf IsError(imTest) Then\nws.Cells(2, 10) = \"Err\"\nElse\nws.Cells(2, 10) = imTest\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>What do I need to do to make the match argument work for variables? I hope I'm not too confusing. Thank you so much in advance for any help! Thanks. </p>\n"}, {"tags": ["excel", "vba", "save-as", "before-save", "xlsm"], "owner": {"reputation": 25, "user_id": 4969789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155631250065553/picture?type=large", "display_name": "Shawna Baker", "link": "https://stackoverflow.com/users/4969789/shawna-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455659708, "creation_date": 1455659708, "question_id": 35443755, "link": "https://stackoverflow.com/questions/35443755/vba-excel-forcing-filename-with-workbook-beforesave-and-activeworkbook-saveas", "title": "VBA excel : Forcing filename with Workbook_BeforeSave and ActiveWorkbook.SaveAs", "body": "<p>I am building a form that is placed in a shared folder on a private network. The 'mother form', used by a single user, is a template that generates 'child forms' when it is saved using the information from the spreadsheet. </p>\n\n<p>To name my 'child forms', I use the Workbook_BeforeSave event. I collect the information I need to name the file. Then, I save as the name of my file. All the files are in the same folder.</p>\n\n<p>My code works fine on my computer (Excel 2016) but for some reason, it doesn't work on all computers (I have noticed the problem on Excel 2013 but not on 2010).</p>\n\n<p>I checked if every user had the correct access to the folder containing the files, and they have. They are not able to manualy save as.</p>\n\n<p>Here is the code I'm using to save : </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nCancel = True\n\n'Variable definition\nDim Contrat As String\nDim Projet As String\nDim Requisition As String\nDim Marque As String\nDim RefPeinture As String\n\n'Get variable values\nContrat = Feuil1.Range(\"C3\").Value\nProjet = Feuil1.Range(\"C4\").Value\nRequisition = Feuil1.Range(\"F5\").Value\nMarque = Feuil1.Range(\"F6\").Value\nRefPeinture = Feuil1.Range(\"C7\").Value\n\n'Determining file name\nNomDeFichier = \"F:\\Peinture (Inspection)\\Ann\u00e9e actuelle\\\" &amp; Contrat &amp; \"_\" &amp; Projet &amp; \"_\" &amp; RefPeinture &amp; \"_\" &amp; Requisition &amp; \"_\" &amp; Marque &amp; \".xlsm\"\n\n'Saving as file name in .xlsm (fileformat = 52)\nActiveWorkbook.SaveAs _\n    Filename:=NomDeFichier, _\n    FileFormat:=52, _\n    Password:=\"\", _\n    WriteResPassword:=\"\", _\n    ReadOnlyRecommended:=False, _\n    CreateBackup:=False\n\n'Inserting document proporty for keyword\nThisWorkbook.BuiltinDocumentProperties(\"Keywords\").Value = Feuil1.Range(\"C3\").Value\n\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "vbscript", "outlook", "ms-office", "office-interop"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455660144, "post_id": 35443585, "comment_id": 58585836, "body": "Is this VBA or VBScript? Or more likely VB.Net? They are not the same thing."}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1455661177, "post_id": 35443585, "comment_id": 58586361, "body": "This is for a VBScript sub within a Custom Outlook form, but I tagged VBA to draw other Outlook folks, as I wasn&#39;t sure who would have a better handle on declaring the KeyAscii parameter."}], "answers": [{"tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": true, "score": 0, "last_activity_date": 1456159871, "creation_date": 1456159871, "answer_id": 35559253, "question_id": 35443585, "link": "https://stackoverflow.com/questions/35443585/determine-ascii-code-of-olktextbox-keypress-event-in-outlook-vb-script-event-han/35559253#35559253", "title": "Determine ASCII Code of OlkTextBox KeyPress Event In Outlook VB Script Event Handler", "body": "<p>The answer to this question is that controls in Custom Outlook form controls will only respond to _Click() events. As far as VB Script is concerned, these other events do not happen. </p>\n"}], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 35559253, "answer_count": 1, "score": 0, "last_activity_date": 1456159871, "creation_date": 1455658994, "question_id": 35443585, "link": "https://stackoverflow.com/questions/35443585/determine-ascii-code-of-olktextbox-keypress-event-in-outlook-vb-script-event-han", "title": "Determine ASCII Code of OlkTextBox KeyPress Event In Outlook VB Script Event Handler", "body": "<p>I am building a custom Outlook form in Outlook, using</p>\n\n<p>Developer > Design Outlook Form</p>\n\n<p>I have enabled scripting in my Public Folders.</p>\n\n<p>I have added a textbox to the form's \"Message\" page</p>\n\n<p>I would like to capture, in a keypress event, the ASCII code of the relevant key, and limit the input in the textbox to numbers (0-9).</p>\n\n<p>In the Script Editor: > Script > Object Browser, we can see that for the OlkTextBoxEvents.KeyPress member, the KeyPress variable is listed as a _IRecipientControl.</p>\n\n<p>When we enter into the Object Help section, however, the KeyAscii variable is listed as long. </p>\n\n<p>Neither appears to be appropriately declared, as we receive a \"Expected ) at Line #\" with both declarations. </p>\n\n<p>If we simply specify KeyAscii as a variant parameter, we do not receive the error, however, that also means that I do not know how to access/manipulate the relevant key data. </p>\n\n<p>How should the KeyAscii parameter be declared and used?</p>\n"}, {"tags": ["vba", "outlook", "attachment"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5936692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd6dd8cd49fa35b9ac0431b002f6b41?s=128&d=identicon&r=PG&f=1", "display_name": "Hopner", "link": "https://stackoverflow.com/users/5936692/hopner"}, "edited": false, "score": 0, "creation_date": 1455710004, "post_id": 35445773, "comment_id": 58608310, "body": "Thank you very much, Om3r! It works like a charm now!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 11, "user_id": 5936692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd6dd8cd49fa35b9ac0431b002f6b41?s=128&d=identicon&r=PG&f=1", "display_name": "Hopner", "link": "https://stackoverflow.com/users/5936692/hopner"}, "edited": false, "score": 0, "creation_date": 1461566628, "post_id": 35445773, "comment_id": 61237800, "body": "@Hopner please remember to accept the answer, Thank you"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1455669368, "creation_date": 1455669368, "answer_id": 35445773, "question_id": 35443330, "link": "https://stackoverflow.com/questions/35443330/code-unexpectedly-stops-after-changing-folder-in-outlook/35445773#35445773", "title": "Code unexpectedly stops after changing folder in Outlook", "body": "<p><strong><code>Set objSelection = objOL.ActiveExplorer.Selection</code></strong></p>\n\n<p>Represents a set of Outlook items object  currently selected in an Active explorer, That procedure is called only when a message is selected - Remove it.</p>\n\n<p><strong><code>Set objOL = CreateObject(\"Outlook.Application\")</code></strong></p>\n\n<p>Also, there is no need to create a new Outlook Application instance in the Outlook VBA macro, Instead, you can use the Application property, </p>\n\n<p>for example:</p>\n\n<p><strong><code>Set objMsg = Application.CreateItem(olMailItem)</code></strong></p>\n"}], "owner": {"reputation": 11, "user_id": 5936692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd6dd8cd49fa35b9ac0431b002f6b41?s=128&d=identicon&r=PG&f=1", "display_name": "Hopner", "link": "https://stackoverflow.com/users/5936692/hopner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593247848, "creation_date": 1455658013, "last_edit_date": 1593247848, "question_id": 35443330, "link": "https://stackoverflow.com/questions/35443330/code-unexpectedly-stops-after-changing-folder-in-outlook", "title": "Code unexpectedly stops after changing folder in Outlook", "body": "<p>I have a macro1 that when it detects a new email in a certain folder it triggers another macro2 that goes to that specific folder, download all attachments, delete all emails and then goes back to inbox.</p>\n\n<p>Macro1 runs well and trigger macro2.</p>\n\n<p>The problem is: macro2 only runs halfway. When It executes, it runs only until the part of the code that sets the active folder to the one I desire. After that, it stops. When I run macro2 again, immediately after it stops, it works and download/delete the attachment. </p>\n\n<p>It looks to me it is a single fix but I can't figure it out.</p>\n\n<p>1-Macro1: If I get a new email in folder \"Relatorio\", it will run macro2</p>\n\n<p>2-Macro2 will turn \"Relatorio\" active</p>\n\n<h3>it stops here ### if I run again, it proceeds</h3>\n\n<p>3-Macro2 will download all emails and attachments</p>\n\n<p>4-Macro2 will delete all emails</p>\n\n<p>5-Macro2 will change active folder to inbox back again</p>\n\n<p>Macro2:</p>\n\n<pre><code>Dim objOL As Object 'As Outlook.Application\nDim objMsg As Object 'Outlook.MailItem\nDim objAttachments As Object 'As Outlook.Attachments\nDim objSelection As Object 'As Outlook.Selection\nDim objFolder As Object 'As Outlook.Folder\n\nDim i As Long\nDim lngCount As Long\nDim strFile As String\nDim strFolderpath As String\n\nstrFolderpath = \"C:\\Users\\hopnere\\Desktop\\Dashboard\\\"\n\nSet objOL = CreateObject(\"Outlook.Application\")\n\nSet objFolder = Session.GetDefaultFolder(olFolderInbox).Folders(\"Relatorio\") \nSet objOL.ActiveExplorer.CurrentFolder = objFolder\n\n### stops here ###\nSet objMsg = objOL.CreateItem(olMailItem)\n\nSet objSelection = objOL.ActiveExplorer.Selection\n\n\nFor Each objMsg In objFolder.Items\n\nSet objAttachments = objMsg.Attachments\n    lngCount = objAttachments.Count 'check if there is an email with attachment\n    MsgBox lngCount\n    If lngCount &gt; 0 Then\n\n\n        For i = lngCount To 1 Step -1\n        i = lngCount\n\n            strFile = strFolderpath &amp; \"Backend.xls\" 'attachment destiny folder\n\n            ' saves attachment\n            objAttachments.item(i).SaveAsFile strFile\n\n            ' Delete attachment\n            objAttachments.item(i).Delete\n            ' delete email\n            objMsg.Delete\n\n        Next i\n\n    End If\n\nNext\n\nSet objFolder = Session.GetDefaultFolder(olFolderInbox) 'setting inbox active\nSet objOL.ActiveExplorer.CurrentFolder = objFolder\n\n\nExitSub:\n\nSet objAttachments = Nothing\nSet objMsg = Nothing\nSet objSelection = Nothing\nSet objOL = Nothing\nSet objFolder = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1455696637, "post_id": 35443319, "comment_id": 58598994, "body": "Are the subform&#39;s displaying properly? What tests have you done on the subform events you say are not working?"}, {"owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1455723849, "post_id": 35443319, "comment_id": 58618676, "body": "The subforms are all displaying properly.  I have created event procedures for the subform&#39;s On Load event, and have put breakpoints, debug messages, message boxes, etc in addition to the non diagnostic code in the On Load event; none of the expected effects are seen.  I am starting to suspect this issue is specific to the Subform being hosted within a TabCtl."}], "owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455657981, "creation_date": 1455657981, "question_id": 35443319, "link": "https://stackoverflow.com/questions/35443319/ms-access-subform-in-a-tabctl-on-load-event-not-triggered", "title": "MS Access Subform in a TabCtl On Load event not triggered", "body": "<p>In an Access 2013 project all of the subforms that are hosted within a TabCtl do not get their On Load (or related: Open, Current, Activate, etc) triggered.</p>\n\n<p>The form that hosts the TabCtl does get its On Load called.  Based on a button click it sets the SourceObject property of the Subform control in the TabCtl to the desired form.  The form is displayed, but On Load is never called.</p>\n\n<p>In the same project I do a similar operation (dynamically setting the SourceObject property of a Subform control) but without a  TabCtl involved, and it works as expected.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455656404, "post_id": 35442810, "comment_id": 58583660, "body": "That <code>John:&#47;&#47;</code> looks like a custom protocol ?  What do you mean by &quot;saving each document&quot;?  Aren&#39;t they already saved on your computer?  I&#39;m guessing that unless whatever executable gets run exposes the actual path you may be out of luck..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1455656483, "post_id": 35442810, "comment_id": 58583710, "body": "Would the filename be in the hyperlink, or will it look like the example?  You&#39;d need to find a way of interfacing with the opening application, depending on the application determines the approach.  What would John be, an internally developed application?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1455656683, "post_id": 35442810, "comment_id": 58583834, "body": "If I am not completely misunderstanding the question then: (1) Use the <code>WorkSheets(1).Hyperlinks</code> collection to check all the hyperlinks 1 by 1 and then (2) use <code>CMD</code> commands to copy / save these file to the location you want them to be."}, {"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1455656700, "post_id": 35442810, "comment_id": 58583845, "body": "Yes, they are actually saved, but each of them is saved in a different folder, along with many other folders that I do not need. My goal is to concentrate all documents that are being linked to in the excel, to a specific folder. Is it possible?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455656777, "post_id": 35442810, "comment_id": 58583897, "body": "Difficult to suggest an answer without knowing more about what your protocol handler actually does."}, {"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1455657096, "post_id": 35442810, "comment_id": 58584105, "body": "Hi Nathan, the filename is not indicated in link. The link consists of many number and letters. But I think it&#39;s important to say that the folders on my local PC that contain the desired files have a similar name to the &quot;special&quot; links in my worksheet, for example: John://56ad4/abcd4/d5d6 (link on excel) C:/local/0000/abcd4/1234/file.pdf  So the abcd4 is the same for both of them."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1455658192, "post_id": 35442810, "comment_id": 58584741, "body": "You could possibly use shell such as Dim oApp As Object oApp.Namespace(DestinationFolder).CopyHere oApp.Namespace(nameOfFile).Items if you can figure out a way to grab the file name"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1455757500, "post_id": 35442810, "comment_id": 58637145, "body": "You may want to use <b>Worksheets Hyperlinks</b> collection and <b>URLDownloadToFile function</b>, sample: <a href=\"http://www.mrexcel.com/forum/excel-questions/67123-visual-basic-applications-save-file-website.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> and from <a href=\"https://msdn.microsoft.com/en-us/library/ms775123(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 1, "creation_date": 1455658831, "post_id": 35443397, "comment_id": 58585053, "body": "Please explain your solution by editing your answer. Especially explain why the original poster should try this."}], "tags": [], "owner": {"reputation": 1, "user_id": 3509331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYqLH.png?s=128&g=1", "display_name": "Gourav Mittal", "link": "https://stackoverflow.com/users/3509331/gourav-mittal"}, "is_accepted": false, "score": 0, "last_activity_date": 1455658279, "creation_date": 1455658279, "answer_id": 35443397, "question_id": 35442810, "link": "https://stackoverflow.com/questions/35442810/is-there-a-way-to-save-all-hyperlinked-documents-in-excel/35443397#35443397", "title": "Is there a way to save all hyperlinked documents in excel?", "body": "<p>You may try this</p>\n\n<pre>\n'''\nInput: test.xlsx\n\nname    link\n1       location/file1.jpg\n2       location/file2.xlsx\n3       location/file3.pdf\n4       location/file4.mp4\n'''\nfrom openpyxl import load_workbook\n\nwb = load_workbook('test.xlsx')\n\nprint wb.get_sheet_names()\n# ['Sheet 1', 'Sheet 2', 'Sheet 3']\n\nws1 = wb['Sheet 1']\n## alternate -> worksheet2 = wb2.get_sheet_by_name('Sheet2')\n\nimport urllib\nimport os\n\n## Result directory\ndirectory = 'result'\n\nif not os.path.exists(directory):\n    os.makedirs(directory)\n\nfor row in ws1:\n    if '.exe' in row[1].value:\n        continue\n    print row[0].value, '\\t', row[1].value\n    urllib.urlretrieve (row[1].value, directory+'/'+row[1].value)\n\n'''\nOutput: \nTable 1     None\nNone    None\nname    link\n1   location/file1.jpg\n2   location/file2.xlsx\n3   location/file3.pdf\n4   location/file4.mp4\n\n'''\n\n</pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1980648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4807345abbd92d0af8963996b9932516?s=128&d=identicon&r=PG", "display_name": "KevinMacKay", "link": "https://stackoverflow.com/users/1980648/kevinmackay"}, "is_accepted": false, "score": 0, "last_activity_date": 1455659290, "creation_date": 1455659290, "answer_id": 35443671, "question_id": 35442810, "link": "https://stackoverflow.com/questions/35442810/is-there-a-way-to-save-all-hyperlinked-documents-in-excel/35443671#35443671", "title": "Is there a way to save all hyperlinked documents in excel?", "body": "<pre><code>Sub PathsText()\nDim List(), Path As String\nDim i, x As Integer\nDim s As InlineShape\nDim fso As FileSystemObject, ts As TextStream\n\nSet fso = New FileSystemObject\nSet ts = fso.OpenTextFile(\"C:\\MyFolder\\List.txt\", 8, True)\n\nWith ts\n.WriteLine (ActiveDocument.InlineShapes.Count)\nEnd With\n\nFor Each s In ActiveDocument.InlineShapes\n    Path = s.LinkFormat.SourcePath &amp; \"\\\" _\n    &amp; s.LinkFormat.SourceName\n    With ts\n        .WriteLine (Path)\n    End With\nNext s\nEnd Sub\n</code></pre>\n\n<p>I guess the important part is if \"Path = s.LinkFormat.SourcePath\" works.</p>\n\n<p>If so, if you have a ton of excel files to do it for, I'd put those (the ones with the links) in one folder. I'd make a new empty workbook with one button on a single sheet to call code. The button would \"For Each workbook in directory, For Each sheet in workbook, For Each link on sheet\" add source path to a text file. </p>\n\n<p>Once you had a list of paths the next step would be obvious. I wish I had demo code, but I migrated to c# years ago. My monstrously slow cell-by-cell search, modify and graph inventions threatened to bury me.</p>\n"}], "owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2219, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1455659290, "creation_date": 1455656190, "question_id": 35442810, "link": "https://stackoverflow.com/questions/35442810/is-there-a-way-to-save-all-hyperlinked-documents-in-excel", "title": "Is there a way to save all hyperlinked documents in excel?", "body": "<p>I know this question has been answered before, but the problem I'm facing is a bit different, and this is why I'm asking for your help :)</p>\n\n<p>So, I'm working with multiple excel files that contain multiple hyperlinks that lead to documents such as Excel files, PDFs, DOCs and sometimes even images. The problem with these hyperlinks is that they are not leading to a \"normal\" website, but to a special internal software, that in its turn links to a local address on my computer that contatins the desired file. That means that there is no direct link that could be grabbed with a simple VBA code.</p>\n\n<p>Let's have an example, assuming the internal software name is \"John\":\nI see in the Excel documents this link:  John://3434545345/345345345\nWhen I click on it, it opens the file, which is located, for example, in: C:/local/Cutekitten.pdf</p>\n\n<p>After this long intro, my question is: Is there a way to automate the process of saving each document, instead of manually opening it and saving it? Could it be solved with a VBA code? Or does is require a different approach? I was actually thinking to bypass this problem by finding a way to open all hyperlinks at once with VBA, and then maybe find some code (not VBA?) that saves all open documents. </p>\n\n<p>P.S Please keep in mind that I can't download EXE files or any other \"suspicious\" files due to workplace restrictions.</p>\n\n<p>Any help will be much appreciated,\nThanks! :) </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1455655332, "last_edit_date": 1455655332, "creation_date": 1455655031, "answer_id": 35442481, "question_id": 35442068, "link": "https://stackoverflow.com/questions/35442068/error-executing-a-saved-access-query-that-depends-on-parameter-values-from-a-for/35442481#35442481", "title": "Error executing a saved Access query that depends on parameter values from a form", "body": "<p>It seems <em>qryInsurance</em> includes references to form controls, maybe like this ...  <code>Forms!frmA!From</code></p>\n\n<p>Those references are resolved when you use <code>DoCmd.OpenQuery</code>, but not when you use the <code>DAO.Database.OpenRecordset</code> method.  With <code>OpenRecordset</code>, they are interpreted as parameters for which you have not supplied values.</p>\n\n<p>If you open the query's <code>QueryDef</code> and then feed each parameter <code>Name</code> to <code>Eval()</code>, it will give you the values of those form controls ... so you can then supply them as the values for the parameters.  </p>\n\n<p>That description may not be easy to follow, but the code is pretty easy.</p>\n\n<p>Add these variable declarations before <code>Set db = CurrentDb</code> ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim prm As DAO.Parameter\nDim qdf As DAO.QueryDef\nDim CountFollowup ' As what? Boolean?\n</code></pre>\n\n<p>Then later ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set db = CurrentDb\nCountFollowup = False\n\n'DoCmd.OpenQuery \"qryInsurance\"\n'strsql = \"SELECT * FROM [qryInsurance];\"\n'CurrentDb.Execute \"Delete * FROM temp_InsData\"\n\nSet qdf = db.QueryDefs(\"qryInsurance\")\nFor Each prm In qdf.Parameters\n    prm.Value = Eval(prm.Name)\nNext\n'Set rs1 = CurrentDb.OpenRecordset(strsql, , dbOpenSnapshot) ' here is where it gives me an ERROR, expecting 2 parameters when it OPENS it fine before strsql\nSet rs1 = qdf.OpenRecordset(dbOpenSnapshot)\n\n' and the rest ...\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5828099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8a37543882c7b52c7f823f1ab24e89a?s=128&d=identicon&r=PG&f=1", "display_name": "SamSam7", "link": "https://stackoverflow.com/users/5828099/samsam7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 35442481, "answer_count": 1, "score": 1, "last_activity_date": 1468283719, "creation_date": 1455653454, "last_edit_date": 1468283719, "question_id": 35442068, "link": "https://stackoverflow.com/questions/35442068/error-executing-a-saved-access-query-that-depends-on-parameter-values-from-a-for", "title": "Error executing a saved Access query that depends on parameter values from a form", "body": "<p>I'm trying to simply open a query and <code>SELECT</code> everything from it. The query requires <code>FROM</code> and <code>TO</code> dates. I have a <code>frmA</code> through which I pass the parameters to the query. I open the <code>frmA</code> and put in 2 dates. Funny thing is, when I do <code>docmd.openQuery \"qryInsurance\"</code> it opens it wihout a problem, however, when I try to <code>Select * from qryInsurance</code>, it tells me that it's expecting 2 parameters.</p>\n\n<p>here is the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function CountFollowup() As Boolean\nOn Error GoTo error_handler:\nDim rs1 As DAO.Recordset\nDim rs2 As DAO.Recordset\nDim strsql As String\nDim rcount As Integer\nSet DB = CurrentDb\nCountFollowup = False\n\nDoCmd.OpenQuery \"qryInsurance\"\n\nstrsql = \"SELECT * FROM [qryInsurance];\"\n\n'CurrentDb.Execute \"Delete * FROM temp_InsData\"\nSet rs1 = CurrentDb.OpenRecordset(strsql, , dbOpenSnapshot) ' here is where it gives me an ERROR, expecting 2 parameters when it OPENS it fine before strsql\nSet rs2 = CurrentDb.OpenRecordset(\"temp_InsData\")\n\nDebug.Print strsql\n\n\nExit Function\nerror_handler:\nMsgBox Err.Number &amp; \" - \" &amp; Err.Description\nEnd Function\n</code></pre>\n"}, {"tags": ["email", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5936920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0e8fc451d23f274f003c928cc0c205?s=128&d=identicon&r=PG&f=1", "display_name": "TTobaben", "link": "https://stackoverflow.com/users/5936920/ttobaben"}, "edited": false, "score": 0, "creation_date": 1455659402, "post_id": 35442058, "comment_id": 58585383, "body": "Thanks for the suggestions!  They pointed me in right direction!  I have it squared away and running.  I am sure the code is not as clean as it could be...still trying to get a feel for how al this works."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1455653398, "creation_date": 1455653398, "answer_id": 35442058, "question_id": 35441663, "link": "https://stackoverflow.com/questions/35441663/process-records-eof/35442058#35442058", "title": "Process Records EOF", "body": "<p>It is - among other things - the <code>GoTo Check</code>.</p>\n\n<p>Remove that and rebuild your loop.\nAlso, you only need one <code>.Edit</code> and <code>.Update</code> for each record.</p>\n"}], "owner": {"reputation": 3, "user_id": 5936920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0e8fc451d23f274f003c928cc0c205?s=128&d=identicon&r=PG&f=1", "display_name": "TTobaben", "link": "https://stackoverflow.com/users/5936920/ttobaben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 35442058, "answer_count": 1, "score": 0, "last_activity_date": 1459413404, "creation_date": 1455651785, "last_edit_date": 1459413404, "question_id": 35441663, "link": "https://stackoverflow.com/questions/35441663/process-records-eof", "title": "Process Records EOF", "body": "<p>Wondering if someone might be able to help me solve this issue.  Have an Access database where I want to send an email for each \"Submit\" box that is checked is checked.  Have tried several thing and either get 1 record processed before the code stops or will give me several emails for the same record without moving on.  Any help with where I am missing the boat would be much appreciated.  Below is what I have for the code:</p>\n\n<pre><code>Dim r As DAO.Recordset\nSet r = CurrentDb.OpenRecordset(\"SELECT * FROM [CIs_All_Statuses] WHERE [Submit] = True\")\n    If r.RecordCount = 0 Then\n    MsgBox (\"No records selected\")\n    GoTo Done\n    Else\n    End If\n\nr.MoveFirst\ni = 1\n\nBegin:\nDo Until r.EOF = True\n\nproduct = r![Product Name]\nserial = r![Serial Number]\nagency = r![Company]\nUser = r![Used By]\nSubmit = r![Submit]\nProcessed = r![Processed]\n\nIf Processed = True Then\n    r.Edit\n    r(\"Submit\").Value = False\n    r.Update\n    r.MoveNext\n    GoTo Begin\nElse\nEnd If\n\nr.Edit\nr(\"Processed\").Value = True\nr.Update\n\nr.Edit\nr(\"Submit\").Value = False\nr.Update\n\nr.MoveNext\n\nDim oOutlook As Outlook.Application\nDim oEmailItem As MailItem\n' prevent 429 error, if outlook not open\nOn Error Resume Next\nErr.Clear\nSet oOutlook = GetObject(, \"Outlook.application\")\nIf Err.Number &lt;&gt; 0 Then\nSet oOutlook = New Outlook.Application\nEnd If\n\nSet oEmailItem = oOutlook.CreateItem(olMailItem)\nWith oEmailItem\n.To = \"@email.com\"\n.CC = Me.Used_By\n.Subject = \"EmailTicket: [Subject]\"\n.Body = \"Equipment to be verified:\" &amp; Space(2) &amp; product &amp; vbCrLf &amp; \"Serial Number:\" &amp; Space(2) &amp; serial &amp; vbCrLf &amp; \"Agency:\" &amp; Space(2) &amp; agency &amp; vbCrLf &amp; \"User Name:\" &amp; Space(2) &amp; User &amp; vbCrLf &amp; vbCrLf &amp; \"By inserting the user name in the CC line the Customer Information on the Incident Customer tab will be auto-completed.  ONLY append information to the end of the SUBJECT LINE\"\n\n.Display\nEnd With\n\nr.MoveNext\n\nCheck:\nDo While r.EOF = False\n\n    NextComputer = r![Serial Number]\n    If (serial = NextComputer) Then\n        r.Edit\n        r(\"Submit\").Value = False\n        r.Update\n        r.Edit\n        r(\"Processed\").Value = True\n        r.Update\n        r.MoveNext\n        GoTo Check\n        Else\n        r.MovePrevious\n        End If\nLoop\nr.MovePrevious\n\nLoop\nr.Close\nSet r = Nothing\n\nDone:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455653077, "post_id": 35441547, "comment_id": 58581839, "body": "do you really want to paste the <b>entire row</b> from one sheet to the next, or just the columns with data for that row? I would think the latter is what you want, in which case setting the exact columns will help speed up your code."}, {"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1455653338, "post_id": 35441547, "comment_id": 58581997, "body": "Say it&#39;s Store #100. There are 30 appointments and 2 invoices. I want all Appointment and Invoice data (first 2 tabs) for Store #100. Store #125 may have 14 appointments and 10 invoices. What I didn&#39;t include in this question is that eventually, I am using a matching formula for the appointments and invoices on &quot;Sheet1&quot;. The question above is just asking how to get the data onto &quot;Sheet1&quot; SO I can match with my other formulas/scripts."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455652346, "post_id": 35441653, "comment_id": 58581427, "body": "Thank you so much for correcting the H:H error. That should speed it up greatly.  Same error message. Highlights the &quot;Rows&quot; in the following line: For Each i In sheet1.Range(&quot;H1&quot;, sheet1.Range(&quot;H&quot; &amp; sheet1.Rows.Count).End(xlUp))   ****I need to edit my original message because I realized I can use the same cell to paste. Delete the blank spaces above the &quot;Invoices&quot; data AFTER I paste. Ugh...Should have thought about this earlier!"}, {"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455652686, "post_id": 35441653, "comment_id": 58581626, "body": "Thanks Scott H.  But now it&#39;s a Sub or Function Not Defined error. What did I set wrong?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455652860, "post_id": 35441653, "comment_id": 58581723, "body": "@MMBInTraining on which line do you get the new error?"}, {"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455653097, "post_id": 35441653, "comment_id": 58581859, "body": "Set book = Workbooks(&quot;SampleWorkbookName&quot;) - Error:9 Subscript out of range  (Looks like it is referring to the A10000 range)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455653196, "post_id": 35441653, "comment_id": 58581911, "body": "@MMBInTraining no, if the error is on that line then you have typed the name wrong.  and Do a Scott said make sure you have the extension"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455653792, "post_id": 35441653, "comment_id": 58582231, "body": "@MMBInTraining I have tested this now and it works for me.  So I realize your code above is not for the actual situation.  Make sure that the data in H is a true number and not a string. If it is a string then see the edit I just made.  Another thing to do is create a stop in the code then hit F8 to go line by line through it and see what it is doing wrong on each line."}, {"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455653871, "post_id": 35441653, "comment_id": 58582270, "body": "Say I have 40 rows of data on the sheet &quot;All Invoices&quot;. The rows with the selected store is pasting on the correct sheet, but at row 41 because of this following line I think:  sheet2.Rows(Range(&quot;A10000&quot;).End(xlUp).Offset(1, 0).Row).Value = sheet1.Rows(i.Row).Value"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 0, "creation_date": 1455653976, "post_id": 35441653, "comment_id": 58582322, "body": "@MMBInTraining I missed a sheet reference in that line.  see edit, it should work now."}, {"owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "edited": false, "score": 1, "creation_date": 1455654231, "post_id": 35441653, "comment_id": 58582444, "body": "Thanks guys! You&#39;ve been a great help. I appreciate it. Marked your answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1455653943, "last_edit_date": 1455653943, "creation_date": 1455651722, "answer_id": 35441653, "question_id": 35441547, "link": "https://stackoverflow.com/questions/35441547/how-can-i-copy-paste-entire-rows-with-distinct-values-to-a-new-sheet-on-varyin/35441653#35441653", "title": "How can I copy &amp; paste entire rows with distinct values to a new sheet on varying cell ranges?", "body": "<p>Try this:</p>\n\n<pre><code>Sub CopyToNewSheetInv()\n\nDim i As Range\nDim book As Workbook\nDim sheet1 As Worksheet\nDim sheet2 As Worksheet\n\nSet book = Workbooks(\"SampleWorkbookName.xlsx\")\nSet sheet1 = book.Worksheets(\"AllInvoices\")\nSet sheet2 = book.Worksheets(\"Sheet1\")\n'iterate only thorugh those cells in H that have data, not all 1.04 million\nFor Each i In sheet1.Range(\"H1\", sheet1.Range(\"H\" &amp; sheet1.Rows.Count).End(xlUp))\n    Select Case i.Value\n        Case 1243,\"1243\"\n            sheet2.Rows(sheet2.Range(\"A10000\").End(xlUp).Offset(1, 0).Row).Value = sheet1.Rows(i.Row).Value\n        Case Else\n    End Select\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5128303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFQAY.jpg?s=128&g=1", "display_name": "MMBInTraining", "link": "https://stackoverflow.com/users/5128303/mmbintraining"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 35441653, "answer_count": 1, "score": 0, "last_activity_date": 1455653943, "creation_date": 1455651322, "last_edit_date": 1455652635, "question_id": 35441547, "link": "https://stackoverflow.com/questions/35441547/how-can-i-copy-paste-entire-rows-with-distinct-values-to-a-new-sheet-on-varyin", "title": "How can I copy &amp; paste entire rows with distinct values to a new sheet on varying cell ranges?", "body": "<p>I know there's many StackOverlow Q&amp;A's on copying &amp; pasting from a cell value in VBA. However, I can't seem to make it work for my own project. I want to copy the entire row(s) if it matches the Distinct Store# (non incremental) in Column H into a new sheet (in this code below, \"Sheet1\") which already has a template layout where I copy/paste the values. The template looks the same on every sheet before any data is filled in, except the first 2 tabs which have the data (\"Appointments\" and \"Invoices\"). \n<p>I came up with the VBA below, but here's the catch- the cell# that it pastes the row(s) (in the code below, \"A10\") changes based on the Store #. This is because I am copying rows from the 1st sheet (\"Appointments\") in the workbook from the distinct Store#, then deleting the empty rows above the area where the 2nd sheet (\"Invoices\") data goes. Some stores may return 10 rows or none at all. The Case, which is the Store #, is currently manually put in one by one. Should it be an array instead?\n<p> Anyway...I was hoping to automate the copying/pasting and loop for each store to their sheet. Maybe I'm going about this wrong, but would anyone be kind enough to suggest how to solve my error code <strong>\"Method or data member not found.\"</strong> as well as provide any suggestions on making my code better for a loop for filtered cell copying to different spots for each sheet. </p>\n\n<p>Simple explanation of my step by step process: <p>\n1.Filter Store # from \"Appointments\" sheet.\n<br>\n2. Copy all rows for that store and paste into a new sheet with template named \"Sheet1\" in B3. <br>\n3. Filter Store # from \"Invoices\" sheet. <br>\n4. Copy all rows for that store and paste into the previously made sheet named \"Sheet\" under the above rows. (Some stores do not have invoices, so this section is blank/NULL). Paste destination cell for \"Invoices\" will be different for each store# depending on how many rows they get from the \"Appointments\" sheet (could be A10 or A25). <br>\n5. LOOP- Next store #, next sheet (sheet2).</p>\n\n<pre><code>    Sub CopyToNewSheetInv()\n\n    Dim i As Range\n    Dim book As Workbooks\n    Dim sheet1 As Worksheets\n    Dim sheet2 As Worksheets\n\n    Set book = Workbooks(\"SampleWorkbookName\")\n    Set sheet1 = Worksheets(\"AllInvoices\")\n    Set sheet2 = Worksheets(\"Sheet1\")\n\n    For Each i In sheet1.Range(\"H:H\")\n\n    Select Case i.Value\n\n        Case 1243\n\n            sheet2.Range(\"A10\").End(xlUp).Offset(1, 0).EntireRow.Value = i.EntireRow.Value\n\n        Case Else\n\n    End Select\n\n    Next i\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1455650340, "creation_date": 1455650340, "answer_id": 35441229, "question_id": 35441116, "link": "https://stackoverflow.com/questions/35441116/apply-vba-code-on-specific-cells/35441229#35441229", "title": "Apply VBA Code on specific cells", "body": "<p>In <code>Write_Change</code> you can test your <code>cellAddress</code> to see if it's something you want to write about. For instance, if you only wanted to capture changed in <code>A1:F50</code> you could write:</p>\n\n<pre><code>If Not(Intersect(Me.Range(cellAddress), me.Range(\"A1:F50\")) IS NOTHING) Then\n    Write_Change = False\n    Exit Function\nEnd If\n</code></pre>\n\n<p>Or something along those lines. If your range of acceptable cells is made up of multiple areas, you can check out the <code>UNION</code> function to stitch them into a single range that you can test with that <code>IF Not(Intersect() Is Nothing))</code> logic.</p>\n"}], "owner": {"reputation": 23, "user_id": 5923202, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153347062941723/picture?type=large", "display_name": "Stefano Lazze&#39;", "link": "https://stackoverflow.com/users/5923202/stefano-lazze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 1, "accepted_answer_id": 35441229, "answer_count": 1, "score": 1, "last_activity_date": 1459950164, "creation_date": 1455649984, "last_edit_date": 1459950164, "question_id": 35441116, "link": "https://stackoverflow.com/questions/35441116/apply-vba-code-on-specific-cells", "title": "Apply VBA Code on specific cells", "body": "<p>I am using an audit trail to record changes effected on Sheet One and record them on Sheet 2. The code works fine however, I would like to restrict the code to run only on specific cells i.e. (A1:L100). The reason is that I have some workings from column M onwards and so I do not want to record any movements in these workings. Any suggestion on what to add/amend to the following code:</p>\n\n<pre><code>Option Explicit\nPublic dArr As Variant\nPrivate Sub Worksheet_Calculate()\nDim nArr As Variant\nDim auditRecord As Range\nDim i As Long\nDim j As Long\nnArr = Me.UsedRange\n 'Look for changes to the used range\nFor i = 1 To UBound(dArr, 2)\n    For j = 1 To UBound(dArr, 1)\n        If nArr(j, i) &lt;&gt; dArr(j, i) Then\n            'write to range\n            If Not Write_Change(dArr(j, i), nArr(j, i), Me.Cells(j, i).Address) Then\n                MsgBox \"The change was not recorded.\", vbInformation\n            End If\n        End If\n    Next j\nNext i\n\nErase nArr, dArr\ndArr = Me.UsedRange\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal target As Range)\nDim Cell As Range\nDim oldValue As Variant\n\nFor Each Cell In target\n    On Error Resume Next\n    oldValue = vbNullString\n    oldValue = dArr(Cell.Row, Cell.Column)\n    On Error GoTo 0\n    If oldValue &lt;&gt; Cell.Value Then\n        If Not Write_Change(oldValue, Cell.Value, Cell.Address) Then\n            MsgBox \"The change was not recorded.\", vbInformation\n        End If\n    End If\nNext Cell\n\nOn Error Resume Next\nErase dArr\nOn Error GoTo 0\n\ndArr = Me.UsedRange\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal target As Range)\ndArr = Me.UsedRange\nEnd Sub\n\nPublic Function Write_Change(oldValue, newValue, cellAddress As String) As     Boolean\nDim auditRecord As Range\nOn Error GoTo errHandler\nSet auditRecord = Sheets(\"ChangeHistory\").Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Offset(1, 0)\nWith auditRecord\n    .Value = cellAddress 'Address of change\n    .Offset(0, 1).Value = newValue 'new value\n    .Offset(0, 2).Value = oldValue 'previous value\n    .Offset(0, 3).NumberFormat = \"dd mm yyyy hh:mm:ss\"\n    .Offset(0, 3).Value = Now 'time of change\n    .Offset(0, 4).Value = Application.UserName 'user who made change\n    .Offset(0, 5).Value = Me.Range(\"D\" &amp; Split(cellAddress, \"$\")(2)).Value\nEnd With\nWrite_Change = True\nExit Function\nerrHandler:\nWrite_Change = False\nDebug.Print \"Error number: \" &amp; Err.Number\nDebug.Print \"Error descr: \" &amp; Err.Description\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1455650361, "post_id": 35441088, "comment_id": 58580317, "body": "<code>For Each curCell In Range(&quot;E6:E9,E15:E19,E21,E23&quot;).Cells</code> would work the same way"}, {"owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1455652750, "post_id": 35441088, "comment_id": 58581668, "body": "Thank you, Tim. I was trying to avoid having the cells referenced within the code so that it would be easier to debug for the next person taking over. I had forgotten that you could set up a non-contiguous range in this way. Thanks for the reminder!"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "edited": false, "score": 0, "creation_date": 1455652824, "post_id": 35441178, "comment_id": 58581710, "body": "Thank you, @tigeravatar ! This is exactly what I was looking for. I really appreciate the quick response."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 5, "last_activity_date": 1455650179, "creation_date": 1455650179, "answer_id": 35441178, "question_id": 35441088, "link": "https://stackoverflow.com/questions/35441088/how-do-i-use-loop-with-variable-range/35441178#35441178", "title": "How do I use Loop with Variable Range", "body": "<p>You need to use an array if you want a setup like that.   Here's how:</p>\n\n<p>Replace your variable declaration statement</p>\n\n<pre><code>'Instead of your original\n'Dim Range1 As Range, Range2 As Range, Range3 As Range, Range4 As Range\n\n'Use this:\nDim arrRanges(1 To 4) As Range\n</code></pre>\n\n<p>Then change how you set the ranges:</p>\n\n<pre><code>Set arrRanges(1) = ws.Range(\"E6:E9\")\nSet arrRanges(2) = ws.Range(\"E15:E19\")\nSet arrRanges(3) = ws.Range(\"E21\")\nSet arrRanges(4) = ws.Range(\"E23\")\n</code></pre>\n\n<p>And when you loop through them, it looks like this:</p>\n\n<pre><code>        For Each curCell In arrRanges(i).Cells\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "edited": false, "score": 0, "creation_date": 1455652896, "post_id": 35441296, "comment_id": 58581748, "body": "Thank you, @John Coleman . This is another good option. I had forgotten that you could assign non-contiguous ranges to a single variable. Thank you for the reminder and solution."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 4, "last_activity_date": 1455650525, "creation_date": 1455650525, "answer_id": 35441296, "question_id": 35441088, "link": "https://stackoverflow.com/questions/35441088/how-do-i-use-loop-with-variable-range/35441296#35441296", "title": "How do I use Loop with Variable Range", "body": "<p>You could assign an non-contiguous range to a range variable instead of using either 4 different range variables or an array of ranges (as @tigeravatar suggested in their excellent answer). Something like this:</p>\n\n<pre><code>Sub test()\n    Dim R As Range\n    Dim myCell As Range\n    Dim ws As Worksheet\n    Dim i As Long\n\n    Set ws = ActiveSheet\n    Set R = ws.Range(\"E6:E9,E15:E19,E21,E23\")\n    i = 1\n    For Each myCell In R.Cells\n        myCell.Value = i\n        i = i + 1\n    Next myCell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1455680845, "creation_date": 1455680845, "answer_id": 35447528, "question_id": 35441088, "link": "https://stackoverflow.com/questions/35441088/how-do-i-use-loop-with-variable-range/35447528#35447528", "title": "How do I use Loop with Variable Range", "body": "<p>I would go a step further and</p>\n\n<ul>\n<li>Look at each range inside the overall range.</li>\n<li>use a variant array to process the range (where the range area is more than one cell), then dump back to the range.</li>\n</ul>\n\n<p><em>code</em></p>\n\n<pre><code>Sub recut()\n    Dim rng1 As Range\n    Dim rng2 As Range\n    Dim lngCol As Long\n    Dim lngRow As Long\n    Dim ws As Worksheet\n\n    Set ws = ActiveSheet\n    Set rng1 = ws.Range(\"E6:E9,E15:E19,E21,E23\")\n\n    For Each rng2 In rng1.Areas\n        If rng2.Cells.Count &gt; 1 Then\n            x = rng2.Value\n            For lngRow = 1 To UBound(x)\n                For lngCol = 1 To UBound(x, 2)\n                    If IsNumeric(x(lngRow, lngCol)) Then x(lngRow, lngCol) = 0\n                Next\n            Next\n            rng2.Value2 = x\n        Else\n            If IsNumeric(rng2.Value) Then rng2.Value = 0\n        End If\n    Next rng2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 35441178, "answer_count": 3, "score": 1, "last_activity_date": 1455680845, "creation_date": 1455649903, "question_id": 35441088, "link": "https://stackoverflow.com/questions/35441088/how-do-i-use-loop-with-variable-range", "title": "How do I use Loop with Variable Range", "body": "<p>In the following code, when I get to for each curCell in Range(i) it is not able to understand the Range that I am referencing. I receive a Method 'Range' of Object'_worksheet' failed. I know the current Range(i) is incorrect, but I have tried every variation and nothing seems to work.</p>\n\n<p>Can someone please help me understand how to get my code to recognize Range1, then Range2, etc?    </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\nDim Range1 As Range, Range2 As Range, Range3 As Range, Range4 As Range\nDim curCell As Variant\nDim i As Integer\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(cCostingQSheet)\n\nSet Range1 = ws.Range(\"E6:E9\")\nSet Range2 = ws.Range(\"E15:E19\")\nSet Range3 = ws.Range(\"E21\")\nSet Range4 = ws.Range(\"E23\")\n\nFor i = 1 To 4\n\n    For Each curCell In Range(i).Cells\n\n        If Not WorksheetFunction.IsNumber(curCell) = True Then\n\n            curCell.Value = 0\n\n        Else\n\n        End If\n\n    Next\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1455650039, "post_id": 35440872, "comment_id": 58580141, "body": "Most likely only 2 criteria for &quot;does not contain&quot; is available in autofilter"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5894321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6848b187f2694943d10dda823f432905?s=128&d=identicon&r=PG&f=1", "display_name": "newmas", "link": "https://stackoverflow.com/users/5894321/newmas"}, "edited": false, "score": 0, "creation_date": 1455662538, "post_id": 35441355, "comment_id": 58586995, "body": "Dave, I didn&#39;t mention that there were 88,000 lines but running your loop after the rest of the filters works a treat."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1455650733, "creation_date": 1455650733, "answer_id": 35441355, "question_id": 35440872, "link": "https://stackoverflow.com/questions/35440872/in-exc-vba-can-i-filter-out-rows-that-have-r-f-u-in-an-alph-nmric-cell-eg-1f3u-c/35441355#35441355", "title": "In Exc vba can i filter out rows that have R/F/U in an alph/nmric cell eg 1F3U.Code ok if I put f and/or u but if I put the 3 in an array then zero", "body": "<p>You may have to create a loop to hide rows if you are using more than 2 criteria, for example, this will loop through column Z and hide rows that contain r,f,u.</p>\n\n<pre><code>Sub HideStuff()\n    Dim LstRw As Long, Rng As Range, C As Range\n\n    LstRw = Cells(Rows.Count, \"Z\").End(xlUp).Row\n    Set Rng = Range(\"Z2:Z\" &amp; LstRw)\n\n    For Each C In Rng.Cells\n        If C Like \"*f*\" Or C Like \"*u*\" Or C Like \"*r*\" Then\n            C.EntireRow.Hidden = 1\n        End If\n    Next C\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5894321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6848b187f2694943d10dda823f432905?s=128&d=identicon&r=PG&f=1", "display_name": "newmas", "link": "https://stackoverflow.com/users/5894321/newmas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455650733, "creation_date": 1455649218, "last_edit_date": 1531164843, "question_id": 35440872, "link": "https://stackoverflow.com/questions/35440872/in-exc-vba-can-i-filter-out-rows-that-have-r-f-u-in-an-alph-nmric-cell-eg-1f3u-c", "title": "In Exc vba can i filter out rows that have R/F/U in an alph/nmric cell eg 1F3U.Code ok if I put f and/or u but if I put the 3 in an array then zero", "body": "<p>Here is a sample of what I have tried so far</p>\n\n<pre><code>    .AutoFilterMode = False\n    .Range(\"A1:AW1\").AutoFilter Field:=26, Criteria1:=\"&lt;&gt;*f*\", Operator:=xlAnd,_ Criteria2:=\"&lt;&gt;*u*\" ' this works\n    .Range(\"A1:AW1\").AutoFilter Field:=26, Criteria1:=\"&lt;&gt;*f*\" 'this works\n    .Range(\"A1:AW1\").AutoFilter Field:=26, Criteria1:=Array_(\"&lt;&gt;*r*\", \"&lt;&gt;*f*\", \"&lt;&gt;*u*\") ' this doesn't\n</code></pre>\n"}]