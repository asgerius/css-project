[{"tags": ["arrays", "excel", "vba", "queue"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509581370, "post_id": 47065283, "comment_id": 81079355, "body": "It sounds like your &quot;unique value&quot; is just a user-specified formula in a 66th column.  (And Column 3 can&#39;t be both &gt; 25 <b>and</b> &lt; 25.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1509581377, "post_id": 47065283, "comment_id": 81079357, "body": "While @KenWhite is correct, assigning all of the values into a 2D array and subsequently processing &#39;in-memory&#39; is several factors faster then looping through rows and cells on a worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1509581498, "post_id": 47065283, "comment_id": 81079383, "body": "btw, if you have working code and require optimization, delete this post and repost at <a href=\"https://codereview.stackexchange.com/questions/tagged/excel\">code review</a>."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1509589131, "post_id": 47065283, "comment_id": 81081207, "body": "It seems you have 10 groups; with multiple rows within each group.  If that is the case, I would suggest that you work with a VBA array and a collection or dictionary object, where each item is a collection of the rows for the particular group.  You can then output in whatever fashion.  As @Jeeped writes, using VBA arrays is much faster than processing from the worksheet -- in my experience often 10x or more faster."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509589329, "post_id": 47065649, "comment_id": 81081252, "body": "Try this instead:  <code>Dim Level_Array_Unsort : Level_Array_Unsort = Range(cells(1,1), cells(LRL,LCL))</code>  No loops and will execute much faster. See Chip Pearsons <a href=\"http://www.cpearson.com/Excel/ArraysAndRan\" rel=\"nofollow noreferrer\">VBA Arrays and Worksheet Ranges</a>"}, {"owner": {"reputation": 350, "user_id": 3881822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/335a9ae9364e36c131fb599feaf0e540?s=128&d=identicon&r=PG&f=1", "display_name": "Conrad Addo", "link": "https://stackoverflow.com/users/3881822/conrad-addo"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509591275, "post_id": 47065649, "comment_id": 81081766, "body": "@RonRosenfeld makes sense, hwever if he wanted to filter data with an <b>IF</b> statement then maybe it can help to do it all in one loop when he takes in the data."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509591818, "post_id": 47065649, "comment_id": 81081902, "body": "I don&#39;t think so. You are doing one read vs <code>i*j</code> reads.  Read it all in, then loop through the array with the testing algorithm."}], "tags": [], "owner": {"reputation": 350, "user_id": 3881822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/335a9ae9364e36c131fb599feaf0e540?s=128&d=identicon&r=PG&f=1", "display_name": "Conrad Addo", "link": "https://stackoverflow.com/users/3881822/conrad-addo"}, "is_accepted": false, "score": 1, "last_activity_date": 1509582062, "creation_date": 1509582062, "answer_id": 47065649, "question_id": 47065283, "link": "https://stackoverflow.com/questions/47065283/excel-vba-should-i-use-arrays-or-a-queue-or-other-w-criteria-passed-as-paramet/47065649#47065649", "title": "Excel VBA Should I use Arrays or a Queue or Other? w/ Criteria passed as parameters", "body": "<p>An array/matrix is a good way to handle data in VBA. Here is the way that I store such data:</p>\n\n<pre><code>LRL = Cells(Rows.Count, 1).End(xlUp).Row 'COunts the rows\nLCL = Cells(2, Columns.Count).End(xlToLeft).Column 'Counts the columns\n\nReDim Level_Array_Unsort(LRL, LCL) 'Dimensionalizes the matrix\n\n'This stores the data\nFor i = 1 To LRL\n    For j = 1 To LCL\n        Level_Array_Unsort(i, j) = Cells(i, j)\n    Next j\nNext\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509582062, "creation_date": 1509579215, "last_edit_date": 1509580404, "question_id": 47065283, "link": "https://stackoverflow.com/questions/47065283/excel-vba-should-i-use-arrays-or-a-queue-or-other-w-criteria-passed-as-paramet", "title": "Excel VBA Should I use Arrays or a Queue or Other? w/ Criteria passed as parameters", "body": "<p>I have a data set with 2500 rows and 65 columns. I have a specific set of criteria than involves Greater/Less than <code>&gt;</code> / <code>&lt;</code> ,<code>AND</code>, <code>OR</code>, and <code>Like</code> Operators that needs to be evaluated on EACH row. </p>\n\n<p>For example:</p>\n\n<p>If Column 2 equals <code>1007001500</code> OR <code>1007000510</code> AND Column 3 <code>&gt; 25</code> AND <code>&lt; 25</code> AND Column 4 equals <code>\"asset\"</code> AND Column 5 equals <code>\"S\"</code> Then I need to assign a unique value for this row or in other words I need to classify this row into the 1 of 10 categories I have for this 2500 R x 65 C data set (which is an imported excel file).</p>\n\n<p>I am fairly familiar with 1D and 2D arrays and I have gotten to the point of importing all the Logic into either 1D or 2D array. I am at this point deciding whether to evaluate the logic in one long 1D Array String across 1 Row and 1 Column or a larger 2D array with each categories' logic segregated into a separate row within the 2D array.</p>\n\n<p>But I have also arrived at the question, <strong>is there a better data structure approach?</strong> I have briefly research Excel VBA <code>Queues</code> and have turned here for more expertise.</p>\n\n<p>My data set will always have the same Columns labels I can used to evaluate upon. However <strong>my logic criteria is always subject to change by the user of the macro.</strong> So I am looking for a way to basically pass all my criteria as parameters to a data structure.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1509582592, "last_edit_date": 1509582592, "creation_date": 1509579581, "answer_id": 47065327, "question_id": 47065203, "link": "https://stackoverflow.com/questions/47065203/why-does-my-for-each-statement-complete-in-its-entirety/47065327#47065327", "title": "Why does my For...Each statement complete in its entirety?", "body": "<p>You're pulling the rug under the <code>For Each</code> statement by deleting the row it is iterating on (<code>For Each</code> scans left to right, from the top row to the bottom row). Excel is nice enough to resume the iteration at \"next\" cell, which really is located on the row after the one it just deleted, and typically 1 cell to the right. But then, your code missed all of the leftmost cells on the new current row, some of which may fulfill your criteria.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>The issue can be circumvented by somehow taking note of the rows to delete, without deleting them within the <code>For Each</code> loop. My personal favorite way of doing so is to use a <code>Scripting.Dictionary</code>, as demonstrated below:</p>\n\n<pre><code>Sub ForEachWithRowDeleteDemo()\n    Dim rangeOfInterest As Excel.Range\n    Dim cell As Excel.Range\n    Dim dicRowIndexesToDelete As Object 'Scripting.Dictionary\n    Dim rowIndex As Variant\n\n    Set rangeOfInterest = Sheet1.Range(\"A1:Z10\") 'ASSUMPTION: rangeOfInterest is a contiguous range; no checks are made here.\n    Set dicRowIndexesToDelete = CreateObject(\"Scripting.Dictionary\")\n\n    For Each cell In rangeOfInterest.Cells\n        If cell.Value2 = 123 Then '...your conditions go here.\n            'Cumulate distinct row indexes.\n            dicRowIndexesToDelete(cell.Row - rangeOfInterest.Row + 1) = True\n        End If\n    Next\n\n    If dicRowIndexesToDelete.Count &gt; 0 Then\n        If rangeOfInterest.Cells.Count = 1 Then\n            'Exceptional case: rangeOfInterest is a single cell.\n            rangeOfInterest.EntireRow.Delete\n        Else\n            'Mark each of the range's rows.\n            rangeOfInterest.Clear\n            For Each rowIndex In dicRowIndexesToDelete.Keys\n                rangeOfInterest.Cells(rowIndex, 1) = True\n            Next\n\n            'Find the marks and delete the entire rows.\n            rangeOfInterest.SpecialCells(xlCellTypeConstants).EntireRow.Delete\n        End If\n    End If\n\n    Set dicRowIndexesToDelete = Nothing\n    Set cell = Nothing\n    Set rangeOfInterest = Nothing\nEnd Sub\n</code></pre>\n\n<p>Notice that all rows are deleted at once, for better performance. This will only work if there are no more than 8'192 separate \"islands\" of rows to delete; beyond that, the <code>SpecialCells</code> method would fail. The exceptional case of a single cell range of interest must be handled separately, since <code>SpecialCells</code> will consider the whole worksheet as its search zone if applied to a single cell.</p>\n"}, {"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 1, "last_activity_date": 1509583513, "last_edit_date": 1509583513, "creation_date": 1509583156, "answer_id": 47065786, "question_id": 47065203, "link": "https://stackoverflow.com/questions/47065203/why-does-my-for-each-statement-complete-in-its-entirety/47065786#47065786", "title": "Why does my For...Each statement complete in its entirety?", "body": "<p>This is a proof of concept that should work around the problem you're facing. Instead of deleting the rows in your <code>For Loops</code>, you could assign the <code>Row</code> to a 1-dimensional <code>Array</code>, then build a string and delete the rows all at once outside of your <code>Loop</code>.</p>\n\n<p><strong>Run this on a sheet with the first 7 rows filled out, then hit play and watch.</strong></p>\n\n<pre><code>Sub DeletingRows()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\n    Dim myArr(0 To 2) As Long\n    Dim myStr As String\n\n    myArr(0) = 2\n    myArr(1) = 4\n    myArr(2) = 6\n\n    For Each myRow In myArr\n        myStr = myStr &amp; myRow &amp; \":\" &amp; myRow &amp; \",\"\n    Next myRow\n\n    myStr = Left(myStr, Len(myStr) - 1)\n\n    ws.Range(myStr).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>How to integrate this into your code</strong></p>\n\n<p>Where <code>x</code> is a long starting at 0.</p>\n\n<pre><code>If myCL &lt;&gt; \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore And ws.Cells(r, C) Like myCL Then\n                myArr(x) = Cell.Row\n                x = x + 1\n            End If\n        End If\n    Next Cell\nElseIf myCL = \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore Then\n                myArr(x) = Cell.Row\n                x = x + 1\n            End If\n        End If\n    Next Cell\nEnd If\nFor Each myRow In myArr\n    myStr = myStr &amp; myRow &amp; \":\" &amp; myRow &amp; \",\"\nNext myRow\n\nmyStr = Left(myStr, Len(myStr) - 1)\n\nws.Range(myStr).Delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510013892, "post_id": 47068675, "comment_id": 81246205, "body": "This will work fine if there aren&#39;t too many rows to delete; <code>Union</code>&#39;s performance degrades geometrically when called in a loop."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1509644949, "last_edit_date": 1509644949, "creation_date": 1509602871, "answer_id": 47068675, "question_id": 47065203, "link": "https://stackoverflow.com/questions/47065203/why-does-my-for-each-statement-complete-in-its-entirety/47068675#47068675", "title": "Why does my For...Each statement complete in its entirety?", "body": "<p>Another method is, instead of adding the rows to an array, or looping backwards and deleting the rows one by one, is to define a <code>DelRng</code> as a <code>Range</code> object.</p>\n\n<p>Everytime, you pass your criteria, than you add that <code>Row</code> to the <code>DelRng</code> object, using the <code>Union</code> function, and at the end, you delete <code>DelRng</code> with one-shot.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim DelRng As Range  ' new range object, collects all rows that needs to be deleted\n\nIf myCL &lt;&gt; \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore And ws.Cells(r, C) Like myCL Then\n                ' add current row to DelRng\n                If Not DelRng Is Nothing Then\n                    Set DelRng = Application.Union(DelRng, .Rows(r))\n                Else\n                    Set DelRng = .Rows(r)\n                End If\n            End If\n        End If\n    Next cell\nElseIf myCL = \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore Then\n                ' add current row to DelRng\n                If Not DelRng Is Nothing Then\n                    Set DelRng = Application.Union(DelRng, .Rows(r))\n                Else\n                    Set DelRng = .Rows(r)\n                End If\n            End If\n        End If\n    Next cell\nEnd If\n\n' now delete the entire rows at once (will save you a lot of run-time)\nIf Not DelRng Is Nothing Then DelRng.Delete\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6576927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 47068675, "answer_count": 3, "score": 1, "last_activity_date": 1509644949, "creation_date": 1509578643, "last_edit_date": 1531164843, "question_id": 47065203, "link": "https://stackoverflow.com/questions/47065203/why-does-my-for-each-statement-complete-in-its-entirety", "title": "Why does my For...Each statement complete in its entirety?", "body": "<p>When the following code runs, it doesn't complete in its entirety. I usually have to run it a few more times to ensure all the data in that range has been inspected and the row deleted if it meets my criteria.</p>\n\n<pre><code>Const A% = 1\nConst B% = 2\nConst C% = 3\nConst D% = 4\n\n'Some code\n\nIf myCL &lt;&gt; \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore And ws.Cells(r, C) Like myCL Then\n                Cell.EntireRow.Delete\n            End If\n        End If\n    Next Cell\nElseIf myCL = \"\" Then\n    For Each Cell In RngB.Cells\n        If Cell.Value &lt;= myBal Then\n            r = Cell.Row\n            If ws.Cells(r, D) &lt;= myScore Then\n                Cell.EntireRow.Delete\n            End If\n        End If\n    Next Cell\nEnd If\n</code></pre>\n\n<p>I understand that I should loop through a range in reverse when using something like <code>For i = ## to 1 Step -1</code>, but I don't believe this would apply in this situation.</p>\n\n<p>My issue is that when <code>Cell</code> should meet the criteria, it sometimes skips over it, which I then rerun the code and it will be deleted.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1509574674, "post_id": 47064534, "comment_id": 81077327, "body": "instead of <code>And WorksheetFunction.CountA(Range(&quot;A&quot; &amp; i)) &lt;&gt; &quot;&quot;</code> just do <code>And Range(&quot;A&quot; &amp; i) &lt;&gt; &quot;&quot;</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1509578160, "post_id": 47065017, "comment_id": 81078443, "body": "THANK YOU for providing a solution that qualifies the parent worksheet!"}, {"owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "edited": false, "score": 0, "creation_date": 1509632345, "post_id": 47065017, "comment_id": 81103500, "body": "@Excelosaurus thanks for your help but when i run this macro i get an error message..however the dialogue that comes up is blank and doesn&#39;t say anything. any idea why this is happening"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509645548, "post_id": 47065017, "comment_id": 81112734, "body": "My bad. Add Exit Sub at the end of the Cleanup section. I&#39;ve edited my answer."}, {"owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "edited": false, "score": 0, "creation_date": 1509653735, "post_id": 47065017, "comment_id": 81117030, "body": "@Excelosaurus Thanks for your response. So this is still not deleting the rows...but could it be because those cells are formula-based?  For example, the cells in rows B-M pull from another sheet. So if it is &quot;0&quot; in the other sheet, it will be 0 on this sheet and I want to remove them.   Right now this code deletes all the rows that have cells in columns B-M that are blank and NOT-formula based."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509661342, "post_id": 47065017, "comment_id": 81120599, "body": "<code>CountA</code> does count cells containing formulas. Just modify the innermost <code>If</code> to suit your needs. If values are either all blank, or all positive, or all negative, you could use <code>Sum(...) = 0</code> as a delete condition (if there&#39;s a mix of positives and negatives, you run into the risk of getting a sum of zero). If the conditions are more complicated, you can add an innermost loop to scan the row&#39;s cells. You could also put a formula in your worksheet, say at column N, that would flag the rows to delete with a value that you&#39;d check for in the VBA."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1509645496, "last_edit_date": 1509645496, "creation_date": 1509577468, "answer_id": 47065017, "question_id": 47064534, "link": "https://stackoverflow.com/questions/47064534/delete-entire-rows-when-cells-in-multiple-columns-are-blank-or-0/47065017#47065017", "title": "Delete entire rows when cells in multiple columns are blank or 0", "body": "<p>Your conditions for row deletion are: column A not blank, columns B to M blank. Then something like this should do the trick:</p>\n\n<pre><code>Sub ScheduleA()\n    On Error GoTo errHandler\n\n    Const TOP_ROW As Long = 13\n    Const BOTTOM_ROW As Long = 33\n\n    Dim rowIndex As Long\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    With ThisWorkbook.Worksheets(\"Schedule A Template\")\n        For rowIndex = .Cells(BOTTOM_ROW, \"A\").End(xlUp).Row To TOP_ROW Step -1\n            If Not IsEmpty(.Cells(rowIndex, \"A\").Value2) Then '...column A is not blank.\n                If Application.WorksheetFunction.CountA(.Range(.Cells(rowIndex, \"B\"), .Cells(rowIndex, \"M\"))) = 0 Then '...all cells on row rowIndex from columns B to M are blank.\n                    .Rows(rowIndex).Delete Shift:=xlUp\n                End If\n            End If\n        Next\n    End With\n\nCleanup:\n    On Error Resume Next\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Exit Sub\n\nerrHandler:\n    MsgBox Err.Description, vbExclamation + vbOKOnly, \"Error\"\n    Resume Cleanup\nEnd Sub\n</code></pre>\n\n<p>Note that the <code>.Select</code> is gone; you almost never have to select anything to get the job done. Not relying on the selection will make your code much more robust. In the code above, the <code>With</code> block tells the code within it to refer to the target worksheet whenever an expression starts with a period, such as <code>.Cells</code>.</p>\n\n<p>Also, when turning off <code>ScreenUpdating</code> and <code>Calculation</code>, systematically include error handling to turn them back on. This way, if something goes wrong, your code won't leave Excel in an undesirable state.</p>\n\n<p>Finally, instead of referring to worksheets by their tab's name (as seen from Excel), you can refer to them directly using their CodeName, as seen from the VBA editor, in the Properties window, under the worksheet's (Name) property (press Ctrl+R to show the Project Explorer, click on the worksheet under the Microsoft Excel Objects node, then press F4 to display the Properties window). You can change this value; I'd typically change it to shtScheduleATemplate. Then, the <code>With</code> line could be re-written as:</p>\n\n<pre><code>With shtScheduleATemplate\n</code></pre>\n\n<p>...which would still work even after you changed the worksheet's name from Excel.</p>\n\n<p><strong>EDIT</strong>: in your question's code, you are checking column B when determining at which bottom row index to start the loop. However, by doing so, you may miss some rows that should be deleted. I've changed my answer to check within column A instead:</p>\n\n<pre><code>For rowIndex = .Cells(BOTTOM_ROW, \"A\").End(xlUp).Row To TOP_ROW Step -1\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509645496, "creation_date": 1509574526, "last_edit_date": 1509574588, "question_id": 47064534, "link": "https://stackoverflow.com/questions/47064534/delete-entire-rows-when-cells-in-multiple-columns-are-blank-or-0", "title": "Delete entire rows when cells in multiple columns are blank or 0", "body": "<p>I am trying to write a code which basically looks at rows 13-33 and deletes the entire row if the cells in Columns B-M are all Blank AND column A is NOT blank. </p>\n\n<p>The first code which I have written below deletes the entire row only if the cell in Column B is blank but I need all the cells in B-M to be blank in order to delete the entire row. </p>\n\n<pre><code>Sub scheduleA()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nSheets(\"Schedule A Template\").Select\n\nDim RowstoDelete As Long\nx = 33\nFor RowstoDelete = Cells(x, 2).End(xlUp).Row To 13 Step -1\n\nIf (Cells(RowstoDelete, 2).Value = \"0\") And (Cells(RowstoDelete, 1).Value &lt;&gt; \"\") Then\n        Rows(RowstoDelete).Delete Shift:=xlUp\n    End If\n\n\nNext RowstoDelete\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I tried writing it differently as well in the following code but can't achieve the desire result.</p>\n\n<pre><code>Sub DeleteRows()\n\n\nDim i As Integer\n\nFor i = 33 To 13 Step -1\n  If WorksheetFunction.CountA(Range(\"B\" &amp; i, \"M\" &amp; i)) = 0 And WorksheetFunction.CountA(Range(\"A\" &amp; i)) &lt;&gt; \"\" Then\n     Rows(i).EntireRow.Delete\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "excel", "split"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1509574566, "post_id": 47064484, "comment_id": 81077277, "body": "Just do another split on ary(1)"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1509574587, "post_id": 47064484, "comment_id": 81077283, "body": "Instead of splitting for the first event, use <code>Like</code>. Ex. <code>If v Like &quot;Name*&quot; then</code>...  You can then split from the colon."}], "answers": [{"comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 3, "creation_date": 1509574750, "post_id": 47064561, "comment_id": 81077363, "body": "you should add a check to ensure there is a hyphen or comma"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1509619950, "last_edit_date": 1509619950, "creation_date": 1509574635, "answer_id": 47064561, "question_id": 47064484, "link": "https://stackoverflow.com/questions/47064484/in-excel-using-vba-how-do-i-split-multiple-values-seperated-by-different-seperat/47064561#47064561", "title": "In Excel using VBA how do I split multiple values seperated by different seperators (ie: commas, colons, etc)", "body": "<p>You could do another split - not sure about name as there is no comma - but for licence. Incorporating a check that hyphen exists as suggested by @Sorceri. Strictly speaking you should do the same for colons too.</p>\n\n<pre><code>  If ary(0) = \"License\" Then\n     s2.Cells(K, 2) = Split(ary(1), \"-\")(0)        \n     If InStr(ary(1), \"-\") &gt; 0 Then\n        s2.Cells(K, 3) = Split(ary(1), \"-\")(1)\n    End If\n  End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8801756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba023f37e76e665fd360ccdc082c9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C.Nug", "link": "https://stackoverflow.com/users/8801756/c-nug"}, "edited": false, "score": 0, "creation_date": 1509640276, "post_id": 47064641, "comment_id": 81109451, "body": "Thank you very much, this works great!  I did/was going to split the first and last name, thank you for including that with you answer.  However, I am now struggling to separate the middle initial (if one exists).  It isn&#39;t a big issue, I can leave the middle initial, but for my edification, how would I achieve that split?  The middle initial is separated from the last name by a space and always ends with a period. ex: &quot;John Smith A.&quot;"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 33, "user_id": 8801756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba023f37e76e665fd360ccdc082c9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C.Nug", "link": "https://stackoverflow.com/users/8801756/c-nug"}, "edited": false, "score": 1, "creation_date": 1509640724, "post_id": 47064641, "comment_id": 81109736, "body": "You could do another split on the first name, using space <code>&quot; &quot;</code> as the delimiter. You could even check to verify it an initial using <code>If Len() = 1</code>. I forgot to add an explanation as to what the (1) after the splits were for, so I will update the answer to add some explanation."}, {"owner": {"reputation": 33, "user_id": 8801756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba023f37e76e665fd360ccdc082c9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C.Nug", "link": "https://stackoverflow.com/users/8801756/c-nug"}, "edited": false, "score": 0, "creation_date": 1509652018, "post_id": 47064641, "comment_id": 81116167, "body": "Perfect, this was such a great help and great explanation.  I appreciate your help!"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1509641312, "last_edit_date": 1509641312, "creation_date": 1509575157, "answer_id": 47064641, "question_id": 47064484, "link": "https://stackoverflow.com/questions/47064484/in-excel-using-vba-how-do-i-split-multiple-values-seperated-by-different-seperat/47064641#47064641", "title": "In Excel using VBA how do I split multiple values seperated by different seperators (ie: commas, colons, etc)", "body": "<p>Not sure if you wanted separate cells for a first name and last name, since you want to split it, but you can change <code>'YourRange</code> below if that is the case. You do not need to split the original string to an array, simply use <code>Like</code>, and the wildcard <code>*</code>.</p>\n\n<pre><code>Sub DataReOrganizer()\n\n    Dim s1, s2 As Worksheet\n    Dim Cook, i, K As Long\n    Dim v As String\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Sheet2\")\n    Cook = s1.Cells(Rows.Count, \"A\").End(xlUp).Row\n    K = 2\n    For i = 1 To Cook\n        v = s1.Cells(i, \"A\").text\n        If v = \"Contact Information\" Then\n            K = K + 1\n        Else\n            If v Like \"Name:*\" Then\n                'YourRange = Split(Split(v, \":\")(1), \",\")(0)    'Last Name\n                s2.Cells(K, 1) = Split(v, \",\")(1)               'First Name\n            End If\n            If v Like \"License:*\" Then s2.Cells(K, 2) = Split(v, \"-\")(1)\n            If v Like \"License Status:*\" Then s2.Cells(K, 3) = Split(v, \":\")(1)\n            If v Like \"City/State:*\" Then s2.Cells(K, 4) = Split(v, \":\")(1)\n            If v Like \"County:*\" Then s2.Cells(K, 5) = Split(v, \":\")(1)\n            If v Like \"Home Phone:*\" Then s2.Cells(K, 6) = Split(v, \":\")(1)\n            If v Like \"Work Phone:*\" Then s2.Cells(K, 7) = Split(v, \":\")(1)\n            If v Like \"Cell Phone:*\" Then s2.Cells(K, 8) = Split(v, \":\")(1)\n            If v Like \"Email Address:*\" Then s2.Cells(K, 9) = Split(v, \":\")(1)\n            If v Like \"Region:*\" Then s2.Cells(K, 10) = Split(v, \":\")(1)\n            If v Like \"Ever Been Disciplined?:*\" Then s2.Cells(K, 11) = Split(v, \":\")(1)\n            If v Like \"Note:*\" Then s2.Cells(K, 12) = Split(v, \":\")(1)\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You have a few options when using <code>Split()</code>. Commonly, it's used to add the splits to an array, such as you did. But you can skip the array altogether and return a single string by adding <code>(i)</code> to the end of the split. Example, if <code>i = 0</code>, you would return the entire string <em>prior</em> to the first delimiter. Likewise, <code>i = 1</code> would return the entire string after the first delimiter, <code>i = 2</code> would return everything after the 2nd, so on and so forth.</p>\n"}], "owner": {"reputation": 33, "user_id": 8801756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba023f37e76e665fd360ccdc082c9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C.Nug", "link": "https://stackoverflow.com/users/8801756/c-nug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 47064641, "answer_count": 2, "score": 0, "last_activity_date": 1509641312, "creation_date": 1509574220, "last_edit_date": 1509574495, "question_id": 47064484, "link": "https://stackoverflow.com/questions/47064484/in-excel-using-vba-how-do-i-split-multiple-values-seperated-by-different-seperat", "title": "In Excel using VBA how do I split multiple values seperated by different seperators (ie: commas, colons, etc)", "body": "<p>I am pulling data from the web into an excel spreadsheet.  All data is listed in column A, Sheet1. ex:</p>\n\n<pre><code>Name: Smith John A.\n\nLicense: General - Master\n\nLicense Status: Active\n\nCity/State: Anytown, USA\n\nCounty: Thatoneyouknow\n\nContact Information\n\nCell Phone: (555) 555-555\n\nEmail Address: johnsmith@johnsmith.com\n\nRegion: One\n\nEver Been Disciplined?: No\n\nNotes: None\n</code></pre>\n\n<p>And it then repeats similar info for the next person right after, etc.</p>\n\n<p>I have been able to split the text by the colon that separates the data using the code below:</p>\n\n<pre><code>Sub DataReOrganizer()\nDim s1, s2 As Worksheet\nDim Cook, i, K As Long\nDim v As String\nSet s1 = Sheets(\"Sheet1\")\nSet s2 = Sheets(\"Sheet2\")\nCook = s1.Cells(Rows.Count, \"A\").End(xlUp).Row\nK = 2\nFor i = 1 To Cook\n      v = s1.Cells(i, \"A\").Text\n      If v = \"Contact Information\" Then\n          K = K + 1\n      Else\n          ary = Split(v, \": \")\n          If ary(0) = \"Name\" Then s2.Cells(K, 1) = ary(1)\n          If ary(0) = \"License\" Then s2.Cells(K, 2) = ary(1)\n          If ary(0) = \"License Status\" Then s2.Cells(K, 3) = ary(1)\n          If ary(0) = \"City/State\" Then s2.Cells(K, 4) = ary(1)\n          If ary(0) = \"County\" Then s2.Cells(K, 5) = ary(1)\n          If ary(0) = \"Home Phone\" Then s2.Cells(K, 6) = ary(1)\n          If ary(0) = \"Work Phone\" Then s2.Cells(K, 7) = ary(1)\n          If ary(0) = \"Cell Phone\" Then s2.Cells(K, 8) = ary(1)\n          If ary(0) = \"Email Address\" Then s2.Cells(K, 9) = ary(1)\n          If ary(0) = \"Region\" Then s2.Cells(K, 10) = ary(1)\n          If ary(0) = \"Ever Been Disciplined?\" Then s2.Cells(K, 11) = ary(1)\n          If ary(0) = \"Note\" Then s2.Cells(K, 12) = ary(1)\n      End If\n    Next I\nEnd Sub\n</code></pre>\n\n<p>This works well so far by taking the data, separating the values into different columns with each new row as the next person in the list on sheet2.  However, to simplify things, is it possible to convert this code to separate the names by the commas too, same with the license field, but by the hyphen?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "selenium", "web", "web-scraping"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1509576764, "post_id": 47064406, "comment_id": 81078000, "body": "Can you post what the HTML surrounding that ID you&#39;re trying to find is?"}, {"owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "edited": false, "score": 0, "creation_date": 1509597037, "post_id": 47064406, "comment_id": 81083207, "body": "Can you share the demo credentials?"}, {"owner": {"reputation": 121, "user_id": 8828432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c529a50eae483c69091a3ddd42508?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8828432/steven"}, "edited": false, "score": 0, "creation_date": 1509659246, "post_id": 47064406, "comment_id": 81119667, "body": "Thank you for your response, I figured it out. I had to switch iframes in my code"}], "answers": [{"comments": [{"owner": {"reputation": 11632, "user_id": 8582353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2e22a564c1d0e098316210a2ec4fb1?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/8582353/yong"}, "edited": false, "score": 0, "creation_date": 1509598297, "post_id": 47064580, "comment_id": 81083576, "body": "agree with  SuperStew point, there should be frame in your page. check that, if so you need to switch to that frame before you operate element comes from that frame (you can think frame is another brower window, so you need to switch to it.)"}, {"owner": {"reputation": 121, "user_id": 8828432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c529a50eae483c69091a3ddd42508?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8828432/steven"}, "edited": false, "score": 0, "creation_date": 1509659292, "post_id": 47064580, "comment_id": 81119688, "body": "That was exactly it! I appreciate the help."}], "tags": [], "owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "is_accepted": true, "score": 0, "last_activity_date": 1509574724, "creation_date": 1509574724, "answer_id": 47064580, "question_id": 47064406, "link": "https://stackoverflow.com/questions/47064406/selenium-web-driver-nosuchelementerror/47064580#47064580", "title": "Selenium Web Driver: NoSuchElementError", "body": "<p>I can't access the exact page because I don't have a login, but in the past when I've had issues finding elements it's because they were in an iframe. You have to activate/select (don't remember the term Selenium uses) an iframe to access elements within it. Or at least that's what I did. </p>\n"}], "owner": {"reputation": 121, "user_id": 8828432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c529a50eae483c69091a3ddd42508?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8828432/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 47064580, "answer_count": 1, "score": 0, "last_activity_date": 1509574724, "creation_date": 1509573803, "question_id": 47064406, "link": "https://stackoverflow.com/questions/47064406/selenium-web-driver-nosuchelementerror", "title": "Selenium Web Driver: NoSuchElementError", "body": "<p>Salutations!</p>\n\n<p>I'm building a web scraper using Selenium Web Driver and Excel VBA. For a specific website, I'm unable to find elements on the webpage, though I'm able to login to the website using the web driver.</p>\n\n<p>Here's the website in question: </p>\n\n<pre><code> WebsiteURL = \"https://apps.availity.com/availity/web/public.elegant.login.HOME\"\n</code></pre>\n\n<p>Here's the code in question: </p>\n\n<pre><code> driver.FindElementByXPath(\"//*[@id='payerDropDown_chzn']\").Click\n</code></pre>\n\n<p>I've tried using byname, byname &amp; byclass but none of the methods are able to find the element. I also tested this on multiple elements on the page and it won't work.</p>\n\n<p>If you have any advice on how to find the elements, please let me know.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7570559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03283e530aeb3c19f2aa7174cabbc7c1?s=128&d=identicon&r=PG&f=1", "display_name": "gr33ns", "link": "https://stackoverflow.com/users/7570559/gr33ns"}, "edited": false, "score": 0, "creation_date": 1509720568, "post_id": 47064306, "comment_id": 81146724, "body": "I noticed you edited this, but the code you first put worked perfectly from what I could tell.  I was just wondering what the difference was and why this would be better?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71, "user_id": 7570559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03283e530aeb3c19f2aa7174cabbc7c1?s=128&d=identicon&r=PG&f=1", "display_name": "gr33ns", "link": "https://stackoverflow.com/users/7570559/gr33ns"}, "edited": false, "score": 0, "creation_date": 1509720660, "post_id": 47064306, "comment_id": 81146788, "body": "@gr33ns I just made it more readable by breaking it up into multiple lines using variables.  It works the same I just made it so one does not need to scroll left or right to see the code."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1509573698, "last_edit_date": 1509573698, "creation_date": 1509573257, "answer_id": 47064306, "question_id": 47064233, "link": "https://stackoverflow.com/questions/47064233/vba-sub-that-applies-a-formula-to-a-block-of-cells-except-left-most-column-and/47064306#47064306", "title": "VBA Sub that applies a formula to a block of cells, except left-most column and header row", "body": "<p>With R1C1 formula notation there is no need for autofill.</p>\n\n<pre><code>Sub A_B4()\n    Dim lr As Long\n    Dim lc As Long\n\n    With ActiveSheet\n        lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lc = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        .Range(\"B2\", .Cells(lr, lc)).FormulaR1C1 = \"=RC1&amp;\"\" \"\"&amp;R1C\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7570559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03283e530aeb3c19f2aa7174cabbc7c1?s=128&d=identicon&r=PG&f=1", "display_name": "gr33ns", "link": "https://stackoverflow.com/users/7570559/gr33ns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 47064306, "answer_count": 1, "score": 0, "last_activity_date": 1509573698, "creation_date": 1509572879, "question_id": 47064233, "link": "https://stackoverflow.com/questions/47064233/vba-sub-that-applies-a-formula-to-a-block-of-cells-except-left-most-column-and", "title": "VBA Sub that applies a formula to a block of cells, except left-most column and header row", "body": "<p>I'm trying to apply a formula to a block of cells, like the title says.</p>\n\n<p>Ultimately, I'd like the formula to only be applied to cells that have values in row 1 and column A.  </p>\n\n<p>I tried this, but quickly realized I was just applying the formula to every cell in the sheet except the left-most and header row.</p>\n\n<pre><code>Sub A_B4()\nApplication.CutCopyMode = False\nRange(\"B2\").Select\nActiveCell.Formula = \"=RC1&amp;\"\" \"\"&amp;R1C\"\nSelection.AutoFill Destination:=Range(Range(\"B2\"), Range(\"B2\").End(xlDown).End(xlToRight))\n\n\nEnd Sub\n</code></pre>\n\n<p>I think I need to use something along the line of this: </p>\n\n<pre><code>With .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n</code></pre>\n\n<p>Where it would count the amount of rows that have data in column A (except the header which that piece does not do), and apply the formula. Then count the amount of columns that have data in row 1, and apply the formula down.  But this is where I'm lost.  I feel like there should be an easier way rather than counting the columns in row 1 that contain data, converting that to a letter, then applying the formula.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1509572570, "post_id": 47063948, "comment_id": 81076496, "body": "Code that works but needs optimization belongs on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>  It is considered too broad here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1509580473, "post_id": 47063948, "comment_id": 81079121, "body": "This seems like it would be pretty fast unless you have hundreds of worksheets.  Using arrays is typically a good approach <i>compared to dealing with data cell-by-cell</i>, so your current approach seems fine to me."}, {"owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509602806, "post_id": 47063948, "comment_id": 81085156, "body": "I didn&#39;t even know what is a codereview! Cheers hombre"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1509572403, "creation_date": 1509572403, "answer_id": 47064113, "question_id": 47063948, "link": "https://stackoverflow.com/questions/47063948/stacking-several-ranges-into-a-dynamic-array/47064113#47064113", "title": "Stacking several ranges into a dynamic array", "body": "<p>With just about any code I use, I like to make a call to this routine I made:</p>\n\n<pre><code>Sub SpeedupCode(Optional ByVal Val As Boolean = True)\n\n    With Application\n        If Val = True Then\n            .ScreenUpdating = False\n            .Calculation = xlCalculationManual\n        Else\n            .ScreenUpdating = True\n            .Calculation = xlCalculationAutomatic\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>So, in your code you would simply use it as follows:</h2>\n\n<pre><code>Sub arrayCopyPaste()\n\n    Dim Obj As Range\n    Dim Data As Variant\n    Dim ws As Worksheet\n    Dim sheetCount As Integer\n    Dim LR As Integer\n\n    SpeedupCode\n\n    sheetCount = Sheets.Count\n\n    Set ws = Sheets.Add\n    ws.Move After:=Worksheets(Worksheets.Count)\n\n    For i = 1 To sheetCount\n        Data = Sheets(i).Range(\"A1:B9\")\n        LR = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n        Set Obj = ws.Range(\"A\" &amp; LR)\n        Set Obj = Obj.Resize(UBound(Data, 1), UBound(Data, 2))\n        Obj.Value = Data\n    Next i\n\n    SpeedupCode False\n\nEnd Sub\n</code></pre>\n\n<p>While this does not necessarily <em>optimize</em> your code, it can significantly improve the performance on every project that you do. In the event that your code requires a newly calculated variable in your worksheet, you can always use <code>Application.Calculate</code> before you grab that variable, but generally, it shouldn't be needed.</p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509602654, "post_id": 47064973, "comment_id": 81085100, "body": "What going on in this part?  <code>* IIf(stackRows, 1, sheetCount)</code>"}, {"owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "reply_to_user": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509609328, "post_id": 47064973, "comment_id": 81088246, "body": "Added a comment explaining. It&#39;s just a shorthand version of an IF statement."}, {"owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509609548, "post_id": 47064973, "comment_id": 81088382, "body": "Sorry I meant, is &quot;IIf&quot; a typo? I wouldn&#39;t think so because you&#39;ve used it twice, but it isn&#39;t Dim&#39;d either so I thought it could be something I&#39;ve not come across before"}, {"owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "reply_to_user": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509609717, "post_id": 47064973, "comment_id": 81088467, "body": "As I said, it&#39;s a shorthand version of an IF statement. &quot;If stackRows = True, multiply by one. Otherwise, multiply by the number of sheets&quot;. Just google &quot;VBA IIf&quot;."}, {"owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509612688, "post_id": 47064973, "comment_id": 81090101, "body": "That looks like Java syntax! Not seen IIf before! Cheers dude :)"}], "tags": [], "owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "is_accepted": false, "score": 2, "last_activity_date": 1509609233, "last_edit_date": 1509609233, "creation_date": 1509577221, "answer_id": 47064973, "question_id": 47063948, "link": "https://stackoverflow.com/questions/47063948/stacking-several-ranges-into-a-dynamic-array/47064973#47064973", "title": "Stacking several ranges into a dynamic array", "body": "<p>This version is slightly more efficient due to writing the results all at once, though you probably won't notice much of a difference unless you're working with very large ranges.</p>\n\n<pre><code>Sub test()\n\n    'Same as original: final array is 2 columns wide, (3 * number of sheets) rows long\n    Call mergeRangeValues(\"A1:B3\", \"Results\", True)\n\n    'Alternate version: final array is 3 rows long, (2 * number of sheets) columns wide\n    'Call mergeRangeValues(\"A1:B3\", \"Results\", False)\n\nEnd Sub\nSub mergeRangeValues(rngString As String, newWSName As String, stackRows As Boolean)\n'Merges the same range (rngString) from all sheets in a workbook\n'Adds them to a new worksheet (newWSName)\n'If stackRows = True, values are stacked vertically\n'If stackRows = False, values are stacked horizontally\n\n    Dim sheetCount As Long\n    Dim newWS As Worksheet\n    sheetCount = ThisWorkbook.Sheets.Count\n    Set newWS = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(sheetCount))\n    newWS.Name = newWSName\n\n    Dim numCols As Long\n    Dim numRows As Long\n    numCols = newWS.Range(rngString).Columns.Count * IIf(stackRows, 1, sheetCount)\n    numRows = newWS.Range(rngString).Rows.Count * IIf(stackRows, sheetCount, 1)\n    ReDim resultsArr(1 To numRows, 1 To numCols) As Variant\n    '''Longer version:\n    'If stackRows Then\n        'numCols = newWS.Range(rngString).Columns.Count\n        'numRows = newWS.Range(rngString).Rows.Count * sheetCount\n    'Else\n        'numCols = newWS.Range(rngString).Columns.Count * sheetCount\n        'numRows = newWS.Range(rngString).Rows.Count\n    'End If\n    '''ie \"If you want to stack the results vertically, make the array really long\"\n    '''or \"If you want to stack the results horizontally, make the array really wide\"\n\n    Dim i As Long\n    For i = 0 To sheetCount - 1\n        Dim tempArr As Variant\n        tempArr = ThisWorkbook.Sheets(i + 1).Range(rngString).Value\n        Dim j As Long\n        Dim k As Long\n        If stackRows Then\n            For j = LBound(tempArr, 1) To UBound(tempArr, 1)\n                For k = LBound(tempArr, 2) To UBound(tempArr, 2)\n                    resultsArr(j + i * (numRows / sheetCount), k) = tempArr(j, k)\n                Next\n            Next\n        Else\n            For j = LBound(tempArr, 1) To UBound(tempArr, 1)\n                For k = LBound(tempArr, 2) To UBound(tempArr, 2)\n                    resultsArr(j, k + i * (numCols / sheetCount)) = tempArr(j, k)\n                Next\n            Next\n        End If\n    Next\n\n    With newWS\n        .Range(.Cells(1, 1), .Cells(numRows, numCols)).Value = resultsArr\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "edited": false, "score": 0, "creation_date": 1509602310, "post_id": 47065473, "comment_id": 81084952, "body": "boiled down? That&#39;s Incredible I had no idea you could cram so much into one line!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1509580859, "creation_date": 1509580859, "answer_id": 47065473, "question_id": 47063948, "link": "https://stackoverflow.com/questions/47063948/stacking-several-ranges-into-a-dynamic-array/47065473#47065473", "title": "Stacking several ranges into a dynamic array", "body": "<p>I'd be inclined to use your current approach and just boil it down a bit.</p>\n\n<pre><code>Sub arrayCopyPaste()\n\n    Dim ws As Worksheet\n\n    Set ws = Sheets.Add(After:=Worksheets(Worksheets.Count))\n\n    For i = 1 To Sheets.Count - 1\n        With Sheets(i).Range(\"A1:B9\")\n            ws.Cells(ws.Rows.Count, 1).End(xlUp).Offset(1, 0).Resize( _\n                        .Rows.Count, .Columns.Count).Value = .Value\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1509609233, "creation_date": 1509571669, "question_id": 47063948, "link": "https://stackoverflow.com/questions/47063948/stacking-several-ranges-into-a-dynamic-array", "title": "Stacking several ranges into a dynamic array", "body": "<p>Hopefully i've phrased that right...</p>\n\n<p>I came across something online stating that copy and pasting wastes precious time. It's better to assign values more directly, without using excel functions.</p>\n\n<p>I found a section in a VBA book explaining how to store a range in a 2D array.</p>\n\n<p>Now what if I wanted to copy and paste a range from a dynamic number of worksheets into another one main sheet with this method?</p>\n\n<p>In my head, I imagine stacking more and more values into an array, then dumping the array where I'd like it to go, into a range whose size is defined by the dimensions of the big array.</p>\n\n<p>In practice, all I have managed to create is something like the below, performing the same simple action for each worksheet in turn.</p>\n\n<p>Is it possible to do this better? That runs faster? Help a brother out!</p>\n\n<pre><code>Sub arrayCopyPaste()\n\nDim Obj As Range\nDim Data As Variant\nDim ws As Worksheet\nDim sheetCount As Integer\nDim LR As Integer\n\nsheetCount = Sheets.Count\n\nSet ws = Sheets.Add\nws.Move After:=Worksheets(Worksheets.Count)\n\nFor i = 1 To sheetCount\n    Data = Sheets(i).Range(\"A1:B9\")\n    LR = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n    Set Obj = ws.Range(\"A\" &amp; LR)\n    Set Obj = Obj.Resize(UBound(Data, 1), UBound(Data, 2))\n    Obj.Value = Data\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "checkbox", "textbox"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8870251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f4423465c0057bab19792fa8824a18?s=128&d=identicon&r=PG&f=1", "display_name": "BryanivaD", "link": "https://stackoverflow.com/users/8870251/bryanivad"}, "edited": false, "score": 0, "creation_date": 1509630819, "post_id": 47075131, "comment_id": 81102431, "body": "Thank you so much for replying! The output example you gave is exactly what I&#39;m looking for. I added the snippet you provided and it&#39;s giving me an error. I imagine this is because the textboxes aren&#39;t differentiated yet. I am going to research the isnumeric and passing the textbox as an argument options and try to make this work. Though, admittedly it&#39;s like a shot in the dark.  I sincerely appreciate your guidance, as this is a giant leap in the right direction."}], "tags": [], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "is_accepted": true, "score": 0, "last_activity_date": 1509625125, "creation_date": 1509625125, "answer_id": 47075131, "question_id": 47063771, "link": "https://stackoverflow.com/questions/47063771/excel-userform-vba-combine-checkbox-textbox-into-a-single-cell-string/47075131#47075131", "title": "Excel Userform/VBA Combine CheckBox &amp; TextBox into a single cell string", "body": "<p>So, if I understand you correctly, You want the output of the Mistakes cell to read</p>\n\n<pre><code>[Caption of checked box](x[Number in Text Box])|[Caption of checked box](x[Number in Text Box])...\n</code></pre>\n\n<p>If that is so, you simply need to add a snippet of code to the end of your 'Mistakes' variable so that it reads:</p>\n\n<pre><code>Mistakes = Mistakes &amp; delimiter &amp; Checkbox.Caption &amp; \"(x\" &amp; TextBox.text &amp; \")\"\n</code></pre>\n\n<p>Where things get difficult is that you will need to differentiate between text boxes so that only the one that applies to the relevant checkbox is being used. You could do this in a number of ways, such as passing the Textbox as an argument, or with a switch case to name a few. </p>\n\n<p>Another problem is making sure that the textbox only uses numbers. The way that I accomplish this is with a combination of the <code>IsNumeric()</code> and <code>Val()</code> functions. You first check if the value is numeric, then store it in an int using the <code>Val()</code> function. Since you only need it for a string, though, using the <code>IsNumeric()</code> function alone should be fine.</p>\n\n<p>If you need more specific clarification, I would need to know exactly what you are looking for. </p>\n"}], "owner": {"reputation": 3, "user_id": 8870251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f4423465c0057bab19792fa8824a18?s=128&d=identicon&r=PG&f=1", "display_name": "BryanivaD", "link": "https://stackoverflow.com/users/8870251/bryanivad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 47075131, "answer_count": 1, "score": 0, "last_activity_date": 1509625125, "creation_date": 1509570849, "last_edit_date": 1509571482, "question_id": 47063771, "link": "https://stackoverflow.com/questions/47063771/excel-userform-vba-combine-checkbox-textbox-into-a-single-cell-string", "title": "Excel Userform/VBA Combine CheckBox &amp; TextBox into a single cell string", "body": "<p>A little background about what I'm trying to do:\nMy userform is going to be used to grade employee training with the results being added to an excel spreadsheet. The checkboxes in my form are representative of the different kinds of mistakes they can make and each mistake ideally has a quantity box that will specify how many times each mistake was made if its box is checked. I need both in one cell, as each row is 1 test for each employee. Here is an example of my userform:\n<a href=\"https://i.stack.imgur.com/xQRsn.png\" rel=\"nofollow noreferrer\">Mistakes Screen Shot</a></p>\n\n<p>All checkboxes and textboxes share the same number and I've already programmed them to automatically insert a 1 quantity if the box is checked/empty if unchecked. (Of course the quantity must be editable in case a mistake type is duplicated.)</p>\n\n<p>So far I was able to use a loop with a string to get the checkboxes to put their captions into the single cell using this code:</p>\n\n<pre><code>Dim CheckBox As Control\nDim Mistakes As String, delimiter As String\n\nFor Each CheckBox In Me.Frame_Mistakes.Controls\n    If TypeOf CheckBox Is MSForms.CheckBox Then\n        If (CheckBox.Value) Then\n            Mistakes = Mistakes &amp; delimiter &amp; CheckBox.Caption\n            delimiter = \" | \"\n        End If\n    End If\nNext\n\nWith Sheet1\n    .Cells(emptyRow, 4).Value = Mistakes\nEnd With\n</code></pre>\n\n<p>However, so far I have been unable to figure out how to get the quantity to be added at the end of each mistake preceding the delimiter. I would prefer it if I could get the string to be in this format: <a href=\"https://i.stack.imgur.com/cWhBT.png\" rel=\"nofollow noreferrer\">Mistakes Format in Excel</a> </p>\n\n<p>If my intentions are unclear, I apologize. I am incredibly new and honestly surprised I was able to make it this far. Please and Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509570351, "post_id": 47063554, "comment_id": 81075484, "body": "<code>xRg(K).Selection.Copy Destination:=Worksheets(&quot;B90_Projects_Archived&quot;).Range(&quot;A&quot; &amp; J + 1)</code> is attempting to copy a Selection and you don&#39;t have anything selected in your code... Unless you&#39;re manually selecting it and then running the macro?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1509570652, "post_id": 47063554, "comment_id": 81075626, "body": "remove <code>On Error Resume Next</code> and debug your code line-by-line, you&#39;ll find out <b>very quickly</b> what your issue is. If you can&#39;t solve update your question with something more specific (i.e. - line of error and what you have tried to solve issue). You also need to loop backwards through a range when also deleting rows from the range."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509587374, "post_id": 47063554, "comment_id": 81080820, "body": "this line <code>xRg(K).Selection.Copy ....</code> throws error 438 .... your code cannot possibly work because of it"}], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1509570652, "last_edit_date": 1509570652, "creation_date": 1509570319, "answer_id": 47063651, "question_id": 47063554, "link": "https://stackoverflow.com/questions/47063554/macro-does-not-execute-completely/47063651#47063651", "title": "Macro does not execute completely", "body": "<p>Because you're decrementing your <code>K</code> variable within the FOR loop, which is also incrementing it.  Your K variable never changes.  Comment out <code>K = K - 1</code> and report back?</p>\n\n<p>If you're doing that on purpose to evaluate / delete a single line and shift the next values up then you might want to have a <code>K2</code> variable that you increment like this:</p>\n\n<pre><code>For K = 1 To xRg.Count\n    If CStr(xRg(K - K2).Value) = \"Closed\" And CStr(yRg(K - K2).Value) &lt;&gt; \"\" Then\n        xRg(K - K2).Selection.Copy Destination:=Worksheets(\"B90_Projects_Archived\").Range(\"A\" &amp; J + 1)\n        xRg(K - K2).EntireRow.Delete\n        If CStr(xRg(K - K2).Value) = \"Closed\" Then\n            K2 = K2 + 1\n        End If\n        J = J + 1\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8838595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213724308596491/picture?type=large", "display_name": "HLB", "link": "https://stackoverflow.com/users/8838595/hlb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509570652, "creation_date": 1509569840, "last_edit_date": 1509570560, "question_id": 47063554, "link": "https://stackoverflow.com/questions/47063554/macro-does-not-execute-completely", "title": "Macro does not execute completely", "body": "<p>I have been working on a macro that Archives: it selects rows with the right cell value and move them to another tab (while deleting the rows in the tab of origin).</p>\n\n<p>My macro was working perfectly fine, but I decided to change my file and have different new tabs. When I computed my Macro in my new tabs, and it works on the right rows, and deletes them, but does not copy them in my \"Archive tab\" :</p>\n\n<pre><code> Sub Archive_Ongoing()\n\nTest 2 : works for 2 arguments.\n\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim I As Long\n    Dim J As Long\n    Dim K As Long\n    I = Worksheets(\"B90_Projects_OnGoing\").UsedRange.Rows.Count\n    J = Worksheets(\"B90_Projects_Archived\").UsedRange.Rows.Count\n\n    If J = 1 Then\n       If Application.WorksheetFunction.CountA(Worksheets(\"B90_Projects_Archived\").UsedRange) = 0 Then J = 0\n    End If\n    Set xRg = Worksheets(\"B90_Projects_OnGoing\").Range(\"O1:O\" &amp; I)\n    Set yRg = Worksheets(\"B90_Projects_OnGoing\").Range(\"T1:T\" &amp; I)\n    On Error Resume Next\n        Application.ScreenUpdating = False\n    For K = 1 To xRg.Count\n        If CStr(xRg(K).Value) = \"Closed\" And CStr(yRg(K).Value) &lt;&gt; \"\" Then\n            xRg(K).Selection.Copy Destination:=Worksheets(\"B90_Projects_Archived\").Range(\"A\" &amp; J + 1)\n            xRg(K).EntireRow.Delete\n            If CStr(xRg(K).Value) = \"Closed\" Then\n                K = K - 1\n            End If\n            J = J + 1\n        End If\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub'\n</code></pre>\n\n<p>Any one would be able to explain why?</p>\n"}, {"tags": ["excel", "vba", "do-loops"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1509569467, "post_id": 47063417, "comment_id": 81075040, "body": "you need to  specify the Parent sheet of the range <code>worksheets(&quot;Sheet1&quot;).Range(&quot;A2&quot;)</code>"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509569657, "post_id": 47063417, "comment_id": 81075129, "body": "Hi Scott Craner- Thanks for your response. I actually call this module- so in the main it looks like <code>sub test() worksheets(&quot;All Data&quot;).activate call module.findkeywords call module.othermodule call module.othermodule2 (etc) end sub</code> does that work okay, or should I re-specify?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1509569856, "post_id": 47063417, "comment_id": 81075239, "body": "One should always avoid <code>.Activate</code> and <code>.Select</code> and just specify the parents directly.  Your loop should be a for loop and not a Do loop.  Find the last row and loop through that.  It is even better practice to use arrays."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509570182, "post_id": 47063417, "comment_id": 81075411, "body": "Could you explain how I would specify the parents in the call statement without using activate or select? I didn&#39;t know there was another way. And as far as the for loop- how do I specify the last blank cell when this is a range that could change? (Ex. B1 to B4 or other times B1 to B70) I realize Stack Overflow is not to have people just write the whole code for me, but a little more specification would definitely help me get started. Thank you for your help!"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509570584, "post_id": 47063417, "comment_id": 81075591, "body": "Update: I see now that you can &quot;Set&quot; a worksheet or range. I can do that. I am still a little confused on how a for loop would work for this though."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1509570975, "post_id": 47063707, "comment_id": 81075759, "body": "That worked! Thank you so much Angel. I wonder why the selection of the workbook and sheet before calling this module didnt translate into it though. Maybe what Scott Craner said about trying to Set it would work."}, {"owner": {"reputation": 90, "user_id": 4086152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cca8eb7762bf4975b6a1bcea30284b4?s=128&d=identicon&r=PG&f=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/4086152/angel"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 1, "creation_date": 1509571602, "post_id": 47063707, "comment_id": 81076028, "body": "Welcome, glat to hear it helped! Thanks for your feedback :)"}], "tags": [], "owner": {"reputation": 90, "user_id": 4086152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cca8eb7762bf4975b6a1bcea30284b4?s=128&d=identicon&r=PG&f=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/4086152/angel"}, "is_accepted": true, "score": 1, "last_activity_date": 1509570587, "creation_date": 1509570587, "answer_id": 47063707, "question_id": 47063417, "link": "https://stackoverflow.com/questions/47063417/excel-vba-my-code-runs-fine-by-itself-but-within-a-bigger-code-does-not/47063707#47063707", "title": "Excel VBA - My code runs fine by itself, but within a bigger code, does not", "body": "<p>Since you mention that the code doesn't seems to \"see\" the value in the cell which in your code is introduced by</p>\n\n<pre><code>Range(\"A2\").activate\n</code></pre>\n\n<p>I would try to replace this with the full reference of the cell which would be something like: </p>\n\n<pre><code>Application.Workbooks(\"book1\").Worksheets(\"Sheet1\").Range(\"A2\").Activate\n</code></pre>\n\n<p>Replace book1 with your file name and Sheet1 with your worksheet.\nMy assumption is that Range(\"A2\").Activate activates A2 on some other sheet but cannot be sure unless see the whole code.\nHope that helps ;)</p>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 47063707, "answer_count": 1, "score": 1, "last_activity_date": 1509570587, "creation_date": 1509569272, "question_id": 47063417, "link": "https://stackoverflow.com/questions/47063417/excel-vba-my-code-runs-fine-by-itself-but-within-a-bigger-code-does-not", "title": "Excel VBA - My code runs fine by itself, but within a bigger code, does not", "body": "<p>I have a do loop that uses an array to find Keywords within a cell and replaces them with their corresponding MachineNames array value. When I run this by itself, it works perfectly. When I run it within a bigger code, it does appear to loop through each of the array items (I used breakpoints to watch this), but for some reason it no longer \"sees\" the value in the cell. It simply loops through all the Keywords, decides none of them were found (even if one is in the cell)... any thoughts or help is appreciated!</p>\n\n<pre><code>'MACHINENAME (if it is written in the description.)\nDim Keywords As Variant\nDim MachineNames As Variant\n\nKeywords = Array(\"Robot\", \"Robot 1\", \"Robot 2\", \"Robot 3\", \"Robot 4\", \"Robot 5\", \"Robot 6\", \"FA \", \"FA 1\", \"FA1\", \"FA 2\", \"FA2\", \"FA 3\", \"FA3\", \"FA 4\", \"FA4\", \"FA 5\", \"FA5\", \"FA 6\", \"FA6\", \"FA 7\", \"FA7\", \"FA 8\", \"FA8\", \"FA 9\", \"FA9\", \"FA 10\", \"FA10\", \"FA 11\", \"FA11\", \"FA 12\", \"FA12\", \"Sta120\", \"Sta95\", \"Sta90C\", \"Sta 120\", \"Sta 95\", \"Sta 90C\", \"St120\", \"St95\", \"St90C\", \"St 120\", \"St 95\", \"St 90C\", \"Flex Arc\", \"Flex Arch\", _\n    \"Hammond\", \"Acme\", \"Polish\", \"SAM\", \"Tank\", \"Fender\", \"Welder\", \"Balance\", \"PICO\", \"Gravity\", \"Vin Mark\", \"Vin Stamp\", \"Telesis\", \"Pinstamp\", \"Pin stamp\", \"Buff\", \"Wet\", \"E-Coat\", \"E Coat\", \"Ecoat\", \"Carrier\", \"Line\", \"Line 1\", \"Line1\", \"Line 2\", \"Line2\", \"Line 3\", \"Line3\", \"Line 4\", \"Line4\", \"Line 5\", \"Line5\", \"Line 6\", \"Line6\", _\n    \"Sta100\", \"Sta30\", \"Sta150\", \"Sta 100\", \"Sta 30\", \"Sta 150\", \"St100\", \"St30\", \"St150\", \"St 100\", \"St 30\", \"St 150\", \"Laser\", \"Laser 1\", \"Laser1\", \"Laser 2\", \"Laser2\", \"Laser 3\", \"Laser3\", \"Laser 4\", \"Laser4\", \"Laser 5\", \"Laser5\", \"Laser 6\", \"Laser6\", \"Laser Seamer\", \"Laser Seam\", \"Laser Seemer\", \"Vin Laser\", \"Monode\", \"Sub\", _\n    \"Tip\", \"Tip Change\", \"Press \", \"Swingarm Press\", \"Swing arm Press\", \"Bearing Press\", \"Medallion Press\", \"Footboard Press\", \"AIDA\", \"AIDA Press\", \"Cushion\", \"Press 1\", \"Press1\", \"Press 2\", \"Press2\", \"Press 3\", \"Press3\", \"Press 4\", \"Press4\")\n\nMachineNames = Array(\"Robot\", \"Robot 1\", \"Robot 2\", \"Robot 3\", \"Robot 4\", \"Robot 5\", \"Robot 6\", \"FA\", \"FA 1\", \"FA 1\", \"FA 2\", \"FA 2\", \"FA 3\", \"FA 3\", \"FA 4\", \"FA 4\", \"FA 5\", \"FA 5\", \"FA 6\", \"FA 6\", \"FA 7\", \"FA 7\", \"FA 8\", \"FA 8\", \"FA 9\", \"FA 9\", \"FA 10\", \"FA 10\", \"FA 11\", \"FA 11\", \"FA 12\", \"FA 12\", \"FA 4\", \"FA 3\", \"FA 10\", \"FA 4\", \"FA 3\", \"FA 10\", \"FA 4\", \"FA 3\", \"FA 10\", \"FA 4\", \"FA 3\", \"FA 10\", \"FA\", \"FA\", _\n    \"Polish (Hammond)\", \"Polish (Acme)\", \"Polish\", \"SAM\", \"Tank\", \"Fender\", \"Welder\", \"Balance\", \"PICO\", \"Gravity\", \"Vin Stamp\", \"Vin Stamp\", \"Pinstamp\", \"Pinstamp\", \"Pinstamp\", \"Buff\", \"Wet\", \"E-Coat\", \"E-Coat\", \"E-Coat\", \"Carrier\", \"Line\", \"Line 1\", \"Line 1\", \"Line 2\", \"Line 2\", \"Line 3\", \"Line 3\", \"Line 4\", \"Line 4\", \"Line 5\", \"Line 5\", \"Line 6\", \"Line 6\", _\n    \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser\", \"Laser 1\", \"Laser 1\", \"Laser 2\", \"Laser 2\", \"Laser 3\", \"Laser 3\", \"Laser 4\", \"Laser 4\", \"Laser 5\", \"Laser 5\", \"Laser 6\", \"Laser 6\", _\n    \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Seamer)\", \"Laser (Vin)\", \"Laser (Monode)\", \"Sub\", \"Tip\", \"Tip\", \"Press\", \"Press (Swingarm)\", \"Press (Swingarm)\", \"Press (Bearing)\", \"Press (Medallion)\", \"Press (Footboard)\", \"Press (AIDA)\", \"Press (AIDA)\", \"Press\", \"Press 1\", \"Press 1\", \"Press 2\", \"Press 2\", \"Press 3\", \"Press 3\", \"Press 4\", \"Press 4\")\n\nRange(\"A2\").activate 'the cell to look in for the keyword\n\nDo Until ActiveCell.Offset(0, 10) &lt;&gt; \"\" 'the cell we are placing the found MachineName Value in (or blank if none are found.) We will eventually hit previous data, so it will stop if this cell is not blank.\n    For i = 0 To UBound(Keywords)\n                    Set C = ActiveCell.Find(Keywords(i), LookIn:=xlValues)\n            If Not C Is Nothing Then ActiveCell.Offset(0, 10).Value = MachineNames(i) \n    Next i\n    ActiveCell.Offset(1, 0).activate\nLoop\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1509568592, "post_id": 47063213, "comment_id": 81074650, "body": "Have you tried to store the column value in an Array?"}, {"owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "edited": false, "score": 0, "creation_date": 1509568869, "post_id": 47063213, "comment_id": 81074777, "body": "@DavidG. Only 1 day into learning VBA so not sure what you mean :) Each column has 51 values so what are you referencing to store?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1509572738, "creation_date": 1509572738, "answer_id": 47064204, "question_id": 47063213, "link": "https://stackoverflow.com/questions/47063213/return-only-one-record-with-column-indicator-from-an-array-in-vba/47064204#47064204", "title": "Return only one record with column indicator from an array in VBA", "body": "<p>You are already using an array, so you can declare a different array to store the columns. I will use part of your code.</p>\n\n<p>First, declare another array:</p>\n\n<pre><code>Dim Columns (0) as Integer\n</code></pre>\n\n<p>Using your code:</p>\n\n<pre><code>If Abs(Arr1(row_num, column_num)) &gt; 0.0001 Then\n    strTieOutMsg = strTieOutMsg &amp; Chr(13) &amp; \"Failure\"\n    'Increase your Columns array\n     ReDim Columns (ubound(arr, 1) + 1)\n    'Store the colum_num in your Columns Array\n    Columns (ubound(arr, 1)) = column_num\nEnd If\n</code></pre>\n\n<p>This way your columns values are being stored in <code>Columns</code> Array.</p>\n"}], "owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509572738, "creation_date": 1509568387, "question_id": 47063213, "link": "https://stackoverflow.com/questions/47063213/return-only-one-record-with-column-indicator-from-an-array-in-vba", "title": "Return only one record with column indicator from an array in VBA", "body": "<p>The following code steps through every cell to check for &lt;> 0 in this array (I specifically don't want to sum). How can I limit output to just list the column letters where this occurs at least once.</p>\n\n<pre><code>Dim Arr1() As Variant\nDim num_rows As Long, num_columns As Long\nDim column_num As Long, row_num As Long\nDim strTieOutMsg As String\nWith ThisWorkbook.Worksheets(\"Tie Out\")\n    ThisWorkbook.Worksheets(\"Tie Out\").Select\n    Arr1 = ThisWorkbook.Worksheets(\"Tie Out\").Range(\"B15:CG66\").Value\n    num_columns = UBound(Arr1, 2)\n    num_rows = UBound(Arr1, 1)\n    For column_num = 1 To num_columns\n        For row_num = 1 To num_rows\n            If Abs(Arr1(row_num, column_num)) &gt; 0.0001 Then\n                strTieOutMsg = strTieOutMsg &amp; Chr(13) &amp; \"Failure\"\n            End If\n            Next row_num\n            Next column_num\n        End With\n        Debug.Print (strTieOutMsg)\n    End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "postgresql", "ms-access", "decimal-point"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1509567698, "post_id": 47062951, "comment_id": 81074231, "body": "A solution would be to use a properly parameterized query instead of converting everything to strings and concatenating them - i.e. pass the float values as such to the server. That said the number of fields is incorrect even if your values are <code>216</code> and <code>0.8</code>: you&#39;re specifying 2 values for 5 fields."}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1509567929, "post_id": 47062951, "comment_id": 81074324, "body": "use parameters (prepared query). It is basic protection for non-US applications (numbers, currecies, dates)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 3, "creation_date": 1509567960, "post_id": 47062951, "comment_id": 81074341, "body": "@JacekCz it&#39;s basic protection for anything that remotely deals with SQL, US or not."}, {"owner": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509614145, "post_id": 47062951, "comment_id": 81090962, "body": "Thanks. I will look at parametrizing. The error in the number of fielsds is due to my simplifying the query. Thanks to Mat for his added comment."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8865077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f791bd826ab49ed61960acec6f730?s=128&d=identicon&r=PG&f=1", "display_name": "Charles_D", "link": "https://stackoverflow.com/users/8865077/charles-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1509575657, "last_edit_date": 1509575657, "creation_date": 1509574337, "answer_id": 47064500, "question_id": 47062951, "link": "https://stackoverflow.com/questions/47062951/access-insert-numeric-with-decimal-comma-into-postgresql/47064500#47064500", "title": "Access insert numeric with decimal comma into Postgresql", "body": "<p>This should work:</p>\n\n<pre><code>Dim Nettoprijs_temp as Single\nNettoprijs_temp = MijnTempOrderLijn!Prijs * ((100 - Korting) / 100)\nmijnSQL = \"INSERT INTO tblOrderLijnen (OrderID, Nettoprijs )VALUES (NieuwOrderId, \" &amp; Nettoprijs_temp &amp; \");\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509613862, "post_id": 47064696, "comment_id": 81090808, "body": "Thanks a lot. This is what I needed"}, {"owner": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509614659, "post_id": 47064696, "comment_id": 81091302, "body": "My special thanks for the excellent example. This really get me on the way."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509639010, "post_id": 47064696, "comment_id": 81108601, "body": "Excellent! Glad to help. And please note the special way to say <a href=\"https://meta.stackexchange.com/a/5235\">thanks</a> on StackOverflow."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 3, "last_activity_date": 1509575474, "creation_date": 1509575474, "answer_id": 47064696, "question_id": 47062951, "link": "https://stackoverflow.com/questions/47062951/access-insert-numeric-with-decimal-comma-into-postgresql/47064696#47064696", "title": "Access insert numeric with decimal comma into Postgresql", "body": "<p>Consider SQL parameterization (an industry standard for any SQL statement used in application layer code like VBA) beyond simply protecting against SQL injection. And not just for Access or Postgres. Parameterization helps avoid quote enclosures, escaping special characters, string concatenation, and specifying data types to align with regional settings.</p>\n\n<p>In MS Access, you can use the <code>PARAMETERS</code> clause (valid in Access SQL dialect) and bind values in VBA using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193967.aspx\" rel=\"nofollow noreferrer\">querydefs</a>. Additionally, as seen code is cleaner and more maintainable.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qdef As QueryDef\n...\n\n' PREPARED STATEMENT (NO DATA)\nmijnSQL = \"PARAMETERS [firstparam] Long, [secondparam] Double;\" _\n           &amp; \" INSERT INTO tblOrderLijnen (OrderID, Nettoprijs)\" _ \n           &amp; \" VALUES ([firstparm], [secondparam]);\"\n\n' INITIALIZE QUERYDEF\nSet qdef = CurrentDb.CreateQueryDef(\"\", mijnSQL)\n\n' BIND PARAMS\nqdef![firstparam] = NieuwOrderId\nqdef![secondparam] = MijnTempOrderLijn!Prijs * ((100 - Korting) / 100)\n\n' EXECUTE ACTION QUERY\nqdef.Execute dbFailOnError\n\nSet qdef = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509613993, "post_id": 47070797, "comment_id": 81090876, "body": "Thanks. By using quotes, I basically did the same. The Csql is not an Access function to my knowledge."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "edited": false, "score": 0, "creation_date": 1509618244, "post_id": 47070797, "comment_id": 81093764, "body": "Then, please add your basically same solution to your question. And right, CSql is not native to VBA, that&#39;s why it is written."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1509611754, "creation_date": 1509611754, "answer_id": 47070797, "question_id": 47062951, "link": "https://stackoverflow.com/questions/47062951/access-insert-numeric-with-decimal-comma-into-postgresql/47070797#47070797", "title": "Access insert numeric with decimal comma into Postgresql", "body": "<p>Use <em>Str</em> to convert. It will always force a dot as the decimal separator:</p>\n\n<pre><code>mijnSQL = mijnSQL &amp; \" VALUES (\" &amp; NieuwOrderId&amp; \"', \" &amp; Str(MijnTempOrderLijn!Prijs * ((100 - Korting) / 100)) &amp; \");\"\n</code></pre>\n\n<p>Or build your concatenated SQL using my <a href=\"https://stackoverflow.com/questions/43589800/syntax-error-in-insert-into-statement-whats-the-error/43591778#43591778\">CSql</a> function.</p>\n"}], "owner": {"reputation": 31, "user_id": 8869680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2TDh.png?s=128&g=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/8869680/guido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1509611754, "creation_date": 1509567261, "last_edit_date": 1509571322, "question_id": 47062951, "link": "https://stackoverflow.com/questions/47062951/access-insert-numeric-with-decimal-comma-into-postgresql", "title": "Access insert numeric with decimal comma into Postgresql", "body": "<p>I need to insert on orderline into a linked PostgreQL table using Access VBA. For easy reporting, I decided to include the netto price which is a Numeric 18,2 field.\nMy computer has a Belgian period using comma as decimal separator. i.e. 0.8 is represented as 0,8</p>\n\n<p>This is the problematic part if the insert statement</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>mijnSQL = \"INSERT INTO tblOrderLijnen (OrderID, Nettoprijs )\"\nmijnSQL = mijnSQL &amp; \" VALUES (\" &amp; NieuwOrderId&amp; \"', \" &amp; MijnTempOrderLijn!Prijs * ((100 - Korting) / 100) &amp; \");\"\n</code></pre>\n\n<p>The result of the calculation is 0.8 (on my computer 0,8)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL mijnSQL\n</code></pre>\n\n<p>Translates into a query where the decimal value is invalid because the decimal point is a comma. How can I solve this?</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO tblOrderLijnen (OrderID, OrderNr,ArtikelID,Aantal,Nettoprijs ) \nVALUES (216, 0,8);\n</code></pre>\n\n<p>Number of fields do not match </p>\n\n<p>I changed the insert to quoting the decimal value. This seems to work, but is it valid? Can I run into problems later?</p>\n\n<p>This is the problematic part if the insert statement</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>mijnSQL = \"INSERT INTO tblOrderLijnen (OrderID, Nettoprijs )\"\nmijnSQL = mijnSQL &amp; \" VALUES (\" &amp; NieuwOrderId&amp; \"', \" &amp; MijnTempOrderLijn!Prijs * ((100 - Korting) / 100) &amp; \");\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1509566796, "post_id": 47062815, "comment_id": 81073771, "body": "see answers to this question, for multiple methods: <a href=\"https://stackoverflow.com/questions/33744149/code-in-vba-loops-and-never-ends-how-to-fix-this\" title=\"code in vba loops and never ends how to fix this\">stackoverflow.com/questions/33744149/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1509653767, "post_id": 47062983, "comment_id": 81117042, "body": "im still kinda new and never seen this before. can you explain a bit more"}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 1, "last_activity_date": 1509660572, "last_edit_date": 1509660572, "creation_date": 1509567393, "answer_id": 47062983, "question_id": 47062815, "link": "https://stackoverflow.com/questions/47062815/delete-multiple-rows-based-on-cell-value-remove-lag/47062983#47062983", "title": "Delete multiple rows based on cell value, remove lag", "body": "<p>delete from last to first. <code>for RowIndex = RowIndexMax to RowIndexMin Step -1</code></p>\n\n<h2>Working code</h2>\n\n<pre><code>Sub delline() 'Using Max-Min-Rows\n\n    Const RowIndexMin  As Long = 12 'first row at the top. B12 =&gt; row 12.\n    Const ColumnB_Index As Long = 2\n\n    Dim UserDecision As Long\n    Dim RowIndexMax  As Long 'last row at the bottom\n    Dim RowIndex  As Long 'changed in every loop\n\n    On Error GoTo Reset\n\n    UserDecision = MsgBox(\"Are you sure you wish to delete the selected rows?\", vbYesNo + vbQuestion, \"Point Of No Return\") 'you can combine vb- enumerations ;)\n    If UserDecision &lt;&gt; vbYes Then\n        Exit Sub 'just my way of avoiding unnecessary nesting.\n    End If\n\n    'Some of speet boosting settings\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    RowIndexMax = Cells(RowIndexMin, ColumnB_Index).End(xlDown).Row\n\n    For RowIndex = RowIndexMax To RowIndexMin Step -1 'Step -1 decreases the RowIndex every loop by 1\n        If Cells(RowIndex, ColumnB_Index).Value2 = True Then\n            Debug.Print \"Deleting row: \" &amp; RowIndex\n            Rows(RowIndex).Delete\n        End If\n    Next\n\n    'True's should be gone. Falses should bubbled to the top.\nReset:\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic 'assuming it was automatic at the beginning\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1509653866, "post_id": 47062995, "comment_id": 81117089, "body": "thanks ill give it a try. does this mean I can get rid of the second &#39;for&#39; statement, or that I just disable trying to update the screen until done?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1509655754, "post_id": 47062995, "comment_id": 81118047, "body": "@benmazor I&#39;ve updated my answer please see the edit, this is much more efficient and will eliminate the error you&#39;re having"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1509657370, "post_id": 47062995, "comment_id": 81118847, "body": "I&#39;ve tested it with 2433 rows and it took ~55 seconds, if you really want something efficient, I&#39;d suggest do a direct value extraction and creating a new table out of it, it&#39;s very fast likely less than <code>2 seconds</code>. EDIT: I just tested the extraction method I mentioned here and it took <code>0.2 seconds</code>"}, {"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1509967832, "post_id": 47062995, "comment_id": 81221085, "body": "first edit works the best, second edit doesnt work, i fixed sheet2 to Main and nothing happend, but your your first edit worked really well thanks"}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": true, "score": 0, "last_activity_date": 1509657537, "last_edit_date": 1509657537, "creation_date": 1509567435, "answer_id": 47062995, "question_id": 47062815, "link": "https://stackoverflow.com/questions/47062815/delete-multiple-rows-based-on-cell-value-remove-lag/47062995#47062995", "title": "Delete multiple rows based on cell value, remove lag", "body": "<p>In your code you should set <code>Application.ScreenUpdating</code> to <code>False</code>, this makes a <strong>HUGE</strong> impact on performance, but be sure to set it back to <code>True</code> when you're done!</p>\n\n<pre><code>Sub delline()\n\n    Application.ScreenUpdating = False\n\n    If (MsgBox(\"Are you sure you wish to delete the selected rows?\", _ \n                vbYesNo, \"Point Of No Return\") = vbYes) Then\n        For Each b In Range(\"B12\", Range(\"B12\").End(xlDown))\n            For Each a In Range(\"B12\", Range(\"B12\").End(xlDown))\n                If a.Value = True Then\n                    a.EntireRow.Delete\n                End If\n            Next a\n        Next b\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>If all you're trying to do is strictly delete the row where in Column B has a value = FALSE, you can use the below code. I've test it and it works fine. It will delete all rows UP TO (and including) B12</p>\n\n<pre><code>Sub test1()\n\n    Dim LastRow As Long\n\n    Application.ScreenUpdating = False\n    If (MsgBox(\"Are you sure you wish to delete the selected rows?\", _ \n            vbYesNo, \"Point Of No Return\") = vbYes) Then\n        With ActiveSheet\n            LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n            For i = LastRow To 12 Step -1\n                If (.Cells(i, \"B\").Value = True) Then\n                    .Cells(i, \"B\").EntireRow.Delete\n                End If\n            Next i\n        End With\n    End If\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>This is using the direct value copy method, and it's very fast compared to all the above</p>\n\n<pre><code>Sub test1()\n\n    Dim LastRow As Long\n    Dim LastRow2 As Long\n    Application.ScreenUpdating = False\n\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        For i = LastRow To 12 Step -1\n            If (.Range(\"B\" &amp; i).Value = False) Then\n                LastRow2 = Sheets(\"Sheet2\").Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n                Sheets(\"Sheet2\").Range(\"B\" &amp; LastRow2).Value = .Range(\"B\" &amp; i).Value\n               ' .Range(\"B\" &amp; i).EntireRow.Delete\n            End If\n        Next i\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Unless you need all the data from the rows, I'd suggest using this one; Or you can add the other data from those rows to the loop as well. Which still will be much faster</p>\n"}], "owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 47062995, "answer_count": 2, "score": 0, "last_activity_date": 1509660572, "creation_date": 1509566705, "last_edit_date": 1509567481, "question_id": 47062815, "link": "https://stackoverflow.com/questions/47062815/delete-multiple-rows-based-on-cell-value-remove-lag", "title": "Delete multiple rows based on cell value, remove lag", "body": "<p>I'm trying to make a button macro that deletes rows based on their true/false value in the 'b' column. the issue with deleting is once it's gone, the 'for _ do' skips the one after cause the cell in the range bellow becomes the current. I came up with this alternative but it's super laggy when done in large quantities. any suggestions. also, im trying to keep the code as simple and clean as possible, I don't like too many vars because it becomes confusing when I have to review and adjust in the future. thanx</p>\n\n<pre><code>Dim inps As Integer\n\nSub delline()\ninps = MsgBox(\"Are you sure you wish to delete the selected rows?\", vbYesNo, \"Point Of No Return\")\nIf inps = vbYes Then\n For Each b In Range(\"B12\", Range(\"B12\").End(xlDown))\n  For Each a In Range(\"B12\", Range(\"B12\").End(xlDown))\n    If a.Value = True Then\n     a.EntireRow.Delete\n    End If\n   Next a\n  Next b\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1509576725, "post_id": 47062786, "comment_id": 81077989, "body": "Excellent question. I struggle with this issue as well, but fortunately, a way I have always solved my problem was adding a loop after the initial loop that contained the <code>.Busy</code> - looping until my object becomes available. So, my question is: are all your objects available after the page completely &quot;loads&quot;? Example: You <code>Set SubmitBtn = doc.getElement.....</code>... Is that <code>Nothing</code>, prompting a runtime error?"}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1509653367, "post_id": 47062786, "comment_id": 81116858, "body": "I too have run into this problem, but it&#39;s usually a network problem. When the network is running fast, no problems, but when it&#39;s starts to show some lag time, the pages don&#39;t fully load. I&#39;ve had to resort to adding a wait timer to allow extra time.  <code>Application.Wait (Now + TimeValue(&quot;0:00:06&quot;))</code>  This being a 6 second wait."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1509657809, "post_id": 47062786, "comment_id": 81119059, "body": "@Mitch Timers is unreliable solution, especially for slow network."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1509708277, "post_id": 47062786, "comment_id": 81138525, "body": "@omegastripes I totally agree. Our internal site is all done using kendo-ui, which, for me, is very hard to figure out. We have 4 T1&#39;s at our location, which you wouldn&#39;t think network lag would be an issue, but it happens occasionally. Most of the issue is with the multitude of users we have accessing the same system, and then the server communicates with the SQL server. I&#39;m still wondering why we&#39;re not running everything on a Unix system (server side). Oh well, thanks for the comment ! I endeavor to persevere."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3790576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xTial.jpg?s=128&g=1", "display_name": "Innertube", "link": "https://stackoverflow.com/users/3790576/innertube"}, "edited": false, "score": 0, "creation_date": 1509900598, "post_id": 47084865, "comment_id": 81198202, "body": "Omegastripes, what you&#39;ve done in the first code snippet is almost identical to my workaround, so that&#39;s encouraging to me that my coding quality is coming along.  XHR is new-ish to me and I haven&#39;t done any JSON work since it first appeared about 15 years ago. I&#39;ll get up to speed on both of those. I just started looking into the MSXML2.XMLHTTP function last week. I believe you&#39;re right that this is the way to go. I&#39;ll give it a go at work and report back here. Thank you!"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 3, "last_activity_date": 1529390054, "last_edit_date": 1529390054, "creation_date": 1509657721, "answer_id": 47084865, "question_id": 47062786, "link": "https://stackoverflow.com/questions/47062786/in-excel-vba-what-is-the-way-to-check-if-the-web-page-is-fully-loaded/47084865#47084865", "title": "In Excel VBA, what is the way to check if the web page is fully loaded?", "body": "<p>Functionality of webpages is very different, so there is no solution that will fit to all of them.</p>\n\n<p>Regarding your example, your workaround is a working solution, the code might be like:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TestIE()\n\n    Dim q\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .Navigate \"https://www.homedepot.ca/en/home/p.dry-cloth-refills-32---count.1000660019.html\"\n        ' Wait IE\n        Do While .readyState &lt; 4 Or .Busy\n            DoEvents\n        Loop\n        ' Wait document\n        Do While .document.readyState &lt;&gt; \"complete\"\n            DoEvents\n        Loop\n        ' Wait element\n        Do\n            q = .document.querySelector(\".product-total-price\").innerText\n            If Left(q, 1) &lt;&gt; \"-\" Then Exit Do\n            DoEvents\n        Loop\n        .Quit\n    End With\n    Debug.Print q\n\nEnd Sub\n</code></pre>\n\n<p>Anyway, you need to look into the webpage loading process, XHRs and DOM modifications, using browser developer tools (F12). Going that way, you may find that one of the numerous XHRs returns the price in JSON format. It's logged on network tab of browser developer tools right before the price appearing while the page is loading. That XHR is made by one of the loaded JS, notably after the page loaded event. Try this URL (I just copied it from network tab):</p>\n\n<p><a href=\"https://www.homedepot.ca/homedepotcacommercewebservices/v2/homedepotca/products/1000660019/localized/9999?catalogVersion=Online&amp;lang=en\" rel=\"nofollow noreferrer\">https://www.homedepot.ca/homedepotcacommercewebservices/v2/homedepotca/products/1000660019/localized/9999?catalogVersion=Online&amp;lang=en</a></p>\n\n<p>So you may just reproduce that XHR and extract the price by splitting:</p>\n\n<pre><code>Sub TestXHR()\n\n    Dim q\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.homedepot.ca/homedepotcacommercewebservices/v2/homedepotca/products/1000660019/localized/9999?catalogVersion=Online&amp;lang=en\", False\n        .Send\n        q = .ResponseText\n    End With\n    q = Replace(q, \" : \", \":\")\n    q = Split(q, \"\"\"displayPrice\"\"\", 2)(1)\n    q = Split(q, \"\"\"formattedValue\"\":\"\"\", 2)(1)\n    q = Split(q, \"\"\"\", 2)(0)\n    Debug.Print q\n\nEnd Sub\n</code></pre>\n\n<p>But again, there is no common case.</p>\n\n<p>You may also use JSON parser, take a look at <a href=\"https://stackoverflow.com/search?q=user%3A2165759+is%3Aanswer+json.bas\">some examples</a>.</p>\n"}], "owner": {"reputation": 51, "user_id": 3790576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xTial.jpg?s=128&g=1", "display_name": "Innertube", "link": "https://stackoverflow.com/users/3790576/innertube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4498, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1529390054, "creation_date": 1509566551, "last_edit_date": 1509648352, "question_id": 47062786, "link": "https://stackoverflow.com/questions/47062786/in-excel-vba-what-is-the-way-to-check-if-the-web-page-is-fully-loaded", "title": "In Excel VBA, what is the way to check if the web page is fully loaded?", "body": "<p>To pause code until a web page is fully loaded, I've been using the method below with great success almost all of the time.</p>\n\n<pre><code>Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n</code></pre>\n\n<p>But occasionally, I see text content load after the method determines that the page is fully loaded, and so that content is not extracted.</p>\n\n<p>However, if I step through the code via F8, the content is extracted every time. This is done about as fast as I can press the F8 key repeatedly.</p>\n\n<p>So how can I check to ensure the page, and all its content, is fully loaded before the code continues to extract data?</p>\n\n<p>In both cases, IE is running invisibly. However, I've tried this with IE visible and there is actually content in this specific location on the pages I'm working with.</p>\n\n<p>This is being done in Excel 2016, using VBA script. The specific content request is written like:</p>\n\n<pre><code> 'get item name from page and write it to the first cell on the first empty row available\n Set itemName = objIE.document.querySelector(\".the-item-name\")\n Worksheets(\"Results\").Range(\"A1048576\").End(xlUp).Offset(1, 0).Value = itemName.innerText\n</code></pre>\n\n<p>I've read through <a href=\"https://stackoverflow.com/questions/13029708/excel-vba-wait-for-javascript-execution-in-internet-explorer\">Excel VBA: Wait for JavaScript execution in Internet Explorer</a> because I think that maybe the values are getting added after the document is loaded, in an effort to prevent anyone from scraping data. However, I can't seem to identify any script that may be doing that. Doesn't mean it isn't there. I just can't see it yet.</p>\n\n<p>A specific example of the page with this issue is URL</p>\n\n<p><a href=\"https://www.homedepot.ca/en/home/p.dry-cloth-refills-32---count.1000660019.html\" rel=\"nofollow noreferrer\">https://www.homedepot.ca/en/home/p.dry-cloth-refills-32---count.1000660019.html</a></p>\n\n<p>Initially <code>product-total-price</code> div element contains dash (-), prior to the price being loaded, so that's what the request will return: <code>- / each</code> instead of <code>$11.29 / each</code>.</p>\n\n<p>I have a workaround, but it's not as efficient or as concise as I'd like it to be. I test the string returned for the presence of the dash. If it's there, loop and check it again, else capture it and insert it into the worksheet.</p>\n\n<pre><code>setPriceUM:\n    Set hdPriceUM = objIE.document.querySelector(\".product-total-price\").innerTe\u200c\u200b\u200c\u200bxt\n    hdPriceUMString = hdPriceUM.innerText\n    stringTest = InStr(hdPriceUMString, \"-\")\n    If stringTest = True Then\n        GoTo setPriceUM\n    Else\n        Debug.Print hdPriceUMString\n    End If\n</code></pre>\n\n<p>Thank you for taking the time to read this and consider it.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1509566500, "post_id": 47062734, "comment_id": 81073602, "body": "Do you have calculation set to manual?  If not, maybe your worksheet is processing a lot of calculations after each of your <code>[d1].Resize(UBound(output_dt)) = Application.Transpose(output_dt)</code> statements.  Other than that, I can&#39;t understand why it would be slow at all."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1509566930, "post_id": 47062734, "comment_id": 81073841, "body": "Is there any reason why you can&#39;t have the 3 columns in the same single 2D array? Do you have handlers running on <code>Worksheet.Change</code>? <code>Application.EnableEvents</code> is off? <code>[d1]</code> notation is implicitly referring to the active worksheet, is that intended? You&#39;re dereferencing the same worksheet 3 times explicitly and, assuming it&#39;s the active sheet, 3 times implicitly. Could be done only once. Gut feeling says it&#39;s the <code>ClearContents</code> calls that are taking forever; dumping a variant array with millions of rows is otherwise pretty much instant."}, {"owner": {"reputation": 81, "user_id": 5291529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb754f1214d2be269bf333a6c8026d55?s=128&d=identicon&r=PG&f=1", "display_name": "LLC", "link": "https://stackoverflow.com/users/5291529/llc"}, "edited": false, "score": 0, "creation_date": 1509568721, "post_id": 47062734, "comment_id": 81074710, "body": "YowE3K - Appreciated, as when I turn off automatic calculations before and after, this solved it. I hadn&#39;t realised that it would re-calculate during each function.  Mat&#39;s Mug - No - I just couldn&#39;t work out how to do it with my original source code (will add below if you can point me in the right direction).  Is is slower then to reference the ActiveSheet rather than just specify which sheet I want 3 times?"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5291529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb754f1214d2be269bf333a6c8026d55?s=128&d=identicon&r=PG&f=1", "display_name": "LLC", "link": "https://stackoverflow.com/users/5291529/llc"}, "is_accepted": false, "score": 0, "last_activity_date": 1509568819, "creation_date": 1509568819, "answer_id": 47063310, "question_id": 47062734, "link": "https://stackoverflow.com/questions/47062734/vba-array-faster-output-to-excel-sheet/47063310#47063310", "title": "VBA Array Faster Output to Excel Sheet", "body": "<p>The loop I wrote for this to loop through the list of dates and 2 numbers to create a new set of data, creating 3x single 1D arrays. </p>\n\n<pre><code>    For i = LBound(data) To UBound(data)\n        For j = LBound(data) To UBound(data)\n            If data(i, 1) = data(j, 1) Then\n                If data(i, 2) &lt; data(j, 2) Then\n                    x = x + 1\n                    'MsgBox data(i, 2) &amp; \"-\" &amp; data(j, 2)\n                    ReDim Preserve output_dt(0 To x + 1)\n                    ReDim Preserve output_s1(0 To x + 1)\n                    ReDim Preserve output_s2(0 To x + 1)\n                    output_dt(x) = data(i, 1)\n                    output_s1(x) = data(i, 2)\n                    output_s2(x) = data(j, 2)\n                End If\n            End If\n        Next j\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5291529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb754f1214d2be269bf333a6c8026d55?s=128&d=identicon&r=PG&f=1", "display_name": "LLC", "link": "https://stackoverflow.com/users/5291529/llc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509568819, "creation_date": 1509566337, "question_id": 47062734, "link": "https://stackoverflow.com/questions/47062734/vba-array-faster-output-to-excel-sheet", "title": "VBA Array Faster Output to Excel Sheet", "body": "<p>Is there a faster version method to output an array to excel? </p>\n\n<p>I currently have data stored in 3 arrays <code>output_dt, output_s1, output_s2</code>. </p>\n\n<p>Format sample:</p>\n\n<pre><code>15/12/2017  2165    2170\n15/12/2017  2165    2175\n15/12/2017  2165    2180\n15/12/2017  2165    2185\n15/12/2017  2165    2190\n15/12/2017  2165    2195\n15/12/2017  2165    2200\n15/12/2017  2165    2205\n15/12/2017  2165    2210\n</code></pre>\n\n<p>My current working solution is this:</p>\n\n<pre><code>Application.ScreenUpdating = False\nWorksheets(\"Strategies\").Columns(4).ClearContents\nWorksheets(\"Strategies\").Columns(5).ClearContents\nWorksheets(\"Strategies\").Columns(6).ClearContents\n[d1].Resize(UBound(output_dt)) = Application.Transpose(output_dt)\n[e1].Resize(UBound(output_s1)) = Application.Transpose(output_s1)\n[f1].Resize(UBound(output_s2)) = Application.Transpose(output_s2)\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>However, this is painfully slow, even for just <strong>150 rows</strong>. </p>\n\n<p>Any methods to speed this up?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509566612, "post_id": 47062643, "comment_id": 81073675, "body": "Remove the <code>+ 1</code> from <code>lrow = ActiveSheet.Cells(Rows.Count, res).End(xlUp).Row + 1</code> and see if it works. If not, I have another method because using <code>SpecialCells</code> to test can be tricky if you don&#39;t get logic <i>just right</i>. And why do you work with <code>ListObject</code> in beginning of code and then <code>Ranges</code> in the middle. If you stick with <code>ListObject</code> object model you&#39;re code would be easier to read, maintain."}, {"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509567857, "post_id": 47062643, "comment_id": 81074287, "body": "@scott Holtzman - I tried removing the +1 from lrow = ActiveSheet.Cells(Rows.Count, res).End(xlUp).Row + 1   but still same issue.  As to why I switched between methods, I couldn&#39;t figure out how to paste the copied data into the bottom of Table B especially when I was pasting multiple rows and use Paste Special Values. Every time I tried to code it, I would run into errors or it would add a blank row at the bottom of table B and not paste any data. This was the only I could get it work properly.   As you can probably gather - I am new to VBA."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509568377, "post_id": 47062643, "comment_id": 81074539, "body": "Change <code>ActiveSheet</code> to explicitly state the worksheet you want to work with in all instances` ... like <code>Worksheets(&quot;SheetA&quot;)</code> and / or <code>Worksheets(&quot;SheetB&quot;)</code>. The <code>ActiveSheet</code> may not be what you think it is. If this doesn&#39;t solve issue, I will write out an answer that will most likely work."}, {"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509568832, "post_id": 47062643, "comment_id": 81074756, "body": "I did as you suggested but still no cigar. Thanks for your help by the way."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1509569277, "post_id": 47062643, "comment_id": 81074962, "body": "Do you know how to use the debugger to set a breakpoint and look at the evaluated expression?"}, {"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "reply_to_user": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1509627119, "post_id": 47062643, "comment_id": 81099900, "body": "@theMayer I do not but I will look into breakpoints in VBA after I try Scott&#39;s suggestion."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 1, "creation_date": 1509642216, "post_id": 47062643, "comment_id": 81110744, "body": "I would recommend learning how to use the debugger <i>before</i> trying the suggestion. Refactoring your code is not going to help you fix the next problem that comes along - and wouldn&#39;t you like three days of your life back? <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/DebuggingVBA.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "edited": false, "score": 0, "creation_date": 1509628403, "post_id": 47063360, "comment_id": 81100747, "body": "Getting a &quot;syntax error&quot; at the following line       If Not .ListColumns(&quot;Quick Status&quot;).DataBodyRange.Find(&quot;Closed&quot;, lookat:=xlWhole) Is Nothing"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "edited": false, "score": 0, "creation_date": 1509631108, "post_id": 47063360, "comment_id": 81102649, "body": "@Den - That pesky <code>Then</code> word, gets me everytime! Try now."}, {"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "edited": false, "score": 0, "creation_date": 1509631953, "post_id": 47063360, "comment_id": 81103231, "body": "Odd now it stopped earlier in the macro - it stopped at this line Set PendATbl = Worksheets(&quot;A&quot;).ListObjects(&quot;PendA&quot;) .   It gave a subscript out of range error"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "edited": false, "score": 0, "creation_date": 1509632459, "post_id": 47063360, "comment_id": 81103585, "body": "@Den - make sure Worksheet and Table name match to yours."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1509642156, "post_id": 47063360, "comment_id": 81110703, "body": "&quot;Give a man a fish, and you feed him for a day. Teach a man to fish, and you feed him for a lifetime&quot;"}, {"owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "reply_to_user": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 1, "creation_date": 1509645966, "post_id": 47063360, "comment_id": 81112961, "body": "Oops can&#39;t believe I missed that. Thanks code works perfectly.   @theMayer - I&#39;ll go and do some more learning."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1509632483, "last_edit_date": 1509632483, "creation_date": 1509569029, "answer_id": 47063360, "question_id": 47062643, "link": "https://stackoverflow.com/questions/47062643/if-else-vba-not-working/47063360#47063360", "title": "IF ELSE VBA not working", "body": "<p>Overall there is a better way to structure your code for accuracy, maintainability and ease of reading. </p>\n\n<p>Try the below. It checks for instances of \"Closed\" in the column <em>before</em> the filter.</p>\n\n<pre><code>Sub MoveC()\n\n    Dim PendATbl as ListObject\n    Set PendATbl = Worksheets(\"A\").ListObjects(\"PendA\") 'change as needed\n\n    With PendATbl\n\n        If Not .ListColumns(\"Quick Status\").DataBodyRange.Find(\"Closed\", lookat:=xlWhole) Is Nothing Then\n\n            .ListColumns(\"Quick Status\").Range.AutoFilter 1, \"Closed\"\n            .DataBodyRange.SpecialCells(xlCellTypeVisible).Copy\n\n             Sheets(\"Closed\").Range(\"A2000\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n\n            .DataBodyRange.Rows.Delete\n\n        Else\n\n           .Range.AutoFilter Field:=8\n            MsgBox \"No Closures found. Should have taken a PTO today.\"\n\n        End If \n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8870052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0cbf33af47ce477788596dec2cbccc?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8870052/den"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1509660177, "answer_count": 1, "score": 0, "last_activity_date": 1509642839, "creation_date": 1509565930, "last_edit_date": 1531164843, "question_id": 47062643, "link": "https://stackoverflow.com/questions/47062643/if-else-vba-not-working", "closed_reason": "Not suitable for this site", "title": "IF ELSE VBA not working", "body": "<p>Been working on this code and still can't get it to work. I've tried to piece it together through searching and copying similar codes but been unsuccessful at duplicating the solutions given. </p>\n\n<p>I have Worksheet A and Worksheet B. I have table A on Worksheet A and table B on Worksheet B. I want to autofilter Table A and copy the results (\"Quick Status\" column=\"closed\") (excluding header info) to bottom of table B. </p>\n\n<p>If that criteria is met (\"Quick Status\" column =\"closed\"), it copies those rows with \"closed\" as the criteria in the \"Quick Status\" column and pastes it over on the other sheet and then deletes the data from Table A. Works as intended. </p>\n\n<p>However if I have a day where I did not close any files, autofilter would return no results. That is when the issue occurs.\nWhen I am stepping thru it in the debugger - it continues thru the \"IF\" portion and gets stuck at </p>\n\n<pre><code>   Range(Selection, Selection.End(xlDown)).SpecialCells   (xlCellTypeVisible).Copy\n</code></pre>\n\n<p>Not sure why it doesn't stop at the IF portion and move down to Else. The If portion should detect that the results are less then 1 so it should clear the filters and then populate a msg box informing the user that they did not close any files that day. </p>\n\n<p>\"PendA\" is name of Table A.\n\"Quick Status\" is name of Column in Table A that I am searching for the criteria \"Closed\".\nTable A starts on B14. And ends on Column L. </p>\n\n<pre><code>Sub MoveC()\n'\n' MoveC Macro\n\n\nDim rng As Range, res As Variant, lrow As Long\n\n\nSet rng = ActiveSheet.ListObjects(\"PendA\").AutoFilter.Range.Rows(1)\nres = Application.Match(\"Quick Status\", rng, 0)\nrng.AutoFilter Field:=res, Criteria1:=\"Closed\"\n\nlrow = ActiveSheet.Cells(Rows.Count, res).End(xlUp).Row + 1\n\n\n\nIf ActiveSheet.Range(Cells(1, res), Cells(lrow, res)).SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n    Range(\"B15:L15\").Select\n    Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Copy\n\n\n    Sheets(\"Closed\").Select\n    Range(\"A2000\").End(xlUp).Offset(1, 0).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n\n    Sheets(\"Pending\").Select\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"PendA\").DataBodyRange.Rows.Delete\n    ActiveSheet.ListObjects(\"PendA\").Range.AutoFilter Field:=8\n\n\nElse\n\n    ActiveSheet.ListObjects(\"PendA\").Range.AutoFilter Field:=8\n\n    MsgBox \"No Closures found. Should have taken a PTO today.\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "dynamic", "insert"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509566248, "post_id": 47062139, "comment_id": 81073457, "body": "Do you mean, if the current range is greater than 187 rows? Also, where is the pasting area?"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509566382, "post_id": 47062139, "comment_id": 81073538, "body": "the pasting area is on sheet 6 located in the range A12:T199. my data table needs not to be touched starts on row 200. so the pasting area is effectively 187 rows. currently all my sheets (that are called to pasting area) are less than 187 rows but that will change and I need to accommodate a dynamic # of rows value for each sheet that is called"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509566474, "post_id": 47062139, "comment_id": 81073588, "body": "Do you want the &quot;old&quot; data to be cleared when new data is pasted in?  If you need to paste more than 187 rows, then you table starting in row 200, will not be able to stay in row 200, can it move?"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509566535, "post_id": 47062139, "comment_id": 81073627, "body": "yes. that would be ideal"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509567053, "post_id": 47062139, "comment_id": 81073910, "body": "moving the table is an option. although it would require I change all my current working macros to accommodate new positioning of the table. I thought it would be much more efficient to make the pasting area dynamic. maybe by default it would show 20 or so blank rows, and then when a sheet is called it would insert x num of rows and move the table down, then moving it back when a new sheet is called"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509567274, "post_id": 47062139, "comment_id": 81074023, "body": "This will get you the number of rows in the data you are copying.  wkSht.Range(&quot;A1&quot;).CurrentRegion.Rows.Count"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509567297, "post_id": 47062139, "comment_id": 81074035, "body": "to be more specific, I have a macro that reads the table and returns search results, and at the end of that macro it then calls the corresponding sheet name, so as long as the table is in row 200 to start with, it can move later, then needs to be placed back where it was"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509569824, "post_id": 47062139, "comment_id": 81075221, "body": "why does the table have to be placed back?  You can access its location and reference its contents easily even if it moves."}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509570635, "post_id": 47062139, "comment_id": 81075618, "body": "@QHarr to answer your question, my table is referenced in several other macros as absolute cell locations. my vba knowledge is limited on how to make those references dynamic if the table were to move..."}], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509565729, "creation_date": 1509563894, "last_edit_date": 1509565729, "question_id": 47062139, "link": "https://stackoverflow.com/questions/47062139/vba-code-to-insert-dynamic-amt-of-rows", "title": "vba code to insert dynamic amt of rows", "body": "<p>need to modify this code which currently pastes the current region to the specified page, to instead read the # of rows used on the sheet that is called, and then insert that number of rows before pasting the data. having issues if the sheet called is > 187 rows it will paste over existing data that it should not touch. need it to then reset when a new sheet is called to the pasting area</p>\n\n<pre><code>    Dim wkSht As Worksheet\n\nFor Each wkSht In Sheets\n'sheet6 is the DashboardMain sheet\n\n    If Sheet6.Range(\"E3\").Value = wkSht.Name Then\n    wkSht.Range(\"A1\").CurrentRegion.Copy Destination:=Sheet6.Range(\"A12\")\n\n    End If\n\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "iframe"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1509564083, "post_id": 47062105, "comment_id": 81072240, "body": "In the link you sent, would the price you want be $6.42 each ?"}, {"owner": {"reputation": 349, "user_id": 6871531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yXAJB.png?s=128&g=1", "display_name": "Froopy", "link": "https://stackoverflow.com/users/6871531/froopy"}, "edited": false, "score": 0, "creation_date": 1509564351, "post_id": 47062105, "comment_id": 81072394, "body": "&lt;div class=&quot;PrceTxt&quot;&gt;$6.42 Each&lt;/div&gt; is the source for the price element."}, {"owner": {"reputation": 3, "user_id": 8821479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5c8880b989a50b5aaf424db0df28f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brother.Ed", "link": "https://stackoverflow.com/users/8821479/brother-ed"}, "edited": false, "score": 0, "creation_date": 1509571570, "post_id": 47062105, "comment_id": 81076013, "body": "Correct, looking for &quot;$6.42 each&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8821479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5c8880b989a50b5aaf424db0df28f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brother.Ed", "link": "https://stackoverflow.com/users/8821479/brother-ed"}, "edited": false, "score": 0, "creation_date": 1509571728, "post_id": 47062339, "comment_id": 81076084, "body": "That worked great!  Thanks for the explanation and the amazing quick response! StackOverflow is by far my favorite go-to for code questions."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 8821479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5c8880b989a50b5aaf424db0df28f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brother.Ed", "link": "https://stackoverflow.com/users/8821479/brother-ed"}, "edited": false, "score": 0, "creation_date": 1509572405, "post_id": 47062339, "comment_id": 81076405, "body": "@Brother.Ed glad it worked, please accept my answer so the thread gets closed."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1509564702, "creation_date": 1509564702, "answer_id": 47062339, "question_id": 47062105, "link": "https://stackoverflow.com/questions/47062105/scrape-data-from-nested-iframe-with-vba/47062339#47062339", "title": "Scrape data from &#39;nested&#39; iframe with vba", "body": "<p>The element you try to scrape in your link is nested as follows: </p>\n\n<p><a href=\"https://i.stack.imgur.com/CQWCW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CQWCW.png\" alt=\"enter image description here\"></a></p>\n\n<p>The first mistake you do is that you're trying to get this object by <code>name</code>, and not by <code>id</code>: </p>\n\n<pre><code>doc.getElementsByName(\"Prce\")\n</code></pre>\n\n<p>There's no object in your HTML document having name=\"Prce\", so I'd expect the <code>For</code> cycle not even to start. </p>\n\n<p>What you might want to do to get your price, instead, is: </p>\n\n<pre><code>Sheet2.Cells(2, 2).Value = doc.getElementById(\"Prce\").getElementsByClassName(\"PrceTxt\")(0).innerText\n</code></pre>\n\n<p>where: </p>\n\n<ul>\n<li><code>doc.getElementById(\"Prce\")</code> gets you the element <code>&lt;div id=\"Prce\"&gt;...&lt;/div&gt;</code></li>\n<li><code>.getElementsByClassName(\"PrceTxt\")(0)</code> gets you the first (and only) element inside the above div, i.e. <code>&lt;div class=\"PrceTxt\"&gt;...&lt;/div&gt;</code></li>\n<li><code>.innerText</code> gets you the text of this element</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 8821479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5c8880b989a50b5aaf424db0df28f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brother.Ed", "link": "https://stackoverflow.com/users/8821479/brother-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 47062339, "answer_count": 1, "score": 0, "last_activity_date": 1509564702, "creation_date": 1509563754, "last_edit_date": 1531164843, "question_id": 47062105, "link": "https://stackoverflow.com/questions/47062105/scrape-data-from-nested-iframe-with-vba", "title": "Scrape data from &#39;nested&#39; iframe with vba", "body": "<p>Am trying to scrape the title and price from mcmaster.com to auto populate an internal purchase rec form. (URL with item part number is hard coded below for testing.) Got the title fine, but can't get the price. I don't think my code is looking at the correct place because the element is not found.  I modeled my code from <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">here.</a></p>\n\n<pre><code>Sub get_title_header()\nDim wb As Object\nDim doc As Object\nDim sURL As String\n\nSet wb = CreateObject(\"internetExplorer.Application\")\nsURL = \"https://www.mcmaster.com/#95907A480\"\n\nwb.navigate sURL\nwb.Visible = True\n\nWhile wb.Busy Or wb.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\n'Wait a bit for everything to catchup...(network?)\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\n'HTML document\nSet doc = wb.document\n\nDim MyString As String\nMyString = doc.Title\n\nSheet2.Cells(1, 2) = Trim(Replace(MyString, \"McMaster-Carr -\", \"\", , , vbTextCompare))\n\nDim el As Object\nFor Each el In doc.getElementsByName(\"Prce\")\n    Sheet2.Cells(2, 2).Value = el.innerText\nNext el\n\nwb.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Is this iframe nested? Can anyone explain why my code can't see the iframe data and help me get the item price?  Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8870079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bfc96c97f09d3a29e228ae2a7d7d7e?s=128&d=identicon&r=PG&f=1", "display_name": "flokki", "link": "https://stackoverflow.com/users/8870079/flokki"}, "edited": false, "score": 0, "creation_date": 1509623990, "post_id": 47063521, "comment_id": 81097678, "body": "Ah you absolute hero, thanks so much for the help. Works perfectly. Thanks again!"}], "tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": true, "score": 0, "last_activity_date": 1509570612, "last_edit_date": 1509570612, "creation_date": 1509569699, "answer_id": 47063521, "question_id": 47062055, "link": "https://stackoverflow.com/questions/47062055/creating-a-hyperlink-containing-variables/47063521#47063521", "title": "Creating a hyperlink containing variables", "body": "<p>You're missing a few quotation marks. Try this:</p>\n\n<pre><code>Sub testy()\n\nDim variable1, variable2, variable3 As Long\n\nvariable2 = range(\"Q8\").Value\n\nvariable3 = range(\"R8\").Value\n\nRange(\"E2\").FormulaR1C1 = \"=HYPERLINK(\"\"www.example.com/\"\"&amp;RC[3]&amp;\"\"Diff=300&amp;Start=\" &amp; variable2 &amp; \"&amp;End=2359\" &amp; variable3 &amp; \"\"\")\"\n\n End Sub\n</code></pre>\n\n<p>If that doesn't work, it might have to do  with your data type you're storing in Variable1, 2 and 3 - if they are not used in any other calculation other than to build this string, I recommend setting them as <strong>String</strong> instead of <strong>Long</strong>.</p>\n\n<hr>\n\n<p>Edit: Also, regarding your need to populate the entire column E with this formula, this will work:</p>\n\n<pre><code>Sub testy2()\n\nDim i, n, variable2, variable3 As Long\n\nvariable2 = Range(\"Q8\").Value\n\nvariable3 = Range(\"R8\").Value\n\nn = Cells(Rows.Count, \"A\").End(xlUp).Row 'Change \"A\" with whichever column contains your data records\n\nFor i = 2 To n\nRange(\"E\" &amp; i).FormulaR1C1 = \"=HYPERLINK(\"\"www.example.com/\"\"&amp;RC[3]&amp;\"\"Diff=300&amp;Start=\" &amp; variable2 &amp; \"&amp;End=2359\" &amp; variable3 &amp; \"\"\")\"\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8870079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bfc96c97f09d3a29e228ae2a7d7d7e?s=128&d=identicon&r=PG&f=1", "display_name": "flokki", "link": "https://stackoverflow.com/users/8870079/flokki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2680, "favorite_count": 0, "accepted_answer_id": 47063521, "answer_count": 1, "score": 0, "last_activity_date": 1509570612, "creation_date": 1509563553, "last_edit_date": 1509563592, "question_id": 47062055, "link": "https://stackoverflow.com/questions/47062055/creating-a-hyperlink-containing-variables", "title": "Creating a hyperlink containing variables", "body": "<p>I'm still pretty new to VBA but i'm trying to get a macro to add a hyperlink based on information stored in a spreadsheet.</p>\n\n<p>So, for example, the link would look something like this (where by the variable parts of the links are listed as VARIABLE:</p>\n\n<pre><code>www.example.com/VARIABLE1&amp;Diff=300&amp;Start=0000VARIABLE2&amp;End=2359VARIABLE3\n</code></pre>\n\n<p>I have already worked out these variables in my excel spreadsheet using a previous macro:</p>\n\n<p>VARIABLE1: This variable is stored in column H, it is an individual variable for each row.</p>\n\n<p>VARIABLE2: This variable is stored in Q8. this is the same for each row, the number is worked out in a previous macro but is the same for every row in the document</p>\n\n<p>VARIABLE3: This variable is stored in R8. this is the same for each row, the number is worked out in a previous macro but is the same for every row in the document</p>\n\n<p>So far i have the following code, but i'm having no luck. It either includes the variable name as text inside the formula in excel, rather than what is stored in the variable or it doesn't work at all. I've tried various ways but no luck:</p>\n\n<pre><code>Dim Variable2 As Long\n\nDim Variable3 As Long\n\nVariable2 = range(\"Q8\").Value\n\nVariable3 = range(\"R8\").Value\n\nrange(\"E2\").FormulaR1C1 = \"=HYPERLINK(\"\"https://www.example.com\"\" &amp; RC[3] &amp; \"\"&amp;Diff=300&amp;Start=0000\"\" &amp; Variable2 &amp; \"\"&amp;End=2359\"\" &amp; Variable 3)\"\n</code></pre>\n\n<p>This formula then needs to be copied down all the way down column 'E' to the last row of data to create a hyperlink for each row of the spreadsheet.</p>\n\n<p>Any help / guidance will be greatly appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "text", "font-size", "userform", "display"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1509561279, "post_id": 47061431, "comment_id": 81070791, "body": "This is very likely a graphical rendering artifact that will appear differently on a variety of displays and/or graphics hardware. Unless you get down to the hardware device-driver level of graphical coding, you won&#39;t be able to guarantee such fine grained pixel placement. (Spoken from years of painful experience)"}, {"owner": {"reputation": 81, "user_id": 8636130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4df4ab32ceea69e1355823354c825d0?s=128&d=identicon&r=PG", "display_name": "L Kadue", "link": "https://stackoverflow.com/users/8636130/l-kadue"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1509566451, "post_id": 47061431, "comment_id": 81073579, "body": "Thank you. Even knowing that it&#39;s unsolvable is so much more valuable than having the question hanging over my head."}], "owner": {"reputation": 81, "user_id": 8636130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4df4ab32ceea69e1355823354c825d0?s=128&d=identicon&r=PG", "display_name": "L Kadue", "link": "https://stackoverflow.com/users/8636130/l-kadue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509561022, "creation_date": 1509561022, "last_edit_date": 1592644375, "question_id": 47061431, "link": "https://stackoverflow.com/questions/47061431/vba-userform-text-of-same-font-size-changes-size-based-on-top-property", "title": "VBA Userform: Text of same font size changes size based on Top property", "body": "<p>I have a userform. In multiple cases across several different controls, I have observed the objects with the same Width, Height, Font, and Font Size display different font sizes depending on where they are placed on my userform.</p>\n<p><a href=\"https://i.stack.imgur.com/sd4VW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sd4VW.png\" alt=\"Example as seen\" /></a> . . . . <a href=\"https://i.stack.imgur.com/rtVZj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rtVZj.png\" alt=\"Example with dots to show measurements\" /></a></p>\n<p>Above is an example of this. The two textbox's are both 26H and 48W, with a Left of 90. Both have font Tahoma Regular size 18. The only difference between them is their Top property. And yet visually, the upper one has much wider text than the lower one. The picture on the right has added dots to prove this is not an optical illusion. The upper one can only fit one dot between the letter and the edge. The lower one can fit at least two dots between the letter and the edge.</p>\n<p>Can anyone explain why this is happening? What is happening? Or how I could stop it from happening?</p>\n"}, {"tags": ["excel", "vba", "passwords"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1509560682, "post_id": 47060804, "comment_id": 81070479, "body": "Why would you want to password-protect the VBA project anyway? Doesn&#39;t this code prove just how pointless this &quot;protection&quot; is?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1509561043, "post_id": 47060804, "comment_id": 81070658, "body": "@Mat&#39;s Mug - it will keep the uninitiated and clueless from mucking around in a shared file&#39;s VBA code.  If the user can crack the code, then they most likely will understand the code and not muck it up."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1509561571, "post_id": 47060804, "comment_id": 81070929, "body": "To be clear, you&#39;re trying to lock a cracked/unlocked VBA project <i>in the same session</i> as it was unlocked, correct? Does it work if you type <code>End</code> in the immediate pane before re-locking? If not, does it work if you close <i>the host process</i> (i.e. Excel, not just the VBE&#39;s main window - that won&#39;t unload it) and then reopen it and <i>then</i> try to re-lock it?"}, {"owner": {"reputation": 9, "user_id": 6022968, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H5CHqnLaQ9g/AAAAAAAAAAI/AAAAAAAAELE/AiIcwDeRRtg/photo.jpg?sz=128", "display_name": "Erick Frederick", "link": "https://stackoverflow.com/users/6022968/erick-frederick"}, "edited": false, "score": 0, "creation_date": 1510340209, "post_id": 47060804, "comment_id": 81409345, "body": "I agree that the protection fairly weak, but it keeps most N0OBs from damaging formulas and what not. I used the code to break open a file that forgot the password to. However, it seems that the code has ruined the functionality altogether."}], "owner": {"reputation": 9, "user_id": 6022968, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H5CHqnLaQ9g/AAAAAAAAAAI/AAAAAAAAELE/AiIcwDeRRtg/photo.jpg?sz=128", "display_name": "Erick Frederick", "link": "https://stackoverflow.com/users/6022968/erick-frederick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509560643, "creation_date": 1509558444, "last_edit_date": 1509560643, "question_id": 47060804, "link": "https://stackoverflow.com/questions/47060804/is-there-a-way-to-crack-the-password-on-an-excel-vba-project-restore-functional", "title": "Is there a way to crack the password on an Excel VBA Project? Restore functionality", "body": "<p>I ran <a href=\"https://stackoverflow.com/a/27508116/1188513\">this VBA code</a> (below) to break open some protection and it worked like a charm. However, I realized there was a dark side to this solution: I am now unable to restore VBA locking on this file.</p>\n\n<p>When I enter a new password after cracking Excel does not recognize the password and I am forced to run the password cracking VBA again. Any ideas how to restore this feature?</p>\n\n<pre><code>Option Explicit\n\nPrivate Const PAGE_EXECUTE_READWRITE = &amp;H40\n\nPrivate Declare Sub MoveMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" _\n    (Destination As Long, Source As Long, ByVal Length As Long)\n\nPrivate Declare Function VirtualProtect Lib \"kernel32\" (lpAddress As Long, _\n    ByVal dwSize As Long, ByVal flNewProtect As Long, lpflOldProtect As     Long) As Long\n\nPrivate Declare Function GetModuleHandleA Lib \"kernel32\" (ByVal lpModuleName As String) As Long\n\nPrivate Declare Function GetProcAddress Lib \"kernel32\" (ByVal hModule As Long, _\n    ByVal lpProcName As String) As Long\n\nPrivate Declare Function DialogBoxParam Lib \"user32\" Alias \"DialogBoxParamA\"     (ByVal hInstance As Long, _\n    ByVal pTemplateName As Long, ByVal hWndParent As Long, _\n    ByVal lpDialogFunc As Long, ByVal dwInitParam As Long) As Integer\n\nDim HookBytes(0 To 5) As Byte\nDim OriginBytes(0 To 5) As Byte\nDim pFunc As Long\nDim Flag As Boolean\n\nPrivate Function GetPtr(ByVal Value As Long) As Long\nGetPtr = Value\nEnd Function\n\nPublic Sub RecoverBytes()\nIf Flag Then MoveMemory ByVal pFunc, ByVal VarPtr(OriginBytes(0)), 6\nEnd Sub\n\nPublic Function Hook() As Boolean\nDim TmpBytes(0 To 5) As Byte\nDim p As Long\nDim OriginProtect As Long\n\nHook = False\n\npFunc = GetProcAddress(GetModuleHandleA(\"user32.dll\"), \"DialogBoxParamA\")\n\n\nIf VirtualProtect(ByVal pFunc, 6, PAGE_EXECUTE_READWRITE, OriginProtect) &lt;&gt; 0 Then\n\n    MoveMemory ByVal VarPtr(TmpBytes(0)), ByVal pFunc, 6\n    If TmpBytes(0) &lt;&gt; &amp;H68 Then\n\n        MoveMemory ByVal VarPtr(OriginBytes(0)), ByVal pFunc, 6\n\n        p = GetPtr(AddressOf MyDialogBoxParam)\n\n        HookBytes(0) = &amp;H68\n        MoveMemory ByVal VarPtr(HookBytes(1)), ByVal VarPtr(p), 4\n        HookBytes(5) = &amp;HC3\n\n        MoveMemory ByVal pFunc, ByVal VarPtr(HookBytes(0)), 6\n        Flag = True\n        Hook = True\n    End If\nEnd If\nEnd Function\n\nPrivate Function MyDialogBoxParam(ByVal hInstance As Long, _\n    ByVal pTemplateName As Long, ByVal hWndParent As Long, _\n    ByVal lpDialogFunc As Long, ByVal dwInitParam As Long) As Integer\nIf pTemplateName = 4070 Then\n    MyDialogBoxParam = 1\nElse\n    RecoverBytes\n    MyDialogBoxParam = DialogBoxParam(hInstance, pTemplateName, _\n                       hWndParent, lpDialogFunc, dwInitParam)\n    Hook\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509561407, "post_id": 47060776, "comment_id": 81070848, "body": "You can write directly to <code>.txt</code> file instead of using <code>Word</code> as intermediary. <a href=\"http://www.excel-easy.com/vba/examples/write-data-to-text-file.html\" rel=\"nofollow noreferrer\">One example</a> of how to do it."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509563610, "post_id": 47060776, "comment_id": 81071993, "body": "@ScottHoltzman I&#39;ll give that a shot tomorrow.  I&#39;ve been reading about that and didn&#39;t see any mention of inserting a whole block of text so it looks like I will need to loop through each row and insert in which may not be faster.  Each text file is about 400 lines (rows) so it may work."}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1509622810, "last_edit_date": 1509622810, "creation_date": 1509621791, "answer_id": 47074090, "question_id": 47060776, "link": "https://stackoverflow.com/questions/47060776/increasing-speed-of-copying-into-word-from-excel-and-saving-document/47074090#47074090", "title": "Increasing speed of copying into Word from Excel and saving document", "body": "<p>If you wanted to continue doing this in MS Word and save as a text file, there are a few things to be aware of...</p>\n\n<p>1 - You've created a <code>wrdDoc</code> but don't seem to use it. </p>\n\n<p>2 - You can replace this:</p>\n\n<pre><code>With wrdapp\n  .Selection.PasteAndFormat (wdFormatPlainText)\n  .Visible = True\n  .Selection.WholeStory\nEnd With\n</code></pre>\n\n<p>with this:</p>\n\n<p><code>wrdDoc.Range.Paste</code></p>\n\n<p>3 - You don't really need this if you're saving as a text file...</p>\n\n<pre><code>With wrdapp.Selection.ParagraphFormat\n  .SpaceBefore = 0\n  .SpaceBeforeAuto = False\n  .SpaceAfter = 0\n  .SpaceAfterAuto = False\n  .LineUnitBefore = 0\nEnd With\n</code></pre>\n\n<p>4 - And finally, to close the document and leave the application open you can do this: <code>wrdDoc.Close</code> <em>(i.e. use the document you created)</em> instead of  <code>wrdapp.Quit</code> <em>(shutting down the Word application)</em></p>\n\n<p>All that aside, yes you can write directly to text file as suggested by @ScottHoltzman </p>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509622810, "creation_date": 1509558354, "last_edit_date": 1531164843, "question_id": 47060776, "link": "https://stackoverflow.com/questions/47060776/increasing-speed-of-copying-into-word-from-excel-and-saving-document", "title": "Increasing speed of copying into Word from Excel and saving document", "body": "<p>I have some code that loops through rows, finds a desired area to copy, copies it to Word and then saves it as a \"txt\" file.  It works fine but is rather slow when running on full size samples where it is creating 80+ files.  I believe this is because the code below is opening and closing Word every time it runs rather than leave it open but I'm not sure how to get it to stay open and create new documents.  Is there a way to do that or another way to speed the code up?</p>\n\n<pre><code>Set wrdapp = CreateObject(\"Word.Application\")\nwrdapp.Visible = False\n\nSet wrddoc = wrdapp.Documents.Add\nRows(endingrow + 1).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nCells(endingrow + 1, \"A\").Value = \"%\"\nRows(startingrow).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nCells(startingrow, \"A\").Value = \"%\"\nendingrow = endingrow + 2\nRange(Cells(startingrow, \"A\"), Cells(endingrow, \"A\")).Copy\n\nWith wrdapp\n.Selection.PasteAndFormat (wdFormatPlainText)\n.Visible = True\n.Selection.WholeStory\nEnd With\n\nWith wrdapp.Selection.ParagraphFormat\n    .SpaceBefore = 0\n    .SpaceBeforeAuto = False\n    .SpaceAfter = 0\n    .SpaceAfterAuto = False\n    .LineUnitBefore = 0\nEnd With\n\nwrdapp.ChangeFileOpenDirectory GetFolder\nwrdapp.ActiveDocument.SaveAs2 filename:=filename, FileFormat:= _\nwdFormatText, LockComments:=False, Password:=\"\", AddToRecentFiles _\n:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _\n:=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _\nSaveAsAOCELetter:=False\nwrdapp.Quit\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office", "protection"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1509558617, "post_id": 47060744, "comment_id": 81069225, "body": "Write a module to test whether the file is located in a sanctioned network directory on workbook open. You simply need to test the path of the current workbook and check against a list of approved locations. Could you post the code that you have attempted so far?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1509563566, "post_id": 47060744, "comment_id": 81071975, "body": "There&#39;s nothing you can do that will 100% prevent the file from being copied, or moved. This is a people concern, not a programming issue. Case in point: attach it to an email, send it to yourself, open the attachment - Excel disables macros by default, defeating any VBA &quot;protection&quot; you could come up with."}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1509559292, "post_id": 47060882, "comment_id": 81069626, "body": "Good call to allow for the workbook name to change. I hadn&#39;t thought about that."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1509559367, "post_id": 47060882, "comment_id": 81069671, "body": "The question stated &quot; if the filepath or directory changes&quot;, not the name."}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1509559596, "post_id": 47060882, "comment_id": 81069810, "body": "of course, the user can circumvent this just by saving the file as .xlsx and then close and open."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509559825, "post_id": 47060882, "comment_id": 81069949, "body": "Except the file will close before it can be saved (could be a problem if your directory changes) and it will lose any macros (has to be saved as xlsm for this macro to work.)  Remember that ctl-Break can be used to pause macros."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1509563444, "post_id": 47060882, "comment_id": 81071905, "body": "<code>If [literal] &lt;&gt; [member-expression]</code> (as opposed to <code>If [member-expression] &lt;&gt; [literal]</code>) is rather uncommon, and there&#39;s a name for it: it&#39;s a <i>Yoda condition</i>, and it&#39;s backwards. There&#39;s no reason whatsoever to do that in VBA."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 1, "last_activity_date": 1509558760, "creation_date": 1509558760, "answer_id": 47060882, "question_id": 47060744, "link": "https://stackoverflow.com/questions/47060744/excel-file-has-to-be-protected-from-moving-or-copying/47060882#47060882", "title": "Excel File has to be protected from Moving or Copying", "body": "<p>Can you hard code the address into the Open event to check if the file is the same?   </p>\n\n<pre><code>Private Sub Workbook_Open()\nIf \"C:\\Excel\\\" &lt;&gt; ThisWorkbook.Path Then ThisWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "is_accepted": false, "score": 1, "last_activity_date": 1509560447, "last_edit_date": 1509560447, "creation_date": 1509559091, "answer_id": 47060962, "question_id": 47060744, "link": "https://stackoverflow.com/questions/47060744/excel-file-has-to-be-protected-from-moving-or-copying/47060962#47060962", "title": "Excel File has to be protected from Moving or Copying", "body": "<p>Set an event to trigger any time the workbook is open to check the filename. If the filename is not your specified path, close the workbook.</p>\n\n<p>Paste the code in <code>ThisWorkbook</code> in the VBA editor:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim FileLoc, MyPath As String\n    FileLoc = ThisWorkbook.Path\n    MyPath = \"C:\\Excel\\\"\n\n    If FileLoc &lt;&gt; MyPath Then\n        MsgBox (\"The workbook was not in the required filepath.\" _\n            &amp; vbNewLine &amp; \"The reuqired filepath is: \" &amp; MyPath _\n            &amp; vbNewLine &amp; \"The current filepath is: \" &amp; FileLoc)\n        Application.DisplayAlerts = False\n        ThisWorkbook.Close\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8869703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc05b522f673b32d224b8c7d8c81f91?s=128&d=identicon&r=PG&f=1", "display_name": "Keshav K", "link": "https://stackoverflow.com/users/8869703/keshav-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2097, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509560838, "creation_date": 1509558224, "last_edit_date": 1509560838, "question_id": 47060744, "link": "https://stackoverflow.com/questions/47060744/excel-file-has-to-be-protected-from-moving-or-copying", "title": "Excel File has to be protected from Moving or Copying", "body": "<p>I have an excel sheet which is in one particular network where my employees are supposed to report. I've make it protected with password, but I would like to protect it with VBA where, if the filepath or directory changes, the file should not open. for example if the file is in \"C:\\Excel\\Book1.xlms\", it has to be there always to work or the file shouldn't open.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509558360, "post_id": 47060721, "comment_id": 81069054, "body": "See the <code>Dir</code> function."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509558519, "post_id": 47060721, "comment_id": 81069166, "body": "Google-fu: <a href=\"https://www.google.com/search?newwindow=1&amp;safe=off&amp;ei=4Af6WeHqMaekjwS15b-gDA&amp;q=CreateObject%28&quot;Scripting.FileSystemObject&quot;%29++all+files&amp;oq=CreateObject%28&quot;Scripting.FileSystemObject&quot;%29++all+files\" rel=\"nofollow noreferrer\">that was hard</a>."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1509558672, "post_id": 47060721, "comment_id": 81069261, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1509558754, "creation_date": 1509558754, "answer_id": 47060876, "question_id": 47060721, "link": "https://stackoverflow.com/questions/47060721/how-to-loop-through-all-the-files-in-a-directory/47060876#47060876", "title": "How to loop through all the files in a directory", "body": "<p>You can use the <code>Dir</code> function. As an example:</p>\n\n<pre><code>ChDir \"C:\\MyDir\"\nnextfile = Dir(\"*.b64\")\nWhile (nextfile &lt;&gt; \"\")\n    delline nextfile\n    nextfile = Dir()\nWend\n</code></pre>\n\n<p>and declare <code>delline</code> as</p>\n\n<pre><code>Sub delline(filename)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1509558978, "creation_date": 1509558978, "answer_id": 47060930, "question_id": 47060721, "link": "https://stackoverflow.com/questions/47060721/how-to-loop-through-all-the-files-in-a-directory/47060930#47060930", "title": "How to loop through all the files in a directory", "body": "<p>Since you already are using the FileSystemObject...</p>\n\n<pre><code>Dim oFile as File\nDim oFolder as Folder\nIf objFSO.FolderExists(&lt;Your Path&gt;) Then\n    Set oFolder = objFSO.GetFolder(&lt;Your Path&gt;)\n    For Each oFile In oFolder.Files\n        ... YOUR CODE\n\n    Next\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8785639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DV-3qVo9vAE/AAAAAAAAAAI/AAAAAAAAAAA/dh9Um0-4IkE/photo.jpg?sz=128", "display_name": "JayeshG", "link": "https://stackoverflow.com/users/8785639/jayeshg"}, "edited": false, "score": 0, "creation_date": 1509561739, "post_id": 47061052, "comment_id": 81071029, "body": "Wow, perfect! Thanks Shri!"}, {"owner": {"reputation": 3, "user_id": 8785639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DV-3qVo9vAE/AAAAAAAAAAI/AAAAAAAAAAA/dh9Um0-4IkE/photo.jpg?sz=128", "display_name": "JayeshG", "link": "https://stackoverflow.com/users/8785639/jayeshg"}, "edited": false, "score": 0, "creation_date": 1509561989, "post_id": 47061052, "comment_id": 81071157, "body": "Thanks all for your time and help! Appreciate it!"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 0, "last_activity_date": 1509559449, "creation_date": 1509559449, "answer_id": 47061052, "question_id": 47060721, "link": "https://stackoverflow.com/questions/47060721/how-to-loop-through-all-the-files-in-a-directory/47061052#47061052", "title": "How to loop through all the files in a directory", "body": "<p>You can also use options in FSO which you have declared as below.</p>\n\n<pre><code>Sub dellineallfilesinafolder()\n\nDim objFSO As Object\nDim objStream As Object\nDim objFil As Object ' File Object\nDim sLines\nDim iNumberOfLines\nDim i\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nFor Each objFil In objFSO.GetFolder(\"C:\\Testing\").Files\n    If LCase(objFSO.GetExtensionName(objFil.Path)) = \"b64\" Then\n        Set objStream = objFSO.OpenTextFile(objFil.Path, 1)\n        sLines = Split(objStream.ReadAll, vbCrLf)\n        objStream.Close\n\n        iNumberOfLines = UBound(sLines)\n\n        If iNumberOfLines &gt; 2 Then\n            Set objStream = objFSO.OpenTextFile(objFil.Path, 2)\n            For i = 1 To iNumberOfLines - 2\n                objStream.WriteLine sLines(i)\n            Next\n            objStream.Close\n        End If\n    End If\nNext objFil\n\nSet objStream = Nothing\nSet objFil = Nothing\nSet objFSO = Nothing\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8785639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DV-3qVo9vAE/AAAAAAAAAAI/AAAAAAAAAAA/dh9Um0-4IkE/photo.jpg?sz=128", "display_name": "JayeshG", "link": "https://stackoverflow.com/users/8785639/jayeshg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6843, "favorite_count": 0, "accepted_answer_id": 47061052, "answer_count": 3, "score": 0, "last_activity_date": 1509559449, "creation_date": 1509558132, "last_edit_date": 1531164843, "question_id": 47060721, "link": "https://stackoverflow.com/questions/47060721/how-to-loop-through-all-the-files-in-a-directory", "title": "How to loop through all the files in a directory", "body": "<p>My query is how to loop through all the files in a specific folder?</p>\n\n<p>I\u2019ve vba code snippet which deletes first and last line of \u201c.b64\u201d file. I want to achieve the same task with all the \u201c.b64\u201d files in a specific folder. Can someone help me tweak this code to loop it?</p>\n\n<p>Here is a code...</p>\n\n<hr>\n\n<pre><code>Sub delline()\n\nDim objFSO As Object\nDim objStream As Object\nDim sLines\nDim iNumberOfLines\nDim i\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objStream = objFSO.OpenTextFile(\"C:\\Testing\\test1.b64\", 1)\nsLines = Split(objStream.ReadAll, vbCrLf)\nobjStream.Close\n\niNumberOfLines = UBound(sLines)\n\nIf iNumberOfLines &gt; 2 Then\n    Set objStream = objFSO.OpenTextFile(\"C:\\Testing\\test1.b64\", 2)\n    For i = 1 To iNumberOfLines - 2\n        objStream.WriteLine sLines(i)\n    Next\n    objStream.Close\nEnd If\n\nSet objStream = Nothing\nSet objFSO = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thanks!\nJack</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8869559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c741425a17d5bbcc39bcb739e9d975b?s=128&d=identicon&r=PG&f=1", "display_name": "TaxingTimes", "link": "https://stackoverflow.com/users/8869559/taxingtimes"}, "edited": false, "score": 0, "creation_date": 1509614767, "post_id": 47060510, "comment_id": 81091379, "body": "Hi Tom - thanks for the code, I agree that is much easier! The code is contained within the sheet object (&quot;Build Detail&quot;), but the problem lies with the drop down being on a separate worksheet - is there a way around this? To work around this, I have tried to link the output of the dropdown (on &quot;Topsheet&quot;) to a cell on &quot;Build Detail&quot; but while this changes the value in &#39;Build Details&#39;!E6, the rows do not become hidden until &#39;Build Details&#39;!E6 is double clicked and enter is hit - hence becoming rather manual."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1509558170, "last_edit_date": 1509558170, "creation_date": 1509557369, "answer_id": 47060510, "question_id": 47060286, "link": "https://stackoverflow.com/questions/47060286/vba-using-drop-down-lists-on-other-worksheets-to-hide-rows-automatically/47060510#47060510", "title": "VBA using drop down lists on other worksheets to hide rows automatically", "body": "<p>Your code can be massively simplified. Try using this (You'll have to update the sheet name if it's not the same as yours)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Sheets(\"SheetWithRowsToBeHidden\").Rows(\"3:8\").EntireRow.Hidden = IIf(Me.Range(\"D27\").Value2 = \"Yes\", True, False)\nEnd Sub\n</code></pre>\n\n<p>Also, where have you put this code? Have you put it inside a Module or is it in the Sheet Object? It needs to be in the Sheet Object that has the dropdowns on.</p>\n"}], "owner": {"reputation": 1, "user_id": 8869559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c741425a17d5bbcc39bcb739e9d975b?s=128&d=identicon&r=PG&f=1", "display_name": "TaxingTimes", "link": "https://stackoverflow.com/users/8869559/taxingtimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509566733, "creation_date": 1509556623, "last_edit_date": 1531164843, "question_id": 47060286, "link": "https://stackoverflow.com/questions/47060286/vba-using-drop-down-lists-on-other-worksheets-to-hide-rows-automatically", "title": "VBA using drop down lists on other worksheets to hide rows automatically", "body": "<p>Afternoon all!</p>\n\n<p>I am using the results of various drop down lists to hide the relevant rows on a spreadsheet as the value on the drop down list is changed (so automatically).</p>\n\n<p>With some googling, I have come across the below set up which works nicely, although I have now hit a snag when trying to specify drop down list cell from another worksheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim disabled As Boolean\n    If Range(\"D2\") = \"Yes\" Then\n        disabled = True\n    End If\n\n    If disabled Then\n        Rows(\"3:8\").EntireRow.Hidden = False\n    Else        \n        Rows(\"3:8\").EntireRow.Hidden = True\n    End If\n\nEnd sub\n</code></pre>\n\n<p>Using the following has not worked, and googling for a solution has lead me up many a dead end:</p>\n\n<pre><code>If Sheets(\"Topsheet\").Range(\"D27\") = \"Yes\" Then\n</code></pre>\n\n<p>Am I unable to use values from a neighbouring sheet when declaring a variable due to it being a private sub?</p>\n\n<p>Any help would be much appreciated as I have been stumped on this for a couple of hours!</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1509556492, "post_id": 47060110, "comment_id": 81067979, "body": "<i>Or does vba not allow for the ad-hoc modification of the For loop variable, in this case &#39;WS_Count&#39;. Does it just see the original value instead?</i> - This is how it works. You cannot adjust the ending count during the loop. I am sure there are ways around it and even answers for it on this site. (I don&#39;t know off top of head though). If adding a new worksheet is not conditional then just do so before loop. Or try a <code>Do Until Loop</code> where you can adjust the value of <code>WS_COUNT</code> and have the Until check update with each iteration. Like <code>Do Until i&gt;WS_COUNT</code> or something."}, {"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509556706, "post_id": 47060110, "comment_id": 81068123, "body": "@Soctt thanks for the reply, I wondered if that was the case but thought it seemed like a stupid thing to happen considering you can use variables within the for loop.. Let&#39;s see if there is a work around or I&#39;ll have a look at doing the loop before, I think it will just be a lot more inefficient, but if it works, it works"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 2, "creation_date": 1509556801, "post_id": 47060110, "comment_id": 81068185, "body": "If you are not sure about the upper limit, its better to use <code>Do</code>/<code>While</code> Loop. That&#39;s the only elegant solution for you."}, {"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 0, "creation_date": 1509556831, "post_id": 47060110, "comment_id": 81068205, "body": "If you were to change the For loop to a While (I &lt;= WS_Count) that should work. You&#39;ll have to define I outside the loop and increment I at the end of each iteration"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509556843, "post_id": 47060110, "comment_id": 81068212, "body": "Use <code>while</code>, which also supports the empty loop (i.e. no iterations if begin &gt; end)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1509556991, "post_id": 47060110, "comment_id": 81068298, "body": "The the other thing to consider is that if adding sheets is <b>not conditional</b> then a Do While Loop will be infinite."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1509561135, "post_id": 47060110, "comment_id": 81070706, "body": "FYI - It&#39;s similar to using a <code>For Each WS in Thisworkbook.Sheets</code> loop, once the For Each (and for i = x to y) is initialised it can&#39;t be altered. If I add a sheet for each sheet in the book then it doesn&#39;t start counting those added sheets and go on infinitely."}], "owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509556023, "creation_date": 1509556023, "question_id": 47060110, "link": "https://stackoverflow.com/questions/47060110/for-loop-with-to-variable", "title": "For loop with To Variable", "body": "<p>I'm having a slightly bizarre issue.</p>\n\n<p>I have the following loop (just a snippet as the code is rather large):</p>\n\n<pre><code>Dim WS_Count As Integer\nDim wsName As String\nDim A As Integer\nDim ExtraArray() As Variant\n\nFor I = 1 To WS_Count\n\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n     'Some Code'\n     Sheets(wsName).Copy After:=Sheets(wsName)\n     Sheets(wsName + \" (2)\").Name = ExtraArray(A, 2)\n     I = I + 1\n\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\nNext I\n</code></pre>\n\n<p>There is a lot of other code but I do not believe this to be the problem.</p>\n\n<p>If I add additional sheets whilst in the For loop and add 1 to I and also recalculate WS_Count at the end of the For loop and at the beginning of the loop to make sure it is correct, should this in theory work?</p>\n\n<p>Or does vba not allow for the ad-hoc modification of the For loop variable, in this case 'WS_Count'. Does it just see the original value instead?</p>\n\n<p>My loop works up until a certain point (roughly the original number held in WS_Count and then I resets back to 0.</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "range"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509558295, "post_id": 47059796, "comment_id": 81069015, "body": "What are you trying to do with this line? Set my_constr_range = Range(Cells(my_constr_range) &amp; Cells(rngCell.Value))     The value of rngCell.value is &quot;--&quot; ,how is that supposed to work with Cells()?"}, {"owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509567922, "post_id": 47059796, "comment_id": 81074317, "body": "I tried to copy all the elements into a new range object up until hitting \u2014, or as an alternative if it is easier crop everything after \u2014"}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1509630291, "post_id": 47063220, "comment_id": 81102037, "body": "I tried your solution, can you please give me some more information on how this works. rw is the row number where my -- is located, lrw is the rows included in my range variable, how would rows(rw : lrw) cover only the first 3 rows? Lets say rw = 100. Or maybe the real question is how do I save it back into my new range"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1509647934, "post_id": 47063220, "comment_id": 81114086, "body": "This would delete the rows you don&#39;t want."}, {"owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1509648120, "post_id": 47063220, "comment_id": 81114189, "body": "I have updated my question with an intermediate solution that I found but it looks like it doesn&#39;t get me a deep copy of my range and just uses the pointer and therefore deletes the content on the worksheet and not just in the copy of the object"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1509648462, "post_id": 47063220, "comment_id": 81114379, "body": "Is &quot;Constr&quot; a named range?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1509649153, "post_id": 47063220, "comment_id": 81114740, "body": "I added to my answer, you will have to incorporate it into you macro."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1509649021, "last_edit_date": 1509649021, "creation_date": 1509568415, "answer_id": 47063220, "question_id": 47059796, "link": "https://stackoverflow.com/questions/47059796/remove-parts-of-range-variable-after-specific-string-element/47063220#47063220", "title": "Remove parts of Range variable after specific string element", "body": "<p>Then something like this will delete the rows you don't want.</p>\n\n<pre><code>rw = Range(\"Constr\").Find(What:=\"--\", LookIn:=xlValues, LookAt:=xlWhole).Row\nlrw = Range(\"Constr\").Rows.Count\nRows(rw &amp; \":\" &amp; lrw).Delete\n</code></pre>\n\n<p>This will change your named range:\nSet nr = Range(\"Constr\")   </p>\n\n<p>' give an absolute reference:\nnr.RefersTo = \"=Sheet1!$A$2:$C$\" &amp; rw-1</p>\n"}], "owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 47063220, "answer_count": 1, "score": 0, "last_activity_date": 1509649021, "creation_date": 1509555006, "last_edit_date": 1509639607, "question_id": 47059796, "link": "https://stackoverflow.com/questions/47059796/remove-parts-of-range-variable-after-specific-string-element", "title": "Remove parts of Range variable after specific string element", "body": "<p>I have a range variable (called Constr) that is based on date that looks like this</p>\n\n<pre><code>Type    Bound1    Bound2    Var1    Var2\nX       1         2         3       4\nY       1         2         3       4\n--  \nZ       1         2         3       4\n</code></pre>\n\n<p>at the moment I am reading in the whole range, all 4 lines. But I am only interested in the first 2, the '--' should by my threshold.</p>\n\n<p>What I tried to do so far is to loop through the range object and check for the \"--\" and copy everything before that into a new range object. But it doesn't seem to work.</p>\n\n<pre><code>Dim my_constr_range As Range\nDim rngCell As Range\nFor Each rngCell In Range(\"Constr\")\n    If rngCell.Value = \"--\" Then\n        Set my_constr_range = Range(Cells(my_constr_range) &amp; Cells(rngCell.Value))\n    End If\nNext   \n</code></pre>\n\n<p>Can someone tell me how to copy the data into a new range object or is there any better way of removing the entries after the double dash \"--\"</p>\n\n<p>EDIT: Partial solution</p>\n\n<p>So after playing around with VBA for a while I got to a point where I remove the correct rows and end up with a range object as I wanted, but unfortunately it removed the rows in my actual worksheet whereas I only wanted them to disappear in my range object.</p>\n\n<p>Here is the code I came up with:</p>\n\n<pre><code>Dim Lrange As Range\nDim n As Long\nSet Lrange = Range(\"Constr\")\n\nFor n = Lrange.Rows.Count To 1 Step -1\n    If Lrange.Cells(n, 1).Value &lt;&gt; \"--\" Then\n        Lrange.Rows(n).Delete\n    ElseIf Lrange.Cells(n, 1).Value = \"--\" Then\n        Exit For\n    End If\nNext\n\nmyitem(\"Constr\") = Lrange.Value\n</code></pre>\n\n<p>How is VBA referencing back to the actual range on the worksheet, I would have thought it was working on the copied data in memory? </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 1, "creation_date": 1509554535, "post_id": 47059438, "comment_id": 81066744, "body": "Don&#39;t have an answer, but have you tried Range(&quot;A3&quot;).FormulaR1C1?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509554980, "post_id": 47059438, "comment_id": 81067034, "body": "Is there <b>anything</b> at all different about that cell? Like anything... may need to dig for differences ..."}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509557304, "post_id": 47059438, "comment_id": 81068474, "body": "@ScottHoltzman I&#39;ve been looking for the last 30 minutes. I&#39;ve resorted to copying a cell that I know works (the one above it) and changing the 5 digit code to see if that helps. Unfortunately that didn&#39;t change the result."}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1509557523, "post_id": 47059438, "comment_id": 81068601, "body": "@ExcelDevelopers I get the same result from <code>.FormulaR1C1</code>"}], "owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509557673, "creation_date": 1509553722, "last_edit_date": 1531161705, "question_id": 47059438, "link": "https://stackoverflow.com/questions/47059438/range-formula-property-not-returning-expected-value", "title": "Range.Formula property not returning expected value", "body": "<p>I'm trying to get some information out of a formula in one of my excel sheets. The problem is, it isn't returning the value I expect it to be.</p>\n\n<p>Here is my formula in the cell:</p>\n\n<p><code>=\"10000: \" &amp; INDEX('path\\to\\other\\file\\[file.xlsx]sheetName'!$B:$B, MATCH(10000, 'path\\to\\other\\file\\[file.xlsx]sheetName'!$A:$A, 0))</code></p>\n\n<p>The formula within the cell results in the expected value, but when I use <code>Range(\"A3\").Formula</code> it returns the value of the cell, not the formula.</p>\n\n<p>This only happens on one cell of a specific sheet. I loop through about ~120 sheets with about ~200 cells collectively and all other cells return expected results. All other cells have the same formula with a different number to match a different string. According to the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel\" rel=\"nofollow noreferrer\">Range.Formula documentation</a> this shouldn't be happening. What is going wrong?</p>\n\n<p><strong>Edit 1:</strong></p>\n\n<p>The two suggestions I've tried so far:</p>\n\n<p><code>.FormulaR1C1</code> returns the same result as <code>.Formula</code></p>\n\n<p>I couldn't find any differences between the cells that work and the one that doesn't so I copied a known functional cell and changed the number within the formula to get the information I wanted. This still gives the same results.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1509550934, "post_id": 47058502, "comment_id": 81064359, "body": "start at last row of data and work your way up"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509551026, "post_id": 47058502, "comment_id": 81064427, "body": "@jsotola do you mean using a step -1 in the for loop??"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509551628, "post_id": 47058502, "comment_id": 81064864, "body": "Why not start your for each loop at the bottom and delete rows as you find them?  You are using two For loops instead of one and say it&#39;s faster?"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509551867, "post_id": 47058502, "comment_id": 81065013, "body": "Yea looking at it I probably could have written it that way. So @mooseman, you mean append 2nd loop to 1st and put the DELETE after the dRows(i) string?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509552344, "post_id": 47058502, "comment_id": 81065338, "body": "do it on paper, write down all the steps that you need to do, then convert the steps to code."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509552550, "post_id": 47058502, "comment_id": 81065479, "body": "Where you would add the row number to the array, just delete the row, do like jsotola said and work from the last row (highest number) to the first row (lowest number)"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509553132, "post_id": 47058502, "comment_id": 81065857, "body": "Thanks guys for pointing me in the right direction. You&#39;re right @jsotola, I really should write it down first ."}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "edited": false, "score": 0, "creation_date": 1509556941, "post_id": 47059264, "comment_id": 81068271, "body": "Ah I see. This is clever. Appending the rows using the UNION method."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1509553177, "creation_date": 1509553177, "answer_id": 47059264, "question_id": 47058502, "link": "https://stackoverflow.com/questions/47058502/vba-loop-through-empty-rows-in-a-range-and-delete-all-in-a-batch-one-line/47059264#47059264", "title": "VBA_Loop through empty rows in a range and delete all in a batch (one-line)", "body": "<p>This is what typically get proposed for this task here:</p>\n\n<pre><code>Sub Tester()\n    '...\n    '...\n    Dim rngDelete As Range\n\n    For Each cRow In cSht.UsedRange.Rows\n        If WorksheetFunction.CountA(cRow.Cells) = 0 Then\n            If rngDelete Is Nothing Then\n                Set rngDelete = cRow.EntireRow\n            Else\n                Set rngDelete = Application.Union(rngDelete, cRow.EntireRow)\n            End If\n        End If\n    Next cRow\n\n    'delete rows if any found\n    If Not rngDelete Is Nothing Then rngDelete.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47059264, "answer_count": 1, "score": 0, "last_activity_date": 1509553177, "creation_date": 1509550769, "question_id": 47058502, "link": "https://stackoverflow.com/questions/47058502/vba-loop-through-empty-rows-in-a-range-and-delete-all-in-a-batch-one-line", "title": "VBA_Loop through empty rows in a range and delete all in a batch (one-line)", "body": "<p>I have developed the code below which  loops through usedrange , stores the row strings into an array of 20 elements, and then deletes the rows at the end, as I find this a lot quicker than a FOR or a DO loop given a large amount of rows. The code works, however, the issue lies with the fact that when the rows are written to the array element they are hard coded, and when the .DELETE method is used , the rows shift accordingly, so the numbers shift and not everything is deleted.</p>\n\n<p>Is there a way to delete an array of ranges in one batch or one line, something like</p>\n\n<pre><code>Arr(drows(1 to 20)).delete\n</code></pre>\n\n<p>Or do I have to find an alternative?</p>\n\n<pre><code>'**** NEEDS RE-WORK --&gt; ADJUST FOR ROWS WHEN DELETING ****'\n\n    Sub loop_it()\n    Dim i As Integer        'counter for array\n    Dim j As Integer        'counter # 2\n    Dim rD As Integer       'count deleted\n    Dim z As Integer\n    Dim dRows(20) As String 'will track the rows deleted1\n    Dim cRow As Range       'current row\n    Dim cSht As Worksheet\n    Dim uB As Integer\n    Set cSht = ActiveSheet  'activesheet\n    i = 1: j = 1: z = 1\n    On Error GoTo viewerr\n    For Each cRow In cSht.UsedRange.Rows\n        If WorksheetFunction.CountA(cRow.Cells) = 0 Then\n            If Len(dRows(i)) &lt; 250 Then             'not to breach length\n            dRows(i) = dRows(i) &amp; cRow.Row &amp; \":\" &amp; cRow.Row &amp; \",\"\n            rD = rD + 1                 'increment # rows deleted\n            Else\n            dRows(i) = dRows(i)         'nothing\n            i = i + 1\n            End If\n        End If\n    Next cRow\n\n    uB = UBound(dRows)                  'max array\n\n    For j = 1 To uB\n        If j &lt;= i Then                                      'skip empty strings\n        dRows(j) = Left(dRows(j), Len(dRows(j)) - z)       ' trim last comma off of string\n        cSht.Range(dRows(j)).Delete                         'delete the rows\n        Else\n        Exit For\n        End If\n    Next j\n\n    'need to combine the text string into one array\n\n    MsgBox rD &amp; Chr(32) &amp; \"rows deleted!\", vbExclamation + vbOKOnly, \"success!\"\n    Erase dRows             'clear array\n\n    Exit Sub\n    viewerr:\n    MsgBox Err.Description &amp; Space(2), vbCritical\n    Erase dRows\n\n    End Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "solver"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509550898, "post_id": 47058442, "comment_id": 81064336, "body": "Do you want all possible combinations or just one.  This seems like a fairly straight forward algorithm problem."}, {"owner": {"reputation": 2511, "user_id": 2859614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/N21aX.jpg?s=128&g=1", "display_name": "MackM", "link": "https://stackoverflow.com/users/2859614/mackm"}, "edited": false, "score": 0, "creation_date": 1509551031, "post_id": 47058442, "comment_id": 81064431, "body": "Hello mmoilanen, we like to keep questions pretty to-the-point here so I edited out part of your question.  Feel free to edit it again if you aren&#39;t happy with the changes."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1509552715, "post_id": 47058442, "comment_id": 81065576, "body": "One approach would be to select the <code>X</code> members from the list that are closest to <code>Y</code> (e.g. select the <code>X</code> smallest of <code>ABS(n-Y)</code>, where <code>n</code> is a member of the list). This approach may not give the &quot;best&quot; solution, but maybe it&#39;s good enough. Should be easy to implement in either VBA or SQL."}, {"owner": {"reputation": 13, "user_id": 8869050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05586dc82b2592759071f32200624b24?s=128&d=identicon&r=PG&f=1", "display_name": "mmoilanen", "link": "https://stackoverflow.com/users/8869050/mmoilanen"}, "reply_to_user": {"reputation": 2511, "user_id": 2859614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/N21aX.jpg?s=128&g=1", "display_name": "MackM", "link": "https://stackoverflow.com/users/2859614/mackm"}, "edited": false, "score": 0, "creation_date": 1509554246, "post_id": 47058442, "comment_id": 81066552, "body": "Thanks @MackM! @mooseman, looking for all possible combinations."}, {"owner": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "edited": false, "score": 0, "creation_date": 1509568952, "post_id": 47058442, "comment_id": 81074819, "body": "Excel solver should have no problem with this, Introduce binary cells indicating if it is part of your subset. A constraint is that the sum of the binaries is 3. Then minimize squared deviation from target (target=3*70) based on binary*value. You can even linearize and use simplex."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1509551255, "creation_date": 1509551255, "answer_id": 47058681, "question_id": 47058442, "link": "https://stackoverflow.com/questions/47058442/select-x-s-from-list-that-average-y/47058681#47058681", "title": "Select X #s from list that average Y", "body": "<p>I have a possible solution for that:</p>\n\n<ol>\n<li>Populate your values to an array</li>\n<li>Calculate your average</li>\n<li>Find the exact or approximate value in the array.</li>\n<li>Get The value, 1 value after and 1 value before.</li>\n</ol>\n\n<p>You can change the criteria of the point 4.</p>\n"}, {"tags": [], "owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1509551720, "creation_date": 1509551720, "answer_id": 47058838, "question_id": 47058442, "link": "https://stackoverflow.com/questions/47058442/select-x-s-from-list-that-average-y/47058838#47058838", "title": "Select X #s from list that average Y", "body": "<pre><code>DECLARE @Table AS TABLE (I INT)\nINSERT INTO @Table VALUES (30),(40),(50),(60),(70),(80),(90),(100),(110)\n\nSELECT\n    DISTINCT\n    N1 = CASE\n          WHEN t1.I &lt; t2.I AND t1.I &lt; t3.I THEN t1.I\n          WHEN t2.I &lt; t1.I AND t2.I &lt; t3.I THEN t2.I\n          ELSE t3.I\n    END\n    ,N2 = CASE\n          WHEN t1.I &gt; t2.I AND t1.I &lt; t3.I THEN t1.I\n          WHEN t1.I &lt; t2.I AND t1.I &gt; t3.I THEN t1.I\n          WHEN t2.I &gt; t1.I AND t2.I &lt; t3.I THEN t2.I\n          WHEN t2.I &lt; t1.I AND t2.I &gt; t3.I THEN t2.I\n          ELSE t3.I\n    END\n    ,N3 = CASE\n          WHEN t1.I &gt; t2.I AND t1.I &gt; t3.I THEN t1.I\n          WHEN t2.I &gt; t1.I AND t2.I &gt; t3.I THEN t2.I\n          ELSE t3.I\n    END\nFROM\n    @Table t1\n    CROSS JOIN @Table t2\n    CROSS JOIN @Table t3\nWHERE\n    t1.I &lt;&gt; t2.I\n    AND t1.I &lt;&gt; t3.I\n    AND t2.I &lt;&gt; t3.I\n    AND (SELECT AVG(V) FROM (VALUES(t1.I),(t2.I),(t3.I)) t(V)) = (SELECT AVG(I) FROM @Table)\n</code></pre>\n\n<p>Basically you have to look at all possible combinations of 3 numbers to determine if the average will be 70.  This can be extremely taxing on system resources if you have a large table.  There would be someways of limiting it to reduce overhead such as seeing if all 3 numbers are less than the average or greater than the average. etc.  When you are doing all of the combinations you will also get duplicate pairs/rows so you have to order the values in such a manner so that you can get distinct values.  Such as first column/number is the smallest, second the second, third the greatest...</p>\n"}, {"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1509554558, "creation_date": 1509554558, "answer_id": 47059659, "question_id": 47058442, "link": "https://stackoverflow.com/questions/47058442/select-x-s-from-list-that-average-y/47059659#47059659", "title": "Select X #s from list that average Y", "body": "<p>Here's a SQL approach based on my comment:</p>\n\n<pre><code>SELECT t.n\nFROM t\nORDER BY ABS(t.n-70) ASC\nLIMIT 3;\n</code></pre>\n\n<p>assuming you want 3 numbers whose average is close to 70.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 13, "user_id": 8869050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05586dc82b2592759071f32200624b24?s=128&d=identicon&r=PG&f=1", "display_name": "mmoilanen", "link": "https://stackoverflow.com/users/8869050/mmoilanen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47058838, "answer_count": 3, "score": 1, "last_activity_date": 1509554558, "creation_date": 1509550573, "last_edit_date": 1509551431, "question_id": 47058442, "link": "https://stackoverflow.com/questions/47058442/select-x-s-from-list-that-average-y", "title": "Select X #s from list that average Y", "body": "<p>I have a list of numbers. I need to find a way to select X of those numbers that average to approximately Y.</p>\n\n<p>As a simplified example, let's say my list is:</p>\n\n<p><code>30, 40, 50, 60, 70, 80, 90, 100, 110</code></p>\n\n<p>and I need to find a combination of three of the numbers that average to approximately 70. Possible solutions could be <code>60, 70, 80</code> or <code>50, 70, 90</code> or <code>30, 70, 110</code>.</p>\n\n<p>I'm honestly at a loss for how to even start, so I'm afraid I haven't tried much. I checked into Excel solver but wasn't able to find a way to have 'or' constraints'.</p>\n\n<p>I'm decent at using VBA in Excel and writing SQL code but I can't figure out how to use either of those skill sets to crack this.</p>\n\n<p>Anyone have any ideas of how to tackle this in Excel or SSMS? If not, what other options should I explore?</p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509550106, "post_id": 47058105, "comment_id": 81063849, "body": "<code>ws.Cells(FoundCell.Row, ws.Range(&quot;RentLog&quot;).Column).Value = Me.checkin_datepicker.Value</code> looks like your column is using the wrong index, shouldn&#39;t it be the <code>Check In Date</code>? Maybe I&#39;m not understanding the question here..."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 8535397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85bf67ccf8b1233bd12086eb224971f?s=128&d=identicon&r=PG&f=1", "display_name": "Tigregalis", "link": "https://stackoverflow.com/users/8535397/tigregalis"}, "edited": false, "score": 0, "creation_date": 1509553424, "post_id": 47059229, "comment_id": 81066039, "body": "Note: I&#39;d only use <code>Find</code> instead of Index Match if I were looking for a partial match. For example, if you had values such as <code>200</code>, <code>1200</code>, <code>2001</code> and you used <code>Find</code> for <code>200</code>, it would find the first cell that had <code>200</code> in it, even if that were <code>1200</code> or <code>2001</code>."}], "tags": [], "owner": {"reputation": 440, "user_id": 8535397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85bf67ccf8b1233bd12086eb224971f?s=128&d=identicon&r=PG&f=1", "display_name": "Tigregalis", "link": "https://stackoverflow.com/users/8535397/tigregalis"}, "is_accepted": false, "score": 0, "last_activity_date": 1509553077, "creation_date": 1509553077, "answer_id": 47059229, "question_id": 47058105, "link": "https://stackoverflow.com/questions/47058105/get-cell-at-row-n-and-column-by-name/47059229#47059229", "title": "Get Cell at Row n and Column (by name)", "body": "<p>To answer your question directly, to refer to a specific column in a table using VBA, you use <code>Range(\"TableName[Column Name]\")</code> (actually, this is how you'd refer to it in an Excel formula too: <code>TableName[Column Name]</code>).</p>\n\n<p>As for implementation, personally I always go to Index Match.</p>\n\n<pre><code>Private Sub checkout_cmdbutton_Click()\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Renting Logs\")\n\n    Const WHAT_TO_FIND As Integer = 200\n\n    Dim FoundRow As Variant\n    Dim FoundCell As Range, TargetCell As Range\n\n    FoundRow = Application.Match(WHAT_TO_FIND, ws.Range(\"RentLogs[Item ID]\"), 0) ' if there is a match of WHAT_TO_FIND in the \"Item ID\" column of \"RentLogs\" table, returns a number corresponding to the row, otherwise returns an error\n    If Not IsError(FoundRow) Then ' if there is a match\n        Set FoundCell = Application.WorksheetFunction.Index(ws.Range(\"RentLogs[Item ID]\"), FoundRow) ' get the corresponding cell in the \"Item ID\" column of \"RentLogs\" table at the same row as the match,\n        MsgBox (WHAT_TO_FIND &amp; \" found in (\" &amp; FoundCell.Row &amp; \",\" &amp; FoundCell.Column &amp; \")\") ' you may wish to look at FoundCell.Row and FoundCell.Column, as this is currently relative to the worksheet, not the table\n    Else ' if there is no match\n        MsgBox (WHAT_TO_FIND &amp; \" not found in RentLog\")\n        Exit Sub\n    End If\n\n    'copy the check in date to the table\n    Set TargetCell = Application.WorksheetFunction.Index(ws.Range(\"RentLogs[Check In Date]\"), FoundRow) ' get the corresponding cell in the \"Check In Date\" column of \"RentLogs\" table at the same row as the match\n    TargetCell.Value = Me.checkin_datepicker.Value\n\n    'clear userform\n    Me.checkin_datepicker.Value = Date\n\n    'close userform\n    Unload Me\n\nEnd Sub\n</code></pre>\n\n<p>Getting to <code>TargetCell</code>, the above is equivalent to having an excel formula like:</p>\n\n<pre><code>=IF(\n    NOT(\n        ISERROR(\n            MATCH(200,RentLogs[Item ID],0)\n        )\n    ),\n    INDEX(RentLogs[Check In Date],\n        MATCH(200,RentLogs[Item ID],0)\n    ),\n    200 &amp; \" not found in RentLog\"\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 1, "creation_date": 1509557364, "post_id": 47059235, "comment_id": 81068511, "body": "This worked! Two errors for my specific version: the table is &quot;RentLog&quot; and the field is &quot;Item ID&quot;. Thank you very much!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1509553086, "creation_date": 1509553086, "answer_id": 47059235, "question_id": 47058105, "link": "https://stackoverflow.com/questions/47058105/get-cell-at-row-n-and-column-by-name/47059235#47059235", "title": "Get Cell at Row n and Column (by name)", "body": "<p>If you're really asking how to refer to cells in a table, you could use something like this. There is a useful guide to syntax here  <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables</a> </p>\n\n<pre><code>Private Sub checkout_cmdbutton_Click()\n\nDim ws As Worksheet, r As ListObject, foundcell As Range\n\nSet ws = Worksheets(\"Renting Logs\")\nSet r = ws.ListObjects(\"RentLogs\")\nConst WHAT_TO_FIND As Integer = 200\n\nSet foundcell = r.ListColumns(\"ID\").DataBodyRange.Find(What:=WHAT_TO_FIND)\n\nIf Not foundcell Is Nothing Then\n    MsgBox (WHAT_TO_FIND &amp; \" found in (\" &amp; foundcell.Row &amp; \",\" &amp; foundcell.Column &amp; \")\")\n    r.ListColumns(\"Check in Date\").Range(foundcell.Row - r.HeaderRowRange.Row + 1).Value = Me.checkin_datepicker.Value\nElse\n    MsgBox (WHAT_TO_FIND &amp; \" not found in RentLog\")\n    Exit Sub\nEnd If\n\nEnd Sub\n\n'clear userform\nMe.checkin_datepicker.Value = Date\n\n'close userform\nUnload Me\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 1, "accepted_answer_id": 47059235, "answer_count": 2, "score": 1, "last_activity_date": 1509553086, "creation_date": 1509549420, "last_edit_date": 1531164843, "question_id": 47058105, "link": "https://stackoverflow.com/questions/47058105/get-cell-at-row-n-and-column-by-name", "title": "Get Cell at Row n and Column (by name)", "body": "<p><strong>System Description:</strong> I have a spreadsheet with a table called <em>RentLogs</em> in a spreadsheet (Sheet2, <em>Renting Logs</em>). When you click a button, a userform appears and the user selects the date the item was returned and hits \"OK\". The form then searches the table for the item's ID and logs the check in date in the <em>Check In Date</em> column.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9RtOq.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Problem:</strong></p>\n\n<p>1) My VBA code (below) can only find the item ID on the whole sheet, how do I find it's location in the table so the table can be moved without worrying about static column values? <br>\n2) How do I get the VBA to drop it in the (item id's row, <em>Check In Date</em> column)?</p>\n\n<pre><code>Private Sub checkout_cmdbutton_Click()\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Renting Logs\")\n\n    Const WHAT_TO_FIND As Integer = 200\n\n    Set FoundCell = ws.Range(\"RentLog\").Find(What:=WHAT_TO_FIND, SearchOrder:=xlRows, SearchDirection:=xlNext, LookIn:=xlValues)\n    If Not FoundCell Is Nothing Then\n        MsgBox (WHAT_TO_FIND &amp; \" found in (\" &amp; FoundCell.Row &amp; \",\" &amp; FoundCell.Column &amp; \")\")\n    Else\n        MsgBox (WHAT_TO_FIND &amp; \" not found in RentLog\")\n        Exit Sub\n    End If\n\n'copy the check in date to the table\n    ws.Cells(FoundCell.Row, ws.Range(\"RentLog\").Column).Value = Me.checkin_datepicker.Value\n\n'clear userform\n    Me.checkin_datepicker.Value = Date\n\n'close userform\nUnload Me End Sub \n</code></pre>\n\n<p><strong>My Attempt:</strong> I know the problem lies in my searching algorithm but I'm not familiar with VBA and don't know all the properties of objects. The userform works perfectly so no problem there.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1509549799, "post_id": 47057980, "comment_id": 81063625, "body": "Anything between double quotes is a <i>string literal</i>. Your <code>Debug.Print</code> statement isn&#39;t accessing the recordset field in any way, it&#39;s just printing what it&#39;s told to print: two string literals and a string variable, concatenated. <code>&quot;&quot;&amp;</code> is completely useless BTW."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "edited": false, "score": 0, "creation_date": 1509549505, "post_id": 47058084, "comment_id": 81063422, "body": "That Debug.Print statement returns a null value also"}, {"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "edited": false, "score": 0, "creation_date": 1509549614, "post_id": 47058084, "comment_id": 81063493, "body": "Oh wait - there is one null value in the table...I needed to step thro more than one instance.  Apology."}, {"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1509562944, "post_id": 47058084, "comment_id": 81071652, "body": "Please correct the code, the name of the recordset is <code>rsSelect</code> which is used in the <code>Do While</code> condition, but <code>rsInsert</code> is used inside the loop."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1509563846, "post_id": 47058084, "comment_id": 81072118, "body": "@Md.SumanKabir I can&#39;t, since I don&#39;t know if OP wanted to iterate through the rsSelect or the rsInsert recordset. Go ask him."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1509549358, "creation_date": 1509549358, "answer_id": 47058084, "question_id": 47057980, "link": "https://stackoverflow.com/questions/47057980/accessing-dao-recordset-values/47058084#47058084", "title": "Accessing DAO Recordset Values", "body": "<p>Your syntax is wrong.</p>\n\n<pre><code>Do While Not rsSelect.EOF\n    Debug.Print rsInsert.Fields(fieldname).Value\n    rsInsert.MoveNext\nLoop\n</code></pre>\n\n<p>Note that you're probably better off looking for a tutorial on the web about how recordsets work, than trial and error and asking questions on Stack Overflow on error.</p>\n"}, {"tags": [], "owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "is_accepted": false, "score": 0, "last_activity_date": 1509550544, "last_edit_date": 1509550544, "creation_date": 1509549426, "answer_id": 47058110, "question_id": 47057980, "link": "https://stackoverflow.com/questions/47057980/accessing-dao-recordset-values/47058110#47058110", "title": "Accessing DAO Recordset Values", "body": "<p>You can use something like below :</p>\n\n<pre><code>Public fieldname As String\n\nfieldname = \"idea\"\n\nDo While Not rsSelect.EOF\n    Debug.Print rsSelect(fieldname).Value\n    rsSelect.MoveNext\nLoop\n</code></pre>\n\n<p>Alternatively you can simply do this without using any variable :</p>\n\n<pre><code>Do While Not rsSelect.EOF\n    Debug.Print rsSelect!idea\n    rsSelect.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 47058084, "answer_count": 2, "score": 0, "last_activity_date": 1594638866, "creation_date": 1509549069, "last_edit_date": 1594638866, "question_id": 47057980, "link": "https://stackoverflow.com/questions/47057980/accessing-dao-recordset-values", "title": "Accessing DAO Recordset Values", "body": "<p>I am storing a field name in a variable - and I want to access the value stored in that field by way of DAO Recordset.</p>\n\n<p>My syntax is set-up like the below, but my Debug.Print statement returns</p>\n\n<pre><code>idea.Value\n</code></pre>\n\n<p>Instead of the actual value held in the field.  For example, let's say that I have a table called <code>Test</code> with a short text field called <code>idea</code> that holds the values</p>\n\n<blockquote>\n  <p>red<br>green<br>blue</p>\n</blockquote>\n\n<p>And In my syntax below I would want the <code>idea.Value</code> to show those 3 values, but instead of printing the actual value I get the field name printed.  What did I set-up incorrectly for this to occur?</p>\n\n<pre><code>Public fieldname As String\n\nfieldname = \"ides\"\n\nDo While Not rsSelect.EOF\n    rsInsert.AddNew\n    Debug.Print \"\"&amp; fieldnamea &amp; \".Value\"\nLoop\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1509548984, "post_id": 47057883, "comment_id": 81063089, "body": "Do you realize that tomorrow the TODAY() function will be different from what is showing today?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1509549211, "post_id": 47057883, "comment_id": 81063235, "body": "Can you provide the VBA?"}, {"owner": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "edited": false, "score": 0, "creation_date": 1509550356, "post_id": 47057883, "comment_id": 81064009, "body": "@Jeeped I did not. So you are saying when I open the sheet tomorrow those dates will change to the current date?"}, {"owner": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1509550387, "post_id": 47057883, "comment_id": 81064030, "body": "@Zac I edited the original question to include the code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "edited": false, "score": 0, "creation_date": 1509550796, "post_id": 47058066, "comment_id": 81064278, "body": "This works just as I was needing. Thank You so much! I searched and searched and couldn&#39;t find it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "edited": false, "score": 0, "creation_date": 1509551486, "post_id": 47058066, "comment_id": 81064760, "body": "Next time, just look through my answers (LOL :D). This came (with very minor modification) from another question I replied to. The search terms you are looking for would be <i>vba timestamp</i>."}, {"owner": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "edited": false, "score": 0, "creation_date": 1509551573, "post_id": 47058066, "comment_id": 81064827, "body": "Will do! Thanks again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1509549308, "creation_date": 1509549308, "answer_id": 47058066, "question_id": 47057883, "link": "https://stackoverflow.com/questions/47057883/automatically-add-the-date-in-a-cell-based-off-text-in-another-cell/47058066#47058066", "title": "Automatically add the date in a cell based off text in another cell", "body": "<p>Here is a fairly boilerplate Worksheet_Change that will put in the date permanently.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"F:F\")) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n        Dim rw As Long, rng As Range\n        For Each rng In Intersect(Target, Range(\"F:F\"))\n            Select Case LCase(rng.Value2)\n                Case \"closed\"\n                    rng.Offset(0, 1) = Date\n                    'optional date formatting\n                    'rng.Offset(0, 1).numberformat = \"dd-mmm-yyyy\"\n                Case Else\n                    rng.Offset(0, 1).ClearContents\n            End Select\n        Next rng\n    End If\n\nbm_Safe_Exit:\n    If CBool(Val(Err.Number)) Then _\n        Debug.Print Err.Number &amp; \": \" &amp; Err.Description\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>This belongs in the worksheet's code sheet, <strong>not</strong> a standard module. It should survive multiple deletions, edits and/or additions.</p>\n"}], "owner": {"reputation": 3, "user_id": 8868791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e99d997ee66a7358c81cbd64ecff5ed?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8868791/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 47058066, "answer_count": 1, "score": 0, "last_activity_date": 1509556133, "creation_date": 1509548788, "last_edit_date": 1531161705, "question_id": 47057883, "link": "https://stackoverflow.com/questions/47057883/automatically-add-the-date-in-a-cell-based-off-text-in-another-cell", "title": "Automatically add the date in a cell based off text in another cell", "body": "<p>I need to add the date into a cell only when another cell has \"closed\" in it. If it has anything else in it I need it to be clear.</p>\n\n<p>I'm using a drop down that has only two options \"Open\" &amp; \"Closed\". When I select \"Closed\" I want the cell to the right to insert the current date.</p>\n\n<p>I found some VBA code that will let me add the date no matter what code is in the cell but I can't figure it out.</p>\n\n<p>I also found the following works but I have to place it in every cell down one column.</p>\n\n<pre><code>=IF(AND(F2&lt;&gt;\"\",F2&lt;&gt;\"Open\"),TODAY(),\"\")\n</code></pre>\n\n<p>This is what code that would add the date no matter what data was in the cell</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim xRg As Range, xCell As Range\nOn Error Resume Next\nIf (Target.Count = 1) Then\n    If (Not Application.Intersect(Target, Me.Range(\"B:B\")) Is Nothing) Then _\n        Target.Offset(0, 1) = Date\n    Application.EnableEvents = False\n    Set xRg = Application.Intersect(Target.Dependents, Me.Range(\"B:B\"))\n    If (Not xRg Is Nothing) Then\n        For Each xCell In xRg\n            xCell.Offset(0, -1) = Date\n        Next\n    End If\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1509548735, "post_id": 47057697, "comment_id": 81062926, "body": "Does the event happen and do you actually get inside the <code>If</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1509548814, "post_id": 47057697, "comment_id": 81062979, "body": "Did you tried <code>Application.Calculation = xlCalculationAutomatic</code> ?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1509549324, "post_id": 47057697, "comment_id": 81063313, "body": "Gserg - Yes event happen and i get inside If. DavidG - I tried that, does not work. So far the only method that reasonably works is to run range.calculate on all upstream and downstream cells that need to be recalced. was hoping there is a more elegant solution"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1509549475, "post_id": 47057697, "comment_id": 81063403, "body": "Exactly what is being calculated (built-in functions or non-volatile VBA UDFs?), and what is the <code>Application.CalculationMode</code>?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1509549587, "post_id": 47057697, "comment_id": 81063471, "body": "Built in functions, very stragiiht forward sums, vlookups, etc. calc mode is manual. the sub mentioned in OP is in the worksheet in VBE"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 1, "creation_date": 1509549732, "post_id": 47057697, "comment_id": 81063575, "body": "If you step through the code and pause on the If statement, what are Target.Address and Cells(3,4).Address?"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1509549815, "post_id": 47057697, "comment_id": 81063638, "body": "Start with putting a debug.print / msgbox to make sure the sub gets triggered."}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1509549879, "post_id": 47057697, "comment_id": 81063687, "body": "Dave, don&#39;t believe it&#39;s necesarily the if statement, as the code in the edited portion of the OP works fine. I force recalc all the dependent cells"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 1, "creation_date": 1509550497, "post_id": 47057697, "comment_id": 81064090, "body": "I can&#39;t replicate the problem so it&#39;s tricky trying to troubleshoot it. You could try ThisWorkbook.Calculate (or assign the workbook you are working in to a Workbook object and use that)"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1509550554, "post_id": 47057697, "comment_id": 81064127, "body": "maybe it has to do with your IF forcing the CELLS reference to work on the active worksheet, whereas with the solution that works you seem to be working with 2 different worksheets; try wraping your <code>.range(&quot;DI:DI&quot;).calculate</code> in their corresponding <code>with worksheets()</code> blocks"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1509550566, "post_id": 47057697, "comment_id": 81064134, "body": "works fine here, maybe check if any of these exists: Application.EnableEvents = False Application.Calculation = xlManual ThisWorkbook.Sheets().EnableCalculation = False"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1509551491, "post_id": 47057697, "comment_id": 81064766, "body": "thanks for the help all. I will resort to the solutioon in edited OP, not elegant but cant spend too much time on this one piece."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1509555116, "post_id": 47057697, "comment_id": 81067096, "body": "Did you at any point change the <code>EnableCalculation</code> property of any sheets to False?"}], "answers": [{"comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1509555606, "post_id": 47058781, "comment_id": 81067406, "body": "You can do <code>Worksheets(&quot;Dashboard&quot;).Calculate</code> and see if it works for you."}], "tags": [], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "is_accepted": false, "score": 0, "last_activity_date": 1509551545, "creation_date": 1509551545, "answer_id": 47058781, "question_id": 47057697, "link": "https://stackoverflow.com/questions/47057697/excel-vba-formulas-dont-calculate-fully/47058781#47058781", "title": "Excel VBA formulas don&#39;t calculate fully", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        Worksheets(\"Dashboard\").Range(\"af3\").Calculate\n        Worksheets(\"Base\").Range(\"R1:R50000\").Calculate\n        Worksheets(\"Control\").Range(\"R1:R50000\").Calculate\n        Worksheets(\"Base\").Range(\"DI1:DI50000\").Calculate\n        Worksheets(\"Control\").Range(\"DI1:DI50000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"W10:W5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"L10:L5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"Y10:Aa5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"B2:B7\").Calculate\nend if\n</code></pre>\n\n<p>Force re-calc all dependent ranges.</p>\n\n<p>Other methods may not work as file is big(~30mb)</p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1509551545, "creation_date": 1509548201, "last_edit_date": 1509549805, "question_id": 47057697, "link": "https://stackoverflow.com/questions/47057697/excel-vba-formulas-dont-calculate-fully", "title": "Excel VBA formulas don&#39;t calculate fully", "body": "<p>I have a toggle cell which feeds calculations throughout multiple sheets in my workbook. The goal is, whenever this toggle cell is changed, workbook recalculates and provides an update number.</p>\n\n<p>I have manual calculation turned on.</p>\n\n<p>Below are methods I have tried (note the code is in a sheet)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        Application.Calculate\n    End If\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        Application.CalculateFull\n    End If\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        Application.CalculateFullRebuild\n    End If\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        range(\"DI:DI\").calculate \n        'to calculate the specific range which drives the updated numbers\n    End If\n</code></pre>\n\n<p>None of these methods work. The only method is to save the workbook and everything calculates.</p>\n\n<p>Any thoughts?</p>\n\n<p>-----------------------------EDIT-----------------------------</p>\n\n<p>Only solution that works so far, force calculate all cells that are drive the final results. Hoping for a more elegant solution. Total run time ~3seconds\\</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Cells(3, 4)) Is Nothing Then\n        Worksheets(\"Dashboard\").Range(\"af3\").Calculate\n        Worksheets(\"Base\").Range(\"R1:R50000\").Calculate\n        Worksheets(\"Control\").Range(\"R1:R50000\").Calculate\n        Worksheets(\"Base\").Range(\"DI1:DI50000\").Calculate\n        Worksheets(\"Control\").Range(\"DI1:DI50000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"W10:W5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"L10:L5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"Y10:Aa5000\").Calculate\n        Worksheets(\"Dashboard\").Range(\"B2:B7\").Calculate\nend if\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 1, "creation_date": 1509551296, "post_id": 47057607, "comment_id": 81064616, "body": "I suggest avoid using <code>.Select</code> copy/paste method as it&#39;s quite slow... I&#39;d suggest just using the <code>Worksheet.Range([RANGE]).Formula = [FORMULA]</code> as it is much faster"}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509552585, "post_id": 47057607, "comment_id": 81065497, "body": "@Maldred so would that solve the macro from using the header where there&#39;s only one row that needs a vlookup?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509568113, "post_id": 47057607, "comment_id": 81074416, "body": "It&#39;d be much easier to <code>Debug</code>, I can&#39;t say for certain that it&#39;ll fix your issue, but your code could definitely use a rework"}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "edited": false, "score": 0, "creation_date": 1509555428, "post_id": 47059746, "comment_id": 81067275, "body": "the thing is there IS a row.  Just one row and the header thats when the macros doesn&#39;t work.  If its 2 rows or more with the words &quot;short paid&quot; in the cell, the macros works.  But if its just one row with the words &quot;short paid&quot; in the cell, the macros starts using the header row to insert data into row 2.  I only call this macro if i do see a row with &quot;short paid&quot; So i don&#39;t need to use an If statement to exit out since i wouldn&#39;t use it in the first place if i didn&#39;t see &quot;short paid&quot;"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "edited": false, "score": 0, "creation_date": 1509572255, "post_id": 47059746, "comment_id": 81076323, "body": "Yes, well when there is one row the FillDown method will copy from the row above, which is the header row. So when there is only one row you should only populate the formula in that one row, and not use the FillDown method."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "edited": false, "score": 0, "creation_date": 1509632167, "post_id": 47059746, "comment_id": 81103387, "body": "So is there a way to implement a code that if there is only one row with data (header row on top of course) to not use the filldown method?  Like what you wrote, something like If LastRow = 2 then (saying 2 because there would be 2 rows, header row, and one row of data needing the vlookup formula) ?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "edited": false, "score": 0, "creation_date": 1509653493, "post_id": 47059746, "comment_id": 81116920, "body": "I wouldn&#39;t use Filldown at all. I suspect it would populate the formula into the filtered rows as well as the unfiltered rows. I&#39;ll add a suggestion to my answer."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "edited": false, "score": 0, "creation_date": 1509653567, "post_id": 47059746, "comment_id": 81116957, "body": "So if i didn&#39;t use .filldown what would my code suppose to look like? thanks in advance"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 1, "last_activity_date": 1509653682, "last_edit_date": 1509653682, "creation_date": 1509554797, "answer_id": 47059746, "question_id": 47057607, "link": "https://stackoverflow.com/questions/47057607/vba-to-fill-cells-with-vlookup-copy-and-paste-into-other-cells-i-have-a-macro/47059746#47059746", "title": "VBA to fill cells with vlookup, copy and paste into other cells. I have a Macro that works fine except when", "body": "<p>The problem is where you try to find LastRow (LastRow = ...) you are not checking for the possibility that there may by no rows. You should add:</p>\n\n<pre><code>If LastRow = 1 Then\n    'This means no rows found. Exit or do something else.\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Try this approach:</p>\n\n<pre><code>Range(\"H2:H\" &amp; LastRow).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=VLOOKUP(RC1, Sheet2!C1:C2, 2, FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509653682, "creation_date": 1509547914, "last_edit_date": 1509553755, "question_id": 47057607, "link": "https://stackoverflow.com/questions/47057607/vba-to-fill-cells-with-vlookup-copy-and-paste-into-other-cells-i-have-a-macro", "title": "VBA to fill cells with vlookup, copy and paste into other cells. I have a Macro that works fine except when", "body": "<p>I have this Macro I wrote to filter and sort the sheet and then add in the vlookup formula next to any cell that says \"short paid\".  My code works fine if there's more than one row that has the \"short paid\" in column G.  </p>\n\n<p>When it's just one row that has the \"short paid\" in column G the Macro starts using the header, copying and pasting what's in the header (row 1) into row2.  I just find it strange that if there's more than one row with \"short paid\" the macro doesn't touch the header at all.  here's the code:</p>\n\n<pre><code>Sub Prox2()\n\nDim LastRow As Long\nDim xRow As Range\nDim xRg As Range\nDim xRows As Range\n\nActiveSheet.Range(\"A:O\").AutoFilter Field:=7, Criteria1:= _\n    \"Short Paid\"\n\nLastRow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\nRange(\"H2\") = \"=VLOOKUP(A2,Sheet2!A:B,2,FALSE)\": Range(\"H2:H\" &amp; \nLastRow).FillDown\n\nRange(\"H2:H\" &amp; LastRow).Select\nSelection.Copy\n\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=True, Transpose:=False\n\nRange(\"H2:H\" &amp; LastRow).Select\nApplication.CutCopyMode = False\nSelection.ClearContents\n\nRange(\"H2\") = \"=VLOOKUP(A2,Sheet2!A:P,16,FALSE)\": Range(\"H2:H\" &amp; \nLastRow).FillDown\n\nRange(\"C2:C\" &amp; LastRow).Select\nApplication.CutCopyMode = False\nSelection.ClearContents\n\nRange(\"C2\") = \"=VLOOKUP(A2,Sheet2!A:F,6,FALSE)\": Range(\"C2:C\" &amp; \nLastRow).FillDown\n\nRange(\"F2:F\" &amp; LastRow).Select\nApplication.CutCopyMode = False\nSelection.ClearContents\n\nRange(\"F2\") = \"=VLOOKUP(A2,Sheet2!A:J,10,FALSE)\": Range(\"F2:F\" &amp; \nLastRow).FillDown\n\nRange(\"E2:E\" &amp; LastRow).Select\nApplication.CutCopyMode = False\nSelection.ClearContents\n\nRange(\"E2\") = \"=F2-30\": Range(\"E2:E\" &amp; LastRow).FillDown\n\nActiveSheet.Range(\"A:O\").AutoFilter Field:=7\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "edited": false, "score": 0, "creation_date": 1509549171, "post_id": 47057322, "comment_id": 81063208, "body": "Could you post your code through editing this question? Please show us what you tried to do."}, {"owner": {"reputation": 11, "user_id": 8868695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99a723f489c76e884200acb73a7bad4?s=128&d=identicon&r=PG&f=1", "display_name": "SenadP", "link": "https://stackoverflow.com/users/8868695/senadp"}, "reply_to_user": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "edited": false, "score": 0, "creation_date": 1509701573, "post_id": 47057322, "comment_id": 81134210, "body": "Hi, I uploaded what I&#39;ve done so far. Very new to vba scripting, so it is not much to go from."}, {"owner": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "edited": false, "score": 0, "creation_date": 1509703315, "post_id": 47057322, "comment_id": 81135420, "body": "You should post your code as text with formatting."}, {"owner": {"reputation": 11, "user_id": 8868695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99a723f489c76e884200acb73a7bad4?s=128&d=identicon&r=PG&f=1", "display_name": "SenadP", "link": "https://stackoverflow.com/users/8868695/senadp"}, "reply_to_user": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "edited": false, "score": 0, "creation_date": 1509710336, "post_id": 47057322, "comment_id": 81139768, "body": "Sub FindMelData() Dim MEL As Workbook Di FinalRow As Integer Dim i As Integer Sheets(&quot;MEL-Input&quot;).Activate Sheets(&quot;MEL-Input&quot;).Range(&quot;A1:BJ3000&quot;).ClearContents iName = Cells(1, 1) iOccup = Cells(1, 2) iSalery = Cells(, 3) Set MEL = Workbook.Open(&quot;path&quot;) area = MEL.Sheets(&quot;MEL&quot;).Range(&quot;A1&quot;).Value FinalRow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row For i = 2 To FinalRow \tIf Cells(i, 3) &gt; 100000 Then \tMEL.Sheets(&quot;MEL&quot;).Range(Cells(i, 2)).Copy \tThisWorkbook.Sheets(&quot;MEL-Input&quot;).Range(&quot;A3000&quot;).End(xlUp).O&zwnj;&#8203;ffset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats \tEnd If \tNext i End Sub"}, {"owner": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "edited": false, "score": 0, "creation_date": 1509712194, "post_id": 47057322, "comment_id": 81140946, "body": "Thanks for clarifying your question"}], "owner": {"reputation": 11, "user_id": 8868695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99a723f489c76e884200acb73a7bad4?s=128&d=identicon&r=PG&f=1", "display_name": "SenadP", "link": "https://stackoverflow.com/users/8868695/senadp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509715346, "creation_date": 1509546948, "last_edit_date": 1531164843, "question_id": 47057322, "link": "https://stackoverflow.com/questions/47057322/copy-rows-depending-on-column-value", "title": "copy rows depending on column value", "body": "<p>I want to copy certain columns from one excel file to another. Basically I want to make a search for \"occupation\", followed by a IF sentence that copies only that column (\"occupation\"), if the salary is above 100,000. Of course in the real file I do not know which column contains \"Occupation\".</p>\n\n<pre><code>Sub FindMelData() \nDim MEL As Workbook \nDim FinalRow As Integer \nDim i As Integer \nSheets(\"MEL-Input\").Activate \nSheets(\"MEL-Input\").Range(\"A1:BJ3000\").ClearContents \niName = Cells(1, 1) \niOccup = Cells(1, 2) \niSalery = Cells(, 3) \n\nSet MEL = Workbook.Open(\"path\") \narea = MEL.Sheets(\"MEL\").Range(\"A1\").Value \nFinalRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row \nFor i = 2 To FinalRow \n   If Cells(i, 3) &gt; 100000 Then \n      MEL.Sheets(\"MEL\").Range(Cells(i, 2)).Copy \n      ThisWorkbook.Sheets(\"MEL-Input\").Range(\"A3000\").End(xlUp).O\u200c\u200bffset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats \n      End If \n      Next i \nEnd Sub\n</code></pre>\n\n<p>So what I want shown on my new file is:</p>\n\n<p>[![enter image description here][2]][2]</p>\n\n<p>I have no good ideas on how to start this, so this far I have just made a loop that finds the column no in the file I want to copy from. This works, but if the columns are to change, then my script will not wor anymore.</p>\n\n<p><a href=\"https://i.stack.imgur.com/U6Xb6.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "ms-word", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8868632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a9148a0c208ce29bb01d40f9cd57b2?s=128&d=identicon&r=PG&f=1", "display_name": "SlowRandy", "link": "https://stackoverflow.com/users/8868632/slowrandy"}, "is_accepted": false, "score": 0, "last_activity_date": 1509548082, "creation_date": 1509548082, "answer_id": 47057646, "question_id": 47057224, "link": "https://stackoverflow.com/questions/47057224/resizing-row-column-height-width-of-a-word-table-from-an-spreadsheet-range-excel/47057646#47057646", "title": "Resizing Row/Column height/width of a Word Table from an spreadsheet range Excel VBA", "body": "<p>I found the answer <a href=\"https://msdn.microsoft.com/en-us/VBA/word-vba/articles/rows-setheight-method-word?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbawd10.chm155975883)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv15)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">here</a> on the microsoft dev center site. \nI changed:</p>\n\n<pre><code>With wrdApp.Selection\n.Paste\nEnd With\n</code></pre>\n\n<p>To\n*</p>\n\n<pre><code>With wrdApp.Selection\n    .Paste\n    .Tables(1).Rows.SetHeight RowHeight:=InchesToPoints(0.2), HeightRule:=wdRowHeightExactly\nEnd With\n</code></pre>\n\n<p>*\nI'm sure I can apply this concept to columns, font size ect.</p>\n"}, {"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1509622675, "creation_date": 1509622675, "answer_id": 47074355, "question_id": 47057224, "link": "https://stackoverflow.com/questions/47057224/resizing-row-column-height-width-of-a-word-table-from-an-spreadsheet-range-excel/47074355#47074355", "title": "Resizing Row/Column height/width of a Word Table from an spreadsheet range Excel VBA", "body": "<blockquote>\n  <p>I want to know how to reference the word table and resize the row height and column width to fit a given size.</p>\n</blockquote>\n\n<pre><code>Sub Table4SlowRandy()\n    Dim aTbl As Word.Table\n\n    ' paste a table from Excel\n    Selection.Range.Paste\n\n    ' Assign pasted table to variable\n    Set aTbl = Selection.Range.Tables(1)\n\n    ' Modify aTbl as you like\n    aTbl.Rows.SetHeight RowHeight:=InchesToPoints(0.2), HeightRule:=wdRowHeightExactly\n\n    ' Deallocate aTbl\n    Set aTbl = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8868632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a9148a0c208ce29bb01d40f9cd57b2?s=128&d=identicon&r=PG&f=1", "display_name": "SlowRandy", "link": "https://stackoverflow.com/users/8868632/slowrandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1545, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509622675, "creation_date": 1509546622, "last_edit_date": 1531164843, "question_id": 47057224, "link": "https://stackoverflow.com/questions/47057224/resizing-row-column-height-width-of-a-word-table-from-an-spreadsheet-range-excel", "title": "Resizing Row/Column height/width of a Word Table from an spreadsheet range Excel VBA", "body": "<p>The range of cells that I copy and paste into a word becomes a table. I want to know how to reference the word table and resize the row height and column width to fit a given size. </p>\n\n<pre><code>Sub RangeImporter()\nDim wrdApp As Word.Application\n\nDim rng As Range\n\nSet wrdApp = New Word.Application\nwrdApp.documents.Add\nwrdApp.Visible = True\nSet rng = Range(\"A27\", Range(\"A27\").End(xlDown))\nrng.Copy\n\nWith wrdApp.Selection\n    .Paste\nEnd With\n\n\nwrdApp.Quit\n\nSet wrdApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I am very new to this and have very little background apart from what I have picked up here. Any help/tips/critiques  would be much appreciated. </p>\n\n<p>Thank you,</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1509548151, "creation_date": 1509548151, "answer_id": 47057679, "question_id": 47057162, "link": "https://stackoverflow.com/questions/47057162/access-reference-library-goes-missing-after-opened-from-newer-version/47057679#47057679", "title": "Access reference library goes missing after opened from newer version", "body": "<p>You can use <a href=\"https://support.microsoft.com/en-in/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">late binding</a>, which helps you avoid the issue. Code with late binding works with any appropriate object library, whichever is available.</p>\n\n<p>You need to change the object initializations:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim excelApp As Excel.Application\nSet excelApp As New Excel.Application\n</code></pre>\n\n<p>To</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim excelApp As Object\nSet excelApp = CreateObject(\"Excel.Application\")\n</code></pre>\n\n<p>Note that if you use late binding, intellisense will be unavailable. My usual practice is to develop using early binding, and change it to late binding as soon as it's finished.</p>\n"}, {"comments": [{"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1510133628, "post_id": 47076605, "comment_id": 81301197, "body": "Good point. I have split the database but everyone had been using the front end which is saved in a network folder. I will create a BAT file that will make a local copy of the front end for each user. Thanks"}], "tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 1, "last_activity_date": 1509629449, "creation_date": 1509629449, "answer_id": 47076605, "question_id": 47057162, "link": "https://stackoverflow.com/questions/47057162/access-reference-library-goes-missing-after-opened-from-newer-version/47076605#47076605", "title": "Access reference library goes missing after opened from newer version", "body": "<p>Are you sharing an unsplit database or sharing the front end of a split database?    </p>\n\n<p>Access is inherently multi user, but one must distribute it correctly.  The database must be split into 2 files (this is a feature in the ribbon) and then each user has their own front end file which links to the common single back end file.</p>\n\n<p>Then there should be no changing occurring to references once they are set up for a user's environment.</p>\n"}], "owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 47057679, "answer_count": 2, "score": 0, "last_activity_date": 1527289269, "creation_date": 1509546396, "question_id": 47057162, "link": "https://stackoverflow.com/questions/47057162/access-reference-library-goes-missing-after-opened-from-newer-version", "title": "Access reference library goes missing after opened from newer version", "body": "<p>I have built an Access database that is shared on our company network. Most users on the network have Access 2010 installed but some have Access 2016. When the database has been opened by someone with Access 2016 and then subsequently opened by someone with Access 2010 they are getting an error message as the Microsoft Excel 16.0 Object Library is marked \"Missing\". </p>\n\n<p>I can fix this temporarily by selecting the '14.0 library' but the error recurs as soon as it is opened in the later version again. Is there anything I can do to stop this from happening?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509564938, "post_id": 47057112, "comment_id": 81072730, "body": "Are you saying that your code works when searching for the &quot;Document&quot; (because your code is searching for it in the column from cell A4 down), and you now want to know how to search in cell B4 down instead (so that you can search for names instead of documents) or are you wanting to search in both column A <b>and</b> B so that the user can search for either a document <b>or</b> a name?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7115328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1tfd.jpg?s=128&g=1", "display_name": "marizolclark", "link": "https://stackoverflow.com/users/7115328/marizolclark"}, "is_accepted": false, "score": 0, "last_activity_date": 1509547881, "creation_date": 1509547881, "answer_id": 47057596, "question_id": 47057112, "link": "https://stackoverflow.com/questions/47057112/search-a-data-on-a-sheet-and-show-its-contents-in-a-textbox-vba/47057596#47057596", "title": "Search a data on a sheet and show its contents in a textbox VBA", "body": "<p>I think what you're asking is Concatenate. You want all the data from C4:F4 to show up in A1:F1. If so, in A1:F1 type the following formula (or copy+paste).</p>\n\n<p>=Concatenate(C4,D4,E4,F4)</p>\n\n<p>if you want spaces in between do the following:</p>\n\n<p>=Concatenate(C4,\" \",D4,\" \",E4,\" \",F4)</p>\n\n<p>If this is what you're asking.</p>\n"}, {"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1509548096, "creation_date": 1509548096, "answer_id": 47057654, "question_id": 47057112, "link": "https://stackoverflow.com/questions/47057112/search-a-data-on-a-sheet-and-show-its-contents-in-a-textbox-vba/47057654#47057654", "title": "Search a data on a sheet and show its contents in a textbox VBA", "body": "<p>I think you need to gather the data and then put it into a textbox.  You should be explicitly referencing the ranges and cells, instead of implicitly by using activecell and select.  This is just a snippet to get you on the correct direction.</p>\n\n<pre><code>Set sh = Sheets(\"Hoja1\")\n    'this searches column a for your input and brings back the row number\nrw = sh.Range(\"A:A\").Find(What:=buscarCedula, LookIn:= _\n    xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext).Row\n    'these set some variable equal to the columns in the found row so you can put them into a textbox.\ndoc = sh.Cells(1, rw).Value\nName = sh.Cells(2, rw).Value\nData1 = sh.Cells(3, rw).Value\nData2 = sh.Cells(4, rw).Value\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8011307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd74bbe9ef9316655341d7cd0b7a462?s=128&d=identicon&r=PG&f=1", "display_name": "luis felipe", "link": "https://stackoverflow.com/users/8011307/luis-felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509548096, "creation_date": 1509546261, "last_edit_date": 1509546459, "question_id": 47057112, "link": "https://stackoverflow.com/questions/47057112/search-a-data-on-a-sheet-and-show-its-contents-in-a-textbox-vba", "title": "Search a data on a sheet and show its contents in a textbox VBA", "body": "<p>I am trying to implement a simple program in vba and the following problem arises: How do you find a cell data in excel and put all the associated data in the textbox?\nFor example:\nHow to make that when typing the name I load the document, the data 1, 2, 3 and the average in the respective textbox.</p>\n\n<p><img src=\"https://i.stack.imgur.com/M1G6e.png\" alt=\"This is my sheet\"></p>\n\n<p>I try to do it with this code, but I do not understand its operation very well, it only works for me if I search for the document</p>\n\n<pre><code>Private Sub btnBuscar_Click()\n\nOn Error GoTo NE\n\nbuscarCedula = InputBox(\"Search:\")\n\nSheets(\"Hoja1\").Select\nRange(\"A4\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Find(What:=buscarCedula, After:=ActiveCell, LookIn:=xlFormulas, _\nLookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False).Activate\n\ntxtCedula.Text = ActiveCell\nActiveCell.Offset(0, 1).Select\n\ntxtNombre.Text = ActiveCell\nActiveCell.Offset(0, 1).Select\n\ntxtNotaUno.Text = ActiveCell\nActiveCell.Offset(0, 1).Select\n\ntxtNotaDos.Text = ActiveCell\nActiveCell.Offset(0, 1).Select\n\ntxtNotaTres.Text = ActiveCell\nActiveCell.Offset(0, 1).Select\n\nlblNotaDefinitiva.Caption = ActiveCell\n</code></pre>\n\n<p>Any idea or example that can guide me?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1509546551, "post_id": 47057073, "comment_id": 81061460, "body": "<code>Debug.Print row_num, column_num</code> will print to the immediate window, but depending on how many occurrences you may not get a complete list. You could also make notes on another sheet, or write to a text file, or build a new array... What sort of output are you looking for? Is this a permanent feature of your code or are you doing this for testing purposes?"}, {"owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1509546993, "post_id": 47057073, "comment_id": 81061789, "body": "Eventually Im going to generate an email to coworkers. That email code is already set I just need to incorporate my stuff. So I&#39;m basically just messing around trying to learn VBA. I figure I probably just want to make notes on another sheet. Eventually, instead of referencing the columns I would specify a certain cell in each column as an identifier to the location of the issue."}], "answers": [{"tags": [], "owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "is_accepted": false, "score": 1, "last_activity_date": 1509547715, "last_edit_date": 1509547715, "creation_date": 1509547381, "answer_id": 47057466, "question_id": 47057073, "link": "https://stackoverflow.com/questions/47057073/generating-a-list-of-issues-outside-of-conditions-in-vba/47057466#47057466", "title": "Generating a list of issues outside of conditions in VBA", "body": "<p>I have tweaked your code slightly (Since you are using <code>With</code> you don't need to keep spelling out <code>ThisWorkbook.Worksheets(\"Tie Out\")</code>). This will generate a list of Column/Row to your Immediate Window</p>\n\n<p>You were close already to this. You might want to try adding a function that will return the Column Letter from the column number you have.</p>\n\n<pre><code>   Sub validate()\n    Dim Arr1() As Variant\n    Dim num_rows As Long, num_columns As Long\n    Dim column_num As Long, row_num As Long\n\n    With ThisWorkbook.Worksheets(\"Tie Out\")\n        Arr1 = .Range(\"B15:CG66\").Value\n        num_columns = UBound(Arr1, 2)\n        num_rows = UBound(Arr1, 1)\n        For column_num = 1 To num_columns\n            For row_num = 1 To num_rows\n                                If Arr1(row_num, column_num) &lt;&gt; 0 Then Debug.Print \"Column \" &amp; column_num + 1, \"Row \" &amp; row_num + 14\n            Next row_num\n        Next column_num\n    End With\n\n    End Sub\n</code></pre>\n\n<p>An alternate method, which is how I would have done it is provided below:</p>\n\n<pre><code>Sub validate2()\n    Dim c As Range\n\n    For Each c In Worksheets(\"Tie Out\").Range(\"B15:CG66\")\n        If c.Value &lt;&gt; 0 Then\n            'add your code here\n            Debug.Print \"Value not = 0 at cell address \" &amp; c.Address\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509547715, "creation_date": 1509546116, "question_id": 47057073, "link": "https://stackoverflow.com/questions/47057073/generating-a-list-of-issues-outside-of-conditions-in-vba", "title": "Generating a list of issues outside of conditions in VBA", "body": "<p>Brand new to VBA so just trying to get a general sense of approaches to use.</p>\n\n<p>The following code defines an array and a condition set if a value is found that &lt;> 0 then 'Failure'. Rather than stopping, I want to generate a list of columns where this condition is met.</p>\n\n<p>Any tips or references would help. Thanks, </p>\n\n<p>Sub validate()</p>\n\n<pre><code>Dim Arr1() As Variant\nDim num_rows As Long, num_columns As Long\nDim column_num As Long, row_num As Long\nWith ThisWorkbook.Worksheets(\"Tie Out\")\n    ThisWorkbook.Worksheets(\"Tie Out\").Select\n    Arr1 = ThisWorkbook.Worksheets(\"Tie Out\").Range(\"B15:CG66\").Value\n    num_columns = UBound(Arr1, 2)\n    num_rows = UBound(Arr1, 1)\n    For column_num = 1 To num_columns\n        For row_num = 1 To num_rows\n                            If Abs(Arr1(row_num, column_num)) &gt; 0.001 Then MsgBox \"Failure\"\n        Next row_num\n    Next column_num\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["html", "excel", "csv", "vba"], "comments": [{"owner": {"reputation": 23769, "user_id": 98422, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/fGGLP.jpg?s=128&g=1", "display_name": "Gary McGill", "link": "https://stackoverflow.com/users/98422/gary-mcgill"}, "edited": false, "score": 0, "creation_date": 1509546808, "post_id": 47056790, "comment_id": 81061642, "body": "Could you not arrange for the file to be delimited with a  comma if that&#39;s what Excel expects? Or give the users a choice so that they can choose a delimiter that matches their requirements?"}], "answers": [{"tags": [], "owner": {"reputation": 23769, "user_id": 98422, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/fGGLP.jpg?s=128&g=1", "display_name": "Gary McGill", "link": "https://stackoverflow.com/users/98422/gary-mcgill"}, "is_accepted": false, "score": 0, "last_activity_date": 1509546645, "creation_date": 1509546645, "answer_id": 47057232, "question_id": 47056790, "link": "https://stackoverflow.com/questions/47056790/automatically-format-csv-file-upon-download/47057232#47057232", "title": "Automatically format .csv file upon download?", "body": "<p>Because you use the word \"download\" and your question is tagged \"html\", I assume that the user interacts with a <em>web</em> form rather than a desktop form.</p>\n\n<p>In that case, it's the web browser that decides what to do with the file. If the browser recognizes the <code>content-type</code> of the response as something it can handle natively (e.g. \"text/plain\" or \"image/jpeg\") then it may open the file and display it directly.</p>\n\n<p>However if the content-type is not something it knows how to deal with (which is likely the case with \"application/csv\"), then it will download the file and ask the operating system to open it. At that point, the filename assigned to the file (which can be set via the HTTP response) may come into play.</p>\n\n<p>On a Windows machine, the operating system maintains a list of file extensions and actions associated with those extensions. When you install Excel, that will normally make Excel the default \"open\" action for files with the \".csv\" extension. That's why double-clicking on a \".csv\" file opens in Excel, and also why it may open in Excel if you download it from a website. (If you didn't have Excel, it may simply ask you what program you want to use).</p>\n\n<p>This is a long-winded way of saying that <em>if you had control over the user's machine</em> you could give the file a different file extension and then associate that extension with an action that did something different. But, I assume that you probably <em>don't</em> have that sort of control unless you're dealing only with in-house users, and anyway it would not be a trivial thing to achieve.</p>\n\n<p>I don't think that there's any way to communicate to Excel <em>via the command line</em> that it should use a particular delimiter when opening a CSV file, and that - unfortunately - is the mechanism by which the operating system will ultimately open the file.</p>\n\n<p>It <em>is</em> possible to control what Excel uses as the default delimiter for <em>all</em> CSV files (see <a href=\"https://superuser.com/a/606274/18472\">https://superuser.com/a/606274/18472</a>) but again that would require you to change the system-wide settings on your users' machines, which I imagine would not be possible.</p>\n"}], "owner": {"reputation": 3, "user_id": 8527763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00eefe4faaa73d3092f42e381ed53673?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/8527763/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509561989, "creation_date": 1509545293, "last_edit_date": 1531161705, "question_id": 47056790, "link": "https://stackoverflow.com/questions/47056790/automatically-format-csv-file-upon-download", "title": "Automatically format .csv file upon download?", "body": "<p>I have a form that will open a file based on user's selections. A few files are .csv and those files open up in Excel, as expected. However, everything is placed into one cell... I know that there is a way to manually configure it so that the | or , are delimiters, but is there a way to set it so that Excel will automatically set the | as a delimiter? </p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "outlook", "late-binding"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 7, "creation_date": 1509544208, "post_id": 47056390, "comment_id": 81059872, "body": "change <code>Dim olApp As Outlook.Application</code> to <code>Dim olApp As Object</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1509544502, "post_id": 47056390, "comment_id": 81060071, "body": "<a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/245115/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 11, "last_activity_date": 1509544335, "creation_date": 1509544335, "answer_id": 47056493, "question_id": 47056390, "link": "https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba/47056493#47056493", "title": "How to do late binding in VBA?", "body": "<p>This is early binding:</p>\n\n<pre><code>Dim olApp As Outlook.Application\nSet olApp = New Outlook.Application\n</code></pre>\n\n<p>And this is late binding:</p>\n\n<pre><code>Dim olApp As Object\nSet olApp = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Late binding does not require a reference to <em>Outlook Library 16.0</em> whereas early binding does. However, note that late binding is a bit slower and you won't get intellisense for that object. </p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 5, "last_activity_date": 1509552953, "creation_date": 1509552953, "answer_id": 47059194, "question_id": 47056390, "link": "https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba/47059194#47059194", "title": "How to do late binding in VBA?", "body": "<p>As Callum pointed out, late binding involves changing your application reference to an object and not setting a reference to the library.</p>\n\n<p>Without a reference Excel doesn't know anything about Outlook until runtime.  This also means that not only will intellisense not work, the constant names for values in Outlook won't work either.</p>\n\n<p>e.g. In Outlooks Immediate window if you type <code>Application.CreateItem(</code> you'll get a whole load of item types pop up to choose from.  <code>olContactItem</code> for instance.</p>\n\n<p>Excel hasn't a clue what <code>olContactItem</code> means - it's an Outlook constant that only Outlook or an application with a reference to Outlook understands.  </p>\n\n<p>In Outlooks immediate window type <code>?olContactItem</code> and it will return <code>2</code>.  That's the number you need to use instead of the constant name.</p>\n\n<p>So your code changes from<br>\n<code>Application.CreateItem(olContactItem)</code> to <code>olApp.CreateItem(2)</code>  </p>\n\n<p>You need to do this throughout your code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14214996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdff3fa621cf6e2c085c8b3d7c5662a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/14214996/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1599136370, "creation_date": 1599136370, "answer_id": 63723777, "question_id": 47056390, "link": "https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba/63723777#63723777", "title": "How to do late binding in VBA?", "body": "<p>In that situation I generally define the constant globally in a module like this, that way you preserve the descriptive value of the variable.</p>\n<p>Public Const olFormatHTML = 2</p>\n"}], "owner": {"reputation": 41, "user_id": 8771584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4337ceb6036aa7d2079441f3ab879cae?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Sica", "link": "https://stackoverflow.com/users/8771584/franco-sica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7773, "favorite_count": 3, "answer_count": 3, "score": 3, "last_activity_date": 1599136370, "creation_date": 1509544021, "last_edit_date": 1509594932, "question_id": 47056390, "link": "https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba", "title": "How to do late binding in VBA?", "body": "<p>I have this little function that achieves the creation of an email via VBA,<br>\nIt gets the data from another function that works together with an Excel file.</p>\n\n<p>The problem I have is that I made all this thru Excel 2016, and when some of my colleagues try to use it there an error of missing references (Outlook Library 16.0). </p>\n\n<p>So I looked in the internet solutions and the ones I found are many, but the better is Late Binding. I have read all about it but I don't seem to really understand what's going on and how to make it work in the following code.</p>\n\n<pre><code>Sub EscalateCase(what_address As String, subject_line As String, email_body As String)\n\n    Dim olApp As Outlook.Application\n    Set olApp = CreateObject(\"Outlook.Application\")\n\n        Dim olMail As Outlook.MailItem\n        Set olMail = olApp.CreateItem(olMailItem)\n\n        olMail.To = what_address\n        olMail.Subject = subject_line\n        olMail.BodyFormat = olFormatHTML\n        olMail.HTMLBody = email_body\n        olMail.Send\n\n    End Sub\n</code></pre>\n\n<p>Therfore, maybe you can help me out with this example in order to see it this practical case of mine.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "edited": false, "score": 0, "creation_date": 1509546611, "post_id": 47057145, "comment_id": 81061508, "body": "It worked perfectly, Thank you! i still need to add the sum to the end of the list though?"}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "edited": false, "score": 0, "creation_date": 1509546846, "post_id": 47057145, "comment_id": 81061668, "body": "Copy that, just saw that sentence of the question. See edited answer. It utilizes the fact that the values for both <code>n</code> and <code>i</code> are still stored."}, {"owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "edited": false, "score": 0, "creation_date": 1509547094, "post_id": 47057145, "comment_id": 81061861, "body": "A small change and it works! thank you!  cells(i+1-n+1,8) or else it will fill it into the last line."}], "tags": [], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "is_accepted": true, "score": 0, "last_activity_date": 1509546721, "last_edit_date": 1509546721, "creation_date": 1509546351, "answer_id": 47057145, "question_id": 47056303, "link": "https://stackoverflow.com/questions/47056303/add-cell-values-to-a-list-filling-cells-without-empty-cells-difficult-to-explai/47057145#47057145", "title": "Add cell values to a list, filling cells without empty cells difficult to explain. (see picture in description)", "body": "<p>One way to do this is to simply add an offset value every time a cell is not included. This would just be a simple counter in the <code>Else</code> portion of the <code>If</code> statement.</p>\n\n<pre><code>Sub MakeList()\n\nDim i As Long\n\nDim Sum As Double\nSum = 0\n\nDim n As Long\nn = 0\n\nFor i = 1 To Rows.Count\n    If Cells(i, 4) = True Then\n        Cells(1 + i - n, 6) = Cells(i, 1)\n        Cells(1 + i - n, 7) = Cells(i, 2)\n        Cells(1 + i - n, 8) = Cells(i, 3)\n\n        Sum = Sum + Cells(i, 3)\n    Else\n        n = n + 1\n    End If\n\nNext i\n\n    'Place sum at the bottom of the original table\n    'Cells(24, 4) = Sum\n\n    'Place sum at the bottom of the output table\n    Cells(i + 1 - n, 8) = Sum\n\nEnd Sub\n</code></pre>\n\n<p>This tells your code that every time an item is not included, the output should be offset by that row. I also moved the summation inside the original loop, to avoid looping twice. Let me know if this works for you.</p>\n"}], "owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 47057145, "answer_count": 1, "score": 0, "last_activity_date": 1528946855, "creation_date": 1509543751, "last_edit_date": 1528946855, "question_id": 47056303, "link": "https://stackoverflow.com/questions/47056303/add-cell-values-to-a-list-filling-cells-without-empty-cells-difficult-to-explai", "title": "Add cell values to a list, filling cells without empty cells difficult to explain. (see picture in description)", "body": "<p>I am working on a project where I want end users to be able to check of the items they need. the checked off items then need to be added to a list beside the items. the problem im having is that i can't figure out how to get excel to add info to the lines without skipping lines where items aren't checked. this is difficult to explain, but the picture attached show exactly what i mean. At the end of the list there should be a sum of the prices and this sum should always be shown after the last line with data so it should be able to move depending on how many lines of data there is. so this is my problem. </p>\n\n<pre><code>Sub MakeList()\nDim i As Long\n\n    For i = 1 To Rows.Count\n        If Cells(i, 4) = True Then\n            Cells(i, 6) = Cells(i, 1)\n            Cells(i, 7) = Cells(i, 2)\n            Cells(i, 8) = Cells(i, 3)\n        End If\n    Next i\n\n    For i = 1 To Rows.Count\n        If Cells(i, 4) = True Then\n            Sum = Sum + Cells(i, 3)\n        End If\n    Next i\n\n    Cells(24, 4) = Sum\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SpO4s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SpO4s.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["string", "ms-access", "variables", "vba", "subroutine"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1509545382, "creation_date": 1509545382, "answer_id": 47056821, "question_id": 47056132, "link": "https://stackoverflow.com/questions/47056132/can-i-use-a-string-variable-as-part-of-a-command-in-access-vba/47056821#47056821", "title": "Can I use a string variable as part of a command in Access VBA?", "body": "<p>As I understand it, your <em>(TFNum)Wet</em> is a control on a form. If that's the case, you can just use the controls collection:</p>\n\n<pre><code>Me.Controls(TFNum &amp; \"Wet\") = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8670600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef110fb2bd9bda686d48d870ab0fac8?s=128&d=identicon&r=PG", "display_name": "VanGoghComplex", "link": "https://stackoverflow.com/users/8670600/vangoghcomplex"}, "is_accepted": false, "score": 0, "last_activity_date": 1509545509, "creation_date": 1509545509, "answer_id": 47056870, "question_id": 47056132, "link": "https://stackoverflow.com/questions/47056132/can-i-use-a-string-variable-as-part-of-a-command-in-access-vba/47056870#47056870", "title": "Can I use a string variable as part of a command in Access VBA?", "body": "<p>Okay, I know this question wasn't long-lived, but a friend in the office solved it for me.</p>\n\n<p>The code on the subroutine needed to look like this:</p>\n\n<pre><code>Private Sub clearWetData(TFNum As String)\n\n    'Call this subroutine to clear wet data from test forms on uncheck of dry comm step.\n    'This subroutine relies on the TFNum argument to decide which test form's wet data to clear.\n    Me.Controls(TFNum &amp; \"Wet\") = False\n    Me.Controls(TFNum &amp; \"Wdate\").Visible = True\n    Me.Controls(TFNum &amp; \"Wdate\").Enabled = True\n    Me.Controls(TFNum &amp; \"Wdate\").SetFocus\n    Me.Controls(TFNum &amp; \"Wdate\") = \"\"\n    Me.Controls(TFNum &amp; \"Wdate\").Enabled = False\n    Me.Controls(TFNum &amp; \"Wet_Label\").Visible = False\n    Me.Controls(TFNum &amp; \"Wet\").Visible = False\n    Me.Controls(TFNum &amp; \"Wdate_Label\").Visible = False\n    Me.Controls(TFNum &amp; \"Wdate\").Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>The Me.Controls is an array of all the form controls. By invoking it first instead of the desired form control directly, I can use my variable TFNum as part of a string defining which form control I want to interact with.</p>\n"}], "owner": {"reputation": 3, "user_id": 8670600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef110fb2bd9bda686d48d870ab0fac8?s=128&d=identicon&r=PG", "display_name": "VanGoghComplex", "link": "https://stackoverflow.com/users/8670600/vangoghcomplex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 47056821, "answer_count": 2, "score": 0, "last_activity_date": 1594638870, "creation_date": 1509543268, "last_edit_date": 1594638870, "question_id": 47056132, "link": "https://stackoverflow.com/questions/47056132/can-i-use-a-string-variable-as-part-of-a-command-in-access-vba", "title": "Can I use a string variable as part of a command in Access VBA?", "body": "<p>I have a form in Access which has some VBA automation in it to prevent junk data from being entered into the database. Part of that automation is to clear steps downstream of a step the user unchecks. It's tracking a linear process, so if steps 1, 2, 3, and 4 are complete, and the user unchecks 2, the code unchecks 3 and 4.</p>\n\n<p>These steps are spread out over a multitude of possible testing forms. I want to code one subroutine that the program can call for the automatic unchecking, and pass a variable to the sub based on which test form the user clicked.</p>\n\n<p>Here's my code, which isn't working. (\"Dry\" and \"Wet\" are steps in the process, in that order.):</p>\n\n<pre><code>Private Sub t2Dry_AfterUpdate()\n    Dim TFNum As String\n    TFNum = \"t2\"\n    'Autodate and expose wet check fields once t2dry box is checked\n    If t2Dry Then\n    t2DDate.Enabled = True\n    t2DDate.SetFocus\n    t2DDate = Date\n    t2Wet_Label.Visible = True\n    t2Wet.Visible = True\n    t2Wdate_Label.Visible = True\n    t2Wdate.Visible = True\n    End If\n\n    'If dry box unchecked after date entered, undo all subsequent steps\n    If Not t2Dry And t2date = \"\" Then\n    Dim t2DUnchk As Byte\n    t2DUnchk = msgbox(\"Unchecking this box will clear all subsequent data. Are you sure?\", vbYesNo + vbQuestion, \"Undo this step?\")\n    If t2DUnchk = vbYes Then\n    t2DDate.SetFocus\n    t2DDate = \"\"\n    t2DDate.Enabled = False\n    clearWetData (TFNum)\n    Else: t2Dry = True\n    t2DDate.SetFocus\n    End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Note that this is only for Test Form 2, which is defined in my database and code as t2. This is the reason for declaring the TFNum variable. 7 lines from the bottom, you'll see me calling the subroutine I've written to clear the wet data after a user unchecks the dry box and wet data exists. Here is that subroutine:</p>\n\n<pre><code>Private Sub clearWetData(TFNum)\n\n        'Call this subroutine to clear wet data from test forms on uncheck of dry comm step.\n        'This subroutine relies on the TFNum argument to decide which test form's wet data to clear.\n        (TFNum)Wet = False\n        t2Wdate.Visible = True\n        t2Wdate.Enabled = True\n        t2Wdate.SetFocus\n        t2Wdate = \"\"\n        t2Wdate.Enabled = False\n        t2Wet_Label.Visible = False\n        t2Wet.Visible = False\n        t2Wdate_Label.Visible = False\n        t2Wdate.Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>That first line after the comments is an example of what I'm trying to do: use the passed variable TFNum (which is a string containing the text \"t2\") as part of an object name. \"t2Wet\" is the name of one of my checkbox objects I'm trying to clear, so I want it to parse that way.</p>\n\n<p>All the remaining code, which begins with t2, is already working; the subroutine clears everything but the checkbox when called.</p>\n\n<p>Sorry for the short novel, I wanted to be a detailed as I could. Thanks for your help!</p>\n"}, {"tags": ["excel", "lookup", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509543334, "post_id": 47056123, "comment_id": 81059210, "body": "If you have Office 365 Excel you can use TEXTJOIN()."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509543474, "post_id": 47056123, "comment_id": 81059312, "body": "If not see here for some code that mimics TEXTJOIN and how to use it: <a href=\"https://stackoverflow.com/questions/39532189/vlookup-with-multiple-criteria-returning-values-in-one-cell\" title=\"vlookup with multiple criteria returning values in one cell\">stackoverflow.com/questions/39532189/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 2211842, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YfMlM.png?s=128&g=1", "display_name": "McClaudLive", "link": "https://stackoverflow.com/users/2211842/mcclaudlive"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509720985, "post_id": 47056123, "comment_id": 81146995, "body": "I have come up with a simple solution. Thank you for the input.  :)"}], "owner": {"reputation": 43, "user_id": 2211842, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YfMlM.png?s=128&g=1", "display_name": "McClaudLive", "link": "https://stackoverflow.com/users/2211842/mcclaudlive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "closed_date": 1509543704, "answer_count": 0, "score": 1, "last_activity_date": 1509543399, "creation_date": 1509543247, "last_edit_date": 1531164843, "question_id": 47056123, "link": "https://stackoverflow.com/questions/47056123/multiple-lookup-using-excel-vba", "closed_reason": "Duplicate", "title": "Multiple lookup using Excel VBA", "body": "<p>I have two tables in Excel 2013 in two different sheets - both starting in Cell A1:</p>\n\n<hr>\n\n<p><strong>Sheet A table</strong></p>\n\n<pre><code>A1:A3 | B1:B3    \na001  | ?    \na002  | ?    \nb001  | ?\n</code></pre>\n\n<hr>\n\n<p><strong>Sheet B table</strong></p>\n\n<pre><code>A1:A5 | B1:B5    \nb001  | 75    \na002  | 85    \nb001  | 60    \nb002  | 25    \nb001  | 50\n</code></pre>\n\n<hr>\n\n<p>I would like to make a simple lookup in the Sheet B table range A1:A5 for each cell value in Sheet A table range A1:A3. Where there is a match I would like the corresponding value in Sheet B table range B1:B5 to be copied to the Sheet A table B1:B3. If there are multiple matches they all should be copied and displayed separated by a semicolon. The result should look like this:</p>\n\n<hr>\n\n<p><strong>Sheet A table (updated)</strong></p>\n\n<pre><code>A1:A3 | B1:B3    \na001  |    \na002  | 85    \nb001  | 75;60;50\n</code></pre>\n\n<hr>\n\n<p>I've started with this code but can't get further:</p>\n\n<pre><code>Sub DeleteRow()\nFor Each c In Range(\"A1:A5\")\n    If c = ??? Then ???\nNext\nEnd Sub\n</code></pre>\n\n<p>I hope somebody can help.</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 6845666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7121d86d37fa1c7568d6d2ce07d30b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jerred S.", "link": "https://stackoverflow.com/users/6845666/jerred-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1509727257, "creation_date": 1509727257, "answer_id": 47100588, "question_id": 47056042, "link": "https://stackoverflow.com/questions/47056042/vba-ms-project-save-multiple-custom-reports-as-pdfs-to-location/47100588#47100588", "title": "VBA MS Project Save Multiple Custom Reports as PDFs to Location", "body": "<p>You can change both the report name and the exported PDF location\\name by hand or with string manipulation.  </p>\n\n<pre><code>Sub Macro2()\n' Macro Macro2\n' Macro Recorded 11/3/17 by me.\n    ApplyReport Name:=\"Lauren\"\n    DocumentExport fileName:=\"X:\\Schedule\\Schedules\\Lauren.pdf\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 8868342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eca8211d0413f54d91d9049ccde1575?s=128&d=identicon&r=PG&f=1", "display_name": "TryDaRyGuy", "link": "https://stackoverflow.com/users/8868342/trydaryguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509727257, "creation_date": 1509543010, "last_edit_date": 1509721139, "question_id": 47056042, "link": "https://stackoverflow.com/questions/47056042/vba-ms-project-save-multiple-custom-reports-as-pdfs-to-location", "title": "VBA MS Project Save Multiple Custom Reports as PDFs to Location", "body": "<p>I am trying to figure the VBA to save 7 separate custom reports made within MS Project as PDFs to a particular folder on a drive. </p>\n\n<p>For example I would like to save the report named \"Lauren\" as a PDF to X:\\Schedule\\Schedules , then also save report named \"Carol\" as a PDF to the same location, then Report \"Jenni\" to the same location, etc...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1509542767, "post_id": 47055860, "comment_id": 81058826, "body": "Could you show more code?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1509542856, "post_id": 47055860, "comment_id": 81058881, "body": "And which version of Excel are you using?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1509543401, "post_id": 47055860, "comment_id": 81059262, "body": "Can you also show a sample of your sheet?"}, {"owner": {"reputation": 35, "user_id": 8868347, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215064404988900/picture?type=large", "display_name": "Chris Hill", "link": "https://stackoverflow.com/users/8868347/chris-hill"}, "edited": false, "score": 0, "creation_date": 1509543490, "post_id": 47055860, "comment_id": 81059325, "body": "Yes, first time posting so wasn&#39;t sure what all to include. I&#39;m using Office 365 so Excel 2016. This is part of 250+ line sub that works with the data set and relevant graphs (admittedly I should probably break this up). Should I attempt to pull out all lines relevant to this problem and post those?"}, {"owner": {"reputation": 2394, "user_id": 4584038, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153654527738797/picture?type=large", "display_name": "Pablo Palacios", "link": "https://stackoverflow.com/users/4584038/pablo-palacios"}, "edited": false, "score": 0, "creation_date": 1509543495, "post_id": 47055860, "comment_id": 81059333, "body": "Please give m,ore feedback on the code you are using."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1509546992, "post_id": 47055860, "comment_id": 81061787, "body": "You could use Sheets(dataSheetName).AutoFilter.Range.Copy or .AutoFilter.Range.Offset(1, 0).Copy to not copy the header row."}, {"owner": {"reputation": 35, "user_id": 8868347, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215064404988900/picture?type=large", "display_name": "Chris Hill", "link": "https://stackoverflow.com/users/8868347/chris-hill"}, "edited": false, "score": 0, "creation_date": 1509559595, "post_id": 47055860, "comment_id": 81069806, "body": "Can you explain a little more how auto filter would help in this situation? I don&#39;t want to actually filter any data. I just want to copy the visible data based on what the user chooses to filter out."}], "owner": {"reputation": 35, "user_id": 8868347, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215064404988900/picture?type=large", "display_name": "Chris Hill", "link": "https://stackoverflow.com/users/8868347/chris-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509553067, "creation_date": 1509542513, "last_edit_date": 1509553067, "question_id": 47055860, "link": "https://stackoverflow.com/questions/47055860/excel-vba-issue-copying-from-filtered-data-set", "title": "Excel VBA issue copying from filtered data set", "body": "<p>I am working on a large project, but am fairly new to VBA. Part of what I am trying to do requires me to copy data from a pre-filtered data set over to a new sheet. From what I have found online it seems like the best way to do this is by using <code>.SpecialCells(xlCellTypeVisible).Copy</code>. Unfortunately this doesn't seem to work for me.</p>\n\n<p>Currently when the code runs it copies all cell values to the new sheet, even filtered or blank cells. My goal is to just have the visible cells copy over.</p>\n\n<p>Here is the relevant code that I have so far...</p>\n\n<pre><code>Sheets(dataSheetName).Range(yColumn &amp; periodStart &amp; \":\" &amp; yColumn &amp; periodEnd).SpecialCells(xlCellTypeVisible).Copy\nSheets(VBASheetName).Range(ySourceColumn &amp; VBAheaderRow + groupCount(groupIndex) + 1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Edit: People have asked for additional context and information. The goal of this code is to add trendlines to charts based on multiple series. From what I could find the only way to do this was to combine the data into one sheet and then can use slope and intercept formulas to solve for the trendline. This seems to be working when the data sources are unfiltered, but I want the user to be able to filter data have the correct trendlines. Hopefully that makes sense.</p>\n\n<p>Here is a small section of the data I am working with. There are hundred of columns and thousands of rows, but the data is being pulled from here:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7CQ4J.png\" alt=\"Data source to be copied\"></p>\n\n<p>The data set is further broken down into time periods and each time period is in a different \"Group.\" The user could filter this in essentially infinite ways and I would like to then copy the filtered data to a new sheet where it is added to the appropriate group column. The header of the source sheet looks like this.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9tpn7.png\" alt=\"Paste loaction\"></p>\n\n<p>This would ultimately be hidden from the user, but data would be copied to the yellow cells and then the slope, intercept, and series values are \"saved\" (copied to a summary table) and used to plot the trendlines. My previous code is in a loop which runs through each time period and copies the data (y source column and x source column) to the correct column in the \"Paste location\" image. This is also repeated for each graph that is created.</p>\n\n<p>And here is a larger section of code. Again this is part of a huge sub and I don't want to post the entire thing (unless someone really wants it), but here is a larger section of the code:</p>\n\n<pre><code>For periodIndex = 1 To 10\n    If graphPeriod = \"Yes\" Then\n        If XYShowTrendlines = \"Yes\" Then\n            'copies the values into the VBA worksheet to graph trendlines as series\n            Sheets(dataSheetName).Range(yColumn &amp; periodStart &amp; \":\" &amp; yColumn &amp; periodEnd).SpecialCells(xlCellTypeVisible).Copy\n            Sheets(VBASheetName).Range(Split(Cells(1, (groupIndex * 2)).Address, \"$\")(1) &amp; VBAHeaderRowXYGroupData + groupCount(groupIndex) + 1).PasteSpecial xlPasteValues\n            Sheets(dataSheetName).Range(xColumn &amp; periodStart &amp; \":\" &amp; xColumn &amp; periodEnd).SpecialCells(xlCellTypeVisible).Copy\n            Sheets(VBASheetName).Range(Split(Cells(1, (groupIndex * 2) - 1).Address, \"$\")(1) &amp; VBAHeaderRowXYGroupData + groupCount(groupIndex) + 1).PasteSpecial xlPasteValues\n\n            Worksheets(VBASheetName).Calculate\n            'copies the calculated x and y values to the summary table\n            Dim index As Integer\n            For index = 1 To 12\n                If IsError(Sheets(VBASheetName).Range(Split(Cells(1, ((index + (index Mod 3)) / 3) + 4).Address, \"$\")(1) &amp; \"3\")) = False Then\n                    If index Mod 3 = 0 Then\n                        'slope and r-squared\n                        Sheets(VBASheetName).Range(Split(Cells(1, (index / 3) + 4).Address, \"$\")(1) &amp; \"3:\" &amp; Split(Cells(1, (index / 3) + 4).Address, \"$\")(1) &amp; \"4\").Copy\n                    Else\n                        'values\n                        Sheets(VBASheetName).Range(Split(Cells(1, index - ((index - (index Mod 3)) / 3)).Address, \"$\")(1) &amp; \"10:\" &amp; Split(Cells(1, index - ((index - (index Mod 3)) / 3)).Address, \"$\")(1) &amp; \"11\").Copy\n                    End If\n                    Sheets(VBASheetName).Range(Split(Cells(1, index * 2 + 9).Address, \"$\")(1) &amp; VBAHeaderRowXYGroupData + graphIndex &amp; \":\" &amp; Split(Cells(1, index * 2 + 10).Address, \"$\")(1) &amp; VBAHeaderRowXYGroupData + graphIndex).PasteSpecial xlPasteValues, Transpose:=True\n                End If\n            Next index\n            Worksheets(XYSheetName).Activate\n        End If\n    End If\nNext periodIndex\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1509541879, "post_id": 47055646, "comment_id": 81058246, "body": "Chill out and use a <code>Variant</code> instead."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509541933, "post_id": 47055646, "comment_id": 81058277, "body": "1. do not set a string array. 2. ^^^^^ 3. <code>GetVars</code> &lt;&gt; <code>GetVariables</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1509542136, "post_id": 47055646, "comment_id": 81058407, "body": "Remove the <code>Set</code> keyword. It is for objects."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 3786134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KPcHg.jpg?s=128&g=1", "display_name": "user3786134", "link": "https://stackoverflow.com/users/3786134/user3786134"}, "edited": false, "score": 0, "creation_date": 1509542999, "post_id": 47055853, "comment_id": 81058986, "body": "thank you for your answer but my first array in the function is dynamic.."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1509544444, "post_id": 47055853, "comment_id": 81060035, "body": "How the first array is being built? When you are saying the first array is dynamic then at what point are you deciding you need to populate the second array?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509552993, "post_id": 47055853, "comment_id": 81065757, "body": "There is no difference if the array is dynamic. I adapted the example using a dynamic array."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 3, "last_activity_date": 1509552960, "last_edit_date": 1509552960, "creation_date": 1509542494, "answer_id": 47055853, "question_id": 47055646, "link": "https://stackoverflow.com/questions/47055646/assign-one-array-to-another-in-vba/47055853#47055853", "title": "assign one array to another in vba", "body": "<p>As a more elaborate example of your function/sub:</p>\n\n<pre><code>Public Function GetVariables() As String()\n    Dim Vars() As String\n    ReDim Preserve Vars(2)\n    Vars(1) = \"hello\"\n    Vars(2) = \"world\"\n    GetVariables = Vars\nEnd Function\n\nPublic Function popu()\n    Dim Vars() As String\n    Dim i\n    Vars = GetVariables()\n    For i = 1 To UBound(Vars)\n        Debug.Print Vars(i)\n    Next i\nEnd Function\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>hello\nworld\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 2, "last_activity_date": 1509542965, "creation_date": 1509542965, "answer_id": 47056023, "question_id": 47055646, "link": "https://stackoverflow.com/questions/47055646/assign-one-array-to-another-in-vba/47056023#47056023", "title": "assign one array to another in vba", "body": "<p>You're doing a few things wrong here. First, as others have noted in the comments, <code>Set</code> is a special keyword for assigning <code>Object</code> variables, and thus <code>Set</code> will cause an error here.</p>\n\n<p>Next, you must be sure to properly assign back to your function call. Currently your code:</p>\n\n<pre><code>Public Function popu()\n    Dim Vars() As String\n    Set Vars = GetVars()\nEnd Function\n</code></pre>\n\n<p>Is doing four things wrong. </p>\n\n<ul>\n<li><p><code>Vars()</code> is not equal to <code>Vars()</code>.</p></li>\n<li><p><code>GetVars()</code> is not equal to <code>Public Function GetVariables()</code></p></li>\n<li><p>You shouldn't include an empty parentheses on a function call.</p></li>\n<li><p>Arrays should be declared as <code>Variant</code>. You can declare an array as a <code>String()</code>, which creates a string array, but this is generally avoided. Addiitonally, you could declare your variable as a <code>Variant()</code> but this will cause issues if you ever try to return a null value (such as <code>vbNullString</code>, or <code>Empty</code>).</p></li>\n</ul>\n\n<p>Therefore, your code should be:</p>\n\n<pre><code>Public Function GetVariables() As Variant\n    Dim Variables As Variant\n    GetVariables = Variables \nEnd Function\n\n' Make sure your function has an explicit returntype, even if that return is variant.\nPublic Function popu() as Variant\n    Dim Variables As Variant\n    Variables = GetVariables\nEnd Function\n</code></pre>\n\n<p>As Paul demonstrates in his answer, your array can be instantiated with dimensions pre-defined, and you can hardcode the values into your array. It definitely depends on your application, but you will want to read the documentation on arrays to understand the different uses and methods for creating them.</p>\n"}], "owner": {"reputation": 241, "user_id": 3786134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KPcHg.jpg?s=128&g=1", "display_name": "user3786134", "link": "https://stackoverflow.com/users/3786134/user3786134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7133, "favorite_count": 0, "accepted_answer_id": 47056023, "answer_count": 2, "score": 0, "last_activity_date": 1509552960, "creation_date": 1509541813, "last_edit_date": 1509542304, "question_id": 47055646, "link": "https://stackoverflow.com/questions/47055646/assign-one-array-to-another-in-vba", "title": "assign one array to another in vba", "body": "<p>In my project I work with arrays a lot and I would like to find a way to assign the return value of one function (which is array) to another newly declared array. I searched and found a way which suggests that I split the array and the rejoin it into another, but I would like a more precise way of handling this requirement...\nLet's say the function that is going to return the value:</p>\n\n<pre><code>Public Function GetVariables() As String()\nDim Vars() As String\nGetVariables = Vars       \nEnd Function\n</code></pre>\n\n<p>and the function using it:</p>\n\n<pre><code>Public Function popu()\n    Dim Vars() As String\n    Set Vars = GetVars()\nEnd Function\n</code></pre>\n\n<p>but this gives me an error:</p>\n\n<pre><code>can not assign to array\n</code></pre>\n\n<p>i would be very grateful of your sincere help.</p>\n"}, {"tags": ["excel", "string", "vba", "split"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1509541297, "post_id": 47055480, "comment_id": 81057867, "body": "Is the white space not a delimiter here?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1509543988, "post_id": 47055480, "comment_id": 81059714, "body": "If you just want to collect the game scores, what would you expect after the first set? would you then want the set score and game score? or still just the game score? Also, how would you want this displayed? i.e. in another sheet or same sheet after the last used cell"}], "answers": [{"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1509547330, "creation_date": 1509547330, "answer_id": 47057451, "question_id": 47055480, "link": "https://stackoverflow.com/questions/47055480/excel-vba-splitting-a-big-string-with-no-good-delimiters/47057451#47057451", "title": "Excel VBA: Splitting a big string with no good delimiters", "body": "<p>Based on the example you've provided, below UDF will give you an array (<strong><code>aGameScore</code></strong>) with set details. Number of elements of the array correspond to the number of sets listed in the string. Each element starts with either <code>Left Player</code> or <code>Right Player</code>: indicating which player served first in the set. After that, each array element holds the score of each game listed in the string</p>\n\n<pre><code>Sub GetScores()\n\n    Dim aScores As Variant\n    Dim aGameScore As Variant\n    Dim iC&amp;, iHyphLoc&amp;, iServerLoc&amp;\n    Dim sServer$\n\n    With ThisWorkbook.Worksheets(\"Sheet13\")\n\n        aScores = Split(.Range(\"A2\"), \" \")\n\n        For iC = LBound(aScores) To UBound(aScores)\n            If InStr(1, aScores(iC), \"0-0\") &gt; 0 And InStr(1, aScores(iC), \"[\") = 0 Then\n                ' Set who sereved in the first game\n                iC = iC + 1\n                If IsArray(aGameScore) Then\n                    ReDim Preserve aGameScore(UBound(aGameScore) + 1)\n                Else\n                    ReDim aGameScore(0)\n                End If\n                iHyphLoc = InStr(1, aScores(iC), \"-\")\n                iServerLoc = InStr(1, aScores(iC), \"*\")\n                If iHyphLoc &gt; iServerLoc Then\n                    aGameScore(UBound(aGameScore)) = \"Left Player\"\n                Else\n                    aGameScore(UBound(aGameScore)) = \"Right Player\"\n                End If\n            ElseIf InStr(1, aScores(iC), \"[\") = 0 Then\n                ' Capture game scores\n                If iC = UBound(aScores) Then\n                    aGameScore(UBound(aGameScore)) = aGameScore(UBound(aGameScore)) &amp; \" | \" &amp; Trim(aScores(iC))\n                ElseIf InStr(1, aScores(iC + 1), \"[\") &lt;&gt; 0 Then\n                    aGameScore(UBound(aGameScore)) = aGameScore(UBound(aGameScore)) &amp; \" | \" &amp; Trim(aScores(iC))\n                End If\n            End If\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>At the moment the UDF is only checking the text in cell <code>A2</code> of <code>Worksheet(13)</code>. You can further modify this to look at all the cells in your range</p>\n"}], "owner": {"reputation": 1, "user_id": 8701446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qMYBS.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/8701446/buddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1509547330, "creation_date": 1509541206, "last_edit_date": 1509542114, "question_id": 47055480, "link": "https://stackoverflow.com/questions/47055480/excel-vba-splitting-a-big-string-with-no-good-delimiters", "title": "Excel VBA: Splitting a big string with no good delimiters", "body": "<p><strong>Dear all,</strong></p>\n\n<p>I need to split a large string from a single cell, with no good delimiters. It's a 'point-by-point' date from a tennis match, exported directly to an Excel workbook from a third-party software.</p>\n\n<p>Unfortunately, I do not know the VBA language enough to solve this by my own, and I could not find a similar example here in the forum. So, can some blessed soul help me, please?</p>\n\n<p>This is an example of the content of my A1 cell:</p>\n\n<pre><code>0-0 [*0-0] [0-15*] [15-15*] [15-30*] [30-30*] [40-30*] [40-40*] [40-A*] [40-40*] [A-40*] 1-0 [*0-0] [*0-15] [*15-15] [*15-30] [*30-30] [*40-30] 2-0 [0-0*] [15-0*] [30-0*] [30-15*] [40-15*] 3-0 [*0-0] [*0-15] [*15-15] [*30-15] [*40-15] 4-0 [0-0*] [15-0*] [30-0*] [40-0*] 5-0 [*0-0] [*15-0] [*15-15] [*30-15] [*40-15] 6-0 0-0 [0-0*] [0-15*] [0-30*] [0-40*] 6-0 0-1 [*0-0] [*0-15] [*15-15] [*15-30] [*30-30] [*30-40] [*40-40] [*A-40] 6-0 1-1 [0-0*] [0-15*] [15-15*] [30-15*] [30-30*] [40-30*] 6-0 2-1 [*0-0] [*15-0] [*15-15] [*15-30] [*30-30] [*40-30] [*40-40] [*A-40] [*40-40] [*A-40] [*40-40] [*40-A] 6-0 2-2 [0-0*] [0-15*] [0-30*] [15-30*] [15-40*] 6-0 2-3 [*0-0] [*0-15] [*0-30] [*0-40] 6-0 2-4 [0-0*] [0-15*] [0-30*] [0-40*] 6-0 2-5 [*0-0] [*15-0] [*30-0] [*30-15] [*40-15] 6-0 3-5 [0-0*] [0-15*] [0-30*] [15-30*] [30-30*] [40-30*] 6-0 4-5 [*0-0] [*15-0] [*30-0] [*40-0] 6-0 5-5 [0-0*] [0-15*] [15-15*] [30-15*] [30-30*] [30-40*] [40-40*] [40-A*] 6-0 5-6 [*0-0] [*15-0] [*30-0] [*30-15] [*40-15] [*40-30] 6-0 6-6 [0-0*] [*1-0] [*2-0] [2-1*] [3-1*] [*4-1] [*5-1] [6-1*] 6-0 7-6(1)\n</code></pre>\n\n<ul>\n<li>The * indicates who is serving.</li>\n<li>The numbers inside the brackets are the points inside each game or in a tiebreak.</li>\n<li>The numbers outside the brackets are the final score of each game.</li>\n<li>After the end of the first set (6-X or 7-5), the numbers outside the brackets include the previously set scores.</li>\n</ul>\n\n<p><strong>Important:</strong> The first characters, before the first real point <code>[0-15*]</code>, are useless, IMO. First, because the indication of who is serving is usually wrong (like in this example); Second, because sometimes the string starts a little different, without the first <code>\"0-0\"</code> or with some other useless zeros, like <code>\"0-0 [0-0] [* 0-0]\"</code>.</p>\n\n<p>That said, what I need extract from this data are only two things:</p>\n\n<ul>\n<li>A column saying who served in the first game (left player or right player);</li>\n<li>The sequence only of the games scores (without the point-by-point) in different columns;</li>\n</ul>\n\n<p>Like this:</p>\n\n<pre><code>*1-0 | 1-1 | 2-1 | 3-1 | 4-1 ...*\n</code></pre>\n\n<p>I already did this using Excel formulas, but I needed dozens of new columns, each one with big inefficient formulas, what is making it impossible to process in Excel.</p>\n\n<p><strong>Is there a easiest way to do this using VBA Excel? Do I have to use another software or language, like R or Power Bi?</strong></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1509574518, "creation_date": 1509574518, "answer_id": 47064531, "question_id": 47055413, "link": "https://stackoverflow.com/questions/47055413/deleting-appointments-from-shared-outlook-calendar/47064531#47064531", "title": "Deleting appointments from shared Outlook calendar", "body": "<p><code>olkSession.GetDefaultFolder(olFolderCalendar)</code> would retrieve your default Calendar folder. You need to either use <code>olkSession.GetSharedDefaultFolder(someRecipient, olFolderCalendar)</code> (where <code>someRecipient</code> is returned by <code>olkSession.CreateRecipient)</code> or open the appropriate store from the Namespace.Stores collection (assuming the delegate mailbox is already there) and call <code>Store.GetDefaultFolder</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 11837984, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/315f043aa816171f96810d29589b3550?s=128&d=identicon&r=PG", "display_name": "Frank Zakikian", "link": "https://stackoverflow.com/users/11837984/frank-zakikian"}, "is_accepted": true, "score": 1, "last_activity_date": 1564079773, "creation_date": 1564079773, "answer_id": 57208271, "question_id": 47055413, "link": "https://stackoverflow.com/questions/47055413/deleting-appointments-from-shared-outlook-calendar/57208271#57208271", "title": "Deleting appointments from shared Outlook calendar", "body": "<p>This is how I did it.</p>\n\n<pre><code>Sub Delete_SharedCal_History()\n    DeleteCal_Appts \"Office Calendar\", \"1/9/2001\", \"0:00:01\", \"12/31/2013\", \"23:59:59\"\nEnd Sub\n\nSub DeleteCal_Appts(sCalendarName As String, ap_dateStart As String, ap_startTime As String, ap_dateEnd As String, ap_endTime As String)\n'   Specified Shared Calendar - Delete all events in specified Date Range\n'   Author: Frank Zakikian\n    Dim objAppointment As AppointmentItem\n    Dim objAppointments As Items\n    Dim objNameSpace As NameSpace\n    Dim objRecip As Recipient\n    Dim nInc As Integer\n    Dim sFilter As Variant\n    Dim dtStartTime As Date, dtEndTime As Date\n    dtStartTime = CDate(ap_dateStart &amp; \" \" &amp; ap_timeStart)\n    dtEndTime = CDate(ap_dateEnd &amp; \" \" &amp; ap_timeEnd)\n\n    Set objNameSpace = Application.GetNamespace(\"MAPI\")\n    'next line would be for use of personal calendar object..\n    'Set objAppointments = objNameSpace.GetDefaultFolder(olFolderCalendar)\n    Set objRecip = objNameSpace.CreateRecipient(sCalendarName)\n    objRecip.Resolve\n    'Debug.Print objRec.AddressEntry\n    Set objAppointments = objNameSpace.GetSharedDefaultFolder(objNameSpace.CreateRecipient(\"Akron Chambers Calendar\"), olFolderCalendar).Items\n\n    sFilter = \"[Start] &gt; '\" &amp; Format(dtStartTime, \"ddddd h:nn AMPM\") &amp; _\n      \"' And [Start] &lt; '\" &amp; Format(dtEndTime, \"ddddd h:nn AMPM\") &amp; \"'\"\n    objAppointments.Sort \"[Start]\", False\n    Debug.Print \"Total Items at begin: \" &amp; objAppointments.Count 'dev. fyi\n    Set objAppointment = objAppointments.Find(sFilter)\n    While TypeName(objAppointment) &lt;&gt; \"Nothing\"\n        'If MsgBox(objAppointment.Subject &amp; vbCrLf &amp; \"Delete \" &amp; objRec.AddressEntry &amp; \" item now? \", vbYesNo, \"Delete Calendar Item\") = vbYes Then\n            objAppointment.Delete\n            nInc = nInc + 1\n        'End If\n        Set objAppointment = objAppointments.FindNext\n    Wend\n    MsgBox \"Deleted \" &amp; nInc &amp; \" calendar items.\", vbInformation, \"Delete done\"\n    Debug.Print \"Total Items at finish: \" &amp; objAppointments.Count 'dev. fyi\n    Set objAppointment = Nothing\n    Set objAppointments = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 218, "user_id": 8761052, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d0d4f61ff8005bbd8654b09d3842385?s=128&d=identicon&r=PG&f=1", "display_name": "sharsart", "link": "https://stackoverflow.com/users/8761052/sharsart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 57208271, "answer_count": 2, "score": 1, "last_activity_date": 1564265577, "creation_date": 1509540969, "last_edit_date": 1564265577, "question_id": 47055413, "link": "https://stackoverflow.com/questions/47055413/deleting-appointments-from-shared-outlook-calendar", "title": "Deleting appointments from shared Outlook calendar", "body": "<p>I want to clear a shared calendar.</p>\n\n<p>I have a delete method that works in my Outlook calendar however it doesn't clear the shared calendar.</p>\n\n<pre><code>Private Sub DeleteAllAppointments()\n    Dim olkApp As Object, _\n        olkSession As Object, _\n        olkCalendar As Object, _\n        olkItem As Object, _\n        intIndex As Integer\n    Set olkApp = CreateObject(\"Outlook.Application\")\n    Set olkSession = olkApp.Session\n    olkSession.Logon\n\n    Set olkCalendar = olkSession.GetDefaultFolder(olFolderCalendar)\n    For intIndex = olkCalendar.Items.Count To 1 Step -1\n        Set olkItem = olkCalendar.Items.Item(intIndex)\n        olkItem.Delete\n    Next\n    Set olkItem = Nothing\n    Set olkCalendar = Nothing\n    olkSession.Logoff\n    Set olkSession = Nothing\n    Set olkApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>This is where the method fails</p>\n\n<pre><code>Set olkCalendar = olkSession.GetDefaultFolder(olFolderCalendar)\n</code></pre>\n\n<p>Is this is a folder path issue?  </p>\n"}, {"tags": ["vba", "internet-explorer", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 8930985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8ca235fc5c0e05c3b2f9e33d269812?s=128&d=identicon&r=PG&f=1", "display_name": "Buntes Lama", "link": "https://stackoverflow.com/users/8930985/buntes-lama"}, "is_accepted": false, "score": 0, "last_activity_date": 1510646121, "creation_date": 1510646121, "answer_id": 47280378, "question_id": 47055087, "link": "https://stackoverflow.com/questions/47055087/vba-copy-text-from-website-and-added-into-word-template/47280378#47280378", "title": "VBA - copy text from website and added into word template", "body": "<p>First, look how the general stuff works. Searchbar: <code>VBA IE automation</code></p>\n\n<p>The try</p>\n\n<pre><code>'First, create an object \"ie\" and use \"ie.navigate\" to get to your website. Then:\n\ndim td_col as iHTMLElementCollection\ndim td_elem as iHTMLElement\n\nset td_col = ie.document.getElementsByTagName(\"td\")\nfor each td_elem in td_col\n    Word.Selection.TypeText (vbCrLf + td_elem.innertext)\nNext td_elem\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 9, "user_id": 3799152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000539677980/picture?type=large", "display_name": "georgian1990", "link": "https://stackoverflow.com/users/3799152/georgian1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545419638, "creation_date": 1509540027, "last_edit_date": 1592644375, "question_id": 47055087, "link": "https://stackoverflow.com/questions/47055087/vba-copy-text-from-website-and-added-into-word-template", "title": "VBA - copy text from website and added into word template", "body": "<p>I'm trying to copy data from several IE pages containing contact info for some persons and then add it into a word template using VBA and word content control This needs to be done dynamically country of origin can be different.\nThe HMTL source code from where I would like to extract the data looks like:</p>\n<pre><code>&lt;td rowSpan=&quot;1&quot; colSpan=&quot;1&quot;&gt;\n  Mrs Mallet Anonime\n  &lt;br&gt;&lt;/br&gt;\n  11, RUE FRANCOIS BOLLE\n  &lt;br&gt;&lt;/br&gt;\n  12345 PARIS 05 FRANCE\n  &lt;br&gt;&lt;/br&gt;\n&lt;/td&gt;\n</code></pre>\n<p>As I'm using a word template to do this the writing needs to look in the following order as in a letter:</p>\n<blockquote>\n<p>Mrs Mallet Anonime</p>\n<p>11, RUE FRANCOIS BOLLE</p>\n<p>12345 PARIS 05</p>\n<p>FRANCE</p>\n</blockquote>\n<p>Unfortunately the country may not be same for all of these letters (ENGLAND,SWITZERLAND,etc.).Any ideas how to proceed with this??</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1509539908, "post_id": 47054910, "comment_id": 81056895, "body": "If columns L or M are blank you are trying to paste in the row after the last row in the spreadsheet."}, {"owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1509540872, "post_id": 47054910, "comment_id": 81057571, "body": "That was the error. I addes some random values in L and M and it worked nicely, Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1509540764, "creation_date": 1509540764, "answer_id": 47055346, "question_id": 47054910, "link": "https://stackoverflow.com/questions/47054910/copy-paste-values-while-creating-growing-list/47055346#47055346", "title": "Copy - paste values while creating growing List", "body": "<p>Try the code below, in case you have only 1 row in column \"L\" (I guess header):</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim LastRow As Long\n\nWith Worksheets(\"overdue\")\n    LastRow = .Range(\"L1\").End(xlDown).Row\n\n    If LastRow &gt;= 2 Then\n        If .Range(\"I5\").Value &gt; .Range(\"L\" &amp; LastRow).Value Then\n            .Range(\"L\" &amp; LastRow + 1).Value = .Range(\"I5\").Value\n            .Range(\"M\" &amp; LastRow + 1).Value = .Range(\"I11\").Value\n        End If\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509540764, "creation_date": 1509539446, "last_edit_date": 1531164843, "question_id": 47054910, "link": "https://stackoverflow.com/questions/47054910/copy-paste-values-while-creating-growing-list", "title": "Copy - paste values while creating growing List", "body": "<p>I want to have a macro which runs everytime I open the excel-file, then compares the date (I5) with the last entry in a list (column L), and if the date is older, copy some values (I5 and I11) and paste them in the next empty row of the list (columns L and M). I have written the code bellow but it does not work, I get runtime error 424 and every other syntax I found online and tried to adapt isn't working either. Can anyone help ? </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nIf Worksheets(\"overdue\").Range(\"I5\").Value &gt; Worksheets(\"overdue\").Range(\"L2\").End(xlDown).Value Then  \nWorksheets(\"overdue\").Range(\"I5\").Copy  \nWorksheets(\"overdue\").Range(\"L1\").End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\nWorksheets(\"overdue\").Range(\"I11\").Copy    \nWorksheets(\"overdue\").Range(\"M1\").End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1509546367, "creation_date": 1509546367, "answer_id": 47057154, "question_id": 47054740, "link": "https://stackoverflow.com/questions/47054740/how-can-i-run-formula-on-a-single-selected-cell-in-the-sheet-using-macro/47057154#47057154", "title": "How can I run formula on a single selected cell in the sheet using macro", "body": "<p>You can stop formula calculation with:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual \n</code></pre>\n\n<p>Now you can calculate your cell:</p>\n\n<pre><code>cells(1,1).value = MYFORMULA\n</code></pre>\n\n<p>To restore calculation:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1509562349, "creation_date": 1509562349, "answer_id": 47061734, "question_id": 47054740, "link": "https://stackoverflow.com/questions/47054740/how-can-i-run-formula-on-a-single-selected-cell-in-the-sheet-using-macro/47061734#47061734", "title": "How can I run formula on a single selected cell in the sheet using macro", "body": "<p>If you want to calculate <strong>only</strong> the cell(s) currently selected, you can use:</p>\n\n<pre><code>Selection.Calculate\n</code></pre>\n\n<p>(I assume you have the calculation mode set to \"Manual\", because if it was set to  \"Automatic\" then this cell and every other cell would already have been calculated prior to your macro running.)</p>\n"}], "owner": {"reputation": 19, "user_id": 7749920, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4ab69625bfc73b87330df999051449b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/7749920/nishant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509562349, "creation_date": 1509538883, "last_edit_date": 1531161705, "question_id": 47054740, "link": "https://stackoverflow.com/questions/47054740/how-can-i-run-formula-on-a-single-selected-cell-in-the-sheet-using-macro", "title": "How can I run formula on a single selected cell in the sheet using macro", "body": "<p>How can I run formula on a single selected cell in the sheet using macro. I do not want the macro to update all the cells except the cell that is selected. Thanks for any help on this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1509538745, "post_id": 47054359, "comment_id": 81056179, "body": "Don&#39;t use <code>Select</code>, turn <code>Application.ScreenUpdating = False</code>. If it&#39;s still really struggling turn <code>Application.Calculation = xlCalculationManual</code>"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8867916, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155348332491339/picture?type=large", "display_name": "Dominic Legendre", "link": "https://stackoverflow.com/users/8867916/dominic-legendre"}, "edited": false, "score": 1, "creation_date": 1509539782, "post_id": 47054906, "comment_id": 81056822, "body": "The app screen updating and app calc lines at beginning and end of my sub worked amazingly well, now results come in almost instantly, thanks!"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509541311, "post_id": 47054906, "comment_id": 81057874, "body": "Yes, of all things mentioned, #3 can have the most dramatic effect on time-to-complete."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1509539435, "last_edit_date": 1592644375, "creation_date": 1509539435, "answer_id": 47054906, "question_id": 47054359, "link": "https://stackoverflow.com/questions/47054359/faster-compare-method-in-excel-using-vba/47054906#47054906", "title": "Faster compare method in Excel using VBA", "body": "<h1>1</h1>\n<p>I won't point out every instance, but with these things it's often about how many times you <em>access</em> the worksheet. Every time you do something like this: <code>Cells(,).Value</code> you are accessing the worksheet.</p>\n<p>An example of good practice is to bring all values in a the same time e.g:</p>\n<pre><code>Dim v as Variant\nv = Range(&quot;A1:A100&quot;).Value\n</code></pre>\n<p>Which only accesses the worksheet once, and then loop through the resulting variant array, applying logic of some sort:</p>\n<pre><code>For i = 1 to 100\n    v(i,1) = v(i,1) + 1\nNext i\n</code></pre>\n<p>And then return to the worksheet in one go (again accessing the worksheet once):</p>\n<pre><code>Range(&quot;A1:A100&quot;) = v\n</code></pre>\n<hr />\n<h1>2</h1>\n<p>As Tom says, don't use <code>Select</code>. For example:</p>\n<pre><code>Rows(&quot;4:4&quot;).Select\n    With Selection.Font\n</code></pre>\n<p>Could just be</p>\n<pre><code>With Rows(&quot;4:4&quot;).Font  \n</code></pre>\n<hr />\n<h1>3</h1>\n<p>A couple of <code>Application</code> settings might speed things up for you</p>\n<pre><code>'at beginning of code\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual  \n\n'at end of code\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8867916, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155348332491339/picture?type=large", "display_name": "Dominic Legendre", "link": "https://stackoverflow.com/users/8867916/dominic-legendre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 47054906, "answer_count": 1, "score": 0, "last_activity_date": 1509540965, "creation_date": 1509537747, "last_edit_date": 1509540965, "question_id": 47054359, "link": "https://stackoverflow.com/questions/47054359/faster-compare-method-in-excel-using-vba", "title": "Faster compare method in Excel using VBA", "body": "<p>My program imports settings from each file into it's own column, I then loop through all imported columns 1 row at a time to compare data in each row.</p>\n\n<p>If all the cells in each column for the row are equal, I set a results column,row to OK, else it's Check to flag they are not all equal.</p>\n\n<p>Problem is that it takes a long time to populate the results column, is there a faster way? Here is my code:</p>\n\n<pre><code>'Auto compare settings and find -1's\nFor i = 6 To 46\n\n    If Cells(3, i).Value = \"Unit\" Then\n    foundcoltodel = i\n    Exit For\n    End If\n\n\nNext i\n\nIf foundcoltodel &gt; 6 Then\nRange(Cells(1, 6), Cells(1, foundcoltodel - 1)).EntireColumn.Select\nEnd If\n\n'auto compare settings from files imported\n\nDim comparelines() As Integer\nDim LastCol As Integer\n    With ActiveSheet\n        LastCol = .Cells(3, .Columns.Count).End(xlToLeft).Column\n    End With\n\nSum = 0\n\nFor Each col In Selection.Columns\n\nSum = Sum + 1\n\n\nNext\nReDim comparelines(1 To Sum)\nz = 1\nFor Each col In Selection.Columns\ncomparelines(z) = col.Column\nz = z + 1\nNext\n\n'Set row 4 back to black\n\nRows(\"4:4\").Select\n    With Selection.Font\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n    End With\nFor i = 7 To 252\n\n\nIf Cells(i, comparelines(1)).Value &lt;&gt; \"\" Then\n\nFor j = 1 To Sum\n\n'set compare columns to red\n\nCells(4, comparelines(1)).Select\n    With Selection.Font\n        .Color = -16776961\n        .TintAndShade = 0\n    End With\n\nCells(4, comparelines(j)).Select\n    With Selection.Font\n        .Color = -16776961\n        .TintAndShade = 0\n    End With\n\n'check for equal values per row in each selected column\n\n    If Cells(i, comparelines(1)).Value &lt;&gt; Cells(i, comparelines(j)).Value Then\n        allnotequal = True\n        Exit For\n    Else\n        allnotequal = False\n    End If\nNext j\n\n\n\nIf allnotequal = True And Cells(i, 5).Value &lt;&gt; \"\" Then\nCells(i, LastCol - 2).Value = \"Check\"\nCells(i, LastCol - 2).HorizontalAlignment = xlCenter\nCells(i, LastCol - 2).Font.Bold = True\nEnd If\n\nIf allnotequal = False And Cells(i, 5).Value &lt;&gt; \"\" Then\nCells(i, LastCol - 2).Value = \"Ok\"\nCells(i, LastCol - 2).HorizontalAlignment = xlCenter\nCells(i, LastCol - 2).Font.Bold = True\nEnd If\n\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": ["arrays", "excel", "charts", "datapoint", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8837279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4518d00cad720e23666882e5cfb6eae?s=128&d=identicon&r=PG&f=1", "display_name": "MrBaracuda", "link": "https://stackoverflow.com/users/8837279/mrbaracuda"}, "edited": false, "score": 0, "creation_date": 1509543263, "post_id": 47054746, "comment_id": 81059170, "body": "I don&#39;t undestand what you mean by the SERIES formula. However, I thought the advantage of using arrays instead of ranges is that I don&#39;t need the datapoints in a worksheet, which saves on calculation speed. Especially if large numbers of datapoints are used (&gt;100.000)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 13, "user_id": 8837279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4518d00cad720e23666882e5cfb6eae?s=128&d=identicon&r=PG&f=1", "display_name": "MrBaracuda", "link": "https://stackoverflow.com/users/8837279/mrbaracuda"}, "edited": false, "score": 0, "creation_date": 1509545673, "post_id": 47054746, "comment_id": 81060858, "body": "Every series plotted on a chart is done via a SERIES formula - you will see it in the formula bar when you select the series, except when you use large arrays - then you&#39;ll see an error message. If you use arrays, the literal values have to be put into an array constant in the formula. If you try and plot that much data on a chart, I think you will always have performance problems at the very least."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1509538902, "creation_date": 1509538902, "answer_id": 47054746, "question_id": 47053918, "link": "https://stackoverflow.com/questions/47053918/chart-fails-to-display-more-than-16384-data-points/47054746#47054746", "title": "Chart fails to display more than 16384 data points", "body": "<p>I think your issue is to do with the length of the SERIES formula that is used to plot the chart series. If you load the array into a worksheet and use that as the source for the series, it should work fine.</p>\n"}], "owner": {"reputation": 13, "user_id": 8837279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4518d00cad720e23666882e5cfb6eae?s=128&d=identicon&r=PG&f=1", "display_name": "MrBaracuda", "link": "https://stackoverflow.com/users/8837279/mrbaracuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 47054746, "answer_count": 1, "score": 1, "last_activity_date": 1509538902, "creation_date": 1509536191, "last_edit_date": 1531161705, "question_id": 47053918, "link": "https://stackoverflow.com/questions/47053918/chart-fails-to-display-more-than-16384-data-points", "title": "Chart fails to display more than 16384 data points", "body": "<p>I'm creating a chart where the \".Values\" are based on an array called 'ReliabilityNumber', which comes from another module. Everything works fine in getting the right datapoints. But whenever the number of elements ('timesteps' in chart) in the array is more than 16384, the datapoints above this number are not displayed in the chart.</p>\n\n<p>Furthermore, if the number of elements exceeds 65536, the chart isn't displayed anymore.</p>\n\n<p>My take is that it has something to do with maximum number of columns (which is 16384 for Excel 2007 and newer) and max number of rows (which is 65536 in excel version 2003 and older). But I can't figure out what it is. My code is below (I use Excel 2010 at work and 2016 at home, the problem is with 2010. Haven't controlled this problem for 2016 yet):</p>\n\n<pre><code>Dim ReliabilityChart As Object\nDim ReliabilitySeries As Series\n\nSet ReliabilityChart = ActiveSheet.ChartObjects.Add(Left:=300, Width:=500, Top:=10, Height:=300)\n    With ReliabilityChart\n    .Chart.Type = xlLine\n    .Left = 600\n    .Width = 800\n    .Top = 50\n    .Height = 300\n    .Name = \"ReliabilityChart1\"\n\n    Set ReliabilitySeries = .Chart.SeriesCollection.NewSeries\n        With ReliabilitySeries\n            .Values = ReliabilityNumber\n            .Name = \"Reliability on timestep #\"\n        End With\n\nEnd With\n\nActiveSheet.ChartObjects(\"ReliabilityChart1\").Activate\nWith ActiveChart\n    .ChartType = xlLine\n    .ChartTitle.Text = \"Reliability over time\"\n    .Axes(xlCategory).TickMarkSpacing = 1600\n    .Axes(xlCategory).TickLabelSpacing = 1600\n    .Axes(xlValue).MaximumScale = 1\n    .Axes(xlValue).TickLabels.NumberFormat = \"0%\"\n    .Axes(xlCategory).HasTitle = True\n    .Axes(xlCategory).AxisTitle.Text = \"Timestep (#)\"\n    .Axes(xlValue).HasTitle = True\n    .Axes(xlValue).AxisTitle.Text = \"Reliability (%)\"\nEnd With\n\nSheets(1).Range(\"E10\").Select\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8867722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNrIoCl5qlg/AAAAAAAAAAI/AAAAAAAALck/hh0OTkFQ1AE/photo.jpg?sz=128", "display_name": "Michael Whitaker", "link": "https://stackoverflow.com/users/8867722/michael-whitaker"}, "edited": false, "score": 0, "creation_date": 1509548259, "post_id": 47053904, "comment_id": 81062633, "body": "Thank you very much for the help. I implemented what you suggested and it worked.  One thing though, I don&#39;t see the need for the With loop? What&#39;s the point of that?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23, "user_id": 8867722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNrIoCl5qlg/AAAAAAAAAAI/AAAAAAAALck/hh0OTkFQ1AE/photo.jpg?sz=128", "display_name": "Michael Whitaker", "link": "https://stackoverflow.com/users/8867722/michael-whitaker"}, "edited": false, "score": 0, "creation_date": 1509548349, "post_id": 47053904, "comment_id": 81062688, "body": "@MichaelWhitaker  just my style of coding , you can get rid of it"}, {"owner": {"reputation": 23, "user_id": 8867722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNrIoCl5qlg/AAAAAAAAAAI/AAAAAAAALck/hh0OTkFQ1AE/photo.jpg?sz=128", "display_name": "Michael Whitaker", "link": "https://stackoverflow.com/users/8867722/michael-whitaker"}, "edited": false, "score": 0, "creation_date": 1509554387, "post_id": 47053904, "comment_id": 81066652, "body": "Fair enough indeed. Thanks very much for the help Re this.   Do you have any idea why this is necessary though?  For example, why should:      ActiveChart.FullSeriesCollection(i).Name = Worksheets(&quot;GSI with DSPV Data&quot;).Cells(nameRow, nameCol)   not work? I remember being told that this type of command does not select the Header, and thus doesn&#39;t work. I am not totally sure what this means however?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1509536125, "creation_date": 1509536125, "answer_id": 47053904, "question_id": 47053823, "link": "https://stackoverflow.com/questions/47053823/excel-vba-activechart-fullseriescollection-name-not-linking-to-cell/47053904#47053904", "title": "Excel-VBA ActiveChart.FullSeriesCollection.Name not linking to cell", "body": "<p>How about trying it in the method below:</p>\n\n<pre><code>Dim nameRow As Long, NameCol As String\nDim SerTitleNameRng As Range\n\nNameCol = \"BUX\"\nnameRow = 4\n\nWith Worksheets(\"GSI with DSPV Data\")\n    Set SerTitleNameRng = .Cells(nameRow, NameCol)\nEnd With\n\nActiveChart.FullSeriesCollection(1).Name = \"=\" &amp; SerTitleNameRng.Address(True, True, xlA1, xlExternal)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8867722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNrIoCl5qlg/AAAAAAAAAAI/AAAAAAAALck/hh0OTkFQ1AE/photo.jpg?sz=128", "display_name": "Michael Whitaker", "link": "https://stackoverflow.com/users/8867722/michael-whitaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4668, "favorite_count": 0, "accepted_answer_id": 47053904, "answer_count": 1, "score": 0, "last_activity_date": 1525066687, "creation_date": 1509535828, "last_edit_date": 1525066687, "question_id": 47053823, "link": "https://stackoverflow.com/questions/47053823/excel-vba-activechart-fullseriescollection-name-not-linking-to-cell", "title": "Excel-VBA ActiveChart.FullSeriesCollection.Name not linking to cell", "body": "<p>Below are two examples for creating a name of a new series:</p>\n\n<pre><code>ActiveChart.FullSeriesCollection(1).Name = \"='GSI with DSPV Data'!$BUX$4\" \n\nActiveChart.FullSeriesCollection(1).Name = Worksheets(\"GSI with DSPV Data\").Cells(nameRow, nameCol)\n</code></pre>\n\n<p><code>nameRow</code> and <code>nameCol</code> can be set to the same values as column: BUX and row: 4 in this instance. In both cases, the legend correctly displays the new series name. However, the second example doesn't link the cell to the series name gui edit box. The series name box remains blank.</p>\n\n<p>The first example is not useful to me as I need to represent the cell using variables for the column and row, as this is within an iterative For loop.</p>\n\n<p>Please see below for my full code:</p>\n\n<pre><code>Sub ExtendPlot()\n\nDim nameRow As Integer\nDim nameCol As Integer\nDim maxPlotRow As Integer\nDim xPlotCol As Integer\nDim minPlotRow As Integer\nDim yPlotCol As Integer\nDim xValues As Range\nDim yValues As Range\n\nnameRow = 4 'the series name is always on the same row\nminPlotRow = 2 'the minimum plotted row is always 2\nmaxPlotRow = 400 'the maximum plotted row is always 400\nnameCol = Sheets(\"GSI with DSPV Data\").Columns(\"BUX\").Column 'specify the column of the series name location and turn this into an integer\nxPlotCol = Sheets(\"GSI with DSPV Data\").Columns(\"BUY\").Column 'specify the column of the series x values location and turn this into an integer\nyPlotCol = Sheets(\"GSI with DSPV Data\").Columns(\"BUZ\").Column 'specify the column of the series y values location and turn this into an integer\nSet xValues = Range(Sheets(\"GSI with DSPV Data\").Cells(minPlotRow, xPlotCol), Sheets(\"GSI with DSPV Data\").Cells(maxPlotRow, xPlotCol)) 'set the range of the x axis given the above values\nSet yValues = Range(Sheets(\"GSI with DSPV Data\").Cells(minPlotRow, yPlotCol), Sheets(\"GSI with DSPV Data\").Cells(maxPlotRow, yPlotCol)) 'set the range of the y axis given the above values\nActiveChart.SeriesCollection.NewSeries 'create a new series on the current graph\nActiveChart.FullSeriesCollection(1).Name = \"='GSI with DSPV Data'!$BUX$4\" 'create the name for the new series by linking to the reference cell\nActiveChart.FullSeriesCollection(1).xValues = xValues 'create the x axis by linking to the x axis range\nActiveChart.FullSeriesCollection(1).Values = yValues 'create the y axis by linking to the y axis range\n\nFor i = 2 To 30 'start a For loop for the next coming series\nnameCol = nameCol + 8 'the name of the next series is always located 8 columns later than the first\nxPlotCol = xPlotCol + 8 'the x axis values of the next series are always located 8 columns later than the first\nyPlotCol = yPlotCol + 8 'the y axis values of the next series are always located 8 columns later than the first\nSet xValues = Range(Sheets(\"GSI with DSPV Data\").Cells(minPlotRow, xPlotCol), Sheets(\"GSI with DSPV Data\").Cells(maxPlotRow, xPlotCol)) 'set the range of the x axis given the above values\nSet yValues = Range(Sheets(\"GSI with DSPV Data\").Cells(minPlotRow, yPlotCol), Sheets(\"GSI with DSPV Data\").Cells(maxPlotRow, yPlotCol)) 'set the range of the y axis given the above values\n\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(i).Name = Worksheets(\"GSI with DSPV Data\").Cells(nameRow, nameCol) 'create the name for the new series by linking to the reference cell\nActiveChart.FullSeriesCollection(i).xValues = xValues 'create the x axis by linking to the x axis range\nActiveChart.FullSeriesCollection(i).Values = yValues 'create the y axis by linking to the y axis range\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have used separate ranges for the x axis and y axis on purpose, such that people with zero VBA experience can picture exactly what's going on here. It is not that computational exhaustive (I don't think?) to do this. It just doesn't look very neat.</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509536045, "post_id": 47053599, "comment_id": 81054570, "body": "Edit your question to show your VBA code."}, {"owner": {"reputation": 308, "user_id": 1263495, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a5816661b25c32d396194f1171766c1?s=128&d=identicon&r=PG", "display_name": "Genki", "link": "https://stackoverflow.com/users/1263495/genki"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509876096, "post_id": 47053599, "comment_id": 81190248, "body": "braX&#39;s answer is the easiest, most straight-forward and gives exactly the desired result, so I&#39;ve selected it.  Further troubleshooting on my issue reveals that Excel was, in fact, giving the correct result -- I was comparing the output to the wrong row.  Face palm!"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1509535428, "creation_date": 1509535428, "answer_id": 47053717, "question_id": 47053599, "link": "https://stackoverflow.com/questions/47053599/excel-vba-extract-date-from-csv-txt/47053717#47053717", "title": "Excel VBA extract date from CSV txt", "body": "<p>You can use the split function, using the comma as a delimiter like this:</p>\n\n<pre><code>sResult = Split(\"4,'31 January 2017','Funds Received/Credits',56,,401.45, \", \",\")(1)\n</code></pre>\n\n<p>If you dont want the single quotes, then add the replace function like this:</p>\n\n<pre><code>sResult = Replace(Split(\"4,'31 January 2017','Funds Received/Credits',56,,401.45, \", \",\")(1), \"'\", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "is_accepted": false, "score": 0, "last_activity_date": 1509536680, "creation_date": 1509536680, "answer_id": 47054062, "question_id": 47053599, "link": "https://stackoverflow.com/questions/47053599/excel-vba-extract-date-from-csv-txt/47054062#47054062", "title": "Excel VBA extract date from CSV txt", "body": "<p>If you include the \"Microsoft VBScript Regular Expressions 5.5\" Reference, you can set up a pattern that will extract the whole date if it is found. For example:</p>\n\n<pre><code>Dim tstring As String\nDim myregexp As RegExp\nDim StrMatch As Object\ntstring = 'Line from the CSV, or entire CSV as one string\nSet myregexp = New RegExp\nmyregexp.Pattern = \"\\d{1,2} [A-Z]{3,9} \\d{4}\"\nSet StrMatch = myregexp.Execute(tstring)\n</code></pre>\n\n<p>You get the benefit from this method that all the dates in the CSV will be pulled out at once, much faster than using a split line by line. Additionally, the dates may be accessed by using </p>\n\n<pre><code>DateStr = StrMatch.Item(index)\n</code></pre>\n\n<p>for the whole string line, or substrings can be set up to get specific parts of the string(Such as month, day, year).</p>\n\n<pre><code>myregexp.Pattern = \"\\(d{1,2}) ([A-Z]{3,9}) (\\d{4})\"\nSet StrMatch = myregexp.Execute(tstring)\nDateStr = StrMatch.Item(index1).SubMatches(index2)\n</code></pre>\n\n<p>It is a very powerful tool, with a simple set of symbols for development of patterns. I highly suggest you familiarize yourself with it for manipulation of large strings. </p>\n"}], "owner": {"reputation": 308, "user_id": 1263495, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a5816661b25c32d396194f1171766c1?s=128&d=identicon&r=PG", "display_name": "Genki", "link": "https://stackoverflow.com/users/1263495/genki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 47053717, "answer_count": 2, "score": -2, "last_activity_date": 1509536680, "creation_date": 1509535019, "last_edit_date": 1509535829, "question_id": 47053599, "link": "https://stackoverflow.com/questions/47053599/excel-vba-extract-date-from-csv-txt", "title": "Excel VBA extract date from CSV txt", "body": "<p>I'm having trouble extracting this text, exactly as it appears, from a CSV. There are similar questions posted on SO but they don't match my requirements:</p>\n\n<p>I want to extract \"31 January 2017\" from this row:</p>\n\n<pre><code>4,'31 January 2017','Funds Received/Credits',56,,401.45,\n</code></pre>\n\n<p>Currently, VBA considers it \"31 Jan\" without the year. I've tried applying .NumberFormat to the cell (general, text, date).</p>\n\n<p>SOLUTION REQUIREMENTS:</p>\n\n<ol>\n<li>No user action required -- Interact with the file only using VBA (not using File > Import > Wizard)</li>\n<li>Compatible with VBA Excel 2003</li>\n<li>Extract the full text regardless of Excel or operating system date settings</li>\n</ol>\n\n<p>Thank you for your ideas</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1509535486, "post_id": 47053142, "comment_id": 81054295, "body": "D,E; F,H; I,J; K,L - where is G?"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "edited": false, "score": 0, "creation_date": 1509533753, "post_id": 47053255, "comment_id": 81053350, "body": "(m*2 + 3) and (m*2 + 4) is the calculation of the row... +3 +4 is the column-offset. *2 because every iteration uses 2 columns..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1509534467, "post_id": 47053255, "comment_id": 81053730, "body": "Should that be +2/+3 - column D is 4?"}], "tags": [], "owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1509533676, "creation_date": 1509533676, "answer_id": 47053255, "question_id": 47053142, "link": "https://stackoverflow.com/questions/47053142/insert-value-to-next-cell-using-vba/47053255#47053255", "title": "insert value to next cell using vba", "body": "<p>Instead of:</p>\n\n<pre><code>Range(\"D\" &amp; i).Value\nRange(\"E\" &amp; i).Value\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>Cells(i, (m*2 + 3)).Value\nCells(i, (m*2 + 4)).Value\n</code></pre>\n\n<p>Or use another counter... As you like... Hope that helps.</p>\n"}], "owner": {"reputation": 474, "user_id": 3770962, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8dd6b665c77e8448bb73e648dfabd592?s=128&d=identicon&r=PG&f=1", "display_name": "Narasappa", "link": "https://stackoverflow.com/users/3770962/narasappa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 47053255, "answer_count": 1, "score": 0, "last_activity_date": 1509535338, "creation_date": 1509533333, "last_edit_date": 1531164843, "question_id": 47053142, "link": "https://stackoverflow.com/questions/47053142/insert-value-to-next-cell-using-vba", "title": "insert value to next cell using vba", "body": "<p>I am trying to fetch data from a webpage. My VBA code is as below   </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>m = 0\nFor Each htmlele1 In doc.getElementsByClassName(\"resultsbranch\")\n    m = m + 1\n    companyname = htmlele1.getElementsByTagName(\"h2\")\n    Address = htmlele1.getElementsByTagName(\"span\")\n    If Address.getAttribute(\"itemprop\") = \"myaddress\" Then\n        Range(\"D\" &amp; i).Value = companyname.innerText + \",\" + Address.innerText\n    End If\n    Teliphone = htmlele1.getElementsByClassName(\"teldata\")\n    If Teliphone.getAttribute(\"itemprop\") = \"tel\" Then\n        Range(\"E\" &amp; i).Value = Teliphone.innerText\n    End If\n    'i = i + 1\n    'Debug.Print i\nNext\n</code></pre>\n\n<p>On the first iteration, values are get inserted to columns <strong>D,E</strong><br>\non second iteration I want to insert data To <strong>F,H</strong> .<br>\nOn 3 rd iteration <strong>I,J</strong><br>\nOn 4th iteration <strong>K,L</strong>\nSo on up to nth iteration  </p>\n\n<p>How can i do this ?</p>\n"}, {"tags": ["vba", "database-connection"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509538624, "post_id": 47052940, "comment_id": 81056109, "body": "The thing should be robust enough, but formally the semi-colon <code>;</code> is a <i>separator</i>, not a terminator. So <code>Pwd=pwd;&quot;</code> is wrong and the last semi-colon should be removed."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509538752, "post_id": 47052940, "comment_id": 81056184, "body": "What is the value of <code>sDBFullName</code>? Are you sure it does not contain reserved characters?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509539656, "post_id": 47052940, "comment_id": 81056734, "body": "Could there be a 32-bit (MicroStation) versus 64-bit (Access 12.0 driver) problem?"}, {"owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509546434, "post_id": 47052940, "comment_id": 81061382, "body": "Value of sDBfullname is correct. I did check but its just pathed to a server location, doesnt include any special characters or anything. The Access driver is 32 bit, ill check MicroStation tomorrow but im pretty sure its 32 bit aswell. Office is 32 bit."}, {"owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1509692520, "post_id": 47052940, "comment_id": 81129458, "body": "I have checked and everything is 32bit except Windows"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10704558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2ff6a48e3a983de83f45665ad44a74?s=128&d=identicon&r=PG&f=1", "display_name": "VBhatia", "link": "https://stackoverflow.com/users/10704558/vbhatia"}, "is_accepted": false, "score": 0, "last_activity_date": 1562744608, "creation_date": 1562744608, "answer_id": 56965749, "question_id": 47052940, "link": "https://stackoverflow.com/questions/47052940/problems-connecting-vba-to-access-database/56965749#56965749", "title": "Problems connecting VBA to Access Database", "body": "<p>I have been struggling with exactly same error in Microstation after IT upgraded Microsoft Office to 2016-32bit, last week.  I have finally been able to resolve it by installing Microsoft Sharepoint Designer 2013 for the users.  It makes the Microsoft.ACE.oledb.15.0 talk to ACCDB files again from Microstation SS-3/4/10 32Bit.</p>\n"}], "owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562744608, "creation_date": 1509532713, "last_edit_date": 1509534969, "question_id": 47052940, "link": "https://stackoverflow.com/questions/47052940/problems-connecting-vba-to-access-database", "title": "Problems connecting VBA to Access Database", "body": "<p>I am using a VBA within a drafting program called MicroStation. The program just connects to an Access Database file to read data and return to MicroStation. The connection i have used for a while i got from connectionstrings.com was working but has since stopped. I can;t figure out what has changed apart from possible security settings, but all of the posts i have read do not seem to indicate this.</p>\n\n<p>This is the previous connection string i used. If i google the issue, plus search StackOverflow 90% of the posts contain this connection string with no issues.</p>\n\n<pre><code>Set conn = New ADODB.Connection\nconn.ConnectionString = \"Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=\" &amp; sDBFullName &amp; \";Uid=Admin;Pwd=;\"\n    \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=\" &amp; sDBFullName &amp; \";\" &amp; _\n    \"Jet OLEDB:Database Password=\" &amp; cPassword &amp; \";Persist Security Info=False\"\n</code></pre>\n\n<p>As the company had upgraded to Office 2016, i thought it might have been the connection string, so i found and used this updated one.</p>\n\n<pre><code>Set conn = CreateObject(\"ADODB.Connection\")\nconn.ConnectionString = \"Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=\" &amp; sDBFullName &amp; \";Uid=Admin;Pwd=pwd;\"\n</code></pre>\n\n<p>When using the top connection string, MicroStation will simply crash with no error messages. If i use the second, i recieve the error message \"Catastrophic Failure\". When debugging i can narrow it down to the conn.open</p>\n\n<p>Both of these connection strings work on multiple PC's, but wont work within the work environment.</p>\n\n<p>So my question is. What could be causing these issues? What should i be on the lookout for? I am struggling to figure out why this is happening.\nThe user is able to read &amp; write to the database using access, so i dont think its a permissions problem, it has been working fine in the past (but i cant get a straight answer as to what has changed)\nI also went to the step of creating a simple VB.NET program to connect to the database and had no issues. Which leads me to rule out a corrupt database connector, or anything with Access. I am happy to post the whole module if it will help track down the issue.</p>\n\n<p>Thanks in advance, i'm really confused with this issue!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1509532454, "post_id": 47052555, "comment_id": 81052555, "body": "(Welcome to SO!)(Try &quot;commenting out&quot; parts of the code.)(Check which statements have an <code>END</code> and what you are using thereof.)"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1509532952, "last_edit_date": 1509532952, "creation_date": 1509531939, "answer_id": 47052699, "question_id": 47052555, "link": "https://stackoverflow.com/questions/47052555/excel-vba-error-compile-error-next-without-for/47052699#47052699", "title": "Excel VBA Error: Compile Error Next without For", "body": "<p>You're missing 2 <code>End If</code> 's </p>\n\n<p>Sometimes when you're missing an </p>\n\n<ul>\n<li><p>End If </p></li>\n<li><p>End WIth </p></li>\n<li><p>End Loop </p></li>\n<li><p><em>etc</em></p></li>\n</ul>\n\n<p>Inside a <code>For..Next</code> Loop, VBA gets confused over which one is exactly the problem and describes the error incorrectly.</p>\n\n<p>All of your <code>If</code>'s and <code>ElseIf'</code>s need to have and <code>End If</code>.  Personally, I avoid using <code>ElseIf</code>'s since they make the code a little harder to follow, compared to using nice neat <code>If..Then..Else..End If</code> blocks (nested as needed).</p>\n\n<hr>\n\n<h2>Your Code:</h2>\n\n<p>I replaced the <code>If-Else-Elseif-Elseif</code> stuff with a second <code>Select..Case</code> statement:</p>\n\n<pre><code>Sub W09T1()\n\n    Dim i As Integer\n    Dim FinalRow As Integer\n    Dim thisCategory As String, thisProduct As String\n    Dim thisQty As Integer\n    Dim Sale As Boolean\n    Dim discount As Single\n\n    With Sheets(\"sheet1\")\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    Range(\"D1\").Value = \"Discount\"\n\n    For i = 2 To FinalRow\n        thisCategory = Cells(i, 1).Value\n        thisProduct = Cells(i, 2).Value\n        thisQty = Cells(i, 3).Value\n\n        'insert select case to determine if the product\n        'is on sale here\n\n        'Use If-Then-Else and/or Select Case to\n        'determine the discount based on product\n        'category and discount rules\n        If Sale Then\n            discount = 0.25\n        Else\n            Select Case thisCategory\n                Case \"Fruit\"\n                    Select Case thisQty\n                        Case Is &lt; 5\n                            discount = 0\n                        Case 5 To 20\n                            discount = 0.1\n                        Case Is &gt; 20\n                            discount = 0.15\n                    End Select\n                Case \"Herbs\"\n                    'insert select case to determine\n                    'discount of Herbs here\n                Case \"Vegetables\"\n                    'insert If-Then-Else and/or Select\n                    'Case to determine discount of\n                    'Vegetables\n                    'insert discount to be displayed in column D\n            Case Else\n                'you could optionally add code here that will run\n                ' if \"thisCategory\" isn't Fruit,Herbs or Vegetables\n            End Select\n        End If\n        If Sale Then\n            Cells(i, 1).Resize(1, 4).Interior.Color = vbYellow\n        End If\n    Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8867408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0c2db272136f38f31374f778993717?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Wong", "link": "https://stackoverflow.com/users/8867408/brian-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509535289, "creation_date": 1509531447, "last_edit_date": 1509535289, "question_id": 47052555, "link": "https://stackoverflow.com/questions/47052555/excel-vba-error-compile-error-next-without-for", "title": "Excel VBA Error: Compile Error Next without For", "body": "<p>Below is my code.  When I run it, it displays:</p>\n\n<blockquote>\n  <p>Compile Error Next without For. </p>\n</blockquote>\n\n<p>Please help!</p>\n\n<pre><code>Sub W09T1()\nDim i As Integer\nDim FinalRow As Integer\nDim thisCategory As String, thisProduct As String\nDim thisQty As Integer\nDim Sale As Boolean\nDim discount As Single\n\nWith Sheets(\"sheet1\")\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nRange(\"D1\").Value = \"Discount\"\n\nFor i = 2 To FinalRow\n    thisCategory = Cells(i, 1).Value\n    thisProduct = Cells(i, 2).Value\n    thisQty = Cells(i, 3).Value\n\n    'insert select case to determine if the product\n    'is on sale here\n\n\n    'Use If-Then-Else and/or Select Case to\n    'determine the discount based on product\n    'category and discount rules\n    If Sale Then\n        discount = 0.25\n    Else\n       If thisCategory = \"Fruit\" Then\n            Select Case thisQty\n                Case Is &lt; 5\n                    discount = 0\n                Case 5 To 20\n                    discount = 0.1\n                Case Is &gt; 20\n                    discount = 0.15\n            End Select\n        ElseIf thisCategory = \"Herbs\" Then\n            'insert select case to determine\n            'discount of Herbs here\n        ElseIf thisCategory = \"Vegetables\" Then\n            'insert If-Then-Else and/or Select\n            'Case to determine discount of\n            'Vegetables\n\n    'insert discount to be displayed in column D\n\n\n    If Sale Then\n        Cells(i, 1).Resize(1, 4).Interior.Color = vbYellow\n    End If\nNext i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vb.net", "vba"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 1793853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/f6hGW.jpg?s=128&g=1", "display_name": "Deedz", "link": "https://stackoverflow.com/users/1793853/deedz"}, "edited": false, "score": 0, "creation_date": 1509533066, "post_id": 47052851, "comment_id": 81052922, "body": "Thank you so much @enigmativity, you are legend sir!"}], "tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": true, "score": 4, "last_activity_date": 1509532447, "creation_date": 1509532447, "answer_id": 47052851, "question_id": 47052305, "link": "https://stackoverflow.com/questions/47052305/visual-basic-replace-certain-characters-in-email-address-for-privacy/47052851#47052851", "title": "Visual Basic Replace certain characters in email address for privacy", "body": "<p>Perhaps try this instead:</p>\n\n<pre><code>Dim email = \"test@test.co.za\"\n\nDim obsfucated = _\n    String.Join(\"@\", email.Split(\"@\"c).Select(Function(x, n) _\n        If(n = 0, _\n            x.Substring(0, System.Math.Min(2, x.Length)).PadRight(x.Length, \"*\"c), _\n            x.Substring(x.Length - 2, 2).PadLeft(x.Length, \"*\"c))))\n\nConsole.WriteLine(obsfucated)\n</code></pre>\n\n<p>It gives: <code>te**@********za</code></p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "is_accepted": false, "score": 0, "last_activity_date": 1509538532, "creation_date": 1509538532, "answer_id": 47054605, "question_id": 47052305, "link": "https://stackoverflow.com/questions/47052305/visual-basic-replace-certain-characters-in-email-address-for-privacy/47054605#47054605", "title": "Visual Basic Replace certain characters in email address for privacy", "body": "<p>Set up a pattern with a nested substring in the current email user substring. Apply the **** filter to only the nested part of the substring.  </p>\n\n<pre><code>Dim emailRegEx As New Regex(\"(\\S{1,2}(\\S*))@([^\\.\\s]+)(?:\\.([^\\.\\s]+))+\")\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/1313934/how-are-nested-capturing-groups-numbered-in-regular-expressions\">Here</a> for more info on nested Substrings in Regex</p>\n"}], "owner": {"reputation": 117, "user_id": 1793853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/f6hGW.jpg?s=128&g=1", "display_name": "Deedz", "link": "https://stackoverflow.com/users/1793853/deedz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47052851, "answer_count": 2, "score": 0, "last_activity_date": 1509538532, "creation_date": 1509530519, "question_id": 47052305, "link": "https://stackoverflow.com/questions/47052305/visual-basic-replace-certain-characters-in-email-address-for-privacy", "title": "Visual Basic Replace certain characters in email address for privacy", "body": "<p>I have the following code that will extract an email address from a text string, which will get replaced by text inside a database field.</p>\n\n<p>The string will contain a single email address. I have already split the email address as follows:</p>\n\n<ol>\n<li>test@test.co.za - Full email address</li>\n<li>test - email user</li>\n<li>test.co.za - Domain</li>\n</ol>\n\n<p>I have included code that can replace all characters as *************** (Full Email) or the individual parts.</p>\n\n<p>It would be easy to combine the text again when I have done what I needed.</p>\n\n<p>The result I am trying to get:</p>\n\n<p>te**@********za </p>\n\n<p>Was thinking about hiding everything in the first part, except first 2 characters and in the last part, everything except last 2 characters.</p>\n\n<pre><code>Dim newText As string = \"\"\n\nDim senText As String = \"This is a long string that we will try test@test.co.za to extract the email address from, it might exist anywhere in this string.\"\nDim emailRegEx As New Regex(\"(\\S+)@([^\\.\\s]+)(?:\\.([^\\.\\s]+))+\")\nDim m As Match = emailRegEx.Match(senText)\nIf m.Success Then\n    newText = m.ToString\nEnd If\n\nDim mystr As String = newText\nDim cut_at As String = \"@\"\nDim x As Integer = InStr(mystr, cut_at)\n\nDim string_before As String = mystr.Substring(0, x - 1)\nDim string_after As String = mystr.Substring(x + cut_at.Length - 1)\n\nDim myString As String = New String(\"*\"c, newText.Length)\n\nDim PrivateMail As String = \"\"\n\nresponse.write(newText)\nresponse.write(myString)\nresponse.write(string_before)\nresponse.write(string_after)\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509535175, "post_id": 47052239, "comment_id": 81054103, "body": "At least you have a functioning and non functioning install to compare. I would start by searching the registry for the progid <code>ADODB.Stream</code> on both machines and comparing it. The ProgID in the registry in turn points at a classid which in turn points at a DLL (see here <a href=\"https://www.symantec.com/connect/articles/basic-understanding-com-and-related-registry\" rel=\"nofollow noreferrer\">symantec.com/connect/articles/&hellip;</a>). So first compare the registry setup then compare the DLL paths then the DLL versions. Then make sure the users have access to the DLL&#39;s"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509535323, "post_id": 47052239, "comment_id": 81054196, "body": "Also FYI, <code>CreateObject</code> is called &quot;late binding&quot;, whereas ticking the reference in that dialog box is called &quot;early binding&quot;. The other thing you could do is, again, comparing failing and functioning machines, try early binding &quot;Microsoft ActiveX Data Objects&quot; (thats the ADODB part) and check that it has a class of &#39;stream&#39; with the class viewer (F2)."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509546837, "post_id": 47052239, "comment_id": 81061662, "body": "Hi Nick. Thank you for taking the time to respond. I believe the pathways are the same. I think after further reading there is now a patch with Microsoft <code>&quot;ADODB.Stream&quot;</code>is now a NO NO after the latest global cyber attach which did seriously impact my company. is there a coding alternative to <code>&quot;ADODB.Stream&quot;</code> in VBA?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509577140, "post_id": 47052239, "comment_id": 81078129, "body": "It depends what your code is doing. I&#39;ve never used <code>stream</code> before. Is it writing binary objects into a database? I can&#39;t tell from your code."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509614966, "post_id": 47052239, "comment_id": 81091509, "body": "Hi Nick: Yes it is writing binary objects into a database. Is there an alternative code piece that you know of to create this process?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509615111, "post_id": 47052239, "comment_id": 81091584, "body": "What data type is the target column?"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509616571, "post_id": 47052239, "comment_id": 81092578, "body": "its all text format."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509622628, "post_id": 47052239, "comment_id": 81096707, "body": "I&#39;m not very familiar with the <code>stream</code> object but that code fragment you posted doesn&#39;t do anything as far as I can tell so I&#39;m not sure what we would need to convert. Can you look at the column that the objects are being saved into and tell me the datatype? It&#39;ll be something like <code>image</code> or <code>blob</code> or <code>varbinary</code>. Note that the code fragment you posted doesn&#39;t mention a table or a column so it&#39;s definitely incomplete."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509626165, "post_id": 47052239, "comment_id": 81099180, "body": "I&#39;m sure there&#39;s another way to do it but my google fu is failing me, and you don&#39;t have enough code there to convert"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509637724, "post_id": 47052239, "comment_id": 81107675, "body": "Hi Nick. I have added to code in its entirety. I avoided this previously as it is long. What this code does in a nut shell is it looks at an Excel sheet with data, then takes that data puts it into Notepad then deliminates with pipes and tehn puts it into a kind of virtual folder where it sits for a while and is pick up and sent for consumption to another database. Again thank you for the assistance it is greatly appreciated"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7751, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509637444, "creation_date": 1509530317, "last_edit_date": 1509637444, "question_id": 47052239, "link": "https://stackoverflow.com/questions/47052239/run-time-error-429-activex-component-cant-create-object", "title": "Run-Time error &#39;429&#39;: ActiveX Component Can&#39;t Create Object", "body": "<p>I hope you can help. I understand that this question has been asked a lot and I hope I don't get voted down. But I have tried several ways to solve this issue using online resources but I am now out of resolution options and need assistance. </p>\n\n<p>As stated in the heading I am facing </p>\n\n<blockquote>\n  <p>Run_Time error '429': ActiveX Component Cant't Create Object</p>\n</blockquote>\n\n<p>What I can tell you is this: That I have 64bit version installed and the Macro in question works fine for me and my team based in Dublin, but other European offices who use 64 bit Version get the 429 error. </p>\n\n<p>See <strong>Pic 1</strong> System Info. The 64bit MUST stay as installing 32Bit is not an option </p>\n\n<p>I have tried all options available here <a href=\"http://Solve%20429%20issues\" rel=\"nofollow noreferrer\">http://www.fixyourerrors.com/how-can-i-get-rid-of-runtime-error-429/</a></p>\n\n<p>But no success, from the instructions in the above link. </p>\n\n<p>I have checked that all the appropriate Active X controls are ticked in the Tools, Reference, area of VBA developer area/library in Excel see Pic 2</p>\n\n<p>But again no affect :-( </p>\n\n<p>Pic 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/A0VGl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A0VGl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 2</p>\n\n<p><a href=\"https://i.stack.imgur.com/UCebV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UCebV.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Code that is error is happening on is below </p>\n\n<pre><code>' *****************************************************************************\n' Management of File to write in UT8 format\n' *****************************************************************************\n\n' This function open the file indicated to be able to write inside\nPrivate Sub OUTFILE_OPEN(filename As String)\n    Set WriteObject = CreateObject(\"ADODB.Stream\")\n    WriteObject.Type = 2 'Specify stream type - we want To save text/string data.\n    WriteObject.Charset = \"utf-8\" 'Specify charset For the source text data.\n    WriteObject.Open 'Open the stream And write binary data To the object\n    OUTFilename = filename\nEnd Sub\n</code></pre>\n\n<p>And the line on that the 429 Error is happening on is </p>\n\n<pre><code>Set WriteObject = CreateObject(\"ADODB.Stream\")\n</code></pre>\n\n<p>As stated I have tried to solve the issue but I am now at a dead end for a resolution. Can my code be amended or is there some trick I can do to solve the issue? </p>\n\n<p>As always any and all help is greatly appreciated. </p>\n\n<p>COMPLETE CODE </p>\n\n<pre><code>'Variables for Deduplication\nDim WB_Cust As Workbook\n'File Variables\nDim DTOV_Directory As String\nDim DTOV_File As String\nDim ITOV_Directory As String\nDim ITOV_file As String\n\nConst DELIMITER As String = \"|\"\n\n' Variables for writing text into file\nDim WriteObject As Object\nDim OUTFilename As String\n\nDim MyWkBook As Workbook\nDim MyWkSheet As Worksheet\n\nDim OutputFile As String ' Output flat file name\nDim SysCode As String ' Variable for text string of system code to be filled into information system code column\nDim strFilenameOut As String ' Variable for name of file being processed. It is used for SysCode and OutputFile determination.\nDim CustAddressSave As Range\n\n\n'Processing of one file. This procedure is called when only one of file types are selected\nPublic Sub Process_template(Directory As String, File As String, FileFlag As String)\n    Application.ScreenUpdating = False 'Turns off switching of windows\n    If FileFlag = \"D\" Then 'Variables setup for DTOV\n        DTOV_Directory = Directory\n        DTOV_File = File\n    ElseIf FileFlag = \"I\" Then 'Variables setup for ITOV\n        ITOV_Directory = Directory\n        ITOV_file = File\n    Else\n        MsgBox \"Unhandled Exception - Unknown files sent\"\n        Exit Sub\n    End If\n    Call Process(1, FileFlag)\n    Application.ScreenUpdating = True 'Turns On switching of windows\nEnd Sub\n\n'Processing of two file. This procedure is called when both file types are to be processed\nPublic Sub Process_Templates(DTOV_Dir As String, DTOV_Fil As String, ITOV_Dir As String, ITOV_Fil As String)\n\n    Application.ScreenUpdating = False 'Turns off switching of windows\n    DTOV_Directory = DTOV_Dir\n    DTOV_File = DTOV_Fil\n    ITOV_Directory = ITOV_Dir\n    ITOV_file = ITOV_Fil\n    Call Process(2, \"B\")\n    Application.ScreenUpdating = True 'Turns on switching of windows\nEnd Sub\n\n\n' *****************************************************************************\n' Management of File to write in UT8 format\n' *****************************************************************************\n\n' This function open the file indicated to be able to write inside\nPrivate Sub OUTFILE_OPEN(filename As String)\n    Set WriteObject = CreateObject(\"ADODB.Stream\")\n    WriteObject.Type = 2 'Specify stream type - we want To save text/string data.\n    WriteObject.Charset = \"utf-8\" 'Specify charset For the source text data.\n    WriteObject.Open 'Open the stream And write binary data To the object\n    OUTFilename = filename\nEnd Sub\n\n' This function closes the file\nPrivate Sub OUTFILE_CLOSE()\n    WriteObject.SaveToFile OUTFilename, 2\n    WriteObject.Close ' Close the file\nEnd Sub\n\n' Write a string in the outfile\nPrivate Sub OUTFILE_WRITELINE(txt As String)\n    WriteObject.WriteText txt &amp; Chr(13) &amp; Chr(10)\n    txt = \"\"\nEnd Sub\n\n' subprocedure to read TOV data into stream and call procedure to generate file\nPublic Sub generate_tov(i_Sheet_To_Process As String, _\n                        i_OffsetShift As Integer)\n\n    Dim sOut As String ' text to be written into file\n    'Set OutputFile = \"sarin\"\n\n    Sheets(i_Sheet_To_Process).Select\n\n    Range(\"C2\").Select\n    'Parsing of system code from filename\n    strFilenameOut = ActiveWorkbook.Name 'example - initial file name: EFPIA_DTOV-BE-MTOV-201503271324.xlsx\n    SysCode = Left(strFilenameOut, InStrRev(strFilenameOut, \"-\") - 1) 'example - after LEFT cut EFPIA_ITOV-BE-MTOV\n    SysCode = Right(SysCode, Len(SysCode) - InStrRev(SysCode, \"-\")) 'example - after RIGHT cut MTOV\n\n    Do Until (IsError(ActiveCell.Offset(0, 1).Value) = True)\n        If ActiveCell.Offset(0, 1).Value = \"\" Then\n            'end-of-file reached, hence exist the do loop\n            Exit Do\n        End If\n\n        ActiveCell.Value = SysCode\n        ActiveCell.Offset(0, i_OffsetShift).Value = Application.WorksheetFunction.VLookup(Sheets(\"Template - EFPIA Customer\").Cells(ActiveCell.Row, 3).Value, Sheets(\"Appendix\").Range(\"N1:O103\"), 2, \"FALSE\") &amp; \"_\" &amp; ActiveCell.Offset(0, i_OffsetShift).Value\n        ActiveCell.Offset(1, 0).Select\n    Loop\n\n    OutputFile = Left(strFilenameOut, InStrRev(strFilenameOut, \".\") - 1) &amp; \".txt\"\n\n    If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n        MsgBox (\"incorrect data in the TOV source file. Please correct and re-run the macro\")\n        Exit Sub\n    Else\n        Call generate_file\n    End If\n\n\nEnd Sub\n\n' procedures to write stream data into file for both TOV and customer\nPublic Sub generate_file()\n\n     Dim X As Integer\n     Dim Y As Long\n     Dim FieldValue As String\n     Dim NBCol As Integer\n     Dim sOut As String ' text to be written into file\n\n\n     OUTFILE_OPEN (OutputFile) 'Open (setup) the output file\n     'Open OutputFile For Output As #1 'Prepares new file for output\n     Set MyWkBook = ActiveWorkbook\n     Set MyWkSheet = ActiveSheet\n     NBCol = 0\n\n     Do While (Trim(MyWkSheet.Cells(1, NBCol + 1)) &lt;&gt; \"\")\n        NBCol = NBCol + 1\n     Loop\n        ' Scroll all rows\n     Y = 1\n     Do While (Trim(MyWkSheet.Cells(Y, 4)) &lt;&gt; \"\")\n        sOut = \"\"\n        For X = 1 To NBCol\n            ' here, if required, insert a convertion type function\n            FieldValue = Trim(MyWkSheet.Cells(Y, X))\n            FieldValue = Replace(FieldValue, \"|\", \"/\") 'Replaces pipes from input file to slashes to avoid mismatches during ETL\n\n            If FieldValue = \"0\" Then FieldValue = \"\" 'Replaces \"only zeroes\" - might need redoing only for amount columns\n            If InStr(MyWkSheet.Cells(1, X), \"Amount\") &gt; 0 Then FieldValue = Replace(FieldValue, \",\", \".\")\n\n            ' add into the string\n            If X = NBCol Then\n                sOut = sOut &amp; FieldValue\n            Else\n                sOut = sOut &amp; FieldValue &amp; DELIMITER\n            End If\n\n        Next X\n        Y = Y + 1\n        OUTFILE_WRITELINE sOut\n     Loop\n    OUTFILE_CLOSE\n\nEnd Sub\n\n' read the customer data into stream\nPublic Sub read_customer(i_Sheet_To_Process As String, _\n                         i_range As String)\n\n    Dim CCST As Workbook ' Variable to keep reference for template Workbook that is being used for copy-paste of Customer data into virtuall Workbook\n\n    Sheets(i_Sheet_To_Process).Select\n    ActiveSheet.UsedRange.Copy\n    Set CCST = ActiveWorkbook\n    WB_Cust.Activate\n\n    If i_range = \"\" Then\n        Sheets(\"Sheet1\").Range(CustAddressSave.Address).PasteSpecial xlPasteValues\n        Range(CustAddressSave.Address).Select\n        ActiveCell.Offset(0, 2).Select\n        Rows(CustAddressSave.Row).EntireRow.Delete\n    Else\n        Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n        Range(\"C2\").Select\n    End If\n\n    'Call LookingUp(CCST)\n    Do Until (IsError(ActiveCell.Offset(0, 1).Value) = True)\n\n        If ActiveCell.Offset(0, 1).Value = \"\" Then\n            'end-of-file reached, hence exist the do loop\n            Exit Do\n        End If\n\n        ActiveCell.Offset(0, 1).Value = Application.WorksheetFunction.VLookup(ActiveCell.Offset(0, 0).Value, CCST.Sheets(\"Appendix\").Range(\"N1:O103\"), 2, \"FALSE\") &amp; \"_\" &amp; ActiveCell.Offset(0, 1).Value\n        ActiveCell.Value = SysCode\n        ActiveCell.Offset(1, 0).Select\n    Loop\n\n    If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n        MsgBox (\"incorrect data in the source file. Please correct and re-run the macro\")\n        Exit Sub\n    Else\n        Set CustAddressSave = ActiveCell.Offset(0, -2) 'Saves position where 2nd Cust data sheet will be copied\n        OutputFile = Left(Mid(strFilenameOut, 1, (InStr(strFilenameOut, \"_\"))) &amp; \"CUST\" &amp; Mid(strFilenameOut, (InStr(strFilenameOut, \"-\"))), InStrRev(strFilenameOut, \".\") - 1) &amp; \".txt\"\n    End If\n\nEnd Sub\n\n\n'Main Procedure of the module that processes the files\nPrivate Sub Process(Loops As Integer, FileFlag As String) 'Loops - number of files (1 or 2), FileFlag - which file is to be processed (I - ITOV, D - DTOV, B - Both)\n\n    Set WB_Cust = Workbooks.Add\n    ' This virtual workbook is created only for duration of the processing. It is used to copy paste CUSTOMER data form one or both templates.\n\n    If FileFlag = \"D\" Or FileFlag = \"B\" Then\n        ' process DTOV first always\n        Call Open_DTOV\n\n        '----------------------------------------------------------\n        Call generate_tov(\"Template - Transfer of Value\", 3)\n        ' if the file have data issues, then abort the procedure.\n        If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n            GoTo HandleException\n        End If\n\n        '----------------------------------------------------------\n        Call read_customer(\"Template - EFPIA Customer\", \"A\")\n        ' if the file have data issues, then abort the procedure.\n        If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n            GoTo HandleException\n        End If\n    End If\n\n\n\n    If FileFlag = \"I\" Or FileFlag = \"B\" Then\n        Call Open_ITOV\n\n        '----------------------------------------------------------\n        Call generate_tov(\"Template - EFPIA iToV\", 17)\n        ' if the file have data issues, then abort the procedure.\n        If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n            GoTo HandleException\n        End If\n\n        '----------------------------------------------------------\n        If FileFlag = \"B\" Then\n            Call read_customer(\"Template - EFPIA Customer\", \"\")\n        Else\n            Call read_customer(\"Template - EFPIA Customer\", \"A\")\n        End If\n\n        ' if the file have data issues, then abort the procedure.\n        If (IsError(ActiveCell.Offset(0, 1).Value) = True) Then\n            GoTo HandleException\n        End If\n\n    End If\n\n    Call Deduplicate\n    Call generate_file ' generate single customer file\n\n    MsgBox \"Export Process is completed\"\n\nHandleException:\n    ' Closes the virtual workbook used for consolidation and deduplication of customers\n    WB_Cust.Saved = True\n    WB_Cust.Close\n    ActiveWorkbook.Saved = True 'Closes Template\n    ActiveWorkbook.Close (False)\n    If Loops = 2 Then 'Closes second Template if two files are being processed\n        ActiveWorkbook.Saved = True\n        ActiveWorkbook.Close (False)\n    End If\n    Application.ScreenUpdating = True 'Turns back on switching to exported excel file once it gets opened\n\n    Exit Sub\nEnd Sub\n\n'Unused Procedure to reduce Customer data processing code. Does not work now.\nPrivate Sub LookingUp(CCST As Workbook)\n    Do Until (ActiveCell.Offset(0, 1).Value = \"\")\n        ActiveCell.Offset(0, 1).Value = Application.WorksheetFunction.VLookup(ActiveCell.Offset(0, 0).Value, CCST.Sheets(\"Appendix\").Range(\"N1:O103\"), 2, \"FALSE\") &amp; \"_\" &amp; ActiveCell.Offset(0, 1).Value\n        ActiveCell.Value = SysCode\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd Sub\n\n'Open DTOV Template\nPrivate Sub Open_DTOV()\n    Workbooks.Open (DTOV_Directory + DTOV_File)\nEnd Sub\n\n'Open ITOV Template\nPrivate Sub Open_ITOV()\n    Workbooks.Open (ITOV_Directory + ITOV_file)\nEnd Sub\n\n'Deduplicating Customer data based on Source_Party_Identifier, which already contains source code prefix\nPrivate Sub Deduplicate()\n    ActiveSheet.UsedRange.RemoveDuplicates Columns:=4, Header:=xlYeas\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery", "excel-2016"], "comments": [{"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "edited": false, "score": 0, "creation_date": 1509532535, "post_id": 47051933, "comment_id": 81052609, "body": "Is the sole reason for your desire to have this new table format simply to be able to do this calculation for the EMI&#39;s per country? If so, I would say that a new table is not required and that a formula can probably be made to perform that calculation in the existing format. Admittedly, the calculation would be easier in this new format but I think it is still possible."}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "reply_to_user": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "edited": false, "score": 0, "creation_date": 1509533651, "post_id": 47051933, "comment_id": 81053282, "body": "Actually like country I have more than 10 fields respective to each loan. And  I need to create that table to create charts based on those fields. But if a formula works telling how many EMIs are pending on my entire porfolio that would be helpful too."}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "edited": false, "score": 0, "creation_date": 1509533757, "post_id": 47051933, "comment_id": 81053354, "body": "Are you looking for a formula to generate the second table based on the first table?"}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "reply_to_user": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "edited": false, "score": 0, "creation_date": 1509534018, "post_id": 47051933, "comment_id": 81053504, "body": "Either way formula or power query or pivot table.. I just want to create that table."}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "edited": false, "score": 0, "creation_date": 1509536775, "post_id": 47051933, "comment_id": 81054998, "body": "I think using a formula would be too convoluted. May be possible with VBA or powerquery but neither of these are my expertise. I recommend adding these two tags to your post to attract people who are experts on these subjects."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1509539879, "post_id": 47051933, "comment_id": 81056879, "body": "This could (possibly) be done with <a href=\"https://msdn.microsoft.com/en-us/library/mt211003.aspx\" rel=\"nofollow noreferrer\">M / Power Query</a>. Yet, I&#39;d lean more towards VBA as this table setup is anything but standard. Besides, there are so many posts on <code>UNPIVOT</code> using VBA that you shouldn&#39;t have any problems finding a suitable solution: <a href=\"https://stackoverflow.com/search?tab=votes&amp;q=%5bexcel-vba%5d%20unpivot\">stackoverflow.com/&hellip;</a>"}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1509600363, "post_id": 47051933, "comment_id": 81084234, "body": "It would really help if we can achieve this using either of the methods. @Ralph Can you please provide any solutions using powerquery or VBA. But the solution need to dynamic as new columns(loans) are added every week."}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 0, "creation_date": 1509608259, "post_id": 47051933, "comment_id": 81087680, "body": "Yes I do know that. I was not asking for VBA code. However, having a good grip over power query I was seeking on how to resolve this, where the solution is dynamic. I know I can achieve this manually unpivoting every EMI table. But making it dynamic is what my biggest challenge"}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 0, "creation_date": 1509714386, "post_id": 47051933, "comment_id": 81142436, "body": "If there is a formula or Powerquery way to solve this situation. I know this falls under unpivoting table. But I have a dynamically increasing table having a different structure."}], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 0, "creation_date": 1509785195, "post_id": 47102935, "comment_id": 81168119, "body": "Wow. Great. I was looking for something like this. Can we make the initial table dynamic? As new columns are getting added for each new record and that table range needs to be changed"}, {"owner": {"reputation": 3648, "user_id": 7346922, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/272fd618206744f794467b795bea29f1?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Pincince", "link": "https://stackoverflow.com/users/7346922/marc-pincince"}, "reply_to_user": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 1, "creation_date": 1509802192, "post_id": 47102935, "comment_id": 81172439, "body": "Yes. It will accommodate adding new records in the manner you&#39;ve described...as 3 new columns to the right of the existing data. I added a little bit at the end of my answer, to discuss and show how that works. I also corrected a problem with the Unpivot Other Columns instruction (I had left out a column that you needed to select before clicking to unpivot). Lastly, I updated some of the screen clips."}, {"owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 0, "creation_date": 1510242673, "post_id": 47102935, "comment_id": 81361028, "body": "One additional problem with the above is my data is that the data is not getting updated on the table. I have to update the data in a table, which means I&#39;d have to maintain a table with same records. Effectively I am storing same data twice. Is there a way to use dynamic range in Power Query? Internet suggestions didn&#39;t help much"}, {"owner": {"reputation": 3648, "user_id": 7346922, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/272fd618206744f794467b795bea29f1?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Pincince", "link": "https://stackoverflow.com/users/7346922/marc-pincince"}, "reply_to_user": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "edited": false, "score": 0, "creation_date": 1510248730, "post_id": 47102935, "comment_id": 81365340, "body": "I&#39;m not sure what you exactly mean by &quot;the data is not getting updated on the table.&quot;"}], "tags": [], "owner": {"reputation": 3648, "user_id": 7346922, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/272fd618206744f794467b795bea29f1?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Pincince", "link": "https://stackoverflow.com/users/7346922/marc-pincince"}, "is_accepted": true, "score": 0, "last_activity_date": 1509801955, "last_edit_date": 1509801955, "creation_date": 1509736247, "answer_id": 47102935, "question_id": 47051933, "link": "https://stackoverflow.com/questions/47051933/change-table-structure-in-excel/47102935#47102935", "title": "Change table structure in Excel", "body": "<p>Start with a table like this (I named mine Table1):</p>\n\n<p><a href=\"https://i.stack.imgur.com/5IHCq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5IHCq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Load it as a source into Power Query (In Excel 2016: Data -> From Table).</p>\n\n<p>It'll look like this in Power Query:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vxBgs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vxBgs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click Transform -> Transpose, to flip the table 90 degrees.</p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/z5ZBK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z5ZBK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click Transform -> Use First Row as Headers.</p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tl6BP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tl6BP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select <em>both</em> the Name and Country columns, then click Transform -> Fill -> Down.</p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5edni.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5edni.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select the Name, Country, Column3 columns, and the untitled column (the one with Date, Cashflow, and Status of payment in it) then click Transform -> Unpivot Columns (drop-down arrow) -> Unpivot Other Columns:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zUMs4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zUMs4.png\" alt=\"enter image description here\"></a></p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k9NCF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k9NCF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select the untitled column (the one with Date, Cashflow, and Status of payment in it) and click Transform -> Pivot Column. Fill out the pop-up window like this and click OK:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8sm8K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8sm8K.png\" alt=\"enter image description here\"></a></p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KzoV1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KzoV1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select the Column3 and Attribute columns and click Home -> Remove Columns.</p>\n\n<p>If there are any blanks in the Date column, select the filter drop-down button on the Date column and filter out any blanks by deselecting the checkbox by (blank) and clicking OK:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LtmO0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LtmO0.png\" alt=\"enter image description here\"></a></p>\n\n<p>It'll look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hQDF9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hQDF9.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Answer to question about adding info:</strong></p>\n\n<p>Yes. This will accommodate additional info...added to the right of the existing source table <em>in Excel</em> (mine was Table1), as long as you maintain the same format. So if I add \"Other Person\" like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T39Wq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T39Wq.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you then select the source table <em>in Excel</em> (Table1) and click Data -> Refresh All, then switch to the newer tab that was created by Power Query when you first ran the query, you'll see it has been updated with the new info. Like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F5UDR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F5UDR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 412, "user_id": 6538898, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0ea857203997d86de8a938304c54653c?s=128&d=identicon&r=PG&f=1", "display_name": "Bikash Behera", "link": "https://stackoverflow.com/users/6538898/bikash-behera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 1, "accepted_answer_id": 47102935, "answer_count": 1, "score": -1, "last_activity_date": 1509801955, "creation_date": 1509529120, "last_edit_date": 1509600506, "question_id": 47051933, "link": "https://stackoverflow.com/questions/47051933/change-table-structure-in-excel", "title": "Change table structure in Excel", "body": "<p>Currently I've a table like below where I collect EMIs for all our borrowers.</p>\n\n<pre><code>+---------+-----------------+----------+-------------------+-----------------+----------+-------------------+------------+----------+-------------------+\n|  Name   |            Vinesh Pardeshi                     |         Satyajit Chavan                        |   Varsha                                  |\n+---------+-----------------+----------+-------------------+-----------------+----------+-------------------+------------+----------+-------------------+\n| Country | India                                          | Europe                                         | Japan                                     |\n|         |                 |          |                   |                 |          |                   |            |          |                   |\n|         | Date            | Cashflow | Status of payment | Date            | Cashflow | Status of payment | Date       | Cashflow | Status of payment |\n| EMI1    | 15-08-2017      | 5000     | Paid              | 15-08-2017      | 8400     | Unpaid            | 31-08-2017 | 40003    | Pending           |\n| EMI2    | 15-09-2017      | 5000     | Pending           | 15-09-2017      | 7700     | Pending           | 30-09-2017 | 6441     | Pending           |\n| EMI3    | 15-10-2017      | 5000     | Pending           | 15-10-2017      | 7700     | Pending           | 30-10-2017 | 6441     | Pending           |\n| EMI4    | 15-11-2017      | 5000     | Pending           | 15-11-2017      | 7700     | Pending           | 30-11-2017 | 6441     | Pending           |\n| EMI5    | 15-12-2017      | 5000     | Pending           | 15-12-2017      | 7700     | Pending           | 30-12-2017 | 6441     | Pending           |\n| EMI6    | 15-01-2018      | 5000     | Pending           | 15-01-2018      | 7700     | Pending           | 30-01-2018 | 6441     | Pending           |\n| EMI7    | 15-02-2018      | 5000     | Pending           | 15-02-2018      | 7700     | Pending           | 28-02-2018 | 6441     | Pending           |\n| EMI8    |                 |          |                   | 15-03-2018      | 7700     | Pending           | 28-03-2018 | 6441     | Pending           |\n| EMI9    |                 |          |                   | 15-04-2018      | 7700     | Pending           | 28-04-2018 | 6441     | Pending           |\n| EMI10   |                 |          |                   |                 |          |                   | 28-05-2018 | 6441     | Pending           |\n| EMI11   |                 |          |                   |                 |          |                   | 28-06-2018 | 6441     | Pending           |\n+---------+-----------------+----------+-------------------+-----------------+----------+-------------------+------------+----------+-------------------+\n</code></pre>\n\n<p>I have data for more than 200 clients. As new clients gets acquired three new columns gets added at the end of the table. So the solution needs to be dynamic to cover any added new columns.</p>\n\n<p>Now I wanted to know how much EMIs are pending/paid for each country and what is total value for those EMIs pending or paid.</p>\n\n<p>For that I want to create a table something like this below</p>\n\n<pre><code>+-----------------+---------+------------+----------+-------------------+\n|      Name       | Country |    Date    | Cashflow | Status of payment |\n+-----------------+---------+------------+----------+-------------------+\n| Vinesh Pardeshi | India   | 15-08-2017 |     5000 | Paid              |\n| Vinesh Pardeshi | India   | 15-09-2017 |     5000 | Pending           |\n| Vinesh Pardeshi | India   | 15-10-2017 |     5000 | Pending           |\n| Vinesh Pardeshi | India   | 15-11-2017 |     5000 | Pending           |\n| Vinesh Pardeshi | India   | 15-12-2017 |     5000 | Pending           |\n| Vinesh Pardeshi | India   | 15-01-2018 |     5000 | Pending           |\n| Vinesh Pardeshi | India   | 15-02-2018 |     5000 | Pending           |\n| Satyajit Chavan | Europe  | 15-08-2017 |     8400 | Unpaid            |\n| Satyajit Chavan | Europe  | 15-09-2017 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-10-2017 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-11-2017 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-12-2017 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-01-2018 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-02-2018 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-03-2018 |     7700 | Pending           |\n| Satyajit Chavan | Europe  | 15-04-2018 |     7700 | Pending           |\n| Varsha          | Japan   | 31-08-2017 |    40003 | Pending           |\n| Varsha          | Japan   | 30-09-2017 |     6441 | Pending           |\n| Varsha          | Japan   | 30-10-2017 |     6441 | Pending           |\n| Varsha          | Japan   | 30-11-2017 |     6441 | Pending           |\n| Varsha          | Japan   | 30-12-2017 |     6441 | Pending           |\n| Varsha          | Japan   | 30-01-2018 |     6441 | Pending           |\n| Varsha          | Japan   | 28-02-2018 |     6441 | Pending           |\n| Varsha          | Japan   | 28-03-2018 |     6441 | Pending           |\n| Varsha          | Japan   | 28-04-2018 |     6441 | Pending           |\n| Varsha          | Japan   | 28-05-2018 |     6441 | Pending           |\n| Varsha          | Japan   | 28-06-2018 |     6441 | Pending           |\n+-----------------+---------+------------+----------+-------------------+\n</code></pre>\n\n<p>So that I can pivot the data later on. Please guide me on how I can achieve that using excel. I am using Excel 2016.</p>\n"}, {"tags": ["vba", "msgbox"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1509529820, "post_id": 47052036, "comment_id": 81051053, "body": "Yes, it&#39;s perfect. Thank you!"}, {"owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1509532588, "post_id": 47052036, "comment_id": 81052637, "body": "One more question please: if even if XXX!D13 =0, i still recieve an empty message with &quot;ok&quot; button. How can i change the vba, so that in case XXX!D13 is zero, not to have any message."}, {"owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1509537770, "post_id": 47052036, "comment_id": 81055610, "body": "I added this line to the vba, but now it seems more complicated :) If msg &lt;&gt; &quot;&quot; Then MsgBox msg.      Now, the message won&#39;t appear at all, if D13=0 and E13=1"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1509601189, "post_id": 47052036, "comment_id": 81084506, "body": "@lofgren This is the best solution you can use. If this is complicated code for you, then you have never seen complicated code ;)"}, {"owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1509630543, "post_id": 47052036, "comment_id": 81102233, "body": "I just discovered VBAs two monts ago, so yes, some things are complicated... :))"}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1509529632, "creation_date": 1509529632, "answer_id": 47052036, "question_id": 47051916, "link": "https://stackoverflow.com/questions/47051916/merge-multiple-msgbox-into-one/47052036#47052036", "title": "Merge multiple MsgBox into one", "body": "<p>You want to show both messages in one box? Like this?</p>\n\n<pre><code>Dim msg As String\nIf Worksheets(\"XXX\").Range(\"D13\") &gt; 0 Then\n    msg = \"ATENTION!\" &amp; vbCrLf &amp; \"OLD = \" &amp; Worksheets(\"XXX\").Range(\"D13\") &amp; \" PCS !\"\nEnd If\n\nIf Worksheets(\"XXX\").Range(\"E13\") &gt; 0 Then\n    msg = msg &amp; vbCrLf &amp; \"ATENTION!\" &amp; vbCrLf &amp; \"REQUEST = \" &amp; Worksheets(\"XXX\").Range(\"E13\") &amp; \" PCS !\"\nEnd If\nMsgBox msg\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47052036, "answer_count": 1, "score": 0, "last_activity_date": 1509529632, "creation_date": 1509529049, "question_id": 47051916, "link": "https://stackoverflow.com/questions/47051916/merge-multiple-msgbox-into-one", "title": "Merge multiple MsgBox into one", "body": "<p>I am trying to merge multiple MsgBoxs into one, but i have no luck.\nIf you have any ideea, please help. This is my VBA:</p>\n\n<pre><code>  If Worksheets(\"XXX\").Range(\"D13\") &gt; 0 Then\n\nMsgBox (\"ATENTION!\" &amp; vbCrLf &amp; \"OLD = \") &amp; Worksheets(\"XXX\").Range(\"D13\") &amp; \" PCS !\"\nEnd If\n\nIf Worksheets(\"XXX\").Range(\"E13\") &gt; 0 Then\nMsgBox (\"ATENTION!\" &amp; vbCrLf &amp; \"REQUEST = \") &amp; Worksheets(\"XXX\").Range(\"E13\") &amp; \" PCS !\"\nEnd If\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["arrays", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1509563623, "post_id": 47061950, "comment_id": 81071998, "body": "This verifies that file 1 has the same number of sheets as file 2, otherwise it doesn&#39;t execute. If file 2 can contain more sheets than file 1 (but not less) remove the condition <code>If ws1Count = wb2.Worksheets.Count Then</code> (and its corresponding <code>End If</code>)"}, {"owner": {"reputation": 5, "user_id": 8789013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ee423f8794e56ad7555703bd29492d?s=128&d=identicon&r=PG&f=1", "display_name": "mhmh", "link": "https://stackoverflow.com/users/8789013/mhmh"}, "edited": false, "score": 0, "creation_date": 1510133744, "post_id": 47061950, "comment_id": 81301281, "body": "hello @Paul bica! Sorry for my late answer. Saw your post this morning and the code works perfect! Thank you for helping me and to also add the seconde code plus <code>wb1.close False</code>"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1509563101, "creation_date": 1509563101, "answer_id": 47061950, "question_id": 47051838, "link": "https://stackoverflow.com/questions/47051838/subtraction-of-two-multidimensional-arrays-vba/47061950#47061950", "title": "Subtraction of two multidimensional Arrays VBA", "body": "<p>You almost had it right, but the issues was that you didn't reset ArrayC</p>\n\n<p>This code creates new sheets in ThisWorkbook for subtractions, and based on your <a href=\"https://stackoverflow.com/questions/46787259/vba-subtract-two-different-3-dimensional-arrays-from-eachother\">previous question</a> it checks for errors, and performs the subtractions only if both values are numbers</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub Differenz2()\n    Const USED_RNG = \"F5:Y75\"   'Main range\n    Dim i As Long, j As Long, k As Long, file1 As String, file2 As String, ws1Count As Long\n    Dim wb1 As Workbook, wb2 As Workbook, arr1 As Variant, arr2 As Variant, arr3 As Variant\n\n    'ChDrive \"O:\\\":  ChDir \"O:...\"\n    file1 = Application.GetOpenFilename:    If file1 = \"False\" Then Exit Sub\n    file2 = Application.GetOpenFilename:    If file2 = \"False\" Then Exit Sub\n    Application.ScreenUpdating = False\n    Set wb1 = Workbooks.Open(Filename:=file1, ReadOnly:=True)\n    Set wb2 = Workbooks.Open(Filename:=file2, ReadOnly:=True)\n    ws1Count = wb1.Worksheets.Count\n    If ws1Count = wb2.Worksheets.Count Then\n        MakeNewWS ws1Count    'Remove this line if ThisWorkbook is properly setup\n        For k = 1 To ws1Count\n            arr1 = wb1.Worksheets(k).Range(USED_RNG).Value\n            arr2 = wb2.Worksheets(k).Range(USED_RNG).Value\n            ReDim arr3(1 To 71, 1 To 20)    'reset array, based on USED_RNG (\"F5:Y75\")\n            For i = LBound(arr1, 1) To UBound(arr1, 1)\n                For j = LBound(arr1, 2) To UBound(arr1, 2)\n                    If Not IsError(arr1(i, j)) And Not IsError(arr2(i, j)) Then\n                        If IsNumeric(arr1(i, j)) And IsNumeric(arr2(i, j)) Then\n                            arr3(i, j) = arr1(i, j) - arr2(i, j)\n                        End If\n                    End If\n                Next\n            Next\n            ThisWorkbook.Worksheets(k + 1).Range(USED_RNG) = arr3\n        Next\n    End If\n    wb1.Close False:    wb2.Close False:    ThisWorkbook.Worksheets(2).Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub MakeNewWS(ByVal wsCount As Long)\n    Dim i As Long, ws As Worksheet\n\n    With ThisWorkbook.Worksheets\n        Application.DisplayAlerts = False\n        For Each ws In ThisWorkbook.Worksheets\n            If Left(ws.Name, 12) = \"Subtraction \" Then\n                If .Count = 1 Then .Add\n                ws.Delete\n            End If\n        Next\n        Application.DisplayAlerts = True\n        For i = 2 To wsCount + 1\n            .Add After:=ThisWorkbook.Worksheets(.Count)\n            ThisWorkbook.Worksheets(.Count).Name = \"Subtraction \" &amp; i - 1\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You can ignore the <code>MakeNewWS()</code> sub if ThisWorkbook contains the proper number of sheets</p>\n\n<p>Also, using arrays does improve performance (significantly)</p>\n"}], "owner": {"reputation": 5, "user_id": 8789013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ee423f8794e56ad7555703bd29492d?s=128&d=identicon&r=PG&f=1", "display_name": "mhmh", "link": "https://stackoverflow.com/users/8789013/mhmh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 47061950, "answer_count": 1, "score": 0, "last_activity_date": 1509563101, "creation_date": 1509528763, "last_edit_date": 1509536379, "question_id": 47051838, "link": "https://stackoverflow.com/questions/47051838/subtraction-of-two-multidimensional-arrays-vba", "title": "Subtraction of two multidimensional Arrays VBA", "body": "<p>I have a problem with a selfmade vba-code. The makro should solve the following problem: I use a \"cockpitfile\" It should load the elemts of two worksheets from two different Excel files into two Arrays. The Elements of these Arrays should be subtracted from each other. I want to get the difference from these two elements. As an example: ArrayElm1(1,1) - ArrayElm2(1,1) = ArrayElm3(1,1), ArrayElm1(1,2) - ArrayElm2(1,2) = ArrayElm3(1,2) etc. </p>\n\n<p>On the first sight the code seems to work but when I check the results with my calculater the difference of the elements is wrong. Maybe there is a problem with the <code>UBound</code> because in my <code>Ubound</code> is only Array A?</p>\n\n<p>Hope you can help me!</p>\n\n<pre><code>Sub Differenz1()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'Variabledefinition\nDim i As Long 'Index\nDim j As Long 'Index\nDim k As Long 'Index\nDim ArrayA As Variant 'Array\nDim ArrayB As Variant 'Array\nDim ArrayC(71, 25) As Variant  'Array\nDim myFile1 As String 'Workbookname\nDim myFile2 As String 'Workbookname\nDim wb1 As String 'Workbookname\nDim wb2 As String 'Workbookname\nDim WS_Count1 As Integer 'Count Worksheets\nDim WS_Count2 As Integer 'Count Worksheets\nDim arrays1 As String 'Dimension\nDim arrays2 As String 'Dimension\n\n\n'Change the actual path\n\nChDrive \"O:\\\"\nChDir \"O:...\"\n\n\nmyFile1 = Application.GetOpenFilename\nWorkbooks.Open Filename:=myFile1, ReadOnly:=True, IgnoreReadOnlyRecommended:=True\nwb1 = ActiveWorkbook.Name\nWS_Count1 = ActiveWorkbook.Worksheets.Count\n\n\n\nmyFile2 = Application.GetOpenFilename\nWorkbooks.Open Filename:=myFile2, ReadOnly:=True, IgnoreReadOnlyRecommended:=True\nwb2 = ActiveWorkbook.Name\nWS_Count2 = ActiveWorkbook.Worksheets.Count\n\n\n\nFor k = 1 To WS_Count1\n\nArrayA = Workbooks(wb1).Worksheets(k).Range(\"F5:Y75\").Value\nArrayB = Workbooks(wb2).Worksheets(k).Range(\"F5:Y75\").Value\n    For i = LBound(ArrayA, 1) To UBound(ArrayA, 1)\n        For j = LBound(ArrayA, 2) To UBound(ArrayA, 2)\n            If Not IsError(ArrayA(i, j)) And Not IsError(ArrayB(i, j)) Then ArrayC(i, j) = ArrayA(i, j) - ArrayB(i, j)\n        Next j\n    Next i\n\n    ThisWorkbook.Worksheets(k + 1).Range(\"F5:Y75\").Value = ArrayC\n\nNext k\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509528506, "post_id": 47051710, "comment_id": 81050325, "body": "Yes, use <code>Worksheet_Change</code> event, and then add <code>Range(&quot;C5&quot;).Value = Date</code>"}, {"owner": {"reputation": 23, "user_id": 8835867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab76959e4a1849496aed59d931a17ccc?s=128&d=identicon&r=PG&f=1", "display_name": "webjoh", "link": "https://stackoverflow.com/users/8835867/webjoh"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509530772, "post_id": 47051710, "comment_id": 81051580, "body": "yes this does actualy work but the worksheet_change event is triggerd when the date changes to a new date,then it is triggered again and again.  Is there a way to keep c5 out of this loop? Meaning c5 is the only cell not to be monitored by this worksheet_change event?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1509536298, "creation_date": 1509536298, "answer_id": 47053945, "question_id": 47051710, "link": "https://stackoverflow.com/questions/47051710/excel-vba-changing-date-when-there-are-changes-to-the-workbook/47053945#47053945", "title": "Excel/VBA changing date when there are changes to the workbook", "body": "<p>Try the code below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n' check that the cell changed is not \"C5\"\nIf Intersect(Target, Range(\"C5\")) Is Nothing Then\n    Application.EnableEvents = False\n\n    Range(\"C5\").Value = Date\nEnd If\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8835867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab76959e4a1849496aed59d931a17ccc?s=128&d=identicon&r=PG&f=1", "display_name": "webjoh", "link": "https://stackoverflow.com/users/8835867/webjoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509536298, "creation_date": 1509528385, "question_id": 47051710, "link": "https://stackoverflow.com/questions/47051710/excel-vba-changing-date-when-there-are-changes-to-the-workbook", "title": "Excel/VBA changing date when there are changes to the workbook", "body": "<p>is it possible in Excel to insert today's date into a Workbook/sheet only when the data inside the sheet is changed.</p>\n\n<p>So what I mean by this is that there is a workbook with several sheets and if somebody makes changes to this sheets I want to have my date updated that is in a specific cell. For better understanding lets just say that this cell is C5 of the first worksheet.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "button", "floating", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1509534486, "post_id": 47050762, "comment_id": 81053735, "body": "What sort of button is it? Form control or ActiveX?"}, {"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1509534887, "post_id": 47050762, "comment_id": 81053958, "body": "@Robin Mackenzie  form control"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1509537964, "post_id": 47050762, "comment_id": 81055711, "body": "Three possible solutions: (1) place the button in a ribbon / menu (2) place the button in the top row and fixate that row (view --&gt; freeze pane) or (3) put the button on a form and show the form with modal being <code>False</code>."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1509549290, "post_id": 47050762, "comment_id": 81063289, "body": "Freeze panes is easier"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9620107, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211141513923341/picture?type=large", "display_name": "Bart Lefevere", "link": "https://stackoverflow.com/users/9620107/bart-lefevere"}, "is_accepted": false, "score": 0, "last_activity_date": 1523295619, "last_edit_date": 1523295619, "creation_date": 1523284920, "answer_id": 49735645, "question_id": 47050762, "link": "https://stackoverflow.com/questions/47050762/excel-vba-how-to-make-a-floating-button/49735645#49735645", "title": "excel VBA how to make a floating button?", "body": "<p>Here it is:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    On Error GoTo 0\n    With Cells(Windows(1).ScrollRow, Windows(1).ScrollColumn)\n        CommandButton1.Top = .Top + 100\n        CommandButton1.Left = .Left + 300\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3743, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523295619, "creation_date": 1509524443, "last_edit_date": 1531164843, "question_id": 47050762, "link": "https://stackoverflow.com/questions/47050762/excel-vba-how-to-make-a-floating-button", "title": "excel VBA how to make a floating button?", "body": "<p>have a code that check the date and fill cells with appropriate colors and this code includes a button that when the user clicked it will run the VBA code.</p>\n\n<p>i want to always make the button visible no matter how the user scroll down.</p>\n\n<h1>code:</h1>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Long\n\nFor i = Range(\"C5000\").End(xlUp).Row To 2 Step -1 'Range upto 5000, chnge this as per your requirment'\n\n\n    If IsEmpty(Cells(i, 3)) Then\n         Cells(i, 3).Interior.Color = xlNone\n\n       ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt; 0 Then\n             Cells(i, 3).Interior.Color = vbGreen\n\n       ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) = 0 Then\n             Cells(i, 3).Interior.Color = vbYellow\n\n       ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &gt;= 1 And (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt;= 4 Then\n              Cells(i, 3).Interior.Color = vbRed\n\n       ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &gt;= 5 And (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt;= 10 Then\n               Cells(i, 3).Interior.Color = vbCyan\n\n    Else\n                Cells(i, 3).Interior.ColorIndex = xlNone\n\n End If\n\n    ' your 2nd criteria to color the entire row if \"F\" is not empty\n    If Trim(Range(\"F\" &amp; i).Value) &lt;&gt; \"\" Then Range(\"D\" &amp; i &amp; \":F\" &amp; i).Interior.ColorIndex = 15\n    Debug.Print Len(Range(\"F\" &amp; i).Value)\n\n\nNext\nEnd Sub\n</code></pre>\n\n<p>i will appreciate any help.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "is_accepted": false, "score": 0, "last_activity_date": 1509540653, "creation_date": 1509540653, "answer_id": 47055303, "question_id": 47050633, "link": "https://stackoverflow.com/questions/47050633/extracting-embedded-documents-from-all-word-documents-in-a-folder/47055303#47055303", "title": "Extracting embedded documents from all word documents in a folder", "body": "<p>The First step would be to Get a list of all the files in the source folder that you are looking to extract from.</p>\n\n<pre><code>Sub GetAllFiles(Folder As String, StrArray() As String)\n    'Stores all file names from a folder into a string array.\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim i As Integer\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(Folder)\n    i = 1\n    'loops through each file in the directory and prints their names and path\n    For Each objFile In objFolder.Files\n        ReDim Preserve StrArray(i)\n        StrArray(i) = objFile.Name\n        i = i + 1\n    Next objFile\n\n    If i = 1 Then\n        ReDim Preserve StrArray(1)\n    End If\nEnd Sub\n</code></pre>\n\n<p>The next step is to filter out all but the Word Document Files.</p>\n\n<pre><code>Dim FileSpec(1) As String\nFileSpec(0) = Source &amp; \"\\*.doc\"\nFileSpec(1) = Source &amp; \"\\*.docx\"\n\nSub GetFileList(ByRef FileSpec() As String, objDict As Object)\n    Dim FileName As String\n    objDict.RemoveAll\n    On Error GoTo NoFilesFound\n    For i = LBound(FileSpec) + 1 To UBound(FileSpec)\n        FileName = Dir(FileSpec(i))\n'       Loop until no more matching files are found\n        Do While FileName &lt;&gt; \"\"\n            If Not objDict.Exists(FileName) Then objDict.Add FileName, 0\n            FileName = Dir()\n        Loop\n    Next i\n    If objDict.count = 0 Then GoTo NoFilesFound\nExit Sub\n\n'Error Handler\nNoFilesFound:\n'ERROR HANDLING\nEnd Sub\n</code></pre>\n\n<p>This Adds all the files with .doc or .docx extensions to a Dictionary as keys and a value of 0. You could change this around to be a key of whatever number with the data as the filename, but that is your choice. </p>\n\n<p>From here, you need to Open and call your Sub for each item in the dictionary.</p>\n\n<pre><code>Sub OpenAndExtract()\nDim AD As Document\n    Documents(ActiveDocument.FullName).Close SaveChanges:=wdDoNotSaveChanges\n    For each Key in objDict\n        Set Ad = Documents.Open(Source &amp; \"\\\" &amp; Key).Activate\n        Call Extract\n    Next\nEnd Sub\n</code></pre>\n\n<p>And that is it roughly. Please note that you will probably have to change up the way that you chose your destination folder (by taking a parameter or setting up a global variable, etc). I don't know the organization of the project you are working on so you are likely going to have to go about this piecewise, getting one part to work slowly. Also, I wrote this almost all this by hand in the editor here, so it is entirely possible I have some syntax wrong somewhere. Don't take it as the word of god, but it should get you well on your way to your goal. </p>\n"}], "owner": {"reputation": 1, "user_id": 8866818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A9Hk1GQZBKk/AAAAAAAAAAI/AAAAAAAAD6o/sMEayJVpuXg/photo.jpg?sz=128", "display_name": "Swagat Karnany", "link": "https://stackoverflow.com/users/8866818/swagat-karnany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1947, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1509540653, "creation_date": 1509523819, "question_id": 47050633, "link": "https://stackoverflow.com/questions/47050633/extracting-embedded-documents-from-all-word-documents-in-a-folder", "title": "Extracting embedded documents from all word documents in a folder", "body": "<p>I am new to vba and I have a question. I have written a macro in word to open and save embedded documents in the active document. The code I wrote is below:</p>\n\n<pre><code>Sub Extract()\n\n    Dim num As Integer\n    Dim AD As Document\n    Set AD = ActiveDocument\n\n    Dim numObjects As Integer\n    numObjects = AD.InlineShapes.Count\n\n    'MsgBox numObjects  ' prints \"11\"\n\n    For num = 1 To numObjects\n        If AD.InlineShapes(num).Type = 1 Then\n            'it's an embedded OLE type so open it.\n            AD.InlineShapes(num).OLEFormat.Open\n            AD.InlineShapes(num).OLEFormat.Object.SaveAs FileName:=\"C:\\Users\\Ankita\\Desktop\\New folder\\x.xlsx\", FileFormat:=51\n\n\n        End If\n    Next num\n\nEnd Sub\n</code></pre>\n\n<p>What I would like to do is extract all embedded documents in all the word documents present in a source folder and save all of them in a destination folder.</p>\n\n<p>I understand that I would have to access the word docs and loop through them and have the same code snippet as above, but how exactly do I write it.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1509523599, "post_id": 47050464, "comment_id": 81048028, "body": "&quot;What am I doing wrong?&quot;: You are copy/pasting only half code from <a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">Ron de Bruin</a> and you dont try to understand how the code works at all."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1509523780, "post_id": 47050464, "comment_id": 81048112, "body": "You are missing the <code>Function RangetoHTML(rng As Range)</code>. See link in my first comment."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "is_accepted": false, "score": -1, "last_activity_date": 1509634179, "creation_date": 1509634179, "answer_id": 47078185, "question_id": 47050464, "link": "https://stackoverflow.com/questions/47050464/excel-vba-rangetohtml/47078185#47078185", "title": "Excel VBA RangeToHTML", "body": "<p>I was missing the <code>Function RangetoHTML(rng As Range)</code> as <a href=\"https://stackoverflow.com/users/3915431/axel-richter\">Axel Richter</a> commented.</p>\n"}], "owner": {"reputation": 93, "user_id": 8806711, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cUmNq.png?s=128&g=1", "display_name": "Maurice van Dorst", "link": "https://stackoverflow.com/users/8806711/maurice-van-dorst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8874, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1509634179, "creation_date": 1509523011, "last_edit_date": 1509536582, "question_id": 47050464, "link": "https://stackoverflow.com/questions/47050464/excel-vba-rangetohtml", "title": "Excel VBA RangeToHTML", "body": "<p>I have been trying to add a button where it pastes the content of a certain range into an Outlook email. By doing so, I'm using the following code:</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\n\nRange(\"P25:P32,Q25:Q32,R25:R32,S25:S32,T25:T32\").Select\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Selection.SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\"\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = Range(\"F22\").Value\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = Range(\"F23\").Value\n    .HTMLBody = RangetoHTML(rng)\n    If Toggle_3.Value = True Then\n        .Display\n    ElseIf Toggle_4.Value = True Then\n        .Send\n    End If\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nCall SaveFile\n\nEnd Sub\n</code></pre>\n\n<p>At line 7 of the code I used to have \"P25:T32\", but I changed it to that because I thought that might've been what caused the error.</p>\n\n<p>When clicking the button, it gives me the error message: </p>\n\n<blockquote>\n  <p>Sub or function is not defined</p>\n</blockquote>\n\n<p>and it highlights the <code>.HTMLBody = RangetoHTML(rng)</code> line.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel", "copy", "paste"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509522238, "post_id": 47050268, "comment_id": 81047454, "body": "Why is this code in the <code>Worksheet_Change</code> event? what you are not realy doing anything with <code>Taregt</code>, ot anything relatind to a certain change event."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509522277, "post_id": 47050268, "comment_id": 81047470, "body": "@ShaiRado Oops - I hadn&#39;t even noticed that!  (I guess it could be intentional, i.e. creating a backup copy, by date, every time any sort of change occurs - this each dated sheet gives the status at the end of that day.  But that&#39;s potentially a <b>lot</b> of copies occurring during the day.)"}, {"owner": {"reputation": 33, "user_id": 8481666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9091a511619f74fb8742da536ec81e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Youiee", "link": "https://stackoverflow.com/users/8481666/youiee"}, "edited": false, "score": 0, "creation_date": 1509522656, "post_id": 47050268, "comment_id": 81047636, "body": "My teacher said to put it in there, he said that means everytime something happens it will check if theres a sheet and if there isnt a sheet with the mm/yyyy then it will create one"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8481666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9091a511619f74fb8742da536ec81e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Youiee", "link": "https://stackoverflow.com/users/8481666/youiee"}, "edited": false, "score": 0, "creation_date": 1509522765, "post_id": 47050292, "comment_id": 81047686, "body": "Thank you! It mostly worked but when the dates carried over they become all #####? Here are some screenshots to show what I am saying  <a href=\"https://gyazo.com/2392e7ec44a91a6af181aa2843cbc4d7\" rel=\"nofollow noreferrer\">gyazo.com/2392e7ec44a91a6af181aa2843cbc4d7</a> <a href=\"https://gyazo.com/04de88e2fac86b04e78f8d7808ccdf0b\" rel=\"nofollow noreferrer\">gyazo.com/04de88e2fac86b04e78f8d7808ccdf0b</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 33, "user_id": 8481666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9091a511619f74fb8742da536ec81e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Youiee", "link": "https://stackoverflow.com/users/8481666/youiee"}, "edited": false, "score": 0, "creation_date": 1509524183, "post_id": 47050292, "comment_id": 81048274, "body": "@Youiee Are you sure you just haven&#39;t made the column widths wide enough to fit a date?  (I&#39;m not going to follow those links - if you want me to look at images, edit the question to include them - that way I will know that they are on a safe server.)  Or are the dates based on a formula that is dependent on something that was in (for instance) rows 1 to 4 and is therefore now giving a <code>#REF</code> error?"}, {"owner": {"reputation": 33, "user_id": 8481666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9091a511619f74fb8742da536ec81e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Youiee", "link": "https://stackoverflow.com/users/8481666/youiee"}, "edited": false, "score": 0, "creation_date": 1509529025, "post_id": 47050292, "comment_id": 81050630, "body": "Oh right sorry you are right again I just had to expand the columns, thank you very much!!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1509522154, "creation_date": 1509522154, "answer_id": 47050292, "question_id": 47050268, "link": "https://stackoverflow.com/questions/47050268/excel-vba-how-to-copy-and-paste-a-section-of-cells-into-a-newly-made-sheet/47050292#47050292", "title": "Excel VBA How to copy and paste a section of cells into a newly made sheet", "body": "<p>Your line saying</p>\n\n<pre><code>Worksheets(\"Main\").Range(\"A5:D300\").Copy Worksheets(\"sheetNameStr\").Range(\"A1\")\n</code></pre>\n\n<p>is referring to a worksheet called <code>\"sheetNameStr\"</code>, but you really want to refer to a sheet with the name contained in the variable <code>sheetNameStr</code>, i.e.</p>\n\n<pre><code>Worksheets(\"Main\").Range(\"A5:D300\").Copy Worksheets(sheetNameStr).Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8481666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9091a511619f74fb8742da536ec81e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Youiee", "link": "https://stackoverflow.com/users/8481666/youiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47050292, "answer_count": 1, "score": 0, "last_activity_date": 1509534541, "creation_date": 1509522035, "last_edit_date": 1509534541, "question_id": 47050268, "link": "https://stackoverflow.com/questions/47050268/excel-vba-how-to-copy-and-paste-a-section-of-cells-into-a-newly-made-sheet", "title": "Excel VBA How to copy and paste a section of cells into a newly made sheet", "body": "<p>I'm making a budgeter sort of thing that helps people keep track of their money. I currently have a bunch of code that checks the current month and attempts to make a new sheet with the name (MM/YYYY) unless that sheet has already been made, if it has been made then nothing will happen.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    nowMonth = Month(Now)\n    nowYear = Year(Now)\n    sheetNameStr = nowMonth &amp; \",\" &amp; nowYear\n\n    sheetExists = False\n    For Each Sheet In Worksheets\n        If sheetNameStr = Sheet.Name Then\n            sheetExists = True\n        End If\n    Next Sheet\n    If sheetExists = False Then\n        Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n        ws.Name = sheetNameStr\n        MsgBox (\"New sheet named \" &amp; sheetNameStr &amp; \"was created\")\n    End If\n    Sheets(\"Main\").Activate\n\n    Worksheets(\"Main\").Range(\"A5:D300\").Copy Worksheets(\"sheetNameStr\").Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>The problem I am having is trying to copy and paste the history of my purchases/income and pasting it into the new sheet. I always get the </p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range</p>\n</blockquote>\n\n<p>error.</p>\n\n<p>If anyone could help that'd be great thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509521391, "post_id": 47050070, "comment_id": 81047137, "body": "Are you really using VB.Net?  The code looks more like just normal VBA, so you have probably included the [vb.net] tag by mistake."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509521516, "post_id": 47050070, "comment_id": 81047183, "body": "<code>Set ws = ActiveWorkbook.ActiveSheet</code> ? if you must use the active sheet, then <code>Set ws = ActiveSheet</code> will do"}, {"owner": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "edited": false, "score": 0, "creation_date": 1509521648, "post_id": 47050070, "comment_id": 81047245, "body": "Removed the vb.net tag and updated the code to remove ActiveWorkbook. Thanks guys!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "edited": false, "score": 0, "creation_date": 1509522591, "post_id": 47050247, "comment_id": 81047603, "body": "Got a &#39;Type mismatch&#39; error on this line     LastRow = .Cells(.Rows.Count, &quot;B&quot;).End(xlUp) &#39; get the last row in      column &quot;B&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "edited": false, "score": 0, "creation_date": 1509522700, "post_id": 47050247, "comment_id": 81047652, "body": "@Motornerve  you&#39;re right, try now with updated code"}, {"owner": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "edited": false, "score": 0, "creation_date": 1509522876, "post_id": 47050247, "comment_id": 81047746, "body": "Works like a charm! I have never used RngAnchor before, but I like the simplicity of it. I gave you an upvote, but alas I am new and cannot influence the numbers. Also I see now that I needed to be formatting the data AFTER I placed it in the cells. I think that could have also been my problem. Thank you again Shai!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "edited": false, "score": 0, "creation_date": 1509523119, "post_id": 47050247, "comment_id": 81047847, "body": "@Motornerve you&#39;re welcome :) when you have 10 (or 15 points) you can upvote"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1509522681, "last_edit_date": 1509522681, "creation_date": 1509521928, "answer_id": 47050247, "question_id": 47050070, "link": "https://stackoverflow.com/questions/47050070/select-the-last-row-and-then-format-it-in-excel-with-vb/47050247#47050247", "title": "Select the last row and then format it in excel with VB", "body": "<p>Try replacing your code with the code below:</p>\n\n<pre><code>Private Sub StuffUpload_Click()\n\nDim ws As Worksheet\nDim LastRow As Long\nDim RngAnchor As Range\n\n' Grabs the worksheet that the user is currently looking at,\n' making this form work on all sheets    \nSet ws = ActiveSheet\n\n'   Make sure all required fields have been entered\nIf Stuff.Text = \"\" Then\n     MsgBox \"You must enter Stuff.\"\n     Stuff.SetFocus\n     Exit Sub\nEnd If\n\n' Add a dash of formatting to the last row so the stuff we put into it will\n' look nice\nWith ws\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row ' get the last row in column \"B\"\n\n    ' set the anchor point of the range in column \"B\"\n    Set RngAnchor = .Range(\"B\" &amp; LastRow + 1)\n\n    ' Adds the Stuff info into Col B at the Last Blank Row\n    RngAnchor.Value = Me.Stuff.Value\n\n    ' Add date and time stamp for the moment the comment was entered\n    RngAnchor.Offset(, 1).Value = Now\n\n    ' Adds the Stuff info into Col D at the last Blank Row\n    RngAnchor.Offset(, 2).Value = Me.Stuff.Value  '&lt;-- already added this on Column \"B\"\n\n    ' now format last row, cells \"B:D\"\n    With RngAnchor.Resize(1, 3)\n        .HorizontalAlignment = xlLeft\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n        .Rows.AutoFit\n    End With\n\nEnd With\n\nUnload Me\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8516239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gl7VJ.jpg?s=128&g=1", "display_name": "Motornerve", "link": "https://stackoverflow.com/users/8516239/motornerve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 47050247, "answer_count": 1, "score": 1, "last_activity_date": 1509522681, "creation_date": 1509521195, "last_edit_date": 1531161705, "question_id": 47050070, "link": "https://stackoverflow.com/questions/47050070/select-the-last-row-and-then-format-it-in-excel-with-vb", "title": "Select the last row and then format it in excel with VB", "body": "<p>I am trying to create a user form that inserts data into the last row of a spreadsheet in a logical fashion, but the data is not formatted once I drop it in to the cells. My first thought would be to simply select the last row and format it before I drop the data in. The '.Rows.Autofit' property works with this code, but the other settings, such as text that is left aligned, which is what I really need, do not work. What am I missing? (I replaced all userform text things and variables with \"Stuff\" for NDA reasons. I know this creates duplicates)</p>\n\n<pre><code>Private Sub StuffUpload_Click()\n\nDim ws As Worksheet\n\n'   Grabs the worksheet that the user is currently looking at, making this \n'   form work on all sheets\nSet ws = ActiveSheet\n\n'   Make sure all required fields have been entered\n If Stuff.Text = \"\" Then\n     MsgBox \"You must enter Stuff.\"\n     Stuff.SetFocus\n     Exit Sub\nEnd If\n\n' Add a dash of formatting to the last row so the stuff we put into it will \n' look nice\nws.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Select\nWith Selection\n    .HorizontalAlignment = xlLeft\n    .VerticalAlignment = xlBottom\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\n    .Rows.AutoFit\nEnd With\n\n'   Adds the Stuff info into Col B at the Last Blank Row\nws.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Value = Me.Stuff.Value\n'   Add date and time stamp for the moment the comment was entered\nws.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Value = Date + Time\n'   Adds the Stuff info into Col D at the last Blank Row\nws.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1).Value = Me.Stuff.Value\n\n\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509520904, "post_id": 47049787, "comment_id": 81046929, "body": "I think your send Function could be a procedure that you call with arguments. Those arguments can be variables that you assign in a loop over the A7 downwards range e.g. one argument would be passing Range(&quot;A&quot;&amp; currentRow) to the sub and within the sub assigning this to TOID, same column B and C values (you would pass these for current row.) This will be a slow i think."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509521295, "post_id": 47049787, "comment_id": 81047103, "body": "Get rid of the .Select you are using. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoiding .Select</a>. Use option explicit and check all your variables are declared and correctly typed e.g. Dim SendEmail As Boolean. You have a lot of variants e.g. Dim ws,.... NotesAttach, NotesDoc, objShell As Object, only the last is an object. You also have an empty Else clause. And i don&#39;t think in VBA you need the garbage collection at the end of your Function though others may disagree."}, {"owner": {"reputation": 11, "user_id": 8866504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99a1311636b08cc28dbc21bdbad8928?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8866504/amit"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509522974, "post_id": 47049787, "comment_id": 81047779, "body": "Hi QHarr, I am very new to these codes and does not understand it much. Can you please help me cleaning this code along with the looping option."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8866504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99a1311636b08cc28dbc21bdbad8928?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8866504/amit"}, "edited": false, "score": 0, "creation_date": 1509525144, "post_id": 47050657, "comment_id": 81048682, "body": "Thank you for the help, I tried running the code but i m getting Run Time error 424 at Set rnBody1 = .Value2"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8866504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99a1311636b08cc28dbc21bdbad8928?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8866504/amit"}, "edited": false, "score": 0, "creation_date": 1509525317, "post_id": 47050657, "comment_id": 81048750, "body": "If you are setting to text within a cell then the rbBody1 should be a string variable and this line would be  rnBody1 = .Value2 but i am unsure as you are then doing   rnBody1.CopyPicture"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8866504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99a1311636b08cc28dbc21bdbad8928?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8866504/amit"}, "edited": false, "score": 0, "creation_date": 1509525402, "post_id": 47050657, "comment_id": 81048793, "body": "The danger is this will become an extended debugging to meet your requirements. Focus perhaps just on getting the loop part working and come back with a specific question regarding the next problem you need to solve."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1509524472, "last_edit_date": 1509524472, "creation_date": 1509523924, "answer_id": 47050657, "question_id": 47049787, "link": "https://stackoverflow.com/questions/47049787/need-help-in-loop-function-in-vba-to-send-multiple-emails/47050657#47050657", "title": "Need help in loop function in vba to send multiple emails", "body": "<p>I am worried about confusing you with too much new detail and must profess i haven't tested the following code so please don't assume this will solve your problem outright. </p>\n\n<p>The following gives you an idea of how you might use a loop as you requested. See example also <a href=\"https://stackoverflow.com/questions/38483759/excel-email-macro-size-limits\">here</a> which covers instances where you might need to batch send (admittedly link is for Outlook) and is also an example of using a loop. </p>\n\n<p>I have included some explanations along the way in the code. It is difficult without more information to properly tailor this but i hope it helps.</p>\n\n<pre><code>Option Explicit\n\nPublic TOID As String\nPublic CCID As String\nPublic SECT As String\nPublic ACCO As String\nPublic SUBJ As String\n\nPublic Sub Send_Mail()\n\nDim wb As Workbook\nDim ws1 As Worksheet\n\nSet wb = ThisWorkbook  'These are assumptions\nSet ws1 = wb.Worksheets(\"Sheet1\") 'These are assumptions. You would change as necessary\n\nDim answer As Long 'Integer types changed to Long\n\nanswer = MsgBox(\"DO YOU HAVE LOTUS NOTES OPEN ??  Not WebLotus notes\", vbYesNo + vbQuestion, \"LOTUS NOTES\")\n\nIf answer = vbNo Then\n    MsgBox \"Please Open Notes and Try the Macro Again\"\n    Exit Sub\n\n'Else 'Not being used so consider removing\n\nEnd If\n\nApplication.DisplayAlerts = False\n\nDim lRow As Long\nDim loopRange As Range\nDim currentRow As Long\nDim TOIDvar As String\nDim SUBJvar As String\n\nWith ws1\n\n    lRow = .Range(\"A7\").End(xlDown).Row 'Assume no gaps in column A in the TOID range\n    Set loopRange = .Range(\"A7:A\" &amp; lRow)\n\n    For currentRow = 1 To loopRange.Rows.Count 'Loop range assigning values to arguments and call send sub with args\n\n       TOIDvar = loopRange.Cells(currentRow, 1)\n\n       SUBJvar = loopRange.Cells(currentRow, 1).Offset(0, 1) ' get column B in same row using Offset\n\n       Send TOIDvar, SUBJvar\n\n    Next currentRow\n\n\nEnd With\n\n\n'Commented out MsgBox at present as unsure what you will do when sending multiple e-mails\n'MsgBox \"Mail Sent to \" &amp; (ws1.Range(\"L2\").Value) &amp; \" \" &amp; \"Recipents\" 'use explicit fully qualified Range references\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n\nPublic Sub Send(ByVal TOIDvar As String, ByVal SUBJvar As String) 'changed to sub using arguments\n\n    Dim SendEMail As Boolean 'declare with type\n    Dim wb As Workbook\n    Dim ws2 As Worksheet\n\n    Set wb = ThisWorkbook  'These are assumptions. Ensuring you are working with correct workbook\n    Set ws2 = wb.Worksheets(\"Main\")\n\n    SendEMail = True\n    TOID = TOIDvar\n    CCID = vbNullString 'use VBNullString rather than empty string literals\n    SUBJ = SUBJvar\n    'On Error GoTo ErrorMsg\n\n    Dim EmailList As Variant 'declaration of separate lines and with their types\n    Dim ws As Object\n    Dim uidoc As Object\n    Dim Session As Object\n    Dim db As Object\n    Dim uidb As Object\n    Dim NotesAttach As Object\n    Dim NotesDoc As Object\n    Dim objShell As Object\n    Dim RichTextBody As Object\n    Dim RichTextAttachment As Object\n    Dim server As String\n    Dim mailfile As String\n    Dim user As String\n    Dim usersig As String\n    Dim SubjectTxt As String\n    Dim MsgTxt As String\n\n    Set Session = CreateObject(\"Notes.NotesSession\")\n    user = Session.UserName\n    usersig = Session.COMMONUSERNAME\n    mailfile = Session.GETENVIRONMENTSTRING(\"MailFile\", True)\n    server = Session.GETENVIRONMENTSTRING(\"MailServer\", True)\n\n    Set db = Session.GETDATABASE(server, mailfile)\n\n    If Not db.IsOpen Then\n        db.Open vbNullString, vbNullString\n        Exit Sub\n    End If\n\n    Set NotesDoc = db.CREATEDOCUMENT\n\n    With NotesDoc\n        .Form = \"Memo\"\n        .Subject = SUBJ                          'The subject line in the email\n        .Principal = user\n        .sendto = TOID                           'e-mail ID variable to identify whom email need to be sent\n        .CopyTo = CCID\n    End With\n\n    Set RichTextBody = NotesDoc.CREATERICHTEXTITEM(\"Body\")\n\n    With NotesDoc\n        .COMPUTEWITHFORM False, False\n    End With\n\n    '==Now set the front end stuff\n    Set ws = CreateObject(\"Notes.NotesUIWorkspace\")\n\n    If Not ws Is Nothing Then\n\n        Set uidoc = ws.EDITDOCUMENT(True, NotesDoc)\n\n        If Not uidoc Is Nothing Then\n\n            If uidoc.EDITMODE Then\n\n                'Mail Body\n                With ws2.Range(\"C7\")\n                    Dim rnBody1 As Range\n                    Set rnBody1 = .Value2\n                    rnBody1.CopyPicture\n\n                'rnBody1.Copy\n                    uidoc.GOTOFIELD \"Body\"\n                    uidoc.Paste\n                End With\n\n            End If\n\n        End If\n\n    End If\n\n    uidoc.Send\n    uidoc.Close\n\n    'removed garbage collection\n\n    ws2.Activate ' swopped out .Select and used Worksheets collection held in variable ws2\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1509595137, "creation_date": 1509595137, "answer_id": 47067373, "question_id": 47049787, "link": "https://stackoverflow.com/questions/47049787/need-help-in-loop-function-in-vba-to-send-multiple-emails/47067373#47067373", "title": "Need help in loop function in vba to send multiple emails", "body": "<p>You may want to consider this.</p>\n\n<pre><code>In column A : Names of the people\nIn column B : E-mail addresses\nIn column C:Z : Filenames like this C:\\Data\\Book2.xls (don't have to be Excel files)\n</code></pre>\n\n<p>The Macro will loop through each row in \"Sheet1\" and if there is a E-mail address in column B\nand file name(s) in column C:Z it will create a mail with this information and send it.</p>\n\n<pre><code>Sub Send_Files()\n'Working in Excel 2000-2016\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim sh As Worksheet\n    Dim cell As Range\n    Dim FileCell As Range\n    Dim rng As Range\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set sh = Sheets(\"Sheet1\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    For Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n\n        'Enter the path/file names in the C:Z column in each row\n        Set rng = sh.Cells(cell.Row, 1).Range(\"C1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n           Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            Set OutMail = OutApp.CreateItem(0)\n\n            With OutMail\n                .to = cell.Value\n                .Subject = \"Testfile\"\n                .Body = \"Hi \" &amp; cell.Offset(0, -1).Value\n\n                For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                    If Trim(FileCell) &lt;&gt; \"\" Then\n                        If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                            .Attachments.Add FileCell.Value\n                        End If\n                    End If\n                Next FileCell\n\n                .Send  'Or use .Display\n            End With\n\n            Set OutMail = Nothing\n        End If\n    Next cell\n\n    Set OutApp = Nothing\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>See this link for all details.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/amail6.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/amail6.htm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8866504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99a1311636b08cc28dbc21bdbad8928?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/8866504/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1398, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1509595137, "creation_date": 1509519776, "last_edit_date": 1509521094, "question_id": 47049787, "link": "https://stackoverflow.com/questions/47049787/need-help-in-loop-function-in-vba-to-send-multiple-emails", "title": "Need help in loop function in vba to send multiple emails", "body": "<p>I have a Excel VBA (Send_Mail) to send emails thru Lotus Notes. It is working fine, however I need help in sending individual email to multiple people in one go.</p>\n\n<p>In my excel sheet. Cell A7 downwards will be the email addresses that can go upto 200+ rows, B7 has the subject Line and Cell C7 has the body of email. (all of this is getting auto populated with a different macro). However my code (Send_Mail) is just sending one email to the address which is in cell A7. I need your help in sending mail to all the email address that are in Col A7 onwards with its respective subject (Col B) and mail body (col C)</p>\n\n<p>Below is my code.</p>\n\n<pre><code>Public TOID As String\nPublic CCID As String\nPublic SECT As String\nPublic ACCO As String\nPublic SUBJ As String\n\nSub Send_Mail()\n\nDim answer As Integer\n\nanswer = MsgBox(\"DO YOU HAVE LOTUS NOTES OPEN ??  Not WebLotus notes\", vbYesNo + vbQuestion, \"LOTUS NOTES\")\n\nIf answer = vbNo Then\n    MsgBox \"Please Open Notes and Try the Macro Again\"\n    Exit Sub\n\nElse\n\nEnd If\n\nApplication.DisplayAlerts = False\n\nCall Send\n\nMsgBox \"Mail Sent to \" &amp; (Range(\"L2\").Value) &amp; \" \" &amp; \"Recipents\"\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n\nPublic Function Send()\n\n    SendEMail = True\n\n    Sheets(\"Main\").Select\n\n    TOID = Range(\"A7\").Value\n    CCID = \"\"\n    SUBJ = Range(\"B7\").Value\n    'On Error GoTo ErrorMsg\n\n    Dim EmailList As Variant\n    Dim ws, uidoc, Session, db, uidb, NotesAttach, NotesDoc, objShell As Object\n    Dim RichTextBody, RichTextAttachment As Object\n    Dim server, mailfile, user, usersig As String\n    Dim SubjectTxt, MsgTxt As String\n\n    Set Session = CreateObject(\"Notes.NotesSession\")\n    user = Session.UserName\n    usersig = Session.COMMONUSERNAME\n    mailfile = Session.GETENVIRONMENTSTRING(\"MailFile\", True)\n    server = Session.GETENVIRONMENTSTRING(\"MailServer\", True)\n\n    Set db = Session.GETDATABASE(server, mailfile)\n\n    If Not db.IsOpen Then\n        Call db.Open(\"\", \"\")\n        Exit Function\n    End If\n\n    Set NotesDoc = db.CREATEDOCUMENT\n\n    With NotesDoc\n        .Form = \"Memo\"\n        .Subject = SUBJ                          'The subject line in the email\n        .Principal = user\n        .sendto = TOID                           'e-mail ID variable to identify whom email need to be sent\n        .CopyTo = CCID\n    End With\n\n    Set RichTextBody = NotesDoc.CREATERICHTEXTITEM(\"Body\")\n\n    With NotesDoc\n        .COMPUTEWITHFORM False, False\n    End With\n\n    '==Now set the front end stuff\n    Set ws = CreateObject(\"Notes.NotesUIWorkspace\")\n\n    If Not ws Is Nothing Then\n\n        Set uidoc = ws.EDITDOCUMENT(True, NotesDoc)\n\n        If Not uidoc Is Nothing Then\n\n            If uidoc.EDITMODE Then\n\n                'Mail Body\n                Sheets(\"Main\").Select\n                Range(\"C7\").Select\n                Dim rnBody1 As Range\n                Set rnBody1 = Selection\n                rnBody1.CopyPicture\n\n                'rnBody1.Copy\n                Call uidoc.GOTOFIELD(\"Body\")\n                Call uidoc.Paste\n            End If\n\n        End If\n\n    End If\n\n    Call uidoc.Send\n    Call uidoc.Close\n\n    'close connection to free memory\n    Set Session = Nothing\n    Set db = Nothing\n    Set NotesAttach = Nothing\n    Set NotesDoc = Nothing\n    Set uidoc = Nothing\n    Set ws = Nothing\n\n    Sheets(\"Main\").Select\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1509523654, "post_id": 47049501, "comment_id": 81048054, "body": "Sweet. Works like a charm. I had to use the regular module code since the other one doesn&#39;t seem to work for me. I already have a worksheet_change module in my code so I just used call function to execute the task. Thanks a lot. Now to repeat this 11 more times..."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1509518627, "last_edit_date": 1509518627, "creation_date": 1509518296, "answer_id": 47049501, "question_id": 47049368, "link": "https://stackoverflow.com/questions/47049368/excel-vba-how-to-create-macro-to-change-text-color-using-if-statement/47049501#47049501", "title": "Excel VBA: How to create macro to change text color using if statement", "body": "<p>You are after something like the code below.</p>\n\n<p>This code is to be ran once, it will lopp through the entire column \"F\" in your worksheet, and change the font of all instances.</p>\n\n<p><strong>Regular Module Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub change_color()\n\nDim LastRow As Long, i As Long\n\nWith Worksheets(\"Sheet1\") ' modify to your sheet's name\n    LastRow = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n\n    For i = 1 To LastRow \n        If .Range(\"F\" &amp; i).Value &lt; .Range(\"O\" &amp; i).Value Then\n            .Range(\"F\" &amp; i).Font.Color = vbRed\n        Else\n            .Range(\"F\" &amp; i).Font.Color = vbBlack\n        End If\n    Next i        \nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To \"<strong>catch</strong>\" the modification in real-time, when someone changes a value in column \"F\", and then change the font according to the criteria you specified, you need add the following code to the Worksheet module, where you have your data, and add the piece of code below to <code>Worksheet_Change</code> event.</p>\n\n<p><strong>Code in <em>Sheet1</em> module</strong> (modify to your sheet's)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 6 Then ' if someone changes a value in column \"F\"\n    Application.EnableEvents = False\n\n    If Target.Value &lt; Range(\"O\" &amp; Target.Row).Value Then\n        Target.Font.Color = vbRed\n    Else\n        Target.Font.Color = vbBlack\n    End If\n\nEnd If\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509518705, "post_id": 47049530, "comment_id": 81046066, "body": "there is no use of <code>Me</code> inside a worksheet module, it automaticaly refers to that worksheet as <code>ActiveSheet</code>, you can remove the <code>With Me</code> and it work the same"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1509519614, "post_id": 47049530, "comment_id": 81046417, "body": "Written on mobile, untested. I did not get rid of the With, only changed the object it returns, so I think all the . should be fine."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509519629, "post_id": 47049530, "comment_id": 81046425, "body": "Where is it you think the <code>.</code> prefix is wrongfully placed here? I see no obvious errors here? @ShaiRado"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1509519706, "post_id": 47049530, "comment_id": 81046459, "body": "@eirikdaude you&#39;re right, comment removed,  I missed the line he replaced of <code>With thisworkbook.worksheets(YOURSHEETNAME)</code>"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1509518894, "last_edit_date": 1509518894, "creation_date": 1509518523, "answer_id": 47049530, "question_id": 47049368, "link": "https://stackoverflow.com/questions/47049368/excel-vba-how-to-create-macro-to-change-text-color-using-if-statement/47049530#47049530", "title": "Excel VBA: How to create macro to change text color using if statement", "body": "<p>Does this work for you?</p>\n\n<pre><code>Option explicit\nSub ChangeColor()\n\nWith thisworkbook.worksheets(YOURSHEETNAME) 'Replace with sheet name as per your workbook.'\n\nDim LastRow as long\nLastrow = .cells(.rows.count,\"F\").end(xlup).row\n\nDim RowIndex as long\n\nFor rowindex = 9 to LastRow\n\nIf .cells(rowindex,\"F\").value2 &lt; .cells(rowindex,\"O\").value2 then\n.cells(rowindex,\"F\").font.color = vbred\nEnd if\n\nNext rowindex\n\nEnd With \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4877, "favorite_count": 0, "accepted_answer_id": 47049501, "answer_count": 2, "score": 0, "last_activity_date": 1509521171, "creation_date": 1509517704, "last_edit_date": 1509521171, "question_id": 47049368, "link": "https://stackoverflow.com/questions/47049368/excel-vba-how-to-create-macro-to-change-text-color-using-if-statement", "title": "Excel VBA: How to create macro to change text color using if statement", "body": "<p>This is a continuation for the following question: <a href=\"https://stackoverflow.com/questions/46947216/what-is-the-cause-for-conditional-formatting-to-get-jumbled-up\">What is the cause for Conditional Formatting to get jumbled up?</a></p>\n\n<p>In an attempt to prevent my conditional formatting from going haywire, I decided to convert it into code in VBA. I decided to start small and start with converting one conditional formatting into VBA.</p>\n\n<p>Explanation:</p>\n\n<p>In column O there are a series of numbers, obtained from a different sheet. User inputs number in column F. For example if number in F9 is less than O9, the font colour will become red. If not number remains normal. The formula should start at row 9 and can continue down onwards and should be automatic.\nMeaning the moment a number is keyed in column F the font colour should change instantly.</p>\n\n<p>The following is the code I created so far:</p>\n\n<pre><code>Sub change_color()\n\nWith Me.Range(\"f9\", Range(\"f\" &amp; Rows.Count).End(xlUp)) 'so the formula will carry onwards from f9 onwards\n    If f9 &lt; o9 Then\n        Range(f).Font.Color = vbRed\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>But alas it didn't work. I also tried linking it to a button and nothing happens. And I also remember to remove my old conditional formatting as well. Is there something I'm missing?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1509516364, "creation_date": 1509516364, "answer_id": 47049132, "question_id": 47048824, "link": "https://stackoverflow.com/questions/47048824/vba-code-to-search-for-0-in-all-the-cells-of-particular-column-if-found-then-del/47049132#47049132", "title": "vba code to search for 0 in all the cells of particular column if found then delete that row", "body": "<p>You should work from the bottom up:</p>\n\n<pre><code>lRow = Cells(Rows.Count, \"AI\").End(xlUp).Row\nFor iCntr = lRow To 1 Step -1\nIf Cells(iCntr, 35) = 0 Then\nRows(iCntr).Delete\nEnd If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509519477, "post_id": 47049217, "comment_id": 81046357, "body": "Nice wokring with the <code>AutoFilter</code> :)"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509534363, "post_id": 47049217, "comment_id": 81053674, "body": "@ShaiRado Thanks. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1509516858, "creation_date": 1509516858, "answer_id": 47049217, "question_id": 47048824, "link": "https://stackoverflow.com/questions/47048824/vba-code-to-search-for-0-in-all-the-cells-of-particular-column-if-found-then-del/47049217#47049217", "title": "vba code to search for 0 in all the cells of particular column if found then delete that row", "body": "<p>To delete the desired rows, you don't need to loop through the rows.</p>\n\n<p>You may use autofilter to delete all the rows at once.</p>\n\n<p>Give this a try...</p>\n\n<pre><code>Sub DeleteRows()\nDim lRow As Long\nApplication.ScreenUpdating = False\nlRow = Cells(Rows.Count, \"AI\").End(xlUp).Row\nActiveSheet.AutoFilterMode = False\nWith Range(\"AI1:AI\" &amp; lRow)\n    .AutoFilter field:=1, Criteria1:=0\n    If .SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n        Range(\"AI2:AI\" &amp; lRow).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End If\n    .AutoFilter\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1509519217, "creation_date": 1509519217, "answer_id": 47049667, "question_id": 47048824, "link": "https://stackoverflow.com/questions/47048824/vba-code-to-search-for-0-in-all-the-cells-of-particular-column-if-found-then-del/47049667#47049667", "title": "vba code to search for 0 in all the cells of particular column if found then delete that row", "body": "<p>@Tim Williams answer would solve your problem, it will take you a long time to process it if you are trying to delete a lot of rows.</p>\n\n<p>A faster solution will be to use <code>DelRng</code> object, which every time you iterate, and the criteria is met, you add that row to <code>DelRng</code> with <code>Union</code> function.\nAt the end, you delete all of the rows at once.</p>\n\n<p>Try the code below:</p>\n\n<pre><code>Dim DelRng As Range\n\nWith Sheets(\"Sheet1\") ' modify to your sheet's name (allways qualify with the worksheet object)\n\n    lRow = .Cells(.Rows.Count, \"AI\").End(xlUp).Row\n\n    For iCntr = 1 To lRow\n        If .Cells(iCntr, 35) = 0 Then\n            If Not DelRng Is Nothing Then\n                Set DelRng = Application.Union(DelRng, .Rows(iCntr))\n            Else\n                Set DelRng = .Rows(iCntr)\n            End If\n        End If\n    Next\n\n    ' delete the entire rows at once &gt;&gt; will save you a lot of time\n    DelRng.Delete\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47049667, "answer_count": 3, "score": 0, "last_activity_date": 1509519877, "creation_date": 1509514663, "last_edit_date": 1509519877, "question_id": 47048824, "link": "https://stackoverflow.com/questions/47048824/vba-code-to-search-for-0-in-all-the-cells-of-particular-column-if-found-then-del", "title": "vba code to search for 0 in all the cells of particular column if found then delete that row", "body": "<pre><code>lRow = Cells(Rows.Count, \"AI\").End(xlUp).Row\nFor iCntr = 1 To lRow\n    If Cells(iCntr, 35) = 0 Then\n        Rows(iCntr).Delete\n    End If\nNext\n</code></pre>\n\n<p>The above-mentioned code is not showing any error but not deleting the entire rows in which Column(\"AI\") cells are 0. Kindly help me with the correct version of the code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509515256, "post_id": 47048715, "comment_id": 81044841, "body": "Why do you copy stuff from column U of &quot;Sheet1&quot; to column A of &quot;Sheet2&quot; and then remove duplicates from column U of &quot;Sheet2&quot;.  Was that column populated prior to running the macro, or is that a typo?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509515392, "post_id": 47048715, "comment_id": 81044886, "body": "You have unqualified <code>Range</code> references (i.e. ones which do not include which sheet they refer to, such as <code>Range(&quot;U1:U4000&quot;)</code>).  Those references will default to the <b>active</b> worksheet.  Are you sure you don&#39;t want to use, for instance, <code>rsheet.Range(&quot;U1:U4000&quot;)</code>?  (You are using qualified references in the first half of the code, so it seems like you know what qualifying references is about, so I&#39;m unsure of whether that is deliberate or not.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509515596, "post_id": 47048715, "comment_id": 81044964, "body": "@YowE3K I am not able to understand what u said above"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509515701, "post_id": 47048715, "comment_id": 81044996, "body": "Which comment don&#39;t you understand - my first one or my second one?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509515893, "post_id": 47048715, "comment_id": 81045067, "body": "Second one. Is there any way to change the code"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509516035, "post_id": 47048715, "comment_id": 81045122, "body": "My <b>guess</b> (and only you can know for sure) is that you want the second half of that code to be referring to ranges on the worksheet you are referring to as <code>rsheet</code>.  (I&#39;m guessing that because you created the reference to the worksheet but never use it.)  So my <b>guess</b> is that you want to use <code>rsheet.Range(&quot;U1:U4000&quot;)</code>, etc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509516254, "post_id": 47048715, "comment_id": 81045183, "body": "@YowE3K Firstly I want to shift my data from sheet1 to sheet2 so i used that range. Secondly I want to convert that into Lcase form"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509517064, "post_id": 47048715, "comment_id": 81045447, "body": "@YowE3K thanks for mentioning the range. I just changed the range and its working"}], "owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509517108, "creation_date": 1509513830, "last_edit_date": 1531164843, "question_id": 47048715, "link": "https://stackoverflow.com/questions/47048715/how-do-i-run-2-operations-at-a-same-click", "title": "How do I run 2 operations at a same click", "body": "<p>I have 2 functions 1. For Shifting columns in next sheet. 2. Convert them in lower case. I want to run this both at a same time on clicking. So i put them in same Sub(Sub Shift_LCase()) but this not not working only shifting is done but the data is not able to convert. </p>\n\n<pre><code>Sub Shift_LCase()\n\n Dim s1 As Worksheet, s2 As Worksheet\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Sheet2\")\n    s1.Range(\"U:U\").copy s2.Range(\"A1\")\n    s2.Range(\"U:U\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    s1.Range(\"AR:AR\").copy s2.Range(\"B1\")\n    s2.Range(\"AR:AR\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    s1.Range(\"BF:BF\").copy s2.Range(\"C1\")\n    s2.Range(\"BF:BF\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n\n       Dim x As Range\n       Dim rsheet As Worksheet\n       Set rsheet = ActiveWorkbook.Sheets(2)\n   ' Loop to cycle through each cell in the specified range.\n   For Each x In Range(\"A1:A4000\")\n      x.Value = LCase(x.Value)\n   Next\n\n   For Each x In Range(\"B1:B4000\")\n      x.Value = LCase(x.Value)\n   Next\n\n   For Each x In Range(\"C1:C4000\")\n      x.Value = LCase(x.Value)\n   Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1509509258, "post_id": 47047924, "comment_id": 81043281, "body": "you could cut down the full column references and change the volatile indirect to a non-volatile index. sample data with expected results needed to assist further."}, {"owner": {"reputation": 127, "user_id": 8268783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a48716911ce4443957611c6f13e84d7?s=128&d=identicon&r=PG&f=1", "display_name": "Faheera", "link": "https://stackoverflow.com/users/8268783/faheera"}, "edited": false, "score": 0, "creation_date": 1509510254, "post_id": 47047924, "comment_id": 81043489, "body": "Hi Jeeped, I have added the dummy file in the question. Thanks for the reply."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1509529665, "post_id": 47047924, "comment_id": 81050982, "body": "Did you replace the <code>INDIRECT</code> with <code>INDEX</code>?  Indirect has a big overhead because they are recalculated every time recalculation is triggered - even if they don&#39;t need to be."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1509590198, "post_id": 47047924, "comment_id": 81081500, "body": "I&#39;ve done some speed testing and I am approaching an answer but I am still unclear on why you use the column BJ and AJ in the same function. Also why is column A absolute (e.g. $A) and column AJ/BJ is relative (AJ/BJ can be filled right for AK/BK, etc). I&#39;m also unclear why you would post &#39;sample data&#39; complete with (limited) narrative that does not correspond with your question&#39;s narrative."}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 1, "last_activity_date": 1509517072, "creation_date": 1509517072, "answer_id": 47049248, "question_id": 47047924, "link": "https://stackoverflow.com/questions/47047924/excel-formula-slows-down-excel-spreadsheet/47049248#47049248", "title": "Excel formula slows down Excel spreadsheet", "body": "<p>The reason excel is crashing is because:</p>\n\n<pre><code>INDEX('Current Month'!$A:BJ\n</code></pre>\n\n<p>That would be an array of over 65 million cells.</p>\n\n<p>Name your array, only the rows needed, and use that instead of <code>'Current Month'!$A:BJ</code>.  I didn't examine the rest of your formula, but this is where I would start.  Same goes for the rest of your arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 8268783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a48716911ce4443957611c6f13e84d7?s=128&d=identicon&r=PG&f=1", "display_name": "Faheera", "link": "https://stackoverflow.com/users/8268783/faheera"}, "edited": false, "score": 0, "creation_date": 1509520466, "post_id": 47049826, "comment_id": 81046758, "body": "Hi,     Thanks for the reply. The column letter is not fixed, it is different for each dataset thus i want it to find for the column header name and use the column. The formula you provided has like specified column letters for eg. D1:D32 = POSITIVE"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 127, "user_id": 8268783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a48716911ce4443957611c6f13e84d7?s=128&d=identicon&r=PG&f=1", "display_name": "Faheera", "link": "https://stackoverflow.com/users/8268783/faheera"}, "edited": false, "score": 0, "creation_date": 1509521839, "post_id": 47049826, "comment_id": 81047319, "body": "@Faheera Edited the formula to substitute the dynamic columns."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": true, "score": 0, "last_activity_date": 1509523786, "last_edit_date": 1509523786, "creation_date": 1509519951, "answer_id": 47049826, "question_id": 47047924, "link": "https://stackoverflow.com/questions/47047924/excel-formula-slows-down-excel-spreadsheet/47049826#47049826", "title": "Excel formula slows down Excel spreadsheet", "body": "<p>You need to restrict the array in your formula.</p>\n\n<pre><code>=SUMPRODUCT(SUBTOTAL(3,OFFSET('Current Month'!A1:A32,ROW('Current Month'!A1:A32)-MIN(ROW('Current Month'!A1:A32)),,1))*--(INDEX('Current Month'!$A1:BJ32,0,MATCH(\"Subject Name\",'Current Month'!$A$1:$BJ$1,0))=\"Pampers\")*--(INDEX('Current Month'!$A1:BJ32,0,MATCH(\"Dryness + Absorbency\",'Current Month'!$A$1:$AJ$1,0))=\"POSITIVE\"))\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8268783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a48716911ce4443957611c6f13e84d7?s=128&d=identicon&r=PG&f=1", "display_name": "Faheera", "link": "https://stackoverflow.com/users/8268783/faheera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 47049826, "answer_count": 2, "score": 1, "last_activity_date": 1509590302, "creation_date": 1509507996, "last_edit_date": 1531161705, "question_id": 47047924, "link": "https://stackoverflow.com/questions/47047924/excel-formula-slows-down-excel-spreadsheet", "title": "Excel formula slows down Excel spreadsheet", "body": "<p>I have been applying this formula in my Excel spreadsheet but when I enter this formula in multiple cells, my Excel calculating processor slows down and eventually crashes. Is there any way to make this formula work faster?</p>\n\n<p><strong>Purpose of formula: To count filtered data with 2 conditions (Y being positive and subject name being X) applied within the formula.</strong> </p>\n\n<p>Multiple cells as what I mean is that Dryness + absorbency is one of the fields. There are about few fields for different brands ( Brand A , Brand B , Brand C)</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>=SUMPRODUCT(\n--(INDEX('Current Month'!$A:BJ,0,MATCH(\"Subject Name\",'Current Month'!$A$1:$BJ$1,0))=\"Pampers\"),\n--(INDEX('Current Month'!$A:BJ,0,MATCH(\"Dryness + Absorbency\",'Current Month'!$A$1:$AJ$1,0))=\"POSITIVE\"),\n--(IF(SUBTOTAL(103,INDIRECT(\"'Current Month'!$A\"&amp;ROW(A:A)&amp;\":$A\"&amp;ROW(A:A))),1,0)=1)\n)\n</code></pre>\n\n<p>Hope someone can help as I have tried multiple times and my Excel keeps crashing. Thank you.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509503746, "post_id": 47047331, "comment_id": 81041992, "body": "You could use an Excel formula making use of the <code>SUBSTITUTE</code> function, or you could use VBA making use of the VBA <code>Replace</code> function.  (You would have to use each one 5 times, although in VBA that could be done in a loop if you wanted to.)"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1509507374, "creation_date": 1509507374, "answer_id": 47047839, "question_id": 47047331, "link": "https://stackoverflow.com/questions/47047331/excel-vba-exclusion-words/47047839#47047839", "title": "Excel VBA Exclusion Words", "body": "<p>Taking your code and putting it into a loop:</p>\n\n<pre><code>Sub test()\n    Dim Exclusions As Variant\n    Dim CorrectedText As String \n    Dim r As Long\n    Dim i As Long\n    'Get all the \"exclusions\" from column A\n    Exclusions = Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp)).Value\n    'Loop through all the cells in column C\n    For r = 2 To Cells(Rows.Count, \"C\").End(xlUp).Row\n        'Start with the current value\n        CorrectedText = Cells(r, \"C\").Value \n        'Remove, one word at a time, any words that are excluded\n        For i = LBound(Exclusions, 1) To UBound(Exclusions, 1)\n            CorrectedText = Replace(CorrectedText, Exclusions(i, 1), \"\") \n        Next\n        'Put whatever is left in column D\n        Cells(r, \"D\").Value = CorrectedText \n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 1343479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd8fa60e533528e4bba8d72eab3e7a9?s=128&d=identicon&r=PG", "display_name": "Sean Foo", "link": "https://stackoverflow.com/users/1343479/sean-foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 47047839, "answer_count": 1, "score": 0, "last_activity_date": 1509507374, "creation_date": 1509503404, "last_edit_date": 1531161705, "question_id": 47047331, "link": "https://stackoverflow.com/questions/47047331/excel-vba-exclusion-words", "title": "Excel VBA Exclusion Words", "body": "<p>I have some exclusion words namely: Limited, Corporation, Incorporation, Inc, Ltd and Co in cells A2 to A6 respectively. </p>\n\n<p>In column B, it will be the input value of namely: ABC Limited, XYZ Holdings Corporation Limited and Tesco Bee Co Ltd in cells B2 to B4 respectively.</p>\n\n<p>In column C, it will display the results of B with the exclusion of any or all words from column A. It should show results of ABC, XYZ Holdings and Tesco Bee respectively. </p>\n\n<p>Will there be any formula or macros that will be able to solve this issue?</p>\n\n<p>I have attached a link to sample of what I am trying to illustrate. </p>\n\n<p><a href=\"https://i.stack.imgur.com/7PScq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7PScq.jpg\" alt=\"Screenshot here\"></a></p>\n\n<p>I have tried this code: </p>\n\n<pre><code>Sub test()\n    Dim OriginalText As String\n    Dim CorrectedText As String \n    OriginalText = Range(\"C4\").Value \n    CorrectedText = Replace(OriginalText, \"Limited\", \"\") \n    Range(\"C4\").Offset(, 1).Value = CorrectedText \nEnd Sub\n</code></pre>\n\n<p>However, I do not know how to incorporate all exclusion words in it, currently I managed to exclude \"Limited\" only.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509503111, "post_id": 47047176, "comment_id": 81041805, "body": "why do you need to <code>highlight the column A in &quot;Sheet2,&quot;</code>  ?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509517536, "post_id": 47047176, "comment_id": 81045598, "body": "question for the OP"}, {"owner": {"reputation": 69, "user_id": 5166241, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10153163491228978/picture?type=large", "display_name": "Javier Ng", "link": "https://stackoverflow.com/users/5166241/javier-ng"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509586640, "post_id": 47047176, "comment_id": 81080675, "body": "@jsotola I think I used a wrong choice of word. It should be &quot;select.&quot; The reason for that is the cells I am selecting contains the strings I want to do the cross check with"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1509502187, "creation_date": 1509502187, "answer_id": 47047176, "question_id": 47047130, "link": "https://stackoverflow.com/questions/47047130/inserting-range-into-array-in-vba-for-iteration/47047176#47047176", "title": "Inserting Range into Array in VBA for iteration", "body": "<p><code>MyArr = Rng</code> is setting <code>MyArr</code> to be a two-dimensional array where the first rank corresponds to the rows in <code>Rng</code> and the second rank corresponds to the columns in <code>Rng</code>.</p>\n\n<p>Assuming you only have one column in <code>Rng</code>, then your <code>Find</code> statement should refer to the values in that first column using <code>MyArr(I, 1)</code>, i.e. </p>\n\n<pre><code>    Set Rng = .Find(What:=MyArr(I, 1), _\n                    After:=.Cells(.Cells.Count), _\n                    LookIn:=xlFormulas, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False)\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5166241, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10153163491228978/picture?type=large", "display_name": "Javier Ng", "link": "https://stackoverflow.com/users/5166241/javier-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 47047176, "answer_count": 1, "score": 0, "last_activity_date": 1509502187, "creation_date": 1509501677, "question_id": 47047130, "link": "https://stackoverflow.com/questions/47047130/inserting-range-into-array-in-vba-for-iteration", "title": "Inserting Range into Array in VBA for iteration", "body": "<p>I am facing some issues with VBA. Let me explain what I am trying to achieve. I have 2 sheets in 1 workbook. They are labelled \"Sheet1\" and \"Sheet2.\"</p>\n\n<p>In \"Sheet1,\" there are 100 rows and 100 columns. In column A, it is filled with eg: SUBJ001 all the way to SUBJ100. In \"Sheet2,\" there is only 1 Column A, with  a range of rows. Eg: \"SUBJ003, SUBJ033, SUBJ45.\" What I am trying to achieve is to use my mouse, highlight the column A in \"Sheet2,\" and compare each individual cell with the cells in column A. Should there be a match, it will copy the entire row and paste them in a new sheet that the macro creates in the same workbook. However, i am experiencing an out of range error at Set Rng =.Find(What:=Arr(I), ... Thanks! </p>\n\n<pre><code>Sub Copy_To_Another_Sheet_1()\nDim FirstAddress As String\nDim MyArr As Variant\nDim Rng As Range\nDim Rcount As Long\nDim I As Long\nDim NewSh As Worksheet\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet Rng = Application.InputBox(\"Select target range with the mouse\", Type:=8)\n\nMyArr = Rng\n\nSet NewSh = Worksheets.Add\n\nWith Sheets(\"Sheet1\").Range(\"A:A\")\n\n    Rcount = 0\n\n    For I = LBound(MyArr) To UBound(MyArr)\n\n        Set Rng = .Find(What:=MyArr(I), _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            FirstAddress = Rng.Address\n            Do\n                Rcount = Rcount + 1\n\n                Rng.EntireRow.Copy NewSh.Range(\"A\" &amp; Rcount)\n\n                ' Use this if you only want to copy the value\n                ' NewSh.Range(\"A\" &amp; Rcount).Value = Rng.Value\n\n                Set Rng = .FindNext(Rng)\n            Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n        End If\n    Next I\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509517912, "post_id": 47046715, "comment_id": 81045734, "body": "It&#39;s good that you added <code>Range(&quot;C3:E3&quot;).Cells</code>, otherwise Excel wouldn&#39;t know how to loop through the <code>Cells</code> ;) JK"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509520689, "post_id": 47046715, "comment_id": 81046844, "body": "@ShaiRado I have gotten into the habit of adding <code>.Cells</code> to stop me from accidentally forgetting to include it when I do something like <code>For Each cel in Rows(&quot;1:10&quot;)</code> (where it defaults to processing a <code>Row</code> at a time instead of a cell at a time).  So there is <b>some</b> method to my madness! :D"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1509497933, "creation_date": 1509497933, "answer_id": 47046715, "question_id": 47046682, "link": "https://stackoverflow.com/questions/47046682/vba-excel-iterate-on-multiple-range/47046715#47046715", "title": "VBA Excel iterate on multiple range", "body": "<p>There is no reason why you should be getting an error in your <code>For Each</code> statement.  (But, then again, I don't understand what you mean by \"if I put two ranges in For Each\".)</p>\n\n<pre><code>Sub test_Click()\n    Dim cel As Range\n    For Each cel in Range(\"C3:E3\").Cells\n        If cel.Value &lt;&gt; cel.Offset(3, 0).Value Then\n            cel.Offset(0, -1).Value = 5\n        End If\n    Next        \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7436, "user_id": 5514476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP6t0.jpg?s=128&g=1", "display_name": "DJK", "link": "https://stackoverflow.com/users/5514476/djk"}, "is_accepted": false, "score": 1, "last_activity_date": 1509582355, "last_edit_date": 1509582355, "creation_date": 1509497934, "answer_id": 47046716, "question_id": 47046682, "link": "https://stackoverflow.com/questions/47046682/vba-excel-iterate-on-multiple-range/47046716#47046716", "title": "VBA Excel iterate on multiple range", "body": "<p>Could be done with the offset command in a for loop</p>\n\n<pre><code>For i = 0 To 3\n    If (Range(\"C3\").Offset(0, i).Value &lt;&gt; Range(\"C6\").Offset(0, i).Value) Then\n        Range(\"B3\").Offset(0, i).Value = 5 \n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 2152, "user_id": 6326739, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8da8de491899a4fddf6cd2435518cc87?s=128&d=identicon&r=PG&f=1", "display_name": "sjishan", "link": "https://stackoverflow.com/users/6326739/sjishan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 47046715, "answer_count": 2, "score": 0, "last_activity_date": 1509582355, "creation_date": 1509497655, "question_id": 47046682, "link": "https://stackoverflow.com/questions/47046682/vba-excel-iterate-on-multiple-range", "title": "VBA Excel iterate on multiple range", "body": "<p>Currently I am writing the code in repittative fashion but I want to now how can I use loop on multiple range to achieve the same outcome. </p>\n\n<p>I am getting error if I put two ranges in For Each.</p>\n\n<pre><code>Sub test_Click()\n\nIf (Range(\"C3\").Value &lt;&gt; Range(\"C6\").Value) Then\n    Range(\"B3\").Value = 5\n\nEnd If\n\nIf (Range(\"D3\").Value &lt;&gt; Range(\"D6\").Value) Then\n    Range(\"C3\").Value = 5\n\nEnd If\n\n\nIf (Range(\"E3\").Value &lt;&gt; Range(\"E6\").Value) Then\n    Range(\"D3\").Value = 5\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ado", "adodb"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1509492902, "post_id": 47045948, "comment_id": 81039396, "body": "Just before calling the command <code>ProcessRS (oRS)</code>, can you try a <code>Debug.Print TypeName(oRS)</code> and tell us what it prints? Also, parameters are passed to <code>Sub</code> routines with brackets only if using the old method <code>Call myMacro(myParameter)</code>. Now it&#39;s rather used <code>myMacro myParameter</code>, try that one too after making sure the type name of the parameter is correctly declared."}, {"owner": {"reputation": 658, "user_id": 2843172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c8ae2f7e942c1deea7da8b4a6a8e254?s=128&d=identicon&r=PG&f=1", "display_name": "Clouse24", "link": "https://stackoverflow.com/users/2843172/clouse24"}, "edited": false, "score": 0, "creation_date": 1509492907, "post_id": 47045948, "comment_id": 81039399, "body": "Did you try using the call keyword  pass the variable? I seem to remember having this issue a while back and that was the solve.  so use Call ProcessRS (oRS)"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 2, "creation_date": 1509492993, "post_id": 47045948, "comment_id": 81039421, "body": "Just remove parentheses <code>ProcessRS oRS</code>. In that case parentheses mean evaluation of expression. You need parentheses for functions call syntax."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1509493319, "post_id": 47045948, "comment_id": 81039494, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42093387/array-argument-must-be-byref\">Array argument must be ByRef</a>.  Although the question is <i>slightly</i> different (giving a compile error), the answer will explain your issue."}, {"owner": {"reputation": 573, "user_id": 2684232, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/39c3075527874812ba31c0b303cfc1f5?s=128&d=identicon&r=PG&f=1", "display_name": "Gang Liang", "link": "https://stackoverflow.com/users/2684232/gang-liang"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1509494361, "post_id": 47045948, "comment_id": 81039761, "body": "@omegastripes thanks, your comment solved my problem. If you can post it below, I will set it as the answer..."}], "owner": {"reputation": 573, "user_id": 2684232, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/39c3075527874812ba31c0b303cfc1f5?s=128&d=identicon&r=PG&f=1", "display_name": "Gang Liang", "link": "https://stackoverflow.com/users/2684232/gang-liang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509492231, "creation_date": 1509492231, "question_id": 47045948, "link": "https://stackoverflow.com/questions/47045948/vba-type-mismatch-how-to-pass-adodb-recordset-object-to-subroutine", "title": "VBA: type mismatch -- how to pass ADODB.Recordset object to subroutine?", "body": "<p>I encountered a type mismatch error when passing a <code>ADODB.Recordset</code> object to a subroutine. See the code nugget below.</p>\n\n<pre><code>Sub CreateRS()\n    Dim oCONN As ADODB.Connection\n    Dim oRS As ADODB.Recordset\n    Dim strSQL As String\n    Dim strConn As String\n\n    strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; ActiveWorkbook.FullName &amp; \";\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0;HDR=Yes;\"\";\"\n    Set oCONN = New ADODB.Connection\n    oCONN.Open strConn\n\n    strSQL = \"SELECT * FROM mytable\"\n    Set oRS = New ADODB.Recordset\n    oRS.Open strSQL, oCONN\n\n    ' type mismatch error for the next statement\n    ProcessRS (oRS)\nEnd Sub\n\nSub ProcessRS(ByRef RS As ADODB.Recordset)\n    ....\nEnd Sub\n</code></pre>\n\n<p>Did quite a bit of searches, yet didn't find a correct answer. Can anyone point out what is the right syntax to use here? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1509492519, "last_edit_date": 1509492519, "creation_date": 1509492158, "answer_id": 47045939, "question_id": 47045839, "link": "https://stackoverflow.com/questions/47045839/write-on-the-next-available-cell-of-a-given-column/47045939#47045939", "title": "Write on the next available cell of a given column", "body": "<p>The object <code>Range</code> offers a method called <code>End</code> that returns the last range on a certain direction.</p>\n\n<pre><code>Range(\"A1\").End(xlDown) '&lt;-- returns the last non-empty range going down from cell A1\nRange(\"A1\").End(xlUp) '&lt;-- same, but going up\nRange(\"A1\").End(xlToRight) '&lt;-- same, but going right\nRange(\"A2\").End(xlToLeft) '&lt;-- same, but going left\n</code></pre>\n\n<p>In your case, hence, you can detect and use the last row of column <code>B</code> like this: </p>\n\n<pre><code>nextRow = y.Sheets(\"Sheet1\").Range(\"B3\").End(xlDown).Row + 1\n</code></pre>\n\n<p><strong>More details</strong>:</p>\n\n<ul>\n<li>The first Range of your column B is the header <code>Range(\"B3\")</code></li>\n<li>You get the last filled range going down with <code>.End(xlDown)</code></li>\n<li>Specifically, you get the <code>Row</code> of that range</li>\n<li>You add <code>+ 1</code> (cause you want the next available row</li>\n<li>You store the row in the variable <code>nextRow</code></li>\n</ul>\n\n<p>... that you can then use like this: </p>\n\n<pre><code>y.Sheets(\"Sheet1\").Range(\"B\" &amp; nextRow ).PasteSpecial\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": false, "score": 0, "last_activity_date": 1509492390, "creation_date": 1509492390, "answer_id": 47045971, "question_id": 47045839, "link": "https://stackoverflow.com/questions/47045839/write-on-the-next-available-cell-of-a-given-column/47045971#47045971", "title": "Write on the next available cell of a given column", "body": "<p>First, you need a variable where you'll store the last used row number:</p>\n\n<pre><code>dim lngRows as long\nlngRows = Cells(Rows.Count, \"D\").End(xlUp).Row\n</code></pre>\n\n<p>Then replace your lines of code where you have <code>.Range(\"B28\")</code> with either <code>.Cells(lngRows+1,2)</code> or <code>.Range(\"B\"&amp;lngRows)</code></p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1556965271, "last_edit_date": 1556965271, "creation_date": 1509505130, "answer_id": 47047564, "question_id": 47045839, "link": "https://stackoverflow.com/questions/47045839/write-on-the-next-available-cell-of-a-given-column/47047564#47047564", "title": "Write on the next available cell of a given column", "body": "<p>Try this</p>\n\n<pre><code>Public Sub foo()\n\n    Dim x As Workbook\n    Dim y As Workbook\n    Dim fromWs As Worksheet\n    Dim toWs As Worksheet\n    Dim Target As Range\n\n    '## Open both workbooks first:\n    Set x = ActiveWorkbook\n    Set y = Workbooks.Open(\"C:\\Users\\hmaggio\\Desktop\\Test Template.xlsx\")\n\n\n    Set fromWs = x.Sheets(\"Sheet1\")\n    Set toWs = y.Sheets(\"Sheet1\")\n\n    With fromWs\n        Set Target = toWs.Range(\"b\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~next row Column B cell\n        Target = .Range(\"c4\") 'Column B\n        If .Range(\"c15\") = \"\" Then\n            Target.Offset(, 2) = \"proposal\" 'Column D\n        Else\n            Target.Offset(, 2) = \"preproposal\"\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1556965271, "creation_date": 1509491551, "last_edit_date": 1509492462, "question_id": 47045839, "link": "https://stackoverflow.com/questions/47045839/write-on-the-next-available-cell-of-a-given-column", "title": "Write on the next available cell of a given column", "body": "<p>I have a somewhat simple macro that I have made but I am rusty as I have not coded in a few years. As simply as I can put it, I Have two different Workbooks. If the workbook I have open has a certain value (or no value), I want it to fill the other workbook(\"Test Template\") with either \"proposal or pre-proposal.\" \nThat has all been easy for me. But since the worksheet adds rows as we input data, I need it to fill those values in the next available row.  </p>\n\n<p>I will attach code but don't worry about the proposal stuff, I just need the range changed from a specific cell into the next available cell in the column. (if d28 is full, put in d29).</p>\n\n<p><a href=\"https://i.stack.imgur.com/O0sOZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O0sOZ.png\" alt=\"Here is a screenshot of code and the two workbooks\"></a></p>\n\n<pre><code>Public Sub foo()\n\nDim x As Workbook\nDim y As Workbook\n\n'## Open both workbooks first:\nSet x = ActiveWorkbook\nSet y = Workbooks.Open(\"C:\\Users\\hmaggio\\Desktop\\Test Template.xlsx\")\n\n\n\n\n'copy Names from x(active):\nx.Sheets(\"Sheet1\").Range(\"C4\").Copy\n\n'paste to y worksheet(template):\ny.Sheets(\"Sheet1\").Range(\"B28\").PasteSpecial\n\n\n\nIf x.Sheets(\"Sheet1\").Range(\"C15\") = \"\" Then\ny.Sheets(\"Sheet1\").Range(\"D28\").Value = \"proposal\"\nElse\n\ny.Sheets(\"Sheet1\").Range(\"D28\").Value = \"preproposal\"\n\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1509548781, "post_id": 47045937, "comment_id": 81062956, "body": "This worked! Thank you. Any idea why Dir is throwing this error?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1509549586, "post_id": 47045937, "comment_id": 81063469, "body": "Because at the end there is no Dir(). You already went through all of them therefore Dir() doesn\u2019t exist."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1517409403, "last_edit_date": 1517409403, "creation_date": 1509492150, "answer_id": 47045937, "question_id": 47045720, "link": "https://stackoverflow.com/questions/47045720/vba-application-defined-error-with-dir/47045937#47045937", "title": "VBA - Application-defined error with Dir()", "body": "<p>Here's a quick fix using some error handling, since your code runs as expected until the end. </p>\n\n<pre><code>Sub test()\n\n    Dim dataIter As Range\n    Dim outputIter As Range\n    Dim fileName As String\n    Dim wkbk As Workbook\n\n    fileName = Dir(path &amp; \"\\\" &amp; \"*.xlsm\")\n    Do While Len(fileName) &gt; 0\n        Set wkbk = Workbooks.Open(path &amp; \"\\\" &amp; fileName)\n        Set dataIter = wkbk.Sheets(1).Range(\"A1\")\n        Do While dataIter.Address &lt;&gt; wkbk.Sheets(1).Range(\"TITLE\").Address\n            If dataIter.Value &lt;&gt; \"\" Then\n                'Extract the data I need\n                Set outputIter = outputIter.Offset(1)\n            End If\n            Set dataIter = dataIter.Offset(1)\n        Loop\n        wkbk.Close False\n        On Error GoTo ErrHandler\n        fileName = Dir() 'Fails here\n        On Error GoTo 0\n    Loop\n\n    ' Any Remaining code\n\n    Exit Sub\nErrHandler:\n    If Err.Number = 1004 Then\n        fileName = vbNullString\n        Err.Clear\n        Resume Next\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 47045937, "answer_count": 1, "score": 1, "last_activity_date": 1517409403, "creation_date": 1509490708, "last_edit_date": 1531164843, "question_id": 47045720, "link": "https://stackoverflow.com/questions/47045720/vba-application-defined-error-with-dir", "title": "VBA - Application-defined error with Dir()", "body": "<p>I'm having issues with the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dir-function\" rel=\"nofollow noreferrer\">Dir()</a> function in Excel VBA. When I run the below code, the code repeats as expected until there are no more files that match my condition. Once the <code>Dir()</code> call should run out of files to return I get a <code>Run-time error '1004': Application-defined or object-defined</code> error. I've tried all the other answers I could find that even remotely seemed like they applied to my situation.</p>\n\n<pre><code>Dim dataIter As Range\nDim outputIter As Range\nDim fileName As String\nDim wkbk As Workbook\n\nfileName = Dir(path &amp; \"\\\" &amp; \"*.xlsm\")\nDo While Len(fileName) &gt; 0\n    Set wkbk = Workbooks.Open(path &amp; \"\\\" &amp; fileName)\n    Set dataIter = wkbk.Sheets(1).Range(\"A1\")\n    Do While dataIter.Address &lt;&gt; wkbk.Sheets(1).Range(\"TITLE\").Address\n        If dataIter.Value &lt;&gt; \"\" Then\n            'Extract the data I need\n            Set outputIter = outputIter.Offset(1)\n        End If\n        Set dataIter = dataIter.Offset(1)\n    Loop\n    wkbk.Close False\n    fileName = Dir() 'Fails here\nLoop\n</code></pre>\n\n<p>Valid assumptions:</p>\n\n<ol>\n<li>All needed sheets are the first in each workbook</li>\n<li>All sheets have a properly placed \"TITLE\" named range</li>\n</ol>\n\n<p>What could be causing this and what can I do to fix this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1509491563, "post_id": 47045751, "comment_id": 81039027, "body": "Thanks for the help, I tried using that code, I am not sure what the formula does and when I run it, it just comes up with the RC[-1]. It seems like maybe I am missing something? What I need is for that part that says RC[-1] to be replaced with the info I have in the C column"}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1509490941, "creation_date": 1509490941, "answer_id": 47045751, "question_id": 47045652, "link": "https://stackoverflow.com/questions/47045652/ranges-in-vba-excel/47045751#47045751", "title": "Ranges in VBA excel", "body": "<p>Looping is overkill.  By putting the value into a variable you are fixing it per cell.  This is inefficient for your purposes.</p>\n\n<pre><code>Sub CallOtherWB()\n\n  Range(\"D4:D50\").FormulaR1C1= \"='Y:\\Public\\QA Other\\Scorecards\\Copy of Scorecard v0.6 \"\" &amp; RC[-1] &amp; \"\".xlsm'!Total\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1509491255, "post_id": 47045774, "comment_id": 81038948, "body": "The problem with using the INDIRECT function is that the excel needs to be open for it to work. So I choose to look at VBA in order to be able to get it from closed excels since we will continue creating the documents and just change that one number in the file name"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1509552326, "post_id": 47045774, "comment_id": 81065329, "body": "What about the &quot;RefreshAll&quot; functionality?"}, {"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1509566156, "post_id": 47045774, "comment_id": 81073408, "body": "It would still give the #REF error unless the other excel workbooks were open."}], "tags": [], "owner": {"reputation": 481, "user_id": 1115629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b3a13a479608b2a99dcb65d331df69?s=128&d=identicon&r=PG", "display_name": "maciek", "link": "https://stackoverflow.com/users/1115629/maciek"}, "is_accepted": false, "score": 0, "last_activity_date": 1509491122, "creation_date": 1509491122, "answer_id": 47045774, "question_id": 47045652, "link": "https://stackoverflow.com/questions/47045652/ranges-in-vba-excel/47045774#47045774", "title": "Ranges in VBA excel", "body": "<p>I believe a path is not correct, it should be like this (please see where are <code>'</code> characters and exclamation mark):</p>\n\n<p><code>='C:\\path_to_directory\\[file_name.xlsx]sheet_name'!A1</code></p>\n\n<p>What you want to achieve can be done without VBA. Please have a look at <a href=\"https://support.office.com/en-us/article/INDIRECT-function-474b3a3a-8a26-4f44-b491-92b6306fa261\" rel=\"nofollow noreferrer\">INDIRECT</a> function. You'll need to enter following formula in your <code>D4</code> cell:</p>\n\n<p><code>=INDIRECT(\"'Y:\\Public\\QA Other\\Scorecards\\[Copy of Scorecard v0.6 \" &amp; C4 &amp; \".xlsm]Total'!A1\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "edited": false, "score": 0, "creation_date": 1509498326, "post_id": 47046757, "comment_id": 81040714, "body": "Just so that you know, I have tested it with the source file closed and it worked perfect. :-)"}, {"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1509547512, "post_id": 47046757, "comment_id": 81062150, "body": "I understand what this code does and I appreciate the help. However I am trying to get the information that I enter in the C column of the master workbook to replace the job number part of the path which is in the D column of the master workbook. The cell is it referencing(Total) has a number which I need to use in the master book and i need it to be updated as we work in the other workbooks. This seems to help me update all the D column but with the same value in C4 when I need it to update as C5 to D5, C6 to D6 and so on."}, {"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "reply_to_user": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1509577483, "post_id": 47046757, "comment_id": 81078236, "body": "@Josh, Have a look at the modified code, it now iterates through the C column from rows 4 to 50. If this is what you needed, please accept my answer"}], "tags": [], "owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "is_accepted": true, "score": 0, "last_activity_date": 1509577374, "last_edit_date": 1509577374, "creation_date": 1509498224, "answer_id": 47046757, "question_id": 47045652, "link": "https://stackoverflow.com/questions/47045652/ranges-in-vba-excel/47046757#47046757", "title": "Ranges in VBA excel", "body": "<p>The below code worked for me. </p>\n\n<pre><code>Sub CallOtherWB()\n\nDim JobNumber As String\nDim srcCell As String\n\nDim id As Integer\n\n    For id = 4 To 50\n        srcCell = \"C\" &amp; id\n\n        JobNumber = Range(srcCell).Value\n\n        Range(\"D\" &amp; id).Value = \"='C:\\Users\\banand\\Desktop\\test\\[\" &amp; JobNumber &amp; \".xlsx]Total'!D4\"\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Trick here is to set the file path accurately. You can try replacing the file path as below and test to see if it works.</p>\n\n<pre><code>    Range(\"D4\").Value = \"='Y:\\Public\\QA Other\\Scorecards\\[Copy of Scorecard v0.6 \" &amp; JobNumber &amp; \".xlsm]Total'!D4\"\n</code></pre>\n\n<p>If the above doesn't work, you can try to key in the below value in a cell, D3 (or some other cell of your choice in the target excel) with just the complete filepath as below to see if the filepath part of the code is translating correctly.</p>\n\n<pre><code>    ='Y:\\Public\\QA Other\\Scorecards\\[Copy of Scorecard v0.6 \" &amp; JobNumber &amp; \".xlsm]Total'!D4:D50\"\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 47046757, "answer_count": 3, "score": 1, "last_activity_date": 1509577374, "creation_date": 1509490281, "last_edit_date": 1509555281, "question_id": 47045652, "link": "https://stackoverflow.com/questions/47045652/ranges-in-vba-excel", "title": "Ranges in VBA excel", "body": "<p>I am quite new to VBA and trying to create an excel template that uses VBA to change a path and automatically gather data from other workbooks. Basically creating a master document to store the information.</p>\n\n<p>At the moment I am using the following code: </p>\n\n<pre><code>Sub CallOtherWB()\n\n  Dim JobNumber As String\n\n  JobNumber = Range(\"C4\").Value\n\n  With Range(\"D4\")\n     .Formula = \"='Y:\\Public\\QA Other\\Scorecards\\Copy of Scorecard v0.6 \" &amp; \n       JobNumber &amp; \".xlsm'!Total\"\n End With\n\nEnd Sub\n</code></pre>\n\n<p>However I haven't figured out how to make the range go through C4:C50 and grab the data entered there to edit <code>\"='Y:\\Public\\QA Other\\Scorecards\\Copy of Scorecard v0.6 \" &amp; JobNumber &amp; \".xlsm'!Total\"</code> which would go in D4:D50.</p>\n\n<p>I searched through other questions and tried to do a sort of loop but was not able to understand how to make the range work.\nTo summarize I am using that code to enter the information in the C column and for that information to replace the \"JobNumber\" part in the D column so that it has the correct file name. </p>\n\n<p>Please let me know if I need to clarify this further and thanks in advance for the help. \nThis is also my first question in Stackoverflow so I apologize for any mistakes. </p>\n"}, {"tags": ["vba", "excel", "position"], "comments": [{"owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 1, "creation_date": 1509489312, "post_id": 47045422, "comment_id": 81038387, "body": "Is the position changing for rng1, rng2 or both?"}, {"owner": {"reputation": 1, "user_id": 8865152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998f56a357c5fbbbb4a06ac70fa6189b?s=128&d=identicon&r=PG&f=1", "display_name": "cdbarton", "link": "https://stackoverflow.com/users/8865152/cdbarton"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1509574514, "post_id": 47045422, "comment_id": 81077257, "body": "just for range 1"}, {"owner": {"reputation": 1, "user_id": 8865152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998f56a357c5fbbbb4a06ac70fa6189b?s=128&d=identicon&r=PG&f=1", "display_name": "cdbarton", "link": "https://stackoverflow.com/users/8865152/cdbarton"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1509574695, "post_id": 47045422, "comment_id": 81077340, "body": "I have some additional information - it looks like this occurs whenever I move the slides.....putting them in current month order.....i.e. first slide is nov, then dec, etc.  Creating them in chronological order though.  So when I took out the moves - the slide in question creates as it should.  No reposition needed.  So this only happens on the last slide (current month) moved to the first position...... the code to accomplish this is below"}, {"owner": {"reputation": 1, "user_id": 8865152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998f56a357c5fbbbb4a06ac70fa6189b?s=128&d=identicon&r=PG&f=1", "display_name": "cdbarton", "link": "https://stackoverflow.com/users/8865152/cdbarton"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1509574739, "post_id": 47045422, "comment_id": 81077358, "body": "&#39;Move the sheets in order by the current month myPresentation.Slides(1).MoveTo toPos:=12 &#39;jan myPresentation.Slides(1).MoveTo toPos:=12 &#39;feb myPresentation.Slides(1).MoveTo toPos:=12 &#39;mar myPresentation.Slides(1).MoveTo toPos:=12 &#39;apr myPresentation.Slides(1).MoveTo toPos:=12 &#39;may myPresentation.Slides(1).MoveTo toPos:=12 &#39;jun myPresentation.Slides(1).MoveTo toPos:=12 &#39;jul myPresentation.Slides(1).MoveTo toPos:=12 &#39;aug myPresentation.Slides(1).MoveTo toPos:=12 &#39;sep myPresentation.Slides(1).MoveTo toPos:=12 &#39;oct"}, {"owner": {"reputation": 1, "user_id": 8865152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998f56a357c5fbbbb4a06ac70fa6189b?s=128&d=identicon&r=PG&f=1", "display_name": "cdbarton", "link": "https://stackoverflow.com/users/8865152/cdbarton"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1514489515, "post_id": 47045422, "comment_id": 82995213, "body": "I am no longer having any positioning issues with the left parameter.  It only happens with the top position.  I am having occurrences where I ran the code - the top position is half way the page now.  I change the top position and it&#39;s way at the top.  If I now put the top position at the original location from the first run - it&#39;s now where it should be - whereas the first time it ran - it was down the page.  This only happens with the first sorted slide in the deck (I sort so that the most current month is first and then the rest for the year).  This is maddening!  ;-("}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9661013, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/84726dd865a654d7fd71f3e2934e727d?s=128&d=identicon&r=PG", "display_name": "JWAM", "link": "https://stackoverflow.com/users/9661013/jwam"}, "is_accepted": false, "score": 0, "last_activity_date": 1523998751, "creation_date": 1523998751, "answer_id": 49887396, "question_id": 47045422, "link": "https://stackoverflow.com/questions/47045422/pasting-an-excel-range-using-vba-to-ppt-pasted-positions-change/49887396#49887396", "title": "Pasting an Excel range using VBA to PPT - pasted positions change", "body": "<p>I was having the same issue in Excel driving me mad and the best I could determine was that having zoom not at 100% or changing zoom levels caused the position in .top and .left to change unprompted.  Even changing between worksheets and workbooks caused the positions to shift.</p>\n"}], "owner": {"reputation": 1, "user_id": 8865152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998f56a357c5fbbbb4a06ac70fa6189b?s=128&d=identicon&r=PG&f=1", "display_name": "cdbarton", "link": "https://stackoverflow.com/users/8865152/cdbarton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1540, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544313089, "creation_date": 1509488897, "last_edit_date": 1509496515, "question_id": 47045422, "link": "https://stackoverflow.com/questions/47045422/pasting-an-excel-range-using-vba-to-ppt-pasted-positions-change", "title": "Pasting an Excel range using VBA to PPT - pasted positions change", "body": "<p>I am using VBA to copy a range from Excel and paste this to a PowerPoint slide. I add the top, left, and width coordinates to position the slide.  The range I am pasting does not change - what is happening is some days the left position changes.  Today, it was the top position.  I am not changing the coordinates.  I've Googled this issue and not have found a solution.  Code is below. </p>\n\n<pre><code>'Oct17\n'Open a slide to the Presentation\n  Set mySlide = myPresentation.Slides(10)\n\n'Copy Range from Excel\n   Set rng = ThisWorkbook.Sheets(\"Oct17\").Range(\"A1:N68\")\n   Set rng2 = ThisWorkbook.Sheets(\"Oct17\").Range(\"L73:N73\")\n\n'Copy Excel Range\n  rng.Copy\n\n'Paste to PowerPoint and position\nPowerPointApp.WindowState = 2\nmySlide.Shapes.PasteSpecial DataType:=0  '2 = ppPasteEnhancedMetafile  0 = ppPasteDefault\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n'Set position:\nmyShape.Left = 20        '15 / 0 / 20\nmyShape.Top = 70         '91\nmyShape.Width = 675\n'myShape.Height = 400\n\n'Copy Excel Range\n  rng2.Copy\n\n'Paste to PowerPoint and position\nPowerPointApp.WindowState = 2\nmySlide.Shapes.PasteSpecial DataType:=2  '2 = ppPasteEnhancedMetafile  0 = ppPasteDefault\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n'Set position:\nmyShape.Left = 494\nmyShape.Top = 527\nmyShape.Width = 300\n'Make PowerPoint Visible and Active\n'PowerPointApp.Visible = msoTrue\n'PowerPointApp.Activate\n\n'Clear The Clipboard\nApplication.CutCopyMode = False\nApplication.Wait (Now + TimeValue(\"00:00:01\"))\n</code></pre>\n"}, {"tags": ["excel", "vba", "variables"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1609391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6362fd2deb1365e9b1ced58eb62a6341?s=128&d=identicon&r=PG", "display_name": "user1609391", "link": "https://stackoverflow.com/users/1609391/user1609391"}, "edited": false, "score": 0, "creation_date": 1509488073, "post_id": 47045182, "comment_id": 81037931, "body": "thank you.  Changing matchvalue from string to variant did it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 1, "last_activity_date": 1509487408, "creation_date": 1509487408, "answer_id": 47045182, "question_id": 47045124, "link": "https://stackoverflow.com/questions/47045124/vba-find-changing-arguments-dynamically/47045182#47045182", "title": "VBA .Find Changing Arguments Dynamically", "body": "<p>Not sure if the way you are splitting the lines makes you can't achieve your goal.</p>\n\n<p>Try with:</p>\n\n<pre><code>Public Function getfield(matchvalue as string)\n\nGetRowNumber = Cells.Find(What:=\"Cat\", After:=ActiveCell, LookIn:=xlValues, _\n        LookAt:=matchvalue, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False).Activate\n End Function\n</code></pre>\n\n<p>Reading <code>.Find</code> documentation, LookAt value should be <code>Variant</code> Type.\nRead the following link.</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1509487718, "creation_date": 1509487718, "answer_id": 47045231, "question_id": 47045124, "link": "https://stackoverflow.com/questions/47045124/vba-find-changing-arguments-dynamically/47045231#47045231", "title": "VBA .Find Changing Arguments Dynamically", "body": "<p>It's not clear what your function is intended to return, but here's how I'd probably handle this:</p>\n\n<pre><code>Public Function getfield(Optional matchWholeValue as Boolean = True)\n\n    GetRowNumber = Cells.Find(What:=\"Cat\", After:=ActiveCell, _\n                              LookIn:=xlValues, _         \n                              LookAt:= IIf(matchWholeValue, xlWhole, xlPart), _\n                             SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                            MatchCase:=False, SearchFormat:=False).Row\nEnd Function\n</code></pre>\n\n<p>To match on the whole value use:</p>\n\n<pre><code>  getfield()\n</code></pre>\n\n<p>and to match on part:</p>\n\n<pre><code>  getfield(False)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1509488104, "creation_date": 1509488104, "answer_id": 47045295, "question_id": 47045124, "link": "https://stackoverflow.com/questions/47045124/vba-find-changing-arguments-dynamically/47045295#47045295", "title": "VBA .Find Changing Arguments Dynamically", "body": "<p>Try:</p>\n\n<pre><code>Public Function GetRowNumber(byval matchvalue as string, optional byval LookAtWhole = True) as long\n\nDim Result as range\nSet Result = \nActivesheet.Cells.Find(What:=matchvalue After:=ActiveCell, LookIn:=xlvalues, LookAt:=iif(LookAtWhole,xlwhole,xlpart), SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _ , SearchFormat:=False)\n\nIf not (Result is nothing) then\nGetrownumber = result.row\nElse\nGetrownumber = 0\nEnd if\n\nEnd Function\n</code></pre>\n\n<p>This function performs FIND method on active sheet's cells. Returns 0, if the criteria returned no results -- else the row number. You could add further parameters.</p>\n\n<p>Hopefully it works and is what you wanted?</p>\n"}], "owner": {"reputation": 379, "user_id": 1609391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6362fd2deb1365e9b1ced58eb62a6341?s=128&d=identicon&r=PG", "display_name": "user1609391", "link": "https://stackoverflow.com/users/1609391/user1609391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 47045182, "answer_count": 3, "score": 1, "last_activity_date": 1509488104, "creation_date": 1509487088, "question_id": 47045124, "link": "https://stackoverflow.com/questions/47045124/vba-find-changing-arguments-dynamically", "title": "VBA .Find Changing Arguments Dynamically", "body": "<p>I have a VBA function that uses the the .find method.  In my function I'd like change the LookAt: argument between xlPart or xlWhole.  I tried using a parameter variable matchvalue and passing in \"xlPart\" or \"xlWhole\".   It didn't work.  </p>\n\n<p>Is there a way to change the LookAt: argument with a variable I pass into my function?</p>\n\n<pre><code>Public Function getfield(matchvalue as string)\n\nGetRowNumber = Cells.Find(What:=\"Cat\", After:=ActiveCell, LookIn:=xlValues, LookAt:= _\n\n        matchvalue, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n\n        , SearchFormat:=False).Activate\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509494412, "post_id": 47044976, "comment_id": 81039782, "body": "I&#39;m no Word expert, but the <code>ActiveDocument.Comments.Add</code> line is in the Else block of your <code>If</code>, which is IMHO never reached since <code>oRng.InRange(oScope)</code> is always <code>True</code>."}, {"owner": {"reputation": 1, "user_id": 8859290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-30cxqf4-VbQ/AAAAAAAAAAI/AAAAAAAAAKA/9GPYHyQZ-Uk/photo.jpg?sz=128", "display_name": "Paulray Keahey", "link": "https://stackoverflow.com/users/8859290/paulray-keahey"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509540940, "post_id": 47044976, "comment_id": 81057620, "body": "The oRng.InRange(oScope) is not always true, because this code does add the comments to the word document."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1509663625, "creation_date": 1509663625, "answer_id": 47085926, "question_id": 47044976, "link": "https://stackoverflow.com/questions/47044976/import-ms-excel-columns-to-ms-word-as-comments/47085926#47085926", "title": "Import MS-Excel columns to MS-Word as Comments", "body": "<p>I'm not sure I understand the Word component of this setup, but if you want to list all comments in your Excel file, you can use the script below to do that.</p>\n\n<pre><code>Sub ShowCommentsAllSheets()\n'Update 20140508\nDim commrange As Range\nDim rng As Range\nDim ws As Worksheet\nDim newWs As Worksheet\nSet newWs = Application.Worksheets.Add\nnewWs.Range(\"A1\").Resize(1, 4).Value = Array(\"Sheet\", \"Address\", \"Value\", \"Comment\")\nApplication.ScreenUpdating = False\nOn Error Resume Next\nFor Each ws In Application.ActiveWorkbook.Worksheets\n    Set commrange = ws.Cells.SpecialCells(xlCellTypeComments)\n    If Not commrange Is Nothing Then\n        i = newWs.Cells(Rows.Count, 1).End(xlUp).Row\n        For Each rng In commrange\n            i = i + 1\n            newWs.Cells(i, 1).Resize(1, 4).Value = Array(ws.Name, rng.Address, rng.Value, rng.Comment.Text)\n        Next\n    End If\n    Set commrange = Nothing\nNext\nnewWs.Cells.WrapText = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8859290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-30cxqf4-VbQ/AAAAAAAAAAI/AAAAAAAAAKA/9GPYHyQZ-Uk/photo.jpg?sz=128", "display_name": "Paulray Keahey", "link": "https://stackoverflow.com/users/8859290/paulray-keahey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509663625, "creation_date": 1509486236, "question_id": 47044976, "link": "https://stackoverflow.com/questions/47044976/import-ms-excel-columns-to-ms-word-as-comments", "title": "Import MS-Excel columns to MS-Word as Comments", "body": "<p>Situation: \nI am trying to search through a word document for Keyword/IDs contained in an excel, and add comments from the spreadsheet to the word document for every occurrence of the Keyword/IDs then save. The sample code I have runs through the list of Keyword/IDs, but only comments the first occurrence</p>\n\n<p>Give: \nThe word  file is located at C:\\Test\\ACBS.docx  and the  excel executing the VBA macro is located separately.  In the Excel the search term variable \u201cFindWord\u201d is in column A , and the comment is the variable \u201cCommentWord\u201d in column B.</p>\n\n<p>Problem:\nHow can I get this to search through the entire word document and comment each occurrence of the Keyword/IDs? </p>\n\n<p>Code: </p>\n\n<pre><code>Sub Comments_Excel_to_Word()\n'Author: Paul Keahey\n'Date: 2017-10-30\n'Name:Comments_Excel_to_Word\n'Purpose: To bring in comments From Excel to Word.\n'Comments: None\n\nDim objWord\nDim objDoc\nDim objSelection\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Open(\"C:\\Test\\ACBS.docx\")\nobjWord.Visible = True\nSet objSelection = objWord.Selection\nDim oRng As Word.range\nSet oRng = objSelection.range\nSet oScope = oRng.Duplicate\nDim oCol As New Collection\nDim FindWord As String\nDim CommentWord As String\nDim I As Integer\n\n\n\n'initalize list of varables\n\n\nFor I = 2 To range(\"A1\").End(xlDown).Row\n\nFindWord = Sheet1.range(\"A\" &amp; I).Value\nCommentWord = Sheet1.range(\"B\" &amp; I).Value\n\n With oRng.Find\n    .Text = FindWord\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = True\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    Do While .Execute = True\n        If oRng.InRange(oScope) Then\n            On Error Resume Next\n            'MsgBox \"oRng.InRange(oScope)\"\n            oCol.Add oRng.Text, oRng.Text\n            On Error GoTo 0\n                oRng.Collapse wdCollapseEnd\n                Else\n             ActiveDocument.Comments.Add oRng, CommentWord\n\n                Exit Do\n            End If\n        Loop\n\n    End With\nNext I\n\nobjDoc.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1510039219, "post_id": 47044957, "comment_id": 81253595, "body": "Chetan: Did either of the below answers solve your question? If so, please mark it as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1509566010, "post_id": 47044997, "comment_id": 81073316, "body": "It removed all 0 and negative entries, however, the blanks are not filtered. Thank you."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1509568610, "post_id": 47044997, "comment_id": 81074655, "body": "@ChetanChimate When you say &quot;blanks&quot;, are they in the pivot table as <code>(blank)</code> or are there are literal blank spaces like <code>&quot; &quot;</code>?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1509486346, "creation_date": 1509486346, "answer_id": 47044997, "question_id": 47044957, "link": "https://stackoverflow.com/questions/47044957/filter-on-pivot-tables-using-macro/47044997#47044997", "title": "Filter on Pivot Tables using Macro", "body": "<p>Try:</p>\n\n<pre><code>Dim i As Integer\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Short Quantity\")\n    For i = 1 To .PivotItems.Count\n        If Left(.PivotItems(i), Len(\"-\")) = \"-\" Or _\n                .PivotItems(i) = \"(blank)\" Or _\n                .PivotItems(i) = 0 Then\n            .PivotItems(i).Visible = False\n        Else\n            .PivotItems(i).Visible = True\n        End If\n\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 0, "last_activity_date": 1509490927, "creation_date": 1509490927, "answer_id": 47045749, "question_id": 47044957, "link": "https://stackoverflow.com/questions/47044957/filter-on-pivot-tables-using-macro/47045749#47045749", "title": "Filter on Pivot Tables using Macro", "body": "<p>So you only want positive numbers to show in the Pivot? If you put the 'Short Quantity' field into the pivot as a Values field as well as a row field, then you can put a Values filter on the field to suppress anything below zero, which also suppresses blanks:</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F4ATX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4ATX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Applying VALUES filter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GszOn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GszOn.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F13H3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F13H3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 47045749, "answer_count": 2, "score": 0, "last_activity_date": 1509490927, "creation_date": 1509486137, "last_edit_date": 1509488366, "question_id": 47044957, "link": "https://stackoverflow.com/questions/47044957/filter-on-pivot-tables-using-macro", "title": "Filter on Pivot Tables using Macro", "body": "<p>I have put a filter on the Pivot Table. I have written a code that filters (removes) the entries with a value less than 0. I want to remove data entries with \"0\" and blanks too. Below is my code that filters entries that start with \"-\" sign. Please suggest how I can filter \"0\" and blanks.</p>\n\n<pre><code>Dim i As Integer\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Short Quantity\")\n    For i = 1 To .PivotItems.Count\n           If Left(.PivotItems(i), Len(\"-\")) = \"-\" Then\n            .PivotItems(i).Visible = False\n        Else\n            .PivotItems(i).Visible = True\n        End If\n\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "batch-file"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1509487616, "post_id": 47044925, "comment_id": 81037790, "body": "I suggest to use <code>Woorkbook_Open</code> instead of <code>Auto_Open</code> Event. There is no necessary to kill excel.exe, you can add <code>Application.Quit</code> at your VBA code. Why you don&#39;t work with Schedule Task?"}, {"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 0, "creation_date": 1509490545, "post_id": 47044925, "comment_id": 81038739, "body": "Once you open the excel file, the batch file is waiting for that command to complete.  In other words it is waiting for Excel to exit. It will not do anything until you close the application."}, {"owner": {"reputation": 68521, "user_id": 2128947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ASTM.jpg?s=128&g=1", "display_name": "Magoo", "link": "https://stackoverflow.com/users/2128947/magoo"}, "edited": false, "score": 1, "creation_date": 1509503924, "post_id": 47044925, "comment_id": 81042034, "body": "<code>start &quot;&quot; &quot;C:\\Summary report.xls&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 8864976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f43111ae0af15ec025c3edd0606d11?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Coney", "link": "https://stackoverflow.com/users/8864976/matt-coney"}, "edited": false, "score": 0, "creation_date": 1509633733, "post_id": 47044925, "comment_id": 81104571, "body": "Thanks for the help I will try using the workbook_open command instead of auto_open. also good note on using Application.quit in my VBA macro to close workbook and continue running batch file.  Also as a note I am using this in conjunction with task scheduler. I have task scheduler run this batch file, every two hours. Then by executing this batch file wich turns on a service and then opens excel, where excel excutes a code to collect data and make a summary then close. then the batch file continues to stop the service."}, {"owner": {"reputation": 11, "user_id": 8864976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f43111ae0af15ec025c3edd0606d11?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Coney", "link": "https://stackoverflow.com/users/8864976/matt-coney"}, "edited": false, "score": 0, "creation_date": 1509634186, "post_id": 47044925, "comment_id": 81104943, "body": "Then by executing this batch file wich turns on a service and then opens excel, where excel excutes a code to collect data and make a summary then close. then the batch file continues to stop the service. The reaso I&#39;ve done it this way is purely a proof of concept for me to make it work. By starting and stopping this service we are limiting the amount of data this service has been consuming. Currently this service is on all day pinging data back and forth consuming data, but all i really need is for it to retrieve data each time i want to update or add a line to the summary.Thanks"}, {"owner": {"reputation": 11, "user_id": 8864976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f43111ae0af15ec025c3edd0606d11?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Coney", "link": "https://stackoverflow.com/users/8864976/matt-coney"}, "edited": false, "score": 0, "creation_date": 1509641339, "post_id": 47044925, "comment_id": 81110167, "body": "Just wanted to say I tried out the Workbook_open in conjunction with application.quit in my VBA and now I have the means of what I was trying to accomplish. thank you very much gentlemen."}], "owner": {"reputation": 11, "user_id": 8864976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f43111ae0af15ec025c3edd0606d11?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Coney", "link": "https://stackoverflow.com/users/8864976/matt-coney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509488309, "creation_date": 1509485948, "last_edit_date": 1509488309, "question_id": 47044925, "link": "https://stackoverflow.com/questions/47044925/batch-file-stops-running-after-opening-excel", "title": "Batch File stops running after opening excel", "body": "<p>This is my first attempt at making a batch file. I am trying to achieve the following: I want to turn on a service, wait 10 seconds, open and excel file, run a macro in the excel file, then close excel file, wait 10 seconds, then turn off a service.</p>\n\n<p>I have managed most of it, please see me bat file below:</p>\n\n<pre><code>net start \"DraftSight API Service\"\n\ntimeout /T 10 /nobreak\n\n\"C:\\Summary report.xls\"\n\ntaskkill /IM excel.exe\n\ntimeout /T 10 /nobreak\n\nnet stop \"DraftSight API Service\"\n</code></pre>\n\n<p>I am now at the point that upon executing this batch file that it turns on service, waits, then opens excel but will not run the macro that i have set as Auto_Open (). If i run the macro manually and close excel, the batch file then proceeds to try and close excel, which has already been closed and then executes the reset of the code. </p>\n\n<p>What I want to know is why after opening excel via a batch file, why does it seem to pause the command prompt and how to get around this? Secondly how to run the macro with either the Auto_Open in excel or can I call the macro from the batch file and have it executed?</p>\n\n<p>Thanks for reading and responding</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509485463, "post_id": 47044775, "comment_id": 81036999, "body": "Without seeing your code, it would be hard to suggest improvements.  But if your code is working, it would possibly be better to post it at <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}], "answers": [{"tags": [], "owner": {"reputation": 90, "user_id": 4086152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cca8eb7762bf4975b6a1bcea30284b4?s=128&d=identicon&r=PG&f=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/4086152/angel"}, "is_accepted": false, "score": 0, "last_activity_date": 1509487179, "creation_date": 1509487179, "answer_id": 47045139, "question_id": 47044775, "link": "https://stackoverflow.com/questions/47044775/how-to-speed-up-vba-from-excel-to-ppt/47045139#47045139", "title": "How to Speed Up VBA from Excel to PPt", "body": "<p>A few things to consider:</p>\n\n<ol>\n<li><p>Copy and paste (pictures, ranges, charts, etc) works faster if made as picture instead for example embedding object from Excel in PPT</p></li>\n<li><p>If possible source data used to build the PPT slides should be placed/ kept inside PPT</p></li>\n<li><p>Running the show from Excel might be considerably slower compared to placing the code in a PPT module (if this is applicable)\nHere is a nice </p></li>\n<li><p>Newer versions of Excel/PPT appear to perform slower compared to older ones. If your data is not outside the number of rows that can hold a sheet of Excel 2003, it might worth it to give it a try.</p></li>\n</ol>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1509487179, "creation_date": 1509485213, "question_id": 47044775, "link": "https://stackoverflow.com/questions/47044775/how-to-speed-up-vba-from-excel-to-ppt", "title": "How to Speed Up VBA from Excel to PPt", "body": "<p>I am using VBA in excel to create a daily report in PPt by copying and pasting pictures and ranges. it works really well but is a little slow. any suggestions?</p>\n\n<p>I already have: </p>\n\n<pre><code>With Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .DisplayAlerts = False\nEnd With\n</code></pre>\n\n<p>Suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1509487715, "post_id": 47044522, "comment_id": 81037822, "body": "There are a lot of excel files similar as the one you want. Google it!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8864872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f4a8f250da0d8781ac0fbde05aeadf?s=128&d=identicon&r=PG&f=1", "display_name": "Rudi Zadok", "link": "https://stackoverflow.com/users/8864872/rudi-zadok"}, "edited": false, "score": 0, "creation_date": 1509488311, "post_id": 47044676, "comment_id": 81038008, "body": "Thank you very much! appreciated! :-)"}, {"owner": {"reputation": 1370, "user_id": 1877752, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yKkk4.png?s=128&g=1", "display_name": "Greg the Incredulous", "link": "https://stackoverflow.com/users/1877752/greg-the-incredulous"}, "reply_to_user": {"reputation": 11, "user_id": 8864872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f4a8f250da0d8781ac0fbde05aeadf?s=128&d=identicon&r=PG&f=1", "display_name": "Rudi Zadok", "link": "https://stackoverflow.com/users/8864872/rudi-zadok"}, "edited": false, "score": 0, "creation_date": 1509488423, "post_id": 47044676, "comment_id": 81038057, "body": "No problem. If you think it&#39;s the correct answer could you mark it as the answer? Thanks."}], "tags": [], "owner": {"reputation": 1370, "user_id": 1877752, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yKkk4.png?s=128&g=1", "display_name": "Greg the Incredulous", "link": "https://stackoverflow.com/users/1877752/greg-the-incredulous"}, "is_accepted": false, "score": 0, "last_activity_date": 1509484730, "creation_date": 1509484730, "answer_id": 47044676, "question_id": 47044522, "link": "https://stackoverflow.com/questions/47044522/looking-for-a-code-to-build-a-competitive-standing/47044676#47044676", "title": "Looking for a code to build a competitive standing", "body": "<p>You can do this using VLookups, but why reinvent the wheel? These examples do what you need: <a href=\"http://excel-example.com/templates/sport-tournament-template\" rel=\"nofollow noreferrer\">http://excel-example.com/templates/sport-tournament-template</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8864872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f4a8f250da0d8781ac0fbde05aeadf?s=128&d=identicon&r=PG&f=1", "display_name": "Rudi Zadok", "link": "https://stackoverflow.com/users/8864872/rudi-zadok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1509484730, "creation_date": 1509483897, "question_id": 47044522, "link": "https://stackoverflow.com/questions/47044522/looking-for-a-code-to-build-a-competitive-standing", "title": "Looking for a code to build a competitive standing", "body": "<p>I'm looking to create a vba-excel based file which recieve games results on one sheet from the end user, and generates a real-time updated standing on the 2nd sheet, based on some rules.\nThe league is an amateur ping-pong game at work :-) including 14 players, each plays 26 games (home &amp; away structure).\nThe table need to consider that each win receive 1 point, and sorting should include the difference between positive &amp; negative points.\nAny ideas how to create? Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1509485012, "post_id": 47044466, "comment_id": 81036803, "body": "VBA doesn&#39;t support &quot;reflection&quot; (which would include iterating over the various properties of an object) so this type of task would be pretty difficult."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1509503785, "post_id": 47044466, "comment_id": 81042002, "body": "the two charts have different names ... use the watch window or the locals window to explore the chart object properties"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1509635686, "post_id": 47044466, "comment_id": 81106066, "body": "If you&#39;re trying to write general case code that will isolate the differences between any two charts of the same general type, you&#39;ll need to compare hundreds of different attributes. If you&#39;re just looking to isolate the differences between two specific charts, you might try saving images of them and then switching back and forth quickly to see if anything appears to move. That&#39;ll give you something to focus more closely on in the object model."}, {"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1509651605, "post_id": 47044466, "comment_id": 81115945, "body": "Very unfortunate to hear that Tim... Jsotola, my goal is to find the chart that has Percent formatting on the y-axis labels so that I can change my data from 0.98 format to 98% format, so the name wouldn&#39;t help me unless I set before hand. @SteveRindsberg If you read what I wrote to jsotola, I know before hand what the difference is but I haven&#39;t been able to find any way to check the formatting on the Y-axis, hence me wanting to find the differences on each chart hoping that this would pop-up somewhere in the locals. I just can&#39;t find this by hand. Do you know how to do this?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1509737749, "post_id": 47044466, "comment_id": 81156814, "body": "Hint: when struggling with PPT chart VBA, create a similar chart in Excel, then record a macro while you make the changes you want. Not perfect, but a far cry better than the non-existent macro recorder in PPT ;-)  Something like this will get you there:  ActiveChart.Axes(xlValue).TickLabels.NumberFormat = &quot;0.00%&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1509813310, "post_id": 47103390, "comment_id": 81175684, "body": "Re generic % format, maybe:   If Instr(shp.Chart.Axes(xlValue).TickLabels.NumberFormat) &gt; 0 Then  OR If Right$(shp.Chart.Axes(xlValue).TickLabels.NumberFormat,1)  = &quot;%&quot;"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1509738210, "creation_date": 1509738210, "answer_id": 47103390, "question_id": 47044466, "link": "https://stackoverflow.com/questions/47044466/how-to-determine-what-is-different-in-an-object-compared-to-another/47103390#47103390", "title": "How to determine what is different in an Object compared to another?", "body": "<p>\" my goal is to find the chart that has Percent formatting on the y-axis labels\"<br>\nThis is what you said in the comments, but it's not what you asked for in the question.</p>\n\n<p>This macro will search your active presentation for any chart that has an y-axis formatted to \"0.0%\" and tell you which slide, name, id, type.  Be careful that if the axis is formatted to \"0.00%\", this will not find it.\nI haven't found a generic % to check formatting for.</p>\n\n<pre><code>Sub Test()\nFor Each sld In ActivePresentation.Slides\n            For Each shp In sld.Shapes\n\n                If shp.HasChart Then\n                  If shp.Chart.Axes(xlValue).TickLabels.NumberFormat = \"0.0%\" Then\n                    message1 = \"Name - \" &amp; shp.Name &amp; \" , Slide # - \" &amp; sld.SlideNumber &amp; \" , ID - \" &amp; shp.Id &amp; \" , type - \" &amp; shp.Type\n                    MsgBox (message1)\n                  End If\n\n               End If\n\n    Next shp\n    Next sld\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47103390, "answer_count": 1, "score": 1, "last_activity_date": 1509738210, "creation_date": 1509483578, "last_edit_date": 1531164843, "question_id": 47044466, "link": "https://stackoverflow.com/questions/47044466/how-to-determine-what-is-different-in-an-object-compared-to-another", "title": "How to determine what is different in an Object compared to another?", "body": "<p>I am working in PowerPoint, but the question is the same in Excel. I want to be able to differentiate between two Charts, but as far as I can see the Locals window looks pretty identical to me. <code>ChartType = xlColumnCluster</code>, <code>BarShape = xlBox</code> and a bunch of other little things like this all seem the same. But I'm not a computer, and I want to know if there is a way to actually have VBA check for me and list all the differences in properties from one Chart to the other. If I can find something different in the charts, I believe I can then code to look for those differences in a more streamlined manner.</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1509483750, "post_id": 47044391, "comment_id": 81036297, "body": "Hard to spot <code>exact</code> issue, but a few notes which will help regardless. <b>1)</b> <code>Match</code> - change this variable name and also define the new variable as a range. <code>Match</code> is a built-in worksheet function. It&#39;s a bad idea to use variables names that are already in use by Excel. <b>2)</b> Use <code>Option Explicit</code> at the top of modules. It will save you many headaches. <b>3)</b> Dimension <code>i</code> and <code>LastRow</code> as Long. Your code will fail for datasets longer than ~32,768 rows."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1509484102, "post_id": 47044391, "comment_id": 81036445, "body": "Is it <b>definitely</b> the <code>For i = lastRow To 1 Step -1</code> being highlighted when the error occurs, or was that the last line that successfully ran (perhaps while you were stepping through the code) and the highlighted statement is actually the <code>If CDate(i1.Range(&quot;B&quot; &amp; i).Value) &gt; CDate(Match.Value) Then</code> line?  (That one may have reasons for a type mismatch, but I can&#39;t see a reason for <code>For i = lastRow To 1 Step -1</code> causing a problem.)"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509484444, "post_id": 47044391, "comment_id": 81036575, "body": "Have you tried using any <code>Debug.Print [VARIABLE NAMES]</code> anywhere? Or trying <code>step by step</code> to find where the issue is occurring? These options might be able to help"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509484468, "post_id": 47044391, "comment_id": 81036592, "body": "Ignore my last comment - I just saw the comment you left on the (now deleted) answer, saying that the error line was the <code>If CDate(...</code> line."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1509484605, "post_id": 47044391, "comment_id": 81036642, "body": "When the code crashes, what is the value of <code>i</code>?  And what is the value of <code>Match.Value</code>? And what is in column B of row <code>i</code> in your &quot;I1&quot; worksheet?"}], "owner": {"reputation": 249, "user_id": 6739518, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a5807e964b3e6af5e67219557a4af6bf?s=128&d=identicon&r=PG&f=1", "display_name": "lisarko8077", "link": "https://stackoverflow.com/users/6739518/lisarko8077"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509484419, "creation_date": 1509483263, "last_edit_date": 1531164843, "question_id": 47044391, "link": "https://stackoverflow.com/questions/47044391/vba-runtime-error-13-type-mismatch-on-for-loop", "title": "Vba runtime error 13 type mismatch on for loop", "body": "<p>I got in stuck with this code. I get back always this error but i have set all the variables and are numbers.</p>\n\n<p>Could you help me?</p>\n\n<p>Here the code</p>\n\n<pre><code>Sub calc()\n    Dim betexcel As Workbook\n    Dim prono As Worksheet\n    Dim test As Worksheet\n\n    Set betexcel = Workbooks(\"BET EXCEL.xlsm\")\n    Set prono = betexcel.Worksheets(\"PRONO\")\n    Set test = betexcel.Worksheets(\"TEST\")\n\n    Dim db As String\n    db = prono.Range(\"A1\").Value\n\n\n    Dim alldata As Workbook\n    Dim i1 As Worksheet\n\n    Set alldata = Workbooks(db)\n    Set i1 = alldata.Worksheets(\"I1\")\n\n    Dim i As Integer\n    Dim lastRow As Integer\n\n    lastRow = i1.Range(\"B2\").End(xlDown).Row\n\n    For Each Match In test.Range(\"A6:\" &amp; test.Range(\"A6\").End(xlDown).Address)\n        MsgBox (\"ciao\")\n\n        For i = lastRow To 1 Step -1\n\n            If CDate(i1.Range(\"B\" &amp; i).Value) &gt; CDate(Match.Value) Then\n\n                'i1.Rows(i).Delete\n\n            End If\n\n        Next i\n\n '            Match.Offset(, 1).Select\n '            Selection.Copy\n '            prono.Range(\"B8\").Select\n '            Selection.PasteSpecial Paste:=xlPasteValues\n\n\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>The error is on <code>If CDate(i1.Range(\"B\" &amp; i).Value) &gt; CDate(Match.Value) Then</code></p>\n"}, {"tags": ["javascript", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1509493196, "post_id": 47044116, "comment_id": 81039467, "body": "Please share VBA code you have, specify what data you need to scrape, and URL."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549633875, "post_id": 47044116, "comment_id": 95983743, "body": "Any update on this?"}], "owner": {"reputation": 11, "user_id": 8864663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2422e273e91a6c8d3d3ddebe9a68332b?s=128&d=identicon&r=PG&f=1", "display_name": "Max Scola", "link": "https://stackoverflow.com/users/8864663/max-scola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509555694, "creation_date": 1509482053, "last_edit_date": 1509555694, "question_id": 47044116, "link": "https://stackoverflow.com/questions/47044116/vba-interacting-with-website", "title": "VBA interacting with website", "body": "<p>I'm writing a VBA macro for Excel to extract and print some data from a website, the job is almost complete. However there's a expandable \"link\" from a javascript function which I need to expand in a lot of the pages but everything I've done failed so far.</p>\n\n<p>The code for the function is:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>&lt;script type=\"text/javascript\" id=\"show\"&gt;&lt;!--/*--&gt;&lt;![CDATA[/*&gt;&lt;!--*/\nfunction show(link, idTable, prefIdRows) {\n  var image = link.getElementsByTagName('img')[0];\n  image.src = (image.src.indexOf('/plus-p.gif') &gt;= 0) ? 'images/minus-p.gif' : 'images/plus-p.gif';\n  var table = document.getElementById(idTable);\n  var elements = table.getElementsByTagName('tr');\n  for (var i = 0; i &lt; elements.length; i++) {\n    var element = elements[i];\n    if (element.id.indexOf(prefIdRows, 0) == 0) {\n      if (element.style.display == 'none') {\n         element.style.display = '';\n      } else {\n        element.style.display = 'none';\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>The link code is:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;a href=\"#\" onClick=\"show(this, 'result','m0-'); return false;\"&gt;\n&lt;img align=\"left\" src=\"images/plus-p.gif\" alt=\"Show\" style=\"cursor:pointer;\"&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>I've already tried getelements by tag, classname, call execscript and nothing seems to work (I scraped everything that didn't work, so I don't have any code to reveal what I'm doing wrong, my bad).</p>\n\n<p>Is there an easy way to do this? I barely know any javascript so I might be trying the wrong element in this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509480413, "post_id": 47043401, "comment_id": 81034698, "body": "Can&#39;t you just simple keep filling down your formula in <code>Column J</code> and stick in a formula at the top of your sheet that tells you which row breaches 65%? Like Formula = <code>=Match((0.65*SUM(C:C)),$J$3:$J$10000,1)+3)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1509481906, "post_id": 47043950, "comment_id": 81035401, "body": "Thank you, after running your codes, I am getting last row or row 53 deleted and the rest are still there. Not sure why."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1509482137, "post_id": 47043950, "comment_id": 81035510, "body": "I get it, you just need to change tsum formula a bit, change your sht.Cells(lrE, 5) to sht.Cells(lrE -1, 5). Then we get it. Thanks."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1509482263, "post_id": 47043950, "comment_id": 81035583, "body": "I didn&#39;t allow for your subtotal row , since this doesn&#39;t need the subtotal to be in the sheet.   Glad it worked for you."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 2, "last_activity_date": 1509481416, "creation_date": 1509481416, "answer_id": 47043950, "question_id": 47043401, "link": "https://stackoverflow.com/questions/47043401/roll-up-sum-and-if-statement-vba/47043950#47043950", "title": "Roll up sum and if statement vba", "body": "<p>This will find the first row that is 65% or greater and delete the rest.</p>\n\n<pre><code>Sub test()\n\nSet sht = Worksheets(\"Zip\")\nlrE = sht.Cells(Rows.Count, 5).End(xlUp).Row\n\ntsum = WorksheetFunction.SUM(sht.Range(sht.Cells(3, 5), sht.Cells(lrE, 5)))\n\nFor i = 3 To lrE\n Sbtotal = Sbtotal + sht.Cells(i, 5).Value\n    If Sbtotal / tsum &gt; 0.65 Then\n    LRow = i\n    i = lrE + 1\n    End If\nNext i\n\n\nsht.Rows(LRow + 1 &amp; \":\" &amp; lrE).Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 1, "accepted_answer_id": 47043950, "answer_count": 1, "score": 2, "last_activity_date": 1509481416, "creation_date": 1509479031, "last_edit_date": 1509480272, "question_id": 47043401, "link": "https://stackoverflow.com/questions/47043401/roll-up-sum-and-if-statement-vba", "title": "Roll up sum and if statement vba", "body": "<p>I have a list of products and their details. Row 2 is the headers, and from row 3 are the details. In column E, I have the quantities for each product and I have a total row at the bottom. Each week I get new data so the data range vary. The data has been sorted by quantity from largest to smallest.</p>\n\n<p>Now my task is to find the row that has total quantities more than 65% of the total quantities we sold. That means I need to sum up each row in column E to determine which row will get me more than 65% of the total sales.</p>\n\n<p>So I have written some vba codes but the results from my codes are just row3, the rest are deleted and there is no error. I am writing vba codes since this is part of the larger codes I have already written so I am only posting this portion of codes.</p>\n\n<p>I have posted my data in picture but not the whole list since it's too long (with rows hidden) but you will get an idea of what I am trying to achieve. From this week's data, that means I will need to delete row 18 and below since row 17 is the first row that surpass the 65% mark. I don't need to display column J and K, I am just showing you what I mean by summing up the quantities and calculation for column percentages.</p>\n\n<pre><code>Sub test()\nDim i, j, k As Integer\nDim ValueA, ValueB As Variant\nDim lrE, c, d As Long\nDim sht As Worksheet\n\nSet sht = Worksheets(\"Zip\")\nlrE = sht.Cells(Rows.Count, 5).End(xlUp).Row\nd = sht.Range(\"E\" &amp; lrE)\n\n\nFor i = 3 To lrE - 1\n    ValueA = 0.65\n    ValueB = sht.Cells(i, 5).Value / d\n          If ValueB &lt;= ValueA Then\n                ValueB = ValueB + sht.Cells(i, 5).Value\n                i = i + 1\n           End If\n            If ValueB &gt; ValueA Then\n                c = sht.Cells(i, 5).Row\n                    sht.Rows(c &amp; \":\" &amp; Rows.Count).Delete\n            End If\n\n   Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/l1ArK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l1ArK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1509483633, "last_edit_date": 1509483633, "creation_date": 1509481490, "answer_id": 47043973, "question_id": 47043149, "link": "https://stackoverflow.com/questions/47043149/macro-in-excel-how-do-i-replace-the-value-with-a-value-in-a-previous-cell/47043973#47043973", "title": "Macro in Excel - how do I replace the #Value! with a value in a previous cell", "body": "<p>The following should do what you want to do in your \"Step 4\"</p>\n\n<pre><code>'Step 4: Do something with every price cell\nIf priceCell.Value = CVErr(xlErrValue) Then\n    priceCell.Value = priceCell.Offset(-1, 0).Value\nEnd If\n</code></pre>\n\n<p><code>CVErr(xlErrValue)</code> returns a <code>Variant/Error</code> value equivalent to what is shown in an Excel cell as <code>#VALUE!</code>.</p>\n\n<hr>\n\n<p>If you wanted to check for <strong>any</strong> error type, not just <code>#VALUE!</code>, you could use</p>\n\n<pre><code>'Step 4: Do something with every price cell\nIf IsError(priceCell.Value) Then\n    priceCell.Value = priceCell.Offset(-1, 0).Value\nEnd If\n</code></pre>\n\n<p><code>IsError</code> is a function that tests the value passed to it to see if it is any of the Excel error types (<code>#VALUE!</code>, <code>#N/A</code>, <code>#DIV/0!</code>, <code>#NAME?</code>, etc) and returns <code>True</code> if it is such a value, or <code>False</code> if it isn't.</p>\n"}], "owner": {"reputation": 39, "user_id": 8527403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d1367749f9e1dcc4a3bde0736a7c59a?s=128&d=identicon&r=PG&f=1", "display_name": "Lawrence Horner", "link": "https://stackoverflow.com/users/8527403/lawrence-horner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47043973, "answer_count": 1, "score": 2, "last_activity_date": 1509483633, "creation_date": 1509477880, "last_edit_date": 1531161705, "question_id": 47043149, "link": "https://stackoverflow.com/questions/47043149/macro-in-excel-how-do-i-replace-the-value-with-a-value-in-a-previous-cell", "title": "Macro in Excel - how do I replace the #Value! with a value in a previous cell", "body": "<p>I have a column of numeric data, however some of the cells contain a #VALUE!. I would like to replace the cells having #VALUE! with the value of the cell in the same column, but previous row. I have attempted the macro code and I obtain a compiler error code 13. Below is the code. I would be grateful for pointers in the right direction.</p>\n\n<pre><code>Sub ReplaceErrorValues()\n'\n' ReplaceErrorValues Macro\n' Macro replaces #Value! with the value of the cell in the same column and previous row\n'\n\n'Step 1: Declare variables\n    Dim priceRange As Range\n    Dim priceCell As Range\n\n\n'Step 2: Define the Target Range\n    Set priceRange = Range(\"D4:D1357\")\n\n\n'Step 3: Start looping through the Days range\n    For Each priceCell In priceRange\n\n'Step 4: Do something with every price cell\n    If priceCell.Value = #Value! Then\n        'Step 5: Create a temporary variable\n        Dim previousValue As Double\n        priceCell.Select\n        priceCell.Offset(-1, 0).Range(\"A1\").Select\n        previousValue = ActiveCell.Value\n        priceCell.Select\n        ActiveCell.Value = previousValue\n     End If\n\n'Step 6: Get the next cell in the Target range\n    Next priceCell       \n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509477545, "post_id": 47043020, "comment_id": 81033158, "body": "Are the <code>16.10.</code> and so on actual dates formatted to show that way or are they just numbers?"}, {"owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509477679, "post_id": 47043020, "comment_id": 81033227, "body": "Yes actual dates formatted."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509477725, "post_id": 47043020, "comment_id": 81033254, "body": "Okay what is wrong with the formula you are using?"}, {"owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509477986, "post_id": 47043020, "comment_id": 81033419, "body": "I think it&#39;s incomplete, because it doesn&#39;t get the rest of the events. Just the first one from the table for Stallone."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509478081, "post_id": 47043020, "comment_id": 81033479, "body": "Got it.  This can be done with formula, but it will be array type formulas and filling a large grid with array type formula will slow down the calculations and even possibly crash excel.  vba is the best answer."}, {"owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509478550, "post_id": 47043020, "comment_id": 81033716, "body": "I was afraid of that it could be get complicated. I haven&#39;t used vba much so I was looking for another solution, but I&#39;ll try to figure out the vba code for this. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "edited": false, "score": 0, "creation_date": 1509479205, "post_id": 47043326, "comment_id": 81034083, "body": "This works! I&#39;ll have matrix that is about 300 rows and one year time span. Do you think it would be too heavy?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "edited": false, "score": 0, "creation_date": 1509479249, "post_id": 47043326, "comment_id": 81034106, "body": "All you can do is try.  If it gets too sluggish then try your hand at vba."}, {"owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "edited": false, "score": 0, "creation_date": 1509479426, "post_id": 47043326, "comment_id": 81034214, "body": "I will. Thanks again Scott!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "edited": false, "score": 0, "creation_date": 1509479606, "post_id": 47043326, "comment_id": 81034317, "body": "@msoi if this worked please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1509478634, "creation_date": 1509478634, "answer_id": 47043326, "question_id": 47043020, "link": "https://stackoverflow.com/questions/47043020/how-to-group-events-in-timeline-matrix-in-excel/47043326#47043326", "title": "How to group events in timeline matrix in Excel", "body": "<p>You can try this array type formula:</p>\n\n<pre><code>=IFERROR(INDEX(Events!$D:$D,AGGREGATE(15,6,ROW(Events!$A$2:$A$6)/((Events!$B$2:$B$6&lt;=B$1)*(Events!$C$2:$C$6&gt;=B$1)*(Events!$A$2:$A$6=$A2)),1)),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lUK6v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lUK6v.png\" alt=\"enter image description here\"></a></p>\n\n<p>Realize that a page full of these will slow down the calcs.</p>\n\n<hr>\n\n<p>My Events page:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W9dgJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W9dgJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8029661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7523255d84c6254299c7e4ea9ad3c63?s=128&d=identicon&r=PG&f=1", "display_name": "msoi", "link": "https://stackoverflow.com/users/8029661/msoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 47043326, "answer_count": 1, "score": 1, "last_activity_date": 1509478634, "creation_date": 1509477363, "last_edit_date": 1592644375, "question_id": 47043020, "link": "https://stackoverflow.com/questions/47043020/how-to-group-events-in-timeline-matrix-in-excel", "title": "How to group events in timeline matrix in Excel", "body": "<p>I have two sheets: <strong>Events</strong> and <strong>Matrix</strong>.</p>\n<p>In the Events Spreadsheet below I have persons name, event start day, event end day and info.</p>\n<p><strong>EVENTS</strong></p>\n<p><img src=\"https://i.stack.imgur.com/c4Jvz.png\" alt=\"Events\" /></p>\n<p>In Matrix Spreadsheet have one column as names and the rest of the columns are timeline with rolling dates.</p>\n<p><strong>MATRIX</strong></p>\n<p><img src=\"https://i.stack.imgur.com/kBwoU.png\" alt=\"Matrix\" /></p>\n<p>Now I need to get event info from list of events for the persons timeline and group them. For example Stallones all events should be shown in Matrix. Is there anyway to do this without VBA?</p>\n<p><strong>Formula from matrix sheet:</strong></p>\n<pre><code>=IF(AND(B$1&gt;=VLOOKUP($A2;Events!$A$1:$D$6;2;FALSE);B$1&lt;=VLOOKUP($A2;Events!$A$1:$D$6;3;FALSE));VLOOKUP($A2;Events!$A$1:$D$6;4;FALSE);&quot;&quot;)\n</code></pre>\n<p>Any suggestions to do this more neatly would be highly appreciated too. Thanks!</p>\n"}, {"tags": ["excel", "checkbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1509476473, "creation_date": 1509476473, "answer_id": 47042817, "question_id": 47042613, "link": "https://stackoverflow.com/questions/47042613/un-assign-macros-from-all-the-checkboxes-in-excel-spreadsheet/47042817#47042817", "title": "Un-assign macros from all the checkboxes in Excel spreadsheet", "body": "<pre><code>For Each sht In ActiveWorkbook.Sheets\n    For Each CheckBox In sht.CheckBoxes\n        CheckBox.OnAction = \"\"\n    Next CheckBox\nNext sht\n</code></pre>\n\n<p>There should be a better way than simply assigning it to \"\" but this definitely works</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 8748552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8d820e605e1263e05c7bdf33ec57169?s=128&d=identicon&r=PG&f=1", "display_name": "Arteezy", "link": "https://stackoverflow.com/users/8748552/arteezy"}, "edited": false, "score": 0, "creation_date": 1509542956, "post_id": 47042943, "comment_id": 81058961, "body": "Thanks, this is a simpler solution indeed. If I had to unassign macro for some of the checkboxes and not all, this would be perfect."}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": false, "score": 1, "last_activity_date": 1509477023, "creation_date": 1509477023, "answer_id": 47042943, "question_id": 47042613, "link": "https://stackoverflow.com/questions/47042613/un-assign-macros-from-all-the-checkboxes-in-excel-spreadsheet/47042943#47042943", "title": "Un-assign macros from all the checkboxes in Excel spreadsheet", "body": "<p>If you <code>Ctrl</code> + <code>Click</code> one of the check marks and then press <code>Ctrl</code> + <code>A</code> it will select them all. From there you can edit formatting, macros and so on...</p>\n"}], "owner": {"reputation": 133, "user_id": 8748552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8d820e605e1263e05c7bdf33ec57169?s=128&d=identicon&r=PG&f=1", "display_name": "Arteezy", "link": "https://stackoverflow.com/users/8748552/arteezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 47042817, "answer_count": 2, "score": 1, "last_activity_date": 1509481786, "creation_date": 1509475741, "last_edit_date": 1531161705, "question_id": 47042613, "link": "https://stackoverflow.com/questions/47042613/un-assign-macros-from-all-the-checkboxes-in-excel-spreadsheet", "title": "Un-assign macros from all the checkboxes in Excel spreadsheet", "body": "<p>I have an <code>excel</code> spreadsheet with more than 700 checkboxes. All the checkboxes have been assigned to one particular macro. I have deleted this macro. Now, I want to unassign this macro from all the checkboxes. I can do it for one checkbox manually by deleting the text when clicking on <code>assign Macro</code>. But how can I do this for large number of checkboxes? Any help greatly appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509474833, "post_id": 47042340, "comment_id": 81031664, "body": "Please show the code you are using."}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509475301, "post_id": 47042340, "comment_id": 81031909, "body": "Just commented below"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1509475311, "post_id": 47042340, "comment_id": 81031921, "body": "What have you done till now? Do you want to check if cell contains SUM in entire formula or it starts from SUM?"}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1509475340, "post_id": 47042340, "comment_id": 81031937, "body": "if the cell starts with =SUM()"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509475392, "post_id": 47042340, "comment_id": 81031976, "body": "Please put the code in the original post using <a href=\"https://stackoverflow.com/posts/47042340/edit\">edit</a> and not in the comments."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509482341, "post_id": 47042340, "comment_id": 81035625, "body": "Assuming your <code>GetColumnLetter</code> function is just allowing you to use <code>Range(GetColumnLetter(iColumn) &amp; &quot;13&quot;)</code> instead of using <code>Cells(13, iColumn)</code>, it appears that you are wanting to find <code>=SUM</code> in row 13 only and, if found, clear all the contents of that column from row 13 downwards.  Is that correct?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1509475254, "post_id": 47042434, "comment_id": 81031892, "body": "If wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; &quot;13&quot;).HasFormula Then                                                                If wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; &quot;13&quot;).HasFormula.Find(&quot;=SUM()&quot;, xlFormulas) Then                                 wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; &quot;13:&quot; &amp; GetColumnLetter(iColumn) &amp; wb_DST.Sheets(sWs_DST).UsedRange.Rows.Count).ClearContents"}], "tags": [], "owner": {"reputation": 86, "user_id": 5545133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iMwMJyUzsiM/AAAAAAAAAAI/AAAAAAAAOZM/4PvbH8MeIpk/photo.jpg?sz=128", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/5545133/john-saunders"}, "is_accepted": false, "score": 0, "last_activity_date": 1509475133, "creation_date": 1509475133, "answer_id": 47042434, "question_id": 47042340, "link": "https://stackoverflow.com/questions/47042340/finding-a-cell-with-sum-formula/47042434#47042434", "title": "Finding a cell with Sum Formula", "body": "<p>Just a thought, \nCould you loop through all your cells in the '.HasFormula' Range\nThen compare the '.formula' to see if it is a sum, \ncreating a collection of just those cells.</p>\n\n<p>Sorry I would put cod but I am not entirely sure what you are try to do yet, could you post your code snippet and I will update my answer better for you. Good luck :)</p>\n"}], "owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1509475779, "creation_date": 1509474771, "last_edit_date": 1509475779, "question_id": 47042340, "link": "https://stackoverflow.com/questions/47042340/finding-a-cell-with-sum-formula", "title": "Finding a cell with Sum Formula", "body": "<p>I am using '.HasFormula' to identify cells in a range. i want to find cells that have a 'sum' formula, and keep those, but keep all the other formulas.  </p>\n\n<pre><code>'If it has Formula\nIf wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; \"13\").HasFormula Then\n\n'If it is a Sum Formula                               \nIf wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; \"13\").HasFormula.Find(\"=SUM()\", xlFormulas) Then\n    wb_DST.Sheets(sWs_DST).Range(GetColumnLetter(iColumn) &amp; \"13:\" &amp; GetColumnLetter(iColumn) &amp; wb_DST.Sheets(sWs_DST).UsedRange.Rows.Count).ClearContents    \nElse \n'Nothing\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1509474273, "post_id": 47042188, "comment_id": 81031366, "body": "You will want to Dim your variables like this instead <code>Dim vmax As Double, vmin As Double, lmax As Double, lmin As Double</code> if you want them all to be doubles. Otherwise, they will be variants. This may or may not help your issue."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509474320, "post_id": 47042188, "comment_id": 81031387, "body": "what do you think is happening with this line <code>lmax = vmax.ClearContents</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1509474355, "post_id": 47042188, "comment_id": 81031405, "body": "you also have a typo here <code>Set vamx </code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1509474741, "post_id": 47042188, "comment_id": 81031613, "body": "What do you mean by <code>stop working</code>?  How are you entering the <code>real numbers</code>?  You never declare <code>vamax</code>.  <code>vmax</code> will never be anything prior to you testing it. <code>vmax, vmin, lmax</code> have all been declared as Variant type. In <code>Tools&#47;Options</code> set to Require variable declaration.  In your current code, enter <code>Option Explicit</code> at the very beginning.  Then you may start to see where your problems are."}], "owner": {"reputation": 9, "user_id": 8864170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5407f7f455c2cc5db416e22b520e460e?s=128&d=identicon&r=PG&f=1", "display_name": "tatanax", "link": "https://stackoverflow.com/users/8864170/tatanax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509474297, "creation_date": 1509474181, "last_edit_date": 1509474297, "question_id": 47042188, "link": "https://stackoverflow.com/questions/47042188/invalid-qualifier-decimals-issue", "title": "invalid qualifier / decimals issue", "body": "<p>I want to clear the cells that contain the max and min value on some data:</p>\n\n<pre><code>Sub Macro5()\nDim vmax, vmin, lmax, lmin As Double\nSet rango = Range(\"DA200:WB300\")\nSet vamx = rango.Find(Application.WorksheetFunction.max(rango),LookIn:=xlValues, lookat:=xlWhole)\nSet vmin = rango.Find(Application.WorksheetFunction.Min(rango),LookIn:=xlValues, lookat:=xlWhole)\nIf Not vmax Is Nothing Then\n    lmax = vmax.ClearContents\nEnd If\nIf Not vmin Is Nothing Then\n    lmin = vmin.ClearContents\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But the code doesn\u00b4t work.</p>\n\n<p>Tip: When I use numbers without decimals, it works fine. But when I change them for the real ones (like 0.565807486680781), the code stop working.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3879, "user_id": 1621444, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a62d4b3a37593b8fc22d2ce79136dc0b?s=128&d=identicon&r=PG", "display_name": "Robert Brisita", "link": "https://stackoverflow.com/users/1621444/robert-brisita"}, "edited": false, "score": 0, "creation_date": 1509476254, "post_id": 47042169, "comment_id": 81032457, "body": "This questions might be better served at: <a href=\"https://dba.stackexchange.com/\">dba.stackexchange.com</a>"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1509476430, "post_id": 47042169, "comment_id": 81032569, "body": "Take a look at: <a href=\"http://mdbdoc.sourceforge.net/\" rel=\"nofollow noreferrer\">mdbdoc.sourceforge.net</a> and <a href=\"http://www.accessdependencychecker.com/\" rel=\"nofollow noreferrer\">accessdependencychecker.com</a> to see if either will help. The first builds an HTML file of all objects that you could search."}], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1509480177, "creation_date": 1509480177, "answer_id": 47043663, "question_id": 47042169, "link": "https://stackoverflow.com/questions/47042169/inherited-ms-access-database-tracking-sources-of-queries/47043663#47043663", "title": "Inherited MS Access Database, Tracking Sources of Queries", "body": "<p>This is pretty messy but could save you time collecting each query's SQL code. The following code exports all SQL stored in the QueryDefs collection into a text file. I have it splitting the code with a space delimiter, but a comma might be preferable. The data will not be normalized, I don't have the time to go to that level of complexity. Just make sure to update <code>strPath</code> before you execute. Hopefully this helps.</p>\n\n<pre><code>Sub PullQuerySQL()\n\n    Dim dbs As Database\n    Dim i As Integer\n    Dim fso As Object\n    Dim oFile As Object\n    Dim varParse() As String\n    Dim element As Variant\n    Dim strPath As String\n\n    strPath = \".txt\"\n\n    Set dbs = CurrentDb()\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFile = fso.CreateTextFile(strPath)\n\n    For i = 0 To dbs.QueryDefs.Count - 1\n        oFile.WriteLine dbs.QueryDefs(i).Name\n        varParse = Split(dbs.QueryDefs(i).SQL, \" \")\n        For Each element In varParse\n            oFile.WriteLine element\n        Next element\n    Next i\n\n    oFile.Close\n\n    Set oFile = Nothing\n    Set fso = Nothing\n    Set dbs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8821380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a79cfe4e6a84e1501401aca3fea328?s=128&d=identicon&r=PG&f=1", "display_name": "Tack", "link": "https://stackoverflow.com/users/8821380/tack"}, "edited": false, "score": 0, "creation_date": 1509554424, "post_id": 47057877, "comment_id": 81066675, "body": "Thanks this exactly what I am looking for!"}], "tags": [], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "is_accepted": true, "score": 0, "last_activity_date": 1509548771, "creation_date": 1509548771, "answer_id": 47057877, "question_id": 47042169, "link": "https://stackoverflow.com/questions/47042169/inherited-ms-access-database-tracking-sources-of-queries/47057877#47057877", "title": "Inherited MS Access Database, Tracking Sources of Queries", "body": "<p>I have been through this with many inherited databases.  I find it extremely helpful to create an Access table with the fields and the tables/queries that they come from.  Try this code below.  It will prompt you for the name of the query that you are looking to \"map\" as I call it.  It will then create a new table named \"queryName Definitions\".  </p>\n\n<pre><code>Option Compare Database\n\nPublic Sub MapQuery()\n\n Dim strQueryName As String\n Dim rst As DAO.Recordset\n Dim fld As Field\n Dim strSource As String\n Dim strField As String\n Dim strValue As String\n Dim strSQL1 As String\n Dim strSQL2 As String\n Dim booExists As Boolean\n\n\nstrQueryName = InputBox(\"Please enter the name of the query that you are looking to map\")\n\n   Set rst = CurrentDb.OpenRecordset(strQueryName)\n\nOn Error GoTo error1\n    booExists = IsObject(CurrentDb.TableDefs(strQueryName &amp; \" Definitions\"))\n    DoCmd.DeleteObject acTable, strQueryName &amp; \" Definitions\"\ncontinue:\n    strSQL1 = \"CREATE TABLE [\" &amp; strQueryName &amp; \" Definitions]\" &amp; \" (FieldName CHAR, SourceName CHAR);\"\n    DoCmd.RunSQL (strSQL1)\n    DoCmd.SetWarnings False\n    For Each fld In rst.Fields\n\n    strField = fld.Name\n    strSource = fld.SourceTable\n\n\nDebug.Print strValue\n\n    strSQL2 = \"INSERT INTO [\" &amp; strQueryName &amp; \" Definitions]\" &amp; \"(FieldName, SourceName) VALUES(\"\"\" &amp; strField &amp; \"\"\", \"\"\" &amp; strSource &amp; \"\"\");\"\n\n    DoCmd.RunSQL (strSQL2)\n    Next fld\n\nerror1:\n    If Err.Number = 3265 Then\n        Resume continue\n    Else\n    MsgBox Err.Description\n\n    End If\n\n    DoCmd.SetWarnings True\n    Exit Sub\n\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8821380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a79cfe4e6a84e1501401aca3fea328?s=128&d=identicon&r=PG&f=1", "display_name": "Tack", "link": "https://stackoverflow.com/users/8821380/tack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47057877, "answer_count": 2, "score": -1, "last_activity_date": 1509548771, "creation_date": 1509474101, "question_id": 47042169, "link": "https://stackoverflow.com/questions/47042169/inherited-ms-access-database-tracking-sources-of-queries", "title": "Inherited MS Access Database, Tracking Sources of Queries", "body": "<p>I have just inherited a database at my new company.  Old DB owner left no good documentation and queries very hard to keep track of.  Looking for programmatic answer to track sources of fields in every query (what table it come from).  Prefer something can be exported to Excel to study, Access visualization is no good.  Am familiar with VBA.</p>\n"}]