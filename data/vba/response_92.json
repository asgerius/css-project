[{"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1476316123, "post_id": 40009994, "comment_id": 67298235, "body": "Should be easier to copy the whole file and remove stuff until it stops working :]"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476338794, "post_id": 40009994, "comment_id": 67304345, "body": "what line is highlighted when it errors out? if it&#39;s <code>Private Sub ClearButton_Click()</code> then check you have a button on your userform named after <code>ClearButton</code>. If it&#39;s <code>Call UserForm_Initialize</code> then check your userform code pane has a <code>Private Sub UserForm_Initialize()</code> sub code"}, {"owner": {"reputation": 1, "user_id": 7010479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/346d18e1a42ba3d63362ade5589801c3?s=128&d=identicon&r=PG&f=1", "display_name": "Brent7415", "link": "https://stackoverflow.com/users/7010479/brent7415"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476911635, "post_id": 40009994, "comment_id": 67553211, "body": "@user3598756 - It highlights in yellow the Private Sub line, but also highlights the second line, as well. The button name and the code above match, and the user form has a Private Sub UserForm_Initialize code already."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476945156, "post_id": 40009994, "comment_id": 67563427, "body": "step through your code (place a breakpoint at <code>Call UserForm_Initialize</code>, run your macro and when it stops at the breakpoint press F8 to step line by line) and see where it actually errors out."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7010479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/346d18e1a42ba3d63362ade5589801c3?s=128&d=identicon&r=PG&f=1", "display_name": "Brent7415", "link": "https://stackoverflow.com/users/7010479/brent7415"}, "edited": false, "score": 0, "creation_date": 1476911119, "post_id": 40010032, "comment_id": 67552964, "body": "True, and that is why I set up an identical button on the new file (cut and paste button text and code to minimize any mis-typing them on the new file.)"}], "tags": [], "owner": {"reputation": 46, "user_id": 6879800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa0bc6e389b1f212ec4269b370fb3c1?s=128&d=identicon&r=PG&f=1", "display_name": "arc", "link": "https://stackoverflow.com/users/6879800/arc"}, "is_accepted": false, "score": 0, "last_activity_date": 1476315528, "creation_date": 1476315528, "answer_id": 40010032, "question_id": 40009994, "link": "https://stackoverflow.com/questions/40009994/sub-or-function-not-defined-but-there-is-no-error-in-the-coding/40010032#40010032", "title": "Sub or Function not defined but there is no error in the coding", "body": "<p>Check the name of your button in the new workbook. Button names don't typically copy over when you copy them.</p>\n"}], "owner": {"reputation": 1, "user_id": 7010479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/346d18e1a42ba3d63362ade5589801c3?s=128&d=identicon&r=PG&f=1", "display_name": "Brent7415", "link": "https://stackoverflow.com/users/7010479/brent7415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476315528, "creation_date": 1476315202, "question_id": 40009994, "link": "https://stackoverflow.com/questions/40009994/sub-or-function-not-defined-but-there-is-no-error-in-the-coding", "title": "Sub or Function not defined but there is no error in the coding", "body": "<p>I am a compile error: Sub or Function not defined. The code involved is:</p>\n\n<pre><code>Private Sub ClearButton_Click()\nCall UserForm_Initialize\nEnd Sub\n</code></pre>\n\n<p>I created a user form, which is exactly the same as I created on another workbook. Everything is identical between both workbooks (data, formatting, coding, user form, everything), but I get this error on one workbook, but not the other. I copied the user form and coding over to this workbook, so nothing was mistyped. Anyone have an idea why one works, but the other doesn't?</p>\n\n<p>I read through the other similar Q&amp;A, but could not find an answer that fit this situation.</p>\n\n<p>I tip my cap to you guru's out there!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476325113, "post_id": 40009943, "comment_id": 67300409, "body": "Could you insert the headers in the VBA code?  i.e. each time you <b>don&#39;t</b> hide a column take the next header (from wherever you have them stored) and put it into the appropriate row of the column you are processing.  (That will be a lot easier to do if you create some <code>Worksheet</code> variables and <code>Set</code> each of those variables to the worksheets you are using - e.g. <code>Set wsSrc = ActiveSheet</code> at the start, then <code>Set wsTempView = ActiveSheet</code> after you have added a new sheet, and <code>Set wsHeaders = Worksheets(&quot;Headers&quot;)</code> to point to the header sheet.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476325531, "post_id": 40009943, "comment_id": 67300522, "body": "I can&#39;t see why deleting a column would cause your code to end after the deletion.  I <b>can</b> see that it would (depending on what other code you have that hasn&#39;t been pasted into the question) skip the processing of the column after the one you delete (because it is now in column <code>i</code> which your code thinks it has already processed) - but that is a quite different issue to just stopping processing altogether."}, {"owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476326913, "post_id": 40009943, "comment_id": 67300861, "body": "Upon further investigation, it seems what you said is happening. I had interpreted the problem incorrectly.  What would you suggest as a fix? I am not aware of a condition that allows me to track if a column was deleted or not"}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "is_accepted": false, "score": 0, "last_activity_date": 1476336515, "creation_date": 1476336515, "answer_id": 40012937, "question_id": 40009943, "link": "https://stackoverflow.com/questions/40009943/vba-copy-pasting-across-visible-columns/40012937#40012937", "title": "VBA - Copy pasting across visible columns", "body": "<p>So, the answer to the issue ended up as follows:</p>\n\n<pre><code>For i = 2 To countUsedCols\n\ncurrentColName = ActiveSheet.Cells(8, i).Value\n\nIf currentColName &lt;&gt; \"Salary\" and currentColName&lt;&gt;\"Net Worth\" Then\n    ActiveSheet.Columns(i).Select\n    'Selection.EntireColumn.Hidden = True\n    Selection.EntireColumn.Delete\n    i = i - 1\n    If currentColName = \"\" Then\n       Exit for\n    End if\n....\nEnd if\n</code></pre>\n\n<p>It was oddly simple</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "edited": false, "score": 0, "creation_date": 1476374300, "post_id": 40015107, "comment_id": 67328759, "body": "Thanks. That&#39;s a more elegant solution than mine"}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": true, "score": 2, "last_activity_date": 1476344667, "creation_date": 1476344667, "answer_id": 40015107, "question_id": 40009943, "link": "https://stackoverflow.com/questions/40009943/vba-copy-pasting-across-visible-columns/40015107#40015107", "title": "VBA - Copy pasting across visible columns", "body": "<p>the best way loop over columns or rows (if you are going to delete some of them) is going backwards:</p>\n\n<pre><code>For i = countUsedCols To 2 Step -1\n\ncurrentColName = ActiveSheet.Cells(8, i).Value\n\nIf currentColName &lt;&gt; \"Salary\" And currentColName &lt;&gt; \"Net Worth\" Then\n    ActiveSheet.Columns(i).Delete\nEnd If\n</code></pre>\n\n<p>That way you dont have to mess with you variables or to worry about the effexcts of the deleted cells. \nIn Addition: you need'nt select the column before deleting.</p>\n"}], "owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 40015107, "answer_count": 2, "score": 0, "last_activity_date": 1476344667, "creation_date": 1476314842, "last_edit_date": 1476327276, "question_id": 40009943, "link": "https://stackoverflow.com/questions/40009943/vba-copy-pasting-across-visible-columns", "title": "VBA - Copy pasting across visible columns", "body": "<p>I have a code that imports a table and then goes on to hide columns that are not relevant to the end user.</p>\n\n<p>As part of the formatting process, I need to add a header to the excel doc that consists of merged and unmerged cells.</p>\n\n<p>My problem is that considering the fact that a number of columns have been hidden, it is proving impossible to import the header. The header would need to be pasted across numerous non-sequential columns. Is there a way to do that?</p>\n\n<p>For reference I have copy pasted the code I use to hide the columns in the first place. I am guessing I will need to find a way to delete the columns instead. The problem with that is that if I do Columns(I).delete, the loop ends after deleting the first column.</p>\n\n<p>Note: The counta in the code yields 17 columns. I have changed some of the naming and number of columns I am checking in the if condition in the interest of confidentiality. If there is any other info you need please let me know</p>\n\n<p><strong>Edit: Upon further investigation and YowE3K's comment the problem in the code is that it is skipping the processing of a given column after one is deleted (because it is now in column i which the code thinks it has already processed)</strong></p>\n\n<pre><code>Sub NewView()\nActiveWindow.DisplayHeadings = False\nApplication.ScreenUpdating = False\nActiveSheet.Range(\"A14:Z14\").Copy\nActiveWorkbook.Sheets.Add Before:=Worksheets(Worksheets.Count)\nActiveWorkbook.ActiveSheet.Name = \"Temp_View\"\nActiveWorkbook.Sheets(\"Temp_View\").Activate\nWorksheets(\"Temp_View\").Range(\"B1\").Formula = \"=COUNTA($8:$8)\"\nActiveSheet.Range(\"B8\").PasteSpecial _\nPaste:=xlPasteValues\nDim countUsedCols As Long\ncountUsedCols = ActiveWorkbook.Sheets(\"Temp View\").Range(\"B1\").Value\nDim currentColName As String\nDim newColName As String\n\nFor i = 2 To countUsedCols + 1\n\n\n    currentColName = ActiveSheet.Cells(8, i).Value\n\n    If currentColName &lt;&gt; \"Salary\" and currentColName&lt;&gt;\"Net Worth\" Then\n        ActiveSheet.Columns(i).Select\n        Selection.EntireColumn.Hidden = True\n        'Selection.EntireColumn.Delete\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "outlook-2010"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476322538, "post_id": 40009549, "comment_id": 67299738, "body": "Instead of <code>Set oTable = ActiveDocument.Tables(1)</code> you need to refer to the table <code>Set oTable  = ActiveDocument.Bookmarks(&quot;bkmrk_name&quot;).Range.Tables(1)</code>?"}, {"owner": {"reputation": 13, "user_id": 4198712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86450eb6529cb70b085af8362443af1e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Morris", "link": "https://stackoverflow.com/users/4198712/richard-morris"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476340450, "post_id": 40009549, "comment_id": 67305100, "body": "Great thanks. I will try that. Any thoughts on how the final script might look? Thanks again. Richard."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4198712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86450eb6529cb70b085af8362443af1e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Morris", "link": "https://stackoverflow.com/users/4198712/richard-morris"}, "is_accepted": false, "score": 0, "last_activity_date": 1476369491, "creation_date": 1476369491, "answer_id": 40024061, "question_id": 40009549, "link": "https://stackoverflow.com/questions/40009549/ms-word-2010-macro-to-export-table-to-outlook-tasks/40024061#40024061", "title": "MS-Word 2010 - Macro to export table to Outlook Tasks", "body": "<p>With Davids help (above) I have got the following solution to my problem. I post here for others if they come across a similar issue:</p>\n\n<pre><code>Sub CreateTasks()\n'\n' CreateTasks Macro\n'\n'\n'\n'Exports the contents of the ACtoins table to MS-Outlook Tasks\n\n' Set Variables\nDim olApp As Object\nDim olItem As Object\nDim oTable As Table\nDim i As Long\nDim strSubject As Range\nDim strDueDate As Range\nDim strBody As Range\nDim strSummary As String\n\nDim bStarted As Boolean\n'Dim strPupil As WdBookmark\nDim strPerson As Range\n\n\n'Link to Outlook\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then\nSet olApp = CreateObject(\"Outlook.Application\")\nbStarted = True\nEnd If\n\n'Set table variable to the bookmarked table\nSet oTable = ActiveDocument.Bookmarks(\"Actions\").Range.Tables(1)\n\n'Ignore the first (header) row of the table\nFor i = 3 To oTable.Rows.Count\n\nSet strSubject = oTable.Cell(i, 3).Range\nstrSubject.End = strSubject.End - 1\n\n\nSet strBody = oTable.Cell(i, 4).Range\nstrBody.End = strBody.End - 1\n\nSet strDueDate = oTable.Cell(i, 5).Range\nstrDueDate.End = strDueDate.End - 1\n\n\n\n'next line not working below\n'Set strPupil = WdBookmark.Name\n\n\n'Create the task\nSet olItem = olApp.CreateItem(3) 'Task Item\n\nstrSummary = Left(strSubject, 30)\n\nolItem.Subject = \"CYPP Action for\" &amp; \" \" &amp; strBody &amp; \"-\" &amp; strSummary &amp; \"...\"\nolItem.Body = strBody &amp; vbNewLine &amp; olItem.Body &amp; vbNewLine &amp; strSubject\nolItem.DueDate = strDueDate &amp; olItem.DueDate\nolItem.Categories = \"CYPP\"\nolItem.Save\n\nNext i\n\n\nIf bStarted Then olApp.Quit\nSet olApp = Nothing\nSet olItem = Nothing\nSet oTable = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>I will be adding to this to deal with empty rows but I am pleased with the functionality so far.  The DateDue is not working yet but I think that is a formatting issue.</p>\n\n<p>Thanks again David,</p>\n\n<p>Richard.</p>\n"}], "owner": {"reputation": 13, "user_id": 4198712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86450eb6529cb70b085af8362443af1e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Morris", "link": "https://stackoverflow.com/users/4198712/richard-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476369491, "creation_date": 1476312272, "last_edit_date": 1476321780, "question_id": 40009549, "link": "https://stackoverflow.com/questions/40009549/ms-word-2010-macro-to-export-table-to-outlook-tasks", "title": "MS-Word 2010 - Macro to export table to Outlook Tasks", "body": "<p>I'm trying to create a macro in MS-Word VBA to take the contents of a MS-Word table (with a bookmarked name), iterate through the rows of the table and create tasks in MS-Outlook (1 row=1 task).</p>\n\n<p>I have Googled and think I will need to try and mix together the following two scripts I have found:</p>\n\n<p>Script 1 - (For making calendar entries - not wanted, but iteration through rows - wanted)</p>\n\n<pre><code>Sub AddAppntmnt() \n'Adds a list of events contained in a three column Word table\n'with a header row, to Outlook Calendar\nDim olApp As Object\nDim olItem As Object\nDim oTable As Table\nDim i As Long\nDim bStarted As Boolean\nDim strStartDate As Range\nDim strEndDate As Range\nDim strSubject As Range\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then\nSet olApp = CreateObject(\"Outlook.Application\")\nbStarted = True\nEnd If\nSet oTable = ActiveDocument.Tables(1)\n\n'Ignore the first (header) row of the table\nFor i = 2 To oTable.Rows.Count\nSet strStartDate = oTable.Cell(i, 1).Range\nstrStartDate.End = strStartDate.End - 1\nSet strEndDate = oTable.Cell(i, 2).Range\nstrEndDate.End = strEndDate.End - 1\nSet strSubject = oTable.Cell(i, 3).Range\nstrSubject.End = strSubject.End - 1\nSet olItem = olApp.CreateItem(1)\nolItem.Start = strStartDate\nolItem.End = strEndDate\nolItem.ReminderSet = False\nolItem.AllDayEvent = True\nolItem.Subject = strSubject\nolItem.Categories = \"Events\"\nolItem.BusyStatus = 0\nolItem.Save\nNext i\nIf bStarted Then olApp.Quit\nSet olApp = Nothing\nSet olItem = Nothing\nSet oTable = Nothing\nEnd Sub\n</code></pre>\n\n<p>Script 2 - has the actual task creation bit I think I need although this one is about setting task to remind user to do something in 2 weeks or something:</p>\n\n<pre><code>Sub AddOutlookTask()\nDim olApp As Object\nDim olItem As Object\nDim bStarted As Boolean\nDim fName As String\nDim flName As String\nOn Error Resume Next\nIf ActiveDocument.Saved = False Then\nActiveDocument.Save\nIf Err.Number = 4198 Then\nMsgBox \"Process ending - document not saved!\"\nGoTo UserCancelled:\nEnd If\nEnd If\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then\n'Outlook wasn't running, start it from code\nSet olApp = CreateObject(\"Outlook.Application\")\nbStarted = True\nEnd If\nSet olItem = olApp.CreateItem(3) 'Task Item\nfName = ActiveDocument.name\nflName = ActiveDocument.FullName\nolItem.Subject = \"Follow up \" &amp; fName\nolItem.Body = \"If no reply to\" &amp; vbCr &amp; _\nflName &amp; vbCr &amp; \"further action required\"\nolItem.StartDate = Date + 10 '10 days from today\nolItem.DueDate = Date + 14 '14 days from today\nolItem.Importance = 2 'High\nolItem.Categories = InputBox(\"Category?\", \"Categories\")\nolItem.Save\nUserCancelled:\nIf bStarted Then olApp.Quit\nSet olApp = Nothing\nSet olItem = Nothing\nEnd Sub\n</code></pre>\n\n<p>How do I reference a particular table in MS-Word in code? I have bookmarked it so it has a \"name\" if that helps!</p>\n"}, {"tags": ["excel", "mailmerge", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1476311741, "creation_date": 1476311741, "answer_id": 40009485, "question_id": 40009359, "link": "https://stackoverflow.com/questions/40009359/vba-mailmerge-to-pdf-output/40009485#40009485", "title": "VBA Mailmerge to pdf Output", "body": "<p>I recorded saving a workbook as a pdf and this is the output:</p>\n\n<pre><code>ActiveDocument.ExportAsFixedFormat OutputFileName:= _\n    \"C:\\Users\\me\\Desktop\\Doc1.pdf\", ExportFormat:=wdExportFormatPDF, _\n    OpenAfterExport:=True, OptimizeFor:=wdExportOptimizeForPrint, Range:= _\n    wdExportAllDocument, From:=1, To:=1, Item:=wdExportDocumentContent, _\n    IncludeDocProps:=True, KeepIRM:=True, CreateBookmarks:= _\n    wdExportCreateNoBookmarks, DocStructureTags:=True, BitmapMissingFonts:= _\n    True, UseISO19005_1:=False\n</code></pre>\n\n<p>It seems like you might try:</p>\n\n<pre><code>objWord.ActiveDocument.ExportAsFixedFormat PeriopCertPath &amp; NewFileNamePDF,\n    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7010356, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f61ca06107832b852906213790a3d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Christine Rieger", "link": "https://stackoverflow.com/users/7010356/christine-rieger"}, "is_accepted": false, "score": 0, "last_activity_date": 1485381612, "last_edit_date": 1485381612, "creation_date": 1485379521, "answer_id": 41861940, "question_id": 40009359, "link": "https://stackoverflow.com/questions/40009359/vba-mailmerge-to-pdf-output/41861940#41861940", "title": "VBA Mailmerge to pdf Output", "body": "<p>The pdf generation always worked and I think I now have the Word bit sorted as well. This is the part of the code that generates the pdf and then closes Word (and a few other things ...)</p>\n\n<pre><code>'Print Certificate\n'Print required\nIf sh1.Cells(r, 12) = \"print\" Then\n    'remove background image\n    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\n    Selection.WholeStory\n    Selection.Cut\n    'Print Certificate\n   objWord.ActiveDocument.PrintOut\n    'Close the Mail Merge Main Document\n    objWord.ActiveDocument.Close (wdDoNotSaveChanges)\n    objMMMD.Close savechanges:=wdDoNotSaveChanges\n    Set objMMMD = Nothing\nElse\n    'Close the Mail Merge Main Document\n    objWord.ActiveDocument.Close (wdDoNotSaveChanges)\n    objMMMD.Close savechanges:=wdDoNotSaveChanges\n    Set objMMMD = Nothing\nEnd If\n\n' Create a Word Application instance\nbCreatedWordInstance = False\nSet objWord = GetObject(, \"Word.Application\")\n' Close the New Mail Merged Document\nIf bCreatedWordInstance Then\n    objWord.Quit\nEnd If\n\n0:\nSet objWord = Nothing\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7010356, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2f61ca06107832b852906213790a3d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Christine Rieger", "link": "https://stackoverflow.com/users/7010356/christine-rieger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1800, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1485381612, "creation_date": 1476311018, "last_edit_date": 1531164843, "question_id": 40009359, "link": "https://stackoverflow.com/questions/40009359/vba-mailmerge-to-pdf-output", "title": "VBA Mailmerge to pdf Output", "body": "<p>Good Morning\nI have modified the code from this post: <a href=\"https://stackoverflow.com/questions/28585226/automating-mail-merge-using-excel-vba\">Automating Mail Merge using Excel VBA</a></p>\n\n<p>But I only want pdf output but as soon as I take out the word code, it baulks. I think the problem is that if I don't save it as word, it doesn't shut the template down properly (there is code to close it). I have to manually click \"Don't Save\" and then it chokes as it tries to reopen the file for the next line. Any idea how to get around that? - Any help much appreciated. Thanks.</p>\n\n<pre><code>Public Sub MailMergeCert()\nDim bCreatedWordInstance As Boolean\nDim objWord As Word.Application\nDim objMMMD As Word.Document\n\nDim FirstName As String\nDim LastName As String\nDim Training As String\nDim SeminarDate As String\nDim HoursComp As String\nDim Location As String\nDim Objectives As String\nDim Trainer As String\n\n\nDim r As Long\nDim ThisFileName As String\n\n'Your Sheet names need to be correct in here\nSet sh1 = Sheets(\"Periop\")\n\nlastrow = Sheets(\"Periop\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nr = 2\n\nFor r = 2 To lastrow\nIf IsEmpty(Cells(r, 10).Value) = False Then GoTo nextrow\n\nFirstName = sh1.Cells(r, 1).Value\nLastName = sh1.Cells(r, 2).Value\nTraining = sh1.Cells(r, 3).Value\nSeminarDate = sh1.Cells(r, 4).Value\nHoursComp = sh1.Cells(r, 5).Value\nLocation = sh1.Cells(r, 6).Value\nObjectives = sh1.Cells(r, 7).Value\nTrainer = sh1.Cells(r, 8).Value\n\nSeminarDate = Format(sh1.Cells(r, 4).Value, \"d mmmm YYYY\")\n\n\n' Setup filenames\nConst WTempName = \"Certificate_Periop_2016.docx\" 'Template name\n\n' Setup directories\ncDir = ActiveWorkbook.Path + \"\\\" 'Change if required\nThisFileName = ThisWorkbook.Name\n\nOn Error Resume Next\n\n' Create a Word Application instance\nbCreatedWordInstance = False\nSet objWord = GetObject(, \"Word.Application\")\n\nIf objWord Is Nothing Then\n  Err.Clear\n  Set objWord = CreateObject(\"Word.Application\")\n  bCreatedWordInstance = True\nEnd If\n\nIf objWord Is Nothing Then\nMsgBox \"Could not start Word\"\nErr.Clear\nOn Error GoTo 0\nExit Sub\nEnd If\n\n' Let Word trap the errors\nOn Error GoTo 0\n\n' Set to True if you want to see the Word Doc flash past during construction\nobjWord.Visible = False\n\n'Open Word Template\nSet objMMMD = objWord.Documents.Open(cDir + WTempName)\nobjMMMD.Activate\n\n'Merge the data\nWith objMMMD\n.MailMerge.OpenDataSource Name:=cDir + ThisFileName, sqlstatement:=\"SELECT *  FROM `Periop$`\"   ' Set this as required\n\nWith objMMMD.MailMerge  'With ActiveDocument.MailMerge\n.Destination = wdSendToNewDocument\n.SuppressBlankLines = True\nWith .DataSource\n  .FirstRecord = r - 1\n  .LastRecord = r - 1\n  .ActiveRecord = r - 1\n  ' EmployeeName = .EmployeeName\nEnd With\n.Execute Pause:=False\nEnd With\nEnd With\n\n' Save new file\n'Path and YYMM\nDim PeriopCertPath As String\nPeriopCertPath = \"C:\\Users\\305015724\\Documents\\ApplicationsTraining\\2016\\Periop\\\"\nDim YYMM As String\nYYMM = Format(sh1.Cells(r, 11).Value, \"YYMM\")\n\n'Word document\nDim NewFileNameWd As String\nNewFileNameWd = YYMM &amp; \"_\" &amp; sh1.Cells(r, 12).Value &amp; \"_\" &amp; sh1.Cells(r, 2).Value &amp; \".docx\" 'Change File Name as req'd\"\nobjWord.ActiveDocument.SaveAs Filename:=PeriopCertPath &amp; NewFileNameWd\n\n'PDF\nDim NewFileNamePDF As String\nNewFileNamePDF = YYMM &amp; \"_\" &amp; sh1.Cells(r, 12).Value &amp; \"_\" &amp; sh1.Cells(r, 2).Value '&amp; \".pdf\" 'Change File Name as req'd\"\nobjWord.ActiveDocument.ExportAsFixedFormat PeriopCertPath &amp; NewFileNamePDF, ExportFormat:=wdExportFormatPDF\n\n' Close the Mail Merge Main Document\nobjMMMD.Close savechanges:=wdDoNotSaveChanges\nSet objMMMD = Nothing\n\n' Close the New Mail Merged Document\nIf bCreatedWordInstance Then\nobjWord.Quit\nEnd If\n\n0:\nSet objWord = Nothing\nCells(r, 10).Value = Date\nnextrow:\n\nNext r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1476311185, "post_id": 40009260, "comment_id": 67296876, "body": "First run a <code>select</code> query to see if the id already exists, then run either an update or an insert depending on the results"}, {"owner": {"reputation": 15, "user_id": 7010510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/426f4a015990c9e976a21578a469bdc0?s=128&d=identicon&r=PG&f=1", "display_name": "afrocode", "link": "https://stackoverflow.com/users/7010510/afrocode"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476313982, "post_id": 40009260, "comment_id": 67297675, "body": "I&#39;m not sure where to add that code or even how. I&#39;m not very familiar of using SQL in VBA. But I added the code that I have for now."}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 12289278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12b34f4abebb01b7f0fbe429292d12?s=128&d=identicon&r=PG&f=1", "display_name": "WIL", "link": "https://stackoverflow.com/users/12289278/wil"}, "is_accepted": false, "score": 0, "last_activity_date": 1590919236, "creation_date": 1590919236, "answer_id": 62114488, "question_id": 40009260, "link": "https://stackoverflow.com/questions/40009260/inserting-data-into-an-access-table-from-excel-with-vba/62114488#62114488", "title": "Inserting data into an Access table from Excel with VBA", "body": "<pre><code>xlFilepath = Application.ThisWorkbook.FullName\n\nSet Var = Sheets1.Range(\"A1\")\n\nConnect.Execute \"Delete * FROM [TableName] WHERE [Column Name] = \" &amp; Var &amp; \"\"\n\nSQL = \"INSERT INTO tbl_TCM_MAA_Data \" &amp; _\n\n\"SELECT * FROM [Excel 12.0 Macro;HDR=YES;DATABASE=\" &amp; xlFilepath &amp; \"].[SheetName$A2:O2] where [Column Name] &gt; 1\"\n\nConnect.Execute SQL\n</code></pre>\n\n<p>Warning in your Datasheet Table The first 8 rows. Assuming theres a Heading (HDR=YES)\nthe next 6 rows should contain a dummy data to define your columns equivalent to your access table column definition.</p>\n"}], "owner": {"reputation": 15, "user_id": 7010510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/426f4a015990c9e976a21578a469bdc0?s=128&d=identicon&r=PG&f=1", "display_name": "afrocode", "link": "https://stackoverflow.com/users/7010510/afrocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 9067, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1617375650, "creation_date": 1476310566, "last_edit_date": 1593694000, "question_id": 40009260, "link": "https://stackoverflow.com/questions/40009260/inserting-data-into-an-access-table-from-excel-with-vba", "title": "Inserting data into an Access table from Excel with VBA", "body": "<p>I need help inserting data into an Access table from a row of record in Excel. I was able to do that using the code here (<a href=\"https://stackoverflow.com/questions/4226004/insert-data-from-excel-into-access-using-vba\">Insert Data from Excel into Access using VBA</a>), but I have a problem of inserting a record that is already in the table because of the same primary key value.</p>\n\n<p>What I want is to be able to update the record or delete the record and enter a new one with the same key.</p>\n\n<p>Any help is appreciated.</p>\n\n<pre><code>Dim Connect As ADODB.Connection\nSet Connect = New ADODB.Connection\n\n\nConnect.Open \"Provider=Microsoft.Ace.OLEDB.12.0;Data Source=C:\\Users\\ExcelFileName.xlsm;Extended Properties=Excel 8.0;\" &amp; \"Persist Security Info=False\"\nConnect.Execute \"INSERT INTO tbl_TCM_MAA_Data IN 'C:\\DataBaseFileName.accdb' SELECT * FROM [SheetName$A2:O2]\"\n\nConnect.Close\nSet Connect = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "graph"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 3, "creation_date": 1476330832, "post_id": 40009069, "comment_id": 67301813, "body": "The best thing to do is go to your boss and tell him that you have a better way.  Have one worksheet for the view and one for the model.  It would be better if you could just query an external workbook that you would use as a database."}, {"owner": {"reputation": 39, "user_id": 5071734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c56b6531596a4f4a9a254ef5fa8d54?s=128&d=identicon&r=PG&f=1", "display_name": "gg2104", "link": "https://stackoverflow.com/users/5071734/gg2104"}, "edited": false, "score": 0, "creation_date": 1476363027, "post_id": 40009069, "comment_id": 67319694, "body": "Yeah, it seems like I&#39;m going to have to convince people that this is the better option. Thanks."}], "owner": {"reputation": 39, "user_id": 5071734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c56b6531596a4f4a9a254ef5fa8d54?s=128&d=identicon&r=PG&f=1", "display_name": "gg2104", "link": "https://stackoverflow.com/users/5071734/gg2104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476309563, "creation_date": 1476309563, "question_id": 40009069, "link": "https://stackoverflow.com/questions/40009069/adding-copying-over-1-000-sheets-within-graph-traversal", "title": "Adding/Copying over 1,000 sheets within graph traversal", "body": "<p>Sorry if this is a little long.</p>\n\n<p>I was asked to take a list of all company employees, create a hierarchical structure that relates employees and their managers, and then make an interface that takes a supervisor ID and outputs a new workbook with separate sheets for each employee beneath them (up to 3 levels) that contains information about the employee replacing the placeholders in a template summary.</p>\n\n<p>I am currently successfully creating and populating a directed graph with nodes that have the employee ID as a key and Person objects as the data. \nThe problem that I am having is when I try to expand on the traverse graph method in order to the separate employee summary sheets in a new workbook. </p>\n\n<p>I wrote the code below to create the sheets, which can complete the task if there are only ~500 employees below the given supervisor \u2013 however, there are certain supervisors that can have up to 2,000 employees under them that are within the 3-level depth. With these supervisors, the program will run for around 10 minutes before completely freezing or crashing, and because I am printing to the immediate screen I can see that it seems to go to each employee/create each sheet at a slower and slower pace.  </p>\n\n<p>I know that it is something about the copying/adding of the worksheets that is doing this, because simply doing a Debug.Print of the de-queue-d node\u2019s Person data within the traversal rather than adding a sheet will run in ~5 seconds total for any supervisor, regardless of if they have 200 or 2,000 employees beneath them.  </p>\n\n<p>I would like to know if there is a way to copy/add sheets that wouldn\u2019t create that problem, but even more than that, it seems strange to me that I was asked to put all employees under the supervisor into the same workbook if there is going to be 2,000 sheets \u2013 it doesn\u2019t seem like it would be feasible at all for the person using the program to then scroll through 1,000 odd sheets to find an employee they need to look at every time. So, I am also trying to figure out how to add a workbook for each parent node on a certain level and then have all of their children go into that specific workbook \u2013 I can\u2019t figure out how to keep track of which workbook it would go into, because there is only separation of employees between levels.</p>\n\n<p>Here is the code for the graph traversal:</p>\n\n<pre><code>Sub TraverseCreateSheets(rootS As String)\n\nDim wb As Workbook, newWb As Workbook\nSet wb = ThisWorkbook\n'the below sheet is the template sheet that I am copying to fill out\nDim managementSumTemplate As Worksheet\nSet managementSumTemplate = wb.Sheets(\"Management Summary\")\n\n\nDim maxDepth As Integer, curDepth As Integer\nmaxDepth = 3\ncurDepth = 0\n\n\nDim root As node\nSet root = pNodeList.Item(rootS)\nDim visited As Object\nSet visited = CreateObject(\"Scripting.Dictionary\")\n\nDim queue As Object\nSet queue = CreateObject(\"System.Collections.Queue\")\nqueue.Enqueue root\n\nDim nullNode As node\nSet nullNode = New node\nnullNode.Key = \"NULLNODE\"\nqueue.Enqueue nullNode\n\nWorkbooks.Add\nSet newWb = ActiveWorkbook\n\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\n\n'implementation of breadth first search using a queue\n'because I had to be able to limit the levels correctly\nDim currentNode As node\nDo While queue.Count &lt;&gt; 0\n    Set currentNode = queue.Dequeue()\n\n    If Not visited.Exists(currentNode.Key) Then\n\n\n        If currentNode.Key = \"NULLNODE\" Then\n            curDepth = curDepth + 1\n            If curDepth &gt; maxDepth Then\n                Exit Do\n            End If\n\n            queue.Enqueue nullNode\n            Dim peekNode As node\n            Set peekNode = queue.Peek\n            If peekNode.Key = \"NULLNODE\" Then\n                Exit Do\n            End If\n        End If\n\n        If Not currentNode.Key = \"NULLNODE\" Then\n            visited.Add currentNode.Key, currentNode\n\n\n            Dim curPer As Person\n            Set curPer = currentNode.Data\n            'just doing the below debug statement without any sheet additions can make entire traversal only take 5 seconds \n            Debug.Print \"ID: \" &amp; currentNode.Key &amp; \" Name: \" &amp; curPer.Name &amp; _\n                \" Location: \" &amp; curPer.Location &amp; \" PyrHead: \" &amp; curPer.PyrHead &amp; _\n                \" Job: \" &amp; curPer.Job &amp; \" Job Entry: \" &amp; curPer.JobEntry &amp; \" Time in Pos: \" &amp; curPer.TimeInPos &amp; _\n                \" Hire Date: \" &amp; curPer.HireDate &amp; \" Supervisor ID \" &amp; curPer.SupervisorID &amp; \" Supervisor \" &amp; curPer.Supervisor\n\n\n            'adding the worksheet here, since I am copying the \n            'sheet I have to rename\n            Dim reportSheet As Worksheet\n            managementSumTemplate.Copy Before:=newWb.Sheets(1)\n            Set reportSheet = newWb.Worksheets(\"Management Summary\")\n            reportSheet.Name = currentNode.Key\n\n            reportSheet.Range(\"A7\").Value = curPer.Location\n            reportSheet.Range(\"A8\").Value = curPer.PyrHead\n            reportSheet.Range(\"B7\").Value = curPer.Name\n            reportSheet.Range(\"B8\").Value = curPer.Job\n            reportSheet.Range(\"B10\").Value = curPer.HireDate\n            reportSheet.Range(\"B11\").Value = curPer.JobEntry\n            reportSheet.Range(\"B12\").Value = curPer.TimeInPos\n\n\n\n            For Each neighbor In currentNode.Neighbors\n                queue.Enqueue neighbor\n            Next neighbor\n        End If\n    End If\n\nLoop\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1476309123, "post_id": 40008263, "comment_id": 67296066, "body": "A range address should follow the exclamation mark.  If you want to import the used range of the worksheet and a specific range then you should remove the exclamation mark."}, {"owner": {"reputation": 1, "user_id": 7010195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1343bcf2f9596158e9826cca82afb7e?s=128&d=identicon&r=PG&f=1", "display_name": "L. Galati", "link": "https://stackoverflow.com/users/7010195/l-galati"}, "edited": false, "score": 0, "creation_date": 1476365057, "post_id": 40008263, "comment_id": 67321454, "body": "Does not matter if i specify a range or not, the problem lies with the pound/hashtag symbol."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7010195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1343bcf2f9596158e9826cca82afb7e?s=128&d=identicon&r=PG&f=1", "display_name": "L. Galati", "link": "https://stackoverflow.com/users/7010195/l-galati"}, "is_accepted": true, "score": 0, "last_activity_date": 1476366003, "creation_date": 1476366003, "answer_id": 40022655, "question_id": 40008263, "link": "https://stackoverflow.com/questions/40008263/error-using-transferspreadsheet-acimport-in-vba-with-a-worksheet-that-has-pound/40022655#40022655", "title": "Error using transferspreadsheet acimport in VBA with a worksheet that has pound (#) signs in the name", "body": "<p>So I've discovered the solution to this. I needed to use a STRING data type declaration while also surrounding the name of the tab in single quotes:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"tTest\", \"C:\\Users\\tnh3spb\\Desktop\\test.xlsx\", True, \"'#test#$'\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7010195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1343bcf2f9596158e9826cca82afb7e?s=128&d=identicon&r=PG&f=1", "display_name": "L. Galati", "link": "https://stackoverflow.com/users/7010195/l-galati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 40022655, "answer_count": 1, "score": 0, "last_activity_date": 1476366003, "creation_date": 1476306037, "last_edit_date": 1531164843, "question_id": 40008263, "link": "https://stackoverflow.com/questions/40008263/error-using-transferspreadsheet-acimport-in-vba-with-a-worksheet-that-has-pound", "title": "Error using transferspreadsheet acimport in VBA with a worksheet that has pound (#) signs in the name", "body": "<p>I am attempting to transfer data from excel to an Access table using the transferspreadsheet function with the acimport option but am getting an error. The worksheet that I'm importing has pound signs in the name (this is non-negotiable). I know that I can open the file via excel object, but don't want to go that route.</p>\n\n<p>Using the following code:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"tTest\", \"C:\\Users\\tnh3spb\\Desktop\\test.xlsx\", True, \"#test#!\"\n</code></pre>\n\n<p>or likewise</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"tTest\", \"C:\\Users\\tnh3spb\\Desktop\\test.xlsx\", True, \"\" &amp; Chr(35) &amp; \"test\" &amp; Chr(35) &amp; \"!\"\n</code></pre>\n\n<p>gives me the same error where the worksheet cannot be found and the pound signs have been changed to periods (.)\n<a href=\"https://i.stack.imgur.com/tcZLI.png\" rel=\"nofollow\">VBA Error</a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1476303244, "post_id": 40007403, "comment_id": 67293088, "body": "Lots of relevant answers come up in Google seacrh for &quot;vba pages insert in tab control&quot;"}, {"owner": {"reputation": 187, "user_id": 5346791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ad56c1d80df971c1c5313f59702832?s=128&d=identicon&r=PG&f=1", "display_name": "Huntdogg", "link": "https://stackoverflow.com/users/5346791/huntdogg"}, "edited": false, "score": 0, "creation_date": 1476303929, "post_id": 40007403, "comment_id": 67293451, "body": "This will probably lead you in the right direction: <a href=\"https://www.experts-exchange.com/questions/27798635/Can&#39;t-programmatically-add-pages-in-tab-control.html\" rel=\"nofollow noreferrer\">Expert Exchange</a>"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1476324884, "post_id": 40007403, "comment_id": 67300364, "body": "the real problem is that you have to open the form in design mode. And once you added that tab, then what? You have to now start writing code to add controls. if this is a one time form create controls then fine, but any design that attempts to &quot;self&quot; modify or create controls at runtime is doomed to failure. You can&#39;t compile such applications, nor can you use the free runtime to distribute such applications. And the reason why you can&#39;t find examples is because no one attempts this kind of design that in practical terms never works well. Simple advice here is &quot;dont&#39; do it!&quot;"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1476364772, "post_id": 40007403, "comment_id": 67321227, "body": "So the idea I had was (and I was going to do this in stages as I figured each stage out) to click a button, have it insert a page, copy the format of another page (copy and paste basically) and then link to the next existing record in a table. What I&#39;m getting is this is impossible? Just trying to make sure before I scrap this project."}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476303274, "creation_date": 1476302728, "last_edit_date": 1476303274, "question_id": 40007403, "link": "https://stackoverflow.com/questions/40007403/inserting-a-new-page-tab-using-vba-in-access", "title": "Inserting a new Page/tab using VBA in Access", "body": "<p>I'm terrible with code and I've been searching around without success. I'm sure this has got to be something easy which is why I'm surprised I haven't found it. Maybe I'm using the wrong terminology. In any case. I have setup a button that I want to be able to click and it automatically add a new Page/Tab (usually you right click and select \"insert Page\" which then adds a new page/tab in my form). I have the button set and all that's missing is the code. Does anyone know where a good resource is where I can find it? Or if you happen to have it pass it along? I'd greatly appreciate it!</p>\n\n<p>-Deke</p>\n"}, {"tags": ["excel", "vba", "formula-editor"], "comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1476302360, "post_id": 40007077, "comment_id": 67292614, "body": "What have you tried so far? It may be easier for you to do it without VBA. Look into the <code>=IF</code> function in Excel."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1476302431, "post_id": 40007077, "comment_id": 67292654, "body": "You need to use a nested <code>If</code> statement. Read about it <a href=\"https://www.techonthenet.com/excel/formulas/if_nested.php\" rel=\"nofollow noreferrer\">here</a>. Your formula will be something like <code>=IF(AND(A1&gt;=TIMEVALUE(&quot;08:00:00&quot;),A1&lt;TIMEVALUE(&quot;18:00:00&quot;), ...</code>"}, {"owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 1, "creation_date": 1476302535, "post_id": 40007077, "comment_id": 67292726, "body": "Tony solved it below. Tony you legend. I was trying this function but could not work it out."}, {"owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 0, "creation_date": 1476303007, "post_id": 40007077, "comment_id": 67292967, "body": "Likewise if I am trying to apply this to a number sequence that requires more than 3 inputs can I still us the IF function? I also need to convert age ranges to text"}, {"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "edited": false, "score": 0, "creation_date": 1476304522, "post_id": 40007077, "comment_id": 67293741, "body": "@Medberry, sure, just remember to balance your parenthesis.  Check out the Switch function too if your result set is finite enough."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 0, "creation_date": 1476303617, "post_id": 40007308, "comment_id": 67293273, "body": "Tony thanks, that works great. Can I use it for more than 3 values. For example I have a column that has ages in it."}, {"owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 0, "creation_date": 1476303698, "post_id": 40007308, "comment_id": 67293319, "body": "&lt;0.1 Neonate &lt;1 Infant &lt;5 Toddler &lt;16 Child &lt;80 Adult &gt;80 Elderly"}, {"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "reply_to_user": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 0, "creation_date": 1476305045, "post_id": 40007308, "comment_id": 67294005, "body": "@Medberry... <code>=IF(A2&gt;=80,&quot;Elderly&quot;,IF(A2&gt;=16,&quot;Adult&quot;,IF(A2&gt;=5,&quot;Child&quot;,IF(A&zwnj;&#8203;2&gt;=1,&quot;Toddler&quot;,IF(A2&zwnj;&#8203;&gt;=0.1,&quot;Infant&quot;,&quot;Neon&zwnj;&#8203;ate&quot;)))))</code>"}, {"owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "edited": false, "score": 0, "creation_date": 1476305122, "post_id": 40007308, "comment_id": 67294049, "body": "Tony, thanks. I worked it out and we came up with the same values. Thanks so much for your help."}], "tags": [], "owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "is_accepted": true, "score": 0, "last_activity_date": 1476302388, "creation_date": 1476302388, "answer_id": 40007308, "question_id": 40007077, "link": "https://stackoverflow.com/questions/40007077/convert-time-range-to-a-text-value/40007308#40007308", "title": "Convert time range to a text value", "body": "<p>You don't need VBA.  Assuming your time value is in A2, Try this:</p>\n\n<pre><code> =IF(HOUR(A2)&gt;=18,\"E\",IF(HOUR(A2)&gt;=8,\"D\",\"N\"))\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5435297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4220a7b7ea9893cacff669d04d45d0?s=128&d=identicon&r=PG&f=1", "display_name": "Medberry", "link": "https://stackoverflow.com/users/5435297/medberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 0, "accepted_answer_id": 40007308, "answer_count": 1, "score": 2, "last_activity_date": 1476302388, "creation_date": 1476301533, "question_id": 40007077, "link": "https://stackoverflow.com/questions/40007077/convert-time-range-to-a-text-value", "title": "Convert time range to a text value", "body": "<p>I have a table in excel that has a column with times in it hh:mm:ss\nI want to convert it so that anything from:\n08:00:00 to 17:59:59 is the text value D\n18:00:00 to 23:59:59 is the text value E\n00:00:00 to 07:59:59 is the text value N</p>\n\n<p>I am having issues doing this and wondered if you could help?</p>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1476301146, "post_id": 40006907, "comment_id": 67291987, "body": "<code>Sheet.PageSetup.PrintArea = &quot;$B$2:$K$55&quot;</code>"}, {"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476301514, "post_id": 40006907, "comment_id": 67292168, "body": "@Slai Thanks that worked"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476303356, "post_id": 40006907, "comment_id": 67293134, "body": "After changing the code to use <code>Sheet.PageSetup.PrintArea</code>, it would be a good idea to also get rid of the <code>Sheet.Activate</code> and <code>Range(&quot;B2:K55&quot;).Select</code> statements, as they are not needed if you are just trying to set the <code>PrintArea</code>."}], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 1387428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134205a91079aea4e705bc182c4e8cd?s=128&d=identicon&r=PG&f=1", "display_name": "JeremyE", "link": "https://stackoverflow.com/users/1387428/jeremye"}, "is_accepted": true, "score": 1, "last_activity_date": 1476457776, "last_edit_date": 1476457776, "creation_date": 1476302043, "answer_id": 40007209, "question_id": 40006907, "link": "https://stackoverflow.com/questions/40006907/set-print-area-for-all-visible-sheets-in-workbook/40007209#40007209", "title": "Set Print Area for All Visible Sheets in Workbook", "body": "<p>It looks like there are two issues with the code provided.</p>\n\n<p>First, There is a syntax error in the <code>with</code> statement. Each property accessed inside the <code>with</code> statement should have a dot before it.</p>\n\n<p>Second, the <code>ActiveSheet.Name</code> is not the object that includes the <code>Range</code> and <code>PageSetup</code> Method/object. It's the <code>ActiveSheet</code> object.</p>\n\n<p>The corrected code should look like:</p>\n\n<pre><code>With ActiveSheet\n  .Range(\"B2:K55\").Select\n  .PageSetup.PrintArea = \"$B$2:$K$55\"\nEnd With\n</code></pre>\n\n<p>The MSDN article for PageSetup provides an example as well:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff196103.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff196103.aspx</a></p>\n"}], "owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 40007209, "answer_count": 1, "score": 0, "last_activity_date": 1476457776, "creation_date": 1476300831, "last_edit_date": 1531164843, "question_id": 40006907, "link": "https://stackoverflow.com/questions/40006907/set-print-area-for-all-visible-sheets-in-workbook", "title": "Set Print Area for All Visible Sheets in Workbook", "body": "<p>Attempting to set the print area for all visible sheets in my workbook however I am getting an \"object required\" error on line <code>PageSetup.PrintArea = \"$B$2:$K$55</code></p>\n\n<p>Any help on how to fix this error is appreciated.</p>\n\n<p>Here is a copy of my full code.</p>\n\n<pre><code>Private Sub YesPrint_Click()\nDim Sheet As Worksheet\nDim CompareTool As Workbook\nDim Sheetname As String\nSet CompareTool = ThisWorkbook\n\n\nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n\nFor Each Sheet In CompareTool.Worksheets\n    If Sheet.Visible = True Then\n    Sheet.Activate\n        With ActiveSheet.Name\n        Range(\"B2:K55\").Select\n        PageSetup.PrintArea = \"$B$2:$K$55\"\n        End With\n    End If\nNext Sheet\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1476301044, "post_id": 40006883, "comment_id": 67291940, "body": "You create a second instance of Excel (<code>xlobj</code>) and select a range there, but then you use <code>Selection</code> which belongs to your current instance of Excel that hosts the running code, not <code>xlobj</code>. Instead of trying to fix this situation, <a href=\"http://stackoverflow.com/q/10714251/11683\">remove it altogether</a>."}, {"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476303443, "post_id": 40006883, "comment_id": 67293177, "body": "<code>code</code>FolderPath = &quot;\\\\edcfs2\\share2\\nathsh\\XenApp\\Desktop\\Getit\\&quot;      <code>code</code>    FileName = Dir(FolderPath &amp; &quot;*-Report.xlsm&quot;)          <code>code</code>Application.DisplayAlerts = False&#39;  <code>code</code>    Do While FileName &lt;&gt; &quot;&quot;  <code>code</code>        Workbooks.Open (FolderPath &amp; FileName), False, True                 <code>code</code> Application.ScreenUpdating = False <code>code</code>        Workbooks(FileName).Activate         <code>code</code>Sheets(&quot;Narrative Report&quot;).Select  Now that I transformed my code, I am getting a subscript (runtime 9) error at the last line. Workbook indicated is open (and a different sheet is selected)"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1476303652, "post_id": 40006883, "comment_id": 67293289, "body": "@Dingo you can update your question with the updated code, but note that any part of the code that relies on .Select, .Activate, .Copy, etc. can easily cause error by the user clicking or copying something while the macro runs."}, {"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "edited": false, "score": 0, "creation_date": 1476303860, "post_id": 40006883, "comment_id": 67293404, "body": "I see, I have to make a decision then :)"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "edited": false, "score": 0, "creation_date": 1476303399, "post_id": 40007504, "comment_id": 67293159, "body": "Thank you. Going forward I will use this (unfortunately since this answer came bit late, I&#39;ve transformed my code to avoid using objects)"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 2, "last_activity_date": 1476303090, "creation_date": 1476303090, "answer_id": 40007504, "question_id": 40006883, "link": "https://stackoverflow.com/questions/40006883/using-selection-with-excel-objects/40007504#40007504", "title": "Using Selection with Excel Objects", "body": "<p>Here is one way to avoid the .Select and .Copy</p>\n\n<pre><code>With xlobj.Worksheets(\"Control\").Cells\n    .Range(\"A3:P1500\").Formula = .Range(\"A3:P3\").Formula \n    .ClearFormats\n    .Value = .Value     ' converts the formulas to values\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40007504, "answer_count": 1, "score": 0, "last_activity_date": 1476303090, "creation_date": 1476300739, "question_id": 40006883, "link": "https://stackoverflow.com/questions/40006883/using-selection-with-excel-objects", "title": "Using Selection with Excel Objects", "body": "<pre><code>    xlobj.Worksheets(\"Control\").Range(\"A3:P3\").Select\n    Selection.AutoFill Destination:=Range(\"A3:P1500\"), Type:=xlFillDefault\n\n    xlobj.Worksheets(\"Control\").Select\n    Selection.ClearFormats\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n\n<p>Hi,</p>\n\n<p>I have the above code but it errors out (Run time error 1004: Subscript out of range) at the 2nd line above. I see that it has a problem of identifying the 'selection' using the object.</p>\n\n<p>How can I go around this? I want to pull down the formulas from range A3 to P3</p>\n\n<p>Thanks for the help! (this would help me with other selection issues in the code as well)</p>\n\n<p>Also, above this code somewhere, I have this (defined)</p>\n\n<pre><code>    Set xlobj = CreateObject(\"Excel.Application\")\n    xlobj.DisplayAlerts = 0\n    xlobj.Workbooks.Open wbPathName &amp; \"\\\" &amp; wbList(intListCounter), False, True\n    DoEvents\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "edited": false, "score": 0, "creation_date": 1476300766, "post_id": 40006789, "comment_id": 67291787, "body": "I apologize for not making it clear in the beginning, but the point of this loop and the sub is to count the number of rows in the table. However, using xldown is not an option because the &quot;valid from&quot; is in the middle of the table. So the logic is that the loop counts to the Valid from column, and checks that column for how many rows it has"}, {"owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "edited": false, "score": 0, "creation_date": 1476300848, "post_id": 40006789, "comment_id": 67291836, "body": "One more thing: no other column besides &quot;Valid from&quot; is guaranteed to be filled without blanks"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1476300332, "creation_date": 1476300332, "answer_id": 40006789, "question_id": 40006679, "link": "https://stackoverflow.com/questions/40006679/changing-a-cell-formula-based-on-for-loop-iteration/40006789#40006789", "title": "Changing a cell formula based on for loop iteration", "body": "<p>A couple of things.</p>\n\n<p>In vba when you put <code>X=Y=Z</code> X becomes a Boolean value based on whether y = z or not.</p>\n\n<p>So when you write:</p>\n\n<pre><code>totalrow = ActiveWorkbook.Sheets(\"Customer_Facing_View\").Range(\"AR1\").Formula = \"=COUNTA($\" &amp; i &amp; \":$\" &amp; i &amp; \")\"\n</code></pre>\n\n<p>Totalrow is returning false because the formula in that cell is not the same as the string you have provided.</p>\n\n<p>Second your COUNT A will resolve to a row not a column.  <code>i</code> is a number and not a letter.</p>\n\n<p>So remove the <code>totalrow =</code> from the first expression and change the range reference.</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Customer_Facing_View\").Range(\"AR1\").Formula = \"=COUNTA(\" &amp; Columns(i).Address &amp;\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7010344, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/30860678f4b5b6fb1f7acc85dbef3def?s=128&d=identicon&r=PG", "display_name": "Galen", "link": "https://stackoverflow.com/users/7010344/galen"}, "is_accepted": false, "score": 0, "last_activity_date": 1476307751, "last_edit_date": 1476307751, "creation_date": 1476307006, "answer_id": 40008498, "question_id": 40006679, "link": "https://stackoverflow.com/questions/40006679/changing-a-cell-formula-based-on-for-loop-iteration/40008498#40008498", "title": "Changing a cell formula based on for loop iteration", "body": "<p>I guess you would like to write a formula into Cell AR1 to calculate the number of rows (with the first totalrow statement); and get that value back (with the second totalrow statement). But I believe the first totalrow statement is wrong as Scott indicated. You need change it. </p>\n\n<p>Also for the Counta formula you need to include your original worksheet name otherwise it just count the column in the Customer_Facing_View worksheet.</p>\n"}], "owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 40006789, "answer_count": 2, "score": 0, "last_activity_date": 1476307751, "creation_date": 1476299874, "question_id": 40006679, "link": "https://stackoverflow.com/questions/40006679/changing-a-cell-formula-based-on-for-loop-iteration", "title": "Changing a cell formula based on for loop iteration", "body": "<p>I am trying to insert and change a counta formula based on the iteration of the for loop. The problem I am facing is that even  though the code runs without error, nothing happens. The totalrow variable is consistently 0. I'm not sure where I am going wrong here. All the variable have been initialized outside the loop. CurrentColname is string, countUsedCols is long, totalRows is long.</p>\n\n<pre><code>For i = 2 To countUsedCols\n    ActiveSheet.Cells(3, i).Select\n    currentColName = ActiveSheet.Cells(3, i).Value\n    If currentColName = \"Valid From\" Then\n\n        totalrow = ActiveWorkbook.Sheets(\"Customer_Facing_View\").Range(\"AR1\").Formula = \"=COUNTA($\" &amp; i &amp; \":$\" &amp; i &amp; \")\"\n\n        totalrow = ActiveWorkbook.Sheets(\"Customer_Facing_View\").Range(\"AR1\").Value\n</code></pre>\n"}, {"tags": ["javascript", "vb.net", "vba", "internet-explorer", "ie-automation"], "comments": [{"owner": {"reputation": 7275, "user_id": 711674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7560ae5fac8aca6de538d5c28232b1c?s=128&d=identicon&r=PG", "display_name": "Will P.", "link": "https://stackoverflow.com/users/711674/will-p"}, "edited": false, "score": 0, "creation_date": 1476299899, "post_id": 40006602, "comment_id": 67291317, "body": "What is the error message you get?"}], "owner": {"reputation": 11, "user_id": 2214543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659cf564d72ba4e507c3a0d475f871bb?s=128&d=identicon&r=PG", "display_name": "user2214543", "link": "https://stackoverflow.com/users/2214543/user2214543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476299597, "creation_date": 1476299597, "question_id": 40006602, "link": "https://stackoverflow.com/questions/40006602/internet-explorer-automation-textbox-with-dropdown-when-typing", "title": "Internet Explorer Automation: textbox with dropdown when typing", "body": "<p>I am automating a page with multiple textboxes that require the text to be manually typed, <a href=\"https://i.stack.imgur.com/VIN80.png\" rel=\"nofollow\">textbox image here</a></p>\n\n<p>while typing, a dropdown with the possible matches will appear and I need to select the value to proceed. \n<a href=\"https://i.stack.imgur.com/e56Gc.png\" rel=\"nofollow\">textbox image with dropdown here</a></p>\n\n<p>If I automatically set the correct text for the textbox ex. getelementbyid().innertext or .text then I will encounter an error when I submit the form but when it is manually typed and selected it will proceed without error. How can I automate this? Any help would be much appreciated thanks.</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1476297194, "post_id": 40005872, "comment_id": 67289743, "body": "re: <code>...the docmd.openquery</code> in paragraph/section 9. Thats not VB.NET - sounds like access-vba (along with hidden forms etc to handle data). You may want to confirm and update the tags."}, {"owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1476297760, "post_id": 40005872, "comment_id": 67290084, "body": "Too right. My bad. Updated. Thank you. :)"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1476304369, "post_id": 40005872, "comment_id": 67293664, "body": "Almost sounds like authentication/permissions issue on SQL Server - NT based login?"}, {"owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "edited": false, "score": 0, "creation_date": 1476305784, "post_id": 40005872, "comment_id": 67294422, "body": "We are using SQL Server authentication on the ODBC connection and all machines are using the same user name and password."}, {"owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "edited": false, "score": 0, "creation_date": 1476307057, "post_id": 40005872, "comment_id": 67295161, "body": "To us, it feels like a primary key issue. It&#39;s the same sort of lag you get, followed by an &#39;ODBC timeout&#39; error dialogue. The one table in question, we have tried to disconnect and reconnect to see if we can make sure the primary key is properly selected, but when we reconnect to it, Access does not prompt us to select a primary key.  However, when we look at the table properties, the field we want as Primary key, is designated as such, since it is that way on the server.  It was originally created in Access, then pushed to the server, just like all of our other tables in this dB."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1476308300, "post_id": 40005872, "comment_id": 67295733, "body": "Does each user have their own local copy of the front-end database file?"}, {"owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "edited": false, "score": 0, "creation_date": 1476368049, "post_id": 40005872, "comment_id": 67323905, "body": "Everyone is running local copies, yes. But they are the same version. So, no customized or individualized versions exist."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "is_accepted": false, "score": 0, "last_activity_date": 1478199654, "creation_date": 1478199654, "answer_id": 40409312, "question_id": 40005872, "link": "https://stackoverflow.com/questions/40005872/access-table-update-fails-on-some-computers/40409312#40409312", "title": "Access Table Update fails on some computers", "body": "<p>Turns out that the issue here seems to have been an intermittent issue with Access being unable to determine which record to update due to the way we were calling details from a continuous form.</p>\n\n<p>We went back to formula on our UI and built it so there is only ever one record on a form when we try to make changes to records, so there can be no system confusion about what record to update.</p>\n\n<p>Still no clue as to why it was working intermittently, but the new iteration is working now.</p>\n\n<p>Thank you all for your questions and suggestions. :)</p>\n"}], "owner": {"reputation": 21, "user_id": 7009528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogUNCnaOgGU/AAAAAAAAAAI/AAAAAAAAAKg/WN9VIbqoL_A/photo.jpg?sz=128", "display_name": "Paul Lell", "link": "https://stackoverflow.com/users/7009528/paul-lell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478199654, "creation_date": 1476296987, "last_edit_date": 1476297727, "question_id": 40005872, "link": "https://stackoverflow.com/questions/40005872/access-table-update-fails-on-some-computers", "title": "Access Table Update fails on some computers", "body": "<p>Okay, this is kind of odd and it is driving us nuts. I'll outline what is going on as best I can, then I can provide specific details and/or code as folks request it, because I'm not sure what will be needed to suss this out.</p>\n\n<p>I have an access database I have built so our analysts can work within a queue, select records, do whatever research is needed, then either mark the record in question as okay, or fill in some blanks and mark it as needing a dispute (we work in billing).</p>\n\n<p>Basically, the database opens and a hidden form pulls the NT User Name from the local machine, then opens a visible form that queries the database via SQL ODBC to display a list of records with that NT User Name attached to them.\nThe user can then scroll through the records, select them to get more information, and click a button to mark them as okay, or another to mark them as needing a dispute.</p>\n\n<p>If they click the okay button, it fires off an update query to mark the record as okay. If they click the dispute button, then it opens a third form to show them the line item they are disputing with values from all of the other text fields on the form that they can select from/fill in. On that form there is a button to commit the dispute, which fires off another query to update the values into the same table as the 'okay' button.</p>\n\n<p>So, the issue is, that this all works perfectly on my workhorse machine, and an essentially naked test machine. It also works on another co-worker's machine. However, whenever we try to run it on two other coworkers' machines, everything works just fine, except for any of the queries that attempt to write back to the ODBC connection. All of the read-only stuff works just fine, just not the updates. But the updates work perfectly, and super-fast on my machine, my test rig, and my other co-worker's machine.</p>\n\n<p>We've tried reinstalling the ODBC connection, and the ODBC SQL Drivers. </p>\n\n<p><em>No go.</em></p>\n\n<p>We've tried just opening the table in question on the affected machines and making direct edits to the table.</p>\n\n<p><em>This works if no forms are open in the database, but as soon as we open a form, no update query will run against the table.</em></p>\n\n<p>So, we tried commenting out all code on all open forms except the docmd.openquery code for the single button we used to test the update query.</p>\n\n<p><em>No go.</em></p>\n\n<p>We even built a new form with just a button on it that triggers a new update query that makes only one simple update (Now()) to the table in question.</p>\n\n<p><em>This runs fine on its own, but times out when run off the button click from the form.</em></p>\n\n<p>We tried changing the MS Office install on one machine to 'run all from computer' to make sure all necessary components are installed/present.</p>\n\n<p><em>No go.</em></p>\n\n<p>We tried installing the ODBC connection both via the normal windows interface, and through the access linked table manager interface.</p>\n\n<p><em>No go.</em></p>\n\n<p>We tried installing both 64-bit and 32-bit ODBC connections, both under USER DSN and SYSTEM DSN, and all permutations of one and not the other that we could think of.</p>\n\n<p><em>No go.</em></p>\n\n<p>It seems that no update query will write to that table while any form is open, but works just fine with no forms open. But only on these other two machines. Everything works fine on the other three machines we've tested on, whether forms are open or not.</p>\n\n<p>We're kind of at wit's end here and don't know where to go. Google is proving unhelpful, possibly because we just don't know exactly how to search the problem out.</p>\n\n<p>Here's basic technical stuff and I am happy to provide whatever other details, code, queries, etc. that are needed to troubleshoot upon request:</p>\n\n<p><strong>OS:</strong> Windows 7 Enterprise 64-bit</p>\n\n<p><strong>Software:</strong> MS Office Enterprise 2013 32-bit</p>\n\n<p><strong>ODBC:</strong> SQL Server</p>\n\n<p>All users have admin access to their respective machines.</p>\n"}, {"tags": ["vba", "vlookup"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476297545, "post_id": 40005848, "comment_id": 67289958, "body": "Which line is raising the error?"}, {"owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476297597, "post_id": 40005848, "comment_id": 67289982, "body": "this line Worksheets(&quot;A&quot;).Activate"}, {"owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476297854, "post_id": 40005848, "comment_id": 67290140, "body": "It does exist. Just when I add the lookup coed this error pops up. Otherwise the rest of the code without lookup works perfectly."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476297902, "post_id": 40005848, "comment_id": 67290161, "body": "Why is it necessary to activate the sheet in the first place?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476298012, "post_id": 40005848, "comment_id": 67290218, "body": "Is the worksheet protected or otherwise not accessible?"}, {"owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476298761, "post_id": 40005848, "comment_id": 67290681, "body": "I am using the information in sheet A to run the entire code and then at some point I need to look at sheet B to use some other information."}, {"owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476298774, "post_id": 40005848, "comment_id": 67290692, "body": "No it is not protected."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1476305453, "post_id": 40005848, "comment_id": 67294247, "body": "Is this VBA a direct copy/paste from your VB editor, or did you make some edits here?   You have both <code>Code</code> and <code>code</code> which seems to point to edits, since the VBE would make them both lower-case..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "edited": false, "score": 0, "creation_date": 1476376710, "post_id": 40011073, "comment_id": 67330372, "body": "kpg you are right. Also after running the code I have to active the worksheet &quot;A&quot; again to let the code run the rest of the code."}], "tags": [], "owner": {"reputation": 476, "user_id": 6569087, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154248943373290/picture?type=large", "display_name": "kpg987", "link": "https://stackoverflow.com/users/6569087/kpg987"}, "is_accepted": true, "score": 0, "last_activity_date": 1476323957, "creation_date": 1476323957, "answer_id": 40011073, "question_id": 40005848, "link": "https://stackoverflow.com/questions/40005848/activate-method-of-worksheet-class-failed-vlookup-vba/40011073#40011073", "title": "activate method of worksheet class failed - vlookup - vba", "body": "<p>Your lookup range seems to be in worksheet B. Try activating worksheet B before using the lookup function. I've encountered issues trying to define ranges on one worksheet while having another activated:</p>\n\n<pre><code>Public Sub Creation()\n\nWorksheets(\"A\").Activate\n\nRandomize\nDim code As String\nDim hamid As Variant\nDim Lookup_Range As Range\ncode = 100032\n'Try here:\nWorksheets(\"B\").Activate\nSet Lookup_Range = Worksheets(\"B\").Range(\"O1:P8\")\nOn Error Resume Next\n'or here:\nWorksheets(\"B\").Activate\nhamid = Application.WorksheetFunction.VLookup(code, Lookup_Range, 2, False)\nOn Error GoTo 0\n'also made 'Code' in lookup function 'code'.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6801274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eedeb7296754483812101458ec6be0?s=128&d=identicon&r=PG&f=1", "display_name": "H.H", "link": "https://stackoverflow.com/users/6801274/h-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1374, "favorite_count": 0, "accepted_answer_id": 40011073, "answer_count": 1, "score": 0, "last_activity_date": 1476323957, "creation_date": 1476296891, "last_edit_date": 1476308966, "question_id": 40005848, "link": "https://stackoverflow.com/questions/40005848/activate-method-of-worksheet-class-failed-vlookup-vba", "title": "activate method of worksheet class failed - vlookup - vba", "body": "<p>I want to use VLOOKUP command and use a range which is in sheet B (not in the activated one A). Calling the new worksheet gives me an error of  \" 'runtime error 1004' activate method of worksheet class failed\"</p>\n\n<pre><code>Public Sub Creation()\n\n    Worksheets(\"A\").Activate\n\n    Randomize\n    Dim code As String\n    Dim hamid As Variant\n    Dim Lookup_Range As Range\n    Code = 100032\n    Set Lookup_Range = Worksheets(\"B\").Range(\"O1:P8\")\n    On Error Resume Next\n    hamid = Application.WorksheetFunction.VLookup(code, Lookup_Range, 2, False)\n    On Error GoTo 0\n\nEnd sub\n</code></pre>\n\n<p>I have tried using With command to call the new worksheet but I was not successful. I am new to VBA so please bear with me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476296835, "post_id": 40005553, "comment_id": 67289539, "body": "How many columns of data <i>should</i> there be? In your example you have 4, but the code looks like you&#39;re expecting 9. Is that always the case, 9 columns would be correct?"}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476306183, "post_id": 40005553, "comment_id": 67294635, "body": "The examples I&#39;m using for I = 3 to 0 and j = 2 To 9 are arbitrary values to test out each row and column, to make sure that when I use the MsgBox, it prints out the value I&#39;m expecting (I&#39;m not great a programming). In reality, there are up to 7 columns that would include bxxxxxx whatever, and roughly 10,000 rows of data."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476300542, "post_id": 40006069, "comment_id": 67291675, "body": "It does look like the 1st row was repeated and mixed with the second row."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476301127, "post_id": 40006069, "comment_id": 67291976, "body": "I was a like confused about your example until I seen that you expanded the data to include a third set of data.  I would think that if this was the case that you should produce an extra row.  In any case it does work on the OP&#39;s dataset. +1"}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1476450455, "post_id": 40006069, "comment_id": 67363659, "body": "Can the above be modified to not divide by 4, because what if you don&#39;t have something divisible by 4? Is there a simple way to modify the loop to find the &quot;b&quot; values and clearcontents, as well as shift based on number of b values found, plus remove their respective data cells?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1476451534, "post_id": 40006069, "comment_id": 67364512, "body": "If there is not always four data points per &quot;b&quot; values then how do you know which data points belong to which &quot;b&quot;?  By your example all &quot;b&quot; have 4 data points.  For example if there are 3 &quot;B&quot; but only 2 years in the second data point there will never be any way for Excel to know which points to remove and which to keep.  There must always be a pattern or it does not work."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1476451707, "post_id": 40006069, "comment_id": 67364637, "body": "The columns of data actually extend from A:AE. I was providing a snippet of the pattern, to figure out a method to remove those values. So the correct values should go A:AE, whereas for instance, I have a row with 4 b values starting extending to BR."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1476451815, "post_id": 40006069, "comment_id": 67364697, "body": "okay then you have an variable number of data points but every &quot;b&quot; has the same number of datapoints in each row?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1476452098, "post_id": 40006069, "comment_id": 67364916, "body": "@TravisCowart see edit.  You may need to refresh the screen.  Next time please enunciate that the data may contain more data points than what is shown and that 4 was just for ease of clarification.  We cannot guess your intentions.  Also, if this works, remember to mark as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1476472105, "post_id": 40006069, "comment_id": 67376852, "body": "It&#39;s so close, but for some reason, oArr keeps repeating values and the next row may contain values from the previous."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1476472154, "post_id": 40006069, "comment_id": 67376881, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/125744/discussion-between-travis-cowart-and-scott-craner\">continue this discussion in chat</a>."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1476477811, "post_id": 40006069, "comment_id": 67379531, "body": "Thank you Scott. I finally figured out what was happening. The oArr was collecting the values as an array for each row, but it was not storing the blank cells as values. So I replaced all blank cells through BR with dashes, and ran the sub again. Works perfect."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1476451987, "last_edit_date": 1476451987, "creation_date": 1476297641, "answer_id": 40006069, "question_id": 40005553, "link": "https://stackoverflow.com/questions/40005553/nested-loop-excel-vba-shiftleft/40006069#40006069", "title": "Nested loop Excel VBA - Shiftleft", "body": "<p>This will do what you asked:</p>\n\n<pre><code>Sub bibcheck()\nDim ws As Worksheet\nDim lastrow As Long\nDim lastclm As Long\nDim i As Long\nDim j As Long\nDim oArr(1 To 4) As Variant\nDim t As Integer\n\nSet ws = ThisWorkbook.ActiveSheet\n\nWith ws\n    lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For i = 3 To lastrow\n        lastclm = .Cells(i, .Columns.Count).End(xlToLeft).Column\n        j = Application.WorksheetFunction.CountIf(.Range(.Cells(i, 1), .Cells(i, lastclm)), \"b*\")\n        t = 1\n        For j = 1 To lastclm Step j\n            oArr(t) = .Cells(i, j).Value\n            t = t + 1\n        Next j\n        .Range(.Cells(i, 1), .Cells(i, lastclm)).ClearContents\n        .Range(.Cells(i, 1), .Cells(i, 4)).Value = oArr\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DeQWh.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/DeQWh.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/m6wGK.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/m6wGK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 40006069, "answer_count": 1, "score": 2, "last_activity_date": 1476451987, "creation_date": 1476295934, "last_edit_date": 1476451275, "question_id": 40005553, "link": "https://stackoverflow.com/questions/40005553/nested-loop-excel-vba-shiftleft", "title": "Nested loop Excel VBA - Shiftleft", "body": "<p>I have a new program I am trying to create. I imported a csv file, and the data needs cleaned up. The first row has the correct headings, while there are some mismatches with what should be assigned to the column labels.</p>\n\n<p>for example:\nCorrect row should be: </p>\n\n<pre><code>A         B     C      D\nbxxxxxxx1 1994  7890   main\n</code></pre>\n\n<p>incorrect row(s) for example:</p>\n\n<pre><code>bxxxxxxx1 bxxxxxxx2 1994 1995 7890 7891  main main\nbxxxxxxx1 bxxxxxxx2 bxxxxxxx3 bxxxxxxx4 1994 1995 1996 1997 7890 7891 7890 7891 main main main main\nbxxxxxxx1 bxxxxxxx2 bxxxxxxx3 1994 1995 1996 7890 7891 7892 main main main\nbxxxxxxx1....bxxxxxxxn 1994....yearn...7890...789n...main1....mainn\n</code></pre>\n\n<p>So the incorrect rows provide the b value multiple times, followed by their respective values, which offsets all of the rows with multiple b values. So I want to remove the bxxxxxxx2, 1995, 7891 and 2nd main, retaining the rest (shifting everything to the left to align with the column headers)</p>\n\n<p>Code I have currently:</p>\n\n<pre><code>Sub bibcheck()\n    Dim Cel As Range\n    Dim n As Integer\n    bibfound = 0\n\n    For i = 3 To 9\n        n = 0\n        For j = 2 To 9\n            Set Cel = Cells(i, j)\n\n            If Cel Like \"b*#\" Or Cel Like \"b*?\" Then\n                n = n + 1\n                '  MsgBox n  :'to verify record is found\n                Cel = \"\"    'Clear the bib record found\n\n\n            'Insert new code\n            'Use each n created per row to create a new loop for shifting to the  left\n            'skip a value, then use n again to delete that many cells to the right, continuously shifting blanks to the left.\n\n            Else  \n            End If \n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 4, "creation_date": 1476295945, "post_id": 40005317, "comment_id": 67289024, "body": "You should also probably add <code>As Boolean</code> after your function declaration."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476297830, "post_id": 40005317, "comment_id": 67290125, "body": "you can replace <code>ActiveCell.Value</code> with <code>Application.Caller</code> but please don&#39;t use VBA when there is absolutely no need for it :[ Also, any numeric value that does not evaluate to zero or error will be considered as True"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1476296152, "post_id": 40005420, "comment_id": 67289146, "body": "Also declaring an explicit return type on the function signature wouldn&#39;t hurt either - <code>Public Function SshProblem(rng As Range) As Boolean</code>; that way it returns <code>False</code> instead of <code>Variant&#47;Empty</code> and making Excel convert <i>that</i> to a Boolean value after returning. I&#39;d argue that the function is superfluous though, the VBA code isn&#39;t doing anything that can&#39;t be done with a simple Excel formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476296344, "post_id": 40005420, "comment_id": 67289239, "body": "@Mat&#39;sMug I thought the same and just assumed that the OP was using this as a learning experience.  Add a note to echo your statement."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1476296527, "post_id": 40005420, "comment_id": 67289350, "body": "The function could also be simplified to <code>Function sshProblem(rng As Range) As Boolean</code> <code>sshProblem = StrComp(rng.Value, &quot;No&quot;) = 0</code> <code>End Function</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476296776, "post_id": 40005420, "comment_id": 67289507, "body": "@YowE3K It surely can.  I wanted to give the guidance, assuming that the OP was doing this not as a end but as a learning experience.  So I simply fixed what was wrong.  But that is very concise, and I like it a lot."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476297439, "post_id": 40005420, "comment_id": 67289895, "body": "I just couldn&#39;t pass up the opportunity to complain about the use of a logical expression to test whether to set a logical variable to a logical constant with the same value as the logical expression.  (Especially when the code was so &quot;sloppy&quot; that it didn&#39;t handle the &quot;False&quot; part of the expression ;-) )  (P.S. Just in case it&#39;s not obvious - I&#39;m just joking about the &quot;sloppy&quot; coding part!!!  Well, it was no more than a <b>friendly</b> dig anyway.)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476297809, "post_id": 40005420, "comment_id": 67290110, "body": "@YowE3K I have had this discussion with Mat&#39;sMug before.  I will answer the question and fix glaring mistakes, but I will leave it to the OP to go to CodeReview to get the pointers on how to make it faster and/or simpler.  I break this rule on occasion when I feel lazy.  Today was not one of those days."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476301357, "post_id": 40005420, "comment_id": 67292093, "body": "Perfectly acceptable practice - and I usually <b>try</b> to do that too.  (Except my attempts to stick to that rule usually fail because I tend to get excited about the chance to do some coding and end up changing the OP&#39;s code despite my attempts not to.)"}, {"owner": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "edited": false, "score": 0, "creation_date": 1476364132, "post_id": 40005420, "comment_id": 67320697, "body": "Thanks to all. You are all right. The code as it is is probably futile. BUT, yes, it is part of my VBA learning curve (I&#39;m more used to javascript), and besides, this is just the beginning. The function should get more complicated in time. I need to evaluate not only if the cell value says &quot;No&quot;, but also if the value from another cell inthe row contains certain device type. Then format the cell range."}, {"owner": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "edited": false, "score": 0, "creation_date": 1476364601, "post_id": 40005420, "comment_id": 67321068, "body": "I just realize: Scott&#39;s code works very well, now, if I apply it to a range such as $I:$I it doesnt format the range, if I use =$I$6:$I$8 it then works. I have other rules applied to ranges such as $K:$K that are working fine. Any ideas?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "edited": false, "score": 0, "creation_date": 1476364771, "post_id": 40005420, "comment_id": 67321228, "body": "@JoseMendez It will work just fine if it is applied to the whole column you just need to use the upper left cell as the reference.  so <code>=sshProblem(J1)</code>  You do not want to put the full column or full range reference in the formula.  That is what the <code>Applies To:</code> box is for."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1476296266, "last_edit_date": 1476296266, "creation_date": 1476295415, "answer_id": 40005420, "question_id": 40005317, "link": "https://stackoverflow.com/questions/40005317/how-to-return-boolean-in-order-to-conditionally-format-a-cell/40005420#40005420", "title": "how to return boolean in order to conditionally format a cell?", "body": "<p>You need to pass the range into the function and not use active cell as that changes every time you change the selection:</p>\n\n<pre><code>Function sshProblem(rng As Range) As Boolean\n   Dim portStatus As String\n    portStatus = rng.Value\n    If StrComp(portStatus, \"No\") = 0 Then\n       sshProblem = True\n    End If\nEnd Function\n</code></pre>\n\n<p>Then you would call it using the upper left cell in the range over which you are formatting.</p>\n\n<p>So if I was formatting A1:A1000 the formula would be:</p>\n\n<pre><code>=sshProblem(A1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LGvh5.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/LGvh5.png\" alt=\"![enter image description here\"></a></p>\n\n<p>But as @Mat'sMug, in his infinite wisdom, stated this can be done with a simple existing formula:</p>\n\n<pre><code>=A1=\"No\"\n</code></pre>\n\n<p>No vba needed for something simple.</p>\n"}], "owner": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 40005420, "answer_count": 1, "score": 0, "last_activity_date": 1476296266, "creation_date": 1476295088, "last_edit_date": 1476295744, "question_id": 40005317, "link": "https://stackoverflow.com/questions/40005317/how-to-return-boolean-in-order-to-conditionally-format-a-cell", "title": "how to return boolean in order to conditionally format a cell?", "body": "<p>The following code in VBE should return true, so that when invoked from the Conditional Format dialog the cell is modified accordingly:</p>\n\n<pre><code>Function sshProblem()\n   Dim portStatus As String\n    portStatus = ActiveCell.Value\n    If StrComp(portStatus, \"No\") = 0 Then\n       sshProblem = True\n    End If\nEnd Function\n</code></pre>\n\n<p>If I apply this conditional settings to a cell with the value \"No\", nothing happens:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pue59.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Pue59.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476294149, "post_id": 40005014, "comment_id": 67287943, "body": "<code>createdDic</code> is not a function. You have <code>CreateDictFromColumns</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476294210, "post_id": 40005014, "comment_id": 67287986, "body": "Change the function signature to <code>Function CreateDic(...</code>"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 1, "creation_date": 1476294340, "post_id": 40005014, "comment_id": 67288068, "body": "He means change it to createdDic"}, {"owner": {"reputation": 121, "user_id": 5787031, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1243790952304028/picture?type=large", "display_name": "Austin Efnor", "link": "https://stackoverflow.com/users/5787031/austin-efnor"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476294543, "post_id": 40005014, "comment_id": 67288190, "body": "@DavidZemens This is where I get confused. Then how would I call it to pass in the sheet name and columns? Do I call it and then &quot;Set dic = createdDic&quot;? Im just no understanding exactly how this is working with a function essentially."}, {"owner": {"reputation": 121, "user_id": 5787031, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1243790952304028/picture?type=large", "display_name": "Austin Efnor", "link": "https://stackoverflow.com/users/5787031/austin-efnor"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476294725, "post_id": 40005014, "comment_id": 67288302, "body": "@Tyeler Also now it says Args not optional so refer above to more confusion of mine."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 6, "last_activity_date": 1476294949, "creation_date": 1476294949, "answer_id": 40005270, "question_id": 40005014, "link": "https://stackoverflow.com/questions/40005014/what-object-has-not-been-set-or-referenced-properly/40005270#40005270", "title": "What object has not been set or referenced properly?", "body": "<p>You should always be using <code>Option Explicit</code> in your modules. This will fail to compile code where variables aren't declared (often the case with typographical errors, etc.)</p>\n\n<p>For example, you have:</p>\n\n<pre><code>Set dic = createdDic\n</code></pre>\n\n<p>But, <code>createdDic</code> isn't the name of any existing object, object variable, or function which returns an object in the scope of your subroutine <code>UserForm_Initialize</code>.</p>\n\n<p>So what this is doing, is interpreting <code>createdDic</code> as an undeclared variable of type <code>Variant</code> which will, by default, contain an empty string or empty numeric value, which evaluates your expression to:</p>\n\n<pre><code>Set dic = \"\"  \n</code></pre>\n\n<p>Or </p>\n\n<pre><code>Set dic = Empty\n</code></pre>\n\n<p>This raises the <strong>Object Required</strong> error, because you're attempting to assign a non-object to an object variable.</p>\n\n<p>Possibly confusing you, here you are calling the function (but not returning any value from it):</p>\n\n<pre><code>Call CreateDictFromColumns(\"Schedule\", \"A\", \"B\")\n</code></pre>\n\n<p><strong>TO FIX THIS ERROR</strong></p>\n\n<p>Assign the result of <code>CreateDictFromColumns</code> to the <code>dic</code> object variable, like so:</p>\n\n<pre><code>Set dic = CreateDictFromColumns(\"Schedule\", \"A\", \"B\")\n</code></pre>\n\n<p>And ensure the return value before <code>End Function</code> is given:</p>\n\n<pre><code>Set CreateDictFromColumns = aDict\n</code></pre>\n\n<p><strong>Putting it all together:</strong></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim dic As Dictionary\nSet dic = CreateDictFromColumns(\"Schedule\", \"A\", \"B\")\nFor Each k In dic.Keys\n    MsgBox dic(k)\nNext\nWith ListBox1\n    .AddItem \"test\"\nEnd With\n\nEnd Sub\n\n'http://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary\nFunction CreateDictFromColumns(sheet As String, keyCol As String, valCol As String) As Dictionary\n    Dim aDict As Dictionary\n    Set aDict = New Dictionary\n    Dim rng As Range: Set rng = Sheets(sheet).Range(keyCol &amp; \":\" &amp; valCol)\n    Dim i As Long\n    Dim lastCol As Long '// for non-adjacent (\"A:ZZ\")\n    lastCol = rng.Columns.Count\n    For i = 1 To rng.Rows.Count\n        If (rng(i, 1).Value = \"\") Then Exit Function\n        aDict.Add rng(i, 1).Value, rng(i, lastCol).Value\n    Next\n    Set CreateDictFromColumns = aDict\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5787031, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1243790952304028/picture?type=large", "display_name": "Austin Efnor", "link": "https://stackoverflow.com/users/5787031/austin-efnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 40005270, "answer_count": 1, "score": 0, "last_activity_date": 1476294949, "creation_date": 1476294052, "question_id": 40005014, "link": "https://stackoverflow.com/questions/40005014/what-object-has-not-been-set-or-referenced-properly", "title": "What object has not been set or referenced properly?", "body": "<pre><code>Private Sub UserForm_Initialize()\nCall CreateDictFromColumns(\"Schedule\", \"A\", \"B\")\nDim dic As Dictionary\nSet dic = createdDic\nFor Each k In dic.Keys\n    MsgBox dic(k)\nNext\nWith ListBox1\n    .AddItem \"test\"\nEnd With\n\nEnd Sub\n\n'http://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary\nFunction CreateDictFromColumns(sheet As String, keyCol As String, valCol As String) As Dictionary\n    Dim aDict As Dictionary\n    Set aDict = New Dictionary\n    Dim rng As Range: Set rng = Sheets(sheet).Range(keyCol &amp; \":\" &amp; valCol)\n    Dim i As Long\n    Dim lastCol As Long '// for non-adjacent (\"A:ZZ\")\n    lastCol = rng.Columns.Count\n    For i = 1 To rng.Rows.Count\n        If (rng(i, 1).Value = \"\") Then Exit Function\n        aDict.Add rng(i, 1).Value, rng(i, lastCol).Value\n    Next\n    Set createdDic = aDict\nEnd Function\n</code></pre>\n\n<p>I continually get the error \"Object Required\", and I believe it is coming from Set <code>dic = createdDic</code> However I cannot seem to figure out as to why this is wrong. Does this object not need to be set this way, or is it set incorrectly when trying to reference a function as a dictionary? All this code is doing is attempting to create a dictionary as the column being the key, and the row being the value stored. Any additional comments would be useful in understanding a little more on how excel works, along with how declaring a dictionary as a function is handled. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1476297864, "post_id": 40004344, "comment_id": 67290144, "body": "Where&#39;s your VBA code? What have you tried so far? Have you <a href=\"https://www.bing.com/search?q=automate+internet+explorer+with+vba\" rel=\"nofollow noreferrer\">searched for an answer</a> yet?"}, {"owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1476298617, "post_id": 40004344, "comment_id": 67290584, "body": "I really don&#39;t have any. I have searched and tried different things here and there hoping that I would find a sort of cookie cutter answer that would work for what I&#39;m trying to do, but have not found anything that has worked so far. Also, my scripting skill are basically non-existing and whatever I have gotten working in the past regarding scripting is through hours of trial and error and googling."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476306995, "post_id": 40004344, "comment_id": 67295126, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18709911/pull-data-from-website-using-vba-excel-multiple-classname\" title=\"pull data from website using vba excel multiple classname\">stackoverflow.com/questions/18709911/&hellip;</a>. Move to close"}, {"owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1476309868, "post_id": 40004344, "comment_id": 67296376, "body": "I don&#39;t believe that it is, I&#39;m not trying to get image elements, at least I don&#39;t think so. I have tried different lines of code like ie.document.getelementsbyclassname but since I know next to nothing of the code syntax I&#39;m basically guessing. I essentially have code that will pull the balance of gift cards for me, <a href=\"http://stackoverflow.com/questions/39883101/excel-vba-to-enter-data-online-with-ie-and-loop-through-rows\" title=\"excel vba to enter data online with ie and loop through rows\">stackoverflow.com/questions/39883101/&hellip;</a>, and wanted to go a step further and see if it was possible to grab the &quot;Available Balance&quot; from the web site as well."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1476368540, "creation_date": 1476368540, "answer_id": 40023684, "question_id": 40004344, "link": "https://stackoverflow.com/questions/40004344/excel-vba-extract-value-from-web-site-and-insert-in-excel/40023684#40023684", "title": "Excel VBA Extract Value from Web Site and Insert in Excel", "body": "<p>After more searching, I was able to pull the info that I needed and enter it into my Excel sheet with the following.</p>\n\n<pre><code>  Dim dd As String\n  dd = IE.Document.getElementsByTagName(\"h5\")(1).innerText\n  ActiveCell.Value = dd\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529243077, "creation_date": 1529243077, "answer_id": 50897235, "question_id": 40004344, "link": "https://stackoverflow.com/questions/40004344/excel-vba-extract-value-from-web-site-and-insert-in-excel/50897235#50897235", "title": "Excel VBA Extract Value from Web Site and Insert in Excel", "body": "<p>It is also the third <code>td</code> tag within the element with className <code>\"bd-wizard-account-header\"</code> with the tag <code>table</code></p>\n\n<p>Without knowing how many tables there are you could use the equivalent CSS selector, as described above, of:</p>\n\n<pre><code>table.bd-wizard-account-header td:nth-child(3)\n</code></pre>\n\n<p>or potentially just</p>\n\n<pre><code>.bd-wizard-account-header td:nth-child(3)\n</code></pre>\n\n<hr>\n\n<p>CSS selector query on HTML supplied:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aLGik.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aLGik.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>Reference material:</strong> </p>\n\n<ol>\n<li><a href=\"https://www.w3schools.com/cssref/sel_class.asp\" rel=\"nofollow noreferrer\">CSS Class selector</a></li>\n<li><a href=\"https://www.w3schools.com/CSSref/sel_nth-child.asp\" rel=\"nofollow noreferrer\">nth-Child</a></li>\n</ol>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You can apply the selector via the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.querySelector</code></a> method of the <code>IE.Document</code>. <code>.querySelectorAll</code> if table/class index is greater than 0 i.e. there are more than one the page and the one you require is not the first.</p>\n\n<p>Example syntax:</p>\n\n<pre><code>IE.Document.querySelector(\"table.bd-wizard-account-header td:nth-child(3)\").innerText\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1529243077, "creation_date": 1476291739, "question_id": 40004344, "link": "https://stackoverflow.com/questions/40004344/excel-vba-extract-value-from-web-site-and-insert-in-excel", "title": "Excel VBA Extract Value from Web Site and Insert in Excel", "body": "<p>I'm trying to pull the \"Available Balance\" dollar amount from a web site and have the amount entered into my Excel sheet. Below is the code section from the web site and the page source is located here, <a href=\"http://pastebin.com/VsThEzEE\" rel=\"nofollow\">http://pastebin.com/VsThEzEE</a>. Thanks in advance for any suggestions.</p>\n\n<pre><code>&lt;table class=\"bd-wizard-account-header\"&gt;\n    &lt;tr&gt;\n        &lt;td valign=\"bottom\"&gt;&lt;img src=\"/Content/images/tenants/visaUS/en-us/vgCard1.png\" /&gt;&lt;/td&gt;\n        &lt;td valign=\"bottom\"&gt;&lt;h6&gt;Card Ending&lt;/h6&gt;&lt;h5&gt;0102&lt;/h5&gt;&lt;/td&gt;\n        &lt;td valign=\"bottom\"&gt;&lt;h6&gt;Available Balance&lt;/h6&gt;&lt;h5&gt;$0.00&lt;/h5&gt;&lt;/td&gt;\n        &lt;td valign=\"bottom\"&gt;&lt;h6&gt;Initial Balance&lt;/h6&gt;&lt;h5&gt;$300.00&lt;/h5&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476296825, "post_id": 40004115, "comment_id": 67289537, "body": "Which library is the <code>Picture</code> type located in?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476297248, "post_id": 40004115, "comment_id": 67289769, "body": "@Mat&#39;sMug Appears to be in the Excel Library."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476297531, "post_id": 40004115, "comment_id": 67289950, "body": "Huh, it appears to be an undocumented type."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 2, "last_activity_date": 1476299596, "creation_date": 1476299596, "answer_id": 40006601, "question_id": 40004115, "link": "https://stackoverflow.com/questions/40004115/documentation-for-pictures-and-picture-methods-and-properties-with-vba/40006601#40006601", "title": "Documentation for Pictures and Picture Methods and Properties with VBA", "body": "<p>From the interop section of MSDN:\nThe <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.excel.pictures.aspx\" rel=\"nofollow\">Pictures</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.excel.picture.aspx\" rel=\"nofollow\">Picture</a> classes.</p>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 40006601, "answer_count": 1, "score": 3, "last_activity_date": 1476299596, "creation_date": 1476291002, "last_edit_date": 1531164843, "question_id": 40004115, "link": "https://stackoverflow.com/questions/40004115/documentation-for-pictures-and-picture-methods-and-properties-with-vba", "title": "Documentation for Pictures and Picture Methods and Properties with VBA", "body": "<p>I am starting to work on a very old workbook that makes extensive use of the <code>Pictures</code> and <code>Picture</code> Objects.  These Objects are \"Hidden\" in my version of Excel <em>(2007)</em>.  I can \"Un-hide\" them in the Object Browser like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5xSqF.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/5xSqF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would now like to \"un-hide\" the documentation material in <em>VBA Help</em>, but I haven't been able to figure out how to do this.</p>\n\n<p>Does anyone know how to get VBA Help to display this material ??<br>or<br>Is anyone aware of similar documentation material availabe online ??</p>\n"}, {"tags": ["image", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1476292934, "last_edit_date": 1476292934, "creation_date": 1476292631, "answer_id": 40004607, "question_id": 40003913, "link": "https://stackoverflow.com/questions/40003913/excel-vba-issues-with-portrait-mode-pictures-addpicture/40004607#40004607", "title": "Excel VBA Issues with portrait mode pictures AddPicture", "body": "<p>Windows \"remembers\" the orientation of the picture, so what is in the Top Left corner of your screen may not actually be the Top Left corner of the picture. You will need to check the <code>.Rotation</code> property of your picture. If it's rotated (ie, not 0), you will need to adjust your code accordingly. For example:</p>\n\n<pre><code>If myObj.Rotation = 0 Or myObj.Rotation = 180 Then \n    .Height = 293\nElse\n    .Width = 293\nEnd If\n</code></pre>\n\n<p>Edit: Forgot to account for it merely being upside down</p>\n"}], "owner": {"reputation": 11, "user_id": 7009138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdroIYSdp28/AAAAAAAAAAI/AAAAAAAAArI/nHXmzy5bZpQ/photo.jpg?sz=128", "display_name": "Matt Luna", "link": "https://stackoverflow.com/users/7009138/matt-luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 850, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476292934, "creation_date": 1476290360, "last_edit_date": 1531164843, "question_id": 40003913, "link": "https://stackoverflow.com/questions/40003913/excel-vba-issues-with-portrait-mode-pictures-addpicture", "title": "Excel VBA Issues with portrait mode pictures AddPicture", "body": "<p>I am having issues with inserting a picture in portrait mode using VBA.  If the picture is in landscape mode, then the picture is inserted into the associated shape in column B.  However, if the picture is in portrait, then the picture is offset 25 columns to column AA.  Any help is greatly appreciated! </p>\n\n<pre><code>Sub cmdInsert1_Click()\n\nDim myPicture As String, MyObj As Object\n\nRange(\"b5\").Select\n\nmyPicture = Application.GetOpenFilename(\"Pictures (*.gif; *.jpg; *.bmp; *.tif),*.gif; *.jpg; *.bmp; *.tif\", , \"Select Picture to Import\")\n\nIf myPicture = \"False\" Then Exit Sub\n\nSet MyObj = ActiveSheet.Shapes.AddPicture(myPicture, False, True, Range(\"B5\").Left, Range(\"B5\").Top, -1, -1)\n\nWith MyObj\n    .Height = 293\n    .Locked = False\nEnd With\n\nSet MyObj = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "countif"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476290646, "post_id": 40003891, "comment_id": 67285819, "body": "I think you can do this with a formula and conditional formatting."}, {"owner": {"reputation": 15, "user_id": 3942970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe8a6b6fcdb4f855a1ad48b0643e2ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Lowry", "link": "https://stackoverflow.com/users/3942970/joshua-lowry"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476463242, "post_id": 40003891, "comment_id": 67372249, "body": "Conditional formatting will work - that is a much easier solution. But do you know why the countif worksheet function works and the countIFS does not?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476463463, "post_id": 40003891, "comment_id": 67372366, "body": "I&#39;m unable to replicate the problem. Have you tried fully qualifying <code>Application.WorksheetFunction.......</code>?"}, {"owner": {"reputation": 15, "user_id": 3942970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe8a6b6fcdb4f855a1ad48b0643e2ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Lowry", "link": "https://stackoverflow.com/users/3942970/joshua-lowry"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476464937, "post_id": 40003891, "comment_id": 67373059, "body": "Ah.. fully qualifying appears to have been the problem. Thanks a ton."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476465153, "post_id": 40003891, "comment_id": 67373203, "body": "No problem. I&#39;ve scratched my head a long time on that one before as well."}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1476290809, "creation_date": 1476290809, "answer_id": 40004054, "question_id": 40003891, "link": "https://stackoverflow.com/questions/40003891/vba-using-countifs-error-and-dynamic-ranges/40004054#40004054", "title": "VBA using countifs error and dynamic ranges", "body": "<p>Put this in as the formula for conditional formatting on cell A4 and then copy the formatting to the remainder of the column.</p>\n\n<pre><code>=COUNTIFS($A$4:$B$27,A4)&gt;1\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3942970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe8a6b6fcdb4f855a1ad48b0643e2ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Lowry", "link": "https://stackoverflow.com/users/3942970/joshua-lowry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 40004054, "answer_count": 1, "score": -1, "last_activity_date": 1476290809, "creation_date": 1476290301, "last_edit_date": 1476290564, "question_id": 40003891, "link": "https://stackoverflow.com/questions/40003891/vba-using-countifs-error-and-dynamic-ranges", "title": "VBA using countifs error and dynamic ranges", "body": "<p>I have the following set of mock-data in A4:B27, with row 4 holding the headers..</p>\n\n<pre><code>4. Entity Country\n5. 12   countryb\n6. 13   dave\n7. 14   dan\n8. 15   john\n9. 16   james\n10. 17  josh\n11. 18  george\n12. 19  geni\n13. 20  gina\n14. 10  countrya\n15. 10  countrya\n16. 11  country\n17. 12  countryb\n18. 12  countryb\n19. 13  brian\n20. 14  ryan\n21. 15  louis\n22. 16  tom\n23. 17  chris\n24. 18  mad\n25. 19  barb\n26. 20  james\n27. 10  countrya\n</code></pre>\n\n<p>In VBA I want to ensure there are no duplicate entity-country combinations. This would be easily seen in a worksheet with the formula \"=COUNTIFS($A$5:$A$27,A5,$B$5:$B$27,B5)\". If the returned value is greater than one, I would want to highlight the entity-country cells to show a duplicate. In the above example rows  5, 14, 15, 17, 18, and 27 would be highlighted.</p>\n\n<p>However after trying to create the VBA I'm stuck..</p>\n\n<pre><code>Sub test()\n\nDim cSheet As Worksheet\nSet cSheet = Sheets(\"CL.AL1\")\n\nDim trolSheet As Worksheet\nSet trolSheet = Sheets(\"Control Sheet\")\n\nDim currentRow As Integer, lastRow As Integer, currentColumn As Long\nDim listA As range, listB As range, cellA As String, cellB As String\n\ncSheet.Select\n\ncurrentColumn = 1\ncurrentRow = 5\nlastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\nSet listA = range(Col_Letter(currentColumn) &amp; currentRow &amp; \":\" &amp; Col_Letter(currentColumn + 1) &amp; lastRow)\nSet listB = range(Col_Letter(currentColumn + 1) &amp; currentRow &amp; \":\" &amp; Col_Letter(currentColumn + 1) &amp; lastRow)\n\n\nDo While range(\"A\" &amp; currentRow) &lt;&gt; \"\"\n\ncellA = (cSheet.range(Col_Letter(currentColumn) &amp; currentRow).Value)\ncellB = (cSheet.range(Col_Letter(currentColumn + 1) &amp; currentRow).Value)\n\nIf WorksheetFunction.CountIfs(listA, cellA, listB, cellB) &gt; 1 Then\n        Union(range(Col_Letter(currentColumn) &amp; currentRow), _\n            range(Col_Letter(currentColumn + 1) &amp; currentRow)).Select\n                With Selection.Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .Color = 49407\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\nEnd If\n\nIf currentRow = lastRow Then\n    currentRow = 5\n    currentColumn = currentColumn + 1\n    If currentColumn = 3 Then\n    Exit Do\n    End If\nElse\ncurrentRow = currentRow + 1\nEnd If\n\nLoop\n\nDebug.Print (range(Col_Letter(currentColumn) &amp; currentRow).Value)\nDebug.Print (range(Col_Letter(currentColumn + 1) &amp; currentRow).Value)\n\nEnd Sub\n\nFunction Col_Letter(lngCol As Long) As String\nDim vArr\nvArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\nCol_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>After executing the current VBA I receive a runtime 1004 error \"unable to get the countifs property of the worksheet function class\".</p>\n\n<p>So. Can anyone help correct this error OR offer an alternative solution? \nThanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 0, "last_activity_date": 1476333348, "creation_date": 1476333348, "answer_id": 40012376, "question_id": 40003510, "link": "https://stackoverflow.com/questions/40003510/how-can-i-compare-a-master-list-of-serial-numbers-and-compare-it-to-a-seperate-l/40012376#40012376", "title": "How can I compare a master list of serial numbers and compare it to a seperate list and have it mark duplicates?", "body": "<p>Sounds like you just need a loop. Perhaps something like this (air code):</p>\n\n<pre><code>Dim lngRow As Long\n\nSheets(\"Die Sizes\").Select\n\nColumns(\"A:A\").Select\nFor lngRow = 2 To 3200\n    Selection.FormatConditions.Add Type:=xlTextString, String:= _\n        \"=cells(i,ForgeSchedule!B\" &amp; lngRow &amp; \")\", TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0.399945066682943\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\nNext lngRow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7009058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28728f33b5dfe83cb27c145af0a4b32e?s=128&d=identicon&r=PG&f=1", "display_name": "greenspank34", "link": "https://stackoverflow.com/users/7009058/greenspank34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476346455, "creation_date": 1476289046, "last_edit_date": 1476346455, "question_id": 40003510, "link": "https://stackoverflow.com/questions/40003510/how-can-i-compare-a-master-list-of-serial-numbers-and-compare-it-to-a-seperate-l", "title": "How can I compare a master list of serial numbers and compare it to a seperate list and have it mark duplicates?", "body": "<pre><code>Sheets(\"Die Sizes\").Select\n\nColumns(\"A:A\").Select\nSelection.FormatConditions.Add Type:=xlTextString, String:= _\n    \"=cells(i,ForgeSchedule!B2)\", TextOperator:=xlContains\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent6\n    .TintAndShade = 0.399945066682943\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>This is what I have so far. This will compare the specific cells in the secondary list to the master list. This means I would have to rerun this one at a time changing the \"B2\" to B3 all the way to B3200. How can I get it to do that automatically? I'm very new to VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476305158, "post_id": 40003358, "comment_id": 67294078, "body": "you can click <code>A9</code> and press Ctrl+A. If that selects the range you want, then you can use <code>Range(&quot;A9&quot;).CurrentRegion.Select</code> in VBA"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6950785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75799f2502dc8bef99fd1a71059b71b?s=128&d=identicon&r=PG&f=1", "display_name": "EnergyHOU", "link": "https://stackoverflow.com/users/6950785/energyhou"}, "edited": false, "score": 0, "creation_date": 1476291170, "post_id": 40003542, "comment_id": 67286127, "body": "This is a good point, didn&#39;t think of it that way. Here&#39;s a twist though, what if there is irrelevant content in other sections of the sheet. Whether it be blank formulas for example, or an empty pivot. This method is perfect assuming the sheet is &quot;vanilla&quot; of sorts."}, {"owner": {"reputation": 1, "user_id": 6950785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75799f2502dc8bef99fd1a71059b71b?s=128&d=identicon&r=PG&f=1", "display_name": "EnergyHOU", "link": "https://stackoverflow.com/users/6950785/energyhou"}, "edited": false, "score": 0, "creation_date": 1476291198, "post_id": 40003542, "comment_id": 67286139, "body": "I suppose I could use a series of xlLeft xlUp but that&#39;s obviously not ideal"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": -1, "last_activity_date": 1476289125, "creation_date": 1476289125, "answer_id": 40003542, "question_id": 40003358, "link": "https://stackoverflow.com/questions/40003358/vba-finding-lastcol-with-lastrow-select/40003542#40003542", "title": "VBA, Finding LastCol With LastRow + Select", "body": "<p>Rather than look for the last row look for the last cell.  Then all you have to do is select everything between the first cell and last cell.</p>\n\n<p>This will fail if there's nothing on your sheet as it will try to reference row 0 and column 0 (<code>Method 'Range' of object '_Worksheet' failed</code>).</p>\n\n<p>I'd suggest using a function to find the last cell first - one that will return a range object even if the sheet is empty.  There's plenty of examples on here.</p>\n\n<pre><code>Sub test()\n\n    Dim Sheet As Worksheet\n    Dim StartCell As Range\n    Dim LastCell As Range\n\n    Set Sheet = Worksheets(\"Summary PNL (bpnl by bucket)\")\n    Set StartCell = Range(\"A9\")\n    Set LastCell = Sheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n    Sheet.Range(StartCell, LastCell).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 4534746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9419c142719689fbb84acacc4a9a8df5?s=128&d=identicon&r=PG&f=1", "display_name": "matellan", "link": "https://stackoverflow.com/users/4534746/matellan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476304428, "creation_date": 1476304428, "answer_id": 40007873, "question_id": 40003358, "link": "https://stackoverflow.com/questions/40003358/vba-finding-lastcol-with-lastrow-select/40007873#40007873", "title": "VBA, Finding LastCol With LastRow + Select", "body": "<p>If you are sure that you want to print all the cells that are not empty nor unformated, you can use:</p>\n\n<pre><code>Worksheets(\"Summary PNL (bpnl by bucket)\").UsedRange.Select\n</code></pre>\n\n<p>That will select all the range that is used.</p>\n\n<p>Anyway, to find the last cell, you can use this property with the specialcells method like this:</p>\n\n<pre><code>LastRow = Worksheets(\"Summary PNL (bpnl by bucket)\").UsedRange.SpecialCells(xlCellTypeLastCell).row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6950785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75799f2502dc8bef99fd1a71059b71b?s=128&d=identicon&r=PG&f=1", "display_name": "EnergyHOU", "link": "https://stackoverflow.com/users/6950785/energyhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476304428, "creation_date": 1476288612, "question_id": 40003358, "link": "https://stackoverflow.com/questions/40003358/vba-finding-lastcol-with-lastrow-select", "title": "VBA, Finding LastCol With LastRow + Select", "body": "<p>I have a macro that currently finds the last row on a worksheet, pairs that with a defined last column and starting cell, and then selects all of it for printing.</p>\n\n<pre><code>Set Sheet = Worksheets(\"Summary PNL (bpnl by bucket)\")\nSet StartCell = Range(\"A9\")\nLastRow = Sheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nSheet.Range(\"A9:I\" &amp; LastRow).Select\n</code></pre>\n\n<p>I am now dealing with a dynamic column in addition to a dynamic row. In theory this isn't a difficult add however row 9 only has data in column A (Range A9), B through I (example ending column) are blank on that row. Any insight?</p>\n"}, {"tags": ["vba", "excel", "ms-word", "named-ranges"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476335402, "post_id": 40004097, "comment_id": 67303065, "body": "Thanks for your reply! Its not showing the data, instead shows worksheet range on each page.( =GenForm!$A$1:$E$22, =GenForm!$A$24:$E$29, etc....). Any other reason for this ?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476370615, "post_id": 40004097, "comment_id": 67326111, "body": "See Edit - I added a simple copy/paste of the data.  It wasn&#39;t clear from your code that you wanted anything other than the range so I left that out originally."}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 2, "last_activity_date": 1476370514, "last_edit_date": 1476370514, "creation_date": 1476290943, "answer_id": 40004097, "question_id": 40003210, "link": "https://stackoverflow.com/questions/40003210/excel-vba-copy-pasting-each-named-range-to-word/40004097#40004097", "title": "Excel VBA copy pasting each named range to word", "body": "<p>It sounds like you want to copy each range onto different pages so I'm not sure why you're using a union.  Here is a quick example of copying each named range 'name' onto a new sheet in a word document.  Note: I created a new doc for simplicity.</p>\n\n<p><strong>Edit</strong> - I added copy/paste functionality of data to the end.  Formatting and such depends on what you have or want.</p>\n\n<pre><code>Sub main()\n    'Create new word document\n    Dim objWord As Object\n    Dim objDoc As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n    Set objDoc = objWord.documents.Add()\n\n    Dim intCounter As Integer\n    Dim rtarget As Word.Range\n    Dim wbBook As Workbook\n    Set wbBook = ActiveWorkbook\n\n    'Loop Through names\n    For intCounter = 1 To wbBook.Names.Count\n       Debug.Print wbBook.Names(intCounter)\n\n       With objDoc\n            Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n\n            'Insert page break if not first page\n            If intCounter &gt; 1 Then rtarget.insertbreak Type:=wdPageBreak\n\n            'Write name to new page of word document\n            rtarget.Text = wbBook.Names(intCounter).Name &amp; vbCr\n\n            'Copy data from named range\n            Range(wbBook.Names(intCounter)).Copy\n            Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n            rtarget.Paste\n       End With\n    Next intCounter\nEnd Sub\n</code></pre>\n\n<p><strong>Excel</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ISD1u.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/ISD1u.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Resulting Word Document</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8j62l.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/8j62l.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1476371013, "creation_date": 1476371013, "answer_id": 40024617, "question_id": 40003210, "link": "https://stackoverflow.com/questions/40003210/excel-vba-copy-pasting-each-named-range-to-word/40024617#40024617", "title": "Excel VBA copy pasting each named range to word", "body": "<p>I don't think this is the best solution out there (as I don't normally play with Word VBA) but I have tried this and it does seems to work: <br></p>\n\n<pre><code>Sub AddNamedRangesToWordDoc()\n\n    Dim oWord As Word.Application\n    Dim oDoc As Word.Document\n    Dim intCount As Integer\n    Dim oRng As Range\n    Dim oSelection As Object\n\n    Set oWord = New Word.Application\n    Set oDoc = oWord.Documents.Add\n    oWord.Visible = True\n\n    For intCount = 1 To ActiveWorkbook.Names.Count\n\n        Set oRng = Range(ActiveWorkbook.Names(intCount).RefersToRange.Name.Name)\n        oRng.Copy\n\n        oDoc.ActiveWindow.Selection.PasteSpecial , , 0\n        Set oSelection = oWord.Selection\n        oSelection.InsertBreak (wdPageBreak)\n\n    Next\n\n    Set oSelection = Nothing\n    Set oRng = Nothing\n    Set oDoc = Nothing\n    Set oWord = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong>: I am creating a new word application. You might have to check if word is already open and how you want to deal with an existing word doc. Also, I'm not creating the word object. I have <code>Microsoft Word xx.x Object Library</code> referenced in the project as I prefer to work with built in libraries. Also, function presumes that you only have 1 worksheet and all your ranges are in that worksheet</p>\n"}], "owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1608, "favorite_count": 0, "accepted_answer_id": 40004097, "answer_count": 2, "score": 0, "last_activity_date": 1476371013, "creation_date": 1476288174, "question_id": 40003210, "link": "https://stackoverflow.com/questions/40003210/excel-vba-copy-pasting-each-named-range-to-word", "title": "Excel VBA copy pasting each named range to word", "body": "<p>I have dynamic named range of cell. I need to paste each named range in one page of  word and move to next page for next named range. I tried copule of code, I am unable to do.Each named range data is overlapping  each other. Can anyone  help me, please.</p>\n\n<pre><code>Set wbBook = ActiveWorkbook\nSet rs = wbBook.Names(1).RefersToRange\n\nFor i = 2 To wbBook.Names.Count\n    Set rs = Union(rs, wbBook.Names(i).RefersToRange)\nNext\n\nrs.Copy\n\nWith wd.Range\n    .Collapse Direction:=0\n    .InsertParagraphAfter\n    .Collapse Direction:=0\n    .PasteSpecial False, False, True\n    Application.CutCopyMode = False\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476289229, "post_id": 40003208, "comment_id": 67284976, "body": "Make sure your function returns array:  <code>Function Base() As Base()</code>?"}, {"owner": {"reputation": 13, "user_id": 7008931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4532a893ffc54b65416c36200850684?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7008931/andy"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476289546, "post_id": 40003208, "comment_id": 67285171, "body": "It worked! Thanks bro!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476289634, "post_id": 40003208, "comment_id": 67285232, "body": "Cheers, if the solution worked, please consider marking it as &quot;Accepted&quot; answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476289964, "post_id": 40003610, "comment_id": 67285433, "body": "sorry I saw you answered some minutes ago on the &quot;main&quot; theme. If you don&#39;t mind I&#39;d leave my solution for other issues it covers"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1476289347, "creation_date": 1476289347, "answer_id": 40003610, "question_id": 40003208, "link": "https://stackoverflow.com/questions/40003208/return-a-user-defined-array-from-a-function-vba-excel/40003610#40003610", "title": "Return a User-defined Array from a function VBA-Excel", "body": "<p>You're declaring <code>A()</code> as an array of type <code>Base</code> and you're also including a function called <code>Base</code>. From a maintenance and readibility perspective, this is a bad idea, I would strongly recommend giving a different name to your function.</p>\n\n<p>That said, using simple example I can get this to work by tweaking the function signature to return an array:</p>\n\n<pre><code>Sub Test()\n\n   Dim a() As Base\n\n    a = GetBase()\n\nEnd Sub\n\nFunction GetBase() As Base()\n    Dim Total_1 As Long\n    Dim b As Long\n    b = 0\n    Total_1 = 0\n    Dim Base_UT() As Base\n    ReDim Base_UT(Total_1)\n\n        Base_UT(b).UT = \"string\"\n        Base_UT(b).N_Inic = 1\n        Base_UT(b).N_Fin = 2\n        Base_UT(b).Largo = 3\n\n    GetBase = Base_UT\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476289793, "creation_date": 1476289793, "answer_id": 40003763, "question_id": 40003208, "link": "https://stackoverflow.com/questions/40003208/return-a-user-defined-array-from-a-function-vba-excel/40003763#40003763", "title": "Return a User-defined Array from a function VBA-Excel", "body": "<p>instead of:</p>\n\n<pre><code>Function Base() As Base\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>Function Base() As Base()\n</code></pre>\n\n<p>but there other possible faults in your code, that the following code should help to avoid</p>\n\n<pre><code>Function Base1() As Base()\n    Dim b As Long, Total_1 As Long\n    Dim UT_Range As Range, cell As Range\n\n    With sheets(\"ARISTAS\")\n        Set UT_Range = .Range(.Cells(2, 1), .Cells(Rows.Count, 1).End(xlUp))\n        Total_1 = UT_Range.Count - 1\n        ReDim Base_UT(Total_1) As Base\n\n        For Each cell In UT_Range.SpecialCells(XlCellType.xlCellTypeConstants)\n            Base_UT(b).UT = cell.Value\n            Base_UT(b).N_Inic = cell.Offset(, 1).Value\n            Base_UT(b).N_Fin = cell.Offset(, 2).Value\n            Base_UT(b).Largo = cell.Offset(, 8).Value '**\n            b = b + 1\n        Next cell\n        ReDim Preserve Base_UT(b - 1)\n    End With\n\n    Base1 = Base_UT\nEnd Function\n</code></pre>\n\n<p>as you see I also changed the function name not to match the UDT name</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1476289948, "creation_date": 1476289948, "answer_id": 40003793, "question_id": 40003208, "link": "https://stackoverflow.com/questions/40003208/return-a-user-defined-array-from-a-function-vba-excel/40003793#40003793", "title": "Return a User-defined Array from a function VBA-Excel", "body": "<p>Here is a very simple example based on your question:</p>\n\n<pre><code>Type Base\n    UT As String\n    N_Inic As Integer\n    N_Fin As Integer\n    Largo As Integer\nEnd Type\n\nSub MAIN()\n    Dim alpha As Base\n    alpha = whatever()\n    MsgBox alpha.UT &amp; alpha.N_Inic &amp; alpha.N_Fin &amp; alpha.Largo\nEnd Sub\n\nPublic Function whatever() As Base\n    Dim poiuyt As Base\n\n    poiuyt.UT = \"hello\"\n    poiuyt.N_Inic = 11\n    poiuyt.N_Fin = 17\n    poiuyt.Largo = 19\n    whatever = poiuyt\nEnd Function\n</code></pre>\n\n<p>It uses an internal variable of Type <code>Base</code> within the function and just passes it back:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iDZ27.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/iDZ27.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7008931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4532a893ffc54b65416c36200850684?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7008931/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 40003610, "answer_count": 3, "score": 1, "last_activity_date": 1476289948, "creation_date": 1476288171, "last_edit_date": 1531164843, "question_id": 40003208, "link": "https://stackoverflow.com/questions/40003208/return-a-user-defined-array-from-a-function-vba-excel", "title": "Return a User-defined Array from a function VBA-Excel", "body": "<p>Hi I've been trying the different solution that this website gave me, but i can't make my code run. I have a user-defined Type() and a Sub() and a function. Like this:</p>\n\n<pre><code>Type Base\n    UT As String\n    N_Inic As Integer\n    N_Fin As Integer\n    Largo As Integer\nEnd Type\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Test()\n\n   Dim A() As Base\n\n   A = Base()\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Function Base() As Base\n    Sheets(\"ARISTAS\").Select\n    ActiveSheet.Cells(2, 1).Select\n    j = 2\n    b = 0\n    Set UT_Range = Range(ActiveCell, Cells(Rows.Count,_ Selection.Column).End(xlUp))\n    Total_1 = UT_Range.Count\n    Dim Base_UT() As Base\n    ReDim Base_UT(Total_1)\n\n    While Sheets(\"ARISTAS\").Cells(j, 1).Value\n        Base_UT(b).UT = Sheets(\"ARISTAS\").Cells(j, 1).Value \n        Base_UT(b).N_Inic = Sheets(\"ARISTAS\").Cells(j, 2).Value\n        Base_UT(b).N_Fin = Sheets(\"ARISTAS\").Cells(j, 3).Value\n        Base_UT(b).Largo = Sheets(\"ARISTAS\").Cells(j, 9).Value '**\n        b = b + 1\n        j = j + 1\n    Wend\n    Base = Base_UT\nEnd Function\n</code></pre>\n\n<p>When I run my sub it said that can't assign to a matrix and highlight \"A\"</p>\n\n<p>Does Anyone knows why?</p>\n\n<p>Thanks you So Much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476287471, "post_id": 40002870, "comment_id": 67283809, "body": "42. Mod  2. ^ 31  also crashed, unlike 42. Mod  (2. ^ 31 -1)  ... maybe an undocumented (google gave nothing) feebleness of mod. Who uses that anyway? O.O"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476287877, "post_id": 40002870, "comment_id": 67284087, "body": "<a href=\"http://www.cpearson.com/excel/ModFunction.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ModFunction.aspx</a>"}, {"owner": {"reputation": 63, "user_id": 7008578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faddba7e8f1d6b6b48892f8f10fd62f6?s=128&d=identicon&r=PG&f=1", "display_name": "B. Woodruff", "link": "https://stackoverflow.com/users/7008578/b-woodruff"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476288438, "post_id": 40002870, "comment_id": 67284472, "body": "@DavidZemens Thanks for the link! Funny thing is, I&#39;ve already tried creating my own function, still results in an overflow error. Also, the pseudo-random number generator works in worksheet form with no overflow, but I need to create a VBA function for it."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7008578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faddba7e8f1d6b6b48892f8f10fd62f6?s=128&d=identicon&r=PG&f=1", "display_name": "B. Woodruff", "link": "https://stackoverflow.com/users/7008578/b-woodruff"}, "edited": false, "score": 0, "creation_date": 1476289026, "post_id": 40003166, "comment_id": 67284845, "body": "Thanks again! I had tried creating then using a similar function and still received the overflow error. Now I&#39;ve copied and pasted Pearson&#39;s.. Still receiving an overflow error."}, {"owner": {"reputation": 63, "user_id": 7008578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faddba7e8f1d6b6b48892f8f10fd62f6?s=128&d=identicon&r=PG&f=1", "display_name": "B. Woodruff", "link": "https://stackoverflow.com/users/7008578/b-woodruff"}, "edited": false, "score": 1, "creation_date": 1476290372, "post_id": 40003166, "comment_id": 67285662, "body": "Wow, nvm.. In my initial attempt after creating Pearson&#39;s function, I was converting to longs and not doubles x). The PRNG function now works  syntatically and semantically. Thank you!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1476290445, "last_edit_date": 1525816150, "creation_date": 1476288043, "answer_id": 40003166, "question_id": 40002870, "link": "https://stackoverflow.com/questions/40002870/overflow-error-in-excel-vba-with-type-double/40003166#40003166", "title": "Overflow Error in Excel VBA with Type Double", "body": "<p>Try using Chip Pearson's <code>XMod</code> function:</p>\n\n<pre><code>x(i) = XMod((CDbl(48271) * seed), CDbl(2 ^ 31 - 1))\n</code></pre>\n\n<p>As he notes:</p>\n\n<blockquote>\n  <p>You can also get overflow errors in VBA using the Mod operator with\n  very large numbers. For example,</p>\n\n<pre><code>Dim Number As Double\nDim Divisor As Double\nDim Result As Double\n\nNumber = 2 ^ 31\nDivisor = 7\nResult = Number Mod Divisor ' Overflow error here.\n</code></pre>\n</blockquote>\n\n<p>Code for the function:</p>\n\n<pre><code>Function XMod(ByVal Number As Double, ByVal Divisor As Double) As Double\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' XMod\n' Performs the same function as Mod but will not overflow\n' with very large numbers. Both Mod and integer division ( \\ )\n' will overflow with very large numbers. XMod will not.\n' Existing code like:\n'       Result = Number Mod Divisor\n' should be changed to:\n'       Result = XMod(Number, Divisor)\n' Input values that are not integers are truncated to integers. Negative\n' numbers are converted to postive numbers.\n' This can be used in VBA code and can be called directly from \n' a worksheet cell.\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Number = Int(Abs(Number))\n    Divisor = Int(Abs(Divisor))\n    XMod = Number - (Int(Number / Divisor) * Divisor)\nEnd Function\n</code></pre>\n\n<p>Additional details:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/ModFunction.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ModFunction.aspx</a></p>\n"}], "owner": {"reputation": 63, "user_id": 7008578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faddba7e8f1d6b6b48892f8f10fd62f6?s=128&d=identicon&r=PG&f=1", "display_name": "B. Woodruff", "link": "https://stackoverflow.com/users/7008578/b-woodruff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3413, "favorite_count": 0, "accepted_answer_id": 40003166, "answer_count": 1, "score": 4, "last_activity_date": 1476290445, "creation_date": 1476287111, "last_edit_date": 1531164843, "question_id": 40002870, "link": "https://stackoverflow.com/questions/40002870/overflow-error-in-excel-vba-with-type-double", "title": "Overflow Error in Excel VBA with Type Double", "body": "<p>I have run into an overflow error in Excel VBA and cannot find my way around it. While Microsoft's documentation indicates that the range for doubles should reach ~1.8E308, I am receiving an overflow error for numbers significantly lower than that threshold. My code is as follows:</p>\n\n<pre><code>Public Function Fixed_Sample_Nums(ByVal n As Long, seed As Long) As Double()\n\n    Dim x() As Double, y() As Double, i As Long\n    ReDim y(1 To n)\n    ReDim x(1 To n)\n\n    x(1) = (CDbl(48271) * seed) Mod CDbl(2 ^ 31 - 1)\n\n    For i = 2 To n\n        x(i) = (CDbl(48271) * CDbl(x(i - 1))) Mod (CDbl(2 ^ 31 - 1))\n        y(i) = CDbl(x(i)) / CDbl(2 ^ 31 - 1)\n    Next i\n\n    Fixed_Sample_Nums = y\n\nEnd Function\n\n'I receive the error in the first iteration of the for loop with \n'seed equal to any value &gt;= 1 (i.e. w/ seed = 1): \n\nDebug.Print((CDbl(48271) * CDbl(48271)) Mod (CDbl(2 ^ 31 - 1))) \n\n'results in an overflow error \n</code></pre>\n\n<p>I am attempting to create a pseudo-random number generator that can take in any 'seed' value up to and including 2 ^ 31 - 1. The for loop should be able to iterate at least 9,999 times (i.e. n = 10000). If the overflow error is not encountered within the first few iterations, it most likely will not be encountered for any subsequent iteration. </p>\n\n<p>As you can see, I am converting each integer to a double before any calculation. I am aware of the fact that arrays substantially increase the byte size of the calculation, but that does not appear to be the current issue as I directly copied the example calculation above into the immediate window and still received the overflow error. My attempts to find a solution online have resulted in no avail, so I would really appreciate any input. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "edited": false, "score": 0, "creation_date": 1476290024, "post_id": 40003562, "comment_id": 67285462, "body": "Column B = Router 1, Column C = Router 2, Column D = Interface 1, Column E = Interface 2. There are always two interfaces. I need the data val list to reflect the interfaces form the table based off the model type select in COL C ... unless there is no second router in which it will pull the interface list of the model type in COL B."}, {"owner": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "edited": false, "score": 0, "creation_date": 1476290353, "post_id": 40003562, "comment_id": 67285648, "body": "For example: Cisco interfaces = Gi, Te. Juniper interface = ge, xe. COL B ROW()= Cisco, COL C ROW()= Juniper. I want the dropdown list of COL E to be ge or xe. But if COL E = Cisco I want it to be Gi or Te. Like I said this is an example, the list if more extensive and contains many model types. Also the reason I do not define the exact cell and using an indirect in the if function is because this is a service being build per row. So I need to use the same drop down list for 100 rows and dont want to continue to edit individual rows. I need a dynamic solution based off the choice n the cur row"}, {"owner": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "edited": false, "score": 0, "creation_date": 1476290461, "post_id": 40003562, "comment_id": 67285711, "body": "Also it is worth mentioning the data in COL B and C are the table&#39;s header values for the interfaces. Which is why I am using table references."}, {"owner": {"reputation": 61, "user_id": 2727290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165790457001f38698f22cbdda1ce16f?s=128&d=identicon&r=PG&f=1", "display_name": "Reeves", "link": "https://stackoverflow.com/users/2727290/reeves"}, "reply_to_user": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "edited": false, "score": 0, "creation_date": 1476727646, "post_id": 40003562, "comment_id": 67458547, "body": "Can you upload a simplified example?"}, {"owner": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "edited": false, "score": 0, "creation_date": 1476846682, "post_id": 40003562, "comment_id": 67513638, "body": "Figured it out, sorry. You can&#39;t  use Row() in data validation list."}], "tags": [], "owner": {"reputation": 61, "user_id": 2727290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165790457001f38698f22cbdda1ce16f?s=128&d=identicon&r=PG&f=1", "display_name": "Reeves", "link": "https://stackoverflow.com/users/2727290/reeves"}, "is_accepted": false, "score": 0, "last_activity_date": 1476289161, "creation_date": 1476289161, "answer_id": 40003562, "question_id": 40002669, "link": "https://stackoverflow.com/questions/40002669/excel-2013-using-an-indirect-in-an-if-statements-clause-for-a-data-validation/40003562#40003562", "title": "Excel 2013: Using an Indirect in an If statement&#39;s clause for a data validation list", "body": "<p>You're mixing different cell reference styles. If you think about how your formula will execute its saying \"Go check out TBL_Device_Interfaces[B3]\". You can see how to build <a href=\"https://support.office.com/en-us/article/Using-structured-references-with-Excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e\" rel=\"nofollow\">structured table references here.</a> You either need to stick with a structured table reference or switch back to a standard reference.</p>\n\n<p>Try your formula as:</p>\n\n<pre><code>=IF($C$6 = \"not used\", INDIRECT( INDIRECT(\"B\" &amp; ROW()) ), INDIRECT(INDIRECT(\"C\" &amp; ROW()) ))\n</code></pre>\n\n<p>or if you want to stick with the structured reference try:</p>\n\n<pre><code>=IF(TBL_Device_Interfaces[@Column3] = \"not used\", TBL_Device_Interfaces[@Column2], TBL_Device_Interfaces[@Column1])\n</code></pre>\n\n<p>I may have your columns wrong, but it should work.</p>\n"}], "owner": {"reputation": 71, "user_id": 6058479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pel5C.jpg?s=128&g=1", "display_name": "Legenis", "link": "https://stackoverflow.com/users/6058479/legenis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476289161, "creation_date": 1476286497, "question_id": 40002669, "link": "https://stackoverflow.com/questions/40002669/excel-2013-using-an-indirect-in-an-if-statements-clause-for-a-data-validation", "title": "Excel 2013: Using an Indirect in an If statement&#39;s clause for a data validation list", "body": "<p>I am trying to create a data validation drop down list containing available router interfaces (column E) based off the router 1's model (column B) and router 2's model (column C).</p>\n\n<p>I have working a list of interfaces (column D) for router1 using:</p>\n\n<pre><code>=INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(\"B\" &amp; ROW()) &amp; \"]\")\n</code></pre>\n\n<p>This is where I run into an issue. For Col E, I need to do the same indirect for the table list but, if current rows's COL C = \"not used\" then used COL B's value, else use COL C's value.</p>\n\n<p>I first tried this but it did not work:</p>\n\n<pre><code>=INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(IF(INDIRECT(\"C\" &amp; ROW()) = \"not used\", \"B\", \"C\") * ROW()) &amp; \"]\")\n</code></pre>\n\n<p>Then I tried, but it did not work:</p>\n\n<pre><code>=If(INDIRECT(\"C\" &amp; ROW()) = \"not used\", INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(\"B\" &amp; ROW()) &amp; \"]\"), INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(\"C\" &amp; ROW()) &amp; \"]\"))\n</code></pre>\n\n<p>But this is what is killing me. Because this works... but I need static columns but dynamic rows based off current row:</p>\n\n<pre><code>=If($C$6 = \"not used\", INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(\"B\" &amp; ROW()) &amp; \"]\"), INDIRECT(\"TBL_Device_Interfaces[\" &amp; INDIRECT(\"C\" &amp; ROW()) &amp; \"]\"))\n</code></pre>\n\n<p>NOTE: I typed this by hand off an offline PC. Sorry if there are any type-os (like spelling indirect wrong). Those would not be in the main code. I have if all working in segments but I cannot get it to work in data validation.</p>\n\n<p>I am also up to is there is another way to create a drop down list. I just need to be able to reference values tables using index/match and indirects.</p>\n"}, {"tags": ["excel", "string", "vba", "list"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1476286280, "post_id": 40002531, "comment_id": 67282928, "body": "<code>Split(&quot;Name1;Name2;Name3&quot;, &quot;;&quot;)</code> returns a 3-element array. The values in that array can be put in a worksheet. What have you tried?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1476286444, "post_id": 40002531, "comment_id": 67283035, "body": "Why <i>VBA</i>, you can do this with worksheet functions."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5136434, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-mutTtS53Gxk/AAAAAAAAAAI/AAAAAAAAAMw/5YfX__48M5g/photo.jpg?sz=128", "display_name": "Mayco Duran", "link": "https://stackoverflow.com/users/5136434/mayco-duran"}, "edited": false, "score": 0, "creation_date": 1476297242, "post_id": 40002825, "comment_id": 67289767, "body": "Thanks John! Just what I was looking for."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1476286976, "creation_date": 1476286976, "answer_id": 40002825, "question_id": 40002531, "link": "https://stackoverflow.com/questions/40002531/split-string-on-individual-cells-vba-function/40002825#40002825", "title": "Split string on individual cells - VBA function", "body": "<p>I like writing non-work-related code over lunch:</p>\n\n<pre><code>Sub NamesToList()\n    'Assumes that a cell is selected which contains a string which\n    'looks something like \"Name1;Name2;Name3\"\n    'The sub splits that list and then puts the values immediately\n    'below the selected cell. Warning: this doesn't check if there is\n    'room for those values and will overwrite existing values with no\n    'warning\n\n    Dim A As Variant, n As Long, R As Range\n    Set R = Selection\n    A = Split(R.Value, \";\")\n    n = UBound(A)\n    Range(R.Offset(1), R.Offset(n + 1)).Value = Application.WorksheetFunction.Transpose(A)\nEnd Sub\n</code></pre>\n\n<p>If you invoke this sub while <code>A1</code> is selected, the names will be automatically inserted in <code>A2:A4</code>. No error-checking is done, so you should probably tweak this code to make sure that it doesn't e.g. overwrite any values.</p>\n"}], "owner": {"reputation": 35, "user_id": 5136434, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-mutTtS53Gxk/AAAAAAAAAAI/AAAAAAAAAMw/5YfX__48M5g/photo.jpg?sz=128", "display_name": "Mayco Duran", "link": "https://stackoverflow.com/users/5136434/mayco-duran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40002825, "answer_count": 1, "score": 0, "last_activity_date": 1476286976, "creation_date": 1476286100, "question_id": 40002531, "link": "https://stackoverflow.com/questions/40002531/split-string-on-individual-cells-vba-function", "title": "Split string on individual cells - VBA function", "body": "<p>I need help spliting a string separated by \";\" and make a list as shown in this example:</p>\n\n<pre><code>         |        A          |\n|----------------------------|\n|  Row1  | Name1;Name2;Name3 |\n|  Row2  |      Name1        |\n|  Row3  |      Name2        |\n|  Row4  |      Name3        |\n</code></pre>\n\n<p>How can I achieve this with a VBA function?</p>\n\n<p>Thanks in advance,</p>\n\n<p>MD</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476286496, "post_id": 40002616, "comment_id": 67283074, "body": "The drawback will be if the original workbook already included a week number as part of the file name, in which case it will be appending the new week number to the old week number.  (I&#39;m not sure how to get around that without more info from the OP re structure of the week number value.)"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1476286871, "post_id": 40002616, "comment_id": 67283363, "body": "The original file name does not include the week number. let&#39;s say it is report.xlsm, I want to save report40.pdf for week 40."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1476286996, "post_id": 40002616, "comment_id": 67283465, "body": "@L.Dutch - in that case David&#39;s suggestion should work without any issues - it is replacing <code>.xlsm</code> with something like <code>wk42.pdf</code> (assuming B2 contained <code>wk42</code>)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476287289, "post_id": 40002616, "comment_id": 67283670, "body": "@YowE3K yes that looks about right -- I deleted to revise it because I had some wrong syntax. I still use <code>Mid</code> function but the <code>Left</code> function should be the same result here."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1476287313, "last_edit_date": 1476287313, "creation_date": 1476286319, "answer_id": 40002616, "question_id": 40002510, "link": "https://stackoverflow.com/questions/40002510/define-file-name-via-macro/40002616#40002616", "title": "Define file name via macro", "body": "<p><code>FullName</code> property returns the full path &amp; filename &amp; extension. Appending <code>Cells(2,2)</code> to that will give you a value like <code>\"c:\\path\\to\\filename.xlsx\" &amp; Cells(2,2).Value</code>.</p>\n\n<p>You need to insert the week number (<code>Cells(2,2)</code>) <em>before</em> the file extension part.</p>\n\n<p>You can probably do that like so:</p>\n\n<pre><code>sNewFilePath = Replace(s(0), s(1), Cells(2,2).Value &amp; \".pdf\")\n</code></pre>\n\n<p>Or, without using FileSystemObject:</p>\n\n<pre><code>Dim fullName As String, weekNum As String\nDim sNewFilePath As String\n\nweekNum = Cells(2,2).Value\nfullName = ThisWorkbook.FullName\n\n'If the file exists, the `Dir` function will return the filename, len != 0\nIf Len(Dir(fullName)) &lt;&gt; 0 Then\n    'remove the extension using Mid/InstrRev functions, _\n     build the new filename with weeknumber &amp; pdf extension\n     sNewFilePath = Mid(fullName, 1, InstrRev(fullName,\".\")-1) &amp; weekNum &amp; \".pdf\" \n    'Export to PDF with new File Path\n     ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF,_\n        _ Filename:=sNewFilePath, Quality:=xlQualityStandard,_\n        _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n    End If\nElse\n    '//Error: file path not found\n    MsgBox \"Error: this workbook may be unsaved.  Please save and try again.\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1476286707, "post_id": 40002654, "comment_id": 67283222, "body": "That won&#39;t work if the <code>FullName</code> is something like <code>C:\\Users\\abc\\test.files\\xyz\\abc.def.xlsx</code>, because the first <code>.</code> is not the one before the extension."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1476286424, "creation_date": 1476286424, "answer_id": 40002654, "question_id": 40002510, "link": "https://stackoverflow.com/questions/40002510/define-file-name-via-macro/40002654#40002654", "title": "Define file name via macro", "body": "<p>FullName includes the file extension. Perhaps this (you would be better off adding a sheet reference to B2 also).</p>\n\n<pre><code>s(0)=split(ThisWorkbook.FullName, \".\")(0) &amp; Cells(2, 2) &amp; \".pdf\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476287196, "creation_date": 1476287196, "answer_id": 40002897, "question_id": 40002510, "link": "https://stackoverflow.com/questions/40002510/define-file-name-via-macro/40002897#40002897", "title": "Define file name via macro", "body": "<p>Something like this would do it (I cleaned it up a little bit):</p>\n\n<pre><code>Dim FSO As Object\nDim s(1) As String\nDim sNewFilePath As String\nSub SavePDF()\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\ns(0) = ThisWorkbook.FullName\n\nIf FSO.FileExists(s(0)) Then\n    '//Change Excel Extension to PDF extension in FilePath\n    s(1) = FSO.GetExtensionName(s(0))\n    If s(1) &lt;&gt; \"\" Then\n        s(1) = \".\" &amp; s(1)\n        sNewFilePath = Left(s(0), InStrRev(s(0), \"\\\")) &amp; \".pdf\"\n\n        '//Export to PDF with new File Path\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        sNewFilePath &amp; Sheets(\"wsTakeOff\").Range(\"AY2\").Value &amp; \" - \" &amp; Sheets(\"wsTakeOff\").Range(\"D1\") &amp; \".pdf\", Quality:= _\n        xlQualityStandard, includedocproperties:=False, ignoreprintareas:=False, _\n        openafterpublish:=False\n    End If\nElse\n    '//Error: file path not found\n    MsgBox \"Error: this workbook may be unsaved.  Please save and try again.\"\nEnd If\n\nSet FSO = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1701, "favorite_count": 0, "accepted_answer_id": 40002616, "answer_count": 3, "score": 0, "last_activity_date": 1476287313, "creation_date": 1476286036, "last_edit_date": 1531164843, "question_id": 40002510, "link": "https://stackoverflow.com/questions/40002510/define-file-name-via-macro", "title": "Define file name via macro", "body": "<p>I have the following piece of code to save a pdf file from an existing excel file.</p>\n\n<pre><code>Dim FSO As Object\nDim s(1) As String\nDim sNewFilePath As String\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\ns(0) = ThisWorkbook.FullName\n\nIf FSO.FileExists(s(0)) Then\n    '//Change Excel Extension to PDF extension in FilePath\n    s(1) = FSO.GetExtensionName(s(0))\n    If s(1) &lt;&gt; \"\" Then\n        s(1) = \".\" &amp; s(1)\n        sNewFilePath = Replace(s(0), s(1), \".pdf\")\n\n        '//Export to PDF with new File Path\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF,_\n        _ Filename:=sNewFilePath, Quality:=xlQualityStandard,_\n        _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n    End If\nElse\n    '//Error: file path not found\n    MsgBox \"Error: this workbook may be unsaved.  Please save and try again.\"\nEnd If\n\nSet FSO = Nothing\n</code></pre>\n\n<p>Since the code has to be run recursively, I'd would like add to the file name the week number, contained in a given cell (B2) in the sheet.</p>\n\n<p>I tried replacing</p>\n\n<pre><code>s(0) = ThisWorkbook.FullName &amp; Cells(2,2)\n</code></pre>\n\n<p>but it is not working. Where is the error?</p>\n"}, {"tags": ["vba", "excel", "vbscript", "automated-tests", "hp-uft"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1476296900, "post_id": 40002360, "comment_id": 67289579, "body": "Can you give us an example of what are the values of your <code>filepath</code> and <code>scriptname</code> variables? As stated in @Dave&#39;s <a href=\"http://stackoverflow.com/a/40002722/6352151\">answer</a>, the problem might be on what you are passing as parameters"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1476889146, "post_id": 40002360, "comment_id": 67539875, "body": "Since you are still facing issues, as per <a href=\"http://stackoverflow.com/questions/40126567/loop-all-the-rows-of-a-worksheet-and-copy-them-into-a-blank-sheet\">this post</a>, I&#39;m replying here. Please put a breakpoint in UFT on that line of code and check all of the variables, make sure they are filled correctly, make sure both file and worksheet exists (with exact same name, with same extension, <code>.xls</code> is different than <code>.xlsx</code>, which is different than <code>xla</code> and so forth) and also the &quot;Action2&quot; exists (just for the sake of testing). Let us know of the results"}], "answers": [{"comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476287857, "post_id": 40002722, "comment_id": 67284071, "body": "So long as the file path is valid and points to a <code>.xls</code> or <code>.xlsx</code> file, the sheet you are importing exists and has the name you specify, and Action2 exists then yes it should be valid.  Note import will also fail if you have the workbook open when the import command is run."}, {"owner": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476288566, "post_id": 40002722, "comment_id": 67284543, "body": "Yes in my case scriptname is exact name of the worksheet I&#39;m trying to import, I think I have to pass as parameters the FilePath and not the File Name unless how UFT will find the worksheet to import ?"}, {"owner": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476288706, "post_id": 40002722, "comment_id": 67284641, "body": "I close all the Excel instances before importing the sheet, that&#39;s why I&#39;m surprising why I got this error !!"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476354604, "post_id": 40002722, "comment_id": 67313846, "body": "Can you edit your question to show the actual values you are using?"}, {"owner": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476354741, "post_id": 40002722, "comment_id": 67313943, "body": "DataTable.ImportSheet &quot;C:\\scripts\\script1.xls&quot; ,&quot;Test_1&quot;, &quot;Action2&quot;"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "edited": false, "score": 0, "creation_date": 1476362262, "post_id": 40002722, "comment_id": 67319055, "body": "Try using the index of the sheet and action instead?  Both are set to start from 1."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1476391134, "post_id": 40002722, "comment_id": 67338240, "body": "You said you are using Excel 2016 but your file is C:\\scripts\\script1.xls, so I have to ask: are you sure your file extension is correct? Excel 2016 files are <b>xlsx</b> by default, unless you changed it"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1476286653, "creation_date": 1476286653, "answer_id": 40002722, "question_id": 40002360, "link": "https://stackoverflow.com/questions/40002360/datatable-importsheet-operation-failed-invalid-file/40002722#40002722", "title": "DataTable.ImportSheet operation failed.Invalid file", "body": "<p>UFT syntax for importing a worksheet is:</p>\n\n<pre><code>DataTable.ImportSheet FileName, vtSrcSheet, vtDstSheet \n</code></pre>\n\n<p>This means you need to pass as parameters the filename (and path) to the excel file, the name (or index) of the source sheet you want to import, and then the destination you want this sheet to be (for example \"Global\" or \"Action1\" etc)</p>\n\n<p>Unless <code>scriptname</code> happens to be the exact name of the worksheet you are trying to import you will get this error.</p>\n\n<p>If you want to import the whole file use <code>Datatable.Import</code> instead of <code>Datatable.ImportSheet</code></p>\n"}], "owner": {"reputation": 133, "user_id": 6012786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b28229f34c2e524453015ffd88ff9222?s=128&d=identicon&r=PG&f=1", "display_name": "sourh", "link": "https://stackoverflow.com/users/6012786/sourh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2907, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476456844, "creation_date": 1476285612, "last_edit_date": 1476456844, "question_id": 40002360, "link": "https://stackoverflow.com/questions/40002360/datatable-importsheet-operation-failed-invalid-file", "title": "DataTable.ImportSheet operation failed.Invalid file", "body": "<p>I'm running Excel tests on UFT and sometimes I get the error number 20012 which is \"DataTable.ImportSheet operation failed.Invalid file\".</p>\n\n<p>This is my way of importing the script:</p>\n\n<pre><code>DataTable.ImportSheet filepath,scriptname,\"Action2\"\n</code></pre>\n\n<ul>\n<li><p>filepath is the path of my workbook which conatins many excel sheets (scripts)</p></li>\n<li><p>scriptname: the name of the script that I want to run</p></li>\n<li><p>Action2: contains all the call of all possible keywords that may script can contains.</p></li>\n</ul>\n\n<p>Any help please, why I'm getting this error.</p>\n\n<p>The problem is that this is working well for some scripts and for others not after 3 or 4 run times.</p>\n\n<p>I think the problem is on Excel itself and not on the code, are there any problems when working with Excel 2016 and UFT 12 ?  </p>\n"}, {"tags": ["angularjs", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476286919, "post_id": 40002321, "comment_id": 67283406, "body": "Can you share the website URL or the code tried so far?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476291417, "post_id": 40002321, "comment_id": 67286264, "body": "Please add this to the question."}, {"owner": {"reputation": 3062, "user_id": 4762502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-JBluz4YbEjk/AAAAAAAAAAI/AAAAAAAAAKM/0RsG_lxMbLs/photo.jpg?sz=128", "display_name": "notescrew", "link": "https://stackoverflow.com/users/4762502/notescrew"}, "edited": false, "score": 0, "creation_date": 1535903928, "post_id": 40002321, "comment_id": 91226991, "body": "A. Reynolds Have you got the solution for this? I am also facing the same issue."}, {"owner": {"reputation": 11, "user_id": 7008679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1646c384336b1ba1a75afe04b675d0c3?s=128&d=identicon&r=PG&f=1", "display_name": "A. Reynolds", "link": "https://stackoverflow.com/users/7008679/a-reynolds"}, "edited": false, "score": 0, "creation_date": 1536197440, "post_id": 40002321, "comment_id": 91340166, "body": "Check my edit to your question. Hope it helps."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7008679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1646c384336b1ba1a75afe04b675d0c3?s=128&d=identicon&r=PG&f=1", "display_name": "A. Reynolds", "link": "https://stackoverflow.com/users/7008679/a-reynolds"}, "edited": false, "score": 0, "creation_date": 1476289322, "post_id": 40002822, "comment_id": 67285033, "body": "I tried this in the VBA code and it isn&#39;t recognized. I assume this is something else but how do I trigger the input event fields using this or have VBA trigger them?"}, {"owner": {"reputation": 3294, "user_id": 510711, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a0bb569b4a0143c066a2b84a56309a9a?s=128&d=identicon&r=PG", "display_name": "flob", "link": "https://stackoverflow.com/users/510711/flob"}, "reply_to_user": {"reputation": 11, "user_id": 7008679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1646c384336b1ba1a75afe04b675d0c3?s=128&d=identicon&r=PG&f=1", "display_name": "A. Reynolds", "link": "https://stackoverflow.com/users/7008679/a-reynolds"}, "edited": false, "score": 0, "creation_date": 1476289709, "post_id": 40002822, "comment_id": 67285276, "body": "You must execute this in the browser Javascript vm. But I don&#39;t know how to do that from vba. Maybe you can trigger the event directly, avoiding Javascript."}], "tags": [], "owner": {"reputation": 3294, "user_id": 510711, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a0bb569b4a0143c066a2b84a56309a9a?s=128&d=identicon&r=PG", "display_name": "flob", "link": "https://stackoverflow.com/users/510711/flob"}, "is_accepted": false, "score": 0, "last_activity_date": 1476286965, "creation_date": 1476286965, "answer_id": 40002822, "question_id": 40002321, "link": "https://stackoverflow.com/questions/40002321/excel-vba-the-webpage-is-not-recognizing-the-fields-are-filled-in-when-i-submit/40002822#40002822", "title": "Excel VBA The webpage is not recognizing the fields are filled in when I submit", "body": "<p>You need to trigger the <code>input</code> event on the fields changed. </p>\n\n<pre><code> var inputs = document.getElementsByTagName(\"input\");\n for (var input in inputs) {\n   var $input = angular.element(input);\n   $input.triggerHandler('input');\n }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7008679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1646c384336b1ba1a75afe04b675d0c3?s=128&d=identicon&r=PG&f=1", "display_name": "A. Reynolds", "link": "https://stackoverflow.com/users/7008679/a-reynolds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1028, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536197270, "creation_date": 1476285517, "last_edit_date": 1536197270, "question_id": 40002321, "link": "https://stackoverflow.com/questions/40002321/excel-vba-the-webpage-is-not-recognizing-the-fields-are-filled-in-when-i-submit", "title": "Excel VBA The webpage is not recognizing the fields are filled in when I submit", "body": "<p><a href=\"https://stackoverflow.com/questions/31152411/how-can-i-force-an-angluarjs-form-to-realize-required-fields-have-been-filled-th\">The exact same issue I have</a></p>\n\n<blockquote>\n  <p>I've written an Excel VBA macro to paste some data into an AngularJS\n  form -- it opens an Internet Explorer (11) window, navigates to the\n  page containing the form, and crawls the document tree looking for\n  certain elements by their ID, changing their values from blank to\n  non-blank strings from the Excel sheet. However, when I submit the\n  form, the form logic treats all the required fields as if they were\n  still blank, drawing a red box around the supposed offending fields.\n  (I can intervene at this point by clicking into each field, typing a\n  random character at the end of the pasted data and immediately\n  deleting it, and this triggers the logic that the required field is\n  now filled.)</p>\n</blockquote>\n\n<p>This page from here I linked is the exact same problem I am having with the relevant part highlighted above. The rest I don't anything about. I have tried what was said in the comments about finding the submit and it doesn't work or I am thinking I just need to correct VBA code to submit it correctly. </p>\n\n<p>At best I can tell is when I type it manually, it verifies the field meets the criteria and marks it okay. How do I force this page to check itself after the fields are filled in?</p>\n\n<p>This is what I have tried. Some of these was stuff I found and tried<br>\n    <code>'Call .Document.getelementbyid(\"firstName\").SetAttribute(\"value\", ActiveCell.Value) 'Tried a different way but stayed with my original lines next<br>\n    Set firstName = .Document.GetElementById(\"firstName\") \u2018works<br>\n    firstName.Value = ActiveCell.Value 'works but then for submit, field says empty</code><br>\nAt end of code to submit,<br>\n   <code>.Document.InvokeMember (\"vm.onSubmit()\")<br>\n    Set HTMLForm = .Document.GetElementsByName(\"vm.onSubmit()\")<br>\n    HTMLForm.Submit<br>\n    .Document.getElementsByClassName(\"btn btn-primary btn-lg btn-next\")(0).Click \u2018works and goes to next page if the fields was working<br>\n    .Document.forms(0).submit 'works, just resets the page to previous page</code></p>\n\n<p>EDIT: This is what ended up working for me.</p>\n\n<pre><code>' Fire the onChange event for the fields on the website \nDim oEvent \nSet oEvent = .Document.createEvent(\"HTMLEvents\") \noEvent.initEvent \"change\", False, True\n</code></pre>\n\n<p>Then wherever you need this next section:</p>\n\n<pre><code>    Set firstName = .Document.getElementById(\"firstName\") \n    firstName.Value = ActiveCell.Value ' Column 0, starting column to know where to start the offsets \n    firstName.dispatchEvent oEvent ' Example here since it is used for current field. Each field needs its own change event \n\n    Set lastName = .Document.getElementById(\"lastName\") \n    lastName.Value = ActiveCell.Offset(0, 1).Value ' Column 1 \n    lastName.dispatchEvent oEvent \n</code></pre>\n\n<p>The rest of the code just repeats for each field but the dispatchEvent oEvent is what helped me figure this out. It took me trying all kinds of solutions to find the answer at the time but hope this helps.</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476283916, "post_id": 40001682, "comment_id": 67281195, "body": "Are you clearing the data from row 1?  I do see a delete in there, but it&#39;s hard to follow because you&#39;re using <code>ActiveCell</code> and <code>Selection</code> a lot.  I recommend taking a look at <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> to clean up your code before doing anything else."}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "edited": false, "score": 0, "creation_date": 1476289844, "post_id": 40001777, "comment_id": 67285358, "body": "This almost fixed my issue. It now selectively returns 1 when running a 2nd set of for loops to re-scan the document again to delete some duplicate entries. Any idea as to why?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "edited": false, "score": 0, "creation_date": 1476290320, "post_id": 40001777, "comment_id": 67285627, "body": "that is much probably the <i>heritage</i> of all those Selection/Activation, which good coding practice cares to avoid. just follow @tigeravatar comment link about how to avoid that and if you still have issues post a new question with your code efforts"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1476283963, "creation_date": 1476283963, "answer_id": 40001777, "question_id": 40001682, "link": "https://stackoverflow.com/questions/40001682/rangeiv1-endxltoleft-column-returning-1-after-first-row/40001777#40001777", "title": "Range(&quot;IV1&quot;).End(xlToLeft).Column Returning 1 after first row", "body": "<p>you are not using the current row index</p>\n\n<p>use this:</p>\n\n<pre><code>LastCell = Cells(i, \"IV\").End(xlToLeft).Column \n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1611, "favorite_count": 0, "accepted_answer_id": 40001777, "answer_count": 1, "score": 0, "last_activity_date": 1476283963, "creation_date": 1476283683, "question_id": 40001682, "link": "https://stackoverflow.com/questions/40001682/rangeiv1-endxltoleft-column-returning-1-after-first-row", "title": "Range(&quot;IV1&quot;).End(xlToLeft).Column Returning 1 after first row", "body": "<pre><code>Sub UpdateText()\n' The purpose of this Macro is to set up an excel spreadsheet in order for\n' it to be properly mapped to be exported into an CRM application.\n' Some variables to use.\nDim fName As String\nDim lName As String\nDim LastRow As Long\nDim LastCell As Long\nDim i As Long\nDim x As Long\n' Get the last Row in the worksheet.\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n' Start the loop for each row.\nFor i = 1 To LastRow\n    ' Grab how many cells that are in the current row.\n    LastCell = Range(\"IV1\").End(xlToLeft).Column ' &lt;---- My Error is here. After first row, it returns 1 everytime.\n    ' Start the loop through each Cell.\n    For x = 1 To LastCell\n        ' Look for the consistant tag for each technician to grab Name.\n        If ActiveCell = \"Location\" Then\n            lName = ActiveCell.Offset(0, -2).Value\n            fName = ActiveCell.Offset(0, -1).Value\n            ' Skip to the next cell.\n            ActiveCell.Offset(0, 1).Select\n        ' Check for the Service to drop in the name of the Technician.\n        ElseIf ActiveCell.Value Like \"HC:H*\" Then\n            ' Step back 1 cell to drop before date of service.\n            ActiveCell.Offset(0, -1).Select\n            ' Insert 3 cells.\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            ' drop in data.\n            ActiveCell.Value = lName\n            ActiveCell.Offset(0, 1).Value = fName\n            ActiveCell.Offset(0, 2).Value = \"Location\"\n            ' Go back to the next cell that should be checked.\n            ActiveCell.Offset(0, 5).Select\n        ' Delete the blank cells that seperate the next technician group.\n        ElseIf ActiveCell.Value = \"\" Then\n            Selection.Delete Shift:=xlToLeft\n        ' If nothing is to do done, Skip to next cell.\n        Else\n            ActiveCell.Offset(0, 1).Select\n        End If\n    Next x\n    ' End of row, go to the beginning of next row to start.\n    Cells(i + 1, 1).Select\nNext i\nEnd Sub\n</code></pre>\n\n<p>On line 16</p>\n\n<pre><code>LastCell = Range(\"IV1\").End(xlToLeft).Column\n</code></pre>\n\n<p>Returns  a value of 1 every row after the first row. I cannot understand why. The purpose of this macro is to format the spreadsheet so that each column has consistent data so that it can be mapped and imported into a CRM file. I need to step into each cell going left to right check the value and either grab the value or insert cells and drop in the values grabbed.</p>\n"}, {"tags": ["excel", "search", "vba"], "comments": [{"owner": {"reputation": 22589, "user_id": 542251, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c6a0ac3e18f1cd8d0f1be4c2e3a4cfbd?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/542251/liam"}, "edited": false, "score": 2, "creation_date": 1476283649, "post_id": 40001638, "comment_id": 67281001, "body": "Please read <a href=\"http://meta.stackoverflow.com/questions/251361/how-do-i-format-my-code-blocks\">How do I format my code blocks?</a>"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1476287132, "post_id": 40001638, "comment_id": 67283566, "body": "You&#39;re want to use <code>InStr</code>, if you want to find a string within another string."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 13, "user_id": 7008532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864389b11857dd570cc2a530942cdce1?s=128&d=identicon&r=PG&f=1", "display_name": "DarkPower15", "link": "https://stackoverflow.com/users/7008532/darkpower15"}, "edited": false, "score": 1, "creation_date": 1476370995, "post_id": 40007539, "comment_id": 67326402, "body": "@DarkPower15 If this answer solved your question then please <a href=\"http://stackoverflow.com/tour\">mark this answer as the accepted answer</a>. Like this other users on this site know that this question has been solved and does not require their attention anymore. Furthermore, it allows users to find this answer if they have a similar problem. Finally, the user posting this answer will get rewarded with points. This is the generally accepted way for showing your appreciation for the help you received. You may also opt to up-vote this answer for an even greater &quot;thank you&quot;."}], "tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": true, "score": 0, "last_activity_date": 1476303243, "creation_date": 1476303243, "answer_id": 40007539, "question_id": 40001638, "link": "https://stackoverflow.com/questions/40001638/search-a-part-of-a-description/40007539#40007539", "title": "Search a part of a description", "body": "<p>Not sure if I understood the question, but maybe try to use \"xlPart\" instead of \"xlWhole\" as lookAt-parameter.</p>\n"}], "owner": {"reputation": 13, "user_id": 7008532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864389b11857dd570cc2a530942cdce1?s=128&d=identicon&r=PG&f=1", "display_name": "DarkPower15", "link": "https://stackoverflow.com/users/7008532/darkpower15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 40007539, "answer_count": 1, "score": 1, "last_activity_date": 1476320061, "creation_date": 1476283581, "last_edit_date": 1531164843, "question_id": 40001638, "link": "https://stackoverflow.com/questions/40001638/search-a-part-of-a-description", "title": "Search a part of a description", "body": "<p>Is there a way that i can search a part of a description in a cell?\nbecause when i search for a part like UTP he give's me an error</p>\n\n<p>Got anny idea?</p>\n\n<p>Here is my code</p>\n\n<pre><code>'search for a cbxItem_Nr or a cbx_Description\nSub Find_test_click()\n    Dim FindString As String\n    Dim Rng As Range\n    FindString = InputBox(\"Voer de product code in\")\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With Sheets(\"Magazijn\").Range(\"A:B\") 'searches all of column A and B\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                Application.Goto Rng, True 'value found\n            Else\n                MsgBox \"Opgegeven product Niet gevonden\" '(MsgBox) Saying Did not find the product\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>In the code there are some dutch words</p>\n"}, {"tags": ["excel", "powerpoint", "vba"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476365710, "post_id": 40001592, "comment_id": 67321960, "body": "So your path variable is being set to &quot;:tmp:&quot;. I can&#39;t see how that works in either case. Shouldn&#39;t it be either a local drive reference e.g. &quot;C:\\tmp\\&quot; or a network location such as &quot;\\\\myServer\\tmp\\&quot;. According to MSDN the Dir function takes the PathName parameter as &quot;String expression that specifies a file name, directory or folder name, or drive volume label.&quot;"}, {"owner": {"reputation": 3, "user_id": 7008494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f328d059f34c35086a8ccaed304122?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/7008494/diego"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476366616, "post_id": 40001592, "comment_id": 67322739, "body": "Hello JamieG, thanks for answering. :tmp is just a reference to the tmp folder in the actual folder where the presentation is located. I will try to change it to the global one to see if this can be the root cause. Thanks!"}, {"owner": {"reputation": 3, "user_id": 7008494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f328d059f34c35086a8ccaed304122?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/7008494/diego"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476393595, "post_id": 40001592, "comment_id": 67339585, "body": "That fixed the issue. When you execute the macro directly on the Powerpoint, the relative path &quot;:tmp:&quot; works fine. If you want to call the powerpoint macro from excel, you must put the global route (activepresentation.path $&quot;:tmp:&quot;"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476399632, "post_id": 40001592, "comment_id": 67341870, "body": "Cool. I posted that as the answer so the question can be marked as answered."}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 0, "last_activity_date": 1476399593, "creation_date": 1476399593, "answer_id": 40032374, "question_id": 40001592, "link": "https://stackoverflow.com/questions/40001592/excel-vba-calling-a-powerpoint-macro-fails-while-running-it-directly-on-powerpoi/40032374#40032374", "title": "Excel-VBA calling a Powerpoint Macro fails while running it directly on PowerPoint works fine", "body": "<p>Try using the fully qualified path when using the Dir function.</p>\n"}], "owner": {"reputation": 3, "user_id": 7008494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f328d059f34c35086a8ccaed304122?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/7008494/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 40032374, "answer_count": 1, "score": 0, "last_activity_date": 1476399593, "creation_date": 1476283442, "last_edit_date": 1531164843, "question_id": 40001592, "link": "https://stackoverflow.com/questions/40001592/excel-vba-calling-a-powerpoint-macro-fails-while-running-it-directly-on-powerpoi", "title": "Excel-VBA calling a Powerpoint Macro fails while running it directly on PowerPoint works fine", "body": "<p>(Excel and PowerPoint 2011 for Mac)</p>\n\n<p>I have a excel macro that opens a powerpoint and executes a macro. \nIf I execute the powerpoint macro directly it works fine, but if I execute it from the excel macro call it fails with Run-time error '68': Device unavailable</p>\n\n<p>It's before this loop:</p>\n\n<pre><code>Dim strfilee As String\n\n\nmydir = \":tmp\"\nstrpath = mydir &amp; \":\"\nstrfilee = Dir(strpath)  &lt;--- Failing on this line\n\n\n''''Loop through each file in the folder to find the one with the OS parameters\n\n    i = 0\n\n    Do While Len(strfilee) &gt; 0\n    cellplace = \"A\" &amp; i\n\n        If Right(strfilee, 11) = \"params.pptx\" Then\n        lspace = InStr(1, strfilee, \"_\", vbTextCompare)\n        target_name = Trim(Left(strfilee, lspace - 1))\n        sc_file_name = \"tmp\" &amp; \":\" &amp; strfilee\n\n                With ActivePresentation\n                    number_slides = .Slides(.Slides.Count).SlideNumber\n                  End With\n                ActivePresentation.Slides.InsertFromFile sc_file_name, number_slides\n\n\n         End If\n        strfilee = Dir\n      i = i + 1\n\n    Loop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476283373, "post_id": 40001462, "comment_id": 67280800, "body": "I dont want to remove duplicates just write the word duplicates in a thrid column. Also I only want the word to be displayed for duplicates with lower value in ID. The duplicate with the max value in ID should not have duplicate displayed."}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476283508, "post_id": 40001462, "comment_id": 67280889, "body": "Yes, assume that the list is sorted"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476285663, "post_id": 40001462, "comment_id": 67282425, "body": "@kit you can replace the <code>;</code>s with <code>,</code>"}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476286097, "post_id": 40001462, "comment_id": 67282765, "body": "I tried: =if(COUNTIF($A$2:$A6,A6,0)&gt;0,&quot;Duplicate #&quot; &amp; COUNTIF($A$2:$A6,A6,0),&quot;&quot;) but it gives an error"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476286628, "post_id": 40001462, "comment_id": 67283166, "body": "@Slai : thanks... goddam french excel... why the hell would they change that?  PS: the  &quot; , 0 &quot; was for sumif, not countif..."}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476287342, "post_id": 40001462, "comment_id": 67283710, "body": "Thanks for your help but this doesn&#39;t quite work. Please see my amended question to see what result I am looking for."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476287619, "post_id": 40001462, "comment_id": 67283911, "body": "How does it &quot;not quite&quot; work? error? Unexpected behavior? (I modified A3 to A2, that was a mistake. )"}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 0, "last_activity_date": 1476287634, "last_edit_date": 1476287634, "creation_date": 1476283147, "answer_id": 40001462, "question_id": 40001386, "link": "https://stackoverflow.com/questions/40001386/counting-duplicates-and-asigning-label/40001462#40001462", "title": "counting duplicates and asigning label", "body": "<p>if the duplicates are in column A, the cell B3 could read: (if ID are decreasing)</p>\n\n<pre><code>=if(COUNTIF($A$1:$A2,A3)&gt;0,\"Duplicate #\" &amp; COUNTIF($A$1:$A3,A3),\"\")\n</code></pre>\n\n<p>does this help?</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476285380, "post_id": 40002143, "comment_id": 67282205, "body": "That puts duplicate next to 1,1. not 6,1"}, {"owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476285661, "post_id": 40002143, "comment_id": 67282422, "body": "Yes. Value 6 and ID 1 will not have label as duplicate because that value is the highest. That is what you have said in your question. Or did I misunderstand?"}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476285769, "post_id": 40002143, "comment_id": 67282506, "body": "ah sorry, the issue is that 2,1 does not also say duplicate"}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476285815, "post_id": 40002143, "comment_id": 67282540, "body": "Is it possible to have not max instead of min or something like that?"}], "tags": [], "owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "is_accepted": false, "score": 0, "last_activity_date": 1476285039, "creation_date": 1476285039, "answer_id": 40002143, "question_id": 40001386, "link": "https://stackoverflow.com/questions/40001386/counting-duplicates-and-asigning-label/40002143#40002143", "title": "counting duplicates and asigning label", "body": "<p>Not sure if this is correct. But please correct me if I am wrong.</p>\n\n<pre><code>=IF(MIN($A$2:$A$6 = MIN($B$2:$B$6)), \"duplicate\", \"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476286473, "post_id": 40002560, "comment_id": 67283057, "body": "That assigns duplicate to everything except 6,1. I am trying to assign duplicate to only 2,1 and 1,1"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476287582, "post_id": 40002560, "comment_id": 67283891, "body": "You have to enter the formula by pressing Ctrl and Shift and Enter, not just Enter. Curly brackets will appear round it."}, {"owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476287807, "post_id": 40002560, "comment_id": 67284034, "body": "Thanks this worked. What doest Ctrl Shift enter do and what are the curly brackets for?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "edited": false, "score": 0, "creation_date": 1476288165, "post_id": 40002560, "comment_id": 67284303, "body": "It means Excel evaluates the formula over a range of cells (an array) rather than a single cell. Plenty of links on them, e.g. <a href=\"https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1476286194, "creation_date": 1476286194, "answer_id": 40002560, "question_id": 40001386, "link": "https://stackoverflow.com/questions/40001386/counting-duplicates-and-asigning-label/40002560#40002560", "title": "counting duplicates and asigning label", "body": "<p>This array formula should work (Ctrl+Shift+Enter) to confirm, though if you have lots of data could be rather slow.</p>\n\n<pre><code>=IF(B2=MAX(IF($A$2:$A$6=A2,$B$2:$B$6)),\"\",\"Duplicate\")\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6162569, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6e8f3165e536902f10f4a1230f88c6dd?s=128&d=identicon&r=PG&f=1", "display_name": "kit", "link": "https://stackoverflow.com/users/6162569/kit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1476287634, "creation_date": 1476282945, "last_edit_date": 1531161705, "question_id": 40001386, "link": "https://stackoverflow.com/questions/40001386/counting-duplicates-and-asigning-label", "title": "counting duplicates and asigning label", "body": "<p>In Excel suppose I have a table with the following two columns and following data:</p>\n\n<pre><code>ID   Value\n1    6\n1    2\n1    1\n2    4\n3    5\n</code></pre>\n\n<p>In excel what I would like to do is write the word duplicate in a third column (say result) when the id is duplicate and is not the highest value.</p>\n\n<p>In this example duplicate would be written next to Value(2),ID(1) and Value(1),ID(1). Value(6), ID(1) would not have duplicate written next to it becasue it has the highest value out of all the ID(1)'s.</p>\n\n<p>Is there an excel forumula I can use to do this? If not what VBA would I need? In reality this is a large database and there will be more than 3 duplicates.</p>\n\n<p>The result should look like this:</p>\n\n<pre><code>ID   Value\n1    6\n1    2      Duplicate\n1    1      Duplicate\n2    4\n3    5\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1476282992, "post_id": 40001133, "comment_id": 67280522, "body": "You lack of clarity (I am not sure to understand what you want to do) and you did not provide us with what you have tried so far (if you tried anything)."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1476283206, "post_id": 40001133, "comment_id": 67280681, "body": "Please edit your question and post you code in it."}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476283331, "post_id": 40001133, "comment_id": 67280768, "body": "Edited OP post, thanks! I am fairly new here to the formatting and everything"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476284441, "post_id": 40001724, "comment_id": 67281582, "body": "Wow! thanks Vincent, I wasn&#39;t aware of setting a workbook open catcher, I really like this idea. Could I declare this a public function and use variables in other Modules of ThisWorkbook, or is it isolated only to &quot;thisWorkbook&quot;"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476285384, "post_id": 40001724, "comment_id": 67282207, "body": "Well, <code>Application</code> is available everywhere, the only use here of myApp is catch the WorkbookOpen event in order to be alerted when the user opens a workbook. From the event you will then be able to call any function you want or set any variable you need to process. The objective here is to not have to look periodically for new opened workbook to test. You can also catch the event the same way in other object or class modules."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1476283833, "creation_date": 1476283833, "answer_id": 40001724, "question_id": 40001133, "link": "https://stackoverflow.com/questions/40001133/vba-how-to-search-active-workbooks-and-match-a-filename-against-string/40001724#40001724", "title": "VBA - How to search Active Workbooks, and match a filename against string?", "body": "<p>You can try to capture the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196583.aspx\" rel=\"nofollow\">WorkbookOpen</a> event of the Application object.</p>\n\n<p>Here is a way to do so: copy the following code into the <code>ThisWorkbook</code> object of your main workbook. </p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents myApp As Application\n\nPrivate Sub myApp_WorkbookOpen(ByVal Wb As Workbook)\n    MsgBox \"Openned \" &amp; Wb.FullName\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set myApp = Application\nEnd Sub\n</code></pre>\n\n<p>Then close you workbook and reopen if with macro enabled. The name of this workbook and each subsequent workbook openned whil it is open will be shown in a message box.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476284685, "post_id": 40001809, "comment_id": 67281740, "body": "This works wonderfully as well, Its more geared to what I was trying to achieve. I presume after the If statement, once I find the InStr search, I can assign this &quot;WB&quot; to a Public variable and use it in the &quot;Sub Example&quot; method?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476284840, "post_id": 40001809, "comment_id": 67281828, "body": "You could, or just make the function return a WorkBook object instead. I understood your requirements to return the Path to the WorkBook object, however returning the Workbook object works too. Just change <code>getWbName(SearchStr As String) As String</code> to <code>getWbName(SearchStr As String) As Workbook</code> and <code>getWbName = ActiveWorkbook.FullName</code> to <code>getWbName = wb</code>. Also remove the <code>wb.Activate</code> and <code>ThisWorkbook.Activate</code> and <code>getWbName = vbNullString</code> lines"}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476284986, "post_id": 40001809, "comment_id": 67281943, "body": "Ah, that should work out perfectly then. I&#39;ll give this a try, was working on a way of trying to figure this out all day yesterday. I learned quite a bit from your comments. Much appreciated."}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476286025, "post_id": 40001809, "comment_id": 67282705, "body": "Just tried this, for some reason in the &#39;sub example"}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476286124, "post_id": 40001809, "comment_id": 67282795, "body": "Just tried this, in the &#39;sub example&#39; I tried to say &#39;getWbName.activate&#39; and &#39;msgbox (&quot;Done&quot;) to test to see if I was passing the getWbName over, but I keep running into a &quot;argument not optional&quot; error"}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476286245, "post_id": 40001809, "comment_id": 67282896, "body": "Ahh I saw your edit now, I understand why it was not working. In your Sub Example (unsure of how to make the text grey like you did), Are you referencing &quot;Book2&quot; as simply a dummy reference? or is there a reason behind that?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476286319, "post_id": 40001809, "comment_id": 67282963, "body": "One of my open workbooks is &#39;Book2&#39;, you&#39;d change that to the Workbook you want to find."}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476286748, "post_id": 40001809, "comment_id": 67283258, "body": "Thanks Ryan for your help! I ended up changing &#39;Book2&quot; to blank (&quot;&quot;) as the searchStr already finds the match and the Function contains the Workbook I instead to use."}, {"owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "edited": false, "score": 0, "creation_date": 1476288661, "post_id": 40001809, "comment_id": 67284606, "body": "Hey Ryan,   I had posted this on another forum as well and this solution works too, figured you&#39;d like to see a different way of doing this method. I&#39;ll be using your way though :)      &#39;Sub Test() Dim Wb As Workbook Dim Wb2 As Workbook      Set Wb = ThisWorkbook      For Each Wb2 In Application.Workbooks         If Wb2.Name Like &quot;Demand*&quot; Then             Exit For         End If     Next Wb2      If Wb2 Is Nothing Then         MsgBox &quot;Weekly workbook not found&quot;     Else         Wb2.Activate         MsgBox (&quot;Done&quot;)     End If  End Sub&#39;"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1476286048, "last_edit_date": 1476286048, "creation_date": 1476284058, "answer_id": 40001809, "question_id": 40001133, "link": "https://stackoverflow.com/questions/40001133/vba-how-to-search-active-workbooks-and-match-a-filename-against-string/40001809#40001809", "title": "VBA - How to search Active Workbooks, and match a filename against string?", "body": "<p>You can iterate each workbook, however I think the key here is to make the workbook active so you can retrieve the FullName with the path information.</p>\n\n<pre><code>Option Explicit\n\nFunction getWbName(SearchStr As String) As String\nOn Error GoTo ErrHand:\n    Application.ScreenUpdating = False\n    Dim wb As Workbook\n\n    getWbName = vbNullString\n\n    For Each wb In Workbooks\n        If InStr(1, wb.Name, SearchStr, vbTextCompare) &gt; 0 Then\n            wb.Activate\n            getWbName = ActiveWorkbook.FullName\n            Exit For\n        End If\n    Next\n\n    'Return the active window and exit\n    ThisWorkbook.Activate\n    Application.ScreenUpdating = True\n    Exit Function\n\nErrHand:\n    Application.ScreenUpdating = True\n    MsgBox (Err.Number &amp; \" has occured, with description: \" &amp; Err.Description)\nEnd Function\n\nSub Example()\n    Debug.Print getWbName(\"Book2\")\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Updated the code above to return the WorkBook Object instead.</p>\n\n<pre><code>Option Explicit\n\nFunction getWorkBookByName(SearchStr As String) As Workbook\n    Dim wb As Workbook\n\n    For Each wb In Workbooks\n        If InStr(1, wb.Name, SearchStr, vbTextCompare) &gt; 0 Then\n            Set getWorkBookByName = wb\n            Exit Function\n        End If\n    Next\nEnd Function\n\nSub Example()\n    Dim myWb As Workbook: Set myWb = getWorkBookByName(\"Book2\")\n    If Not myWb Is Nothing Then Debug.Print myWb.FullName\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7008402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ocQnS.jpg?s=128&g=1", "display_name": "Jaz", "link": "https://stackoverflow.com/users/7008402/jaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 0, "accepted_answer_id": 40001809, "answer_count": 2, "score": 1, "last_activity_date": 1476286048, "creation_date": 1476282249, "last_edit_date": 1476283643, "question_id": 40001133, "link": "https://stackoverflow.com/questions/40001133/vba-how-to-search-active-workbooks-and-match-a-filename-against-string", "title": "VBA - How to search Active Workbooks, and match a filename against string?", "body": "<p>I am coding up a quick automation project for work, I cannot specify a filepath to open a workbook from as it is used in a special software, not easily accessible with VBA. </p>\n\n<p>If User A opens this file: \"ABC_todaysdate\"... How would I tell Excel to cycle through the active workbooks (User A could have 5-6 workbooks open), find the letter ABC in the Activeworkbook filename, and use that in the rest of my function?</p>\n\n<p>VBA Code so far:</p>\n\n<pre><code>Sub CopyDemand()\nDim filename As String\nDim Wb As Workbook\nDim ws As Worksheet\nDim Wb2 As Workbook\n\nSet Wb = ThisWorkbook\nFor Each Wb2 In Application.Workbooks\nfilename = ActiveWorkbook.FullName\nIf filename Like \"demand\" Then\nDebug.Print (\"Found\")\n''' Insert function to use WB2 and copy over data, compare workbooks etc.\nNext\nWb.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1476281660, "post_id": 40000876, "comment_id": 67279535, "body": "Do a Find loop and add each result to a listbox, then the user can quickly see all of the results and select an item from the listbox.  If preferred, a listbox can be set to MultiSelect so that more than one result can be selected.  (Though that is assuming you&#39;re using a Userform, which I recommend for something like this)"}, {"owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476281807, "post_id": 40000876, "comment_id": 67279639, "body": "I already tried that. I added the list box as per: <a href=\"http://www.excel-easy.com/vba/examples/list-box.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/list-box.html</a>  But this list box is always visible on the sheet. I want the user experiance to be similar to the find all in excel. The results are displayed, selected by user and then the list box disappears. Also There are no cancel buttons on the list box. What happens if someone enters the wrong search string is presented with the results but not able to cancel and try again"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476281878, "post_id": 40000876, "comment_id": 67279696, "body": "Please clarify your question with a <i>specific</i> problem statement, preferably also including your code (a minimum amount needed to replicate your problem)."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1476281889, "post_id": 40000876, "comment_id": 67279703, "body": "&quot;Already tried that&quot; doesn&#39;t give us much information.  When you tried it, did you run into a problem or error? Do you have code for how you tried to populate it so that we can review the code and offer suggestions to correct or improve it?"}, {"owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "edited": false, "score": 0, "creation_date": 1476282277, "post_id": 40000876, "comment_id": 67280005, "body": "Set rngSearch = ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A1:A1320&quot;) Set rngLast = rngSearch.Cells(rngSearch.Cells.Count) Set rngFound = rngSearch.Find(&quot;573&quot;, After:=rngLast, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False) &#39;if &quot;string&quot; is found in search range:  If Not rngFound Is Nothing Then strFirstAddress = rngFound.Address Do             &#39;HERE IS WHERE I WANT TO DISPLAY THE RESULTS AND USE THE INPUT SELECTED BY THE USER TO PROCEED FURTHER         Loop Until rngFound.Address = strFirstAddress End If"}, {"owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "edited": false, "score": 0, "creation_date": 1476282463, "post_id": 40000876, "comment_id": 67280132, "body": "I used the following code to populate the list box With Sheet1.ListBox1     .AddItem rngFound.Value End With  The problem is the list box is always there on the sheet. I want a pop up window to display the results and allow the user to choose 1 results and for the windows to close and proceed to the next action"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1476282642, "post_id": 40000876, "comment_id": 67280269, "body": "For this, you will want a Userform, not Sheet controls. Here is a <a href=\"http://www.excel-easy.com/vba/userform.html\" rel=\"nofollow noreferrer\">text tutorial</a> and a <a href=\"https://www.youtube.com/watch?v=5oXcct1mOUw\" rel=\"nofollow noreferrer\">video tutorial</a> that you can follow for how to create a basic userform."}], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476283438, "post_id": 40001451, "comment_id": 67280848, "body": "As a side note, the reason I iterate over an array instead of using a Find Loop is that in general iterating over an array is going to be much faster than a Find Loop."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476284826, "post_id": 40001451, "comment_id": 67281818, "body": "wouldn&#39;t that <code>If .Row &lt; 2 Then</code> be <code>If .Rows.Count &lt; 2 Then</code>?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476285262, "post_id": 40001451, "comment_id": 67282129, "body": "No, because it&#39;s assuming row 1 is a header row, and if there&#39;s no data in column A, the range would be A2:A1 which still results in a .rows.count of 2, but the .row would be 1 because it is the starting row, indicating that nothing was found in column A."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476285536, "post_id": 40001451, "comment_id": 67282314, "body": "if my currently active sheet has values in cells &quot;A1:A8&quot; and run from immediate window <code>Range(&quot;A1&quot;, Cells(activesheet.Rows.Count, &quot;A&quot;).End(xlUp)).Row</code>, it returns <code>1</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476285648, "post_id": 40001451, "comment_id": 67282405, "body": "aha, but A1 is header row. I only know understand that. sorry"}, {"owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "edited": false, "score": 0, "creation_date": 1476295013, "post_id": 40001451, "comment_id": 67288473, "body": "Thank you for your help. I will try it out and work tomorrow and let you know how successful i&#39;ve been. I wasn&#39;t aware that it is possible to add a listbox in a userform and not as a sheet control."}, {"owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "edited": false, "score": 0, "creation_date": 1476366424, "post_id": 40001451, "comment_id": 67322550, "body": "Thanks for your help. Userform was the way to go. Also I replaced my find code with your suggestion. I&#39;m using the Array now."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1476283502, "last_edit_date": 1476283502, "creation_date": 1476283128, "answer_id": 40001451, "question_id": 40000876, "link": "https://stackoverflow.com/questions/40000876/excel-macros-findall-and-allow-user-to-select-result/40001451#40001451", "title": "Excel Macros - FindAll and allow user to select result", "body": "<p>For tutorials on how to create a basic userform, here is a <a href=\"http://www.excel-easy.com/vba/userform.html\" rel=\"nofollow\">text tutorial</a> and a <a href=\"https://www.youtube.com/watch?v=5oXcct1mOUw\" rel=\"nofollow\">video tutorial</a>.</p>\n\n<p>Note that on the userform you create, I suggest the following names for the controls:</p>\n\n<ul>\n<li>Textbox: <code>txtFind</code></li>\n<li>Find button: <code>btnFind</code></li>\n<li>Listbox: <code>listResults</code></li>\n</ul>\n\n<p>Once you have your userform with a Textbox that the user can type into for what they want to search for, a Find button, and a Listbox, you would use this code for your Find button:</p>\n\n<pre><code>Private Sub btnFind_Click()\n\n    Dim ws As Worksheet\n    Dim aData As Variant\n    Dim vData As Variant\n    Dim aResults() As Variant\n    Dim lIndex As Long\n    Dim sFind As String\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    sFind = Me.txtFind.Text\n    Me.listResults.Clear\n\n    With ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n        If .Row &lt; 2 Then\n            Me.txtFind.SetFocus\n            MsgBox \"No data in \" &amp; ws.Name\n            Exit Sub\n        End If\n        aData = .Value\n        ReDim aResults(1 To WorksheetFunction.CountIf(.Cells, \"*\" &amp; sFind &amp; \"*\"), 1 To 1)\n    End With\n\n    lIndex = 0\n    For Each vData In aData\n        If InStr(1, vData, sFind, vbTextCompare) &gt; 0 Then\n            lIndex = lIndex + 1\n            aResults(lIndex, 1) = vData\n        End If\n    Next vData\n\n    If lIndex &gt; 0 Then Me.listResults.List = aResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7008315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94726001b657a3aa0dc859315ef8a16f?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaR", "link": "https://stackoverflow.com/users/7008315/hamzar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 40001451, "answer_count": 1, "score": -1, "last_activity_date": 1476283502, "creation_date": 1476281525, "last_edit_date": 1476281586, "question_id": 40000876, "link": "https://stackoverflow.com/questions/40000876/excel-macros-findall-and-allow-user-to-select-result", "title": "Excel Macros - FindAll and allow user to select result", "body": "<p>I have an excel sheet with all the SKUs in our inventory. There are about 1300 records.Lot of the SKUs have similar numbers with only small variants for colour etc</p>\n\n<p>I already have some code that will find the string entered by the user. My question is how to I present the list to the user and allow him to pick one SKU which I can use an input.</p>\n\n<p>For example, imagine my database as:</p>\n\n<pre><code>Shirt-red\nShirt-Blue\nShirt-Pink\nTrouser-red\nTrouser-blue\n</code></pre>\n\n<p>If the user enters the string Shirt I want to present the user with Shirt-red, Shirt-Blue &amp; Shirt-Pink and allow the user to select one of the 3 options which I will use for further processing</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "performance", "ms-access", "ado", "recordset"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 3, "creation_date": 1476282670, "post_id": 40000848, "comment_id": 67280296, "body": "Seeing the code would be helpful. An initial question, where is the database housed? Is it on a network drive? If so, could it be the network has bandwidth issues?"}, {"owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476367517, "post_id": 40000848, "comment_id": 67323490, "body": "Added code as requested. DB is housed in the cloud on Amazon Web Services. Thanks again!"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476448226, "post_id": 40000848, "comment_id": 67362085, "body": "Hi there a few things I&#39;d consider. Use the MySQL ODBC driver. You can set the OPTION parameter like &quot;OPTION=18435;&quot; in the connection string to use the compression protocol and not to optimize the column width. Also, if you recordset is only going forward set the cursor type of the recordset option to <code>adOpenForwardOnly</code> instead of <code>adOpenStatic</code>. Also if you are only reading data from the connection, set the mode like: <code>MyConn.Mode = adModeRead</code>. Lastly, using passthrough queries wherever possible should also see a speedup."}], "owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594641238, "creation_date": 1476281437, "last_edit_date": 1594641238, "question_id": 40000848, "link": "https://stackoverflow.com/questions/40000848/why-does-vba-script-speed-vary-greatly", "title": "Why Does VBA Script Speed Vary Greatly", "body": "<p>This question may be unsolveable, but I figured I'd give it a shot.</p>\n\n<p>I have a VBA script (running inside of Access 2010) that opens a few recordsets (ADOX), processes them, and writes the result to a local Access table. Sometimes this processing takes a few minutes; sometimes it can take upwards of an hour. The actual data being processed is similar enough that the specific data shouldn't be the cause of the time difference.</p>\n\n<p>When I run the code in break mode (just holding down F8) there are no obvious hangups - the script appears to run just fine.</p>\n\n<p>To add to my confusion, sometimes (but not always) if the script is running slowly, and I pause and then resume (making no other changes), it will run quickly after the resume. This made me think it could be a record caching issue, so I have increased the recordcache for each recordset to be slightly above the maximum record count for that particular recordset, however that doesn't appear to have had any effect.</p>\n\n<p>Does anyone have any idea what could cause these types of fluctuations, and more importantly, what I could do to alleviate them? I can post the code if necessary, but given the different behaviors with the same code in the pause/resume scenario I'm not sure that the issue is code based.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Edit: Added code below. The Do...Loop Until loop is where the speed variances tend to occur. The database is MySQL hosted on Amazon Web Services.</p>\n\n<pre><code>Public Sub ReportTrueAdherenceNew(dtStart As Date, blRebuildIndexes As Boolean)\n\nDim lngScheduleLoadOrderID As Long\nDim dtEnd As Date\nDim dtShiftStart As Date\nDim dtShiftEnd As Date\nDim lngLCV As Long\nDim strIEXUID As String\nDim strFive9ID As String\nDim strMUNumID As String\nDim lngManagerID As Long\nDim lngTimeOffset As Long\nDim dbs As DAO.Database\nDim cn As ADODB.Connection\nDim cnFive9 As ADODB.Connection\nDim qdf As DAO.QueryDef\nDim strSQLAgentList(1 To 1, 1 To 3) As String\nDim strSQLAgentData(1 To 3, 1 To 3) As String\nDim strSQLAgentStateData(1 To 2, 1 To 3) As String\nDim strSQLMaintenance(1 To 2, 1 To 3) As String\nDim strSQLRebuildIndex(1 To 2, 1 To 3) As String\nDim rsAgentSchedule As ADODB.Recordset\nDim rsAgentState As ADODB.Recordset\nDim rsAgentList As ADODB.Recordset\nDim rsAgentDates As ADODB.Recordset\nDim rsAgentAdherent As ADODB.Recordset\nDim rsOOOEvents As ADODB.Recordset\nDim strOOOEvents As String\nDim lngAdherent As Long\nDim lngSchedStateID As Long\nDim lngActStateID As Long\nDim lngTotalAgents As LongPtr\nDim lngProcessingAgent As Long\nDim varReturn As Variant\nDim strAdherenceFile As String\nDim dtAS As Date\n\nDim rsSS As ADODB.Recordset\nDim rsAS As ADODB.Recordset\nDim rsADH As ADODB.Recordset\n\nDim strAgentLim As String\nDim strAgentsExclude As String\nDim strLogFile As String\nDim strMUs As String\n\nstrMUs = \"1000,2000,6000\"\nstrLogFile = \"C:\\Logs\\ReportTrueAdherenceRecordset.txt\"\nLogToFile strLogFile, \"Begin ReportTrueAdherenceRecordset for \" &amp; CStr(dtStart) &amp; \"...\"\ndtEnd = DateAdd(\"d\", 1, dtStart)\nlngScheduleLoadOrderID = 3\n\nstrSQLMaintenance(1, 1) = \"qryADHTransfer\"\nstrSQLMaintenance(1, 2) = \"INSERT INTO tblAdherence (ScheduleDate, ScheduleMinute, IEXUID, Adherent, MUNumID, ManagerID, SchedStateID, AgentStateID) SELECT ScheduleDate, ScheduleMinute, IEXUID, Adherent, MUNumID, ManagerID, SchedStateID, AgentStateID FROM tblAdherenceLoad ORDER BY IEXUID, ScheduleDate, ScheduleMinute;\"\nstrSQLMaintenance(1, 3) = \"workforce_management\"\nstrSQLMaintenance(2, 1) = \"qryADHClearTemp\"\nstrSQLMaintenance(2, 2) = \"DELETE FROM tblAdherenceLoad;\"\nstrSQLMaintenance(2, 3) = \"workforce_management\"\n\nstrSQLRebuildIndex(1, 1) = \"qryAdherenceIndexesDrop\"\nstrSQLRebuildIndex(1, 2) = \"ALTER TABLE `workforce_management`.`tbladherence` \" &amp; _\n    \"DROP FOREIGN KEY `fk_Adherence_IEXUID`, \" &amp; _\n    \"DROP FOREIGN KEY `fk_Adherence_MUNumID`, \" &amp; _\n    \"DROP FOREIGN KEY `fk_Adherence_ManagerID`, \" &amp; _\n    \"DROP INDEX `idxScheduleDate`, \" &amp; _\n    \"DROP INDEX `idxScheduleMinute`, \" &amp; _\n    \"DROP INDEX `idxIEXUID`, \" &amp; _\n    \"DROP INDEX `idxMUNumID`, \" &amp; _\n    \"DROP INDEX `idxManagerID`;\"\nstrSQLRebuildIndex(1, 3) = \"ODBC;DSN=workforce_management;\"\nstrSQLRebuildIndex(2, 1) = \"qryAdherenceIndexesRebuild\"\nstrSQLRebuildIndex(2, 2) = \"ALTER TABLE `workforce_management`.`tbladherence` \" &amp; _\n    \"ADD INDEX `idxScheduleDate` (`ScheduleDate` ASC), \" &amp; _\n    \"ADD INDEX `idxScheduleMinute` (`ScheduleMinute` ASC), \" &amp; _\n    \"ADD INDEX `idxIEXUID` (`IEXUID`), \" &amp; _\n    \"ADD INDEX `idxMUNumID` (`MUNumID`), \" &amp; _\n    \"ADD INDEX `idxManagerID` (`ManagerID`), \" &amp; _\n    \"ADD CONSTRAINT `fk_Adherence_IEXUID` \" &amp; _\n    \"  FOREIGN KEY (`IEXUID`) \" &amp; _\n    \"  REFERENCES `workforce_management`.`tblAgentData` (`IEXUID`) \" &amp; _\n    \"  ON DELETE NO ACTION \" &amp; _\n    \"  ON UPDATE NO ACTION, \" &amp; _\n    \"ADD CONSTRAINT `fk_Adherence_MUNumID` \" &amp; _\n    \"  FOREIGN KEY (`MUNumID`) \" &amp; _\n    \"  REFERENCES `workforce_management`.`tblmu` (`MUNumID`) \" &amp; _\n    \"  ON DELETE NO ACTION \" &amp; _\n    \"  ON UPDATE NO ACTION, \" &amp; _\n    \"ADD CONSTRAINT `fk_Adherence_ManagerID` \" &amp; _\n    \"  FOREIGN KEY (`ManagerID`) \" &amp; _\n    \"  REFERENCES `workforce_management`.`tblmanager` (`ManagerID`) \" &amp; _\n    \"  ON DELETE NO ACTION \" &amp; _\n    \"  ON UPDATE NO ACTION;\"\nstrSQLRebuildIndex(2, 3) = \"ODBC;DSN=workforce_management;\"\n\nstrAgentsExclude = ADHLoadIEXUID(dtStart)\n\nIf strAgentsExclude &lt;&gt; \"\" Then\n    strAgentLim = \"AND ad.IEXUID NOT IN(\" &amp; strAgentsExclude &amp; \") \"\n    LogToFile strLogFile, \"Excluded: \" &amp; strAgentsExclude\nEnd If\n\nstrSQLAgentList(1, 1) = \"qryAdherenceAgentList\"\nstrSQLAgentList(1, 2) = \"SELECT DISTINCT ad.IEXUID, ad.Five9ID, ad.MUNumID, ad.ManagerID, mu.TimeOffset \" &amp; _\n    \"FROM tblAgentData ad \" &amp; _\n        \"INNER JOIN tblAgentScheduleData asd ON ad.IEXUID = asd.IEXUID \" &amp; _\n        \"INNER JOIN tblMU mu ON ad.MUNumID = mu.MUNumID \" &amp; _\n    \"WHERE asd.ScheduleDate = '\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"' AND mu.MUSetID IN(\" &amp; strMUs &amp; \") AND asd.ScheduleActivity NOT IN(SELECT SchedState FROM tblSchedState WHERE InOffice=0) \" &amp; _\n    strAgentLim &amp; _\n    \"UNION SELECT a.IEXUID, ad.Five9ID, a.MUNumID, a.ManagerID, mu.TimeOffset \" &amp; _\n    \"FROM tblAttendance a \" &amp; _\n        \"LEFT JOIN (SELECT DISTINCT adh.MUNumID, adh.ManagerID, adh.IEXUID, adh.ScheduleDate FROM tblAdherence adh WHERE adh.ScheduleDate = '\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"') adh2 ON a.IEXUID = adh2.IEXUID AND a.ScheduleDate = adh2.ScheduleDate \" &amp; _\n        \"INNER JOIN tblAgentData ad ON a.IEXUID = ad.IEXUID \" &amp; _\n        \"INNER JOIN tblMU mu ON a.MUNumID = mu.MUNumID \" &amp; _\n    \"WHERE (adh2.IEXUID IS NULL AND adh2.ScheduleDate IS NULL) AND a.ScheduleDate = '\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"' AND a.ScheduleDate &lt;= (SELECT MAX(adh3.ScheduleDate) FROM tblAdherence adh3) AND a.MUSetID IN(\" &amp; strMUs &amp; \") \" &amp; _\n    strAgentLim &amp; _\n    \"ORDER BY IEXUID;\"\n'Alternate list of those with attendance records but no longer in an active MU\nstrSQLAgentList(1, 3) = \"workforce_management\"\n\nSet dbs = CurrentDb()\nSet cn = New ADODB.Connection\ncn.CursorLocation = adUseClient\ncn.Open \"DSN=workforce_management;\"\nDoCmd.SetWarnings False\n\nIf blRebuildIndexes Then\n    LogToFile strLogFile, \"Dropping indexes on tblAdherence...\"\n    cn.Execute strSQLRebuildIndex(1, 2)\n    LogToFile strLogFile, \"Indexes dropped on tblAdherence...\"\nEnd If\n\nSet rsOOOEvents = New ADODB.Recordset\nrsOOOEvents.Open \"SELECT SchedState FROM tblSchedState WHERE InOffice=0;\", cn, adOpenForwardOnly, adLockReadOnly\nDo\n    strOOOEvents = strOOOEvents &amp; rsOOOEvents.Fields(0) &amp; \";\"\n    rsOOOEvents.MoveNext\nLoop Until rsOOOEvents.EOF\nrsOOOEvents.Close\nSet rsOOOEvents = Nothing\n\nSet rsAgentList = New ADODB.Recordset\nrsAgentList.Open strSQLAgentList(1, 2), cn, adOpenStatic, adLockReadOnly\nrsAgentList.CacheSize = 200\n\nIf Not (rsAgentList.BOF And rsAgentList.EOF) Then\n    LogToFile strLogFile, \"Clearing temp table...\"\n    dbs.Execute \"DELETE * FROM tblAdherenceLoadLocal;\"\n    lngTotalAgents = rsAgentList.RecordCount\n    LogToFile strLogFile, CStr(lngTotalAgents) &amp; \" total agents\"\n    lngProcessingAgent = 1\n\n    Do\n        varReturn = Access.SysCmd(acSysCmdSetStatus, \"Processing agent \" &amp; lngProcessingAgent &amp; \" of \" &amp; lngTotalAgents &amp; \" (\" &amp; CStr(dtStart) &amp; \")\")\n\n        strIEXUID = rsAgentList.Fields(\"IEXUID\")\n        strFive9ID = rsAgentList.Fields(\"Five9ID\")\n        strMUNumID = rsAgentList.Fields(\"MUNumID\")\n        lngManagerID = rsAgentList.Fields(\"ManagerID\")\n        lngTimeOffset = CInt(rsAgentList.Fields(\"TimeOffset\")) + 2\n\n        LogToFile strLogFile, \"Processing - Agent: \" &amp; strFive9ID &amp; \", IEXUID: \" &amp; strIEXUID\n        strSQLAgentData(1, 1) = \"qryAdherenceShiftStart\"\n        strSQLAgentData(1, 2) = \"SELECT MIN(tblAgentScheduleData.StartTime) AS ShiftStart, MAX(tblAgentScheduleData.EndTime) AS ShiftEnd \" &amp; _\n            \"FROM tblAgentScheduleData \" &amp; _\n            \"WHERE (((tblAgentScheduleData.IEXUID)=\" &amp; strIEXUID &amp; \") AND ((tblAgentScheduleData.ScheduleDate)='\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"') AND ScheduleLoadOrderID=\" &amp; lngScheduleLoadOrderID &amp; \");\"\n        strSQLAgentData(1, 3) = \"workforce_management\"\n\n        strSQLAgentData(2, 1) = \"qryAdherenceSchedule\"\n        strSQLAgentData(2, 2) = \"SELECT tblAgentScheduleData.* \" &amp; _\n            \"FROM tblAgentScheduleData \" &amp; _\n            \"WHERE (((tblAgentScheduleData.IEXUID)=\" &amp; strIEXUID &amp; \") AND ((tblAgentScheduleData.ScheduleDate)='\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"') AND ScheduleLoadOrderID=\" &amp; lngScheduleLoadOrderID &amp; \");\"\n        strSQLAgentData(2, 3) = \"workforce_management\"\n\n        strSQLAgentData(3, 1) = \"qryAdherenceActual\"\n        strSQLAgentData(3, 2) = \"SELECT five9_agent_state.*, DATE_ADD(Timestamp, INTERVAL \" &amp; lngTimeOffset &amp; \" HOUR) AS AdjTimestamp \" &amp; _\n            \"FROM five9_agent_state \" &amp; _\n            \"WHERE (((five9_agent_state.Agent_Email)='\" &amp; strFive9ID &amp; \"') AND ((five9_agent_state.Timestamp) Between '\" &amp; Format(dtStart, \"YYYY-MM-DD\") &amp; \"' And '\" &amp; Format(dtEnd, \"YYYY-MM-DD\") &amp; \"')) \" &amp; _\n            \"ORDER BY timestamp;\"\n        strSQLAgentData(3, 3) = \"five9\"\n\n        Set rsAgentDates = New ADODB.Recordset\n        rsAgentDates.Open strSQLAgentData(1, 2), cn, adOpenStatic, adLockReadOnly\n\n        dtShiftStart = CDate(dtStart &amp; \" \" &amp; TimeValue(Nz(rsAgentDates.Fields(\"ShiftStart\"), #12:00:00 AM#)))\n        rsAgentDates.Close\n        Set rsAgentDates = Nothing\n\n        Set rsAgentSchedule = New ADODB.Recordset\n        rsAgentSchedule.Open strSQLAgentData(2, 2), cn, adOpenStatic, adLockReadOnly\n        rsAgentSchedule.CacheSize = 50\n\n        Set cnFive9 = New ADODB.Connection\n        cnFive9.Open \"DSN=five9;\"\n\n        Set rsAgentState = New ADODB.Recordset\n        rsAgentState.Open strSQLAgentData(3, 2), cnFive9, adOpenStatic, adLockReadOnly\n        rsAgentState.CacheSize = 200\n\n        If Not (rsAgentState.BOF And rsAgentState.EOF) Then\n            rsAgentState.MoveLast\n            rsAgentState.MoveFirst\n        End If\n\n        Set rsSS = New ADODB.Recordset\n        rsSS.Open \"tblSchedState\", cn, adOpenStatic, adLockReadOnly\n        rsSS.CacheSize = 50\n\n        If Not (rsAgentSchedule.BOF And rsAgentSchedule.EOF) Then\n            rsSS.MoveFirst\n            rsSS.Find \"SchedState = '\" &amp; rsAgentSchedule.Fields(\"ScheduleActivity\") &amp; \"'\"\n            lngSchedStateID = rsSS.Fields(\"SchedStateID\")\n        End If\n\n        Set rsAS = New ADODB.Recordset\n        rsAS.Open \"tblAgentState\", cn, adOpenStatic, adLockReadOnly\n        rsAS.CacheSize = 100\n\n        Set rsADH = New ADODB.Recordset\n        rsADH.Open \"tblAdherentState\", cn, adOpenStatic, adLockReadOnly\n        rsADH.CacheSize = 100\n\n        Do While dtShiftStart &lt; dtShiftEnd\n            lngAdherent = 0\n            If Not (rsAgentState.BOF And rsAgentState.EOF) Then\n\n                If TimeValue(dtShiftStart) &gt;= TimeValue(rsAgentSchedule.Fields(\"EndTime\")) Then\n                    rsAgentSchedule.MoveNext\n                    rsSS.MoveFirst\n                    rsSS.Find \"SchedState = '\" &amp; rsAgentSchedule.Fields(\"ScheduleActivity\") &amp; \"'\"\n                    lngSchedStateID = rsSS.Fields(\"SchedStateID\")\n                End If\n\n                rsAgentState.Find \"AdjTimestamp&gt;#\" &amp; dtShiftStart &amp; \"#\"\n                If Not rsAgentState.BOF Then rsAgentState.MovePrevious\n                If Not rsAgentState.BOF Then\n                    If rsAgentState.Fields(\"Agent_State_Time\") = \"24:00:00\" Then\n                        dtAS = 0\n                    Else\n                        dtAS = rsAgentState.Fields(\"Agent_State_Time\")\n                    End If\n'                    If TimeValue(dtShiftStart) &gt; DateAdd(\"h\", lngTimeOffset, TimeValue(rsAgentState.Fields(\"Timestamp\")) + TimeValue(rsAgentState.Fields(\"Agent_State_Time\"))) Then\n                    If TimeValue(dtShiftStart) &gt; DateAdd(\"h\", lngTimeOffset, TimeValue(rsAgentState.Fields(\"Timestamp\")) + dtAS) Then\n                        rsAgentState.MoveNext\n                    End If\n                End If\n\n                If Not (rsAgentState.BOF Or rsAgentState.EOF) Then\n                    rsAS.MoveFirst\n                    rsAS.Find \"AgentState = '\" &amp; rsAgentState.Fields(\"Agent_State\") &amp; \"'\"\n                    lngActStateID = rsAS.Fields(\"AgentStateID\")\n                    rsADH.MoveFirst\n                    rsADH.Filter = \"SchedStateID = \" &amp; lngSchedStateID &amp; \" AND AgentStateID = \" &amp; lngActStateID\n                    If Not (rsADH.BOF And rsADH.EOF) Then lngAdherent = 1\n                    rsADH.Filter = \"\"\n                Else\n                    lngActStateID = 10\n                End If\n            End If\n\n            If InStr(1, strOOOEvents, rsAgentSchedule.Fields(\"ScheduleActivity\"), vbTextCompare) = 0 Then\n                dbs.Execute \"INSERT INTO tblAdherenceLoadLocal (ScheduleDate, ScheduleMinute, IEXUID, Adherent, MUNumID, ManagerID, SchedStateID, AgentStateID) \" &amp; _\n                    \"VALUES (#\" &amp; dtStart &amp; \"#,#\" &amp; dtShiftStart &amp; \"#,\" &amp; strIEXUID &amp; \",\" &amp; lngAdherent &amp; \",\" &amp; strMUNumID &amp; \",\" &amp; lngManagerID &amp; \",\" &amp; lngSchedStateID &amp; \",\" &amp; lngActStateID &amp; \");\"\n            End If\n\n            dtShiftStart = DateAdd(\"n\", 1, dtShiftStart)\n        Loop\n\n        rsSS.Close\n        rsAS.Close\n        rsADH.Close\n        rsAgentSchedule.Close\n        rsAgentState.Close\n        cnFive9.Close\n\n        Set rsSS = Nothing\n        Set rsAS = Nothing\n        Set rsADH = Nothing\n        Set rsAgentSchedule = Nothing\n        Set rsAgentState = Nothing\n        Set cnFive9 = Nothing\n\n        If Not rsAgentList.EOF Then rsAgentList.MoveNext\n        lngProcessingAgent = lngProcessingAgent + 1\n        LogToFile strLogFile, \"Completed Processing: \" &amp; strFive9ID\n    Loop Until rsAgentList.EOF\nElse\n    LogToFile strLogFile, \"No agents selected\"\nEnd If\n\nLogToFile strLogFile, \"Completed All Agents;Begin Upload to MYSQL\"\n\nvarReturn = Access.SysCmd(acSysCmdSetStatus, \"Inserting processed records\")\n\nLogToFile strLogFile, \"Generating output file...\"\nstrAdherenceFile = \"C:\\Temp\\\" &amp; Format(dtStart, \"YYYYMMDD\") &amp; \"AdherenceFile.csv\"\nDoCmd.TransferText acExportDelim, , \"qryTrueAdherenceExport\", strAdherenceFile, False\nstrAdherenceFile = VBA.Replace(strAdherenceFile, \"\\\", \"\\\\\")\n\nSet qdf = New DAO.QueryDef\nqdf.Name = \"qryTrueAdherenceTransfer\"\nqdf.Connect = \"ODBC;DSN=workforce_management;\"\nqdf.SQL = \"LOAD DATA LOW_PRIORITY LOCAL INFILE '\" &amp; strAdherenceFile &amp; \"' INTO TABLE workforce_management.tblAdherence FIELDS TERMINATED BY ',' ( @dummy, @var1, @var2, IEXUID, Adherent, MUNumID, ManagerID, SchedStateID, AgentStateID ) SET ScheduleDate = DATE_FORMAT(STR_TO_DATE(@var1, '%m/%d/%Y %H:%i:%s'), '%Y-%m-%d'), ScheduleMinute = DATE_FORMAT(STR_TO_DATE(@var2, '%m/%d/%Y %H:%i:%s'), '%H:%i:%s');\"\nqdf.ReturnsRecords = False\nqdf.ODBCTimeout = 600\ndbs.QueryDefs.Append qdf\nSet qdf = Nothing\n\nLogToFile strLogFile, \"Importing results to server...\"\ndbs.Execute \"qryTrueAdherenceTransfer\"\ndbs.QueryDefs.Delete \"qryTrueAdherenceTransfer\"\n\nvarReturn = Access.SysCmd(acSysCmdSetStatus, \"Clearing temp tables...\")\nLogToFile strLogFile, \"Clearing temp table...\"\ndbs.Execute \"DELETE * FROM tblAdherenceLoadLocal;\"\nFor lngLCV = LBound(strSQLMaintenance, 1) To UBound(strSQLMaintenance, 1)\n    If ExistObject(strSQLMaintenance(lngLCV, 1), acQuery) Then dbs.QueryDefs.Delete strSQLMaintenance(lngLCV, 1)\n    Set qdf = New DAO.QueryDef\n    qdf.Name = strSQLMaintenance(lngLCV, 1)\n    qdf.SQL = strSQLMaintenance(lngLCV, 2)\n    qdf.Connect = \"ODBC;DSN=\" &amp; strSQLMaintenance(lngLCV, 3) &amp; \";\"\n    qdf.ReturnsRecords = False\n    dbs.QueryDefs.Append qdf\n    qdf.Execute\n    Set qdf = Nothing\n    If ExistObject(strSQLMaintenance(lngLCV, 1), acQuery) Then dbs.QueryDefs.Delete strSQLMaintenance(lngLCV, 1)\nNext lngLCV\n\nLogToFile strLogFile, \"Temp tables cleared.\"\n\nIf blRebuildIndexes Then\n    varReturn = Access.SysCmd(acSysCmdSetStatus, \"Rebuilding database indexes...\")\n    LogToFile strLogFile, \"Rebuilding indexes on tblAdherence...\"\n    If ExistObject(strSQLRebuildIndex(2, 1), acQuery) Then dbs.QueryDefs.Delete strSQLRebuildIndex(2, 1)\n    Set qdf = New DAO.QueryDef\n    qdf.Name = strSQLRebuildIndex(2, 1)\n    qdf.SQL = strSQLRebuildIndex(2, 2)\n    qdf.Connect = strSQLRebuildIndex(2, 3)\n    qdf.ReturnsRecords = False\n    qdf.ODBCTimeout = 180\n    dbs.QueryDefs.Append qdf\n    Set qdf = Nothing\n    dbs.Execute strSQLRebuildIndex(2, 1)\n    LogToFile strLogFile, \"Indexes rebuilt on tblAdherence...\"\n    dbs.QueryDefs.Delete strSQLRebuildIndex(2, 1)\nEnd If\n\nvarReturn = Access.SysCmd(acSysCmdClearStatus)\nDoCmd.SetWarnings True\n\nLogToFile strLogFile, \"Process completed successfully\"\n\ncn.Close\nSet cn = Nothing\n\nSet dbs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476280552, "post_id": 40000404, "comment_id": 67278749, "body": "Use the &amp; symbol? Formula: <code>=A1&amp;Today()</code>. Or just do almost exactly the same in VBA: <code>activecell.value=activecell.value &amp; date()</code>. I don&#39;t understand what your question is here."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1476280985, "post_id": 40000404, "comment_id": 67279078, "body": "you mean split not append?"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476348922, "post_id": 40002630, "comment_id": 67309999, "body": "too vague a sentence. give details about: starting data, what&#39;s not working and how&#39;s not working."}, {"owner": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476349162, "post_id": 40002630, "comment_id": 67310166, "body": "I have a requirement like, I want to append the text before my Date for example &quot;9/23/99 10:37am We&#39;re not going&quot; before the date like 9/23/99 I want to append some text"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476350427, "post_id": 40002630, "comment_id": 67310958, "body": "so you want: 1) define/input a &quot;date&quot; (for example &quot;9/23/99&quot;) 2) search a &quot;text&quot; for that &quot;date&quot; 3) have &quot;some other text&quot; being input 4) insert that &quot;some other text&quot; <i>before</i> the &quot;date&quot; in the &quot;text&quot;. Should it be like that: a) where is the &quot;date&quot; to be read from? b) where is the &quot;text&quot; to be read from? c) where is the &quot;some other text&quot; to be read from?"}, {"owner": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476353819, "post_id": 40002630, "comment_id": 67313297, "body": "Yes, I want 1.Search the Date from the Text 2.I want to Insert the text which will &lt;p&gt; and &lt;/p&gt; before the Text . a.Date to be read from the Text. b. text is in the column. c) Other Data will be hardcoded."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476356632, "post_id": 40002630, "comment_id": 67315195, "body": "sorry but I&#39;m not getting you. the best is you enhance your post with a clear example of a &quot;before&quot; and &quot;after&quot; scenario as well as with details about where all relevant data are to be get and/or written"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476692875, "post_id": 40002630, "comment_id": 67436041, "body": "<i>&quot;it is not working&quot;</i> is too vague a sentence. If you want help, you need to provide all possible information about: input data (read from where, its value), output data (written where, its value) and description of what didn&#39;t work"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476695235, "post_id": 40002630, "comment_id": 67437425, "body": "bring with me: I want to know if my answer worked as per your <i>original</i> question. As per this site rules you can&#39;t update a question if not to improve (adding examples, data, screenshots) its understanding but not changing the <i>original</i> request. And, should the OP need to change the <i>original</i>  question, he/she would post a new one. Otherwise, as you may agree, there would be no ending ... Bottom line:Ilet me know if my answer worked as per your <i>original</i> question and, if not, explain with proper detail what&#39;s &quot;not working&quot; <i>actually</i> means"}, {"owner": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476698570, "post_id": 40002630, "comment_id": 67439542, "body": "As per my original question answer is working fine. Now the problem is I want to append html tag when i found date in that String with proper opening and closing of the tag. i.e. if my string is like &quot;23/06/1992 Hello world Note is created 23/4/1991 Note Has been Changed&quot; ---- should be converted to------ &quot;&lt;p&gt; 23/06/1992 Hello world Note is created &lt;/p&gt; &lt;p&gt;23/4/1991 Note Has been Changed&lt;/p&gt;&quot;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1476698975, "post_id": 40002630, "comment_id": 67439798, "body": "Since my answer solved your <i>original</i> question, please mark it as accepted (click on the check mark beside the answer to toggle it from greyed out to filled in). as to new issues you have to make a new post along with your coding efforts and a clear explanation as to how is your posted code not working"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1476424170, "last_edit_date": 1476424170, "creation_date": 1476286371, "answer_id": 40002630, "question_id": 40000404, "link": "https://stackoverflow.com/questions/40000404/append-text-with-date-in-excel-sheet/40002630#40002630", "title": "Append text with Date in Excel Sheet", "body": "<p><strong>edited</strong> after OP's clarifications</p>\n\n<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim newStrng As String\n    Dim word As Variant\n    Dim strngToBeAppended As String\n\n    strngToBeAppended = Application.InputBox(\"Input string to be appended\", 1)\n\n    With Worksheets(\"TextSheet\") '&lt;-- change \"TextSheet\" to your actual sheet with text name\n        For Each word In Split(.Range(\"A1\").Text, \" \") '&lt;-- assuming that the text to be splitted is in cell \"A1\" of the referenced worksheet\n            If Len(word) - Len(Replace(word, \"/\", \"\")) = 2 Then\n                newStrng = newStrng &amp; \" \" &amp; strngToBeAppended &amp; word\n            Else\n                newStrng = newStrng &amp; \" \" &amp; word\n            End If\n        Next word\n        .Range(\"A2\").Value = LTrim(newStrng)\n    End With\nEnd Sub\n</code></pre>\n\n<p>as you see:</p>\n\n<ul>\n<li><p>the \"text to be appended\" is requested to the user by means of an <code>Application.InputBox()</code> call</p></li>\n<li><p>the \"text to append to\" is assumed in cell \"A1\" of worksheet \"TextSheet\"</p></li>\n<li><p>the \"output\" text is written in cell \"A2\" of worksheet \"TextSheet\"</p></li>\n</ul>\n\n<p>you can change all those references to your actual needs</p>\n"}], "owner": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 40002630, "answer_count": 1, "score": -2, "last_activity_date": 1476687387, "creation_date": 1476280227, "last_edit_date": 1476687387, "question_id": 40000404, "link": "https://stackoverflow.com/questions/40000404/append-text-with-date-in-excel-sheet", "title": "Append text with Date in Excel Sheet", "body": "<p>I am trying to append Text field with Date in Excel Sheet. I have a text format like this.</p>\n\n<p><strong>9/23/99 10:37am We're not going. I'm on disablity. Columbus is not the thriving place. It's mostly retired military. She called to ask why she is the only one. Wanted her partner on, too. I explained that happens in the meeting. 9/10/99 4:15p Rick Ludwig referred $995 Wants Essex Funding &amp; Associates Inc. WY 4262-3607-0011-9582 8/01 8/23/99 9:08am Want a NV corporation. Need to do a little bit of finance change around. A couple of the programs. MU and mentors. Parters and I...I am 60. I maxxed out my cards yesterday.</strong></p>\n\n<p>So I want to append some data when my date field will come into picture </p>\n\n<p>for example</p>\n\n<p><strong>\"HTML Paragraph Tag\"9/23/99 10:37am We're not going. I'm on disablity. Columbus is not the thriving place. It's mostly retired military. She called to ask why she is the only one. Wanted her partner on, too. I explained that happens in the meeting. \"End of HTML Paragraph Tag\" \"HTML Paragraph Tag\" 9/10/99 No Need to worry</strong> </p>\n\n<p>Thank you for your help !!!</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476279832, "post_id": 39999739, "comment_id": 67278155, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11573914/check-if-the-file-exists-using-vba\">Check if the file exists using VBA</a>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 3, "creation_date": 1476280015, "post_id": 39999739, "comment_id": 67278309, "body": "Try google next time. This has been asked here a hundred times - and that is just this year. :) <a href=\"http://stackoverflow.com/questions/16351249/vba-check-if-file-exists\">1</a> <a href=\"http://stackoverflow.com/questions/26551757/how-do-i-check-if-a-file-exists-before-i-open-it-via-excel-vba\">2</a> <a href=\"http://stackoverflow.com/questions/4082539/how-do-i-determine-if-file-exists-using-vba-excel-2007\">3</a> <a href=\"http://stackoverflow.com/questions/35712855/test-if-file-exists-using-vba-or-excel-without-dir\">4</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1476283669, "post_id": 39999739, "comment_id": 67281025, "body": "<code>CommandButton21</code>... consider <i>naming</i> things. <code>TimestampAndSaveButton</code> (or whatever) will be much easier to tell from <code>CommandButton42</code> six months from now."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 1, "creation_date": 1476279212, "post_id": 39999889, "comment_id": 67277668, "body": "Nice. I&#39;ll add this to my VBA library."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1476279816, "post_id": 39999889, "comment_id": 67278140, "body": "Upvoted. The <code>FileSystemObject</code> is very useful for other functions too. It&#39;ll be helpful to get acquainted with it. :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1476279938, "post_id": 39999889, "comment_id": 67278244, "body": "Taken to the next level it can be written as <code>IF CreateObject(&quot;Scripting.FileSystemObject&quot;).FileExists(&quot;C:\\Us&zwnj;&#8203;ers\\Moez\\Desktop\\Mac&zwnj;&#8203;ro_Project\\Test1.ppt&zwnj;&#8203;m&quot;) THEN</code> (better to use in a one line function to return TRUE/FALSE)."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476280729, "post_id": 39999889, "comment_id": 67278897, "body": "@RyanWildry I just did and you are right... highly useful. Anything else of that kind that I could look at?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1476280935, "post_id": 39999889, "comment_id": 67279044, "body": "Also in the scripting runtime is the Dictionary Data structure. Extremely useful. See: <a href=\"http://stackoverflow.com/documentation/vba/3667/scripting-dictionary-object#t=201610121401569699478\">stackoverflow.com/documentation/vba/3667/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476283508, "post_id": 39999889, "comment_id": 67280888, "body": "Note that early-binding (adding a reference) to the Scripting runtime will give you better runtime performance, and IntelliSense/autocompletion at design time. I don&#39;t understand why everybody keeps late-binding that library."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476366552, "post_id": 39999889, "comment_id": 67322670, "body": "I like the one line solution. What happens to the object if it is not &quot;Set&quot; e.g. how to set it to nothing when clearing up?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476373476, "post_id": 39999889, "comment_id": 67328225, "body": "@JamieG If you fail to <code>Set</code> it initially, you&#39;ll get an <code>Object Required</code> error.  Once you are finished with it and want to clear it up, you can <code>Set fso = Nothing</code> which will release the memory held by the object."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476399874, "post_id": 39999889, "comment_id": 67341942, "body": "I get the second part of that Dave but in the 7th comment above this one, Darren isn&#39;t setting a reference to the object so it&#39;s that one line use I don&#39;t quite understand and how it&#39;s possible to release the memory in that case."}, {"owner": {"reputation": 406, "user_id": 2701191, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/774c4ebd2f37e1f8345436184ce3981d?s=128&d=identicon&r=PG&f=1", "display_name": "Malcoolm", "link": "https://stackoverflow.com/users/2701191/malcoolm"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1508942586, "post_id": 39999889, "comment_id": 80817968, "body": "@rohrl77 what else is in your vba library ? :) trying to constitute myself one, but my projects are all around the place !"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 7, "last_activity_date": 1476278901, "creation_date": 1476278901, "answer_id": 39999889, "question_id": 39999739, "link": "https://stackoverflow.com/questions/39999739/how-do-i-check-whether-a-file-exists-using-vba-macro-in-powerpoint/39999889#39999889", "title": "How do i check whether a File exists using VBA Macro in Powerpoint", "body": "<p>If you want to check a file exists on the local machine you want to use a <code>FileSystemObject</code>.</p>\n\n<pre><code>Dim fso : Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\nif fso.FileExists(\"Your file name and path here\") Then\n    ' do what you like in the case where the file exists\nElse\n    ' do whatever you wanted to do where the file doesn't exist\nEnd If\n</code></pre>\n\n<p>Let me know if you need any further explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476279137, "post_id": 39999908, "comment_id": 67277615, "body": "same as my method :-)"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1476279295, "post_id": 39999908, "comment_id": 67277731, "body": "That&#39;s actually in Powerpoint and not in Excel. I tried it but it doesn&#39;t work!"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1476280590, "post_id": 39999908, "comment_id": 67278777, "body": "@Zigouma Try it now"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476366500, "post_id": 39999908, "comment_id": 67322621, "body": "This is the only way if you write VBA that has to work on a PC and Mac but the FSO method is much more powerful for PC-only dev."}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 2, "last_activity_date": 1476280579, "last_edit_date": 1495541793, "creation_date": 1476278932, "answer_id": 39999908, "question_id": 39999739, "link": "https://stackoverflow.com/questions/39999739/how-do-i-check-whether-a-file-exists-using-vba-macro-in-powerpoint/39999908#39999908", "title": "How do i check whether a File exists using VBA Macro in Powerpoint", "body": "<p>This is the best way I've seen:</p>\n\n<pre><code>Sub test()\n\nthesentence = InputBox(\"Type the filename with full extension\", \"Raw Data File\")\n\nIf Dir(thesentence) &lt;&gt; \"\" Then\n    MsgBox \"File exists.\"\nElse\n    MsgBox \"File doesn't exist.\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Credit here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11573914/check-if-the-file-exists-using-vba\">Check if the file exists using VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 1, "last_activity_date": 1476279637, "last_edit_date": 1476279637, "creation_date": 1476279085, "answer_id": 39999973, "question_id": 39999739, "link": "https://stackoverflow.com/questions/39999739/how-do-i-check-whether-a-file-exists-using-vba-macro-in-powerpoint/39999973#39999973", "title": "How do i check whether a File exists using VBA Macro in Powerpoint", "body": "<p>Here is my version of checking if something exists. Including a test sub. This should work in any VBA environment, including PowerPoint.</p>\n\n<pre><code>Sub test()\nMsgBox (FileFolderExists(\"C:\\Users\\Moez\\Desktop\\Macro_Project\\Test1.pptm\"))\nEnd Sub\n\nPrivate Function FileFolderExists(str As String) As Boolean\nDim sCheck As String\nsCheck = Dir(str)\n\nIf Len(sCheck) &gt; 0 Then\n    FileFolderExists = True\nElse\n    FileFolderExists = False\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11234, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1476280579, "creation_date": 1476278493, "last_edit_date": 1476280034, "question_id": 39999739, "link": "https://stackoverflow.com/questions/39999739/how-do-i-check-whether-a-file-exists-using-vba-macro-in-powerpoint", "title": "How do i check whether a File exists using VBA Macro in Powerpoint", "body": "<p>I want to check if a file already exist before running my code. If it exists than exit otherwise keep my code running. What I wrote is following code: </p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nIf FileFolderExists(\"C:\\Users\\Moez\\Desktop\\Macro_Project\\Test1.pptm\") Then\n    MsgBox \"Modification already done!\"\nElse\n    deleteTextBox\n    AllBlackAndDate\n    LastModifiedDate\n    SaveAllPresentations \"C:\\Users\\Moez\\Desktop\\Macro_Project\\Test1.pptm\" ' save here\nEnd If\n\nEnd Sub          \n</code></pre>\n"}, {"tags": ["ms-access", "pdf", "vba", "export"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6932857, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e3a87011afa8b7d1de66e107f6e3c4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Ace16150s", "link": "https://stackoverflow.com/users/6932857/ace16150s"}, "edited": false, "score": 0, "creation_date": 1476293778, "post_id": 39999989, "comment_id": 67287726, "body": "When I run this I get a runtime error 2501 the OutputTo action was canceled..looked this up and tried saving to a drive in my network, same thing happened. After further research I don&#39;t think it&#39;s possible to export my form with with saved values from a control source (being a table that I store each unique trip) having them be present on my exported form."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1476279122, "creation_date": 1476279122, "answer_id": 39999989, "question_id": 39999737, "link": "https://stackoverflow.com/questions/39999737/ms-access-vba-possibility-to-export-userform-as-pdf/39999989#39999989", "title": "MS Access VBA - Possibility to export userform as PDF", "body": "<p>you can export your form to pdf using this command</p>\n\n<p>docmd.OutputTo acOutputForm,\"your form name\", acformatpdf, \"export file path\"</p>\n"}], "owner": {"reputation": 97, "user_id": 6932857, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e3a87011afa8b7d1de66e107f6e3c4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Ace16150s", "link": "https://stackoverflow.com/users/6932857/ace16150s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476279122, "creation_date": 1476278479, "question_id": 39999737, "link": "https://stackoverflow.com/questions/39999737/ms-access-vba-possibility-to-export-userform-as-pdf", "title": "MS Access VBA - Possibility to export userform as PDF", "body": "<p>Hello Stackoverflow community,</p>\n\n<p>I am currently testing code in Access VBA that will export a form and all of its controls as it appears directly to the user (while on one record). In short, I have a calculation tool with many inputs which calculates an international trips estimated total cost and saves all the inputs to a table, in order to record costs per unique trip. </p>\n\n<p>Currently (on-click button), I am exporting one record from the table into an excel workbook and have a lengthy P.I.T.A. excel MACRO that re-formats the raw data into the format that is similar to the user-form in Access. Is there any way (other than to screenshot the form) to get a \"print preview\" and save as a PDF or any other output.</p>\n\n<p>Thank you for taking the time to read through this and I appreciate any insight regarding this topic.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1476277057, "post_id": 39999134, "comment_id": 67276071, "body": "You do not build a comma-separated string to pass to <code>Array</code>, that&#39;s not how it works. Declare an array beforehand and <a href=\"http://stackoverflow.com/q/8850984/11683\">fill it</a> without calling <code>Array</code>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1476277507, "post_id": 39999134, "comment_id": 67276397, "body": "<code>Array(SheetsArray)</code> creates an array with one entry.  In <code>Sheets(X)</code>, X can be a number or a string but not an array.  Try <code>MyArray = Array(SheetsArray)</code> and <code>Sheets(MyArray(0))</code>.  Warnings. MyArray must be declared as Variant to be initialised with Array.  The lower bound of an array created with Array depends on <code>Option Base</code>.  I prefer <code>VBA.Array</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1476278610, "post_id": 39999134, "comment_id": 67277184, "body": "@TonyDallimore In <code>Sheets(X)</code> the <code>X</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193217.aspx#Anchor_1\" rel=\"nofollow noreferrer\">can be an array</a>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476282097, "post_id": 39999134, "comment_id": 67279863, "body": "@GSerg.  Thanks for the link.  I will try this out although it makes little sense to me.  <code>Sheets</code> is a <code>Collection</code>.  The documentation I have read on collections is that elements can only be accessed by index or key. In general terms what would Collection(X, Y,Z) mean?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1476282218, "post_id": 39999134, "comment_id": 67279956, "body": "@TonyDallimore <a href=\"http://stackoverflow.com/documentation/vba/5838/collections\">stackoverflow.com/documentation/vba/5838/collections</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1476282262, "post_id": 39999134, "comment_id": 67279990, "body": "@TonyDallimore <code>Sheets</code> is not <i>the</i> <code>Collection</code>, it&#39;s <i>a</i> collection. This particular collection specifically accepts an array as the index and returns union of the sheets listed in the array. There is still one argument to the indexer method, it&#39;s just that singe argument is an array."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476290301, "post_id": 39999134, "comment_id": 67285619, "body": "@Slai Thanks for the link but I can find nothing to contradict my statement that a collection item is identified by its index or its key."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476290926, "post_id": 39999134, "comment_id": 67285973, "body": "@GSerg Where does &quot;<code>Sheets</code> is not <i>the</i> <code>Collection</code>, it&#39;s a collection&quot; come from? Excel VBA has many collections of which <code>Sheets</code> is one. I frequently create my own collections. If I can move multiple elements within any collection in this way then this is a feature of which I was not previously aware. If it is a feature unique to <code>Sheets</code> or <code>Worksheets</code> then I am unhappy because I always found inconsistencies in syntax leads to errors."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1476291409, "post_id": 39999134, "comment_id": 67286260, "body": "@TonyDallimore It comes from me. <code>Sheets</code> is a collection as opposed to <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251465.aspx\" rel=\"nofollow noreferrer\">the <code>Collection</code></a>. There is no standard regarding what other &quot;a-collection&quot;s support because they are not related to each other and it is logical that they accept what makes sense in their area of use. It makes sense for <code>Sheets</code> to accept an array index because it has useful applications. It is not related to moving elements or interacting with other a-collections."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476303563, "post_id": 39999134, "comment_id": 67293238, "body": "@GSerg I have been experimenting and you are correct. Although Sheets is always described as a collection it is not a member of the class Collection. A sub class can have properties and methods that are not inherited from the parent so I do not understand why Sheets is not a member of class Collection. A poor class structure can lead to difficult to locate errors which perhaps explains a lot about Excel. In <code>Sheets(X).Move</code>, X can be an index (number), a key (string) or a Param Array holding either numbers or strings or a mixture."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476303600, "post_id": 39999134, "comment_id": 67293258, "body": "@GSerg   The sheets to be moved are sorted into alphabetic sequence before moving. I have learnt something today so thank you."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1476279339, "post_id": 39999602, "comment_id": 67277775, "body": "The only problem though is that it is common for Excel sheet names to contain commas (<code>&quot;Profits, monthly&quot;</code>)..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1476279960, "post_id": 39999602, "comment_id": 67278263, "body": "@GSerg Updated. Thanks again"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1476279944, "last_edit_date": 1476279944, "creation_date": 1476278193, "answer_id": 39999602, "question_id": 39999134, "link": "https://stackoverflow.com/questions/39999134/cant-pass-string-into-array-function-subscript-out-of-range/39999602#39999602", "title": "Can&#39;t pass string into array function : subscript out of range", "body": "<p>You can split the string into an Array like this:</p>\n\n<p><code>Wb.Sheets(Split(SheetsArray, \",\")).Copy After:=RegionWb.Sheets(RegionWb.Sheets.Count)</code></p>\n\n<p>As GSerg pointed out: You'll need to remove the quotes around the Worksheet names.</p>\n\n<p><code>SheetsArray = SheetsArray &amp; .Cells(j, 2).Value &amp; \",\"</code></p>\n\n<p>The backslash would be a safer delimiter that using a comma because Worksheet names can include a comma but not a backslash. </p>\n\n<p><code>SheetsArray = SheetsArray &amp; .Cells(j, 2).Value &amp; \"/\"</code></p>\n\n<p><code>Wb.Sheets(Split(SheetsArray, \"/\")).Copy After:=RegionWb.Sheets(RegionWb.Sheets.Count)</code></p>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476279944, "creation_date": 1476276875, "last_edit_date": 1531164843, "question_id": 39999134, "link": "https://stackoverflow.com/questions/39999134/cant-pass-string-into-array-function-subscript-out-of-range", "title": "Can&#39;t pass string into array function : subscript out of range", "body": "<p>I'm trying to imitate copying multiple sheets to a new workbook and this is fine if I literally use the sheet names in the array function.</p>\n\n<p>However if I try to pass a string variable into the array I get a subscript out of range error. </p>\n\n<p>The line of concern is:</p>\n\n<pre><code>Wb.Sheets(Array(SheetsArray)).Copy After:=RegionWb.Sheets(RegionWb.Sheets.count)\n</code></pre>\n\n<p>Please see my code below :</p>\n\n<pre><code>Sub CreateFiles()\n    Application.ScreenUpdating = False\n    Dim LastRow As Long\n    Dim WKC As String: WKC = Replace(DateValue(DateAdd(\"ww\", -1, Now() - (Weekday(Now(), vbMonday) - 1))), \"/\", \".\")\n    Dim FilePath As String: FilePath = \"Z:\\MI\\Krishn\\Retail\"\n    Dim BuyerLastRow As Long\n    Dim Wb As Workbook: Set Wb = ActiveWorkbook\n    Dim RegionWb As Workbook\n    Dim RegionCount As Integer\n    Dim RegionCounter As Integer\n    Dim SheetsArray As String\n        With BuyerList\n            LastRow = .Range(\"G1048576\").End(xlUp).Row\n            BuyerLastRow = .Range(\"A1048576\").End(xlUp).Row\n            'Create WKC Dir\n\n            If Dir(FilePath &amp; \"\\\" &amp; WKC, vbDirectory) = \"\" Then\n                MkDir FilePath &amp; \"\\\" &amp; WKC\n            End If\n\n            'Create Create Files\n            If CountFiles(FilePath &amp; \"\\\" &amp; WKC) = 0 Then\n                For i = 2 To LastRow\n                    RegionCounter = 0\n                    SheetsArray = \"\"\n'                    Set RegionWb = Workbooks.Add\n'                    'wb.SaveAs FilePath &amp; \"\\\" &amp; WKC &amp; \"\\\" &amp; .Cells(i, 7).Value\n'                    RegionWb.SaveAs FilePath &amp; \"\\\" &amp; WKC &amp; \"\\\" &amp; \"WKC \" &amp; WKC &amp; \" - \" &amp; .Cells(i, 7).Value &amp; \".xlsb\", 50\n\n                        For j = 2 To BuyerLastRow\n                            RegionCount = Application.WorksheetFunction.CountIf(.Range(\"C:C\"), .Cells(i, 7).Value)\n                            If .Cells(i, 7).Value = .Cells(j, 3).Value Then\n                                SheetsArray = SheetsArray &amp; \"\"\"\" &amp; .Cells(j, 2).Value &amp; \"\"\",\"\n                                RegionCounter = RegionCounter + 1\n                                If RegionCounter = RegionCount Then\n                                    Debug.Print Left(SheetsArray, Len(SheetsArray) - 1)\n                                    Set RegionWb = Workbooks.Add\n                                    RegionWb.SaveAs FilePath &amp; \"\\\" &amp; WKC &amp; \"\\\" &amp; \"WKC \" &amp; WKC &amp; \" - \" &amp; .Cells(i, 7).Value &amp; \".xlsb\", 50\n                                    'Wb.Sheets(Array(Left(SheetsArray, Len(SheetsArray) - 1))).Copy After:=RegionWb.Sheets(RegionWb.Sheets.count)\n                                    SheetsArray = Left(SheetsArray, Len(SheetsArray) - 1)\n                                    Wb.Sheets(Array(SheetsArray)).Copy After:=RegionWb.Sheets(RegionWb.Sheets.count)\n                                    'Wb.Sheets(Array()).Copy After:=RegionWb.Sheets(RegionWb.Sheets.count)\n                                    RegionWb.Save\n                                    RegionWb.Close\n                                    Exit For\n                                End If\n'                                Wb.Sheets(Wb.Sheets(\"Buyer list\").Range(Cells(j, 2).Address).Value).Copy After:=RegionWb.Sheets(RegionWb.Sheets.count)\n                            End If\n                        Next j\n'\n'\n\n                Next i\n            End If\n\n\n        End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "ms-word", "find"], "comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1476277592, "post_id": 39999120, "comment_id": 67276453, "body": "Are you trying to create a VBA macro to do this, in Excel or in Word?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2824371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca04e74a90bd349f25986e7ec063308?s=128&d=identicon&r=PG&f=1", "display_name": "user2824371", "link": "https://stackoverflow.com/users/2824371/user2824371"}, "edited": false, "score": 1, "creation_date": 1523725286, "post_id": 40000380, "comment_id": 86683161, "body": "Error: Expected End function"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 117, "user_id": 2824371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca04e74a90bd349f25986e7ec063308?s=128&d=identicon&r=PG&f=1", "display_name": "user2824371", "link": "https://stackoverflow.com/users/2824371/user2824371"}, "edited": false, "score": 1, "creation_date": 1524461467, "post_id": 40000380, "comment_id": 86963764, "body": "@user2824371 fixed now, the End Function was not inside the code block."}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1524461438, "last_edit_date": 1524461438, "creation_date": 1476280166, "answer_id": 40000380, "question_id": 39999120, "link": "https://stackoverflow.com/questions/39999120/multiple-find-and-replace-in-ms-word-from-a-list-in-ms-excel/40000380#40000380", "title": "Multiple find and replace in MS Word from a list in MS Excel", "body": "<p>If I understood you right, you want to replace Words in your Word Document with Words listed in your Excel File. If so, this macro should do the trick(Macro for MS Word):</p>\n\n<pre><code>Function findAndReplace()\nDim xlApp As Object\nDim xlWB As Object\nDim xlWS As Object\n\nDim i As Integer, j As Integer\nDim lastRow As Integer\n\n'Set Objects\nSet xlApp = CreateObject(\"Excel.Application\")\nSet xlWB = xlApp.Workbooks.Open(\"PATH TO EXCEL FILE\") 'Replace String with path to Excel File\nSet xlWS = xlWB.Worksheets(\"Name of Worksheet\") 'Replace String with your Worksheet Name\n\n'get last row of excel file\nlastRow = xlWS.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n\n'loop through all words in Word Document\nFor i = 1 To ThisDocument.Words.Count - 1 Step 1\n\n    'Loop through cells in Excel File\n    For j = 1 To lastRow Step 1\n\n        'Replace Word value in Column B of Excel File\n        ThisDocument.Words(i) = Replace(ThisDocument.Words(i), xlWS.Cells(j, 1).Value, xlWS.Cells(j, 2).Value)\n    Next j\nNext i\n\n'Close Excel and Cleanup\nSet xlWS = Nothing\nxlWB.Close True\nSet xlWB = Nothing\nxlApp.Quit\nSet xlApp = Nothing\nEnd Function\n</code></pre>\n\n<p>If I understood you wrong, please give us more detail on what you are trying to do.</p>\n"}], "owner": {"reputation": 1, "user_id": 7007863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbba17f4499870a2bd36785a9f58cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emma F", "link": "https://stackoverflow.com/users/7007863/emma-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2264, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524461438, "creation_date": 1476276835, "last_edit_date": 1476288088, "question_id": 39999120, "link": "https://stackoverflow.com/questions/39999120/multiple-find-and-replace-in-ms-word-from-a-list-in-ms-excel", "title": "Multiple find and replace in MS Word from a list in MS Excel", "body": "<p>Hi I really hope you can help me as I've been trying to do this for a while with not a lot of luck. </p>\n\n<p>I have a list in Excel, say, file 1 (say, A1 - B10, 2 columns of words - the words in column A are the ones to be replaced by the ones in column B).</p>\n\n<p>I have a document in word, say, file 2, which I want to run the words in the excel file so that every appearance of any words which are in column A of the excel file is replaced by the corresponding words in column B.</p>\n\n<p>I would really appreciate any help you could give me, thank you so much.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476279816, "post_id": 39999032, "comment_id": 67278141, "body": "you have a ; after from laufzettel this prematurely closes the SQL command. or was it typo?"}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476280004, "post_id": 39999032, "comment_id": 67278303, "body": "Ah no that was a typo but its not the problem."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476280098, "post_id": 39999032, "comment_id": 67278384, "body": "from where are you executing this command? post your on click procedure"}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476280430, "post_id": 39999032, "comment_id": 67278658, "body": "I&#39;m sorry I don&#39;t understand what you mean?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476280816, "post_id": 39999032, "comment_id": 67278962, "body": "Your code behind for the &quot;search button&quot; so we can get the idea what is triggering the error. Your SQL looks valid unless your form name is different."}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476281187, "post_id": 39999032, "comment_id": 67279217, "body": "The code behind the Search button is a Run Report code which i can create when My query above works. I have a question with [Forms]![overview]![StartDate] here the StartDate is the Label Name. I have also tested with TextBox name and it still gives me the same error. But In general which name should it be"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476283366, "post_id": 39999032, "comment_id": 67280792, "body": "your sql looks valid, just try to create a new form. maybe your form is broken."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1476283846, "post_id": 39999032, "comment_id": 67281150, "body": "If the data entered into <code>StartDate</code> and <code>EndDate</code> is text, <code>BETWEEN</code> won&#39;t work; text strings aren&#39;t comparable in that way.  You&#39;d need to change your form entry fields to gather datetime values."}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "edited": false, "score": 0, "creation_date": 1476284001, "post_id": 39999032, "comment_id": 67281253, "body": "I Just created a new form named Oberfla and inserted it in code * BETWEEN [Forms]![Oberfla]![StartDate] AND [Forms]![Oberfla]![EndDate];  * but it gives me the same error"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476284960, "post_id": 39999032, "comment_id": 67281922, "body": "@ashwin is the Laufzettel a standard select query? or a cross-tab? if the second you need to use proper parameters or rebuild the SQL in vba"}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "edited": false, "score": 0, "creation_date": 1476286063, "post_id": 39999032, "comment_id": 67282738, "body": "@ Krish KM Yes the Laufzettel is a CrossTab Query. What do you mean by proper parameters? and why do I need to rebuild the code in VBA?"}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 1, "creation_date": 1476290906, "post_id": 39999032, "comment_id": 67285967, "body": "Can you post the code for your Laufzettel query? That would help diagnose."}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "reply_to_user": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1476303790, "post_id": 39999032, "comment_id": 67293370, "body": "@Rominus : I posted the SQL of my Laufzettel."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1476372801, "post_id": 39999032, "comment_id": 67327739, "body": "If you have time parts in <i>AEingangDatenstromZWorkflow</i>, use <i>Fix</i> to remove that and leave only the date part: <code>Fix(Laufzettel.AEingangDatenstromZWorkflow)</code>."}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "edited": false, "score": 0, "creation_date": 1476374145, "post_id": 39999032, "comment_id": 67328657, "body": "@ Gustav. Thanks it works. I have another problem with Datediff when i use DATEDIFF(minute,  Laufzettel.EPolicierungVSL,  Laufzettel.AEingangDatenstromZWorkflow) It gives me an error saying access does not recognize minute as field? Where am I going wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476284381, "post_id": 40001263, "comment_id": 67281535, "body": "No. That format is for display only. Assuming, of course, that the date fields are of data type Date which they must be."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476286198, "post_id": 40001263, "comment_id": 67282849, "body": "@krishKM: Or, if field is text, apply <i>DateValue</i> which converts localized text formats to date values. Se edit."}, {"owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "edited": false, "score": 0, "creation_date": 1476287247, "post_id": 40001263, "comment_id": 67283639, "body": "@Gustav I get a Run-time error &#39;438&#39; Object doesn&#39;t support this property or method when I try to execute your code by linking it to the search button"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476286114, "last_edit_date": 1476286114, "creation_date": 1476282603, "answer_id": 40001263, "question_id": 39999032, "link": "https://stackoverflow.com/questions/39999032/retrieve-data-using-form-from-dates/40001263#40001263", "title": "Retrieve data using form from Dates", "body": "<p>If build in code (VBA), try with:</p>\n\n<pre><code>SQL = \"SELECT Laufzettel.ANTRAGSNUMMER, Laufzettel.Eingang, Laufzettel.esigniert, Laufzettel.Ausgang, Laufzettel.Anlage, Laufzettel.Policierung \" &amp; _\n\"FROM Laufzettel \" &amp; _\n\"WHERE Lauzettel.Eingang BETWEEN #\" &amp; Format([Forms]![overview]![StartDate], \"yyyy\\/mm\\/dd\") &amp; \"# AND #\" &amp; Format([Forms]![overview]![EndDate], \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n\n<p>If the \"date\" field really is text, apply <em>DateValue</em>:</p>\n\n<pre><code>SQL = \"SELECT Laufzettel.ANTRAGSNUMMER, Laufzettel.Eingang, Laufzettel.esigniert, Laufzettel.Ausgang, Laufzettel.Anlage, Laufzettel.Policierung \" &amp; _\n\"FROM Laufzettel \" &amp; _\n\"WHERE DateValue(Lauzettel.Eingang) BETWEEN #\" &amp; Format([Forms]![overview]![StartDate], \"yyyy\\/mm\\/dd\") &amp; \"# AND #\" &amp; Format([Forms]![overview]![EndDate], \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476365923, "creation_date": 1476276581, "last_edit_date": 1476365923, "question_id": 39999032, "link": "https://stackoverflow.com/questions/39999032/retrieve-data-using-form-from-dates", "title": "Retrieve data using form from Dates", "body": "<p>I have a query in Access named '<em>Laufzettel</em>' and it looks in this way. The dates are in dd.mm.yyyy format</p>\n\n<pre><code>Antragsnummer   Eingang    esigniert    Ausgang     Anlage    Policierung\n\n   111         2.10.2016   2.10.2016   3.10.2016                3.10.2016\n\n   222         3.10.2016   3.10.2016   3.10.2016    4.10.2016\n\n   333         5.10.2016   6.10.2016   7.10.2016                 7.10.2016\n</code></pre>\n\n<p>I am creating a form named '<em>overview</em>' with two Textboxes named <strong>StartDate</strong> and <strong>EndDate</strong> and search button. What I need is When I click the search button by giving in two dates it should retrieve me the related records from the above query with all the fields in form of a report.</p>\n\n<p>The <strong>StartDate</strong> and <strong>EndDate</strong> are related to the Eingang field of the query. SO when I enter 2.10.2016 as StartDate and 5.10.2016 as EndDate it must produce the above query. To achieve this I have started to create a query using the form fields which in turn can produce me the required report when I click the search button. So I am trying with the code </p>\n\n<pre><code>SELECT Laufzettel.ANTRAGSNUMMER,       Laufzettel.Eingang, Laufzettel.esigniert, Laufzettel.Ausgang, Laufzettel.Anlage, Laufzettel.Policierung\nFROM Laufzettel\n WHERE Lauzettel.Eingang BETWEEN [Forms]![overview]![StartDate] and  [Forms]![overview]![EndDate];\n</code></pre>\n\n<p>For which I get an error <em>Access cannot recognise  [Forms]![overview]![StartDate] and [Forms]![overview]![EndDate] as a valid field name or expression</em></p>\n\n<p>How can I achieve the above? Can someone help me?</p>\n\n<p>EDIT : Here is my working Query now. Although It doesn't give me the records from EndDate values.</p>\n\n<pre><code>PARAMETERS [Forms]![overview]![start] DateTime, [Forms]![overview]![end]  DateTime;\n SELECT Laufzettel.ANTRAGSNUMMER,     Laufzettel.AEingangDatenstromZWorkflow, Laufzettel.BEingangesigniertDokumentZWorkflow, Laufzettel.CAusgangDatenstromZWorkflow, Laufzettel.DAnlageSchwebeVSL,  Laufzettel.EPolicierungVSL\n   FROM Laufzettel\n   WHERE (((Laufzettel.AEingangDatenstromZWorkflow) Between [Forms]! [overview]![start] And [Forms]![overview]![end]));\n</code></pre>\n\n<p>Can someone tell me where am I going Wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7007828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd29757808c03f63b6df77cb59ed7e6?s=128&d=identicon&r=PG&f=1", "display_name": "D&#225;vid Papp", "link": "https://stackoverflow.com/users/7007828/d%c3%a1vid-papp"}, "edited": false, "score": 0, "creation_date": 1476278382, "post_id": 39999525, "comment_id": 67277011, "body": "But the cell in question is already read in under rng, so I don&#39;t really see how/why should I reassign the very same cell to my variable."}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 37, "user_id": 7007828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd29757808c03f63b6df77cb59ed7e6?s=128&d=identicon&r=PG&f=1", "display_name": "D&#225;vid Papp", "link": "https://stackoverflow.com/users/7007828/d%c3%a1vid-papp"}, "edited": false, "score": 0, "creation_date": 1476280491, "post_id": 39999525, "comment_id": 67278706, "body": "Alright, the parameter rng in your code, what is that ? I&#39;m guessing a Range object right ? have you assigned range to it before passing ?"}], "tags": [], "owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476277999, "creation_date": 1476277999, "answer_id": 39999525, "question_id": 39998960, "link": "https://stackoverflow.com/questions/39998960/how-to-assign-value-to-cell-in-excel-vba-after-clearing-validation/39999525#39999525", "title": "How to assign value to cell in excel VBA after clearing validation", "body": "<p>I guess you have to pass some range before assigning any value. \nFor eg:</p>\n\n<pre><code>Range(\"A1:A10\") = \"some text\"\n</code></pre>\n\n<p>or maybe something like this:</p>\n\n<pre><code>Dim example As Range\nSet example = Range(\"A1:A10\")\n\nexample.Value = 8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7007828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd29757808c03f63b6df77cb59ed7e6?s=128&d=identicon&r=PG&f=1", "display_name": "D&#225;vid Papp", "link": "https://stackoverflow.com/users/7007828/d%c3%a1vid-papp"}, "edited": false, "score": 0, "creation_date": 1476278851, "post_id": 39999554, "comment_id": 67277369, "body": "I have quite a number a cells, for which this function should be applied, so is there an easy way, when I don&#180;t have to add each one of them manually in the code?"}, {"owner": {"reputation": 37, "user_id": 7007828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd29757808c03f63b6df77cb59ed7e6?s=128&d=identicon&r=PG&f=1", "display_name": "D&#225;vid Papp", "link": "https://stackoverflow.com/users/7007828/d%c3%a1vid-papp"}, "edited": false, "score": 0, "creation_date": 1476278929, "post_id": 39999554, "comment_id": 67277435, "body": "did not see the code part, disregard my prev. comment, I&#39;ll give it a try!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1476278779, "last_edit_date": 1476278779, "creation_date": 1476278077, "answer_id": 39999554, "question_id": 39998960, "link": "https://stackoverflow.com/questions/39998960/how-to-assign-value-to-cell-in-excel-vba-after-clearing-validation/39999554#39999554", "title": "How to assign value to cell in excel VBA after clearing validation", "body": "<p>A function can only put text in the cell in which it is called so you would have to do this using a normal sub (possibly with parameters). E.g.</p>\n\n<pre><code>Sub x()\nsema_list Range(\"A1:A2\"), False\nEnd Sub\n\nSub sema_list(rng As Range, sema As Boolean)\nIf sema = True Then\n    With rng.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=\"=arrangement\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\nEnd If\n\nIf sema = False Then\n    rng.Validation.Delete\n    rng.Value = \"some text\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7007828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd29757808c03f63b6df77cb59ed7e6?s=128&d=identicon&r=PG&f=1", "display_name": "D&#225;vid Papp", "link": "https://stackoverflow.com/users/7007828/d%c3%a1vid-papp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 39999554, "answer_count": 2, "score": 0, "last_activity_date": 1476278779, "creation_date": 1476276352, "last_edit_date": 1476277627, "question_id": 39998960, "link": "https://stackoverflow.com/questions/39998960/how-to-assign-value-to-cell-in-excel-vba-after-clearing-validation", "title": "How to assign value to cell in excel VBA after clearing validation", "body": "<p>So my vba function should assign different values to a cell based on a boolean input. True part works perfectly, however I'm getting stuck with the False statement. The True part assigns a drop down list to the cell, and the False part should erase it, and set its value to text \"N/A\". As soon as I'm trying to change the value of the cell (or any cells actually, with range(\"..\").value command, the code faces an error.</p>\n\n<p>Is there an other way around?\nThanks in advance!</p>\n\n<pre><code>Function sema_list(rng As Range, sema As Boolean)\n\n\nIf sema = True Then\n    With rng.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=\"=arrangement\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\nEnd If\n\nIf sema = False Then\n    rng.Validation.Delete\n    rng.Value = \"some text\"\nEnd If\n\nsema_list = \"\"\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "connection", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476284506, "post_id": 40000511, "comment_id": 67281616, "body": "This has not worked. I am thinking maybe its a lib reference that I need."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476284610, "post_id": 40000511, "comment_id": 67281682, "body": "See my comment on line 2 of the code. You need a reference to ADO. Specifically <code>Microsoft ActiveX Data Objects 2.X Library</code> or you may have version 6.x available. Either should work."}, {"owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476284917, "post_id": 40000511, "comment_id": 67281886, "body": "I have Microsoft ActiveX Data Objects 6.1 Library - so it appears this is not the problem."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476284950, "post_id": 40000511, "comment_id": 67281916, "body": "It would be helpful to know the specific error you are receiving, and on what line."}, {"owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476284967, "post_id": 40000511, "comment_id": 67281929, "body": "I have even tried connecting to the Northwind.mdb and this does not work either. Most strange. :("}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476285295, "post_id": 40000511, "comment_id": 67282152, "body": "It might be the connection string still. I didn&#39;t need the UID portion to connect. <code>Dim sConn As String: sConn = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\\\MyNetworkPath\\BP-MasterDashboard Source\\BP_Planning_by_PT_dept_be.accdb;Mode=Read&quot;</code>"}, {"owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "edited": false, "score": 0, "creation_date": 1476339682, "post_id": 40000511, "comment_id": 67304740, "body": "Run Time Error &#39;-2147467259  Automation Error   Unspecified Error"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 2, "last_activity_date": 1476285365, "last_edit_date": 1476285365, "creation_date": 1476280524, "answer_id": 40000511, "question_id": 39998676, "link": "https://stackoverflow.com/questions/39998676/connection-string-for-ms-access-database-incorrect/40000511#40000511", "title": "Connection String for MS Access Database incorrect", "body": "<p>While the connection string was incorrect, there were other issues as well. Such as, not assigning the connection String to the ADODB Connection object as well as others. Here is the updated code that I hope will get you operational</p>\n\n<pre><code>Private Sub btnGetMsAccessData_Click()\n    'Ensure you add a reference to Microsoft ADO Objects\n    Dim oConn As New ADODB.Connection\n    Dim oRs   As New ADODB.Recordset\n    Dim sSQL  As String: sSQL = \"SELECT * FROM Tbl_Start_Leaver\"\n    'Corrected Connection String from Thomas Inzina\n    Dim sConn As String: sConn = \"Provider=Microsoft.ACE.OLEDB.12.0;UID=Admin;Data Source=\" &amp; _\n                                 \"\\\\MyNetworkPath\\BP-MasterDashboard Source\\BP_Planning_by_PT_dept_be.accdb;Mode=Read\"\n\n    With oConn\n        .ConnectionString = sConn ' You need to assign the connection string to the ADODB.Connection Object\n        .Open\n    End With\n\n    'Make sure the connection isn't open before opening the recordset\n    'You also need to specify which connection you want to use as the second parameter (this was missed)\n    If oRs.State &lt;&gt; adStateOpen Then oRs.Open sSQL, oConn, adOpenStatic, adLockBatchOptimistic, adCmdText\n\n    'Close Connection and RS\n    If oConn.State = adStateOpen Then oConn.Close\n    If oRs.State = adStateOpen Then oRs.Close\n\n    'Clean Up\n    Set oRs = Nothing\n    Set oConn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1734, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476285365, "creation_date": 1476275395, "last_edit_date": 1476278093, "question_id": 39998676, "link": "https://stackoverflow.com/questions/39998676/connection-string-for-ms-access-database-incorrect", "title": "Connection String for MS Access Database incorrect", "body": "<p>I am trying to extrapolate data from an MS Access 2007/2010 Database. </p>\n\n<p>I have the following code in VBA but the connection string is incorrect. I have added the relevant REFERENCES libraries</p>\n\n<pre><code> Private Sub btnGetMsAccessData_Click()\n\nDim sConn As String\nDim oConn As ADODB.Connection\nDim oRs As ADODB.Recordset\nDim sSQL As String\n\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=\\\\MyNetworkPath\\BP-MasterDashboard Source\\BP_Planning_by_PT_dept_be.accdb;Mode=Read\"\n\nSet oConn = New ADODB.Connection        ' Open a connection.\noConn.Open\n\n\nsSQL = \"SELECT * FROM Tbl_Start_Leaver\"        ' Make a query over the connection.\nSet oRs = New ADODB.Recordset\noRs.Open sSQL, , adOpenStatic, adLockBatchOptimistic, adCmdText\n\nMsgBox oRs.RecordCount\n\noConn.Close ' Close the connection.\nSet oConn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>It fails saying Unknown Application error on the oConn.Open line. </p>\n\n<p>I have tried to link a Workbook to one of the tables and this works fine. \nI then looked at the \"Connection\" and copied it into my code but still no joy. </p>\n\n<p>Keeps saying :\nAutomation Error\nUnexpected Error</p>\n\n<p>Any ideas would be appreciated. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1476275158, "post_id": 39998453, "comment_id": 67274769, "body": "Do <code>A1</code> and <code>A2</code> contain <b>constants</b> or <b>formulas</b> ??"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 4534746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9419c142719689fbb84acacc4a9a8df5?s=128&d=identicon&r=PG&f=1", "display_name": "matellan", "link": "https://stackoverflow.com/users/4534746/matellan"}, "is_accepted": false, "score": 3, "last_activity_date": 1476275099, "creation_date": 1476275099, "answer_id": 39998578, "question_id": 39998453, "link": "https://stackoverflow.com/questions/39998453/excel-if-a1-cell-value-is-equal-to-a2-cell-value-select-m3-cell/39998578#39998578", "title": "Excel if A1 cell value is equal to A2 cell value select M3 cell", "body": "<pre><code>if range(\"A1\").value = range(\"A2\").value then\n    range(\"M3\").select\nend if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7007692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb235817d6266a200c1fd2d0e98b7ba?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnie Golem", "link": "https://stackoverflow.com/users/7007692/johnnie-golem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1477541477, "creation_date": 1476274756, "last_edit_date": 1531161705, "question_id": 39998453, "link": "https://stackoverflow.com/questions/39998453/excel-if-a1-cell-value-is-equal-to-a2-cell-value-select-m3-cell", "title": "Excel if A1 cell value is equal to A2 cell value select M3 cell", "body": "<p>I want a simple thing. if A1 cell value is equal to A2 cell value then select M3 cell (set active cell M3)</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["excel", "vba", "ms-office", "ms-project"], "comments": [{"owner": {"reputation": 167, "user_id": 5363723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5d2ed5edfdceded20322aba47eaf9eb?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Farrelle", "link": "https://stackoverflow.com/users/5363723/malcolm-farrelle"}, "edited": false, "score": 0, "creation_date": 1545314262, "post_id": 39998406, "comment_id": 94587188, "body": "Please repost your CreateRibbon function in valid syntax and I&#39;ll have a look."}], "owner": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1593557724, "creation_date": 1476274616, "last_edit_date": 1593557724, "question_id": 39998406, "link": "https://stackoverflow.com/questions/39998406/custom-image-in-ribbon-created-by-macro-in-project", "title": "Custom image in ribbon created by macro in Project", "body": "<p>We have a macro in this file that on the FileOpen event (Project_Open in our case, but I'm trying to make it a little bit general) is creating a RibbonXML string and loads it as a CustomUI, like below: </p>\n\n<pre><code>Function CreateRibbon()\n    Dim ribbonXml As String\n    ribbonXml = \"&lt;customUI ....&gt;\n    ....\n    ribbonXml = \"&lt;mso:button id=\"customButton\" getImage=\"\"GetImage\"\" ....&gt;\n    ....\n    ActiveProject.SetCustomUI (ribbonXml)\nEnd Function\n</code></pre>\n\n<p>Under this function, I specified the GetImage function</p>\n\n<pre><code>Public Function GetImage(Ctrl As IRibbonControl) As IPictureDisp // I tried 'As String' as well\n    On Error Resume Next\n    If Ctrl.ID = \"SiemensLogo\" Then\n        GetImage = \"FormRegionMenu\"\n    Else\n        GetImage = \"HappyFace\"\n    End If 'Ctrl.ID?  \nEnd Function 'GetImage\n</code></pre>\n\n<p>When I open the project, it shows an error message: </p>\n\n<pre><code>Automation error. Exception occured.\n</code></pre>\n\n<p>Any ideas what I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel", "unpivot", "excel-2016"], "comments": [{"owner": {"reputation": 534, "user_id": 5302008, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6da6be45abcaac81c87b513f2d9f1182?s=128&d=identicon&r=PG&f=1", "display_name": "BaldEagle", "link": "https://stackoverflow.com/users/5302008/baldeagle"}, "edited": false, "score": 1, "creation_date": 1476275171, "post_id": 39998245, "comment_id": 67274778, "body": "I&#39;m not close enough to the problem. What does your code do and what do you want it to do? How has it not worked?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1476277989, "post_id": 39998245, "comment_id": 67276724, "body": "might be easier with the Power Query Unpivot, and then just refresh when the new data comes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476307103, "post_id": 39998245, "comment_id": 67295186, "body": "<a href=\"https://stackoverflow.com/questions/36365839/excel-macrovba-to-transpose-multiple-columns-to-multiple-rows/36366394#36366394\" title=\"excel macrovba to transpose multiple columns to multiple rows\">stackoverflow.com/questions/36365839/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 7007601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s1i8P.jpg?s=128&g=1", "display_name": "ExplodingPony", "link": "https://stackoverflow.com/users/7007601/explodingpony"}, "edited": false, "score": 0, "creation_date": 1477173684, "post_id": 39998245, "comment_id": 67660794, "body": "thanks for the help... figured it. took me a while, been many years since I last wrote any VBA"}], "owner": {"reputation": 37, "user_id": 7007601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s1i8P.jpg?s=128&g=1", "display_name": "ExplodingPony", "link": "https://stackoverflow.com/users/7007601/explodingpony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476278060, "creation_date": 1476274130, "last_edit_date": 1476278060, "question_id": 39998245, "link": "https://stackoverflow.com/questions/39998245/dynamic-excel-unpivot-data", "title": "Dynamic Excel Unpivot Data", "body": "<p>I regularly get data in a pre-crosstabbed format that I want to unpivot. \nI've used the built in feature in Excel 2016 to generate most of the macro code, but I need to make it dynamic. </p>\n\n<p>Each week, the columns headings will be the previous weeks dates and the macro has hard coded that specific set of dates used when recording the marco. </p>\n\n<p>Here is my initial spreadsheet\n<img src=\"https://i.stack.imgur.com/xV0IQ.jpg\" alt=\"Initial data\"></p>\n\n<p>The recorded macro gives the following:</p>\n\n<pre><code>    ActiveWorkbook.Queries.Add Name:=\"Table1\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Excel.CurrentWorkbook(){[Name=\"\"Table1\"\"]}[Content],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Source,{{\"\"Code\"\", Int64.Type}, {\"\"Product Description\"\", type text}, {\"\"Store Number\"\", Int64.Type}, {\"\"Store Name\"\", type text}, {\"\"04/09/2016\"\", Int64.Type}, {\"\"05/09/2016\"\", Int64.Type}, {\"\"06/09/2016\"\", Int64.Type}, {\"\"07/09/2016\" &amp; _\n    \"\"\", Int64.Type}, {\"\"08/09/2016\"\", Int64.Type}, {\"\"09/09/2016\"\", Int64.Type}, {\"\"10/09/2016\"\", Int64.Type}}),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"    #\"\"Unpivoted Columns\"\" = Table.UnpivotOtherColumns(#\"\"Changed Type\"\", {\"\"Code\"\", \"\"Product Description\"\", \"\"Store Number\"\", \"\"Store Name\"\"}, \"\"Attribute\"\", \"\"Value\"\")\" &amp; _\n    Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Unpivoted Columns\"\"\"\n</code></pre>\n\n<p>I've altered it to look like this, but it's not worked... </p>\n\n<pre><code>Dim col1 As String, col2 as String, col3 as String, col4 as String, col5 as String, col6 as String, col7 as String\n\ncol1 = Range(\"E1\").Value\ncol2 = Range(\"F1\").Value\ncol3 = Range(\"G1\").Value\ncol4 = Range(\"H1\").Value\ncol5 = Range(\"I1\").Value\ncol6 = Range(\"J1\").Value\ncol7 = Range(\"K1\").Value\n\nActiveWorkbook.Queries.Add Name:=\"Table1\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Excel.CurrentWorkbook(){[Name=\"\"Table1\"\"]}[Content],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Source,{{\"\"Code\"\", Int64.Type}, {\"\"Product Description\"\", type text}, {\"\"Store Number\"\", Int64.Type}, {\"\"Store Name\"\", type text}, {\" &amp; col1 &amp; \", Int64.Type}, {\" &amp; col2 &amp; \", Int64.Type}, {\" &amp; col3 &amp; \", Int64.Type}, {\" &amp; col4 &amp; _\n    \"\"\", Int64.Type}, {\" &amp; col5 &amp; \", Int64.Type}, {\" &amp; col6 &amp; \", Int64.Type}, {\" &amp; col7 &amp; \", Int64.Type}}),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"    #\"\"Unpivoted Columns\"\" = Table.UnpivotOtherColumns(#\"\"Changed Type\"\", {\"\"Code\"\", \"\"Product Description\"\", \"\"Store Number\"\", \"\"Store Name\"\"}, \"\"Attribute\"\", \"\"Value\"\")\" &amp; _\n    Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Unpivoted Columns\"\"\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476274514, "post_id": 39997889, "comment_id": 67274372, "body": "your goal is to get the dates? why don&#39;t you target the date values?"}, {"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476274704, "post_id": 39997889, "comment_id": 67274496, "body": "I need them to be the dates that exist specifically after that pattern which is why I&#39;m including that pattern. Other dates exist in that document."}], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1476279939, "post_id": 39998433, "comment_id": 67278245, "body": "Took what you had, cleaned up my regex. VBA still isn&#39;t giving me anything after the schedule line, though RegExr works."}, {"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1476280719, "post_id": 39998433, "comment_id": 67278885, "body": "Marked it as correct, because I only needed to change <code>([\\r\\n])</code> to <code>([\\r\\n]{1,2})</code> to get it to work. THANK YOU!"}], "tags": [], "owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "is_accepted": true, "score": 1, "last_activity_date": 1476281948, "last_edit_date": 1476281948, "creation_date": 1476274705, "answer_id": 39998433, "question_id": 39997889, "link": "https://stackoverflow.com/questions/39997889/getting-all-lines-as-well-as-the-initial-pattern-in-vba-regex/39998433#39998433", "title": "Getting all lines as well as the initial pattern in VBA regex", "body": "<p>Does something like </p>\n\n<p><code>(OUR SKED|OURS SCHEDULE:)((([\\r\\n]{1,2})(DDMMMYYYY - DDMMMYYYY)|)|){0,3}</code></p>\n\n<p>Work?\nBasically, this Regex can be split up into \n\"OUR SKED\" OR \"OURS SCHEDULE:\"\nthen\nUp to three rows of \"DDMMMYYYY - DDMMMYYYYY\"</p>\n\n<p>You need to change the DDMMMYYY items to be however your dates are displayed (I don't know if MMM is \"MAY\" or supposed to be \"MM\"-> 05)</p>\n\n<p>I put your string (with the line returns \\n) in cell(1,1) and used the following code.</p>\n\n<pre><code>Sub Test()\n\nDim results As Variant\nDim i As Integer\nSet results = StripPatternMatchingRegex(Cells(1, 1), \"(OUR SKED|OURS SCHEDULE:)((([\\r\\n])(DDMMMYYYY - DDMMMYYYY)|)|){0,3}\")\nFor i = 0 To results.Count - 1\n    Debug.Print results.Item(i).Value\nNext i\n\nEnd Sub\n\nPublic Function StripPatternMatchingRegex(ByVal valueToTest As String, ByVal expression As String) As Variant\nDim regex As New RegExp\nDim results As Variant\nDim allmatches As Object\nIf valueToTest &lt;&gt; \"\" Then\n    With regex\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = expression\n    End With\n    ' Debug.Print expression\n    If regex.Test(valueToTest) Then\n        Set StripPatternMatchingRegex = regex.Execute(valueToTest)\n    Else\n        Set StripPatternMatchingRegex = Nothing\n    End If\nEnd If\nEnd Function\n</code></pre>\n\n<p>You can test and play around with regex on a site like <a href=\"http://regexr.com/\" rel=\"nofollow\">RegExr</a></p>\n"}], "owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 39998433, "answer_count": 1, "score": 0, "last_activity_date": 1476281948, "creation_date": 1476273000, "last_edit_date": 1476279885, "question_id": 39997889, "link": "https://stackoverflow.com/questions/39997889/getting-all-lines-as-well-as-the-initial-pattern-in-vba-regex", "title": "Getting all lines as well as the initial pattern in VBA regex", "body": "<p>I'm trying to match a pattern, and then get the next 1-3 lines after that pattern if they exist. I know I'm doing something wrong, but I'm not sure what exactly it is:</p>\n\n<p>So if the string contains:</p>\n\n<pre><code>OUR SKED\nor \nOURS SCHEDULE:\n01JAN14-24FEB16\n26FEB17-17FEB18\n19MAR16 - 24DEC28\n</code></pre>\n\n<p>(ignore the grammar error, I need to incorporate the fact that people can't spell but may get the \"gist\" of it right).\nI need to get that, plus the next 3 lines. Right now I'm only getting the first part matching schedule.</p>\n\n<p><code>((OUR[S]{0,1} S[KCH]{1,2}ED(ULE){0,1})[:]{1})((([\\r\\n])([0-9]{2}[\\s]{0,1}[A-Z]{3}[0-9]{2}[\\s]{0,1}-[\\s]{0,1}[0-9]{2}[\\s]{0,1}[A-Z]{3}[0-9]{2})|)|){0,3}</code></p>\n\n<p>Using <a href=\"http://regexr.com/\" rel=\"nofollow\">RegExr</a> the above works, however in my <code>Debug.Print</code> I'm only getting the \"OUR SCHEDULE:\" part.</p>\n\n<p>Let me break down the above regex for clarity. The schedule part:</p>\n\n<pre><code>((OUR[S]{0,1} S[KCH]{1,2}ED(ULE){0,1})[:]{1})\n</code></pre>\n\n<p>The each subsequent date line, accounting for spaces and random errors:</p>\n\n<pre><code>((([\\r\\n])([0-9]{2}[\\s]{0,1}[A-Z]{3}[0-9]{2}[\\s]{0,1}-[\\s]{0,1}[0-9]{2}[\\s]{0,1}[A-Z]{3}[0-9]{2})|)|){0,3}\n</code></pre>\n\n<p>That will match <code>01JAN17-02FEB17</code> or <code>10 JAN 17 - 02 FEB 17</code> and everything in between.</p>\n\n<p>This gets the correct first line, so I know I'm good there just don't know what else I'm missing.</p>\n\n<p>I'm now using the VBA code from the first answer to test, and still only getting the first part. The VBA code to pull the match is as follows:</p>\n\n<pre><code>Public Function StripPatternMatchingRegex2(ByVal valueToTest As String, ByVal expression As String) As Variant\nDim regex As New RegExp\nDim results As Variant\nDim allmatches As Object\nIf valueToTest &lt;&gt; \"\" Then\n    With regex\n        .Global = True\n        .Multiline = True\n        .IgnoreCase = False\n        .Pattern = expression\n    End With\n    ' Debug.Print expression\n    If regex.test(valueToTest) Then\n        Set StripPatternMatchingRegex2 = regex.Execute(valueToTest)\n    Else\n        Set StripPatternMatchingRegex2 = Nothing\n    End If\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1476272598, "post_id": 39997486, "comment_id": 67273214, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37260496/vba-advancedfilter-to-get-unique-values-after-autofilter\">VBA: AdvancedFilter to get unique values after AutoFilter</a>"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 2, "creation_date": 1476273000, "post_id": 39997486, "comment_id": 67273460, "body": "Use a pivot table"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7007460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d53155acb40b922d6a8e270c553ee93?s=128&d=identicon&r=PG&f=1", "display_name": "Candy", "link": "https://stackoverflow.com/users/7007460/candy"}, "edited": false, "score": 0, "creation_date": 1476435525, "post_id": 40001730, "comment_id": 67353993, "body": "I have data in 5 columns and need"}, {"owner": {"reputation": 1, "user_id": 7007460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d53155acb40b922d6a8e270c553ee93?s=128&d=identicon&r=PG&f=1", "display_name": "Candy", "link": "https://stackoverflow.com/users/7007460/candy"}, "edited": false, "score": 0, "creation_date": 1476435632, "post_id": 40001730, "comment_id": 67354050, "body": "I a need a code where there are duplicates in column D and a single mail needs to be sent to the emails in column C                                        Name\tType of Contact (i.e. Main, Backup)\tEmail Address\tCountry Candy\tMain\tcandy@gmail.com\tAfghanistan Rubin\tMain\trubin@gmail.com\tRubin Elisa\tBackup\tElisa@gmail.com\tRubin Hamlim\tMain\thamlin@gmail.com\tAlgeria Maya\tBackup\tmaya@gmail.com\tAlgeria"}], "tags": [], "owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "is_accepted": false, "score": 0, "last_activity_date": 1476283861, "creation_date": 1476283861, "answer_id": 40001730, "question_id": 39997486, "link": "https://stackoverflow.com/questions/39997486/select-each-and-every-unique-row-when-an-auto-filter-is-applied/40001730#40001730", "title": "Select each and every unique row when an auto filter is applied?", "body": "<p>Using the below VBA code you can do this.</p>\n\n<pre><code>Selection.AutoFilter\nRange(\"A:A\").AdvancedFilter Action:=xlFilterInPlace, Unique:=True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7007460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d53155acb40b922d6a8e270c553ee93?s=128&d=identicon&r=PG&f=1", "display_name": "Candy", "link": "https://stackoverflow.com/users/7007460/candy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476283861, "creation_date": 1476271805, "last_edit_date": 1531164843, "question_id": 39997486, "link": "https://stackoverflow.com/questions/39997486/select-each-and-every-unique-row-when-an-auto-filter-is-applied", "title": "Select each and every unique row when an auto filter is applied?", "body": "<p>For example I wanted to select the unique names that i get under the filter and then send an email</p>\n\n<p><img src=\"https://i.stack.imgur.com/YxSWV.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3836989, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f25e6a644a70261833cdc0f0ef13089f?s=128&d=identicon&r=PG&f=1", "display_name": "lance9877", "link": "https://stackoverflow.com/users/3836989/lance9877"}, "edited": false, "score": 0, "creation_date": 1476354031, "post_id": 39998204, "comment_id": 67313445, "body": "See that is my issue as they enter column a which is text and minutes I need to get the corresponding column B to show so I can then convert. Does that make more sense?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 31, "user_id": 3836989, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f25e6a644a70261833cdc0f0ef13089f?s=128&d=identicon&r=PG&f=1", "display_name": "lance9877", "link": "https://stackoverflow.com/users/3836989/lance9877"}, "edited": false, "score": 0, "creation_date": 1476354218, "post_id": 39998204, "comment_id": 67313567, "body": "Not really. What is entered, and what should the output be? And where?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476273991, "creation_date": 1476273991, "answer_id": 39998204, "question_id": 39997186, "link": "https://stackoverflow.com/questions/39997186/field-conversion/39998204#39998204", "title": "Field conversion", "body": "<p>A time difference can be found with <em>DateDiff</em>:</p>\n\n<pre><code>Minutes = DateDiff(\"n\", StartTime, EndTime)\n</code></pre>\n\n<p>Your conversion can then be calculated by this formula:</p>\n\n<pre><code>Conversion = -Int(-(Minutes - 2) / 60 * 10) / 10\n</code></pre>\n\n<p>For example: 94 minutes -> 1.6</p>\n"}], "owner": {"reputation": 31, "user_id": 3836989, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f25e6a644a70261833cdc0f0ef13089f?s=128&d=identicon&r=PG&f=1", "display_name": "lance9877", "link": "https://stackoverflow.com/users/3836989/lance9877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 11, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476274105, "creation_date": 1476270884, "last_edit_date": 1476274105, "question_id": 39997186, "link": "https://stackoverflow.com/questions/39997186/field-conversion", "title": "Field conversion", "body": "<p>I have an Access form that goes to a back end table. Users enter a time frame and there is a corresponding conversion I want to tell if they are making production. I have created a field to house this conversion. </p>\n\n<p>Is there a way in Access if users enter a time function it will then complete the other field for the conversion? I am not sure how. </p>\n\n<p>I have a second table that has all of the values and the conversions.<a href=\"https://i.stack.imgur.com/7a0DV.png\" rel=\"nofollow\">This is backend conversion table</a>. Is there a way to just reference if this value is entered on to table place this value from other table in this field? Then I could build my production queries. </p>\n"}, {"tags": ["vba", "excel", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 319, "user_id": 6899499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1203d5fd706ef6ab5e815f1514cda9b?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian F", "link": "https://stackoverflow.com/users/6899499/fabian-f"}, "is_accepted": true, "score": 2, "last_activity_date": 1476271271, "creation_date": 1476271271, "answer_id": 39997298, "question_id": 39997115, "link": "https://stackoverflow.com/questions/39997115/how-to-make-my-vba-code-do-nothing-and-move-to-next-step-vba-run-time-error-91/39997298#39997298", "title": "How to make my VBA code do nothing AND move to next step / VBA Run time error 91", "body": "<p>You could probably just add the <code>If Not IsEmpty(Table1.UsedRange) Then</code> statements to your code. This will prevent the code to run if the worksheet is completely empty. Please comment if you need more help.</p>\n\n<pre><code>Sub CreateBasicWordReport()\n'Create word doc automatically\nDim wApp As Word.Application\nDim SaveName As String\n\nSet wApp = New Word.Application\n\nWith wApp\n\n'Make word visible\n\n.Visible = True\n.Activate\n.Documents.Add \"C:\\Users\\MyDesktop\\TemplateWordFile.dotx\"\n\n'paste supplier name in word\nSheets(\"Sheet1\").Range(\"C1\").Copy\n.Selection.Goto what:=wdGoToBookmark, name:=\"SupplierName\"\n.Selection.PasteSpecial DataType:=wdPasteText\n\n'Dynamic range\n\nDim Table1 As Worksheet\nDim Table2 As Worksheet\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\n\nSet Table1 = Worksheets(\"Table 1\")\nSet Table2 = Worksheets(\"Table 2\")\nSet StartCell = Range(\"A1\")\n\n'Paste table 1 in word\n\nIf Not IsEmpty(Table1.UsedRange) Then\n  LastRow = Table1.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n  Table1.Range(\"A1:J\" &amp; LastRow).Copy\n  .Selection.GoTo what:=wdGoToBookmark, name:=\"Table1\"\n  .Selection.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\n  Placement:=wdAlignRowLeft, DisplayAsIcon:=True\nEnd If\n\n'Paste table 2 in word\n\nIf Not IsEmpty(Table2.UsedRange) Then\n  LastRow = Worksheets(\"Table 2\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n  Table2.Range(\"A1:J\" &amp; LastRow).Copy\n  .Selection.GoTo what:=wdGoToBookmark, name:=\"Table2\"\n  .Selection.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\n  Placement:=wdAlignRowLeft, DisplayAsIcon:=True\nEnd If\n\n'Save doc to a specific location and with a specific title\n\nDim name As String\nname = \"C:\\Users\\MyDesktop\\Supplier\\\" &amp; \"DocName\" &amp; \"_\" &amp; _\nSheets(\"Sheet1\").Range(\"C1\").Value &amp; \"_\" &amp; Sheets(\"Sheet1\").Range(\"H1\").Value &amp; _\n\"_\" &amp; Format(Now, \"yyyy-mm-dd\") &amp; \".docx\"\n\n.ActiveDocument.SaveAs2 Filename:=name\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3075174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XTZAj.jpg?s=128&g=1", "display_name": "Gabi", "link": "https://stackoverflow.com/users/3075174/gabi"}, "is_accepted": false, "score": 1, "last_activity_date": 1476272120, "creation_date": 1476272120, "answer_id": 39997600, "question_id": 39997115, "link": "https://stackoverflow.com/questions/39997115/how-to-make-my-vba-code-do-nothing-and-move-to-next-step-vba-run-time-error-91/39997600#39997600", "title": "How to make my VBA code do nothing AND move to next step / VBA Run time error 91", "body": "<p>Unfortunately I'm not able to comment on Fabian's answer, but his suggestion will probably solve your problem. \nI just thought you should know that what your code is doing <strong>on \"On Error Resume Next\" is go to the next line, no matter if there is an error or not</strong>. Therefore, in order to tell the program to do something different in case there is an error, you'd have to verify if the error occurred and handle it.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476280636, "creation_date": 1476280636, "answer_id": 40000553, "question_id": 39997115, "link": "https://stackoverflow.com/questions/39997115/how-to-make-my-vba-code-do-nothing-and-move-to-next-step-vba-run-time-error-91/40000553#40000553", "title": "How to make my VBA code do nothing AND move to next step / VBA Run time error 91", "body": "<p>you could avoid some code repetition and widen your code application by delegating tables cpying/pasting to a specific sub:</p>\n\n<pre><code>Sub PasteTables(docContent As Word.Range, numTables As Long)\n    Dim iTable As Long\n    Dim myRng As Range\n\n    With docContent\n        For iTable = 1 To numTables\n            Set myRng = Worksheets(\"Table \" &amp; iTable).UsedRange\n            If Not IsEmpty(myRng) Then\n                myRng.Copy\n                .Goto(what:=wdGoToBookmark, name:=\"Table\" &amp; iTable).PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\n                Placement:=wdAlignRowLeft, DisplayAsIcon:=True\n                Application.CutCopyMode = False\n            End If\n        Next iTable\n    End With\nEnd Sub\n</code></pre>\n\n<p>correspondingly your main code would shorten down to:</p>\n\n<pre><code>Option Explicit\n\nSub CreateBasicWordReport()\n    'Create word doc automatically\n    Dim wApp As Word.Application\n    Dim name As String\n\n    Set wApp = New Word.Application\n\n    sheets(\"Sheet01\").Range(\"C1\").Copy\n    With wApp.Documents.Add(\"C:\\Users\\MyDesktop\\TemplateWordFile.dotx\") '&lt;-- open word document and reference it        \n        'Make word visible\n        .Parent.Visible = True\n        .Parent.Activate\n\n        'paste supplier name in word\n        .content.Goto(what:=wdGoToBookmark, name:=\"SupplierName\").PasteSpecial DataType:=wdPasteText\n        Application.CutCopyMode = False '&lt;-- it's always a good habit to set it after pasting has taken place\n\n        'paste tables\n        PasteTables .content, 2 '&lt;-- call your specific Sub passing the referenced document content and \"2\" as the maximum number of tables to loop through\n\n        'Save doc to a specific location and with a specific title\n        name = \"C:\\Users\\MyDesktop\\Supplier\\\" &amp; \"DocName\" &amp; \"_\" &amp; _\n        sheets(\"Sheet1\").Range(\"C1\").Value &amp; \"_\" &amp; sheets(\"Sheet1\").Range(\"H1\").Value &amp; _\n        \"_\" &amp; Format(Now, \"yyyy-mm-dd\") &amp; \".docx\"\n        .ActiveDocument.SaveAs2 Filename:=name\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6900397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6447baefc6ca34b711d22ca19acee78?s=128&d=identicon&r=PG&f=1", "display_name": "userkhal", "link": "https://stackoverflow.com/users/6900397/userkhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4207, "favorite_count": 0, "accepted_answer_id": 39997298, "answer_count": 3, "score": 1, "last_activity_date": 1476280636, "creation_date": 1476270617, "last_edit_date": 1476271181, "question_id": 39997115, "link": "https://stackoverflow.com/questions/39997115/how-to-make-my-vba-code-do-nothing-and-move-to-next-step-vba-run-time-error-91", "title": "How to make my VBA code do nothing AND move to next step / VBA Run time error 91", "body": "<p>I am having a problem with the result of my code: Main idea is that i have a word template where i copy paste different tables from an excel file. The tables are in 12 different sheets, named Table 1, Table 2, etc. When there is some data in these sheets, the code works perfectly. This is the entire code:  </p>\n\n<pre><code>Sub CreateBasicWordReport()\n'Create word doc automatically\nDim wApp As Word.Application\nDim SaveName As String\n\nSet wApp = New Word.Application\n\nWith wApp\n\n'Make word visible\n\n.Visible = True\n.Activate\n.Documents.Add \"C:\\Users\\MyDesktop\\TemplateWordFile.dotx\"\n\n'paste supplier name in word\nSheets(\"Sheet1\").Range(\"C1\").Copy\n.Selection.Goto what:=wdGoToBookmark, name:=\"SupplierName\"\n.Selection.PasteSpecial DataType:=wdPasteText\n\n'Dynamic range\n\nDim Table1 As Worksheet\nDim Table2 As Worksheet\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\n\nSet Table1 = Worksheets(\"Table 1\")\nSet Table2 = Worksheets(\"Table 2\")\nSet StartCell = Range(\"A1\")\n\n'Paste table 1 in word\n\nWorksheets(\"Table 1\").UsedRange\nLastRow = Table1.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nTable1.Range(\"A1:J\" &amp; LastRow).Copy\n.Selection.GoTo what:=wdGoToBookmark, name:=\"Table1\"\n.Selection.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\nPlacement:=wdAlignRowLeft, DisplayAsIcon:=True\n\n'Paste table 2 in word\n\nWorksheets(\"Table 2\").UsedRange\nLastRow = Worksheets(\"Table 2\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nWorksheets(\"Table 2\").Range(\"A1:J\" &amp; LastRow).Copy\n.Selection.GoTo what:=wdGoToBookmark, name:=\"Table2\"\n.Selection.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\nPlacement:=wdAlignRowLeft, DisplayAsIcon:=True\n\n'Save doc to a specific location and with a specific title\n\nDim name As String\nname = \"C:\\Users\\MyDesktop\\Supplier\\\" &amp; \"DocName\" &amp; \"_\" &amp; _\nSheets(\"Sheet1\").Range(\"C1\").Value &amp; \"_\" &amp; Sheets(\"Sheet1\").Range(\"H1\").Value &amp; _\n\"_\" &amp; Format(Now, \"yyyy-mm-dd\") &amp; \".docx\"\n\n.ActiveDocument.SaveAs2 Filename:=name\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The problem is when the sheets are blank. I might only need one table (from sheet Table 1) and IF next sheet (Table 2) is empty, then I want VBA to do nothing and move to the next step. But then i get run time error 91 in this line of my code:</p>\n\n<pre><code> LastRow = Worksheets(\"Table 2\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n</code></pre>\n\n<p>I have tried the \"on error resume next\" command, like this:</p>\n\n<pre><code>'Paste table 2 in word\n\nWorksheets(\"Table 2\").UsedRange\nOn Error Resume Next\nLastRow = Worksheets(\"Table 2\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nWorksheets(\"Table 2\").Range(\"A1:J\" &amp; LastRow).Copy\n.Selection.GoTo what:=wdGoToBookmark, name:=\"Table2\"\n.Selection.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, _\nPlacement:=wdAlignRowLeft, DisplayAsIcon:=True   \n</code></pre>\n\n<p>BUT in that case, it does bring to my word file an empty table (five lines, 10 rows that have nothing in, just the outline of a table), while I just want it to be blank/nothing appear on my word file.</p>\n\n<p>Does anybody have any idea how this could be solved pretty please? </p>\n"}, {"tags": ["excel", "vba", "hyperlink", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 4534746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9419c142719689fbb84acacc4a9a8df5?s=128&d=identicon&r=PG&f=1", "display_name": "matellan", "link": "https://stackoverflow.com/users/4534746/matellan"}, "is_accepted": false, "score": 1, "last_activity_date": 1476273934, "creation_date": 1476273934, "answer_id": 39998188, "question_id": 39996507, "link": "https://stackoverflow.com/questions/39996507/store-hyperlinks-to-a-dynamic-range-from-powerpoint/39998188#39998188", "title": "Store hyperlinks to a dynamic range from powerpoint?", "body": "<p>Something like this can works, but you will need to add the Microsoft Excel reference</p>\n\n<pre><code>Dim oSl As Slide\nDim oHl As Hyperlink\nDim sSearchFor As String\nDim sReplaceWith As String\nDim oSh As Shape\nDim wk As Workbook\nDim ws As Worksheet\nDim i As Double\n\nSet wk = Workbooks.Add\nSet ws = wk.Worksheets(1)\n\nws.Cells(1, 1).Value = \"original\"\nws.Cells(1, 2).Value = \"modified\"\ni = 2\n\nsSearchFor = InputBox(\"What text should I search for?\", \"Search for ...\")\nIf sSearchFor = \"\" Then\n    Exit Sub\nEnd If\n\nsReplaceWith = InputBox(\"What text should I replace\" &amp; vbCrLf _\n    &amp; sSearchFor &amp; vbCrLf _\n    &amp; \"with?\", \"Replace with ...\")\n'If sReplaceWith = \"\" Then\n'    Exit Sub\n'End If\n\nOn Error Resume Next\n\nFor Each oSl In ActivePresentation.Slides\n\n    For Each oHl In oSl.Hyperlinks\n        ws.Cells(i, 1).Value = oH1.Address 'original\n        oHl.Address = Replace(oHl.Address, sSearchFor, sReplaceWith) 'modification\n        ws.Cells(i, 2).Value = oH1.Address 'modified\n        i = i + 1\n        oHl.SubAddress = Replace(oHl.SubAddress, sSearchFor, sReplaceWith)\n    Next    ' hyperlink\n\n    For Each oSh In oSl.Shapes\n       If oSh.Type = msoLinkedOLEObject _\n        Or oSh.Type = msoMedia Then\n          oSh.LinkFormat.SourceFullName = _\n               Replace(oSh.LinkFormat.SourceFullName, _\n               sSearchFor, sReplaceWith)\n       End If\n   Next\n\nNext    ' slide\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7007184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d2aeea56eff698477fa1fd9e052b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Varns", "link": "https://stackoverflow.com/users/7007184/j-varns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1476273934, "creation_date": 1476268661, "question_id": 39996507, "link": "https://stackoverflow.com/questions/39996507/store-hyperlinks-to-a-dynamic-range-from-powerpoint", "title": "Store hyperlinks to a dynamic range from powerpoint?", "body": "<p>So I have a large powerpoint presentation which I'm using the following code to modify part of all of the hyperlinks within the presentation (to remove part of the file path to use relative rather than absolute referencing): </p>\n\n<pre><code>Dim oSl As Slide\nDim oHl As Hyperlink\nDim sSearchFor As String\nDim sReplaceWith As String\nDim oSh As Shape\n\nsSearchFor = InputBox(\"What text should I search for?\", \"Search for ...\")\nIf sSearchFor = \"\" Then\n    Exit Sub\nEnd If\n\nsReplaceWith = InputBox(\"What text should I replace\" &amp; vbCrLf _\n    &amp; sSearchFor &amp; vbCrLf _\n    &amp; \"with?\", \"Replace with ...\")\n'If sReplaceWith = \"\" Then\n'    Exit Sub\n'End If\n\nOn Error Resume Next\n\nFor Each oSl In ActivePresentation.Slides\n\n    For Each oHl In oSl.Hyperlinks\n        oHl.Address = Replace(oHl.Address, sSearchFor, sReplaceWith)\n        oHl.SubAddress = Replace(oHl.SubAddress, sSearchFor, sReplaceWith)\n    Next    ' hyperlink\n\n    For Each oSh In oSl.Shapes\n       If oSh.Type = msoLinkedOLEObject _\n        Or oSh.Type = msoMedia Then\n          oSh.LinkFormat.SourceFullName = _\n               Replace(oSh.LinkFormat.SourceFullName, _\n               sSearchFor, sReplaceWith)\n       End If\n   Next\n\nNext    ' slide\n</code></pre>\n\n<p>What I want to do to QA this is to display the original hyperlinks and the modified hyperlinks side by side in an excel sheet to compare original and new links to make sure that everything is working OK.</p>\n\n<p>My first post here, I tried google but not much joy, any help much appreciated!! </p>\n\n<p>Thanks</p>\n\n<p>James</p>\n"}, {"tags": ["vba", "excel", "header", "formatting"], "comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476269409, "post_id": 39996489, "comment_id": 67271175, "body": "Entschuldigung, ich verstehe nicht Deutsch :D"}, {"owner": {"reputation": 208, "user_id": 6870271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286e7d209e7915b83dcd74b41eb155ea?s=128&d=identicon&r=PG&f=1", "display_name": "Etaila", "link": "https://stackoverflow.com/users/6870271/etaila"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476270672, "post_id": 39996489, "comment_id": 67271960, "body": "As far as I knot the only german word is Fett -&gt; Fat, and is a formatting part, if I accidently wrote some other german parts, let me know."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1476273139, "post_id": 39996489, "comment_id": 67273545, "body": "@Ismalith, your header is in German"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476274031, "post_id": 39996489, "comment_id": 67274073, "body": "better now. :-) Is there anything a good old &quot;split(string, &quot;;&quot;) &quot; can solve in your problem? I don&#39;t see what your problem is... BTW if you use &amp; to concatenate, the space before &amp; is mandatory"}, {"owner": {"reputation": 208, "user_id": 6870271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286e7d209e7915b83dcd74b41eb155ea?s=128&d=identicon&r=PG&f=1", "display_name": "Etaila", "link": "https://stackoverflow.com/users/6870271/etaila"}, "edited": false, "score": 0, "creation_date": 1476274250, "post_id": 39996489, "comment_id": 67274215, "body": "I don&#39;t define the way the string is written, it is created by word itself when format change are made by the user, like changeing the size or color, which is the problem, every use of the split() function would let the last format parameter together with the name and since these parameter isn&#39;t defined in lenght, I don#t have any idea how to get the name and parameters seperated.  &amp;K03+039Appendix with Appendix as the name and K03+039 as a color parameter would be the core of the problem, but could also be &amp;SAppendix."}], "answers": [{"tags": [], "owner": {"reputation": 208, "user_id": 6870271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286e7d209e7915b83dcd74b41eb155ea?s=128&d=identicon&r=PG&f=1", "display_name": "Etaila", "link": "https://stackoverflow.com/users/6870271/etaila"}, "is_accepted": true, "score": 0, "last_activity_date": 1478504507, "last_edit_date": 1478504507, "creation_date": 1476365442, "answer_id": 40022433, "question_id": 39996489, "link": "https://stackoverflow.com/questions/39996489/vba-excel-2013-headline-footline-manipulation/40022433#40022433", "title": "VBA Excel 2013 Headline / Footline manipulation", "body": "<p>Ok I now developed a solution to my problem that works for me, it isn't beautiful but works.</p>\n\n<p>It can split up a given string into formatting parts and a text part, however it can't work with &amp;&amp; within a title, that needs to be taken care of before using this method.</p>\n\n<p>It also doesn't know the formatting of page numbers, since I didn't need it but that can be fixed very easily.</p>\n\n<pre><code>Public FullLine As SeperatedLineParts\n</code></pre>\n\n<p>Private Function InformationHandler(text As String)\n    Set FullLine = New SeperatedColumnParts\n    Dim param As String\n    Dim textPart As String\n    Dim co As Integer</p>\n\n<pre><code>'Stops the function when \"text\" is empty\nIf text = \"\" Then\n    FullLine.text = text\n    FullLine.format = \"\"\n    Exit Function\nEnd If\n\n\n\n\n\n'Splits the incoming \"text\" in single Symbols\nDim singleSymbols() As String\nReDim singleSymbols(Len(text) - 1)\nFor co = 1 To Len(text)\n    singleSymbols(co - 1) = Mid$(text, co, 1)\nNext\n\n\n\n'switch case variables, helper for seperating the \"text\"\nDim isParam As String   ' Boolean Value as a String, to use it for the switch cases\nDim wasText As Boolean  ' Remembers if the last part was a textpart or a format part, if it was a text and now a format part is following, they will be sepperated\nisParam = \"False\"       ' Remembers if the current Symbol is a textpart or a format part\nwasText = False\nFullLine.parts = 1      ' remembers the number of parts with different formats\n\n' This loop splits Format and Textparts and writes a Chr(3)||Chr(2) Marker between the different formatted parts\nFor co = 0 To UBound(singleSymbols)\n    Select Case singleSymbols(co) + isParam\n\n    Case Chr(38) + \"False\"          ' If a &amp; symbol appears it will start a new parameter except if another &amp; follows (&amp;&amp;)\n        If singleSymbols(co + 1) = Chr(38) Then\n        textPart = textPart + \"&amp;&amp;\"\n        co = co + 1\n        isParam = \"False\"\n        Else\n\n        If wasText = True Then      ' If a &amp; follows after a textsegment a new part will be created except when another &amp; follows (&amp;&amp;)\n            textPart = textPart + Chr(3) + \"||\" + Chr(2)               ' Chr(3) and Chr (2) arte the permitter  and  that split a following formatpart from a leading textpart\n            param = param + Chr(3) + \"||\" + Chr(2)\n            FullLine.parts = FullLine.parts + 1\n            wasText = False\n        End If\n\n        isParam = \"True\"\n        param = param + \"&amp;\"\n        End If\n\n\n    ' Identifies all single letter commands\n    Case \"L\" + \"True\", \"C\" + \"True\", \"R\" + \"True\", \"I\" + \"True\", \"E\" + \"True\", \"X\" + \"True\", \"Y\" + \"True\", \"B\" + \"True\", \"U\" + \"True\", \"S\" + \"True\", \"D\" + \"True\", \"T\" + \"True\", \"F\" + \"True\", \"A\" + \"True\", \"N\" + \"True\", \"Z\" + \"True\", \"G\" + \"True\"\n        param = param + singleSymbols(co)\n        isParam = \"False\"\n\n    ' Identifies all size commands\n    Case \"1\" + \"True\", \"2\" + \"True\", \"3\" + \"True\", \"4\" + \"True\", \"5\" + \"True\", \"6\" + \"True\", \"7\" + \"True\", \"8\" + \"True\", \"9\" + \"True\"\n        param = param + singleSymbols(co)\n        If IsNumeric(singleSymbols(co + 1)) Then\n            co = co + 1\n            param = param + singleSymbols(co)\n        End If\n        isParam = \"False\"\n\n\n    Case Chr(34) + \"True\"           ' If the \" symbol appears at the beginning of a command it will be a longer command till another \" symbol ends it\n        Dim coun As Integer\n        param = param + singleSymbols(co)\n        For coun = co + 1 To UBound(singleSymbols)\n            param = param + singleSymbols(coun)\n            If singleSymbols(coun) = Chr(34) Then\n                co = coun\n                coun = UBound(singleSymbols)\n            End If\n        Next\n        isParam = \"False\"\n\n\n    Case \"K\" + \"True\"               ' Identifies all color commands\n        param = param + singleSymbols(co)\n        For coun = 1 To 6\n            param = param + singleSymbols(coun + co)\n        Next\n        co = co + 6\n        isParam = \"False\"\n\n\n    Case Else                       ' Identifies all normal text symbols\n        textPart = textPart + singleSymbols(co)\n        wasText = True\n\n    End Select\nNext\n\n' Writes the format and the text parts into the \"FullLine\" object, wich now contains these parameters as well as the number of parts\nFullLine.format = param\nFullLine.text = text\nEnd Function\n\n\n'Function for making a string out of an array while shorten it at the beginning for the given amount\nPrivate Function ArrToString(inpu() As String, shortenBy As Integer) As String\n    Dim i As Integer\n    For i = shortenBy + 1 To UBound(inpu)\n        ArrToString = ArrToString + inpu(i)\n    Next\n\nEnd Function\n</code></pre>\n\n<p>I know it is a monster and will probably hurt every more experienced programmer, but it is the best I could come up with till now.</p>\n\n<p>edit: it still has the issue that if there are format symbols within the text, it will take only the last text part as text and everything that is between a format part will be seen as a Format as well.</p>\n\n<p>Is there any more effective way to get this done.</p>\n\n<p>Edit: Redesigned the whole function, it is now able to deal with format changes within a text and the &amp;&amp;, also the commentary was improved to make it changeable for other user.</p>\n\n<p>Also write a classmodule with:</p>\n\n<pre><code>Option Explicit\nPublic parts As Integer\nPublic format As String\nPublic text As String\n</code></pre>\n\n<p>for the function to work.</p>\n\n<p>edit: the Chr(3) and Chr (4) symbols don't work on this side, and the example comments for what you should see in your output don't show them, so your result will differ from what is shown here.\nFor all that matters these symbols are symbols that are unlikely to be used by any headline in excel, and can be changed without any further changes in the rest of the code.</p>\n"}], "owner": {"reputation": 208, "user_id": 6870271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286e7d209e7915b83dcd74b41eb155ea?s=128&d=identicon&r=PG&f=1", "display_name": "Etaila", "link": "https://stackoverflow.com/users/6870271/etaila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40022433, "answer_count": 1, "score": 0, "last_activity_date": 1478504507, "creation_date": 1476268619, "last_edit_date": 1476859964, "question_id": 39996489, "link": "https://stackoverflow.com/questions/39996489/vba-excel-2013-headline-footline-manipulation", "title": "VBA Excel 2013 Headline / Footline manipulation", "body": "<p>I am currently working on a VBA tool that sets the headline and footline in an Excel document for all sheeds in it automaticly, it opens when a document is opened and the user can ether import the head and footline from another document, write it in the fields in the gui window.\nTo prevent the user from having to type in everything if he maybe just needs a small change, the window has all values already filled in from the current document.</p>\n\n<p>My problem is now that I don't know how to split the incoming string up into format parts and the  actual shown text parts, (it is not neccesary to split the formatting parts themselves up).</p>\n\n<p>till now I used Replace() to simply erase known format parts and add them manually at the end, but that won't cut it for varying titles.</p>\n\n<p>Attemts with using a For loop to cut the incoming string at the &amp; symbols failed because for once the user could use Titles with &amp; symbols and the last format does directly continue with the actual text (&amp;K03+039Appendix a color variable leading into the title part Appendix)</p>\n\n<p>I also can't use any parts of the table itself since this will be a universal too for all kinds of tables.</p>\n\n<p>So I want to know if there is a way to split a title string into actual text parts and format parts.</p>\n\n<p>An Input String with every format I could come up with was this:\n&amp;\"Algerian,Fett\"&amp;14&amp;S&amp;X&amp;K03+039Appendix C - Opera\nwhile Appendix C - Opera was the Title.</p>\n\n<p>Thank you for the help in advance</p>\n"}, {"tags": ["excel", "vba", "visual-studio", "reporting-services"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1476276536, "post_id": 39996383, "comment_id": 67275713, "body": "I&#39;m not sure, but I notice in <code>code.go_compare(ReportItems)</code> that <code>ReportItems</code> is a type name you use in <code>Function go_compare(Items as ReportItems)</code>"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1476278292, "post_id": 39996383, "comment_id": 67276953, "body": "Thanks @PaulOgilvie. I have tried variants on this where I send fields individually rather than the whole report item collection but still get the same error e.g. <code>=code.go_compare(Fields!AOS.Value,Fields!AfterAOS.Value)</code> (plus changing the code to reflect this)"}], "answers": [{"tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1476283805, "creation_date": 1476283805, "answer_id": 40001713, "question_id": 39996383, "link": "https://stackoverflow.com/questions/39996383/ssrs-vba-code-object-reference-not-set-to-an-instance-of-an-object/40001713#40001713", "title": "SSRS VBA code Object reference not set to an instance of an object", "body": "<p>The problem seems to have arisen from the Erase Diff statement. If I follow this with a ReDim of the array then the routine works!</p>\n\n<p>Anyone out there know why the original code (i.e. without the ReDim) might work in Excel VBA but not in SSRS?</p>\n\n<pre><code>For y = 0 To 1\n    Erase Diff\n    Redim Diff(100)\n</code></pre>\n"}], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476283805, "creation_date": 1476268244, "last_edit_date": 1476278804, "question_id": 39996383, "link": "https://stackoverflow.com/questions/39996383/ssrs-vba-code-object-reference-not-set-to-an-instance-of-an-object", "title": "SSRS VBA code Object reference not set to an instance of an object", "body": "<p>I have some custom code in an SSRS report which works perfectly well (with minor changes) when I run it with test data in Excel VBA but fails in SSRS with the error <br><br>\n<b>The Value expression for the textbox \u2018textbox72\u2019 contains an error: Object reference not set to an instance of an object</b><br><br>\nThe report is a simple table report. The custom code compares \"before\" and \"after\" strings in an audit report and should send back added or removed details. The strings are separated by char(10). The strings lines can only be added or removed. The string lines themselves will not change. There are no Null strings. I have successfully tested this in Excel VBA, so I think the code is probably ok. Any ideas?</p>\n\n<p>The code call in textbox72 is</p>\n\n<pre><code>=iif(len(Fields!AOS.Value) &gt; 0 and len(Fields!AfterAOS.Value) &gt; 0,code.go_compare(ReportItems),\"\")\n</code></pre>\n\n<p>The code in the report is:</p>\n\n<pre><code>Function go_compare(Items as ReportItems) as string\nDim j As Integer\nDim x As Integer\nDim Diff(50) As String\nDim DiffInd As Integer\nDim Intmatch As Integer\nDim StrDiff as string\nDim Arr() As String\nDim Arr1() As String\nDim StrVal As String\nDim StrFinal As String\nDim y As Integer\nDim Str1 as string\nDim Str2 as string\n\nStr1 =  items(\"AOS_1\").value\nStr2 = items(\"AfterAOS\").value\nStrFinal = \"\"\nStrDiff = \"\"\n\nFor y = 0 To 1\n   Erase Diff\n   If y = 1 Then\n      StrVal = \"Removed\"\n      Arr = Split(Str1, Chr(10))\n      Arr1 = Split(Str2, Chr(10))\n      Else\n      StrVal = \"Added\"\n      Arr = Split(Str2, Chr(10))\n      Arr1 = Split(Str1, Chr(10))\n  End If\n  For j = 0 To UBound(Arr)\n    Intmatch = 0\n    For x = 0 To UBound(Arr1)\n       If Trim(Arr(j)) = Trim(Arr1(x)) Then\n         Intmatch = 1\n       End If\n    Next x\n    If Intmatch = 0 Then\n      Diff(DiffInd) = Trim(Arr(j))\n      DiffInd = DiffInd + 1\n    End If\n  Next j\n\n  StrDiff = StrDiff &amp; StrVal &amp; \" Values\" + vbCrLf\n  For j = 0 To UBound(Diff)\n     If Diff(j) = \"\" Then Exit For\n     StrDiff = StrDiff + Diff(j) + vbCrLf\n Next j\n If Len(StrDiff) &gt; 16 Then\n    StrFinal = StrFinal + StrDiff\n End If\n StrDiff = \"\"\nNext y\nReturn StrFinal\nEnd Function\n</code></pre>\n\n<p>Sample data (from Excel VBA test)</p>\n\n<pre><code>Dim StrStr1 As String\nDim StrStr2 As String\n\n StrStr1 = \"xxxx\" &amp; Chr(10)\n StrStr1 = StrStr1 &amp; \"yyyy\" &amp; Chr(10)\n StrStr1 = StrStr1 &amp; \"zzzz\" &amp; Chr(10)\n StrStr1 = StrStr1 &amp; \"aaaa\" &amp; Chr(10)\n StrStr1 = StrStr1 &amp; \"bbbb\" &amp; Chr(10)\n StrStr1 = StrStr1 &amp; \"cccc\" &amp; Chr(10)\nStrStr1 = StrStr1 &amp; \"dddd\" &amp; Chr(10)\n\nStrStr2 = \"xxxx\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"yyyy\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"zzzz\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"aaaa\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"bbbb\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"dddd\" &amp; Chr(10)\nStrStr2 = StrStr2 &amp; \"eeee\" &amp; Chr(10)\n</code></pre>\n\n<p>Expected result</p>\n\n<pre><code>Removed Values\ncccc\n\nAdded Values\neeee\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1476269235, "post_id": 39996601, "comment_id": 67271052, "body": "Good answer, can you just explain how to use in excel too ;)"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1476269326, "post_id": 39996601, "comment_id": 67271116, "body": "done both :-) (was gonna add the part to use it on excel anyway :D )"}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476417735, "post_id": 39996601, "comment_id": 67346062, "body": "Thank you Pierre ,user3598756 Both worked. Pierre I was off so could not see the answers. Thanks again."}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476775599, "post_id": 39996601, "comment_id": 67475929, "body": "@pierre thank you this helped me for a long time question."}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 2, "last_activity_date": 1476269282, "last_edit_date": 1476269282, "creation_date": 1476268965, "answer_id": 39996601, "question_id": 39996346, "link": "https://stackoverflow.com/questions/39996346/how-to-use-different-functions-out-put-in-function/39996601#39996601", "title": "How to use different functions out put in function?", "body": "<pre><code>Function Pminmax(P, Mx, My, b, d, b1, d1, ex, ey)\n    P1 = (---------)\n    P2 = (---------)\n    P3 = (---------)\n    P4 = (---------)\n    dim a(1 to 2,1 to 1)\n    a(1,1) = Application.WorksheetFunction.Max(P1, P2, P3, P4)\n    a(2,1) = Application.WorksheetFunction.Min(P1, P2, P3, P4)\n    Pminmax=a\nEnd Function\n</code></pre>\n\n<p>in excel: select 2 cells, formula, ctrl+shift+enter</p>\n"}, {"comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476269640, "post_id": 39996754, "comment_id": 67271309, "body": "hahaha that was my answer too. Before I edited it. :D (except I used byref)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476269748, "post_id": 39996754, "comment_id": 67271366, "body": "@Pierre, well your first answer was not quite this"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476270166, "post_id": 39996754, "comment_id": 67271650, "body": "that&#39;s because I modified it. ;-)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476272906, "post_id": 39996754, "comment_id": 67273415, "body": "@Pierre, I&#39;m referring to your <i>actual</i> first edit, that still can be seen if you click the <code>edited ... ago</code> tag below your code. There you had a <code>Sub sousfonction()</code> not returning anything but accepting <code>ByRef</code> and setting parameters P1...P4. So that you had both to call first <code>sousfonction</code> and then <code>Pmin()</code>. While my solution uses a <code>Function</code> directly.  Anyhow it seems like devi didn&#39;t bother neither answers at all..."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476273302, "post_id": 39996754, "comment_id": 67273631, "body": "indeed your version is simpler&amp;better in this matter :-)  I meant no offense, I was just having a small laugh as we had the same interpretation of the question. But indeed OP seems not to bother answering which is rude."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476275697, "post_id": 39996754, "comment_id": 67275135, "body": "@Pierre, I got no offense and I was not saying my solution is better than yours, just pointing out it was different. As for rudeness, many people with  1 rep are likely to act as devi is doing by now"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476277146, "post_id": 39996754, "comment_id": 67276143, "body": "Yours is better, no debate, but still similar. :-)  Yes I had that several times, it is really annoying... such lack of etiquette is a shame."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476279951, "post_id": 39996754, "comment_id": 67278254, "body": "I had to say it, you know it. :-)"}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476418454, "post_id": 39996754, "comment_id": 67346217, "body": "Thank you Pierre  and user3598756. sorry for late acknowledgement as I am not regular here. I am using excel to develop my engineering calculation sheet so was not of urgent and it is learning. thank you again"}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476418701, "post_id": 39996754, "comment_id": 67346289, "body": "I have this following question, In my engineering calculation I need to use some parameter again and again say for example all those parameters P,Mx,My,b,d,b1,d1,ex,ey."}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476418883, "post_id": 39996754, "comment_id": 67346334, "body": "I have this following question, In my engineering calculation I need to use some parameter again and again say for example all those parameters P,Mx,My,b,d,b1,d1,ex,ey. Now how I can define these parameters globally so that in functions it is not necessary to call or assign these parameters again and again?? Thank you in advance"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476423442, "post_id": 39996754, "comment_id": 67347734, "body": "devi, if you need to use them in different sub of the same <code>module</code> than place their declaration statement (e.g.:<code>Dim P As Double, Mx As Double,...</code>) at the top of it. If you need them to be shared among different <code>modules</code> you can define them as <code>Public</code> (e.g. <code>Public P As Double, Mx As Double, ...</code>) placing this declaration at the top of any of them... But don&#39;t say anybody I told you that.... BTW when addressing your comment to some user you have to suffix his/her name with &quot;@&quot; (e.g. &quot;@user3598756&quot;)"}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476446865, "post_id": 39996754, "comment_id": 67361172, "body": "@user3598756 thanks for the education really appreciated it. I run a test as follows but it not work"}, {"owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "edited": false, "score": 0, "creation_date": 1476447239, "post_id": 39996754, "comment_id": 67361424, "body": "@user3598756  first I declared them as you said then wrote a function say function pn(P,Mx,My) -------- end function and now I have another function q which uses same parameter for another procedure  I tried as function q( ) ---- end function (with out putting parameters inside parenthesis) . it didn&#39;t work . Thank you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476448833, "post_id": 39996754, "comment_id": 67362505, "body": "Wait. My info was about sharing variables between subs/functions of a VBA project. If you are using those function as UDF to be inpit in excel worksheet cells, then you have to use full <i>signature</i>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1476269491, "creation_date": 1476269491, "answer_id": 39996754, "question_id": 39996346, "link": "https://stackoverflow.com/questions/39996346/how-to-use-different-functions-out-put-in-function/39996754#39996754", "title": "How to use different functions out put in function?", "body": "<p>you could define a Pn function that returns an array of P's values</p>\n\n<pre><code>Function Pn(P, Mx, My, b, d, b1, d1, ex, ey)\n    P1 = '(---------)\n    P2 = '(---------)\n    P3 = '(---------)\n    P4 = '(---------)\n\n    Pn = Array(P1, P2, P3, P4)\nEnd Function\n</code></pre>\n\n<p>and then use it in your <code>Pmin()</code> and <code>Pmax()</code> functions</p>\n\n<pre><code>Function Pmax(P, Mx, My, b, d, b1, d1, ex, ey)\n    Pmax = Application.WorksheetFunction.Max(Pn(P, Mx, My, b, d, b1, d1, ex, ey))\nEnd Function\n\nFunction Pmin(P, Mx, My, b, d, b1, d1, ex, ey)\n    Pmin = Application.WorksheetFunction.Min(Pn(P, Mx, My, b, d, b1, d1, ex, ey))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7007108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AGrBFUuyaI0/AAAAAAAAAAI/AAAAAAAAAP8/Sw3CaRYDip0/photo.jpg?sz=128", "display_name": "devi", "link": "https://stackoverflow.com/users/7007108/devi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39996754, "answer_count": 2, "score": 0, "last_activity_date": 1476269491, "creation_date": 1476268163, "last_edit_date": 1531164843, "question_id": 39996346, "link": "https://stackoverflow.com/questions/39996346/how-to-use-different-functions-out-put-in-function", "title": "How to use different functions out put in function?", "body": "<p>I have a procedure which gives many values and I need to return maximum and minimum of these values to separate cells. </p>\n\n<p>my procedure follows defining two different function for max and min, executing the same procedure!! </p>\n\n<p>Is there a better way to do this? </p>\n\n<pre><code>Function Pmax(P, Mx, My, b, d, b1, d1, ex, ey)\nP1 = (---------)\nP2 = (---------)\nP3 = (---------)\nP4 = (---------)\nPmax = Application.WorksheetFunction.Max(P1, P2, P3, P4)\nEnd Function\nFunction Pmin(P, Mx, My, b, d, b1, d1, ex, ey)\nP1 = (--------)\nP2 = (--------)\nP3 = (--------)\nP4 = (--------)\nPmin = Application.WorksheetFunction.Min(P1, P2, P3, P4)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1476268238, "post_id": 39996162, "comment_id": 67270445, "body": "Cell value can be anything, not just integer, so it is not a good idea to use an integer variable to store it. Go with String. If you are sure only numbers between ~-32000 and ~+32000 will be in said cell, then go with @clusks&#39;s answer, and remove the quotes."}, {"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476269019, "post_id": 39996162, "comment_id": 67270931, "body": "The cell value will always be an integer, so have declared it as that and now removed the quotes"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476269208, "post_id": 39996162, "comment_id": 67271039, "body": "Define &quot;not working&quot;. Error messafe? False positive? Flase negative? Have you tried stepping through the code (F8)? Did you check what was in your <code>check</code> variable (Locals window, or mouse over it while you step through the code)?"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 2, "creation_date": 1476269517, "post_id": 39996162, "comment_id": 67271243, "body": "shouldn&#39;t this be Workbook_BeforeSave ?"}, {"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476269807, "post_id": 39996162, "comment_id": 67271413, "body": "@Pierre this has fixed the issue, thank you very much"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476269889, "post_id": 39996162, "comment_id": 67271473, "body": "hahaha that was simple. :D  Should I put it as an answer so you accept it to close the question?"}, {"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476270143, "post_id": 39996162, "comment_id": 67271636, "body": "@Pierre Yes please"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "edited": false, "score": 0, "creation_date": 1476268920, "post_id": 39996236, "comment_id": 67270871, "body": "Just tried this but still not working for some reason."}, {"owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "edited": false, "score": 0, "creation_date": 1476268969, "post_id": 39996236, "comment_id": 67270899, "body": "Anything else you can see?"}, {"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "reply_to_user": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "edited": false, "score": 0, "creation_date": 1476269440, "post_id": 39996236, "comment_id": 67271194, "body": "Where is the code? Have you put this in &quot;TheWorkbook&quot; in the Microsoft Excel Objects list?"}], "tags": [], "owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "is_accepted": false, "score": -1, "last_activity_date": 1476269838, "last_edit_date": 1476269838, "creation_date": 1476267798, "answer_id": 39996236, "question_id": 39996162, "link": "https://stackoverflow.com/questions/39996162/check-cell-0-if-it-does-display-message-box-and-cancel-save/39996236#39996236", "title": "Check cell = 0 if it does display message box and cancel save", "body": "<p>You're seeing if what is in the check cell is a string, since you've put quotation marks around it - \"0\", but check has been declared as an integer. Try changing it to just 0 without the quotation marks.</p>\n\n<p>EDIT: Please also ensure that this code appears in \"TheWorkbook\" module and change the name to Workbook_BeforeSave (as pointed out by @Pierre)</p>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": true, "score": 5, "last_activity_date": 1476688235, "last_edit_date": 1476688235, "creation_date": 1476270227, "answer_id": 39997005, "question_id": 39996162, "link": "https://stackoverflow.com/questions/39996162/check-cell-0-if-it-does-display-message-box-and-cancel-save/39997005#39997005", "title": "Check cell = 0 if it does display message box and cancel save", "body": "<p>The sub name should be <code>Workbook_BeforeSave</code>. </p>\n\n<p>The hardest to find errors are always the simplest ones. :D</p>\n"}], "owner": {"reputation": 107, "user_id": 1511736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b047d202277aa3879ddc1970d69a6ef3?s=128&d=identicon&r=PG", "display_name": "Sean_myers", "link": "https://stackoverflow.com/users/1511736/sean-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 39997005, "answer_count": 2, "score": 0, "last_activity_date": 1476688235, "creation_date": 1476267545, "last_edit_date": 1476269035, "question_id": 39996162, "link": "https://stackoverflow.com/questions/39996162/check-cell-0-if-it-does-display-message-box-and-cancel-save", "title": "Check cell = 0 if it does display message box and cancel save", "body": "<p>I am having an issue with some VBA code which seems so basic but yet is just not working. I am new to VBA so possible that I am missing something.</p>\n\n<p>The code is supposed to check a cell (XFD3002) to see if it equals 0, if it does then display a message and stop the file from saving. For background, there is a check to see that certain cells are filled and if not it will return a 0.</p>\n\n<p>The code is:</p>\n\n<pre><code>Private Sub Check_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nDim check As Integer\ncheck = Sheets(\"Data\").Range(\"XFD3002\").Value\n\nIf check = 0 Then\n    MsgBox (\"You have missed one or more required field\")\n    Cancel = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone see something wrong with the above?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476274751, "post_id": 39997653, "comment_id": 67274524, "body": "Thank you for your answer!"}, {"owner": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476274829, "post_id": 39997653, "comment_id": 67274579, "body": "Thank you for your answer! However it gives out an error in the line [Dim streetsDict As New Scripting.Dictionary], stating that this is not defined?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476275868, "post_id": 39997653, "comment_id": 67275247, "body": "add to your project the reference to &quot;Microsoft Scripting Runtime&quot; (Tool-&gt;References, scroll the listbox till that library, tick its checkbox and press OK) . and let me know"}, {"owner": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476276563, "post_id": 39997653, "comment_id": 67275732, "body": "Is there maybe a solution without setting this, as I wanted to save this formula as an Excel Add-In and then share it with my colleagu"}, {"owner": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476276579, "post_id": 39997653, "comment_id": 67275746, "body": "Is there maybe a solution without setting this, as I wanted to save this formula as an Excel Add-In and then share it with my colleagues?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "edited": false, "score": 0, "creation_date": 1476278176, "post_id": 39997653, "comment_id": 67276861, "body": "to avoid adding reference to &quot;Microsoft Scripting Runtime&quot;, substitute <code>.Add street, New Scripting.Dictionary </code> with  <code>.Add street, CreateObject(&quot;Scripting.Dictionary&quot;)</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1476272301, "creation_date": 1476272301, "answer_id": 39997653, "question_id": 39995795, "link": "https://stackoverflow.com/questions/39995795/vba-vlookup-for-adresses-with-removing-duplicates/39997653#39997653", "title": "VBA Vlookup for Adresses with removing duplicates", "body": "<p>the issue lies in your <code>RemoveDupes2()</code> function</p>\n\n<p>mainly in that it processes as <code>keys</code> both street <em>names</em> (\"Mainstreet\", \"Yorkstreet \",...) and <em>numbers</em> (\"1\", \"2\", ..) <em>separately</em> so that after you add \"1,\" the first time (e.g.: from \"Mainstreet 1, 2, ...\") to the created dictionary, any further occurrence of \"1,\" in <code>txt</code> (e.g. \"Yorkstreet 1, 2\") won't pass the <code>Not .exists(Trim(x))</code> check and thus won't be added to the dictionary <code>keys</code> </p>\n\n<p>while adopting \" \" as delimeter is the reason why you get \"Yorkstreet 2\"</p>\n\n<p>since the first occurrence of \"2\" is actually a \"2,\" from \"Mainstreet 1, 2, \" (i.e. it gets \"caught\" together with the adjacent comma having \" \" as <code>Split()</code> delimeter parameter), while the second is a \"pure\" \"2\" from \" Yorkstreet 1, 2\"</p>\n\n<p>you may want to adopt the following <code>RemoveDupes2()</code> code</p>\n\n<pre><code>Function RemoveDupes2(txt As String, Optional delim As String = \" \") As String\n    Dim x\n    Dim streetsDict As New Scripting.Dictionary\n    Dim street As String, number As String\n\n    With CreateObject(\"Scripting.Dictionary\")\n        .CompareMode = vbTextCompare\n        For Each x In Split(txt, \", \")\n            If Trim(x) &lt;&gt; \"\" Then\n                street = Split(Trim(x), \" \")(0)\n                number = Split(Trim(x), \" \")(1)\n                If Not .Exists(street) Then\n                    .Add street, New Scripting.Dictionary\n                    .Item(street).Add number, Nothing\n                Else\n                    If Not .Item(street).Exists(number) Then .Item(street).Add number, Nothing\n                End If\n            End If\n        Next\n        If .Count &gt; 0 Then\n            For Each x In .Keys\n                RemoveDupes2 = RemoveDupes2 &amp; x &amp; \" \" &amp; Join(.Item(x).Keys, \", \") &amp; \", \"\n            Next x\n            RemoveDupes2 = Left(RemoveDupes2, Len(RemoveDupes2) - 2)\n        End If\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7006967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd07aaeb4e140732b8a80d1fbd6e6fe?s=128&d=identicon&r=PG&f=1", "display_name": "ABCDE", "link": "https://stackoverflow.com/users/7006967/abcde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 39997653, "answer_count": 1, "score": 0, "last_activity_date": 1476272641, "creation_date": 1476266418, "last_edit_date": 1476272641, "question_id": 39995795, "link": "https://stackoverflow.com/questions/39995795/vba-vlookup-for-adresses-with-removing-duplicates", "title": "VBA Vlookup for Adresses with removing duplicates", "body": "<p>I am looking at a problem where I have following Excel set up:</p>\n\n<pre><code>1 Mainstreet 1\n1 Mainstreet 2\n1 Yorkstreet 1\n1 Yorkstreet 2\n</code></pre>\n\n<p>Where in column A is the 1 and in B the street including the number.</p>\n\n<p>Now I want to have a Vlookup, which searches for the 1 and gives out:</p>\n\n<p>Mainstreet 1, 2, Yorkstreet 1, 2</p>\n\n<p>I have already set up an code with the help of searching through blogs (see end of the question), however it gives out.</p>\n\n<p>Mainstreet 1,2, Yorkstreet 2,</p>\n\n<p>I think that the problem lies within the \"removedupes2\" formula, which also identifies the 2 from Yorkstreet as text and consequentyl removes it.</p>\n\n<p>Does anyone have a clue? :)</p>\n\n<p>Thank you in advance :)</p>\n\n<p>Find my code below:</p>\n\n<pre><code>    Function StrSort(ByVal sInp As String, _\n    Optional bDescending As Boolean = False) As String\n     ' sorts a comma-delimited string\n    Dim asSS()  As String ' substring array\n    Dim sSS     As String ' temp string for exchange\n    Dim n       As Long\n    Dim i       As Long\n    Dim j       As Long\n\n    asSS = Split(sInp, \",\")\n    n = UBound(asSS)\n\n    For i = 0 To n\n        asSS(i) = Trim(asSS(i))\n    Next\n\n    If n &lt;= 1 Then\n        StrSort = sInp\n    Else\n        For i = 0 To n - 1\n            For j = i + 1 To n\n                If (asSS(j) &lt; asSS(i)) Xor bDescending Then\n                    sSS = asSS(i)\n                    asSS(i) = asSS(j)\n                    asSS(j) = sSS\n                End If\n            Next j\n        Next i\n        StrSort = Join(asSS, \", \")\n    End If\nEnd Function\n\nFunction RemoveDupes2(txt As String, Optional delim As String = \" \") As String\n    Dim x\n\n    With CreateObject(\"Scripting.Dictionary\")\n        .CompareMode = vbTextCompare\n        For Each x In Split(txt, delim)\n            If Trim(x) &lt;&gt; \"\" And Not .exists(Trim(x)) Then .Add Trim(x), Nothing\n        Next\n        If .Count &gt; 0 Then RemoveDupes2 = Join(.keys, delim)\n    End With\nEnd Function\n\nFunction Myvlookup(lookupval, lookuprange As Range, indexcol As Long)\n\nDim r As Range\nDim result As String\nDim result2 As String\nDim result3 As String\nresult = \"\"\nFor Each r In lookuprange\n    If r = lookupval Then\n        result = result &amp; \", \" &amp; r.Offset(0, indexcol - 1)\n    End If\nNext r\n\nresult2 = Right(result, Len(result) - 2)\n\nresult3 = StrSort(result2)\nMyvlookup = RemoveDupes2(result3)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476265941, "post_id": 39995281, "comment_id": 67268973, "body": "You need to watch this series <a href=\"https://www.youtube.com/playlist?list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction</a> this is the relavent video <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=5\" rel=\"nofollow noreferrer\">Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>.  It sounds like to you want to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet.Change Event (Excel)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1476266525, "creation_date": 1476266525, "answer_id": 39995820, "question_id": 39995281, "link": "https://stackoverflow.com/questions/39995281/move-range-based-on-cell-value/39995820#39995820", "title": "Move Range Based On Cell Value", "body": "<p>You need to use the built-in event <code>Worksheet_Change</code> :</p>\n\n<p>In <a href=\"/questions/tagged/vbe\" class=\"post-tag\" title=\"show questions tagged &#39;vbe&#39;\" rel=\"tag\">vbe</a>, on the left, double-click on the sheet you want this code to work. You'll access the sheet module, you have 2 lists just upon the text editor to select which event you want to use.</p>\n\n<p>You can use this code there, it'll transfer the data of the 'Completed' line from B:O to Q:AE :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Application.Intersect(Me.Columns(15), Target) Is Nothing Then\n    If Target.Value &lt;&gt; \"Completed\" Then\n    Else\n        Dim FirstFreeRowInColQ As Long\n        FirstFreeRowInColQ = Me.Range(\"Q\" &amp; Me.Rows.Count).End(xlUp).Row + 1\n\n        Me.Range(\"Q\" &amp; FirstFreeRowInColQ &amp; \":AE\" &amp; FirstFreeRowInColQ).Value = _\n            Me.Range(\"B\" &amp; Target.Row &amp; \":O\" &amp; Target.Row).Value\n    End If\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 7006770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a822458971786175f897d8d1b3e33470?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7006770/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1476346977, "creation_date": 1476346977, "answer_id": 40015821, "question_id": 39995281, "link": "https://stackoverflow.com/questions/39995281/move-range-based-on-cell-value/40015821#40015821", "title": "Move Range Based On Cell Value", "body": "<p>I used offset to move the data across and an insert \"Delete\" function to delete the original range. The offset created an un-bordered cell  which I had to fix and I also cleared the \"Completed\" cell once it had been moved to the new range.</p>\n\n<p>I'm still struggling with the loop but I'll continue trying.</p>\n\n<pre><code>Sub Move()\n\nDim r As Range, cell As Range, mynumber As Long\n\nSet r = Range(\"O1:O1000\")\n\nmynumber = 1\nFor Each cell In r\n    If cell.Value = \"Completed\" Then\n    Range(\"Q14:AE14\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    End If\n\n    If cell.Value = \"Completed\" Then\n    cell.Select\n    cell.Value = \"Delete\"\n    Range(ActiveCell, ActiveCell.Offset(0, -14)).Select\n    Selection.Copy\n    Range(\"Q14\").Select\n    ActiveSheet.Paste\n\n       With Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\n\n    Range(\"AE14\").ClearContents\n\n    End If\n\n    If cell.Value = \"Delete\" Then\n    cell.Select\n    Range(ActiveCell, ActiveCell.Offset(0, -14)).Select\n    Selection.Delete Shift:=xlUp\n\n    End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 7006770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a822458971786175f897d8d1b3e33470?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7006770/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 731, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476346977, "creation_date": 1476264933, "last_edit_date": 1476265287, "question_id": 39995281, "link": "https://stackoverflow.com/questions/39995281/move-range-based-on-cell-value", "title": "Move Range Based On Cell Value", "body": "<p>I'm quite new to VBA and am working on a code to copy a range only if a cell value in the same row is \"Completed\". </p>\n\n<p>The copied range is then pasted in another column and the original range is deleted. </p>\n\n<p>It would be great if it could loop as well so that the movement happens automatically when the cell value is changed to completed. My code so far is:</p>\n\n<pre><code>Sub Move()\n\n    Dim r As Range, cell As Range, mynumber As Long\n\n    Set r = Range(\"O1:O1000\")\n\n    mynumber = 1\n    For Each cell In r\n        If cell.Value = \"Completed\" Then\n        Range(\"Q15:AE15\").Select\n        Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n        If cell.Value = \"Completed\" Then\n        ActiveCell.Select\n        ActiveCell.Range(\"B:O\").Select\n        Selection.Copy\n        Range(\"Q14\").Select\n        ActiveSheet.Paste\n\n        End If\n\n        Next\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476266219, "post_id": 39995276, "comment_id": 67269174, "body": "What error do you have and where?"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476266498, "post_id": 39995276, "comment_id": 67269357, "body": "In the intermediate window, I see sql as select * from dataFile, whereas it should be select * from product.csv. the value of dataFile I.e product.csv should be in sql query."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476266617, "post_id": 39995276, "comment_id": 67269447, "body": "good reference <a href=\"https://www.youtube.com/watch?v=HE9CIbetNnI&amp;index=33&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 30 - ADO (ActiveX Data Objects) Querying a Database</a>.  Please consider refactoring your question before refactoring your code."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1476266905, "post_id": 39995276, "comment_id": 67269634, "body": "Cn.open(&quot;provider = Microsoft.Jet.OLRDB.4.0;&quot; &amp; _ &quot;Data Source = &quot; &amp; pathName &amp;&quot;;&quot; &amp; _ &quot;Extended Properties=&quot;&quot;text; HDR=Yes; FMT=Delimited; IMEX=1;&quot;&quot;&quot;"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1476266993, "post_id": 39995276, "comment_id": 67269699, "body": "@ThomasInzina it gives error as dataFile.text not found or doesn&#39;t exist.It is still taking dataFile as file name. It should take product.csv value that I have assigned to it  in my code description on the post."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1476268101, "creation_date": 1476268101, "answer_id": 39996325, "question_id": 39995276, "link": "https://stackoverflow.com/questions/39995276/dynamic-fetching-of-data-file-name-and-passion-to-sql-in-vba/39996325#39996325", "title": "Dynamic fetching of data file name and passion to sql in VBA", "body": "<p>It seems like:</p>\n\n<p><code>Sql = \"select * from [dataFile]\"</code></p>\n\n<p>Should be</p>\n\n<p><code>Sql = \"SELECT * FROM [\" &amp; dataFile &amp; \"]\"</code></p>\n\n<p>I merged you code with the example from <a href=\"https://msdn.microsoft.com/en-us/library/ms974559.aspx\" rel=\"nofollow\">Much ADO About Text Files</a> to give you a better example.</p>\n\n<pre><code>Sub Example()\n    Dim conn As Object, rs As Object\n    Dim Filename As String, dataFile As String\n\n\n    'Refernce: https://msdn.microsoft.com/en-us/library/ms974559.aspx\n\n    On Error Resume Next\n    Const adOpenStatic = 3\n    Const adLockOptimistic = 3\n    Const adCmdText = &amp;H1\n\n    Filename = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"FileEnv\").Value\n    dataFile = FileNameFromPath(Filename)\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    conn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n              \"Data Source=\" &amp; Filename &amp; \";\" &amp; _\n              \"Extended Properties=\"\"text;HDR=YES;FMT=Delimited\"\"\"\n\n    rs.Open \"SELECT * FROM [\" &amp; dataFile &amp; \"]\", _\n            conn, adOpenStatic, adLockOptimistic, adCmdText\n\n    Do Until rs.EOF\n\n    Loop\n\nEnd Sub\n\nFunction FileNameFromPath(Filename As String) As String\n    FileNameFromPath = Right(Filename, Len(Filename) - InStrRev(Filename, \"\\\"))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 39996325, "answer_count": 1, "score": 0, "last_activity_date": 1476268101, "creation_date": 1476264916, "last_edit_date": 1531164843, "question_id": 39995276, "link": "https://stackoverflow.com/questions/39995276/dynamic-fetching-of-data-file-name-and-passion-to-sql-in-vba", "title": "Dynamic fetching of data file name and passion to sql in VBA", "body": "<pre><code>'fetching the file full name from from the range\nFilename = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"FileEnv\"). Value\n'fetching the filename from the path fetched from above range\ndataFile = FileNameFromPath(Filename)\n'this function fetched the file name correctly as Product.csv\nSql = \"select * from [dataFile]\"\n</code></pre>\n\n<p>Now in the sql it's not fetching the data file as product.csv.It is takin dataFile only bcoznof which am getting an error of file not existing.</p>\n\n<p>Help please?</p>\n"}, {"tags": ["vba", "formulas", "dcount"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1476264932, "post_id": 39995002, "comment_id": 67268309, "body": "What does your code look like now?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476266842, "post_id": 39995002, "comment_id": 67269595, "body": "If you could just copy and paste the code that would be much easier, pics are a draaaaag"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476266968, "post_id": 39995002, "comment_id": 67269681, "body": "to find the last row you can use this: LastRow = .Range(&quot;E&quot; &amp; .Rows.Count).End(xlUp).Row"}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1476267339, "post_id": 39995002, "comment_id": 67269891, "body": "Private Sub DeriveTheFigures_Click() Worksheets(&quot;see the figures.&quot;).Activate Dim fulldataset As Range Worksheets(&quot;paste trial billing here.&quot;).Range(&quot;a1&quot;).Select Range(Selection, Selection.End(xlToRight)).Select Range(Selection, Selection.End(xlDown)).Select fulldataset = Selection.Address(rowabsolute:=False, columnabsolute:=False) Range(&quot;f9&quot;).FormulaR1C1 = &quot;=DCOUNT(&quot; End Sub  the code so far."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1476267665, "post_id": 39995002, "comment_id": 67270075, "body": "and what&#39;s the &quot;E&quot; for in the range address you are suggesting? remember i intend to adopt a r1c1 style formula or is there a more effective alternative?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476268250, "post_id": 39995002, "comment_id": 67270457, "body": "You say &#39;remember&#39;, but didn&#39;t put code in your question until after my comment..."}, {"owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "edited": false, "score": 0, "creation_date": 1476268501, "post_id": 39995002, "comment_id": 67270606, "body": "you&#39;re right i&#39;m sorry about that."}], "owner": {"reputation": 43, "user_id": 6610173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67400bbc2655ff0ac6d972de22dea37d?s=128&d=identicon&r=PG&f=1", "display_name": "ju&#39;blu&#39;", "link": "https://stackoverflow.com/users/6610173/jublu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476268479, "creation_date": 1476264130, "last_edit_date": 1476268479, "question_id": 39995002, "link": "https://stackoverflow.com/questions/39995002/trying-to-run-a-dcount-formula-in-a-cell-in-vba", "title": "Trying to run a &quot;DCOUNT&quot; formula in a cell in vba", "body": "<p>I am trying to run a \"DCOUNT\" formula in a cell in VBA but then my database range (in the formula) refers to a dynamic range on a different sheet. Now the challenge is:</p>\n\n<p>how do I frame my VBA code to refer to the database (which would be dynamic but always starting from cell A1 with the same number of  columns  but the number of rows would change depending on the data copied in) in a sheet different from the sheet where the result of the formula is to appear?</p>\n\n<pre><code>Private Sub DeriveTheFigures_Click()\n    Worksheets(\"see the figures.\").Activate\n    Dim fulldataset As Range\n    Worksheets(\"paste trial billing here.\").Range(\"a1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select                                                                                                   fulldataset= Selection.Address(rowabsolute:=False, columnabsolute:=False)\n     Range(\"f9\").FormulaR1C1 = \"=DCOUNT(\"\n End Sub**\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vd9ow.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/vd9ow.jpg\" alt=\"Useless picture of code\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 1, "creation_date": 1476263427, "post_id": 39994710, "comment_id": 67267275, "body": "wrong langage I think :-)  (who the hell upvoted that?? )"}, {"owner": {"reputation": 501, "user_id": 6952884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05b20875787a546d7a0f80ded19ef2c?s=128&d=identicon&r=PG&f=1", "display_name": "TripleEEE", "link": "https://stackoverflow.com/users/6952884/tripleeee"}, "edited": false, "score": 0, "creation_date": 1476263804, "post_id": 39994710, "comment_id": 67267538, "body": "I just see - you were looking for a VBA Solution - but I guess you&#39;ll be able to translate the code above."}], "tags": [], "owner": {"reputation": 501, "user_id": 6952884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05b20875787a546d7a0f80ded19ef2c?s=128&d=identicon&r=PG&f=1", "display_name": "TripleEEE", "link": "https://stackoverflow.com/users/6952884/tripleeee"}, "is_accepted": false, "score": -1, "last_activity_date": 1476263868, "last_edit_date": 1476263868, "creation_date": 1476263300, "answer_id": 39994710, "question_id": 39994621, "link": "https://stackoverflow.com/questions/39994621/loop-through-folder-containing-subfolders-to-find-excel-files/39994710#39994710", "title": "Loop through folder containing subfolders to find excel files", "body": "<pre><code>void DirSearch(string sDir) \n{\n    try \n    {\n       foreach (string d in Directory.GetDirectories(sDir)) \n       {\n        foreach (string f in Directory.GetFiles(d, txtFile.Text)) \n        {\n           if(f.EndsWith(\"MySearchPattern.xlsx\"))\n           lstFilesFound.Items.Add(f);\n        }\n        DirSearch(d);\n       }\n    }\n    catch (System.Exception excpt) \n    {\n        Console.WriteLine(excpt.Message);\n    }\n}\n</code></pre>\n\n<p>See: de: <a href=\"https://support.microsoft.com/de-de/kb/303974\" rel=\"nofollow\">https://support.microsoft.com/de-de/kb/303974</a></p>\n\n<p>en: <a href=\"https://support.microsoft.com/en-us/kb/303974\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/303974</a></p>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1476264291, "post_id": 39994762, "comment_id": 67267871, "body": "Yup, I saw that thread while looking for an answer. I&#39;m not quite sure what should I add to &quot;operate on each file&quot; ( only excel file) ?"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1476265657, "post_id": 39994762, "comment_id": 67268778, "body": "and what about the second case?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1476265766, "post_id": 39994762, "comment_id": 67268845, "body": "File is the variable you need here, so workbook.open file"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1476265819, "post_id": 39994762, "comment_id": 67268879, "body": "n the first case, variable myName will contain something like &#39;CostSheet2016.xlsx&#39;, so you can use workbook.open myName to open it and go from there i guess if that&#39;s what you need?"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1476265923, "post_id": 39994762, "comment_id": 67268954, "body": "OK, Thanks so much. Could you please take a look on the code I&#39;ve just posted in my original question, why i&#39;ts not working?"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 1, "last_activity_date": 1476263794, "last_edit_date": 1495541957, "creation_date": 1476263422, "answer_id": 39994762, "question_id": 39994621, "link": "https://stackoverflow.com/questions/39994621/loop-through-folder-containing-subfolders-to-find-excel-files/39994762#39994762", "title": "Loop through folder containing subfolders to find excel files", "body": "<p>So for just the files in the directory specified:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx</a></p>\n\n<pre><code>Dim MyFile, MyPath, MyName As String \n' Returns \"WIN.INI\" if it exists.\nMyFile = Dir(\"C:\\WINDOWS\\WIN.INI\")   \n\n' Returns filename with specified extension. If more than one *.INI \n' file exists, the first file found is returned.\nMyFile = Dir(\"C:\\WINDOWS\\*.INI\")\n\n' Call Dir again without arguments to return the next *.INI file in the \n' same directory.\nMyFile = Dir()\n\n' Return first *.TXT file, including files with a set hidden attribute.\nMyFile = Dir(\"*.TXT\", vbHidden)\n\n' Display the names in C:\\ that represent directories.\nMyPath = \"c:\\\"   ' Set the path.\nMyName = Dir(MyPath, vbDirectory)   ' Retrieve the first entry.\nDo While MyName &lt;&gt; \"\"   ' Start the loop.\n      ' Use bitwise comparison to make sure MyName is a directory. \n      If (GetAttr(MyPath &amp; MyName) And vbDirectory) = vbDirectory Then \n         ' Display entry only if it's a directory.\n         MsgBox(MyName)\n      End If   \n   MyName = Dir()   ' Get next entry.\nLoop\n</code></pre>\n\n<p>Or for all sub folders too, take a look here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\">Loop Through All Subfolders Using VBA</a></p>\n\n<pre><code>Dim FileSystem As Object\nDim HostFolder As String\n\nHostFolder = \"C:\\\"\n\nSet FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(HostFolder)\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    For Each File In Folder.Files\n        ' Operate on each file\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1476263531, "creation_date": 1476263531, "answer_id": 39994786, "question_id": 39994621, "link": "https://stackoverflow.com/questions/39994621/loop-through-folder-containing-subfolders-to-find-excel-files/39994786#39994786", "title": "Loop through folder containing subfolders to find excel files", "body": "<p>the best way I know is to use a batch:</p>\n\n<pre><code>dir /b \"D:\\mondossier\\\" &gt;\"C:\\tempfolder\\TEMP.txt\"\n</code></pre>\n\n<p>then read it as text : </p>\n\n<pre><code>CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(\"C:\\tempfolder\\TEMP.txt\")\n</code></pre>\n\n<p>way faster than juste FSO, unless mistaken</p>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4404, "favorite_count": 0, "accepted_answer_id": 39994762, "answer_count": 3, "score": -1, "last_activity_date": 1476265802, "creation_date": 1476263042, "last_edit_date": 1531164843, "question_id": 39994621, "link": "https://stackoverflow.com/questions/39994621/loop-through-folder-containing-subfolders-to-find-excel-files", "title": "Loop through folder containing subfolders to find excel files", "body": "<p>I would like to loop through folder that contains multiple subfolders to find excel files that contain specified name, and do stuff with those found excel files. \nAny suggestions how can I achieve that?</p>\n\n<p>I have found something like this but it's not working:</p>\n\n<pre><code>Application.ScreenUpdating = False\n Application.DisplayAlerts = False\n\n With Application.FileSearch\n .NewSearch\n .LookIn = \"C:\\temp 1\" ' your drive / directory here\n .SearchSubFolders = True\n .FileName = \".xls\" ' all files ending in xls\n .FileType = msoFileTypeExcelWorkbooks\n If .Execute() &gt; 0 Then\n ' how many files are there in the selected folder?\n MsgBox \"There were \" &amp; .FoundFiles.Count &amp; \" file(s) found.\"\n\n For i = 1 To .FoundFiles.Count\n Workbooks.Open .FoundFiles(i), 0\n '\n ' code \n '\n\n '\n ActiveWorkbook.Save\n ActiveWorkbook.Close\n Next i\n Else\n MsgBox \"There were no files found.\"\n End If\n End With\n\n\n Application.ScreenUpdating = True\n Application.DisplayAlerts = True\n\n MsgBox \"All Done!\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "excel-2010"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1476264119, "post_id": 39994577, "comment_id": 67267757, "body": "On which line do you get the error? is on <code>.Item.Display</code>?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476264636, "post_id": 39994577, "comment_id": 67268115, "body": "Never heard of <code>ActiveSheet.MailEnvelope.Introduction</code> or ActiveSheet.MailEnvelope.Item`: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839554(v=office.15).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> Where did you get this code from?"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476265273, "post_id": 39994577, "comment_id": 67268524, "body": "It errors on initially on &quot;cr.Offset(, -1).Resize(30, 2).Select&quot;"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476266157, "post_id": 39994577, "comment_id": 67269131, "body": "Funnily Enough Picked it up from Mr Excel Forum after googling but this code has given me nothing but trouble and i swear it should be easier that this."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476266621, "post_id": 39994577, "comment_id": 67269449, "body": "@Ralph: I actually have that &quot;Introduction&quot; in my Excel 2013!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476266673, "post_id": 39994577, "comment_id": 67269487, "body": "@blood_milk_sky, you may want to share the solution"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476266857, "post_id": 39994577, "comment_id": 67269601, "body": "This was the solution but it doesnt work on my workbook. even though from what I can see the parameters are correct for the code to work."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476267940, "post_id": 39994577, "comment_id": 67270283, "body": "Put <code>cr.Parent.Activate</code> before the line <code>cr.Offset(, -1).Resize(30, 2).Select</code>. You can only select an area on a sheet if the sheet is currently active / selected."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476269213, "post_id": 39996392, "comment_id": 67271042, "body": "I tried your code just because I have never heard of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836185.aspx\" rel=\"nofollow noreferrer\">MailEnvelope</a> before. And you are right: the code works smoothly without any errors. Yet, I didn&#39;t get to see the email and if I uncomment <code>.Send</code> then I don&#39;t get an email in my Outlook outbox. But with the code provided by the OP with my suggestion (comment above) I do get the required result. Not sure why that is. All I can say is that&#39;s what I experience here on my end. Just wanted to share."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476270419, "post_id": 39996392, "comment_id": 67271799, "body": "@Ralph : I checked Outlook sent items and I have the sent mails (for valid emails only)... But the 1st version of the code send the whole sheet... :/ I saw each &quot;mail&quot; (Excel interface to prepare mail) with a breakpoint on <code>.display</code> (both <code>.display</code> and <code>.send</code> use Outlook) but can&#39;t seem to keep all of them viewable like with direct use of Outlook..."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476271243, "post_id": 39996392, "comment_id": 67272324, "body": "Just felt like sharing that it doesn&#39;t seem to work on my system. I will look more into that if I ever have the need. Right now, all that matters is that it seems to work for you and (hopefully) also for the OP. BTW, with the OP code only the <code>selection</code> got sent on my computer and it did not matter if the email address was valid (took Outlook offline for testing and found the emails in the outbox). Setup here: Excel 2016 64-bit on Windows7."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476272405, "post_id": 39996392, "comment_id": 67273094, "body": "@Ralph : Same setup, Outlook seems to send mails but I only see the ones with valid addresses in Sent Items. I edited my answer to actually select the desired ranged. I&#39;m clueless on why you need to use <code>Selection</code> rather a custom range. We&#39;ll see if this work for the OP! Thx for your inputs!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476272536, "post_id": 39996392, "comment_id": 67273171, "body": "Then you should include in your code my comment above. A range can be only selected if the sheet is activated first. Otherwise, you&#39;ll get an error."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476273125, "post_id": 39996392, "comment_id": 67273541, "body": "Sorry to be such a hazzle but <code>ActiveWorkbook.ActiveSheet.Select</code> may fail on some systems (obviously not on ours): <a href=\"http://stackoverflow.com/questions/24344607/excel-vba-select-method-of-range-class-failed\" title=\"excel vba select method of range class failed\">stackoverflow.com/questions/24344607/&hellip;</a> Sheets should be activated and not selected."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476273262, "post_id": 39996392, "comment_id": 67273605, "body": "@Ralph : No problem, I didn&#39;t know that it could fail (I never use it^^). I edited it ;)"}, {"owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "edited": false, "score": 0, "creation_date": 1476273524, "post_id": 39996392, "comment_id": 67273771, "body": "Works fine for me if I change:  <code>RangeToSend.Select</code> <code>With Selection.Parent.MailEnvelope</code>  To  <code>With RangeToSend.Parent.MailEnvelope</code>"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476276575, "post_id": 39996392, "comment_id": 67275744, "body": "Hi that works really well but it is sending the whole of sheet 2 and not the individual ranges on this sheet to the different email addresses"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476276721, "post_id": 39996392, "comment_id": 67275852, "body": "@blood_milk_sky : Did you try the change that Jon Carlsted did? What is your setup?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "edited": false, "score": 0, "creation_date": 1476276804, "post_id": 39996392, "comment_id": 67275905, "body": "@JonCarlstedt : This method seems to be highly variable... I HAD TO change it the other way to have only the range included... And OP seems to have the same issue than you. What is your setup?"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476277157, "post_id": 39996392, "comment_id": 67276151, "body": "my appologies I havent yet literally just seen your code posted."}, {"owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "edited": false, "score": 0, "creation_date": 1476279152, "post_id": 39996392, "comment_id": 67277625, "body": "@R3uK : I am on Excel 2013 (15.0.4867.1000) Professional Plus 32-bit, English version on Win 7 Enterprise. Note: It might be a Scandinavian version installed with English language pack."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476286793, "post_id": 39996392, "comment_id": 67283300, "body": "so should this be what it looks like ?"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476286832, "post_id": 39996392, "comment_id": 67283332, "body": "With RangeToSend.Parent.MailEnvelope             .Introduction = &quot;Good Morning&quot;             With .Item"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476287401, "post_id": 39996392, "comment_id": 67283758, "body": "@blood_milk_sky : Try the edit and tell me if it works as expected"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476287895, "post_id": 39996392, "comment_id": 67284100, "body": "Hi, it just goes on to a compile error: Invalid Or Unqualified reference."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476288000, "post_id": 39996392, "comment_id": 67284183, "body": "I am on Excel 2010 (14.0.7166.5000) Professional Plus 32 bit"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476288427, "post_id": 39996392, "comment_id": 67284465, "body": "@blood_milk_sky : Try the redited version, if it doesn&#39;t work, I think it&#39;ll be easier to use Outlook directly..."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476288857, "post_id": 39996392, "comment_id": 67284736, "body": "it sends one email then errors on &quot;With Selection.Parent.MailEnvelope&quot; sorrry for the hassel an i really appreciate all of your help"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476289060, "post_id": 39996392, "comment_id": 67284866, "body": "and then if you Uncomment With RangeToSend.Parent.MailEnvelope it errors on compile error : Loop Without do"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476289338, "post_id": 39996392, "comment_id": 67285044, "body": "@blood_milk_sky : Ok... :/ I&#39;m not sure how to go with this... I don&#39;t have the same issue here so hard to help more... If you are open to use Outlook from the start I&#39;ll propose an answer tomorrow for this ;)"}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476356464, "post_id": 39996392, "comment_id": 67315077, "body": "@R3uK I am just looking to ensure that these named ranges get sent to the correct email address&#39;s so anyway that we could do it would be great."}, {"owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "edited": false, "score": 0, "creation_date": 1476451844, "post_id": 39996392, "comment_id": 67364722, "body": "Is there another way of doing it without the code I provided initially."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1476288381, "last_edit_date": 1476288381, "creation_date": 1476268271, "answer_id": 39996392, "question_id": 39994577, "link": "https://stackoverflow.com/questions/39994577/emailing-ranges-instead-of-rows/39996392#39996392", "title": "Emailing Ranges Instead Of Rows", "body": "<p>You need to be more explicit about your references (workbook, sheet, ...).</p>\n\n<p>Thx to @Ralph :</p>\n\n<blockquote>\n  <p>A range can be only selected if the sheet is activated first. Otherwise, you'll get an error.</p>\n</blockquote>\n\n<p>This run smoothly on my computer :</p>\n\n<pre><code>Sub Email_Ranges()\n    Dim rG As Range\n    Dim RangeToSend As Range\n    Dim CustomerMail As String\n\n    Set rG = ActiveWorkbook.ActiveSheet.[b1]\n\n    ActiveWorkbook.EnvelopeVisible = True\n\n    Do While rG.Value &lt;&gt; vbNullString\n        CustomerMail = rG.Value\n        Set RangeToSend = rG.Offset(, -1).Resize(30, 2)\n\n        'With RangeToSend.Parent.MailEnvelope\n\n        ''Uncomment below if you get an error\n        rG.Parent.Activate\n        RangeToSend.Select\n        With Selection.Parent.MailEnvelope\n\n            .Introduction = \"Good Morning\"\n            With .Item\n                .To = CustomerMail\n                .Subject = \"Just testing, sorry for filling your inbox ^_^ \"\n                .display    'to test\n                .Send      'to send\n            End With\n        End With\n        Debug.Print CustomerMail &amp; \" receives \" &amp; RangeToSend.Address\n        Set rG = rG.Offset(, 2)\n    Loop\n\n    ActiveWorkbook.EnvelopeVisible = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6752983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wMDRd.jpg?s=128&g=1", "display_name": "blood_milk_sky", "link": "https://stackoverflow.com/users/6752983/blood-milk-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1488362542, "creation_date": 1476262938, "last_edit_date": 1488362542, "question_id": 39994577, "link": "https://stackoverflow.com/questions/39994577/emailing-ranges-instead-of-rows", "title": "Emailing Ranges Instead Of Rows", "body": "<p>I am attempting to run through sheet 2 of an Excel workbook to email  ranges to customers.</p>\n\n<p>The ranges would be A1:B30,C1:D30,E1:F30 and so on with their account number in A1 &amp; email in B1 and information below. </p>\n\n<p>Every time I try to run the email it comes up with:</p>\n\n<blockquote>\n  <p>Run Time Error 1004 </p>\n</blockquote>\n\n<p>and then goes on to error </p>\n\n<blockquote>\n  <p>Object has been moved or deleted</p>\n</blockquote>\n\n<p>Is there another way of emailing ranges or a way to amend this code? </p>\n\n<pre><code>Sub EmailRanges()\nDim cr As Range\nSet cr = [b1]\nActiveWorkbook.EnvelopeVisible = True\nDo While cr &lt;&gt; \"\"\n    cr.Offset(, -1).Resize(30, 2).Select\n    With ActiveSheet.MailEnvelope\n        .Introduction = \" Good Morning\"\n        .Item.To = cr\n        .Item.Subject = \"Just testing, sorry for filling you inbox ^_^ \"\n        .item.Send                                 ' to send\n        .Item.Display                               ' to test\n    End With\n    MsgBox cr &amp; \" receives \" &amp; Selection.Address\n    Set cr = cr.Offset(, 2)\nLoop\nApplication.ScreenUpdating = True\nMsgBox \"The Customers Have Been Notified\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1476260928, "post_id": 39993828, "comment_id": 67265744, "body": "I think you want to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194470.aspx\" rel=\"nofollow noreferrer\"><code>SelectionChange</code></a> event."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4793429, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b486c65903066c9c7af9bc6db127f0d1?s=128&d=identicon&r=PG&f=1", "display_name": "lala_12", "link": "https://stackoverflow.com/users/4793429/lala-12"}, "edited": false, "score": 0, "creation_date": 1476261241, "post_id": 39993944, "comment_id": 67265939, "body": "I have already tried that. I have solved it by using the <code>SelectionChange</code> event, as  @Phylogenesis said."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476262553, "post_id": 39993944, "comment_id": 67266728, "body": "your code is cleaner, but equivalent. Better even without the &quot;not&quot; ;-)"}], "tags": [], "owner": {"reputation": 319, "user_id": 6899499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1203d5fd706ef6ab5e815f1514cda9b?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian F", "link": "https://stackoverflow.com/users/6899499/fabian-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1476260982, "creation_date": 1476260982, "answer_id": 39993944, "question_id": 39993828, "link": "https://stackoverflow.com/questions/39993828/disable-application-onkey-behaviour-excel-2013/39993944#39993944", "title": "Disable Application.OnKey behaviour Excel 2013", "body": "<p>You need to get your IF-Logic right:</p>\n\n<pre><code>If Not Source.Row = 6 Then \n  UnsetOnKey\nElse\n  SetOnKey\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 0, "last_activity_date": 1476265658, "last_edit_date": 1476265658, "creation_date": 1476262522, "answer_id": 39994430, "question_id": 39993828, "link": "https://stackoverflow.com/questions/39993828/disable-application-onkey-behaviour-excel-2013/39994430#39994430", "title": "Disable Application.OnKey behaviour Excel 2013", "body": "<p>it is a worksheet change you used, not selectionchange... I checked, the UnsetOnKey works fine for me.\nHowever the simplest is to check directly in the code which cell is selected and exit if wrong one</p>\n"}], "owner": {"reputation": 121, "user_id": 4793429, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b486c65903066c9c7af9bc6db127f0d1?s=128&d=identicon&r=PG&f=1", "display_name": "lala_12", "link": "https://stackoverflow.com/users/4793429/lala-12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476265658, "creation_date": 1476260610, "last_edit_date": 1531161705, "question_id": 39993828, "link": "https://stackoverflow.com/questions/39993828/disable-application-onkey-behaviour-excel-2013", "title": "Disable Application.OnKey behaviour Excel 2013", "body": "<p>I am using Application.OnKey in Excel 2013 to change the behavior of a specific row, when the keys <code>c</code>, <code>x</code>, and <code>z</code> are pressed.</p>\n\n<p>My code is below:</p>\n\n<p>In a module:</p>\n\n<pre><code>Public Sub SetOnKey()\n    Application.OnKey \"x\", \"Macro1\"\n    Application.OnKey \"c\", \"Macro2\"\n    Application.OnKey \"z\", \"Macro3\"\nEnd Sub\n\nPublic Sub UnsetOnKey()\n    Application.OnKey \"x\"\n    Application.OnKey \"c\"\n    Application.OnKey \"z\"\nEnd Sub\n\nPublic Sub MoveCellSelectorToRight()\n    ' Move cell selector to the right\n    Cells(ActiveCell.Row, ActiveCell.Column + 1).Select\nEnd Sub\n\nPublic Sub Macro1()\n    ActiveCell.Value = \"r\"\n    MoveCellSelectorToRight\nEnd Sub\n\nPublic Sub Macro2()\n    ActiveCell.Value = \"t\"\n    MoveCellSelectorToRight\nEnd Sub\n\nPublic Sub Macro3()\n    ActiveCell.Value = \"o\"\n    MoveCellSelectorToRight\nEnd Sub\n</code></pre>\n\n<p>In my workbook:</p>\n\n<pre><code>Public Sub Workbook_SheetChange(ByVal Sh As Object, _\n ByVal Source As Range)\n\n    SetOnKey\n    If Not Source.Row = 6 Then UnsetOnKey\nEnd Sub\n</code></pre>\n\n<p>If I am not in row 6, the <code>SetOnKey</code> still executes. How can I prevent this from happening?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476259746, "post_id": 39993392, "comment_id": 67265051, "body": "Here is one way to do it: remove the current selection / value from the ComboBox by issuing a <code>ComboBox1.Value = vbNullString</code> in the first line of <code>Sub TestAddItem()</code> (just before the rest of your code)."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476259889, "post_id": 39993392, "comment_id": 67265140, "body": "Just tried that and it still jumps to the Change event"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476260048, "post_id": 39993392, "comment_id": 67265232, "body": "B2 must be empty too (as the linked cell). <a href=\"https://www.dropbox.com/s/x2v6ci3lxrf13fb/StackOverflow_Question39993392.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/x2v6ci3lxrf13fb/&hellip;</a>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476260333, "post_id": 39993392, "comment_id": 67265375, "body": "Ok. With B2 empty this works. Unfortunately, I have other calculations that depend on that... ofcourse I can work around that, but I&#39;m trying to avoid the headache. You have given me at least one more workable solution thank you! PS: I can&#39;t access dropbox from my current IT setting, will do so at home though."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476261075, "post_id": 39993834, "comment_id": 67265840, "body": "This is an elegant solution! Thank you! I will run it through some tests tonight, but in my test workbook this runs nicely!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476790828, "post_id": 39993834, "comment_id": 67485743, "body": "@rohrl77, did you get through it?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476867675, "post_id": 39993834, "comment_id": 67523377, "body": "Sorry for the late reply. In the end it didn&#39;t work for my situation. The reason why, is that the Change Event on the worksheet is triggered AFTER the Change event for the combo box. So it ended up getting triggered anyway."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1477989963, "post_id": 39993834, "comment_id": 67966603, "body": "I just gave it a try. This solution works! Thanks for providing an answer."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 6, "last_activity_date": 1476946624, "last_edit_date": 1476946624, "creation_date": 1476260626, "answer_id": 39993834, "question_id": 39993392, "link": "https://stackoverflow.com/questions/39993392/how-to-prevent-combobox-change-event-from-being-called-when-source-list-is-chang/39993834#39993834", "title": "How to prevent ComboBox Change event from being called when source list is changed", "body": "<p>edited after OP's comment</p>\n\n<p>since involved events <em>timing</em>, it then suffices the following code in your worksheet code pane:</p>\n\n<pre><code>Option Explicit\n\nDim bMakeItHappen As Boolean\n\nPrivate Sub ComboBox1_DropButtonClick()\n    bMakeItHappen = True\nEnd Sub\n\n\nPrivate Sub ComboBox1_Change()   \n    If bMakeItHappen Then\n        MsgBox (\"hello\") '&lt;-- i.e. the code to be executed at \"actual\" combobox value change\n        bMakeItHappen = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6286, "favorite_count": 1, "accepted_answer_id": 39993834, "answer_count": 1, "score": 3, "last_activity_date": 1476946624, "creation_date": 1476259048, "last_edit_date": 1495541208, "question_id": 39993392, "link": "https://stackoverflow.com/questions/39993392/how-to-prevent-combobox-change-event-from-being-called-when-source-list-is-chang", "title": "How to prevent ComboBox Change event from being called when source list is changed", "body": "<p><strong>TL;DR: How to prevent ActiveX ComboBox from being triggerd when adding or deleting items in the source list</strong></p>\n\n<p>Please note that I have seen <a href=\"https://stackoverflow.com/questions/19276861/how-to-prevent-activex-events-firing-in-vba\">this post</a> and it is not the same problem or rather it does not provide a workable solution for my current project.</p>\n\n<p>You can replicate the problem by creating an ActiveX ComboBox and giving it a source list range on the sheet from A1:A4, Output cell B2, then adding this code:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    MsgBox (\"hello\")\nEnd Sub\n\nSub TestAddItem()\n    Range(\"A4\").Insert xlDown\n    Range(\"A4\").Value = \"NewItem\"\nEnd Sub\n</code></pre>\n\n<p>If you run <code>TestAddItem</code>, upon getting to the \"New Item\" line, the <code>Change</code> event for the combo box will be triggered.</p>\n\n<p>I have searched for solutions to this, but could only find the workaround suggestion to add a Boolean Variable that checks whether or not to actually proceed with the code in the change event. Here is what that would look like in my example:</p>\n\n<pre><code>Option Explicit\nPublic bMakeItHappen As Boolean\n\nPrivate Sub ComboBox1_Change()\n    If bMakeItHappen Then\n        MsgBox (\"hello\")\n    End If\nEnd Sub\n\nSub TestAddItem()\n    bMakeItHappen = False\n    Range(\"A4\").Insert xlDown\n    Range(\"A4\").Value = \"NewItem\"\nEnd Sub\n</code></pre>\n\n<p>The same thing happens if the destination of the combo box is changed. Adding or deleting items from the source range manually does not trigger the event.</p>\n\n<p>Note: <code>Application.EnableEvents = False</code> has no impact on ActiveX elements! They will fire anyway (by design from Microsoft)</p>\n\n<p><strong>How do I prevent this from happening?</strong> As it stands, this ActiveX element is unusable, or at least I can't use it if I need to set Boolean variables everywhere in my code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1476259176, "post_id": 39993306, "comment_id": 67264700, "body": "range(&quot;blah&quot;).entirerow for the whole row to start"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476260081, "post_id": 39993306, "comment_id": 67265252, "body": "(a) Note that <code>Set selectedRange = Range(&quot;A1:AC&quot; &amp; LastRow)</code> is selecting a range on the active sheet, not on the sheet your other statements are accessing.  You probably want to say <code>Set selectedRange = sheet.Range(&quot;A1:AC&quot; &amp; LastRow)</code> - but you don&#39;t appear to be using selectedRange elsewhere so it probably doesn&#39;t matter. (b) Similarly, all the references to <code>Cells</code> in your &quot;first condition&quot; block are accessing the active sheet - you probably need <code>sheet.Cells</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476261939, "post_id": 39993306, "comment_id": 67266367, "body": "you may want to add a &quot;before&quot; and &quot;after&quot; scenarios images"}], "answers": [{"comments": [{"owner": {"reputation": 35803, "user_id": 3858469, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Lf9q4.png?s=128&g=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/3858469/aravind"}, "edited": false, "score": 0, "creation_date": 1476259842, "post_id": 39993543, "comment_id": 67265115, "body": "I made first condition but in the first one I want to add the second one also instead of adding another set of for loop."}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 1, "last_activity_date": 1476260690, "last_edit_date": 1495540112, "creation_date": 1476259512, "answer_id": 39993543, "question_id": 39993306, "link": "https://stackoverflow.com/questions/39993306/excel-macro-vba-basic-comparison-but-unable-to-fix-error/39993543#39993543", "title": "Excel Macro VBA basic comparison - but unable to fix error", "body": "<p>For your first condition:</p>\n\n<pre><code>For i = 1 To LastRow\n    For j = 6 To LastColumn\n        Select Case Cells(i, j).Value\n            Case 0\n                Cells(i, j).EntireRow.Interior.Color = vbGreen\n            Case 1\n                Cells(i, j).EntireRow.Interior.Color = vbRed\n\n            Case Else\n                Cells(i, j) = \"Whetever\"\n        End Select\n        if range(\"A\" &amp; i).value = 1 and range(\"AC\" &amp; i).value = 1 then\n            Cells(i, j).EntireRow.Interior.Color = vbYellow\n        end if\n   Next j\nNext i\n</code></pre>\n\n<p>Point 2 now added.  For deleting duplicates, that depends on your data, but the question has been asked here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9644453/how-to-look-for-repeated-rows-and-then-delete-one-of-them-requires-vba\">How to look for repeated rows and then delete one of them? requires VBA</a></p>\n"}], "owner": {"reputation": 35803, "user_id": 3858469, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Lf9q4.png?s=128&g=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/3858469/aravind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39993543, "answer_count": 1, "score": 0, "last_activity_date": 1476260690, "creation_date": 1476258760, "last_edit_date": 1476258783, "question_id": 39993306, "link": "https://stackoverflow.com/questions/39993306/excel-macro-vba-basic-comparison-but-unable-to-fix-error", "title": "Excel Macro VBA basic comparison - but unable to fix error", "body": "<p>I have a set of rows and columns range is <strong>A:AC</strong> and Rows count may be anything </p>\n\n<p><strong>Fixing the sheet and range and calculating RowCount and ColumnCount using this</strong> </p>\n\n<pre><code>Dim sheet As Worksheet\nDim LastRow As Long\nDim LastColumn As Long\nSet sheet = ActiveWorkbook.Worksheets(1)\nLastRow = sheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nLastColumn = sheet.Range(\"A1\").CurrentRegion.Columns.Count\nSet selectedRange = Range(\"A1:AC\" &amp; LastRow)\n</code></pre>\n\n<ul>\n<li><strong>First Condition:</strong></li>\n</ul>\n\n<p>I am trying to compare column F to AC should have either 0 or 1. and found that by using </p>\n\n<pre><code>For i =1 To LastRow\n   For j = 6 To LastColumn\n      If Cells(i, j).Value &lt;&gt; 0 And Cells(i, j) &lt;&gt; 1 Then\n           Cells(i, j).Interior.Color = vbGreen\n      End If\n      If Cells(i, j).Value &gt; 1 Then\n           Cells(i, j).Interior.Color = vbRed\n      End If\n   Next j\nNext i\n</code></pre>\n\n<ul>\n<li><strong>Second Condition</strong></li>\n</ul>\n\n<p>Out of these columns I should have only <strong>one column</strong> should have <strong>1</strong> and remaining as <strong>0</strong></p>\n\n<p><strong>I tried this and it is throwing different error codes for each run</strong></p>\n\n<ul>\n<li><strong>Third Condition</strong></li>\n</ul>\n\n<p>Find <strong>duplicate rows</strong> from A:AC</p>\n\n<p>I need to highlight entire <strong>row</strong> which has the error </p>\n\n<p><strong><code>But I have done which Column has error</code></strong> with this statement \n<strong><code>Cells(i, j).Interior.Color = vbRed</code></strong></p>\n\n<h2>Though it is simple I am unable to figure out the logic as I am completely new to Excel VBA.</h2>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476257668, "post_id": 39992853, "comment_id": 67263822, "body": "why would you go through the trouble of taking and posting a screenshot of the code instead of pasting it..?"}, {"owner": {"reputation": 1, "user_id": 6887140, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154490384858340/picture?type=large", "display_name": "Jeroen Meddeler", "link": "https://stackoverflow.com/users/6887140/jeroen-meddeler"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476257976, "post_id": 39992853, "comment_id": 67263995, "body": "new to stackoverflow! Thanks for the advice"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476258066, "post_id": 39992853, "comment_id": 67264052, "body": "why did you revert my edit and make your code unreadable again? Use four spaces to indent code so it gets formatted correctly. (e.g. by selecting it and clicking the {} button in the editor)"}, {"owner": {"reputation": 1, "user_id": 6887140, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154490384858340/picture?type=large", "display_name": "Jeroen Meddeler", "link": "https://stackoverflow.com/users/6887140/jeroen-meddeler"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476258647, "post_id": 39992853, "comment_id": 67264357, "body": "Didn&#39;t realize you could change it"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476258731, "post_id": 39992853, "comment_id": 67264419, "body": "indent the whole block, do not add `s around every line so you get syntax highlightning. I changed it now"}], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476259759, "post_id": 39993385, "comment_id": 67265057, "body": "From <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx#Anchor_2\" rel=\"nofollow noreferrer\">this</a> example I would have thought that it took some path as default. Am I missing something?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476260546, "post_id": 39993385, "comment_id": 67265494, "body": "If you used <code>ChDir &quot;F:\\WGD\\...&quot;</code> Excel would be able to open the file just using it&#39;s name but you will still have to supply the path to the Dir function.  It is best just to use this pattern: <a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Dir Function</a>"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476261400, "post_id": 39993385, "comment_id": 67266031, "body": "Ahh changing the directory makes sense. (not that I want to use it that way, was just curious about the example)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1476259036, "creation_date": 1476259036, "answer_id": 39993385, "question_id": 39992853, "link": "https://stackoverflow.com/questions/39992853/vba-open-multiple-files-in-selection-to-copy-into-mastersheet/39993385#39993385", "title": "VBA Open multiple files in selection to copy into mastersheet", "body": "<p>The reason that Excel cannot find the file is that MyFile is just the filename; you need to also include that file path.</p>\n\n<p>This line: <code>ActiveSheet.Paste Destination...</code> will throw an error.  </p>\n\n<p>Try to avoid select and activate.  </p>\n\n<p>There is no need to size a range when using copy and paste.  You just need to target the top left cell of the destination range.</p>\n\n<pre><code>Sub LoopThroughDirectory()\n\n    Const FOLDERPATH = \"F:\\WGD\\Dep 408101-Se-DCIFINK-009786\\Consolidatie &amp; Regulatory Reporting\\Regulatory Reporting\\Daily dashboard of Ratios\\Test Daily Dashboard\\\"\n    Dim Myfile As String\n    Dim Source As Range, Target As Range\n\n    Myfile = Dir(FOLDERPATH)\n    Application.DisplayAlerts = False\n\n    Do While Len(Myfile) &gt; 0\n        If Myfile &lt;&gt; \"Masterfile.xlsm\" Then\n            With Worksheets(\"Sheet1\")\n                Set Target = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1)\n            End With\n\n            With Workbooks.Open(FOLDERPATH &amp; Myfile)\n\n                Set Source = .Worksheets(\"Liquidity Reporting\").Range(\"A2:E19\")\n                Source.Copy Destination:=Target\n                .Close SaveChanges:=False\n\n            End With\n\n        End If\n        Myfile = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6887140, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154490384858340/picture?type=large", "display_name": "Jeroen Meddeler", "link": "https://stackoverflow.com/users/6887140/jeroen-meddeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476259156, "creation_date": 1476257347, "last_edit_date": 1476258688, "question_id": 39992853, "link": "https://stackoverflow.com/questions/39992853/vba-open-multiple-files-in-selection-to-copy-into-mastersheet", "title": "VBA Open multiple files in selection to copy into mastersheet", "body": "<p>I created a macro in VBA (excel) to open a specific range of a daily file which all have a similar start of the name (9489) followed by a file specific date (DD-MM-YY). The selection is then copied into the masterfile (Masterfile.xlsm), this sub is run for all the files from the directory.</p>\n\n<p>Since today however I keep getting an error named \"Run-time error 1004: 9489 150116 Daily Dashboard.xlsx could not be found. Check the spelling of the file name, and verify that the file location is correct.\"</p>\n\n<p>Why do I get this error? Most importantly, can anybody help me solve this error? I did not change the spelling of the file or the files location!</p>\n\n<p><strong>The code:</strong></p>\n\n<pre><code>Sub LoopThroughDirectory() \nDim Myfile As String \nDim erow \nMyfile = Dir(\"F:\\WGD\\Dep 408101-Se-DCIFINK-009786\\Consolidatie &amp; Regulatory Reporting\\Regulatory Reporting\\Daily dashboard of Ratios\\Test Daily Dashboard\\\")\nApplication.DisplayAlerts = False\n\nDo While Len(Myfile) &gt; 0 \nIf Myfile = \"Masterfile.xlsm\" Then\n\nExit Sub\n\nEnd If\n\nWorkbooks.Open (Myfile) \nWorksheets(\"Liquidity Reporting\").Range(\"A2:E19\").Copy\n\nWindows(\"Masterfile.xlsm\").Activate \nerow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row \nActiveSheet.Paste Destination:=Worksheets(\"Sheet1\").Range(Cells(erow, 1), Cells(erow, 5))\n\nWorkbooks(Myfile).Application.CutCopyMode = False \nWorkbooks(Myfile).Close SaveChanges:=False\n\nMyfile = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "string", "vba", "compare"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476257039, "post_id": 39992708, "comment_id": 67263486, "body": "Use the instr() function. * is not a joker character."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1476257222, "post_id": 39992708, "comment_id": 67263579, "body": "Does the <code>.Cells(j,I)</code> <i>contain</i> or is equal to <code>*PENDING*</code>? I could not repro, please provide actual data."}, {"owner": {"reputation": 25, "user_id": 5901564, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153265651217117/picture?type=large", "display_name": "RoboNerd", "link": "https://stackoverflow.com/users/5901564/robonerd"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476258033, "post_id": 39992708, "comment_id": 67264028, "body": "@vacip instr worked like a charm, you&#39;re a lifesaver"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1476258717, "post_id": 39992708, "comment_id": 67264406, "body": "I totally can&#39;t understand these idiotic random downvotes with no comment..."}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 0, "last_activity_date": 1476257664, "last_edit_date": 1476257664, "creation_date": 1476257253, "answer_id": 39992816, "question_id": 39992708, "link": "https://stackoverflow.com/questions/39992708/excel-string-comparison-issue/39992816#39992816", "title": "excel string comparison issue", "body": "<p>You can't use joker characters in string comparisons in VBA like that.</p>\n\n<p>Instead, use the Instr() function to search for a string within another string.</p>\n\n<pre><code>If instr(1,Worksheets(\"Rework List\").Cells(j, I),\"pending\",vbTextCompare)&gt;0 Then\n</code></pre>\n\n<p>If the search string can be found within the second string, instr returns the first character's position. If it can't be found, it returns a 0. So if instr()>0 that means the string is there.</p>\n\n<p>vbTextCompare makes sure casing (upper/lower case) is ignored. The 1 at the beginning specifies the starting position for the search.</p>\n\n<p>Note that this is not the fastest thing in the world...</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5901564, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153265651217117/picture?type=large", "display_name": "RoboNerd", "link": "https://stackoverflow.com/users/5901564/robonerd"}, "edited": false, "score": 0, "creation_date": 1476258770, "post_id": 39993105, "comment_id": 67264445, "body": "you are completely right.  I found that goof up right after I plugged in the fix from vacip.  I was hoping no one would notice that part :).  I also forgot to tell it which sheet to grab the values from."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1476258089, "creation_date": 1476258089, "answer_id": 39993105, "question_id": 39992708, "link": "https://stackoverflow.com/questions/39992708/excel-string-comparison-issue/39993105#39993105", "title": "excel string comparison issue", "body": "<p>other than what @vacip already told you, I'd point out the following</p>\n\n<p>you wrote:</p>\n\n<blockquote>\n  <p>it grabs the value within the same row but a couple columns over and\n  writes it to the sheet which has the user defined look up value</p>\n</blockquote>\n\n<p>then I think:</p>\n\n<pre><code>Cells(j, 3).Value = Worksheets(\"Dashboard\").Range(\"F\" &amp; k)\n</code></pre>\n\n<p>would do quite the opposite (provided the active sheet at macro start is \"Rework List\")!</p>\n\n<p>moreover its' better to:</p>\n\n<ul>\n<li><p>declare rows index variables as of <code>Long</code> type</p>\n\n<p>though not strictly necessary in your specific case (they range to a maximum of 50, which is handled by an <code>Integer</code> type), it's quite common you would eventually face some 33k+ rows, and that's where <code>Long</code> type variable must enter the scene</p></li>\n<li><p>store the keyword value instead of its range, and avoid all subsequent accesses to it with <code>keycells.Value</code></p></li>\n<li><p>always adopt fully qualified range references up to the worksheet object at least (if not the workbook one)</p></li>\n</ul>\n\n<p>so you could try this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub valchange()\n    Dim keyVal As String\n    Dim k As Long, i As Long, j As Long\n\n    keyVal = CStr(Worksheets(\"Dashboard\").Range(\"B1\").Value)\n    k = 5\n    With Worksheets(\"Rework List\")\n        For i = 1 To 50\n            If .Cells(3, i).Value = keyVal Then\n                For j = 14 To 50\n                    If InStr(.Cells(j, i), \"pending\", vbTextCompare) &gt; 0 Then\n                        Worksheets(\"Dashboard\").Range(\"F\" &amp; k) = .Cells(j, 3).Value\n                        k = k + 1\n                    End If\n                Next j\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5901564, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153265651217117/picture?type=large", "display_name": "RoboNerd", "link": "https://stackoverflow.com/users/5901564/robonerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 39992816, "answer_count": 2, "score": 1, "last_activity_date": 1476258089, "creation_date": 1476256839, "question_id": 39992708, "link": "https://stackoverflow.com/questions/39992708/excel-string-comparison-issue", "title": "excel string comparison issue", "body": "<p>So I am trying to create a pretty simple macro that loops through a certain row looking for a value which is identified in a different sheet.  Once that value is found it starts to look in that resultant column for a text string.  If the text string is found, it grabs the value within the same row but a couple columns over and writes it to the sheet which has the user defined look up value.  My problem is that for some reason when I am trying to compare the strings my conditional if statement is not being achieved, meaning that the part which writes the final value is never being evaluated.Here is the code and thanks in advance.  </p>\n\n<pre><code>Private Sub valchange()\nDim keycells As Range\nSet keycells = Worksheets(\"Dashboard\").Range(\"B1\")\nDim k As Integer\nk = 5\n        For I = 1 To 50\n            If Worksheets(\"Rework List\").Cells(3, I).Value = keycells.Value Then\n                For j = 14 To 50\n                    If UCase(Worksheets(\"Rework List\").Cells(j, I)) = \"*PENDING*\" Then\n                            Cells(j, 3).Value = Worksheets(\"Dashboard\").Range(\"F\" &amp; k)\n                            k = k + 1\n                    End If\n                Next j\n            End If\n        Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476257919, "post_id": 39991838, "comment_id": 67263959, "body": "How about using <code>Private Sub Image1_BeforeDragOver(....</code> instead? <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-454.html\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/archive/index.php/t-454.html</a>"}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476262133, "post_id": 39991838, "comment_id": 67266495, "body": "hi, can you show me how the guide can be used on my project? sorry this is the first time i have encountered this beforedragover event and i cannot find anything relevant for excel2013 in google."}], "owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476260085, "creation_date": 1476253689, "last_edit_date": 1476260085, "question_id": 39991838, "link": "https://stackoverflow.com/questions/39991838/excel-userform-image-drag-for-a-simple-game", "title": "Excel Userform Image Drag for a simple game", "body": "<p><img src=\"https://i.stack.imgur.com/NARZm.png\" alt=\"Image1\"></p>\n\n<p>Hi everyone. I am trying to create a simple drag and drop game where the player should be able to drag an Image Control to a Specific location in a UserForm.</p>\n\n<p>I have tried to look around the net without getting a specific answer to my issue. </p>\n\n<p>The procedures available for an image control doesn't seem to do anything:</p>\n\n<pre><code>Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\nEnd Sub\n</code></pre>\n\n<p>Any advise?</p>\n"}, {"tags": ["excel", "vba", "columnsorting"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1476260989, "post_id": 39992919, "comment_id": 67265786, "body": "Thanks for you answer! The situation is I need to work on 5 column data, and I need to first sort them by color in column B and value in column A."}, {"owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1476261265, "post_id": 39992919, "comment_id": 67265950, "body": "I wrongly press the ENTER key. When I try to run you VBA, it prompts A &quot;Run-time error &#39;1004&#39; : Method &#39;Range&#39; of object&#39;_Global&#39; failed&quot; and points at &quot;.Set aColumn = Range(&quot;A2&quot;, .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp))&quot; The line makes sense to me, so I really don&#39;t know how to debug it, please advice, thank in advance!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1476261965, "post_id": 39992919, "comment_id": 67266386, "body": "I was missing a dot qualifier.   No data in column A will also cause the error.  What is the actual data range that you want to filter?"}, {"owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1476283838, "post_id": 39992919, "comment_id": 67281147, "body": "Thanks you so much! I got it working flawlessly after adding the dot qualifier."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1476296596, "post_id": 39992919, "comment_id": 67289401, "body": "@YSCheung I glad that I was able to help. :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1476261970, "last_edit_date": 1476261970, "creation_date": 1476257527, "answer_id": 39992919, "question_id": 39991059, "link": "https://stackoverflow.com/questions/39991059/sorting-a-dynamic-range-of-data-by-value-of-1-column-and-color-of-another-column/39992919#39992919", "title": "Sorting a dynamic range of data by value of 1 column and color of another column", "body": "<p>You are trying to mix Range Sort and WorkSheet Sort.  </p>\n\n<p>This line still has the close parenthesis from when you recorded the macro.  The macro was using the Worksheet SortFields.Add method.</p>\n\n<p><code>DataOption:=xlSortNormal).SortOnValue.Color = _</code></p>\n\n<p>There is no way write an accurate Macro based on your question.  Try to avoid using Selection, Activate, ActiveCell, ...etc. </p>\n\n<p>This should get you started:</p>\n\n<pre><code>Sub SortData()\n    Dim aColumn As Range, bColumn As Range, Target As Range\n\n    With ActiveWorkbook.Worksheets(\"Sheet1\")\n        Set Target = .Range(\"A1\").CurrentRegion\n        Set aColumn = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n        Set bColumn = .Range(\"B2\", .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n\n        With .Sort\n            .SortFields.Clear\n            .SortFields.Add(bColumn, xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(198, 239, 206)\n            .SortFields.Add Key:=aColumn, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .SetRange Selection\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 39992919, "answer_count": 1, "score": 0, "last_activity_date": 1476261970, "creation_date": 1476249941, "question_id": 39991059, "link": "https://stackoverflow.com/questions/39991059/sorting-a-dynamic-range-of-data-by-value-of-1-column-and-color-of-another-column", "title": "Sorting a dynamic range of data by value of 1 column and color of another column", "body": "<p>I am working on a vba to sort a dynamic range of data by cell color of column 2 and value of column 1. The code works okay with sorting just by value, but got a syntax error when I add the code to sort cell color as well. I have searched for a few hours for similar situations over the internet but failed. (perhaps I don't know the correct keywords) </p>\n\n<p>The following is the code that I am working on. Please shed some light on me, thank a bunch!</p>\n\n<pre><code>Dim oneRange As Range\nDim aCell As Range\nDim bCell As Range\n\nSet oneRange = Selection\nSet aCell = ActiveCell\nSet bCell = ActiveCell.Offset(0, 1)\n\noneRange.Sort key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\noneRange.Sort Key2:=bCell, _\n   SortOn:=xlSortOnCellColor, _\n   Order:=xlAscending, _\n    DataOption:=xlSortNormal).SortOnValue.Color = _\n    RGB(198, 239, 206)\n\n  End Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "win32com"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1476249470, "post_id": 39990959, "comment_id": 67260235, "body": "I think you&#39;re going to find that difficult - if you have control of the VBA it would be best to break the functionality out of the control handler into a separate sub which you can call using <code>application.Run</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478118060, "post_id": 40388958, "comment_id": 68029792, "body": "It&#39;s not possible to remove that argument from the method call in VBA, without breaking the Add-In."}], "tags": [], "owner": {"reputation": 1118, "user_id": 7078614, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tflJqPv5djU/AAAAAAAAAAI/AAAAAAAAAI8/9IpuL9Mz29A/photo.jpg?sz=128", "display_name": "Dr. V", "link": "https://stackoverflow.com/users/7078614/dr-v"}, "is_accepted": true, "score": 0, "last_activity_date": 1478117630, "creation_date": 1478117630, "answer_id": 40388958, "question_id": 39990959, "link": "https://stackoverflow.com/questions/39990959/how-to-run-a-vba-macro-through-python-win32com-that-has-iribboncontrol-as-a-para/40388958#40388958", "title": "How to run a vba macro through Python win32com that has IRibbonControl as a parameter", "body": "<p>You would need an object on python-side that implements <code>IRibbonControl</code>, and pass that as parameter back to Excel.</p>\n\n<p>The only way I can imagine this makes sense (but I have an open mind) is if you implement a COM add-in (<a href=\"https://support.microsoft.com/en-us/kb/291392\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/291392</a>) as <code>IDTExensibility2</code>. Then you will be called the <code>OnConnection</code> method (in your python COM server), which gives you the Excel application object.</p>\n\n<p>From there, you could very likely obtain a reference to the ribbon control.</p>\n\n<p>I must admit that I did so far not manage to get any python COM Excel add-in to work myself, though I tried.</p>\n\n<p>Or can you not better obtain the <code>IRibbonControl</code> from the excel application from within the sub, and remove it from the argument list?</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11554034, "user_type": "registered", "profile_image": "https://graph.facebook.com/1196957956996000/picture?type=large", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/11554034/francisco-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1569862316, "creation_date": 1569862316, "answer_id": 58172163, "question_id": 39990959, "link": "https://stackoverflow.com/questions/39990959/how-to-run-a-vba-macro-through-python-win32com-that-has-iribboncontrol-as-a-para/58172163#58172163", "title": "How to run a vba macro through Python win32com that has IRibbonControl as a parameter", "body": "<p>Usually that argument is to capture customized Ribbons calls, incoming from the ribbon. \nIf you are using Python, then you are not using Ribbon, and then you can bypass that, this does not apply to all use cases, although it applies to mine and most also.</p>\n\n<pre><code>Public Sub test(Optional control As IRibbonControl)\n\n    blabla\n\nEnd Sub\n</code></pre>\n\n<p>Simply using the argument as optional could help there.</p>\n\n<pre><code>import os\nimport win32com.client\n\nfrom win32com.client import DispatchEx\n\nxl = DispatchEx('Excel.Application')\nxl.Workbooks.Open(\"myexcelfile.xlsm\")\n\nxl.Application.Run(\"test\")\n</code></pre>\n"}], "owner": {"reputation": 1635, "user_id": 3001616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100002575680260/picture?type=large", "display_name": "JonghoKim", "link": "https://stackoverflow.com/users/3001616/jonghokim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 40388958, "answer_count": 2, "score": 0, "last_activity_date": 1569862316, "creation_date": 1476249325, "question_id": 39990959, "link": "https://stackoverflow.com/questions/39990959/how-to-run-a-vba-macro-through-python-win32com-that-has-iribboncontrol-as-a-para", "title": "How to run a vba macro through Python win32com that has IRibbonControl as a parameter", "body": "<p>I want to run a vba macro that has IRibbonControl as a parameter using Python win32com.</p>\n\n<p>For example, my vba sub is looks like below</p>\n\n<pre><code>Public Sub test(control As IRibbonControl)\n\n    blabla\n\nEnd Sub\n</code></pre>\n\n<p>And </p>\n\n<p>And then Python calls test sub using win32com.</p>\n\n<p>What should we put on parameters of a test function?</p>\n\n<pre><code>import os\nimport win32com.client\n\nfrom win32com.client import DispatchEx\n\nxl = DispatchEx('Excel.Application')\nxl.Workbooks.Open(\"myexcelfile.xlsm\")\n\nxl.Application.Run(\"test\", some magic needs here)\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1476249969, "creation_date": 1476249969, "answer_id": 39991067, "question_id": 39990080, "link": "https://stackoverflow.com/questions/39990080/output-listbox-as-multiple-line-log/39991067#39991067", "title": "Output ListBox as multiple line log", "body": "<p>Dealing with the printing file statements only, you have to:</p>\n\n<ul>\n<li>change n type to <code>integer</code> </li>\n<li>use <code>Append</code> keyword</li>\n</ul>\n\n<p>here's the revised code</p>\n\n<pre><code>Sub ExampleString(s As String)\n    Dim n As Integer\n\n    n = FreeFile()\n    Open \"C:\\Path\\TEST.txt\" For Append As #n\n\n    If Not listBoxOut Is Nothing Then\n        With listBoxOut\n            ' add items to List Box\n            Print #n, s\n            ' iterate through List Box\n            Close #n\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6777867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44b1b3649794c1f90ec05b5cd00ef80b?s=128&d=identicon&r=PG&f=1", "display_name": "Neuw", "link": "https://stackoverflow.com/users/6777867/neuw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 39991067, "answer_count": 1, "score": 0, "last_activity_date": 1476249969, "creation_date": 1476243191, "question_id": 39990080, "link": "https://stackoverflow.com/questions/39990080/output-listbox-as-multiple-line-log", "title": "Output ListBox as multiple line log", "body": "<p>I have run into an issue when automating some of the error checking processes on a database. I need to output a log that is identical to an output to a ListBox, however my current (FreeFile) method, will overwrite the log file each time a new line is added to the box.</p>\n\n<pre><code>Sub ExampleString (s As String)\nDim n as Object\n\nn = FreeFile()\nOpen \"C:\\Path\\TEST.txt\" For Output As #n\n\nIf Not listBoxOut Is Nothing Then\nWith listBoxOut\n' add items to List Box\nPrint #n, s\n' iterate through List Box\nClose #n\nEnd With\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>How would I go about ouputting this text in an identical manner to how it is done in the ListBox, over multiple lines?</p>\n\n<p>Thanks,</p>\n\n<p>Neuw</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "edited": false, "score": 0, "creation_date": 1476312117, "post_id": 39990092, "comment_id": 67297176, "body": "Thank you lllpratll, I am really sorry, i am new to VBA. Could you plz help me with the code. I know I am asking for more."}, {"owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "edited": false, "score": 0, "creation_date": 1476328344, "post_id": 39990092, "comment_id": 67301206, "body": "Thank you for the code. It&#39;s crashing my excel every time. Also, my cell value changes every time. So if my excel is updated from A1 to L30. Now when new value gets updated it would get added to A31 so I want timer with"}, {"owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "edited": false, "score": 0, "creation_date": 1476328403, "post_id": 39990092, "comment_id": 67301221, "body": "Thank you for the code. It&#39;s crashing my excel every time. Also, my cell value changes every time. So if my excel is updated from A1 to L30. Now when the new value gets updated it would get added to A31 so I want timer with to come in B31."}], "tags": [], "owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "is_accepted": false, "score": 0, "last_activity_date": 1476316039, "last_edit_date": 1495541969, "creation_date": 1476243264, "answer_id": 39990092, "question_id": 39989919, "link": "https://stackoverflow.com/questions/39989919/adding-timer-to-adjacent-cell/39990092#39990092", "title": "Adding timer to adjacent cell", "body": "<p>you can find info on timers here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11867225/how-do-i-show-a-running-clock-in-excel\">How do I show a running clock in Excel?</a></p>\n\n<p>this link will show you how to run a sub (to start the timer) when a cell value changes</p>\n\n<p><a href=\"https://stackoverflow.com/questions/409434/automatically-execute-an-excel-macro-on-a-cell-change\">automatically execute an Excel macro on a cell change</a></p>\n\n<p>you should create a variable to hold the time when the timer starts to allow you to determine when 15 mins have passed, then you can change the cell colour, eg.</p>\n\n<p>Worksheets(\"Sheet1\").Range(\"A1\").Interior.Color = vbRed</p>\n\n<p>Ok, I'll help you to create the code. You will have to edit it slightly for your specific sheet names and ranges. In this example I have a sheet named \"timer\", when the value in cell A1 changes a timer appears in cell B1 then after 15 seconds B1 turns red (I made it 15 seconds for testing, you can change to whatever you need). Also I turn off the timer once the 15 seconds have passed, you may want to leave it running and updating the cell.</p>\n\n<p>You want to add this code to the sheet with the data that will change (in my case \"timer\"), repeat, don't put this code in a module, it has to be in the code of the sheet</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"A1\")) Is Nothing Then    \n        StartTimer    \n    End If    \nEnd Sub\n</code></pre>\n\n<p>Then you want to create a module and add this code</p>\n\n<pre><code>Public Declare Function SetTimer Lib \"user32\" (ByVal HWnd As Long, ByVal nIDEvent As Long, ByVal uElapse As Long, ByVal lpTimerFunc As Long) As Long\n\nPublic Declare Function KillTimer Lib \"user32\" (ByVal HWnd As Long, ByVal nIDEvent As Long) As Long\n\nPublic TimerID As Long, TimerSeconds As Single, tim As Boolean\nDim Counter As Long\nDim StartTime As Date\n\nSub StartTimer()\n\n    StartTime = Now()\n    TimerSeconds = 1\n    TimerID = SetTimer(0&amp;, 0&amp;, TimerSeconds * 1000&amp;, AddressOf TimerProc)\n\nEnd Sub\n\nSub EndTimer()\n\n    On Error Resume Next\n    KillTimer 0&amp;, TimerID\n\nEnd Sub\n\nSub TimerProc(ByVal HWnd As Long, ByVal uMsg As Long, ByVal nIDEvent As Long, ByVal dwTimer As Long)\n\n    Worksheets(\"timer\").Range(\"B1\").Value = Time\n\n    If (Now - StartTime &gt; TimeValue(\"00:00:15\")) Then\n\n        Worksheets(\"timer\").Range(\"B1\").Interior.Color = vbRed\n        Worksheets(\"timer\").Range(\"B1\").Value = \"\"\n        EndTimer\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476316039, "creation_date": 1476241917, "last_edit_date": 1531164843, "question_id": 39989919, "link": "https://stackoverflow.com/questions/39989919/adding-timer-to-adjacent-cell", "title": "Adding timer to adjacent cell", "body": "<p>Thank you for answering the previous question. Now I would like to start a timer to the corresponding cell of ticket arriving in Dashboard. During frequent update one of my cell update with a time of arrival of the ticket on the dashboard. As soon as the cell is updated with actual time I would like to run a timer to the corresponding cell. Once the timer crosses 15 min it should show in red colour. Not sure if this is possible. Please help me with this.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "is_accepted": true, "score": -1, "last_activity_date": 1476314879, "last_edit_date": 1476314879, "creation_date": 1476246874, "answer_id": 39990591, "question_id": 39989804, "link": "https://stackoverflow.com/questions/39989804/comparing-values-in-different-columns-looping/39990591#39990591", "title": "Comparing values in different columns - looping", "body": "<p>I've included code below to solve the problem you stated at the top. If you have EntryP in A1:A3 and TwndHigh in A5:A10 as in the example it will output the results next to the EntryP data. Based on your example data you are dealing with relatively small integers, please note you need to initialise possibleResult to something larger than your expected input data and you may need to change the data type to accomdate this.</p>\n\n<pre><code>Public Sub FindFirstHigher()\n\nDim possibleResult As Integer\n\nDim EntryP, TwndHigh As Range\n\nSet EntryP = Worksheets(\"firstHigher\").Range(\"A1:A3\")\nSet TwndHigh = Worksheets(\"firstHigher\").Range(\"A5:A10\")\n\nFor Each entrycell In EntryP\n\n    possibleResult = 9999\n\n    For Each checkcell In TwndHigh\n\n        If (checkcell.Value &gt; entrycell.Value And checkcell.Value &lt; possibleResult) Then\n\n            possibleResult = checkcell.Value\n\n        End If\n\n    Next checkcell\n\n    entrycell.Offset(0, 1).Value = possibleResult\n\nNext entrycell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6902524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b7dea714b71287856d0e56598ae010f7?s=128&d=identicon&r=PG&f=1", "display_name": "jadeliew123", "link": "https://stackoverflow.com/users/6902524/jadeliew123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 39990591, "answer_count": 1, "score": -1, "last_activity_date": 1476314879, "creation_date": 1476240950, "question_id": 39989804, "link": "https://stackoverflow.com/questions/39989804/comparing-values-in-different-columns-looping", "title": "Comparing values in different columns - looping", "body": "<p>I want to compare values from </p>\n\n<p>EntryP:</p>\n\n<p>6</p>\n\n<p>11</p>\n\n<p>4</p>\n\n<p>TwndHigh:</p>\n\n<p>5</p>\n\n<p>10</p>\n\n<p>4</p>\n\n<p>6</p>\n\n<p>10</p>\n\n<p>11</p>\n\n<p>I want to compare each value in EntryP to the values in TwndHigh and find the first value in TwndHigh that is bigger than EntryP. For eg the first value that is bigger than 6 is 10, <strong>and the first value that is bigger than 4 is 6.</strong> that means i want my row number in TwndHigh to match the row of EntryP i want to compare. </p>\n\n<pre><code>Sub BUYexitGAIN()\n\nDim ohlc As Range\nDim cll, cell, twndhigh, twndlow As Range\nDim stoplossb, entrypriceb, stoplosss, entryprices As Double\nDim exitgains, exitlosss, exitgainb, exitlossb As Range\nDim n As Range\nDim i As Long\n\n\nFor i = 990 To 2000\n\n'BUY\n    If Range(\"M\" &amp; i).Value = \"buy\" Then\n        entrypriceb = Range(\"w\" &amp; i)\n        Set twndlow = Range(\"K\" &amp; i &amp; \":\" &amp; \"K10000\")\n\n    For Each cell In twndlow\n        If cell.Value &gt; entrypriceb Then\n            Range(\"z\" &amp; cell.Row) = cell.Value\n            Range(\"t\" &amp; cell.Row) = -Range(\"t\" &amp; i)\n            Range(\"u\" &amp; cell.Row) = Range(\"t\" &amp; i) * cell.Value * 10000\n            Exit For\n        End If\n    Next cell\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>A bit messy right now, but I'm using double loops (For and For each cell). This gives me about 3 values in my return columns (when i only want the first value that meets my condition), with 2 of them usually as wrong values and 1 of them right. How do I make my code a single loop, or make it just return the First Value I want? Thanks guys</p>\n\n<p>*PS sorry i know i have asked similar questions but I wanted to rewrite my whole question to make it easier for you guys.</p>\n"}, {"tags": ["vba", "excel", "delimiter", "trim"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1476251943, "post_id": 39989631, "comment_id": 67261043, "body": "&quot;The code I currently have works fine&quot; - it would help if you posted that"}], "answers": [{"tags": [], "owner": {"reputation": 2608, "user_id": 6942328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ck4d7.jpg?s=128&g=1", "display_name": "LStarky", "link": "https://stackoverflow.com/users/6942328/lstarky"}, "is_accepted": false, "score": 0, "last_activity_date": 1476240409, "creation_date": 1476240409, "answer_id": 39989724, "question_id": 39989631, "link": "https://stackoverflow.com/questions/39989631/removing-spaces-from-text-string-in-vba/39989724#39989724", "title": "Removing spaces from text string in vba", "body": "<p>Do you have any control over the format of the data export?  If so, you should change it to use a different delimiter, like CSV (\"WT 03\",\"68.44\",\"91.13\"...).</p>\n\n<p>If not, you could try separating the values by multiple spaces.  It looks like there are at least 5-6 spaces between legitimate fields, so try dividing them using the Split function as follows:</p>\n\n<pre><code>Dim MyArr() as String\nMyArr = Split(InputTextLine, \"     \")\n</code></pre>\n\n<p>And then trim each of the array values to remove excess spaces.</p>\n"}], "owner": {"reputation": 11, "user_id": 7004982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a3ac26c817088ceaee4a5ee1e1e38d?s=128&d=identicon&r=PG&f=1", "display_name": "Emily ", "link": "https://stackoverflow.com/users/7004982/emily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1278, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1476241174, "creation_date": 1476239758, "last_edit_date": 1476241174, "question_id": 39989631, "link": "https://stackoverflow.com/questions/39989631/removing-spaces-from-text-string-in-vba", "title": "Removing spaces from text string in vba", "body": "<p>I'm trying to debug a function in excel to do with delimiting tables using data from an imported text file. The macro has an issue when the name has a space in it (see example, second line) since the table is delimited using spaces. The code I currently have works fine for the first line of the example. A table exists with multiple lines similar to this.</p>\n\n<p>Example of lines of table imported from text file</p>\n\n<p><a href=\"https://i.stack.imgur.com/rMPxe.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/rMPxe.png\" alt=\"enter image description here\"></a></p>\n\n<p>So the issue is when something like \"WT 03\" appears, has a space, the program crashes. I've tried trimming and find &amp; replace but they don't work since the entire line is contained in the first column and separated by spaces. I only want to eliminated any spaces found within \"Wt02\" or \"WT 03\" when they occur.</p>\n\n<p>Any suggestions or recommendations on where to look would be appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1476280379, "creation_date": 1476280379, "answer_id": 40000455, "question_id": 39989085, "link": "https://stackoverflow.com/questions/39989085/word-vba-table-copy-formatted-cell-contents-but-not-table/40000455#40000455", "title": "Word VBA table - copy formatted cell contents but not table", "body": "<p>I found a workaround to transform tables in an output document into their formatted content, while preserving nested tables. Afterwards I remove indentation of the content and previously nested tables, because it is not needed anymore after getting rid of the main table.</p>\n\n<p>Still hoping to find a cleaner and more efficient solution.</p>\n\n<pre><code>For Each table In outputDoc.Tables        \n    table.ConvertToText Separator:=wdSeparateByParagraphs, NestedTables:=False\nNext table\n\nWith outputDoc.Content.ParagraphFormat\n    .LeftIndent = CentimetersToPoints(0)\n    .FirstLineIndent = CentimetersToPoints(0)\nEnd With\n\nFor Each table In outputDoc.Tables\n    table.Rows.LeftIndent = CentimetersToPoints(0)\nNext table\n</code></pre>\n"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476280379, "creation_date": 1476234998, "question_id": 39989085, "link": "https://stackoverflow.com/questions/39989085/word-vba-table-copy-formatted-cell-contents-but-not-table", "title": "Word VBA table - copy formatted cell contents but not table", "body": "<p>I'm trying to copy content of Word table cells (formatted text, bullet points, tables, images) and paste them into an output docx file. Unfortunately code below copies the whole cell, so that an undesired table is created in output file.</p>\n\n<pre><code>With outputApp.Selection\n    dbDoc.Tables(1).Cell(tableRow, 3).Range.Copy\n    .Paste\nEnd With\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "join", "count"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1476231664, "post_id": 39988474, "comment_id": 67256074, "body": "You may just be missing a <code>GROUP BY</code> clause but are you sure table 3&#39;s county id matches table 4&#39;s county name? Seems inconsistent."}, {"owner": {"reputation": 17, "user_id": 1504725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b21108c4e1524de1a93ac6aa8113ed?s=128&d=identicon&r=PG", "display_name": "user1504725", "link": "https://stackoverflow.com/users/1504725/user1504725"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1476292594, "post_id": 39988474, "comment_id": 67287005, "body": "Yea, i just named them differently. I would rename it but it would require alot of rewriting code."}, {"owner": {"reputation": 17, "user_id": 1504725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b21108c4e1524de1a93ac6aa8113ed?s=128&d=identicon&r=PG", "display_name": "user1504725", "link": "https://stackoverflow.com/users/1504725/user1504725"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1476292624, "post_id": 39988474, "comment_id": 67287023, "body": "How would i include the group by clause?"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1476293853, "creation_date": 1476293853, "answer_id": 40004958, "question_id": 39988474, "link": "https://stackoverflow.com/questions/39988474/join-and-count-records-sql-vba-access/40004958#40004958", "title": "Join and Count Records SQL vba access", "body": "<p>Several things need adjustments in your query:</p>\n\n<ol>\n<li><code>JOIN</code> statements are not correct as you are joining <em>Table1</em> to itself multiple times (which is allowed for self-joins) but you then refer to <em>Table2</em>, <em>Table3</em>, and <em>Table4</em> which do not exist. Simply join by those tables. Possibly, these were simple typos.</li>\n<li>MS Access SQL requires parentheses around table join pairings.</li>\n<li>Brackets must wrap around a table name or field name. Two brackets cannot wrap both though two sets of brackets can be used: <code>[table].[field]</code>.</li>\n<li>Add a <code>GROUP BY</code> at the end of query. In SQL, all non-aggregated (or unit-level) columns in <code>SELECT</code> of an aggregate query are considered the groupings and hence must be declared in a <code>GROUP BY</code>.</li>\n<li><p>Consider a <code>BETWEEN</code> clause for your date range as recommended with <a href=\"https://msdn.microsoft.com/en-us/library/dd942824(v=office.12).aspx#Anchor_4\" rel=\"nofollow\">Query Performance Tips</a>: </p>\n\n<blockquote>\n  <p>Between lets the search engine look for values in one evaluation\n  rather than two</p>\n</blockquote></li>\n</ol>\n\n<p><strong>SQL</strong> Query adjustment</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT COUNT(*), table1.date, table2.status, table3.county\nFROM ((table1 \nINNER JOIN table2 ON table1.status = table2.staus)\nINNER JOIN table3 ON table1.cust_id = table3.cust_id) \nINNER JOIN table4 ON table3.countyid = table4.countyname \nWHERE table1.[Date] BETWEEN date_variable_1 AND date_variable_2 \n  AND table3.[county] = countyname\n  AND table4.[status] = Status_string \nGROUP BY table1.date, table2.status, table3.county\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 1504725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b21108c4e1524de1a93ac6aa8113ed?s=128&d=identicon&r=PG", "display_name": "user1504725", "link": "https://stackoverflow.com/users/1504725/user1504725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 40004958, "answer_count": 1, "score": 0, "last_activity_date": 1476315795, "creation_date": 1476229719, "last_edit_date": 1476315795, "question_id": 39988474, "link": "https://stackoverflow.com/questions/39988474/join-and-count-records-sql-vba-access", "title": "Join and Count Records SQL vba access", "body": "<p>i just started learning sql and i have a vba funtion that i want to convert to a simple sql. i have 4 tables that need to be joined then i need a total count where date>date1 &amp; date &lt; date2 and status= status_string and county=countyname (date1, date2, status_string, county names are variables).</p>\n\n<pre><code>SELECT COUNT(*), table1.date, table2.status, table3.county\nFROM table1 \nINNER JOIN table1 ON table1.status=table2.staus\nINNER JOIN table1 ON table1.cust_id=table3.cust_id \nINNER JOIN table3 ON table3.countyid=table4.countyname \nWHERE table4.status = Status_string and [table1.Date] &gt; date_varaible_1 and [table1.Date] &lt; date_varaible_2 and [table.county]=countyname\n</code></pre>\n\n<p>any help to correct this would be great.</p>\n\n<p>ty</p>\n"}, {"tags": ["ms-access", "vba", "report", "datasource"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7004034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63320d307405179d86df798a1dd6f02a?s=128&d=identicon&r=PG&f=1", "display_name": "SteveMap", "link": "https://stackoverflow.com/users/7004034/stevemap"}, "edited": false, "score": 0, "creation_date": 1476271139, "post_id": 39988382, "comment_id": 67272269, "body": "I am trying to write a monthly report where the month ends on the 20th.  My data spans over a period of 4 years.  I am going to have each month be on on one page. My thought was to have the dates in a table, read them into the query and print the report and repeat the process for the 4 yeas of data.  Thanks for your help."}], "tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 1, "last_activity_date": 1476229112, "creation_date": 1476229112, "answer_id": 39988382, "question_id": 39987115, "link": "https://stackoverflow.com/questions/39987115/trying-to-pass-parameters-to-an-ms-access-query/39988382#39988382", "title": "Trying to pass parameters to an MS Access query", "body": "<p>Nothing is happening because you're not doing anything with <code>qdf</code> and <code>rst</code> after you set them. I'm not entirely sure what you're trying to accomplish, but:</p>\n\n<p><br>\n1. If you want to open a Report whose <code>RecordSource</code> is the results of the Query (with parameters dynamically set), try placing the following in the Report's code module:</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\n    Dim db As DAO.Database: Set db = CurrentDb\n    Dim qdf As DAO.QueryDef\n    Dim sql As String\n\n    Set qdf = db.QueryDefs(\"MixByRangeA\")\n\n    sql = qdf.sql\n    sql = Replace(sql, \"[StartDate]\", \"#10/2/2014#\")\n    sql = Replace(sql, \"[EndDate]\", \"#11/2/2014#\")\n    Me.RecordSource = sql\n\n    On Error Resume Next\n    qdf.Close: Set qdf = Nothing\n    db.Close: Set db = Nothing\nEnd Sub\n</code></pre>\n\n<p>And in the Form, use this to open the Report:</p>\n\n<pre><code>Private Sub AutoReport1_Click()\n    DoCmd.OpenReport \"Report1\", acViewReport\nEnd Sub\n</code></pre>\n\n<p><br>\n2. If instead you just want to open the Query (with parameters dynamically set), try the following:</p>\n\n<pre><code>Public Sub AutoReport1_Click()\n    Dim db As DAO.Database: Set db = CurrentDb\n    Dim qdf As DAO.QueryDef\n    Dim sql As String\n\n    Set qdf = db.QueryDefs(\"MixByRangeA\")\n\n    sql = qdf.sql\n    sql = Replace(sql, \"[StartDate]\", \"#10/2/2014#\")\n    sql = Replace(sql, \"[EndDate]\", \"#11/2/2014#\")\n    qdf.sql = sql\n    DoCmd.OpenQuery (qdf.Name)\n\n    On Error Resume Next\n    qdf.Close: Set qdf = Nothing\n    db.Close: Set db = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7004034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63320d307405179d86df798a1dd6f02a?s=128&d=identicon&r=PG&f=1", "display_name": "SteveMap", "link": "https://stackoverflow.com/users/7004034/stevemap"}, "edited": false, "score": 0, "creation_date": 1476352770, "post_id": 39992854, "comment_id": 67312543, "body": "I think this might work for what I am trying to do but I am getting an run-time error &#39;13&#39;, Type Mismatch"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 7004034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63320d307405179d86df798a1dd6f02a?s=128&d=identicon&r=PG&f=1", "display_name": "SteveMap", "link": "https://stackoverflow.com/users/7004034/stevemap"}, "edited": false, "score": 0, "creation_date": 1476353019, "post_id": 39992854, "comment_id": 67312745, "body": "Sorry, the filter was malformed. See revised answer please."}, {"owner": {"reputation": 1, "user_id": 7004034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63320d307405179d86df798a1dd6f02a?s=128&d=identicon&r=PG&f=1", "display_name": "SteveMap", "link": "https://stackoverflow.com/users/7004034/stevemap"}, "edited": false, "score": 0, "creation_date": 1476357829, "post_id": 39992854, "comment_id": 67315982, "body": "Thanks, I actually got it working.  I did the same thing you are showing.  Now I am trying to figure out how to make the StartDate and EndDate Value show on my report. like Starting date = 9/10/2015 etc."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476352980, "last_edit_date": 1476352980, "creation_date": 1476257354, "answer_id": 39992854, "question_id": 39987115, "link": "https://stackoverflow.com/questions/39987115/trying-to-pass-parameters-to-an-ms-access-query/39992854#39992854", "title": "Trying to pass parameters to an MS Access query", "body": "<p>The easy method is to remove the parameters from the query and apply a filter to the report:</p>\n\n<pre><code>Dim StartDate As Date\nDim EndDate As Date\n\nStartDate = #10/2/2014#\nEndDate = #11/2/2014#\n\nDoCmd.OpenReport \"YourReport\", , , \"[YourDateField] Between #\" &amp; Format(StartDate, \"yyyy\\/mm\\/dd\") &amp; \"# And #\" &amp; Format(EndDate, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 50532, "user_id": 15354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca5a87d982422410d9f14aa89c0a842?s=128&d=identicon&r=PG", "display_name": "onedaywhen", "link": "https://stackoverflow.com/users/15354/onedaywhen"}, "is_accepted": false, "score": 0, "last_activity_date": 1476263812, "creation_date": 1476263812, "answer_id": 39994907, "question_id": 39987115, "link": "https://stackoverflow.com/questions/39987115/trying-to-pass-parameters-to-an-ms-access-query/39994907#39994907", "title": "Trying to pass parameters to an MS Access query", "body": "<p>I don't think it can be done the way simple way you want.</p>\n\n<p>This seems a shame because you've followed what could be considered 'best practise' by using a stored procedure with parameters parameters, rather than constructing dynamic SQL.</p>\n\n<p>The truth is, even if it is good practise generally, you are guilty of going against the natural flow of how the Access Team want you use its software! Looks like you are compelled to dynamically construct a <code>WHERE</code> clause to squirt into the provided method :(</p>\n"}], "owner": {"reputation": 1, "user_id": 7004034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63320d307405179d86df798a1dd6f02a?s=128&d=identicon&r=PG&f=1", "display_name": "SteveMap", "link": "https://stackoverflow.com/users/7004034/stevemap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1476352980, "creation_date": 1476221600, "last_edit_date": 1476238226, "question_id": 39987115, "link": "https://stackoverflow.com/questions/39987115/trying-to-pass-parameters-to-an-ms-access-query", "title": "Trying to pass parameters to an MS Access query", "body": "<p>I am trying to write a MS Access report based on a query that I can programically put the a date range in using VBA. I set up the query with <code>Between [StartDate] and [EndDate]</code> as the criteria.  Then I have the following code on a form:</p>\n\n<pre><code>Private Sub AutoReport1_Click()\nDim qdf As DAO.QueryDef\nDim rst As DAO.Recordset\n\nSet qdf = CurrentDb.QueryDefs(\"MixByRangeA\")\n\nqdf.Parameters(\"StartDate\").Value = #10/2/2014#\nqdf.Parameters(\"EndDate\").Value = #11/2/2014#\n\n\nSet rst = qdf.OpenRecordset()\n\nEnd Sub\n</code></pre>\n\n<p>Nothing seems to happen.  Should the query open and show on the screen?  I have tried a few code variations of the above based on my internet searches but nothing works.</p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1476221119, "post_id": 39986941, "comment_id": 67252851, "body": "Depending on how funky you&#39;re willing to I remember doing something similar; I created the objects at run-time so they had array like names. Another method would be to make a class wrapper for the objects. Also, I think a collection would work."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476221448, "post_id": 39986941, "comment_id": 67253026, "body": "I agree that a collection is the best way to go. Actually I would further say that collections are specifically made to be able to progamatically cycle through its items. Is there not a listbox collection in any case by default in Excel? Pretty sure there is an object collection you can cycle through and test if each item is a listbox and action accordingly."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 1, "creation_date": 1476222478, "post_id": 39986941, "comment_id": 67253491, "body": "I know exactly how to do this, but I want to make sure I get it right: you want to cycle through 18 ListBox objects (named ListBox_TimeX) and rename them to something else, right?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1476222843, "post_id": 39986941, "comment_id": 67253642, "body": "You will get error 382 - you can&#39;t write to a control name while the form is initialized"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1476222931, "post_id": 39986941, "comment_id": 67253680, "body": "@JReid How could you achieve that if the elements are already set on the userform? at.nbayly The thing they are objects in a userforms, but, hmm perhaps you are right, just I need to know somehow how to call the items in the userform at.tyeler Not rename them, instead changing their values"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476223099, "post_id": 39986941, "comment_id": 67253746, "body": "@Sgdva Oh like set a default value in index 0?"}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1476223011, "post_id": 39987296, "comment_id": 67253712, "body": "Thanks! However the objects are inside a userform, not in the sheet as shapes; I mean there are list boxes in a userform that I need to work with."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1476222430, "creation_date": 1476222430, "answer_id": 39987296, "question_id": 39986941, "link": "https://stackoverflow.com/questions/39986941/select-variable-object-with-counter/39987296#39987296", "title": "Select variable object with counter", "body": "<p>I treat them like <code>Shapes</code> and test their pre-defined <code>Names</code>:</p>\n\n<pre><code>Sub ShapeRenamer()\n    Dim s As Shape\n    For Each s In ActiveSheet.Shapes\n        If s.Name = \"List Box 6\" Then s.Name = \"Sixth\"\n    Next s\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/07fkI.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/07fkI.png\" alt=\"enter image description here\"></a></p>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qEpSD.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/qEpSD.png\" alt=\"enter image description here\"></a></p>\n\n<p>You would update this to examine the <code>Shapes</code> in your userform.</p>\n\n<p>You could also do this with an indexing counter.</p>\n"}, {"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1476223455, "post_id": 39987351, "comment_id": 67253911, "body": "Yes this worked! I go confused somehow because I try to avoid sometimes for each and having a preset cycle instead, thanks!"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1476223641, "post_id": 39987351, "comment_id": 67253989, "body": "I&#39;m glad it worked, but I&#39;m not sure how... I wasn&#39;t aware it would throw error 382 like Raystafarian said. I guess if you wanted to know how to cycle through userform controls, this does show you how. As far as it being working code....."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1476224000, "post_id": 39987351, "comment_id": 67254116, "body": "@Sgdva I changed the code to reflect what I think it is you&#39;re asking for. Since you didn&#39;t actually want to change the objects name, just it&#39;s index 0 item, I changed the code to reflect that"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 4, "last_activity_date": 1476223941, "last_edit_date": 1476223941, "creation_date": 1476222687, "answer_id": 39987351, "question_id": 39986941, "link": "https://stackoverflow.com/questions/39986941/select-variable-object-with-counter/39987351#39987351", "title": "Select variable object with counter", "body": "<h2>For use with ListBox controls on a UserForm</h2>\n\n<p><strong>If you want to change only certain ListBox controls by number:</strong></p>\n\n<pre><code>Public Sub ListBoxNameChange()\n    Dim ctrl As Control\n    Dim ctrlName As String, ctrlNum As Integer\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"ListBox\" Then\n            ctrlName = ctrl.Name\n            ctrlNum = CInt(Replace(ctrlName, \"ListBox_Time\", \"\")) \n            If ctrlNum &gt; 0 And ctrlNum &lt; 19 Then\n                ctrl.AddItem \"Dummy\" &amp; ctrlNum, 0\n            End If\n        End If\n    Next ctrl\nEnd Sub\n</code></pre>\n\n<p><strong>If you want to change ALL ListBox controls:</strong></p>\n\n<pre><code>Public Sub ListBoxNameChange2()\n    Dim ctrl As Control\n    Dim ctrlName As String\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"ListBox\" Then _\n            ctrl.AddItem \"Dummy\" &amp; Replace(ctrl.Name, \"ListBox_Time\", \"\"), 0\n    Next ctrl\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1476223536, "post_id": 39987450, "comment_id": 67253945, "body": "This is a nice tip and it works as well, I upvoted it only but, it might be consider as solution as well (Saddly 2 were given almost in the same time)"}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 5, "last_activity_date": 1476261969, "last_edit_date": 1476261969, "creation_date": 1476223168, "answer_id": 39987450, "question_id": 39986941, "link": "https://stackoverflow.com/questions/39986941/select-variable-object-with-counter/39987450#39987450", "title": "Select variable object with counter", "body": "<p>No, you can't edit the name while the userform is in use, you'll get <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251501.aspx\" rel=\"nofollow\">error 382</a></p>\n\n<p>What you'd like to do is this</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim myForm As UserForm\n    Set myForm = UserForm1\n    Dim myCtrl As Control\n    Dim i As Long\n    Dim myCount As Long\n    myCount = 1\n        For Each myCtrl In myForm.Controls\n            If TypeName(myCtrl) = \"ListBox\" Then\n                myCtrl.Name = \"Dummy\" &amp; myCount 'error\n                myCount = myCount + 1\n            End If\n        Next\nEnd Sub\n</code></pre>\n\n<p>But you'll error when you try to write to the name property. You can print the names or set other properties, but this isn't something you can do as far as I know.</p>\n"}], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 39987351, "answer_count": 3, "score": 1, "last_activity_date": 1476261969, "creation_date": 1476220860, "last_edit_date": 1531161705, "question_id": 39986941, "link": "https://stackoverflow.com/questions/39986941/select-variable-object-with-counter", "title": "Select variable object with counter", "body": "<p><strong>Background:</strong>\n<br>I have a collection of objects (for this example Listbox objects) in a userform using standardized names, I would like to rename them dynamically using a counter cycle.\n<a href=\"https://i.stack.imgur.com/GFFfs.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/GFFfs.png\" alt=\"enter image description here\"></a></p>\n\n<p><br><strong>Problem:</strong>\n<br>I have not figured a way if what I am asking is even possible, however, I would like to confirm it.\n<strong>Solution approach:</strong>\n<br>Nothing so far, like I said (refer to the image above) I need a way to set the values of the objects within the for cycle, something like this:</p>\n\n<pre><code>For CounterItems = 1 To 18 'Hours in Template\nListBox_Time(CounterItems).Value=\"Dummy\" &amp; CounterItems\nNext CounterHours\n</code></pre>\n\n<p>However, I am clueless on how to do so (or if it is achievable).\n<br><strong>Question:</strong>\n<br>Is there any way to use a counter to cast a variable/object?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476297907, "post_id": 39986880, "comment_id": 67290164, "body": "Thank you.  I&#39;m trying to learn more about this.  What would you have done different?"}, {"owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476298329, "post_id": 39986880, "comment_id": 67290425, "body": "Hello J.  I&#39;m getting a compile error.  Next without for.  It&#39;s after j=j+1"}, {"owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476298410, "post_id": 39986880, "comment_id": 67290480, "body": "it&#39;s after,  j=j+1   next c"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476298922, "post_id": 39986880, "comment_id": 67290784, "body": "Hi Brian, if the code is the same with only the change I made you should not get said compile error. Unfortunately, I would need to see the code to tell you what&#39;s missing. It&#39;s not necessarily the for:next combination, could be a missing &#39;end if&#39;"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476299119, "post_id": 39986880, "comment_id": 67290889, "body": "What would you have done different? &gt;&gt; Sorting is very expensive, I would not do this. Copy-Paste is also expensive, not sure I would do this. You can read the entire range once, reading a variable is faster than reading cells. You can copy a union of ranges and then perform one paste. When I learned this, I probably would&#39;ve had the same code as you but no one told me half of what I know today :("}, {"owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476299887, "post_id": 39986880, "comment_id": 67291312, "body": "I just put the new code up in the original question."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476300384, "post_id": 39986880, "comment_id": 67291581, "body": "There is a missing <code>End If </code> that should probably go between <code>j=j+1</code> and <code>next c</code> Yes, it&#39;s due to the if I added, you have to close it off"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476300532, "post_id": 39986880, "comment_id": 67291672, "body": "To not move to kids if * black change the <code>if c.offset ...</code> to <code>if ( c.offset(0, 3) &lt;= 12 and InStr(1, c, &quot;black&quot;, , VbCompareMethod.vbTextCompare) &gt; 0 ) then</code>"}, {"owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476310739, "post_id": 39986880, "comment_id": 67296692, "body": "Thank you for all your help J.  I am not getting the error anymore but it is not copying any of the other data now.  Only the Black that is over 12."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "edited": false, "score": 0, "creation_date": 1476369878, "post_id": 39986880, "comment_id": 67325488, "body": "Sorry about that, see the answer edit, I made a typo in my comment"}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": false, "score": 0, "last_activity_date": 1476369847, "last_edit_date": 1476369847, "creation_date": 1476220616, "answer_id": 39986880, "question_id": 39986691, "link": "https://stackoverflow.com/questions/39986691/vba-copy-row-to-certain-sheet-based-on-cell-data-plus-age-sort/39986880#39986880", "title": "VBA copy row to certain sheet based on cell data plus age sort", "body": "<p>I'm going to stick with your style of coding ... I don't exactly agree with it but here</p>\n\n<pre><code>For Each c In Source.Range(\"b11:b110\")\n    ' new condition to check cell e\n    if ( c.offset(0, 3) &lt;= 12 and Instr(1, c, \"black\", vbcomparemethod.vbtextcompare) &lt;= 0) then \n       Set Target = ActiveWorkbook.Worksheets(\"KIDS NOTES\")\n    elseIf (c = \"6th Black\" Or c = \"5th Black\" Or c = \"4th Black\" Or c = \"3rd Black\" Or c = \"2nd Black\" Or c = \"1st Black\" Or c = \"Jr. Black\") Then\n       Set Target = ActiveWorkbook.Worksheets(\"BLACK\")\n       Source.Rows(c.Row).Copy Target.Rows(j)\n    ...\nenter code here \n</code></pre>\n\n<p>Hopefully someone will upload a more optimized version for you</p>\n"}], "owner": {"reputation": 23, "user_id": 6178754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OLk9r.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6178754/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476369847, "creation_date": 1476219848, "last_edit_date": 1476300216, "question_id": 39986691, "link": "https://stackoverflow.com/questions/39986691/vba-copy-row-to-certain-sheet-based-on-cell-data-plus-age-sort", "title": "VBA copy row to certain sheet based on cell data plus age sort", "body": "<p>I received some help here before and need to update my code.  Right now it takes the row on the \"MASTER\" sheet and copies it to a new sheet (BLACK, 1ST BROWN,...).  I would like it to still do that but also copy it to a second sheet (BLACK NOTES, 1ST BROWN,...) but if (cell e&lt;=12) it copies it to \"KIDS NOTES\" and not the (BLACK NOTES, 1ST BROWN,...)</p>\n\n<p>Thank you</p>\n\n<pre><code>Sub RUN_BEFORE_TEST()\n\n sortlist Macro\n\n  Dim c As Range\n    Dim j As Integer\n    Dim k As Integer\n    Dim l As Integer\n    Dim m As Integer\n    Dim n As Integer\n    Dim o As Integer\n    Dim p As Integer\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n\n    j = 11\n    k = 11\n    l = 11\n    m = 11\n    n = 11\n    o = 11\n    p = 11\n\n    Set Source = ActiveWorkbook.Worksheets(\"master\")\n\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Add _\n        Key:=Range(\"D10:D110\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n        DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Add _\n        Key:=Range(\"C10:C110\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n        DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"B10\").Select\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort.SortFields.Add _\n        Key:=Range(\"B11:B110\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n        CustomOrder:= _\n        \"6th Black,5th Black,4th Black,3rd Black,2nd Black,1st Black,Jr. Black,1st Brown,2nd Brown,3rd Brown\", _\n        DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"MASTER\").ListObjects(\"Table2\").sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nFor Each c In Source.Range(\"b11:b110\")\n        If (c = \"6th Black\" Or c = \"5th Black\" Or c = \"4th Black\" Or c = \"3rd Black\" Or c = \"2nd Black\" Or c = \"1st Black\" Or c = \"Jr. Black\") Then\n           Set Target = ActiveWorkbook.Worksheets(\"BLACK\")\n           Source.Rows(c.Row).Copy Target.Rows(j)\n        ElseIf c = \"1st Brown\" Then\n            Set Target = ActiveWorkbook.Worksheets(\"1ST BROWN\")\n            Source.Rows(c.Row).Copy Target.Rows(k)\n            k = k + 1\n        ElseIf c = \"2nd Brown\" Then\n            Set Target = ActiveWorkbook.Worksheets(\"2ND BROWN\")\n            Source.Rows(c.Row).Copy Target.Rows(l)\n            l = l + 1\n        ElseIf c = \"3rd Brown\" Then\n            Set Target = ActiveWorkbook.Worksheets(\"3RD BROWN\")\n            Source.Rows(c.Row).Copy Target.Rows(m)\n            m = m + 1\n        End If\n\n        j = j + 1\n        Next c\n\nSheets(\"BLACK\").Select\n\nSet oRng = Range(\"b11\")\n\niRow = oRng.Row\niCol = oRng.Column\n\nDo\n'\nIf Cells(iRow + 1, iCol) &lt;&gt; Cells(iRow, iCol) Then\n    Cells(iRow + 1, iCol).EntireRow.Insert shift:=xlDown\n    iRow = iRow + 2\nElse\n    iRow = iRow + 1\nEnd If\n'\nLoop While Not Cells(iRow, iCol).Text = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>Here is your code inserted.  One thing I forgot to mention is that if c=*black I don't want it to move to \"kids\".</p>\n\n<pre><code>For Each c In Source.Range(\"b11:b110\")\n' new condition to check cell e\nIf (c.Offset(0, 2) &lt;= 12) Then\n   Set Target = ActiveWorkbook.Worksheets(\"KIDS BROWN NOTES\")\nElseIf (c = \"6th Black\" Or c = \"5th Black\" Or c = \"4th Black\" Or c = \"3rd Black\" Or c = \"2nd Black\" Or c = \"1st Black\" Or c = \"Jr. Black\") Then\n   Set Target = ActiveWorkbook.Worksheets(\"BLACK\")\n   Source.Rows(c.Row).Copy Target.Rows(j)\n    If (c = \"6th Black\" Or c = \"5th Black\" Or c = \"4th Black\" Or c = \"3rd Black\" Or c = \"2nd Black\" Or c = \"1st Black\" Or c = \"Jr. Black\") Then\n       Set Target = ActiveWorkbook.Worksheets(\"BLACK\")\n       Source.Rows(c.Row).Copy Target.Rows(j)\n    ElseIf c = \"1st Brown\" Then\n        Set Target = ActiveWorkbook.Worksheets(\"1ST BROWN\")\n        Source.Rows(c.Row).Copy Target.Rows(k)\n        k = k + 1\n    ElseIf c = \"2nd Brown\" Then\n        Set Target = ActiveWorkbook.Worksheets(\"2ND BROWN\")\n        Source.Rows(c.Row).Copy Target.Rows(l)\n        l = l + 1\n    ElseIf c = \"3rd Brown\" Then\n        Set Target = ActiveWorkbook.Worksheets(\"3RD BROWN\")\n        Source.Rows(c.Row).Copy Target.Rows(m)\n        m = m + 1\n    End If\n\n    j = j + 1\n    Next c\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "edited": false, "score": 0, "creation_date": 1476220164, "post_id": 39986456, "comment_id": 67252365, "body": "Where you say you have &quot;weeks of the year&quot; that you don&#39;t want to drag across, this implies that each of your weeks is a separate column. It might be easier to flatten your source table (if possible) and add a &quot;week number&quot; column. This will then trivialise your question, since you can just drag the &quot;week number&quot; field across."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1476226054, "creation_date": 1476226054, "answer_id": 39987941, "question_id": 39986456, "link": "https://stackoverflow.com/questions/39986456/adding-set-of-variables-to-different-fields-in-pivot-table-using-vba/39987941#39987941", "title": "Adding set of variables to different fields in pivot table using VBA", "body": "<p>What Jonathan is referring to in his comment is commonly called 'Unpivoting'. Google \"Unpivot\", and you'll find a whole bunch of VBA code that does it for you, including an article I wrote at <a href=\"http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/\" rel=\"nofollow\">http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/</a></p>\n\n<p>(If you elect to use the code from that post, scroll down till you see the words \"Update 26 November 2013\". My code is very complicated, but handles the very rare end-case where the unpivoted dataset is too long to fit on the sheet).</p>\n"}], "owner": {"reputation": 1, "user_id": 7003894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7acdde8a8b2add480afd35c2fe0710b6?s=128&d=identicon&r=PG&f=1", "display_name": "user7003894", "link": "https://stackoverflow.com/users/7003894/user7003894"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476226054, "creation_date": 1476218873, "question_id": 39986456, "link": "https://stackoverflow.com/questions/39986456/adding-set-of-variables-to-different-fields-in-pivot-table-using-vba", "title": "Adding set of variables to different fields in pivot table using VBA", "body": "<p>I am VBA novice trying to add certain variables to the values field (but this question can be expanded to other pivot table fields, like rows or columns fields). </p>\n\n<p>I have weeks of the year that I would like to add all at once using VBA rather than one-by-one by hand (dragging and pulling).</p>\n\n<p>I found the following code online that adds all variables to the values field, but I would like to edit it to be able to copy in a list of variable names to add rather than it add all of them.</p>\n\n<pre><code>Sub AddAllFieldsValues()\n' Adds all fields to Values\n    Dim pt As PivotTable\n    Dim I As Long\n    For Each pt In ActiveSheet.PivotTables\n        For I = 1 To pt.PivotFields.Count\n            With pt.PivotFields(I)\n              If .Orientation = 0 Then .Orientation = xlDataField\n            End With\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Can anyone provide any edits to the above code to answer my question? If it needs further explaining please let me know.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "treeview", "activex", "32bit-64bit"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7186244, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5cf5f7295f6d4f7997a9e95285b03d22?s=128&d=identicon&r=PG", "display_name": "David Andress", "link": "https://stackoverflow.com/users/7186244/david-andress"}, "is_accepted": false, "score": 0, "last_activity_date": 1479668247, "last_edit_date": 1479668247, "creation_date": 1479665436, "answer_id": 40707543, "question_id": 39986385, "link": "https://stackoverflow.com/questions/39986385/treeview-control-becomes-unresponsive-excel-2013-64-bit/40707543#40707543", "title": "Treeview Control becomes unresponsive - Excel 2013 64 Bit", "body": "<p>I encountered the same problem with EXCEL 2016, 32 bit version.  EXCEL does not recognize the embedded TREEVIEW control after saving and reopening the file. (Sometimes it would work on the first save and reopen, but fail on the second.) This problem did not occur with EXCEL 2010 and earlier, same spreadsheet. Like you, I can embed a new TREEVIEW control, name with the name the macro populating uses, i.e., the name originally given to the unresponsive TREEVIEW control.  I did  not have to delete the unresponsive control like you did because EXCEL did not recognize it.  You can check this by going to Develop tab and activating the properties view.</p>\n\n<p>Curiously, I found a couple of workarounds this bug in EXCEL:</p>\n\n<ol>\n<li>When I saved the file while in Developer mode, it opened OK and the TREEVIEW control worked, but you have to run a macro to populate.  So far it works, but who knows....</li>\n<li>When I embedded the TREEVIEW control in a Form, rather than directly in the spreadsheet, it saved and reopened OK, at least so far. No need to be in Developer mode or rerun the populating macro. </li>\n</ol>\n\n<p>Good luck, maybe one of these will work for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 7003511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadcb8fc407c6b80d23648539290c865?s=128&d=identicon&r=PG&f=1", "display_name": "rfb_jax", "link": "https://stackoverflow.com/users/7003511/rfb-jax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 822, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531322034, "creation_date": 1476218548, "last_edit_date": 1531322034, "question_id": 39986385, "link": "https://stackoverflow.com/questions/39986385/treeview-control-becomes-unresponsive-excel-2013-64-bit", "title": "Treeview Control becomes unresponsive - Excel 2013 64 Bit", "body": "<p><strong>My Problem:</strong> Treeview Control 6.0 becomes unresponsive in Excel 2013 64 Bit (Compile Error: Method or Data Member Not Found). I am able to delete the control, insert a new Treeview and it initializes fine (loads Imagelist, allows user configuration of nodes, etc.); however, once I save/close/reopen it becomes unresponsive again. This Excel tool allows users to configure a dashboard using Treeview and it worked fine (still works fine) in Excel 2007. I can include the code to initialize the Treeview control, but it is not a code issue as it works perfectly in Excel 2007.</p>\n\n<p><strong>Attempted Solutions:</strong> I have read through many forums and have tried numerous solutions to fix, but none have fixed the issue...</p>\n\n<ol>\n<li>Running a batch file (as Admin) to unregister/re-register MSCOMCTL.OCX in the correct location</li>\n<li>Deleting all .exd files from my hard drive</li>\n<li>Removing/adding Common Controls reference in VBA editor</li>\n<li>Deleting/Recreating the Treeview numerous times</li>\n<li>Repeating above solutions in every possible order</li>\n</ol>\n\n<p>The strangest part to me is that I can re-create the Treeview (insert, set properties), run code to initialize, and completely configure the Treeview with no issues... it only becomes unresponsive after saving/closing/re-opening. Again, the opening/closing routines worked fine in Excel 2007 so I don't think it is a code issue.</p>\n\n<p>Any help would be greatly appreciated... I need Treeview to work as it stores all of the user dashboard info (TV terminals, files to open/close, etc.).</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476231817, "post_id": 39986146, "comment_id": 67256110, "body": "Proper syntax is Application.WorksheetFunction.IFERROR() etc. Not sure why you want to do it this way, instead of using .Range().Find(), as it takes longer.. Also, if youre trying to dynamically find the last row, something like Sheets(1).Cells(Sheets(1).Rows.Count, 1).End(xlUp).Row might work better."}], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1476218237, "post_id": 39986265, "comment_id": 67251342, "body": "Shouldn&#39;t it be <code>Cells(i, 2)</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476218278, "post_id": 39986265, "comment_id": 67251369, "body": "@arcadeprecinct yes I think so, thanks for catching that"}, {"owner": {"reputation": 3, "user_id": 6945738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c72523d0382c79969318e312ad2d91?s=128&d=identicon&r=PG&f=1", "display_name": "Skudra21", "link": "https://stackoverflow.com/users/6945738/skudra21"}, "edited": false, "score": 0, "creation_date": 1476219250, "post_id": 39986265, "comment_id": 67251888, "body": "Thanks a lot! Works perfectly and also thanks for the information, it will definitely help in the future."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1476218269, "last_edit_date": 1476218269, "creation_date": 1476218041, "answer_id": 39986265, "question_id": 39986146, "link": "https://stackoverflow.com/questions/39986146/vlookup-iferror-in-vba-error-1004/39986265#39986265", "title": "Vlookup + Iferror in VBA error &quot;1004&quot;", "body": "<p>You're getting a 1004 because <code>Sheets(\"Sheet1\").Range(\"i, 2\")</code> is invalid range assignment. </p>\n\n<p>To fix it:</p>\n\n<p><code>Range(\"i, 2\")</code> should be <code>Cells(i, 2)</code></p>\n\n<p><code>Range</code> takes an <em>address</em> argument (e.g., <code>Range(\"A1\")</code> or <code>Range(\"B\" &amp; i)</code>, etc.), <code>Cells</code> takes <em>row</em>/<em>column</em> index arguments (e.g., <code>Cells(1,2)</code>, etc.).</p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 4516719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bbfc4662da4221fe0965c350496f45?s=128&d=identicon&r=PG&f=1", "display_name": "Ali M Irshad", "link": "https://stackoverflow.com/users/4516719/ali-m-irshad"}, "is_accepted": false, "score": 0, "last_activity_date": 1476218140, "creation_date": 1476218140, "answer_id": 39986291, "question_id": 39986146, "link": "https://stackoverflow.com/questions/39986146/vlookup-iferror-in-vba-error-1004/39986291#39986291", "title": "Vlookup + Iferror in VBA error &quot;1004&quot;", "body": "<p>check the range in loop.. it must be string. u r using \"i\" as string it should be there as variable.</p>\n"}], "owner": {"reputation": 3, "user_id": 6945738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c72523d0382c79969318e312ad2d91?s=128&d=identicon&r=PG&f=1", "display_name": "Skudra21", "link": "https://stackoverflow.com/users/6945738/skudra21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 39986265, "answer_count": 2, "score": 0, "last_activity_date": 1476218269, "creation_date": 1476217634, "question_id": 39986146, "link": "https://stackoverflow.com/questions/39986146/vlookup-iferror-in-vba-error-1004", "title": "Vlookup + Iferror in VBA error &quot;1004&quot;", "body": "<p>I have not been able to figure out what is wrong with my script as it seems to be not difficult at all, so I hope that I will find the answer here.</p>\n\n<p>I have two sheets (Sheet1 and Sheet2) where in both are lists that change over time (info from sheet1 gets pased in sheet2 every time). I want to to run vlookup function for every row in Sheet1 and return \"new\" (in 28th column) if the entry does not exist in sheet2.</p>\n\n<p>Something is wrong with the code as I get 1004 error all the time regarding iferror&amp;vlookup function.</p>\n\n<p>Thanks in advance,</p>\n\n<pre><code>Sub vlookup_iferror ()\n Dim i As Integer\n Dim finalrow As Integer\n\n finalrow = Sheets(\"Sheet1\").Range(\"A100000\").End(xlUp).Row\n\n  For i = 2 To finalrow\n  Cells(i, 28) = Application.IfError(Application.VLookup(Sheets(\"Sheet1\").Range(\"i, 2\"), Sheets(\"Sheet2\").Range(\"B:B\"), 1, False), \"New\")\n  Next i\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "export"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1476217028, "post_id": 39985872, "comment_id": 67250682, "body": "Could it be because you wish to process more than 1 million rows and Excel can only store (on any given sheet) no more than 1,048,576 rows? Maybe June 2016 is where Excel reaches the 1 million limit?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1476221836, "post_id": 39985872, "comment_id": 67253201, "body": "To @Ralph&#39;s suggestion, can you place <code>rst.MoveLast</code> and <code>MsgBox rst.RecordCount</code> to see how many records the recordset is holding?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1476232763, "post_id": 39985872, "comment_id": 67256323, "body": "Alternatively, you can use the ` ADODB.Recordset.GetRows()` method to get an array of the data that you can write to the worksheet."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476263907, "post_id": 39985872, "comment_id": 67267617, "body": "The query gets the data for one day only, with 220k records per month that&#39;s in the magnitude of 10k records per day, so it&#39;s a long way from 1 million."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476263958, "post_id": 39985872, "comment_id": 67267653, "body": "@Selim: So your query gets n records for <code>start_date</code> &lt; &quot;middle of June&quot;, and zero records for later dates? -- To make sure it&#39;s not a problem with the parameter datatype, add <code>PARAMETERS start_date DateTime;</code> before your SELECT query."}, {"owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476271156, "post_id": 39985872, "comment_id": 67272281, "body": "To @nbayly - added rst.movelast and message box with rst.recordcount; it turns out that the query does extract the correct number of records for any given date; that means the problem comes from pasting the data into excel;"}, {"owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1476271242, "post_id": 39985872, "comment_id": 67272323, "body": "To @Ralph - I actually extract records only for a single day, which is as pointed below is in the range of 10k records; this number shouldn&#39;t be a problem for Excel"}, {"owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476271428, "post_id": 39985872, "comment_id": 67272438, "body": "To @Andre - seems like the query is getting the records, since I was able to to do several correct record counts; pasting in Excel seems to be the problem;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476273767, "post_id": 39985872, "comment_id": 67273914, "body": "Interesting... What exactly happens for a day where it doesn&#39;t work? The Excel sheet stays completely empty? Is there a runtime error? Make sure you don&#39;t have <code>On Error Resume Next</code> somewhere before your code, if in doubt, add <code>On Error Goto 0</code> before the Excel part starts."}, {"owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476283715, "post_id": 39985872, "comment_id": 67281056, "body": "@Andre - it just opens the excel template without any records in it"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "is_accepted": false, "score": 0, "last_activity_date": 1476814531, "creation_date": 1476814531, "answer_id": 40115257, "question_id": 39985872, "link": "https://stackoverflow.com/questions/39985872/vba-procedure-returns-results-only-up-to-a-certain-date/40115257#40115257", "title": "VBA procedure returns results only up to a certain date", "body": "<p>first of all I'd like to thank everybody who contributed. \nMy database was created on Access 2016 and I was running it on another pc, with Access 2013. This is where it was returning records only to a certain date. After moving it to a pc with Access 2016, it worked as expected, but was running excel only on the background with all applicable records in the exported file. At that point I moved the line xl.Visible = true below the line xl.workbooks.open. That worked like a charm. </p>\n"}], "owner": {"reputation": 53, "user_id": 7003683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d9fc2c1fbbd21ebce7ad3e15396f07?s=128&d=identicon&r=PG&f=1", "display_name": "Selim", "link": "https://stackoverflow.com/users/7003683/selim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1476814531, "creation_date": 1476216589, "last_edit_date": 1476234805, "question_id": 39985872, "link": "https://stackoverflow.com/questions/39985872/vba-procedure-returns-results-only-up-to-a-certain-date", "title": "VBA procedure returns results only up to a certain date", "body": "<p>everyone. I have a procedure that extracts certain data on a daily basis from a large table and then pastes this data to an excel file. The source table contains about 2 million records(starting from 01.10.2015 up to 09.09.2016) and growing at a pace of 220k records per month. The below procedure extracts successfully the data I need only up to the middle of June, 2016. From that point on, it cannot extract any data. Running a regular query does show that the data is there. Opening the table also shows the same result - data is available up to 09.09.2016). I would think there is some other problem with the code, but it does work correctly on another table. It works on this one as well, but cannot think of a reason why it won't find records past the middle of June 2016. I indexed the date field, which is my parameter for extracting records, but that didn't help. Any help and suggestions are highly appreciated. Thanks for your time. Here is my code: </p>\n\n<pre><code>Dim xl As Excel.Application\nDim wb As Excel.Workbook\nDim xs As Excel.Worksheet\nDim rng As Excel.Range\nDim c_range As Excel.Range\n\n\nDim dbs As DAO.Database\nDim qdf As DAO.QueryDef\nDim rst As DAO.Recordset\nDim strsql As String\n\nstrsql = \"SELECT tblTraderExecutions.exec_id, tblTraderExecutions.exec_date, tblTraderExecutions.exec_time, tblTraderExecutions.empty, tblTraderExecutions.exec_string, tblTraderExecutions.internal_order_id, tblTraderExecutions.trading_account, \" &amp; _\n\"tblTraderExecutions.trading_account, tblTraderExecutions.operation_bg, tblTraderExecutions.empty, tblTraderExecutions.empty, tblTraderExecutions.symbol, tblTraderExecutions.symbol, tblTraderExecutions.price, tblTraderExecutions.quantity, \" &amp; _\n\"tblTraderExecutions.currency, ROUND(tblTraderExecutions.total_comm,2), tblTraderExecutions.empty, Round((tblTraderExecutions.quantity * tblTraderExecutions.price),2), Round((tblTraderExecutions.quantity * tblTraderExecutions.price),2), \" &amp; _\n\"tblTraderExecutions.trade_broker, tblTraderExecutions.contra, tblTraderExecutions.accept_broker FROM tblTraderExecutions \" &amp; _\n\"WHERE [exec_date] = [start_date] ORDER BY [tblTraderExecutions].[exec_id]\"\nSet dbs = CurrentDb\nSet qdf = dbs.CreateQueryDef(vbNullString, strsql)\nqdf.Parameters(\"start_date\").Value = Forms!frmPropReports!txtDate\nSet rst = qdf.OpenRecordset\n\nSet xl = New Excel.Application\nxl.Visible = True\nSet wb = xl.Workbooks.Open(\"D:\\mpuls\\trader_executions_export.xlsx\")\nSet ws = wb.Worksheets(\"DNEVNICI\")\nSet rng = ws.Range(\"a8\")\nrng.CopyFromRecordset rst\n\nSet c_range = ws.Range(\"c8:c65000\")\nc_range.NumberFormat = \"h:mm:ss;@\"\n\nrst.Close\nqdf.Close\nSet qdf = Nothing\n\nSet rst = Nothing\nSet dbs = Nothing\n</code></pre>\n"}, {"tags": ["database", "vba", "validation", "ms-access", "relational-database"], "comments": [{"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 2, "creation_date": 1476216492, "post_id": 39985715, "comment_id": 67250385, "body": "you need to separate the autonumber function from the display purpose.  You need a numeric (long integer) field for referential integrity purposes, but when you&#39;re displaying the ID on a report (prettyID), then you can append your prefix.  Don&#39;t store your ID pretty, just display it pretty."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1476218434, "post_id": 39985715, "comment_id": 67251459, "body": "My only concern is that this will be utilized by our data entry team, so a tiny discretion in appearance and the back end may cause issues. It was explicitly requested of me that I include the prefix &quot;c&quot; or whatever other letter denotes the table content. I&#39;ve changed all of my foreign key fields to Number data type, and it&#39;s working for now, but I&#39;m not sure if it&#39;s the optimal solution."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 1, "creation_date": 1476218876, "post_id": 39985715, "comment_id": 67251694, "body": "no, if you&#39;re using the column&#39;s property to &#39;pretty&#39; your output, you should be good, but the underlying data type is numeric across the board.  Access is basically making it easy for you."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476218959, "post_id": 39985715, "comment_id": 67251734, "body": "yes it is the optimal solution. leave it as auto-number and change other table&#39;s fields as number. it should be fine!"}, {"owner": {"reputation": 50532, "user_id": 15354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca5a87d982422410d9f14aa89c0a842?s=128&d=identicon&r=PG", "display_name": "onedaywhen", "link": "https://stackoverflow.com/users/15354/onedaywhen"}, "edited": false, "score": 0, "creation_date": 1476347018, "post_id": 39985715, "comment_id": 67308767, "body": "Create a new table <code>NextClientId</code>, with a single column <code>ClientID</code> and a constraint to ensure there can never be more than one row in this table. Insert that one row using the value of the next unused <code>ClientID</code> in the sequence e.g. <code>C0003</code>. Now you need some procedural code that 1) locks the row/table, 2) grabs the stored <code>ClientID</code> value (<code>C0003</code>) into a variable, 3) increments the stored <code>ClientID</code> value (<code>C0004</code>), 4) unlocks the row/table, 5) returns the grabbed value (<code>C0003</code>). You can&#39;t do this in an Access SQL stored procedure, but maybe in one of those new trigger macro thingys?"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476216024, "creation_date": 1476216024, "question_id": 39985715, "link": "https://stackoverflow.com/questions/39985715/data-type-is-preventing-relationship-creation-in-access", "title": "Data type is preventing relationship creation in Access", "body": "<p>So I have a table named \"Client\" where the ClientID is the Primary Key and the Data Type is an AutoNumber, but I formatted it as \\C00 so instead of \"001\" or \"002\" the record appears as \"C001\" or \"C002\".</p>\n\n<p>I expected Access to essentially change the data type from AutoNumber to Short Text because of the formatting, since it's basically concatenation.</p>\n\n<p>So the issue comes when trying to create a relationship between ClientID in the Client table and ClientID in any other, because I have the Data Type set as Short Text everywhere else.</p>\n\n<p>Is there a way around this? I can't have the primary key for all of my tables be auto-generated alone, I need them to have a letter prefix. Unless someone can suggest a more efficient manner of accomplishing that.</p>\n\n<p>Thanks folks!</p>\n"}, {"tags": ["excel", "vba", "ms-office"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476216671, "post_id": 39985473, "comment_id": 67250489, "body": "<i>at best awful and at worst simply do not work</i> - are you overlapping form controls? If so, that isn&#39;t best-practice. If not, then a work-around could be to set the backcolor to the same value as the form. That said, that&#39;s some scary glitch indeed!"}, {"owner": {"reputation": 11, "user_id": 7003517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abd7ca10bdeaff6b9b0849eae6a0e46?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Halksworth", "link": "https://stackoverflow.com/users/7003517/nick-halksworth"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476217212, "post_id": 39985473, "comment_id": 67250795, "body": "Scary indeed - this was fist notified to me by one of my customers, who happens to be Microsoft which is kind of ironic."}], "answers": [{"comments": [{"owner": {"reputation": 2434, "user_id": 3684653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyLtW.jpg?s=128&g=1", "display_name": "Isuka", "link": "https://stackoverflow.com/users/3684653/isuka"}, "edited": false, "score": 0, "creation_date": 1477249541, "post_id": 40206627, "comment_id": 67677843, "body": "When giving a link as an answer, try to extract the important information from it so people can see directly what you are referring to. :)"}, {"owner": {"reputation": 1, "user_id": 7061434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210384490039229/picture?type=large", "display_name": "Lance Phillips", "link": "https://stackoverflow.com/users/7061434/lance-phillips"}, "reply_to_user": {"reputation": 2434, "user_id": 3684653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyLtW.jpg?s=128&g=1", "display_name": "Isuka", "link": "https://stackoverflow.com/users/3684653/isuka"}, "edited": false, "score": 0, "creation_date": 1477262595, "post_id": 40206627, "comment_id": 67681580, "body": "This error is so far reaching I thought the link was the best way to go. Here is one of the main responses which suggest that MS might fix it."}, {"owner": {"reputation": 1, "user_id": 7061434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210384490039229/picture?type=large", "display_name": "Lance Phillips", "link": "https://stackoverflow.com/users/7061434/lance-phillips"}, "reply_to_user": {"reputation": 2434, "user_id": 3684653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyLtW.jpg?s=128&g=1", "display_name": "Isuka", "link": "https://stackoverflow.com/users/3684653/isuka"}, "edited": false, "score": 1, "creation_date": 1477262601, "post_id": 40206627, "comment_id": 67681584, "body": "Posted Friday, October, 2016 10:12 PM Hi everyone,  The team has checked in a fix for the BackStyle/transparency issue. They&#39;ve also fixed (or are in the progress of fixing) several other forms-related issues that occurred after recent Office updates. When these fixes get released, I&#39;ll come back to this thread and let you know.  Anneliese"}], "tags": [], "owner": {"reputation": 1, "user_id": 7061434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210384490039229/picture?type=large", "display_name": "Lance Phillips", "link": "https://stackoverflow.com/users/7061434/lance-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1477248702, "creation_date": 1477248702, "answer_id": 40206627, "question_id": 39985473, "link": "https://stackoverflow.com/questions/39985473/office-vba-controls-transparacy-not-working-since-october-2016-office-update/40206627#40206627", "title": "Office VBA controls transparacy not working since October 2016 office update", "body": "<p>Office introduced a major bug in October that influences VBA behavior. The following link explains the situation in more detail.</p>\n\n<p><a href=\"https://social.technet.microsoft.com/Forums/office/en-US/9796fd67-e65c-4086-a2db-b990a17077b8/office-vba-controls-transparacy-not-working-since-october-2016-office-update?forum=Office2016ITPro\" rel=\"nofollow\">https://social.technet.microsoft.com/Forums/office/en-US/9796fd67-e65c-4086-a2db-b990a17077b8/office-vba-controls-transparacy-not-working-since-october-2016-office-update?forum=Office2016ITPro</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7003517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abd7ca10bdeaff6b9b0849eae6a0e46?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Halksworth", "link": "https://stackoverflow.com/users/7003517/nick-halksworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477248702, "creation_date": 1476215076, "last_edit_date": 1476262223, "question_id": 39985473, "link": "https://stackoverflow.com/questions/39985473/office-vba-controls-transparacy-not-working-since-october-2016-office-update", "title": "Office VBA controls transparacy not working since October 2016 office update", "body": "<p>It appears that the latest Office update (Version 1609 (Build 7369.2024))\nreleased in September or October has made it impossible (without using windows APIs) to switch some control backstyles to transparent (i.e. labels/ checkboxes/ option buttons etc.) </p>\n\n<p>I have managed to find one other post on MSDN relating to this issue which can be found at the following link (but without resolution):</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/en-US/608e9a9b-69a2-44b3-8ab4-10fe2fe1c04e/no-more-transparent-labels-on-vba-userforms?forum=officegeneral\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/en-US/608e9a9b-69a2-44b3-8ab4-10fe2fe1c04e/no-more-transparent-labels-on-vba-userforms?forum=officegeneral</a></p>\n\n<p>This problem relates to Excel and Word as a minimum as that is all I have tested but would guess the same goes for all office VBA applications.</p>\n\n<p>Now - as you might imagine, this has put me in a bit of a pickle as I use transparent labels etc. throughout my applications and as a result, forms now look at best awful and at worst simply do not work. </p>\n\n<p>Has anyone got a fix or any further information on this?</p>\n\n<p>Thanks in advance</p>\n\n<p>Nick</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1476217159, "post_id": 39985372, "comment_id": 67250769, "body": "Is it VB.Net or VBA? Please correct tags accordingly"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476229959, "post_id": 39986225, "comment_id": 67255713, "body": "What (in the OP&#39;s original code) makes the <code>Or</code> <i>not</i> a logical operator (though I can&#39;t tell if your answer really states that)?  Seems like logical vs. bitwise would depend on the types of variable involved ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1476230178, "post_id": 39986225, "comment_id": 67255759, "body": "@TimWilliams AFAIK that&#39;s correct: these operators are <i>logical</i> operators when they&#39;re involved in a <i>Boolean expression</i>, and <i>bitwise</i> operators otherwise (with the operands possibly implicitly converted to long integers). Bitwise operations are commonly used to determine whether a flag is &quot;on&quot; when dealing with combined enum values, for example."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476231993, "post_id": 39986225, "comment_id": 67256164, "body": "@TimWilliams actually the distinction between &quot;logical&quot; and &quot;bitwise&quot; operators seems pretty artificial when you consider that <code>11111111 11111111 11111111 11111111</code> (aka -1/<code>True</code>) <code>And 0</code> (aka <code>False</code>) gives you 0 either way, and <code>11111111 11111111 11111111 11111111 Or 0</code> gives you -1/<code>True</code> either way as well: in the end <i>everything</i> is bitwise ;-)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476232101, "post_id": 39986225, "comment_id": 67256183, "body": "Yes I thought that would be the logical conclusion of following that path... ;-)"}, {"owner": {"reputation": 327, "user_id": 1432736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/grUsH.jpg?s=128&g=1", "display_name": "donutguy640", "link": "https://stackoverflow.com/users/1432736/donutguy640"}, "edited": false, "score": 2, "creation_date": 1476237635, "post_id": 39986225, "comment_id": 67257345, "body": "Your answer...makes sense in VB&#39;s occasional total-nonsense kind of way that I&#39;m learning to hate O_o idk, hopefully it made sense at the time? Regardless, thank you for clearing it up."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1476237854, "post_id": 39986225, "comment_id": 67257384, "body": "@TimWilliams - It depends on the type of the variable it is being assigned to.  There&#39;s an implicit cast if a bitwise <code>Or</code> result is assigned to a <code>Boolean</code>.  It doesn&#39;t get cast if it&#39;s being assigned to a numeric type."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1476219485, "last_edit_date": 1476219485, "creation_date": 1476217920, "answer_id": 39986225, "question_id": 39985372, "link": "https://stackoverflow.com/questions/39985372/vba-assignment-statement-with-an-or-clause/39986225#39986225", "title": "VBA assignment statement with an OR clause", "body": "<h2>What it's <em>not</em>.</h2>\n\n<p>There is no ternary operator in VBA. The closest you get is <code>IIf</code>, which evaluates both <em>true</em> and <em>false</em> expressions (so don't use it when either branch has side-effects!):</p>\n\n<pre><code>IIf({bool-expression}, {value-if-true}, {value-if-false})\n</code></pre>\n\n<p>So it's not anything like a ternary.</p>\n\n<p>We don't know what's in <code>array(index)</code>, but let's assume it's some <code>Long</code>:</p>\n\n<pre><code>array(index) = SomeLongInteger Or variable\n</code></pre>\n\n<p>What you're looking at is a regular assignment:</p>\n\n<pre><code>foo = 42 Or variable\n</code></pre>\n\n<p>The runtime is going to assign <code>foo</code> with a value. So first it must compute the right-hand side of the assignment (<code>=</code>) operator:</p>\n\n<pre><code>42 Or Variable\n</code></pre>\n\n<p>The <code>Or</code> operator is often used as a <em>logical operator</em> in <em>Boolean expressions</em>.</p>\n\n<p>However the above expression isn't a <em>Boolean expression</em>, and the <code>Or</code> operator isn't a <em>logical operator</em> here.</p>\n\n<hr>\n\n<h2>What it <em>is</em>.</h2>\n\n<p>It's a <strong>bitwise operator</strong> (in VB the logical and bitwise operators are the same, which is indeed a bit (pun not intended) confusing). In the assignment <code>foo = 42 Or Variable</code>, <code>foo</code> will take the value of the <em>bitwise comparison</em> of <code>42 Or Variable</code>.</p>\n\n<pre><code>Debug.Print 42 Or 12 'prints 46\n</code></pre>\n\n<hr>\n\n<h3>How?</h3>\n\n<p>Think in binary. This is 42:</p>\n\n<pre><code>00101010\n</code></pre>\n\n<p>This is 12:</p>\n\n<pre><code>00001100\n</code></pre>\n\n<p>Then you <em>bitwise-or</em> the two values (remember your <em>truth tables</em>? <code>True Or True = True</code>; <code>True Or False = True</code>; <code>False Or False = False</code>) and you get this:</p>\n\n<pre><code>00101110\n</code></pre>\n\n<p>..which is the binary representation for - that's right - 46.</p>\n\n<hr>\n\n<p>So, <code>array(index) = array(index) Or variable</code> does the following:</p>\n\n<ul>\n<li>Read the value of <code>array(index)</code></li>\n<li>Read the value of <code>variable</code></li>\n<li>Bitwise-Or the two values</li>\n<li>Assign the result of that operation back to <code>array(index)</code></li>\n</ul>\n"}], "owner": {"reputation": 327, "user_id": 1432736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/grUsH.jpg?s=128&g=1", "display_name": "donutguy640", "link": "https://stackoverflow.com/users/1432736/donutguy640"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 39986225, "answer_count": 1, "score": 2, "last_activity_date": 1476238059, "creation_date": 1476214806, "last_edit_date": 1495540840, "question_id": 39985372, "link": "https://stackoverflow.com/questions/39985372/vba-assignment-statement-with-an-or-clause", "title": "VBA assignment statement with an OR clause", "body": "<p>I've come across some code that looks something like this </p>\n\n<pre><code>If (condition) Then\n    array(index) = array(index) Or variable\nEnd If\n</code></pre>\n\n<p>Being unfamiliar with VB, it looks to me like some kind of horrid result of a love affair between an assignment statement and a condition clause.</p>\n\n<p>Functionally, I thought it looked like some kind of ?: ternary operation. I now assume it is, though certainly not in a form I'm used to.</p>\n\n<p>I'm aware that the first branch will assign array(index) to itself, that's essentially how the code I'm working on works. I don't THINK it's relevant to the question, but it kinda weirds me out, and there is often more going on than what I realize with VB.</p>\n\n<p>Not a duplicate of <a href=\"https://stackoverflow.com/questions/576431/is-there-a-conditional-ternary-operator-in-vb-net\">Is there a conditional ternary operator in VB.NET?</a> since that question is asking if there IS one, rather than \"what the heck does this mean\"</p>\n"}, {"tags": ["excel", "vba", "form-fields"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6145225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/786246c244194e500231776f4af26ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Shultz", "link": "https://stackoverflow.com/users/6145225/chuck-shultz"}, "is_accepted": false, "score": 0, "last_activity_date": 1476215079, "creation_date": 1476215079, "answer_id": 39985475, "question_id": 39985027, "link": "https://stackoverflow.com/questions/39985027/word-vba-renaming-drop-down-form-fields/39985475#39985475", "title": "Word VBA Renaming Drop-Down Form Fields?", "body": "<p>Found it. I was chasing my tail for quite a while, but I found that this works.</p>\n\n<pre><code>ThisDocument.Unprotect strSheetPassword\nSelection.Shading.BackgroundPatternColor = wdColorLightGreen\nThisDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, Password:=strSheetPassword\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6145225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/786246c244194e500231776f4af26ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Shultz", "link": "https://stackoverflow.com/users/6145225/chuck-shultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476215079, "creation_date": 1476213532, "question_id": 39985027, "link": "https://stackoverflow.com/questions/39985027/word-vba-renaming-drop-down-form-fields", "title": "Word VBA Renaming Drop-Down Form Fields?", "body": "<p>I have a set of 6 tables in a password-protected Word document. Each table has a header row, followed by at least one data row. The 6th column of the second (and subsequent) rows has a drop-down form field in it. There is a button above each table that allows the user to add a row to the table. When they do so, the 6th column contains another drop-down.</p>\n\n<p>After the user selects a value in the drop-down and leaves the field, I need to color that cell, based on the selected value. I can set the OnExit value to run a macro I call \"HighlightStatus\". To get the reference to the cell to change, I am using</p>\n\n<pre><code>Dim ff As Word.FormField\nThisDocument.Unprotect strSheetPassword\nSet ff = ThisDocument.FormFields(Selection.Bookmarks(1).Name)\n</code></pre>\n\n<p>How do I reference the cell that contains this form field?</p>\n\n<p>The other problem is that when I add a row to the table, I need to set the Name of the form field to a unique one, so that I can reference the field that was just updated. But the Name property seems to be read-only.</p>\n\n<p>I took another approach, that basically runs into the same wall. After updating the field, I had the code loop through all the tables and all of the rows, and update the 6th column of each row. The problem is that the screen scrolls down to the end of the document. To get back to where I was, I still need to uniquely reference the correct form field, which I can't do if the field doesn't have a unique name.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1476214330, "post_id": 39985135, "comment_id": 67249219, "body": "Related: always specify <code>Option Explicit</code>. <code>CompareMethod.Text</code> would have popped as an undeclared identifier, which should have been OP&#39;s first clue."}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": true, "score": 2, "last_activity_date": 1476213981, "creation_date": 1476213981, "answer_id": 39985135, "question_id": 39984955, "link": "https://stackoverflow.com/questions/39984955/vba-deleting-words-after-string/39985135#39985135", "title": "VBA Deleting words after String", "body": "<p>Change <code>CompareMethod.Text</code> to <code>VbCompareMethod.vbTextCompare</code></p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "is_accepted": false, "score": 0, "last_activity_date": 1476214612, "creation_date": 1476214612, "answer_id": 39985305, "question_id": 39984955, "link": "https://stackoverflow.com/questions/39984955/vba-deleting-words-after-string/39985305#39985305", "title": "VBA Deleting words after String", "body": "<p>I also ended up fixing it by simply getting rid of the \"CompareMethod.Text\" entirely</p>\n"}], "owner": {"reputation": 127, "user_id": 4318590, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f33eb37c6b4b734ada8eeef001980926?s=128&d=identicon&r=PG&f=1", "display_name": "Adit2789 ", "link": "https://stackoverflow.com/users/4318590/adit2789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 39985135, "answer_count": 2, "score": 0, "last_activity_date": 1476214612, "creation_date": 1476213223, "question_id": 39984955, "link": "https://stackoverflow.com/questions/39984955/vba-deleting-words-after-string", "title": "VBA Deleting words after String", "body": "<p>I am trying to delete all words after the first occurrence of an open parentheses in all cells starting from cell D14. I keep coming up with a Object Required error, and not sure where the issue lies.</p>\n\n<pre><code>Dim startRow As Integer\nDim pos_of_parenth As Integer\nDim resultString as String\n\nstartRow = 15\n\nWith Windows(NewTemplateName)\n    .Activate\n    .ActiveSheet.Range(\"D\" &amp; startRow).Select\n    Do While .ActiveSheet.Range(\"D\" &amp; startRow).Value &lt;&gt; \"\"\n        resultString = \"\"\n        pos_of_parenth = InStr(1, ActiveSheet.Range(\"D\" &amp; startRow).Text, \"(\", CompareMethod.Text)\n        resultString = Left(.ActiveSheet.Range(\"D\" &amp; startRow).Value, pos_of_parenth)\n        startRow = startRow + 1\n    Loop\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "mdx", "powerquery"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5062948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/490debf8b436c92fc16a0088e7be78f5?s=128&d=identicon&r=PG&f=1", "display_name": "tylerpol", "link": "https://stackoverflow.com/users/5062948/tylerpol"}, "edited": false, "score": 0, "creation_date": 1476217463, "post_id": 39985214, "comment_id": 67250931, "body": "Thanks! So if the cell I want to use as the value is on &quot;Sheet1&quot; and cell B2, how would that look?"}, {"owner": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "reply_to_user": {"reputation": 11, "user_id": 5062948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/490debf8b436c92fc16a0088e7be78f5?s=128&d=identicon&r=PG&f=1", "display_name": "tylerpol", "link": "https://stackoverflow.com/users/5062948/tylerpol"}, "edited": false, "score": 0, "creation_date": 1476222764, "post_id": 39985214, "comment_id": 67253612, "body": "Depends on the query name. You can use &quot;From Table&quot; in the ribbon to get the value of the cell into Power Query. That creates a query (let&#39;s call it Query1) with the value in a table cell You can then drill down into the cell to get its value, and then reference Query1 whenever you want to use that value."}], "tags": [], "owner": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "is_accepted": false, "score": 2, "last_activity_date": 1476214296, "creation_date": 1476214296, "answer_id": 39985214, "question_id": 39984381, "link": "https://stackoverflow.com/questions/39984381/use-vba-to-define-dymanic-mdx-parameters-in-power-query/39985214#39985214", "title": "Use VBA to Define Dymanic MDX Parameters in Power Query", "body": "<p>You can combine text values in the Power Query language using the &amp; operator, like <code>\"[Table].[ID].&amp;[\" &amp; CellValue &amp; \"])\"</code>. If you do use this method you may have to turn off privacy levels, and you should make sure that you either trust the values coming from the cells or properly encode those values by doubling the ] character (you can use <code>Text.Replace(CellValue, \"]\", \"]]\")</code> to do this).</p>\n"}], "owner": {"reputation": 11, "user_id": 5062948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/490debf8b436c92fc16a0088e7be78f5?s=128&d=identicon&r=PG&f=1", "display_name": "tylerpol", "link": "https://stackoverflow.com/users/5062948/tylerpol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476214296, "creation_date": 1476211096, "last_edit_date": 1476211661, "question_id": 39984381, "link": "https://stackoverflow.com/questions/39984381/use-vba-to-define-dymanic-mdx-parameters-in-power-query", "title": "Use VBA to Define Dymanic MDX Parameters in Power Query", "body": "<p>I have a power query connection to a Tabular data model. I have some MDX that runs and would like to pass a value in the WHERE statement to the MDX from the value of a cell. Any ideas on how to do this? I set the Power Query procedure up before to grab the value of the cell and use that as a filter by pulling it in through a second procedure, but that method does not work when I use that named range in the MDX.</p>\n\n<p>Essentially I have a \"... WHERE ( [Table].[ID].&amp;[123] )\" and I want to \"123\" part to be replaced with the value in cell A1 each time I refresh the process.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1476211409, "post_id": 39984201, "comment_id": 67247502, "body": "Have your tried <code>Application.DisplayAlerts = False</code> ?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476213531, "post_id": 39984201, "comment_id": 67248767, "body": "Be sure to set <code>Application.DisplayAlerts = True</code> at the end of your routine :)"}], "owner": {"reputation": 1, "user_id": 7003208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a20db5915b2f4286e83d1a3a5563fea?s=128&d=identicon&r=PG&f=1", "display_name": "Bhiggz", "link": "https://stackoverflow.com/users/7003208/bhiggz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476243317, "creation_date": 1476210525, "question_id": 39984201, "link": "https://stackoverflow.com/questions/39984201/how-to-automatically-hit-ok-box-when-opening-a-workbook-from-sharepoint", "title": "How to automatically hit &quot;OK&quot; box when opening a workbook from SharePoint", "body": "<p>My team stores their EOM reports on SharePoint. The macro to pull all the files and compile them is complete. The only pain is that when every workbook opens there is a pop up box that says \"You are opening from an untrusted source, are you sure you want to open?\" I want My VBA code to automatically hit ok or ignore this so I don't have to hit OK for each team member (There are 17). I know I can add it as a trusted source, but sometimes others will need to run this report from their laptop. Suggestions?</p>\n"}, {"tags": ["linux", "vba", "visual-studio", "vim", "macros"], "comments": [{"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1476213320, "post_id": 39983873, "comment_id": 67248648, "body": "How about adding some example code that illustrates the problem. Good luck."}, {"owner": {"user_type": "does_not_exist", "display_name": "user277465"}, "reply_to_user": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1476213837, "post_id": 39983873, "comment_id": 67248949, "body": "I&#39;ve added in an edit that hopefully makes the problem clearer."}, {"owner": {"reputation": 630, "user_id": 1121933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDKbl.jpg?s=128&g=1", "display_name": "Jair L&#243;pez", "link": "https://stackoverflow.com/users/1121933/jair-l%c3%b3pez"}, "edited": false, "score": 0, "creation_date": 1476274134, "post_id": 39983873, "comment_id": 67274137, "body": "You may be better served at <a href=\"http://vi.stackexchange.com/\">Vi and Vim</a>"}], "answers": [{"tags": [], "owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "is_accepted": false, "score": 2, "last_activity_date": 1476267216, "creation_date": 1476267216, "answer_id": 39996050, "question_id": 39983873, "link": "https://stackoverflow.com/questions/39983873/vim-how-to-use-config-to-dim-lines-that-are-not-compiled-in/39996050#39996050", "title": "Vim: How to use .config to dim lines that are not compiled in", "body": "<p>The <a href=\"http://www.vim.org/scripts/script.php?script_id=7\" rel=\"nofollow\">ifdef plugin</a> provides such dimmed syntax highlighting. You can define this in multiple ways. From its description:</p>\n\n<blockquote>\n  <p>Provides highlighting for  #ifdef  #ifndef  #else  #endif  blocks, with the ability to mark a symbol as defined or undefined.\n  Handles nesting of #ifdefs (and #if) as well, but does not handle  #if defined().</p>\n  \n  <p>Supports vim_ifdef:  modelines and .defines (_defines for win16/win32s) files to specify defined/undefined symbols.</p>\n  \n  <p>use :Define   or  :Undefine      to dynamically specify defined or undefined sections.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user277465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1476271580, "creation_date": 1476209455, "last_edit_date": 1476271580, "question_id": 39983873, "link": "https://stackoverflow.com/questions/39983873/vim-how-to-use-config-to-dim-lines-that-are-not-compiled-in", "title": "Vim: How to use .config to dim lines that are not compiled in", "body": "<p>When reading the linux kernel source code in Vim, is there any way to tell the editor that there is a <code>.config</code> file at a certain location, and that it is to dim lines that are within macro guards that cause it to not be compiled into the kernel?</p>\n\n<p>If not, what do you do to solve the problem when reading source code? I use vim, ctags and cscope, but I end up looking into code that is not compiled into the final binary image as I had not noticed macro guards. Is there a way to avoid this?</p>\n\n<p>[EDIT]</p>\n\n<p>As an example, the <code>.config</code> file lets say I have the following config value.</p>\n\n<pre><code>...\nCONFIG_TEST_BLAH\n...\n</code></pre>\n\n<p>Later on, in one of the C files I have :-</p>\n\n<pre><code>#ifdef CONFIG_TEST_BLAH\nvoid test () {\n...\n...\n}\n#else\nvoid test() {\n...\n...\n}\n#endif\n</code></pre>\n\n<p>In this case I'd like the block of code inside the <code>#else</code> block to be intented or colored differently so that I know its not being compiled into the final kernel image.</p>\n\n<p>[EDIT 2]</p>\n\n<p>I believe editors such as Visual Studio allow for this to happen, I'm wondering if there is a way to do this with vim.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476209652, "post_id": 39983846, "comment_id": 67246474, "body": "this may not be related to your problem but <i>&quot;the first 5 letters of last name&quot;</i> would be <code>newLastName = Left(lastName,5)</code>"}, {"owner": {"reputation": 70, "user_id": 6901300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eafbbe603863698a441231c32da06b92?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/6901300/andrew-lee"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476209999, "post_id": 39983846, "comment_id": 67246650, "body": "Oh yea  thats right"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1476209745, "creation_date": 1476209745, "answer_id": 39983958, "question_id": 39983846, "link": "https://stackoverflow.com/questions/39983846/type-mismatch-excel-outlook-vba/39983958#39983958", "title": "Type mismatch Excel/Outlook vba", "body": "<p>instead of</p>\n\n<pre><code>If (lastName &gt;= 5) Then\n</code></pre>\n\n<p>you must use</p>\n\n<pre><code>If (Len(lastName) &gt;= 5) Then\n</code></pre>\n\n<p>and the likes</p>\n\n<pre><code>Public Function userNameBuilder(ByVal firstName As String, ByVal lastName As String) As String\n    Dim newLastName As String\n    Dim newUserName As String\n    If (Len(lastName) &gt;= 5) Then\n        newLastName = Left(lastName, 5)\n        userNameBuilder = (newLastName &amp; Left(firstName, 1))\n    ElseIf (Len(lastName) &lt; 5 &amp;&amp; Len(lastName) &gt; 0) Then\n        userNameBuilder = lastName &amp; Left(firstName, 5 - (Len(lastName)))\n    Else\n        userNameBuilder = vbNullString\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 6901300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eafbbe603863698a441231c32da06b92?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/6901300/andrew-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 39983958, "answer_count": 1, "score": 1, "last_activity_date": 1476209745, "creation_date": 1476209404, "question_id": 39983846, "link": "https://stackoverflow.com/questions/39983846/type-mismatch-excel-outlook-vba", "title": "Type mismatch Excel/Outlook vba", "body": "<p>What I want is the macro to put: first name | last name | username</p>\n\n<p>I am getting an error when calling the userNameBuilder function even though it is returning a string and expecting a string</p>\n\n<pre><code>Dim firstName, lastName As String\nSet sh = ActiveSheet\nDim counter = 0\nFor Each entry In exUser.GetDirectReports() 'exUser is an exchangeUser\n    counter = counter + 1\n    firstName = entry.GetExchangeUser.firstName\n    lastName = entry.getExchangeUser.lastName\n    sh.Cells(counter, 1).value = firstName \n    sh.Cells(counter, 2).value = lastName\n    sh.Cells(counter, 3).value = userNameBuilder(firstName, lastName) \nNext\n</code></pre>\n\n<p>Here is my userNameBuilder function that the code is complaining.</p>\n\n<p>When I comment out \"sh.Cells(counter, 3).value = userNameBuilder(firstName, lastName)\" then the code runs fine, just doesn't make the username.  </p>\n\n<p>The username is the first 5 letters of last name plus first letter of the first name. If the last name is too short, it is just filled with characters of the first name starting at the beginning until the username is 6 characters long.</p>\n\n<pre><code>Public Function userNameBuilder(ByVal firstName As String, ByVal lastName As String) As String\n    Dim newLastName As String\n    Dim newUserName As String\n    If (lastName &gt;= 5) Then\n        newLastName = Left(lastName, Len(lastName) - 5)\n        userNameBuilder = (newLastName &amp; Left(firstName, 1))\n    ElseIf (lastName &lt; 5 &amp;&amp; lastName &gt; 0) Then\n        userNameBuilder = lastName &amp; Left(firstName, 5 - (Len(lastName)))\n    Else\n        userNameBuilder = vbNullString\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1476208258, "post_id": 39983473, "comment_id": 67245654, "body": "You dim <code>question3</code> but you never actually set it to a worksheet.  Immediately after the Dim line, put in a Set line: <code>Set question3 = ActiveWorkbook.Sheets(&quot;Question3&quot;)</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476208443, "post_id": 39983473, "comment_id": 67245764, "body": "Also, don&#39;t you need to make <code>gender</code> something when calling your subs? What do they do when <code>gender</code> is <code>nothing</code>? I&#39;m surprised this doesn&#39;t throw an error when trying to run <code>Main()</code>."}, {"owner": {"reputation": 29, "user_id": 6935351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8c191d67faac52f349e29fa7d026303?s=128&d=identicon&r=PG&f=1", "display_name": "Vedant Dhawan", "link": "https://stackoverflow.com/users/6935351/vedant-dhawan"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476209051, "post_id": 39983473, "comment_id": 67246147, "body": "Thanks @tigeravatar it worked perfectly, I had forgotten to set it to the active workbook!"}, {"owner": {"reputation": 29, "user_id": 6935351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8c191d67faac52f349e29fa7d026303?s=128&d=identicon&r=PG&f=1", "display_name": "Vedant Dhawan", "link": "https://stackoverflow.com/users/6935351/vedant-dhawan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476209117, "post_id": 39983473, "comment_id": 67246178, "body": "@BruceWayne I did Dim gender As String, am I doing it wrong?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476210347, "post_id": 39983473, "comment_id": 67246869, "body": "Yeah, but then when <code>GetResponse(sender)</code> is called, what does the function use as <code>sender</code>? What value is passed there? (I&#39;m kinda new to UDF, so am wondering how you can pass a (seemingly) nonexistant variable? Am I missing something?)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1476213669, "post_id": 39983473, "comment_id": 67248858, "body": "@BruceWayne - <code>Dim gender As String</code> creates a string variable, and sets it to the default value of an empty string (i.e. <code>&quot;&quot;</code>).  As it is never assigned another value before the statement <code>Call GetResponse(gender)</code>, that subroutine receives a reference to a string variable which has a value of <code>&quot;&quot;</code>.  The subroutine then changes the value of the variable referred to and so, when the <code>Call NameGenderRange(gender)</code> statement is executed, the <code>NameGenderRange</code> subroutine is passed a reference to a string variable which now contains either <code>&quot;boys&quot;</code> or <code>&quot;girls&quot;</code>."}], "owner": {"reputation": 29, "user_id": 6935351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8c191d67faac52f349e29fa7d026303?s=128&d=identicon&r=PG&f=1", "display_name": "Vedant Dhawan", "link": "https://stackoverflow.com/users/6935351/vedant-dhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476216819, "creation_date": 1476208078, "last_edit_date": 1476216819, "question_id": 39983473, "link": "https://stackoverflow.com/questions/39983473/activating-appropriate-worksheet-and-renaming-it", "title": "Activating appropriate worksheet and renaming it", "body": "<p>I have been adding worksheets from different workbooks into one for ease, however, when I copy and paste the code into the new model in the new workbook, the code keeps on showing me an error, despite it working in the old workbook. \nIn the code below, how can I activate worksheet \"Question3\" and have \"Set myRange = question3.Range(\"A3\") not give me an error, like it wasn't before I copied and pasted it into my new workbook. \nThank You. </p>\n\n<pre><code> Sub Main()\n Dim gender As String\n   Call GetResponse(gender)\n   Call NameGenderRange(gender)\n   Call FormatOutputRange(gender)\n   Call EnterOutput(gender)\n End Sub\n\nSub GetResponse(gender As String)\n\n  Dim response As Variant '&lt;-- since the user can respond in alphabets or     anything else\n  Dim ErrorCheck As Boolean\n\n    Do\n      response = InputBox(\"please enter 1 for boys, or 2 for girls\") '&lt;--prompting user for input\n      If IsNumeric(response) = False Then\n        ErrorCheck = True  '&lt;-- ensuring the input value is an integer\n        MsgBox (\"Please enter a valid entry\") '&lt;-- ensuring user inputs  only 1 or 2\n      ElseIf response = 1 Then '&lt;-- if logic to differentiate between the gender averages\n        gender = \"boys\"\n      ElseIf response = 2 Then\n        gender = \"girls\"\n      Else\n        ErrorCheck = False\n      End If  \n    Loop Until response = 1 Or response = 2 '&lt;-- continously prompting the user to enter a correct value\nEnd Sub\n\nSub NameGenderRange(gender As String)\nDim myRange As Range '&lt;-- selecting the appropriate column to calculate   the average\nDim question3 As Worksheet\n\n  If gender = \"boys\" Then\n    Set myRange = question3.Range(\"A3\") '&lt;-- selecting the column contaning  data for boys\n  Else\n    Set myRange = question3.Range(\"B3\") '&lt;-- slecting the column contaning data for girls\n  End If\n  With myRange\n    Range(.Offset(1, 0), .End(xlDown)).Name = \"average\" '&lt;--selecting the whole column and calling it \"average\"\n  End With\nEnd Sub\n\nSub FormatOutputRange(gender As String)\n  With question3.Range(\"D9:E9\") '&lt;-- selecting the rows to display the \"average\"\n    With .Font\n      .Size = 12\n      .Underline = True '&lt;-- altering the font\n      .Bold = True\n      .TintAndShade = 0\n      If gender = \"boys\" Then '&lt;-- If logic to differentiate by colour\n        .ColorIndex = 5\n      Else\n        .ColorIndex = 3\n      End If\n    End With\n  End With\nEnd Sub\n\n Sub EnterOutput(gender As String)\n   question3.Range(\"D9\").Value = \"The average for \" &amp; gender &amp; \" is\" '&lt;-- naming the row to display the average\n   question3.Range(\"E9\").Formula = \"=Average(average)\" '&lt;-- displaying the   average in cell E9\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1476208913, "post_id": 39983393, "comment_id": 67246063, "body": "What issue is not working, what issue are you getting?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476208918, "post_id": 39983393, "comment_id": 67246065, "body": "<code>Worksheets(j)</code> isn&#39;t necessarily in <code>ActiveWindow.SelectedSheets</code>. Why not iterate the <code>SelectedSheets</code> collection?"}, {"owner": {"reputation": 13, "user_id": 7002940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fc88f46200586e36cffb6560cfebe?s=128&d=identicon&r=PG&f=1", "display_name": "se_ib", "link": "https://stackoverflow.com/users/7002940/se-ib"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476209097, "post_id": 39983393, "comment_id": 67246167, "body": "basically the issue is that it simply isnt sorting the selected sheets. and @Mat&#39;sMug, how would I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7002940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fc88f46200586e36cffb6560cfebe?s=128&d=identicon&r=PG&f=1", "display_name": "se_ib", "link": "https://stackoverflow.com/users/7002940/se-ib"}, "edited": false, "score": 0, "creation_date": 1476209984, "post_id": 39983794, "comment_id": 67246646, "body": "that was much closer, but it still is sorting sheets that arent selected @user3598756"}, {"owner": {"reputation": 13, "user_id": 7002940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fc88f46200586e36cffb6560cfebe?s=128&d=identicon&r=PG&f=1", "display_name": "se_ib", "link": "https://stackoverflow.com/users/7002940/se-ib"}, "edited": false, "score": 0, "creation_date": 1476211671, "post_id": 39983794, "comment_id": 67247656, "body": "Yup, looks like it. Thanks!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1476210272, "last_edit_date": 1476210272, "creation_date": 1476209220, "answer_id": 39983794, "question_id": 39983393, "link": "https://stackoverflow.com/questions/39983393/trying-to-sort-worksheets-in-descending-order-based-on-cell-values/39983794#39983794", "title": "Trying to sort worksheets in descending order based on cell values", "body": "<p>whenever you <code>Move</code> a worksheet you loose the selection of worksheets, so you have to fix it before starting the sorting process</p>\n\n<pre><code>Option Explicit\n\n Sub SortWksByCell()\n    Dim i As Integer\n    Dim j As Integer\n    Dim wss As Sheets\n\n    Set wss = ActiveWindow.SelectedSheets\n    For i = 1 To wss.Count\n        For j = i + 1 To wss.Count\n            If UCase(wss(i).Range(\"q1\")) &lt;= _\n              UCase(wss(j).Range(\"q1\")) Then\n                wss(j).Move Before:=wss(i)\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7002940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fc88f46200586e36cffb6560cfebe?s=128&d=identicon&r=PG&f=1", "display_name": "se_ib", "link": "https://stackoverflow.com/users/7002940/se-ib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39983794, "answer_count": 1, "score": 1, "last_activity_date": 1520471414, "creation_date": 1476207828, "last_edit_date": 1476208411, "question_id": 39983393, "link": "https://stackoverflow.com/questions/39983393/trying-to-sort-worksheets-in-descending-order-based-on-cell-values", "title": "Trying to sort worksheets in descending order based on cell values", "body": "<p>I am trying to sort worksheets based on a cell value located within each sheet. The main area I am having difficulty is applying the sort to ONLY selected sheets. Below is what I have so far. Pretty new to VBA</p>\n\n<pre><code>Sub SortWksByCell()\nDim i As Integer\nDim j As Integer\n\n  For i = 1 To ActiveWindow.SelectedSheets.Count\n    For j = i + 1 To ActiveWindow.SelectedSheets.Count\n        If UCase(Worksheets(i).Range(\"q1\")) &lt;= _\n          UCase(Worksheets(j).Range(\"q1\")) Then\n            Worksheets(j).Move Before:=Worksheets(i)\n        End If\n    Next\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1476219545, "post_id": 39983134, "comment_id": 67252048, "body": "Where do you attempt a second Pivot Table object? And where does <i>PivotTable2</i> come from?"}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1476221092, "post_id": 39983134, "comment_id": 67252842, "body": "I think that was a typo and should have been PivotTable4. for the name of the pivot table. I haven&#39;t attempted the second pivot table object. Right now I am trying to pull data dynamically to a new sheet. I imagine I can add a call to run a similar code for a new sheet. My issue comes up at Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables(&quot;PivotTable4&quot;). Runtime error 1004"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476230949, "post_id": 39987465, "comment_id": 67255925, "body": "Option Explicit  Public Sub RunPivots()     Call BuildPivot(&quot;Travel Payment Data by Employee&quot;)     Call BuildPivot(&quot;Travel Payment Data by Acct Dim&quot;)"}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476231239, "post_id": 39987465, "comment_id": 67255985, "body": "Disregard above. Your code works, but now I am trying to put the sub in for a new pivot table with different  parameters. You are saying add a new function after the exit function and specify the name of the sheet?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476231282, "post_id": 39987465, "comment_id": 67255993, "body": "Do you have question? Yes go ahead and implement specific worksheets as needed."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476231379, "post_id": 39987465, "comment_id": 67256010, "body": "Simply create a new function similar to this one but change data source and/or pivot fields at end."}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476234847, "post_id": 39987465, "comment_id": 67256715, "body": "Sorry, but the second function isn&#39;t being called. It just says application defined or object defined error. I already changed the pivot fields, the data source is staying the same. I renamed the function and call &quot;BuildPivot2&quot; because i was getting an error that was due to the same call name being used."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1476235296, "post_id": 39987465, "comment_id": 67256806, "body": "How can I help as I don&#39;t see such a function? Just carefully check what you changed from this version."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1476223208, "creation_date": 1476223208, "answer_id": 39987465, "question_id": 39983134, "link": "https://stackoverflow.com/questions/39983134/creating-mutiple-pivot-tables-from-single-data-source/39987465#39987465", "title": "Creating Mutiple Pivot Tables from single data source", "body": "<p>Consider the following adjustment with a subroutine calling a function, passing in new worksheet names for new identical pivot tables. If you do not intend identical pivots, adjust them in code conditionally by sheet name or copies of function. The main changes from your code are as follows:</p>\n\n<ol>\n<li>ACTIVE SHEET: Remove the need to search <code>ActiveSheet.Name</code> as adding more worksheets will alter active sheets. Simply hard-code or pass as parameter the data source.</li>\n<li>OBJECT CHECK: You need to check if Worksheet exits and PivotTable exists. For these, you will need to iterate through all current such objects  and conditionally set worksheet, pivot table objects (see <code>For...Next</code> loops and <code>If ... Is Nothing</code> checks). </li>\n<li>For PivotField, since <em>Dollar Amounts</em> will exist in Pivot Table data source but not necessarily display, iterating through all of them might not work like above. So conditionally add only if does not error out see <code>On Resume Next</code> handle.</li>\n</ol>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub RunPivots()\n    Call BuildPivot(\"Travel Payment Data by Employee\")\n    Call BuildPivot(\"Other Worksheet\")\n    Call BuildPivot(\"Still More Worksheet\")\nEnd Sub\n\nFunction BuildPivot(paramSheet As String)\nOn Error GoTo ErrHandle\n    Dim FinalRow            As Long\n    Dim DataSheet           As String\n    Dim PvtCache            As PivotCache\n    Dim PvtTbl              As PivotTable\n    Dim PvtFld              As PivotField\n    Dim DataRng             As Range\n    Dim TableDest           As Range\n    Dim ws                  As Worksheet\n\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    DataSheet = \"DataSourceWorksheet\"    \n    ' set data range for Pivot Table\n     Set DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, 15))\n\n    ' check if worksheet exists\n    Dim currws As Worksheet\n    For Each currws In ActiveWorkbook.Worksheets\n        If currws.Name = paramSheet Then\n            Set ws = Worksheets(paramSheet)\n            Exit For\n        End If\n    Next currws\n\n    ' create new worksheet if does not exist\n    If ws Is Nothing Then\n        Set ws = Worksheets.Add\n        ws.Name = paramSheet\n    End If\n\n    ' set range for Pivot table placement\n    Set TableDest = Sheets(paramSheet).Cells(1, 1)\n\n    ' create pivot cache\n    Set PvtCache = ActiveWorkbook.PivotCaches.Create( _\n              SourceType:=xlDatabase, _\n              SourceData:=DataRng, _\n              Version:=xlPivotTableVersion15)\n\n    'check if \"PivotTable4\" Pivot Table exists            \n    Dim currpvt As PivotTable\n    For Each currpvt In ws.PivotTables\n        If currpvt.Name = \"PivotTable4\" Then\n            Set PvtTbl = ws.PivotTables(\"PivotTable4\")\n            Exit For   \n        End If\n    Next currpvt\n\n    ' create new pivot table if does not exist\n    If PvtTbl Is Nothing Then\n        Set PvtTbl = PvtCache.CreatePivotTable( _\n            TableDestination:=TableDest, _\n            TableName:=\"PivotTable4\")\n    End If\n\n    With PvtTbl.PivotFields(\"Security Org\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Month\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n    With PvtTbl.PivotFields(\"Budget Org\")\n        .Orientation = xlRowField\n        .Position = 3\n    End With\n    With PvtTbl.PivotFields(\"Vendor Name\")\n        .Orientation = xlRowField\n        .Position = 4\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Year\")\n        .Orientation = xlRowField\n        .Position = 5\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Year\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n    ' Add data field if does not exist\n    On Error Resume Next\n    PvtTbl.AddDataField PvtTbl.PivotFields(\"Dollar Amount\"), \"Sum of Dollar Amount\", xlSum\n\n    Exit Function\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    Exit Function\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 39987465, "answer_count": 1, "score": 0, "last_activity_date": 1476223208, "creation_date": 1476206889, "last_edit_date": 1476216539, "question_id": 39983134, "link": "https://stackoverflow.com/questions/39983134/creating-mutiple-pivot-tables-from-single-data-source", "title": "Creating Mutiple Pivot Tables from single data source", "body": "<p>I am trying to create a pivot table on a new sheet. Additionally, I would like to create another call to create another different pivot table using the same data from the first data sheet.</p>\n\n<p>having trouble with the macro below. I think it is a small error, but can't figure it out.  </p>\n\n<pre><code>Sub Macro2()\n\n    Dim FinalRow            As Long\n    Dim DataSheet           As String\n    Dim PvtCache            As PivotCache\n    Dim PvtTbl              As PivotTable\n    Dim DataRng             As Range\n    Dim TableDest           As Range\n    Dim ws                  As Worksheet\n\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n    DataSheet = ActiveSheet.Name\n\n    'set data range for Pivot Table -- ' conversion of R1C1:R &amp; FinalRow &amp; C15\n     Set DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, 15)) \n\n    Set ws = Worksheets.Add\n    ws.Name = \"Travel Payment Data by Employee\"\n\n    'set range for Pivot table placement -- Conversion of R1C1\n    Set TableDest = Sheets(\"Travel Payment Data by Employee\").Cells(1, 1)\n\n    Set PvtCache = ActiveWorkbook.PivotCaches.Create(xlDatabase, DataRng, xlPivotTableVersion15)\n\n    'check if \"PivotTable4\" Pivot Table already created (in past runs of this Macro)\n    Set PvtTbl = ActiveWorkbook.Sheets(\"Travel Payment Data by Employee\").PivotTables(\"PivotTable4\")\n\n    With PvtTbl.PivotFields(\"Security Org\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Month\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n    With PvtTbl.PivotFields(\"Budget Org\")\n        .Orientation = xlRowField\n        .Position = 3\n    End With\n    With PvtTbl.PivotFields(\"Vendor Name\")\n        .Orientation = xlRowField\n        .Position = 4\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Year\")\n        .Orientation = xlRowField\n        .Position = 5\n    End With\n    With PvtTbl.PivotFields(\"Fiscal Year\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    PvtTbl.AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable2\").PivotFields(\"Dollar Amount\"), \"Sum of Dollar Amount\", xlSum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476205748, "post_id": 39982767, "comment_id": 67244200, "body": "Please try stepping through your code using F8 key to debug it and see what happens (or doesn&#39;t). Stepping through your code should at least allow you to describe where a specific failure mode occurs (e.g., evaluating an <code>If</code> statement should return <code>False</code> but it returns <code>True</code> instead and I can&#39;t figure out why, etc.)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476205890, "post_id": 39982767, "comment_id": 67244272, "body": "RIght off the bat it&#39;s possible that your <code>lastRow</code> and <code>lastCell</code> are not what you think they are (step through &amp; verify) and further complicating it is the fact that you&#39;re relying on <code>ActiveCell</code> while simultaneously inserting/shifting data in a loop, which seems immediately suspect."}, {"owner": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476206552, "post_id": 39982767, "comment_id": 67244659, "body": "The active cell doesn&#39;t move along with the For statement. Meaning the Active Cell is always A1. Other than ActiveCell what should I be using?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476206784, "post_id": 39982767, "comment_id": 67244789, "body": "Which <code>For</code> statement? There are two of them. One (the inner one) provides a condition whereby the active cell is offset (0,3). The outer <code>For</code> statement never changes the active row. I suggest revising this code to avoid reliance on <code>ActiveCell</code>. <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "edited": false, "score": 1, "creation_date": 1476211716, "post_id": 39983325, "comment_id": 67247680, "body": "It&#39;s worth noting, in order for it to work with your changes, while doing what i needed it to do, I had to add 2 to both LastCell and X."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "edited": false, "score": 0, "creation_date": 1476212073, "post_id": 39983325, "comment_id": 67247909, "body": "You can do that easily and optimally using <code>For i = 1 to LastRow Step 3</code> and <code>For x = 1 to LastCell Step 3</code> (instead of having to increment like <code>x = x +2</code> inside the loop.  Cheers."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1476207598, "last_edit_date": 1495542790, "creation_date": 1476207598, "answer_id": 39983325, "question_id": 39982767, "link": "https://stackoverflow.com/questions/39982767/change-activecell-in-a-loop/39983325#39983325", "title": "Change ActiveCell in a loop", "body": "<p>Without changing anything structurally in your code it seems like you need to change the <code>ActiveCell</code> along with the <code>For i</code> loop:</p>\n\n<pre><code>For i = 1 To LastRow\n    LastCell = Range(\"IV1\").End(xlToLeft).Column\n    For x = 1 To LastCell\n        If ActiveCell = \"Location\" Then\n            lName = ActiveCell.Offset(0, -2).Value\n            fName = ActiveCell.Offset(0, -1).Value\n        ElseIf ActiveCell.Value Like \"HC:H*\" Then\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            ActiveCell.Value = lName\n            ActiveCell.Offset(0, 1).Value = fName\n            ActiveCell.Offset(0, 3).Select\n        End If\n    Next x\n    Cells(i, 1).Select  '## Change your \"ActiveCell\" to the first cell in the next row.\nNext i\n</code></pre>\n\n<p>This may yet not work 100% of the time because it's relying on <code>ActiveCell</code> and further, it's not explicitly <em>activating</em> anything, so that means it must rely on whatever the user had previously selected/activated before running the macro. This is unreliable, at best, because people forget to select the correct cell, etc...</p>\n\n<p>Further: relying on <code>ActiveCell</code> leads to spaghetti code that becomes increasingly difficult to read, interpret, or troubleshoot (especially as you start working across multiple worksheets, workbooks, etc.) and defeats the purpose of object-oriented programming. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Learn to use and manipulate the objects directly, and you'll find that it's very rarely (like, 0.01% of the time) necessary to <code>Select</code> or <code>Activate</code> anything:</a></p>\n\n<pre><code>Dim cl as Range '# Declaring a Range object to represent a cell on which to operate\n\nFor i = 1 To LastRow\n    LastCell = Range(\"IV1\").End(xlToLeft).Column\n    For x = 1 To LastCell\n        Set cl = Cells(i, x)   '## Assign your cell: row:=i, column:=x\n        If cl.Value = \"Location\" Then\n            lName = cl.Offset(0, -2).Value\n            fName = cl.Offset(0, -1).Value\n        ElseIf ActiveCell.Value Like \"HC:H*\" Then\n            cl.Resize(1,2).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            cl.Value = lName\n            cl.Offset(0, 1).Value = fName\n            Set cl = cl.Offset(0, 3)\n        End If\n    Next x\n    Set cl = Cells(i, 1).Select \nNext i\n</code></pre>\n\n<p>You may also want to review this for more reliable ways of obtaining the \"last\" row or column:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Error in finding last used cell in VBA</a></p>\n"}], "owner": {"reputation": 112, "user_id": 6933003, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-oPv7OtP0unE/AAAAAAAAAAI/AAAAAAAAAFw/F2_X5n6UfLg/photo.jpg?sz=128", "display_name": "Shane A. Workman", "link": "https://stackoverflow.com/users/6933003/shane-a-workman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 39983325, "answer_count": 1, "score": 0, "last_activity_date": 1562577922, "creation_date": 1476205457, "last_edit_date": 1562577922, "question_id": 39982767, "link": "https://stackoverflow.com/questions/39982767/change-activecell-in-a-loop", "title": "Change ActiveCell in a loop", "body": "<p>I have an Excel file from a third party that I wrote a macro to manipulate.</p>\n\n<p>The macro needs to grab a technician's name and insert it prior to each service \nlisted in the row per client.</p>\n\n<p>The excel file is set up as follows.</p>\n\n<p>|RowID|ClientID|CLname|CFname|TLname|TFname|Location|date|Serv|ServDur|ServID|Cost|</p>\n\n<p>Each row has 1 unique client, multiple technicians, each technician can have multiple services.</p>\n\n<p>My macro runs with no errors, yet it makes no changes. </p>\n\n<pre><code>Sub UpdateText()\n' UpdateText Macro\n' Keyboard Shortcut: Ctrl+Shift+D\n\nDim fName As String\nDim lName As String\nDim LastRow As Long\nDim LastCell As Long\nDim i As Long\nDim x As Long\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To LastRow\n    LastCell = Range(\"IV1\").End(xlToLeft).Column\n    For x = 1 To LastCell\n        If ActiveCell = \"Location\" Then\n            lName = ActiveCell.Offset(0, -2).Value\n            fName = ActiveCell.Offset(0, -1).Value\n        ElseIf ActiveCell.Value Like \"HC:H*\" Then\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            ActiveCell.Value = lName\n            ActiveCell.Offset(0, 1).Value = fName\n            ActiveCell.Offset(0, 3).Select\n        End If\n    Next x\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The active cell doesn't move along with the For statement. Meaning the Active Cell is always A1.   </p>\n"}, {"tags": ["database", "forms", "validation", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1476205763, "post_id": 39982522, "comment_id": 67244207, "body": "Have you tried VBA? Are you using a command button to execute an append or update? It should be as simple as referencing your controls and testing the values they contain. <code>IsNull([Me!MyField])</code>, <code>LEN(Me!MyField) &gt; 255</code> are examples of expressions to use in <code>IF</code> statements in your command button click prior to running the append/update. Is that what you are looking for?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1476206202, "post_id": 39982522, "comment_id": 67244445, "body": "You can create these sort of validation rules directly for the form controls, no need to write code for it."}, {"owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1476210966, "post_id": 39982522, "comment_id": 67247238, "body": "IsNull, as @ChristopherD said, is my preferred way to handle these situations.  You can develop a list of them in an If/ElseIf statement that will error check prior to entering the information into your database."}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476204601, "creation_date": 1476204601, "question_id": 39982522, "link": "https://stackoverflow.com/questions/39982522/need-to-develop-a-data-entry-platform-in-ms-access-using-forms", "title": "Need to develop a data entry platform in MS Access using forms", "body": "<p>So I've been given the task of developing a GUI for our data entry team that allows them to enter/update records that will then be appended to certain tabels within our database.</p>\n\n<p>I'm having trouble planning the exception handling of flagging of certain events like a missing value that may be used to search for a record later, values that are too long/short to satisfy validation rules within the database, things like that.</p>\n\n<p>Are there any resources or tips/advice you folks can provide that make exception handling and data entry easier? I know Access probably isn't the desired platform here, but I have no choice.</p>\n"}]