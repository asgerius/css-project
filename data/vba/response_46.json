[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448492302, "post_id": 33927736, "comment_id": 55616740, "body": "because the <code>Range</code> by itself does not mean anything in this context. Try changing <code>Range(Cells(1,1)</code> to <code>Selection(Cells(1,1))</code> in your 2nd line. It&#39;s not best practice, but at least you are tying the <code>Cells</code> property to an object in this case. Best practice is to always qualify your Ranges, Cells, Sheets, etc."}, {"owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448493438, "post_id": 33927736, "comment_id": 55617199, "body": "Thanks but selection gives a type mismatch. I have added an edit."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1448493524, "post_id": 33927736, "comment_id": 55617224, "body": "so just use <code>Key1:=Cells(intRow, intCol)</code>"}, {"owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448493957, "post_id": 33927736, "comment_id": 55617350, "body": "So simple. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "edited": false, "score": 0, "creation_date": 1448493438, "post_id": 33927945, "comment_id": 55617197, "body": "Thanks. I have added an edit explaining what I trying to do. I should have said that at the start."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1448496066, "post_id": 33927945, "comment_id": 55617996, "body": "Actually, <code>Range(Cells(1, 1))</code> is equivalent to <code>Range(Cells(1, 1).Value)</code>, because it invokes the version of Range that takes one parameter and expects a valid <i>range address</i>. So if the cell <code>A1</code> contained a valid address, such as &quot;G5&quot;, <code>Range(Cells(1, 1))</code> would designate the cell <code>G5</code>."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1448496228, "post_id": 33927945, "comment_id": 55618038, "body": "@A.S.H Thanks for demystifying!"}], "tags": [], "owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "is_accepted": false, "score": 3, "last_activity_date": 1448492878, "last_edit_date": 1448492878, "creation_date": 1448492577, "answer_id": 33927945, "question_id": 33927736, "link": "https://stackoverflow.com/questions/33927736/sort-key-range-query/33927945#33927945", "title": "Sort key range query", "body": "<p>The <code>Cells</code> call is already returning a Range object, so you should use </p>\n\n<pre><code>Selection.Sort Key1:=Cells(1,1), Order1:=xlAscending, Header:=xlNo, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n</code></pre>\n\n<p>I think that your confusion is stemming from the fact that passing two Cells parameters to Range is valid, i.e. <code>Range(Cells(1, 1), Cells(5, 5))</code>, but it is not valid to only pass one Cells parameter, i.e. <code>Range(Cells(1, 1))</code></p>\n\n<p>You can see this for yourself with the following snippet</p>\n\n<pre><code>Public Sub test()\n\nDim rng As Range\n\nSet rng = Range(Cells(1, 1), Cells(3, 1))\nMsgBox rng.Cells.Count\n\nSet rng = Range(Cells(1, 1))\nMsgBox rng.Cells.Count\n\nEnd Sub\n</code></pre>\n\n<p>You will get a message saying 3 for the first msgbox call, but you get an exception when trying to set rng the second time.</p>\n\n<p>As to why the second format is not valid, I have no idea. If you find out why the devs built it this way, let us know.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1448493948, "creation_date": 1448493948, "answer_id": 33928181, "question_id": 33927736, "link": "https://stackoverflow.com/questions/33927736/sort-key-range-query/33928181#33928181", "title": "Sort key range query", "body": "<p>It's always best to qualify exactly which objects you are working with and work directly with the objects, as opposed to using <code>Selection</code> or just <code>Range</code>, as it can sometimes lead to unintended consequences or slow your code down. </p>\n\n<p>Try this:</p>\n\n<pre><code>Dim ws as Worksheet\nSet ws = Sheets(\"Sheet1\") ' replace with your sheet name\n\n'assume you wrap this around a loop to move through intRow and intCol _\n or set them in some other fasion\nWith ws.Range(Cells(1,1), Cells(5,5)\n\n  .Sort Key1:=.Cells(intRow, intCol), Order1:=xlAscending, Header:=xlNo, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1448493954, "last_edit_date": 1495540319, "creation_date": 1448493954, "answer_id": 33928183, "question_id": 33927736, "link": "https://stackoverflow.com/questions/33927736/sort-key-range-query/33928183#33928183", "title": "Sort key range query", "body": "<blockquote>\n  <p>The reason for asking is that I would like the sort key to be dynamic ...</p>\n</blockquote>\n\n<p>At least part of the problem is relying on <code>.Select</code> and the subsequent <code>Selection</code> as the working area. If your intention is to work with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a> (the 'island' of data origination in A1) then use a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> to define the .CurrentRegion and work with it.</p>\n\n<pre><code>with worksheets(\"Sheet1\")     `&lt;~~ set the parent worksheet!\n    with .Cells(1, 1).CURRRENTREGION         `&lt;~~ set the 'island' of data\n        .cells.Sort Key1:=.cells(1), Order1:=xlAscending, Header:=xlNo, _\n                    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n                    DataOption1:=xlSortNormal\n    end with\nend with\n</code></pre>\n\n<p>I'm a little unclear on what you mean by 'dynamic'. The above will use the cell in the top-left of the area defined by .CurrentRegion. If you used <code>With .Range(\"D5:H99\")</code> then <code>.Cells(1)</code> would refer to D5.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 0, "accepted_answer_id": 33928181, "answer_count": 3, "score": 0, "last_activity_date": 1448498870, "creation_date": 1448491491, "last_edit_date": 1448498870, "question_id": 33927736, "link": "https://stackoverflow.com/questions/33927736/sort-key-range-query", "title": "Sort key range query", "body": "<p>Why does this work:</p>\n\n<pre><code>Range(Cells(1, 1), Cells(5, 5)).Select\nSelection.Sort Key1:=Range(\"A1\"), Order1:=xlAscending, Header:=xlNo, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n</code></pre>\n\n<p>But this doesn't?:</p>\n\n<pre><code>Range(Cells(1, 1), Cells(5, 5)).Select\nSelection.Sort Key1:=Range(Cells(1,1)), Order1:=xlAscending, Header:=xlNo, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n</code></pre>\n\n<p>Saying the </p>\n\n<blockquote>\n  <p>Method Range failed</p>\n</blockquote>\n\n<p>EDIT </p>\n\n<p>The reason for asking is that I would like the sort key to be dynamic, such as:</p>\n\n<pre><code>Selection.Sort Key1:=Range(Cells(intRow, intCol))\n</code></pre>\n\n<p>I can't see how this is done.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1448490517, "post_id": 33927429, "comment_id": 55616031, "body": "probably going to need more code (but - unless it&#39;s short - not the whole lot!)  <a href=\"http://stackoverflow.com/help/mcve\">This may help</a>"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1448490640, "post_id": 33927429, "comment_id": 55616082, "body": "It&#39;s not <i>particularly</i> short. However, this is the last section of the code that should be hiding or unhiding rows. I&#39;ll append more of the code onto the question."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448491175, "post_id": 33927429, "comment_id": 55616289, "body": "<i>it&#39;s just not reading the values in the two certain pivot tables.</i> - did you check those pivot tables and verify that the rows match the text you entered <b>exactly</b>?"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "edited": false, "score": 0, "creation_date": 1448491840, "post_id": 33927429, "comment_id": 55616555, "body": "Yes. More than once. I even removed the filters and put them back on again, just to be sure. I&#39;ve also copied and pasted the text values from other pivot tables where it is working correctly to the ones where it&#39;s not working."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 2, "creation_date": 1448494059, "post_id": 33927429, "comment_id": 55617377, "body": "what happens when you single-step through the code for the offending rows?  Does <code>c.EntireRow.Hidden = True</code> execute but not hide the row?  Does the <code>If</code> statement skip those rows?"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "edited": false, "score": 0, "creation_date": 1448496236, "post_id": 33927429, "comment_id": 55618042, "body": "Is there any way to single step past 500 rows without it going through each one? :/"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1448497038, "post_id": 33927429, "comment_id": 55618241, "body": "yes you can try <code>For Each c In r.Offset(500)</code> and you will start immediately at row 500 ;). I second the suggestion of @aucuparia"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1448538732, "post_id": 33927429, "comment_id": 55635260, "body": "set a watch to break on <code>c.row = 500</code> or whatever."}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448544427, "post_id": 33927429, "comment_id": 55638844, "body": "try using instr() to check for those values in your last loop, that will avoid missing an exact match because of an errant whitespace and make sure your range declaration (r) includes all your pivot tables!"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1448897327, "post_id": 33927429, "comment_id": 55759849, "body": "@aucuparia, I&#39;ve gotten back to the spreadsheet. It goes through the rows that should be hidden but aren&#39;t and just skips them. I&#39;m using the same data set for each of the Pivot Tables, and haven&#39;t changed any values, so I don&#39;t know why the data would be different in these two sets of rows (in addition, it&#39;s skipping all 4 rows in each set. There are 15 sets with these 4 rows total, and in the other 13 all 4 rows are being hidden)"}], "answers": [{"tags": [], "owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "is_accepted": true, "score": 0, "last_activity_date": 1448900742, "creation_date": 1448900742, "answer_id": 34003239, "question_id": 33927429, "link": "https://stackoverflow.com/questions/33927429/some-rows-that-should-be-being-hidden-are-not-being-hidden/34003239#34003239", "title": "Some rows that should be being hidden are not being hidden", "body": "<p>I have solved the problem. Instead of using <code>c.Text</code> I used <code>c.Value2</code> and that fixed the issue. There must have been some internal formatting issue that was unfixable. </p>\n"}], "owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 34003239, "answer_count": 1, "score": 0, "last_activity_date": 1448900742, "creation_date": 1448490017, "last_edit_date": 1448499699, "question_id": 33927429, "link": "https://stackoverflow.com/questions/33927429/some-rows-that-should-be-being-hidden-are-not-being-hidden", "title": "Some rows that should be being hidden are not being hidden", "body": "<p>Here is the relevant code: </p>\n\n<pre><code>'hides all Location, Account, Product Line, or Sum of Total rows in column A\nFor Each c In r\n    If c.Text = \"Location\" Or c.Text = \"Account\" Or c.Text = \"Product Line\" Or _ \n            c.Text = \"Sum of Total\" Then\n        c.EntireRow.Hidden = True\n    End If\nNext c\n</code></pre>\n\n<p>The issue is that it is hiding most of the columns with those names in column A, but there are two sets where it is not being hidden. (There are ~15 PivotTables, and Location, Account, and Product Line are all filters; Sum of Total is a row that is blank except for that single statement in column A)</p>\n\n<p>What could be causing this? </p>\n\n<p>I can post the full code that I'm using if required, but for some reason it's just not reading the values in the two certain PivotTables. </p>\n\n<p>Edit: more of the code</p>\n\n<pre><code>Set r = Range(\"a1:a1000\")\n\n'hides all rows with no value\nFor Each c In r\n    If Len(c.Text) = 0 Then\n        c.EntireRow.Hidden = True\n    Else\n        c.EntireRow.Hidden = False\n    End If\nNext c\n\n'unhides all the rows below each grand total row\nFor Each c In r\n    If c.Text = \"Grand Total\" Then\n        c.Offset(1).EntireRow.Hidden = False\n    End If\n\nNext c\n\n'unhides all rows below a row with a value\nFor Each c In r\n    If Len(c.Text) &gt; 0 Then\n        c.Offset(1).EntireRow.Hidden = False\n    End If\nNext c\n\n\n'hides all Location, Account, Product Line, or Sum of Total rows in column A\nFor Each c In r\n    If c.Text = \"Location\" Or c.Text = \"Account\" Or c.Text = \"Product Line\" _\n Or c.Text = \"Sum of Total\" Then\n        c.EntireRow.Hidden = True\n    End If\nNext c\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448491490, "post_id": 33927339, "comment_id": 55616406, "body": "for starters I would change <code>vbYellow</code> to <code>vbRed</code> and <code>vbRed</code> to <code>vbBlack</code>. Otherwise, what does the code <i>not</i> do for you that you expect it to do?"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1448573511, "post_id": 33927339, "comment_id": 55653440, "body": "I would advise in learning VBA to grab hold of object types and references rather than all that <code>.select</code> and <code>parent.parent</code> coding. You can use dots and go through, but if you need to manipulate certain objects often, then getting it referenced well can i)ease your debugging, ii) simplify your codewriting, iii) improve your knowledge of the Object Model, and iv) get intellisense to provide you with the available methods and properties of the object..."}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1448575824, "post_id": 33927339, "comment_id": 55654236, "body": "@MacroMarc Thank you for the advice, do you know of any specific material I could use to learn more about objects in VBA?"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1448580313, "post_id": 33927339, "comment_id": 55655561, "body": "MSDN doesnt have good explanations sometimes, and the examples are weird, but it&#39;s the most complete reference(being that VBA is a MS language). Intellisense can be very helpful once you get the general swing of things in Excel objects"}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "edited": false, "score": 0, "creation_date": 1449166934, "post_id": 33948350, "comment_id": 55899771, "body": "Thank you! This is very helpful; I will definitely be learning more on how to grab and manipulate objects in VBA."}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1448580150, "creation_date": 1448580150, "answer_id": 33948350, "question_id": 33927339, "link": "https://stackoverflow.com/questions/33927339/format-a-pivotchart-data-label-based-on-the-x-axis/33948350#33948350", "title": "Format a PivotChart data label based on the x axis", "body": "<p>Some code to get you started:</p>\n\n<pre><code>Sub template()\n\n    Dim pc As Chart\n    Set pc = Sheets(\"Dashboard\").ChartObjects(\"DB_Chrt_1\").Chart\n\n    Dim ax As Axis\n    Set ax = pc.Axes(xlCategory)\n\n    Dim dSet As Series\n    Set dSet = pc.SeriesCollection(1)\n\n    Dim dPoints As Points\n    Set dPoints = dSet.Points\n\n    pc.ApplyDataLabels\n\n    For i = 1 To dPoints.Count\n        If ax.CategoryNames(i) = \"45+\" Then\n            With dPoints(i).DataLabel.Format.TextFrame2.TextRange.Characters\n               .Font.Fill.ForeColor.RGB = RGB(255, 0, 0)\n            End With\n        End If\n   Next i\n\nEnd Sub\n</code></pre>\n\n<p>This should set the dataLabel text to red. You can fool around with other properties as well</p>\n"}], "owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 33948350, "answer_count": 1, "score": 0, "last_activity_date": 1448580150, "creation_date": 1448489675, "last_edit_date": 1448489796, "question_id": 33927339, "link": "https://stackoverflow.com/questions/33927339/format-a-pivotchart-data-label-based-on-the-x-axis", "title": "Format a PivotChart data label based on the x axis", "body": "<p>I am trying to find a way (if possible) to change the text color of a data label to red, if the X axis happens to be a certain label. </p>\n\n<p>The issue I am having is that my charts are dynamic (are refreshed daily via PowerPivot and have date and other slicers that change what data is displayed in the charts), so even if I color the data label red, when the charts are refreshed, it reverts back to the original black font.  </p>\n\n<p>For example, in the image below, I have a chart that is tracking tickets by the amount of days that they have been open; the goal is to have all tickets resolved within 45 days; so, when the charts shows any data in the \"45+\" section, I would like the font of that data label to be red. </p>\n\n<p>Sample of my chart:</p>\n\n<p><img src=\"https://i.imgbomb.com/njzK1.jpg\" alt=\"Sample of my chart:\"></p>\n\n<p>In my research I was able to find and modify some code that make all the data labels red, but I am very new to using VBA to manipulate charts and would appreciate some help. The code I have so far:</p>\n\n<pre><code>Sub ChrtTest()\nDim i As Long\n\nSheets(\"Dashboard\").Select\nActiveSheet.ChartObjects(\"DB_Chrt_1\").Activate\nActiveChart.PlotArea.Select\n\nWith ActiveChart\n    For i = 1 To .SeriesCollection.Count\n        With .SeriesCollection(i).Format.Fill\n            Select Case .Parent.Parent.Name\n                Case \"45+\"\n                    .Visible = msoTrue\n                    With .Parent.Parent\n                        .ApplyDataLabels\n                        With .DataLabels\n                            .Position = xlLabelPositionOutsideEnd\n                            .Font.Color = vbYellow\n                        End With\n                    End With\n                Case Else\n                    .Visible = msoTrue\n                    With .Parent.Parent\n                        .ApplyDataLabels\n                        With .DataLabels\n                            .Position = xlLabelPositionOutsideEnd\n                            .Font.Color = vbRed\n                        End With\n                    End With\n             End Select\n        End With\n        Next i\n      End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "edited": false, "score": 0, "creation_date": 1448488128, "post_id": 33926959, "comment_id": 55614957, "body": "Can you try <code>serverName = &quot;ServerName\\\\InstanceName&quot;</code> ?"}, {"owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "reply_to_user": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "edited": false, "score": 1, "creation_date": 1448488377, "post_id": 33926959, "comment_id": 55615065, "body": "The \\ char needing to be escaped was my first thought also. however this did not solve the problem."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1448488534, "post_id": 33926959, "comment_id": 55615156, "body": "What happens if you set serverName = &quot;fred&quot;? Do you still lose the last part of the conn string?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1448489091, "post_id": 33926959, "comment_id": 55615421, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31940720/adodb-connection-connectionstring-property-doesnt-return-server-name\">ADODB Connection.ConnectionString property doesn&#39;t return server name</a>"}, {"owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "edited": false, "score": 1, "creation_date": 1448489095, "post_id": 33926959, "comment_id": 55615424, "body": "According to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821690.aspx\" rel=\"nofollow noreferrer\">MSDN: ADO Connection String</a>, you should use single quote mark <code>&#39;</code> in your connection string, so <code>objMyConn.ConnectionString = &quot;Provider=&#39;SQLOLEDB&#39;;Initial Catalog=&#39;MyCat&#39;;Data Source=&#39;&quot; &amp; serverName &amp; &quot;&#39;;User ID=&#39;MyId&#39;;Password=&#39;MyPwd&#39;;&quot;</code>"}, {"owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1448901913, "post_id": 33926959, "comment_id": 55762844, "body": "@DeanOC yes I still lose the rest of the connection string if I change the server name"}, {"owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "reply_to_user": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "edited": false, "score": 0, "creation_date": 1448901948, "post_id": 33926959, "comment_id": 55762869, "body": "@MincongHuang Thanks, but this does not solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "is_accepted": false, "score": 0, "last_activity_date": 1452706571, "creation_date": 1452706571, "answer_id": 34773330, "question_id": 33926959, "link": "https://stackoverflow.com/questions/33926959/vba-string-concatenation-not-working-as-expected/34773330#34773330", "title": "VBA String Concatenation not working as expected", "body": "<p>Here is the solution to this, Just in case anyone else has the same problem.</p>\n\n<p>When declaring my variable server name I had given it a length of 255, I changed the length to the appropriate length needed.</p>\n"}], "owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452706571, "creation_date": 1448487985, "question_id": 33926959, "link": "https://stackoverflow.com/questions/33926959/vba-string-concatenation-not-working-as-expected", "title": "VBA String Concatenation not working as expected", "body": "<p>Im trying to use concatenation to make a connection string.\nHeres the code:</p>\n\n<pre><code>objMyConn.ConnectionString = \"Provider=SQLOLEDB;Initial Catalog=MyCat;Data Source=\" &amp; serverName &amp; \";User ID=MyId;Password=MyPwd;\"\n</code></pre>\n\n<p>serverName is a string defined like this: serverName = \"ServerName\\InstaceName\"</p>\n\n<p>I am expecting for objMyConn.Connection string to be = to the whole connection staring however it is = to this:</p>\n\n<pre><code>Provider=SQLOLEDB;Initial Catalog=MyCat;Data Source=ServerName\\InstanceName\n</code></pre>\n\n<p>So I'm missing the last part of my connection string.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448488910, "post_id": 33926677, "comment_id": 55615343, "body": "What if the user enters their login info into Excel, then you can open an new IE instance (in the background) and control IE to login into the page and then fill the data?"}, {"owner": {"reputation": 55, "user_id": 5271428, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-v_yzS_Jl_Ko/AAAAAAAAAAI/AAAAAAAABCY/o-vK6VKndj8/photo.jpg?sz=128", "display_name": "Mohd akhtar", "link": "https://stackoverflow.com/users/5271428/mohd-akhtar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448489476, "post_id": 33926677, "comment_id": 55615591, "body": "No, for audit purpose log in details will not be used from excel. Excel would control the page post user has logged in.  Anything for that?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448489906, "post_id": 33926677, "comment_id": 55615777, "body": "I mean, you could collect the username and login at run-time via input box or form, use it to log into the webpage. That way it&#39;s just like someone is logging in on their own."}, {"owner": {"reputation": 55, "user_id": 5271428, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-v_yzS_Jl_Ko/AAAAAAAAAAI/AAAAAAAABCY/o-vK6VKndj8/photo.jpg?sz=128", "display_name": "Mohd akhtar", "link": "https://stackoverflow.com/users/5271428/mohd-akhtar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448490209, "post_id": 33926677, "comment_id": 55615906, "body": "Here&#39;s the problem. When you click login, new pop up will open to fill login details. Once you click on submit, a 3rd popup window will open where we need to put data from excel. So I don&#39;t want to get into the login part rather when the 3rd popup is ready, I want to execute the code and fill data. You follow?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448490633, "post_id": 33926677, "comment_id": 55616081, "body": "I follow completely. However, I have not had much success in trying to locate existing IE windows with VBA. There is info out there on how to handle pop-up windows, though. I am only suggesting it may be easier to do a silent login in the background to get what you need. There is some information in <a href=\"http://www.myengineeringworld.net/2013/04/save-web-pages-as-pdf-files.html\" rel=\"nofollow noreferrer\">this post</a> about Finding Windows and such. It&#39;s for a completely different solution, but if you dig through and study it a bit you may be able to get it to work for what you want to do."}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1448504627, "post_id": 33926677, "comment_id": 55620036, "body": "see <a href=\"http://stackoverflow.com/questions/20664845/get-ie-window-object-by-window-title-with-vba\">get-ie-window-object-by-window-title-with-vba</a>?"}], "owner": {"reputation": 55, "user_id": 5271428, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-v_yzS_Jl_Ko/AAAAAAAAAAI/AAAAAAAABCY/o-vK6VKndj8/photo.jpg?sz=128", "display_name": "Mohd akhtar", "link": "https://stackoverflow.com/users/5271428/mohd-akhtar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448486742, "creation_date": 1448486742, "last_edit_date": 1531164843, "question_id": 33926677, "link": "https://stackoverflow.com/questions/33926677/input-data-to-a-webpage-which-is-already-open", "title": "Input Data to a webpage which is already open.", "body": "<p>I'm looking for codes to get access to a webpage which is already open. I don't want vba to open the url for me as user will manually login into that. Once webpage is ready, vba will input data from excel to webpage. I can manage the codes to feed data but not sure of how to get in to the page which I need the data in as there would be other sites open as well.</p>\n\n<p>we can identify the webpage by title or by clicking on it. I checked some other posts from google but didn't get any luck.</p>\n\n<p>Please help me on this.</p>\n\n<p>Regards!\nMohd. </p>\n"}, {"tags": ["excel", "datatable", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448485262, "post_id": 33926276, "comment_id": 55613494, "body": "Unless the table is only a single colum, you can&#39;t do a <code>Debug.Print</code> on the <code>row.Value</code> because the row will represent an array of value<b>s</b>, and the debugger will raise an error if you try to print it."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1448485325, "creation_date": 1448485325, "answer_id": 33926340, "question_id": 33926276, "link": "https://stackoverflow.com/questions/33926276/loop-through-rows-in-dynamic-table/33926340#33926340", "title": "Loop through rows in dynamic table", "body": "<p>Unless the table is only a single colum, you can't do a <code>Debug.Print</code> on the <code>row.Value</code> because the row will represent an array of value<strong>s</strong>, and the debugger will raise an error if you try to print it.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>For Each row In wb.Worksheets(\"Colour\").ListObjects(\"Table4\").ListRows\n   For c = 1 to row.Columns.Count\n       Debug.Print row(1,c).Value\n   Next\nNext\n</code></pre>\n\n<p>That method is cell-by-cell iteration which is probably what you need.  </p>\n\n<p>Alternatively, to simply <em>print</em> the entire row value:</p>\n\n<pre><code>For Each row In wb.Worksheets(\"Colour\").ListObjects(\"Table4\").ListRows\n   Debug.Print Join(Application.Transpose(row.Value), vbTab)\nNext\n</code></pre>\n\n<p>But this doesn't give you as much freedom to manipulate cell values or anything like that.</p>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 4513651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ac10e08c79959eb37a4c8f7244a81a?s=128&d=identicon&r=PG&f=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4513651/kat"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490664, "creation_date": 1448490664, "answer_id": 33927567, "question_id": 33926276, "link": "https://stackoverflow.com/questions/33926276/loop-through-rows-in-dynamic-table/33927567#33927567", "title": "Loop through rows in dynamic table", "body": "<p>Try looping over just the column you want to match. Once you find a match, you can look for the value in the correct column in the same row.</p>\n\n<pre><code>For Each cell in wb.Worksheets(\"Colour\").Range(\"Table4[description]\")\n    If cell.value = \"Desired Value\" then\n        Debug.Print(Cells(cell.row(), Range(\"Table4[colour code]\").column))\n    End If\nNext\n</code></pre>\n\n<p>The benefit to doing it this way is you can rearrange your table and your code will still work so long as those columns still exist with the same names.</p>\n"}, {"tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 0, "last_activity_date": 1537786378, "creation_date": 1537786378, "answer_id": 52477745, "question_id": 33926276, "link": "https://stackoverflow.com/questions/33926276/loop-through-rows-in-dynamic-table/52477745#52477745", "title": "Loop through rows in dynamic table", "body": "<p>I'd suggest using the following function:</p>\n\n<pre><code>Function lrWrap(lr As ListRow) As Collection\n    Dim lo As ListObject\n    set lo = lr.Parent\n    Dim vh As Variant: vh = lo.HeaderRowRange.Value 'Header\n    Dim vr As Variant: vr = lr.Range.Value          'This row\n    Dim retCol As New Collection\n\n    'Append list row and object to collection as __ListRow and __ListObject\n    retCol.Add lr, \"__ListRow\"\n    retCol.Add lo, \"__ListObject\"\n\n    'Loop through each header and append row value with header as key into return collection\n    For i = LBound(vh, 2) To UBound(vh, 2)\n        retCol.Add vr(1, i), vh(1, i)\n    Next\n\n    'Return retCol\n    Set lrWrap = retCol\nEnd Function\n</code></pre>\n\n<p>Ultimately with the function you can do the following:</p>\n\n<pre><code>Dim row as ListRow, rCol as Collection\nFor each row in Sheets(\"MySheet\").ListObjects(\"MyTableName\").ListRows\n    set rCol = lrWrap(row)\n    debug.print rCol(\"My Table Header\")\n\n    'If you need to access the list object you can do so via __ListObject\n    debug.print rCol(\"__ListObject\").name\nnext\n</code></pre>\n\n<p>This makes your code a lot cleaner than any of the above solutions, in my opinion.</p>\n"}], "owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2399, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1537786378, "creation_date": 1448485070, "last_edit_date": 1531161705, "question_id": 33926276, "link": "https://stackoverflow.com/questions/33926276/loop-through-rows-in-dynamic-table", "title": "Loop through rows in dynamic table", "body": "<p>I have entered data into an Excel 2013 worksheet and converted it to a table (Table4) which has two columns \"colour code\" and \"description\". I want to read the table data from another workbook and loop through the table rows in VBA and where the value matches a value in the \"description\" column then I want to use the \"colour code\".  </p>\n\n<p>How do I loop through the table to do this?</p>\n\n<p>At the moment I have tried a few ways but I am finding errors.  The section of code currently looks like this:</p>\n\n<pre><code>Dim row As Range\n\nFor Each row In wb.Worksheets(\"Colour\").ListObjects(\"Table4\").ListRows\n   Debug.Print row.value\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "ibm-midrange"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 2, "creation_date": 1448484222, "post_id": 33926006, "comment_id": 55613013, "body": "You should edit your title and provide something that actually relates to what you&#39;re trying to do. It&#39;s currently just a line of code. Also, what are you asking about? Connecting to an AS400, or keeping the connection open? If keeping the connection open, why?"}, {"owner": {"reputation": 1, "user_id": 5605909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZWIy_an7ktQ/AAAAAAAAAAI/AAAAAAAAAA0/1XH66S3alqI/photo.jpg?sz=128", "display_name": "Jaime Hernandez", "link": "https://stackoverflow.com/users/5605909/jaime-hernandez"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1448484926, "post_id": 33926006, "comment_id": 55613330, "body": "Hi Lynn,  Never used this site before and now trying to find out how to edit the title .    The reason I need the connection open is that I have a control button and every time the are on a particular cell the would click the command button and it will bring in the information from the iSeries.  the problem is that the don&#39;t want to sing in to the system every time they click the button and if I can leave the connection open as long as the workbook is open that would work perfectly.   Very new to this type of programming  Thank you for your reply ..   awesome place by the way"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1448484999, "post_id": 33926006, "comment_id": 55613353, "body": "Hi Jaime, click the Edit link to edit the question and/or the title."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5605909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZWIy_an7ktQ/AAAAAAAAAAI/AAAAAAAAAA0/1XH66S3alqI/photo.jpg?sz=128", "display_name": "Jaime Hernandez", "link": "https://stackoverflow.com/users/5605909/jaime-hernandez"}, "edited": false, "score": 1, "creation_date": 1448484978, "post_id": 33926171, "comment_id": 55613348, "body": "I will try that Phil652 .  Thank you so much ..   Very new to this VB coding....    awesome"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 2, "creation_date": 1448485092, "post_id": 33926171, "comment_id": 55613402, "body": "I edited out the profanity in the error handler - same idea, just changed the name. Feel free to re-edit it to whatever :)"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 1, "user_id": 5605909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZWIy_an7ktQ/AAAAAAAAAAI/AAAAAAAAAA0/1XH66S3alqI/photo.jpg?sz=128", "display_name": "Jaime Hernandez", "link": "https://stackoverflow.com/users/5605909/jaime-hernandez"}, "edited": false, "score": 0, "creation_date": 1448485233, "post_id": 33926171, "comment_id": 55613473, "body": "Thank you for your edit. @JaimeHernandez feel free to ask any question"}, {"owner": {"reputation": 1, "user_id": 5605909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZWIy_an7ktQ/AAAAAAAAAAI/AAAAAAAAAA0/1XH66S3alqI/photo.jpg?sz=128", "display_name": "Jaime Hernandez", "link": "https://stackoverflow.com/users/5605909/jaime-hernandez"}, "edited": false, "score": 1, "creation_date": 1448485456, "post_id": 33926171, "comment_id": 55613588, "body": "I will keep you posted..   You guys have an  awesome thanksgiving."}], "tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": false, "score": 1, "last_activity_date": 1448485038, "last_edit_date": 1448485038, "creation_date": 1448484592, "answer_id": 33926171, "question_id": 33926006, "link": "https://stackoverflow.com/questions/33926006/dim-myconn-as-adodb-connection/33926171#33926171", "title": "Dim myConn As ADODB.Connection", "body": "<p>This is how I do it. </p>\n\n<pre><code>Dim myConn As New ADODB.Connection\nDim myRs As New ADODB.Recordset\n\nOn Error GoTo ErrorHandler\n\ncon.Open \"PROVIDER=IBMDAS400;Data Source=999.999.999.999;USER ID= ;PASSWORD= ;\"\n\nSet myRs.ActiveConnection = myConn\n\nEnd\n\nExit Sub\n\nErrorHandler:\n\nMsgBox \"Can not connect\", vbInformation, cHeading\nEnd\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 0, "last_activity_date": 1448558507, "creation_date": 1448558507, "answer_id": 33944172, "question_id": 33926006, "link": "https://stackoverflow.com/questions/33926006/dim-myconn-as-adodb-connection/33944172#33944172", "title": "Dim myConn As ADODB.Connection", "body": "<p>I can sympathize with you as I had to figure this out as well before I knew much about VBA.  Below is a simple connection and loop through results example.  And yes, you shouldn't use Activate but for the sake of this example I through it in. </p>\n\n<p>Note that you should clean up the connection at the end.  If you use an error handler than make sure you close any open connections before exiting even after an error.</p>\n\n<pre><code>Dim cnn As ADODB.Connection\nDim rst As ADODB.Recordset\n\nSet cnn = New ADODB.Connection\nSet rst = New ADODB.Recordset\n\ncnn.Open \"PROVIDER=IBMDAS400;Data Source=999.999.999.999;USER ID= ;PASSWORD= ;\"\nrst.ActiveConnection = cnn\nrst.CursorLocation = adUseServer\n\n'Query String (Specific to your database setup)\nrst.Source = \"SELECT DISTINCT F3002.IXLITM \" _\n                &amp; \"FROM WYATT.PRDDTA.F3002 F3002 \" _\n                &amp; \"WHERE (F3002.IXKITL='30P') AND (F3002.IXTBM='E')\"\n\nrst.Open\n\nWorksheets(\"Sheet1\").Range(\"A1\").Activate\n\nDo Until rst.EOF\n    ActiveCell.Value = rst.Fields(\"IXLITM\")\n\n    rst.MoveNext\n    ActiveCell.Offset(1, 0).Activate\nLoop\n\n'Clean up\nrst.Close\nSet rst = Nothing\nSet cnn = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5605909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZWIy_an7ktQ/AAAAAAAAAAI/AAAAAAAAAA0/1XH66S3alqI/photo.jpg?sz=128", "display_name": "Jaime Hernandez", "link": "https://stackoverflow.com/users/5605909/jaime-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1448558507, "creation_date": 1448483916, "last_edit_date": 1448484041, "question_id": 33926006, "link": "https://stackoverflow.com/questions/33926006/dim-myconn-as-adodb-connection", "title": "Dim myConn As ADODB.Connection", "body": "<p>I am trying a couple of things and one is to connect an excel workbook with an AS400 to get the description to a part number in our system but trying to keep the connection open or at least until the workbook is closed.\nDoes anyone have any suggestions?</p>\n\n<pre><code>Public Sub GetPartNumbers()\n\n    Dim myConn As ADODB.Connection\n    Dim myRS As ADODB.Recordset\n''    Dim selVal As String\n''    Dim selRow As Integer\n    Set myConn = New ADODB.Connection\n    myConn.ConnectionString = \"Provider=SEQUEL ViewPoint;\"\n    myConn.Open\n    Set myRS = New ADODB.Recordset\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1448483747, "post_id": 33925923, "comment_id": 55612744, "body": "Put quotes around the <code>T</code>s in your Cells.  So <code>Range(Cells(LR, &quot;T&quot;), Cells(LR + 1, &quot;T&quot;))</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1448484054, "post_id": 33925923, "comment_id": 55612923, "body": "-or use the column number instead of the letter"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "edited": false, "score": 0, "creation_date": 1448491867, "post_id": 33925923, "comment_id": 55616565, "body": "You may also want to consider using the <code>Long</code> data type instead of <code>Integer</code> for your <code>LR</code> row counter variable."}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 4513651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ac10e08c79959eb37a4c8f7244a81a?s=128&d=identicon&r=PG&f=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4513651/kat"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490965, "creation_date": 1448490965, "answer_id": 33927631, "question_id": 33925923, "link": "https://stackoverflow.com/questions/33925923/range-define-not-working/33927631#33927631", "title": "Range define not working", "body": "<p>When you say this:</p>\n\n<pre><code>Cells(LR + 1, T)\n</code></pre>\n\n<p>It thinks that T is a variable just like LR is. Since you want it to literally be \"T\" you need to put it in quotation marks or assign it to a variable and use that. So either:</p>\n\n<pre><code>Cells(LR+1, \"T\")\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>dim col as string\ncol = \"T\"\nCells(LR+1, col)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5605914, "user_type": "registered", "profile_image": "https://graph.facebook.com/503678939790401/picture?type=large", "display_name": "Jitendra Kumar", "link": "https://stackoverflow.com/users/5605914/jitendra-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448490965, "creation_date": 1448483576, "last_edit_date": 1531164843, "question_id": 33925923, "link": "https://stackoverflow.com/questions/33925923/range-define-not-working", "title": "Range define not working", "body": "<p>I receive the error \"application defined or object defined error\" when running the below code: </p>\n\n<pre><code>Sub FillRowst()\n     Dim LR As Integer\n      LR = Range(\"M\" &amp; Rows.count).End(xlUp).row\n     Range(\"T2\").AutoFill Destination:=Range(Cells(LR, T), Cells(LR + 1, T)), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n\n<p>It is working fine with following code</p>\n\n<pre><code>Sub FillRowsu()\n     Dim LR As Integer\n      LR = Range(\"M\" &amp; Rows.count).End(xlUp).row\n     Range(\"T2\").AutoFill Destination:=Range(\"T2:T\" &amp; LR + 1), Type:=xlFillDefault\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2492, "user_id": 2807860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd25593e6c2a32247f10feebe10a0b63?s=128&d=identicon&r=PG&f=1", "display_name": "Elad Joseph", "link": "https://stackoverflow.com/users/2807860/elad-joseph"}, "edited": false, "score": 1, "creation_date": 1448484099, "post_id": 33925822, "comment_id": 55612949, "body": "Can you at least post the code you have tried? See <a href=\"https://msdn.microsoft.com/en-us/library/00wf8zk9(v=vs.90).aspx\" rel=\"nofollow noreferrer\">IsDate</a>"}, {"owner": {"reputation": 1, "user_id": 5605878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lT6deOyxyPc/AAAAAAAAAAI/AAAAAAABP8o/n-a3XcfimOQ/photo.jpg?sz=128", "display_name": "krishart16", "link": "https://stackoverflow.com/users/5605878/krishart16"}, "reply_to_user": {"reputation": 2492, "user_id": 2807860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd25593e6c2a32247f10feebe10a0b63?s=128&d=identicon&r=PG&f=1", "display_name": "Elad Joseph", "link": "https://stackoverflow.com/users/2807860/elad-joseph"}, "edited": false, "score": 0, "creation_date": 1448628669, "post_id": 33925822, "comment_id": 55673205, "body": "If IsDate(ActiveCell.Value) &lt;&gt; &quot;a date value&quot; Then MsgBox &quot;This is not a date&quot;, vbOKOnly + vbInformation, &quot;Hello!!!&quot; Else Format ([ActiveCell.Value]), &quot;Long Date&quot;) End If"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5605878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lT6deOyxyPc/AAAAAAAAAAI/AAAAAAABP8o/n-a3XcfimOQ/photo.jpg?sz=128", "display_name": "krishart16", "link": "https://stackoverflow.com/users/5605878/krishart16"}, "edited": false, "score": 0, "creation_date": 1448628737, "post_id": 33927731, "comment_id": 55673251, "body": "This is what I have so far, when I try the code line you posted, I receive a message from VB that &quot;expected end of statement.&quot;"}, {"owner": {"reputation": 1, "user_id": 5605878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lT6deOyxyPc/AAAAAAAAAAI/AAAAAAABP8o/n-a3XcfimOQ/photo.jpg?sz=128", "display_name": "krishart16", "link": "https://stackoverflow.com/users/5605878/krishart16"}, "edited": false, "score": 0, "creation_date": 1448628744, "post_id": 33927731, "comment_id": 55673256, "body": "If IsDate(ActiveCell.Value) &lt;&gt; &quot;a date value&quot; Then MsgBox &quot;This is not a date&quot;, vbOKOnly + vbInformation, &quot;Hello!!!&quot; Else Format ([ActiveCell.Value]), &quot;Long Date&quot;) End If"}], "tags": [], "owner": {"reputation": 219, "user_id": 4513651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ac10e08c79959eb37a4c8f7244a81a?s=128&d=identicon&r=PG&f=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4513651/kat"}, "is_accepted": false, "score": 0, "last_activity_date": 1448491471, "creation_date": 1448491471, "answer_id": 33927731, "question_id": 33925822, "link": "https://stackoverflow.com/questions/33925822/excel-vba-check-date-set-date-in-long-format/33927731#33927731", "title": "Excel VBA Check Date, Set Date in long format", "body": "<p>To check if a value is a date, use the IsDate() function. To format a date a particular way, you can use the Format() function. You can find a reference on <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755.aspx\" rel=\"nofollow\">MSDN</a>. In short, you want to use an expression along the lines of:</p>\n\n<pre><code>Format([date to format], \"Long Date\")\n</code></pre>\n\n<p>If you already found these functions and are running into other errors then you should post your code. We cannot debug code that we can't see.</p>\n"}], "owner": {"reputation": 1, "user_id": 5605878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lT6deOyxyPc/AAAAAAAAAAI/AAAAAAABP8o/n-a3XcfimOQ/photo.jpg?sz=128", "display_name": "krishart16", "link": "https://stackoverflow.com/users/5605878/krishart16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1448491471, "creation_date": 1448483173, "last_edit_date": 1531164843, "question_id": 33925822, "link": "https://stackoverflow.com/questions/33925822/excel-vba-check-date-set-date-in-long-format", "title": "Excel VBA Check Date, Set Date in long format", "body": "<p>I am new to VBA. I am trying to learn simple things and I have a specific problem I am trying to figure out.  I get the gist of VBA, however actually trying to put the code into place is driving me crazy. Here is what I am trying to do.</p>\n\n<p>I have a date value in cell C2 of 11/24/2015. I want to use VBA to do the following:</p>\n\n<p>a.  Check the active cell to see if the value in the cell is a date.\nb.  If it is not a date, display a message that reads \"This is not a date\".\nc.  If it is a date, format the date to display the complete date (day, month,      and year) in the long date format.</p>\n\n<p>This seems simple enough.  I need to use an If Then Else statement and I have been trying different variations of VBA code to get this to work, with no luck. Can you please help me?  Thank you in advance!!</p>\n"}, {"tags": ["xml", "vba", "excel", "xslt"], "comments": [{"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1504229991, "post_id": 33925567, "comment_id": 78944473, "body": "Don&#39;t know how encoding works in VBA, but maybe you can try to replace the trademark sign to something that you can convert back later."}], "owner": {"reputation": 117, "user_id": 5191231, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7ywW4.jpg?s=128&g=1", "display_name": "John Minze", "link": "https://stackoverflow.com/users/5191231/john-minze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502595750, "creation_date": 1448482213, "last_edit_date": 1502595750, "question_id": 33925567, "link": "https://stackoverflow.com/questions/33925567/excel-vba-is-converting-my-trademark-tm-in-my-xml-to-t-when-i-run-an-xsl", "title": "Excel VBA is converting my \u2018\u2122\u2019 (Trademark TM) in my XML to \u2018T\u2019 when I run an XSLT which converts UTF-8 to ISO-8859-1", "body": "<p>I have the following XSLT to take an XML encoded UTF-8, that was originally created from Excel, and create the same XML but encode ISO-8859-1</p>\n\n<pre><code>&lt;xsl:stylesheet version=\"3.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\"&gt;\n&lt;xsl:output method=\"xml\" version=\"1.0\" encoding=\"iso-8859-1\" indent=\"yes\"/&gt;\n    &lt;xsl:template match=\"@* | node()\"&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>It works well and when I use XMLspy to run the transform the <code>\u2122</code> becomes <code>&amp;#8482</code> which is great. The issue I have is when I use the following Excel VBA, thank you Parfait, to run the XSLT the <code>\u2122</code> in the XML becomes <code>T</code>.</p>\n\n<pre><code>Set xmldoc = CreateObject(\"MSXML2.DOMDocument\")\nSet xsldoc = CreateObject(\"MSXML2.DOMDocument\")\nSet newdoc = CreateObject(\"MSXML2.DOMDocument\")\n\n'LOAD XML\nxmldoc.async = False\nxmldoc.Load \u201cpath and file name &amp; fileName.xml\"\n\n'LOAD XSL\nxsldoc.async = False\nxsldoc.Load \"path and file name.xslt\"\n\n'TRANSFORM\nxmldoc.transformNodeToObject xsldoc, newdoc\nnewdoc.Save \u201cPath and file name.xml\"\n</code></pre>\n\n<p>I don\u2019t understand why when Excel runs the XSLT the results are different. I originally research if the Excel could export XML encoded ISO-8859-1 in the first place but that does not seem to be an option.</p>\n"}, {"tags": ["html", "excel", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 1, "creation_date": 1448483441, "post_id": 33925735, "comment_id": 55612603, "body": "the e-mail sends properly using .BCC"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448483464, "post_id": 33925735, "comment_id": 55612615, "body": "i tried out this edit but my emails still dont retain the original spacing - line1line2line3"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448483668, "post_id": 33925735, "comment_id": 55612706, "body": "the original spacing? I am confused, because you only set the body from one cell? Are there carriage returns in this cell that creates the spacing?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448483880, "post_id": 33925735, "comment_id": 55612816, "body": "yep, i am new to vba so i set my whole paragraph from one cell. i don&#39;t know what carriage returns are"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448483940, "post_id": 33925735, "comment_id": 55612852, "body": "can you post a screen shot of your &quot;whole paragraph in one cell&quot;? Do you press <code>Ctrl+Enter</code> when you are making your paragraph in one cell (creating a carriage return)?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448484219, "post_id": 33925735, "comment_id": 55613012, "body": "added in my OP. i basically have the whole paragraph prepared so I reference it in my code"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1448488604, "post_id": 33925735, "comment_id": 55615184, "body": "I see now. The answer you accepted is a good idea. I usually do it line by line in my code (mainly because I have variables in the body depending on the email that are easy to see. You could also add the <code>&lt;BODY&gt;</code> HTML tagging into your cell as well to set fonts and stuff."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1448483692, "last_edit_date": 1448483692, "creation_date": 1448482830, "answer_id": 33925735, "question_id": 33925433, "link": "https://stackoverflow.com/questions/33925433/retain-original-paragraph-spacing-with-htmlbody/33925735#33925735", "title": "Retain original paragraph spacing with HTMLbody", "body": "<p>It would serve you well to read up on <a href=\"http://www.w3schools.com/html/html_formatting.asp\" rel=\"nofollow\">coding HTML</a>.</p>\n\n<p>For now, you can do this:</p>\n\n<p>To load the default signature (already set in outlook), you can do the below (and eliminate your code to get the signature):</p>\n\n<pre><code>With OutLookMailItem\n     .Display\n     signature = .HTMLBody\n     ....\n</code></pre>\n\n<p>To format the HTML for the body you can do something like this:</p>\n\n<pre><code>'change font info as needed\nbod = \"&lt;BODY style=font-size:12pt font-family:Times New Roman font-color:blue&gt;\" _\n      &amp; \"&lt;p&gt;\" &amp; Cells(iCounter, 16).Value &amp; \"&lt;/p&gt;\" _\n      &amp; \"&lt;/BODY&gt;\" _\n      &amp; signature\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 3, "last_activity_date": 1571626241, "last_edit_date": 1571626241, "creation_date": 1448484232, "answer_id": 33926084, "question_id": 33925433, "link": "https://stackoverflow.com/questions/33925433/retain-original-paragraph-spacing-with-htmlbody/33926084#33926084", "title": "Retain original paragraph spacing with HTMLbody", "body": "<p>I would echo Scott Holtzman's advice to read up on HTML. Whenever I've needed to do HTML formatting in an email, I've found that <code>&lt;br&gt;</code> is the most straightforward option. Using one <code>&lt;br&gt;</code> will move text to the next line. To create white space, (like, a blank line between paragraphs) use <code>&lt;br&gt;&lt;br&gt;</code>.</p>\n\n<p>You can put this right into the cell where your text is located. The brackets will mark this as HTML and it will be rendered in the email as a break rather than as readable text.</p>\n\n<p>In other words:  <code>Thanks,&lt;br&gt;Cthulhu</code> in your excel cell, will render as <br>\n\"Thanks,<br>Cthulhu\"<br> in your email.</p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 33926084, "answer_count": 2, "score": 1, "last_activity_date": 1571626241, "creation_date": 1448481733, "last_edit_date": 1531161705, "question_id": 33925433, "link": "https://stackoverflow.com/questions/33925433/retain-original-paragraph-spacing-with-htmlbody", "title": "Retain original paragraph spacing with HTMLbody", "body": "<p><a href=\"https://i.stack.imgur.com/S5IhO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S5IhO.jpg\" alt=\"enter image description here\"></a>    Sub ColdEmail()</p>\n\n<pre><code>Dim OutLookApp As Object\nDim OutLookMailItem As Object\nDim lastrow As Long\nDim iCounter As Long\nDim MailDest As String\nDim subj As String\nDim bod As String\nDim ws As Worksheet\nDim signature As String\n\nlastrow = ThisWorkbook.Worksheets(\"Prospects\").Cells(Rows.Count, \"D\").End(xlUp).Row 'change worksheet\n\nFor iCounter = 2 To lastrow\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n\n     signature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\n    If Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\n        signature = signature &amp; Dir$(signature &amp; \"*.htm\")\n    Else:\n        signature = \"\"\n    End If\n    signature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\n\n    With OutLookMailItem\n\n        subj = \"\"\n        MailDest = \"\"\n        bod = \"\"\n\n        If Cells(iCounter, 13) = \"*\" Then\n\n            subj = Cells(iCounter, 14).Value\n            MailDest = Cells(iCounter, 7).Value\n            bod = Cells(iCounter, 16).Value\n\n            .BCC = MailDest\n            .Subject = subj\n            .HTMLBody = bod &amp; signature\n            .Send\n        End If\n\n    End With\n\n\n\nNext iCounter\n\nEnd Sub\n</code></pre>\n\n<p>The code above sends emails automatically to a column of e-mail addresses and it gets the body paragraph from a column in Excel as well.</p>\n\n<p>I wanted my messages to include my default signature in Outlook, so I changed my code to HTMLbody.</p>\n\n<p>The e-mails sent out don't retain the original paragraph spacing:</p>\n\n<pre><code>line 1\n\nline 2\n\nline 3\n</code></pre>\n\n<p>It looks like this now: <code>line1 line2 line3</code>.</p>\n"}, {"tags": ["vba", "object", "collections", "properties", "object-properties"], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "edited": false, "score": 0, "creation_date": 1448489918, "post_id": 33925513, "comment_id": 55615783, "body": "I tried this but I still get the same result.  Sorry"}, {"owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "edited": false, "score": 0, "creation_date": 1448507216, "post_id": 33925513, "comment_id": 55620650, "body": "I missed to addition of the word set before the word <code>pPrompts</code> now it works.  Thanks"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1448527427, "last_edit_date": 1448527427, "creation_date": 1448482048, "answer_id": 33925513, "question_id": 33925195, "link": "https://stackoverflow.com/questions/33925195/excel-vba-adding-collection-to-class-property/33925513#33925513", "title": "Excel VBA: Adding Collection to class property", "body": "<p>As <code>Collection</code> is an object, you should use <code>Set</code> property instead of <code>Let</code>, <br>\n (notice the <code>Set</code> to assign the value) :</p>\n\n<pre><code>Public Property Set Prompts(Val As Collection)\n     Set pPrompts = Val\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 592, "user_id": 2016653, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/34cd973e27413af944d8d9acb4d3cafc?s=128&d=identicon&r=PG", "display_name": "joeb", "link": "https://stackoverflow.com/users/2016653/joeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 33925513, "answer_count": 1, "score": 1, "last_activity_date": 1448527427, "creation_date": 1448480770, "last_edit_date": 1448483917, "question_id": 33925195, "link": "https://stackoverflow.com/questions/33925195/excel-vba-adding-collection-to-class-property", "title": "Excel VBA: Adding Collection to class property", "body": "<p>I'm working on a little project and I keep getting a problem with one of the \"letters\" where it's saying Arguement not optional.</p>\n\n<p>I have clsXML which is here</p>\n\n<p>The line i am getting the error on is here <code>CurrentProduct.Prompts = PromptsCollection</code></p>\n\n<pre><code>Private Function GetProductsCollection() As Collection\nDim AWP As New clsAWP\nDim PurchaseOrderProductCollection As New Collection\nDim ProductsTopRange As Range\nDim ProductsBottomRange As Range\nDim Row As Range\nDim Product As New clsProduct\nDim PurchaseOrderRange As Range\n\nSet ProductsTopRange = Sheets(\"Purchase Order\").Range(\"ProductTableTop\")\nSet ProductsBottomRange = Sheets(\"Purchase Order\").Range(\"ProductTableBottom\")\n\n'Add all Top Range Products\nFor Each Row In ProductsTopRange.Rows\n    If Not IsEmpty(Row.Cells(1, 1).Value) Then\n        Dim CurrentSKU As New clsSKU\n        Set CurrentSKU = Product.GetSKU(Row.Cells(1, 1).Value)\n        If Not IsEmpty(CurrentSKU) And CurrentSKU.Category = \"Product\" Then\n            Dim CurrentProduct As New clsProduct\n            CurrentProduct.SKU = Row.Cells(1, 1).Value\n            CurrentProduct.Width = Row.Cells(1, 2).Value\n            CurrentProduct.Height = Row.Cells(1, 3).Value\n            CurrentProduct.Depth = Row.Cells(1, 4).Value\n            CurrentProduct.Skins = Row.Cells(1, 10).Value\n            CurrentProduct.Swing = Row.Cells(1, 13).Value\n            CurrentProduct.Qty = Row.Cells(1, 14).Value\n\n            Dim PromptsCollection As New Collection\n            'add all prompts to collection\n            Dim ToeKickHeight As New clsPrompt\n            ToeKickHeight.Name = \"Toe_Kick_Height\"\n            ToeKickHeight.Value = Row.Cells(1, 18).Value\n            PromptsCollection.Add ToeKickHeight\n\n            Dim AdjShelfQty As New clsPrompt\n            AdjShelfQty.Name = \"Adj_Shelf_Qty\"\n            AdjShelfQty.Value = Row.Cells(1, 19).Value\n            PromptsCollection.Add AdjShelfQty\n\n            Dim LSW As New clsPrompt\n            LSW.Name = \"Left_Stile_Width\"\n            LSW.Value = Row.Cells(1, 20).Value\n            PromptsCollection.Add LSW\n\n            Dim RSW As New clsPrompt\n            RSW.Name = \"Right_Stile_Width\"\n            RSW.Value = Row.Cells(1, 21).Value\n            PromptsCollection.Add RSW\n\n            Dim TRW As New clsPrompt\n            TRW.Name = \"Top_Rail_Width\"\n            TRW.Value = Row.Cells(1, 22).Value\n            PromptsCollection.Add TRW\n\n            Dim BRW As New clsPrompt\n            BRW.Name = \"Bottom_Rail_Width\"\n            BRW.Value = Row.Cells(1, 23).Value\n            PromptsCollection.Add BRW\n\n            Dim ELSFFD As New clsPrompt\n            ELSFFD.Name = \"Extend_Left_Side_FF_Down\"\n            ELSFFD.Value = Row.Cells(1, 24).Value\n            PromptsCollection.Add ELSFFD\n\n            Dim ELSFFU As New clsPrompt\n            ELSFFU.Name = \"Extend_Left_Side_FF_Up\"\n            ELSFFU.Value = Row.Cells(1, 25).Value\n            PromptsCollection.Add ELSFFU\n\n            Dim ERSFFD As New clsPrompt\n            ERSFFD.Name = \"Extend_Right_Side_FF_Down\"\n            ERSFFD.Value = Row.Cells(1, 26).Value\n            PromptsCollection.Add ERSFFD\n\n            Dim ERSFFU As New clsPrompt\n            ERSFFU.Name = \"Extend_Right_Side_FF_Up\"\n            ERSFFU.Value = Row.Cells(1, 27).Value\n            PromptsCollection.Add ERSFFU\n\n            Dim ETR As New clsPrompt\n            ETR.Name = \"Extend_Top_Rail\"\n            ETR.Value = Row.Cells(1, 28).Value\n            PromptsCollection.Add ETR\n\n            Dim EBR As New clsPrompt\n            EBR.Name = \"Extend_Bottom_Rail\"\n            EBR.Value = Row.Cells(1, 29).Value\n            PromptsCollection.Add EBR\n\nMsgBox (PromptsCollection.Count)\n            CurrentProduct.Prompts = PromptsCollection\n            CurrentProduct.MVProductName = CurrentSKU.MVProductName\n\n            PurchaseOrderProductCollection.Add CurrentProduct\n        End If\n    Else\n        'skip the row\n    End If\nNext\n</code></pre>\n\n<p>and here is taking a look inside the product class, I've removed all the other getters and letters for clarity.</p>\n\n<pre><code> Option Explicit\n\n Private pSKU As String\n Private pWidth As String\n Private pHeight As String\n Private pDepth As String\n Private pSkins As String\n Private pSwing As String\n Private pQty As String\n Private pToeKickHeight As String\n Private pAdjShelfQty As String\n Private pLeftStileWidth As String\n Private pRightStileWidth As String\n Private pTopRailWidth As String\n Private pBottomRailWidth As String\n Private pExtLSFFD As String\n Private pExtLSFFU As String\n Private pExtRSFFD As String\n Private pExtRSFFU As String\n Private pExtTopRail As String\n Private pExtBottomRail As String\n Private pMVProductName As String\n Private pPrompts As Collection\n\nPublic Property Get Prompts() As Collection\nPrompts = pPrompts\nEnd Property\n\nPublic Property Let Prompts(Val As Collection)\npPrompts = Val\nEnd Property\n\nPublic Function GetSKU(ByVal SKU As String) As Object\n\nDim DataTable As Range\nDim ProductSKURange As Range\nDim Product As New clsSKU\nDim SheetName As String\n\nSheetName = \"Purchase Order\"\nSet DataTable = Range(\"DataTable\")\nSet ProductSKURange = DataTable.Find(SKU, LookIn:=xlValues)\nIf Not ProductSKURange Is Nothing Then\n    Product.SKU = Sheets(SheetName).Range(\"AE\" &amp; ProductSKURange.Row).Value\n    Product.A = CDbl(Sheets(SheetName).Range(\"AF\" &amp; ProductSKURange.Row).Value)\n    Product.B = CDbl(Sheets(SheetName).Range(\"AG\" &amp; ProductSKURange.Row).Value)\n    Product.C = CDbl(Sheets(SheetName).Range(\"AH\" &amp; ProductSKURange.Row).Value)\n    Product.D = CDbl(Sheets(SheetName).Range(\"AI\" &amp; ProductSKURange.Row).Value)\n    Product.E = CDbl(Sheets(SheetName).Range(\"AJ\" &amp; ProductSKURange.Row).Value)\n    Product.F = CDbl(Sheets(SheetName).Range(\"AK\" &amp; ProductSKURange.Row).Value)\n    Product.G = CDbl(Sheets(SheetName).Range(\"AL\" &amp; ProductSKURange.Row).Value)\n    Product.Description = Sheets(SheetName).Range(\"AM\" &amp; ProductSKURange.Row).Value\n    Product.MVProductName = Sheets(SheetName).Range(\"AN\" &amp; ProductSKURange.Row).Value\n    Product.Width = Sheets(SheetName).Range(\"AO\" &amp; ProductSKURange.Row).Value\n    Product.Height = Sheets(SheetName).Range(\"AP\" &amp; ProductSKURange.Row).Value\n    Product.Depth = Sheets(SheetName).Range(\"AQ\" &amp; ProductSKURange.Row).Value\n    Product.Category = Sheets(SheetName).Range(\"AR\" &amp; ProductSKURange.Row).Value\nEnd If\n\nSet GetSKU = Product\nEnd Function\n</code></pre>\n\n<p>Please let me know where I am going wrong.  Thanks in advance.</p>\n"}, {"tags": [".net", "vba", "com"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1448482148, "post_id": 33925165, "comment_id": 55611958, "body": "Have you tried <a href=\"http://stackoverflow.com/q/11570262/1188513\">this</a> and <a href=\"http://stackoverflow.com/a/29783710/1188513\">this</a>?"}, {"owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "edited": false, "score": 0, "creation_date": 1448482243, "post_id": 33925165, "comment_id": 55612002, "body": "Please read my response on your other post.....<a href=\"http://stackoverflow.com/questions/33923624/cant-add-a-reference-to-the-specified-file/33923711?noredirect=1#comment55610787_33923711\" title=\"cant add a reference to the specified file\">stackoverflow.com/questions/33923624/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1448483115, "post_id": 33925165, "comment_id": 55612439, "body": "COM types don&#39;t have &quot;constructors&quot;, that&#39;s why you can&#39;t expose a managed type to COM if it only has a parameterized constructor - actually you <i>can</i>, but your COM client won&#39;t be able to instantiate it. ...and before you hit that wall, you can&#39;t expose generic types to COM either. =)"}], "answers": [{"comments": [{"owner": {"reputation": 5314, "user_id": 695134, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/98db04b16073eb8da1d437432452c355?s=128&d=identicon&r=PG", "display_name": "Neil Walker", "link": "https://stackoverflow.com/users/695134/neil-walker"}, "edited": false, "score": 1, "creation_date": 1448484183, "post_id": 33925667, "comment_id": 55612991, "body": "thanks, I&#39;ve updated my code above, but still no joy. Does it need an Interface and Interface type, etc setup? tbh, I thought it would be a simple job, but I can&#39;t find anything that takes you through this."}, {"owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "reply_to_user": {"reputation": 5314, "user_id": 695134, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/98db04b16073eb8da1d437432452c355?s=128&d=identicon&r=PG", "display_name": "Neil Walker", "link": "https://stackoverflow.com/users/695134/neil-walker"}, "edited": false, "score": 0, "creation_date": 1448484601, "post_id": 33925667, "comment_id": 55613196, "body": "@NeilWalker You made your methods com visible but not your class. You shouldn&#39;t need any of the other stuff."}, {"owner": {"reputation": 5314, "user_id": 695134, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/98db04b16073eb8da1d437432452c355?s=128&d=identicon&r=PG", "display_name": "Neil Walker", "link": "https://stackoverflow.com/users/695134/neil-walker"}, "edited": false, "score": 0, "creation_date": 1448485648, "post_id": 33925667, "comment_id": 55613687, "body": "Still doesn&#39;t work. Your assembly details are already there, I can see the class ok, just not the methods, and I&#39;ve added an interface and this is visible with the methods in VBA, just not the class. Thanks for your patience :)"}], "tags": [], "owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "is_accepted": false, "score": 2, "last_activity_date": 1448485094, "last_edit_date": 1448485094, "creation_date": 1448482552, "answer_id": 33925667, "question_id": 33925165, "link": "https://stackoverflow.com/questions/33925165/tlb-generates-no-methods/33925667#33925667", "title": "tlb generates no methods", "body": "<p>Oh I see the difference is now you posted your code.... </p>\n\n<p>You need to make functions you want to use COM Visible. You can do that in a properties file or above you class like this </p>\n\n<pre><code>[ComVisible(true)]\n[Guid(\"blah\")]\npublic class ConnectionUtilities: IConnectionUtilities\n{\n}\n</code></pre>\n\n<p>Try making your entire Assembly ComVisible by going into your C# Project's properties->AssemblyInfo.cs and declaring like this:</p>\n\n<pre><code>// Setting ComVisible to false makes the types in this assembly not visible \n// to COM components.  If you need to access a type in this assembly from \n// COM, set the ComVisible attribute to true on that type.\n[assembly: ComVisible(true)]\n\n// The following GUID is for the ID of the typelib if this project is exposed to COM\n[assembly: Guid(\"0a2d43c9-da5e-4a59-8006-ff131b33d86c\")]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5314, "user_id": 695134, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/98db04b16073eb8da1d437432452c355?s=128&d=identicon&r=PG", "display_name": "Neil Walker", "link": "https://stackoverflow.com/users/695134/neil-walker"}, "is_accepted": false, "score": 2, "last_activity_date": 1448490044, "creation_date": 1448490044, "answer_id": 33927441, "question_id": 33925165, "link": "https://stackoverflow.com/questions/33925165/tlb-generates-no-methods/33927441#33927441", "title": "tlb generates no methods", "body": "<p>Firstly, thanks for everyone's help.</p>\n\n<p>The solution was rather simple in the end. I simply had to add '/codebase' to the regasm.exe (or sign it and add it via gacutil).</p>\n\n<p>Also, I haven't checked any other permutation, but this is the only way it worked for me:</p>\n\n<pre><code>namespace NeilLibrary\n    {\n        [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]\n        public interface INeilTest\n        {\n            [DispId(1)]\n            string DoMethodReturn(string name);\n            [DispId(2)]\n            string DoMethodOut(string name, out string name2, out bool isPrev);\n        }\n\n        [Guid(\"BA7CC0F2-9C07-4EF9-B799-18D317B7E293\")]\n        [ComVisible(true)]\n        [ClassInterface(ClassInterfaceType.None)]\n        [ProgId(\"NeilLibrary.NeilTest\")]\n        public class NeilTest : INeilTest\n        {\n            [ComVisible(true)]\n            public string DoMethodReturn(string name)\n            {\n                return \"name: \" + name;\n            }\n\n            [ComVisible(true)]\n            public string DoMethodOut(string name, out string name2, out bool isPrev)\n            {\n                name2 = \"New Value\";\n                isPrev = true;\n                return \"Name: \" + name;\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 5314, "user_id": 695134, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/98db04b16073eb8da1d437432452c355?s=128&d=identicon&r=PG", "display_name": "Neil Walker", "link": "https://stackoverflow.com/users/695134/neil-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448490044, "creation_date": 1448480676, "last_edit_date": 1448484605, "question_id": 33925165, "link": "https://stackoverflow.com/questions/33925165/tlb-generates-no-methods", "title": "tlb generates no methods", "body": "<p>I've created a class library DLL and wrapped it up, but when I use it within VBA (Excel) it has no methods. All is well from another .NET program:</p>\n\n<p>This is my code:</p>\n\n<pre><code>    namespace NeilLibrary\n    {\n        public interface INeilTest\n        {\n            string DoMethodReturn(string name);\n            string DoMethodOut(string name, out string name2, out bool isPrev);\n        }\n        [Guid(\"BA7CC0F2-9C07-4EF9-B799-18D317B7E293\")]\n        [ComVisible(true)]\n        public class NeilTest\n        {\n            public NeilTest() { }\n            [ComVisible(true)]\n            public string DoMethodReturn(string name)\n            {\n                return \"name: \" + name;\n            }\n\n            [ComVisible(true)]\n            public string DoMethodOut(string name, out string name2, out bool isPrev)\n            {\n                name2 = \"New Value\";\n                isPrev = true;\n                return \"Name: \" + name;\n            }\n        }        }\n</code></pre>\n\n<p>I built it with COM enabled in the assembly and I ran the following command:</p>\n\n<pre><code>regasm.exe NeilLibrary.dll /tlb:neil.tlb\n</code></pre>\n\n<p>Which worked fine. In Excel I imported the tlb and it appears in the object browser so it's created ok, but there are no methods. The interface is shown though, with it's methods, but that's not much use.</p>\n\n<p>Can somebody help please.</p>\n\n<p>I added the no-arg constructor because I read somewhere with someone with a similar problem had to do this.</p>\n"}, {"tags": ["vba", "ms-word", "ms-office"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448491469, "post_id": 33924980, "comment_id": 55616401, "body": "Word should remember what&#39;s been marked as &quot;editable&quot;. But you have to apply the correct Protection type when using the Protect method. As it stands, you&#39;re telling Word to NOT protect at the end of the macro."}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448508991, "post_id": 33924980, "comment_id": 55621040, "body": "Thank you Cindy. I posted my latest effort as I am running out of options! I would think that &#39;wdAllowOnlyReading&#39; would do the trick, but it is not allowing the user to manipulate the edit-able fields after the macro runs. Any ideas what i&#39;m missing?  thanks again,"}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1448524504, "post_id": 33924980, "comment_id": 55626390, "body": "Can&#39;t you just use protection type &quot;Filling in forms&quot;?"}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1448558578, "post_id": 33924980, "comment_id": 55647418, "body": "@DanL, No. That doesn&#39;t work either. Thank you"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448558930, "post_id": 33924980, "comment_id": 55647583, "body": "I&#39;m surprised Dan&#39;s suggestion doesn&#39;t work... Could you please give us exact repro steps for setting up a valid test?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448616817, "post_id": 33924980, "comment_id": 55666348, "body": "Have you tried your script without unblocking the protection"}], "owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594054552, "creation_date": 1448479945, "last_edit_date": 1594054552, "question_id": 33924980, "link": "https://stackoverflow.com/questions/33924980/how-to-re-protect-part-of-a-word-doc-with-vba", "title": "How to re-protect part of a Word Doc with VBA", "body": "<p>I have a custom template that I built in Word. </p>\n\n<p>I used Content controls for certain fill-able fields and used 'Restrict editing' - 'No changes' with exceptions (the content controls) to protect it.</p>\n\n<p>After the user fills out the content control information, they click a \"Reset\" button to start over. The code associated with this button is below.\nQuestion is: How do I re-protect the doc with the original protection parameters I put in place?\nThank you for your help!\nJP</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\n    ActiveDocument.Unprotect (\"Word\")\n    Dim oCC As ContentControl\n\n    x = 1\n\n    For Each oCC In ActiveDocument.ContentControls\n\n        Count = x\n\n        If Count &gt; 0 Then\n            oCC.Range.Text = \"\"\n        End If\n\n        x = x + 1\n\n    Next oCC\n\n    ActiveDocument.Protect wdNoProtection, , \"Word\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 6171, "user_id": 1971895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5fdcff84fa3fb39a716bdd919605109b?s=128&d=identicon&r=PG", "display_name": "Brett Wolfington", "link": "https://stackoverflow.com/users/1971895/brett-wolfington"}, "is_accepted": true, "score": 2, "last_activity_date": 1448479951, "creation_date": 1448479951, "answer_id": 33924984, "question_id": 33924905, "link": "https://stackoverflow.com/questions/33924905/swapping-two-ranges/33924984#33924984", "title": "Swapping two ranges", "body": "<p>The cause of the error is that you are not using the <code>Set</code> command when assigning ranges. In addition, understand that this code:</p>\n\n<pre><code>Set holder = range1\nSet range1 = range2\nSet range2 = holder\n</code></pre>\n\n<p>only changes the ranges referred to by the variables <code>holder</code>, <code>range1</code>, and <code>range2</code>. It doesn't actually copy the data contained in those references from one range to another. </p>\n\n<p>The code below will perform the actual copying while also addressing the run-time error.</p>\n\n<pre><code>Sub SwapRanges()\n  Dim range1 As Range\n  Dim range2 As Range\n  Dim holder As Range\n\n  Set range1 = Range(\"D7:D12\")\n  Set range2 = Range(\"E7:E12\")\n  Set holder = Range(\"F7:F12\")\n\n  range1.Copy holder\n  range2.Copy range1\n  holder.Copy range2\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532509904, "post_id": 33925121, "comment_id": 89998496, "body": "i assume this wasn&#39;t tested?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532591361, "post_id": 33925121, "comment_id": 90034851, "body": "@ashleedawg No need to assume 3 years later. It&#39;s written black on white on the very first line."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1448480495, "creation_date": 1448480495, "answer_id": 33925121, "question_id": 33924905, "link": "https://stackoverflow.com/questions/33924905/swapping-two-ranges/33925121#33925121", "title": "Swapping two ranges", "body": "<p>I would try this way (sorry, non tested - writing from a Chrombook :)  </p>\n\n<pre><code>Sub SwapRanges()\n  Dim range1 As Range\n  Dim range2 As Range\n  Dim holder() as variant\n\n  Set range1 = Range(\"D7:D12\")\n  Set range2 = Range(\"E7:E12\")\n\n  holder = range1    \n  range1 = range2\n  range2 = holder\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1532509893, "post_id": 33925211, "comment_id": 89998486, "body": "i assume this wasn&#39;t tested?"}], "tags": [], "owner": {"reputation": 1, "user_id": 5596462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8c96a139db4ab4ba035fbda4e5c5ac3?s=128&d=identicon&r=PG&f=1", "display_name": "MrMoore", "link": "https://stackoverflow.com/users/5596462/mrmoore"}, "is_accepted": false, "score": 0, "last_activity_date": 1448480823, "creation_date": 1448480823, "answer_id": 33925211, "question_id": 33924905, "link": "https://stackoverflow.com/questions/33924905/swapping-two-ranges/33925211#33925211", "title": "Swapping two ranges", "body": "<p>Instead of coping you can just say:\n       holder=range1\n       Range2=range1\n       Holder=range2</p>\n\n<p>Not realy related to the question pnuts answered it but I thought this would be helpful for your application.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5316498"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "accepted_answer_id": 33924984, "answer_count": 3, "score": 0, "last_activity_date": 1448480823, "creation_date": 1448479665, "last_edit_date": 1448479863, "question_id": 33924905, "link": "https://stackoverflow.com/questions/33924905/swapping-two-ranges", "title": "Swapping two ranges", "body": "<p>I am trying to write code for swapping two ranges:</p>\n\n<pre><code>Sub SwapRanges()\n  Dim range1 As Range\n  Dim range2 As Range\n  Dim holder As Range\n\n  range1 = Range(\"D7:D12\")\n  range2 = Range(\"E7:E12\")\n  holder = Range(\"F7:F12\")\n\n  Set holder = range1\n  Set range1 = range2\n  Set range2 = holder\nEnd Sub\n</code></pre>\n\n<p>but get <em>run-time error 91</em>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1448477464, "post_id": 33924015, "comment_id": 55609477, "body": "Just to understand better, you are saving the file with the name from cell D2 ?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448477506, "post_id": 33924015, "comment_id": 55609498, "body": "Regarding your second question, you&#39;re saving to some ancient version of excel... <code>FileFormat:= _  xlExcel8</code>"}, {"owner": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "edited": false, "score": 0, "creation_date": 1448477525, "post_id": 33924015, "comment_id": 55609510, "body": "yes.. After that I am choosing the path to save it. I am able to do that. But the file is not getting saved in the choosen path"}, {"owner": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448477559, "post_id": 33924015, "comment_id": 55609525, "body": "@findwindow ohh.. i guessed that should be the problem. What is the version we can change now?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1448477603, "post_id": 33924015, "comment_id": 55609560, "body": "I just leave out fileformat. In fact, you can leave out all the parameters you have... Only set parameters if it matters to you."}, {"owner": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "edited": false, "score": 0, "creation_date": 1448477704, "post_id": 33924015, "comment_id": 55609610, "body": "Ok Thanks.. Would edit that."}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "edited": false, "score": 0, "creation_date": 1448480695, "post_id": 33924513, "comment_id": 55611262, "body": "Thanks a lot.. this works. As for the name format, I was still getting the warning in your code also. So, as per ExcelHero&#39;s  suggestion, i removed the extra parameters."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "edited": false, "score": 0, "creation_date": 1448481144, "post_id": 33924513, "comment_id": 55611482, "body": "Glad to help and I wonder why it gave you the warning as it&#39;s working perfectly fine for me."}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 1, "last_activity_date": 1448478259, "creation_date": 1448478259, "answer_id": 33924513, "question_id": 33924015, "link": "https://stackoverflow.com/questions/33924015/macro-for-getting-the-file-name-from-the-cell-and-prompt-the-location-to-save-th/33924513#33924513", "title": "Macro for getting the file name from the cell and prompt the location to save the file", "body": "<p><strong>Here is a working code:</strong>  </p>\n\n<pre><code>Sub SelectFolder()\n    Dim diaFolder As FileDialog\n    Dim fileName, filePath As String\n\n    Set diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\n\n    diaFolder.AllowMultiSelect = False\n    diaFolder.Show\n    ActiveSheet.Copy\n\n    fileName = ActiveSheet.Range(\"D2\").Value\n\n    'You need to use diaFolder.SelectedItems(1) and not just diaFolder\n    filePath = diaFolder.SelectedItems(1) &amp; \"\\\" &amp; fileName &amp; \".xlsx\"\n\n    ActiveWorkbook.SaveAs fileName:= _\n        filePath, FileFormat:=xlWorkbookNormal, Password:=\"\", WriteResPassword:=\"\" _\n        , ReadOnlyRecommended:=False, CreateBackup:=False\n\n    Set diaFolder = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong><br>\nI've changed FileFormat from Excel8 to xlWorkbookNormal</p>\n\n<p><strong>Issues in your code:</strong><br>\n1. FileFormat Excel 8 means <strong><code>97-2003 format in Excel 2007-2013, xls</code></strong> and you are saving it as <strong><code>.xlsx</code></strong><br>\n2. You were using <strong><code>diaFolder</code></strong> only and not <strong><code>diaFolder.SelectedItems(1)</code></strong></p>\n"}], "owner": {"reputation": 561, "user_id": 5063127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa46f899fbfac039642a857a833ba17c?s=128&d=identicon&r=PG&f=1", "display_name": "Observer", "link": "https://stackoverflow.com/users/5063127/observer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 0, "accepted_answer_id": 33924513, "answer_count": 1, "score": 0, "last_activity_date": 1448478259, "creation_date": 1448476411, "last_edit_date": 1531161705, "question_id": 33924015, "link": "https://stackoverflow.com/questions/33924015/macro-for-getting-the-file-name-from-the-cell-and-prompt-the-location-to-save-th", "title": "Macro for getting the file name from the cell and prompt the location to save the file", "body": "<p>I am looking for a macro which when run would take the value from the cell and save it using that name and also prompt for the path to save the file. The following is my attempt:</p>\n\n<pre><code>Sub SelectFolder()\n    Dim diaFolder As FileDialog\n\n    Set diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\n    diaFolder.AllowMultiSelect = False\n    diaFolder.Show\n    ActiveSheet.Copy\n    ActiveWorkbook.SaveAs Filename:= _\n    diaFolder &amp; ActiveSheet.[d2] &amp; \".xlsx\", FileFormat:= _\n    xlExcel8, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False _\n, CreateBackup:=False\n\n\n    Set diaFolder = Nothing\nEnd Sub\n</code></pre>\n\n<p>In this the value is taken from the cell and there is a prompt to ask for the folder to save the file. But the file is not stored in the folder and stored in a separate folder. I guess there is a small correction that needs to be done here.</p>\n\n<p>Also while saving, it is giving me an warning that there may be compatibility issues from 97-2003 file type. I guess there is something that needs to be corrected in this line:</p>\n\n<pre><code>diaFolder &amp; ActiveSheet.[d2] &amp; \".xlsx\", FileFormat:= _\n        xlExcel8, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False \n</code></pre>\n\n<p>but don't know what to change. I want the file to be in .xlsx and also compatible with all devices.</p>\n\n<p>Can anybody help me in doing these two?</p>\n"}, {"tags": ["vba", "excel", "events", "event-handling"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1448476687, "post_id": 33923984, "comment_id": 55609037, "body": "(Did you forget to leave out <code>End Sub</code> in your post?)"}, {"owner": {"reputation": 31, "user_id": 5605526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306f96a15f9663c68e522c155b034f76?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Sto", "link": "https://stackoverflow.com/users/5605526/richard-sto"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1448478282, "post_id": 33923984, "comment_id": 55609964, "body": "Just forgot to copy it my bad :)"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 2, "last_activity_date": 1448480985, "creation_date": 1448480985, "answer_id": 33925247, "question_id": 33923984, "link": "https://stackoverflow.com/questions/33923984/running-a-different-macro-for-a-different-cell-only-when-changed-manually/33925247#33925247", "title": "Running a different macro for a different cell only when changed manually", "body": "<p>Two solutions for this :</p>\n\n<ol>\n<li>Add <code>Application.EnableEvents = False</code> at the start of your _change event and set it to <code>True</code> at the end</li>\n<li>Create a Public Boolean to test if you are already doing any update automatically</li>\n</ol>\n\n<p>Something like this (solution 2) :</p>\n\n<pre><code>Public DisableEvents As Boolean\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf DisableEvents Then Exit Sub\n    DisableEvents = True\n\n    Dim cell As Range\n    For Each cell In Target\n        If Not Intersect(cell, Range(\"c2\")) Is Nothing Then\n            Macro1\n        ElseIf Not Intersect(cell, Range(\"C3\")) Is Nothing Then\n            Macro2\n        ElseIf Not Intersect(cell, Range(\"d8\")) Is Nothing Then\n            Macro3\n        End If\n    Next cell\n\n    DisableEvents = False\nEnd Sub\n\n\nSub Macro1()\nIf DisableEvents Then Exit Sub\n\n'Rest of your code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5605526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306f96a15f9663c68e522c155b034f76?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Sto", "link": "https://stackoverflow.com/users/5605526/richard-sto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448483891, "creation_date": 1448476301, "last_edit_date": 1448483891, "question_id": 33923984, "link": "https://stackoverflow.com/questions/33923984/running-a-different-macro-for-a-different-cell-only-when-changed-manually", "title": "Running a different macro for a different cell only when changed manually", "body": "<p>My problem is that the macros I wrote change the values of the cells triggering again a macro to change one of the other cells.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cell As Range\n    For Each cell In Target\n        If Not Intersect(cell, Range(\"c2\")) Is Nothing Then\n            Macro1\n        ElseIf Not Intersect(cell, Range(\"C3\")) Is Nothing Then\n            Macro2\n        ElseIf Not Intersect(cell, Range(\"d8\")) Is Nothing Then\n            Macro3\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>The macros running always change the other cells, what makes it a endless loop at the moment.</p>\n\n<p>Is there a way to only make manual input/ change of the cell let the macro run?</p>\n"}, {"tags": ["vba", "excel", "formatting"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448478645, "post_id": 33923874, "comment_id": 55610167, "body": "if you run your refresh manually then run the first sub right after it works?"}, {"owner": {"reputation": 394, "user_id": 2596757, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f68659f60a4c9616c9ed05a3e6e6b718?s=128&d=identicon&r=PG", "display_name": "Dakota", "link": "https://stackoverflow.com/users/2596757/dakota"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448480323, "post_id": 33923874, "comment_id": 55611051, "body": "@ScottHoltzman Yes. I can run the Refresh Sub and the Text to Column sub individually, and both work fine. When I roll the two into each other, the Text to columns does not proc."}, {"owner": {"reputation": 394, "user_id": 2596757, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f68659f60a4c9616c9ed05a3e6e6b718?s=128&d=identicon&r=PG", "display_name": "Dakota", "link": "https://stackoverflow.com/users/2596757/dakota"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1448480378, "post_id": 33923874, "comment_id": 55611081, "body": "@pnuts I have tried that in 5, 30 and 60 second increments. I don&#39;t think the issue is with the amount of time the table takes to refresh (&lt; 2 seconds)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448481004, "post_id": 33923874, "comment_id": 55611411, "body": "there are no other workbooks open when you run the code, right?"}, {"owner": {"reputation": 394, "user_id": 2596757, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f68659f60a4c9616c9ed05a3e6e6b718?s=128&d=identicon&r=PG", "display_name": "Dakota", "link": "https://stackoverflow.com/users/2596757/dakota"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448481364, "post_id": 33923874, "comment_id": 55611565, "body": "@ScottHoltzman Correct."}], "owner": {"reputation": 394, "user_id": 2596757, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f68659f60a4c9616c9ed05a3e6e6b718?s=128&d=identicon&r=PG", "display_name": "Dakota", "link": "https://stackoverflow.com/users/2596757/dakota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448476204, "creation_date": 1448475923, "last_edit_date": 1448476204, "question_id": 33923874, "link": "https://stackoverflow.com/questions/33923874/text-to-columns", "title": "Text to Columns", "body": "<p>My Excel file has a SQL connection that runs a stored procedure and outputs three columns, each in a time format. The output is in the \"hh:mm:ss\" format, which Excel doesn't take as a time. I've found that if I manually use the 'Text to Columns' tool with the default settings, Excel converts '0:03:05' to '12:03:05 AM'. I used VB Code to replicate the Text to Column, but it's only working if it's the only code in a Sub. Currently, this works = </p>\n\n<pre><code> Sub textToColumns()\n Sheets(\"Main Data\").Visible = True\n     Sheets(\"Main Data\").Select \n         Sheets(\"Main Data\").Select\n     Columns(\"Z:Z\").Select\n     Selection.textToColumns Destination:=Range(\"Z:Z\"), _\n    DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter _\n    :=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, _\n    Other:=False, FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\n Sheets(\"Main Data\").Visible = False   \n End Sub\n</code></pre>\n\n<p>But this does not = </p>\n\n<pre><code> Sub textToColumns()\n ActiveWorkbook.RefreshConnections\n Sheets(\"Main Data\").Visible = True\n     Sheets(\"Main Data\").Select \n         Sheets(\"Main Data\").Select\n     Columns(\"Z:Z\").Select\n     Selection.textToColumns Destination:=Range(\"Z:Z\"), _\n    DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter _\n    :=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, _\n    Other:=False, FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\n Sheets(\"Main Data\").Visible = False   \n End Sub\n</code></pre>\n\n<p>The only difference is the <code>ActiveWorkbook.RefreshConnections</code></p>\n\n<p>I tried splitting the Refresh and the Text to Columns into two separate Subs and then calling both, but it didn't work.</p>\n\n<p>It's worth noting that I'm not receiving any error messages at all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448475092, "post_id": 33923305, "comment_id": 55608145, "body": "what number do you get when you <code>?Sheets(&quot;Homeward_Summary&quot;).PivotTables.Count</code> in the Immediate Window?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448475617, "post_id": 33923305, "comment_id": 55608446, "body": "are you sure the pivot table name is what you think it is. if you right click on the pivot table and go to properties what does the name say? or you can <code>?Sheets(&quot;Homeward_Summary&quot;).PivotTables(1).Name</code> in the <code>Immediate Window</code> to get the name."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448475729, "post_id": 33923305, "comment_id": 55608514, "body": "and why do you open the same workbook twice? and see the answer below. it may solve your issue."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448476044, "post_id": 33923305, "comment_id": 55608703, "body": "weird, i explicitly renamed the pivot table MyPivot to test if that was the problem but in the Immediate Window it says it is &quot;Microsoft Office PivotTable 10.0&quot; so I am changing it to that in my code.  It looks like that might have solved it but I also used the answer below&#39;s code in place of mine."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448477867, "post_id": 33923305, "comment_id": 55609710, "body": "bizarre - but glad you got it solved. try renaming it again?"}], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 1, "last_activity_date": 1448475174, "creation_date": 1448475174, "answer_id": 33923643, "question_id": 33923305, "link": "https://stackoverflow.com/questions/33923305/unable-to-get-the-pivottables-property-of-the-worksheet-class/33923643#33923643", "title": "Unable to get the PivotTables Property of the Worksheet Class", "body": "<p>Make sure everything is  referenced, then there is no guesswork about which workbook or sheet you are trying to deal with (pardon the shorthand, alter as required)</p>\n\n<pre><code>Sub Format_Homeward_V3()\nDim wbe As Workbook\nDim wbi As Workbook\nDim ws As Worksheet\nSet wbe = Workbooks.Open(\"J:\\Templates\\Homeward_Exception_Report_Template_Final.xlsx\")\nSet wbi = Workbooks.Open(\"J:\\Templates\\Homeward_Inventory_Report_Template_Final.xlsx\")\nSet ws = wbi.Sheets(\"PIVOT\")\nws.Range(\"A4\").Select\nws.PivotTables(\"MyPivot\").PivotCache.Refresh\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5835, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448475174, "creation_date": 1448473996, "last_edit_date": 1448474125, "question_id": 33923305, "link": "https://stackoverflow.com/questions/33923305/unable-to-get-the-pivottables-property-of-the-worksheet-class", "title": "Unable to get the PivotTables Property of the Worksheet Class", "body": "<p>I am trying to use some VBA that another person made and it is giving me an error that I can't seem to fix.  Here's the code:</p>\n\n<pre><code>Sub Format_Homeward_V3()\n' Format_Homeward_V3 Macro\n    ChDir \"J:\\Templates\"\n    Workbooks.Open Filename:= _\n        \"J:\\Templates\\Homeward_Exception_Report_Template_Final.xlsx\"\n    Workbooks.Open Filename:= _\n        \"J:\\Templates\\Homeward_Inventory_Report_Template_Final.xlsx\"\n    Range(\"A4\").Select\n    Sheets(\"Homeward_Summary\").PivotTables(\"MyPivot\").PivotCache.Refresh\n    Sheets(\"Detail\").Select\n    Range(\"A1\").Select\n</code></pre>\n\n<p>it errors out at:  </p>\n\n<pre><code>Sheets(\"Homeward_Summary\").PivotTables(\"MyPivot\").PivotCache.Refresh  \n</code></pre>\n\n<p>and gives the error:  </p>\n\n<blockquote>\n  <p>\"unable to get the pivottables property of the worksheet class\"</p>\n</blockquote>\n\n<p>But as far as I can tell it is looking at the right sheet and the right name of the PivotTable.  I also tried doing <code>.RefreshTable</code> instead of cache refresh but got the same error.  I don't really know why it would be giving me this error and and I don't know what else to try.  It's been working without this error for a while.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1448473239, "post_id": 33923037, "comment_id": 55607045, "body": "What is the value of <code>Formula</code> if you set a breakpoint there?"}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1448473296, "post_id": 33923037, "comment_id": 55607086, "body": "what do you expect the Series 1 formula to show?"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1448474664, "creation_date": 1448474664, "answer_id": 33923495, "question_id": 33923037, "link": "https://stackoverflow.com/questions/33923037/object-variable-or-with-block-variable-not-set-error-91-error/33923495#33923495", "title": "Object variable or With block variable not set (Error 91) error", "body": "<p>Ensure that the chart you want to work with is the actual chart that <strong>is active</strong> on the worksheet.</p>\n\n<p>Place this code before you set 'xVals` and adjust as needed.</p>\n\n<pre><code>Dim c As ChartObject\nSet c = Sheets(\"Sheet6\").ChartObjects(\"Chart 1\") 'change to your chart name\nc.Activate\n\n'Store the formula for the first series in \"xVals\".\nxVals = ActiveChart.SeriesCollection(1).Formula\n</code></pre>\n\n<p>Generally, it's bad practice to use <code>Active</code> anything (Chart / Sheet / Cell / etc.), but when manipulating charts, that's the only way AFAIK. I don't know of a way to work directly with the object in this way. If someone else does, perhaps they can post a better answer.</p>\n"}], "owner": {"reputation": 41, "user_id": 5605336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d610a902d2c16a06269d4b509854c135?s=128&d=identicon&r=PG&f=1", "display_name": "S.Zhong", "link": "https://stackoverflow.com/users/5605336/s-zhong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1644, "favorite_count": 0, "accepted_answer_id": 33923495, "answer_count": 1, "score": 0, "last_activity_date": 1448474664, "creation_date": 1448473041, "last_edit_date": 1448473579, "question_id": 33923037, "link": "https://stackoverflow.com/questions/33923037/object-variable-or-with-block-variable-not-set-error-91-error", "title": "Object variable or With block variable not set (Error 91) error", "body": "<p>I have the following code that was working earlier, but is now showing an error:</p>\n\n<pre><code>Sub AttachLabelsToPoints()\n\n   'Dimension variables.\n   Dim Counter As Integer\n   Dim ChartName As String\n   Dim xVals As String\n\n   ' Disable screen updating while the subroutine is run.\n   Application.ScreenUpdating = False\n\n   'Store the formula for the first series in \"xVals\".\n   xVals = ActiveChart.SeriesCollection(1).Formula\n\n   'Extract the range for the data from xVals.\n   xVals = Mid(xVals, InStr(InStr(xVals, \",\"), xVals, _\n      Mid(Left(xVals, InStr(xVals, \"!\") - 1), 9)))\n   xVals = Left(xVals, InStr(InStr(xVals, \"!\"), xVals, \",\") - 1)\n   Do While Left(xVals, 1) = \",\"\n      xVals = Mid(xVals, 2)\n   Loop\n\n   'Attach a label to each data point in the chart.\n   For Counter = 1 To Range(xVals).Cells.Count\n     ActiveChart.SeriesCollection(1).Points(Counter).HasDataLabel = _\n         True\n     ActiveChart.SeriesCollection(1).Points(Counter).DataLabel.Text = _\n     Range(xVals).Cells(Counter, 1).Offset(0, -1).Value\n   Next Counter\n\nEnd Sub\n</code></pre>\n\n<p>The error is specifically around the <code>xVals = ActiveChart.SeriesCollection(1).Formula</code> statement. When I put a <code>Set</code> in front of it, it just asks for an object.</p>\n\n<p>Would anyone be able to help me on what's wrong? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1448472444, "post_id": 33922798, "comment_id": 55606593, "body": "You need to specify the sheet ie <code>ActiveWorkbook.Sheet(1).Range...</code>"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1448472648, "post_id": 33922798, "comment_id": 55606726, "body": "Hi Scott   still receiving the same error with that change"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1448472778, "post_id": 33922798, "comment_id": 55606801, "body": "Is it possible to refactor your code to use the destination argument in the <code>.Copy</code> function?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1448472817, "post_id": 33922798, "comment_id": 55606825, "body": "<code>ActiveWorkbook.Sheet(1).Range(&quot;A&quot; &amp; newSheetRow).PasteSpecial</code> the way you had it you were saying <code>Range(1 &amp; 1)</code> which become <code>Range(11)</code>, which does not work"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1448473001, "post_id": 33922798, "comment_id": 55606930, "body": "@ScottCraner is correct. In the editor type out <code>activeworkbook.</code> After the period Intellisense will list all the available methods and properties of that object. Range is not a property or method of <code>activeworkbook</code>. That is why you are getting errors. Also, look into using properties like <code>.sheet1.usedrange.rows.count</code> to find your empty cells. And if you are only checking the value of one cell, use something like <code>.cells(row_counter, buyerCol)</code> instead of ranges."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1448473244, "post_id": 33922798, "comment_id": 55607048, "body": "Hi gents, much appreciated for all the help.  Unfortunately I am still receving an error when using scotts code above.  Any idea why that might be?  I apologize i&#39;m new to VBA so the syntax is still new. I am copying a row and pasting it over into another row"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1448473560, "post_id": 33922798, "comment_id": 55607241, "body": "When it stops what is the value of <code>newSheetRow</code>? you can hover over the variable in the code and it will tell you.  My guess is it is 0, because the first row is empty and it never assigns a value to it.  Instead of your loop to find the next empty row put this <code>newSheetRow = ActiveWorkbook.Sheet(1).Range(&quot;A60000&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1448474082, "post_id": 33922798, "comment_id": 55607561, "body": "I had initialized it to one earlier in the code.  I added your method instead of the loop and that works properly and now the line will execute, but it does something really strange in that after it executes it jumps to another Public function in the excel book Which is very odd.  Any idea why that could happen? lol Thank you so much for all your help I really appreciate it."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1448475651, "post_id": 33922798, "comment_id": 55608463, "body": "Changed it to a Private Sub and it resolved the issue.  Thank you for all your help"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448472688, "creation_date": 1448472313, "last_edit_date": 1448472688, "question_id": 33922798, "link": "https://stackoverflow.com/questions/33922798/having-trouble-copying-data-from-one-sheet-to-another", "title": "Having trouble copying data from one sheet to another", "body": "<p>Developing a large macro and now it seems the second simplest part is giving me trouble.</p>\n\n<p>I am able to copy the selection in one workbook, but it does not allow me to paste over to the other workbook.  I am getting:  </p>\n\n<blockquote>\n  <p>\"Object doesn't support this property or method\" error.  </p>\n</blockquote>\n\n<p>This is looping through large sets of data so it will need to be able to rinse and repeat, which shouldn't be a problem because I can just clear the clipboard as a rinse method.  </p>\n\n<p>Any ideas?  </p>\n\n<p>Code below. There is code above it, but I don't think you should need any of it to get an idea of what's going on.  Error comes in on the ** line.</p>\n\n<pre><code>Do\nDoEvents\n    'Tests condition for counter party\n    If InStr(1, Range(buyerCol &amp; row_counter), clientName) &gt; 0 Or InStr(1, Range(sellerCol &amp; row_counter), clientName) &gt; 0 Then\n        EEB.Sheets(\"Trades Master List\").Rows(row_counter).Copy\n\n        'Activates newly created excel sheet\n        Workbooks(newWorkbookName).Activate\n\n        'Tests newly created sheet for already existing entries and increments newSheetRow by 1 until it finds the next empty space\n        Do While IsEmpty(Range(\"A\" &amp; newSheetRow)) = False\n            newSheetRow = newSheetRow + 1\n        Loop\n\n        **ActiveWorkbook.Range(newSheetRow &amp; newSheetRow).PasteSpecial\n        EEB.masterList.Activate\n        row_counter = row_counter + 1\n    Else\n        row_counter = row_counter + 1\n    End If\n\nLoop Until Range(\"A\" &amp; row_counter).Value &gt; endDateFromSheet Or IsEmpty(Range(\"A\" &amp; row_counter)) = True\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5605249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d74cc14cbe47bf2f5406ad2a1a10055d?s=128&d=identicon&r=PG&f=1", "display_name": "Jano Salazar", "link": "https://stackoverflow.com/users/5605249/jano-salazar"}, "edited": false, "score": 0, "creation_date": 1448472333, "post_id": 33922753, "comment_id": 55606531, "body": "Las part of code is:      Sub TotalE()          Dim LR As Long               LR = Range(&quot;E&quot; &amp; Rows.Count).End(xlUp).Row         Range(&quot;D&quot; &amp; LR + 2) = LR + 2                  End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1462480614, "creation_date": 1462480614, "answer_id": 37059824, "question_id": 33922753, "link": "https://stackoverflow.com/questions/33922753/transferring-data-to-excel/37059824#37059824", "title": "Transferring Data to Excel", "body": "<p>Looks like you are calling the TotalE sub routine, but in it you are not telling the range explicitly what workbook to use.\nActiveworkbook.Range() may be better or when you add the workbook, capture the name and pass it to the sub routine.</p>\n\n<p>Strange, but your only calculating the last row in column E and putting that value + 2 into column D two rows down.</p>\n\n<p>All you really need is this code to replace your call to TotalE:</p>\n\n<pre><code>ActiveWorkbook.Sheets(1).Range(\"D\" &amp; ActiveWorkbook.Sheets(1).Range(\"E\" &amp; Rows.Count).End(xlUp).Row + 2) = ActiveWorkbook.Sheets(1).Range(\"E\" &amp; Rows.Count).End(xlUp).Row + 2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5605249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d74cc14cbe47bf2f5406ad2a1a10055d?s=128&d=identicon&r=PG&f=1", "display_name": "Jano Salazar", "link": "https://stackoverflow.com/users/5605249/jano-salazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462480614, "creation_date": 1448472181, "last_edit_date": 1448474971, "question_id": 33922753, "link": "https://stackoverflow.com/questions/33922753/transferring-data-to-excel", "title": "Transferring Data to Excel", "body": "<p>I have the following code to transfer code to excel file:</p>\n\n<pre><code>Dim SaveAsStr As String\n    Dim appXL As Excel.Application\n    Dim wbk As Excel.Workbook\n    Dim wst As Excel.Worksheet\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim rs1 As ADODB.Recordset\n    Dim rs2 As ADODB.Recordset\n    Dim LR As Long\n    Dim startcell As Range\n    DoCmd.RunMacro \"Guardarmcr\"\n\n      Set appXL = CreateObject(\"Excel.Application\")\n      appXL.Visible = True\n      Set wbk = appXL.Workbooks.Add\n      Set wst = wbk.Worksheets(1)\n      Set startcell = Range(\"D16\")\n\n      Set cn = CurrentProject.AccessConnection\n      Set rs = New ADODB.Recordset\n       Set rs1 = New ADODB.Recordset\n       Set rs2 = New ADODB.Recordset\n\n\n      With rs\n        Set .ActiveConnection = cn\n        .Source = \"SELECT * FROM ExcelTitulotbl\"\n        .Open\n      End With\n\n      With rs1\n        Set .ActiveConnection = cn\n        .Source = \"SELECT * FROM Excelotptbl\"\n        .Open\n      End With\n\n      With rs2\n\n        Set .ActiveConnection = cn\n        .Source = \"SELECT * FROM ExcelEDTUDCtbl\"\n        .Open\n\n      End With\n\n\n      With wst\n        '.QueryTables.Add Connection:=rs, Destination:=.Range(\"A1\")\n        '.QueryTables(1).Refresh\n\n\n         .QueryTables.Add Connection:=rs1, Destination:=.Range(\"d16\")\n        .QueryTables(1).Refresh\n\n\n         .Range(\"A16\").EntireRow.Delete\n         .Range(\"e2\").Font.Bold = True\n         .Range(\"e2\").Font.Name = \"Calibri\"\n          .Range(\"e2\").Font.Size = 14\n\n        .Range(\"e2\") = \"VALORACION\"\n        .Range(\"D5\") = \"Descripci\u00f3n\"\n        .Range(\"j5\") = \"Profesional Colaborador\"\n        .Range(\"j6\") = \"Profesional Chilectra\"\n        .Range(\"e5\") = rs(\"proyectoMain\")\n        .Range(\"k5\") = rs(\"Empleado\")\n        .Range(\"k6\") = rs(\"chilectramain\")\n\n        .Range(\"B15\") = \"Recargo\"\n        .Range(\"D15\") = \"N\u00famero\"\n        .Range(\"E15\") = \"Apdto\"\n         .Range(\"F14\") = \"Tipo\"\n        .Range(\"F15\") = \"Ocurrencia\"\n        .Range(\"g15\") = \"Especialidad\"\n         .Range(\"h14\") = \"Tipo\"\n         .Range(\"h15\") = \"Activo\"\n\n\n          TotalE\n\n      End With\n     wbk.Saved = True\n     Set wks = Nothing\n             Set wbk = Nothing\n\n             Set appXL = Nothing\n\n    End Sub\n</code></pre>\n\n<p>Most of it works all right but if I try to run the command a Second time the worksheet opens but the vba fails showing a 1004 error. It has something to do with <code>LR = Range(\"E\" &amp; Rows.Count).End(xlUp).Row</code>. If I quit the form and enter it again it works the first time but not a second. </p>\n\n<p>Will appreciate some help on this, thanks.</p>\n"}, {"tags": ["vba", "email", "outlook", "directory"], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1448572905, "creation_date": 1448572905, "answer_id": 33947188, "question_id": 33922640, "link": "https://stackoverflow.com/questions/33922640/define-folder-location/33947188#33947188", "title": "Define folder location", "body": "<p>A method of pulling the folder out of a path is described here.</p>\n\n<p><a href=\"http://www.outlookcode.com/d/code/getfolder.htm\" rel=\"nofollow\">http://www.outlookcode.com/d/code/getfolder.htm</a></p>\n\n<pre><code>Private Function GetFolder(strFolderpath As String) As Folder\n\n    ' The path argument needs to be in quotation marks and\n    '  exactly match the folder hierarchy that the user sees in the Folder List.\n    '\n    ' NOTE: If any folder name in the path string contains a \"\\\" character,\n    '  this routine will not work,\n    '\n    ' As the developer do not use this. It hides errors.\n    'On Error GoTo GetFolder_Error\n\n    Dim objNS As Namespace\n    Dim objFolder As Folder\n\n    Dim arrFolders() As String\n\n    Dim colFolders As Folders\n\n    Dim i As Long\n\n    Dim uErrorMsg As String\n\n    ' Remove leading slashes, if any\n    Do While Left(strFolderpath, 1) = \"\\\"\n        'Debug.Print strFolderpath\n        strFolderpath = Right(strFolderpath, Len(strFolderpath) - 1)\n    Loop\n\n    Debug.Print strFolderpath\n\n    arrFolders() = Split(strFolderpath, \"\\\")\n\n    Set objNS = GetNamespace(\"MAPI\")\n    Set objFolder = objNS.Folders.Item(arrFolders(0))\n\n    If Not objFolder Is Nothing Then\n\n        For i = 1 To UBound(arrFolders)\n\n            Set colFolders = objFolder.Folders\n            Set objFolder = Nothing\n            Set objFolder = colFolders.Item(arrFolders(i))\n\n            If objFolder Is Nothing Then Exit For\n\n        Next\n\n    End If\n\n    Set GetFolder = objFolder\n\nExitRoutine:\n    Set colFolders = Nothing\n    Set objNS = Nothing\n    Set objFolder = Nothing\n\n    Exit Function\n\nGetFolder_Error:\n    uErrorMsg = \"Err.Number: \" &amp; Err.Number &amp; vbCr &amp; \"Err.Description: \" &amp; Err.Description\n    MsgBox uErrorMsg\n    Set GetFolder = Nothing\n    Resume ExitRoutine\n\nEnd Function\n\nPrivate Sub GetFolder_Test()\n    Dim testFolder As Folder\n    Set testFolder = GetFolder(\"\\mailbox-name\\customers\\customer-xyz\")\n    If Not (testFolder Is Nothing) Then testFolder.Display\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 150, "user_id": 1773021, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7f47260ac6af89b221d77f967ad2bf45?s=128&d=identicon&r=PG", "display_name": "Inetquestion", "link": "https://stackoverflow.com/users/1773021/inetquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 807, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448572905, "creation_date": 1448471813, "last_edit_date": 1448491605, "question_id": 33922640, "link": "https://stackoverflow.com/questions/33922640/define-folder-location", "title": "Define folder location", "body": "<p>Working on a macro for Outlook 2007 which selects messages in a folder.</p>\n\n<p>In example 1 and 2 below the customers folder is selected, then a specific customer folder is selected.   The method to define the location seems clumsy.  Is there a cleaner way to do this?</p>\n\n<p>Right clicking on the sub-folder and selecting properties, the path shown is:   \"\\mailbox-name\\customers\\customer-xyz\".  Referencing the path this way in a macro doesn't work.  Is it possible to reference the folder location in a more direct manner?</p>\n\n<pre><code>Set olNamespace = olApp.GetNamespace(\"MAPI\")\n\n' Example-1, Select folder by name from default PST inbox\nSet FolderKeep = _\n olNamespace.GetDefaultFolder(olFolderInbox).Folders(\"customers\").Folders(\"customer-XYZ\")\n\n' Example-2, Select folder by mailbox name/folder/subfolder\nSet FolderKeep = _\n olNamespace.Folders(\"mailbox-name\").Folders(\"customers\").Folders(\"customer-XYZ\")\n</code></pre>\n"}, {"tags": ["validation", "excel", "formula", "spreadsheet", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448472709, "post_id": 33922540, "comment_id": 55606755, "body": "<code>Is this possible on Excel</code> - Yes! See <code>worksheet_change</code> event for the sheet with the drop-downs. I answered a <a href=\"http://stackoverflow.com/questions/33740114/lock-excel-2013-cells-based-on-other-cell-input/33741017#33741017\">somewhat related question</a> recently. It&#39;s exactly what you need in content, but the logic is very much in-line with what you need."}, {"owner": {"reputation": 9, "user_id": 5605259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18a80f66745fc246e4fb00f6d0a18c1?s=128&d=identicon&r=PG&f=1", "display_name": "Tekko", "link": "https://stackoverflow.com/users/5605259/tekko"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448489380, "post_id": 33922540, "comment_id": 55615549, "body": "Thanks, I&#39;ll have a look when I&#39;m at work tomorrow."}, {"owner": {"reputation": 9, "user_id": 5605259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18a80f66745fc246e4fb00f6d0a18c1?s=128&d=identicon&r=PG&f=1", "display_name": "Tekko", "link": "https://stackoverflow.com/users/5605259/tekko"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448529128, "post_id": 33922540, "comment_id": 55629015, "body": "Hi Scott, I don&#39;t really understand how to start it, I have never done macros on excel before.  I have edited my original post with pictures of the spreadsheet on 2 different packages so you can see what I am trying to do."}], "owner": {"reputation": 9, "user_id": 5605259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18a80f66745fc246e4fb00f6d0a18c1?s=128&d=identicon&r=PG&f=1", "display_name": "Tekko", "link": "https://stackoverflow.com/users/5605259/tekko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448529324, "creation_date": 1448471552, "last_edit_date": 1531161705, "question_id": 33922540, "link": "https://stackoverflow.com/questions/33922540/data-validation-drop-down-lists", "title": "Data Validation drop down lists", "body": "<p>I am working on a rate card for my company, and when you choose a different package I am trying to get other fields to change.  Once they have been changed, I would like the other fields to be able to change.</p>\n\n<p>I'll try and give a simple explanation of what the spreadsheet could look like, all lists are created through data validation with <code>Allow</code> set to <code>List</code> and the sources are on connected spreadsheets.</p>\n\n<p>Cell A1 has a drop down list of Bronze, Silver, Gold and Platinum<br>\nCell A2 has a drop down list of 10, 20, 30, 40 and 50<br>\nCell A3 has a drop down list of 1, 2, 3, 4 and 5</p>\n\n<p>When I select A1 as Bronze, I want A2 to change to 10 and A3 to change to 1.  I then want to be able to change A2 and A3 depending if the customer wants to modify the order.</p>\n\n<p>Then if I changed A1 to Silver, I would like A2 to change to 20 and A3 to change to 2.</p>\n\n<p>Is this possible on Excel?</p>\n\n<p>Just to note, these aren't the exact options on my spreadsheet, but if I know how to do the above, then I should be able to change it on my actual spreadsheet (it would just be a lot tougher to explain that).</p>\n\n<p>Below are pictures of the spreadsheet.</p>\n\n<p><a href=\"http://i.stack.imgur.com/0pwPM.png\" rel=\"nofollow\">bronze package</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/E674X.png\" rel=\"nofollow\">gold package</a></p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448472076, "post_id": 33922455, "comment_id": 55606344, "body": "If you deleted or changed the name of a control, that could cause this since VBA checks references to controls during compilation."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448473011, "post_id": 33922455, "comment_id": 55606936, "body": "I deleted one button that I didn&#39;t want to use anymore, could that have caused it? If so, how do you avoid an error like that after deleting such a control?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448473157, "post_id": 33922455, "comment_id": 55607009, "body": "Yes, that can cause it. You avoid it by ensuring you have no lingering references to deleted controls. You might also discover it without causing a crash by doing Debug-&gt;Compile VBAProject."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448473760, "post_id": 33922455, "comment_id": 55607364, "body": "thanks. I will try that next time"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448471325, "creation_date": 1448471325, "question_id": 33922455, "link": "https://stackoverflow.com/questions/33922455/errors-coming-up-after-moving-items-around-on-userforms", "title": "Errors coming up after moving items around on UserForms", "body": "<p>I have been formatting my UserForms to look better, essentially just resizing buttons and ListBoxes. After that this error began to show: </p>\n\n<pre><code> System Error &amp;H80004005 (-2147467259)\n</code></pre>\n\n<p>in an endless loop. When I killed the process the file also disappeared. I am working off a previous version now (pre-reformatting) but wonder what I might have done wrong. Any ideas what occurred?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448471804, "post_id": 33922215, "comment_id": 55606172, "body": "I cant recreate this error. You can use <code>Listbox2.Clear</code> to remove the items from Listbox2 instead of using a loop. Can you clarify what you mean when you say &quot;it stops working&quot;? do you mean it stops running altogether? or just misses certain values?"}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "reply_to_user": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448471961, "post_id": 33922215, "comment_id": 55606279, "body": "Its just does not detect that <code>Listbox1.Selected(I)</code> is true, and after a while I get an system error. But it works if I reopen my excel workbook."}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 1, "creation_date": 1448471990, "post_id": 33922215, "comment_id": 55606296, "body": "what does the system error say?"}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "reply_to_user": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448472293, "post_id": 33922215, "comment_id": 55606500, "body": "Just <code>unknown error</code> . It detects the correct number of items inside the Listbox1 so it can access it correctly. The sub works first but after several uses its just stops working"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448472351, "post_id": 33922215, "comment_id": 55606541, "body": "is there any other code behind the listboxes?"}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "reply_to_user": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448472377, "post_id": 33922215, "comment_id": 55606564, "body": "Do I need to delete any memory or temp files before I reopen the same userform?"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448472468, "post_id": 33922215, "comment_id": 55606621, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/96175/discussion-between-neuralgroove-and-user3614882\">continue this discussion in chat</a>."}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "reply_to_user": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1448472497, "post_id": 33922215, "comment_id": 55606642, "body": "I fill the listbox with Additem into the first listbox and the userform is displayed correctly the entire time, just my add button stops working."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448478554, "post_id": 33922215, "comment_id": 55610120, "body": "Where is counter declared and what does it contain?"}], "owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448470563, "creation_date": 1448470563, "question_id": 33922215, "link": "https://stackoverflow.com/questions/33922215/listbox1-selectedi-true-stops-working", "title": "ListBox1.Selected(i) = True stops working", "body": "<p>I want to move selected Items from one Listbox into a second Listbox , its working fine. After a while though, its stops working!</p>\n\n<pre><code>Private Sub add_Click()\n'delete old selection\nFor i = 0 To Listbox2.ListCount - 1\n         Listbox2.RemoveItem (i - counter)\n         counter = counter + 1\n\nNext i\n    For i = 0 To Listbox1.ListCount - 1\n     If Listbox1.Selected(i) = True Then Listbox2.AddItem Listbox1.List(i)\n    Next I\nEnd Sub\n</code></pre>\n\n<p>VBA does not detect that <code>Selected(I)</code> is true. It works again, if I reopen my excel file.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1448470247, "post_id": 33921752, "comment_id": 55605200, "body": "You can&#39;t copy and paste in a function called from a cell."}, {"owner": {"reputation": 65, "user_id": 5554523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6004167feaee6c57def3b0afd6c40f72?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Costa", "link": "https://stackoverflow.com/users/5554523/rui-costa"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448471150, "post_id": 33921752, "comment_id": 55605774, "body": "How can i copy format of cell to another, inside a funciton?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448471305, "post_id": 33921752, "comment_id": 55605864, "body": "You don&#39;t. Functions return values. Why do you need to?"}, {"owner": {"reputation": 65, "user_id": 5554523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6004167feaee6c57def3b0afd6c40f72?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Costa", "link": "https://stackoverflow.com/users/5554523/rui-costa"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448471438, "post_id": 33921752, "comment_id": 55605947, "body": "I need to execute vlookup and return the value and his cell&#39;s format-"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448471506, "post_id": 33921752, "comment_id": 55605982, "body": "But <b>why</b> do you need to copy the format?"}, {"owner": {"reputation": 65, "user_id": 5554523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6004167feaee6c57def3b0afd6c40f72?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Costa", "link": "https://stackoverflow.com/users/5554523/rui-costa"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448471720, "post_id": 33921752, "comment_id": 55606118, "body": "Director of Human Resources wants"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1448494503, "last_edit_date": 1448494503, "creation_date": 1448490224, "answer_id": 33927475, "question_id": 33921752, "link": "https://stackoverflow.com/questions/33921752/copy-pastspecial-cell-format-in-vba-user-defined-function/33927475#33927475", "title": "copy/pastspecial cell format in VBA User-Defined Function", "body": "<p>Well, we can't say we can't to the HR director, can we? :P\nAlthough it is not straightforward to do some operations such as copy/paste inside a custom User-Defined Function (UDF), it is still achievable in a tricky way, to some extent with a few limitations that I will point out at the end.</p>\n\n<p>The code snippets that follow can be considered as a general technique to achieve any type of <code>\"forbidden UDF operations\"</code>: memorize them <em>somehow</em> and let the <code>Workbook_SheetCalculate</code> event handler execute them later.</p>\n\n<p>The idea is to count on the <code>Workbook_SheetCalculate</code> event, because we know that it will be invoked after the calculation is made, and unlike UDFs, it allows us to do copying and pasting. Therefore, the UDF will simply hand it the ranges (sources and destinations) through some variables. Once the calculation is made and the UDFs are finished, <code>Workbook_SheetCalculate</code> will be automatically invoked; it will read those variables and achieve the jobs that the UDF did not allow directly.</p>\n\n<p>1) In code Module <em>ThisWorkbook</em>:</p>\n\n<pre><code>Public Sources As New Collection, Destinations As New Collection\n\nPrivate Sub Workbook_SheetCalculate(ByVal Sh As Object)\n    Application.ScreenUpdating = False\n    On Error GoTo Cleanup\n    For Each src In Sources\n        src.copy\n        Destinations(1).PasteSpecial xlPasteFormats\n        Destinations.Remove 1\n    Next\n\nCleanup:\n    Application.CutCopyMode = False\n    Set Sources = New Collection: Set Destinations = New Collection\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>2) In the User-Defined Function, instead of doing directly a copy/paste operation, add your source cell and your destination cell to the <code>ThisWorkbook.Sources</code> and <code>ThisWorkbook.Destinations</code> collections, respectively. That is, replace the following part of your UDF code:</p>\n\n<blockquote>\n<pre><code>Range(CellOrigin).Copy\nActiveCell.PasteSpecial (xlPasteFormats)\nApplication.CutCopyMode = False\n</code></pre>\n</blockquote>\n\n<p>with this:</p>\n\n<pre><code>ThisWorkbook.Sources.Add Range(CellOrigin)\nThisWorkbook.Destinations.Add Application.ThisCell\n</code></pre>\n\n<p>This will achieve the desired behavior. But as I said, There are a few limitations:</p>\n\n<p>First, it's a bit slow if the number of cells that use your custom UDF is too big (say thousands).</p>\n\n<p>Second and more important, automatic calculation in Excel is not triggered when you change a cell's <em>format</em>, but only when you change its <em>value</em>. Therefore, if the user changes the source cell's format but not its value, the format will not be immediately reported at the destination. The user will probably need to manually force the calculation, i.e. by pressing <code>F9</code>. </p>\n"}], "owner": {"reputation": 65, "user_id": 5554523, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6004167feaee6c57def3b0afd6c40f72?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Costa", "link": "https://stackoverflow.com/users/5554523/rui-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 1, "accepted_answer_id": 33927475, "answer_count": 1, "score": 2, "last_activity_date": 1448560294, "creation_date": 1448469238, "last_edit_date": 1531164843, "question_id": 33921752, "link": "https://stackoverflow.com/questions/33921752/copy-pastspecial-cell-format-in-vba-user-defined-function", "title": "copy/pastspecial cell format in VBA User-Defined Function", "body": "<p>I have a formula in VBA that:\n- Executes VLOOKUP\n- Find the address of the cell that has the value found by vlookup\n- PROBLEM: Copy/pastespecial original cell's format\n- Return Value of vlookup</p>\n\n<pre><code>Function VLOOKUPnew(ValueToLook As Range, Interval As Range, ColIndex As Integer) As Variant\n\nDim fMatch, fVlookup\n\nDim ColMatchIndex\nDim CellOrigin, CellDestination\n\n' ********************************************************************************\n' LOOKUP:: Application.VLookup(ValueToLook, Interval, colIndex, False)\n' MATCH:: Application.Match(ValueToLook, Range(Interval.Address()).Columns(1), 0)\n' ********************************************************************************\n\n' Indice da 1\u00aa coluna do Intervalo\n' **********************************************\nColMatchIndex = Interval.Columns(Interval.Columns.Count - 1).Column\n' **********************************************\n\nfMatch = Application.Match(ValueToLook, Range(Interval.Address()).Columns(1), 0)\n\n' Obtem o endere\u00e7o da c\u00e9lula que contem o valor do VLOOKUP\n' **********************************************\nCellOrigin = Interval.Cells(fMatch, Interval.Columns.Count).Address()\n' **********************************************\n\n' Copia a Formata\u00e7\u00e3o da C\u00e9lula encontrada pelo Vlookup\n' ******************************************************************\nRange(CellOrigin).Copy\nActiveCell.PasteSpecial (xlPasteFormats)\nApplication.CutCopyMode = False\n' ******************************************************************\n\nVLOOKUPnew = Application.VLookup(ValueToLook, Interval, ColIndex, False)\nEnd Function\n</code></pre>\n\n<p>Some tips to keep in mind:\n- User must write function - VLOOKUPnew - like he writes normal vlookup formula at excel\n- After press enter, the function must return vlookupnew results his cell's format</p>\n\n<p>Don't copy/paste cell's format. Any tip?</p>\n\n<p>Printscreen of my goal\n<a href=\"http://snag.gy/rZJ8n.jpg\" rel=\"nofollow\">Printscreen of excel</a></p>\n"}, {"tags": ["for-loop", "ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1448469348, "post_id": 33921468, "comment_id": 55604561, "body": "Create a string: <code>&quot;Textbox&quot; &amp; i</code>  Use that string to refer to the item in the form&#39;s <code>Controls</code> collection: <code>If Me.Controls(&quot;Textbox&quot; &amp; i).Value = &quot;&quot; Then</code>  Use the same strategy for your check boxes."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1448483460, "creation_date": 1448483460, "answer_id": 33925896, "question_id": 33921468, "link": "https://stackoverflow.com/questions/33921468/access-vba-for-loops/33925896#33925896", "title": "Access-VBA for loops", "body": "<p>Something like:</p>\n\n<pre><code> For i = 1 To 8\n     Me.Controls(\"checkbox\" &amp; i).Enabled = (Nz(Me.Controls(\"Textbox\" &amp; i).Value) &lt;&gt; \"\")\n Next\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5605045, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VEW0HxO1RsM/AAAAAAAAAAI/AAAAAAAAAxc/Y2dfpYh9XqM/photo.jpg?sz=128", "display_name": "Daniel kirk", "link": "https://stackoverflow.com/users/5605045/daniel-kirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643135, "creation_date": 1448468475, "last_edit_date": 1594643135, "question_id": 33921468, "link": "https://stackoverflow.com/questions/33921468/access-vba-for-loops", "title": "Access-VBA for loops", "body": "<p>I am quite new to VB coding but I do understand some of the basics. I want to create a loop that checks the value within 8 text boxes and enabled a tick box next to the respected text box if it not blank. I am not quite sure on the syntax. I have 8 text boxes called Textbox1 : Textbox8 and 8 checkboxes with names checkbox1-8. This is the code I have already but I just need a bit of help with the syntax.</p>\n\n<pre><code> For i = 1 To 8\n\n If Textbox(i) = \"\" Then\n checkbox(i).enabled = false\n else\n checkbox(i).enabled = true\n\n End If\n\n Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1448468318, "post_id": 33921356, "comment_id": 55603879, "body": "Remove the comments at <code>&#39;Application.ScreenUpdating = False</code> and <code>&#39;Application.EnableEvents = False</code>. It should make it a little bit faster"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1448469170, "post_id": 33921356, "comment_id": 55604444, "body": "You&#39;re using <code>On Error Resume Next</code> - why would you expect an error message?"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1465496639, "post_id": 33921356, "comment_id": 62938253, "body": "@MacroMan That is to trap the error if Word isn&#39;t already running."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1465496883, "post_id": 33921356, "comment_id": 62938390, "body": "@JonPeltier I know, my point is that it&#39;s only set up to trap one specific error. There&#39;s nothing to handle other errors that might explain the OP&#39;s issue."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1465596941, "post_id": 33921356, "comment_id": 62985043, "body": "Then he puts <code>On Error GoTo 0</code> right after the last chance to get an error when starting Word (it also traps the error if Word just can&#39;t be started). Any further errors should open the debugger."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 3432631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f844f6524d78db0fd4f49b7bae74dcee?s=128&d=identicon&r=PG&f=1", "display_name": "R2D2", "link": "https://stackoverflow.com/users/3432631/r2d2"}, "is_accepted": false, "score": 1, "last_activity_date": 1472341270, "creation_date": 1472341270, "answer_id": 39186762, "question_id": 33921356, "link": "https://stackoverflow.com/questions/33921356/make-copy-paste-faster-excel-vba-to-word/39186762#39186762", "title": "make copy paste faster excel vba to word", "body": "<p>At the top of the page add: <strong><em>Option Explicit</em></strong>, which forces you to use variables and speeds it up..\nAt the end of the code add: <strong><em>Application.ScreenUpdating = True</em></strong>, which speeds it up.</p>\n"}], "owner": {"reputation": 21, "user_id": 5604930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b1a32afdbc4b53425d7728a0673f56?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Giron", "link": "https://stackoverflow.com/users/5604930/julio-giron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472341270, "creation_date": 1448468157, "last_edit_date": 1531164843, "question_id": 33921356, "link": "https://stackoverflow.com/questions/33921356/make-copy-paste-faster-excel-vba-to-word", "title": "make copy paste faster excel vba to word", "body": "<p>I\u00b4ve been assembling a code, that basically copy paste data from excel to a word table, but is a little bit slow.</p>\n\n<p>And I also noticed, that when I make false the screenupdating and the events, the programs stop, without any number message of error.</p>\n\n<p>I\u00b4d like to have your recommendations to speed up the code. Thanks!</p>\n\n<pre><code>Sub InspecForm()\n\n'PURPOSE: Copy/Paste An Excel Table Into a New Word Document\n'NOTE: Must have Word Object Library Active in Order to Run _\n  (VBE &gt; Tools &gt; References &gt; Microsoft Word 12.0 Object Library)\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim tbl As Excel.Range\nDim WordApp As Word.Application\nDim myDoc As Word.Document\nDim WordTable As Word.Table\nDim rwcll, wrdlct As Integer\nDim lRow, llRow As Long\n\n\n'Optimize Code\n  'Application.ScreenUpdating = False\n  'Application.EnableEvents = False\n\n'Copy Range from Excel, Set tbl = ThisWorkbook.Worksheets(Sheet1.Name).ListObjects(\"Table1\").Range\n\n'Create an Instance of MS Word\n  On Error Resume Next\n\n    'Is MS Word already opened?\n      Set WordApp = GetObject(class:=\"Word.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If MS Word is not already open then open MS Word\n      If WordApp Is Nothing Then Set WordApp = CreateObject(class:=\"Word.Application\")\n\n    'Handle if the Word Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"Microsoft Word could not be found, aborting.\"\n        GoTo EndRoutine\n      End If\n\n  On Error GoTo 0\n\n'Make MS Word Visible and Active\n  WordApp.Visible = True\n  WordApp.Activate\n\n'Select Document\n  Set myDoc = WordApp.Documents.Open(ThisWorkbook.Path &amp; \"\\Generic Inspection Form.docx\")\n\n'Variables to control the copy and paste\n  rwcll = 2\n  wrdlct = 44\n  lRow = 2\n  llRow = 2\n\n  Worksheets(\"Receiving List\").Range(\"C\" &amp; 2).Copy\n\n            myDoc.Paragraphs(3).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=True\n\n\n\n    Do While (Cells(lRow, 1) &lt;&gt; \"\")\n\n    'Copy Excel Values and Paste on word\n          Worksheets(\"D\").Range(\"A\" &amp; rwcll).Copy\n\n          myDoc.Paragraphs(wrdlct).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=True\n            wrdlct = wrdlct + 1\n\n    'Copy Excel Values and Paste on word\n         Worksheets(\"D\").Range(\"B\" &amp; rwcll).Copy\n\n          myDoc.Paragraphs(wrdlct).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=True\n\n     'Variable for positioning the paste\n           rwcll = rwcll + 1\n           wrdlct = wrdlct + 9\n           lRow = 1 + lRow\n           llRow = 1 + llRow\n\n    'Variable for positioning the paste\n           If llRow = 17 Then\n           wrdlct = wrdlct + 17\n           llRow = 0\n           End If\n\n\n\n    Loop\n\n            lRow = lRow - 2\n            Range(\"G1\").Value = lRow\n\n          Worksheets(\"D\").Range(\"G\" &amp; 1).Copy\n\n            myDoc.Paragraphs(9).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=True\n            Application.CutCopyMode = False\n            wrdlct = wrdlct + 1\n\n\nEndRoutine:\n'Optimize Code\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\n\n'Clear The Clipboard\n  Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 2, "creation_date": 1448467960, "post_id": 33921237, "comment_id": 55603667, "body": "extrapolate:  &quot;to predict by projecting past experience or known data&quot;  I don&#39;t think that&#39;s the word you want ? I&#39;m guessing you want just &quot;extract&quot; ?  It kind of changes the question ... ;)"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1448468749, "post_id": 33921237, "comment_id": 55604153, "body": "How much data?  (Rekey it)  Program would take too long to write and would still be wrong."}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1448469945, "post_id": 33921237, "comment_id": 55604983, "body": "@Ditto: Yes, I just want to extract."}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1448469949, "post_id": 33921237, "comment_id": 55604984, "body": "@xQbert: like 200 records but I&#39;d like something automatic to be reusable in time..."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1448470109, "post_id": 33921237, "comment_id": 55605108, "body": "Your formula implied by the results you seek is not clear. Also, this is not a &#39;code for me&#39; site, it is for specific Q&amp;A. Have you attempted this? What problems did you have?"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1448470289, "post_id": 33921237, "comment_id": 55605233, "body": "@Grade&#39;Eh&#39;Bacon What i&#39;m seeking here some hints for the approach. I think that the formula it&#39;s clear. You see the input and the outputs. Unfortunately I don&#39;t know where to start since it&#39;s not a matter of &quot;i do not know the code by I know how to do it&quot;. Anyway I saw that the question isn&#39;t likable so i&#39;ll keep the problem for me and i will delete the question."}], "answers": [{"tags": [], "owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1448470735, "creation_date": 1448470735, "answer_id": 33922278, "question_id": 33921237, "link": "https://stackoverflow.com/questions/33921237/extract-number-from-text-string/33922278#33922278", "title": "Extract number from text string", "body": "<p>This is error prone but it does give you a starting point to spot check the 200 </p>\n\n<p>Using excel formula's you could do something like this; but each record would still have to be spot checked.  For example if a product has an X in the name beyond the 24x330 then it would error or provide wrong values.  The data is just too unstable to generate a true program to do this and account for all possibilities.  We're not saying it can't be done, simply saying the time would be better spent manually doing it.</p>\n\n<p>As you can see I couldn't easily handle row 3:</p>\n\n<p>Formula for E:\n=IFERROR(MID(B1,FIND(\"X\",UPPER(B1))-2,2),1)*1</p>\n\n<p>Formula for F:\n=MID(B1,IF(FIND(\"ML\",UPPER(B1))&lt;6,1,FIND(\"ML\",UPPER(B1))-3),3)</p>\n\n<p><a href=\"https://i.stack.imgur.com/jQHZa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jQHZa.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 33922278, "answer_count": 1, "score": -2, "last_activity_date": 1448470735, "creation_date": 1448467749, "last_edit_date": 1592644375, "question_id": 33921237, "link": "https://stackoverflow.com/questions/33921237/extract-number-from-text-string", "title": "Extract number from text string", "body": "<p>I'd like to extrapolate all the numbers inside a text string (based on a condition) and if the numbers are separated by a text they should be separated too. Below an example to better understand since the problem it's very complex</p>\n<h3>Example</h3>\n<pre><code>  INPUT                                             OUTPUT1     OUTPUT2\n\n1 500ML BIA BINGWA SORGHUM                          1           500\n2 CLUB 07 VODKA LEMON 24X330ML                      24          330\n3 375ML EAGLE LAGER REGULAR RB 375X20ML             20          375\n4 KONYAGI GIN 1X500ML                               1           500\n5 SAFARI LAGER NRB 24x330 LOCAL                     24          330\n</code></pre>\n<p><em>Notes</em></p>\n<ul>\n<li>In row 1 the <code>OUTPUT1 = 1</code> even there is no <code>1x500ML</code> but only <code>500ML</code></li>\n<li>Row 3 have reverse order, instead of <code>20x375ML</code> -&gt; <code>375x20ML</code> (<em>I think that this can be overcomed with &quot;put smallest in <code>OUTPUT1</code> and Largest in <code>OUTPUT2</code></em>)</li>\n<li>Row 5 doesn't have <code>ML</code> so the recognition should be made by the <code>x</code> used as separator</li>\n</ul>\n<p>both formula and VBA approaches are fine.</p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1448468452, "creation_date": 1448468452, "answer_id": 33921458, "question_id": 33921158, "link": "https://stackoverflow.com/questions/33921158/im-removing-characters-from-a-range-of-cells-how-do-i-stop-it-looping/33921458#33921458", "title": "I&#39;m removing characters from a range of cells. How do I stop it looping?", "body": "<p>Assuming you are not trying to preserve leading/trailing spaces, you could do something like:</p>\n\n<pre><code>c.Value = application.trim(c.Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1448468884, "creation_date": 1448468884, "answer_id": 33921628, "question_id": 33921158, "link": "https://stackoverflow.com/questions/33921158/im-removing-characters-from-a-range-of-cells-how-do-i-stop-it-looping/33921628#33921628", "title": "I&#39;m removing characters from a range of cells. How do I stop it looping?", "body": "<p>Get rid of the <code>.Select</code> statements, they're triggering unneeded processes.</p>\n\n<pre><code>For Each c In Range(\"A1\", SpecialCells(xlLastCell)).Cells\n    With c\n        While InStr(.Value, \"  \"): .Value = Replace(.Value, \"  \", \" \"): Wend\n    End With\nNext\n</code></pre>\n\n<hr>\n\n<p><strong><em>Edit:</em></strong> <em>Just noticed Rory's answer, much more efficient and quicker. I'll leave this here as an example.</em></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "is_accepted": false, "score": 0, "last_activity_date": 1448469241, "creation_date": 1448469241, "answer_id": 33921754, "question_id": 33921158, "link": "https://stackoverflow.com/questions/33921158/im-removing-characters-from-a-range-of-cells-how-do-i-stop-it-looping/33921754#33921754", "title": "I&#39;m removing characters from a range of cells. How do I stop it looping?", "body": "<p>This is great, works perfectly.</p>\n\n<pre><code>Sub Removestuff()\n\n    Range(\"A1\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n\n       For Each c In Range(Selection, ActiveCell)\n    c.Value = Application.Trim(c.Value)\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5604943, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10156253759020203/picture?type=large", "display_name": "Adam Blunt", "link": "https://stackoverflow.com/users/5604943/adam-blunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1448469241, "creation_date": 1448467542, "last_edit_date": 1448468116, "question_id": 33921158, "link": "https://stackoverflow.com/questions/33921158/im-removing-characters-from-a-range-of-cells-how-do-i-stop-it-looping", "title": "I&#39;m removing characters from a range of cells. How do I stop it looping?", "body": "<p>I'm trying to automate a few processes I regularly complete as a way of learning VBA. I'm writing a code that selects all cells in the worksheet and removes a certain character anywhere is occurs. In my case, I'm removing double spaces from strings.</p>\n\n<p>The code I'm using does the job and removes the double spaces but it continues to loop for what seems like an indefinite amount of time.</p>\n\n<pre><code>Dim celref As String\n\n    Range(\"A1\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n\n    For Each c In Range(Selection, ActiveCell)\n    celref = c.Value\n           Do While InStr(1, celref, \"  \")\n           Selection.Replace What:=\"  \", Replacement:=\" \", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n        Loop\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5604959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jINnUAJfobw/AAAAAAAAAAI/AAAAAAAAAAA/kSao16ZY6Sg/photo.jpg?sz=128", "display_name": "Joe Messingschlager", "link": "https://stackoverflow.com/users/5604959/joe-messingschlager"}, "edited": false, "score": 0, "creation_date": 1448988085, "post_id": 33923285, "comment_id": 55806317, "body": "i&#39;m a new user - i don&#39;t have 15 points yet - i&#39;ll upvote when i do - maybe upvote my question and i&#39;ll get points then"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1448473905, "creation_date": 1448473905, "answer_id": 33923285, "question_id": 33921084, "link": "https://stackoverflow.com/questions/33921084/determining-ppt-table-dimensions/33923285#33923285", "title": "Determining PPT Table dimensions", "body": "<p>Assuming you have a reference to the table shape object as oShp this this will give you the number of rows and columns in the table:</p>\n\n<pre><code>Dim intTableRows As Integer, intTableCols As Integer\nintTableRows = oShp.Table.Rows.Count\nintTableCols = oShp.Table.Columns.Count\n</code></pre>\n\n<p>Try it using the immediate window when you have a table selected:</p>\n\n<pre><code>?ActiveWindow.Selection.ShapeRange(1).Table.Rows.Count\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5604959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jINnUAJfobw/AAAAAAAAAAI/AAAAAAAAAAA/kSao16ZY6Sg/photo.jpg?sz=128", "display_name": "Joe Messingschlager", "link": "https://stackoverflow.com/users/5604959/joe-messingschlager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448473905, "creation_date": 1448467326, "last_edit_date": 1448470144, "question_id": 33921084, "link": "https://stackoverflow.com/questions/33921084/determining-ppt-table-dimensions", "title": "Determining PPT Table dimensions", "body": "<p>I'm opening an existing PPT deck from Excel using VBA. I'm editing the cell contents, but I need to determine if I need to add rows or columns depending on my Excel content. How can I determine how many cells wide and tall are in the existing PowerPoint table?</p>\n"}, {"tags": ["vba", "debugging", "compiler-errors", "console", "visual-studio-2015"], "comments": [{"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1448467488, "post_id": 33921065, "comment_id": 55603333, "body": "I&#39;ve created console applications with VS2015 on both 2012R2 and 10. So there is something in you project&#39;s set up that is causing it to try targeting DNX. Double check what framework version it is set to target."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1448470985, "post_id": 33921065, "comment_id": 55605666, "body": "Did you actually intend to create a console mode app that targets DNX?  Nothing particularly simple about it while it is in beta and changing rapidly.  Ensure you picked the right project template to get started, Visual C# &gt; Windows &gt; Classic Desktop &gt; Console Application."}, {"owner": {"reputation": 147, "user_id": 5525537, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-xU8L3CsZsoQ/AAAAAAAAAAI/AAAAAAAAAoM/tCUDTPY5qgs/photo.jpg?sz=128", "display_name": "Mohd Anzal", "link": "https://stackoverflow.com/users/5525537/mohd-anzal"}, "reply_to_user": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1448557024, "post_id": 33921065, "comment_id": 55646616, "body": "@Richard My VS2015 is targeted to Framework 4.5."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 5525537, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-xU8L3CsZsoQ/AAAAAAAAAAI/AAAAAAAAAoM/tCUDTPY5qgs/photo.jpg?sz=128", "display_name": "Mohd Anzal", "link": "https://stackoverflow.com/users/5525537/mohd-anzal"}, "is_accepted": false, "score": 1, "last_activity_date": 1448694340, "creation_date": 1448694340, "answer_id": 33968707, "question_id": 33921065, "link": "https://stackoverflow.com/questions/33921065/debugging-error-on-console-application-using-visual-studio-2015/33968707#33968707", "title": "Debugging Error on Console Application using Visual Studio 2015", "body": "<p>I found the Solution myself,you need a internet connection and visit the following website.. \n<a href=\"http://www.codeproject.com/Tips/1039152/DNX-SDK-Version-dnx-clr-win-x-beta-Failedto\" rel=\"nofollow\">http://www.codeproject.com/Tips/1039152/DNX-SDK-Version-dnx-clr-win-x-beta-Failedto</a></p>\n\n<p>First of all,you need to set the path in Environment Variables for Powershell\nie;C:\\Windows\\System32\\Windows PowerShell\\1.0\nAnd then enter the following comments mentioned in the website..</p>\n\n<p>Hope You guys find the solution \nThank you</p>\n"}], "owner": {"reputation": 147, "user_id": 5525537, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-xU8L3CsZsoQ/AAAAAAAAAAI/AAAAAAAAAoM/tCUDTPY5qgs/photo.jpg?sz=128", "display_name": "Mohd Anzal", "link": "https://stackoverflow.com/users/5525537/mohd-anzal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448694340, "creation_date": 1448467287, "last_edit_date": 1448470426, "question_id": 33921065, "link": "https://stackoverflow.com/questions/33921065/debugging-error-on-console-application-using-visual-studio-2015", "title": "Debugging Error on Console Application using Visual Studio 2015", "body": "<p>While trying to debug a simple Console Application with C# the following error message occurred: </p>\n\n<blockquote>\n  <p>DNX SDK version not installed</p>\n</blockquote>\n\n<p>I got a suggestion to upgrade Windows Powershell to 3.0 or higher. Nevertheless, I found my current Powershell Version is 3.0 and it still doesn't work.\nI am using Windows 8 OS.</p>\n\n<p>What else can I do?</p>\n"}, {"tags": ["xml", "vba", "excel", "vbscript", "xmldom"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 5334744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208027319109184/picture?type=large", "display_name": "Anant Naugai", "link": "https://stackoverflow.com/users/5334744/anant-naugai"}, "edited": false, "score": 0, "creation_date": 1448470775, "post_id": 33921735, "comment_id": 55605545, "body": "Thanks for the quick response Homer. Just a quick query will this work for any type of XML ?(no matter how deep the tags go)"}], "tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": true, "score": 1, "last_activity_date": 1448469174, "last_edit_date": 1495542217, "creation_date": 1448469174, "answer_id": 33921735, "question_id": 33921005, "link": "https://stackoverflow.com/questions/33921005/editing-all-text-nodes-of-xml-dom-using-excel-vba/33921735#33921735", "title": "Editing All Text Nodes of XML DOM using Excel VBA", "body": "<p>For background see <a href=\"https://stackoverflow.com/a/14987356/603855\">here</a>. You need a <strong>recursive</strong> approach:</p>\n\n<pre><code>Option Explicit\n\nDim oFS    : Set oFS  = CreateObject(\"Scripting.FileSystemObject\")\nDim sFSpec : sFSpec   = oFS.GetAbsolutePathName(\"..\\data\\33921005.xml\")\nDim oXML   : Set oXML = CreateObject(\"Msxml2.DOMDocument.6.0\")\noXML.load sFSpec\nIf 0 = oXML.parseError Then\n   recursiveTraversal oXML.documentElement, 0\n   WScript.Echo \"===============\"\n   WScript.Echo oXML.xml\nElse\n   WScript.Echo objMSXML.parseError.reason\nEnd If\n\nSub recursiveTraversal(oElm, nIndent)\n  If oElm.nodeType = 3 Then\n     WScript.Echo Space(nIndent), oElm.text\n     oElm.text = \"{{\" &amp; oElm.parentNode.tagName &amp; \"}}\"\n  Else\n     WScript.Echo Space(nIndent), oElm.tagName\n     If 0 &lt; oElm.childNodes.length Then\n        Dim oChild\n        For Each oChild In oElm.childNodes\n            recursiveTraversal oChild, nIndent + 2\n        Next\n     End If\n  End If\nEnd Sub\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>cscript 33921005.vbs\n Envelope\n   Body\n     Request\n       individual\n         hasName\n           firstName\n             ABC\n           lastName\n             DEF\n         birthDate\n           2015-01-10\n         hasContact\n           type\n             Mobile\n           phoneAddress\n             countryCode\n               02\n             localNumber\n               12345678\n===============\n&lt;?xml version=\"1.0\"?&gt;\n&lt;Envelope&gt;\n        &lt;Body&gt;\n                &lt;Request&gt;\n                        &lt;individual&gt;\n                                &lt;hasName&gt;\n                                        &lt;firstName&gt;{{firstName}}&lt;/firstName&gt;\n                                        &lt;lastName&gt;{{lastName}}&lt;/lastName&gt;\n                                &lt;/hasName&gt;\n                                &lt;birthDate&gt;{{birthDate}}&lt;/birthDate&gt;\n                                &lt;hasContact&gt;\n                                        &lt;type&gt;{{type}}&lt;/type&gt;\n                                        &lt;phoneAddress&gt;\n                                                &lt;countryCode&gt;{{countryCode}}&lt;/countryCode&gt;\n                                                &lt;localNumber&gt;{{localNumber}}&lt;/localNumber&gt;\n                                        &lt;/phoneAddress&gt;\n                                &lt;/hasContact&gt;\n                        &lt;/individual&gt;\n                &lt;/Request&gt;\n        &lt;/Body&gt;\n&lt;/Envelope&gt;\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 5334744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208027319109184/picture?type=large", "display_name": "Anant Naugai", "link": "https://stackoverflow.com/users/5334744/anant-naugai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "accepted_answer_id": 33921735, "answer_count": 1, "score": 0, "last_activity_date": 1448469174, "creation_date": 1448467081, "question_id": 33921005, "link": "https://stackoverflow.com/questions/33921005/editing-all-text-nodes-of-xml-dom-using-excel-vba", "title": "Editing All Text Nodes of XML DOM using Excel VBA", "body": "<p>I am trying to Edit a XML DOM file using Excel VBA, but facing issues reaching beyond level 1 nodes.\nMy requirement is to Modify all (and only) Text nodes but the script I wrote modifies all level 1 nodes.</p>\n\n<p>Please suggest Code Modifications.</p>\n\n<p>Input XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Envelope&gt;\n    &lt;Body&gt;\n        &lt;Request&gt;\n            &lt;individual&gt;\n                &lt;hasName&gt;\n                    &lt;firstName&gt;ABC&lt;/firstName&gt;\n                    &lt;lastName&gt;DEF&lt;/lastName&gt;\n                &lt;/hasName&gt;\n                &lt;birthDate&gt;2015-01-10&lt;/birthDate&gt;\n                &lt;hasContact&gt;\n                    &lt;type&gt;Mobile&lt;/type&gt;\n                    &lt;phoneAddress&gt;\n                        &lt;countryCode&gt;02&lt;/countryCode&gt;\n                        &lt;localNumber&gt;12345678&lt;/localNumber&gt;\n                    &lt;/phoneAddress&gt;\n                &lt;/hasContact&gt;\n            &lt;/individual&gt;\n        &lt;/Request&gt;\n    &lt;/Body&gt;\n&lt;/Envelope&gt;\n</code></pre>\n\n<p>Excel VB Script:</p>\n\n<pre><code>Option Explicit\nSub Test()\nDim xmlDoc\nDim colNodes\nDim objNode\nDim objNodesParam\n\nSet xmlDoc = CreateObject (\"Microsoft.XMLDOM\")\nxmlDoc.Async = \"False\"\nxmlDoc.Load(\"H:\\Desktop\\Request.xml\")\nSet colNodes = xmlDoc.SelectNodes (\"/Envelope/Body/Request/individual/*\")\n\nFor Each objNode In colNodes\nobjNodeParam = \"{{\" &amp; objNode.nodeName &amp; \"}}\"\nobjNode.Text = objNodeParam\nNext\n\nxmlDoc.Save \"H:\\Desktop\\Request.xml\"\n\nEnd Sub\n</code></pre>\n\n<p>Actual Output of Above Script:</p>\n\n<pre><code>  &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n  &lt;Envelope&gt;\n    &lt;Body&gt;\n        &lt;Request&gt;\n            &lt;individual&gt;\n                &lt;hasName&gt;{{hasName}}&lt;/hasName&gt;\n                &lt;birthDate&gt;{{birthDate}}&lt;/birthDate&gt;\n                &lt;hasContact&gt;{{hasContact}}&lt;/hasContact&gt;\n            &lt;/individual&gt;\n        &lt;/Request&gt;\n    &lt;/Body&gt;\n&lt;/Envelope&gt;\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Envelope&gt;\n    &lt;Body&gt;\n        &lt;Request&gt;\n            &lt;individual&gt;\n                &lt;hasName&gt;\n                    &lt;firstName&gt;{{firstName}}&lt;/firstName&gt;\n                    &lt;lastName&gt;{{lastName}}&lt;/lastName&gt;\n                &lt;/hasName&gt;\n                &lt;birthDate&gt;{{birthDate}}&lt;/birthDate&gt;\n                &lt;hasContact&gt;\n                    &lt;type&gt;{{type}}&lt;/type&gt;\n                    &lt;phoneAddress&gt;\n                        &lt;countryCode&gt;{{countryCode}}&lt;/countryCode&gt;\n                        &lt;localNumber&gt;{{localNumber}}&lt;/localNumber&gt;\n                    &lt;/phoneAddress&gt;\n                &lt;/hasContact&gt;\n            &lt;/individual&gt;\n        &lt;/Request&gt;\n    &lt;/Body&gt;\n&lt;/Envelope&gt;\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 0, "creation_date": 1448466909, "post_id": 33920880, "comment_id": 55602938, "body": "My question is that i am using Acropdf for displaying pdf in access form.My code works only for one time when i create new application on access but when i close this application and reopen it it didnt works."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1561414490, "post_id": 33920880, "comment_id": 100047909, "body": "If you paid for a license to this product you could open a ticket with their support. <a href=\"http://www.acropdf.com/support.html\" rel=\"nofollow noreferrer\">acropdf.com/support.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 0, "creation_date": 1448521323, "post_id": 33921495, "comment_id": 55625021, "body": "My version of adobe is 11.0.10 and it is up to date but still it works only for one time when i close access and reopen access application it show only black screen in AcroAdobe control area."}, {"owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 0, "creation_date": 1448522226, "post_id": 33921495, "comment_id": 55625401, "body": "its not working still.only black screen appear with initialize label in it on my access form."}, {"owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 0, "creation_date": 1448523778, "post_id": 33921495, "comment_id": 55626083, "body": "And my office version is office 2010 64bits"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 1, "creation_date": 1448544992, "post_id": 33921495, "comment_id": 55639222, "body": "OK, this may sound crazy, but I get the same error when I tried to load your file because it doesn&#39;t exist on my computer. Check the file name you are trying to load, it doesn&#39;t error out if it can&#39;t find it, it just stays black."}, {"owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "edited": false, "score": 0, "creation_date": 1448617411, "post_id": 33921495, "comment_id": 55666730, "body": "i also verify file path it is correct but control still showing black screen i dnt know why"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1448468528, "creation_date": 1448468528, "answer_id": 33921495, "question_id": 33920880, "link": "https://stackoverflow.com/questions/33920880/showing-pdf-in-access-form-gets-stuck-on-initializing-screen/33921495#33921495", "title": "Showing pdf in Access form gets stuck on initializing screen", "body": "<p>Check that your version of Adobe Reader is up to date and replace your code with this. I was able to load the file several times, close and reopen and load again.</p>\n\n<pre><code>Private Sub Command1_Click()\n    Dim pdf As AcroPDF\n    Set pdf = Me.AcroPDF0.Object\n    pdf.LoadFile \"F:\\Grifols\\files\\Unified Region TemplateV1_0_Budget.pdf\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493835836, "post_id": 43765174, "comment_id": 74576203, "body": "Don&#39;t provide only a link."}], "tags": [], "owner": {"reputation": 1, "user_id": 4900899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0351972fc338f4e4073305e9d0542fcd?s=128&d=identicon&r=PG&f=1", "display_name": "Willis62", "link": "https://stackoverflow.com/users/4900899/willis62"}, "is_accepted": false, "score": -1, "last_activity_date": 1493830176, "last_edit_date": 1493830176, "creation_date": 1493827883, "answer_id": 43765174, "question_id": 33920880, "link": "https://stackoverflow.com/questions/33920880/showing-pdf-in-access-form-gets-stuck-on-initializing-screen/43765174#43765174", "title": "Showing pdf in Access form gets stuck on initializing screen", "body": "<p>I found a solution, that work for me, at <a href=\"http://www.efferen.nl/2012/03/solved-adobe-reader-x-hangs-after-opening-a-pdf-file/\" rel=\"nofollow noreferrer\">this link</a>:</p>\n\n<p>To solve initializing screen for Acrobat Reader XI, just disable \"Enable Protected Mode At Startup\"</p>\n"}, {"tags": [], "owner": {"reputation": 1663, "user_id": 2527116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6tNyk.jpg?s=128&g=1", "display_name": "Lord Darth Vader", "link": "https://stackoverflow.com/users/2527116/lord-darth-vader"}, "is_accepted": false, "score": 0, "last_activity_date": 1506936975, "creation_date": 1506936975, "answer_id": 46523006, "question_id": 33920880, "link": "https://stackoverflow.com/questions/33920880/showing-pdf-in-access-form-gets-stuck-on-initializing-screen/46523006#46523006", "title": "Showing pdf in Access form gets stuck on initializing screen", "body": "<p>I had Acrobat Reader DC installed, I Downgraded to 11 from this link\n<a href=\"https://helpx.adobe.com/acrobat/kb/install-reader-x-windows.html\" rel=\"nofollow noreferrer\">https://helpx.adobe.com/acrobat/kb/install-reader-x-windows.html</a></p>\n\n<p>And changed the following registry setting to get this to work</p>\n\n<p>To disable the Enable Protected Mode at startup configuration, navigate to the following registry key:</p>\n\n<p>HKEY_CURRENT_USER\\Software\\Adobe\\Acrobat Reader\\DC\\Privledged</p>\n\n<p>\u2026 then modify the bProtectedMode REG_DWORD value to 0 to disable and 1 to enable:</p>\n\n<p>found it at this link \n<a href=\"http://terenceluk.blogspot.co.uk/2016/01/disabling-enable-protected-mode-at.html\" rel=\"nofollow noreferrer\">http://terenceluk.blogspot.co.uk/2016/01/disabling-enable-protected-mode-at.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 7293142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c9053315b419ab1f5d9c3c1a3dbde2d?s=128&d=identicon&r=PG&f=1", "display_name": "CajunCoding", "link": "https://stackoverflow.com/users/7293142/cajuncoding"}, "edited": false, "score": 0, "creation_date": 1584652125, "post_id": 56654150, "comment_id": 107510072, "body": "This answer basically has the key -- the app must be compiled to target x86 ONLY.  My application is working and implements both #1 &amp; #2 only.  It works perfectly fine for my, by only calling the LoadFile() method and does not need to use the &#39;.src&#39; property as mentioned."}], "tags": [], "owner": {"reputation": 41, "user_id": 11568838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3SPq5QeoXvY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFabHkjovcKR02rF-4ci8Emzv3Qw/mo/photo.jpg?sz=128", "display_name": "Andrew Gale", "link": "https://stackoverflow.com/users/11568838/andrew-gale"}, "is_accepted": false, "score": 1, "last_activity_date": 1561412950, "last_edit_date": 1561412950, "creation_date": 1560878392, "answer_id": 56654150, "question_id": 33920880, "link": "https://stackoverflow.com/questions/33920880/showing-pdf-in-access-form-gets-stuck-on-initializing-screen/56654150#56654150", "title": "Showing pdf in Access form gets stuck on initializing screen", "body": "<p>I struggled with this issue for a long time, it was only happening when the EXE was run as Administrator.</p>\n\n<p>My fix was the following:</p>\n\n<ol>\n<li>Set EXE compile to x86 CPU</li>\n<li>Change PDF output path to ProgramData: \"C:\\ProgramData(Client)(Project)\"</li>\n<li>Update code to first call \"AxAcroPDF1.LoadFile(PDFfilepath)\" then call \"AxAcroPDF1.src = PDFfilepath\"</li>\n</ol>\n\n<p>Important: If you need to run the application on Windows Server for some reason, then the 32bit version of Crystal Runtime needs to be installed</p>\n"}], "owner": {"reputation": 11, "user_id": 5299619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b488f55cc13f9bde7e57625ec8924fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Ghazanfar Ali", "link": "https://stackoverflow.com/users/5299619/ghazanfar-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1594540794, "creation_date": 1448466710, "last_edit_date": 1594540794, "question_id": 33920880, "link": "https://stackoverflow.com/questions/33920880/showing-pdf-in-access-form-gets-stuck-on-initializing-screen", "title": "Showing pdf in Access form gets stuck on initializing screen", "body": "<p>I am trying to display a pdf file in an Access form, but my code only works once. When I close the Access application and reopen it Acropdf doesn't display the pdf, it just gets stuck on this screen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZSvnv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZSvnv.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Command1_Click()\n    Dim strPdfDoc As String\n    'Below is my source\n    strPdfDoc = \"F:\\Grifols\\files\\Unified Region TemplateV1_0_Budget.pdf\"\n    'Here I am loading the pdf file with Acropdf \n    AcroPDF0.loadFile strPdfDoc\nEnd Sub\n</code></pre>\n\n<p>I get no errors when debugging the code, but the pdf never shows.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448466730, "post_id": 33920802, "comment_id": 55602813, "body": "Try using: <code>Set TableRange = Application.Range(TableName &amp; &quot;[#All]&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 1831476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca96355e095f5ed2296120da711c10?s=128&d=identicon&r=PG", "display_name": "futureboy", "link": "https://stackoverflow.com/users/1831476/futureboy"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448467548, "post_id": 33920802, "comment_id": 55603373, "body": "That produced the same error but with <code>&quot;_Application failed&quot;</code> instead of _Global..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448468066, "post_id": 33920802, "comment_id": 55603720, "body": "Then I guess at least one of the table names is incorrect."}, {"owner": {"reputation": 1, "user_id": 1831476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca96355e095f5ed2296120da711c10?s=128&d=identicon&r=PG", "display_name": "futureboy", "link": "https://stackoverflow.com/users/1831476/futureboy"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448468542, "post_id": 33920802, "comment_id": 55604020, "body": "Ok, so I just realized that my <code>filename</code> and <code>filenm</code> were wrong. I corrected them and, even though I&#39;m still getting the <code>_Application failed</code> error, the tables are now being exported to their respective pipe-delimited TXT files. If the Range method is still failing, how could the export still succeed?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448468942, "post_id": 33920802, "comment_id": 55604287, "body": "What is <code>myrng</code> in your posted code?"}, {"owner": {"reputation": 1, "user_id": 1831476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca96355e095f5ed2296120da711c10?s=128&d=identicon&r=PG", "display_name": "futureboy", "link": "https://stackoverflow.com/users/1831476/futureboy"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448469035, "post_id": 33920802, "comment_id": 55604352, "body": "That&#39;s supposed to be <code>TableRange</code>, but it was also a typo in the question - it&#39;s corrected now, but still getting the error. It&#39;s not a big deal, since the data is successfully exporting, and I am able to suppress the error."}], "owner": {"reputation": 1, "user_id": 1831476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ca96355e095f5ed2296120da711c10?s=128&d=identicon&r=PG", "display_name": "futureboy", "link": "https://stackoverflow.com/users/1831476/futureboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448469072, "creation_date": 1448466462, "last_edit_date": 1448469072, "question_id": 33920802, "link": "https://stackoverflow.com/questions/33920802/using-string-as-named-table-for-range-object", "title": "Using string as Named Table for Range Object", "body": "<p>I have a list of text values each of which is the name of a Named Table on a different Worksheet of my Workbook.</p>\n\n<pre><code>Colum1    Value\nTable1    True\nTable2    False\nTable3    False\nTable4    True\nTable5    True\n</code></pre>\n\n<p>My VBA code is going through the list like so:</p>\n\n<pre><code>For Each cell In MyRange\n    If cell.Offset(0, 1).Value = \"True\" Then\n        Call WriteTXTFile(cell.Value)\n    End If\nNext cell\n</code></pre>\n\n<p>The WriteTXTFile subroutine needs to take the Table name and use it as a range to get all the data from the table and export it as a pipe-delimited TXT file like so:</p>\n\n<pre><code>Private Sub WriteTXTFile(TableName As String)\nDim TableRange As Range\n\nSet TableRange = Range(TableName &amp; \"[#All]\")\n\nConst ForReading = 1, ForWriting = 2, ForAppending = 3\nConst TristateUseDefault = -2, TristateTrue = -1, TristateFalse = 0\nDim filesys, filenm, txtstrm\nDim CurrentCell As String\n\nSet filesys = CreateObject(\"Scripting.FileSystemObject\")\nfilesys.CreateTextFile ThisWorkbook.Path &amp; \"\\\" &amp; TableName &amp; \".txt\"\nSet filenm = filesys.GetFile(ThisWorkbook.Path &amp; \"\\\" &amp; TableName &amp; \".txt\")\nSet txtstrm = filenm.OpenAsTextStream(ForWriting, TristateFalse)\n\nFor Each cell In TableRange\n    CurrentCell = cell.Value\n    txtstrm.Write (Chr(124) &amp; CurrentCell)\nNext cell\n\ntxtstrm.Close\n</code></pre>\n\n<p>However, I keep getting an error:  </p>\n\n<blockquote>\n  <p>\"Method Range of object _Global failed.\"</p>\n</blockquote>\n\n<p>I'm sure there's something wrong with the way the subroutine sets the TableRange, but I can't find any information on how to pass a Named Table name as a string to a subroutine and use it in a range.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1448473798, "last_edit_date": 1495539875, "creation_date": 1448473798, "answer_id": 33923251, "question_id": 33920532, "link": "https://stackoverflow.com/questions/33920532/multiple-like-queries-access/33923251#33923251", "title": "multiple like queries access", "body": "<p>I think you might simplify your approach a bit if you were to use fuzzy text search.  The common way of doing this is to use the Levenshtein distance, or the number of changes it takes to turn one string into another.  A nice implementation of the Levenshtein is here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4243036/levenshtein-distance-in-excel\">Levenshtein Distance in Excel</a></p>\n\n<p>In this manner, you can find the closest possible match on city, street, first name, last name, etc.  You can even set up a \"reasonable\" limit, such as any record where the Levenshtein > 10 may be \"unreasonable.\"  I threw out 10, but it will vary depending on your data.</p>\n\n<p>Some optimization notes:</p>\n\n<ol>\n<li>Based on the fact that you have 300,000 rows, I would go so far as to say you still need to narrow your results a bit.  Reading all 300,000 records for each match is unreasonable.  For example, if you had state (which I see you don't), then a reasonable limit is to say the state must match.  That takes your 300,000 down to a much lower number.  You may want to also assume that the first letter of the last name must match.  That will narrow it down further.  Etc, etc.</li>\n<li>If you can, I would use an actual RDBMS instead of Access to store the data and let the DB server do the heavy lifting.  PostgreSQL, in particular, has nice fuzzy search capabilities available through extensions</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 3316276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8320b706979ab4c91a4213860518b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Houlihan", "link": "https://stackoverflow.com/users/3316276/tom-houlihan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448540786, "creation_date": 1448540786, "answer_id": 33938706, "question_id": 33920532, "link": "https://stackoverflow.com/questions/33920532/multiple-like-queries-access/33938706#33938706", "title": "multiple like queries access", "body": "<p>One thing I have done in similar situations is to extract the first few characters of the last name, the first one or two characters of the first name, and the postal code, and write it from both tables to temp tables, and do the matching query on the truncated tables.  After some tinkering with how many characters to extract, I can usually find a balance between speed and false positive matches that I can live with, then have a human review the resulting list. The speed difference can be significant - if instead of matching Schermerstien, Stephan to Schermerstien, Ste*an, you are matching Scher, St to Scher, St, you can see the processing advantage.  But it only works if there is a small intersection between the tables and you can tolerate a human review step.</p>\n"}], "owner": {"reputation": 21, "user_id": 5588904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02db64eb3c8cadf26e4d69a7c813e8c?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/5588904/j-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448540786, "creation_date": 1448465751, "question_id": 33920532, "link": "https://stackoverflow.com/questions/33920532/multiple-like-queries-access", "title": "multiple like queries access", "body": "<p>I am using Access.<br>\n<strong><em>Szenario</em></strong><br>\nAt work I've got a table with around 300k rows which defines Person IDs to House IDs with the associated information (First Name, Last Name, City, \"Street + StreetNumber\", Postal Code). Each person can live in n houses, and each house can inhabit n of those people.</p>\n\n<p>When I am visited by various persons I get a table. This table is filled in by a human being, so there are no IDs in it and unfortunately often have spelling errors and information missing. It should contain \"First Name\", \"Last Name\", \"Street &amp; Nr\", \"City\", \"Postal Code\". </p>\n\n<p>To integrate the data I need the IDs from the persons. To counter the spelling error problem I want to build a table which gives me results ordered by \"matching priority\".</p>\n\n<p>The handfilled Table is called <strong>tbl_to_fill</strong> and got empty Person-ID row, an indexed autonumber and First Name, Last Name, Street &amp; Nr, City and Postal Code. The table with the relation information is called <strong>tbl_all</strong>.</p>\n\n<p>So if I find an exact match (with a join query) from tbl_to_fill to tbl_all for \"First Name\", \"Last Name\" and \"Postal Code\" or \"First Name\", \"Last Name\", \"Street &amp; Nr\", \"City\" it gets \"matching priority\" 1. If I find an exact match with only \"Last Name\", \"Postal Code\" or \"Last Name\", \"City\", \"Street &amp; Nr\" I get a \"matching priority\" 2. And there are few more levels.</p>\n\n<p>Then comes the tricky part:<br>\nNow I built a \"tbl_filter\" from \"tbl_to_fill\" with tweaked informations: The street numbers are cut, common spelling errors are replaced with a <code>'*'</code> (for example a common spelling error in german names: ph - f, like Stefan and Stephan), city names are shortened after the last space \" \" found and some more.</p>\n\n<p>With this table I look for the same criteria as stated above, but with a <code>\"LIKE '*' &amp; tbl_filter.Field &amp; '*'\"</code> - query. And they get matching priority same as above + 10.\nNow those join queries and the Like queries are all aggregated via a union query, let's call this Query <strong>001 quni All rows</strong>.</p>\n\n<p>I got this to work exactly like I want to, but it takes AGES, every time I run the last query.</p>\n\n<p><strong><em>My Question</em></strong><br>\nHas someone done something alike? What can I do to fasten the process?</p>\n\n<p>As many of my matching criteria expect First Name and Last Name to fit and then some more, should I first extract only matching rows from \"tbl_all\" via a make table and then run the according queries?<br>\nShould I use regex instead of like queries on a field which contains all information concatenated by a \"-\"?\nIs there a better way to assign those priorities? Maybe all in one query via an Iff - function? </p>\n\n<pre><code>Select ..., matching_priority = IFF(tbl_all.\"First Name\" =  tbl_to_Fill.\"FirstName\",1,\n    IFF(...)\n)\nFrom tbl_all;\n</code></pre>\n\n<p>I am a self tought access developer, so i often have problems knowing which approach is the most optimized.\nI use VBA regularly and dont shy away from it, so if you got a solution via VBA let me know.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1448465774, "post_id": 33920457, "comment_id": 55602044, "body": "Is there anything unique about this one failing formula? Is the filename reference only used here? What is the specific failure? Need some more information in order to begin isolating the cause."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1448465868, "post_id": 33920457, "comment_id": 55602132, "body": "Nothing unique except obviously, it&#39;s the only file with that filename. The master has other formulas that pull data from other named ranges from the same file. The failure is that the number in the file is not reflected in the master. Edit: <code>=&#39;D:\\path\\file.XLSM&#39;!TOTOPS</code> from the same file works fine."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448465941, "post_id": 33920457, "comment_id": 55602191, "body": "What <b>is</b> reflected in the master?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448465990, "post_id": 33920457, "comment_id": 55602234, "body": "A number that is &quot;randomly&quot; 9100 less than the number in the book. Random because I can&#39;t determine why that exact amount :/"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1448466214, "post_id": 33920457, "comment_id": 55602406, "body": "No typing error or something like that? Having a cell in that workbook with <code>=TOTSAL</code> works? Also having just the REF to this testcell works?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448466337, "post_id": 33920457, "comment_id": 55602509, "body": "I am about to edit OP because there&#39;s one important detail I left out... no typo because a rerun of macro worked fine."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1448466401, "post_id": 33920457, "comment_id": 55602555, "body": "Just curious if the named ranges are set up differently in different files (scope as gobal vs. worksheet) or if the other files are saved with certain sheets selected.  Also, if you create a new workbook with the same exact name and location (temporarily changing the name of the workbook that does not work), does that fix the problem?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448466579, "post_id": 33920457, "comment_id": 55602689, "body": "No, all the books are identical actually. Literally. Every last detail. Number of sheets, sheetnames, named ranges, column width, formatting. Really.  The only difference is the numbers within. Edit: not all sheet names are identical. Most are. Edit2: the formulas in the master book are all the same except the filename it references."}, {"owner": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "edited": false, "score": 0, "creation_date": 1448466852, "post_id": 33920457, "comment_id": 55602892, "body": "What does the cell say after the macro is run. Is it #ref? or do you see the formula pasted out? If it is #ref, try typing in the formula manually, clicking on the worksheet range you want it to be, and see if there are any differences. If you see the formula written out, check if there is a &quot;&#39;&quot; in front of the formula, or check the formatting of the cell (right click -&gt; format cells) and see if it is text, for example, or any different from the cells around it that work."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "edited": false, "score": 0, "creation_date": 1448466903, "post_id": 33920457, "comment_id": 55602932, "body": "@user3476534 please see comment above to Rory. The cell gives a number. Just an incorrect one :/"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1448466942, "post_id": 33920457, "comment_id": 55602971, "body": "@pnuts what do you mean? It&#39;s a named range in the file that is opened. So I guess local to that file?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448466997, "post_id": 33920457, "comment_id": 55603016, "body": "Worksheet.. Edit: technically, it&#39;s a formula that pulls data from another sheet in the book."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448467089, "post_id": 33920457, "comment_id": 55603073, "body": "No, not sure how XD But even then, why only this one formula out of hundreds? All the other formulas are built exactly the same."}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1448468514, "post_id": 33920457, "comment_id": 55603999, "body": "First thing I would try is taking one of the other workbooks that it doesn&#39;t encounter any problems with and save it over the problematic one (make a back-up copy first so you have a record of the correct values). Run your macro and see if it works. If it does, then copy the correct field values from the backup into the new template, save it and then re-run your macro. This won&#39;t identify what was wrong with the original, but if it solves the problem then who cares! ;)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448468653, "post_id": 33920457, "comment_id": 55604089, "body": "Well, the problem is solved already. A rerun of the macro worked. The issue is that a sensitive report was sent to some VIPS from the bad run which makes any changes thereafter uncomfortable to explain so trying to pinpoint problem so it won&#39;t ever happen again XD"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1448469202, "post_id": 33920457, "comment_id": 55604465, "body": "Hmm. Interesting that re-running it resolved the issue without any code changes. Does your VBA include <code>On Error Resume Next</code> anywhere in it? perhaps it encountered a one-off error without reporting any problems at run time."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448469301, "post_id": 33920457, "comment_id": 55604523, "body": "Exactly. This is why I don&#39;t think I will ever be able to pinpoint error :/ Very good point on the error resume next. But no, no such line in the code or any error handling actually... XD"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448487935, "creation_date": 1448465577, "last_edit_date": 1531161705, "question_id": 33920457, "link": "https://stackoverflow.com/questions/33920457/one-formula-out-of-hundreds-fail", "title": "One formula out of hundreds fail", "body": "<p>I have a master workbook with multiple sheets with each sheet holding hundreds of formulas that pull data from a named range from hundreds of other books. The macro in the master opens all the other books in order to update the formulas. Everything works (updates) except the one formula below:</p>\n\n<pre><code>='D:\\path\\file.XLSM'!TOTSAL\n</code></pre>\n\n<p><code>TOTSAL</code> is a named range in the <code>file</code> book that holds a number. That formula actually repeats hundreds of times in the master, just with different files (all the books have that named range).</p>\n\n<p>I can post code to how my macro works but if something was bad in the macro, how can only <strong><em>one</em></strong> formula fail out of hundreds?</p>\n\n<p>The hundreds of books that the master opens are on a shared drive. IT has changed permission so users who can access said books only have read permission, not write. While it's possible that a user may be reading the file when I run the macro, it's very highly unlikely. And the nature of the macro prompts for a password if the book is opened.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1448465842, "post_id": 33920398, "comment_id": 55602108, "body": "Nope, you&#39;ll have to loop again to test and set a boolean to know if you already have it or not! Or you could use a dictionnary : <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">snb-vba.eu/VBA_Dictionary_en.html</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448465901, "post_id": 33920398, "comment_id": 55602161, "body": "do you want to place the boxes on a UserForm or just on a sheet?"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448466147, "post_id": 33920398, "comment_id": 55602352, "body": "@ScottHoltzman My end goal is to have this combo box be able to select an option, then apply a certain filter to ~15 pivot tables at the same time. This is the best way that I can think of to do it. If there&#39;s a better way, I&#39;m more than open to suggestions!"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1448466301, "post_id": 33920398, "comment_id": 55602477, "body": "@R3uK, is there a way to display all the items in a combobox&#39;s list? For that matter (this may reveal how new I am to VBA), is there an <code>in</code> function? Like, could I say <code>If cellName In (list of current combobox values) Then Next ELSE combobox1.additem i Next end If</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1448466461, "post_id": 33920398, "comment_id": 55602597, "body": "Nope, there isn&#39;t such a thing in Comboboxes! You&#39;ll have to loop on the items! There is something like this for dictionnary (<code>.Exists</code>)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1448466577, "post_id": 33920398, "comment_id": 55602687, "body": "Having <code>ComboBox1.AddItem i</code> will only add a number... are you sure you want that?"}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "edited": false, "score": 0, "creation_date": 1448466596, "post_id": 33920398, "comment_id": 55602703, "body": "I don&#39;t understand what you mean by &quot;loop on the items.&quot; In the example I linked, it looks to me like they used the loop and boolean as your described, but I don&#39;t know how to make it apply to my situation."}, {"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1448466626, "post_id": 33920398, "comment_id": 55602727, "body": "@DirkReichel, you&#39;re right. I meant cellName <i>facepalm</i>"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "edited": false, "score": 1, "creation_date": 1448466980, "post_id": 33920829, "comment_id": 55602998, "body": "Perfect! I threw it on a button, and it worked like a charm. You&#39;re the man, Scott!"}, {"owner": {"reputation": 3060, "user_id": 1101846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f30e989c661c62552c62e7af06f2d0e?s=128&d=identicon&r=PG&f=1", "display_name": "Cor_Blimey", "link": "https://stackoverflow.com/users/1101846/cor-blimey"}, "edited": false, "score": 1, "creation_date": 1448468412, "post_id": 33920829, "comment_id": 55603940, "body": "worst-case O(n^2) performance though. A collection works nicely: <code>On Error Resume Next: For each item in range: collection.Add item.value: Next: For each item in collection: ComboBox1.Add....</code> etc"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1448466554, "creation_date": 1448466554, "answer_id": 33920829, "question_id": 33920398, "link": "https://stackoverflow.com/questions/33920398/add-name-fields-to-a-combobox-based-on-a-column-without-repeating/33920829#33920829", "title": "Add name fields to a ComboBox based on a column without repeating?", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim lastRow As Integer\nDim cellName As Integer\nDim match As Boolean\nDim iItem As Integer, sItem As String\n\nlastRow = Sheets(1).Range(\"F2\").End(xlDown).Row\n\nFor i = 2 To lastRow\n\n    match = False\n    sItem = Sheets(1).Range(\"F\" &amp; i).Value2\n\n    For iItem = 0 To ComboBox1.ListCount - 1\n\n        If ComboBox1.List(iItem) = sItem Then\n\n            match = True\n            Exit For\n\n        End If\n\n    Next iItem\n\n    If Not match Then ComboBox1.AddItem sItem\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 33920829, "answer_count": 1, "score": 0, "last_activity_date": 1448466554, "creation_date": 1448465419, "last_edit_date": 1495540319, "question_id": 33920398, "link": "https://stackoverflow.com/questions/33920398/add-name-fields-to-a-combobox-based-on-a-column-without-repeating", "title": "Add name fields to a ComboBox based on a column without repeating?", "body": "<p>I found this link here: <a href=\"https://stackoverflow.com/questions/27247459/vba-code-to-create-sheets-based-on-the-values-in-column-a\">VBA Code to Create Sheets based on the values in column A</a> </p>\n\n<p>It tells me how to create a list of sheets from a column, based on the names in one of the columns on the first sheet without repeating. </p>\n\n<p>I've tried to translate this code to being useable for a ComboBox, but my VBA skills are most definitely lackluster. </p>\n\n<p>What I have so far is </p>\n\n<pre><code>Private Sub form_load()\n\nDim lastRow As Integer\nDim cellName As Integer\nDim match As Boolean\n\nlastRow = Sheets(1).Range(\"F2\").End(xlDown).Row\n\nFor i = 2 To lastRow\n    match = False\n    cellName = .Sheets(1).Range(\"F\" &amp; i).Value\n\n    For _________________\n\nComboBox1.AddItem i\n\n\nEnd Sub\n</code></pre>\n\n<p>You'll notice that in the example I linked, they use the code </p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n        If ws.Name = sheetName Then\n            match = True\n        End If\n    Next\n</code></pre>\n\n<p>to determine if a cell has already been used as a sheet name. However, I'm not familiar enough with VBA to know whether or not a complementary command exists to check for values in a combobox. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1448465488, "post_id": 33920243, "comment_id": 55601846, "body": "Yes you can, and you might have to use <code>VBA.Environ(&quot;UserName&quot;)</code> to make it work on some computers! ;)"}, {"owner": {"reputation": 3060, "user_id": 1101846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f30e989c661c62552c62e7af06f2d0e?s=128&d=identicon&r=PG&f=1", "display_name": "Cor_Blimey", "link": "https://stackoverflow.com/users/1101846/cor-blimey"}, "edited": false, "score": 2, "creation_date": 1448465964, "post_id": 33920243, "comment_id": 55602207, "body": "this is not security. You should only even consider it if it is for a convenience (i.e. hiding not relevant info)."}, {"owner": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "edited": false, "score": 0, "creation_date": 1448466533, "post_id": 33920243, "comment_id": 55602652, "body": "yes this is not really for security. This is just to make sure that the users will only see fewer worksheets."}, {"owner": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "edited": false, "score": 0, "creation_date": 1448466682, "post_id": 33920243, "comment_id": 55602773, "body": "BTW, when I user environ(&quot;username&quot;) here, it will only show the employee ID which is alphanumeric and not really the name of the employee. So can you give me an example? let say the ID of one employee is ABC123 and I only want him to see worksheet named as sheet1 and sheet2. Then for employee DEF456 it will only show sheet3 and sheet4"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1448469607, "last_edit_date": 1448469607, "creation_date": 1448466419, "answer_id": 33920785, "question_id": 33920243, "link": "https://stackoverflow.com/questions/33920243/hide-unhide-sheets-using-username/33920785#33920785", "title": "Hide/Unhide sheets using username", "body": "<p>Example of what you want (<em>for educational purposes only</em>):</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nSelect Case Environ(\"username\")\n    Case \"bloggsj\"\n        Sheets(1).Visible = False\n        Sheets(2).Visible = True\n    Case \"doej\", \"murphyp\", \"manm\"\n        Sheets(2).Visible = True\n        Sheets(1).Visible = False\n    Case Else\n        '// Unknown, close workbook\n        ThisWorkbook.Close False\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p><strong>Important:</strong> As already mentioned in the comments, this is <strong>not</strong> a secure way of protecting data, two quick reasons as an example:</p>\n\n<ul>\n<li>The Environment variable \"username\" can easily be changed which would trick the code into thinking that the person is a different user.</li>\n<li>The <code>Workbook_Open</code> event can be easily bypassed by holding the shift button when opening the file.</li>\n</ul>\n"}], "owner": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448469607, "creation_date": 1448465016, "last_edit_date": 1531164843, "question_id": 33920243, "link": "https://stackoverflow.com/questions/33920243/hide-unhide-sheets-using-username", "title": "Hide/Unhide sheets using username", "body": "<p>I just want to ask if it's possible to create a VBA that detects the identity of the person opening the workbook using Environ$(\"username\") and using that I can hide some of the worksheet and unhide other worksheet that only that person can see?. Then if another person opens up the same workbook it will then hide/unhide worksheets for that other person.</p>\n"}, {"tags": ["vba", "function", "excel", "autofill"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5604657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f2ea6ab854d1fde5b49405484331e89?s=128&d=identicon&r=PG&f=1", "display_name": "Top_Meat", "link": "https://stackoverflow.com/users/5604657/top-meat"}, "edited": false, "score": 0, "creation_date": 1448912597, "post_id": 33920185, "comment_id": 55769113, "body": "I have one more question for you.... How do I code VBA to autofill down to the last row from the current selected cell? Sorry I am a total VBA n00b."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 1, "user_id": 5604657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f2ea6ab854d1fde5b49405484331e89?s=128&d=identicon&r=PG&f=1", "display_name": "Top_Meat", "link": "https://stackoverflow.com/users/5604657/top-meat"}, "edited": false, "score": 0, "creation_date": 1448976632, "post_id": 33920185, "comment_id": 55798115, "body": "Down to the last row in the sheet? <code>Range(&quot;B1&quot;).Resize(Rows.Count,1).FillDown</code>"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1448465894, "last_edit_date": 1448465894, "creation_date": 1448464839, "answer_id": 33920185, "question_id": 33920059, "link": "https://stackoverflow.com/questions/33920059/how-to-autofill-a-cell-down-based-on-a-variable-value-n/33920185#33920185", "title": "How to autofill a cell down based on a variable value &#39;n&#39;", "body": "<pre><code>Range(\"B1\").Resize(Range(\"C1\").Value,1).FillDown\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1448464915, "creation_date": 1448464915, "answer_id": 33920200, "question_id": 33920059, "link": "https://stackoverflow.com/questions/33920059/how-to-autofill-a-cell-down-based-on-a-variable-value-n/33920200#33920200", "title": "How to autofill a cell down based on a variable value &#39;n&#39;", "body": "<p>Put this in B2 and copy down:</p>\n\n<pre><code>=IF(ROW()&lt;=$C$1,$B$1,\"\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5604657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f2ea6ab854d1fde5b49405484331e89?s=128&d=identicon&r=PG&f=1", "display_name": "Top_Meat", "link": "https://stackoverflow.com/users/5604657/top-meat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1448465894, "creation_date": 1448464459, "last_edit_date": 1448464804, "question_id": 33920059, "link": "https://stackoverflow.com/questions/33920059/how-to-autofill-a-cell-down-based-on-a-variable-value-n", "title": "How to autofill a cell down based on a variable value &#39;n&#39;", "body": "<p>I am calculating a variable number of rows in cell C1, which I need to autofill down by, in cell B1. For example, if C1 returns the number '3', then I need to autofill cell B1 down three rows.  </p>\n\n<p>Any way to do this using a logic function or VBA?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1448466090, "post_id": 33919947, "comment_id": 55602308, "body": "<a href=\"http://www.cpearson.com/excel/InsertProcedureNames.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/InsertProcedureNames.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1448465770, "post_id": 33920065, "comment_id": 55602039, "body": "In other words, you say, there is no such thing like ActiveMacro analogically to ActiveSheet or ActiveCell? Or may bee you say that you do not know if such a thing exists?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 2, "creation_date": 1448466090, "post_id": 33920065, "comment_id": 55602307, "body": "@PrzemyslawRemin read e.g. <a href=\"http://www.pcreview.co.uk/threads/accessing-the-call-stack-in-an-excel-vba-macro.4015153/\" rel=\"nofollow noreferrer\">this</a>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1448464471, "creation_date": 1448464471, "answer_id": 33920065, "question_id": 33919947, "link": "https://stackoverflow.com/questions/33919947/get-the-name-of-currently-executed-macro-in-excel-vba/33920065#33920065", "title": "Get the name of currently executed macro in Excel VBA", "body": "<p>That which is not exposed must be remembered.</p>\n\n<p>Define a Global variable and have each Sub setup the variable at entry.  Thus a general error handler can determine a miscreant.</p>\n\n<p>If you have a nested call structure <em>(with subs calling subs)</em>, you will need to implement a stack.</p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "accepted_answer_id": 33920065, "answer_count": 1, "score": 0, "last_activity_date": 1526482739, "creation_date": 1448464136, "last_edit_date": 1448464604, "question_id": 33919947, "link": "https://stackoverflow.com/questions/33919947/get-the-name-of-currently-executed-macro-in-excel-vba", "title": "Get the name of currently executed macro in Excel VBA", "body": "<p>How to get the currently executed macro name in Excel VBA?</p>\n\n<pre><code>Sub WhateverMacroName()\n    MsgBox (GetTheNameOfCurrentlyExecutedMacro)\nEnd Sub\n</code></pre>\n\n<p>Which should return <code>WhateverMacroName</code></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1448464840, "post_id": 33919839, "comment_id": 55601392, "body": "Don&#39;t know if it will solve it, but your query runs on <code>table</code>, so your criterium must be the other way around: <code>WHERE table.string &lt;&gt; function(table.string)</code>"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448464976, "post_id": 33919839, "comment_id": 55601487, "body": "Can you show the code for <code>function</code>?"}, {"owner": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "edited": false, "score": 0, "creation_date": 1448465112, "post_id": 33919839, "comment_id": 55601594, "body": "Shouldn&#39;t your WHERE clause be function(table.string) and not function(string)?"}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "edited": false, "score": 0, "creation_date": 1448466442, "post_id": 33919839, "comment_id": 55602587, "body": "@Duston Yeah, sorry. fixed that now."}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1448466600, "post_id": 33919839, "comment_id": 55602708, "body": "@andre451 I changed it around, though I don&#39;t see how it makes any difference. Still get the same error, obviously."}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448466852, "post_id": 33919839, "comment_id": 55602891, "body": "@Hambone  The function gets the table.string, changes/deletes some characters in it, doesn&#39;t change nulls, and returns table.string as string type (which means that if table.string is a null, it will return a null, I think.) Why does the code for the function matter?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448472017, "post_id": 33919839, "comment_id": 55606310, "body": "I was wondering if it wasn&#39;t handling the nulls properly...  can you post the code for function?"}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448473443, "post_id": 33919839, "comment_id": 55607169, "body": "@Hambone I&#39;m adding the function to the question. Hope you can solve this."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448475201, "post_id": 33919839, "comment_id": 55608202, "body": "Two final questions...  is your table really named <code>table</code> and your field really named <code>string</code>?  Also, where you have <code>function</code> up there, I assume in your actual query, you called out the function <code>illegalCharEliminate</code> and didn&#39;t actually say <code>function</code>?"}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1448475607, "post_id": 33919839, "comment_id": 55608439, "body": "@Hambone Yes, sorry, I should have mentioned these. Of course my table is <b>not</b> named <code>table</code>, nor is my <code>string</code> column named that. My function <b>is</b> actually <code>illegalCharEliminate</code> and when I added it to the code I left it&#39;s real name so that what it does would be apparent. Thank you so much for trying to help."}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1448535890, "post_id": 33923807, "comment_id": 55633528, "body": "thank you so much. This worked perfectly. I didn&#39;t know how to do conditional statements in access beforehand, thanks!"}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 1, "last_activity_date": 1448475697, "creation_date": 1448475697, "answer_id": 33923807, "question_id": 33919839, "link": "https://stackoverflow.com/questions/33919839/data-type-mismatch-error-in-string-query/33923807#33923807", "title": "Data type mismatch error in string query", "body": "<p>I think your assessment that the null is the problem was correct.  The function fails when you give it a null value because a null is not a string (it's not anything).  I think this fix might address your issue:</p>\n\n<pre><code>SELECT\n  table.string,\n  illegalCharEliminate(iif(isnull(table.string), \"\", table.string)) AS afterFix\nFROM [table]\nWHERE\n  illegalCharEliminate(iif(isnull(table.string), \"\", table.string)) &lt;&gt; table.string;\n</code></pre>\n\n<p>In essence, this converts null values to an empty string.</p>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2150, "favorite_count": 0, "accepted_answer_id": 33923807, "answer_count": 1, "score": 1, "last_activity_date": 1448475697, "creation_date": 1448463839, "last_edit_date": 1448473669, "question_id": 33919839, "link": "https://stackoverflow.com/questions/33919839/data-type-mismatch-error-in-string-query", "title": "Data type mismatch error in string query", "body": "<p>I'm trying to run the following query from Access's Create Query:</p>\n\n<pre><code>SELECT table.string, function(table.string) AS afterFix\nINTO checkFix\nFROM table\nWHERE function(table.string)&lt;&gt;table.string;\n</code></pre>\n\n<p>I get the following error when trying to run the function: <strong>Data type mismatch in criteria expression.</strong></p>\n\n<p><code>table.string</code> is defined as <strong>short text</strong> and it's field size is 50. some might be NULL, <code>function</code> is my vba function that returns a <strong>string</strong>. \nthis is the function:</p>\n\n<pre><code>Public Function illegalCharEliminate(ByVal fieldName As String) As String\n    Dim field As String\n    field = fieldName\n    If (IsNull(field)) Then\n        GoTo catchNulls\n    End If\n    For i = 1 To 128        'goes through all illegal ascii and removes illegal chars\n        Select Case i\n            Case 1 To 44, 47, 58 To 59, 60 To 64, 91, 93, 123 To 125, 127\n                 field = Replace(field, Chr(i), Empty)\n           End Select\n    Next i\ncatchNulls:\n    illegalCharEliminate = field\nEnd Function\n</code></pre>\n\n<p>I tried Cast and Convert sql functions:</p>\n\n<pre><code>WHERE function(table.string)&lt;&gt;(Cast(table.string as string))\n</code></pre>\n\n<p>but get this error\" <strong>Syntax error (missing operator) in query expression function(table.string)...</strong> I saw some answers for this problem in vba, but I really do not want to use vba for this query. <strong>NOTICE:</strong> If there are no problems with my syntax, then the reason is probably because the table.string column has nulls. if so, how to fix this?</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448464069, "post_id": 33919822, "comment_id": 55600842, "body": "Get rid of <code>Cells(1,1).Select</code> (both occurences)."}, {"owner": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448464675, "post_id": 33919822, "comment_id": 55601272, "body": "the error is gone which is a plus, but it&#39;s not sorting"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "edited": false, "score": 0, "creation_date": 1448465429, "post_id": 33919941, "comment_id": 55601814, "body": "The spelling is correct, i took out the select parts of the code to simplify it. gets rid of the error, but it&#39;s still not sorting."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "edited": false, "score": 0, "creation_date": 1448465585, "post_id": 33919941, "comment_id": 55601912, "body": "@pts2800 are you sure it is sorting the correct worksheet? Because this works when I test it."}, {"owner": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448465865, "post_id": 33919941, "comment_id": 55602128, "body": "@DavidZemens interesting, just tried with the cat example, and it worked, must be something to do with the file names i&#39;m using... thanks for the help!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "edited": false, "score": 1, "creation_date": 1448466008, "post_id": 33919941, "comment_id": 55602254, "body": "@pts2800 it is probably a good idea that the example data you provide should be representative of the actual data you&#39;re working with..."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1448464126, "creation_date": 1448464126, "answer_id": 33919941, "question_id": 33919822, "link": "https://stackoverflow.com/questions/33919822/range-error-when-sorting/33919941#33919941", "title": "Range error when sorting", "body": "<p>Because this works:</p>\n\n<pre><code>Public Sub GatherInfo_Click()\n\n   '*gets info*\n\n   Cells(1, 1).Select\n   Cells(1, 1).Select\n   Sheets(\"Data\").Select\n\n   Dim oneRange As Range\n   Dim aCell As Range\n\n   Set oneRange = Range(\"A1:A100\")\n   Set aCell = Range(\"A1\")\n\n   oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\nEnd Sub\n</code></pre>\n\n<p>Check the spelling of <strong>Data</strong></p>\n"}], "owner": {"reputation": 43, "user_id": 2832295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a99409c0de8c4f2d77c21e2b507529?s=128&d=identicon&r=PG&f=1", "display_name": "pts2800", "link": "https://stackoverflow.com/users/2832295/pts2800"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 33919941, "answer_count": 1, "score": -1, "last_activity_date": 1448469877, "creation_date": 1448463788, "last_edit_date": 1448469877, "question_id": 33919822, "link": "https://stackoverflow.com/questions/33919822/range-error-when-sorting", "title": "Range error when sorting", "body": "<p>I have some code that reads all the files in a folder and displays them in a column in Excel.  After it gets the data, I want VBA to sort this data, but I keep getting a:  </p>\n\n<blockquote>\n  <p>Run-time error '1004': Select method of Range class failed.</p>\n</blockquote>\n\n<p>Note, I'm ONLY interested in sorting column A. Depending for the type of file I'm searching for, there could be 10 results, or there could be 100+ results.</p>\n\n<p>I have a button called \"gatherInfo\", once this button is clicked it <em>gathers info</em> (can't show you that part of the code due to confidentiality of folder names and file names). The gathering of information works just fine, but the sorting doesn't.</p>\n\n<pre><code>Private Sub GatherInfo_Click()\n\n   *gets info*\n\n   Cells(1, 1).Select\n   Cells(1, 1).Select\n   Sheets(\"Data\").Select\n\n   Dim oneRange As Range\n   Dim aCell As Range\n\n   Set oneRange = Range(\"A1:A100\")\n   Set aCell = Range(\"A1\")\n\n   oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\nEnd Sub\n</code></pre>\n\n<p>Example of files I'm trying to sort in order of name:</p>\n\n<pre><code> - cat01.exe\n - cat07.exe\n - cat02.exe\n - cat11.exe\n - cat03.exe\n</code></pre>\n\n<p>Would like it to look like:</p>\n\n<pre><code> - cat01.exe\n - cat02.exe\n - cat03.exe\n - cat07.exe\n - cat11.exe\n</code></pre>\n\n<p><strong>EDIT: changed code around a bit, got rid of the Select statements, error went away but it is still NOT sorting</strong></p>\n\n<pre><code>Private Sub GatherInfo_Click()\n\n   *gets info*\n\n   Dim oneRange As Range\n   Dim aCell As Range\n\n   Set oneRange = Range(\"A1:A100\")\n   Set aCell = Range(\"A1\")\n\n   oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT02: i believe my issue is the actual file names, closing out my question</strong></p>\n"}, {"tags": ["excel", "excel-2011", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 1501975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f83eb1215f736c41c62b9b57bc492a8?s=128&d=identicon&r=PG", "display_name": "ShorTControlleR", "link": "https://stackoverflow.com/users/1501975/shortcontroller"}, "edited": false, "score": 0, "creation_date": 1448532252, "post_id": 33920941, "comment_id": 55631160, "body": "Thanks but that is what I want to avoid - having to use the actual name of the sheet - I was hoping I could use the codename of the sheet in some way?"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 79, "user_id": 1501975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f83eb1215f736c41c62b9b57bc492a8?s=128&d=identicon&r=PG", "display_name": "ShorTControlleR", "link": "https://stackoverflow.com/users/1501975/shortcontroller"}, "edited": false, "score": 0, "creation_date": 1448546909, "post_id": 33920941, "comment_id": 55640421, "body": "@ShorTControlleR I have changed the code, let me know if it works"}, {"owner": {"reputation": 79, "user_id": 1501975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f83eb1215f736c41c62b9b57bc492a8?s=128&d=identicon&r=PG", "display_name": "ShorTControlleR", "link": "https://stackoverflow.com/users/1501975/shortcontroller"}, "edited": false, "score": 0, "creation_date": 1448559250, "post_id": 33920941, "comment_id": 55647718, "body": "perfect!  That&#39;s exactly what I was looking for.  Thanks for your assistance with this"}], "tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": true, "score": 1, "last_activity_date": 1448546885, "last_edit_date": 1448546885, "creation_date": 1448466911, "answer_id": 33920941, "question_id": 33919654, "link": "https://stackoverflow.com/questions/33919654/macro-to-copy-worksheet-irrespective-of-worksheet-name/33920941#33920941", "title": "Macro to copy worksheet irrespective of worksheet name?", "body": "<p>This part is causing the error</p>\n\n<pre><code>Sheets(Sheet1).Select\nSheets(Sheet1).Copy After:=Sheets(1)\n</code></pre>\n\n<p>The correct syntax is:</p>\n\n<pre><code>Activeworkbook.Worksheets(1).Activate\nActiveSheet.Copy After:=ActiveSheet\n</code></pre>\n\n<p>EDIT: Change the code so it does not use the name of the sheet </p>\n"}], "owner": {"reputation": 79, "user_id": 1501975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f83eb1215f736c41c62b9b57bc492a8?s=128&d=identicon&r=PG", "display_name": "ShorTControlleR", "link": "https://stackoverflow.com/users/1501975/shortcontroller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "accepted_answer_id": 33920941, "answer_count": 1, "score": 1, "last_activity_date": 1448546885, "creation_date": 1448463350, "last_edit_date": 1531161705, "question_id": 33919654, "link": "https://stackoverflow.com/questions/33919654/macro-to-copy-worksheet-irrespective-of-worksheet-name", "title": "Macro to copy worksheet irrespective of worksheet name?", "body": "<p>I export lots of information to a .csv file then download/open for manipulation.  Each export is sequentially numbered (eg export (22).csv, export (23).csv etc hence the worksheet is also given the same name/number.</p>\n\n<p>For each .csv file that I open, I would like a macro to do a quick filter, count and copy so that I can keep one complete worksheet before manipulation and work on a second worksheet.  In my macro, I have:</p>\n\n<pre><code>Sub Export()\n'\n' Export Macro\n'\n\n'\n    Range(\"A1\").Select\n    Selection.AutoFilter\n    Rows(\"2:2\").Select\n    ActiveWindow.FreezePanes = True\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"=SUBTOTAL(3,R[-4]C:R[-1]C)\"\n    Range(\"A7\").Select\n    Selection.End(xlUp).Select\n    Selection.End(xlUp).Select\n    Range(\"A2\").Select\n    Sheets(\"export (87).csv\").Select\n    Sheets(\"export (87).csv\").Copy After:=Sheets(1)\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>This all works correctly for export (87).csv but then fails for the next file, export (88).csv.</p>\n\n<p>How can I make the macro select the first sheet and copy to the end irrespective of the sheet name?</p>\n\n<p>I have tried using:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nSheets(\"Sheet1\").Copy After:=Sheets(1)\n\nSheets(\"Sheets1\").Select\nSheets(\"Sheets1\").Copy After:=Sheets(1)\n</code></pre>\n\n<p>I get a RT Error 9\nand</p>\n\n<pre><code>Sheets(Sheet1).Select\nSheets(Sheet1).Copy After:=Sheets(1)\n</code></pre>\n\n<p>I get a RT error 13</p>\n\n<p>Thanking all in advance...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1448463859, "post_id": 33919407, "comment_id": 55600705, "body": "Use this instead of the loop: <code>Target.Value = Right(&quot;00000000&quot; &amp; CStr(Target.Value), 8)</code> . That is, prepend 8 zeroes and keep the 8 rightmost characters. Just be sure that the value will never need more than 8 places!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5581245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yNGFs.jpg?s=128&g=1", "display_name": "Steve101", "link": "https://stackoverflow.com/users/5581245/steve101"}, "edited": false, "score": 0, "creation_date": 1448463543, "post_id": 33919652, "comment_id": 55600494, "body": "You my friend, are freaking awesome."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1448463347, "creation_date": 1448463347, "answer_id": 33919652, "question_id": 33919407, "link": "https://stackoverflow.com/questions/33919407/how-to-prefix-cell-with-0-dependant-on-character-length/33919652#33919652", "title": "How to prefix cell with 0, dependant on character length", "body": "<p>If you mean it should check column AF <strong>on the same row</strong> for a Q, try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rCell                 As Range\n\n    If Not Intersect(Target, Me.Columns(30)) Is Nothing Then\n        On Error Resume Next\n        Application.EnableEvents = False\n        For Each rCell In Intersect(Target, Me.Columns(30)).Cells\n            Select Case Len(rCell.Value)\n                Case 0, 8\n                    ' ignore if 8 characters or blank\n                Case Else\n                    If Strings.UCase$(Cells(rCell.Row, \"AF\").Value) &lt;&gt; \"Q\" Then\n                        rCell.NumberFormat = \"@\"\n                        rCell.Value = VBA.Right$(\"0000000\" &amp; rCell.Value, 8)\n                    End If\n            End Select\n        Next rCell\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5581245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yNGFs.jpg?s=128&g=1", "display_name": "Steve101", "link": "https://stackoverflow.com/users/5581245/steve101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 33919652, "answer_count": 1, "score": 0, "last_activity_date": 1477308130, "creation_date": 1448462624, "last_edit_date": 1477308130, "question_id": 33919407, "link": "https://stackoverflow.com/questions/33919407/how-to-prefix-cell-with-0-dependant-on-character-length", "title": "How to prefix cell with 0, dependant on character length", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)    \nIf Len(Target) = 8 Then  \nExit Sub  \nEnd If  \nIf Range(\"AF1:AF1000\").Value = \"Q\" Then  \nExit Sub  \nEnd If  \nOn Error Resume Next  \nApplication.EnableEvents = False  \nIf Target.Column = 30 Then  \nlTarget = Len(Target)  \nTarget.NumberFormat = \"@\"  \nFor i = 1 To 8 - lTarget  \nTarget.Value = \"0\" &amp; Target.Value  \nNext  \nEnd If  \nApplication.EnableEvents = True  \nEnd Sub  \n</code></pre>\n\n<p>I'm trying to get this to basically when putting the information into a certain cell, if you put any less that 8 digits in, it will prefix it with '0 until it is 8 which is does, but now i want to adapt it so that it doesn't do it if a certain cell has the text \"Q\" in it, its not working when i do this how ever, little help?</p>\n\n<p>EDIT: to make this easier the whole AF thing... its the entire AF column not just 1 to 1000 so how do i change that with what i have so far... probably need to re-write the whole thing..lol :(</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448463471, "post_id": 33919237, "comment_id": 55600429, "body": "<code>100000000000#</code> I&#39;m not overly familiar with RandBetween. What does the <code>#</code> sign do?"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1448463532, "post_id": 33919237, "comment_id": 55600483, "body": "if you eliminate <code>sheets(&quot;programs&quot;).cells(Srow,19)</code> and set it to 20... does it work?  if So the problem is likely in the <code>srow</code> value or the existence of <code>&quot;programs&quot;</code> worksheet. or in the value of (srow,19)"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1448463621, "post_id": 33919237, "comment_id": 55600542, "body": "@xQbert I was thinking along the same lines. Are you sure that <code>Sheets(&quot;Programs&quot;).Cells(Srow, 19) * 100000000000#</code> is greater than 10?"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 1, "creation_date": 1448464026, "post_id": 33919237, "comment_id": 55600812, "body": "That specific error message occurs when the value for sheets(&quot;Programs&quot;)cells.(srow,19) contains no value.  So within your loop you&#39;re encountering a non numeric value.  If I had to guess the .exnd(xlup) is hitting some blank lines.  If you delete the rows with spaces after the last row with data it may start to work again.  Step though and look at the value for LROW to determine if it exceeds the last row with data."}], "owner": {"reputation": 1, "user_id": 5604607, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153101533046836/picture?type=large", "display_name": "Denis Pohlman", "link": "https://stackoverflow.com/users/5604607/denis-pohlman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448463406, "creation_date": 1448462158, "last_edit_date": 1531164843, "question_id": 33919237, "link": "https://stackoverflow.com/questions/33919237/excel-error-1004-unable-to-get-randbetween-property-of-worksheetfunction-class", "title": "Excel error 1004 \u201cUnable to get RandBetween property of WorksheetFunction class\u201d", "body": "<p>The following code worked perfectly fine as written last week. I have been working in Excel 2013 and 2010 recently so this may have caused the issue.</p>\n\n<p>I run the code today and it properly executes the code. Meaning the values in the specified sheets and columns change each time I run the macro. However I get the error in the title of this post when I do run it. </p>\n\n<p>I have read other posts that say to add Application in front of WorksheetFunction and this does not work either. I get the same message.</p>\n\n<pre><code>Sub rndScore()\nDim Lrow As Integer \nDim Srow As Integer \nLrow = Sheets(\"Programs\").Cells(Rows.count, 19).End(xlUp).Row \n\nFor Srow = 9 To Lrow \n    Sheets(\"Programs\").Cells(Srow, 26).Value = WorksheetFunction.RandBetween(10, Sheets(\"Programs\").Cells(Srow, 19) * 100000000000#) / 1000000000 \nNext Srow \nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "button"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448462670, "post_id": 33919163, "comment_id": 55599798, "body": "If you change to this: <code>Sheets(&quot;Report&quot;).Range(&quot;Report[#Tout]&quot;).RemoveDuplicates Columns:=2, Header:=xlYes</code>  does the error still happen?"}, {"owner": {"reputation": 1491, "user_id": 4489629, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1991aac79be2d880aee94a7f904dff54?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/4489629/r%c3%a9mi"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448462728, "post_id": 33919163, "comment_id": 55599842, "body": "I did this and yea i still have the error"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448462780, "post_id": 33919163, "comment_id": 55599887, "body": "Is the worksheet protected?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448463006, "post_id": 33919163, "comment_id": 55600080, "body": "Or, on which worksheet exists the <code>Range(&quot;Report[#Tout]&quot;)</code> ?  (I assume it was on Sheets(&quot;Report&quot;)"}, {"owner": {"reputation": 1491, "user_id": 4489629, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1991aac79be2d880aee94a7f904dff54?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/4489629/r%c3%a9mi"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448464338, "post_id": 33919163, "comment_id": 55601037, "body": "yea it is, its a table on the sheet called Report, what is strange is that when i run the code from the editor it work but when i run it with the button it bugs."}, {"owner": {"reputation": 1491, "user_id": 4489629, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1991aac79be2d880aee94a7f904dff54?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/4489629/r%c3%a9mi"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448541341, "post_id": 33919163, "comment_id": 55636828, "body": "Any help ? i still have the issue... i tried the following:   Sheets(&quot;Report&quot;).Select     ActiveSheet.Range(&quot;Report[#Tout]&quot;).RemoveDuplicates Columns:=2, Header:=xlYes     Range(&quot;A7&quot;).Select"}], "owner": {"reputation": 1491, "user_id": 4489629, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1991aac79be2d880aee94a7f904dff54?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/4489629/r%c3%a9mi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448462223, "creation_date": 1448461969, "last_edit_date": 1448462186, "question_id": 33919163, "link": "https://stackoverflow.com/questions/33919163/execution-macor-excel-1004-vba", "title": "Execution macor excel (1004) vba", "body": "<p>When I try to run the following macro through a button that I drew on my workbook I get the an error (1004). The macro looks like this:</p>\n\n<pre><code>Sub copy_data()\n' Copy incident_id and ticket_id from raw_incidents\n    Sheets(\"Raw_Incidents\").Select\n    Range(\"Raw_incident[[id]:[ticket_id]]\").Select\n    Selection.Copy\n    Sheets(\"Report\").Select\n    Range(\"Report[[incident_id]:[ticket_id]]\").Select\n    ActiveSheet.Paste\n\n' Copy ticket_id from raw_old_ticket_support\n    Sheets(\"Raw_Old_Support_Tickets\").Select\n    Range(\"A5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Report\").Select\n\n' Function found on this page:    http://stackoverflow.com/questions/14957994/select-first-empty-cell-in-column-f-starting-from-row-1-without-using-offset\n    Range(\"A8:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Select\n    Range(Selection.Cells(1, 2), Selection.Cells(1, 2).End(xlDown)).Select\n    ActiveSheet.Paste\n\n    ActiveSheet.Range(\"Report[#Tout]\").RemoveDuplicates Columns:=2, Header:=xlYes\nEnd Sub\n</code></pre>\n\n<p>The error is on the last line: </p>\n\n<pre><code>ActiveSheet.Range(\"Report[#Tout]\").RemoveDuplicates Columns:=2, Header:=xlYes\n</code></pre>\n\n<p>However when I run the macro from the editor, so by pressing the run button, it works fine.  </p>\n\n<p>What could be the issue?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 3, "last_activity_date": 1448460945, "creation_date": 1448460945, "answer_id": 33918801, "question_id": 33918599, "link": "https://stackoverflow.com/questions/33918599/inserting-2-images-in-a-single-cell/33918801#33918801", "title": "Inserting 2 Images in a Single Cell", "body": "<p>There is no command like <code>.Bottom</code>, but an alternate approach for you could be simply adding the height of the first image to the top of the cell to decide where it ends. I.e.:</p>\n\n<pre><code>image2.Top = ActiveSheet.Range(\"B2\").Top + image1.Height\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5604406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcb136a3cef2ba17adbbbb8f23825d11?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay", "link": "https://stackoverflow.com/users/5604406/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 33918801, "answer_count": 1, "score": 0, "last_activity_date": 1448461804, "creation_date": 1448460412, "last_edit_date": 1531164843, "question_id": 33918599, "link": "https://stackoverflow.com/questions/33918599/inserting-2-images-in-a-single-cell", "title": "Inserting 2 Images in a Single Cell", "body": "<p>I am new to VBA and request your assistance for the below query.</p>\n\n<p><strong>QUERY:</strong></p>\n\n<p>I want to insert two images, one below the other, in a Cell say B2 with already pre-configured enough Cell height and width.\nI am using the below code</p>\n\n<pre><code> .Left = ActiveSheet.Range(\"B2\").Left\n .Top = ActiveSheet.Range(\"B2\").Top\n</code></pre>\n\n<p>where in my 1st image is placed at the Top,Left of the Cell.Now how do i place the 2nd image in the same cell below the 1st image.</p>\n\n<p>Is there any command like <code>.Bottom</code>?</p>\n"}, {"tags": ["vba", "excel", "formatting", "excel-2010"], "comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1448461339, "post_id": 33918565, "comment_id": 55598849, "body": "The VALUE() function would work in a formula picking up the text in an adjacent column - and it&#39;s resilient if you have a mixture of numeric and non-numeric data. . Failing that, grab the column in a VBA array, loop through the array applying Clng() or Cdb() to each member, and write the array back into the range."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1448461645, "post_id": 33918565, "comment_id": 55599081, "body": "Yeah, I&#39;m a little confused. You say &quot;Besides showing the right type...&quot; So the cell&#39;s content <code>IsNumeric</code>? If so, then your cell is a number and it is the formula &quot;showing the count in the bottom of the Excel&quot; that is the problem. But @Nile is correct. <code>.Value</code> should treat any text that is numeric as a number."}, {"owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1448465168, "post_id": 33918565, "comment_id": 55601620, "body": "@pnuts Your method worked great. Can you explain me why? I would appreciate a detailed answer!"}], "answers": [{"comments": [{"owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "edited": false, "score": 0, "creation_date": 1448465205, "post_id": 33919108, "comment_id": 55601651, "body": "Thx for your answer! However, my problem is that it can take ages to run through this code."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1448558833, "post_id": 33919108, "comment_id": 55647535, "body": "That&#39;s not a great answer: every &#39;hit&#39; to the sheet, reading a cell, writing to a cell takes about a hundredth of a second. You know that you can read a range in a single &#39;hit&#39; using <code>varArray = myRange.Value</code>, iterate through every item in the VBA array, and write it all back in a single &#39;hit&#39;  to the sheet as: <code>myRange.Value = varArray</code>? Iterating every array item from an entire column is  slow, by VBA standards - so define your range properly -  but that&#39;s still  <b>way</b> faster than interacting with every cell directly, so it&#39;ll still run in under a second."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1448461811, "creation_date": 1448461811, "answer_id": 33919108, "question_id": 33918565, "link": "https://stackoverflow.com/questions/33918565/convert-an-imported-column-from-a-text-field-to-a-number/33919108#33919108", "title": "Convert an imported column from a text field to a number", "body": "<p>Consider:</p>\n\n<pre><code>Sub qwerty()\n   Dim r As Range, rng As Range\n   Set rng = Intersect(Range(\"S:T\"), ActiveSheet.UsedRange)\n   rng.ClearFormats\n\n   For Each r In rng\n      r.Value = r.Value\n   Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 2, "last_activity_date": 1448465973, "creation_date": 1448465973, "answer_id": 33920614, "question_id": 33918565, "link": "https://stackoverflow.com/questions/33918565/convert-an-imported-column-from-a-text-field-to-a-number/33920614#33920614", "title": "Convert an imported column from a text field to a number", "body": "<p>You might run something like:  </p>\n\n<pre><code>Columns(\"A:A\").TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, Tab:=True, FieldInfo:=Array(1, 1)  \n</code></pre>\n\n<p>on each column (here A assumed).  </p>\n\n<p>Text to Columns is a Wizard that must be backed by proprietary code. One of its facilities is to permit the selection of the format for 'imported' data, which is then written into the existing column and parsed out to other columns (where (a) those are empty (unless that requirement is overridden) and (b) there is data to the right of the chosen delimiter or beyond the given fixed width).</p>\n\n<p>The 'imported' data is what is actually already in the selected column. Since in this case that does not include any tabs, selecting Tab as the delimiter means that no parsing is involved - the data is read from the column and re-entered back into it. However as part of the re-entry process the format may be changed. In this case the second <code>1</code> parameter in the <code>array</code> defines numeric. </p>\n\n<p>Proprietary code is usually much faster than VBA.  </p>\n"}], "owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 33920614, "answer_count": 2, "score": 0, "last_activity_date": 1448815079, "creation_date": 1448460322, "last_edit_date": 1448815079, "question_id": 33918565, "link": "https://stackoverflow.com/questions/33918565/convert-an-imported-column-from-a-text-field-to-a-number", "title": "Convert an imported column from a text field to a number", "body": "<p>I am looking for a way to convert a text to a number, which can then be used further in other formulas. My columns look simple:</p>\n\n<pre><code>Data1   Data2\n1       1\n123     1324\n1000    1000\n...     ...\n</code></pre>\n\n<p>I tried several ways:</p>\n\n<pre><code>Range(\"S:S\").NumberFormat = \"0\"\nRange(\"T:T\").NumberFormat = \"0\"\n</code></pre>\n\n<p>or copy an empty cell and add it to the range:</p>\n\n<pre><code>Sheets(\"Sold_Portfolio\").Range(\"ZZ100000\").Copy\nSheets(\"Sold_Portfolio\").Range(\"T3:T100000\").PasteSpecial , xlPasteSpecialOperationAd\n</code></pre>\n\n<p>However, besides seeing the right type there is only showing the count in the bottom of the Excel.</p>\n\n<p>Any suggestions how to properly convert an Excel column to a number, which can then be used by other formulas further?  </p>\n\n<p>What is my error?</p>\n\n<p><strong>UPDATE</strong> Here you can find the full VBA code:</p>\n\n<pre><code>Sub selectFile()\n\nDim wbI As Workbook, wbO As Workbook\nDim wsI As Worksheet\n\nSet wbI = ThisWorkbook\n'sheet where you want to import the sheet in\nSet wsI = wbI.Sheets(\"Sheet_Items\")\n\nChDir (Environ(\"USERPROFILE\") &amp; \"\\Desktop\")\n 'Select the file\nFname = Application.GetOpenFilename(filefilter:=\"Text Files (*.txt),*.txt\", MultiSelect:=False)\n\n' check if file is selected\nIf Fname = False Then\n'    MsgBox \"No File Was Selected\"\n    Exit Sub\nEnd If\n\n' delete the current content there\nSheets(\"Sheet_Items\").Range(\"G3:AB50000\").ClearContents\n\n'Set wbO = Workbooks.Open(Fname)\n'\n'wbO.Sheets(1).Cells.Copy wsI.Cells\n'\n'wbO.Close SaveChanges:=False\nDim var As String\n\nvar = \"TEXT;\" &amp; Fname\nWith ActiveSheet.QueryTables.Add(Connection:= _\n        var, Destination:=Range(\"$G$3\") _\n        )\n        .Name = \"Sample\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = True\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n\n\n\n'You need to properly qualify the range for the Replace() method\nColumns(\"S\").Replace What:=\".\", _\n                            Replacement:=\",\", _\n                            LookAt:=xlPart, _\n                            SearchOrder:=xlByRows, _\n                            MatchCase:=False, _\n                            SearchFormat:=False, _\n                            ReplaceFormat:=False\n\nColumns(\"T\").Replace What:=\".\", _\n                            Replacement:=\",\", _\n                            LookAt:=xlPart, _\n                            SearchOrder:=xlByRows, _\n                            MatchCase:=False, _\n                            SearchFormat:=False, _\n                            ReplaceFormat:=False\n\n'Range(\"S3:S100000\") = Range(\"S3:S100000\").Value\n'Range(\"T3:T100000\") = Range(\"T3:T100000\").Value\n'\n'convert to number\n'for further details on other available formats have a look at: http://stackoverflow.com/questions/20648149/what-are-numberformat-options-in-excel-vba\n'Range(\"S:S\").NumberFormat = \"0\"\n'Range(\"T:T\").NumberFormat = \"0\"\n\n''get an emtpy cell\n'Sheets(\"Sheet_Items\").Range(\"ZZ100000\").Copy\n'Sheets(\"Sheet_Items\").Range(\"S3:S100000\").PasteSpecial , xlPasteSpecialOperationAdd\n'\n'Sheets(\"Sheet_Items\").Range(\"ZZ100000\").Copy\n'Sheets(\"Sheet_Items\").Range(\"T3:T100000\").PasteSpecial , xlPasteSpecialOperationAdd\n\n'select the cell B1\nSheets(\"Sheet_Items\").Range(\"B1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "ms-access", "report", "attachment"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 3, "creation_date": 1448460242, "post_id": 33918482, "comment_id": 55598076, "body": "Export your report externally in a .PDF and then add as attachments referencing full file path."}, {"owner": {"reputation": 55, "user_id": 4637688, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d7f845f2eb63fb8d121961dda4b4643?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy", "link": "https://stackoverflow.com/users/4637688/stacy"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1448460764, "post_id": 33918482, "comment_id": 55598447, "body": "I don&#39;t think this will work for me.  There will be multiple users of this database and I cannot anticipate the full path on multiple work stations."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1448461413, "post_id": 33918482, "comment_id": 55598913, "body": "Use the database&#39;s current location: <code>Application.CurrentProject.Path &amp;&quot;\\&quot; &amp; &quot;filename.pdf&quot;</code> so PDF is saved wherever database is located."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "edited": false, "score": 0, "creation_date": 1448460704, "post_id": 33918657, "comment_id": 55598402, "body": "You cand see more in this web: <a href=\"https://msdn.microsoft.com/en-gb/library/office/ff197046.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-gb/library/office/ff197046.aspx</a>"}], "tags": [], "owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "is_accepted": false, "score": 3, "last_activity_date": 1448460562, "creation_date": 1448460562, "answer_id": 33918657, "question_id": 33918482, "link": "https://stackoverflow.com/questions/33918482/ms-access-send-email-with-report-as-attachment/33918657#33918657", "title": "Ms Access Send Email with Report as Attachment", "body": "<p>You can export your report as PDF by email with this:</p>\n\n<pre><code>DoCmd.SendObject(ObjectType, ObjectName, OutputFormat, To, Cc, Bcc,Subject, MessageText, EditMessage, TemplateFile)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 7, "last_activity_date": 1448472223, "creation_date": 1448472223, "answer_id": 33922764, "question_id": 33918482, "link": "https://stackoverflow.com/questions/33918482/ms-access-send-email-with-report-as-attachment/33922764#33922764", "title": "Ms Access Send Email with Report as Attachment", "body": "<p>As mentioned, export your report into an external file such as .pdf in order to attach to your outgoing email. Remember a report is an internal Access object and not readily in a file format for email. With <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192065.aspx\" rel=\"noreferrer\">DoCmd.OutputTo</a>, you can dynamically create the pdf on the fly date-stamped and in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff191878.aspx\" rel=\"noreferrer\">same location</a> as the database for a generalizeable solution for all your users.</p>\n\n<pre><code>Private Sub EmailReport_Click()\nDim oApp As New Outlook.Application\nDim oEmail As Outlook.MailItem\nDim fileName As string, todayDate As String    \n\n'Export report in same folder as db with date stamp\ntodayDate = Format(Date, \"MMDDYYYY\")\nfileName = Application.CurrentProject.Path &amp; \"\\ReportName_\" &amp; todayDate &amp; \".pdf\"\nDoCmd.OutputTo acReport, \"ReportName\", acFormatPDF, fileName, False\n\n'Email the results of the report generated\nSet oEmail = oApp.CreateItem(olMailItem)\nWith oEmail\n    .Recipients.Add \"myemailaddress@email.com\"\n    .Subject = \"Training Roster\"\n    .Body = \"Roster Information\"\n    .Attachments.Add fileName\n    .Send        \nEnd With\n\nMsgBox \"Email successfully sent!\", vbInformation, \"EMAIL STATUS\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3627268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634388056cf3c68619ba96da614becf1?s=128&d=identicon&r=PG&f=1", "display_name": "user3627268", "link": "https://stackoverflow.com/users/3627268/user3627268"}, "is_accepted": false, "score": 0, "last_activity_date": 1530778434, "last_edit_date": 1530778434, "creation_date": 1530778223, "answer_id": 51186298, "question_id": 33918482, "link": "https://stackoverflow.com/questions/33918482/ms-access-send-email-with-report-as-attachment/51186298#51186298", "title": "Ms Access Send Email with Report as Attachment", "body": "<p>With using <code>DoCmd.SendObject</code> you need to update Outlook Programmatic Access to turn off warnings about auto sending emails. In my case, administrator of domain enabled this options to change. More information <a href=\"https://support.office.com/en-us/article/i-get-warnings-about-a-program-accessing-email-address-information-or-sending-email-on-my-behalf-86cc5ece-379e-45e3-b8eb-3fefba09946b?NS=MSACCESS&amp;Version=16&amp;SysLcid=1033&amp;UiLcid=1033&amp;AppVer=ZAC160&amp;HelpId=olmain11.chm553714172&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 55, "user_id": 4637688, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d7f845f2eb63fb8d121961dda4b4643?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy", "link": "https://stackoverflow.com/users/4637688/stacy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48605, "favorite_count": 3, "accepted_answer_id": 33922764, "answer_count": 3, "score": 5, "last_activity_date": 1566576291, "creation_date": 1448460076, "question_id": 33918482, "link": "https://stackoverflow.com/questions/33918482/ms-access-send-email-with-report-as-attachment", "title": "Ms Access Send Email with Report as Attachment", "body": "<p>Using VBA code builder in MS Access, I have been able to write code that opens Outlook and send me an email with the click of a button.  I am having problems with adding an attachment. Most code I have found adds files outside the MS Database as an attachment, I would like to add a report created in my database as an attachment.  </p>\n\n<pre><code>Private Sub EmailReport_Click()\nDim oApp As New Outlook.Application\nDim oEmail As Outlook.MailItem\n\n'Email the results of the report generated\nSet oEmail = oApp.CreateItem(olMailItem)\noEmail.To = \"myemailaddress@email.com\"\noEmail.Subject = \"Training Roster\"\noEmail.Body = \"Roster Information\"\n\nWith oEmail\n    .Send\n    MsgBox \"Email Sent\"\nEnd With\n</code></pre>\n\n<p>I have been looking into a command similar to </p>\n\n<pre><code>oEmail.Attachments.Add Me.\n</code></pre>\n\n<p>..But, I cannot find the correct combination for adding my report.\nThanks!! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1448461427, "post_id": 33918436, "comment_id": 55598920, "body": "<code>wbReport </code> is not just simple variable but it is member of class <code>ThisWorkbook</code>. So it is needed to reference this variable with the name of the class like <code>ThisWorkbook.wbReport</code>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1448461832, "post_id": 33918436, "comment_id": 55599226, "body": "And becasue <code>wbReport</code> is workbook it is necessary to say on which sheet the range is located e.g. <code>ThisWorkbook.wbReport.ActiveSheet.Range(&quot;inspection_number&quot;)</code>&zwnj;&#8203;."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1448461865, "post_id": 33918436, "comment_id": 55599245, "body": "Also remember that a <code>Workbook</code> object doesn&#39;t have a <code>Range</code> property - that belongs to either a <code>Worksheet</code> or the <code>Application</code>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1448461949, "post_id": 33918436, "comment_id": 55599295, "body": "@GuyH don&#39;t forget to use <code>Option Explicit</code> it helps to catch a lot of errors."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1448462462, "post_id": 33918436, "comment_id": 55599646, "body": "<a href=\"http://stackoverflow.com/questions/33798766/variable-between-worksheet-and-module-not-cooperating/33799649#33799649\">Here</a> another question which is almost identical to yours. HTH"}, {"owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "edited": false, "score": 0, "creation_date": 1448463025, "post_id": 33918436, "comment_id": 55600095, "body": "OK, thanks dee, that seems to have fixed it. Would this have been avoided if the global variable were declared in an inserted module? I wanted it in ThisWorkbook because I want to assign it its value with the auto open macro."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1448463836, "post_id": 33918436, "comment_id": 55600694, "body": "When you do it like this then the variable <code>wbReport</code> actually duplicates the property <code>ThisWorkbook</code>. So you do not really need this varaible but can use <code>ThisWorkbook</code>. Or if you wish you can declare a public <code>global</code> variable in standard module. Then you can reference to this varaible just with its name."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "edited": false, "score": 0, "creation_date": 1448460520, "post_id": 33918517, "comment_id": 55598288, "body": "I have tried changing  &#39;Workbook_Open()&#39; to &#39;Public&#39; but I&#39;m still getting the same error. As you can see, in &#39;Workbook_Open&#39;, I have &#39;Set wbReport = ActiveWorkbook&#39;, so I&#39;d expect that to be enough to establish it as an object"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "reply_to_user": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "edited": false, "score": 0, "creation_date": 1448463397, "post_id": 33918517, "comment_id": 55600382, "body": "You have to call <code>Workbook_Open()</code>.   See edited answer."}], "tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": false, "score": 0, "last_activity_date": 1448464388, "last_edit_date": 1448464388, "creation_date": 1448460190, "answer_id": 33918517, "question_id": 33918436, "link": "https://stackoverflow.com/questions/33918436/why-isnt-my-global-variable-recognised-in-other-modules-in-excel-vba/33918517#33918517", "title": "Why isn&#39;t my global variable recognised in other modules in Excel VBA?", "body": "<p><code>wbReport</code> must be available as an object.  When you run <code>Worksheet_Change()</code>, have you beforehand run <code>Set wbReport = ActiveWorkbook</code>? The error message indicates not.  The Locals window is also useful to find out:  set a break point and see if <code>wbReport</code> is an object.  If not, find a way to make is so.  You may be able to use <code>Workbook_Open()</code> to do just that, but you will have to make it <code>public</code> instead of <code>private</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Call Workbook_Open()\n    '' the Call keyword is optional, I find it adds clarity.\n\n    Dim KeyCells As Range\n\n    Set KeyCells = wbReport.Range(\"inspection_number\")\n\n    etc. \n</code></pre>\n\n<p>Instead of calling that function, simper to just use its one line of code:</p>\n\n<pre><code>Set wbReport = ActiveWorkbook\n</code></pre>\n\n<p>I perceive you come from an object-oriented background, where the module would contain its methods and some would be called implicitly.  (I don't, so my descriptive verbiage is probably incorrect.)  This makes your approach a bit formalistic.  This will serve you well generally; in this case, perhaps an unnecessary layer.</p>\n"}], "owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1448464388, "creation_date": 1448459958, "question_id": 33918436, "link": "https://stackoverflow.com/questions/33918436/why-isnt-my-global-variable-recognised-in-other-modules-in-excel-vba", "title": "Why isn&#39;t my global variable recognised in other modules in Excel VBA?", "body": "<p>This is what I have in the \"ThisWorkbook\" module:</p>\n\n<pre><code>Option Explicit\n\nPublic wbReport As Workbook\n\nPrivate Sub Workbook_Open()\n    Set wbReport = ActiveWorkbook\nEnd Sub\n</code></pre>\n\n<p>I have the following macro in the module corresponding to a cetain worksheet, I want it to activate when the values of certain cells change:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    Set KeyCells = wbReport.Range(\"inspection_number\")\n\n    etc.    \n    .\n    .\n    .\nEnd Sub\n</code></pre>\n\n<p>However, when this macro is activated, I get an runtime error '424' as if the wbReport global variable had never been established.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1448459973, "post_id": 33918386, "comment_id": 55597885, "body": "What does your code do? What did you expect it to do? Is there an error?  Have you located the line of code where it first fails to do what you expect?"}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1448460151, "post_id": 33918386, "comment_id": 55598017, "body": "The code works perfectly. Its compute the difference between E2-A1 and E3-B1 (all in absolute value). Then what i do not succeed to do, is to display in a message box the company name for which the difference of the 2 calculation is the minimum. Currently the code display the name of the last company."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1448461075, "post_id": 33918386, "comment_id": 55598669, "body": "If you store your diffs in an array, use <code>Application.WOrksheetFunction.Min</code> to get the minimum difference."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1448461062, "creation_date": 1448461062, "answer_id": 33918857, "question_id": 33918386, "link": "https://stackoverflow.com/questions/33918386/display-minimum-value-in-a-loop-vba/33918857#33918857", "title": "Display minimum value in a loop vba", "body": "<p>You need to create a conditional statement to compare the <code>bestDiff3</code> against (essentially itself) for each loop and check for the smallest one. </p>\n\n<p>I have added that test statement in your code, and also fixed your declaration of resultCell as <code>Double</code>, which should be <code>String</code> if you expect to return <code>Company X</code>.</p>\n\n<pre><code>Sub CheckCell()\n\nDim resultCell As String 'fixed this to return string value of Company X\nDim CheckCell As Double\nDim checkCell2 As Double\nDim bestDiff As Double\nDim bestDiff2 As Double\nDim bestDiff3 As Double\nDim dLowValue As Double 'added as a variable to check for lowest value\n\nCheckCell = Range(\"E2\").Value\ncheckCell2 = Range(\"E3\").Value\nbestDiff = CheckCell\nbestDiff2 = checkCell2\ndLowValue = 1000 'set to arbitrary beginning number to test against\n\nFor i = 1 To Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    If (Range(\"A\" &amp; i).Value &lt;= CheckCell Or Range(\"A\" &amp; i).Value &gt;= CheckCell) And (Range(\"B\" &amp; i).Value &lt;= checkCell2 Or Range(\"B\" &amp; i).Value &gt;= checkCell2) Then\n\n            If (CheckCell - Range(\"A\" &amp; i).Value) &lt;= bestDiff Or (CheckCell - Range(\"A\" &amp; i).Value) &gt;= bestDiff And (checkCell2 - Range(\"B\" &amp; i).Value) &lt;= bestDiff2 Or (checkCell2 - Range(\"B\" &amp; i).Value) &gt;= bestDiff2 Then\n\n                    bestDiff3 = Application.WorksheetFunction.Min(Abs(CheckCell - Range(\"A\" &amp; i)) + Abs(checkCell2 - Range(\"B\" &amp; i)))\n\n\n                    If bestDiff3 &lt; dLowValue Then\n\n                        dLowValue = bestDiff3\n                        resultCell = Range(\"C\" &amp; i)\n\n                    End If\n\n            End If\n        End If\n    Next i\n\nMsgBox \"Best match is in \" &amp; resultCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "accepted_answer_id": 33918857, "answer_count": 1, "score": 1, "last_activity_date": 1448461062, "creation_date": 1448459854, "last_edit_date": 1531164843, "question_id": 33918386, "link": "https://stackoverflow.com/questions/33918386/display-minimum-value-in-a-loop-vba", "title": "Display minimum value in a loop vba", "body": "<p>I am having an issue to display the minimum value found in my loop. <strong>The goal is to find the the best match possible and display in a message box the company</strong>.</p>\n\n<p><strong>Issue:</strong> What I do not succeed to do, is to display in a message box the company name for which the difference of the 2 calculation is the minimum. Currently the code displays only the name of the last company.</p>\n\n<p>See picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jMNrU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jMNrU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>See the code:</p>\n\n<pre><code>Sub BestMatch()\n\n    Dim resultCell      As Double\n    Dim checkCell       As Double\n    Dim checkCell2       As Double\n    Dim bestDiff        As Double\n    Dim bestDiff2        As Double\n    Dim bestDiff3         As Double\n\n    checkCell = Range(\"E2\").Value\n    checkCell2 = Range(\"E3\").Value\n    bestDiff = checkCell\n    bestDiff2 = checkCell2\n\n    For i = 1 To Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n        If (Range(\"A\" &amp; i).Value &lt;= checkCell Or Range(\"A\" &amp; i).Value &gt;= checkCell) And (Range(\"B\" &amp; i).Value &lt;= checkCell2 Or Range(\"B\" &amp; i).Value &gt;= checkCell2) Then\n\n                If (checkCell - Range(\"A\" &amp; i).Value) &lt;= bestDiff Or (checkCell - Range(\"A\" &amp; i).Value) &gt;= bestDiff And (checkCell2 - Range(\"B\" &amp; i).Value) &lt;= bestDiff2 Or (checkCell2 - Range(\"B\" &amp; i).Value) &gt;= bestDiff2 Then\n\n                        bestDiff3 = Application.WorksheetFunction.Min(Abs(checkCell - Range(\"A\" &amp; i)) + Abs(checkCell2 - Range(\"B\" &amp; i)))\n\n                        resultCell = Range(\"C\" &amp; i)\n\n                End If\n            End If\n        Next i\n\n    MsgBox \"Best match is in \" &amp; resultCell\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1448459310, "post_id": 33918108, "comment_id": 55597398, "body": "Simple google search <code>Pivot Tables excel vba</code> will give you plenty of results. This <a href=\"http://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow noreferrer\">link</a> will give you kick start."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1448459368, "post_id": 33918108, "comment_id": 55597432, "body": "It&#39;s refreshing pivot table results."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1448459394, "post_id": 33918108, "comment_id": 55597457, "body": "&quot;Refresh&quot;es pivot tables, Pivottable1 and Pivottable2"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1448459406, "post_id": 33918108, "comment_id": 55597464, "body": "@ManishChristian How is it helpful to respond to a specific question with a generic link about random VBA pivot examples??"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448459571, "post_id": 33918108, "comment_id": 55597566, "body": "@Rory, the link will help him understand the basics of pivot table and hence these lines of code."}, {"owner": {"reputation": 13, "user_id": 5604432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc60000fbc05f4b63cebfe58c243b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan de la Puente", "link": "https://stackoverflow.com/users/5604432/ivan-de-la-puente"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1448459597, "post_id": 33918108, "comment_id": 55597597, "body": "@Macro Man @ Nathan_Sav Thanks a lot guys."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1448459840, "post_id": 33918108, "comment_id": 55597794, "body": "@ManishChristian On that basis I could answer half the questions here just with a link to the VBA language specification. ;)"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1448459974, "post_id": 33918108, "comment_id": 55597886, "body": "You could answer whatever you think is right. I did because I believe it&#39;s better to understand than just getting the answer."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 2, "creation_date": 1448461777, "post_id": 33918108, "comment_id": 55599186, "body": "&quot;Give a man a fish...&quot; ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1448578590, "post_id": 33918108, "comment_id": 55655044, "body": "I always prefer the saying &quot;Give a man a fire and he&#39;ll be warm for a day, set a man on fire and he&#39;ll be warm for life&quot; :-D"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5604432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc60000fbc05f4b63cebfe58c243b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan de la Puente", "link": "https://stackoverflow.com/users/5604432/ivan-de-la-puente"}, "edited": false, "score": 0, "creation_date": 1448553602, "post_id": 33918785, "comment_id": 55644616, "body": "Thank you and all the other helpful commenters. I am sorry if my question was too specific, I am not a VBA programmer."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 2, "last_activity_date": 1448460902, "creation_date": 1448460902, "answer_id": 33918785, "question_id": 33918108, "link": "https://stackoverflow.com/questions/33918108/can-somebody-explain-me-what-this-vba-code-means/33918785#33918785", "title": "Can somebody explain me what this VBA code means?", "body": "<p>I'll comment your code for you if this helps:</p>\n\n<pre><code>'Select the sheet named \"5. Resume\"\nSheets(\"5. Resume\").Select\n\n'Select the pivot table named \"PivotTable1\" on the active sheet (\"5. Resume\")\nActiveSheet.PivotTables(\"PivotTable1\").PivotSelect \"'Tarea IS'[All]\", _\n    xlLabelOnly, True\n\n'Refresh the data in \"PivotTable1\" on the selected sheet (\"5. Resume\") from the source\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n\n'Select the pivot table named \"PivotTable2\" on the active sheet (\"5. Resume\")\nActiveSheet.PivotTables(\"PivotTable2\").PivotSelect \"'Tarea IS'[All]\", _\n    xlLabelOnly, True\n\n'Refresh the data in \"PivotTable1\" on the selected sheet (\"5. Resume\") from the source\nActiveSheet.PivotTables(\"PivotTable2\").PivotCache.Refresh\n\n'Select the sheet named \"6. Reg Err\"\nSheets(\"6. Reg Err\").Select\n\n'Refresh the data in \"PivotTable3\" on the selected sheet (\"6. Reg Err\") from the source\nActiveSheet.PivotTables(\"PivotTable3\").PivotCache.Refresh \n</code></pre>\n\n<p>The lines where you select the pivottable seem to be irrelevant as you are changing the selection shortly after without doing anything to the currently selected item (I am guessing this is recorded). You can remove the lines with <code>.PivotSelect</code> and it will not change the outcome.</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotSelect \"'Tarea IS'[All]\", _\n        xlLabelOnly, True\n</code></pre>\n\n<p>In fact, the following code achieves the same in a much shorter fashion:</p>\n\n<pre><code>With Sheets(\"5. Resume\")\n    .PivotTables(\"PivotTable1\").PivotCache.Refresh\n    .PivotTables(\"PivotTable2\").PivotCache.Refresh\nEnd With\nSheets(\"6. Reg Err\").PivotTables(\"PivotTable3\").PivotCache.Refresh\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5604432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc60000fbc05f4b63cebfe58c243b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan de la Puente", "link": "https://stackoverflow.com/users/5604432/ivan-de-la-puente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "closed_date": 1448465459, "accepted_answer_id": 33918785, "answer_count": 1, "score": 0, "last_activity_date": 1448460902, "creation_date": 1448459144, "question_id": 33918108, "link": "https://stackoverflow.com/questions/33918108/can-somebody-explain-me-what-this-vba-code-means", "closed_reason": "Needs details or clarity", "title": "Can somebody explain me what this VBA code means?", "body": "<p>This is for an excel with macros. I am really lost here. I'd really appreciate any help.  </p>\n\n<pre><code>Sheets(\"5. Resume\").Select\n\nActiveSheet.PivotTables(\"PivotTable1\").PivotSelect \"'Tarea IS'[All]\", _\n    xlLabelOnly, True\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n\nActiveSheet.PivotTables(\"PivotTable2\").PivotSelect \"'Tarea IS'[All]\", _\n    xlLabelOnly, True\nActiveSheet.PivotTables(\"PivotTable2\").PivotCache.Refresh\n\nSheets(\"6. Reg Err\").Select\nActiveSheet.PivotTables(\"PivotTable3\").PivotCache.Refresh \n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1448459549, "post_id": 33918037, "comment_id": 55597550, "body": "check out this very handy <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">RangeToHTML</a> function. I use it whenever I want to paste Excel ranges into email bodies."}, {"owner": {"reputation": 4056, "user_id": 683518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e9578f1b05bc6ea629266b5ddb03871?s=128&d=identicon&r=PG", "display_name": "Vivek", "link": "https://stackoverflow.com/users/683518/vivek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448459766, "post_id": 33918037, "comment_id": 55597733, "body": "Thanks scott. I tried that, <code>RangeToHTML</code> is a common funtion i see in most of the answers in web. But it fails in my case, it doesnt copy charts."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448459886, "post_id": 33918037, "comment_id": 55597821, "body": "can you copy the chart as a picture and then paste that into the email body?"}, {"owner": {"reputation": 4056, "user_id": 683518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e9578f1b05bc6ea629266b5ddb03871?s=128&d=identicon&r=PG", "display_name": "Vivek", "link": "https://stackoverflow.com/users/683518/vivek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448459978, "post_id": 33918037, "comment_id": 55597889, "body": "I reserved that for last option because saving picture degrades the quality of chart thereby spoiling the neatness of my email."}], "answers": [{"tags": [], "owner": {"reputation": 4056, "user_id": 683518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e9578f1b05bc6ea629266b5ddb03871?s=128&d=identicon&r=PG", "display_name": "Vivek", "link": "https://stackoverflow.com/users/683518/vivek"}, "is_accepted": false, "score": 1, "last_activity_date": 1448549790, "last_edit_date": 1592644375, "creation_date": 1448549464, "answer_id": 33941523, "question_id": 33918037, "link": "https://stackoverflow.com/questions/33918037/paste-contents-from-multiple-excel-sheets-into-outlook-body/33941523#33941523", "title": "Paste contents from multiple Excel sheets into Outlook body", "body": "<p>Here is the approach i got working finally</p>\n<blockquote>\n<p><strong>Approach:</strong></p>\n<p>Copy sheet1 content to a temp sheet<br />\nCopy sheet2 (charts) content to temp sheet as picture.</p>\n</blockquote>\n<ul>\n<li>Now, copying charts as picture was already known to me</li>\n<li>I kept ignoring this method earlier as i was not able to export\ncharts to a quality image without distorted  text and graph lines.</li>\n<li>In this approach I used <code>CopyPicture</code> function and this function is able to get the graph content as it is but in an image.</li>\n</ul>\n<p>Below is the final code i have</p>\n<pre><code>Sub copy_graph()\n\nDim rgExp As Range\nSet outlookapp = CreateObject(&quot;outlook.application&quot;)\nSet OutMail = outlookapp.createitem(olmailitem)\nOutMail.display\nSet worddoc = OutMail.getinspector.wordeditor\n\nThisWorkbook.Sheets.Add\nActiveSheet.Name = &quot;temp&quot;\nThisWorkbook.Worksheets(&quot;temp&quot;).Range(&quot;a:z&quot;).Delete\nThisWorkbook.Worksheets(&quot;temp&quot;).Columns(&quot;a:a&quot;).ColumnWidth = 25.57\nThisWorkbook.Worksheets(&quot;temp&quot;).Columns(&quot;b:b&quot;).ColumnWidth = 89.57\n\n'Copy contents from sheet1\nThisWorkbook.Worksheets(&quot;Mail&quot;).Range(&quot;a5:b18&quot;).Copy\nThisWorkbook.Worksheets(&quot;temp&quot;).Range(&quot;a1&quot;).Select\nThisWorkbook.Worksheets(&quot;temp&quot;).Paste\n\n'Copy contents from sheet2 as picture\nSet rgExp = ThisWorkbook.Worksheets(&quot;graph&quot;).Range(&quot;a1:x93&quot;)\nrgExp.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\nThisWorkbook.Worksheets(&quot;temp&quot;).Range(&quot;a19&quot;).Select\nThisWorkbook.Worksheets(&quot;temp&quot;).Paste\nThisWorkbook.Worksheets(&quot;temp&quot;).Range(&quot;a1:t105&quot;).Copy\nworddoc.Range.PasteExcelTable linkedtoexcel:=False, wordformatting:=False, RTF:=False\n\nApplication.DisplayAlerts = False\n\nThisWorkbook.Worksheets(&quot;temp&quot;).Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4056, "user_id": 683518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e9578f1b05bc6ea629266b5ddb03871?s=128&d=identicon&r=PG", "display_name": "Vivek", "link": "https://stackoverflow.com/users/683518/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1965, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448549790, "creation_date": 1448458936, "last_edit_date": 1531164843, "question_id": 33918037, "link": "https://stackoverflow.com/questions/33918037/paste-contents-from-multiple-excel-sheets-into-outlook-body", "title": "Paste contents from multiple Excel sheets into Outlook body", "body": "<p>I need to copy contents from two sheets into Outlook mail body.</p>\n\n<ul>\n<li>Sheet 1 contains only text with some merged cells. </li>\n<li>Sheet2 contains charts.</li>\n</ul>\n\n<p><strong>My failed approach:</strong></p>\n\n<ul>\n<li><p>Copy contents from sheet1 and sheet2 into a temp sheet and\nthen copy the complete content from temp sheet to mail body.</p></li>\n<li><p>This approach messes the complete alignment once\nthe content is pasted into Outlook mail body, even though it looks good in the temp sheet.</p></li>\n</ul>\n\n<p>Below is the code snippet I use.</p>\n\n<pre><code>Sub copy_graph()\nDim outlookapp, outmail, worddoc As Object\n\nSet outlookapp = CreateObject(\"outlook.application\")\nSet outmail = outlookapp.createitem(olmailitem)\n\noutmail.display\nSet worddoc = outmail.getinspector.wordeditor\n\nThisWorkbook.Sheets.Add.Name = \"temp_mail\"\nThisWorkbook.Worksheets(\"Tu_Mail\").Range(\"a4:b18\").Copy\nThisWorkbook.Worksheets(\"temp_mail\").Range(\"a1\").Select\nActiveSheet.Paste\n\nThisWorkbook.Worksheets(\"trend\").Range(\"a1:x93\").Copy\nThisWorkbook.Worksheets(\"temp_mail\").Range(\"a19\").Select\nActiveSheet.Paste\n\nThisWorkbook.Worksheets(\"temp_mail\").Range(\"a1:x93\").Copy\nworddoc.Range.PasteExcelTable linkedtoexcel:=False, wordformatting:=False, RTF:=False\nApplication.DisplayAlerts = False\nThisWorkbook.Worksheets(\"temp_mail\").Delete\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to paste content from two sheets one by one into the mail body instead of combining them into one sheet. i.e paste as two different tables so that the column alignment is intact.</p>\n\n<p>Or </p>\n\n<p>Is there any other better approach for this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "edited": false, "score": 0, "creation_date": 1448458663, "post_id": 33917853, "comment_id": 55596908, "body": "Can you show the Filename with a MsgBox? Like: MsgBox (Path &amp; Date &amp; &quot;-&quot; &amp; Client &amp; &quot;.xls&quot;)"}, {"owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "edited": false, "score": 1, "creation_date": 1448458801, "post_id": 33917853, "comment_id": 55597006, "body": "You don&#39;t happen to have mixed dat (from dat = Range(&quot;F42&quot;)) and Date (from Filename:=Path &amp; Date &amp; ...)?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "edited": false, "score": 0, "creation_date": 1448458845, "post_id": 33917853, "comment_id": 55597036, "body": "Elzell yes I can (the message box).  That was a typo on my part, but it&#39;s still not executing."}, {"owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "edited": false, "score": 1, "creation_date": 1448459020, "post_id": 33917853, "comment_id": 55597181, "body": "Works fine for me ... do you have proper writing permissions in the folder where you want to save? What does the MsgBox show exactly?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1448459106, "post_id": 33917853, "comment_id": 55597235, "body": "Worked for me as well. Make sure you have proper permission for the folder <code>&quot;C:\\Back\\Test\\&quot;</code>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1448459126, "post_id": 33917853, "comment_id": 55597246, "body": "Will date evaluate to 3 folders dd mm yyyy in a path?  Try format(date,&quot;ddmmyyyy&quot;)"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1448459186, "post_id": 33917853, "comment_id": 55597289, "body": "The MsgBox shows C:\\Back\\Test\\11/24/2015-ClientTest.xls"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1448459282, "post_id": 33917853, "comment_id": 55597377, "body": "Nathan the problem is the date.  I just changed it and it executed properly.  Much appreciated!.  Thank you I appreciate it.  And thanks elzell for your effort!"}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": true, "score": 0, "last_activity_date": 1448459330, "creation_date": 1448459330, "answer_id": 33918183, "question_id": 33917853, "link": "https://stackoverflow.com/questions/33917853/trouble-saving-newly-created-vba-workbook/33918183#33918183", "title": "Trouble Saving Newly Created VBA Workbook", "body": "<p>I will propose my access to your need.</p>\n\n<p>Here is sub which should do what you need. So first i recomend to Dim all of your variables and do not use activate. Instead use sheet variable and also acces single values via cells not via range. </p>\n\n<p>But your main issue maybe is that you try to use reserved word <code>Date</code>. Let me know if something isnt clear to you.</p>\n\n<pre><code>Sub save()\n\nDim filePath As String\nDim dateFromSheet As String\nDim clientName As String\nDim controlPanelSheet As Worksheet\nDim newWorkbookName As String\n\nSet controlPanelSheet = Sheets(\"Control Panel\")\n\nfilePath = \"c:\\Users\\sukl\\Documents\\\"\n\nWith controlPanelSheet\n    dateFromSheet = .Cells(42, \"F\").Value\n    clientName = .Cells(43, \"F\").Value\n\nEnd With\n\nThisWorkbook.SaveAs Filename:=filePath &amp; dateFromSheet &amp; \"-\" &amp; clientName &amp; \".xls\", FileFormat:=xlNormal\nnewWorkbookName = ThisWorkbook.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33918183, "answer_count": 1, "score": 0, "last_activity_date": 1448459330, "creation_date": 1448458436, "last_edit_date": 1448458772, "question_id": 33917853, "link": "https://stackoverflow.com/questions/33917853/trouble-saving-newly-created-vba-workbook", "title": "Trouble Saving Newly Created VBA Workbook", "body": "<p>I'm starting a new project and having trouble right at the start =[.  So often I need to pull out specific data from a very large excel sheet and create a new excel sheet for just that data.  At the moment I am currently trying to create a new workbook and save it to a file path.  I am getting the error on the <code>SaveAs</code> execution line.  Any idea why this might be happening?  The error is: </p>\n\n<blockquote>\n  <p>\"Method 'Save As' of object' _Workbook' failed.</p>\n</blockquote>\n\n<pre><code>Dim Path As String\nDim dat As String\nDim Client As String\n\nPath = \"C:\\Back\\Test\\\"\nThisWorkbook.Sheets(\"Control Panel\").Activate\ndat = Range(\"F42\")\nClient = Range(\"F43\")\n\nWorkbooks.Add\nActiveWorkbook.SaveAs Filename:=Path &amp; Date &amp; \"-\" &amp; Client &amp; \".xls\", FileFormat:=xlNormal\nnewWBName = ActiveWorkbook.Name\n</code></pre>\n"}, {"tags": ["vba", "excel", "error-handling", "int"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1448458611, "creation_date": 1448458611, "answer_id": 33917919, "question_id": 33917746, "link": "https://stackoverflow.com/questions/33917746/vba-error-handling-only-int/33917919#33917919", "title": "Vba Error Handling / only int", "body": "<p>See the <code>InputBox</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195768(v=office.11).aspx\" rel=\"nofollow\">MSDN Page</a>.</p>\n\n<p>Set the Type:=1</p>\n\n<p><code>inpt = Application.InputBox(Prompt:=\"Date (YYMM)\", Type:=1)</code></p>\n\n<p>This will force the user to enter a valid number before moving on.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5604370"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448458611, "creation_date": 1448458140, "last_edit_date": 1531164843, "question_id": 33917746, "link": "https://stackoverflow.com/questions/33917746/vba-error-handling-only-int", "title": "Vba Error Handling / only int", "body": "<p>I would like to in the <code>Inputbox</code> only numbers are allowed and if someone types a letter Error Handling installed entry. The variable <code>zahl</code> I use later.</p>\n\n<pre><code>Dim inpt As Integer\nDim zahl As String\ninpt = Application.InputBox(\"Date (YYMM)\")\nIf inpt = False Then Exit Sub\nMsgBox inpt\nzahl = CInt(inpt)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1448458767, "post_id": 33917694, "comment_id": 55596981, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/19200428/recordset-value-property\">Recordset .value property</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1448458800, "post_id": 33917694, "comment_id": 55597005, "body": "You have Text, Value and Value2, text is whats in the cell displayed (Formatted for ex), Value and Value2 are the underlying values, eg. difference between .135 and .134590953"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1448458862, "post_id": 33917694, "comment_id": 55597051, "body": "see this <a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a> or this <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/11/30/&hellip;</a>"}, {"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1448461328, "post_id": 33917694, "comment_id": 55598843, "body": "For example I&#39;m having one drop down list in cell C5 from &quot;Sheet1&quot;, (this can be used to select names of operators from the sheet). When the macro is started (after selceting a name) I&#39;d like to copy the name that was selected in the dropdownlist to, lets say, &quot;Sheet2&quot;. Currently it turns out to paste &quot;Oke&quot; in the cell  &quot;B12&quot; in &quot;Sheet2&quot; (but you now can click on cell B12 and select one of the names.  I&#39;d like the code to (when I&#39;ve for example selected my own name &quot;Cornelis) to paste Cornelis in B12, preferably without the option using B12 as dropdownlist as well Does this has the same cause?"}], "answers": [{"comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 1, "creation_date": 1448460690, "post_id": 33918051, "comment_id": 55598397, "body": "Good answer, but I would urge you to expand this a bit with a clear statement of the difference between value and formatting."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1448461200, "post_id": 33918051, "comment_id": 55598761, "body": "@Nile The OP is asking about the difference between <code>.Value</code> and <code>&lt;nothing&gt;</code>, not between <code>.Value</code> and <code>.Text</code>. This is a very different kind of difference, and the commenters (<a href=\"http://stackoverflow.com/questions/33917694/when-should-one-use-value#comment55597005_33917694\">1</a>, <a href=\"http://stackoverflow.com/questions/33917694/when-should-one-use-value#comment55597051_33917694\">2</a>) are adding to the confusion."}, {"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1448461806, "post_id": 33918051, "comment_id": 55599212, "body": "First of all I realy appreciate the anwser from John Coleman. (only need to re-read it a second time, due I&#39;m not a native English speaker.) But it allready clearify&#39;s a lot.  Difference between .text and .value2 indeed wern&#39;t part of my question. Allthough... It&#39;s kind of corrolated with my question... probably could learn some of it as well. I&#39;ll keep reading some more on stackoverflow!  Thanks to all of you so far!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1448462341, "post_id": 33918051, "comment_id": 55599566, "body": "@Nile Good idea. I tried to explain a bit more the difference between a range and simply its value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1448491332, "post_id": 33918051, "comment_id": 55616347, "body": "&quot;... Value is the default property of a Range object&quot; may be overstating things a scooch subject to the operation.  I never liked that definition since <code>Set rng = Range(&quot;A1&quot;)</code> obviously sets rng to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a>, not the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1448493249, "post_id": 33918051, "comment_id": 55617137, "body": "<a href=\"http://stackoverflow.com/questions/33927736/vba-sort-key-range-query\">This recent post</a> may be of interest as it demonstrates both ways that either the .Value or Range Object is interpreted on-the-fly depending upon  the ways it is requested. It fails when the Value is returned by the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a> but not when the Range Object is returned."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1448462298, "last_edit_date": 1448462298, "creation_date": 1448458979, "answer_id": 33918051, "question_id": 33917694, "link": "https://stackoverflow.com/questions/33917694/when-should-one-use-value/33918051#33918051", "title": "When should one use &quot;.Value&quot;", "body": "<p>In Excel VBA a <code>Range</code> object is a fairly rich thing which corresponds to either a cell or a range of cells. As such it has all sorts of properties (it is in a given row, accessible via the <code>.Row</code> property, it has interior color, possible borderlines, formulas, etc. -- all accessible via the right properties after the dot.) <code>Value</code> is one of these properties. It refers to the value in the cell -- typically a number or a text. It wouldn't be used when using <code>Copy</code> and <code>Paste</code> since those methods are used on whole <code>Range</code> object -- as can been seen by the fact that they are able to copy formatting and not just raw values.</p>\n\n<p>You can <em>assign</em> the value in one cell to another. Even though this looks like copy/pasting it really is quite different and is in some sense a low-tech solution when all you want to do is transfer the values. It can be done using either e.g. <code>Range(\"A1\").Value = Range(\"B1\").Value</code> or <code>Range(\"A1\") = Range(\"B1\")</code>. The reason the later works is that <code>Value</code> is the <em>default property</em> of a <code>Range</code> object -- hence <code>.Value</code> is implicit in any context in which you aren't treating the <code>Range</code> as an actual object. </p>\n\n<p>Personally, I always explicitly use <code>Value</code> when I want to either read or set the value in a cell (or range of cells) even though I <em>could</em> rely on the fact that <code>Value</code> is the default property. Most Excel VBA code makes heavy use of both Range objects and the values in the Range objects. For reasons of readability it is a good idea for your code to be explicit about when it is using the range vs. when it is using the value. If you follow the <code>excel-vba</code> tag on SO you will see that it is relatively rare for programmers to rely on Range's default property.</p>\n"}], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 1, "accepted_answer_id": 33918051, "answer_count": 1, "score": 2, "last_activity_date": 1448462298, "creation_date": 1448457991, "last_edit_date": 1448462216, "question_id": 33917694, "link": "https://stackoverflow.com/questions/33917694/when-should-one-use-value", "title": "When should one use &quot;.Value&quot;", "body": "<p>I'm a beginner with Visual Basic, and mainly use it to edit MS Excel files. \nWhen copying/pasting (Cell) content or other values, in some cases <code>.value</code> is added.</p>\n\n<p>When should this be added?</p>\n\n<p>When not?</p>\n\n<p>Is it necessary?</p>\n\n<p>Could it harm my code if I use it in places where it isn't needed?</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1448459741, "post_id": 33917521, "comment_id": 55597716, "body": "since you are just reading data from the file, can you set the Read Only argument to True <code>Workbooks.Open Filename:=Sheets(&quot;Control Sheet&quot;).Range(&quot;C6&quot;).value, ReadOnly:=True</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11598, "user_id": 993494, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/d293b7af53b7ceea66cf2947f373f75a?s=128&d=identicon&r=PG", "display_name": "Thorsten Niehues", "link": "https://stackoverflow.com/users/993494/thorsten-niehues"}, "is_accepted": false, "score": 0, "last_activity_date": 1448883269, "creation_date": 1448883269, "answer_id": 33997667, "question_id": 33917521, "link": "https://stackoverflow.com/questions/33917521/run-time-error-1004-this-file-is-already-open-in-protected-view/33997667#33997667", "title": "Run-time error &#39;1004&#39; This file is already open in Protected View", "body": "<p>For reading I recommend Scott Holtzman's solution:</p>\n\n<pre><code>Workbooks.Open Filename:=\"FileName\", ReadOnly:=True \n</code></pre>\n\n<p>For other cases you can remove the protected mode by:</p>\n\n<pre><code>Do While Application.ProtectedViewWindows.Count &gt; 0\n    Application.ProtectedViewWindows(1).Edit\nLoop\n</code></pre>\n"}], "owner": {"reputation": 11598, "user_id": 993494, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/d293b7af53b7ceea66cf2947f373f75a?s=128&d=identicon&r=PG", "display_name": "Thorsten Niehues", "link": "https://stackoverflow.com/users/993494/thorsten-niehues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 862, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448883269, "creation_date": 1448457451, "question_id": 33917521, "link": "https://stackoverflow.com/questions/33917521/run-time-error-1004-this-file-is-already-open-in-protected-view", "title": "Run-time error &#39;1004&#39; This file is already open in Protected View", "body": "<p>I have a Macro which reads data from another Excel file. If the file is already opened by the user Excel tries to reopen the file - this is fine so far.</p>\n\n<p>However if the file is opened in Protected View then the macro stops at this line:</p>\n\n<pre><code>Workbooks.Open Filename:=Sheets(\"Control Sheet\").Range(\"C6\").value\n</code></pre>\n\n<p>With the Error:</p>\n\n<pre><code>Run-time error '1004' This file is already open in Protected View\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 535, "user_id": 1639427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c60552143017b175abeb3bb3ab806a93?s=128&d=identicon&r=PG", "display_name": "Steve Dell", "link": "https://stackoverflow.com/users/1639427/steve-dell"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1448457593, "post_id": 33917327, "comment_id": 55596176, "body": "yes but this would be difficult considering that I might have a list of 20 names, and it would be very tedious to create a filter for every one"}, {"owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 0, "creation_date": 1448457855, "post_id": 33917327, "comment_id": 55596344, "body": "Where do you want to store your list ? inside the code or in a excel worksheet ?"}, {"owner": {"reputation": 535, "user_id": 1639427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c60552143017b175abeb3bb3ab806a93?s=128&d=identicon&r=PG", "display_name": "Steve Dell", "link": "https://stackoverflow.com/users/1639427/steve-dell"}, "edited": false, "score": 0, "creation_date": 1448458298, "post_id": 33917327, "comment_id": 55596651, "body": "inside the excel worksheet would be best"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 3725626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d015cceee5e74f8842bf6779fb203b8?s=128&d=identicon&r=PG&f=1", "display_name": "user3725626", "link": "https://stackoverflow.com/users/3725626/user3725626"}, "is_accepted": false, "score": 1, "last_activity_date": 1448459490, "creation_date": 1448459490, "answer_id": 33918249, "question_id": 33917327, "link": "https://stackoverflow.com/questions/33917327/highlighting-rows-where-a-cell-contains-a-name-from-a-list-of-names/33918249#33918249", "title": "Highlighting rows where a cell contains a name from a list of names", "body": "<p>I would write it as a macro. </p>\n\n<p>Begin with the first sheet. \nFind the last used column and the last used row on that sheet.\nUse these figures to iterate through each cell in each row.\nFor each cell you iterate through you need to go to the list and iterate through each item in the list. Compare the cell value and the list value, if they are the same then highlight the row and go the next row.</p>\n\n<p>I hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 2, "last_activity_date": 1448465336, "creation_date": 1448465336, "answer_id": 33920360, "question_id": 33917327, "link": "https://stackoverflow.com/questions/33917327/highlighting-rows-where-a-cell-contains-a-name-from-a-list-of-names/33920360#33920360", "title": "Highlighting rows where a cell contains a name from a list of names", "body": "<p>Place this code in a module</p>\n\n<pre><code>Option Explicit\nPublic Sub ApplyConditionalFormattingsFromAList()\n    '\n    ' this code create multiple conditional formattings on current selected cells\n    ' using a list of conditions along with its formattings defined in another worksheet.\n    ' to use, just select the range and then run this code\n    '\n\n    Dim iRng        As Range\n    Dim ApplyToRng  As Range\n    Dim wsCondition As Worksheet\n\n    ' determine the worksheet that define the conditions and formattings\n    ' to do this, create a blank worksheet and name it \"Names\",\n    ' then in the worksheet,\n    ' column A of the worksheet should contain the names to highlight, start at [A1]\n    ' column B of the worksheet should be filled with the highlight color to apply, working in pair with column A\n    Set wsCondition = Worksheets(\"Names\")\n\n    ' i make the Macro to apply to current selection.\n    ' i made it this way so that you can reuse this code on different sheets multiple times\n    ' anyway, you can change this to apply to a fixed range, which can then be turned into automatic running code.\n    ' e.g. Set ApplyToRng = Columns(\"B\")\n    Set ApplyToRng = Selection\n\n    ' clear the conditional formattings of current selection. otherwise the list of conditional formatting will keep growing.\n    ApplyToRng.FormatConditions.Delete\n\n    ' add the conditions\n    For Each iRng In wsCondition.Range([A1].Address, wsCondition.Cells(Rows.Count, 1).End(xlUp))\n        ApplyToRng.FormatConditions.Add Type:=xlTextString, String:=iRng.Value, TextOperator:=XlContainsOperator.xlContains\n        ApplyToRng.FormatConditions(ApplyToRng.FormatConditions.Count).SetFirstPriority\n        ApplyToRng.FormatConditions(1).Interior.Color = iRng.Offset(0, 1).Interior.Color\n        ApplyToRng.FormatConditions(1).StopIfTrue = False\n    Next iRng\nEnd Sub\n</code></pre>\n\n<p>The worksheet \"Names\" would look like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/vxCSN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vxCSN.png\" alt=\"Preview of the Names sheet\"></a></p>\n"}], "owner": {"reputation": 535, "user_id": 1639427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c60552143017b175abeb3bb3ab806a93?s=128&d=identicon&r=PG", "display_name": "Steve Dell", "link": "https://stackoverflow.com/users/1639427/steve-dell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 1, "accepted_answer_id": 33920360, "answer_count": 2, "score": 0, "last_activity_date": 1525721845, "creation_date": 1448456892, "last_edit_date": 1531161705, "question_id": 33917327, "link": "https://stackoverflow.com/questions/33917327/highlighting-rows-where-a-cell-contains-a-name-from-a-list-of-names", "title": "Highlighting rows where a cell contains a name from a list of names", "body": "<p>How would I go about highlighting rows which contain a cell that contains a name from a list of names which I can specify?</p>\n\n<p>I assume this is best done by a macro, but not sure where to start.</p>\n"}, {"tags": ["string", "excel", "excel-formula", "worksheet-function", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448457278, "post_id": 33916893, "comment_id": 55595969, "body": "I assume you mean the first number string matching that <i>nnn-nn-nn-nnn</i> format, rather than literally that text?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1448458959, "post_id": 33916893, "comment_id": 55597130, "body": "Perhaps a simpler method would be to paste your source data in using the wizard, and separating using &quot; as the delimiter?"}, {"owner": {"reputation": 1778, "user_id": 1298432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/14e5281840de7f7a2a297e9c8fa4e90e?s=128&d=identicon&r=PG", "display_name": "bskool", "link": "https://stackoverflow.com/users/1298432/bskool"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448459524, "post_id": 33916893, "comment_id": 55597534, "body": "@Rory The problem with this is that not all the  cells will follow that formatting. some will just be 10 numbers, some will have a - in different locations."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448459594, "post_id": 33916893, "comment_id": 55597591, "body": "So what&#39;s the common factor? The first item with numbers in it? The third item between colons? Something else?"}, {"owner": {"reputation": 1778, "user_id": 1298432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/14e5281840de7f7a2a297e9c8fa4e90e?s=128&d=identicon&r=PG", "display_name": "bskool", "link": "https://stackoverflow.com/users/1298432/bskool"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448461665, "post_id": 33916893, "comment_id": 55599098, "body": "@Rory It would be everything after at least <code>billing&quot;:{&quot;NIP (tylko firma)&quot;:&quot;</code> and before the next <code>&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1778, "user_id": 1298432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/14e5281840de7f7a2a297e9c8fa4e90e?s=128&d=identicon&r=PG", "display_name": "bskool", "link": "https://stackoverflow.com/users/1298432/bskool"}, "edited": false, "score": 1, "creation_date": 1448459895, "post_id": 33917627, "comment_id": 55597828, "body": "That&#39;s it! Below is my modified code  <code>=LEFT(MID(orders!AY1;FIND(&quot;&quot;&quot;:&quot;&quot;&quot;;orders!AY1)+3;LEN(orders!A&zwnj;&#8203;Y1));FIND(&quot;&quot;&quot;&quot;;MID(o&zwnj;&#8203;rders!AY1;FIND(&quot;&quot;&quot;:&quot;&zwnj;&#8203;&quot;&quot;;orders!AY1)+3;LEN&zwnj;&#8203;(orders!AY1)))-1)</code>  Thank you"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1448457770, "creation_date": 1448457770, "answer_id": 33917627, "question_id": 33916893, "link": "https://stackoverflow.com/questions/33916893/escape-multiple-double-quotes/33917627#33917627", "title": "Escape multiple double quotes", "body": "<p>Please try:  </p>\n\n<pre><code>=LEFT(MID(A1,FIND(\"\"\":\"\"\",A1)+3,LEN(A1)),FIND(\"\"\"\",MID(A1,FIND(\"\"\":\"\"\",A1)+3,LEN(A1)))-1)\n</code></pre>\n"}], "owner": {"reputation": 1778, "user_id": 1298432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/14e5281840de7f7a2a297e9c8fa4e90e?s=128&d=identicon&r=PG", "display_name": "bskool", "link": "https://stackoverflow.com/users/1298432/bskool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 33917627, "answer_count": 1, "score": 1, "last_activity_date": 1448460509, "creation_date": 1448455536, "last_edit_date": 1531161705, "question_id": 33916893, "link": "https://stackoverflow.com/questions/33916893/escape-multiple-double-quotes", "title": "Escape multiple double quotes", "body": "<p>I have a sheet with the following value:</p>\n\n<p><code>{\"billing\":{\"NIP (tylko firma)\":\"123-12-12-123\",\"Firma\":\"Google\"},\"shipping\":{\"NIP (tylko firma)\":\"123-12-12-123\",\"Nazwa firmy\":\"Google\"}}</code></p>\n\n<p>I want to extract the first <code>123-12-12-123</code> from a given cell and output it into another cell in a different sheet.</p>\n\n<p>I have attempted to use <code>FIND</code> but I am having trouble because of all the quotes.</p>\n"}, {"tags": ["excel", "vba", "commandbutton"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1448456557, "post_id": 33916723, "comment_id": 55595470, "body": "You need to trust VBA model in Options to do the add code way.  You can use Event Sinking to do this, then add the new control to a collection of similar controls.  You would use a class like so  --&gt;        Option Explicit  Private WithEvents listBox_Custom As MSForms.ListBox  Private Sub listBox_Custom_Change()  End Sub"}, {"owner": {"reputation": 83, "user_id": 2025478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a6a7fb9fa3189a9d5aa4c2cfcca3d08?s=128&d=identicon&r=PG", "display_name": "BBDev", "link": "https://stackoverflow.com/users/2025478/bbdev"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1448541073, "post_id": 33916723, "comment_id": 55636656, "body": "Thanks but can you provide a bit clearer explanation, like I said I&#39;m just learning VBA"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1448620222, "creation_date": 1448620222, "answer_id": 33955407, "question_id": 33916723, "link": "https://stackoverflow.com/questions/33916723/add-event-listeners-to-procedurally-generated-controls-without-using-a-user-form/33955407#33955407", "title": "Add event listeners to procedurally generated controls without using a user form", "body": "<p>Something like a class module, called clsCustomListBox containing the following code</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents custom As MSForms.ListBox\n\nPublic Function initialise(cbConvert As MSForms.ListBox) As Boolean\n    Set custom = cbConvert\nEnd Function\n\nPrivate Sub custom_Click()\n    MsgBox \"Clicked\"\nEnd Sub\n</code></pre>\n\n<p>and then a standard module to go through the sheet and get all the listboxes, or you could just add to the collection, when your code adds them.</p>\n\n<pre><code>Option Explicit\n\nPrivate cls_CustomListBox As clsCustomListbox\nPublic colCustomListboxCollection As Collection\n\nPublic Sub GetListBoxes()\n\nDim c As OLEObject\n\nSet colCustomListboxCollection = New Collection\n\nFor Each c In Worksheets(\"Sheet1\").OLEObjects\n\n    If TypeOf c.Object Is MSForms.ListBox Then\n        Set cls_CustomListBox = New clsCustomListbox\n        cls_CustomCombo.initialise c.Object\n        colCustomListboxCollection.Add c\n    End If\n\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>I havent fully tested as at work, but that's where id start.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 83, "user_id": 2025478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a6a7fb9fa3189a9d5aa4c2cfcca3d08?s=128&d=identicon&r=PG", "display_name": "BBDev", "link": "https://stackoverflow.com/users/2025478/bbdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 33955407, "answer_count": 1, "score": 0, "last_activity_date": 1448620222, "creation_date": 1448455023, "last_edit_date": 1495542617, "question_id": 33916723, "link": "https://stackoverflow.com/questions/33916723/add-event-listeners-to-procedurally-generated-controls-without-using-a-user-form", "title": "Add event listeners to procedurally generated controls without using a user form", "body": "<p>I have a spreadsheet and create ListBox controls in every cell of a column. I'm trying  to capture their selected contents  but the examples of capturing events on runtime generated controls all involve using a user form and I'm not using one. I'm new to VBA so how can I reproduce the code below from \n<a href=\"https://stackoverflow.com/questions/3014421/how-to-add-events-to-controls-created-at-runtime-in-excel-with-vba\">How to add events to Controls created at runtime in Excel with VBA</a></p>\n\n<pre><code>Option Explicit\n\n\nDim ButArray() As New Class2\n\nPrivate Sub UserForm_Initialize()\n    Dim ctlbut As MSForms.CommandButton\n\n    Dim butTop As Long, i As Long\n\n    '~~&gt; Decide on the .Top for the 1st TextBox\n    butTop = 30\n\n    For i = 1 To 10\n        Set ctlbut = Me.Controls.Add(\"Forms.CommandButton.1\", \"butTest\" &amp; i)\n\n        '~~&gt; Define the TextBox .Top and the .Left property here\n        ctlbut.Top = butTop: ctlbut.Left = 50\n        ctlbut.Caption = Cells(i, 7).Value\n        '~~&gt; Increment the .Top for the next TextBox\n        butTop = butTop + 20\n\n        ReDim Preserve ButArray(1 To i)\n        Set ButArray(i).butEvents = ctlbut\n    Next\nEnd Sub\n</code></pre>\n\n<p>My code for generating my controls is</p>\n\n<pre><code>Public Sub CreateListbox()\n Dim rCell As Range\n    Dim rRng As Range\n    Set rRng = ActiveSheet.Range(\"AA3:AA45\")\n    For Each rCell In rRng.Cells\n        Set oLISTBOX = ActiveSheet.OLEObjects.Add(classtype:=\"Forms.ListBox.1\")\nWith oLISTBOX\n        .Object.IntegralHeight = False\n        .Object.Font.Size = 11\n        .Top = rCell.Top\n        .Left = rCell.Left\n        .Width = rCell.Width\n        .Height = rCell.Height\n        .LinkedCell = rCell.Address\n        .ListFillRange = \"ValSocDeterm.\"\n        .Object.ColumnCount = 3\n        .MultiSelect = 1\n    End With\n\n    Next rCell\nEnd Sub\n</code></pre>\n\n<p>I basically want to take the example code for creating buttons on a form to creating ListBoxes on a Sheet. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448457863, "post_id": 33916320, "comment_id": 55596353, "body": "Is the Users table located in an Excel worksheet? Because if it is, you could loop through the range of users, add the names to a collection (To avoid duplicates), and then make a string of all the items in the collection, seperated by a &quot;;&quot;. In the end .To should refer to this newly created string."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448462259, "post_id": 33916320, "comment_id": 55599504, "body": "&quot;not allowing me to attach anything&quot; Do you need to add an attachment? If so you&#39;ll need to use <code>OutMail.Attachments.Add</code> See this: <a href=\"http://stackoverflow.com/questions/15675414/add-attachement-to-outlook-with-varying-file-names\" title=\"add attachement to outlook with varying file names\">stackoverflow.com/questions/15675414/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 5089318, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zVz3mhv2s6c/AAAAAAAAAAI/AAAAAAAAGdY/rWS7WNDLQl8/photo.jpg?sz=128", "display_name": "Bien Alejandro", "link": "https://stackoverflow.com/users/5089318/bien-alejandro"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448541071, "post_id": 33916320, "comment_id": 55636653, "body": "@Alex4336  Yes this is what I want to happen, but since I just started vba a day ago, I&#39;m still not sure on how to work on loops. Can you guide me as to what kind of loop and how to work with concatenating the &#39;;&#39; character in the said string result? Thanks."}, {"owner": {"reputation": 3, "user_id": 5089318, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zVz3mhv2s6c/AAAAAAAAAAI/AAAAAAAAGdY/rWS7WNDLQl8/photo.jpg?sz=128", "display_name": "Bien Alejandro", "link": "https://stackoverflow.com/users/5089318/bien-alejandro"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1448541172, "post_id": 33916320, "comment_id": 55636723, "body": "@Tim although this was not the intended result I was hoping for, this helped me out for another task that I&#39;m supposed to do after this, so thanks for the link bro!"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448541286, "post_id": 33916320, "comment_id": 55636802, "body": "I actually made a small example file, for exactly that, let me see if I saved it :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5089318, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zVz3mhv2s6c/AAAAAAAAAAI/AAAAAAAAGdY/rWS7WNDLQl8/photo.jpg?sz=128", "display_name": "Bien Alejandro", "link": "https://stackoverflow.com/users/5089318/bien-alejandro"}, "edited": false, "score": 0, "creation_date": 1448542252, "post_id": 33939135, "comment_id": 55637405, "body": "I&#39;m gonna try this as soon as I get back to work tomorrow. I&#39;ll update you on how it works. Thank you so much for the response!"}], "tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": true, "score": 0, "last_activity_date": 1448542025, "creation_date": 1448542025, "answer_id": 33939135, "question_id": 33916320, "link": "https://stackoverflow.com/questions/33916320/attach-recipients-using-range-from-sheet/33939135#33939135", "title": "Attach recipients using range from sheet", "body": "<p>The following code assumes that you have your users' names in your outlook contact list, and that they are located in the cells A2 and down, but that range can be altered.</p>\n\n<pre><code>Sub test()\nDim users As New Collection\nDim usrRng As Range\nDim recipients As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nSet usrRng = Range(\"A2\", Range(\"A2\").End(xlDown))\n\nApplication.ScreenUpdating = False\n\nOn Error Resume Next\nFor Each cell In usrRng\n    users.Add cell.Value, cell.Value\nNext cell\nOn Error GoTo 0\n\n\n\nFor Each usrName In users\n    recipients = recipients &amp; usrName &amp; \"; \"\nNext usrName\n\n\nWith OutMail\n    .To = recipients\n    .CC = \"\"\n    .BCC = \"\"\n    .Importance = 2\n    .Subject = \"[ACTION REQUIRED] \" &amp; Format(Date, \"YYYYMMDD\")\n    .HTMLBody = \"some_body\"\n    .Display\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>What this does, is that it takes each name in the range A2 and down, and adds it to a collection, skipping the duplicates.</p>\n\n<p>Then we make a string, which will be made out of each name we just added to the collection, seperating each name with a \";\".\nThen we pass that new string to the OutMail object as the receiver of the message.</p>\n\n<p>When the new mail is displayed, the names will not be recognized, but if press send, the mail should be sent to the correct people, assuming you don't have multiple contacts with the same name.</p>\n"}], "owner": {"reputation": 3, "user_id": 5089318, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zVz3mhv2s6c/AAAAAAAAAAI/AAAAAAAAGdY/rWS7WNDLQl8/photo.jpg?sz=128", "display_name": "Bien Alejandro", "link": "https://stackoverflow.com/users/5089318/bien-alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33939135, "answer_count": 1, "score": 0, "last_activity_date": 1448542025, "creation_date": 1448453790, "last_edit_date": 1448458180, "question_id": 33916320, "link": "https://stackoverflow.com/questions/33916320/attach-recipients-using-range-from-sheet", "title": "Attach recipients using range from sheet", "body": "<p>I have the following code which lets me prepare an email which is ready to be sent:</p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = ThisWorkbook.Sheets(\"Users\").Range(\"A1\").Value\n    .CC = \"\"\n    .BCC = \"\"\n    .Importance = 2\n    .Subject = \"[ACTION REQUIRED] Format(Date, \"YYYYMMDD\")\"\n    .HTMLBody = \"some_body\"\n    .Display\nEnd With\n</code></pre>\n\n<p>and here is the Users table:</p>\n\n<blockquote>\n  <p><strong>Users</strong> <br> Johnson, Jerry <br> Mullen, Carl <br> Mullen, Carl <br> Mullen, Carl <br> Terry, Mark <br> Carlos, Juan <br></p>\n</blockquote>\n\n<p>I need to create a macro which lets me prepare an email but my main problem is I don't know how to add recipients using data from Users table.\nMy current code is not allowing me to attach anything aside from string values (typed directly, or maybe I'm doing something wrong).\nI also need it to not attach names that are duplicated. </p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 1, "creation_date": 1448453673, "post_id": 33915958, "comment_id": 55593581, "body": "Gives me a type mismatch"}], "answers": [{"comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448455241, "post_id": 33916573, "comment_id": 55594539, "body": "Is it okay if you I take a look at your file?"}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 1, "creation_date": 1448455376, "post_id": 33916573, "comment_id": 55594634, "body": "Sorry, employee does not allow this."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448455412, "post_id": 33916573, "comment_id": 55594666, "body": "Can you add the name of the form before the listbox name?  something like Form1.Listbox1.RowSource"}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448456667, "post_id": 33916573, "comment_id": 55595540, "body": "I did try this but I still get the error. The First, which direct to the userform with the error has the command Me.hide, can this cause trouble?"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448456837, "post_id": 33916573, "comment_id": 55595679, "body": "Try commenting the Me.hide out."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448457114, "post_id": 33916573, "comment_id": 55595854, "body": "Can you try using list instead of rowsource. I can&#39;t really help you if I can&#39;t see the entirely of your code. Perhaps if you can reproduce the error in a new spreadsheet I would be able to help ya."}, {"owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "edited": false, "score": 0, "creation_date": 1448468074, "post_id": 33916573, "comment_id": 55603727, "body": "Sadly not, I think it has maybe something to do with the <code>RefEdit </code> controls inside vba. So I just use addItem method and hopefully it will fix the problem"}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 1, "last_activity_date": 1448455696, "last_edit_date": 1448455696, "creation_date": 1448454488, "answer_id": 33916573, "question_id": 33915958, "link": "https://stackoverflow.com/questions/33915958/vba-listbox-rowsource-crashed-after-a-while/33916573#33916573", "title": "VBA listbox.rowsource crashed after a while", "body": "<p>Try with the full path for <code>listbox</code> objects.</p>\n\n<pre><code> UserFormX.Listbox1.RowSource = \"SheetX!namedrange0\"\n UserFormX.ListBox2.RowSource = \"SheetX!namedrange1\"\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 3614882, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7c1eddd3ed3db6af5b2b0ea33ad9d75c?s=128&d=identicon&r=PG&f=1", "display_name": "user3614882", "link": "https://stackoverflow.com/users/3614882/user3614882"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448455696, "creation_date": 1448452745, "last_edit_date": 1531164843, "question_id": 33915958, "link": "https://stackoverflow.com/questions/33915958/vba-listbox-rowsource-crashed-after-a-while", "title": "VBA listbox.rowsource crashed after a while", "body": "<p>I Link a listbox to a named range in the same worbook. But sometimes after a while I get a unknown error.</p>\n\n<p>Extract of my code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Listbox1.RowSource = \"namedrange0\"\n    ListBox2.RowSource = \"namedrange1\"\nEnd Sub\n</code></pre>\n\n<p>I open this userform from a another userform and it works fine, but after a while I get <code>Runtime error 8004005 Cant set RowSource, unknown error</code></p>\n\n<p>Anyone got something similar?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1448452630, "creation_date": 1448452630, "answer_id": 33915927, "question_id": 33915737, "link": "https://stackoverflow.com/questions/33915737/how-to-bind-vba-macro-to-specific-cell/33915927#33915927", "title": "How to bind VBA macro to specific cell?", "body": "<p>Here's an example of how you could do this:</p>\n\n<ul>\n<li>Add a button (MSForm, not ActiveX) in the cell. Make sure the top left corner of the button is inside the cell for the row you want to refer to.</li>\n<li>Assign the macro (let's say \"MM\" here for simplicity)</li>\n</ul>\n\n<p>In the Macro:</p>\n\n<pre><code>Sub MM()\n    Dim rowNumber As Long\n    rowNumber = Shapes(Application.Caller).TopLeftCell.Row\n\n    Debug.Print Range(\"A\" &amp; rowNumber).Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3820047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bceefa48f7a3b9001ef6da9c56da9e?s=128&d=identicon&r=PG&f=1", "display_name": "user3820047", "link": "https://stackoverflow.com/users/3820047/user3820047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 33915927, "answer_count": 1, "score": 0, "last_activity_date": 1448453094, "creation_date": 1448452074, "last_edit_date": 1448453094, "question_id": 33915737, "link": "https://stackoverflow.com/questions/33915737/how-to-bind-vba-macro-to-specific-cell", "title": "How to bind VBA macro to specific cell?", "body": "<p>I'm working on an excel sheet where I have data organized in rows and need a way to run a VBA macro which will execute program based on data found in specific row. </p>\n\n<p>What I'm struggling to achieve is to find a mechanism for users to simply click something button-like positioned after data to complete this task. Also users should be able to copy an existing row (and macro trigger with it) and execute macro related to that new row without having to do any code modifications.</p>\n\n<p>What I have tried so far is excel button but it has no way of binding to certain cell. Also macro has to be assigned manually every time new row is added.\nI also tried 'Worksheet_SelectionChange' event with filtering to certain column containing link-like text. This works fine in a way, but some users use arrow keys to navigate within sheet which accidentally triggers macros if macro cell gets selected. Also, mouse cursor doesn't change to pointing finger during hover over.\nLast attempt was to try <code>=HYPERLINK(\"#'Sheet1'!E3\";\"Run macro\")</code>-function and using it with 'Worksheet_FollowHyperlink'. However, in this case event does not trigger if hyperlink points to current sheet. </p>\n\n<p>So any new ideas or maybe refining some of these to overcome problems I have described?\n<a href=\"https://i.stack.imgur.com/XwZaw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XwZaw.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1448521714, "post_id": 33919294, "comment_id": 55625180, "body": "Thank you very much! I love plain and simple solutions. <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow noreferrer\">Nice article about the topic</a>"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1448462286, "creation_date": 1448462286, "answer_id": 33919294, "question_id": 33915558, "link": "https://stackoverflow.com/questions/33915558/excel-vba-paste-entire-row-from-array-of-arrays-into-table/33919294#33919294", "title": "Excel VBA Paste entire row from array of arrays into table", "body": "<p>You can do this:</p>\n\n<pre><code>Range(objListRowBytoveDomyNovy.Range(1, 1), objListRowBytoveDomyNovy.Range(1, 20)).Value = Application.Index(varZaznamyNove(0), intPorovnavanyZaznamNovy, 0)\n</code></pre>\n"}], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 2, "accepted_answer_id": 33919294, "answer_count": 1, "score": 1, "last_activity_date": 1448462286, "creation_date": 1448451518, "last_edit_date": 1531164843, "question_id": 33915558, "link": "https://stackoverflow.com/questions/33915558/excel-vba-paste-entire-row-from-array-of-arrays-into-table", "title": "Excel VBA Paste entire row from array of arrays into table", "body": "<p>I have an array of arrays. Its dimensions can be summed like this:<br>\n<strong>varZaznamyNove(0)(1 to 2, 1 to 20)</strong> as shown in the picture.  </p>\n\n<p>I want to take an entire row and put the data from that row into an Excel table. For example:<br>\n<code>Range(objListRowBytoveDomyNovy.Range(1, 1), objListRowBytoveDomyNovy.Range(1, 20)) = varZaznamyNove(0)(intPorovnavanyZaznamNovy)</code></p>\n\n<p>When I attempt to run the line, I get an error:  </p>\n\n<blockquote>\n  <p>Run time error 9: Subscript out of range.  </p>\n</blockquote>\n\n<p><strong>How can I put entire row from a jagged array, without looping through all of its columns, into an excel table?</strong>   </p>\n\n<p>Variables used are dimensioned as follows:<br>\n<code>objListRowBytoveDomyNovy as lisrow</code><br>\n<code>intPorovnavanyZaznamNovy as integer</code><br>\n<code>varZaznamyNove(0) as variant</code>  </p>\n\n<p><strong>Note:</strong><br>\nI don't get an error, when I add second index to the right side of the line, e.g.:<br>\n<code>Range(objListRowBytoveDomyNovy.Range(1, 1), objListRowBytoveDomyNovy.Range(1, 20)) = varZaznamyNove(0)(intPorovnavanyZaznamNovy,1)</code><br>\nbut this only pust first column into all of the table columns. That is not desired.  </p>\n\n<p>Example of the data is shown in picture. Just to show what I work with (dummy data). </p>\n\n<p><a href=\"https://i.stack.imgur.com/7s0P8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7s0P8.png\" alt=\"Example of the data\"></a></p>\n"}, {"tags": ["excel", "vba", "file", "batch-file"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1448451695, "post_id": 33914952, "comment_id": 55592480, "body": "Unless access to the VBProject model is enabled, you can&#39;t do this with a script."}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "edited": false, "score": 0, "creation_date": 1448451204, "post_id": 33915190, "comment_id": 55592191, "body": "I didnt phraze it right, we have a excel file that is stored on a server storage, a few people acess and edit that file, at the end of the day and external firm acess that file and their program reads data from it, they dont have IT guy or are just plain mean :) .... so they dont want to change the path to the file. For our editors i have wrote a simple macro that sums up data from all sheets inside that workbook but right now they have to copy file to their HDD and then edit workbook and copy macro, its annojing and time consuming and a problem to some who arentt that savy..."}, {"owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "edited": false, "score": 0, "creation_date": 1448451215, "post_id": 33915190, "comment_id": 55592196, "body": "so i was thinking if there would be a possibility to make a batch file that would open that file, and create a macro and copy the macro code from a txt file that would be located on local PC into that macro."}, {"owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "reply_to_user": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "edited": false, "score": 0, "creation_date": 1448451494, "post_id": 33915190, "comment_id": 55592354, "body": "as I said: in theory it&#39;s possible via VBE. But I still wouldn&#39;t go that way. Better to have one file already with a macro in it and import the data into that template file ... so going the other way. Don&#39;t bring the macro to the data ... bring the data to the macro."}, {"owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "edited": false, "score": 0, "creation_date": 1448453326, "post_id": 33915190, "comment_id": 55593373, "body": "Thanks, that was my second guess ... but this way its even more hassle than copying the macro everytime. Thank you."}], "tags": [], "owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "is_accepted": true, "score": 0, "last_activity_date": 1448450447, "creation_date": 1448450447, "answer_id": 33915190, "question_id": 33914952, "link": "https://stackoverflow.com/questions/33914952/batch-file-for-inserting-macros/33915190#33915190", "title": "Batch file for inserting macro&#39;s", "body": "<p>In theory it's possible by using the VBE object (<a href=\"https://msdn.microsoft.com/en-us/library/aa443984%28v=vs.60%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa443984%28v=vs.60%29.aspx</a>). But that's not activated by default so you can not ensure that each user is able to do that.</p>\n\n<p>Better find other solutions for that problem. Can you upload .XLSB for example? Or do you have another kind of server available - for example a database server - you can use for storing the file? We use this method here for deploying our updates on AddIns and report templates for example.</p>\n"}], "owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 33915190, "answer_count": 1, "score": 0, "last_activity_date": 1448453130, "creation_date": 1448449714, "last_edit_date": 1448453130, "question_id": 33914952, "link": "https://stackoverflow.com/questions/33914952/batch-file-for-inserting-macros", "title": "Batch file for inserting macro&#39;s", "body": "<p>I am trying to create a batch file as icon on desktop, that would open a specific excel file, create a macro in it and copy code from a specific txt file into it. </p>\n\n<p>The reason i need this, is that the file is located on a server and the ending .xlm cannot be cahanged (should not) so i cannot save it as a macro enabled file (to store a macro in it ) </p>\n\n<p>Could annyone with better understanding please explain to me how to create the said code ? </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "export", "file-conversion", "export-to-pdf"], "answers": [{"tags": [], "owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1448450068, "creation_date": 1448450068, "answer_id": 33915069, "question_id": 33914937, "link": "https://stackoverflow.com/questions/33914937/i-am-trying-to-print-an-active-sheet-as-a-pdf-is-it-also-possible-to-print-page/33915069#33915069", "title": "I am trying to print an active sheet as a PDF, is it also possible to print page 1 and 2 separately? i have this so far", "body": "<p>Just use the <code>From</code> and <code>To</code> parameters of the <code>ExportAsFixedFormat</code> function:</p>\n\n<pre><code>ws.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=myFile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False, _\n    From:=1, _\n    To:=1\n</code></pre>\n\n<p>and the same again with page 2</p>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 33915069, "answer_count": 1, "score": 1, "last_activity_date": 1448450068, "creation_date": 1448449653, "question_id": 33914937, "link": "https://stackoverflow.com/questions/33914937/i-am-trying-to-print-an-active-sheet-as-a-pdf-is-it-also-possible-to-print-page", "title": "I am trying to print an active sheet as a PDF, is it also possible to print page 1 and 2 separately? i have this so far", "body": "<p>I am trying to print an active sheet as a PDF, is it also possible to print page 1 and 2 separately? i have this so far. i want the name of the export to use the values from cells B1 I1 and J1</p>\n\n<p>Sub PDFActiveSheet()</p>\n\n<pre><code>Dim ws As Worksheet\nDim strPath As String\nDim myFile As Variant\nDim strFile As String\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\n'enter name and select folder for file\n' start in current workbook folder\nstrFile = Replace(Replace(ws.Name, \" \", \"\"), \".\", \"_\") _\n        &amp; \"_\" _\n        &amp; Range(\"B1\"&amp;\"I1\"&amp;\"J1\") _\n        &amp; \".pdf\"\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\nmyFile = Application.GetSaveAsFilename _\n    (InitialFileName:=strFile, _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Folder and FileName to save\")\n\nIf myFile &lt;&gt; \"False\" Then\n    ws.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=myFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n\n    MsgBox \"PDF file has been created.\"\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "checkbox", "pdf-generation", "userform"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448459643, "post_id": 33914691, "comment_id": 55597639, "body": "Does it have to be CheckBoxes or would a ListBox of all your sheets, where the user can select multiple sheets, work aswell ?"}, {"owner": {"reputation": 3, "user_id": 5600304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb7348e02f05ecf79e2e69ae1570c74?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Jones", "link": "https://stackoverflow.com/users/5600304/ollie-jones"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448460140, "post_id": 33914691, "comment_id": 55598011, "body": "I am not familiar with the ListBox feature, but If it is capable of achieving the task I&#39;d definitely give it a go."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448460324, "post_id": 33914691, "comment_id": 55598131, "body": "I&#39;m using ListBoxes to display all my sheets, and then the user can select which sheets they would like to export as PDFs, either as a joined PDF file or all sheets in seperate files."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448463178, "post_id": 33914691, "comment_id": 55600207, "body": "Coming up in a second"}, {"owner": {"reputation": 3, "user_id": 5600304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb7348e02f05ecf79e2e69ae1570c74?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Jones", "link": "https://stackoverflow.com/users/5600304/ollie-jones"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448465455, "post_id": 33914691, "comment_id": 55601827, "body": "I&#39;ve managed to export individual sheets to pdf from my ListBox, when i set MultiSelect to 1 - fmMultiSelectMulti in the ListBox settings it doesnt seem to work.    Should i be using        Worksheets(Array(ListBox1.Value)).Select in the above code?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5600304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb7348e02f05ecf79e2e69ae1570c74?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Jones", "link": "https://stackoverflow.com/users/5600304/ollie-jones"}, "edited": false, "score": 0, "creation_date": 1448528875, "post_id": 33919614, "comment_id": 55628856, "body": "I did, It&#39;s perfect!  Thanks again."}], "tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": true, "score": 2, "last_activity_date": 1448463707, "last_edit_date": 1448463707, "creation_date": 1448463256, "answer_id": 33919614, "question_id": 33914691, "link": "https://stackoverflow.com/questions/33914691/check-boxes-in-user-form-to-select-sheets-to-print/33919614#33919614", "title": "Check boxes in user form to select sheets to print", "body": "<p>If you have a UserForm with a ListBox and a CommandButton, this should work, assuming you have sheets named as you specified.</p>\n\n<p>This code should of course be added to the UserForm code module.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim SheetArray() As Variant\nDim indx As Integer\n\nDim ws As Worksheet\nDim strPath As String\nDim myfile As Variant\nDim strFile As String\nDim sheetstoprint As String\n\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\nstrFile = \"E_CALC_\" &amp; Worksheets(\"Contents\").Range(\"H7\").Text &amp; \".pdf\"\n\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\nmyfile = Application.GetSaveAsFilename _\n    (InitialFileName:=strFile, _\n    FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n    Title:=\"Select Folder and FileName to save\")\n\nIf myfile &lt;&gt; \"False\" Then\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    indx = 0\n    For i = 0 To ListBox1.ListCount - 1\n            If ListBox1.Selected(i) = True Then\n                ReDim Preserve SheetArray(indx)\n                SheetArray(indx) = Sheets(ListBox1.List(i, 1)).Index\n                indx = indx + 1\n            End If\n    Next i\n\n    If indx &gt; 0 Then\n\n            Sheets(SheetArray()).Select\n                ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n                Filename:=myfile, _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=True\n\n\n                '.ExportAsFixedFormat Type:=xlTypePDF, Filename:=myfile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n\n    End If\nEnd If\nexitHandler:\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nExit Sub\n\nerrHandler:\nMsgBox \"Could not create PDF file\", vbRetryCancel, \"Oops!\"\n\nResume exitHandler\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nDim wks() As Variant\n\n\nwks = Array(\"Engine\", \"CHP Layout\", \"Ventilation\", \"Exhaust\", \"Gas\", \"Hazardous Zoning\", \"Gas Ramp up\", \"Steam Boilers\", _\n                        \"JW PU\", \"AC PU\", \"Combustion\", \"BREEAM NOx\", \"Pump P1\", \"Pump P2\", \"Pump P3\", \"Pump P4\", \"Pump P5\")\n\n'Debug.Print wks(16)\nFor i = 0 To UBound(wks)\n\n        ListBox1.AddItem wks(i)\n        ListBox1.List(ListBox1.ListCount - 1, 1) = wks(i)\n\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Remember to allow listbox multiselect in the listbox properties window.</p>\n\n<p>Edit:\nDuring my testing, it seems that the Excel application freezes after exporting the PDF. I don't know if it has anything to do with the OpenAfterPublish property being set to True as I've always set it to False.</p>\n\n<p>Edit2:</p>\n\n<p>My mistake, It's simply because the UserForm is still open ...</p>\n"}], "owner": {"reputation": 3, "user_id": 5600304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb7348e02f05ecf79e2e69ae1570c74?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie Jones", "link": "https://stackoverflow.com/users/5600304/ollie-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2614, "favorite_count": 0, "accepted_answer_id": 33919614, "answer_count": 1, "score": 0, "last_activity_date": 1448463707, "creation_date": 1448449033, "last_edit_date": 1448449587, "question_id": 33914691, "link": "https://stackoverflow.com/questions/33914691/check-boxes-in-user-form-to-select-sheets-to-print", "title": "Check boxes in user form to select sheets to print", "body": "<p>I have code that selects an array of sheets to be printed to a pdf document, however I am trying to implement a user form with a series of check boxes that correspond to a specific sheets.</p>\n\n<p>The following code selects a predetermined array of sheets and prints them as a pdf</p>\n\n<pre><code>Sub PDFAllSheets_Click()\n\nDim ws As Worksheet\nDim strPath As String\nDim myfile As Variant\nDim strFile As String\nDim sheetstoprint As String\n\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\nstrFile = \"E_CALC_\" &amp; Worksheets(\"Contents\").Range(\"H7\").Text &amp; \".pdf\"\n\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\nmyfile = Application.GetSaveAsFilename _\n    (InitialFileName:=strFile, _\n    FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n    title:=\"Select Folder and FileName to save\")\n\nIf myfile &lt;&gt; \"False\" Then\n\n    ThisWorkbook.Sheets(Array(\"Engine\", \"CHP Layout\", \"Ventilation\", \"Exhaust\", \"Gas\", \"Hazardous Zoning\", \"Gas Ramp up\", \"Steam Boilers\", _\n                        \"JW PU\", \"AC PU\", \"Combustion\", \"BREEAM NOx\", \"Pump P1\", \"Pump P2\", \"Pump P3\", \"Pump P4\", \"Pump P5\")).Select\n\n    ActiveSheet.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    FileName:=myfile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True\n\n    MsgBox \"PDF file has been created.\"\n\nEnd If\n\nexitHandler:\nExit Sub\n\nerrHandler:\nMsgBox \"Could not create PDF file\", vbRetryCancel, \"Oops!\"\n\nResume exitHandler\n\nEnd Sub\n</code></pre>\n\n<p>I need the following UserForm's check boxes to define the sheets to include in the array.</p>\n\n<p><a href=\"http://i.stack.imgur.com/4U2TM.png\" rel=\"nofollow\">UserForm1</a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1448453494, "post_id": 33914137, "comment_id": 55593472, "body": "Typical case for regex."}, {"owner": {"reputation": 41, "user_id": 5553439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a5c23406da01583c3b48e26f189306?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul Sharma", "link": "https://stackoverflow.com/users/5553439/vipul-sharma"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1448526361, "post_id": 33914137, "comment_id": 55627332, "body": "Hi Jelly,  Thanks for the suggestion. I am quite new to VBA so could you please elaborate on this or provide a small example.  Thanks again"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1448536651, "post_id": 33914137, "comment_id": 55633992, "body": "A regex is a library that is used to return substrings from strings matching a specific pattern. Before I can help you, can you please illustrate the input and desired output of your problem. What do you want to extract from that text."}], "owner": {"reputation": 41, "user_id": 5553439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a5c23406da01583c3b48e26f189306?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul Sharma", "link": "https://stackoverflow.com/users/5553439/vipul-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448448892, "creation_date": 1448447504, "last_edit_date": 1448448892, "question_id": 33914137, "link": "https://stackoverflow.com/questions/33914137/get-all-occurrences-of-data-from-text-file-using-vba", "title": "Get all occurrences of data from text file using VBA", "body": "<p>I have a text file which contains lots of repetitive data.</p>\n\n<pre>\nCOB TRAC\nGreen With Comments\nIssue Description: Users were not able to use the document upload/download functionality as well as the ARP/TRP module of CoBTrac.\nRoot cause:\u00a0GPA working with CATE to help troubleshoot the issue as we migrated from WebBank to Cloud this past Friday (10/20/15).\u00a0 All other Modules are working fine.\nBusiness Impact:\u00a0 Users not able to upload document for CoBTrac.\nCompensating Controls:\u00a0 TBD.\nWork around: \u00a0No workaround, GPA/CATE working on resolution.\nIssue Reported On: 17th November 2015 \u2013 12:17PM EST\nEnvironment (Prod/UAT): PROD\nTechnology: Application\nEngineer SOEID (Who has worked on this): RK55542\nTicket Type (VT/EMS) & Number & Status: HYPERLINK \"https://servicemanagement.citigroup.net/nav_to.do?uri=incident.do%3Fsys_id=6e42f9df6ff34e00dad82fe64f3ee430%26sysparm_record_list=active=true%5esys_class_name!=u_major_incident\"INC0026404246\nIssue Category (APP/SA/DB): APP\nIssue Severity: Medium\n\nCitiRisk Credit\nGreen With Comments\nIssue \u00a0Description:\u00a0 The CitiRisk Credit Application Production Oracle RAC database server had one node (of three) go down due to a power issue.\nRoot Cause: Infrastructure issue - Server Power failure, RC to be determined. \nApplication Impact :\u00a0 As a result of this issues, 3 listeners and 1 data load job for the application failed. They were immediately re-run to success.\nBusiness Impact: \u00a0None\nCompensating Control: None\nWork Around:\u00a0DBA team is checking with service providers (Oracle & HP) to find a fix to such infra issue. The application team are looking at the reason for the failures of the listeners and data load job. \nIssue Reported On (Date/Time):\u00a0\u00a0\u00a0 11:30 PM EST 11/24/2015\nEnvironment (PROD/UAT):\u00a0\u00a0 PROD\nTechnology:\u00a0\u00a0 Oracle\nEngineer SOEID (Who is working on this):\u00a0\u00a0gg13851\nTicket Type(VT/EMS) & Number & Status: \u00a0INC0026451991\u00a0(SA) & INC0026451020 (DBA)\nIssue Category(APP/SA/DB):\u00a0\u00a0\u00a0 APP\nIssue Severity:\u00a0\u00a0 Severity - 2 (High)\n</pre>\n\n<p>I need to get the data like Issue Severity, Issue Category, etc.</p>\n\n<p>I am able to open the file and read but I dont know how to get all the required data for all tickets.</p>\n\n<p>I am using following code to open the file</p>\n\n<pre><code>    Dim strTestFile2 As String\n    strTestFile2 = \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\ETSDaily.txt\"\n    Dim dataArray2 As Variant\n    ' Open the file and assign data to array\n    Open strTestFile2 For Input As #1\n        dataArray2 = Split(Input$(LOF(1), #1), vbLf)\n    Close #1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1448447803, "post_id": 33913834, "comment_id": 55589938, "body": "Could you post the whole procedure or function?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "edited": false, "score": 0, "creation_date": 1448452141, "post_id": 33914437, "comment_id": 55592713, "body": "hm, does not work for me... I simplified it just for one <code>r = 1</code> ... <code>Then Sheet1.Range(&quot;B1&quot;) = &quot;a&quot;</code>, And nothing happens"}, {"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "edited": false, "score": 1, "creation_date": 1448452931, "post_id": 33914437, "comment_id": 55593165, "body": "nope, I got it. Managed to adapt it for my purpose. Thanks for your help!"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1448448286, "creation_date": 1448448286, "answer_id": 33914437, "question_id": 33913834, "link": "https://stackoverflow.com/questions/33913834/loop-for-cell-comparison-in-if-then-statement/33914437#33914437", "title": "Loop for cell comparison in IF-THEN statement", "body": "<p>Something like this should work:  </p>\n\n<pre><code>Sub test()\n    Dim r As Range, rng10 As Range, rng3 As Range\n    Set rng10 = Sheet1.Range(\"a1:a10\")\n    Set rng3 = Sheet2.Range(\"$a$1:$a$3\")\n\n    For Each r In rng10\n        If Application.WorksheetFunction.CountIf(rng3, r) &gt; 0 Then\n            'proceed here\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33914437, "answer_count": 1, "score": 0, "last_activity_date": 1448448465, "creation_date": 1448446741, "last_edit_date": 1448448465, "question_id": 33913834, "link": "https://stackoverflow.com/questions/33913834/loop-for-cell-comparison-in-if-then-statement", "title": "Loop for cell comparison in IF-THEN statement", "body": "<p>I need to compare each cell from range <code>src.Range(\"A1:A\" &amp; 10)</code> with cells in range <code>src3.Range(\"A1:A\" &amp; 3)</code> and proceed only if <code>src</code> cell is not equal to any of <code>src3</code> cells. It works if I manually list each comparison (as comment - what I have to get eventually. It works but there will be much greater range for comparison). But it does not when I try to loop it. I cannot separate<code>IF</code> from <code>THEN</code>. And I cannot find alternative.</p>\n\n<pre><code>  For temprow = 1 To rngSelectionTable.Rows.Count                         \n    tempselected = rngSelectionTable(temprow, 2).Value                      \n    Crit = rngSelectionTable(temprow, 5).Value                              \n\n    If tempselected = True Then\n\n    For Each r In src.Range(\"A1:A\" &amp; 10)                \n\n         'If r &lt;&gt; 0 _\n          And r &lt;&gt; src3.Range(\"A1\") _\n          And r &lt;&gt; src3.Range(\"A2\") _\n          And r &lt;&gt; src3.Range(\"A3\") _\n          Then myFinalResult = r\n\n        For Each comparisonRange In src3.Range(\"A1:A\" &amp; 3) 'does not work\n          If r &lt;&gt; 0 And r &lt;&gt; comparisonRange 'does not work\n              Next comparisonRange 'does not work\n          Then myFinalResult = r 'does not work\n\n        'rest of the code below\n             If myFinalResult = Crit Then                                 \n                 If CopyRange Is Nothing Then                        \n                     Set CopyRange = r.EntireRow                 \n                           Else\n                     Set CopyRange = Union(CopyRange, r.EntireRow) \n                 End If\n             End If   \n       Next r\n    End If\n  Next temprow\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1448447088, "post_id": 33913832, "comment_id": 55589482, "body": "I don&#39;t get your qestion exactly. You want to take the month e.g. January from the worksheetname and change it to 0116 (month.year)?"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1448449520, "creation_date": 1448449520, "answer_id": 33914893, "question_id": 33913832, "link": "https://stackoverflow.com/questions/33913832/vba-activesheet/33914893#33914893", "title": "VBA Activesheet", "body": "<p>Looks like your problem is that you don't know how to transform month name into number ( but as string).  Here is a solution (to be completed - I am not going to do all your work :)</p>\n\n<pre><code>Function getMonth(mname As String) As String\n'returns month number as string, from month name. Eg: returns \"02\" for \"Feb\"\n    Dim a()\n    Dim i As Integer\n    a = Array(\"jan\", \"feb\", \"mar\", \"apr\", \"...\")\n    i = Application.Match(mname, a, False)\n    getMonth = Format$(i, \"00\")\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5603602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448452957, "creation_date": 1448446738, "last_edit_date": 1531164843, "question_id": 33913832, "link": "https://stackoverflow.com/questions/33913832/vba-activesheet", "title": "VBA Activesheet", "body": "<p>I'm trying to make a monthly evaluation.\n\u00a0 I would like to read the sheet name, and then transform it into a date.\nThe individual worksheets have the names January, February, etc.\nWhen I wanted to issue 0116, 0216, 0316 and get this save.</p>\n\n<pre><code>tabellenblatt = ActiveSheet.Name\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "msgbox"], "comments": [{"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1448443791, "post_id": 33912571, "comment_id": 55587356, "body": "Do you have predefined list of sheet? The design of your form would not handle the situation, where number of sheets is dynamic."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1448444554, "post_id": 33912571, "comment_id": 55587843, "body": "@Juliusz. It depends on what you mean by predefined. The sheets are created when needed, through Userform2.combobox2 ( column 0 = code abbreviation (BRREPAIRS), column 1 = sheet name (2780), column 2 = full name (Repairs)."}, {"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1448445369, "post_id": 33912571, "comment_id": 55588347, "body": "I would redesign that part, so there is no limit on sheet numbers and to make reporting easier - your current design can handle four sheets. I would use ListBox control (with multi column) and add new rows to it. (Short of time right now, sorry for being very vague)"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1448445806, "post_id": 33912571, "comment_id": 55588625, "body": "@Juliusz. There is no limit on the number of sheets allowed, they are set to the combobox as all the sheets that could possible be used at the current time, if a new sheet is needed that is not in the list, then the user will create it manually, then i will update the combobox to include it for the future."}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448524527, "creation_date": 1448443075, "last_edit_date": 1448524527, "question_id": 33912571, "link": "https://stackoverflow.com/questions/33912571/msgbox-for-number-of-rows-copied-to-what-sheet", "title": "Msgbox for number of rows copied to what sheet", "body": "<p>With help from many helpful people on here I have got to the point where the code does exactly what I need it to do!</p>\n\n<p>I am really struggling with the <code>MsgBox</code> at the end that display how many rows have been copied to each sheet. I would also like it to display if there were any non-matches from the Global sheet in the same <code>MsgBox</code>. If no non-matches were found then this part can be omitted.</p>\n\n<p>Below is the code i have that searches the sheet for the values in <code>column Q</code> and the finds the match in the <code>ComboBox2</code> on the <code>UserForm</code>. This tells what sheet the rows need to be copied to, and if a new sheet is needed then also what to name it along with some other needed information.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim i As Long, j As Long, k As Long, strWS As String, rngCPY As Range\n  Dim noFind As Variant: noFind = UserForm2.ComboBox2.List '&lt;~~~ get missed items\n  With Application: .ScreenUpdating = False: .EnableEvents = False: .CutCopyMode = False: End With\n  If Range(\"L9\") = \"\" Then: MsgBox \"You can't Split the Jobs at this stage. \" &amp; vbLf &amp; vbLf &amp; \"Please create the form for the Sub-Contractor First.\" &amp; vbLf &amp; vbLf &amp; \"Please press Display Utilities to create form.\", vbExclamation, \"Invalid Operation\": Exit Sub\n\n  Dim lastG As Long: lastG = sheets(\"Global\").Cells(Rows.Count, 17).End(xlUp).row\n  Dim cVat As Boolean: cVat = InStr(1, sheets(\"Payment Form\").Range(\"A20\").value, \"THE VAT SHOWN IS YOUR OUTPUT TAX DUE TO CUSTOMS AND EXCISE\")\n\n  If sheets(\"PAYMENT FORM\").Cells(35 - cVat * 5, 12) &gt;= 1 Then: MsgBox \"It appears you have already split the jobs, this operation can only be performed once.\", vbExclamation, \"Invalid Operation\": Exit Sub\n\n  For j = 0 To UserForm2.ComboBox2.ListCount - 1\n    noFind(j, 4) = 0\n    For i = 3 To lastG\n      If noFind(j, 0) = sheets(\"Global\").Cells(i, 17) Then\n        k = i\n        strWS = UserForm2.ComboBox2.List(j, 1)\n        On Error Resume Next  '&lt;~~ if the worksheet in the next line does not exist, go make one\n        If Len(Worksheets(strWS).Name) = 0 Then\n          With ThisWorkbook\n            On Error GoTo 0\n            Dim nStr As String: With sheets(\"Payment Form\").Range(\"C9\"): nStr = Right(.value, Len(.value) - Len(Left(.value, InStr(.value, \"- \")))): End With\n            Dim CCName As Variant: CCName = UserForm2.ComboBox2.List(j, 2)\n            Dim lastRow As Long: lastRow = sheets(\"Payment Form\").Range(\"U36:U53\").End(xlDown).row\n            Dim strRng As String: strRng = Array(\"A18:A34\", \"A23:A39\")(-1 * cVat)\n            Dim lastRow2 As Long: lastRow2 = sheets(\"Payment Form\").Range(strRng).End(xlDown).row\n            Dim wsTemplate As Worksheet: Set wsTemplate = ThisWorkbook.sheets(\"Template\")\n            Dim wsNew As Worksheet\n            With sheets(\"Payment Form\")\n              For Each cell In .Range(strRng)\n                If Len(cell) = 0 Then\n                  If sheets(\"Payment Form\").Range(\"C9\").value = \"Network\" Then\n                    cell.Offset.value = strWS &amp; \" - \" &amp; nStr &amp; \": \" &amp; CCName\n                  Else\n                    cell.Offset.value = strWS &amp; \" -\" &amp; nStr &amp; \": \" &amp; CCName\n                  End If\n                  Exit For\n                End If\n              Next cell\n            End With\n            With wsNew\n            wsTemplate.Visible = True\n            wsTemplate.Copy before:=sheets(\"Details\"): Set wsNew = ActiveSheet\n            wsTemplate.Visible = False\n              wsNew.Name = strWS\n              wsNew.Range(\"D4\").value = sheets(\"Payment Form\").Range(strRng).End(xlDown).value\n              wsNew.Range(\"D6\").value = sheets(\"Payment Form\").Range(\"L11\").value\n              wsNew.Range(\"D8\").value = sheets(\"Payment Form\").Range(\"C9\").value\n              wsNew.Range(\"D10\").value = sheets(\"Payment Form\").Range(\"C11\").value\n            End With\n            With .sheets(\"Payment Form\")\n              .Activate\n              .Range(\"J\" &amp; lastRow2 + 1).value = 0\n              .Range(\"L\" &amp; lastRow2 + 1).Formula = \"=N\" &amp; lastRow2 + 1 &amp; \"-J\" &amp; lastRow2 + 1 &amp; \"\"\n              .Range(\"N\" &amp; lastRow2 + 1).Formula = \"='\" &amp; strWS &amp; \"'!L20\"\n              .Range(\"U\" &amp; lastRow + 1).value = strWS &amp; \": \"\n              .Range(\"V\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!I21\"\n              .Range(\"W\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!I23\"\n              .Range(\"X\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!K21\"\n            End With\n          End With\n        End If '&lt;~~~ end new sheet\n        On Error GoTo 0\n        While sheets(\"Global\").Cells(k + 1, 17).value = noFind(j, 0) And k &lt; lastG\n          k = k + 1\n        Wend\n        Set rngCPY = sheets(\"Global\").Range(\"Q\" &amp; i &amp; \":Q\" &amp; k).EntireRow\n        With Worksheets(strWS)\n          rngCPY.Copy\n          .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Insert shift:=xlDown\n        End With\n        noFind(j, 4) = noFind(j, 4) + k - i + 1\n        i = k\n      End If\n    Next i\n  Next j\n\n  With Application: .ScreenUpdating = True: .EnableEvents = True: .CutCopyMode = True: End With\n\n  'noFind(x, y) &gt; x = item / y: 0 = name / y: 4 = counter\n  noFind(0, 0) = noFind(0, 0) &amp; \" \" &amp; noFind(0, 4) &amp; \" times copied\"\n  For i = 1 To UBound(noFind)\n    noFind(0, 0) = noFind(0, 0) &amp; vbLf &amp; noFind(i, 0) &amp; \" \" &amp; noFind(i, 4) &amp; \" times copied\"\n  Next\n  MsgBox noFind(0, 0)\nEnd Sub\n</code></pre>\n\n<p>This is what is currently being displayed by the <code>MsgBox</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LskKK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LskKK.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is how I want the <code>MsgBox</code> to display the information:</p>\n\n<p><a href=\"https://i.stack.imgur.com/je3iI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/je3iI.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want it to show the sheet names, then how many rows have been copied to it.</p>\n\n<p>Below that the total number of rows copied.</p>\n\n<p>Then if required, below that display errors found on the global sheet along with how many times you found that value. I.e (BRERRORS) &lt;- This is the cell value.</p>\n\n<p>If possible below that, maybe a total number of errors found on the sheet as well.</p>\n\n<p>At the very bottom, a total number of rows that were searched in the global sheet, this will be used for comparison, so if the total number of rows copied doesn't match the total number of the global sheet then the user will know they need to copied some rows manually after checking the rows value.</p>\n\n<p>If it helps here is the original code without the code for the <code>MsgBox</code>, if you can think of a better way to do it.</p>\n\n<pre><code>Private Sub btnSplitJobs_Click()\n  Dim i As Long, j As Long, k As Long, strWS As String, rngCPY As Range\n  With Application: .ScreenUpdating = False: .EnableEvents = False: .CutCopyMode = False: End With\n  If Range(\"L9\") = \"\" Then: MsgBox \"You can't Split the Jobs at this stage. \" &amp; vbLf &amp; vbLf &amp; \"Please create the form for the Sub-Contractor First.\" &amp; vbLf &amp; vbLf &amp; \"Please press Display Utilities to create form.\", vbExclamation, \"Invalid Operation\": Exit Sub\n\n  Dim lastG As Long: lastG = sheets(\"Global\").Cells(Rows.Count, \"Q\").End(xlUp).row\n  Dim cVat As Boolean: cVat = InStr(1, sheets(\"Payment Form\").Range(\"A20\").value, \"THE VAT SHOWN IS YOUR OUTPUT TAX DUE TO CUSTOMS AND EXCISE\")\n\n  If sheets(\"PAYMENT FORM\").Cells(35 - cVat * 5, 12) &gt;= 1 Then: MsgBox \"It appears you have already split the jobs, this operation can only be performed once.\", vbExclamation, \"Invalid Operation\": Exit Sub\n\n  For j = 0 To UserForm2.ComboBox2.ListCount - 1\n    currval = UserForm2.ComboBox2.List(j, 0)\n    For i = 3 To lastG\n      If currval = sheets(\"Global\").Cells(i, \"Q\") Then\n        k = i\n        strWS = UserForm2.ComboBox2.List(j, 1)\n        On Error Resume Next  '&lt;~~ if the worksheet in the next line does not exist, go make one\n        If Len(Worksheets(strWS).Name) = 0 Then\n          With ThisWorkbook\n            On Error GoTo 0\n            Dim nStr As String: With sheets(\"Payment Form\").Range(\"C9\"): nStr = Right(.value, Len(.value) - Len(Left(.value, InStr(.value, \"- \")))): End With\n            Dim CCName As Variant: CCName = UserForm2.ComboBox2.List(j, 2)\n            Dim lastRow As Long: lastRow = sheets(\"Payment Form\").Range(\"U36:U53\").End(xlDown).row\n            Dim strRng As String: strRng = Array(\"A18:A34\", \"A23:A39\")(-1 * cVat)\n            Dim lastRow2 As Long: lastRow2 = sheets(\"Payment Form\").Range(strRng).End(xlDown).row\n            Dim wsTemplate As Worksheet: Set wsTemplate = ThisWorkbook.sheets(\"Template\")\n            Dim wsNew As Worksheet\n            With sheets(\"Payment Form\")\n              For Each cell In .Range(strRng)\n                If Len(cell) = 0 Then\n                  If sheets(\"Payment Form\").Range(\"C9\").value = \"Network\" Then\n                    cell.Offset.value = strWS &amp; \" - \" &amp; nStr &amp; \": \" &amp; CCName\n                  Else\n                    cell.Offset.value = strWS &amp; \" -\" &amp; nStr &amp; \": \" &amp; CCName\n                  End If\n                  Exit For\n                End If\n              Next cell\n            End With\n            With wsNew\n            wsTemplate.Visible = True\n            wsTemplate.Copy before:=sheets(\"Details\"): Set wsNew = ActiveSheet\n            wsTemplate.Visible = False\n              wsNew.Name = strWS\n              wsNew.Range(\"D4\").value = sheets(\"Payment Form\").Range(strRng).End(xlDown).value\n              wsNew.Range(\"D6\").value = sheets(\"Payment Form\").Range(\"L11\").value\n              wsNew.Range(\"D8\").value = sheets(\"Payment Form\").Range(\"C9\").value\n              wsNew.Range(\"D10\").value = sheets(\"Payment Form\").Range(\"C11\").value\n            End With\n            With .sheets(\"Payment Form\")\n              .Activate\n              .Range(\"J\" &amp; lastRow2 + 1).value = 0\n              .Range(\"L\" &amp; lastRow2 + 1).Formula = \"=N\" &amp; lastRow2 + 1 &amp; \"-J\" &amp; lastRow2 + 1 &amp; \"\"\n              .Range(\"N\" &amp; lastRow2 + 1).Formula = \"='\" &amp; strWS &amp; \"'!L20\"\n              .Range(\"U\" &amp; lastRow + 1).value = strWS &amp; \": \"\n              .Range(\"V\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!I21\"\n              .Range(\"W\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!I23\"\n              .Range(\"X\" &amp; lastRow + 1).Formula = \"='\" &amp; strWS &amp; \"'!K21\"\n            End With\n          End With\n        End If '&lt;~~~ end new sheet\n        While sheets(\"Global\").Cells(k + 1, 17).value = currval And k &lt; lastG\n          k = k + 1\n        Wend\n        Set rngCPY = sheets(\"Global\").Range(\"Q\" &amp; i &amp; \":Q\" &amp; k).EntireRow\n        With Worksheets(strWS)\n          rngCPY.Copy\n          .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Insert shift:=xlDown\n        End With\n        i = k\n      End If\n    Next i\n  Next j\n\n  With Application: .ScreenUpdating = True: .EnableEvents = True: .CutCopyMode = True: End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "find"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1448440688, "creation_date": 1448440688, "answer_id": 33911799, "question_id": 33911526, "link": "https://stackoverflow.com/questions/33911526/copying-data-to-another-sheet/33911799#33911799", "title": "Copying data to another sheet", "body": "<p>After a bit of cleaning, this is what this could look like (explanations below) :</p>\n\n<pre><code>Sub histFunc()\nDim FindRange As Range, _\n    LookForValue As String\nLookForValue = \"R\" &amp; Range(\"G7\").Value\n\nWith Sheets(\"Sheet History\")\n    .Range(\"h17\").Activate\n    Set FindRange = .Cells.Find(What:=LookForValue, _\n                    After:=ActiveCell, _\n                    LookIn:=xlFormulas, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False, _\n                    SearchFormat:=False)\n\n    Application.CutCopyMode = False\n\n    Range(FindRange, FindRange.End(xlToRight)).Copy\n    FindRange.PasteSpecial Paste:=xlPasteValues, _\n                           Operation:=xlNone, _\n                           SkipBlanks:=False, _\n                           Transpose:=False\nEnd With\n\nApplication.CutCopyMode = False\nSheets(\"Sheet Current\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I changed <code>Y</code> to <code>LookForValue</code> for better understanding and used a Range variable to reference the result of the <code>Find</code> method.</p>\n\n<p>So this code, step by step :</p>\n\n<ol>\n<li>Define <code>LookForValue</code> as <code>\"R\" &amp; Range(\"G7\").Value</code></li>\n<li>Search for that value in the formulas of <code>Sheet History</code></li>\n<li>Copy the data block (in the row of the result, from result to right, until there is a blank)</li>\n<li>Paste it at the same place but in <em>values</em>, so that you get rid of the formulas!</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "is_accepted": false, "score": 1, "last_activity_date": 1448442643, "last_edit_date": 1592644375, "creation_date": 1448442643, "answer_id": 33912402, "question_id": 33911526, "link": "https://stackoverflow.com/questions/33911526/copying-data-to-another-sheet/33912402#33912402", "title": "Copying data to another sheet", "body": "<p>In short, the code searches for the value in <em>G7</em> in <em>Sheet History</em> and replaces the right part of that line with <em>values only</em>, i.e. removing references or values.</p>\n<h1>Step-by-step Explanation</h1>\n<p>Get the value of cell G7:</p>\n<pre><code>Y = &quot;R&quot; &amp; Range(&quot;G7&quot;).Value\n</code></pre>\n<p>Select sheet <em>Sheet History</em> and select cell <em>H17</em>:</p>\n<pre><code>Sheets(&quot;Sheet History&quot;).Select\nRange(&quot;h17&quot;).Select\n</code></pre>\n<p>Executes the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\"><code>Find</code></a> method over <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\"><code>Cells</code></a>, all cells in the sheet (note that if no parameter is given it is the range of all Cells in the current Sheet):</p>\n<pre><code>Cells.Find(What:=Y, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\n</code></pre>\n<p>This returns:</p>\n<blockquote>\n<p>A Range object that represents the first cell where that information is found.</p>\n</blockquote>\n<p>For more info see the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\"><code>Find</code> documentation</a>.\nNow due to <code>.Activate</code> the (first) cell is selected where the value was found. This selection is extended to the end of the line:</p>\n<pre><code>Range(Selection, Selection.End(xlToRight)).Select\n</code></pre>\n<p>Then the <code>CutCopyMode</code> is deactivated to <a href=\"https://stackoverflow.com/questions/17607412/what-exactly-is-the-function-of-application-cutcopymode-property-in-excel\">clear the clipboard after usage</a>:</p>\n<pre><code>Application.CutCopyMode = False\n</code></pre>\n<p>Now the selected cells are copied and pasted:</p>\n<pre><code>Selection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n<p>Note that they are pasted on with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\"><code>PasteSpecial</code></a> on the <strong>same location</strong>, using  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837425.aspx\" rel=\"nofollow noreferrer\"><code>xlPasteValues</code></a> to only maintain the values, and therefore not to have any formulas nor references in the cells.</p>\n<p>Now go to <em>Sheet Current</em>:</p>\n<pre><code>Sheets(&quot;Sheet Current&quot;).Select\n</code></pre>\n"}], "owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448442643, "creation_date": 1448439732, "last_edit_date": 1448440704, "question_id": 33911526, "link": "https://stackoverflow.com/questions/33911526/copying-data-to-another-sheet", "title": "Copying data to another sheet", "body": "<p>I am having trouble understanding what the below function is doing.</p>\n\n<p>The function itself has the ability to copy data to the sheet <code>Sheet History</code>. However, I do not get how it is doing it?</p>\n\n<pre><code>Sub histFunc()\n\nDim Y As String\nY = \"R\" &amp; Range(\"G7\").Value\n\n    Sheets(\"Sheet History\").Select\n    Range(\"h17\").Select\n\n    Cells.Find(What:=Y, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False).Activate\n    Range(Selection, Selection.End(xlToRight)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Sheets(\"Sheet Current\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Any suggestions how this macro is operating? </p>\n\n<p>I appreciate your replies!</p>\n"}, {"tags": ["sql-server", "excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1448446390, "post_id": 33910985, "comment_id": 55589026, "body": "Is there any reason why you keep the connection open? Why not open the connection at the start of the function Rout, then close it at the end. So basically, don&#39;t rely on the caching of the connection, simply opent it, process , then close it."}, {"owner": {"reputation": 1, "user_id": 5584113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8862ddd6a5994e81eba0d1c060dcbc84?s=128&d=identicon&r=PG&f=1", "display_name": "Donny Lee", "link": "https://stackoverflow.com/users/5584113/donny-lee"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1448500144, "post_id": 33910985, "comment_id": 55618966, "body": "I thought about it. But between these two, which would be the more robust solution: 1 - For each loop that runs every 15 seconds - open a connection, open recordset, close recordset, close connection. 2 - For each loop that runs every 15 seconds - open a connection if it&#39;s closed, open recordset, close recordset. Opening a connection every 15 seconds seems more network intensive to me."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1448519548, "post_id": 33910985, "comment_id": 55624230, "body": "Or - keep an expensive connection open all the time. Everywhere I&#39;ve implemented DB connections they&#39;e closed asap since they have a cost involved with them. I&#39;d at least try to open each time to see if it corrects the issue. BTW could you implement a disconnected recordset.... maybe."}], "owner": {"reputation": 1, "user_id": 5584113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8862ddd6a5994e81eba0d1c060dcbc84?s=128&d=identicon&r=PG&f=1", "display_name": "Donny Lee", "link": "https://stackoverflow.com/users/5584113/donny-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448437947, "creation_date": 1448437574, "last_edit_date": 1448437947, "question_id": 33910985, "link": "https://stackoverflow.com/questions/33910985/what-causes-adodb-connection-to-close-other-than-calling-close-itself", "title": "What causes ADODB Connection to close other than calling close itself", "body": "<p>Here is the context. I've tested a VBA app on my computer where I'm been developing and it works fine. The app, which also runs a loop via <code>Application.OnTime</code>, connects to a Sql server via <code>ADODB.Connection</code> using Windows Authentication. Only one <code>conn</code> is made but many <code>RecordSet</code> open's using <code>conn</code> are executed in each <code>OnTime</code> loop. </p>\n\n<p>While the VBA app runs fine 24 hours on my computer, problems arise when I ship the app to another computer. This other computer <strong>can</strong> log into the Sql server <strong>but</strong> the RecordSet starts to fail after 5 hours. Nothing is read, nothing is outputted.</p>\n\n<p>The routine I call is very simple.</p>\n\n<pre><code>Sub Rout()\n    On Error Resume Next\n    If conn Is Nothing Then\n        Call connectDB\n    End If\n\n    Dim cmd As New ADODB.Command\n    cmd.ActiveConnection = conn\n    cmd.CommandText = \"dbo.[procedureTestEvent]\"\n    cmd.CommandType = adCmdStoredProc                                  \n    Dim rs As Recordset\n    Set rs = cmd.Execute\n\n    ThisWorkbook.Sheets(\"Main\").Range(\"E5\").Value = rs!Value    \n\n    DateRun = Now + TimeSerial(0, 0, 2)\n    Application.OnTime DateRun, \"Rout\"\nEnd Sub\n</code></pre>\n\n<p>Now, when I disable <code>On Error Resume Next</code>, a pop up with the error </p>\n\n<p>Run-time error '3709': Requested operation requires an OLE DB Session object, which is not supported by the current provider.</p>\n\n<p>which is due to the <code>conn.State</code> being closed. Because I was ignoring errors before, the <code>Rout()</code> will simply continue to repeat itself and there won't be any updates on the screen as <code>RecordSet</code> is failing without notification. Thus, the questions are:</p>\n\n<ol>\n<li><p>Is there a cause that makes <code>conn.State</code> to <code>0</code> after <code>cmd.Execute</code>? I'm sure <code>conn.State=1</code> after <code>connectDB</code>. I've tried setting <code>cmd.ConnectionTimeout=10</code> and putting an artificial <code>waitfor delay '00:00:15'</code> in <code>procedureTestEvent</code>. Even when disregarding errors, <code>conn.State</code> is still open after the timeout.</p></li>\n<li><p>Knowing that the only difference between both instances of the VBA app is the Windows log in, can the automatic closing of <code>conn</code> be related to Windows Authentication? Bear in mind that <code>RecordSet</code> fails <strong>after a few hours</strong> of the app operating fine.</p></li>\n</ol>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448464502, "post_id": 33910480, "comment_id": 55601150, "body": "Why do yo&#246;u need a content control? It&#39;s not possible to assign a size to a content control - content controls adjust to the content, not the other way around. A table cell can limit the size of a picture, but can&#39;t make a picture &quot;zoom&quot; to fit. Also, I don&#39;t think you can assign a caption to a picture inside a content control..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448464637, "post_id": 33910480, "comment_id": 55601242, "body": "You should avoid using Selection as much as possible and work, instead, with the objects. In your case, you should declare an object for the table and assign the table you&#39;re adding to it, then work with that: Dim tbl as Word.Table : Set tbl = ActiveDocument.Tables.Add(&#39;params) : With tbl and so on."}], "owner": {"reputation": 11, "user_id": 5602893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e9b12cb5ebdff54dcf1356816c4b57?s=128&d=identicon&r=PG&f=1", "display_name": "Sydney87", "link": "https://stackoverflow.com/users/5602893/sydney87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448437299, "creation_date": 1448435482, "last_edit_date": 1448437299, "question_id": 33910480, "link": "https://stackoverflow.com/questions/33910480/word-macros-how-to-combine-and-change-different-content-control-elements", "title": "Word Macros: How to combine and change different content control elements", "body": "<p>I don't have any experiences with Macros and VBA so please excuse my question. I am currently creating a word template (Word 2016) which contains various buttons in my own ribbon. I use Macros to run those buttons, e.g. to insert a specific table format, a format for headlines, a list format etc. I also want to create such a button to insert grafics in a specific way. Therefore I need a table which contains a content control element for pictures in a specific size and below the table I need a caption. Problem: I cannot change the size of the content control element and the caption is not shown. If I insert a specifc picture from my computer it works, but then it doesn't work on other pcs, which is essential. Does anyone has an idea?\nBtw this is my code:</p>\n\n<pre><code>Sub BildContent()\n'\n' BildContent Makro\n'\n'\n    ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _\n\n        1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _\n        wdAutoFitFixed\n    With Selection.Tables(1)\n        If .Style &lt;&gt; \"Tabellenraster\" Then\n            .Style = \"Tabellenraster\"\n        End If\n        .ApplyStyleHeadingRows = True\n        .ApplyStyleLastRow = False\n        .ApplyStyleFirstColumn = True\n        .ApplyStyleLastColumn = False\n        .ApplyStyleRowBands = True\n        .ApplyStyleColumnBands = False\n    End With\n    Selection.Shading.Texture = wdTextureNone\n    Selection.Shading.ForegroundPatternColor = wdColorAutomatic\n    Selection.Shading.BackgroundPatternColor = 15523274\n    Selection.Tables(1).Rows.LeftIndent = CentimetersToPoints(-4.5)\n    Selection.Tables(1).PreferredWidthType = wdPreferredWidthPoints\n    Selection.Tables(1).PreferredWidth = CentimetersToPoints(16.36)\n    Selection.Style = ActiveDocument.Styles(\"Hinweistext Marginale\")\n    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    Selection.Range.ContentControls.Add (wdContentControlPicture)\n    Selection.InsertCaption Label:=\"Abbildung\", TitleAutoText:= _\n        \"Einf\u00fcgenBeschriftung1\", Title:=\"\", Position:=wdCaptionPositionBelow, _\n        ExcludeLabel:=0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "runtime-error"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1448437988, "post_id": 33910106, "comment_id": 55584103, "body": "Which line is causing the error?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5602840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ek6qtTgrPog/AAAAAAAAAAI/AAAAAAAAANE/ZnGrsS94egY/photo.jpg?sz=128", "display_name": "Singgih Putra", "link": "https://stackoverflow.com/users/5602840/singgih-putra"}, "edited": false, "score": 0, "creation_date": 1448445818, "post_id": 33911152, "comment_id": 55588640, "body": "you really save my life dude @R3uK ! appreciated it so much !"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 5602840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ek6qtTgrPog/AAAAAAAAAAI/AAAAAAAAANE/ZnGrsS94egY/photo.jpg?sz=128", "display_name": "Singgih Putra", "link": "https://stackoverflow.com/users/5602840/singgih-putra"}, "edited": false, "score": 1, "creation_date": 1448448466, "post_id": 33911152, "comment_id": 55590377, "body": "Glad I could help! ;) Take a minute to take the tour and see how SO works (accepting answers and voting) : <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1448438230, "creation_date": 1448438230, "answer_id": 33911152, "question_id": 33910106, "link": "https://stackoverflow.com/questions/33910106/run-time-error-424-object-required/33911152#33911152", "title": "Run Time Error &#39;424&#39; Object Required", "body": "<p>You need to :</p>\n\n<ol>\n<li>Define the range you want to paste on/from (top left cell is sufficient)</li>\n<li>Then do the actual paste</li>\n</ol>\n\n<p>So instead of : </p>\n\n<pre><code>Set rngDestin = ThisWorkbook.Sheets(\"RawData\").Range(\"A2\").PasteSpecial\n</code></pre>\n\n<p>Do this :</p>\n\n<pre><code>Set rngDestin = ThisWorkbook.Sheets(\"RawData\").Range(\"A2\")\nrngDestin.PasteSpecial\n</code></pre>\n\n<hr>\n\n<p>Here is your full code with the correction and without all useless scrolls :</p>\n\n<pre><code>Sub CopyData()\n    Dim fileDialog As fileDialog\n    Dim strPathFile As String\n    Dim strFileName As String\n    Dim strPath As String\n    Dim dialogTitle As String\n    Dim wbSource As Workbook\n    Dim rngToCopy As Range\n    Dim rngRow As Range\n    Dim rngDestin As Range\n    Dim lngRowsCopied As Long\n\n    dialogTitle = \"Navigate to and select required file.\"\n    Set fileDialog = Application.fileDialog(msoFileDialogFilePicker)\n    With fileDialog\n        .InitialFileName = \"P:\\Sales &amp; Marketing\\REVENUE MANAGEMENT\\REPORTS\"\n        '.InitialFileName = ThisWorkbook.Path &amp; \"\\\" 'Alternative to previous line\n       .AllowMultiSelect = False\n        .Filters.Clear\n        .Title = dialogTitle\n        If .Show = False Then\n            MsgBox \"File not selected to import. Process Terminated\"\n            Exit Sub\n        End If\n        strPathFile = .SelectedItems(1)\n    End With\n\n    Set wbSource = Workbooks.Open(Filename:=strPathFile)\n\n    Range(\"16:16,18:18,20:20,22:22,24:24,26:26,28:28,30:30,32:32,34:34,36:36,38:38,40:40,42:42,44:44,\" &amp; _\n            \"46:46,48:48,50:50,52:52,54:54,56:56,58:58,60:60,62:62,64:64,66:66,68:68,70:70,72:72,74:74\" _\n        ).Delete Shift:=xlUp\n\n    Range(\"A15:P45\").Copy\n\n    Set rngDestin = ThisWorkbook.Sheets(\"RawData\").Range(\"A2\")\n    rngDestin.PasteSpecial\n\n    wbSource.Close SaveChanges:=False\n\n    Set fileDialog = Nothing\n    Set rngRow = Nothing\n    Set rngToCopy = Nothing\n    Set wbSource = Nothing\n    Set rngDestin = Nothing\n\n    'MsgBox \"The Data Is Imported\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5602840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ek6qtTgrPog/AAAAAAAAAAI/AAAAAAAAANE/ZnGrsS94egY/photo.jpg?sz=128", "display_name": "Singgih Putra", "link": "https://stackoverflow.com/users/5602840/singgih-putra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448438230, "creation_date": 1448434107, "last_edit_date": 1448435639, "question_id": 33910106, "link": "https://stackoverflow.com/questions/33910106/run-time-error-424-object-required", "title": "Run Time Error &#39;424&#39; Object Required", "body": "<p>i'm Going to make the Copy Paste file using dialogbox, i successfully copy and paste the data to the desire sheets and cell but in the VBA Appear Run Time Error '424' Object Required message box. sorry for the mess i'm new for this. would really appreciate for the help to figure whats the problem and how to fix it :</p>\n\n<pre><code>Sub CopyData()\n\n    Dim fileDialog As fileDialog\n    Dim strPathFile As String\n    Dim strFileName As String\n    Dim strPath As String\n    Dim dialogTitle As String\n    Dim wbSource As Workbook\n    Dim rngToCopy As Range\n    Dim rngRow As Range\n    Dim rngDestin As Range\n    Dim lngRowsCopied As Long\n\n\n    dialogTitle = \"Navigate to and select required file.\"\n    Set fileDialog = Application.fileDialog(msoFileDialogFilePicker)\n    With fileDialog\n        .InitialFileName = \"P:\\Sales &amp; Marketing\\REVENUE MANAGEMENT\\REPORTS\"\n        '.InitialFileName = ThisWorkbook.Path &amp; \"\\\" 'Alternative to previous line\n       .AllowMultiSelect = False\n        .Filters.Clear\n        .Title = dialogTitle\n\n\n\n        If .Show = False Then\n            MsgBox \"File not selected to import. Process Terminated\"\n            Exit Sub\n        End If\n        strPathFile = .SelectedItems(1)\n    End With\n\n    Set wbSource = Workbooks.Open(Filename:=strPathFile)\n\n    Range(\"16:16,18:18,20:20,22:22,24:24,26:26\").Select\n    Range(\"A26\").Activate\n    ActiveWindow.ScrollRow = 10\n    ActiveWindow.ScrollRow = 11\n    ActiveWindow.ScrollRow = 12\n    ActiveWindow.ScrollRow = 13\n    ActiveWindow.ScrollRow = 14\n    ActiveWindow.ScrollRow = 15\n    ActiveWindow.ScrollRow = 16\n    ActiveWindow.ScrollRow = 17\n    ActiveWindow.ScrollRow = 18\n    ActiveWindow.ScrollRow = 19\n    ActiveWindow.ScrollRow = 20\n    ActiveWindow.ScrollRow = 21\n    ActiveWindow.ScrollRow = 22\n    ActiveWindow.ScrollRow = 23\n    ActiveWindow.ScrollRow = 24\n    ActiveWindow.ScrollRow = 25\n    ActiveWindow.ScrollRow = 26\n    ActiveWindow.ScrollRow = 25\n    ActiveWindow.ScrollRow = 24\n    ActiveWindow.ScrollRow = 23\n    ActiveWindow.ScrollRow = 22\n    Range( _\n        \"16:16,18:18,20:20,22:22,24:24,26:26,28:28,30:30,32:32,34:34,36:36,38:38,40:40,42:42,44:44,46:46\" _\n        ).Select\n    Range(\"A46\").Activate\n    ActiveWindow.ScrollRow = 23\n    ActiveWindow.ScrollRow = 24\n    ActiveWindow.ScrollRow = 25\n    ActiveWindow.ScrollRow = 26\n    ActiveWindow.ScrollRow = 27\n    ActiveWindow.ScrollRow = 28\n    ActiveWindow.ScrollRow = 29\n    ActiveWindow.ScrollRow = 30\n    ActiveWindow.ScrollRow = 31\n    ActiveWindow.ScrollRow = 32\n    ActiveWindow.ScrollRow = 33\n    ActiveWindow.ScrollRow = 34\n    ActiveWindow.ScrollRow = 35\n    ActiveWindow.ScrollRow = 36\n    ActiveWindow.ScrollRow = 37\n    ActiveWindow.ScrollRow = 38\n    ActiveWindow.ScrollRow = 39\n    ActiveWindow.ScrollRow = 40\n    ActiveWindow.ScrollRow = 41\n    ActiveWindow.ScrollRow = 42\n    Range( _\n        \"16:16,18:18,20:20,22:22,24:24,26:26,28:28,30:30,32:32,34:34,36:36,38:38,40:40,42:42,44:44,46:46,48:48,50:50,52:52,54:54,56:56,58:58,60:60,62:62,64:64,66:66,68:68\" _\n        ).Select\n    Range(\"A68\").Activate\n    ActiveWindow.ScrollRow = 41\n    ActiveWindow.ScrollRow = 43\n    ActiveWindow.ScrollRow = 44\n    ActiveWindow.ScrollRow = 46\n    ActiveWindow.ScrollRow = 48\n    ActiveWindow.ScrollRow = 50\n    ActiveWindow.ScrollRow = 53\n    Range( _\n        \"16:16,18:18,20:20,22:22,24:24,26:26,28:28,30:30,32:32,34:34,36:36,38:38,40:40,42:42,44:44,46:46,48:48,50:50,52:52,54:54,56:56,58:58,60:60,62:62,64:64,66:66,68:68,70:70,72:72,74:74\" _\n        ).Select\n    Range(\"A74\").Activate\n    Selection.Delete Shift:=xlUp\n    Range(\"F64\").Select\n    ActiveWindow.SmallScroll Down:=-48\n    Range(\"A15:P45\").Select\n    Selection.Copy\n\n    Set rngDestin = ThisWorkbook.Sheets(\"RawData\").Range(\"A2\").PasteSpecial\n\n\n    wbSource.Close SaveChanges:=False\n\n    Set fileDialog = Nothing\n    Set rngRow = Nothing\n    Set rngToCopy = Nothing\n    Set wbSource = Nothing\n    Set rngDestin = Nothing\n\n    'MsgBox \"The Data Is Imported\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448434002, "post_id": 33909795, "comment_id": 55582242, "body": "Check the <code>Merge</code> button status on your Excel Task Bar when you have clicked on E7"}, {"owner": {"reputation": 163, "user_id": 5541519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8849fd0d79354ab3f718f72d5e7aaa2e?s=128&d=identicon&r=PG&f=1", "display_name": "smz", "link": "https://stackoverflow.com/users/5541519/smz"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448434135, "post_id": 33909795, "comment_id": 55582289, "body": "it is disabled when I clicked it.."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448434221, "post_id": 33909795, "comment_id": 55582323, "body": "OK, and then you click E7, in the White box next to the Function/Formula bar above your Sheet, does it only say E7"}, {"owner": {"reputation": 163, "user_id": 5541519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8849fd0d79354ab3f718f72d5e7aaa2e?s=128&d=identicon&r=PG&f=1", "display_name": "smz", "link": "https://stackoverflow.com/users/5541519/smz"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448434320, "post_id": 33909795, "comment_id": 55582370, "body": "Yes it is.. I can only see E7 on the box"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448434488, "post_id": 33909795, "comment_id": 55582439, "body": "If you use your keyboard arrows to navigate from E8 to E7, does it become selected? Also, why is your cursor green?"}, {"owner": {"reputation": 163, "user_id": 5541519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8849fd0d79354ab3f718f72d5e7aaa2e?s=128&d=identicon&r=PG&f=1", "display_name": "smz", "link": "https://stackoverflow.com/users/5541519/smz"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1448435026, "post_id": 33909795, "comment_id": 55582688, "body": "I can navigate from E8 to E7, and the name changes also, BUT the cell is not selected. It is green because I am using excel 2013"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 163, "user_id": 5541519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8849fd0d79354ab3f718f72d5e7aaa2e?s=128&d=identicon&r=PG&f=1", "display_name": "smz", "link": "https://stackoverflow.com/users/5541519/smz"}, "edited": false, "score": 0, "creation_date": 1448435065, "post_id": 33909795, "comment_id": 55582708, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/96113/discussion-between-jean-pierre-oosthuizen-and-smz\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 0, "last_activity_date": 1448446582, "creation_date": 1448446582, "answer_id": 33913770, "question_id": 33909795, "link": "https://stackoverflow.com/questions/33909795/focusing-of-cell-is-not-working-after-inserting-of-new-column-in-vba/33913770#33913770", "title": "Focusing of cell is not working after inserting of new column in vba", "body": "<p><strong>NOTE: I am Using Office 2010</strong></p>\n\n<p>With my Version I am not able to select cells which ave been set to locked when the document is protected.</p>\n\n<p>It might be that in Office 2013 you are able to select the cell but the Rectangular Cursor will be hidden when the Cell is selected to Locked, depending on your settings for the document Protection.</p>\n\n<p>Setting the Locked/Hidden Property of a Cell, right click Cell and Select \"Format Cells...\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/jnRGR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jnRGR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When you protect your document there will be two Settings selected by default. To Protect the document Click the Review Tabs and Select \"Protect Sheet\". See below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PVBG1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PVBG1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Check Settings are selected in the Protect Sheet window, this might advise you as to where the issue is coming from.</p>\n"}], "owner": {"reputation": 163, "user_id": 5541519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8849fd0d79354ab3f718f72d5e7aaa2e?s=128&d=identicon&r=PG&f=1", "display_name": "smz", "link": "https://stackoverflow.com/users/5541519/smz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 33913770, "answer_count": 1, "score": 0, "last_activity_date": 1448446582, "creation_date": 1448432783, "last_edit_date": 1531164843, "question_id": 33909795, "link": "https://stackoverflow.com/questions/33909795/focusing-of-cell-is-not-working-after-inserting-of-new-column-in-vba", "title": "Focusing of cell is not working after inserting of new column in vba", "body": "<p>I have inserted a column between E and F after I clicked a button. Please see my code below:</p>\n\n<pre><code> Columns(\"E:F\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>After that, I wanted the user to click on the cells that were added recently (Column E). But, when I clicked on the new added cells, I cannot see the borders on focused around the cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/risIX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/risIX.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BF2zB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BF2zB.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the first image, in cell E8, I can see a border (colored green) when i clicked it. But, on the second cell, on E7, I cant see the border. This is important for me to serve as a guide for the user. </p>\n\n<p>Any suggestion? thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1448438977, "post_id": 33909656, "comment_id": 55584601, "body": "(1) What is CTPT and why do you need it, where is it used, etc? (2) What exactly (more specifically than what you&#39;ve said so far) do you want to copy and where do you want to paste it?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1448439014, "post_id": 33909656, "comment_id": 55584618, "body": "Can you explain &quot;I need to insert an row by finding the cell address of the clicked button&quot; a bit more plz? Do you meant to insert a row before the clicked button?"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1448440898, "post_id": 33909656, "comment_id": 55585637, "body": "\u201cCTPT\u201d is the unique id which is maintained for each and every product. If I need to have one More copy of the similar product then these are the steps which I am following. I will find the cell address of the \u201cCTPT\u201d and by keeping the reference of it I will copy all the parameters which belongs to that particular product. Then I will select the cell address of the ADD button, by keeping the reference of it I will add one more row first and then I will insert the copied data by selecting the second column of the newly inserted row. Now I have the duplicate of the Product Details"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1448441306, "post_id": 33911431, "comment_id": 55585868, "body": "Thanks for your help @R3uK, experimented with my code by doing some slight modification and it worked, i have posted the code below"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1448439393, "creation_date": 1448439393, "answer_id": 33911431, "question_id": 33909656, "link": "https://stackoverflow.com/questions/33909656/how-to-copy-the-data-form-the-specified-address-and-copy-it-to-the-next-specifie/33911431#33911431", "title": "How to copy the Data form the Specified address and copy it to the next specified location using excel vba", "body": "<pre><code>Sub test_Karthik()\nDim WbEPC As Workbook, _\n    WbCPT As Workbook, _\n    WsEPC As Worksheet, _\n    WsCPT As Worksheet, _\n    FirstAddress As String, _\n    WriteRow As Long, _\n    cF As Range, _\n    num As String\n\nSet WbEPC = Workbooks(\"EPC 1.xlsx\")\nSet WbCPT = Workbooks(\"Control Power Transformers.xlsm\")\nSet WsEPC = WbEPC.Sheets(\"Sheet1\")\nSet WsCPT = WbCPT.Sheets(\"Sheet2\")\n\nWith WsEPC\n    .Activate\n    With .Range(\"A1:A10000\")\n    'First, define properly the Find method\n        Set cF = .Find(What:=\"CTPT\", _\n                    After:=ActiveCell, _\n                    LookIn:=xlValues, _\n                    Lookat:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False, _\n                    SearchFormat:=False)\n\n        'If there is a result, keep looking with FindNext method\n        If Not cF Is Nothing Then\n            FirstAddress = cF.Address\n            Do\n                num = cF.Address ' Here we will the get the cell address of CTPT ($A$14)\n                WsEPC.Range(cF.Offset(0, 1).End(xlUp), cF.Offset(0, 3).End(xlDown)).Copy\n                WriteRow = WsCPT.Range(\"E\" &amp; WsCPT.Rows.Count).End(xlUp).Row + 1\n                WsCPT.Range(\"E\" &amp; WriteRow).PasteSpecial (xlPasteValues)\n\n                cF.EntireRow.Insert xlDown, False\n\n\n                Set cF = .FindNext(cF)\n            'Look until you find again the first result\n            Loop While Not cF Is Nothing And cF.Address &lt;&gt; FirstAddress\n        End If\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4199, "user_id": 871150, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/17a36fa05368aad5f5a353920af0c02a?s=128&d=identicon&r=PG", "display_name": "Novocaine", "link": "https://stackoverflow.com/users/871150/novocaine"}, "edited": false, "score": 0, "creation_date": 1449583561, "post_id": 33911933, "comment_id": 56062490, "body": "For a code block this size you really need to add some kind of explanation as to what you&#39;ve done and why."}], "tags": [], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1448441211, "creation_date": 1448441211, "answer_id": 33911933, "question_id": 33909656, "link": "https://stackoverflow.com/questions/33909656/how-to-copy-the-data-form-the-specified-address-and-copy-it-to-the-next-specifie/33911933#33911933", "title": "How to copy the Data form the Specified address and copy it to the next specified location using excel vba", "body": "<pre><code>Private Sub CommandButton21_Click()\n\n\n\n\nDim WbEPC As Workbook, _\nWbCPT As Workbook, _\nWsEPC As Worksheet, _\nWsCPT As Worksheet, _\nFirstAddress As String, _\nWriteRow As Long, _\ncF As Range, _\nnum As String\n\nSet WbEPC = Workbooks(\"EPC 1.xlsm\")\nSet WbCPT = Workbooks(\"Control Power Transformers.xlsm\")\nSet WsEPC = WbEPC.Sheets(\"Sheet1\")\nSet WsCPT = WbCPT.Sheets(\"Sheet1\")\n\nDim b As Object, RowNumber As Integer\nSet b = ActiveSheet.Shapes(\"CommandButton21\")\nWith b.TopLeftCell\n    RowNumber = .Row\nEnd With\n\n\n Rows(RowNumber + 1 &amp; \":\" &amp; RowNumber + 1).Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n\n\n\n\n    With WsEPC\n    .Activate\n    With .Range(\"A1:A10000\")\n\nSet cF = .Find(what:=\"CTPT\", _\n    lookat:=xlPart, searchorder:=xlByRows, searchdirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\n            num = cF.Address ' Here we will the get the cell address of CTPT ($A$14)\n            WsEPC.Range(cF.Offset(-1, 3), cF.Offset(-1, 1).End(xlDown)).Copy\n            WsEPC.Range(\"B\" &amp; RowNumber + 1).Select\n\n\n                Selection.Insert Shift:=xlDown\n                Application.CutCopyMode = False\n\nEnd With\nEnd With\n\nMsgBox \" Successfully added the product to EPC\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448441211, "creation_date": 1448432181, "last_edit_date": 1448438288, "question_id": 33909656, "link": "https://stackoverflow.com/questions/33909656/how-to-copy-the-data-form-the-specified-address-and-copy-it-to-the-next-specifie", "title": "How to copy the Data form the Specified address and copy it to the next specified location using excel vba", "body": "<p>I have a worksheet which contains the details of the each product.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NaYzU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NaYzU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here i have crested a button (ADD), by clicking on it i want to copy all the details of the CONTROL POWER TRANSFORMERS block and copy it to below (i mean copy it from B20).</p>\n\n<p>I have written a code to pinpoint the CTPT (which is the unique id for that product) keeping it as a reference i have copied whole block till the row ends using the below code.</p>\n\n<pre><code>Set cF = .Find(what:=\"CTPT\", _\n    lookat:=xlPart, searchorder:=xlByRows, searchdirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\nnum = cF.Address ' Here we will the get the cell address of CTPT ($A$14)\n            WsEPC.Range(cF.Offset(-1, 3), cF.Offset(-1, 1).End(xlDown)).Copy\n</code></pre>\n\n<p>Now while pasting the cell i need to do couple of things</p>\n\n<ol>\n<li><p>I need to insert an row by finding the cell address of the clicked button  </p></li>\n<li><p>Paste the copied Data</p></li>\n</ol>\n\n<p>Code any one help me out in achieving these couple of task.\nAny help is Appreciated!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 4981, "user_id": 1249131, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/XtYlU.jpg?s=128&g=1", "display_name": "Viraj Dhamal", "link": "https://stackoverflow.com/users/1249131/viraj-dhamal"}, "edited": false, "score": 0, "creation_date": 1448434332, "post_id": 33909465, "comment_id": 55582376, "body": "Are u using interop.Excel.dll for excel operation in your project?"}, {"owner": {"reputation": 23, "user_id": 704614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/529332a5f1df2e3961208acf088db7f4?s=128&d=identicon&r=PG", "display_name": "user704614", "link": "https://stackoverflow.com/users/704614/user704614"}, "reply_to_user": {"reputation": 4981, "user_id": 1249131, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/XtYlU.jpg?s=128&g=1", "display_name": "Viraj Dhamal", "link": "https://stackoverflow.com/users/1249131/viraj-dhamal"}, "edited": false, "score": 0, "creation_date": 1448440792, "post_id": 33909465, "comment_id": 55585569, "body": "no idea what that is to be honest, just using formulas to calculate everything"}, {"owner": {"reputation": 583, "user_id": 2286964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca11e109f5f3e0877a0ab858f33c3d4c?s=128&d=identicon&r=PG", "display_name": "Alan Waage", "link": "https://stackoverflow.com/users/2286964/alan-waage"}, "edited": false, "score": 0, "creation_date": 1448655397, "post_id": 33909465, "comment_id": 55685872, "body": "So if the plan date is &gt; the pay date that has an X, pull in the amount?  Not sure I follow the logic rule you need.  You likely will benefit from the cell function hlookup.  <a href=\"http://www.techonthenet.com/excel/formulas/hlookup.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/hlookup.php</a>"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1450103439, "post_id": 33909465, "comment_id": 56280156, "body": "Yeah I&#39;m with Alan on this, an Hlookup or an Index/Match would be what I&#39;d use, but I&#39;m not entirely sure I&#39;m following"}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 5749709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8647f5aace4f9e2cfb01a267bf9d1fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton Morris", "link": "https://stackoverflow.com/users/5749709/clayton-morris"}, "is_accepted": false, "score": 0, "last_activity_date": 1452557773, "creation_date": 1452557773, "answer_id": 34733506, "question_id": 33909465, "link": "https://stackoverflow.com/questions/33909465/excel-retrieve-value-of-specific-cell-in-column-based-off-of-date/34733506#34733506", "title": "EXCEL - retrieve value of specific cell in column based off of date", "body": "<p>If I understand what you want to accomplish correctly, your dates on the first worksheet (E3, F3, etc) need to be changed to Thursday dates - they are Wed dates right now.Also, you need the descriptions in column B of the first sheet to exactly match the descriptions in column A of the second sheet. This is why accountants like to use account numbers instead of account descriptions when possible.\nIf you change those here are your formulas:</p>\n\n<p>Second sheet cell A2 - =IF(WEEKDAY(A3)&lt;=5,A3+5-WEEKDAY(A3),A3-WEEKDAY(A3)+7+5). This checks the day of week of the current date then adds days as needed. It seems like there might be an easier way to get this.</p>\n\n<p>Second sheet cells B6, B7, B8, B10 ,etc = =IF(HLOOKUP(A10,$F$4:$J$8,MATCH(A12,$D$5:$D$8,0)+1,FALSE)=\"x\",VLOOKUP(A12,$D$5:$E$8,2,FALSE),\"\"), The hlookup determines if there is an \"x\" in the current week and the vlookup pulls the amount from the correct line.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qsxHZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qsxHZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 704614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/529332a5f1df2e3961208acf088db7f4?s=128&d=identicon&r=PG", "display_name": "user704614", "link": "https://stackoverflow.com/users/704614/user704614"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452557773, "creation_date": 1448431284, "last_edit_date": 1448433496, "question_id": 33909465, "link": "https://stackoverflow.com/questions/33909465/excel-retrieve-value-of-specific-cell-in-column-based-off-of-date", "title": "EXCEL - retrieve value of specific cell in column based off of date", "body": "<p>My question is as follows:</p>\n\n<p>I have an excel workbook with two worksheets.  The first worksheet has my bills listed in rows, and paydates in columns.  The second worksheet has a weekly cashflow plan with spots corresponding to various bills in the first.</p>\n\n<p>I would like the cash flow worksheet to update the cell to the dollar value of the bill if its due.  I have attached a link to my box with the excel file. Screen shots are below as well.  In the screenshot examples, for instance, i would like the Electricity Cell in Cash flow sheet to Show $238 since the Electricity in the Bills sheet for the current week has an X in that location.</p>\n\n<p><a href=\"https://app.box.com/s/o10nu3ac7vm0wb0yoboet9lwq1qyophk\" rel=\"nofollow noreferrer\">Excel Workbook</a></p>\n\n<p>Any help that can be provided would be greatly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vK18s.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vK18s.jpg\" alt=\"Bills Sheet\"></a>\n<a href=\"https://i.stack.imgur.com/Mx00P.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mx00P.jpg\" alt=\"Cash Flow Sheet\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 1, "creation_date": 1448429662, "post_id": 33909083, "comment_id": 55580582, "body": "See this for instructions:  <a href=\"http://stackoverflow.com/a/1099570/122139\">stackoverflow.com/a/1099570/122139</a>.  The important thing is to use <code>Debug.Print</code> to put the final version of your query in the Immediate window; from there you can take it ordinary query builder and start trouble shooting."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1448449742, "post_id": 33909083, "comment_id": 55591269, "body": "Great link and answer @Smandoli. Goes straight to bookmarks and I&#39;m never gonna have to type this stuff again. :)"}], "answers": [{"tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": true, "score": 1, "last_activity_date": 1448429834, "creation_date": 1448429834, "answer_id": 33909159, "question_id": 33909083, "link": "https://stackoverflow.com/questions/33909083/access-run-time-error-3134/33909159#33909159", "title": "Access Run-time Error 3134", "body": "<p>Remove the first <code>&amp;</code> in this line:</p>\n\n<pre><code>\"VALUES &amp; (\" &amp; _\n</code></pre>\n\n<p>So it is:</p>\n\n<pre><code>\"VALUES (\" &amp; _\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1448444937, "creation_date": 1448444937, "answer_id": 33913222, "question_id": 33909083, "link": "https://stackoverflow.com/questions/33909083/access-run-time-error-3134/33913222#33913222", "title": "Access Run-time Error 3134", "body": "<p>Further, hardly all values are text, thus:</p>\n\n<pre><code>\"#\" &amp; Format(Me.txt_tDate, \"yyyy\\/mm\\/dd\") &amp; \"#, \" &amp; _\n\"'\" &amp; Me.cmb_Category &amp; \"', \" &amp; _\n\"\" &amp; Str(txt_TransAmount) &amp; \", \" &amp; _\n\"'\" &amp; Me.txt_transDescription &amp; \"' \" &amp; _\n</code></pre>\n\n<p>where Str will convert a decimal value to a string with dot as the decimal separator.</p>\n"}], "owner": {"reputation": 3, "user_id": 5138613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ddaef14764d8f3a67b097f904daff3e?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5138613/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 33909159, "answer_count": 2, "score": 0, "last_activity_date": 1448444937, "creation_date": 1448429405, "last_edit_date": 1448429867, "question_id": 33909083, "link": "https://stackoverflow.com/questions/33909083/access-run-time-error-3134", "title": "Access Run-time Error 3134", "body": "<p>I have the following code that I have read and made changes to for the last 3 hours and just can seam to get it working.</p>\n\n<p>The error I get is \"Syntax error in INSERT INTO statement\"</p>\n\n<pre><code>Private Sub AddRecord_Click()\n\n'Add the form details to the table\n\nCurrentDb.Execute \"INSERT INTO (Transactions (tDate,  category, transAmount, transDescription) \" &amp; _\n    \"VALUES &amp; (\" &amp; _\n    \"'\" &amp; Me.txt_tDate &amp; \"', \" &amp; _\n    \"'\" &amp; Me.cmb_Category &amp; \"', \" &amp; _\n    \"'\" &amp; txt_TransAmount &amp; \"', \" &amp; _\n    \"'\" &amp; Me.txt_transDescription &amp; \"' \" &amp; _\n    \")\"\n\n\nEnd Sub\n</code></pre>\n\n<p>The form has 4 fields as above with the tDate being set to Date() by default and all others as short text or number.</p>\n\n<p>Any advice welcome.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5602534, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e72daff73f6eac3a0de77d953ff1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sijie Shao", "link": "https://stackoverflow.com/users/5602534/sijie-shao"}, "edited": false, "score": 0, "creation_date": 1448429073, "post_id": 33908713, "comment_id": 55580367, "body": "Hi Scott. Thank you so much for your answer. It actually have values appears.  But the problem is It is the same value for all the roles.  What I want is for each row, there are new values.   Every time when I refresh the excel, The values inside B5:AE5 will changes.  Basically,  I want to record 1000 times of the B5:AE5 values.  Each row should be different."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 51, "user_id": 5602534, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e72daff73f6eac3a0de77d953ff1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sijie Shao", "link": "https://stackoverflow.com/users/5602534/sijie-shao"}, "edited": false, "score": 0, "creation_date": 1448429292, "post_id": 33908713, "comment_id": 55580442, "body": "so new random values for each row? is there an upper / lower limit to the values? or do you have some sort of <i>definition</i> to the randomness?"}, {"owner": {"reputation": 51, "user_id": 5602534, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e72daff73f6eac3a0de77d953ff1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sijie Shao", "link": "https://stackoverflow.com/users/5602534/sijie-shao"}, "edited": false, "score": 0, "creation_date": 1448429985, "post_id": 33908713, "comment_id": 55580689, "body": "Yes, different random value each row.  There are another table I created.  With IF and RNAD function, every time I refresh the sheet, 30 interest rates will be generate( between 3%-8%),  those interest rate will calculate 30 NPV.   I copy those 30 NPV to the new table as first role.  By using the VBA code, I want to have 1000 row of those 30 NPV. Every role will be different NPV.  Can you understand what I talked about? It may be a little bit messy."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 51, "user_id": 5602534, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e72daff73f6eac3a0de77d953ff1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sijie Shao", "link": "https://stackoverflow.com/users/5602534/sijie-shao"}, "edited": false, "score": 0, "creation_date": 1448458037, "post_id": 33908713, "comment_id": 55596465, "body": "@SijieShao - It&#39;s still a little unclear. If you want 1000 rows of random numbers then the <code>InputBox</code> to set trail is not needed correct? For the 1000 rows of 30 random NPVs can you just use the <code>RAND</code> Function or <code>RANDBETWEEN</code>?"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1448428988, "last_edit_date": 1448428988, "creation_date": 1448427322, "answer_id": 33908713, "question_id": 33908630, "link": "https://stackoverflow.com/questions/33908630/vba-why-endxldown-will-take-me-to-the-very-bottom-of-my-excel/33908713#33908713", "title": "VBA- Why End(xlDown) will take me to the very bottom of my excel", "body": "<p>To answer your question about why your <code>End(xlDown)</code> takes you to the end of the sheet, the <code>Selection.End(xlDown).Select</code> is similar to pressing <code>Ctrl+Down</code> on the spreadsheet. <em>(Likewise <code>Selection.End(xlToRight)).Select</code> is similar to pressing Ctrl+Right.)</em></p>\n\n<p>Hence if you are on an empty sheet, or if all the cells beneath the active (or referenced) cell are empty, then pressing <code>Ctrl+Down</code> will bring you to the last row.</p>\n\n<p>All that said, you can avoid that whole issue and improve your code significantly by </p>\n\n<ul>\n<li>Removing all the <code>Select</code> statements and work directly with the range objects. </li>\n<li>Using the defined range (B5:AE5) since you know what it is. </li>\n<li>Just using the counter to resize the range to to paste the values and formats (and eliminate the loop).</li>\n</ul>\n\n<p>See the code below:</p>\n\n<pre><code>Sub Macros()\n\nDim trail As Long\ntrail = InputBox(\"Enter the number of time you want to simulate this Macros\", \"Macros\", \"10\")\n\nWith Range(Range(\"B5\"), Range(\"AE5\"))\n     .Copy\n     .Offset(1).Resize(trail - 1, 30).PasteSpecial xlPasteValues\n     .Offset(1).Resize(trai1 - 1, 30).PasteSpecial xlPasteFormats\nEnd With\n\nWith Range(\"A5\")\n     .Copy .Offset(1).Resize(trail - 1)\nEnd With\n\n'if you don't need to copy the formats you can change the above With statements to just this:\n\n'With Range(\"A5:BE5\")\n'     .Offset(i).Resize(trail - 1,31).Value = .Value\n'End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1448432325, "creation_date": 1448432325, "answer_id": 33909682, "question_id": 33908630, "link": "https://stackoverflow.com/questions/33908630/vba-why-endxldown-will-take-me-to-the-very-bottom-of-my-excel/33909682#33909682", "title": "VBA- Why End(xlDown) will take me to the very bottom of my excel", "body": "<p>It sounds like you want to place formulas in the selected number of rows.</p>\n\n<pre><code>Sub Frmla()\n    Dim i As Long\n    i = InputBox(\"enter Number\")\n    Range(\"B6:AE\" &amp; 5 + i).FormulaR1C1 = \"=R[-1]C*0.7\"'whatever the formula is\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5602534, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e72daff73f6eac3a0de77d953ff1b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sijie Shao", "link": "https://stackoverflow.com/users/5602534/sijie-shao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2457, "favorite_count": 0, "accepted_answer_id": 33908713, "answer_count": 2, "score": 1, "last_activity_date": 1448432325, "creation_date": 1448426761, "question_id": 33908630, "link": "https://stackoverflow.com/questions/33908630/vba-why-endxldown-will-take-me-to-the-very-bottom-of-my-excel", "title": "VBA- Why End(xlDown) will take me to the very bottom of my excel", "body": "<p>The assignment requires me to run the Monte Carlo result 1000 times. I already create a row of 30 years values(B5:AE5), and I want to repeat the process 1000 times. Every time, there will be a new row comes out, and all the values will be random. </p>\n\n<p>Below is my code, for some reason, it will go to the very bottom of my excel sheet. I want the second row of 30 years values inside (B6:AE6). </p>\n\n<pre><code>Sub Macros()\f\nDim trail As Long\ntrail = InputBox(\"Enter the number of time you want to simulate this Macros\", \"Macros\", \"10\")\n\nFor i = 1 To trail\nApplication.CutCopyMode = False\nRange(\"B5\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\nSelection.End(xlDown).Select\nSelection.Offset(-1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n       :=False, Transpose:=False\nSelection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n       SkipBlanks:=False, Transpose:=False\nRange(\"A4\").Select\nSelection.End(xlDown).Select\nSelection.Copy\nSelection.Offset(1, 0).Select\nActiveSheet.Paste\nApplication.CutCopyMod = False\nNext i\nRange(\"B4\").Select\nEnd Sub \n</code></pre>\n\n<p>Thank you sooo much! </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1982, "user_id": 2638872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc7c0a9f7819f2f487411dc7df04020?s=128&d=identicon&r=PG&f=1", "display_name": "mrtig", "link": "https://stackoverflow.com/users/2638872/mrtig"}, "edited": false, "score": 0, "creation_date": 1448420729, "post_id": 33907726, "comment_id": 55578123, "body": "Have you tried <code>sumifs</code>?"}, {"owner": {"reputation": 1, "user_id": 5602309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e98940c37ef4137e035ca675313391a?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Ballesteros", "link": "https://stackoverflow.com/users/5602309/gustavo-ballesteros"}, "reply_to_user": {"reputation": 1982, "user_id": 2638872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc7c0a9f7819f2f487411dc7df04020?s=128&d=identicon&r=PG&f=1", "display_name": "mrtig", "link": "https://stackoverflow.com/users/2638872/mrtig"}, "edited": false, "score": 0, "creation_date": 1448421919, "post_id": 33907726, "comment_id": 55578423, "body": "Not yet, does it works in a different way tan SumIf"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1448424224, "post_id": 33907726, "comment_id": 55578990, "body": "The code which is producing the incorrect sum is using slightly differently named ranges. The original code has <code>Range(&quot;Test_FecFinCup&quot;)</code> as the first range whereas the incorrect code uses <code>Set Rango1 = .Range(&quot;Test_FecIniCup&quot;)</code> Is this intentional?"}, {"owner": {"reputation": 1, "user_id": 5602309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e98940c37ef4137e035ca675313391a?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Ballesteros", "link": "https://stackoverflow.com/users/5602309/gustavo-ballesteros"}, "edited": false, "score": 0, "creation_date": 1448556849, "post_id": 33907726, "comment_id": 55646521, "body": "Can&#180;t believe I let it pass, I feel so dumb.  Thank you very much barrowc thats were I was wrong.  And thanks also to all that who took time to read this post."}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1448433669, "creation_date": 1448433669, "answer_id": 33910003, "question_id": 33907726, "link": "https://stackoverflow.com/questions/33907726/use-of-sumif-function-with-range-object-or-arrays/33910003#33910003", "title": "Use of SumIf function with range object or arrays", "body": "<p>It seems that you try to sum a range of numbers using a range of criteria:</p>\n\n<pre><code>WorksheetFunction.SumIf(Arr_FecFinCup, Arr_FecFlujos(i), Arr_MtoCup)\n</code></pre>\n\n<p>As i know, if the criteria parameter is given a range, Excel don't iterate over that range but instead look for the one value in the criteria_range that coincides with the row of the cell that it is calculating.</p>\n\n<p>For example</p>\n\n<pre><code>Range(\"D3\") = WorksheetFunction.SumIf(Range(\"A1:A10\"),Range(\"B1:B10\"))\n</code></pre>\n\n<p>Excel will actually calculate as follow </p>\n\n<pre><code>Range(\"D3\") = WorksheetFunction.SumIf(Range(\"A1:A10\"),Range(\"B3\"))\n</code></pre>\n\n<p>If there is no coincident, then the return is 0</p>\n\n<p>For example</p>\n\n<pre><code>Range(\"D7\") = WorksheetFunction.SumIf(Range(\"A1:A10\"),Range(\"B1:B5\"))\n</code></pre>\n\n<p>Then D7 is always 0 because looking for [B7] in [B1:B5] is out of range.</p>\n\n<p>Therefore, to do a sum with multiple criterias, the correct way is using SUMIFS as suggested by @mrtiq.</p>\n"}], "owner": {"reputation": 1, "user_id": 5602309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e98940c37ef4137e035ca675313391a?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Ballesteros", "link": "https://stackoverflow.com/users/5602309/gustavo-ballesteros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448433669, "creation_date": 1448419913, "last_edit_date": 1448420642, "question_id": 33907726, "link": "https://stackoverflow.com/questions/33907726/use-of-sumif-function-with-range-object-or-arrays", "title": "Use of SumIf function with range object or arrays", "body": "<p>I'm am trying to optimize a sub that uses Excel\u00b4s sumif function since it takes several time to finish.</p>\n\n<p>The specific line (contained in to a for loop) is this one:</p>\n\n<pre><code>Cupones = Application.WorksheetFunction.SumIf(Range(\"Test_FecFinCup\"), Arr_FecFlujos(i), Range(\"Test_MtoCup\"))\n</code></pre>\n\n<p>Where the ranges are named ranges in the workbook, and Arr_FecFlujos() is an array of dates </p>\n\n<p>That, code works fine, except for it takes to much time to finish.</p>\n\n<p>I am trying this two approaches\nArrays:</p>\n\n<p>Declare my arrays</p>\n\n<pre><code>With Test\n  Fluj = .Range(Range(\"Test_Emision\").Cells(2, 1), Range(\"Test_Emision\").Cells(2, 1).End(xlDown)).Rows.Count\n  Arr_FecFinCup = .Range(\"Test_FecFinCup\")\n  Arr_MtoCup = .Range(\"Test_MtoCup\")\nEnd With\n\nCupones = Application.WorksheetFunction.SumIf(Arr_FecFinCup, Arr_FecFlujos(i), Arr_MtoCup)\n</code></pre>\n\n<p>Error tells me I need to work with Range Objects, so I changed to:</p>\n\n<pre><code>With Test\n Set Rango1 = .Range(\"Test_FecIniCup\")\n Set Rango2 = .Range(\"Test_MtoCup\")\nEnd With\n\nCupones = Application.WorksheetFunction.SumIf(Rango1, Arr_FecFlujos(i), Rango2)\n</code></pre>\n\n<p>That one, doesn't shows any error messages, but the sum is incorrect.</p>\n\n<p>Can anybody tell me what's working wrong with these methods and perhaps point me in the correct direction?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1448460386, "post_id": 33907330, "comment_id": 55598184, "body": "Your <code>strSql</code> is literally only the text &quot;SELECT LastName From Patient WHERE PatientID = 1&quot; and not the executed result of the query it describes. Using the <code>DLOOKUP</code> function as @Emi has suggested is the simpler approach for what you&#39;re trying to do here."}, {"owner": {"reputation": 47, "user_id": 4848228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8daf5b9ea98ec616917dcaa8212307d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4848228/kyle"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1448474722, "post_id": 33907330, "comment_id": 55607962, "body": "I know DLookup but I need to use SQL because the queries will get more complex. Is there a way to do this?"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1448478335, "post_id": 33907330, "comment_id": 55609995, "body": "Oh ok, see answer below."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4848228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8daf5b9ea98ec616917dcaa8212307d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4848228/kyle"}, "edited": false, "score": 0, "creation_date": 1448474699, "post_id": 33907579, "comment_id": 55607948, "body": "I know DLookup but I need to use SQL because the queries will get more complex. Is there a way to do this?"}], "tags": [], "owner": {"reputation": 474, "user_id": 5060720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/56fc8ec996b9fe62716185a2ba353693?s=128&d=identicon&r=PG&f=1", "display_name": "Emi", "link": "https://stackoverflow.com/users/5060720/emi"}, "is_accepted": false, "score": 3, "last_activity_date": 1448418878, "creation_date": 1448418878, "answer_id": 33907579, "question_id": 33907330, "link": "https://stackoverflow.com/questions/33907330/run-sql-from-vba-button/33907579#33907579", "title": "Run SQL from VBA button", "body": "<p>You can use <code>DLookup</code> function.</p>\n\n<pre><code>Me.txtDisease1.Value = DLookup(\"LastName\", \"Patient\", \"PatientID = 1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1448470854, "creation_date": 1448470854, "answer_id": 33922324, "question_id": 33907330, "link": "https://stackoverflow.com/questions/33907330/run-sql-from-vba-button/33922324#33922324", "title": "Run SQL from VBA button", "body": "<p>For more complex lookups or to hit other data sources, you can use ADO (requires reference to Microsoft Active X Data Objects)</p>\n\n<pre><code>Dim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nrs.Open \"SELECT TOP 1 LastName From Patient WHERE PatientID=1\", _\n    CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly\nIf Not rs.EOF Then Me.txtDisease1.Value = rs(0)\nrs.Close\nSet rs = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "is_accepted": false, "score": 2, "last_activity_date": 1448478314, "creation_date": 1448478314, "answer_id": 33924528, "question_id": 33907330, "link": "https://stackoverflow.com/questions/33907330/run-sql-from-vba-button/33924528#33924528", "title": "Run SQL from VBA button", "body": "<p>I've not been able to test this, but I think this should work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btnDNA_Click()\n\n    Dim strSQL As String\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n\n    strSQL = \"SELECT LastName From Patient WHERE PatientID = 1\"\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(strSQL)\n\n    Me.txtDisease1 = rs!LastName\n\n    rs.close\n    Set rs = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4848228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8daf5b9ea98ec616917dcaa8212307d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4848228/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1594643139, "creation_date": 1448417079, "last_edit_date": 1594643139, "question_id": 33907330, "link": "https://stackoverflow.com/questions/33907330/run-sql-from-vba-button", "title": "Run SQL from VBA button", "body": "<p>What do I need to add/modify to this code to have txtDisease1 be populated with the results of strSQL? As of now the textbox populates with the SQL query. I'm sure it is a simple fix but for the life of me I can not find the answer. </p>\n\n<pre><code>Private Sub btnDNA_Click()\nDim strSQL As String\n\nstrSQL = \"SELECT LastName From Patient WHERE PatientID = 1\"\nMe.txtDisease1.Value = strSQL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1448417336, "post_id": 33907332, "comment_id": 55577306, "body": "Its working fine, is it possible to clear all the contents except for first 3 columns and the entire first row?  I cleared all whole excel sheet except for the first row suing the below code      Rows(1).Offset(1, 0).Resize(Rows.Count - 1).ClearContents  How can it be merged with your code so that i can accomplish both the task at the one shot"}, {"owner": {"reputation": 2939, "user_id": 4320738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47f691b009d906bf13e2e6c0fb1451?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/4320738/munir"}, "reply_to_user": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1448417493, "post_id": 33907332, "comment_id": 55577347, "body": "<code>Range(&quot;D2:XFD1048576&quot;)</code> I would suggest you look up the documentation on <code>Range</code> object at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff838238.aspx</a>. StackOverflow is not really a code writing service, although we try our best to help."}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1448417731, "post_id": 33907332, "comment_id": 55577405, "body": "Thanks a lot @municontractor Its working just as i expected. Have a good day ahead!"}], "tags": [], "owner": {"reputation": 2939, "user_id": 4320738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47f691b009d906bf13e2e6c0fb1451?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/4320738/munir"}, "is_accepted": true, "score": 0, "last_activity_date": 1448417085, "creation_date": 1448417085, "answer_id": 33907332, "question_id": 33907277, "link": "https://stackoverflow.com/questions/33907277/how-to-delete-the-columns-except-the-first-three-columns/33907332#33907332", "title": "How to delete the columns except the first three columns?", "body": "<p>To remove formula and values use:</p>\n\n<pre><code>Range(\"D:XFD\").ClearContents\n</code></pre>\n\n<p>To remove formula, values and formatting, use:</p>\n\n<pre><code>Range(\"D:XFD\").Clear\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "closed_date": 1449571782, "accepted_answer_id": 33907332, "answer_count": 1, "score": -1, "last_activity_date": 1448418062, "creation_date": 1448416733, "last_edit_date": 1448418062, "question_id": 33907277, "link": "https://stackoverflow.com/questions/33907277/how-to-delete-the-columns-except-the-first-three-columns", "closed_reason": "Needs more focus", "title": "How to delete the columns except the first three columns?", "body": "<p>I have a worksheet where after all the operations are done I want to clear all the contents except in first three columns (A, B, C).  </p>\n\n<p>Is it possible to achieve using VBA?</p>\n"}, {"tags": ["excel", "vba", "find", "range"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5602091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468b115dc119c73565804aa015c13236?s=128&d=identicon&r=PG&f=1", "display_name": "S.G. Uncle", "link": "https://stackoverflow.com/users/5602091/s-g-uncle"}, "edited": false, "score": 0, "creation_date": 1448755082, "post_id": 33907384, "comment_id": 55712101, "body": "Thanks David. As you said, my mistake was not using &quot;set&quot;. Now it works.  But what do I do when I have merged cells? When it runs into a merged cell and tries to clear the contents of the cell, I get a run-time error. The error reads &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;. Any ideas on how to deal with this?  Lastly, my ultimate goal is not just to delete cells that say &quot;Retail&quot;, but to delete all formatted cells with any contents whatsoever. So what should I specify - something like:      find(what:=not(&quot;&quot;), SearchFormat:=True)  Thanks again for your help!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3, "user_id": 5602091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468b115dc119c73565804aa015c13236?s=128&d=identicon&r=PG&f=1", "display_name": "S.G. Uncle", "link": "https://stackoverflow.com/users/5602091/s-g-uncle"}, "edited": false, "score": 0, "creation_date": 1448755433, "post_id": 33907384, "comment_id": 55712166, "body": "Try <code>find(what=&quot;*&quot;...</code>. Also try <code>myrange.mergearea.clearcontents</code> or <code>myrange.cells(1,1).clearcontents</code>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1448417396, "creation_date": 1448417396, "answer_id": 33907384, "question_id": 33906958, "link": "https://stackoverflow.com/questions/33906958/how-to-set-a-range-using-the-find-function/33907384#33907384", "title": "How to set a range using the find function", "body": "<p>I refer to the FindFormat documentation for some example:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff838023.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff838023.aspx</a></p>\n\n<p>And modify your code thusly:</p>\n\n<pre><code>With Application.FindFormat\n    .Interior.Color = inputCell\n    Do\n        Set myRange = mySheet.Cells.Find(what:=\"Retail\", SearchFormat:=True)\n        If myRange Is Nothing Then myRange.ClearContents\n    Loop While Not myRange Is Nothing\nEnd With\n</code></pre>\n\n<p><strong>NOTE</strong>: You should be using the <code>Set</code> keyword when assigning to a range object <code>myRange</code>.  Also, your improper use of <code>On Error Resume Next</code> may be masking additional errors which are adversely impacting the results of this function.  You can rectify the latter issue like so:</p>\n\n<pre><code>            If Not IsEmpty(wb.LinkSources(xlExcelLinks)) Then\n                For Each link In wb.LinkSources(xlExcelLinks)\n                    On Error Resume Next\n                    wb.ChangeLink name:=link, newName:=pathName, Type:=xlLinkTypeExcelLinks\n                    On Error GoTo 0  '### RESUME NORMAL ERROR HANDLING\n                Next link\n            End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5602091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468b115dc119c73565804aa015c13236?s=128&d=identicon&r=PG&f=1", "display_name": "S.G. Uncle", "link": "https://stackoverflow.com/users/5602091/s-g-uncle"}, "is_accepted": false, "score": 0, "last_activity_date": 1448817533, "creation_date": 1448817533, "answer_id": 33985618, "question_id": 33906958, "link": "https://stackoverflow.com/questions/33906958/how-to-set-a-range-using-the-find-function/33985618#33985618", "title": "How to set a range using the find function", "body": "<p>I changed my code as follows and now it works exactly as I wanted:</p>\n\n<pre><code>                For Each mySheet In ActiveWorkbook.Worksheets\n\n                    With Application.FindFormat\n                        .Interior.Color = inputCell\n\n                        Do\n                            On Error GoTo handler:\n                            Set myRange = mySheet.Cells.Find(what:=\"?*\", searchformat:=True).MergeArea\n                            If Not (myRange Is Nothing) Then\n                                myRange.ClearContents\n                            End If\n                        Loop While Not (myRange Is Nothing)\n\n                        .Interior.Color = noteCell\n\n                        Do\n                            On Error GoTo handler:\n                            Set myRange = mySheet.Cells.Find(what:=\"?*\", searchformat:=True).MergeArea\n                            If Not (myRange Is Nothing) Then\n                                myRange.ClearContents\n                            End If\n                        Loop While Not (myRange Is Nothing)\n\nhandler:\nSet myRange = Nothing\nResume Next\n\n                    End With\n\n                Next mySheet\n</code></pre>\n\n<p>I'm just not sure if this kind of error handling is the best way to deal with the problem, and I don't understand why an error occurs in the first place. So if anyone has a thought on this, I would appreciate it. If not, I'm just happy it works now.</p>\n"}], "owner": {"reputation": 3, "user_id": 5602091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468b115dc119c73565804aa015c13236?s=128&d=identicon&r=PG&f=1", "display_name": "S.G. Uncle", "link": "https://stackoverflow.com/users/5602091/s-g-uncle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 33907384, "answer_count": 2, "score": 0, "last_activity_date": 1448817658, "creation_date": 1448414600, "last_edit_date": 1448817658, "question_id": 33906958, "link": "https://stackoverflow.com/questions/33906958/how-to-set-a-range-using-the-find-function", "title": "How to set a range using the find function", "body": "<p>I have a stylized spreadsheet with formatted cells for users to input data. I am trying to create a macro for use with a button to clear all of the input cells at once. However, I am struggling with the \"find\" and \"findformat\" functions.</p>\n\n<p>To make it simple, in this code I am just looking for cells that say \"Retail\". When I run the code, the value of myRange is always Nothing even though there is clearly a cell in the spreadsheet that has the value \"Retail\". Any ideas why the range is Nothing?</p>\n\n<pre><code>    Public Sub reset()\n    'reset all input fields to no value\n    msg = MsgBox(\"Are you sure you want to delete all data and reset all files to original state?\", vbYesNoCancel, \"***Warning***\")\n    If msg = vbYes Then\n\nDim inputCell As Long\nDim noteCell As Long\ninputCell = RGB(255, 204, 153)\nnoteCell = RGB(255, 255, 204)\n\nDim myRange As Range\nDim mySheet As Worksheet\n\nDim shp As Shape\nDim sht As Worksheet\nDim objXL As Object\nDim wb As Workbook\nDim pathName, name, myLink As String\n\nSet sht = ActiveSheet\nSet wb = ActiveWorkbook\n\npathName = wb.FullName\nname = wb.name\n\nFor Each shp In sht.Shapes\n    If shp.Type = msoGroup Then\n        For i = 1 To shp.GroupItems.Count\n            If shp.GroupItems(i).Type = msoEmbeddedOLEObject Then\n                shp.GroupItems(i).Select\n                shp.GroupItems(i).OLEFormat.Activate\n                Set wb = ActiveWorkbook\n                If Not IsEmpty(wb.LinkSources(xlExcelLinks)) Then\n                    For Each link In wb.LinkSources(xlExcelLinks)\n                        On Error Resume Next\n                        wb.ChangeLink name:=link, newName:=pathName, Type:=xlLinkTypeExcelLinks\n                    Next link\n                End If\n\n                For Each mySheet In ActiveWorkbook.Worksheets\n\n                    With Application.FindFormat.Interior.Color = inputCell\n                        myRange = mySheet.Cells.Find(what:=\"Retail\")   ', searchformat:=True)\n                        myRange.ClearContents\n                    End With\n\n                Next mySheet\n\n                wb.Close (False)\n            End If\n        Next i\n    End If\nNext shp\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "replace", "numeric", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1448415676, "post_id": 33907058, "comment_id": 55576869, "body": "I&#39;m not so sure that this will work, since OP stated, that the numeric value is stored as text."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1448417481, "post_id": 33907058, "comment_id": 55577345, "body": "@MarcoGetrost  I tested the code on a column in which all cells were formatted as <i>Text</i>"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1448417653, "post_id": 33907058, "comment_id": 55577389, "body": "Ok. Thats good to know, that VBA will even detect numeric values, when they are stored as text!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1448415216, "creation_date": 1448415216, "answer_id": 33907058, "question_id": 33906599, "link": "https://stackoverflow.com/questions/33906599/vba-code-that-will-replace-the-cells-displaying-the-numeric-values-text-type-w/33907058#33907058", "title": "VBA Code that will replace the cells displaying the numeric values (text type) with a blank?", "body": "<p>This is for column <strong>B</strong>:</p>\n\n<pre><code>Sub qwerty()\n   Dim r As Range\n\n   For Each r In Intersect(ActiveSheet.UsedRange, Range(\"B:B\"))\n      If IsNumeric(r.Value) Then\n         r.Clear\n      End If\n   Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5602041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ff5198743150db119362adbec1e669?s=128&d=identicon&r=PG&f=1", "display_name": "K.Hooper", "link": "https://stackoverflow.com/users/5602041/k-hooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1448415216, "creation_date": 1448412143, "last_edit_date": 1531164843, "question_id": 33906599, "link": "https://stackoverflow.com/questions/33906599/vba-code-that-will-replace-the-cells-displaying-the-numeric-values-text-type-w", "title": "VBA Code that will replace the cells displaying the numeric values (text type) with a blank?", "body": "<p>I have an excel spreadsheet that gets data from another source.  One column has text names but a numeric value is presented if no name is available, the numeric value is also the text type.  Is there VBA Code that will replace the cells displaying the numeric values with a blank?</p>\n"}, {"tags": ["javascript", "php", "vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1448413165, "post_id": 33905546, "comment_id": 55576109, "body": "As this question is tagged &quot;javascript&quot;, is the required data present in the page being requested even if Javascript is turned off?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1448441979, "post_id": 33905546, "comment_id": 55586261, "body": "Good question! I didn&#39;t think about that option."}, {"owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 1, "creation_date": 1448444935, "post_id": 33905546, "comment_id": 55588086, "body": "there is no clear answer to this question ... both methods have adavantages / disadvantages. I personally prefer a third method (but similar to the first one) with using WinHttpRequest object. The greates advantage of method 1 (and for my method with the WinHttpRequest object) is, that you have full control over the communication between server and client - and that it doesn&#39;t matter if the IE is installed or not ... and it&#39;s much faster."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "reply_to_user": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 0, "creation_date": 1448447052, "post_id": 33905546, "comment_id": 55589456, "body": "@cboden thanks for your answer. I&#39;m leaning torwards the 1st (or 3rd) method too due to the reasons you point. Do you know of any resources, like code examples, I can use to further explore this question?"}], "owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448442017, "creation_date": 1448406193, "last_edit_date": 1448442017, "question_id": 33905546, "link": "https://stackoverflow.com/questions/33905546/request-php-data-from-page", "title": "Request PHP data from page", "body": "<p>I'm requesting information from a webpage using Excel VBA. I'm trying to find which of the following methods is more effective in terms of reliability/performance.</p>\n\n<p><strong>Method 1: Use MSXML2.ServerXMLHTT and request the data from the server like:</strong></p>\n\n<pre><code>Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n   URL = \"http://www.example.com/page\"\n   objHTTP.Open \"POST\", URL, False\n   objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n   objHTTP.send (\"\")\n</code></pre>\n\n<p><strong>Method 2 Use IE to navigate to the page and fetch the elements I need by getting the innerHTML of specific div id's. Like:</strong></p>\n\n<pre><code>sURL = \"http://www.example.com/page\"\nSet oBrowser = CreateObject(\"InternetExplorer.Application\") 'New InternetExplorer\noBrowser.navigate sURL\n\nWith oBrowser\n    Do While .Busy Or .ReadyState &lt;&gt; 4: Loop\nEnd With\n\nSet HTMLDoc = oBrowser.Document\nWith HTMLDoc\n  divID = HTMLDoc.getElementById(\"myId\").innerHTML\nEnd With\n\noBrowser.Quit\n</code></pre>\n\n<p>The data I'm trying to obtain from this page is the complete name of the user, address, and registration date (given his username). For that, I have a PHP script.  </p>\n\n<p>Which of these two methods will be faster, what if the user doesn't have IE installed (will the first method work)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448407527, "post_id": 33905277, "comment_id": 55574138, "body": "Your bigger problem is determining distance? Even after you determine all possible minimums, you still need to assign via distance from there."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1448407539, "post_id": 33905277, "comment_id": 55574143, "body": "I cannot see how this code even compiles.  <code>SmallestWorkload</code> is a <code>Date</code> variable, and then <code>TeamAssigned</code> is being set to to the value of <code>SmallestWorklaod.Offset(0,1).Value</code> which could only happen if <code>SmallestWorkload</code> was of type <code>Range</code>.  I&#39;m going to take a wild stab at a solution in a second, but I think you might get more people helping if you could add a picture of the data."}, {"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1448407970, "post_id": 33905277, "comment_id": 55574306, "body": "GD Lauren, your code does not describe how you determine the &#39;nearest city&#39; or where it decides that the workload between teams are equal. All your code does now is determine the oldest date (i.e. minimum in the range(N4:N10) -this is not an array by the way- and then decides to update the value in column &quot;F&quot; of a table which, apparently, holds some data after which It updates the finishing date of the last found team and then loops. There are a couple of things wrong with it, but let&#39;s start at the beginning (typo at NSBcomplAtion) what data is in your table (column A through I) ?"}, {"owner": {"reputation": 49, "user_id": 4954235, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10152936698147963/picture?type=large", "display_name": "Lauren Neely", "link": "https://stackoverflow.com/users/4954235/lauren-neely"}, "edited": false, "score": 0, "creation_date": 1448408233, "post_id": 33905277, "comment_id": 55574406, "body": "distance calculations are in another sheet, that&#39;s completely done and not a problem at all. There&#39;s 7 tabs of data I&#39;m using but my current issue is just how to go about this loop. Demetri, this was a rough outline code. I&#39;m aware that doesn&#39;t work. I&#39;m more concerned about logic at the moment."}, {"owner": {"reputation": 49, "user_id": 4954235, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10152936698147963/picture?type=large", "display_name": "Lauren Neely", "link": "https://stackoverflow.com/users/4954235/lauren-neely"}, "edited": false, "score": 0, "creation_date": 1448408634, "post_id": 33905277, "comment_id": 55574571, "body": "So essentially what is happening is that a city is inputted. I have a distance matrix with long/lat coordinates to determine distance.I also have a column for expected days to completion based on a equation. From that I am looking at the date and location of a call and assigning a team based on which one has the lightest workload. I&#39;m determining lightest workload based based on which team will be done with their current scheduled jobs the fastest (the min of the dates) but the issue is that there are instanced when that min value will be for more than one team and I need to find -"}, {"owner": {"reputation": 49, "user_id": 4954235, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10152936698147963/picture?type=large", "display_name": "Lauren Neely", "link": "https://stackoverflow.com/users/4954235/lauren-neely"}, "edited": false, "score": 0, "creation_date": 1448408799, "post_id": 33905277, "comment_id": 55574642, "body": "a way to tell the code that when this occurs (more than one minimum)  I need it to decide the city has the nearest location. The code here doesn&#39;t run, it is a rough outline. My issue is logic of how to go about indicating if there id more than one value for the minimum. Something like &quot; If more than one min, then nearest city&quot;"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1448466091, "post_id": 33905277, "comment_id": 55602310, "body": "Sorry about responding so late, I left after posting the answer and just got in.  I was wondering if the general idea in my solution was helpful or if something further was needed.  If so please let me know."}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 1, "last_activity_date": 1448408247, "creation_date": 1448408247, "answer_id": 33905931, "question_id": 33905277, "link": "https://stackoverflow.com/questions/33905277/how-to-adjust-a-code-if-there-is-more-than-one-minimum-value/33905931#33905931", "title": "How to adjust a code if there is more than one minimum value", "body": "<p>The below is an example of how one might try to look at two conditions in a loop using vba code.</p>\n\n<p>You will have to then assign the variables at the end to the cells you wish them to go in, and add code to update the final team that was chosen, but perhaps it gives you some ideas.</p>\n\n<pre><code>Sub TeamAssignment()\n\n    ' Assuming column N has the workload date, column O has the Team, and column P has the distance in miles\n    Dim lastRow As Integer\n    Dim i As Integer\n    lastRow = Worksheets(\"Calc\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    Dim TeamAssigned As String, SmallestWorkload As Date, ClosestTeam As Double\n\n    ' Choose the first team to begin with\n    SmallestWorkload = Range(\"N3\").Value: TeamAssigned = Range(\"O3\").Value: ClosestTeam = Range(\"P3\").Value\n\n    'find smallest workload and put into sheet\n    For i = 3 To lastRow\n        Select Case Range(\"N\" &amp; i).Value\n            Case Is &lt; SmallestWorkload\n                ' If we find a smaller workload, then assign it to this team\n                SmallestWorkload = Range(\"N\" &amp; i).Value: TeamAssigned = Range(\"O\" &amp; i).Value: ClosestTeam = Range(\"P\" &amp; i).Value\n            Case Is = SmallestWorkload\n                ' If the workload is the same, then determine if it should be assigned based on the distance\n                If Range(\"P\" &amp; i).Value &lt; ClosestTeam Then _\n                    SmallestWorkload = Range(\"N\" &amp; i).Value: TeamAssigned = Range(\"O\" &amp; i).Value: ClosestTeam = Range(\"P\" &amp; i).Value\n        End Select\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4954235, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10152936698147963/picture?type=large", "display_name": "Lauren Neely", "link": "https://stackoverflow.com/users/4954235/lauren-neely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448408247, "creation_date": 1448404917, "last_edit_date": 1448407875, "question_id": 33905277, "link": "https://stackoverflow.com/questions/33905277/how-to-adjust-a-code-if-there-is-more-than-one-minimum-value", "title": "How to adjust a code if there is more than one minimum value", "body": "<p>I'm trying to write a code that will look at the city a call takes place in and then assigns a team in a city to remedy the call. There are 7 team locations and the teams are assigned by which team has the lightest workload. If two teams have the same workload it is assigned to the team in the nearest city. </p>\n\n<p>I'm having problems thinking about how a loop would calculate the minimum workload but then also take into account there being more than one min and then decide to use the nearest location of minimums.</p>\n\n<p>right now I have a sheet that has the date of the call and the number of days to completion for each call. I have an array (N4:N10) that displays the last completion date for each team location. Right now my loop is just taking the minimum of those completion dates and assigning the corresponding team to the call and then incrementing the last completion date by the expected number of days to complete the last call, but it's not taking into account there being more than one minimum.</p>\n\n<pre><code>Sub TeamAssignment()\n   Dim lastRow As Integer\n   Dim i As Integer\n   lastRow = Worksheets(\"Calc\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n   Dim SmallestWorkload As Date\n   Dim TeamAssigned As String\n\n   For i = 3 To lastRow\n      'find smallest workload and put into sheet\n      SmallestWorkload = Application.WorksheetFunction.Min(Sheets(\"Calc\").Range(\"N4:N10\"))\n      TeamAssigned = SmallestWorkload.Offset(0, 1).Value\n      Range(i, \"F\").Value = TeamAssigned\n\n      If TeamAssigned = \"Miami\" Then\n         MIAcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N9\").Value = MIAcompletion\n      ElseIf TeamAssigned = \"Jacksonville\" Then\n         JAXcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N5\").Value = JAXcompletion\n      ElseIf TeamAssigned = \"New Smyrna Beach\" Then\n         NSBcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N6\").Value = NSBcomplation\n      ElseIf TeamAssigned = \"Ocala\" Then\n         OCALAcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N7\").Value = OCALAcompletion\n      ElseIf TeamAssigned = \"St. Petersburg\" Then\n         SPcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N8\").Value = SPcompletion\n      ElseIf TeamAssigned = \"Gainesville\" Then\n         GNVcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N4\").Value = GNVcompletion\n      Else\n         PSLcompletion = SmallestWorkload + Range(i, \"I\").Value\n         Range(\"N10\").Value = PSLcompletion\n      End If\n   Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 3, "creation_date": 1448404036, "post_id": 33904950, "comment_id": 55572735, "body": "Can you please provide an example value that works, and one that does not work ?"}, {"owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1448461458, "post_id": 33904950, "comment_id": 55598944, "body": "So for instance, if WorkCity was Columbus, and the person&#39;s name was Smith,John it works, if WorkCity is Dublin (and this only happens in this case) all the names under Dublin result in this error. The replace function I put in place to help with cases like O&#39;Mailey in the last name. Access did not like the &#39; in the name so had to replace it."}, {"owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1448461998, "post_id": 33904950, "comment_id": 55599330, "body": "I used mdialogo&#39;s suggestion below and this is what debug.print results in the para noted below. The first two being part of &quot;Columbus&quot; as a WorkCity and the second two being &quot;Dublin&quot;, I look at the overall data, nothing really makes the two different in terms data content and structure."}, {"owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1448462098, "post_id": 33904950, "comment_id": 55599394, "body": "[Employee Name]=&#39;Jones,Melika&#39; And [Movement Type]=&#39;Term&#39; [Employee Name]=&#39;MacGuinness,Neil&#39; And [Movement Type]=&#39;Term&#39; [Employee Name]=&#39;&#39; And [Movement Type]=&#39;&#39; [Employee Name]=&#39;&#39; And [Movement Type]=&#39;&#39;"}, {"owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1448465725, "post_id": 33904950, "comment_id": 55602013, "body": "I found the issue, it was pertaining to a datapoint that was not filled out in the table, thank you all again for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "edited": false, "score": 0, "creation_date": 1448461520, "post_id": 33905835, "comment_id": 55598997, "body": "Thanks for the quick response mdialogo, I added Nz() in the above code and this resulted in the record not being pulled at all. When I checked to see what its printing it results in [Employee Name]=&#39;&#39; And [Movement Type]=&#39;&#39;"}], "tags": [], "owner": {"reputation": 453, "user_id": 2669681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efb225f101bbb27b11dc7b2209991c7d?s=128&d=identicon&r=PG", "display_name": "mdialogo", "link": "https://stackoverflow.com/users/2669681/mdialogo"}, "is_accepted": false, "score": 0, "last_activity_date": 1448407810, "creation_date": 1448407810, "answer_id": 33905835, "question_id": 33904950, "link": "https://stackoverflow.com/questions/33904950/invalid-use-of-null-in-dropdown-vba/33905835#33905835", "title": "Invalid Use of Null in Dropdown VBA", "body": "<p><code>Replace</code> doesn't like <code>null</code> so you must enclosed <code>Me.cmb_Name</code> with <code>Nz()</code> function like this:</p>\n\n<pre><code>Private Sub cmb_Name_AfterUpdate()\nDim strFilter As String\nMe.cmb_WorkCity.Requery\nstrFilter = \"[Employee Name]='\" &amp; Replace(Nz(Me.cmb_Name.Column(0)), \"'\", \"''\") &amp; _\n            \"' And [Movement Type]='\" &amp; Me.cmb_Name.Column(1) &amp; \"'\"\nDebug.Print strFilter '\nDoCmd.ApplyFilter , strFilter\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "is_accepted": false, "score": 0, "last_activity_date": 1448465752, "creation_date": 1448465752, "answer_id": 33920533, "question_id": 33904950, "link": "https://stackoverflow.com/questions/33904950/invalid-use-of-null-in-dropdown-vba/33920533#33920533", "title": "Invalid Use of Null in Dropdown VBA", "body": "<p>I found the issue, it was pertaining to a datapoint that was not filled out in the table, thank you all again for your help!</p>\n"}], "owner": {"reputation": 43, "user_id": 5441754, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-_NOhDNNyef0/AAAAAAAAAAI/AAAAAAAASgA/Axhh5ExCoIY/photo.jpg?sz=128", "display_name": "Yasir Yousuf", "link": "https://stackoverflow.com/users/5441754/yasir-yousuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448465752, "creation_date": 1448403572, "question_id": 33904950, "link": "https://stackoverflow.com/questions/33904950/invalid-use-of-null-in-dropdown-vba", "title": "Invalid Use of Null in Dropdown VBA", "body": "<p>I have the following code for my dropdown menu</p>\n\n<pre><code>Private Sub cmb_Name_AfterUpdate()\nDim strFilter As String\nMe.cmb_WorkCity.Requery\nstrFilter = \"[Employee Name]='\" &amp; Replace(Me.cmb_Name.Column(0), \"'\", \"''\") &amp; _\n            \"' And [Movement Type]='\" &amp; Me.cmb_Name.Column(1) &amp; \"'\"\nDebug.Print strFilter '\nDoCmd.ApplyFilter , strFilter\nEnd Sub\n</code></pre>\n\n<p>It works for every single cmb_WorkCity except one city where all Employee Names that I select result in an Invalid Use of Null, I'm pulling my hair right now because anything I change results in the same thing. The code worked previously, it just stopped working today randomly.</p>\n\n<p>Thanks again for your help</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 11, "user_id": 3417575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1ea38d8627cc1c551e4c825fc0532c?s=128&d=identicon&r=PG&f=1", "display_name": "user3417575", "link": "https://stackoverflow.com/users/3417575/user3417575"}, "reply_to_user": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1448404507, "post_id": 33904787, "comment_id": 55572963, "body": "Within the arguments, number 3, it&#39;s stated   &quot;If the foreign key field is Text (not Number), include quote marks as delimiters, e.g.: &quot;[ForeignKeyFieldName] = &quot;&quot;&quot; &amp; [PrimaryKeyFieldName]   &amp; &quot;&quot;&quot;&quot;&quot;  So I used this as the keys are not just numbers but include text."}], "answers": [{"tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": false, "score": 2, "last_activity_date": 1448428910, "last_edit_date": 1448428910, "creation_date": 1448428445, "answer_id": 33908896, "question_id": 33904787, "link": "https://stackoverflow.com/questions/33904787/ms-access-concatenate-function-allow-no-duplicates/33908896#33908896", "title": "MS Access Concatenate function -- allow no duplicates", "body": "<p>Modify the <code>ConcatRelated()</code> function <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow\">from Allen Browne</a> as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Do While Not rs.EOF\n    If bIsMultiValue Then\n        'For multi-valued field, loop through the values\n        Set rsMV = rs(0).Value\n        Do While Not rsMV.EOF\n            If Not IsNull(rsMV(0)) Then\n              If InStr(strOut, rsMV(0)) = 0 then  ''''' ADD THIS\n                strOut = strOut &amp; rsMV(0) &amp; strSeparator\n              End If                         ''''' ADD THIS\n            End If\n            rsMV.MoveNext\n        Loop\n        Set rsMV = Nothing\n    ElseIf Not IsNull(rs(0)) Then\n        strOut = strOut &amp; rs(0) &amp; strSeparator\n    End If\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>The <code>InStr()</code> function will check to see if the current value is already in the output string <code>strOut</code>.  If it is (as indicated by a return of zero), the <code>If()</code> statement will ensure the current value is not added.  </p>\n"}], "owner": {"reputation": 11, "user_id": 3417575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1ea38d8627cc1c551e4c825fc0532c?s=128&d=identicon&r=PG&f=1", "display_name": "user3417575", "link": "https://stackoverflow.com/users/3417575/user3417575"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485869977, "creation_date": 1448402899, "last_edit_date": 1495542259, "question_id": 33904787, "link": "https://stackoverflow.com/questions/33904787/ms-access-concatenate-function-allow-no-duplicates", "title": "MS Access Concatenate function -- allow no duplicates", "body": "<p>looking through StackOverflow I was able to find what I was looking for from:<br>\n<a href=\"https://stackoverflow.com/questions/9217234/concatenating-multiple-rows-into-single-line-in-ms-access\">Concatenating multiple rows into single line in MS Access [duplicate]</a>\n<br/>\nWhich utilizes the function from:<br>\n<a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">Concatenate values from related records</a>\n<br/>\nBut what I can't figure out is how to not return duplicate values from the rows that are being concatenated. Examples...I want it to return for Customer1:</p>\n\n<pre><code>PartA, PartB, PartF\n</code></pre>\n\n<p>Not...</p>\n\n<pre><code>PartA, PartA, PartA, PartB, PartB, PartF  \n</code></pre>\n\n<p>I am not honestly sure on how to make this custom function work like that. My query is...  </p>\n\n<pre><code>SELECT DISTINCT PART_NUMBER, \nConcatRelated(\"SUPPLIER_NAME\",\"tbl_supplier_list\",\n              \"PART_NUMBER=\"\"\" &amp; [PART_NUMBER] &amp; \"\"\"\")\nFROM tbl_supplier_list;`\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1289, "user_id": 4303407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5feb379946286f2086055b78892368e1?s=128&d=identicon&r=PG", "display_name": "Harsh", "link": "https://stackoverflow.com/users/4303407/harsh"}, "edited": false, "score": 0, "creation_date": 1448402855, "post_id": 33904729, "comment_id": 55572166, "body": "Check the value of the loopText2.Offset(k).Value before start of the second loop"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1448402887, "post_id": 33904729, "comment_id": 55572182, "body": "Don&#39;t understand what you&#39;re doing but are you sure you want to use <code>correctedText2</code> in both loops?"}, {"owner": {"reputation": 119, "user_id": 5559990, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91abaf38ab0d688dfd1426e3fb61152b?s=128&d=identicon&r=PG&f=1", "display_name": "ksenia", "link": "https://stackoverflow.com/users/5559990/ksenia"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448406054, "post_id": 33904729, "comment_id": 55573622, "body": "@findwindow I believe that could be causing the problem, only the first loop is executed. However, correctedText is the same modification of originalText. I am just trying to modify originalText by replacing the words &quot;tagname&quot; and &quot;sheetname&quot; with cell ranges loopText1 and loopText2 respectively."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 1289, "user_id": 4303407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5feb379946286f2086055b78892368e1?s=128&d=identicon&r=PG", "display_name": "Harsh", "link": "https://stackoverflow.com/users/4303407/harsh"}, "edited": false, "score": 0, "creation_date": 1448406571, "post_id": 33904729, "comment_id": 55573811, "body": "I still don&#39;t get it XD I need to see it :/ I would also take a look at what @Harsh said."}, {"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1448408654, "post_id": 33904729, "comment_id": 55574581, "body": "GD, you do not reset i it starts at the value it had after first loop ?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1448408731, "post_id": 33904729, "comment_id": 55574609, "body": "@mtholen if it resets, it would overwrite what the first loop did....I think... it seems to keep appending like a list. I am having trouble picturing it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1448421276, "post_id": 33904729, "comment_id": 55578255, "body": "don&#39;t you need to reset <code>i = 0</code> before running the 2nd loop? otherwise, i will equal the last i value from the first loop....  or how about 1 loop with a &quot;double replace&quot; ...  <code>correctedText2.Offset(i).Value = Replace(Replace(cel.Value, &quot;tagname&quot;, loopText1.Offset(j).Value),&quot;sheetname&quot;,loopText2.Offset(j).V&zwnj;&#8203;alue)</code>"}, {"owner": {"reputation": 119, "user_id": 5559990, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91abaf38ab0d688dfd1426e3fb61152b?s=128&d=identicon&r=PG&f=1", "display_name": "ksenia", "link": "https://stackoverflow.com/users/5559990/ksenia"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1448466250, "post_id": 33904729, "comment_id": 55602431, "body": "Yes!!! @ScottHoltzman you got it! Spot on! Works like magic. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 5559990, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91abaf38ab0d688dfd1426e3fb61152b?s=128&d=identicon&r=PG&f=1", "display_name": "ksenia", "link": "https://stackoverflow.com/users/5559990/ksenia"}, "is_accepted": false, "score": 0, "last_activity_date": 1448466975, "creation_date": 1448466975, "answer_id": 33920966, "question_id": 33904729, "link": "https://stackoverflow.com/questions/33904729/do-until-isempty-to-loop-through-multiple-user-defined-ranges/33920966#33920966", "title": "Do Until IsEmpty to loop through multiple user-defined ranges", "body": "<p>Thanks to @ScottHoltzman, here's the answer!</p>\n\n<pre><code>Sub CommandButton21_Click()\nDim correctedText1 As Range\nDim correctedText2 As Range\nDim correctedText3 As Range\nDim OriginalText1 As Range\nDim OriginalText2 As Range\nDim loopText1 As Range\nDim loopText2 As Range\nDim cel As Range\nDim i As Long\nDim j As Long\n\nSet OriginalText2 = Range(\"H3:H20\")\nSet correctedText2 = Range(\"B9\")\nSet loopText1 = Range(\"D2\")\nSet loopText2 = Range(\"E2\")\n\ni = 0\nj = 0\n\nDo Until IsEmpty(loopText1.Offset(j).Value)\n\n    For Each cel In OriginalText2\n        correctedText2.Offset(i).Value = Replace(Replace(cel.Value, \"tagname\", loopText1.Offset(j).Value), \"sheetname\", loopText2.Offset(j).Value)\n        i = i + 1\n    Next cel\n    j = j + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Instead of creating two Do Until IsEmpty Loops, combine into one loop with a double replace.</p>\n"}], "owner": {"reputation": 119, "user_id": 5559990, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91abaf38ab0d688dfd1426e3fb61152b?s=128&d=identicon&r=PG&f=1", "display_name": "ksenia", "link": "https://stackoverflow.com/users/5559990/ksenia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448466975, "creation_date": 1448402604, "last_edit_date": 1495540319, "question_id": 33904729, "link": "https://stackoverflow.com/questions/33904729/do-until-isempty-to-loop-through-multiple-user-defined-ranges", "title": "Do Until IsEmpty to loop through multiple user-defined ranges", "body": "<p>This is a continuation of the question <a href=\"https://stackoverflow.com/questions/33746604/do-until-isempty-to-loop-through-the-user-defined-ranges\">Do Until IsEmpty to loop through the user-defined ranges</a>:</p>\n\n<p>In the code below the excel Macro loops through Original text range, replacing all the instances of \"tagname\" with the assigned loopText in cell D2 and puts the corrected text into cell B9. Then it checks whether the looptext range has other values and loops through the original text again to account for these. Once the looptext cell is empty, the macro stops and prints the corrected text for each instance of loopText.\nParallel to replacing \"tagname\" in cells D2 and onward I want the Macro to replace the word \"sheetname\" with the range of cells in E2 and onward.\nI have created a separate Do Until IsEmpty loop, however excel only executes the first one.</p>\n\n<p>Please, help locate an error in my VB code.</p>\n\n<p>Thank you.</p>\n\n<pre><code>Sub CommandButton21_Click()\nDim correctedText2 As Range\nDim OriginalText2 As Range\nDim loopText1 As Range\nDim loopText2 As Range\nDim cel As Range\nDim i As Long\nDim j As Long\nDim k As Long\n\nSet OriginalText2 = Range(\"H3:H20\")\nSet correctedText2 = Range(\"B9\")\nSet loopText1 = Range(\"D2\")\nSet loopText2 = Range(\"E2\")\n\ni = 0\n\nj = 0\n\nDo Until IsEmpty(loopText1.Offset(j).Value)\n\n    For Each cel In OriginalText2\n        correctedText2.Offset(i).Value = Replace(cel.Value, \"tagname\", loopText1.Offset(j).Value)\n        i = i + 1\n    Next cel\n    j = j + 1\nLoop\n\nk = 0\n\nDo Until IsEmpty(loopText2.Offset(k).Value)\n\n    For Each cel In OriginalText2\n        correctedText2.Offset(i).Value = Replace(cel.Value, \"sheetname\", loopText2.Offset(k).Value)\n        i = i + 1\n    Next cel\n    k = k + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448401875, "post_id": 33904469, "comment_id": 55571691, "body": "Range requires row and column. <code>wsDate_Header_Row</code> only holds row."}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448405913, "post_id": 33904469, "comment_id": 55573570, "body": "The column would change based on the date I need to find in the range (an entire row). If I understand your advice correctly, I&#39;m not sure how specifying a column is what I want. Maybe there is another way to find something based on an input variable that I am missing?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448406099, "post_id": 33904469, "comment_id": 55573635, "body": "You have the right idea. Like Bob said below, you can use a variable named <code>column_number</code> and set that to the column you need."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448407916, "post_id": 33905106, "comment_id": 55574285, "body": "There are around 20+ columns that can contain the date I need to find in a single row, so I will update 10 to 20. I received a Run-time error 91 Object variable or With block variable not Set at mRange.Find."}], "tags": [], "owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1448404184, "creation_date": 1448404184, "answer_id": 33905106, "question_id": 33904469, "link": "https://stackoverflow.com/questions/33904469/run-time-error-424-object-required/33905106#33905106", "title": "Run-time error 424 Object Required", "body": "<p>When you try to create a range object variable, you have to set it to an range object. When you use <code>Set mRange = wsDate_Header_Row</code> you are trying to set it to a row number not an object. You should use something like <code>Set mRange = Cells(wsDate_Header_Row, column_number_or_letter)</code> where column_number_or_letter points to your target column.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448464521, "post_id": 33905650, "comment_id": 55601166, "body": "Now I get Run-time error 91 Object variable or With block variable not Set at the f.Select. I copied/pasted your code and declarations just in case, but the error persists."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448464942, "post_id": 33905650, "comment_id": 55601457, "body": "That&#39;s my fault. Try <code>Set mRange = ActiveSheet.Range(ActiveSheet.Cells(wsDate_Header_Row, 1), ActiveSheet.Cells(wsDate_Header_Row, 20))</code>"}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448468072, "post_id": 33905650, "comment_id": 55603723, "body": "I copied this new code line into my code, removed the old code it replaces but I still get the same error at the f.Select statement."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448468371, "post_id": 33905650, "comment_id": 55603906, "body": "Uh works fine for me :/ Is this the entirety of your code? Did <code>f</code> actually find something?"}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448469561, "post_id": 33905650, "comment_id": 55604721, "body": "My full code is over the posting limit by 400 characters. Is there another way I can display it all? <code>wsDate_Header_Row</code> is correct at 6 (the entire row is highlighted); variable <code>New_Batch_Date</code> is correct as entered at 4/1/2016; <code>var_Batch_Qty</code> is correct as entered but still it bombs on f.Select."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448469690, "post_id": 33905650, "comment_id": 55604819, "body": "You can always edit OP but did <code>f</code> find something? Also, shouldn&#39;t date be <code>04&#47;01&#47;2016</code>? You&#39;re not hopping between sheets right?"}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448476222, "post_id": 33905650, "comment_id": 55608798, "body": "I edited the OP heading and included the full code above. I did not edit the title of the OP. When I hover over <code>f.Select</code> it shows <code>wsDate_Header_Row = 6</code>The sixth row is the correct row. I receive the same result if I enter the date with and without leading zeroes and using slashes or hyphens. I stay within the same worksheet which is called &quot;Lot Info&quot; Tyvm for sticking with this :)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1448477022, "post_id": 33905650, "comment_id": 55609215, "body": "Sigh. As predicted <code>f</code> is empty. I don&#39;t know what you want to do. You&#39;re better off rephrasing your question to explain what you want to do because your code leaves a lot to be desired :/ Edit: I am leaving soon and won&#39;t be back till Monday."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1448676385, "post_id": 33905650, "comment_id": 55691441, "body": "Gave you one for your effort here bro."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 1, "last_activity_date": 1448409061, "last_edit_date": 1448409061, "creation_date": 1448406776, "answer_id": 33905650, "question_id": 33904469, "link": "https://stackoverflow.com/questions/33904469/run-time-error-424-object-required/33905650#33905650", "title": "Run-time error 424 Object Required", "body": "<p>Edited per OP comment on other answer.</p>\n\n<pre><code>Dim mRange  As Range\nDim New_Batch_Date As Date\nDim f As Variant\n\nwsDate_Header_Row = ActiveCell.Row\nNew_Batch_Date = InputBox(\"Use Format: mm-dd-yyyy\", \"Enter the New Batch Date:\", \"\")\n\nSet mRange = Range(Cells(wsDate_Header_Row, 1), Cells(wsDate_Header_Row, 20))\n\nSet f = mRange.Find(What:=New_Batch_Date, After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\nf.Select\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448475720, "creation_date": 1448401602, "last_edit_date": 1531164843, "question_id": 33904469, "link": "https://stackoverflow.com/questions/33904469/run-time-error-424-object-required", "title": "Run-time error 424 Object Required", "body": "<p>I want to find the date I type into an input box in a selected row. I am getting the </p>\n\n<blockquote>\n  <p>Run-time error 91 Object variable or With block variable not Set</p>\n</blockquote>\n\n<p>error at the <code>f.Select</code> line. Please advise what I did wrong. Thanks much.</p>\n\n<p><code>Sub Add_Batch_Macro()</code><br>\n    <code>Dim mRange  As Range</code><br>\n    <code>Dim New_Batch_Date As Date</code><br>\n    <code>Dim f As Variant</code><br>\n    <code>Range(\"A1\").Select</code><br>\n    <code>ActiveCell.Rows(\"1:5\").EntireRow.Select</code><br>\n    <code>Selection.Copy</code><br>\n    <code>Selection.End(xlDown).Select</code><br>\n    <code>ActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select</code><br>\n    <code>ActiveSheet.Paste</code><br>\n    <code>wsDate_Header_Row = ActiveCell.Row</code><br>\n    <code>var_Batch_Qty = InputBox(\"Batch Quantity is:\", \"Enter the Batch Quantity:\", \"\")</code><br>\n    <code>ActiveCell.Offset(4, 3).Select</code><br>\n    <code>Selection.Value = var_Batch_Qty</code><br>\n    <code>ActiveCell.Offset(-2, 1).Select</code><br>\n    <code>ActiveCell.FormulaR1C1 = \"=R[2]C4-R[-1]C\"</code><br>\n    <code>Application.CutCopyMode = False</code><br>\n    <code>New_Batch_Date = InputBox(\"Use Format: mmddyyyy\", \"Enter the New Batch Date:\", \"\")</code><br>\n    <code>Application.Rows(wsDate_Header_Row).Select</code><br>\n    <code>Set mRange = ActiveSheet.Range(ActiveSheet.Cells(wsDate_Header_Row, 1), ActiveSheet.Cells(wsDate_Header_Row, 20))</code><br>\n    <code>Set f = mRange.Find(What:=New_Batch_Date, After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)</code><br>\n    <code>f.Select</code><br>\n    <code>End Sub</code>  </p>\n"}, {"tags": ["html", "xml", "vba", "parsing"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": true, "score": 1, "last_activity_date": 1448407473, "creation_date": 1448407473, "answer_id": 33905765, "question_id": 33904008, "link": "https://stackoverflow.com/questions/33904008/parse-scrape-column-from-table-using-mshtml-htmldocument/33905765#33905765", "title": "Parse/Scrape column from table using MSHTML.HTMLDocument", "body": "<p>Try this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Sub ExtractAlbertaAIL()\r\n\r\nApplication.ScreenUpdating = False\r\nApplication.EnableEvents = False\r\n\r\nDim URL As String\r\nDim Request As MSXML2.XMLHTTP60\r\nDim doc As MSHTML.HTMLDocument\r\nDim tr As MSHTML.HTMLGenericElement\r\nDim td As MSHTML.HTMLGenericElement\r\nDim VOLUME_SUMMARY_FOUND As Boolean\r\nVOLUME_SUMMARY_FOUND = False\r\n\r\nDim RowNumber As Integer\r\nDim ColNumber As Integer\r\n\r\nActiveWorkbook.Worksheets(\"Gas Day Summary\").Range(\"A5:H10000\") = \"\"\r\n\r\nSet Request = CreateObject(\"msxml2.xmlhttp\")\r\nIf Request Is Nothing Then\r\n  MsgBox \"For some reason I wasn't able to make a MSXML2.XMLHTTP object\"\r\n  Exit Sub\r\nEnd If\r\n\r\n\r\nURL = \"https://services.tcpl.ca/cor/public/gdsr/GdsrNGTLImperial20151122.htm\"\r\nWith Request\r\n    .Open \"GET\", URL, False\r\n    .send\r\n\r\n    Set doc = New MSHTML.HTMLDocument\r\n    doc.body.innerHTML = .responseText\r\nEnd With\r\n\r\n\r\n\r\nRowNumber = 1\r\nFor Each tr In doc.getElementsByTagName(\"table\").Item(2).getElementsByTagName(\"tr\")\r\n\r\n   If tr.Cells(0).innerText = \"VOLUME SUMMARY\" Then\r\n      VOLUME_SUMMARY_FOUND = True\r\n   End If\r\n   If VOLUME_SUMMARY_FOUND = True Then\r\n       Worksheets(\"Gas Day Summary\").Cells(RowNumber, 1) = tr.Cells(0).innerText\r\n       Worksheets(\"Gas Day Summary\").Cells(RowNumber, 2) = tr.Cells(2).innerText\r\n       RowNumber = RowNumber + 1\r\n   End If\r\nNext tr\r\n\r\n\r\n Application.ScreenUpdating = True\r\nApplication.EnableEvents = True\r\nEnd Sub\r\n\u200b</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 45, "user_id": 5115787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3167561dc26435999bbd32f89abc790?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Sank", "link": "https://stackoverflow.com/users/5115787/nick-sank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 33905765, "answer_count": 1, "score": 0, "last_activity_date": 1582157655, "creation_date": 1448399881, "last_edit_date": 1582157655, "question_id": 33904008, "link": "https://stackoverflow.com/questions/33904008/parse-scrape-column-from-table-using-mshtml-htmldocument", "title": "Parse/Scrape column from table using MSHTML.HTMLDocument", "body": "<p>I wrote this piece of code that scrapes the whole table from the webpage in the URL variable. I would like to only scrape/parse the column by the name </p>\n\n<blockquote>\n  <p>\"Extrapolated Vol\". </p>\n</blockquote>\n\n<p>My html/xml is not strong, so a solution along with an explanation would be appreciated!</p>\n\n<p><a href=\"https://services.tcpl.ca/cor/public/gdsr/GdsrNGTLImperial20151122.htm\" rel=\"nofollow noreferrer\">https://services.tcpl.ca/cor/public/gdsr/GdsrNGTLImperial20151122.htm</a></p>\n\n<p>Thanks</p>\n\n<pre><code>Sub ExtractAlbertaAIL()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim URL As String\nDim Request As MSXML2.XMLHTTP\nDim doc As MSHTML.HTMLDocument\nDim tr As MSHTML.HTMLGenericElement\nDim td As MSHTML.HTMLGenericElement\n\nDim RowNumber As Integer\nDim ColNumber As Integer\n\nActiveWorkbook.Worksheets(\"Gas Day Summary\").Range(\"A5:H10000\") = \"\"\n\nSet Request = CreateObject(\"msxml2.xmlhttp\")\nIf Request Is Nothing Then\n  MsgBox \"For some reason I wasn't able to make a MSXML2.XMLHTTP object\"\n  Exit Sub\nEnd If\n\n\nURL = \"https://services.tcpl.ca/cor/public/gdsr/GdsrNGTLImperial20151122.htm\"\nWith Request\n    .Open \"GET\", URL, False\n    .send\n\n    Set doc = New MSHTML.HTMLDocument\n    doc.body.innerHTML = .responseText\nEnd With\n\n\n\nRowNumber = 1\nFor Each tr In doc.getElementsByTagName(\"table\").Item(2).getElementsByTagName(\"tr\")\n   ColNumber = 1\n    For Each td In tr.getElementsByTagName(\"td\")\n        Worksheets(\"Gas Day Summary\").Cells(RowNumber, ColNumber) = td.innerText\n        ColNumber = ColNumber + 1\n    Next td\n    RowNumber = RowNumber + 1\nNext tr\n\n\n Application.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448399926, "post_id": 33903831, "comment_id": 55570615, "body": "You forgot to qualify the row? <code>LRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Offset(1, 0).Row</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1448401080, "post_id": 33903831, "comment_id": 55571230, "body": "Although your post describes very well the context, I still fail to grasp completely the problem. Your <code>rng</code> is set to <code>(LRow, 23)</code>, you insert a button there, and you get it inserted there. What is the problem exactly, then? Is it that you want to insert such button at the end of <i>each</i> row? If so, it is a very simple loop, no?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1448401477, "post_id": 33903831, "comment_id": 55571468, "body": "And by the way, did you envisage using a drop down menu using the mouse right-click? I have a similar application that drops a menu with adjusted content according to the mouse position (row). It is much more practical and aestectic than filling too many buttons on the worksheet. The user would place the mouse over a cell, right-click, and click the menu item &quot;Sale&quot;."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1448401937, "post_id": 33903831, "comment_id": 55571713, "body": "@findwindow I dont think that this causes a problem, unless the workbook is a pre-2007 version open in compatibility mode."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1448402154, "post_id": 33903831, "comment_id": 55571837, "body": "@A.S.H OP didn&#39;t specify what the issue was. That was my first thought."}, {"owner": {"reputation": 11, "user_id": 5601465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b902c1a466c5f5635edcf93f99715f2?s=128&d=identicon&r=PG&f=1", "display_name": "J O&#39;Brien", "link": "https://stackoverflow.com/users/5601465/j-obrien"}, "edited": false, "score": 0, "creation_date": 1449500869, "post_id": 33903831, "comment_id": 56021105, "body": "The problem was that the button <i>wasn&#39;t</i> inserting in to Lrow, 23 when I ran the macro. No button was appearing at all. It might be because I&#39;m using Excel on a mac and it seems that VBA is a bit  dodgy at times on the mac version. The right click menu is a much better idea though, I&#39;ve coded that in instead. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1448400144, "creation_date": 1448400144, "answer_id": 33904080, "question_id": 33903831, "link": "https://stackoverflow.com/questions/33903831/adding-a-button-and-macro-to-the-last-row/33904080#33904080", "title": "Adding a button and macro to the last row", "body": "<p>I ran your code and it inserts the button okay, but it would be better to avoid the selects</p>\n\n<pre><code>    Set btn = ws.Buttons.Add(rng.Left, rng.Top, rng.Width, rng.RowHeight)\n    With btn\n        .OnAction = \"Sale\"\n        .Characters.Text = \"SALE\"\n        With .Characters.Font\n            .Name = \"Lucida Grande\"\n'        (---more formatting stuff---)\n        End With\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5569418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c002f3aeef9a173da295e95e9f969e?s=128&d=identicon&r=PG", "display_name": "KiwiSteve", "link": "https://stackoverflow.com/users/5569418/kiwisteve"}, "is_accepted": false, "score": 0, "last_activity_date": 1448405065, "creation_date": 1448405065, "answer_id": 33905315, "question_id": 33903831, "link": "https://stackoverflow.com/questions/33903831/adding-a-button-and-macro-to-the-last-row/33905315#33905315", "title": "Adding a button and macro to the last row", "body": "<p>Have you considered having one button which stays put above a freeze-pane line, and users select a/any cell (you can tell/train them which one) in the row they want to delete/process/whatever, and then press the button? Have the button detect the row (with appropriate checks) using ActiveCell.Row and work from there.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5601465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b902c1a466c5f5635edcf93f99715f2?s=128&d=identicon&r=PG&f=1", "display_name": "J O&#39;Brien", "link": "https://stackoverflow.com/users/5601465/j-obrien"}, "edited": false, "score": 0, "creation_date": 1449500985, "post_id": 33906286, "comment_id": 56021180, "body": "Thanks, this is an interesting solution and looks nicer than hundreds of buttons!"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1448410653, "last_edit_date": 1448410653, "creation_date": 1448410188, "answer_id": 33906286, "question_id": 33903831, "link": "https://stackoverflow.com/questions/33903831/adding-a-button-and-macro-to-the-last-row/33906286#33906286", "title": "Adding a button and macro to the last row", "body": "<p>I have done something similar but it was two buttons and they moved depending on the selected row, that way the user could scroll the data and the buttons would show up when they selected the row they wanted. I used pictures as my buttons and assigned macros to them:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nOn Error Resume Next\nWith ActiveSheet.Pictures(\"Picture 2\")\n    .Top = Target.Offset(1).Top\n    .Left = 930\nEnd With\nWith ActiveSheet.Pictures(\"Picture 4\")\n    .Top = Target.Offset(1).Top\n    .Left = 1005\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It always displays to the right of the data and down 1 row so as not to cover up any notes I had in there.</p>\n\n<p>Edit:</p>\n\n<p>Using this method you can also make it work on a selection if the user selects a bunch of rows and runs the code by using <code>Selection.Rows.Count</code> and looping the code using an offset.</p>\n"}], "owner": {"reputation": 11, "user_id": 5601465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b902c1a466c5f5635edcf93f99715f2?s=128&d=identicon&r=PG&f=1", "display_name": "J O&#39;Brien", "link": "https://stackoverflow.com/users/5601465/j-obrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1312, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1448410653, "creation_date": 1448399304, "last_edit_date": 1448409896, "question_id": 33903831, "link": "https://stackoverflow.com/questions/33903831/adding-a-button-and-macro-to-the-last-row", "title": "Adding a button and macro to the last row", "body": "<p>I'm building a stock taking spreadsheet for a small company, with very <strong>very</strong> novice Excel users. As such I want to use macros and VBA to do most of the work so they don't get overwhelmed by having to edit formula or create charts. In an ideal world they would learn some excel, but the reality is that isn't going to happen.</p>\n\n<p>So far I have a nice userform that makes input easy and once the submit button is pressed, it inserts all the data on to a stock list on the first available row. However, I also want to put a button at the end of each row that they can press if an item is subsequently sold. I have written a macro for this (\"Sale\") that decreases the item quantity, moves the item details to a sold sheet, and deletes the row entirely if the quantity goes to zero. My problem is that I cannot get the submit button of my userform to add in a macro button to a variable row number. </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>    Dim LRow As Long\n    Dim ws As Worksheet\n    Dim rng As Range\n    Set ws = Worksheets(\"Stock Warehouse\")\n    LRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    Set rng = ws.Cells(LRow, 23)\n\n    With ws\n    .Cells(LRow, 1).Value = Date\n    .Cells(LRow, 2).Value = Me.CATEGORY.Value\n\n     (---etc etc until---)\n\n    .Cells(LRow, 21).FormulaR1C1 = \"=Sum(rc[-1]/rc[-11])\"\n\n    rng.Select\n    ws.Buttons.Add(rng.Left, rng.Top, rng.Width, rng.RowHeight).Select\n    Selection.OnAction = \"Sale\"\n    Selection.Characters.Text = \"SALE\"\n    With Selection.Characters(Start:=1, Length:=4).Font\n    .Name = \"Lucida Grande\"\n    (---more formatting stuff---)\n    End With\n</code></pre>\n\n<p>If I set it to go to a named cell (i.e. \"W5\") it works and inserts the button. It's just getting it to insert a button in LRow, 23 that is so problematic! It's probably pretty straight forward but I have been staring at this for days and can't figure it out.</p>\n"}, {"tags": ["vba", "excel", "shell", "putty"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1448399578, "post_id": 33903606, "comment_id": 55570450, "body": "Well done for the first question here !"}, {"owner": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1448630751, "post_id": 33903606, "comment_id": 55674444, "body": "still I am not able to find solution of that question. could you reopen it. shared solution is not working."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1448630991, "post_id": 33903606, "comment_id": 55674569, "body": "Nobody has closed this question I believe. :). See Marc&#39;s final comment. That could be of some help.."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "edited": false, "score": 0, "creation_date": 1448400077, "post_id": 33903685, "comment_id": 55570688, "body": "Thanks Marc. I need to run shell script, which is located at remote server. while i am using &amp; &quot;-m /home/test.sh&quot;  then error message pop up as &quot;unable to open command file /home/test.sh&quot;. could you please suggest me any solution apart from plink.exe."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "reply_to_user": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "edited": false, "score": 0, "creation_date": 1448403156, "post_id": 33903685, "comment_id": 55572322, "body": "is that the full path to the script you&#39;re trying to run on the remote machine? I assume putty/plink runs the series of commands you provide in your local script, which could actually call the remote script, no? I probably can&#39;t offer a lot more, as I was just going off of what I read on the web."}, {"owner": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "edited": false, "score": 0, "creation_date": 1448479210, "post_id": 33903685, "comment_id": 55610476, "body": "pc1 = &quot;C:\\Users\\Desktop\\putty.exe -ssh &quot; &amp; UserName &amp; &quot;@server -pw &quot; &amp; Passwrd pc2 = &quot;/home/test.sh&quot; TaskID1 = Shell(pc1, 1) TaskID2 = Shell(pc2, 1)......While executing this code, It is showing Error message as &quot;File not found&quot; in the TaskID2."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "reply_to_user": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "edited": false, "score": 0, "creation_date": 1448480999, "post_id": 33903685, "comment_id": 55611410, "body": "If you&#39;re trying to use putty from a Windows machine (which I assume you are if you&#39;re using VBA), you need to specify a Windows path to a file that resides on the local Windows machine. You appear to have specified a <code>test.sh</code> file that resides on the remote machine, so of course that won&#39;t work."}, {"owner": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "edited": false, "score": 0, "creation_date": 1448633276, "post_id": 33903685, "comment_id": 55675800, "body": "if I am able to login to putty with userID and password successfully from the windows machine, There should be some command, so that I can run also any script on the putty. could you please check and suggest that we can solve via sendkeys and writeline functions. Is there any command to copy text data on the putty command line from Excel VBA script(discussed eariler) and hit enter. so that we can run the required shell script."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524666774, "post_id": 33903685, "comment_id": 87065915, "body": "@Marc Is there any parameter rather than <code>-m</code> to execute any command like I want to execute <code>ls</code> command after connecting to target server."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524756836, "post_id": 33903685, "comment_id": 87110028, "body": "@harun24hr, if you write <code>ls</code> into the script, then your script will execute <code>ls</code>.  You can write whatever executable commands you want into that script."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524759402, "post_id": 33903685, "comment_id": 87111545, "body": "Then what will be format means what will full code to run ls command. Can you please put a line here exactly."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1524769553, "post_id": 33903685, "comment_id": 87116764, "body": "You need to create a script file (batch file, etc.) that contains the commands you want to run. The <code>-m</code> parameter identifies that script file. Put your commands in that file."}], "tags": [], "owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "is_accepted": false, "score": 0, "last_activity_date": 1448398767, "creation_date": 1448398767, "answer_id": 33903685, "question_id": 33903606, "link": "https://stackoverflow.com/questions/33903606/open-putty-and-run-shell-script-on-server/33903685#33903685", "title": "Open PuTTY and run shell script on server", "body": "<p>I'm pretty sure you need to use the <code>-m</code> parameter.</p>\n\n<p>Like this:</p>\n\n<pre><code>pc1 = \"C:\\Users\\Desktop\\putty.exe -ssh \" &amp; UserName &amp; \"@servernamee -pw \" &amp; Passwrd &amp; \" -m c:\\temp\\test.sh\"\nTaskID = Shell(pc1, 1)\n</code></pre>\n\n<p>You might also consider use <code>plink.exe</code>, which is the command line connection utility.</p>\n"}], "owner": {"reputation": 21, "user_id": 5601364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15b2c95b8e0aae2a9c627a8719730647?s=128&d=identicon&r=PG&f=1", "display_name": "ajay0210", "link": "https://stackoverflow.com/users/5601364/ajay0210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 10288, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1609959670, "creation_date": 1448398482, "last_edit_date": 1481063273, "question_id": 33903606, "link": "https://stackoverflow.com/questions/33903606/open-putty-and-run-shell-script-on-server", "title": "Open PuTTY and run shell script on server", "body": "<p>I want to open Putty from local machine, automatically login to the server, and run shell script on the same session of putty using Excel VBA Script.\nThe code below works fine to open putty.</p>\n\n<pre><code>Sub open_putty()\n    Dim UserName 'assign user name\n    Dim Passwrd 'assign password\n    Dim TaskID As Long\n    pc1 = \"C:\\Users\\Desktop\\putty.exe -ssh \" &amp; UserName &amp; \"@servernamee -pw \" &amp; Passwrd\n    TaskID = Shell(pc1, 1)\nEnd Sub \n</code></pre>\n\n<p>However, I'm not able to run the shell script test.sh on the same session.  The script is in the default location after login.\nHow can I run the shell script on the server using Excel VBA. </p>\n"}, {"tags": ["vba", "excel", "excel-2010", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448466006, "post_id": 33903482, "comment_id": 55602252, "body": "I&#39;m assuming there is just the one table in the document, so AutoFit is definitely being applied to the right table... Try checking the Table.AllowAutoFit property - it needs to be True. You might also try &quot;fiddling&quot; with it in the Word UI until you find a combination that gives the desired result."}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1448888862, "post_id": 33903482, "comment_id": 55754201, "body": "It is just the one table each time.  But was able to run this by some friends over the holiday, and we figured it out.  Replaced <code>If objWord.ActiveDocument.Tables.Count &lt;&gt; 0 Then     objWord.ActiveDocument.Tables(1).AutoFitBehavior wdAutoFitWindow End If</code> with <code>objWord.ActiveDocument.Tables(1).AutoFitBehavior (2)</code> and now  get the intended result."}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448465858, "post_id": 33903795, "comment_id": 55602120, "body": "IF you read the code carefully you&#39;ll see that the OP is copying and pasting into Word. Your contribution does not address the actual question, which is how to change the table&#39;s behavior in Word."}, {"owner": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448544708, "post_id": 33903795, "comment_id": 55639025, "body": "Try using <code>.Selection.PasteExcelTable False, True, False</code> instead of juste Paste. It worked for me. Getting back to your comment, you said that you were transferring data from Excel to Word. The actual question was not clear enough and that why I used a question mark at my first sentence so I can inquire more about the issue.  &#39;Understand, read, know the context, then Compile&#39;"}], "tags": [], "owner": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "is_accepted": false, "score": -1, "last_activity_date": 1448467042, "last_edit_date": 1448467042, "creation_date": 1448399201, "answer_id": 33903795, "question_id": 33903482, "link": "https://stackoverflow.com/questions/33903482/data-from-excel-to-word-not-applying-autofitbehavior-correctly/33903795#33903795", "title": "Data from Excel to Word not applying AutoFitBehavior correctly", "body": "<p>Have you checked that the tables count condition is true (using debug.print)?\nIf not, I don't believe that an Excel Range object is simply converted into a table object in Word. You should probably use <code>Range.ConvertToTable</code>method so you can get the table object and then you can apply the auto fit thing. </p>\n"}], "owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1667, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448467042, "creation_date": 1448398037, "last_edit_date": 1531164843, "question_id": 33903482, "link": "https://stackoverflow.com/questions/33903482/data-from-excel-to-word-not-applying-autofitbehavior-correctly", "title": "Data from Excel to Word not applying AutoFitBehavior correctly", "body": "<p>Hoping that someone can give some advice, as I've modified my code many times now trying to get the <code>AutoFitBehavior</code> formatting to apply correctly.  The code runs through everything as is (moves everything over and completes just fine), but the AutoFit never applies. Feel like I'm missing something that should be a simple fix, but everything I see seems to be telling me that the <code>objWord.ActiveDocument.Tables(1).AutoFitBehavior wdAutoFitWindow</code> should work - I've tried it within its' own If statement where it is now, as well as moving it around and including in different places, with the same result.  Any advice is greatly appreciated.</p>\n\n<p>Most recent version of my code:</p>\n\n<pre><code>Sub CopyToWord()\n\nDim objWord\nDim objDoc\nDim ws As Worksheet\nDim Rpt As Range\n\nApplication.CopyObjectsWithCells = False\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Add\nSet ws = ThisWorkbook.Worksheets(\"Report\")\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nLastColumn = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column\n\nws.Range(\"A1:\" &amp; Split(ws.Cells(, LastColumn).Address, \"$\")(1) &amp; LastRow).Copy\n\nWith objWord\n    .ActiveDocument.PageSetup.Orientation = 1\n    .Selection.Paste\n    .Visible = True\nEnd With\n\nIf objWord.ActiveDocument.Tables.Count &lt;&gt; 0 Then\n    objWord.ActiveDocument.Tables(1).AutoFitBehavior wdAutoFitWindow\nEnd If\n\nApplication.CopyObjectsWithCells = True\nThisWorkbook.Worksheets(\"Control Panel\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1448395853, "post_id": 33902846, "comment_id": 55568418, "body": "Yes, <code>Sheets(Sheets(&quot;Summary&quot;).Range(&quot;E7&quot;)).Range(&quot;F7:H7&quot;) = Sheets(&quot;Summary&quot;).Range(&quot;F7:H7&quot;)</code>"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1448445105, "post_id": 33902846, "comment_id": 55588204, "body": "Where in the new sheet would you like the copied data to be copied to ? It is possible to cycle through the cells E7:E17, and use their values as names for which sheet to copy to."}], "answers": [{"tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": true, "score": 0, "last_activity_date": 1448445734, "creation_date": 1448445734, "answer_id": 33913481, "question_id": 33902846, "link": "https://stackoverflow.com/questions/33902846/excel-vba-copy-data-from-summary-sheet-names-as-variables/33913481#33913481", "title": "Excel VBA - Copy data from summary - sheet names as variables", "body": "<p>If you still need it, the following code will cycle through the cells E7:E17, and uses their values as the sheet names.</p>\n\n<p>It will then take the data in the three columns to the right of that cell, and copy the data to cells A1:C1 on the sheet with the cells value.</p>\n\n<pre><code>Sub test()\n\nDim cell As Range, startSheet As String\n\nApplication.ScreenUpdating = False\n\nstartSheet = ActiveSheet.Name\n\nFor Each cell In Sheets(startSheet).Range(\"E7\", \"E17\")\n\n    If Not cell.Value = Empty Then\n        Sheets(cell.Value).Range(\"A1:C1\") = Sheets(startSheet).Range(cell.Offset(0, 1), cell.Offset(0, 4))\n    End If\n\nNext cell\n\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 33913481, "answer_count": 1, "score": 0, "last_activity_date": 1448445734, "creation_date": 1448395663, "last_edit_date": 1531164843, "question_id": 33902846, "link": "https://stackoverflow.com/questions/33902846/excel-vba-copy-data-from-summary-sheet-names-as-variables", "title": "Excel VBA - Copy data from summary - sheet names as variables", "body": "<p>Cells E7:E17 contain values of existing sheet names. Subsequent columns contain data to be copied to corresponding worksheet.\nEx. E7 value is Case 1 \nF7:H7 contain data to be copied to sheet called \"Case 1\"\nIs it possible to cycle the sheetname as a variable?</p>\n\n<p><a href=\"http://i.stack.imgur.com/XX0pv.jpg\" rel=\"nofollow\">Example</a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "is_accepted": false, "score": 0, "last_activity_date": 1448398416, "creation_date": 1448398416, "answer_id": 33903592, "question_id": 33902831, "link": "https://stackoverflow.com/questions/33902831/docmd-outputto-excel-microsoft-access-cant-save-the-output-data-to-the-file/33903592#33903592", "title": "Docmd.OutputTo Excel - &quot;Microsoft Access can&#39;t save the output data to the file you&#39;ve selected&quot;", "body": "<p>This worked for me:</p>\n\n<pre><code>While Len(Dir(FileName)) &lt;&gt; 0\nDim i As Integer\ni = i + 1\nFileName = \"CategoryBreakdown\" &amp; i &amp; \".xls\"\nWend\n</code></pre>\n\n<p>Critiques?</p>\n"}, {"comments": [{"owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "edited": false, "score": 0, "creation_date": 1448465038, "post_id": 33906201, "comment_id": 55601531, "body": "Thanks that looks nice."}], "tags": [], "owner": {"reputation": 453, "user_id": 2669681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efb225f101bbb27b11dc7b2209991c7d?s=128&d=identicon&r=PG", "display_name": "mdialogo", "link": "https://stackoverflow.com/users/2669681/mdialogo"}, "is_accepted": false, "score": 0, "last_activity_date": 1448409631, "creation_date": 1448409631, "answer_id": 33906201, "question_id": 33902831, "link": "https://stackoverflow.com/questions/33902831/docmd-outputto-excel-microsoft-access-cant-save-the-output-data-to-the-file/33906201#33906201", "title": "Docmd.OutputTo Excel - &quot;Microsoft Access can&#39;t save the output data to the file you&#39;ve selected&quot;", "body": "<p>Yes, it's best practice to add error handlers in your application to trap unexpected errors and share adequate information on what the user should do next.  Here's an example of error handler for your case:</p>\n\n<pre><code>Sub ExportToExcel()\n    On Error GoTo ErrHandler\n    Dim FileName As String\n    &lt;...your other codes here...&gt;\n\n    FileName = \"CategoryBreakdown.xls\"\n    DoCmd.OutputTo acOutputStoredProcedure, sqlSP, acFormatXLS, FileName, True\n\n    Exit Sub\nErrHandler:\n    If Err.Number = 2302 Then\n        MsgBox \"Cannot create \" &amp; FileName &amp; \" because it is currently open. Close the spreadsheet or save it under a different name.\", vbExclamation, \"Error\"\n    Else\n        MsgBox \"ExportToExcel encountered an unexpected error:\" &amp;  Err.Description, vbCritical, \"Error\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "edited": false, "score": 0, "creation_date": 1448902571, "post_id": 33928088, "comment_id": 55763266, "body": "I ended up doing something very similar to this. sans putting it in a public module so it could be reused. I like that idea."}, {"owner": {"reputation": 133, "user_id": 3554553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761f34ac6cd58754bd27a23f6d283b7?s=128&d=identicon&r=PG&f=1", "display_name": "Nur Ys", "link": "https://stackoverflow.com/users/3554553/nur-ys"}, "reply_to_user": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "edited": false, "score": 0, "creation_date": 1448902783, "post_id": 33928088, "comment_id": 55763429, "body": "in fact, i dont like using modules a lot, i prefer defining a class and put my functions in it, and for this case, i would put a shared key with methods needed to manipulate things. so its more secure and resuable"}], "tags": [], "owner": {"reputation": 133, "user_id": 3554553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761f34ac6cd58754bd27a23f6d283b7?s=128&d=identicon&r=PG&f=1", "display_name": "Nur Ys", "link": "https://stackoverflow.com/users/3554553/nur-ys"}, "is_accepted": true, "score": 0, "last_activity_date": 1448493371, "creation_date": 1448493371, "answer_id": 33928088, "question_id": 33902831, "link": "https://stackoverflow.com/questions/33902831/docmd-outputto-excel-microsoft-access-cant-save-the-output-data-to-the-file/33928088#33928088", "title": "Docmd.OutputTo Excel - &quot;Microsoft Access can&#39;t save the output data to the file you&#39;ve selected&quot;", "body": "<p>As understood from you, you want to keep the previously exported excel files as well as the new exports.</p>\n\n<p>so what you can do is to <strong>create a public function</strong> within a module, and an public increment variable, then <strong>call that function</strong> on a button click event and on the error 2302 as well...</p>\n\n<blockquote>\n  <p>The public function</p>\n</blockquote>\n\n<pre><code>Option Compare Database\n  Dim i As Integer\n  Public Sub exportXLS()\n    i = i + 1\n    Dim FileName As String\n    FileName = \"CategoryBreakdown\" &amp; i &amp; \".xls\"\n    DoCmd.OutputTo acOutputTable, \"Table1\", acFormatXLS, FileName, True\n  End Sub\n</code></pre>\n\n<blockquote>\n  <p>The button click Function</p>\n</blockquote>\n\n<pre><code>Private Sub cmdExportXLS_Click()\n  On Error GoTo ErrHandler\n  Call exportXLS\n  Exit Sub\nErrHandler:\n  If Err.Number = 2302 Then\n    Call exportXLS\n  Else\n    MsgBox \"error msg when other error occurs:\" &amp; Err.Description, vbCritical, \"Error\"\n  End If\nEnd Sub\n</code></pre>\n\n<p>This will increment the Filename on every export action or when and export action pops an error.</p>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3444, "favorite_count": 1, "accepted_answer_id": 33928088, "answer_count": 3, "score": 0, "last_activity_date": 1448493371, "creation_date": 1448395630, "last_edit_date": 1448396256, "question_id": 33902831, "link": "https://stackoverflow.com/questions/33902831/docmd-outputto-excel-microsoft-access-cant-save-the-output-data-to-the-file", "title": "Docmd.OutputTo Excel - &quot;Microsoft Access can&#39;t save the output data to the file you&#39;ve selected&quot;", "body": "<p>I am exporting some data to excel using a Docmd.Output. </p>\n\n<p><code>FileName = \"CategoryBreakdown.xls\"\n DoCmd.OutputTo acOutputStoredProcedure, sqlSP, acFormatXLS, FileName, True</code></p>\n\n<p>The error occurs when I've already exported the data once, and there is an open excel spreadsheet named \"CategoryBreakdown.xls\".</p>\n\n<p>Is the best practice to use On Error and show a message telling the user to close the spreadsheet/save it under a different name? Or is there a way to check during runtime if there is a file open with that name and to provide a different file name before it crashes?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "visual-studio", "excel", "vsto"], "answers": [{"comments": [{"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "edited": false, "score": 0, "creation_date": 1448396705, "post_id": 33902945, "comment_id": 55568853, "body": "And then use <code>vstoWorkbook</code> as the <code>In</code> in <code>For Each wks In vstoWorkbook</code>?"}, {"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "edited": false, "score": 0, "creation_date": 1448397103, "post_id": 33902945, "comment_id": 55569089, "body": "Tried this but same error, can you provide usage for this?"}, {"owner": {"reputation": 4382, "user_id": 3205529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/edAtA.jpg?s=128&g=1", "display_name": "Malick", "link": "https://stackoverflow.com/users/3205529/malick"}, "reply_to_user": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "edited": false, "score": 0, "creation_date": 1448398990, "post_id": 33902945, "comment_id": 55570146, "body": "I think you must declare an Excel.Workbook variable, instantiate in with ActiveWorkbook before to use it in a loop. Something like :  1)Dim wkb As Excel.Workbook  ....  2)wkb =  Globals.ThisAddIn.Application.ActiveWorkbook...3)  For Each wks In Wkb"}, {"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "edited": false, "score": 0, "creation_date": 1448401736, "post_id": 33902945, "comment_id": 55571619, "body": "Still no dice. Doing some more research on this now"}], "tags": [], "owner": {"reputation": 4382, "user_id": 3205529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/edAtA.jpg?s=128&g=1", "display_name": "Malick", "link": "https://stackoverflow.com/users/3205529/malick"}, "is_accepted": false, "score": 0, "last_activity_date": 1448398676, "last_edit_date": 1448398676, "creation_date": 1448396022, "answer_id": 33902945, "question_id": 33902759, "link": "https://stackoverflow.com/questions/33902759/unable-to-cast-com-object-of-type-excel-worksheetclass-for-vsto-add-in/33902945#33902945", "title": "Unable to cast COM object of type &#39;Excel.WorksheetClass&#39; for VSTO add-in", "body": "<p>You need to check if there is a worksheet (isnot nothing)</p>\n\n<pre><code>Dim NativeWorkbook As Microsoft.Office.Interop.Excel.Workbook =\nGlobals.ThisAddIn.Application.ActiveWorkbook\nIf NativeWorkbook IsNot Nothing Then\nDim vstoWorkbook As Microsoft.Office.Tools.Excel.Workbook =\n    Globals.Factory.GetVstoObject(NativeWorkbook)\nEnd If\n</code></pre>\n\n<p>see more information  : <a href=\"https://msdn.microsoft.com/fr-fr/library/cc442981.aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-3\" rel=\"nofollow\">here msdn</a></p>\n\n<p><strong>EDIT</strong> : here a working example but in C# , not in VB.NET, I think you can convert it because I'm not very efficient in VB.NET :</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application XL =   Globals.ThisAddIn.Application;\n            Microsoft.Office.Interop.Excel.Workbook xlWorkBook = default(Microsoft.Office.Interop.Excel.Workbook);\n            xlWorkBook = XL.ActiveWorkbook;\n            foreach (Microsoft.Office.Interop.Excel.Worksheet xs_loopVariable in xlWorkBook.Sheets)\n            {\n                    foreach (Microsoft.Office.Interop.Excel.ListObject objList in xs_loopVariable.ListObjects)\n                    {\n                     objList.Unlist();\n                    }\n            }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1448413757, "creation_date": 1448413757, "answer_id": 33906844, "question_id": 33902759, "link": "https://stackoverflow.com/questions/33902759/unable-to-cast-com-object-of-type-excel-worksheetclass-for-vsto-add-in/33906844#33906844", "title": "Unable to cast COM object of type &#39;Excel.WorksheetClass&#39; for VSTO add-in", "body": "<p>In plain vanilla VBA which you can adapt to your requirements:</p>\n\n<p>References to a Worksheet come from the Worksheets collection so code block #1 should have:</p>\n\n<pre><code>For Each wks In Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets\n</code></pre>\n\n<p>In code block #2, assigning a Worksheets collection to an Application object makes no sense - two different, incompatible types. Try this instead:</p>\n\n<pre><code>Dim exApp As Excel.Application\n\n' VBA requires Set for assigning any object type - remove\n' the Set keyword if not needed in your approach\nSet exApp = Globals.ThisAddIn.Application\n\nFor Each wks In exApp.ActiveWorkbook.Worksheets\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "is_accepted": true, "score": 1, "last_activity_date": 1448467560, "creation_date": 1448467560, "answer_id": 33921166, "question_id": 33902759, "link": "https://stackoverflow.com/questions/33902759/unable-to-cast-com-object-of-type-excel-worksheetclass-for-vsto-add-in/33921166#33921166", "title": "Unable to cast COM object of type &#39;Excel.WorksheetClass&#39; for VSTO add-in", "body": "<p>It turns out that there are 3 typecasting errors.</p>\n\n<p>1- the <code>wks</code> variable needs to be set to <code>Excel.Worksheet</code> since <code>Worksheet</code> is <code>Microsoft.Office.Tools.Execl.Worksheet</code> while the type I need is <code>Microsoft.Office.Interop.Excel.Sheet</code></p>\n\n<p>2- Same goes for the <code>objList</code> variable. Needs to be <code>Excel.ListObject</code> instead of <code>ListObject</code></p>\n\n<p>3- I need to search the collection <code>Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets</code></p>\n\n<p>That clears up all of the errors and allows the code to function without fail.</p>\n"}], "owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "accepted_answer_id": 33921166, "answer_count": 3, "score": 0, "last_activity_date": 1448467560, "creation_date": 1448395380, "last_edit_date": 1592644375, "question_id": 33902759, "link": "https://stackoverflow.com/questions/33902759/unable-to-cast-com-object-of-type-excel-worksheetclass-for-vsto-add-in", "title": "Unable to cast COM object of type &#39;Excel.WorksheetClass&#39; for VSTO add-in", "body": "<p>I have tried a few things and am still getting this error. I am creating an excel VSTO using VBA and Visual Studio.</p>\n<p>The way I have this setup is there is a button in the ribbon and that the user can click and it will go through and unlist all tables. I guess my issue lies with actually hooking onto the current active instance of Excel to loop through the worksheets.</p>\n<blockquote>\n<p>An exception of type 'System.InvalidCastException' occurred in ConvertAllTablesToRange.dll but was not handled in user code</p>\n<p>Additional information: Unable to cast COM object of type 'System.__ComObject' to interface type 'Microsoft.Office.Tools.Excel.Worksheet'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{297DC8D9-EABD-45A1-BDEF-68AB67E5C3C3}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)).</p>\n</blockquote>\n<p>Here's what I've tried:</p>\n<pre><code>Private Sub Button1_Click(sender As Object, e As RibbonControlEventArgs) Handles Button1.Click\n\n    Dim wks As Worksheet, objList As ListObject\n\n    For Each wks In Globals.ThisAddIn.Application.ActiveWorkbook  ' ERROR LINE\n\n        For Each objList In wks.ListObjects\n            objList.Unlist()\n        Next objList\n\n    Next wks\nEnd Sub\n</code></pre>\n<p>and</p>\n<pre><code>Private Sub Button1_Click(sender As Object, e As RibbonControlEventArgs) Handles Button1.Click\n    Dim wks As Worksheet, objList As ListObject\n    Dim exApp As Excel.Application\n\n    exApp = Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets\n\n    For Each wks In exApp.Worksheets\n        For Each objList In wks.ListObjects\n            objList.Unlist()\n        Next objList\n    Next wks\nEnd Sub\n</code></pre>\n<p>Both of which throw the same error</p>\n"}]