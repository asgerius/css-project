[{"tags": ["excel", "vba", "testing"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1553730791, "post_id": 55388128, "comment_id": 97498185, "body": "Hi and welcome! Can you <a href=\"https://stackoverflow.com/posts/55388128/edit\">edit</a> your question and post the error message as text so others may search this solution. Currently the title is too vague to help anyone find it or be of use. The goal of SE sites is to become a resource of knowledge, of answers, for years to come."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1553731646, "post_id": 55388128, "comment_id": 97498385, "body": "When you <i>get syntax error</i>, you also get an error message, and that error message should be included in your post. It&#39;s information you already have on your screen, but we can&#39;t see your screen from here. Adding it to you question makes it much easier for people to help you, and it&#39;s to your advantage to make it as easy as possible for them to do so by including the details you already have about the problem. Also, having the error message in the post means that it&#39;s searchable, so it can be found by others in the future who are trying to solve the same sort of problem."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1553730554, "creation_date": 1553730554, "answer_id": 55388160, "question_id": 55388128, "link": "https://stackoverflow.com/questions/55388128/very-green-vba-user-everything-below-2nd-line-works-but-how-do-i-make-above-it/55388160#55388160", "title": "Very green VBA user, everything below 2nd line works, but how do I make above it work?", "body": "<p>VBA never uses <code>==</code> for a comparison operator. Use <code>=</code> instead. Also, I presume that you want to refer to <em>range</em> <code>K11</code> rather than some unspecified variable. Thus, replace</p>\n\n<pre><code>If K11.Value == \"Correct!\" Then\n</code></pre>\n\n<p>by</p>\n\n<pre><code>If Range(\"K11\").Value = \"Correct!\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553760474, "creation_date": 1553760474, "answer_id": 55392764, "question_id": 55388128, "link": "https://stackoverflow.com/questions/55388128/very-green-vba-user-everything-below-2nd-line-works-but-how-do-i-make-above-it/55392764#55392764", "title": "Very green VBA user, everything below 2nd line works, but how do I make above it work?", "body": "<p>Some Tips:</p>\n\n<ul>\n<li>In order to avoid confusion, used a With Statement declaring the sheet you want to target</li>\n<li>use \".\" before \"Range\" to impose the range in the Sheet With Statement\" </li>\n<li>Avoid ActiveSheet &amp; Select</li>\n<li><p>If you will refer to a range more than one times used With Statement.</p>\n\n<pre><code>Sub answer_correct()\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n\n    If .Range(\"K11\").Value = \"Correct!\" Then\n\n        .Range(\"A1\").Value = WorksheetFunction.RandBetween(1, 65)\n\n        With .Range(\"I11\")\n            .ClearContents\n            .Select '&lt;- I keep .Select to show the With Statement for the range.\n        End With\n\n        .Range(\"F18\").Value = .Range(\"F18\").Value + 1\n\n    End If\n\nEnd With\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 2455933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559d7d52989977a16da3620fed5bb7d2?s=128&d=identicon&r=PG", "display_name": "user2455933", "link": "https://stackoverflow.com/users/2455933/user2455933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553760474, "creation_date": 1553730269, "last_edit_date": 1553730334, "question_id": 55388128, "link": "https://stackoverflow.com/questions/55388128/very-green-vba-user-everything-below-2nd-line-works-but-how-do-i-make-above-it", "title": "Very green VBA user, everything below 2nd line works, but how do I make above it work?", "body": "<p>I have made a test in Excel for my cousin; right now if you get the answer correct then you have to press a button for the next question, but I would like the macro to show \"correct\" for 2 seconds then move on to the next question without having to press a button. Please help</p>\n\n<p>I've tried below, it used to be regular button click macro, but i've tried to change it and it won't run</p>\n\n<pre><code>Sub answer_correct()\n\nIf K11.Value == \"Correct!\" Then\n\nRange(\"A1\") = WorksheetFunction.RandBetween(1, 65)\n\nRange(\"I11\").Cells.ClearContents\n\nActiveSheet.Range(\"I11\").Select\n\nRange(\"F18\").Value = Range(\"F18\").Value + 1\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I get syntax error, I expect the counter to go up by 1 and the question to reset</p>\n"}, {"tags": ["excel", "vba", "loops", "web-scraping", "next"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1553737850, "post_id": 55388108, "comment_id": 97499681, "body": "Please seek help at <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>  and completely shorten your question to its main problem.  Paste in the problem code Fragment.  Include some of your test data, and state the expected results."}, {"owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1553738433, "post_id": 55388108, "comment_id": 97499805, "body": "Hi donpablo, I believe I have done all that as much as I can, is no one able to help me with the details I submitted, I gave alot to help."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1553743276, "post_id": 55388108, "comment_id": 97500741, "body": "your code, as is, shouldn&#39;t run. You have a stranded End If  just sitting there at the top with no start If. It is worth reading why using .Select is rarely a good idea <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a>. You also don&#39;t won&#39;t to be creating and destroying IE instances in a loop when you can simply work with the same instance throughout. Not sure what valueofInterest is as well. Can it be removed?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553743444, "post_id": 55388108, "comment_id": 97500774, "body": "You also have a page load wait at the top before you have navigated to a page and multiple repeat page load waits with hardcoded waits -too many IMO.  Sorry for the large number of comments."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553744155, "post_id": 55388108, "comment_id": 97500910, "body": "I&#39;m not going to post essentially the same answer again. I know you want to preserve as much of your code as possible so I will just leave a link here to a slightly updated version of my answer and suggest you review the structure of the loop, how waits are set up and the fact IE is only created once. <a href=\"https://pastebin.com/TW9hdWw0\" rel=\"nofollow noreferrer\">pastebin.com/TW9hdWw0</a>"}, {"owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "edited": false, "score": 0, "creation_date": 1553760980, "post_id": 55388108, "comment_id": 97506253, "body": "Hi qharr, hope you are well. Thank you for your time in this. I willlooom at your updates and your helpful insight and see where I end up. Have a nice day"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553809109, "post_id": 55388108, "comment_id": 97534970, "body": "Hi. here is another link showing you how to use a For Each over the range of cells containing your lookup values. You might find that easier. Ignore all my other code and just focus on how For Each rng In inputValues  works and how rng  is the current cell in the loop down the column X and the current row number comes from rng.row <a href=\"https://pastebin.com/dzz7Jvgj\" rel=\"nofollow noreferrer\">pastebin.com/dzz7Jvgj</a>"}, {"owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "edited": false, "score": 0, "creation_date": 1553813094, "post_id": 55388108, "comment_id": 97536292, "body": "hi qharr, thank you I will look in to that now, I have been looing up loops, arrays and that more, so much to consider, I am feeling the base of my knowledge is weak and maybe this is too far advanced for me."}], "owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553742774, "creation_date": 1553730023, "last_edit_date": 1553742774, "question_id": 55388108, "link": "https://stackoverflow.com/questions/55388108/loop-through-column-of-cells-checking-car-reg-in-website-then-move-to-next-one", "title": "loop through column of cells checking car reg in website, then move to next one after dates put in next column", "body": "<p>I need some help, not mentally haha that's a different problem, this problem I have put tens of hours in and literally cant find what type of loop or next will help me loop through my code, I have done a lot of research on do until loops which just keep looping through the first car registration endlessly or next loops which will work down the car registration column but wont actually use the next car reg. What I want my sheet to do is take a car registration and check its tax and mot date and then take that mot and tax date or lack of date and put it in the column next to the car registration, once done for it to do the same with the next car reg (which is currently in column x). also if there is an error or no date for it to just put no date in the cell next to the car reg and still move on to the next car reg to do the same check until the a cell in column x is blank/ empty. I had help from some people on here and got some working code already for the other bits, I want to keep this code as it is as much as possible, I am new to all of this so need to keep consistency for my self while I learn, been doing it 3 weeks now so not long and anything new will kick me off the tracks and complicate things for me.</p>\n\n<p>to help the first car reg will be in column x row 3, and the next car reg after will be in column x row 4 and so on. the dates for the relative car reg I am putting in the column next to the car reg it relates to.</p>\n\n<p>i am a fraud investigator and think the way forward is software driven by fraud experts, this is for excel vba (as most companies use excel for management information reports and data analytics), its a project I am doing for my self to help me progress at work and prevent fraud so your help here personally will help me down the line. I have appreciated the help so far from this site so thank you to those who helped me so far.</p>\n\n<pre><code>Sub TAXandMOTcheck()\n\n'dimension (declare or set aside memory for) our variables\n    Dim objIE As InternetExplorer 'special object variable representing the IE browser\n\n'''''''''''''''''''''''''''''''''''''''''''\n\nDim valueofInterest As Integer\n\nRange(\"x3\").Select\n\n Do Until ActiveCell.Empty\n\nEnd If\nActiveCell.Offset(1, 0).Select\n\n\n\n'''''''''''''''''''''''''''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''\n' START OF THE CODE THAT WORKS, PLEASE DONT CHANGE IT IF POSSIBLE '''''''''''''''''''''''''''''''''''''''''''\n\n'OPEN INTERNET\n\n'initiating a new instance of Internet Explorer and asigning it to objIE\n    Set objIE = New InternetExplorer\n\n'wait # seconds\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''\n\n'OPEN TAX/ MOT PAGE\n\n'navigate IE to this web page (a pretty neat search engine really)\n    objIE.Navigate \"https://vehicleenquiry.service.gov.uk/\"\n\n'make IE browser visible (False would allow IE to run in the background)\n    objIE.Visible = True\n\n'wait # seconds\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''\n\n'ENTER DETAILS IN TO PAGE\n\n'in the search box put cell \"x3\" value\n    objIE.Document.getElementById(\"Vrm\").Value = _\n    Sheets(\"INPUT DATA\").Range(\"x3\").Value\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'wait # seconds\n    Application.Wait Now + TimeValue(\"00:00:03\")\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'click the 'Continue' button\n    objIE.Document.getElementsByClassName(\"button\")(0).Click\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'wait # seconds\n    Application.Wait Now + TimeValue(\"00:00:03\")\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'click the 'Yes' button\n    objIE.Document.getElementById(\"Correct_True\").Click\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'click the 'Continue' button\n    objIE.Document.getElementsByClassName(\"button\")(0).Click\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'wait # seconds\n    Application.Wait Now + TimeValue(\"00:00:03\")\n\n'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'TAX EXPIRY DATE:\n\n'get data inside element\n    TaxExpiryDate = objIE.Document.getElementsByClassName(\"status-bar\")(0).getElementsByTagName(\"strong\")(0).innerText\n\n'split the date from the words\n    TaxExpiryDate = Split(TaxExpiryDate, vbNewLine)(1)\n\n'add tax date to sheet\n    Range(\"y3\").Value = TaxExpiryDate\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'MOT EXPIRY DATE:\n\n'get data inside element\n    MotExpiryDate = objIE.Document.getElementsByClassName(\"status-bar\")(0).getElementsByTagName(\"strong\")(1).innerText\n\n'split the date from the words\n    MotExpiryDate = Split(MotExpiryDate, vbNewLine)(1)\n\n'add mot date to sheet\n    Range(\"z3\").Value = MotExpiryDate\n\n'''''''''''''''''''''''''''''''''''''''''''\n\n'close the browser\n    objIE.Quit\n\n'''''''''''''''''''''''''''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''\n' END OF THE ABOVE CODE THAT WORKS, PLEASE DONT CHANGE THIS IF POSSIBLE '''''''''''''''''''''''''''''''''''''''''''\n\n\n\n\nLoop\n\n\n'''''''''''''''''''''''''''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''\n' THE BELOW CODE WORKS PLEASE DONT CHANGE IT IF POSSIBLE '''''''''''''''''''''''''''''''''''''''''''\n\n'message boxes if true or false\n\n    If found = True Then\n    MsgBox \"Value found in cell\" &amp; ActiveCell.Address\n    Else\n    MsgBox \"Be Happy and Smile, its the end of the search. Just keep swimming, just keep swimming...\"\n    End If\n\n'''''''''''''''''''''''''''''''''''''''''''\n\n'exit our SearchBot subroutine and start new row for new website data\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553726277, "post_id": 55387365, "comment_id": 97496877, "body": "Your first example should have worked fine.  Are you sure your code is in a Sub or Function?"}, {"owner": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553790813, "post_id": 55387365, "comment_id": 97525862, "body": "Very good question, I didn&#39;t even think of that one! Will check it."}], "answers": [{"tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": false, "score": 0, "last_activity_date": 1553726404, "last_edit_date": 1553726404, "creation_date": 1553725584, "answer_id": 55387415, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55387415#55387415", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>try this:</p>\n\n<pre><code>For sht = 1 To Sheets.Count\n    Debug.Print sht\n    'your code here\n    Sheets(sht).Activate'or\n    Sheets(Sheets(sht).Name).Activate\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "edited": false, "score": 0, "creation_date": 1553795327, "post_id": 55387877, "comment_id": 97528419, "body": "I&#39;ve done this one and it skips everything from &quot;With iSheet&quot; all the way to the second &quot;End With&quot;."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "edited": false, "score": 0, "creation_date": 1553801546, "post_id": 55387877, "comment_id": 97531692, "body": "It should only do that for sheets whose name didn&#39;t begin with &quot;Table&quot;"}, {"owner": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "edited": false, "score": 0, "creation_date": 1553810148, "post_id": 55387877, "comment_id": 97535332, "body": "When I do the above code, it gives me a &quot;Compile error: Next without For&quot;"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1553810589, "last_edit_date": 1553810589, "creation_date": 1553728336, "answer_id": 55387877, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55387877#55387877", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>This should work:</p>\n\n<pre><code>Sub TFRdataExtract()\n\n    Dim iSheet As Worksheet, rngCopy As Range\n\n    For Each iSheet In ThisWorkbook.WorkSheets\n\n        If iSheet.Name Like \"Table*\" Then\n\n            With iSheet                                            '&lt;&lt; no need to activate!\n                .Range(\"AB1\").FormulaR1C1 = \"=MID(RC[-27], 7,100)\" '&lt;&lt; no need to select!\n                .Range(\"AC1\").FormulaR1C1 = \"=MID(RC[-24], 14,100)\"\n                .Range(\"AD1\").FormulaR1C1 = \"=MID(RC[-19],23,100)\"\n                'etc etc\n\n\n                Set rngCopy = .Range(\"AB1:CY1\")\n            End with\n\n            'assign values directly\n            With ThisWorkbook.Sheets(\"Combined\").Range(\"A2\")\n                .Resize(rngCopy.Rows.Count, _\n                        rngCopy.Columns.Count).Value = rngCopy.Value\n            End with\n\n        End If 'EDIT - added\n\n    Next iSheet\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11176825, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TY7Urtamtx0/AAAAAAAAAAI/AAAAAAAAAAc/OTYEshYsBlk/photo.jpg?sz=128", "display_name": "Furry Chemistry", "link": "https://stackoverflow.com/users/11176825/furry-chemistry"}, "edited": false, "score": 0, "creation_date": 1553729059, "post_id": 55387977, "comment_id": 97497742, "body": "Sub procedure &#39;CopyRange&#39; does not handle merged cells in destination."}], "tags": [], "owner": {"reputation": 11, "user_id": 11176825, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TY7Urtamtx0/AAAAAAAAAAI/AAAAAAAAAAc/OTYEshYsBlk/photo.jpg?sz=128", "display_name": "Furry Chemistry", "link": "https://stackoverflow.com/users/11176825/furry-chemistry"}, "is_accepted": false, "score": 0, "last_activity_date": 1553728968, "creation_date": 1553728968, "answer_id": 55387977, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55387977#55387977", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>Perhaps this will help. Commented to help understand what is going on.</p>\n\n<pre><code>'// Modify as desired, like to empty rows/columns.\nPrivate Function GetRangeToCopy(zWorksheet As Worksheet) As Range\n    Set GetRangeToCopy= zWorksheet.UsedRange\nEnd Function\n\n\n'// Modify to add spacing or whatnot.\nPrivate Function GetDestinationRange(zDestinationWorksheet As Worksheet, zRowCount As Long, zColumnCount As Long) As Range\n    Dim zReturnRange As Range\n    Dim zNewRowIndex As Long\n\n    Let zNewRowIndex = zDestinationWorksheet.UsedRange.End.Row + 3 '// Increase to add more rows between inserts.\n    Set zReturnRange = zDestinationWorksheet.\n\n    Set GetDestinationRange = zReturnRange\nEnd Function\n\n\n'// Copies a range to the destination range.\nPrivate Sub CopyRange(zSourceRange As Range, zDestinationRange As Range)\n    '// This is where copying styles and such would be done.\n    '// We will just call copy for simplicity.\n\n    '// Clear.\n    Call zDestinationRange.Clear\n\n    '// Copy.\n    Call zSourceRange.Copy(zDestinationRange)\nEnd Sub\n\n\n'// Copy worksheets to a destination worksheet.\n'// Destination worksheet can be a worksheet loaded into a different workbook altogether.\nPublic Sub CopyWorksheetsTo(zDestinationWorksheet As Worksheet, zClearDestinationWorksheet As Boolean = False _\nzPopupCurrentWorksheet As Boolean = True)\n    Dim zCurrentWorksheet As Worksheet\n    Dim zCurrentWorksheet_Var As Variant\n    Dim zRangeToCopy As Range\n    Dim zDestinationRange As Range\n\n    '// Clear destination.\n    If (zClearDestinationWorksheet) Then\n        Call zDestinationWorksheet.UsedRange.Clear\n    End If\n\n    '// Cycle through each worksheet in the workbook.\n    ForEach zCurrentWorksheet_Var in Worksheets\n        '// this allow us the Intellisense while coding.\n        Set zCurrentWorksheet = zCurrentWorksheet_Var\n\n        '// Make sure this isn't the destination worksheet.\n        If (zCurrentWorksheet.Name &lt;&gt; zDestinationWorksheet.Name) Then\n            '// Popup worksheet name.\n            If (zPopupCurrentWorksheet) Then\n                Call MsgBox(zCurrentWorksheet.Name)\n            End If\n\n            '// Get range to be copied.\n            Set zRangeToCopy = GetRangeToCopy(zCurrentWorksheet)\n\n            '// Get destination range.\n            Set zDestinationRange = GetDestinationRange(zDestinationWorksheet)\n\n            '// Copy range.\n            Call CopyRange(zRangeToCopy, zDestinationRange)\n        End If\n    Next xCurrentWorksheet_Var\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1553729841, "creation_date": 1553729841, "answer_id": 55388089, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55388089#55388089", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p><em>To loop on all Worksheets</em></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n'   // Declare your Variables\n    Dim Sht As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n\n    '// loop on all sheets\n    For Each Sht In Worksheets\n        Debug.Print Sht.Name\n        'Do something\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .DisplayAlerts = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10313264, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217881355013641/picture?type=large", "display_name": "Mathew Raju", "link": "https://stackoverflow.com/users/10313264/mathew-raju"}, "is_accepted": false, "score": 0, "last_activity_date": 1553748615, "creation_date": 1553748615, "answer_id": 55390367, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55390367#55390367", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>Try this code snippet. I am already using this in a macro.   </p>\n\n<pre><code>Sub Combine()\n\n' ensure you have placed the \"combined\" worksheet as the first sheet\n\n'variable declaration\nDim J As Integer\n\n'copying header row from second sheet\nSheets(2).Activate\nRange(\"A1\").EntireRow.Select\nSelection.Copy Destination:=ThisWorkbook.Sheets(\"combined\").Range(\"A1\")\n\n\n\n'copying data from other sheets\nFor J = 2 To 4\nSheets(J).Activate\nRange(\"A1\").Select\nSelection.CurrentRegion.Select\nSelection.Offset(1, 0).Resize(Selection.Rows.Count - 1).Select\nSelection.Copy Destination:=ThisWorkbook.Sheets(\"combined\").Range(\"A65536\")_\n.End(xlUp) (2)\nNext\n\nThisWorkbook.Worksheets(\"combined\").Columns.AutoFit\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "edited": false, "score": 0, "creation_date": 1553811475, "post_id": 55393143, "comment_id": 97535784, "body": "This seems to work but skips the macro from &quot;With ws&quot; all the way to &quot;Next ws&quot;. It just will not enter the macro..."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553763975, "last_edit_date": 1553763975, "creation_date": 1553762089, "answer_id": 55393143, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook/55393143#55393143", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>In my opinion you should try to avoid <strong>.Select</strong>. Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n\n    With ThisWorkbook\n\n        For Each ws In .Worksheets\n\n            If ws.Name = \"Table 1\" Then\n\n                With ws\n\n                    .Range(\"AB1\").FormulaR1C1 = \"=MID(RC[-27], 7,100)\"\n                    .Range(\"AC1\").FormulaR1C1 = \"=MID(RC[-24], 14,100)\"\n                    .Range(\"AD1\").FormulaR1C1 = \"=MID(RC[-19],23,100)\"\n                    .Range(\"AE1\").FormulaR1C1 = \"=MID(RC[-10],22,100)\"\n                    .Range(\"AF1\").FormulaR1C1 = \"=MID(R[1]C[-31], 23,100)\"\n                    '....... Add more formulas\n                    .Range(\"AB1:CY1\").Copy\n\n\n                End With\n\n                With .Worksheets(\"Combined\").Range(\"A2\")\n                    .PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n                End With\n\n            End If\n\n        Next ws\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9687358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXGAr.jpg?s=128&g=1", "display_name": "Tonja", "link": "https://stackoverflow.com/users/9687358/tonja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 6, "score": 1, "last_activity_date": 1553810589, "creation_date": 1553725291, "last_edit_date": 1553729548, "question_id": 55387365, "link": "https://stackoverflow.com/questions/55387365/how-to-get-my-vba-code-to-loop-through-all-sheets-in-workbook", "title": "How to get my VBA Code to loop through all sheets in workbook?", "body": "<p>I have 5 worksheets in my workbook(Table 1, Table 2, Table 3, Table 4 and Combined). The main Worksheet is the one I am trying to combine the other 4 into and place the data on the next blank line. </p>\n\n<p>I have been googling different code solutions for weeks to no avail. </p>\n\n<p>When I step through the macro and use the loop (do while, for and Each), it is only looping through Table 1 perfectly. But I cannot get it to loop through Sheets 2-4. </p>\n\n<p>I think I know where my issue is, but in my weeks of googling, I still can't find the solution.  I think the issue is on the line where it reads \"Sheets(\"Table 1\").Select\".  Because the code seems to work till it gets to that line. Then it \"of course\" goes back to Table 1.  </p>\n\n<p>This is a test group for a much larger project. I have to pull information from 500 documents that are all set up in the exact same position, but I have to get these 4 to work first. </p>\n\n<p>'I have tried this:</p>\n\n<pre><code>Dim iSheet As Object\n\nFor Each iSheet In ThisWorkbook.Sheets\n    MsgBox iSheet.Name\n    Next iSheet\n</code></pre>\n\n<p>'And I tried this:</p>\n\n<pre><code>Dim useWorkSheet As Worksheet\nDim totalWorkSheet As Worksheet\nDim tableAsNumeric As Integer\nDim startingTable As Integer\n\n'For Each Current In Worksheets\n'Table Name = Table in Worksheets\n\nstartingTable = 1\n\nSet totalWorkSheet = ActiveWorkbook.Sheets(\"Table 1\")\n\nFor Each useWorkSheet In ActiveWorkbook.Worksheets\n    tableAsNumeric = Val(useWorkSheet.Name)\n\n    'If tableAsNumeric &gt;= startingTable Then\n\n'Do While I &gt;= Worksheet(\"Table 1\")\n'I = I + 1\n</code></pre>\n\n<p>'I have also tried a for loop and as many others as there are out on the net...  Nothing works...</p>\n\n<p>This is the code I need help with:</p>\n\n<pre><code>Sub TFRdataExtract()\n'\n' TFRdataExtract Macro\n' Extract Data from Individual TFR files to the combined file.\n'\n' Keyboard Shortcut: Ctrl+e\n'\n\nDim iSheet As Object\n\nFor Each iSheet In ThisWorkbook.Sheets\n    MsgBox iSheet.Name\n\n    Sheets(\"Table 1\").Select\n    Range(\"AB1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(RC[-27], 7,100)\"\n    Range(\"AC1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(RC[-24], 14,100)\"\n    Range(\"AD1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(RC[-19],23,100)\"\n    Range(\"AE1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(RC[-10],22,100)\"\n    Range(\"AF1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[1]C[-31], 23,100)\"\n    Range(\"AG1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[1]C[-16], 10,100)\"\n    Range(\"AH1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[1]C[-13],13,100)\"\n    Range(\"AI1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[2]C[-34],22,100)\"\n    Range(\"AJ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[2]C[-25],18,100)\"\n    Range(\"AK1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[2]C[-16],21,100)\"\n    Range(\"AL1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[3]C[-37],21,100)\"\n    Range(\"AM1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[3]C[-28],17, 100)\"\n    Range(\"AN1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[3]C[-21],34,100)\"\n    Range(\"AO1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[4]C[-40],28,100)\"\n    Range(\"AP1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[4]C[-35], 7,100)\"\n    Range(\"AQ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[4]C[-34],10,100)\"\n    Range(\"AR1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[4]C[-29],10,100)\"\n    Range(\"AS1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[4]C[-21],22,100)\"\n    Range(\"AT1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[5]C[-45],26,100)\"\n    Range(\"AU1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[6]C[-46],18,100)\"\n    Range(\"AV1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[6]C[-37],55,100)\"\n    Range(\"AW1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[7]C[-48],36,100)\"\n    Range(\"AX1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[7]C[-39],30,100)\"\n    Range(\"AY1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[7]C[-28],12,100)\"\n    Range(\"AZ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[8]C[-51],20,100)\"\n    Range(\"BA1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[8]C[-35],12,100)\"\n    Range(\"BB1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[8]C[-31],20,100)\"\n    Range(\"BC1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[9]C[-54],25,100)\"\n    Range(\"BD1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[9]C[-45],15,100)\"\n    Range(\"BE1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[9]C[-39],23,100)\"\n    Range(\"BF1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[10]C[-57],17,100)\"\n    Range(\"BG1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[10]C[-56],17,100)\"\n    Range(\"BH1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[10]C[-52],13,100)\"\n    Range(\"BI1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[10]C[-42],14,100)\"\n    Range(\"BJ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[10]C[-38],15,100)\"\n    Range(\"BK1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-62],11,100)\"\n    Range(\"BL1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-62],12,100)\"\n    Range(\"BM1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-59],10,100)\"\n    Range(\"BN1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-57], 7,100)\"\n    Range(\"BO1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-55],7,100)\"\n    Range(\"BP1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-55],11,100)\"\n    Range(\"BQ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-53],12,100)\"\n    Range(\"BR1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-50],8,100)\"\n    Range(\"BS1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[12]C[-47],12,100)\"\n    Range(\"BT1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-71],10,100)\"\n    Range(\"BU1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-71],20,100)\"\n    Range(\"BV1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-66],10,100)\"\n    Range(\"BW1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-63],10,100)\"\n    Range(\"BX1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-62],8,100)\"\n    Range(\"BY1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-61],7,100)\"\n    Range(\"BZ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-59],9,100)\"\n    Range(\"CA1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-57],10,100)\"\n    Range(\"CB1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[13]C[-55],13,100)\"\n    Range(\"CC1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-80],12,100)\"\n    Range(\"CD1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-80],13,100)\"\n    Range(\"CE1\").Select\n    ActiveCell.FormulaR1C1 = \"\"\n    Range(\"CE1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-77],15,100)\"\n    Range(\"CF1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-72],7,100)\"\n    Range(\"CG1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-71],13,100)\"\n    Range(\"CH1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-67],14,100)\"\n    Range(\"CI1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[14]C[-62],7,100)\"\n    Range(\"CJ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[15]C[-87],13,100)\"\n    Range(\"CK1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[15]C[-85],15,100)\"\n    Range(\"CL1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[15]C[-82],11,100)\"\n    Range(\"CM1\").Select\n    ActiveCell.FormulaR1C1 = \"L16,11,100)\"\n    Range(\"CN1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[15]C[-73],15,100)\"\n    Range(\"CO1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[15]C[-68],8,100)\"\n    Range(\"CP1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[17]C[-93],19,100)\"\n    Range(\"CQ1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[17]C[-80],22,100)\"\n    Range(\"CR1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[18]C[-95],27,100)\"\n    Range(\"CS1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[18]C[-82],18,100)\"\n    Range(\"CT1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[19]C[-97],45,100)\"\n    Range(\"CU1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[19]C[-89],22,100)\"\n    Range(\"CV1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[19]C[-81],49,100)\"\n    Range(\"CW1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[20]C[-91],21,100)\"\n    Range(\"CX1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(R[21]C[-101],16,100)\"\n    Range(\"CY1\").Select\n    ActiveCell.FormulaR1C1 = \"=MID(22,27,100)\"\n    Range(\"CZ1\").Select\n    ActiveWindow.SmallScroll Down:=-3\n    Range(\"CY1\").Select\n    ActiveWindow.SmallScroll ToRight:=-50\n    Range(\"AB1:CY1\").Select\n    Range(\"CY1\").Activate\n    Selection.Copy\n    Sheets(\"Combined\").Select\n    Rows(\"2:2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Next iSheet\n\nEnd Sub\n</code></pre>\n\n<p>I need to loop through all 4 Worksheets and paste data onto the Combined file into the next blank line.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7355043, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635262476798986/picture?type=large", "display_name": "&#214;v&#252;n&#231; G&#252;neri", "link": "https://stackoverflow.com/users/7355043/%c3%96v%c3%bcn%c3%a7-g%c3%bcneri"}, "edited": false, "score": 0, "creation_date": 1553727590, "post_id": 55387523, "comment_id": 97497289, "body": "Thanks for your answer. Yes this could also work but \u0131 should have to update my source sheet. this is why \u0131 have done the way that \u0131 used in the code. Also this still not solves my problem too. :("}, {"owner": {"reputation": 23, "user_id": 7355043, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635262476798986/picture?type=large", "display_name": "&#214;v&#252;n&#231; G&#252;neri", "link": "https://stackoverflow.com/users/7355043/%c3%96v%c3%bcn%c3%a7-g%c3%bcneri"}, "edited": false, "score": 0, "creation_date": 1553858864, "post_id": 55387523, "comment_id": 97551720, "body": "Thanks for your answer again. But as I have mentioned in the description its an Activex listbox which is located in the worksheet, its not located in the userform. I&#39;ve tried what you have suggested to me but it&#39;s not working for the Activex objects."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1553813077, "last_edit_date": 1553813077, "creation_date": 1553726136, "answer_id": 55387523, "question_id": 55387242, "link": "https://stackoverflow.com/questions/55387242/im-having-an-automation-error-404-while-trying-to-refresh-activex-listbox-fille/55387523#55387523", "title": "I&#39;m having an Automation error 404 while trying to refresh activex listbox filledrange", "body": "<p>I would try working with something like this:</p>\n\n<pre><code>For i = ListBox1.ListCount - 1 To 0 Step -1\n        If ListBox1.Selected(i) Then\n            ListBox1.RemoveItem i\n        End If\n Next i\n</code></pre>\n\n<p>Edit: then you can delete the row at your \u201cSolve\u201d sheet with your code and update listrange like this:</p>\n\n<pre><code>Private sub userform_initialize()\nWith Worksheets(\"Solve\").Range(\"A2:A\" &amp; lastrow) '&lt;-- change with your range\n                Me.ListBox1.List = Application.Transpose(.Cells)\n                Set listRng = .Cells\n    End With \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7355043, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635262476798986/picture?type=large", "display_name": "&#214;v&#252;n&#231; G&#252;neri", "link": "https://stackoverflow.com/users/7355043/%c3%96v%c3%bcn%c3%a7-g%c3%bcneri"}, "is_accepted": true, "score": 0, "last_activity_date": 1554851573, "creation_date": 1554851573, "answer_id": 55602554, "question_id": 55387242, "link": "https://stackoverflow.com/questions/55387242/im-having-an-automation-error-404-while-trying-to-refresh-activex-listbox-fille/55602554#55602554", "title": "I&#39;m having an Automation error 404 while trying to refresh activex listbox filledrange", "body": "<p>I have found an solution for my problem here is my edited code.</p>\n\n<pre><code>Set s = Worksheets(\"Solve\")\nSet sd = Worksheets(\"SrData\")\nDim lastrow As Integer\nDim target As String\nDim sheetcontrol As String\n\nApplication.ScreenUpdating = False\n\ntarget = s.ListBox1.List(s.ListBox1.ListIndex)\nlastrow = sd.Cells(sd.Rows.Count, \"A\").End(xlUp).Row\n\nIf IsNull(ListBox1) Then\n\n    MsgBox \"You haven't selected an Sales Representative. Please Select one.\"\n\nElse\n\n    If MsgBox(\"Are you sure you want to delete this Sales Representative?\", vbYesNo + vbQuestion, \"Delete Sales Representative\") = vbYes Then\n\n    For i = 2 To lastrow\n         sheetcontrol = sd.Cells(i, 1)\n\n         If sheetcontrol = target Then\n\n            s.ListBox1.ListIndex = -1\n\n            sd.Rows(i).Delete\n            sd.Activate\n            ActiveWorkbook.Names(\"SrDat\").Delete\n            Range(\"'SrData'!$A$2:$C$\" &amp; lastrow - 1).Name = \"SrDat\"\n            s.Activate\n        End If\n     Next i\n     End If\n\nEnd If\nrefSr\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>in refSr part I'm doing the</p>\n\n<pre><code>    With Worksheets(\"Solve\").OLEObjects(\"ListBox1\")\n        .ListFillRange = .ListFillRange\n    End With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7355043, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635262476798986/picture?type=large", "display_name": "&#214;v&#252;n&#231; G&#252;neri", "link": "https://stackoverflow.com/users/7355043/%c3%96v%c3%bcn%c3%a7-g%c3%bcneri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 55602554, "answer_count": 2, "score": 0, "last_activity_date": 1554851573, "creation_date": 1553724658, "last_edit_date": 1553727300, "question_id": 55387242, "link": "https://stackoverflow.com/questions/55387242/im-having-an-automation-error-404-while-trying-to-refresh-activex-listbox-fille", "title": "I&#39;m having an Automation error 404 while trying to refresh activex listbox filledrange", "body": "<p>I'm worikng on a project for my senior year project and I have to deal with the Activex controls for my userinterface. For deleting the single item in the listbox, I have written the code below.</p>\n\n<p>When I debug the code, I'm having an \"automation error 404\" at the last part of my code:</p>\n\n<pre><code>With Worksheets(\"Solve\").OLEObjects(\"ListBox1\")\n        .ListFillRange = .ListFillRange\nEnd With\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim i As Integer\nDim lastrow As Integer\n\nlastrow = Sheets(\"SrData\").Cells(Sheets(\"SrData\").Rows.Count, \"A\").End(xlUp).Row\n\n\nIf MsgBox(\"Are you sure you want to delete this Sales Representative?\", vbYesNo + vbQuestion, \"Delete Sales Representative\") = vbYes Then\n\n    For i = 2 To lastrow\n\n\n        sheetcontrol = Sheets(\"SrData\").Cells(i, 1)\n        listcontrol = Sheets(\"Solve\").ListBox1.List(Sheets(\"Solve\").ListBox1.ListIndex)\n\n        If sheetcontrol = listcontrol Then\n\n            Sheets(\"SrData\").Activate\n            ActiveWorkbook.Names(\"SrDat\").Delete\n\n            Sheets(\"SrData\").Rows(i).Select\n            Selection.Delete\n\n            Sheets(\"SrData\").Range(Sheets(\"SrData\").Cells(2, 1), Sheets(\"SrData\").Cells(lastrow - 1, 3)).Select\n\n            ActiveWorkbook.Names.Add Name:=\"SrDat\", RefersTo:=Selection\n\n\n\n            End If\n\n    Next i\n\nEnd If\n\n\nWith Worksheets(\"Solve\").OLEObjects(\"ListBox1\")\n    .ListFillRange = .ListFillRange\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "copy", "paste"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1553728871, "post_id": 55386923, "comment_id": 97497685, "body": "The reason it is slow is because it is calculating on each iteration of the loop (which you need) and there are probably multiple formulas in your sheet. Can you update your question with a clear goal of what you are trying to achieve and some sample data?. It looks like you are trying to compound some sums?"}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1553731358, "post_id": 55386923, "comment_id": 97498297, "body": "I updated my question with some data and maybe a more clear explanation of what I need? Let me know if that helps."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1553769620, "post_id": 55386923, "comment_id": 97511308, "body": "You could replace the formulas in your Excel sheet by a formula directly inside VBA. You could also quit VBA and run everything on your sheet, say by having one column per combination (first row would be your input, and the next rows would be your outputs)."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553770179, "post_id": 55386923, "comment_id": 97511630, "body": "Ama thanks for your suggestion but in that case I will have a very large sheet with many columns. I am still trying how to optimise the code with arrays. I got a better run time however not as significant as I expected so I am still working on it. Thanks!"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1553782825, "post_id": 55386923, "comment_id": 97520237, "body": "Just sent you a full reponse. Let me know if that helps."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553786656, "post_id": 55386923, "comment_id": 97523124, "body": "I uploaded a new picture of what I actually need. Maybe it is more helpful now. In a sense that is what I need, the difference is that there are more than 200 people and so instead of having 200 and more columns of each one, I have in cell C8 a unique characteristic of the individuals. Whenever this changes, payments changes as well. But the idea of what I need can be seen in the picture. Thank you so much again"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1553789779, "post_id": 55386923, "comment_id": 97525271, "body": "So, to sum up: you have Person ID number. Your <code>For i = 1 to k</code> translates this ID number. For each ID number, you pull a list of payments, associated to a date. What you want is for a given date, get the cumulative payments made by all the ID numbers, up to that date. Correct? If so, you can achieve all of this very quickly through a basic sheet, or if you want something interactive you can use a pivot chart: it is very intuitive, I can show you how to do that."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553790359, "post_id": 55386923, "comment_id": 97525595, "body": "Yes that is exactly what I need. Could you please explain me how to do that with a basic sheet? As my initial problem was that I didn&#39;t know how I could simultaneously change the ID ,take the relevant payment of the date and then aggregate them for each date. That&#39;s why I tried to use VBA."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1553792464, "post_id": 55386923, "comment_id": 97526814, "body": "First things first: how do you retrieve the dates and payments for a given Id? Are you connected to a separate database (perhaps online or on the intranet of your company). Or is it just a formula with some vlookup or index/match formulas to another sheet?"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1553792811, "post_id": 55386923, "comment_id": 97527025, "body": "Your current code is not optimized because you perform the same calculations several time. FOr example if date A &lt; date B, then the cumulative payments up to date B = cumualtive payments up to date A + payments between A and B. In your code you always start your sums from the beginning, whilst you could reuse the sum you just calculated on the row just above. If you have N rows, calculating date N will &quot;cost&quot; you N operations, whilst it could cost you only one if you reuse the calcs for date N-1. So if you have 20 dates, you used 1+2+3+...+19+20=210 operations intead of 20."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553793673, "post_id": 55386923, "comment_id": 97527535, "body": "For your first comment above, all of those data are calculated in the same sheet as the one I perform the macro. This is because these data do not exist in the whole spreadsheet. So the first thing that this sheet does is selecting a person (with cell C8) then  find each date of repayment that  this borrower has and then matching that date with a fixed date on each month (15th working day of the month). By that I mean, that if two borrowers A and B repay on 7 of May and 11 of May respectively, for my purposes I need both of them to be associated for the 15th day of the month (continuing ...)"}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553793778, "post_id": 55386923, "comment_id": 97527604, "body": "The repayment date is also calculated on that sheet from other data like inception date of the loan, relevant working day of the month."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553794147, "post_id": 55386923, "comment_id": 97527800, "body": "Regarding to your second comment, I am really sorry but I misunderstood your previous comment. I actually need the monthly payments hence the payments between A and B and not the cumulative up to B. Apologies again. It would be a good idea to use cumulative repayments and substracting the cumulative repayments up to the previous month. However in my case there is a slight difficulty to that as some borrowers become obsolete over time and hence the numbers of borrowers are not constant over time. My excel formulas have taken this into account even though it is not noticeable from the code"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553724550, "post_id": 55387146, "comment_id": 97496346, "body": "Thank you very much for your answer. Apologies for the confusion caused by my descreption.  I need to sum all the different values for b1. Then in another cell all the different values for b2 etc. If we had two possible values for  cell b1=1 and b1=2 and two values for cell b2=1 and b2=3 then I need sum(b1)=1+2=3 and in another cell sum(b2)=1+3=4. I hope this makes it more clear?   Regarding your answer, I will try using arrays and see if this makes the code faster. Thanks again!"}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553776077, "post_id": 55387146, "comment_id": 97515310, "body": "Ama, I think the main problem with using arrays in my case is that I have to change the array inside of the loop as column H changes. Therefore, I think that the number of requests remain the same. As on each iteration of the loop array should be equal to the same range which have been updated with new data. I can&#39;t give values to the array before the loop as on that case the array will remain constant while the column H will keep changing on each iteration."}], "tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1553782986, "last_edit_date": 1553782986, "creation_date": 1553724101, "answer_id": 55387146, "question_id": 55386923, "link": "https://stackoverflow.com/questions/55386923/sum-of-a-specific-range-that-changes-on-each-iteration-of-a-loop/55387146#55387146", "title": "Sum of a specific range that changes on each iteration of a loop", "body": "<p>Welcome to StackOverflow.\nI must admit I got a bit confused by your narrative, as I did not fully understand if you are doing a sum(a,b,c) or a sum(sum(a,b,c), sum(d,e,f), ...).\nIn any cases, a trick that will dramatically accelerate your script is the use of arrays.</p>\n\n<p>Performing calcs with VBA is not slow, but retrieving the data from Excel (communicating with the application) IS slow, and pretty much depending on the number of \"requests\", rather than the quantity of data requested.</p>\n\n<p>You can use arrays to request the data from a range all at once, isntead of requesting the value of each cell separately.</p>\n\n<pre><code>Dim Arr() As Variant\nArr = Range(\"A1:E999\")\n</code></pre>\n\n<p>It is as simple as this.\nGive it a try and if you are still struggling let us know.</p>\n\n<hr>\n\n<h1>BONUS</h1>\n\n<p>If you are new to Arrays, keep in mind you can have a two-dimmensionnal array:</p>\n\n<pre><code>Dim 2DArray(0 to 10, 0 to 50)\n</code></pre>\n\n<p>Or a stacked array (an array of arrays):</p>\n\n<pre><code>Dim MyArray() as String\nDim StackedArray() as MyArray\n\nDim StackedArray() as Variant\n</code></pre>\n\n<p>You will need a 2D-Array for extracting the data from a range, but I feel you may need an Array of 2D-Arrays for your Sum of Sums.</p>\n\n<p>Some recommended reading: <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/excel-vba-array/</a></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553761389, "post_id": 55388855, "comment_id": 97506461, "body": "Thanks for your suggestions. I have tried to switch the calculations to Manual but as you said I need them inside of the loop. Also I need calculation to be active as column H takes its values from another sheet. Hence, whenever I change cell c8 data in column H changes as well, hence the other problem I had from deactivating the calculations was that column H was remaining unchanged. Maybe I should enable the calculation only on that sheet. Also, apologies for my narrative, I tried to update my questions and maybe now is more comprehensible."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1553736266, "creation_date": 1553736266, "answer_id": 55388855, "question_id": 55386923, "link": "https://stackoverflow.com/questions/55386923/sum-of-a-specific-range-that-changes-on-each-iteration-of-a-loop/55388855#55388855", "title": "Sum of a specific range that changes on each iteration of a loop", "body": "<p>OK, A few things.</p>\n\n<p>Firstly, <code>Dim i, k As Integer</code> doesn't do what you think it does, you need to do: <code>Dim i As Integer, k As Integer</code></p>\n\n<p>Secondly don't use Integer in VBA use Long so <code>Dim i As Long, k As Long</code></p>\n\n<p>Third the calculations are killing you. Turn them off with <code>Application.Calculation = xlCalculationManual</code> at the start of your code and back on with <code>Application.Calculation = xlCalculationAutomatic</code> at the end of your code.</p>\n\n<p>Now we are presented with really fast code but the problem that it doesn't update on each iteration which you need it to do. You can calculate just a range like so: <code>Sheets(\"Sheet1\").Range(\"h10:h200\").Calculate</code> so put that in just before you copy the range</p>\n\n<p>There will be an even faster way to do this but I just can't seem to wrap my head around your requirements so I am unable to assist further.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553785974, "post_id": 55399920, "comment_id": 97522591, "body": "First of allo huge thanks for your effort on that. While it is very helpful, it adds up all the values of column H and extract them in C17. What I really need is on each iteration of the loop to add seperately all the values of cell H10 (which changes on each iteration) contains. Then the total of every value of H10s will be pasted in cell C17, at the same time the aggregate of H11s (which again changes on each iteration) will be pasted in C18 etc. I tried to modified your code, however the only thing that comes to my mind is somehow to same in a two dimensional array all the combinations ..."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553786155, "post_id": 55399920, "comment_id": 97522727, "body": "and so in the first row will be all the payments of person 1, then in the second column all the payments of person 2 etc. And then after the loop somehow to take the sum of the first row of this array (because the first row will be the payments of different persons on the same date) and paste it to c17, then the sum of the second row of the array and paste it in c18, and so on."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553789218, "post_id": 55399920, "comment_id": 97524979, "body": "This code does exactly what the code you provided in your question does. It has been optimized and refactored a little bit. So, is your question only about efficiency, or are you also struggling to get the Macro do what you would like it to do? If you need help beyond code optimization, then I highly recommend you submit an example of your worksheet (even if with fake values)."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553790595, "post_id": 55399920, "comment_id": 97525743, "body": "Hi Ama, regarding my code my problem is its efficiency. I have attached you the run of my code and yours. I didn&#39;t change anything from yours. I didn&#39;t know how to attach them in my comment that&#39;s why I edited your answer. Sorry about this"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553793564, "post_id": 55399920, "comment_id": 97527466, "body": "Sorry but I am so confused. Please send a screenshot showing the column and row coordinates. Change/remove the data if sensitive, but we need to see a full example. Also please make sure the code you posted in your question is the one you are using when running your tests, because I am 99% sure my code does the same as yours. (except maybe if some recalculations are not done; you can verify this be deleting the <code>Application.Calculation = xlCalculationManual</code> line of my code)"}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553795493, "post_id": 55399920, "comment_id": 97528502, "body": "I retried without the Application but still same result. 100% the code I use is the same as the one in my questions and yours is just copied and pasted. The only change I made to your is the Sheet1 to the actual sheet name. I will send you a picture of everything if that helps."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553796053, "post_id": 55399920, "comment_id": 97528771, "body": "Ok so I found whre the variance between my code and yours is: <code>MySheet.Range(&quot;c17&quot;).Value2 = Application.WorksheetFunction.Sum(MyData)</code>. What you want is <code>MySheet.Range(&quot;c17&quot;).Value2 = MyData.cells(1,1)</code>, <code>MySheet.Range(&quot;c18&quot;).Value2 = MyData.cells(2,1)</code>, etc. I will post you a quick upadte, but also will send you info about how to achieve this with a pivot cahrt, which will be way easier and once you will start using it you will love it!"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553797501, "post_id": 55399920, "comment_id": 97529477, "body": "Code updated. I cannot check if it even compiles (no computer nearby) but you have the whole idea."}, {"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553853979, "post_id": 55399920, "comment_id": 97548819, "body": "Hi Ama, your code with few adjustments works great (most of them were due to my difficulty of explaining to you what exactly I need). But with 250 borrowers it takes 20 seconds to run, while previously it was taking more than 1 minute. I improvef my code as well but I couldn&#39;t decrease the running time under 30 seconds. So many thanks for that! It would be great if you can still show me how to do the same function with a pivot chart. Again thank you so much for your help, you have been extremely helpful with that."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553871849, "post_id": 55399920, "comment_id": 97559766, "body": "Just proposed the Pivot Chart solution. Don&#39;t forget to mark your question as answered, and to &quot;click up&quot; any post you find usefull. This helps others to find relevant responses, and it helps the person who gave the answer to gain points and be helped in return on another day ;)"}], "tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": true, "score": 0, "last_activity_date": 1553797438, "last_edit_date": 1553797438, "creation_date": 1553782789, "answer_id": 55399920, "question_id": 55386923, "link": "https://stackoverflow.com/questions/55386923/sum-of-a-specific-range-that-changes-on-each-iteration-of-a-loop/55399920#55399920", "title": "Sum of a specific range that changes on each iteration of a loop", "body": "<p>Here is a complete solution, with explainations in comments.\nBecause we do not have you source spreadsheet, I could not run any tests on this.</p>\n\n<pre><code>Option Explicit 'This forces you to declare all your varaibles correctly. It may seem annoying at first glance, but will quickly save you time in the future.\n\nSub sumloop()\n\n    Application.ScreenUpdating = False\n    'Application.DisplayStatusBar = False -&gt; This is not noticely slowing down your code as soon as you do not refresh the StatusBar value for more than say 5-10 times per second.\n\n    'Save the existing Calculation Mode to restore it at the end of the Macro\n    Dim xlPreviousCalcMode As XlCalculation\n    xlPreviousCalcMode = Application.Calculation\n    Application.Calculation = xlCalculationManual\n\n    'Conveniently store the Sheet into a variable. You might want to do the same with your cells, for example: MyCellWhichCounts = MySheet.Range(\"c17\")\n    Dim MySheet As Worksheet\n    MySheet = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    MySheet.Range(\"C8\").Value2 = 1 'It is recommended to use.Value2 instead of .Value (notably in case your data type is Currency, but it is good practice to use that one all the time)\n\n    Dim LR As Long\n    LR = MySheet.Range(\"C\" &amp; MySheet.Rows.Count).End(xlUp).Row 'Be carefull with \"MySheet.Rows.Count\", it may go beyond your data range, for example if you modify the formatting of a cell below your \"last\" row.\n    MySheet.Range(\"C17:C\" &amp; LR).Value2 = vbNullString 'It is recommended to use vbNullString instead of \"\"; although I agree it makes it more difficult to read.\n\n    Dim i As Integer, k As Integer 'Integers are ok, just make sure you neer exceed 255\n    k = MySheet.Range(\"C9\").Value2\n    For i = 1 To k 'Use a For whenever you can, it is easier to maintain (i.e. avoid errors and also for you to remember when you go back to it years later)\n\n        'Little extra so you can track progress of your calcs\n        Dim z As Integer\n        z = 10 'This can have any value &gt; 0. If the value is low, you will refresh your app often but it will slow down. If the value is high, it won't affect performance but your app might freeze and/or you will not have your Statusbar updated as often as you might like. As a rule of thumb, I aim to refresh around 5 times per seconds, which is enough for the end user not to notice anything.\n        If i Mod z = 0 Then 'Each time i is a mutliple of z\n            Application.StatusBar = \"Calculating i = \" &amp; i &amp; \" of \" &amp; k 'We refresh the Statusbar\n            DoEvents 'We prevent the Excel App to freeze and throw messages like: The application is not responding.\n        End If\n\n        'Set the range\n        Dim MyResultRange As Range\n        If (MySheet.Range(\"J9\").Value2 = vbNullString) Then\n            MyResultRange = MySheet.Range(\"h10:h200\")\n        Else\n            MyResultRange = MySheet.Range(\"h9:h200\")\n        End If\n\n\n        '# Extract Result Data\n        MyResultRange.Calculate 'Refresh the Range values\n        Dim MyResultData As Variant\n        MyResultData = MyResultRange.Value2 'Store the values in VBA all at once\n\n        '# Extract Original Data\n        Dim MyOriginalRange as Range\n        MyOriginalRange.Calculate\n        MyOriginalRange = MySheet.Range(\"c17\").Resize(MyResultRange.Rows.Count,MyResultRange.Columns.Count) 'This produces a Range of the same size as MyResultRange \n        Dim MyOriginalData as Variant\n        MyOriginalData = MyOriginalRange.Value2\n\n        '# Sum Both Data Arrays\n        Dim MySumData() as Variant\n        Redim MySumData(lbound(MyResultRange,1) to ubound(MyResultRange,1),lbound(MyResultRange,2) to ubound(MyResultRange,2))\n        Dim j as long\n        For j = lbound(MySumData,1) to ubound(MySumData,1)\n            MySumData(j,1)= MyResultData(j,1) + MyOriginalData(j,1)\n        Next j\n\n        'Instead of the \"For j = a to b\", you could use this, but might be slower: MySumData = Application.WorksheetFunction.MMult(Array(1, 1), Array(MyResultData, MyOriginalData))\n\n        MySheet.Range(\"C8\").Value2 = MySheet.Range(\"C8\").Value2 + 1\n\n    Next i\n\n MySheet.Range(\"C8\").Value2 = 1\n\n Application.ScreenUpdating = True\n Application.StatusBar = False 'Give back the status bar control to the Excel App\n Application.Calculation = xlPreviousCalcMode 'Do not forget to restore the Calculation Mode to its previous state\n\n End Sub\n</code></pre>\n\n<hr>\n\n<h1>Added by OP (see comments)</h1>\n\n<p>Image 1 Code written in the initially question. <a href=\"https://i.stack.imgur.com/z1Pnp.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Image 2 Code above <a href=\"https://i.stack.imgur.com/lOVD5.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "edited": false, "score": 0, "creation_date": 1553884896, "post_id": 55420236, "comment_id": 97566526, "body": "Thank you so much once againfor your time and effort you put into my question! This answer is very helpful for organised data as you mentioned so it&#39;s good to know regardless my question. Again thanks!"}], "tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1553871678, "creation_date": 1553871678, "answer_id": 55420236, "question_id": 55386923, "link": "https://stackoverflow.com/questions/55386923/sum-of-a-specific-range-that-changes-on-each-iteration-of-a-loop/55420236#55420236", "title": "Sum of a specific range that changes on each iteration of a loop", "body": "<h1>How to achieve the same through pivot charts (no VBA)</h1>\n\n<h3>Step 1</h3>\n\n<p>First, you must organize your data in a specific way, where each column is a field, and each row is a data entry. If you are not familiar with databases, this is the most tricky point as you may arrange your data in different ways.</p>\n\n<p>Long story short, we will take an example where you have 3 customers and 4 dates.\nSo that is 12 data entries, which will provide the repayment value for each of the possible customer ID and date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/O5QCJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O5QCJ.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 2</h3>\n\n<p>Select that data and insert a PivotChart.\nNote: you could insert a PivotTable alone, or a PivotChart alone. I recommend the option hwere you insert both, as managing your data will be more intuitive when working on the Chart. The table is updated at the same time you update the chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/s87wv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s87wv.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 3</h3>\n\n<p>Make sure the all your data is selected, including the top row which will dictate the name of each field (the name of each column).</p>\n\n<p><a href=\"https://i.stack.imgur.com/CZUfj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CZUfj.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 4</h3>\n\n<p>A new sheet has just been create, and you can see where both your PivotTble and PivotCharts will appear. Select the chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xCmlb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xCmlb.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 5</h3>\n\n<p>A menu to the right will appear (it might have already been there, so make sure you selected the Chart and not the Table, as that menu would be slightly different).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q5Zse.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q5Zse.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 6</h3>\n\n<p>Drag and drop the field names into the categories as shown.\nWhat you are doing here is telling Excel what data you want to see (Values) and how you want to break it down (per date, and per customer).</p>\n\n<p><a href=\"https://i.stack.imgur.com/J6CLK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J6CLK.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 7</h3>\n\n<p>By default dates data is always groupped quartile and year. To be able to see all the date we have data for, you can click the [+] near the data on the Table: this will show more details for both the table and the chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3kKk0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3kKk0.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 8</h3>\n\n<p>But we want to get completely rid of the quartils and years. In order to achieve this, you need to right click any value of your date column in the Table, and choose \"Ungroup\" as displayed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9CWwu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9CWwu.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 9</h3>\n\n<p>Your data now looks like this.\nNote the time axis is not on scale. For example if you hae monthly data and a month is missing, there will be no gap. This is one of the difficulties with Pivot data. This can be overcomes, but it is off topic here.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3yxp0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3yxp0.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 10</h3>\n\n<p>Now we want to have a cumulative view of the data, so we want to play with the way the values are proessed by Excel.\nSelect the chart, then in the right panel: right click on the \"Sum of Repayment\" field, and select \"Value Field Settings\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/OkfIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OkfIa.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 11</h3>\n\n<p>In the \"Show Values As\" tab, select \"Show values as\" \"Running Tital In\".\nThen choose \"Date\".\nHere we are telling Excel that the value to display should be a cumulative total, cumulated according to the \"Date\" field.\nPress OK.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GsVNe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GsVNe.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 12</h3>\n\n<p>You now have what you are looking for. If you look in the Table, you have one column per Customer ID, and one row per date. For a given Date, you have the cumulative repayment made by a given Customer ID. At the very right, you have the Grand Total, which is, for a given date, the sum of all the Customer ID values.</p>\n\n<h3>Step 13</h3>\n\n<p>The Chart keeps showing the cumulative payment per CUstomer ID, and we cannot see the grand total.\nIn orer to achieve this, simply remove the \"Customer ID\" field from the \"Legend (Series)\" category area in the Fields Panel, as shown. (you can untick the Customer Id [x] box, or you can drag and drop it from the category area to the main list area).</p>\n\n<p><a href=\"https://i.stack.imgur.com/92PdW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/92PdW.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Step 14</h3>\n\n<p>Now we only have the Grand total in the chart. But why?\nIf you display the \"Value Field Settings\" of Sum of Repyament\" (Step 10), the first tab \"Summarize Values By\" will tell Excel what to do when several value meet the same Legend and Axis values.\nNow that we removed the Customer ID field from the Legend area, for each date, we have 3 repayment values (one for each Customer ID). In the field settings, we tell Excel to use a \"Sum\". So it returns the sum of the 3 values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/23KOv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/23KOv.png\" alt=\"enter image description here\"></a></p>\n\n<p>But you could play around and return the Average, or even use \"Count\", which will show you how many records you have (it will return 3).\nThat is why pivot charts are so powerful: with only a few clicks and/or drag and drop, you can display a myriad of different graphics for your data.</p>\n\n<p>For future interest, you should look online for Filters, and \"Insert Slicer\" (which is equivalent to filtering, but will add button directly on your chart: great when showing the data to colleagues and switch from one setting to another)</p>\n\n<p>Hope this helped!</p>\n"}], "owner": {"reputation": 5, "user_id": 11266647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6843653bf584add61e1754860c5098?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/11266647/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "accepted_answer_id": 55399920, "answer_count": 4, "score": 0, "last_activity_date": 1553871678, "creation_date": 1553723000, "last_edit_date": 1553786529, "question_id": 55386923, "link": "https://stackoverflow.com/questions/55386923/sum-of-a-specific-range-that-changes-on-each-iteration-of-a-loop", "title": "Sum of a specific range that changes on each iteration of a loop", "body": "<p>I have a sheet that the values of a range change each time I change a specific cell. Let's say that the cell C8 is an indentity of a person and column H the scheduled monthly repayments. I need to find the aggregate monthly repayments, hence on each possible value of C8 (and that actually means for every person as you can think of different values of C8) I need the aggegate of repayments, hence the aggegate of cell Hi Hence, keeping row i constant  and changing cell C8, I always need to sum Hi. So I actually need sum(Hi) (i constant and the index of the sum is cell c8, so if c8 takes value from 1 to 200, I need the sum(Hi(c8)), again row i . Hi(c8) it is just a notation to show you that Hi depends on the value of c8. The actual formula in cell H10 is INDEX('Sheet2'!R:R,MATCH('Sheet1'!$C$8,'Sheet2'!F:F,0)))). H11 and onwards have the same formula with slight twists for the fact that the repayments are not always equal, but the index function remains the same. </p>\n\n<p>Then, the total of H10 for all possible values of c8 is pasted in c17, the total of H11 is pasted in C18 etc. Please find some images below, maybe that helps to support what I try to achieve. <a href=\"https://i.stack.imgur.com/sMZch.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I have the following code for that purpose.  Note that the above example was just to explain you a bit the background, the cells and the range that changes are different.</p>\n\n<pre><code> sub sumloop()\n\n Application.ScreenUpdating = False\n Application.DisplayStatusBar = False\n\n\n Sheets(\"Sheet1\").Range(\"C8\").Value = 1\n\n\n Dim i, k As Integer\n\n  i = 1\n\n\n  k = Sheets(\"Sheet1\").Range(\"C9\").Value\n\n  Dim LR As Long\n  LR = Sheets(\"Sheet1\").Range(\"C\" &amp; \n  Sheets(\"Sheet1\").Rows.Count).End(xlUp).row\n\n  Sheets(\"Sheet1\").Range(\"C17:C\" &amp; LR).ClearContents\n\n   Do While i &lt;= k\n\n\n   If (Sheets(\"Sheet1\").Range(\"J9\").Value = \"\") Then\n\n\n           Sheets(\"Sheet1\").Range(\"h10:h200\").Copy\n           Sheets(\"Sheet1\").Range(\"c17\").PasteSpecial \n    Paste:=xlValues, Operation:=xlAdd, SkipBlanks:= _\n        False, Transpose:=False\n\n\n   Else\n\n\n           Sheets(\"Sheet1\").Range(\"h9:h200\").Copy\n           Sheets(\"Sheet1\").Range(\"c17\").PasteSpecial \n   Paste:=xlValues, Operation:=xlAdd, SkipBlanks:= _\n            False, Transpose:=False\n\n\nEnd If\n\n\n\n\n\n Sheets(\"Sheet1\").Range(\"C8\").Value = Sheets(\"Sheet1\").Range(\"C8\").Value+1 \n\n\n  i = i + 1\n\n  Loop\n\n Sheets(\"Sheet1\").Range(\"C8\").Value = 1\n\n Application.ScreenUpdating = True\n Application.DisplayStatusBar = True\n\n End Sub\n</code></pre>\n\n<p>The if inside of the loop is needed as the location of the first value of the range depends on some criteria which have not to do with the code. Also k denotes the maximum number of possible values. What I need is approximately 250.</p>\n\n<p>While the code works, it takes approximately 40 seconds to run for 84 values of cell C8 and approximately 1.5 minute for 250. I tried some things, changed do while to for but nothing significant, used variable ranges instead of fixed ones like h10:h100, very similar to what I do with Sheet1.Range(C17:C&amp;LR). Again no significant changes. As I am very new to vba I don't know if 1.5 minutes are a lot for such a simple code, but to me it seems a lot and this analysis is needed for 10 different combinations of 250 different values for cell c8, which means 15 minutes approximately. </p>\n\n<p>I would appreciate if anyone can suggest me something faster. </p>\n\n<p>Thank you very much in advance.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1, "user_id": 11268893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c56f58a899bda726c3a405e654d5c36?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11268893/mark"}, "edited": false, "score": 0, "creation_date": 1553723040, "post_id": 55386914, "comment_id": 97495759, "body": "Sorry the format of the question did not display as intended."}, {"owner": {"reputation": 1, "user_id": 11268893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c56f58a899bda726c3a405e654d5c36?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11268893/mark"}, "edited": false, "score": 0, "creation_date": 1553723257, "post_id": 55386914, "comment_id": 97495840, "body": "How do you type a basic question without the formatting getting altered? Stackoverflow keeps thinking my example is code. It is not. Anyway. Hopefully my initial question is understood."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553723553, "post_id": 55386914, "comment_id": 97495947, "body": "Welcome to SO! This site uses <a href=\"https://stackoverflow.com/editing-help\">Markdown</a> for formatting. A uniform 4-space indent is used to mark a line as a block of code. Did you mean to make a bullet list? In any case, it looks like your question as it stands is <i>too broad</i> to be reasonably answerable, and will probably end up being put on hold. Rule of thumb, &quot;I need code that does XYZ&quot; isn&#39;t going to work. Do you code that can add an attachment and you need help iterating PDF files? See the &quot;related&quot; posts in the side bar to get you started."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553723559, "post_id": 55386914, "comment_id": 97495951, "body": "<a href=\"https://stackoverflow.com/q/14245712/1188513\">This</a> might also help."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1553729795, "post_id": 55386914, "comment_id": 97497935, "body": "There is help available for formatting when you&#39;re typing your post, in the form of a <i>?</i> button on the editor toolbar."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11268893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c56f58a899bda726c3a405e654d5c36?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11268893/mark"}, "edited": false, "score": 0, "creation_date": 1559080448, "post_id": 55387850, "comment_id": 99305994, "body": "My organization does not use Redemption so this will not be an option. Are there any other solutions or sample VBA code I could use to solve this? Somehow I need to &quot;move&quot; or &quot;save-as&quot; many pdfs that are buried in nested Outlook email attachments."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11268893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c56f58a899bda726c3a405e654d5c36?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11268893/mark"}, "edited": false, "score": 0, "creation_date": 1559082490, "post_id": 55387850, "comment_id": 99306549, "body": "It is either Extended MAPI (C++ or Delphi only) or Redemption (any language). Otherwise it is only recursively saving the embedded message attachments as MSG files (Attachment.SaveAsFile) and then opening it using Namespace.OpenSharedItem"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1553728155, "creation_date": 1553728155, "answer_id": 55387850, "question_id": 55386914, "link": "https://stackoverflow.com/questions/55386914/extract-nested-files-from-mutlple-attached-emails/55387850#55387850", "title": "Extract nested files from mutlple attached emails", "body": "<p>Outlook does not let you access embedded message attachments directly - you would need to save them first using <code>Attachment.SaveAsFile</code>, and then open the MSG file using <code>Namespace.OpenSharedItem</code>.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> is an option (I am its author), it exposes the <a href=\"http://www.dimastr.com/redemption/RDOAttachment.htm\" rel=\"nofollow noreferrer\">RDOAttachment</a>.<code>EmbeddedMsg</code> property that returns the embedded message attachment as an <a href=\"http://www.dimastr.com/redemption/RDOMail.htm\" rel=\"nofollow noreferrer\">RDOMail</a> object:</p>\n\n<pre><code>set OutlookMsg = Application.ActiveExplorer.Selection(1)\n\nset Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset msg = Session.GetRDOObjectFromOutlookObject(OutlookMsg)\nProcessMessage(msg)\n\nsub ProcessMessage(msg)\n  for each attach in msg.Attachments\n    if attach.Type = olEmbeddedItem Then\n      ProcessMessage(attach.EmbeddedMsg)\n    elseif attach.Type = olByValue Then\n      attach.SaveAsFile \"c:\\temp\\\" &amp; attach.FileName\n    End If\n  next\nend sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11268893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c56f58a899bda726c3a405e654d5c36?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11268893/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553729162, "creation_date": 1553722957, "last_edit_date": 1553729162, "question_id": 55386914, "link": "https://stackoverflow.com/questions/55386914/extract-nested-files-from-mutlple-attached-emails", "title": "Extract nested files from mutlple attached emails", "body": "<p>I regularly receive emails that have 30+ attached emails with PDF files nested inside. I need a VBA code that will copy ALL of the nested PDF files to a folder outside Outlook. Could some one kindly point me in the right direction.</p>\n\n<p>Example:</p>\n\n<pre><code>Main Email\n   Attached email\n      PDF attachment\n   Attached email\n      PDF attachment\n   Attached email\n      PDF attachment\n   Attached email\n      PDF attachment\n   Etc...\n</code></pre>\n\n<p>How do I copy all the nested PDF's to a folder outside outlook in one action?</p>\n\n<p>Thank you in advance for the direction.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553722961, "post_id": 55386893, "comment_id": 97495734, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open</a> see the <code>UpdateLinks</code> parameter"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553723606, "post_id": 55386893, "comment_id": 97495972, "body": "I have about 2500 files all with link to another sheet, this is why I am looking for a solution. do you think it is doable?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553724963, "post_id": 55386893, "comment_id": 97496469, "body": "Did you read the linked page?"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553725774, "post_id": 55386893, "comment_id": 97496723, "body": "I did but I am afraid I don&#39;t know how to use it ActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources, Type:=xlExcelLinks"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553728005, "post_id": 55387724, "comment_id": 97497424, "body": "Thank you Much Tim. sorry I was asking so much, I just barely getting started on this so not the brightest cookie out there"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553734284, "post_id": 55387724, "comment_id": 97498968, "body": "I have been running the macro and now I am not getting the update links anymore but it does comes up with a Update Values: Source. I have sent the UpdateLinks to =0 =False =Never. any recommendation"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553744596, "post_id": 55387724, "comment_id": 97501004, "body": "Maybe try some of the other suggestions at the question I linked to."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1553727380, "creation_date": 1553727380, "answer_id": 55387724, "question_id": 55386893, "link": "https://stackoverflow.com/questions/55386893/close-pop-up-when-trying-to-open-a-multiple-worksheet-from-a-macro/55387724#55387724", "title": "close pop up when trying to open a multiple worksheet from a macro", "body": "<p>Change</p>\n\n<pre><code>With Workbooks.Open(sFolder &amp; sFile)\n</code></pre>\n\n<p>To</p>\n\n<pre><code>With Workbooks.Open(sFolder &amp; sFile, UpdateLinks:=False)\n</code></pre>\n\n<p>More here on this topic:\n<a href=\"https://stackoverflow.com/questions/14908372/how-to-suppress-update-links-warning\">How to suppress Update Links warning?</a></p>\n"}], "owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553758174, "creation_date": 1553722809, "last_edit_date": 1553758174, "question_id": 55386893, "link": "https://stackoverflow.com/questions/55386893/close-pop-up-when-trying-to-open-a-multiple-worksheet-from-a-macro", "title": "close pop up when trying to open a multiple worksheet from a macro", "body": "<p>I am trying to extract a some data from multiple worksheets but when I run the macro some worksheet are coming up with a Pop-up window asking me to update or don't update the link attached to the worksheet. I am looking for a way to make the macro hit \"Don't update\"</p>\n\n<p>P.S. if possible I would like sFolder to be the root folder and also search for any \"*.xlsx\" contained inside C:\\temp</p>\n\n<pre><code>Sub tgr()\n\n    Dim wbDest As Workbook\n    Dim wsDest As Worksheet\n    Dim rCopy As Range\n    Dim sFolder As String\n    Dim sFile As String\n    Dim lRow As Long\n\n    Set wbDest = ThisWorkbook                   'The workbook where information will be copied into\n    Set wsDest = wbDest.Worksheets(\"Sheet1\")    'The worksheet where information will be copied into\n    sFolder = \"C:\\Path\\\" 'The folder path containing the xlsx files to copy from\n\n    'would like sFolder to be the root folder and also \n    '   search for any \"*.xlsx\" contained inside C:\\temp\n\n    lRow = 1 'The starting row where information will be copied into\n\n    'Adjust the folder path to ensure it ends with \\\n    If Right(sFolder, 1) &lt;&gt; \"\\\" Then sFolder = sFolder &amp; \"\\\"\n\n    'Get the first .xlsx file in the folder path\n    sFile = Dir(sFolder &amp; \"*.xlsx\")\n\n    'Begin loop through each file in the folder\n    Do While Len(sFile) &gt; 0\n\n        'Open the current workbook in the folder\n        With Workbooks.Open(sFolder &amp; sFile)\n            'Copy over the formulas from A1:C3 from only the first \n            '   worksheet into the destination worksheet\n            Set rCopy = .Sheets(1).Range(\"C9:D26\")\n            wsDest.Cells(lRow, \"A\").Resize(rCopy.Rows.Count, rCopy.Columns.Count).Formula = rCopy.Formula\n\n            'Advance the destination row by the number of rows being copied over\n            lRow = lRow + rCopy.Rows.Count\n\n            .Close False    'Close the workbook that was opened from the folder without saving changes\n        End With\n        sFile = Dir 'Advance to the next file\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553721930, "post_id": 55386656, "comment_id": 97495323, "body": "We need much more info from you. What do you mean locked? You say coding but I don&#39;t see any coding tags"}, {"owner": {"reputation": 1, "user_id": 11268870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218235421787940/picture?type=large", "display_name": "William Morgan", "link": "https://stackoverflow.com/users/11268870/william-morgan"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553722204, "post_id": 55386656, "comment_id": 97495462, "body": "Locked meaning unable to enter anything in the cell"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553722268, "post_id": 55386656, "comment_id": 97495482, "body": "<a href=\"https://stackoverflow.com/questions/45987196/possible-to-lock-range-of-cells-based-on-another-cells-value?rq=1\" title=\"possible to lock range of cells based on another cells value\">stackoverflow.com/questions/45987196/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1553723244, "creation_date": 1553723244, "answer_id": 55386970, "question_id": 55386656, "link": "https://stackoverflow.com/questions/55386656/how-to-lock-a-cell-based-off-of-a-value-from-another-cell/55386970#55386970", "title": "How to lock a cell based off of a value from another cell", "body": "<p><em>Pasted in VBE under sheet that you want this rule to apply to...</em></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n    If Target.Count = 1 Then\n        If Target.Offset(, 1) = \"Hold\" Then\n            Application.EnableEvents = False\n                Application.Undo\n                MsgBox \"Cell on Hold. Reverting changes\", vbCritical\n            Application.EnableEvents = True\n        End If\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11268870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218235421787940/picture?type=large", "display_name": "William Morgan", "link": "https://stackoverflow.com/users/11268870/william-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553723244, "creation_date": 1553721768, "last_edit_date": 1553721921, "question_id": 55386656, "link": "https://stackoverflow.com/questions/55386656/how-to-lock-a-cell-based-off-of-a-value-from-another-cell", "title": "How to lock a cell based off of a value from another cell", "body": "<p>I have a sheet that has column B. the states a disposition of our product released, hold ect..  column A. states what has been done with this product ie shipped, in storage ect. I need to have column A. to be locked if column B. is set to \"Hold\" I am pretty new to this coding and so I have almost no idea where to start or if its even possible.</p>\n"}, {"tags": ["xml", "vba", "vb.net", "walmart-api"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553747879, "post_id": 55386475, "comment_id": 97501668, "body": "You noted that tokens have a 15min lifespan?  Don&#39;t know if that applies to your side of the process. Weird - consumer id relates to the old style authentication method."}, {"owner": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553770371, "post_id": 55386475, "comment_id": 97511762, "body": "Yes, I know about it. However, I always get an error (even after 15 minutes)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553772294, "post_id": 55390286, "comment_id": 97512986, "body": "Do you think I need to add the line:  xmlhttp.SetRequestHeader &quot;grant_type&quot;, &quot;client_credentials&quot; ?   The error is the same."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553772341, "post_id": 55390286, "comment_id": 97513014, "body": "I think it needs to go in the body against the .send &quot;xyz&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553773823, "post_id": 55390286, "comment_id": 97513962, "body": "without the brackets. I don&#39;t know if it needs to be encoded. You may need to encode it first."}, {"owner": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553773985, "post_id": 55390286, "comment_id": 97514056, "body": "Dim s As String     s = &quot;grant_type = authorization_code&quot;          xmlhttp.send s  The same error"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553779451, "post_id": 55390286, "comment_id": 97517656, "body": "&quot;grant_type=client_credentials&quot; - no space"}, {"owner": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553799999, "post_id": 55390286, "comment_id": 97530859, "body": "Unfortunately, I get all the same error message. Is it possible that Walmart cannot find a consumer id that meets my ClientID and ClientSecret?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1553800058, "post_id": 55390286, "comment_id": 97530892, "body": "Sounds plausible. Certainly worth checking with them direct."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1553748029, "creation_date": 1553748029, "answer_id": 55390286, "question_id": 55386475, "link": "https://stackoverflow.com/questions/55386475/walmart-oauth-authentication-token-api-on-vba/55390286#55390286", "title": "Walmart OAuth Authentication (Token API) on vba", "body": "<p>Maybe a side note but there should be a grant type sent by the looks of it i.e. body in send line should be </p>\n\n<pre><code>grant_type=client_credentials \n</code></pre>\n\n<p>Info:</p>\n\n<pre><code>Request Parameters\nName        Description                             Required      Default        \ngrant_type  The type of access token to be issued   Yes     client_credentials        \n\n** Note:The value of the grant_type should always be 'client_credentials' to get the correct access token **\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 423, "user_id": 4437810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVIp4.jpg?s=128&g=1", "display_name": "Gomzy", "link": "https://stackoverflow.com/users/4437810/gomzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1570704777, "last_edit_date": 1570704777, "creation_date": 1570702197, "answer_id": 58320498, "question_id": 55386475, "link": "https://stackoverflow.com/questions/55386475/walmart-oauth-authentication-token-api-on-vba/58320498#58320498", "title": "Walmart OAuth Authentication (Token API) on vba", "body": "<p>As per <a href=\"https://developer.walmart.com/#/apicenter/marketPlace/latest#getToken\" rel=\"nofollow noreferrer\">Walmart Token API</a> You need to pass <code>grant_type=client_credentials</code> as <code>request body</code> to get an <code>access_token</code> for other API calls.</p>\n"}], "owner": {"reputation": 21, "user_id": 4617905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802caaedab5e53fc5c0e298fa458a94?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u041b\u0438\u043b\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/4617905/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%9b%d0%b8%d0%bb%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570704777, "creation_date": 1553720889, "last_edit_date": 1563221851, "question_id": 55386475, "link": "https://stackoverflow.com/questions/55386475/walmart-oauth-authentication-token-api-on-vba", "title": "Walmart OAuth Authentication (Token API) on vba", "body": "<p>I am trying to authenticate to walmart.com using Token-based authentication (New preferred method) on vba. You can read more here: <a href=\"https://developer.walmart.com/#/apicenter/marketPlace/latest#introduction\" rel=\"nofollow noreferrer\">https://developer.walmart.com/#/apicenter/marketPlace/latest#introduction</a></p>\n\n<p>What can be the reason for the error message? How to fix this error? After all, Consumer id is not required in the code.</p>\n\n<p>Base64EncodeString is my personal function. I checked how it works by comparing the result with web resources.</p>\n\n<p>WalmartAPIUserKey - my ClientID</p>\n\n<p>WalmartSecretKey - my ClientSecret</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim xmlhttp As New MSXML2.XMLHTTP60    \nDim encodeData As String\n\nencodeData = Base64EncodeString(WalmartAPIUserKey &amp; \":\" &amp; WalmartSecretKey) \nxmlhttp.Open \"POST\", \"https://marketplace.walmartapis.com/v3/token\", False                       \nxmlhttp.SetRequestHeader \"WM_SVC.NAME\", \"Walmart marketplace\"\nxmlhttp.SetRequestHeader \"WM_QOS.CORRELATION_ID\", \"123456abcdef\"\nxmlhttp.SetRequestHeader \"Authorization\", \"Basic \" &amp; encodeData\nxmlhttp.SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nxmlhttp.SetRequestHeader \"Accept\", \"application/xml\"\nxmlhttp.send\n\nMsgBox (xmlhttp.responseText)\nDebug.Print (xmlhttp.responseText)\n\nSet xmlhttp = Nothing\n</code></pre>\n\n<p>However, I get the following error:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;ns2:errors xmlns:ns2=\"http://walmart.com/\"&gt;\n    &lt;ns2:error&gt;\n        &lt;ns2:code&gt;SYSTEM_ERROR.GMP_GATEWAY_API&lt;/ns2:code&gt;\n        &lt;ns2:description&gt;consumer id not found in PRS&lt;/ns2:description&gt;\n        &lt;ns2:info&gt;System encountered some internal error.&lt;/ns2:info&gt;\n        &lt;ns2:severity&gt;ERROR&lt;/ns2:severity&gt;\n        &lt;ns2:category&gt;DATA&lt;/ns2:category&gt;\n        &lt;ns2:causes/&gt;\n        &lt;ns2:errorIdentifiers/&gt;\n    &lt;/ns2:error&gt;\n&lt;/ns2:errors&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553720990, "post_id": 55386446, "comment_id": 97494876, "body": "Why vba when a simple INDEX/MATCH formula will work?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1553721105, "post_id": 55386446, "comment_id": 97494934, "body": "Without vba in <code>C1</code>: <code>=INDEX([File1]Sheet1!$A$1:$A$2,MATCH(B1,[File1]Sheet1!$R$1:$&zwnj;&#8203;R$2,0))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 11254422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Adc-c_JeUqI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3red0dxhI8Uv0SWAD9mu5pxe86haOw/mo/photo.jpg?sz=128", "display_name": "Eric Johnson", "link": "https://stackoverflow.com/users/11254422/eric-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1553732034, "creation_date": 1553732034, "answer_id": 55388355, "question_id": 55386446, "link": "https://stackoverflow.com/questions/55386446/if-column-b-in-excel-file-2-matches-column-b-in-excel-file-1-output-column-a-va/55388355#55388355", "title": "If column B in excel file 2 matches Column B in excel file 1, output column A value in excel file 1 value to column C in excel file 2", "body": "<p>An index match will work. In file two, type this formula</p>\n\n<p>=index(<em>DRAG AND CLICK THE ALL YOUR DATA IN FILE 1, which wil automatically link its location</em>,match(<em>THE CELL YOU ARE LOOKING UP</em>, <em>DRAG AND CLICK THE B COLUMN OF YOUR DATA in FILE 1</em>, 1)</p>\n\n<p>The last 1 tells this formula to look in the first column of your data range in File 1.</p>\n\n<p>The actual formula will look like this.</p>\n\n<pre><code>=INDEX([File]Sheet1!$A$2:$B$6,MATCH(A3,[File1]Sheet1!$B$2:$B$6,),1)\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2948940, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/439f706f61304f41333aa22615b113e2?s=128&d=identicon&r=PG&f=1", "display_name": "JLM", "link": "https://stackoverflow.com/users/2948940/jlm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55388355, "answer_count": 1, "score": -1, "last_activity_date": 1553732034, "creation_date": 1553720727, "question_id": 55386446, "link": "https://stackoverflow.com/questions/55386446/if-column-b-in-excel-file-2-matches-column-b-in-excel-file-1-output-column-a-va", "title": "If column B in excel file 2 matches Column B in excel file 1, output column A value in excel file 1 value to column C in excel file 2", "body": "<p>I am trying to put a name in column C in excel file 2 based on a number in column B in file 2 that is matched to column R in file 1. The name comes from column A in file 1. </p>\n\n<pre><code>File 1\nA                R\nJohn Doe         1234567\nJane Smith       8889911\n\n\nFile 2\nB                C\n1234567          \"John Doe should appear here\"\n8889911          \"Jane Smith appears here\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553720887, "post_id": 55386371, "comment_id": 97494824, "body": "Could you please provide the code for us to look at?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553720906, "post_id": 55386371, "comment_id": 97494832, "body": "The issue is <i>very</i> likely due to the number/text formatting: simply wrap your lookup value with a <code>TEXT</code> or <code>VALUE</code> (depending on the format of the source) function, and the lookup should work just fine. Please <a href=\"https://stackoverflow.com/posts/55386371/edit\">edit</a> your question to include the actual formula you&#39;re using."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1553722949, "creation_date": 1553722949, "answer_id": 55386912, "question_id": 55386371, "link": "https://stackoverflow.com/questions/55386371/trying-to-copy-cells-from-one-sheet-to-another-through-vlookup/55386912#55386912", "title": "Trying to copy cells from one sheet to another through VLookup", "body": "<p><code>VLOOKUP</code> won't find a number if it's looking for text, or text if it's looking for a number.</p>\n\n<p>If Excel is understanding account numbers as string values in the <code>Ledger</code> sheet, convert the lookup value to a string using the <code>TEXT</code> function:</p>\n\n<pre><code>=IFERROR(VLOOKUP(TEXT(A15,\"@\"),Ledger!A:B,2,FALSE),\"\")\n</code></pre>\n\n<p>If Excel is understanding account numbers as numeric values in the <code>Ledger</code> sheet, convert the lookup value to a number using the <code>VALUE</code> function:</p>\n\n<pre><code>=IFERROR(VLOOKUP(VALUE(A15),Ledger!A:B,2,FALSE),\"\")\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11268767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240d1deb550925e03c5cc1a8cac107e3?s=128&d=identicon&r=PG&f=1", "display_name": "twils14", "link": "https://stackoverflow.com/users/11268767/twils14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55386912, "answer_count": 1, "score": -1, "last_activity_date": 1553722949, "creation_date": 1553720422, "last_edit_date": 1553721474, "question_id": 55386371, "link": "https://stackoverflow.com/questions/55386371/trying-to-copy-cells-from-one-sheet-to-another-through-vlookup", "title": "Trying to copy cells from one sheet to another through VLookup", "body": "<p>I have a spreadsheet with Sheet 1 and Sheet 2. Sheet 2 has data being pulled in from an Access database using a Macro. There is an account number (ex: 12345) and an account name corresponding to that number (ex: Account A).</p>\n\n<p>On Sheet 1, I have am using VLookup in the Account Name field to look at the Account number in column A, use that value to look up the account number on Sheet 2, and pull the corresponding Account Name from Sheet 2.</p>\n\n<p>I am getting an #N/A error. I believe the issue is related to the fact that the account number in Sheet 2 is being pulled in as \"Number as Text\". However, the account on Sheet 1 is text.</p>\n\n<p>I tried changing the account on Sheet 2 to be text as well and it still won't work. I also tried writing a macro to format paint from Sheet 1 to Sheet 2 so the accounts would literally match.</p>\n\n<p>If I double click on the account number on Sheet 2 and hit enter, it will pull the account name into Sheet 1. So I tried writing a macro to set the account value equal to itself as I had to do that for some other fields but that won't work either.</p>\n\n<p>Has anyone had a similar issue like this before? How can I get the vlookup to recognize the accounts on Sheet 2?</p>\n\n<p>Here is the vlookup I am using on Sheet 1:\n=IFERROR(VLOOKUP(A15,Ledger!A:B,2,FALSE),\"\")</p>\n\n<pre><code>    Sub DATA_RECORDSET_OPEN()\n        Application.StatusBar = \"OPENING RECORDSET  -  PLEASE WAIT\"\n        With rstQuery\n          .ActiveConnection = cn\n          .Source = sqlSelect\n          .LockType = adLockOptimistic\n          .CursorType = adOpenStatic\n          .CursorLocation = adUseServer\n          .Open\n        End With\n      Application.StatusBar = False\n     End Sub\n\n    Sub DATA_IMPORT_RECORDS()\n      'This section counts the number of rows with data in column \"A\" and then pastes the information from the query on the first empty row.\n        Application.StatusBar = \"IMPORTING NEW ROWS OF DATA  -  PLEASE WAIT\"\n        intRows = Application.CountA(ActiveSheet.Columns(\"A:A\"))\n        ActiveSheet.Range(\"A\" &amp; intRows + 1).CopyFromRecordset rstQuery\n        Application.StatusBar = False\n    End Sub\n\n    'Format painter from Sheet 1 to Sheet 2\n    Sheets(\"Sheet 1\").Range(\"A15\").Copy\n        Sheets(\"Sheet 2\").Range(\"A2:A500\").Select\n                Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n                SkipBlanks:=False, Transpose:=False\n        Application.CutCopyMode = False\n\n   'Fixes Sheet 2 total formulas by correcting Sheet 2 tab cells\n    intCount = Application.CountA(Sheets(\"Sheet 2\").Range(\"A:A\"))\n        Do Until intCount = 1\n            Range(\"A\" &amp; intCount).Select\n            ActiveCell.FormulaR1C1 = Range(\"A\" &amp; intCount).Value\n            Range(\"B\" &amp; intCount).Select\n            ActiveCell.FormulaR1C1 = Range(\"B\" &amp; intCount).Value\n            Range(\"C\" &amp; intCount).Select\n            ActiveCell.FormulaR1C1 = Range(\"C\" &amp; intCount).Value\n            Range(\"D\" &amp; intCount).Select\n            ActiveCell.FormulaR1C1 = Range(\"D\" &amp; intCount).Value\n            Range(\"E\" &amp; intCount).Select\n            ActiveCell.FormulaR1C1 = Range(\"E\" &amp; intCount).Value\n            intCount = intCount - 1\n        Loop\n</code></pre>\n"}, {"tags": ["excel", "vba", "foreach"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553720359, "post_id": 55386340, "comment_id": 97494572, "body": "What is causing the need to do this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1553721799, "post_id": 55386340, "comment_id": 97495253, "body": "@ScottCraner IME that would be a date column pulled from some SQL data source, that Excel isn&#39;t understanding as a date - F2+Enter does work for this, ...but a much better alternative is to simply add a helper column with a <code>DATEVALUE</code> function that converts the <code>String</code> date into an actual <code>Date</code>. Or, use PowerQuery / Get &amp; Transform to pull the data."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553721936, "post_id": 55386340, "comment_id": 97495326, "body": "@MathieuGuindon I was thinking they were formulas that are not calculating which the F2-Enter will force a recalc.  In which case checking to make sure the calcs are set to automatic or hitting F9 would do the same."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553722301, "post_id": 55386340, "comment_id": 97495495, "body": "@ScottCraner that&#39;s another possibility indeed!"}, {"owner": {"reputation": 3, "user_id": 6036422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4760357f53751f2027580680e52e23?s=128&d=identicon&r=PG&f=1", "display_name": "Luskar", "link": "https://stackoverflow.com/users/6036422/luskar"}, "edited": false, "score": 0, "creation_date": 1553804653, "post_id": 55386340, "comment_id": 97533153, "body": "Thanks, the &#39;application.sendkeys&#39; work great!"}, {"owner": {"reputation": 3, "user_id": 6036422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4760357f53751f2027580680e52e23?s=128&d=identicon&r=PG&f=1", "display_name": "Luskar", "link": "https://stackoverflow.com/users/6036422/luskar"}, "edited": false, "score": 0, "creation_date": 1553805013, "post_id": 55386340, "comment_id": 97533316, "body": "And for the &#39;why&#39;, it&#39;s really a SQL query thing, but not a date. It&#39;s a RFT field that came with all the code. I&#39;ve try changing the format or doing some &#39;activate&#39;, but F2+enter is the only one that work!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553721533, "post_id": 55386469, "comment_id": 97495123, "body": "Side note: OP might want to toggle <code>Application.EnableEvents</code> off before &amp; back on after that loop, to avoid triggering worksheet events 99 times (assuming the intent isn&#39;t to trigger such events in the first place)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553721593, "post_id": 55386469, "comment_id": 97495153, "body": "Other side note: Parameterless <code>Range.Cells</code> call is entirely superfluous ;-)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553722091, "post_id": 55386469, "comment_id": 97495419, "body": "@MathieuGuindon  Thank you for the comments."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1553721236, "last_edit_date": 1553721236, "creation_date": 1553720850, "answer_id": 55386469, "question_id": 55386340, "link": "https://stackoverflow.com/questions/55386340/excel-vba-simple-for-each-macro-shift-the-range/55386469#55386469", "title": "Excel VBA, Simple &quot;For Each&quot; macro shift the range", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub qwerty()\n    Dim Rng As Variant, Cell As Range\n\n    Set Rng = Range(\"AC1:AC100\")\n    For Each Cell In Rng.Cells\n        Cell.Select\n        Application.SendKeys \"{F2}\"\n        Application.SendKeys \"{ENTER}\"\n        DoEvents\n    Next Cell\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>We specify <code>Application</code> to prevent <code>SendKeys</code> from going to the <em>VBE</em><br>The <code>DoEvents</code> prevents he <code>SendKeys</code> from \"piling-up\"</p>\n"}], "owner": {"reputation": 3, "user_id": 6036422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4760357f53751f2027580680e52e23?s=128&d=identicon&r=PG&f=1", "display_name": "Luskar", "link": "https://stackoverflow.com/users/6036422/luskar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55386469, "answer_count": 1, "score": 0, "last_activity_date": 1553721236, "creation_date": 1553720242, "question_id": 55386340, "link": "https://stackoverflow.com/questions/55386340/excel-vba-simple-for-each-macro-shift-the-range", "title": "Excel VBA, Simple &quot;For Each&quot; macro shift the range", "body": "<p>I'm trying to run a really simple code to simulate F2+Enter on each cells in a range.</p>\n\n<p>I know, I should use something else, but in my case nothing else work!</p>\n\n<p>Any range I put in the code, the macro strat at the end of the range and do the number of cells included in my range!!! </p>\n\n<p>I've try with simple range or dynamic range, same thing.</p>\n\n<p>With the code below, it will start at AC100 and stop at AC200.</p>\n\n<pre><code>Dim Rng As Variant, Cell As Range\n\nSet Rng = Range(\"AC1:AC100\")\nFor Each Cell In Rng.Cells\n    Cell.Select\n    SendKeys \"{F2}\", True\n    SendKeys \"{ENTER}\", True\nNext Cell\n</code></pre>\n\n<p>Pretty sure it's a little detail that I've misted, but I can't see what.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553721590, "post_id": 55386231, "comment_id": 97495152, "body": "does the sub that runs when the workbook is opened start like &quot;Private Sub Workbook_Open()&quot; or &quot;Sub Auto_Open()&quot;? Also, do you want a macro to run automatically when you open it programmatically?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "edited": false, "score": 0, "creation_date": 1553726421, "post_id": 55386231, "comment_id": 97496924, "body": "I would recommend to write a VB script instead of using VBA..."}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1553729399, "post_id": 55386231, "comment_id": 97497828, "body": "see <a href=\"https://stackoverflow.com/questions/51888282/getting-a-xlsm-file-to-not-execute-code-when-being-opened-with-vba\" title=\"getting a xlsm file to not execute code when being opened with vba\">stackoverflow.com/questions/51888282/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 2727467, "user_type": "registered", "profile_image": "https://graph.facebook.com/591840664/picture?type=large", "display_name": "Ned Charles", "link": "https://stackoverflow.com/users/2727467/ned-charles"}, "reply_to_user": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553730431, "post_id": 55386231, "comment_id": 97498085, "body": "@w-hit private sub workbook_open() and I want the macro to run programmatically.  \u2014"}, {"owner": {"reputation": 5, "user_id": 2727467, "user_type": "registered", "profile_image": "https://graph.facebook.com/591840664/picture?type=large", "display_name": "Ned Charles", "link": "https://stackoverflow.com/users/2727467/ned-charles"}, "edited": false, "score": 0, "creation_date": 1553730438, "post_id": 55386231, "comment_id": 97498088, "body": "@irene G yes it would be great if I could use VB but unfortunately I need a SAP VBA specific API"}, {"owner": {"reputation": 5, "user_id": 2727467, "user_type": "registered", "profile_image": "https://graph.facebook.com/591840664/picture?type=large", "display_name": "Ned Charles", "link": "https://stackoverflow.com/users/2727467/ned-charles"}, "reply_to_user": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1553730484, "post_id": 55386231, "comment_id": 97498105, "body": "@simple solution \u2014 thanks for the help\u2014 but I want the code to run :/"}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1553780951, "last_edit_date": 1553780951, "creation_date": 1553777519, "answer_id": 55398142, "question_id": 55386231, "link": "https://stackoverflow.com/questions/55386231/use-vba-to-open-multiple-files-that-run-vba-on-open-at-the-same-tjme/55398142#55398142", "title": "Use VBA to open multiple files that run VBA on open at the same tjme", "body": "<p>First you disable the run of macros, open the workbooks as you need them and then you reenable the run of macros. (as proposed here: <a href=\"https://stackoverflow.com/questions/51888282/getting-a-xlsm-file-to-not-execute-code-when-being-opened-with-vba\">Getting a .xlsm file to not execute code when being opened with VBA</a>)</p>\n\n<pre><code>Private Sub OpenWorkBookMacroDisabled(wbPath As String)\n    Application.AutomationSecurity = msoAutomationSecurityForceDisable\n    Workbooks.Open (wbPath)\n    Application.AutomationSecurity = msoAutomationSecurityByUI\n    'or\n    'Application.AutomationSecurity = msoAutomationSecurityLow\nEnd Sub\n</code></pre>\n\n<p><strong>But actually this does not solve your problem.</strong> To run the macros it would be necessary to reopen the workbooks which then would again autostart the individual macros.</p>\n\n<p><strong>Workaround 1</strong><br>\nA possible solution is mentioned here: <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/47477-enabling-macros-without-re-opening-worksheet\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/47477-enabling-macros-without-re-opening-worksheet</a>: </p>\n\n<blockquote>\n  <p><strong>CREATE AN ENABLE/DISABLE VALIDATION CELL</strong><br>\n  <em>The only work around if it was a problem could be something like a validation cell on your home / front page that said \" enabled\" / \"disabled\".<br>\n  Then when opening the workbook always enable the macro's, then on workbook open auto set this to disabled.<br>\n  then you would have all macros look at this ref and if disabled not run, and you would need to dial up enabled to allow any macro to run.<br>\n  May not be what you want but a thought.</em></p>\n</blockquote>\n\n<p><strong>Workaround 2</strong><br>\nAnother workaround could be:<br>\n(1) Open the workbook(s) with the code mentioned above.<br>\n(2) Change <code>Sub Workbook_Open</code> to <code>Sub Workbook_Open_OLD</code> programmatically<br>\n(3) Save the workbook(s)<br>\n(4) Change <code>AutomationSecurity</code> to the desired level<br>\n(5) reopen your workbook(s)<br>\nQuite a lot of work!<br>\nFor details see: <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n\n<p><strong>Workaround 3</strong><br>\nA variation to the enable/disable validation cell is the use of a central property<br>\ne.g. Application.Username</p>\n\n<pre><code>**This Macro calls the 'other excel files':**  \nSub Main0()\n    'TEST 1:\n    'Open workbook and DON'T run macros\n    'Call \"YourCode\" manually\n\n    Application.UserName = \"NoMacroRun\"\n    Debug.Print \"Test 1:\"\n    Debug.Print Application.UserName\n    Workbooks.Open ThisWorkbook.Path &amp; \"\\macro_010.xlsb\"\n    Debug.Print \"Open finished\"\n    Debug.Print \"Call YourCode\"\n     Run \"macro_010.xlsb!YourCode\"\n    Workbooks(\"macro_010.xlsb\").Close SaveChanges:=False\n    Debug.Print \"Test 1: FINISHED successfully\"\n    Debug.Print \"\"\n\n\n    'TEST 2:\n    'Open workbook and run macros\n\n    Application.UserName = \"SomeThingElse\"\n    Debug.Print \"Test 2:\"\n    Debug.Print Application.UserName\n    Workbooks.Open ThisWorkbook.Path &amp; \"\\macro_010.xlsb\"\n    Debug.Print \"Test 2: FINISHED successfully\"\n    Debug.Print \"\"\n    Workbooks(\"macro_010.xlsb\").Close SaveChanges:=False\n    Debug.Print \"\"\nEnd Sub\n</code></pre>\n\n<p><strong>The other files look like:</strong><br>\nIn 'the other files' you seperate \"YourCode\" from \"Workbook_Open\" and make it callable from the outside:  </p>\n\n<pre><code>'doubleclick \"ThisWorkbook\" in the IDE and insert this code there\nPublic Sub Workbook_Open()\n    If Application.UserName &lt;&gt; \"NoMacroRun\" Then\n        Debug.Print \"---&gt; \" &amp; ThisWorkbook.Name &amp; \": Workbook_Open is part of ThisWorkbook in the IDE\"\n\n        'your code\n        Call YourCode\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code you insert into a module:</p>\n\n<pre><code>'doubleclick \"module\" in the IDE and insert this code there\n'OR click in the menu --&gt; Insert --&gt; Module\nSub YourCode()\n        Debug.Print \"---&gt; \" &amp; ThisWorkbook.Name &amp; \": \"\"Sub YourCode\"\" is part of a module in the IDE!\"\nEnd Sub\n</code></pre>\n\n<p>And finally, the <strong>Immediate Window</strong> proves that it works as intended:</p>\n\n<pre><code>Test 1:\nNoMacroRun\nOpen finished\nCall YourCode\n---&gt; macro_010.xlsb: \"Sub YourCode\" is part of a module in the IDE!\nTest 1: finished successfully\n\nTest 2:\nSomeThingElse\n---&gt; macro_010.xlsb: Workbook_Open is part of ThisWorkbook in the IDE\n---&gt; macro_010.xlsb: \"Sub YourCode\" is part of a module in the IDE!\nTest 2: finished successfully\n</code></pre>\n\n<p>Q.E.D. ;-)</p>\n\n<p><a href=\"https://i.stack.imgur.com/e9pe8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e9pe8.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 2727467, "user_type": "registered", "profile_image": "https://graph.facebook.com/591840664/picture?type=large", "display_name": "Ned Charles", "link": "https://stackoverflow.com/users/2727467/ned-charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553780951, "creation_date": 1553719826, "last_edit_date": 1553758164, "question_id": 55386231, "link": "https://stackoverflow.com/questions/55386231/use-vba-to-open-multiple-files-that-run-vba-on-open-at-the-same-tjme", "title": "Use VBA to open multiple files that run VBA on open at the same tjme", "body": "<p>I have one excel file that opens other excel files using VBA. These other excel files all run code on open \u2014 currently when the main file opens a file, it waits for the on open code to run in the file it just opened, and then opens the next file. I would like it to just open the files then move on to opening the next file without waiting for the on open code to finish \u2014  (I plan on limiting the number of files it has open at a time using process IDs) \u2014 any tips?</p>\n"}, {"tags": ["excel", "vba", "copy", "excel-2016"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1553717078, "post_id": 55385562, "comment_id": 97493051, "body": "Is the range you want to copy over always <code>A1:C3</code> from each of the workbooks?"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1553717143, "post_id": 55385562, "comment_id": 97493092, "body": "yes but the Range can change, I would want to do find but for now Range would do"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553717711, "post_id": 55385562, "comment_id": 97493346, "body": "Do you know SQL?"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553717752, "post_id": 55385562, "comment_id": 97493364, "body": "I do not, sorry"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553718386, "post_id": 55385761, "comment_id": 97493653, "body": "This is Amazing Thank you Tigeravatar.  one question if I want just the first sheet from the workbook instead each sheet from the wb?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553718607, "post_id": 55385761, "comment_id": 97493739, "body": "@Spock See updated answer.  I removed the worksheet loop and instead only reference <code>Sheets(1)</code> of the opened workbook."}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553718750, "post_id": 55385761, "comment_id": 97493793, "body": "you are a lifesaver. Thank you much Tigeravatar"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553719047, "post_id": 55385761, "comment_id": 97493911, "body": "what if the files are in subfolder? sorry I should have mention that on my origianl post."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553719151, "post_id": 55385761, "comment_id": 97493968, "body": "You mean, you have files in a main folder, and that main folder also has subfolders where you need to find files?  So all the files you need are spread out among multiple folders? If that&#39;s the case, I recommend asking a new question since that deviates significantly from the intent of this question."}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1553719291, "post_id": 55385761, "comment_id": 97494046, "body": "you got it. Thank you. you have really helped me a lot."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1553718580, "last_edit_date": 1553718580, "creation_date": 1553717839, "answer_id": 55385761, "question_id": 55385562, "link": "https://stackoverflow.com/questions/55385562/copy-range-to-another-sheet/55385761#55385761", "title": "Copy range to another sheet", "body": "<p>I think something like this might be what you're looking for.  I added comments to the code to help explain it.</p>\n\n<pre><code>Sub tgr()\n\n    Dim wbDest As Workbook\n    Dim wsDest As Worksheet\n    Dim rCopy As Range\n    Dim sFolder As String\n    Dim sFile As String\n    Dim lRow As Long\n\n    Set wbDest = ThisWorkbook                   'The workbook where information will be copied into\n    Set wsDest = wbDest.Worksheets(\"Sheet1\")    'The worksheet where information will be copied into\n    sFolder = \"C:\\Test\\\"                        'The folder path containing the xlsx files to copy from\n    lRow = 1                                    'The starting row where information will be copied into\n\n    'Adjust the folder path to ensure it ends with \\\n    If Right(sFolder, 1) &lt;&gt; \"\\\" Then sFolder = sFolder &amp; \"\\\"\n\n    'Get the first .xlsx file in the folder path\n    sFile = Dir(sFolder &amp; \"*.xlsx\")\n\n    'Begin loop through each file in the folder\n    Do While Len(sFile) &gt; 0\n\n        'Open the current workbook in the folder\n        With Workbooks.Open(sFolder &amp; sFile)\n            'Copy over the formulas from A1:C3 from only the first worksheet into the destination worksheet\n            Set rCopy = .Sheets(1).Range(\"A1:C3\")\n            wsDest.Cells(lRow, \"A\").Resize(rCopy.Rows.Count, rCopy.Columns.Count).Formula = rCopy.Formula\n\n            'Advance the destination row by the number of rows being copied over\n            lRow = lRow + rCopy.Rows.Count\n\n            .Close False    'Close the workbook that was opened from the folder without saving changes\n        End With\n        sFile = Dir 'Advance to the next file\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55385761, "answer_count": 1, "score": 2, "last_activity_date": 1553718580, "creation_date": 1553716933, "last_edit_date": 1553718444, "question_id": 55385562, "link": "https://stackoverflow.com/questions/55385562/copy-range-to-another-sheet", "title": "Copy range to another sheet", "body": "<p>I'm super new at VBA, and I am trying to copy range from a closed Excel file to an active workbook without overriding the current pasted range.</p>\n\n<p>This is on Excel 2016.</p>\n\n<pre><code>Sub GetDataFromWbs()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fldr = fso.Getfolder(\"C:\\Path\")\n    Dim lastrow As Long\n\n    For Each wbFile In fldr.Files\n        If fso.GetExtensionName(wbFile.Name) = \"xlsx\" Then\n            Set wb = Workbooks.Open(wbFile.Path)\n            For Each ws In wb.Sheets\n                ThisWorkbook.Activate\n                Worksheets(\"Sheet1\").Range(\"A1:D12\").Formula = wb.Worksheets(\"Sheet1\").Range(\"a1:c3\").Formula  \n                'here is where I would like to add +1 so my loop isn't overridden   \n            Next 'ws\n            wb.Close\n        End If\n    Next 'wbFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553716185, "post_id": 55385362, "comment_id": 97492629, "body": "You want to copy every 5th row? If so, use a <code>Union</code> and <code>For i = 2 to LR Step 5</code> while adding your increments to the <code>Union</code>"}, {"owner": {"reputation": 1, "user_id": 11268344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160e784d5a811b985989a8056dc4bad6?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/11268344/joe"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553717843, "post_id": 55385362, "comment_id": 97493411, "body": "Thank you Union worked great! I had tried copy, autofill, and other functions with only partial success."}], "owner": {"reputation": 1, "user_id": 11268344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160e784d5a811b985989a8056dc4bad6?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/11268344/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553758146, "creation_date": 1553716037, "last_edit_date": 1553758146, "question_id": 55385362, "link": "https://stackoverflow.com/questions/55385362/how-to-copy-a-cell-across-a-dynamic-range-of-columns", "title": "How to copy a cell across a dynamic range of columns", "body": "<p>I have data on a large number of rows 200000+ and 20 columns or less that I would like to graph. Because it is so large graphing becomes problematic. I would like to copy every nth row to a new sheet and graph from the new sheet. </p>\n\n<p>I can accomplish the task by entering and dragging offset formula.I would like to do this same task dynamically with VBA code. In this code I am trying to enter offset formula into cell a1 of sheet2 and copy the formula to a range defined by data range on sheet1. It gives error \"autofill method of range class failed\" on last line.</p>\n\n<pre><code>Sub copy_5()\n\nDim startCol As String\nDim startRow As Long\nDim lastRow As Long\nDim lastCol As Long\nDim myCol As String\nDim ws As Worksheet\nDim rng As Range\nDim cell As Range\n\nSet ws = ThisWorkbook.Sheets(\"sheet1\")\nstartCol = \"a\"\nstartRow = 1\nlastRow = ws.Range(startCol &amp; ws.Rows.Count).End(xlUp).Row\nlastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\nmyCol = GetColumnLetter(lastCol)\n\nSet rng = ws.Range(startCol &amp; startRow &amp; \":\" &amp; myCol &amp; lastRow)\n\nFor Each cell In rng\n\nNext cell\n\n\n    With ActiveWorkbook\n    .Sheets.Add(after:=.Sheets(.Sheets.Count)).Name = \"sheet2\"\n    End With\n\n    Range(\"a1\").Value = (\"=OFFSET(data!A1,(ROW()-1)*5,0)\")\n\n    Range(\"a1\").AutoFill Destination:=Range(startCol &amp; startRow &amp; \":\" &amp; myCol &amp; lastRow)\n\n\nEnd Sub\n</code></pre>\n\n<p>It gives error </p>\n\n<blockquote>\n  <p>\"autofill method of range class failed\" </p>\n</blockquote>\n\n<p>on last line.</p>\n\n<p>I would like it to fill the same number of columns in sheet2 as are in sheet1.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1553712876, "post_id": 55384520, "comment_id": 97491075, "body": "What line are you getting the error ?"}, {"owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1553714184, "post_id": 55384520, "comment_id": 97491681, "body": "I am not getting any error, it is simply not displaying the pivot table with the Values, it&#39;s only showing the Row Fields"}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1553713963, "creation_date": 1553713963, "answer_id": 55384884, "question_id": 55384520, "link": "https://stackoverflow.com/questions/55384520/excel-vba-adding-values-field-in-pivot-table-not-working/55384884#55384884", "title": "Excel VBA adding Values field in Pivot Table not working", "body": "<p>I would recommend some clean-up:</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable\")\n   'Insert Row Fields\n   With .PivotFields(\"Account Lvl1 Desc\")\n       .Orientation = xlRowField\n       .Position = 1\n   End With\n   With .PivotFields(\"Account Description\")\n       .Orientation = xlRowField\n       .Position = 2\n   End With\n   With .PivotFields(\"Supplier\")\n       .Orientation = xlRowField\n       .Position = 3\n   End With\n   'Insert Data Field \n   With .PivotFields (\"Distrib Amt CAD\")\n       .Orientation = xlDataField\n       .Function = xlSum\n       '.NumberFormat = \"#,##0\"\n       .Name = \"Sum of OH in CAD \"\n   End With\nEnd With\n</code></pre>\n\n<p>If you have values that you, say, exported from SharePoint field tables, those are strings... run a similar code to the below on your data so you can display as a number:</p>\n\n<pre><code>With sws 'source worksheet\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For i = 2 To lr\n        .Cells(i, 6).Value = Val(.Cells(i, 6).Value) * 1 'Uses column 6 (F)\n    Next i\nEnd With\n</code></pre>\n\n<p>Once the appropriate data exists, it will give more than #Value errors on the output.</p>\n"}], "owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "accepted_answer_id": 55384884, "answer_count": 1, "score": 0, "last_activity_date": 1553713963, "creation_date": 1553712577, "question_id": 55384520, "link": "https://stackoverflow.com/questions/55384520/excel-vba-adding-values-field-in-pivot-table-not-working", "title": "Excel VBA adding Values field in Pivot Table not working", "body": "<p>Hi I am trying to add a Values field in my Pivot table. Here is the code I have for now :</p>\n\n<pre><code> 'Insert Row Fields\n   With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Account Lvl1 Desc\")\n   .Orientation = xlRowField\n   .Position = 1\n   End With\n   With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Account Description\")\n   .Orientation = xlRowField\n   .Position = 2\n   End With\n   With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Supplier\")\n   .Orientation = xlRowField\n   .Position = 3\n   End With\n\n 'Insert Data Field\n   With ActiveSheet.PivotTables(\"PivotTable\")\n\n   .PivotFields (\"Distrib Amt CAD\")\n   .Orientation = xlDataField\n   .Function = xlSum\n   '.NumberFormat = \"#,##0\"\n   .Name = \"Sum of OH in CAD \"\n   End With\n</code></pre>\n\n<p>Everything else is working but the Values</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1553712262, "post_id": 55384395, "comment_id": 97490761, "body": "Can&#39;t you use a filter and select anything but empty, copy range to new sheet and save as CSV?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553712311, "post_id": 55384395, "comment_id": 97490795, "body": "What&#39;s the output of your other MsgBox calls?  I don&#39;t see any additional row in <code>UsedRange</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1553712431, "post_id": 55384395, "comment_id": 97490848, "body": "For the sake of asking, how consistent is your range?  if you know your number of columns (via dynamically determining last column) and you know your last row (via dynamically determining last row), you can use a specified range... cells(1,1).resize(lr,lc).copy or something like that"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1553712490, "post_id": 55384395, "comment_id": 97490872, "body": "There are better ways to find the last row/column containing data.  <code>UsedRange</code> can have inaccuracies.  Do a <code>search</code> in this forum to find various methods."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1553712591, "post_id": 55384395, "comment_id": 97490923, "body": "Are you performing the CSV SaveAs using VBA?  If Yes, it would be useful to post that."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553712807, "post_id": 55384395, "comment_id": 97491048, "body": "@TimWilliams Yes I am - I&#39;ve never used UsedRange before since I never need it as a VBA hound but that&#39;s how I understand VBA to know what to save. Here&#39;s my SaveAs line: <code>ThisWorkbook.SaveAs Filename:=strFilePath, FileFormat:=xlCSV</code>"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553712892, "post_id": 55384395, "comment_id": 97491081, "body": "@Cyril Definitely agree with you - my problem is that I understand .SaveAs to use the <code>UsedRange</code> to determine output. Definitely don&#39;t have any problems copy-pasting or any other functions."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553713966, "post_id": 55384395, "comment_id": 97491585, "body": "@TimWilliams Edited actual/expected results into question, cleaned up code block to make it easier to follow."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553714763, "post_id": 55384395, "comment_id": 97491940, "body": "@TimWilliams Also added another detail that may help you recreate the issue - right before this happens, I do the following after filtering: <code>rngAllDate.SpecialCells(xlCellTypeVisible).Copy ThisWorkbook.Worksheets(1).Cells(1, 1)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553714814, "post_id": 55384395, "comment_id": 97491959, "body": "What is your actual occupied range?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553714894, "post_id": 55384395, "comment_id": 97492001, "body": "@TimWilliams $A$1:$N$10 (number 4 in expected Msgbox results)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553715087, "post_id": 55384395, "comment_id": 97492081, "body": "I can&#39;t replicate what you&#39;re seeing.  UseRange is always A1:N10"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553715443, "post_id": 55384395, "comment_id": 97492258, "body": "@TimWilliams Thanks for trying!"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553715510, "post_id": 55384395, "comment_id": 97492308, "body": "Have you checked each cells on row 11 to make sure there are no spaces?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553715586, "post_id": 55384395, "comment_id": 97492343, "body": "@W-hit Just did this, no spaces."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 2, "creation_date": 1553714112, "post_id": 55384705, "comment_id": 97491644, "body": "Just tried this, unfortunately it didn&#39;t work for me, but I&#39;m glad it worked for you and thank you for suggesting it! Sometimes inexplicable things do work."}], "tags": [], "owner": {"reputation": 61, "user_id": 11262141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d17c24f22572d49dfca58ec1c481d51?s=128&d=identicon&r=PG&f=1", "display_name": "Krysteel", "link": "https://stackoverflow.com/users/11262141/krysteel"}, "is_accepted": false, "score": 0, "last_activity_date": 1553713310, "creation_date": 1553713310, "answer_id": 55384705, "question_id": 55384395, "link": "https://stackoverflow.com/questions/55384395/usedrange-cant-eliminate-trailing-blank-row/55384705#55384705", "title": "UsedRange - can&#39;t eliminate trailing blank row", "body": "<p>I recently had an issue with the UsedRange on a spreadsheet, and I couldn't delete/clear the cells and get the UsedRange to reset. The fix I found was to select all the un-used rows/columns, change the size of them, now delete the cells, save the spreadsheet, and boom the UsedRange was reset... Maybe this will help you?</p>\n"}, {"tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": false, "score": 0, "last_activity_date": 1553717491, "last_edit_date": 1553717491, "creation_date": 1553717059, "answer_id": 55385586, "question_id": 55384395, "link": "https://stackoverflow.com/questions/55384395/usedrange-cant-eliminate-trailing-blank-row/55385586#55385586", "title": "UsedRange - can&#39;t eliminate trailing blank row", "body": "<p>try running this to see if there are any hidden breaks on row 11 right before  you calculate that usedrange</p>\n\n<pre><code>Sub IterateCharacters()\n    For Each cell In Sheets(\"Sheet1\").Range(Cells(11, 1), Cells(11, 14))\n        With cell\n            For n = 1 To Len(.Value)\n                Debug.Print Asc(Mid(.Value, n, 1))\n            Next n\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>Also, try the line below right after you get the incorrect used range, then test the used range again.</p>\n\n<pre><code>ActiveSheet.Range(Cells(11, 1), Cells(11, 14)).Replace \"*\", vbNullString\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": true, "score": 0, "last_activity_date": 1553717119, "creation_date": 1553717119, "answer_id": 55385600, "question_id": 55384395, "link": "https://stackoverflow.com/questions/55384395/usedrange-cant-eliminate-trailing-blank-row/55385600#55385600", "title": "UsedRange - can&#39;t eliminate trailing blank row", "body": "<p>For some reason, the formatting of the actual data range was causing the UsedRange to include a blank row at the end. For the record, I was using a Thick Box Border around the data range.</p>\n\n<p>After clearing formats from the data range as well, it <em>seemed</em> that the blank row was still being included in the UsedRange, as I stated I tested above, because when I pushed Ctrl-Shift-End, the highlighted area still included the blank row. However, VBA reveals that the actual UsedRange has in fact shrunk to row 10 from row 11.</p>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 55385600, "answer_count": 3, "score": 1, "last_activity_date": 1553717491, "creation_date": 1553712003, "last_edit_date": 1553714694, "question_id": 55384395, "link": "https://stackoverflow.com/questions/55384395/usedrange-cant-eliminate-trailing-blank-row", "title": "UsedRange - can&#39;t eliminate trailing blank row", "body": "<p>Both VBA and non-VBA answers accepted.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>I'm trying to save a sheet as .csv using <code>ThisWorkbook.SaveAs Filename:=strFilePath, FileFormat:=xlCSV</code>, but because the <code>UsedRange</code> includes a trailing blank row, I get an unwanted row of commas in the .csv.</p>\n\n<p><strong>What I did immediately beforehand in the Code</strong></p>\n\n<pre><code>rngAllDate.SpecialCells(xlCellTypeVisible).Copy ThisWorkbook.Worksheets(1).Cells(1, 1)\n</code></pre>\n\n<p>This may be helpful if you're trying to recreate the issue.</p>\n\n<p><strong>What I've Tried</strong></p>\n\n<ul>\n<li>Deleting all rows under my data</li>\n<li>Using the eraser tool to Clear All from all rows under my data</li>\n<li>Clearing formats from my entire worksheet, including my data, in case the borders were causing an issue</li>\n<li>Using the following VBA codeblock:</li>\n</ul>\n\n<hr>\n\n<pre><code>With ThisWorkbook.Worksheets(1)\n    .UsedRange 'I'm told this recomputes the UsedRange\n    MsgBox .UsedRange.Address\n\n    Dim rngColumnsToDeleteAndClear As Range\n    Set rngColumnsToDeleteAndClear = .Range(.Cells(1, WorksheetFunction.CountA(.Rows(1)) + 1), .Cells(1, .Columns.Count))\n    MsgBox rngColumnsToDeleteAndClear.Address\n    rngColumnsToDeleteAndClear.EntireColumn.Clear\n    rngColumnsToDeleteAndClear.EntireColumn.Delete\n\n    Dim rngRowsToDeleteAndClear As Range\n    Set rngRowsToDeleteAndClear = .Range(.Cells(WorksheetFunction.CountA(.Columns(1)) + 1, 1), .Cells(.Rows.Count, 1))\n    MsgBox rngRowsToDeleteAndClear.Address\n    rngRowsToDeleteAndClear.EntireRow.Clear\n    rngRowsToDeleteAndClear.EntireRow.Delete\n\n    .UsedRange\n    MsgBox .UsedRange.Address\nEnd With\n</code></pre>\n\n<hr>\n\n<p>I get the following Msgbox results from the above codeblock:</p>\n\n<ol>\n<li>$A$1:$N$11</li>\n<li>$O$1:$XFD$1</li>\n<li>$A$11:$A$1048576</li>\n<li>$A$1:$N$11</li>\n</ol>\n\n<p>I expect the following Msgbox results from the above codeblock:</p>\n\n<ol>\n<li>$A$1:$N$11</li>\n<li>$O$1:$XFD$1</li>\n<li>$A$11:$A$1048576</li>\n<li>$A$1:$N$10</li>\n</ol>\n\n<p>What else can I try?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553721706, "post_id": 55384321, "comment_id": 97495202, "body": "You need to update your example with a screen shot of the text in Word with the hidden formatting showing.  At the moment it is not clear if you paragraphs are paragraph or just section of text within a paragraph."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553723636, "post_id": 55384321, "comment_id": 97495983, "body": "Your description suggests you&#39;re trying to clean up the formatting of text that&#39;s been copied from websites, e-mails, and/or PDFs. In that case, see, for example: <a href=\"http://www.msofficeforums.com/word/29880-cleaning-up-text-pasted-websites-e-mails.html\" rel=\"nofollow noreferrer\">msofficeforums.com/word/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553740293, "post_id": 55384321, "comment_id": 97500157, "body": "Hi @Freeflow, as per your recommendation, added images for both input and output. Thank you for looking at it"}, {"owner": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553740375, "post_id": 55384321, "comment_id": 97500176, "body": "@macropod The input is not really from PDF, but sort of Yes. Thank you for the link. I checked it. Unfortunately it does not help."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553742953, "post_id": 55384321, "comment_id": 97500695, "body": "Did you actually try the code there - and make sure your text is appropriately structured beforehand? Saying only &quot;Unfortunately it does not help&quot; isn&#39;t conducive to finding a solution. After all, not every sentence terminating a line in a document also terminates a paragraph. Colons &amp; semi-colons, too, may be in-line and your approach could end up with some items following a colon being put in separate paragraphs and other items following the same colons being put in the same paragraphs."}, {"owner": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553745021, "post_id": 55384321, "comment_id": 97501077, "body": "@macropod Of course, I actually tested. Haven&#39;t tried anything complicated, just one simple sentence -&gt; divided into multiple paragraph with &lt;carriage return&gt;. At the end of every sentence added period, Question mark and semi colon. The output is blank paragraph(s) are deleted, but sentences were not joined. If you copy paste my code, it works well only when there is a period. All I need is look not only for period, but also others such as question mark, semi-colon, etc."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553750696, "post_id": 55384321, "comment_id": 97502426, "body": "The code in the link works just fine, regardless of how the sentences are terminated. Most likely you have an empty paragraph between each line of text - which the advice in the link I posted clearly says you should not have..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "edited": false, "score": 0, "creation_date": 1553759719, "post_id": 55390907, "comment_id": 97505750, "body": "That&#39;s fabulous. With Replace = ^32\\1 I could achieve it. Even though it merges everything into a single paragraph, still its OK. Written a small patch to split them. Thank you very much!!!"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "edited": false, "score": 0, "creation_date": 1553806591, "post_id": 55390907, "comment_id": 97533991, "body": "&#171;Even though it merges everything into a single paragraph&#187; - not if you&#39;re using the Find expression I posted..."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1553752027, "creation_date": 1553752027, "answer_id": 55390907, "question_id": 55384321, "link": "https://stackoverflow.com/questions/55384321/how-to-search-multiple-string-either-of-the-string-from-the-list-in-a-paragrap/55390907#55390907", "title": "how to search multiple string (either of the string from the list) in a paragraph (updated with input &amp; output images)", "body": "<p>As noted in my comments, paragraphs don't necessarily end at punctuations marks. That said, a crude but effective solution to achieve the results you've described would be to use a <em>wildcard</em> Find/Replace, where:</p>\n\n<pre><code>Find = ([!.\\!\\?;:])^13\nReplace = ^32\\1\n</code></pre>\n\n<p>IOW, you don't even need a macro. Since we don't know whether there are spaces preceding the paragraph breaks in your source text, you may end up with some extra spaces - which you could clean up with another Find/Replace (or you might omit the ^32 from the Replace expression).</p>\n"}], "owner": {"reputation": 11, "user_id": 9204487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94b920661bbb517c2c4778911f77423?s=128&d=identicon&r=PG&f=1", "display_name": "mannar mani", "link": "https://stackoverflow.com/users/9204487/mannar-mani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553752027, "creation_date": 1553711704, "last_edit_date": 1553740590, "question_id": 55384321, "link": "https://stackoverflow.com/questions/55384321/how-to-search-multiple-string-either-of-the-string-from-the-list-in-a-paragrap", "title": "how to search multiple string (either of the string from the list) in a paragraph (updated with input &amp; output images)", "body": "<p>My goal is to merge multiple paragraph based on predefined string (in an arrary) such as period (.) or question mark (?)</p>\n\n<p>My sample sentence is as below (refer the image please):</p>\n\n<p><a href=\"https://i.stack.imgur.com/u2HWg.jpg\" rel=\"nofollow noreferrer\">Input</a></p>\n\n<p>The expected result will be something like this.</p>\n\n<p>////////////////////////////////////////////////////////</p>\n\n<p><a href=\"https://i.stack.imgur.com/8kRhL.jpg\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p>////////////////////////////////////////////////////////</p>\n\n<p>In the below code, I could achieve it using period (.), but for every other end string, I have separate macro. Depends on the end string, I run different macro. Is there way to put all these search string (. / ? / ;) in a single array and ask the code to run until it find either of them and exit from the loop and do the merge?</p>\n\n<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n\n<pre><code>Sub FindDotToJoinParagraph()\nDim xRange As Range\nDim Srt As Variant\nDim Endee As Variant\nDim currentPosition As Range\n\n\n\nSelection.HomeKey Unit:=wdLine, Extend:=wdMove  \nActiveDocument.Bookmarks.Add Range:=Selection.Range, Name:=\"Srt\" 'Bookmark\n\nWith Selection.Find\n    .Text = \".\" 'Here not just period alone, but others too \n    .Replacement.Text = \"\"\n    .Forward = True\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = True\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n\nSelection.Find.Execute\nSelection.EndKey Unit:=wdLine, Extend:=wdMove\nActiveDocument.Bookmarks.Add Range:=Selection.Range, Name:=\"Ends\" 'Bookmark\n\nActiveDocument.Range( _\n    ActiveDocument.Bookmarks(\"Srt\").Range.Start, _\n    ActiveDocument.Bookmarks(\"Ends\").Range.Start) _\n    .Select\n\ncall MergeParaAndLineBreaks() 'An another sub-routine to merge \n\nEnd Sub\n</code></pre>\n\n<p>//////////////////////////////////\n    Sub MergeParaAndLineBreaks()</p>\n\n<pre><code>Dim oRng As Range\nSet oRng = Selection.Range\n\nDim oFind As Range\nSet oFind = Selection.Range\n\nWith oFind.Find\n    Do While .Execute(findtext:=\"[^13^l]{1,}\", MatchWildcards:=True)\n        If oFind.InRange(oRng) Then\n            oFind.Text = \"\"\n        End If\n    Loop\nEnd With\nSet oFind = oRng\n\nWith oFind.Find\n    Do While .Execute(findtext:=\"[ ]{2,}\", MatchWildcards:=True)\n        If oFind.InRange(oRng) Then\n            oFind.Text = Chr(32)\n            oFind.Collapse 0\n        End If\n    Loop\nEnd With\n\nlbl_Exit:\nSet oRng = Nothing\nSet oFind = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n\n<p>Could someone help me out, please!</p>\n"}, {"tags": ["excel", "vba", "msxml2"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553716456, "post_id": 55384107, "comment_id": 97492756, "body": "Seems like it would be difficult for anyone here to diagnose the problem - maybe you&#39;re making too many requests and the server is throttling you, or something else is blocking the request.  Without knowing anything about the other end of the process, or what kind of load you&#39;re placing on it, it&#39;s difficult to make any guesses."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1553731108, "post_id": 55384107, "comment_id": 97498256, "body": "You might want to check the HTTP status code rather than just looking at the status text. Check the value of <code>MyRequest.Status</code> against the details <a href=\"https://tools.ietf.org/html/rfc7231#section-6.1\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1, "user_id": 10032971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad720e2b9dcd7b1993e5ecb92644e96?s=128&d=identicon&r=PG&f=1", "display_name": "DrIzzy", "link": "https://stackoverflow.com/users/10032971/drizzy"}, "edited": false, "score": 0, "creation_date": 1553776586, "post_id": 55384107, "comment_id": 97515654, "body": "Thanks, I&#39;ll check that!"}], "owner": {"reputation": 1, "user_id": 10032971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad720e2b9dcd7b1993e5ecb92644e96?s=128&d=identicon&r=PG&f=1", "display_name": "DrIzzy", "link": "https://stackoverflow.com/users/10032971/drizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553758098, "creation_date": 1553710860, "last_edit_date": 1553758098, "question_id": 55384107, "link": "https://stackoverflow.com/questions/55384107/msxml2-xmlhttp-times-out-once-in-a-while", "title": "MSXML2.XMLHTTP times out once in a while", "body": "<p>Trying to determine if a file exists on the server using an MSXML2.XMLHTTP request. It works most of the time but every once in a while fails with \"Operation timed out\". At most, there error condition kicks in once and theh it returns to working normally. Any ideas?</p>\n\n<pre><code> Public Function InputFileThere(myUrl As String) As Boolean\n Dim myLine As String\n Dim numTimes As Long\n Dim MyRequest As Object\n Dim urlExists As Boolean\n numTimes = 0\n urlExists = False\n Dim dirName As String\n Dim userName As String\n Dim passWord As String\n userName = \u201c******\u201d\n passWord = \u201c******\u201d\n On Error GoTo errorPart\n startHere:\n Set MyRequest = CreateObject(\"MSXML2.XMLHTTP\")\n MyRequest.Open \"HEAD\", myUrl, False, userName, passWord\n MyRequest.send\n If MyRequest.StatusText = \"OK\" Then urlExists = True\n GoTo finHere\n errorPart:\n Set MyRequest = Nothing\n numTimes = numTimes + 1\n myLine = \" Right now \" &amp; Format(Now(), \"hh:mm:ss\") &amp; \" there was an error , numTimes = \" &amp;    CStr(numTimes) &amp; \" Err Description = \" &amp; Err.Description\nApplication.StatusBar = myLine\nApplication.Wait (Now() + TimeValue(\"00:01:00\"))\nGoTo startHere\nfinHere:\nInputFileThere = urlExists\nSet MyRequest = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1553710732, "post_id": 55384027, "comment_id": 97490016, "body": "Set the BodyFormat: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.bodyformat\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1553846884, "post_id": 55384393, "comment_id": 97545186, "body": "Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1553854795, "post_id": 55384393, "comment_id": 97549317, "body": "@user7202022.  <code>objMsg</code> is a mail item which definitely has a Html body.  What is <code>Item</code>?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1553856664, "post_id": 55384393, "comment_id": 97550462, "body": "that&#39;s correct <code>objMsg.HtmlBody = Item.Body</code> works. Item is Appointment where Body is taken. I guess appointment does not have HTML body version? That&#39;s why it does not work?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1553858341, "post_id": 55384393, "comment_id": 97551434, "body": "@user7202022 Since my last comment, I saw than <code>Item</code> is a <code>IPM.Appointment</code>.  I cannot find any useful documentation on this class.  If I understand your comment correctly, <code>Item.Body</code> is an Html string.  You are correct, an <code>AppointmentItem</code> only has a text body but since both bodies are strings, you can put an Html string in the text body.  Have you got what you want or is <code>Item.Body</code> not the formatted body you want for your message?"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1553711994, "creation_date": 1553711994, "answer_id": 55384393, "question_id": 55384027, "link": "https://stackoverflow.com/questions/55384027/scheduled-and-recurring-email-in-outlook-in-html-format/55384393#55384393", "title": "Scheduled and recurring email in Outlook in HTML format", "body": "<p>.Body is the text body.  If you want to copy the Html body try:</p>\n\n<pre><code>objMsg.HtmlBody = Item.HtmlBody\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 55384393, "answer_count": 1, "score": 0, "last_activity_date": 1592684458, "creation_date": 1553710592, "last_edit_date": 1592684458, "question_id": 55384027, "link": "https://stackoverflow.com/questions/55384027/scheduled-and-recurring-email-in-outlook-in-html-format", "title": "Scheduled and recurring email in Outlook in HTML format", "body": "<p>I am using suggestion by kmote from this answer (<a href=\"https://superuser.com/questions/635094/\">https://superuser.com/questions/635094/</a>). Everything seems to work and message is send. However I have a problem with my message. I have images and text formatting in my body. Currently sent message is formatted to only text mode. Is there any way to make it HTML format, so it would be the same as in my appointment?</p>\n\n<pre><code>    Private Sub Application_Reminder(ByVal Item As Object)\n  Dim objMsg As MailItem\n  Set objMsg = Application.CreateItem(olMailItem)\n\nIf Item.MessageClass &lt;&gt; \"IPM.Appointment\" Then\n  Exit Sub\nEnd If\n\nIf Item.Categories &lt;&gt; \"Automated Email Sender\" Then\n  Exit Sub\nEnd If\n\n  objMsg.To = Item.Location\n  objMsg.Subject = Item.Subject\n  objMsg.Body = Item.Body\n  objMsg.Send\n\n  Set objMsg = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1553710026, "post_id": 55383832, "comment_id": 97489610, "body": "What&#39;s the actual value in the cell when the error raises? Have you tried <code>ExpirationDate = CDate(Cells(x, &quot;G&quot;).Value)</code>?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1553710065, "post_id": 55383832, "comment_id": 97489627, "body": "Please show your declared variables.  Are you using serial date or just date?  What is the number of rows you&#39;re working?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1553710449, "post_id": 55383832, "comment_id": 97489837, "body": "<i>marked as dates</i> doesn&#39;t mean <i>is</i> a date. see this often with text-formatted-as-date, or dates from locales that aren&#39;t the system locale, etc."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1553712024, "post_id": 55383832, "comment_id": 97490664, "body": "You can check if the value in the Cell is a date with <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isdate-function?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vblr6.chm1008951)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">IsDate()</a> function. This will help you troubleshoot."}, {"owner": {"reputation": 13, "user_id": 11204056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ebb16b6239792c4ef478168ab2f539?s=128&d=identicon&r=PG&f=1", "display_name": "JSL", "link": "https://stackoverflow.com/users/11204056/jsl"}, "edited": false, "score": 0, "creation_date": 1553712296, "post_id": 55383832, "comment_id": 97490778, "body": "The actual value in the cell is 10/2/2019"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553712577, "post_id": 55383832, "comment_id": 97490918, "body": "Does <code>Debug.Print TypeName(ExpirationDate)</code> output <code>Date</code> or <code>String</code>? Is it declared anywhere? With an explicit type? If so then note that cell values should be read into a <code>Variant</code>, lest you get a <i>type mismatch</i> error if you try to read a worksheet error value (e.g. <code>#REF!</code>) into a <code>Date</code>, <code>String</code>, or any other type."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10313264, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217881355013641/picture?type=large", "display_name": "Mathew Raju", "link": "https://stackoverflow.com/users/10313264/mathew-raju"}, "is_accepted": false, "score": 0, "last_activity_date": 1553752825, "creation_date": 1553752825, "answer_id": 55391038, "question_id": 55383832, "link": "https://stackoverflow.com/questions/55383832/type-mismatch-error-when-assigning-date-to-variable/55391038#55391038", "title": "Type mismatch error when assigning date to variable", "body": "<p>Please try replacing the following line:</p>\n\n<pre><code> ExpirationDate = Cells(x, \"G\").Value\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>ExpirationDate = Cells(x,7).Value\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11204056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ebb16b6239792c4ef478168ab2f539?s=128&d=identicon&r=PG&f=1", "display_name": "JSL", "link": "https://stackoverflow.com/users/11204056/jsl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553752825, "creation_date": 1553709853, "last_edit_date": 1553710288, "question_id": 55383832, "link": "https://stackoverflow.com/questions/55383832/type-mismatch-error-when-assigning-date-to-variable", "title": "Type mismatch error when assigning date to variable", "body": "<p>I'm trying to loop through expiration dates in column \"G\" and compare them with today's date. The code loops through 363 times whenever I run it but then it stops at <code>ExpirationDate = Cells(x, \"G\").Value</code> and gives me a type mismatch error. </p>\n\n<p>All the cells in column \"G\" are marked as dates and so is ExpirationDate. There is no difference that I can see between the row that the code always stops at and the rows prior which successfully passed through the code.</p>\n\n<pre><code>    For x = 13 To numrows\n        reminderrows = Worksheets(\"Reminders\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        expiredrows = Worksheets(\"Expired\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        Worksheets(\"Training Log Test\").Activate\n\n        ExpirationDate = Cells(x, \"G\").Value\n\n        If ExpirationDate &gt; today And ExpirationDate &lt;= ninetydays Then\n            Rows(x).Copy\n            Worksheets(\"Reminders\").Activate\n            Worksheets(\"Reminders\").Cells(reminderrows + 1, 1).Select\n            ActiveSheet.Paste\n\n        ElseIf today &gt;= ExpirationDate Then\n            Rows(x).Copy\n            Worksheets(\"Expired\").Activate\n            Worksheets(\"Expired\").Cells(expiredrows + 1, 1).Select\n            ActiveSheet.Paste\n        Else\n        End If\n    Next       \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "iteration"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553709977, "post_id": 55383511, "comment_id": 97489585, "body": "The short identifiers and lack of proper block indentation makes the code rather hard to read/follow, so I only superficially glanced at it, but consider declaring your variant arrays <code>foo As Variant</code> instead of <code>foo() As Variant</code>. Also note that the unqualified <code>Range</code> calls in <code>cek</code> are implicitly referring to whatever the <code>ActiveSheet</code> is, and all involve an implicit <code>_Default</code> member call that you could make explicit by appending <code>.Value</code> to populate the 2D variant arrays."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553710028, "post_id": 55383511, "comment_id": 97489614, "body": "That said <code>temp1(i) = x2 - x1(i)</code> is clearly trying to subtract an array from an array element, and VBA doesn&#39;t do set operations on arrays, if that&#39;s what you intended to do here. Did you mean <code>= x2(i) - x1(i)</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553710118, "post_id": 55383511, "comment_id": 97489660, "body": "One more thing: the <code>err</code> parameter is hiding/shadowing the <code>VBA.Information.Err</code> global function, which is fundamental for any kind of debugging and/or error-handling. You will definitely want to rename that to something else."}, {"owner": {"reputation": 1, "user_id": 10893033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf4587c57719ff4111066a4a106c0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Irsyad Nash", "link": "https://stackoverflow.com/users/10893033/irsyad-nash"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553744228, "post_id": 55383511, "comment_id": 97500937, "body": "@Mathieu Guindon Thank you for your advices, i will try to use them and post the result."}], "owner": {"reputation": 1, "user_id": 10893033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf4587c57719ff4111066a4a106c0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Irsyad Nash", "link": "https://stackoverflow.com/users/10893033/irsyad-nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553708574, "creation_date": 1553708574, "question_id": 55383511, "link": "https://stackoverflow.com/questions/55383511/how-to-assign-value-individually-in-vba-to-prevent-cant-assign-to-array", "title": "How to assign value individually in VBA to prevent &quot;Can&#39;t Assign To Array&quot;?", "body": "<p>When i execute below function, i am getting \"Can't assign to array\" compile error.</p>\n\n<p>I try to change x2() to x2 and get : \"Subscript out of range\" for any length i used or Mismatch error.</p>\n\n<pre><code>Public Function Residual(x1() As Variant, x2() As Variant)\n    Dim temp1() As Variant, temp2 As Variant\n    Dim i As Integer, j As Integer, le As Integer\n    le = UBound(x1) - LBound(x1)\n    For i = 1 To le\n        temp1(i) = x2 - x1(i)\n        temp2 = temp2 + temp1(i)\n    Next i\n    Residual = temp2 / le\nEnd Function\n\nPublic Function Jacobi(A() As Variant, b() As Variant, x() As Variant, err As Variant)\n    Dim i As Integer, j As Integer, k As Integer, le As Integer\n    le = UBound(A) - LBound(A)\n    ReDim Dia(1 To le, 1 To le)\n    ReDim Low(1 To le, 1 To le)\n    ReDim Upp(1 To le, 1 To le)\n\n    For i = 1 To le\n        For j = 1 To le\n            If i = j Then\n            Dia(i, j) = A(i, j)\n            Else: Dia(i, j) = 0\n            End If\n        Next j\n        For j = i + 1 To le\n            If i &lt; j Then\n            Low(i, j) = A(i, j)\n            Else: Low(i, j) = 0\n            End If\n        Next j\n        For j = i + 1 To le\n            If i &gt; j Then\n            Upp(i, j) = A(i, j)\n            Else: Upp(i, j) = 0\n            End If\n        Next j\n    Next i\n\n    Dim temp1() As Variant, temp2() As Variant, temp3() As Variant, x1() As Variant, x2() As Variant\n\n    x1 = x\n    Do While Residual(x1, x2) &gt; err\n        temp1 = Application.WorksheetFunction.MMult(Application.WorksheetFunction.MInverse(Dia), Application.WorksheetFunction.Sum(Low, Upp))\n        temp2 = Application.WorksheetFunction.MMult(temp1, x1)\n        temp3 = Application.WorksheetFunction.MMult(Application.WorksheetFunction.MInverse(Dia), b)\n        x2 = Application.WorksheetFunction.Sum(temp2, temp3)\n        x1 = x2\n    Loop\n    Jacobi = x2\nEnd Function\nSub cek()\n    Dim A() As Variant, b() As Variant, x() As Variant\n    Dim hasil As Integer\n\n    A = Range(\"A1:C3\")\n    b = Range(\"D1:D3\")\n    x = Range(\"E1:E3\")\n    hasil = Jacobi(A, b, x, 0.0001)\nEnd Sub\n</code></pre>\n\n<p>I'm new to VBA and this program for Jacobi method. What i did wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1553708962, "post_id": 55383555, "comment_id": 97489050, "body": "Thanks for useful tip. However I would like to add if error to my code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553714567, "post_id": 55383555, "comment_id": 97491857, "body": "This is unfounded and useless advice that adds an unnecessary level of indirection that obscures which workbook we&#39;re working with. <code>ThisWorkbook</code> is a project-wide identifier that holds a reference to the specific workbook that contains the VBA code that&#39;s running. This answer takes good, solid advice about <code>ActiveWorkbook</code> and turns it into bad advice about <code>ThisWorkbook</code>. <code>ActiveWorkbook</code> can change depending on what the code (or user) is doing during execution, that&#39;s why you keep a named reference to it. <code>ThisWorkbook</code> only ever refers to one very specific object. Copying it is useless."}], "tags": [], "owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1553708766, "creation_date": 1553708766, "answer_id": 55383555, "question_id": 55383432, "link": "https://stackoverflow.com/questions/55383432/display-message-and-lock-workbook-if-error/55383555#55383555", "title": "Display message and lock workbook if error", "body": "<p>In my experience it is not good to use ThisWorkbook many times, in the beginning of your code use the following,</p>\n\n<pre><code>dim thisWb as excel.workbook\nset thisWb = thisworkbook\n</code></pre>\n\n<p>then instead of ThisWorkbook use thisWb and it won't matter if the user clicks on another different wb during execution.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55383555, "answer_count": 1, "score": 0, "last_activity_date": 1553714334, "creation_date": 1553708316, "last_edit_date": 1553714334, "question_id": 55383432, "link": "https://stackoverflow.com/questions/55383432/display-message-and-lock-workbook-if-error", "title": "Display message and lock workbook if error", "body": "<p>I have VBA code for running several operations. It unlocks Workbook before running and protects after operation is done. However sometimes code runs into an error due to user opening windows or doing something in background. I would like it not to display any kind of Visual Basic standard message like \"Compile error\" but my custom message whenever code runs to any kind of error and use <code>ThisWorkbook.Protect Password:=\"123456\", Structure:=True, Windows:=False</code>. </p>\n\n<p>P.S. Time break is due operation system on my computer can't handle the processes that fast. </p>\n\n<pre><code>Sub TryToDoEverything()\nApplication.ScreenUpdating = False\nThisWorkbook.Unprotect Password:=\"123456\"\n\n    ufProgress.LabelProgress.Width = 0\n    ufProgress.Show\n\nFractionComplete (0) 'Next step\n\nWorksheets(\"MAIN\").Activate\n\nCall MakeMyFolder\nApplication.Wait (Now + TimeValue(\"00:00:10\"))\nDoEvents\nFractionComplete (0.1) 'Next step\n\nIf ThisWorkbook.Sheets(\"Other Data\").Range(\"J2\").Value = True Then\nCall opentemplateWordOL\nEnd If\nIf ThisWorkbook.Sheets(\"Other Data\").Range(\"J2\").Value = False Then\nEnd If\n\nDoEvents\nFractionComplete (0.2) 'Next step\nApplication.Wait (Now + TimeValue(\"00:00:10\"))\n\nIf ThisWorkbook.Sheets(\"Other Data\").Range(\"J2\").Value = True Then\nCall opentemplateWordPL\nEnd If\nIf ThisWorkbook.Sheets(\"Other Data\").Range(\"J2\").Value = False Then\nEnd If\n\nDoEvents\nFractionComplete (0.4) 'Next step\nApplication.Wait (Now + TimeValue(\"00:00:10\"))\n\nFractionComplete (1) 'Next step\n\nWorksheets(\"MAIN\").Activate\n\nUnload ufProgress\n\nThisWorkbook.Protect Password:=\"123456\", Structure:=True, Windows:=False\n\n    TaskComplete.Show\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1553711518, "post_id": 55383405, "comment_id": 97490415, "body": "Are you sure AutoFilter returns at least one row to delete? The error may be caused by absence of any rows to delete after filter is applied."}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1553711741, "post_id": 55383405, "comment_id": 97490538, "body": "Yes, it returns roughly 25/150 (loop will run around 10 times)."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553714415, "post_id": 55383405, "comment_id": 97491787, "body": "The offset is only deleting the first row after the <code>targetRangeName</code>.  I would suggest using a <code>Union</code> to remove all of the visible rows.  This link may offer some guidance <a href=\"https://stackoverflow.com/questions/45363077/deleting-rows-from-filtered-range-via-macro\" title=\"deleting rows from filtered range via macro\">stackoverflow.com/questions/45363077/&hellip;</a>."}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553715834, "post_id": 55383405, "comment_id": 97492452, "body": "I have had this exact formula work before, which is why it is strange.  I am just not sure why it isn&#39;t working here.  I can post the entire code if that will help."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553717052, "post_id": 55385522, "comment_id": 97493040, "body": "Hi Tim,  I am getting that the offset (1, 0) is an application defined or object defined error.  I shouldn&#39;t have to declare an offset function should I?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553719214, "post_id": 55385522, "comment_id": 97494004, "body": "What&#39;s the range <code>targetRangeName</code> when it fails?  If that represents one or more complete columns, then you can&#39;t offset that by one row..."}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553719357, "post_id": 55385522, "comment_id": 97494073, "body": "This represents the entire worksheet, essentially.  Does it need to be a single column (i.e. the column I am filtering by)?  When I try setting targetrangename to the column I am filtering and the field:=1 I am still receiving the same error."}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553720562, "post_id": 55385522, "comment_id": 97494677, "body": "The range is columns (&quot;A:AM&quot;) and then the filter column is 17."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 1, "creation_date": 1553720865, "post_id": 55385522, "comment_id": 97494813, "body": "@ConnorSmith - its very efficient to work with <i>entire columns</i> of data when only <i>n</i> number of rows has actual data. Get the lastRow of used data and then work with that defined range. you&#39;re programs will be much happier :)"}, {"owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "edited": false, "score": 0, "creation_date": 1553721254, "post_id": 55385522, "comment_id": 97494989, "body": "Scott, you have answered a lifelong question!  Thank you, sir!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1553720421, "last_edit_date": 1553720421, "creation_date": 1553716752, "answer_id": 55385522, "question_id": 55383405, "link": "https://stackoverflow.com/questions/55383405/offset-function-wont-work-to-delete-all-visible-cells-besides-headers/55385522#55385522", "title": "Offset function wont work to delete all visible cells besides headers", "body": "<p>Not an answer, but break it up a bit to see if you can debug:</p>\n\n<pre><code>Dim rng As range\n\nWith targetSheet.Range(targetRangeName)\n\n    .AutoFilter Field:=17, Criteria1:=\"&lt;&gt;\" &amp; sourceCell.Value, _\n                Operator:=xlFilterValues\n\n    Set rng = .Offset(1, 0)\n    Debug.Print rng.Address\n\n    Set rng = rng.SpecialCells(xlCellTypeVisible)\n    Debug.Print rng.Rows.Count\n\n    rng.EntireRow.Delete\n\nEnd With\n</code></pre>\n\n<p><strong>EDIT</strong>: you can't offset a range by one row if it already reaches the last row in the sheet.  If all you really want to do is exclude a header row then you can do something like this:</p>\n\n<pre><code>Dim rng\nSet rng = ActiveSheet.Columns(1)\n\nDebug.Print rng.Address '&gt;&gt; $A:$A\n\n'resize and offset to exclude the first row\nSet rng = rng.Resize(rng.Rows.Count - 1, rng.Columns.Count).Offset(1, 0)\n\nDebug.Print rng.Address '&gt;&gt; $A$2:$A$1048576\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11161801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19db0cd3f5f981275bd80a2861bc474a?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Smith", "link": "https://stackoverflow.com/users/11161801/connor-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553758091, "creation_date": 1553708232, "last_edit_date": 1553758091, "question_id": 55383405, "link": "https://stackoverflow.com/questions/55383405/offset-function-wont-work-to-delete-all-visible-cells-besides-headers", "title": "Offset function wont work to delete all visible cells besides headers", "body": "<p>My code is working until I try to delete all visible cells (besides headers) after filtering. Can someone tell me why my offset command is giving me a application defined or object defined error?</p>\n\n<p>I have tried just using rows, deleting visible cells, setting a range.</p>\n\n<pre><code>    'Filter target cell out and remove all other rows\n    With targetSheet.Range(targetRangeName)\n        .AutoFilter Field:=17, Criteria1:=\"&lt;&gt;\" &amp; sourceCell.Value, Operator:=xlFilterValues\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n</code></pre>\n\n<p>I want to delete all visible cells (besides headers) after filtering.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1553711727, "post_id": 55383331, "comment_id": 97490530, "body": "Copy&gt;&gt;Paste is a 2 lines code: <code>wks.Range(&quot;H2:N2&quot; &amp; wks.Cells(Rows.Count, &quot;N&quot;).End(xlUp).Row).Copy</code>  and <code>Worksheets(&quot;Master Data&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Offset(1).PasteSpecial xlPasteValues</code>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1553757959, "creation_date": 1553757959, "answer_id": 55392164, "question_id": 55383331, "link": "https://stackoverflow.com/questions/55383331/paste-as-values/55392164#55392164", "title": "Paste as Values", "body": "<p>To paste as values you need to use the  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\">Range.PasteSpecial method</a>: <code>.PasteSpecial xlPasteValues</code></p>\n\n<p>Note that if you use an array for the worksheets to skip you can reduce your code like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub exa()\n    Dim SkipWorksheets As Variant\n    SkipWorksheets = Array(\"Master Data\", \"Query ---&gt;\", \"Pivot Portfolio Movement\", \"PortfolioMovement - All\", _\n                           \"Bank Holidays\", \"Property\", \"Postcodes\", \"Product\", \"PartRedemption\", \"Wrap\", _\n                           \"Completions Database\", \"Default\", \"ReturningBorrower\", \"Extensions\", _\n                           \"PortfolioMovement\", \"Drawdowns\", \"Dev Interest WIP\", \"Write Off Loans\", _\n                           \"Interest Rate\", \"Admin\", \"Datatape ---&gt;\", \"Data\", \"Drawn Balance by Loan\", \"Sheet1\")\n\n\n    Dim Wks As Worksheet\n    For Each Wks In ThisWorkbook.Worksheets\n        If Not (UBound(Filter(SkipWorksheets, Wks.Name)) &gt; -1) Then\n            Wks.Range(\"H2:N2\" &amp; Wks.Cells(Rows.Count, \"N\").End(xlUp).Row).Copy\n            Worksheets(\"Master Data\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n        End If\n    Next Wks\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11267877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d84bfd17be3b5f2845e08e13f48f5c?s=128&d=identicon&r=PG&f=1", "display_name": "George K ", "link": "https://stackoverflow.com/users/11267877/george-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553757959, "creation_date": 1553707919, "last_edit_date": 1553757270, "question_id": 55383331, "link": "https://stackoverflow.com/questions/55383331/paste-as-values", "title": "Paste as Values", "body": "<p>I really need help pasting the following data set as values. </p>\n\n<p>I am currently wanting to loop through certain Worksheets in my Workbook and copy and paste data from the ones selected. </p>\n\n<p>However, I am unsure as to how to paste the data I am coping as values. </p>\n\n<p>I have written the following code to loop through the worksheets I want and also select the date I want from each worksheet. However, when i paste this data into the Master Data tab, I cannot seem to paste as values. </p>\n\n<pre><code>    Sub exa()\nDim wks As Worksheet\n\nFor Each wks In ThisWorkbook.Worksheets\nIf Not wks.Name = \"Master Data\" _\nAnd Not wks.Name = \"Query ---&gt;\" _\nAnd Not wks.Name = \"Pivot Portfolio Movement\" _\nAnd Not wks.Name = \"PortfolioMovement - All\" _\nAnd Not wks.Name = \"Bank Holidays\" _\nAnd Not wks.Name = \"Property\" _\nAnd Not wks.Name = \"Postcodes\" _\nAnd Not wks.Name = \"Product\" _\nAnd Not wks.Name = \"PartRedemption\" _\nAnd Not wks.Name = \"Wrap\" _\nAnd Not wks.Name = \"Completions Database\" _\nAnd Not wks.Name = \"Default\" _\nAnd Not wks.Name = \"ReturningBorrower\" _\nAnd Not wks.Name = \"Extensions\" _\nAnd Not wks.Name = \"PortfolioMovement\" _\nAnd Not wks.Name = \"Drawdowns\" _\nAnd Not wks.Name = \"Dev Interest WIP\" _\nAnd Not wks.Name = \"Write Off Loans\" _\nAnd Not wks.Name = \"Interest Rate\" _\nAnd Not wks.Name = \"Admin\" _\nAnd Not wks.Name = \"Datatape ---&gt;\" _\nAnd Not wks.Name = \"Data\" _\nAnd Not wks.Name = \"Drawn Balance by Loan\" _\nAnd Not wks.Name = \"Sheet1\" Then\nwks.Range(\"H2:N2\" &amp; wks.Cells(Rows.Count, \"N\").End(xlUp).Row).Copy _\nDestination:=Worksheets(\"Master Data\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553709282, "post_id": 55383122, "comment_id": 97489209, "body": "<code>DisplayFormat</code> doesn&#39;t seem to expose the applied NumberFormat, only the &quot;base&quot; format.  <code>FormatConditions(1).NumberFormat</code> would give you the appropriate format, but you&#39;d need to apply some logic to figure out if the CF rule had been met."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553709449, "post_id": 55383122, "comment_id": 97489308, "body": "Here&#39;s some &quot;old school&quot; (pre-DisplayFormat) code which may help:   <a href=\"http://www.xldynamic.com/source/xld.CFConditions.html\" rel=\"nofollow noreferrer\">xldynamic.com/source/xld.CFConditions.html</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553710324, "post_id": 55383122, "comment_id": 97489774, "body": "You&#39;ll probably want to run <code>Worksheet.Evaluate</code> with the format condition expressions in order to determine whether the format is being applied or not."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553710328, "post_id": 55383122, "comment_id": 97489778, "body": "In some round-about look, i found: <a href=\"https://stackoverflow.com/questions/18548156/how-to-copy-the-conditional-formatting-without-copying-the-rules-from-a-conditio\" title=\"how to copy the conditional formatting without copying the rules from a conditio\">stackoverflow.com/questions/18548156/&hellip;</a> ... appears to work!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553710354, "post_id": 55383122, "comment_id": 97489790, "body": "...Or yeah, copy-paste :)"}, {"owner": {"reputation": 1, "user_id": 11267787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xIvapZjMc10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTEsv-C_W0Ke3qh7Yzl1vAffX7dw/mo/photo.jpg?sz=128", "display_name": "Robert Dunn", "link": "https://stackoverflow.com/users/11267787/robert-dunn"}, "edited": false, "score": 0, "creation_date": 1553763159, "post_id": 55383122, "comment_id": 97507372, "body": "Thanks for the help, but copy and paste won&#39;t work (see edit in bold).  I&#39;ll see if I can write a something that evaluates whether the conditional formatting rule is true and if so then apply the formatting, but this may take a while."}, {"owner": {"reputation": 1, "user_id": 11267787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xIvapZjMc10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTEsv-C_W0Ke3qh7Yzl1vAffX7dw/mo/photo.jpg?sz=128", "display_name": "Robert Dunn", "link": "https://stackoverflow.com/users/11267787/robert-dunn"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553849830, "post_id": 55383122, "comment_id": 97546470, "body": "@MathieuGuindon - Solution added - can you unmark this as a duplicate please in case any one else would find it useful."}], "owner": {"reputation": 1, "user_id": 11267787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xIvapZjMc10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTEsv-C_W0Ke3qh7Yzl1vAffX7dw/mo/photo.jpg?sz=128", "display_name": "Robert Dunn", "link": "https://stackoverflow.com/users/11267787/robert-dunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "closed_date": 1553710381, "answer_count": 0, "score": 0, "last_activity_date": 1580415219, "creation_date": 1553707258, "last_edit_date": 1580415219, "question_id": 55383122, "link": "https://stackoverflow.com/questions/55383122/vba-flatten-conditional-formatting", "closed_reason": "Duplicate", "title": "VBA - Flatten conditional formatting", "body": "<p>I've got a worksheet which has various conditional formatting applied to it. I'm trying to copy the worksheet in its exact format to a new worksheet, but make all the conditional formatting permanent - I've worked it out for styling, but how do I do it for the format of the cell?</p>\n\n<p>To summarise my main issue:</p>\n\n<p>In my spreadsheet, a row has either 'cost' or 'hours' in a previous column. \n If 'cost' is selected, the relevant currency symbol ($, \u00a3, etc.) is added to the conditionally formatted cell.</p>\n\n<p>When flattened, this is returning to a numerical value (like it's hours counterparts).</p>\n\n<p>I've tried various things, which either through errors or doesn't apply.  I've copied all my code below with two examples of what I thought would work but doesn't.</p>\n\n<p>Alternatively, if there is a simpler method that achieves this and keeps all of the styling in place, even better!</p>\n\n<pre><code>Sub Flatten_Formatting()\n    Dim r\n    For Each r In Selection\n        r.Interior.PatternColor = r.DisplayFormat.Interior.PatternColor\n        r.Interior.Pattern = r.DisplayFormat.Interior.Pattern\n        r.Interior.Color = r.DisplayFormat.Interior.Color\n        r.Borders.Color = r.DisplayFormat.Borders.Color\n        r.Font.Color = r.DisplayFormat.Font.Color\n        r.Font.FontStyle = r.DisplayFormat.Font.FontStyle\n\n'I'd expect either this to work...\n        r.FormatCondition.NumberFormat = r.DisplayFormat.FormatCondition.NumberFormat\n\n'Or this to work...\n        r.CellFormat.NumberFormat = r.DisplayFormat.CellFormat.NumberFormat\n\n    Next r\n    Selection.FormatConditions.Delete\nEnd Sub\n</code></pre>\n\n<p>Expected outcome:</p>\n\n<p>All cell styling remains as is.</p>\n\n<p>If a cell is a number, stays as a number.</p>\n\n<p>If a cell is currency, it stays as currency (including relevant symbol).</p>\n\n<p><strong>Additionally, I can't use the copy &amp; paste into Word method as that breaks border formatting + removes my formulas.  Additionally CTRL+C then ALT > E > S > U will only copy values, not formatting.</strong></p>\n\n<p><strong><em>SOLUTION</em></strong>\nIn the end, I had to add my conditional formatting rules to my VBA which solved the issue.  Example below:</p>\n\n<pre><code>Sub Flatten_Formatting()\n\n    MsgBox \"Flattening formatting\" 'added message box as it can take a while depending on the selected range\n\n    Dim r\n\n    For Each r In Selection\n\n    r.Interior.PatternColor = r.DisplayFormat.Interior.PatternColor\n    r.Interior.Pattern = r.DisplayFormat.Interior.Pattern\n    r.Interior.Color = r.DisplayFormat.Interior.Color\n    r.Borders.Color = r.DisplayFormat.Borders.Color\n    r.Font.Color = r.DisplayFormat.Font.Color\n    r.Font.FontStyle = r.DisplayFormat.Font.FontStyle\n\n    If Range(\"Summary!J2\") = \"\u00a3\" Then 'My currency selection is on a sheet called 'Summary' in cell J2\n    r.NumberFormat = \"$#,##0\" 'This shows \u00a3 as this is my default currency\n\n    ElseIf Range(\"Summary!J2\") = \"$\" Then\n    r.NumberFormat = \"[$$-en-US]#,##0\"\n\n    ElseIf Range(\"Summary!J2\") = \"\u20ac\" Then\n    r.NumberFormat = \"#,##0 [$\u20ac-x-euro1]\"\n\n    End If\n\n    Next r\n\n    Selection.FormatConditions.Delete\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "edited": false, "score": 0, "creation_date": 1553707501, "post_id": 55383041, "comment_id": 97488233, "body": "Corrected that, but I still get the compile error of &#39;method or data member not found&#39; and it points at lstyoga.rowsource and .additem as the culprits for the errors."}, {"owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "edited": false, "score": 0, "creation_date": 1553708090, "post_id": 55383041, "comment_id": 97488559, "body": "try this lstYoga.RowSourceType = &quot;Value List&quot;"}, {"owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "edited": false, "score": 0, "creation_date": 1553708259, "post_id": 55383041, "comment_id": 97488658, "body": "you can also change the RowSourceType from the editor, i&#39;ve tested your code and it works after fixing the increment."}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553709064, "post_id": 55383041, "comment_id": 97489106, "body": "@HansUp There&#39;s an explicitly named listbox, but explicit option isn&#39;t in"}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "edited": false, "score": 0, "creation_date": 1553709140, "post_id": 55383041, "comment_id": 97489143, "body": "@JasonK. Did you change anything else other than the increment?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553711604, "post_id": 55383041, "comment_id": 97490462, "body": "Add <code>Option Explicit</code> and run Debug-&gt;Compile from the VB editor&#39;s main menu.  If <code>lstYoga.RowSource</code> is in a standard module, Access will highlight <code>lstYoga</code> and complain <i>&quot;Variable not defined&quot;</i> because it doesn&#39;t know that is a listbox.  In that case, copy your code to the form&#39;s module and test it there."}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553715237, "post_id": 55383041, "comment_id": 97492154, "body": "@HansUp I\u2019ll try that when I get out of class"}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "edited": false, "score": 0, "creation_date": 1553741618, "post_id": 55383041, "comment_id": 97500435, "body": "9 hours later It&#39;s still broken. I&#39;ve completely re-wrote it and it&#39;s still coming up with the same error on the same lines and it won&#39;t display output. I have no idea."}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553741913, "post_id": 55383041, "comment_id": 97500485, "body": "@HansUp Alright, there&#39;s something going on here with my access and it&#39;s current config. I just went back to some old homework databases and they work perfectly. If i rebuild them on a new database, I&#39;m getting the same return, that the error is on the lst.additems and .rowsources. Any Ideas? My code works perfectly on an old database i&#39;ve saved, just tried it."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553797307, "post_id": 55383041, "comment_id": 97529380, "body": "If the code works perfectly in that old database, why not just use that one and call this &quot;problem solved&quot;?"}, {"owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553802557, "post_id": 55383041, "comment_id": 97532167, "body": "@HansUp I like your thinking, just wish I knew why it won&#39;t work in a NEW database. lol. Oh well, Problem solved."}, {"owner": {"reputation": 4728, "user_id": 1288408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r09bq.jpg?s=128&g=1", "display_name": "Modus Tollens", "link": "https://stackoverflow.com/users/1288408/modus-tollens"}, "edited": false, "score": 0, "creation_date": 1553966446, "post_id": 55383041, "comment_id": 97585239, "body": "@JasonK. OP can&#39;t upvote until they have at least 15 reputation."}], "tags": [], "owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1553706984, "creation_date": 1553706984, "answer_id": 55383041, "question_id": 55382949, "link": "https://stackoverflow.com/questions/55382949/how-to-output-info-to-a-listbox/55383041#55383041", "title": "How to output info to a listbox?", "body": "<p>In the last do-loop you do not increment index, </p>\n"}], "owner": {"reputation": 11, "user_id": 11267775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3ad95636a8127a606f5e4f8543f702?s=128&d=identicon&r=PG&f=1", "display_name": "SirMilkyMilk", "link": "https://stackoverflow.com/users/11267775/sirmilkymilk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612398854, "creation_date": 1553706659, "last_edit_date": 1612398854, "question_id": 55382949, "link": "https://stackoverflow.com/questions/55382949/how-to-output-info-to-a-listbox", "title": "How to output info to a listbox?", "body": "<p>This code gives me</p>\n<blockquote>\n<p>&quot;data member not found&quot;</p>\n</blockquote>\n<p>when trying to output my info to a listbox.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim ClassYoga(5) As Integer\n    Dim NumOfAttend As Integer\n    Dim index As Integer\n\n    'initialize array\n    index = 0\n    Do Until index &gt; 4\n        ClassYoga(index) = 0\n        index = index + 1\n    Loop\n\n    'first input from user\n\n    NumOfAttend = InputBox(&quot;How many people will be attending class? (555 to quit&quot;)\n    \n    Do Until NumOfAttend = 555\n        ClassYoga(NumOfAttend - 1) = ClassYoga(NumOfAttend - 1) + 1\n        \n        NumOfAttend = InputBox(&quot;How many people will be attending class? (555 to quit&quot;)\n    Loop\n    \n    'display\n\n    index = 0\n    \n    lstYoga.RowSource = vbNullString\n    \n    Do Until index &gt; 4\n        lstYoga.AddItem ((index + 1) &amp; &quot;Attendants :&quot; * ClassYoga(index))\n    Loop\n</code></pre>\n<p>It returns errors on the <code>.rowsource</code> and <code>.additem</code> functions.</p>\n<p>How can I output my results?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553707493, "post_id": 55383072, "comment_id": 97488228, "body": "Side note, you could also find the last column in the row (lc in my code) and use that to insert a number of rows."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1553707832, "last_edit_date": 1553707832, "creation_date": 1553707079, "answer_id": 55383072, "question_id": 55382807, "link": "https://stackoverflow.com/questions/55382807/excel-vba-transpose-and-insert-rows-confused/55383072#55383072", "title": "Excel VBA Transpose and insert rows, confused", "body": "<p>My big assumption is that you can do this as a second sheet, not touching your initial data, and negating the need for inserting rows.... something like:</p>\n\n<pre><code>dim sws as worksheet, dws as worksheet, i as long, j as long, k as long, slr as long, dlr as long, lc as long\nset sws = sheets(\"source\")\nset dws = sheets(\"desination\")\nwith sws\n    slr = .cells(.rows.count,2).end(xlup).row\n    for i = 1 to slr \n        lc = .cells(i,.columns.count).end(xltoleft).column\n        j = 3\n        dlr = dws.cells(dws.rows.count,2).end(xlup).row+1\n        dwb.cells(j,1)\n        do until j = lc\n            dwb.cells(dlr,2).value = .cells(i,2).value\n            dwb.cells(dlr,3).value = .cells(i,j).value\n            j = j+1\n            dlr = dlr+1\n        loop\n    next i\nend with\n</code></pre>\n\n<hr>\n\n<p>General thing I'm doing is nesting a loop to create a new table on sheets(\"destination\") based on the data in sheets(\"source\"), where you are looping doing value=value for the number of columns (after finding the last column on the source sheet), whcih is the do-until loop.  Once you've accounted for all of the columns (becoming rows on the second sheet), you move to the next row on the source sheet.</p>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Albeit not tested, looked back and did not account for destination last row (dlr) and added that into the code.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11267714, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-osneqMIuruI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOBwzNjTmwu_ko4z4i3d-TGm_7Xw/mo/photo.jpg?sz=128", "display_name": "Mike Norry", "link": "https://stackoverflow.com/users/11267714/mike-norry"}, "edited": false, "score": 0, "creation_date": 1553707980, "post_id": 55383085, "comment_id": 97488492, "body": "I see what you did, the thing is my data has over 100 columns, when I select what to transpose, I am selecting just the columns I want to be transposed. But when i do that it doesn&#39;t take in consideration any of the data left of the selection.   With your code, i ended up with 3 columns which the 1st column had the spacing that I want on all the data to the left of my selection.   I like my final output to have 2 columns. 1 that has the telephone 2 that has the numbers  While the data is inserted taking in consideration the rest of the data to the left of my selection."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 11267714, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-osneqMIuruI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOBwzNjTmwu_ko4z4i3d-TGm_7Xw/mo/photo.jpg?sz=128", "display_name": "Mike Norry", "link": "https://stackoverflow.com/users/11267714/mike-norry"}, "edited": false, "score": 0, "creation_date": 1553717656, "post_id": 55383085, "comment_id": 97493317, "body": "OK I assumed you selected the whole range. Allowing for that as far as I can see this produces the output you specified above."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1553707115, "creation_date": 1553707115, "answer_id": 55383085, "question_id": 55382807, "link": "https://stackoverflow.com/questions/55382807/excel-vba-transpose-and-insert-rows-confused/55383085#55383085", "title": "Excel VBA Transpose and insert rows, confused", "body": "<p>Adapting your code - see added comments.</p>\n\n<pre><code>Sub TransposeInsertRows()\n\n    Dim rData As Range\n    Dim aData As Variant\n    Dim aResults() As Variant\n    Dim iyData As Long, ixData As Long\n    Dim iyResult As Long\n\n    On Error Resume Next\n    Set rData = Application.InputBox(Prompt:=\"Range Selection...\", _\n                                     Title:=\"Transpose\", _\n                                     Default:=Selection.Address, _\n                                     Type:=8)\n    On Error GoTo 0\n    If rData Is Nothing Then Exit Sub   'Pressed cancel\n\n    If rData.Cells.Count = 1 Then\n        MsgBox \"Only one cell selected, not enough data to transpose and insert.  Exiting Macro.\"\n        Exit Sub\n    End If\n\n    aData = rData.Value\n    ReDim aResults(1 To rData.Rows.Count * rData.Columns.Count, 1 To 3) 'need 3 columns, not 2\n    iyResult = 1\n\n    For iyData = 1 To UBound(aData, 1)\n        aResults(iyResult, 1) = aData(iyData, 1)      'xyz123 etc moe outside loop so doesn't repeat every row\n        For ixData = 3 To UBound(aData, 2)                    'start at 3, as 2 is telephone etc\n            If Len(Trim(aData(iyData, ixData))) &gt; 0 Then\n                aResults(iyResult, 2) = aData(iyData, 2)      'telephone etc\n                aResults(iyResult, 3) = aData(iyData, ixData) 'numbers\n                iyResult = iyResult + 1\n            End If\n        Next ixData\n    Next iyData\n\n    If iyResult = 0 Then\n        MsgBox \"No data found to transpose in selected range [\" &amp; rData.Address &amp; \"]\"\n        Exit Sub\n    End If\n\n    rData.Clear\n    If rData.Rows.Count &lt; iyResult Then\n        rData.Offset(1).Resize(iyResult - rData.Rows.Count - 1).EntireRow.Insert\n    End If\n    rData.Resize(iyResult, UBound(aResults, 2)).Value = aResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11267714, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-osneqMIuruI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOBwzNjTmwu_ko4z4i3d-TGm_7Xw/mo/photo.jpg?sz=128", "display_name": "Mike Norry", "link": "https://stackoverflow.com/users/11267714/mike-norry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553707832, "creation_date": 1553706207, "question_id": 55382807, "link": "https://stackoverflow.com/questions/55382807/excel-vba-transpose-and-insert-rows-confused", "title": "Excel VBA Transpose and insert rows, confused", "body": "<p>I am using the following code below to transpose and insert rows for a dataset. </p>\n\n<p>Its doing mostly what i want but it inserts the rows continuously without regard to the data that is to the left of the columns.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub TransposeInsertRows()\r\n\r\n    Dim rData As Range\r\n    Dim aData As Variant\r\n    Dim aResults() As Variant\r\n    Dim iyData As Long, ixData As Long\r\n    Dim iyResult As Long\r\n\r\n    On Error Resume Next\r\n    Set rData = Application.InputBox(Prompt:=\"Range Selection...\", _\r\n                                     Title:=\"Transpose\", _\r\n                                     Default:=Selection.Address, _\r\n                                     Type:=8)\r\n    On Error GoTo 0\r\n    If rData Is Nothing Then Exit Sub   'Pressed cancel\r\n\r\n    If rData.Cells.Count = 1 Then\r\n        MsgBox \"Only one cell selected, not enough data to transpose and insert.  Exiting Macro.\"\r\n        Exit Sub\r\n    End If\r\n\r\n    aData = rData.Value\r\n    ReDim aResults(1 To rData.Rows.Count * rData.Columns.Count, 1 To 2)\r\n\r\n    For iyData = 1 To UBound(aData, 1)\r\n        For ixData = 2 To UBound(aData, 2)\r\n            If Len(Trim(aData(iyData, ixData))) &gt; 0 Then\r\n                iyResult = iyResult + 1\r\n                aResults(iyResult, 1) = aData(iyData, 1)\r\n                aResults(iyResult, 2) = aData(iyData, ixData)\r\n            End If\r\n        Next ixData\r\n    Next iyData\r\n\r\n    If iyResult = 0 Then\r\n        MsgBox \"No data found to transpose in selected range [\" &amp; rData.Address &amp; \"]\"\r\n        Exit Sub\r\n    End If\r\n\r\n    rData.Clear\r\n    If rData.Rows.Count &lt; iyResult Then\r\n        rData.Offset(1).Resize(iyResult - rData.Rows.Count - 1).EntireRow.Insert\r\n    End If\r\n    rData.Resize(iyResult, UBound(aResults, 2)).Value = aResults\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My excel data looks like the following</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Other Data | Data to transpose | Data to transpose |...\r\n----------------------------------------------------------------------------------\r\nxyz123     |     telephone     |     123           | 312 | 123 | 334|\r\noij        |    faxmachine     |   129             |  22 |  3  | \r\nlowks      |    fridge         |     32            |   1 |  55 |  928|  239|</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I want it to look like</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>   Other Data | Data to transpose | Data to transpose |...\r\n    ----------------------------------------------------------------------------------\r\n    xyz123     |    telephone     |     123  |\r\n               |    telephone      |      312 |  \r\n               |    telephone     |      123 |\r\n               |    telephone      |     334  |\r\n    oij        |    faxmachine     |   129  |      \r\n               |    faxmachine     |    22  |\r\n               |    faxmachine     |    3   |\r\n    lowks      |    fridge         |     32 |     \r\n               |    fridge         |     1  |\r\n               |    fridge         |     55  |\r\n               |    fridge         |     928 |\r\n               |    fridge         |     239 |</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Currently what I end up with is the following:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code> ...Other Data | Data to transpose | Data to transpose |...\r\n        ----------------------------------------------------------------------------------\r\n        xyz123     |    telephone     |     123  |\r\n                   |    telepone      |      312 |  \r\n                   |    telephone     |      123 |\r\n                   |    telehone      |     334  |\r\n                   |    faxmachine     |   129  |      \r\n                   |    faxmachine     |    22  |\r\n                   |    faxmachine     |    3   |\r\n                   |    fridge         |     32 |     \r\n                   |    fridge         |     1  |\r\n                   |    fridge         |     55  |\r\n                   |    fridge         |     928 |\r\n                   |    fridge         |     239 |\r\n        oij        |\r\n        lowks      |</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Your help is much appreciated! </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553721967, "post_id": 55382744, "comment_id": 97495349, "body": "You can&#39;t use for each in this case, you have to iterate by an index and also count down.  The reason for this is that the indexing changes when you delete a row.  e.g. If you delete row 1 then row 2 becomes row 1.  How is the control variable supposed to know if you have deleted rows ?  If you count down then deleting row 5 doesn&#39;t change the numbering of row 4 etc."}, {"owner": {"reputation": 13, "user_id": 11267667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VQzQcCIkn8U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYRmPhO_pKQ79lWEOgh8fiyHbnyg/mo/photo.jpg?sz=128", "display_name": "Greg Mousseau", "link": "https://stackoverflow.com/users/11267667/greg-mousseau"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553784204, "post_id": 55382744, "comment_id": 97521325, "body": "This helped, thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1553784740, "creation_date": 1553784740, "answer_id": 55400606, "question_id": 55382744, "link": "https://stackoverflow.com/questions/55382744/how-to-delete-all-rows-with-a-specific-shading-backgroundpatterncolor-from-a-se/55400606#55400606", "title": "How to delete all rows with a specific Shading.BackgroundPatternColor (from a selected table)", "body": "<p>Problems occur when elements of a collection are deleted during a loop. The deletion removes the item from the collection, which throws the internal counting off.</p>\n\n<p>There are two basic ways to work around this. </p>\n\n<p>1) Work through the items from back to front. Since that which is being removed from the collection was at the end it doesn't throw the count off:</p>\n\n<pre><code>Sub DeleteRowWithShading()\n    Dim oRow As Word.Row\n    Dim tbl As Word.Table\n    Dim nrRows As Long, rowCounter As Long\n    Dim check As Long\n\n    Set tbl = Selection.Tables(1)\n    nrRows = tbl.Rows.Count\n\n  For rowCounter = nrRows To 1 Step -1\n        Set oRow = tbl.Rows(rowCounter)\n        If oRow.Shading.BackgroundPatternColor = -721354855 Then\n            check = check + 1\n            oRow.Delete\n        End If\n  Next\n  Debug.Print \"Nr of rows deleted: \" &amp; check\n\nEnd Sub\n</code></pre>\n\n<p>2) Add the items to an array or custom collection during the first loop, then loop the array/collection to remove all the items (rows). </p>\n\n<pre><code>Sub DeleteRowWithShadingInArray()\n    Dim oRow As Word.Row\n    Dim tbl As Word.Table\n    Dim RowsToDelete() As Variant\n    Dim check As Long, itemNr As Long\n\n    Set tbl = Selection.Tables(1)\n    itemNr = 0\n    For Each oRow In tbl.Rows\n        ReDim Preserve RowsToDelete(itemNr)\n        If oRow.Shading.BackgroundPatternColor = -721354855 Then\n            Set RowsToDelete(itemNr) = oRow\n            itemNr = itemNr + 1\n        End If\n    Next\n\n    itemNr = 0\n\n    For itemNr = 0 To UBound(RowsToDelete)\n            check = check + 1\n            RowsToDelete(itemNr).Delete\n    Next\n\n    Debug.Print \"Nr of rows deleted: \" &amp; check\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11267667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VQzQcCIkn8U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYRmPhO_pKQ79lWEOgh8fiyHbnyg/mo/photo.jpg?sz=128", "display_name": "Greg Mousseau", "link": "https://stackoverflow.com/users/11267667/greg-mousseau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55400606, "answer_count": 1, "score": 1, "last_activity_date": 1553784740, "creation_date": 1553705988, "last_edit_date": 1553784702, "question_id": 55382744, "link": "https://stackoverflow.com/questions/55382744/how-to-delete-all-rows-with-a-specific-shading-backgroundpatterncolor-from-a-se", "title": "How to delete all rows with a specific Shading.BackgroundPatternColor (from a selected table)", "body": "<p>I want to associate a shortcut key to a VBA macro that I can use on some tables of my Word document.\nThis macro should go through all rows of the selected table and remove those with a specific Shading.BackgroundPatternColor</p>\n\n<p>I've tried the following code :</p>\n\n<pre><code>Sub DeleteRowWithShading()\n\n\nDim oRow As Word.Row\n\n  For Each oRow In Selection.Rows\n        If oRow.Shading.BackgroundPatternColor = -721354855 Then\n            oRow.Delete\n        End If\n  Next oRow\n\nEnd Sub\n</code></pre>\n\n<p>The loop through all rows of the table is correct but rows aren't deleted as expected.</p>\n\n<p>I'm rather new to VBA so any help appreciated !</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553706243, "post_id": 55382738, "comment_id": 97487571, "body": "Yes, you can format a pre-determined string within a string using Characters()"}, {"owner": {"reputation": 13, "user_id": 7808765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670735962942606/picture?type=large", "display_name": "William Finnerty", "link": "https://stackoverflow.com/users/7808765/william-finnerty"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553707119, "post_id": 55382738, "comment_id": 97488055, "body": "I watched a few videos on that function and i don&#39;t think its what i&#39;m looking for.                            ListView2.ListItems(itmx.Index).Selected = True         ListView2.SetFocus                                                                                                             I think it should be another line under this saying something like display focus."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553707411, "post_id": 55382738, "comment_id": 97488191, "body": "You can try:  <a href=\"http://vbcity.com/forums/t/89921.aspx\" rel=\"nofollow noreferrer\">vbcity.com/forums/t/89921.aspx</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553708386, "post_id": 55382738, "comment_id": 97488734, "body": "...or just <code>ListView2.ListItems(itmx.Index).EnsureVisible</code>"}], "owner": {"reputation": 13, "user_id": 7808765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670735962942606/picture?type=large", "display_name": "William Finnerty", "link": "https://stackoverflow.com/users/7808765/william-finnerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553709464, "creation_date": 1553705983, "last_edit_date": 1553709464, "question_id": 55382738, "link": "https://stackoverflow.com/questions/55382738/is-there-a-function-that-can-make-a-line-in-a-textbox-be-highlighted-and-display", "title": "Is there a function that can make a line in a textbox be highlighted and displayed when i click on a button?", "body": "<p><img src=\"https://i.stack.imgur.com/Z8GL3.png\" alt=\"enter image description here\">\nWhen i search for something it will be highlighted in the listbox. I want it to scroll down automatically and display the highlighted information on the screen when the find button is clicked.</p>\n\n<pre><code>myindex = 0\n\nSet itmx = ListView2.FindItem(Trim(TextBox_Reason.Text), lvwText, lvwPartial)\n    If itmx Is Nothing Then\n        If TextBox_Reason.Text = \"\" Then\n            MsgBox \"Please enter a Reason\", vbCritical\n            Exit Sub\n        Else\n        result = MsgBox(\"Reason not found !, Add new Reason \", vbYesNo, \"Reason Status\")\n        If result = vbYes Then\n            CommandButton_Add_Click\n        End If\n        Exit Sub\n        End If\n    Else\n        ListView2.ListItems(itmx.Index).Selected = True\n        ListView2.SetFocus\n    End If\n\nmyindex = 0\n\n\nSet itmx = ListView2.FindItem(Trim(TextBox_Reason.Text), lvwText, lvwPartial)\n    If itmx Is Nothing Then\n        If TextBox_Reason.Text = \"\" Then\n            MsgBox \"Please enter a Reason\", vbCritical\n            Exit Sub\n        Else\n        result = MsgBox(\"Reason not found !, Add new Reason \", vbYesNo, \"Reason Status\")\n        If result = vbYes Then\n            CommandButton_Add_Click\n        End If\n        Exit Sub\n        End If\n    Else\n        ListView2.ListItems(itmx.Index).Selected = True\n        ListView2.SetFocus\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1553704212, "post_id": 55382008, "comment_id": 97486436, "body": "It might be a good idea to provide a sample image, so people can see what you&#39;re talking about"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553707607, "post_id": 55382008, "comment_id": 97488286, "body": "a picture in a chart does not fill it completely, so you see the <code>ChartArea</code> color around the outside of the picture, the color is white. If you want it to be black you can place this line <code>.ChartArea.Format.Fill.ForeColor.RGB = RGB(0, 0, 0)</code> directly under <code>With oChrtO.Chart</code>. Or you can use <code>.ChartArea.Format.Fill.Visible = msoFalse</code> to  make the <code>ChartArea</code> transparent."}], "owner": {"reputation": 123, "user_id": 10069020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-shmmeufVHKU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oG_Z9Iw-rGMeg-gWXsqZKLx5UteA/mo/photo.jpg?sz=128", "display_name": "Ahmed Chishti", "link": "https://stackoverflow.com/users/10069020/ahmed-chishti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553703662, "creation_date": 1553703662, "question_id": 55382008, "link": "https://stackoverflow.com/questions/55382008/cell-ranges-export-as-images-without-white-border", "title": "Cell ranges export as images, without white border", "body": "<p>I am using vba to export several cell ranges in same work sheet as images. Though task is being done perfectly with the below code but all the images are exported with a white thin border. I've already already inserted the what should remove the border but that does not work. My code is as follows</p>\n\n<pre><code>Dim oWs As Worksheet\nDim oRng As Range\nDim oChrtO As ChartObject\nDim lWidth As Long, lHeight As Long\nSet oWs = Sheets(\"sheet2\")\n\noWs.Select\nSet oRng = oWs.Range(\"g35:i44\")\noRng.CopyPicture xlScreen, xlPicture\nlWidth = oRng.width\nlHeight = oRng.height\nSet oChrtO = oWs.ChartObjects.Add(Left:=0, Top:=0, width:=lWidth, \nheight:=lHeight)\noChrtO.Activate\nWith oChrtO.Chart\n.ChartArea.Format.Line.Visible = msoFalse\n.Paste\n.Export Filename:=\"C:\\Users\\tg033980\\Desktop\\JSS \n project\\img\\MNTH1_A.png\", Filtername:=\"PNG\"\n End With\n oChrtO.Delete`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553704468, "post_id": 55381809, "comment_id": 97486584, "body": "How about you use the standard one <code>&quot;0%;-0%&quot;</code> and set up conditional formatting to easily differentiate between negatives and positive numbers. Just a thought."}, {"owner": {"reputation": 45, "user_id": 9335018, "user_type": "registered", "profile_image": "https://graph.facebook.com/124959438321930/picture?type=large", "display_name": "LE FE", "link": "https://stackoverflow.com/users/9335018/le-fe"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553711434, "post_id": 55381809, "comment_id": 97490372, "body": "thanks, there actually is conditional formatting as well (red v blue) but I prefer to have the &quot;+&quot; symbol there for added emphasis, and to set it apart from other &quot;percent of total&quot; columns"}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 9335018, "user_type": "registered", "profile_image": "https://graph.facebook.com/124959438321930/picture?type=large", "display_name": "LE FE", "link": "https://stackoverflow.com/users/9335018/le-fe"}, "is_accepted": false, "score": 0, "last_activity_date": 1553716039, "creation_date": 1553716039, "answer_id": 55385363, "question_id": 55381809, "link": "https://stackoverflow.com/questions/55381809/custom-number-format-being-read-as-a-string-what-am-i-missing/55385363#55385363", "title": "Custom number format being read as a string; what am I missing?", "body": "<p>turns out it wasn't the number formatting, it was the piece of the formula that said if then \"\" that was leaving invisible text strings in my columns</p>\n\n<p>fixed it with this code I found via <a href=\"https://stackoverflow.com/users/2327877/elderdelp\">ElderDelp</a> here, so thanks, Man!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1119614/return-empty-cell-from-formula-in-excel/39351425#39351425\">Return empty cell from formula in Excel</a></p>\n\n<pre><code>For Each myCell In ColPct\n                    ''calculate Prct Chg\n                        myCell.FormulaR1C1 = \"=iferror(IF(OR(rc[-6]&lt;&gt;\"\"\"\",rc[-3]&lt;&gt;\"\"\"\"),(rc[-3]/rc[-6]-1),\"\"\"\"),\"\"N/A\"\")\"\n                        myCell.NumberFormat = \"+0%;-0%\"\n                        If Len(myCell.Text) = 0 Then\n                            myCell.ClearContents\n                        End If\n                Next\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9335018, "user_type": "registered", "profile_image": "https://graph.facebook.com/124959438321930/picture?type=large", "display_name": "LE FE", "link": "https://stackoverflow.com/users/9335018/le-fe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553716039, "creation_date": 1553703013, "question_id": 55381809, "link": "https://stackoverflow.com/questions/55381809/custom-number-format-being-read-as-a-string-what-am-i-missing", "title": "Custom number format being read as a string; what am I missing?", "body": "<p>I have a macro I'm writing to format a daily report; part of which compares a week-over-week percent change.  I prefer to use a \"+0%;-0%\" format as opposed to the standard \"0%;-0%\", but when I apply filters, I am losing the number context, and associated number filters options (ex. \"above average\").</p>\n\n<p>Any ideas?</p>\n\n<p>I tried copy/pasting as values, instead of leaving the formula and while that seemed to fix the first  %  Col range, it did not fix the others (although they are correctly pasted as values)</p>\n\n<pre><code>''''''''                    \n ''Call my FindAll function to find each column with the header \"% chg\"\n ''''''''\n\n    Dim matches As Collection, m\n    Dim mycell As Range, c As Range\n\n    Dim strFindMe As String\n    Dim myCell As Range\n\n\n            strFindMe = \"% Chg\"\n\n\n            Set matches = FindAll(rgHeader, strFindMe)\n            For Each m In matches\n                Dim ColPct As Range\n                    Set c = m.Offset(1, 0)\n                    Set ColPct = Range(c.Address, Cells(RgSummary.Row, _\n                        Range(c.Address).Column))\n\n ''''''''                    \n ''Calculate the wk-wk % chg for each column with header \"% Chg\"        \n ''''''''   \n\n                        For Each myCell In ColPct\n                            ''calculate Prct Chg\n                                myCell.FormulaR1C1 = \"=iferror(IF(AND(rc[-6]&lt;&gt;\"\"\"\",rc[-3]&lt;&gt;\"\"\"\"),(rc[-3]/rc[-6]-1),\"\"\"\"),\"\"N/A\"\")\"\n    '                            myCell.NumberFormat = \"+0%;-0%\"\n                        Next\n\n                        With ColPct\n                            .Copy\n                            .PasteSpecial xlValues\n                            .NumberFormat = \"+0%;-0%\"\n                        End With\n              next m\n</code></pre>\n\n<p>Goal: percent change has format \"+0%;-0%\" and is read by excel filters as a number, not a string</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1553703358, "post_id": 55381729, "comment_id": 97485927, "body": "This question pops up all the time, but in such a way that it is seldom an outright duplicate. Arguably VBA made a poor design decision here, but it is what it is."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1553703619, "last_edit_date": 1553703619, "creation_date": 1553703122, "answer_id": 55381838, "question_id": 55381729, "link": "https://stackoverflow.com/questions/55381729/why-sometimes-the-same-variables-declaration-gives-a-compilation-error/55381838#55381838", "title": "Why sometimes the same variables declaration gives a compilation error?", "body": "<p>In variable declaration, you must specify the type for each variable, otherwise it's a <code>Variant</code>.</p>\n\n<p>In other words, in </p>\n\n<pre><code>Dim numCables, numCaColumn, firstCableRow, numCable, numDiColumn, posInArray, j, numMaterialWDifSEColumn, numSEMaterials  As Integer\n</code></pre>\n\n<p>only <code>numSEMaterials</code> is an <code>Integer</code> and the rest are <code>Variant</code>s.</p>\n\n<p>You need </p>\n\n<pre><code> Dim numCables as Integer, numCaColumn as Integer, firstCableRow as Integer...\n</code></pre>\n\n<p>Note (thanks for the reminder <a href=\"https://stackoverflow.com/users/4996248/john-coleman\">@John Coleman</a>) that it's almost always better to use a <code>Long</code> variable type instead of <code>Integer</code>. For a detailed explanation, see <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why use integer instead of Long</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 1, "last_activity_date": 1553703946, "last_edit_date": 1553703946, "creation_date": 1553703152, "answer_id": 55381845, "question_id": 55381729, "link": "https://stackoverflow.com/questions/55381729/why-sometimes-the-same-variables-declaration-gives-a-compilation-error/55381845#55381845", "title": "Why sometimes the same variables declaration gives a compilation error?", "body": "<p>Vba code like <code>Dim a, b, c as integer</code> does NOT declare a, b and c as integer type! It does only declare c as integer. The variables a and b are declared as variant! </p>\n\n<p>To declare all variables as integer you have to decare each one individually:</p>\n\n<pre><code>Dim a as integer\nDim b as integer\nDim c as integer\n</code></pre>\n\n<p>.</p>\n\n<p><strong>PROOF</strong></p>\n\n<pre><code>Option Explicit\n\nSub Debug_VarType()\n\nDim a, b, c As Integer\n\nDebug.Print \"Definition of a, b and c:\"\nDebug.Print \"a: \"; VarType(a); MyVarType(VarType(a))\nDebug.Print \"b: \"; VarType(b); MyVarType(VarType(b))\nDebug.Print \"c: \"; VarType(c); MyVarType(VarType(c))\nDebug.Print \"\"\n\nDim d As Integer\nDim e As Integer\nDim f As Integer\n\nDebug.Print \"Definition of d, e and f:\"\nDebug.Print \"d: \"; VarType(d); MyVarType(VarType(d))\nDebug.Print \"e: \"; VarType(e); MyVarType(VarType(e))\nDebug.Print \"f: \"; VarType(f); MyVarType(VarType(f))\nDebug.Print \"\"\n\nEnd Sub\n\n\nFunction MyVarType(Varint As Integer) As String\nSelect Case Varint\n    Case 0: MyVarType = \"vbEmpty\"\n    Case 1: MyVarType = \"vbNull\"\n    Case 2: MyVarType = \"vbInteger\"\n    Case 3: MyVarType = \"vbLong\"\n    Case 4: MyVarType = \"vbSingle\"\n    Case 5: MyVarType = \"vbDouble\"\n    Case 6: MyVarType = \"vbCurrency\"\n    Case 7: MyVarType = \"vbDate\"\n    Case 8: MyVarType = \"vbString\"\n    Case 9: MyVarType = \"vbObject\"\n    Case 10: MyVarType = \"vbError\"\n    Case 11: MyVarType = \"vbBoolean\"\n    Case 12: MyVarType = \"vbVariant\"\n    Case 13: MyVarType = \"vbDataObject\"\n    Case 14: MyVarType = \"vbDecimal\"\n    Case 17: MyVarType = \"vbByte\"\n    Case 20: MyVarType = \"vbLongLong\"\n    Case 36: MyVarType = \"vbUserDefinedType\"\n    Case 8192: MyVarType = \"vbArray\"\nEnd Select\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fYljx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fYljx.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 10608775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b18a762ba05e7a6b957a9ca29d237602?s=128&d=identicon&r=PG&f=1", "display_name": "Mandragor", "link": "https://stackoverflow.com/users/10608775/mandragor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55381838, "answer_count": 2, "score": 0, "last_activity_date": 1553703946, "creation_date": 1553702779, "last_edit_date": 1553703045, "question_id": 55381729, "link": "https://stackoverflow.com/questions/55381729/why-sometimes-the-same-variables-declaration-gives-a-compilation-error", "title": "Why sometimes the same variables declaration gives a compilation error?", "body": "<p>When there is a variable type mismatch compilation error in VBA sometimes the solution is to change how I declare the variables, but not the type.\ne.g.: \nIf I have:</p>\n\n<pre><code>Dim numCables, numCaColumn, firstCableRow, numCable, numDiColumn, posInArray, j, numMaterialWDifSEColumn, numSEMaterials  As Integer\n</code></pre>\n\n<p>And I replace it for:</p>\n\n<pre><code>Dim numCables, numCaColumn, firstCableRow, numCable, numDiColumn, posInArray, j, numMaterialWDifSEColumn  As Integer\nDim numSEMaterials As Integer\n</code></pre>\n\n<p>Now with this change I don't have a compilation error and all is working fine.</p>\n\n<p>I would like to know why this is happening.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "file", "criteria"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1553702024, "post_id": 55381425, "comment_id": 97485028, "body": "It would be helpful to know where exactly you are stuck. Can you please <a href=\"https://stackoverflow.com/posts/55381425/edit\">edit your question</a> to include the code you have? A clear explanation of how it, specifically, does not meet expectations would also be useful"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1553702722, "post_id": 55381425, "comment_id": 97485521, "body": "Try: <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2014/4/23/loop-through-all-excel-files-in-a-given-folder\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/the-code-vault/2014/4/23/&hellip;</a>  and use For Each SubFolder In Folder.SubFolders to get in subfolders"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1553705550, "post_id": 55381425, "comment_id": 97487227, "body": "One the one hand you display only &quot;zip&quot; files with your code. On the other hand you state in your comments that you want to open workbook files? It&#39;s unclear what you are trying to achive!"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1553705790, "post_id": 55381425, "comment_id": 97487352, "body": "see <a href=\"https://docs.microsoft.com/de-de/office/vba/language/reference/user-interface-help/file-object\" rel=\"nofollow noreferrer\">docs.microsoft.com/de-de/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1553705865, "post_id": 55381425, "comment_id": 97487388, "body": "add:             Application.ActiveSheet.Cells(rowIndex, 2).Value = xFile.DateLastModified"}], "owner": {"reputation": 1, "user_id": 11267347, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M-CDU6nE1qk/AAAAAAAAAAI/AAAAAAAAAEA/cASfRwhH4kE/photo.jpg?sz=128", "display_name": "Colin Bruce-Alleyne", "link": "https://stackoverflow.com/users/11267347/colin-bruce-alleyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553704108, "creation_date": 1553701920, "last_edit_date": 1553704108, "question_id": 55381425, "link": "https://stackoverflow.com/questions/55381425/macro-to-find-xlsm-workbooks-in-given-folders-sub-folders-based-on-criteria-the", "title": "Macro to find xlsm workbooks in given folders/sub folders based on criteria, then check a value in each workbook", "body": "<p>I'm trying to create a macro that lists all the files in a given folder (and its sub folders) which match criteria for filename (in my example \"<em>job checklist</em>\") and type (in my example \"*.xlsm\").  since all the workbooks of this type and naming convention in my search folder are of the same type, i need to open and read values from each workbook and copy them into my host workbook.  when the macro is run the run date/time should be noted in the host workbook, so that when the macro is run subsequently only new workbooks OR workbooks which have been modified since the most recent time stamp need to be opened and updated in the host workbook.</p>\n\n<p>I have been trying to use some recursive code found in other posts, but threads, but i'm having a hard time to incorporate search criteria:\n- file name\n- file type\n- modified date\n[here] (<a href=\"https://stackoverflow.com/questions/20687810/vba-macro-that-search-for-file-in-multiple-subfolders?newreg=d5bea4c6c336460da1c1ac1d028c20a7\">VBA macro that search for file in multiple subfolders</a>)</p>\n\n<p>I have also tried to encorporate code from Pearson <a href=\"http://www.cpearson.com/excel/docprop.aspx\" rel=\"nofollow noreferrer\">here</a> to allow me to check file attributes of xls files but it doesnt seem to work (maybe due to 64 bit, though i found another version which was supposed to be compatible)</p>\n\n<p>I've been trying to find a solution for several days, but am kinda stuck, any help would be appreciated.</p>\n\n<p>working code i have so far which is listing all the files here of type .zip in my host workbook, i don't know how to check the modified date of a file.  i assume that if i could i could add some code to open files (which meet type, name and modified (compared to a date/time value cell in the host workbook, and updates every time the macro is run) and then extract values from a known sheet/range into the host workbook.</p>\n\n<pre><code>```vba\nSub MainList()\n    Dim folder, xdir As Variant\n    Set folder = Application.FileDialog(msoFileDialogFolderPicker)\n    Call ListFilesInFolder(\"C:\\Users\\60066690\\Desktop\\Documents from BCP and loose MTC\", True)\nEnd Sub\n\nSub ListFilesInFolder(ByVal xFolderName As String, ByVal xIsSubfolders As Boolean)\n    Dim xFileSystemObject As Object\n    Dim xFolder As Object\n    Dim xSubFolder As Object\n    Dim xFile As Object\n    Dim rowIndex As Long\n    Set xFileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\n    Set xFolder = xFileSystemObject.GetFolder(xFolderName)\n    rowIndex = Application.ActiveSheet.Range(\"A65536\").End(xlUp).Row + 1\n    For Each xFile In xFolder.Files\n        If Not InStr(1, xFile.Name, \".zip\") = 0 Then\n'could need to add in here If for name, but not sure how to add If for modified date, if i could i could compare the modified date to a date cell in this workbook\n            Application.ActiveSheet.Cells(rowIndex, 1).Formula = xFile.Name\n'need to add some code in here to open the found workbook, then extract some values from known sheets/cells, store those values in variables, then close the found workbook and output the found variables to the colums beside the file name            \nrowIndex = rowIndex + 1\n        End If\n    Next xFile\n    If xIsSubfolders Then\n        For Each xSubFolder In xFolder.SubFolders\n            ListFilesInFolder xSubFolder.Path, True\n        Next xSubFolder\n    End If\n    Set xFile = Nothing\n    Set xFolder = Nothing\n    Set xFileSystemObject = Nothing\nEnd Sub\n```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1553701515, "post_id": 55381231, "comment_id": 97484684, "body": "Note that <code>On Error Resume Next</code> makes you blind for any errors. Never use it like that. Always use a complete error handling <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1553701588, "post_id": 55381231, "comment_id": 97484735, "body": "Can you please specify in your question what does <i>&quot;renames files in wrong order&quot;</i> exactly mean? Give an example please."}, {"owner": {"reputation": 49, "user_id": 3013203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae558f0470e21dbf19a173f28e1a8f61?s=128&d=identicon&r=PG&f=1", "display_name": "user3013203", "link": "https://stackoverflow.com/users/3013203/user3013203"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553703288, "post_id": 55381231, "comment_id": 97485879, "body": "for example, 1st file is &quot;\u04101.14.12.2016.pdf&quot;, and it should be renamed as &quot;1-\u04101.14.12.2016.pdf&quot;, and after rename I see file &quot;1-\u04101.14.12.2016.doc&quot;, and its another file("}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1553703380, "post_id": 55381231, "comment_id": 97485940, "body": "There&#39;s no guaranteee what order the files are enumerated using Dir() - you will need to check each file&#39;s name to determine what the new name should be.  You can do that by looking up the name in ColB and taking the new name from ColA"}, {"owner": {"reputation": 49, "user_id": 3013203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae558f0470e21dbf19a173f28e1a8f61?s=128&d=identicon&r=PG&f=1", "display_name": "user3013203", "link": "https://stackoverflow.com/users/3013203/user3013203"}, "edited": false, "score": 0, "creation_date": 1553703471, "post_id": 55381231, "comment_id": 97486001, "body": "so, what should I do?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1553703974, "creation_date": 1553703974, "answer_id": 55382111, "question_id": 55381231, "link": "https://stackoverflow.com/questions/55381231/rename-files-in-folder-with-various-extensions-according-to-worksheet-list/55382111#55382111", "title": "Rename files in folder with various extensions according to worksheet list", "body": "<p>Untested, but you can do something like this:</p>\n\n<pre><code>Sub test2()\n\n    Dim x As String\n    Dim fName As String\n    Dim oldPath As String\n    Dim newPath As String\n    Dim i As Long\n    Dim fso As Object, f As Range\n\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n\n    oldPath = \"\\\\Plu20\\dfs01\\USMiKAR\\docs\\\"\n    newPath = oldPath &amp; \"New\\\"\n\n    If Dir(newPath, vbDirectory) = \"\" Then MkDir newPath\n\n    fName = Dir(oldPath &amp; \"*.*\")\n    With ActiveSheet\n        Do While Len(fName) &gt; 0\n            'find the current filename\n            Set f = .Columns(2).Find(fso.getbasename(fName), lookat:=xlWhole)\n            If Not f Is Nothing Then\n                'got a match\n                FileCopy oldPath &amp; fName, _\n                   newPath &amp; f.Offset(0, -1).Value &amp; \".\" &amp; fso.getextensionname(fName)\n                '.Cells(i, 2) = oldPath &amp; fName '\u00ef\u00f0\u00ee\u00e2\u00e5\u00f0\u00ea\u00e0\n                'Kill oldPath &amp; fName '\u00f3\u00e4\u00e0\u00eb\u00e5\u00ed\u00e8\u00e5 \u00f1\u00f2\u00e0\u00f0\u00fb\u00f5\n            Else\n                'no match...\n                Debug.Print \"filename:\" &amp; fName &amp; \" was not matched\"\n            End If\n\n            fName = Dir\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3013203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae558f0470e21dbf19a173f28e1a8f61?s=128&d=identicon&r=PG&f=1", "display_name": "user3013203", "link": "https://stackoverflow.com/users/3013203/user3013203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55382111, "answer_count": 1, "score": 0, "last_activity_date": 1553703974, "creation_date": 1553701371, "last_edit_date": 1553701532, "question_id": 55381231, "link": "https://stackoverflow.com/questions/55381231/rename-files-in-folder-with-various-extensions-according-to-worksheet-list", "title": "Rename files in folder with various extensions according to worksheet list", "body": "<p>I need to rename 300+ files of various extensions in 1 folder. I have a list of file names without extension in column B, and final names in column A of my Excel worksheet. My code works, but renames files in wrong order. Filenames contain dots, like </p>\n\n<blockquote>\n  <p>\u04101.14.12.2016</p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>Option Explicit\nSub test2()\n    Dim x As String\n    Dim fName As String\n    Dim oldPath As String\n    Dim newPath As String\n    Dim i As Long\n\n    oldPath = \"\\\\Plu20\\dfs01\\USMiKAR\\docs\\\"\n    newPath = oldPath &amp; \"New\\\"\n    On Error Resume Next\n    x = GetAttr(newPath) And 0\n    If Err.Number &lt;&gt; 0 Then MkDir newPath\n    fName = Dir(oldPath &amp; \"*.*\")\n    With ActiveSheet\n        Do While Len(fName) &gt; 0\n            i = i + 1\n            FileCopy oldPath &amp; fName, newPath &amp; .Cells(i, 1) &amp; Mid$(fName, InStrRev(fName, \".\"))\n            '.Cells(i, 2) = oldPath &amp; fName '\u00ef\u00f0\u00ee\u00e2\u00e5\u00f0\u00ea\u00e0\n            'Kill oldPath &amp; fName '\u00f3\u00e4\u00e0\u00eb\u00e5\u00ed\u00e8\u00e5 \u00f1\u00f2\u00e0\u00f0\u00fb\u00f5\n            fName = Dir\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553700134, "post_id": 55380625, "comment_id": 97483779, "body": "You need to (1) make sure the checkboxes are not spanning multiple cells (2) set their position to &quot;move but not size with cells&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1553700301, "post_id": 55380625, "comment_id": 97483889, "body": "Since both branches of the conditional are assigning a Boolean value to the same member expression, consider rewriting it as <code>Range(&quot;BK10&quot;).Value = (Range(&quot;H10&quot;).Value &gt;= 0)</code> - also consider qualifying these <code>Range</code> calls with an explicit <code>Worksheet</code> object if that code is written in <code>ThisWorkbook</code> or in a standard module, or with the <code>Me</code> qualifier if that code is written in a <code>Worksheet</code> module. An unqualified <code>Range</code> call made in a standard module, userform, or workbook module, will implicitly refer to whatever the <code>ActiveSheet</code> is."}, {"owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553700662, "post_id": 55380625, "comment_id": 97484146, "body": "@TimWilliams  it wasn&#39;t &quot;move but not size with cells&quot;, i had to place &quot;dont move and dont size with cells&quot;, but thank you so much for solving the issue."}], "owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553699623, "creation_date": 1553699623, "question_id": 55380625, "link": "https://stackoverflow.com/questions/55380625/why-does-this-tick-box-issue-happen", "title": "Why does this tick box issue happen?", "body": "<p>I have tick boxes that are linked to cells so that i can just use code to set them true or false and instantly control the tick boxes. problem is, when i organize a column in any way (in this case, lowest to highest number), the tick boxes get all mixed up (they switch places with each other). this makes it so when i try to tick a certain number,it'll tick a random number that i don't want to tick.</p>\n\n<p>i don't really know what code i should place here, hope this bit helps</p>\n\n<pre><code>If Range(\"h10\").Value &gt;= 0 Then\n   Range(\"bk10\").Value = True\nElse\n   Range(\"bk10\").Value = False\nEnd If\n</code></pre>\n\n<p>(bk10 is supposed to represent specifically the line number 10)</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553701879, "post_id": 55380487, "comment_id": 97484945, "body": "Is the host application Excel or PowerPoint?"}, {"owner": {"reputation": 1, "user_id": 11267101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96872ba7b4292ae343b898bbdba83a11?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Norlin", "link": "https://stackoverflow.com/users/11267101/anton-norlin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1553789486, "post_id": 55380487, "comment_id": 97525116, "body": "The host program is excel. I want to export a report from excel to powerpoint. Thank you in advance!"}], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1554257514, "creation_date": 1554257514, "answer_id": 55486050, "question_id": 55380487, "link": "https://stackoverflow.com/questions/55380487/how-to-solve-run-time-error-2147188160-80048240-shapes-unknown-member/55486050#55486050", "title": "How to solve &quot;Run-time error &#39;-2147188160 (80048240)&#39;: Shapes (unknown member): invalid request. The specified data type i unavailable&quot;", "body": "<p>See if this is the case.</p>\n\n<p>PowerPoint usually needs some time after pasting something onto the slide.</p>\n\n<p>Especially an OLE object like Excel table takes a while.</p>\n\n<p>Try adding following code sniffet.</p>\n\n<pre><code>...\nSelection.Copy\nactiveSlide.Shapes.PasteSpecial(DataType:=ppPasteBitmap)\n\n'Let's give some break time\nDo\n    DoEvents\nLoop Until activeSlide.Shapes.Count &gt; 0  ' use '0' if pasted on a new slide\n\n'Select the last shape pasted\nactiveSlide.Shapes(activeSlide.Shapes.Count).Select\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11267101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96872ba7b4292ae343b898bbdba83a11?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Norlin", "link": "https://stackoverflow.com/users/11267101/anton-norlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 841, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554257514, "creation_date": 1553699231, "last_edit_date": 1553699295, "question_id": 55380487, "link": "https://stackoverflow.com/questions/55380487/how-to-solve-run-time-error-2147188160-80048240-shapes-unknown-member", "title": "How to solve &quot;Run-time error &#39;-2147188160 (80048240)&#39;: Shapes (unknown member): invalid request. The specified data type i unavailable&quot;", "body": "<p>I'm trying to automate a report from Excel to Powerpoint. I get the same error message. Sometimes the script works, some don't. I read something about \"Panes\" in another thread, but I didn't understand what to do with the info. The string causing the error is:</p>\n\n<hr>\n\n<blockquote>\n  <p>activeSlide.Shapes.PasteSpecial(DataType:=ppPasteBitmap).Select</p>\n</blockquote>\n\n<hr>\n\n<p>I'm not very familiar with programming, so please take that in consideration. Thank you!</p>\n\n<p>Right now i just continue the exports, and compensates with manual work for the slides that doesn't work.</p>\n\n<pre><code>    'SLIDE HISTORICALS Germany _____________________________________________________________\n    'Add a new slide where we will paste the chart\n        newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\n        newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n        Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n\n            Sheets(\"Historicals Output\").Activate\n\n    'Copy the chart and paste it into the PowerPoint as a Metafile Picture\n        ActiveWorkbook.Worksheets(\"Historicals Output\").Range(\"A86:S118\").Select\n        Selection.Copy\n</code></pre>\n\n<p>'''activeSlide.Shapes.PasteSpecial(DataType:=ppPasteBitmap).Select'''</p>\n\n<pre><code>    'Set the title of the slide the same as the title of the chart\n       ' activeSlide.Shapes(1).TextFrame.TextRange.Text = cht.Chart.ChartTitle.Text\n\n    'Adjust the positioning of the Chart on Powerpoint Slide\n       ' newPowerPoint.ActiveWindow.Selection.ShapeRange.Left = 15\n       newPowerPoint.ActiveWindow.Selection.ShapeRange.Top = 70\n\n        ' create textbox\n        Sheets(\"Text\").Activate\n        ActiveWorkbook.Worksheets(\"Text\").Range(\"b12:z12\").Select\n        Selection.Copy''' activeSlide.Shapes.PasteSpecial(DataType:=ppPasteBitmap).Select '''\n        newPowerPoint.ActiveWindow.Selection.ShapeRange.Top = 0\n        newPowerPoint.ActiveWindow.Selection.ShapeRange.Left = 0\n</code></pre>\n\n<p>I would be so thankful to make this run smooth.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1553699478, "post_id": 55380446, "comment_id": 97483303, "body": "What do you mean by <i>substrings</i> here?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553699496, "post_id": 55380446, "comment_id": 97483313, "body": "if check_10th = &quot; &quot; then i = i+1... it would be better to use a do until loop for that scenario"}, {"owner": {"reputation": 79, "user_id": 8091097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae2d10bcdc22616335c3899dc17c9db?s=128&d=identicon&r=PG&f=1", "display_name": "attemptingpython", "link": "https://stackoverflow.com/users/8091097/attemptingpython"}, "edited": false, "score": 0, "creation_date": 1553699677, "post_id": 55380446, "comment_id": 97483432, "body": "T.M. By substrings, i mean the &quot;1111&quot; and &quot;2222222&quot;, etc... Thanks"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1553699769, "post_id": 55380446, "comment_id": 97483508, "body": "It&#39;s not clear to me what you mean with substring <code>3333 77777</code>. Did you mean to split these? Or are they somehow connected so they shouldn&#39;t be split? What is the logic behind this?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1553699770, "post_id": 55380446, "comment_id": 97483511, "body": "What is the logic?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1553699995, "post_id": 55380446, "comment_id": 97483674, "body": "What does not make sense is why is <code>3333 77777</code> not split? but <code>44444</code> is split? Why is <code>44444</code> not grouped with <code>55555</code>, but <code>55555</code> is grouped with <code>6666</code>? It&#39;s very hard to see the pattern you are after."}, {"owner": {"reputation": 79, "user_id": 8091097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae2d10bcdc22616335c3899dc17c9db?s=128&d=identicon&r=PG&f=1", "display_name": "attemptingpython", "link": "https://stackoverflow.com/users/8091097/attemptingpython"}, "edited": false, "score": 1, "creation_date": 1553700140, "post_id": 55380446, "comment_id": 97483786, "body": "The 3333 77777 is not split as it is 10 characters, the 44444 combined with the 55555 is 11 characters"}], "answers": [{"comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553705010, "post_id": 55380920, "comment_id": 97486928, "body": "Split is the way to go.  But it is a much more interesting function that demonstrated above.  Split can return a two item array the first item of which is the first substring and the second part is the remainder substring.  Its well worth reading the MS help page on split."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 4, "last_activity_date": 1553700493, "creation_date": 1553700493, "answer_id": 55380920, "question_id": 55380446, "link": "https://stackoverflow.com/questions/55380446/how-to-split-a-string-every-nth-character-on-vba-unless-nth-character/55380920#55380920", "title": "How to split a string every nth character on VBA, unless nth character = &quot; &quot;?", "body": "<p>I think you would be a lot better off here splitting your string into an array and testing from there. </p>\n\n<p>Something like this (totally not optimized, but it works fine):</p>\n\n<pre><code>Sub test()\n    Dim somestring As String\n    Dim word As Variant\n    Dim outline As String\n    Dim outstring As String\n\n    somestring = \"1111 2222222 3333 77777 44444 55555 6666 99999\"\n\n    For Each word In Split(somestring, \" \")\n        If Len(outline &amp; \" \" &amp; word) &lt;= 10 Then\n            outline = Trim(outline &amp; \" \" &amp; word)\n        Else\n            If outstring = \"\" Then outstring = outline Else outstring = outstring &amp; vbCrLf &amp; Trim(outline)\n            outline = word\n        End If\n    Next\n\n    outstring = outstring &amp; vbCrLf &amp; Trim(outline)\n\n    Debug.Print outstring\nEnd Sub\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>1111\n2222222\n3333 77777\n44444\n55555 6666\n99999\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8091097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae2d10bcdc22616335c3899dc17c9db?s=128&d=identicon&r=PG&f=1", "display_name": "attemptingpython", "link": "https://stackoverflow.com/users/8091097/attemptingpython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 55380920, "answer_count": 1, "score": -1, "last_activity_date": 1557935319, "creation_date": 1553699127, "last_edit_date": 1557935319, "question_id": 55380446, "link": "https://stackoverflow.com/questions/55380446/how-to-split-a-string-every-nth-character-on-vba-unless-nth-character", "title": "How to split a string every nth character on VBA, unless nth character = &quot; &quot;?", "body": "<p>I have a string similar to</p>\n\n<pre><code> \"1111 2222222 3333 77777 44444 55555 6666 99999\"\n</code></pre>\n\n<p>Is it possible to split the string after each 10th character, without splitting the sub-strings (by subtrings I mean the \"1111\", \"3333\" etc),</p>\n\n<pre><code>1111\n2222222 \n3333 77777 \n44444 \n55555 6666\n99999\n</code></pre>\n\n<p>I have tried this, but it's not quite right. Thanks</p>\n\n<pre><code>Dim i As Long, n As Long\nDim SplitStr, check_10th, TestStr As String\nDim string_length As Double\n\nTestStr = Cells(1, 1)\nn = 10\n\nFor i = 1 To Len(TestStr) Step n\n    check_10th = Mid(TestStr, n, 1)\n    If check_10th &lt;&gt; \" \" Then\n        For k = 1 To 10 \n            check_10th = Mid(TestStr, n - k, 1)\n        If check_10th = \" \" Then\n            Exit For\n        End If\n\n    Next k\n\n    SplitStr = SplitStr &amp; Mid(TestStr, i, n - k) &amp; vbNewLine\nElse\n    SplitStr = SplitStr &amp; Mid(TestStr, i, n) &amp; vbNewLine\nEnd If\n\nNext i\n\nCells(2, 1).Value = SplitStr\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1553699133, "post_id": 55380254, "comment_id": 97483050, "body": "You might consider using <code>.CurrentRegion</code> in order to get the cell, belonging to the same region."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1553699171, "post_id": 55380254, "comment_id": 97483082, "body": "Is there a reason you cannot use conditional formatting? (<code>=A1&lt;&gt;&#39;2019 Project Detail SOURCE&#39;!A1</code>)"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1553699310, "post_id": 55380254, "comment_id": 97483176, "body": "Your <code>&lt;&gt;</code> statement will always be false since you have already determined that the two are equal."}], "answers": [{"comments": [{"owner": {"reputation": 584, "user_id": 10473230, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1E83_CwuxUg/AAAAAAAAAAI/AAAAAAAAAB4/_zbwV-kcjG0/photo.jpg?sz=128", "display_name": "Lucas", "link": "https://stackoverflow.com/users/10473230/lucas"}, "reply_to_user": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 1, "creation_date": 1553702285, "post_id": 55380392, "comment_id": 97485223, "body": "Is you sheet protected? If yes, you should unprotect it in the code first. I&#39;ll edit my post."}], "tags": [], "owner": {"reputation": 584, "user_id": 10473230, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1E83_CwuxUg/AAAAAAAAAAI/AAAAAAAAAB4/_zbwV-kcjG0/photo.jpg?sz=128", "display_name": "Lucas", "link": "https://stackoverflow.com/users/10473230/lucas"}, "is_accepted": true, "score": 1, "last_activity_date": 1553702372, "last_edit_date": 1553702372, "creation_date": 1553698930, "answer_id": 55380392, "question_id": 55380254, "link": "https://stackoverflow.com/questions/55380254/vba-compare-two-sheets-and-highlight-changes/55380392#55380392", "title": "VBA - Compare two sheets and highlight changes", "body": "<p>I would use something like this:</p>\n\n<pre><code>Sub CompareAndHighlightDifferences()\n\nDim w1 As Worksheet, w2 As Worksheet\n\nSet w1 = Sheets(\"2019 Project Detail\")\nSet w2 = Sheets(\"2019 Project Detail SOURCE\")\n\nWith w1\n    For Each cel In .UsedRange\n        If cel.Value &lt;&gt; w2.Cells(cel.Row, cel.Column).Value Then cel.Font.Color = vbRed\n    Next cel\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>Edit:</em> If your sheet is protected, you should add <code>w1.Unprotect</code> in the beginning and <code>w1.Protect</code> at the end.</p>\n"}, {"comments": [{"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1553699967, "post_id": 55380571, "comment_id": 97483652, "body": "thanks @Daniel, I did that. Unfortunately I received error 1004 on this line:  <code>.Cells(c.Row, c.Column).Interior.Color = vbRed</code>"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1553700746, "post_id": 55380571, "comment_id": 97484187, "body": "Odd, it works for me. this is an object-defined error, are you still using with and en with? If not, just place w1 like so: w1.Cells(c.Row, c.Column).Interior.Color = vbRed"}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1553702315, "post_id": 55380571, "comment_id": 97485243, "body": "I&#39;ve replaced it, but still the same error. I&#39;ve edited the code above."}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1553702808, "post_id": 55380571, "comment_id": 97485581, "body": "the sheet has been protected, that&#39;s why it did not work. It works like a charm, already. Many thanks!"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1553699464, "creation_date": 1553699464, "answer_id": 55380571, "question_id": 55380254, "link": "https://stackoverflow.com/questions/55380254/vba-compare-two-sheets-and-highlight-changes/55380571#55380571", "title": "VBA - Compare two sheets and highlight changes", "body": "<p>The problem is that you're searching value in the other sheet, so even if it's not in the same cell address, it will match.</p>\n\n<p>You can remove this and the following if condition:</p>\n\n<pre><code>Set a = w2.Columns(30).Find(c.Value, LookAt:=xlWhole)\n</code></pre>\n\n<p>And use the same address when comparing values:</p>\n\n<p>If .Cells(c.Row, c.Column).Value &lt;> w2.Cells(<strong>c</strong>.Row, <strong>c</strong>.Column)<strong>.Value</strong> Then</p>\n\n<p>/e: Also, you might want to use <code>interior</code> rather than <code>font</code> color because if the cell is blank, there will be a difference that you won't be able to see</p>\n"}], "owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 55380392, "answer_count": 2, "score": 0, "last_activity_date": 1553702372, "creation_date": 1553698473, "last_edit_date": 1553702264, "question_id": 55380254, "link": "https://stackoverflow.com/questions/55380254/vba-compare-two-sheets-and-highlight-changes", "title": "VBA - Compare two sheets and highlight changes", "body": "<p>I'm trying to compare two sheets. The structure of sheet is absolutely the same -> Cell AD4 in Sheet1 should be same as AD4 in Sheet2, if not, then highlight the AD4 cell. It should be done as far as data exists.</p>\n\n<p>The below code does not work, but it does not show any error message.</p>\n\n<pre><code>Sub CompareAndHighlightDifferences()\nDim w1 As Worksheet, w2 As Worksheet\nDim c As Range, a As Range\nSet w1 = Sheets(\"2019 Project Detail\")\nSet w2 = Sheets(\"2019 Project Detail SOURCE\")\nWith w1\n  For Each c In .Range(\"AD4\", .Range(\"AD\" &amp; Rows.Count).End(xlUp))\n    Set a = w2.Columns(30).Find(c.Value, LookAt:=xlWhole)\n    If Not a Is Nothing Then\n      If .Cells(c.Row, c.Column).Value &lt;&gt; w2.Cells(a.Row, a.Column) Then\n         .Cells(c.Row, c.Column).Font.Color = vbRed\n      End If\n    End If\n  Next c\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Could I ask you for any advices, please?</p>\n\n<p>Many thanks!</p>\n\n<p>---------------------EDIT----------------------</p>\n\n<pre><code>Sub CompareAndHighlightDifferences()\nDim w1 As Worksheet, w2 As Worksheet\nDim c As Range\nSet w1 = Sheets(\"2019 Project Detail\")\nSet w2 = Sheets(\"2019 Project Detail SOURCE\")\n\n  For Each c In w1.Range(\"AD4\", w1.Range(\"AD\" &amp; Rows.Count).End(xlUp))\n    If w1.Cells(c.Row, c.Column).Value = w2.Cells(c.Row, c.Column).Value Then\n       w1.Cells(c.Row, c.Column).Interior.Color = vbRed\n    End If\n  Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1553697941, "post_id": 55379966, "comment_id": 97482162, "body": "You need to copy something before you run that code. Otherwise you cannot paste anything. \u2022 Please tell what you copied. Is it in the same workbook? Is it in another workbook? \u2022 Your code should work if a range was copied before. Note that you need to perform the <b>copy action right before the paste action</b>. If you do something else in between like deleting data in a cell, it doesn&#39;t work anymore."}, {"owner": {"reputation": 1, "user_id": 5494210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219c0a41a2d29e52e8093cc793b6f8a3?s=128&d=identicon&r=PG&f=1", "display_name": "user5494210", "link": "https://stackoverflow.com/users/5494210/user5494210"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553897053, "post_id": 55379966, "comment_id": 97571073, "body": "All work in the same worksheet. I tried coping both a single cell and a range of cells. To do the process manually, I would copy the desired cells, move to where I want to paste them and then use paste special to link the cell back to the source. Not a lot of work but I do this a lot.  I thought I could just create a macro that would do the paste special link portion.  E.G. Copy cell, move to new cell, press function key for the macro."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553897215, "post_id": 55379966, "comment_id": 97571120, "body": "Yes, this is exactly how your code works. You copy a cell (manually) then you move to the cell you want to paste in (manually) and press the button for your code and the link (formula) gets pasted. If you do it like that your code works"}], "owner": {"reputation": 1, "user_id": 5494210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219c0a41a2d29e52e8093cc793b6f8a3?s=128&d=identicon&r=PG&f=1", "display_name": "user5494210", "link": "https://stackoverflow.com/users/5494210/user5494210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553697762, "creation_date": 1553697690, "last_edit_date": 1553697762, "question_id": 55379966, "link": "https://stackoverflow.com/questions/55379966/excel-macro-paste-link-run-time-error-1004", "title": "Excel Macro: Paste Link run time Error 1004", "body": "<p>Need a simple way of performing Paste-Link of copied cells.\nThe way I would like it to function is:</p>\n\n<ol>\n<li>User copies cell or range of cells.</li>\n<li>User move the blank area of worksheet where data is to be copied.</li>\n<li>User activates macro that performs Paste-Link function.</li>\n</ol>\n\n<p>I thought it would be a simple record macro of Paste-Link.\nThe Macro created was:</p>\n\n<pre><code>Sub PasteLink()\n' Paste Link function\n      ActiveSheet.Paste Link:=True\n End Sub\n</code></pre>\n\n<p>When I run the macro it gives an error message:</p>\n\n<blockquote>\n  <p>run-time error '1004':<br>\n  Paste method of Worksheet class failed</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553698627, "post_id": 55379925, "comment_id": 97482682, "body": "Why don&#39;t you just run both on the same amount of cells and stop the time with a timer? Then you know it. \u2022 Actually that is what anyone else here would need to do too. See <a href=\"https://stackoverflow.com/questions/198409/how-do-you-test-running-time-of-vba-code\">How do you test running time of VBA code?</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553698792, "post_id": 55379925, "comment_id": 97482811, "body": "Because I am under the impression some of us here know a lot more about computing than I do, and I would like to understand why this difference, if there is any, exists"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553698862, "post_id": 55379925, "comment_id": 97482866, "body": "I suggest to read the data into an array and then test the values in the array for <code>vbNullString</code>. This should be a alot faster than testing each cell. Actually you can only do this with <code>.Value</code> but not with <code>.Interior.Color</code>."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553698990, "post_id": 55379925, "comment_id": 97482948, "body": "I&#39;m afraid I can&#39;t do that, it&#39;s a tad more complicated than that. Before a cell is checked, values in other columns need to be found and compared with other data."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553699128, "post_id": 55379925, "comment_id": 97483045, "body": "You still can use an array for this check only and it still should be faster than reading each cell on its own. \u2022 Or use the array for your other checks and compares too to make these even faster too."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553699590, "post_id": 55379925, "comment_id": 97483378, "body": "In what sense would that be faster? I know check if a cell holds a value, and if not, I populate the cell. By your method I would instead place the cell&#39;s address in an array and after all cells have been added to the array I&#39;d loop through it to check the values. Isn&#39;t that a worse method?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1553699998, "post_id": 55379925, "comment_id": 97483677, "body": "I&#39;ve been programming in Excel for years, but know almost nothing about its internals, at last nothing that would allow me to predict Value vs Color performance.  I suspect that&#39;s true for many others who answer here too.  As @PEH notes, a quick test would provide a pretty reliable answer to your question."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553700623, "post_id": 55379925, "comment_id": 97484122, "body": "@TimStack You can read a whole range into an array like <code>MyArray = Range(&quot;A1:B100&quot;).Value</code> which is only one read action instead of 100 read actions. This makes it a lot (not only a bit) faster. Then you can access the values in that array like <code>MyArray(row, column)</code> eg <code>MyArray(5, 2)</code> will return the value of B5 (which is also much faster than reading the cell). In the end you can even write the whole array at once back to the cells <code>Range(&quot;A1:B100&quot;).Value = MyArray</code>. Note that the range size must exactly match the array size here when writing data."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553701059, "post_id": 55379925, "comment_id": 97484399, "body": "@P\u1d07\u029c cheers, that seems like a sound method. I&#39;ve always steered clear from multi-dimensional arrays but I have to widen my knowledge"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553701075, "post_id": 55379925, "comment_id": 97484406, "body": "@TimWilliams got it. Thanks for the time"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553701115, "post_id": 55379925, "comment_id": 97484434, "body": "@TimStack have a look here for a performance test: <a href=\"https://stackoverflow.com/questions/33302962/performance-difference-between-looping-range-vs-looping-array\">Performance difference between looping range vs looping array</a> It&#39;s 96.39% faster!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553701559, "post_id": 55379925, "comment_id": 97484718, "body": "Blimey, that&#39;s way more significant than I had anticipated. Very useful information, cheers! @P\u1d07\u029c if you make that into an answer I&#39;ll happily accept it"}], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1553701982, "post_id": 55381365, "comment_id": 97484999, "body": "Superb, thank you very much for the time and effort"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 2, "last_activity_date": 1553701744, "creation_date": 1553701744, "answer_id": 55381365, "question_id": 55379925, "link": "https://stackoverflow.com/questions/55379925/performance-difference-between-checking-a-cells-interior-colour-vs-its-value/55381365#55381365", "title": "Performance difference between checking a cell&#39;s interior colour vs. its value", "body": "<p>There seems to be a performance difference indeed. I just checked a cell's value and a cell's interior colour for one hundred million times and there are clear differences:</p>\n\n<pre><code>Checking the value :  456 seconds\nChecking the colour: 1281 seconds\n</code></pre>\n\n<p>In other words: checking the values goes \u00b12.8 times faster (following this single simple experiment). </p>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1553706957, "post_id": 55381841, "comment_id": 97487963, "body": "Awesome, definitely shows the performance boost arrays will give me. Cheers"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1553703138, "creation_date": 1553703138, "answer_id": 55381841, "question_id": 55379925, "link": "https://stackoverflow.com/questions/55379925/performance-difference-between-checking-a-cells-interior-colour-vs-its-value/55381841#55381841", "title": "Performance difference between checking a cell&#39;s interior colour vs. its value", "body": "<p>Just extended the code from here: <a href=\"https://stackoverflow.com/questions/33302962/performance-difference-between-looping-range-vs-looping-array\">Performance difference between looping range vs looping array</a></p>\n\n<p>Range tested: A1:A100000</p>\n\n<pre><code>Read/Write Cell        = 15,765625 seconds\nRead/Write Array       = 0,203125 seconds\n\nRead Cell              = 0,37109375 seconds\nRead Array             = 0,0234375 seconds\nRead Interior Color    = 1,421875 seconds\n</code></pre>\n\n<p>So you have the direct comparison between reading color vs reading array value too.</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nConst strRANGE_ADDRESS As String = \"A1:A100000\"\n\nSub LoopRangeReadWrite()\n\n    Dim r As Range\n    Dim lStart As Double\n    Dim lEnd As Double\n\n    lStart = Timer\n\n    For Each r In Range(strRANGE_ADDRESS)\n        r.Value = r.Value + 1\n    Next r\n\n    lEnd = Timer\n\n    Debug.Print \"Read/Write Cell = \" &amp; (lEnd - lStart) &amp; \" seconds\"\n\nEnd Sub\n\nSub LoopArrayAddOne()\n\n    Dim varArray As Variant\n    Dim var As Variant\n    Dim lStart As Double\n    Dim lEnd As Double\n\n    lStart = Timer\n\n    varArray = Range(strRANGE_ADDRESS).Value\n    For Each var In varArray\n        var = var + 1\n    Next var\n    Range(strRANGE_ADDRESS).Value = varArray\n\n    lEnd = Timer\n\n    Debug.Print \"Read/Write Array = \" &amp; (lEnd - lStart) &amp; \" seconds\"\n\nEnd Sub\n\nSub LoopRangeReadColor()\n\n    Dim r As Range\n    Dim lStart As Double\n    Dim lEnd As Double\n    Dim a As Long\n\n    lStart = Timer\n\n    For Each r In Range(strRANGE_ADDRESS)\n\n        a = r.Interior.Color\n    Next r\n\n    lEnd = Timer\n\n    Debug.Print \"Read Interior Color = \" &amp; (lEnd - lStart) &amp; \" seconds\"\n\nEnd Sub\n\nSub LoopRangeReadValue()\n\n    Dim r As Range\n    Dim lStart As Double\n    Dim lEnd As Double\n    Dim a As Variant\n\n    lStart = Timer\n\n    For Each r In Range(strRANGE_ADDRESS)\n        a = r.Value\n    Next r\n\n    lEnd = Timer\n\n    Debug.Print \"Read Cell = \" &amp; (lEnd - lStart) &amp; \" seconds\"\n\nEnd Sub\n\nSub LoopArrayValue()\n\n    Dim varArray As Variant\n    Dim var As Variant\n    Dim lStart As Double\n    Dim lEnd As Double\n\n    lStart = Timer\n\n    varArray = Range(strRANGE_ADDRESS).Value\n    For Each var In varArray\n        var = var + 1\n    Next var\n\n    lEnd = Timer\n\n    Debug.Print \"Read Array = \" &amp; (lEnd - lStart) &amp; \" seconds\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55381365, "answer_count": 2, "score": 0, "last_activity_date": 1553703138, "creation_date": 1553697583, "question_id": 55379925, "link": "https://stackoverflow.com/questions/55379925/performance-difference-between-checking-a-cells-interior-colour-vs-its-value", "title": "Performance difference between checking a cell&#39;s interior colour vs. its value", "body": "<p>I am running an asset management project in excel. Using a connection with an SQL database I am able to import large numbers of maintenance plans.</p>\n\n<p>Based on what I import, I fill a number of cells with specific short strings, and I additionally paint the interior of the respective cells with one of two colours. Cells that later are populated by the user remain unpainted.</p>\n\n<p><strong>Cells populated using the database data will always be coloured</strong></p>\n\n<p>When I later run a command that populates a large number of cells again, some of these cells may already be populated either by the user or the database. These specific cells must be skipped, and so far I am aware of three possible methods of determining if a cell must be skipped:</p>\n\n<ol>\n<li>Checking with the database (slow): a poor solution since the cells have already been populated with the database, another run would be overdoing it</li>\n<li>Checking wether the cell is populated: <code>If not cell.Value = vbNullstring Then</code></li>\n<li>Checking whether a cell is coloured: <code>If not cell.Interior.Color = vbRed Then</code> </li>\n</ol>\n\n<p>Now, because in theory the amount of populated cells could be up to half a million or even more, I am wondering about the performance differences between the <strong>second</strong> and <strong>third option</strong></p>\n\n<p><strong>Is there any noticeable difference between checking a cell's value versus a cell's interior colour?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "edited": false, "score": 1, "creation_date": 1553696914, "post_id": 55379552, "comment_id": 97481423, "body": "Looking at your code I would say one of the issues is you&#39;ve got nothing declared.  Try Dim Wb As workbook Dim Ws as worksheet Dim Lastcell As integer  Set Wb = Thisworkbook Set Ws = Wb.worksheets(&quot;Bonussen&quot;)  Then you can set LastCell as Ws.cells(rows.count, 1).end(xlup).row"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1553697010, "post_id": 55379552, "comment_id": 97481487, "body": "Does the worksheet Bonussen exist in ThisWorkbook? Note that the With block is redundant."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1553697672, "post_id": 55379552, "comment_id": 97481968, "body": "The Rows.count is unrefererenced and as such takes rows of ActiveSheet. If you &quot;Bonussen&quot; worksheet has less rows than your active sheet you will get an error."}], "owner": {"reputation": 1, "user_id": 9558964, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-POIezK5nPas/AAAAAAAAAAI/AAAAAAAADmA/hMjyE9WuASs/photo.jpg?sz=128", "display_name": "Natascha de Brabander CEVA", "link": "https://stackoverflow.com/users/9558964/natascha-de-brabander-ceva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553698252, "creation_date": 1553696526, "last_edit_date": 1553696682, "question_id": 55379552, "link": "https://stackoverflow.com/questions/55379552/how-to-fix-my-macro-to-create-excel-tabs-based-on-a-table", "title": "How to fix my macro to create excel tabs based on a table", "body": "<p>I created a macro to copy a template macro as many times as there are rows in my table.</p>\n\n<p>However I get the following error: </p>\n\n<blockquote>\n  <p>Error 429 ActiveX Component Can't Create Object.</p>\n</blockquote>\n\n<p>It was working fine when I created it a year ago</p>\n\n<p>The part of the code that is giving an issue is the first line starting with lastcell (see code below)</p>\n\n<p>Anybody any idea why it is not working?</p>\n\n<p>Googled on the answer, but could not find why it is not working.</p>\n\n<p>Maybe it has to do with the fact that I created the macro in an older office version (2013) then I am working in right now (2016)</p>\n\n<pre><code>Sub Aanmaaktabbladen()\nlastcell = ThisWorkbook.Worksheets(\"Bonussen\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 3 To lastcell\n\nWith ThisWorkbook\n\nnewname = ThisWorkbook.Worksheets(\"Bonussen\").Cells(i, 1).Value\n\nSet wsVOORBEELD = ActiveSheet\nwsVOORBEELD.Copy After:=Sheets(Sheets.Count)\n\nActiveSheet.Name = newname\n\nEnd With\nNext\nThisWorkbook.Worksheets(\"Bonussen\").Activate\nThisWorkbook.Worksheets(\"Bonussen\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553695793, "post_id": 55379214, "comment_id": 97480683, "body": "Where is this Date attribute? Is it a value in a cell? Have you discovered how to read this value? And by Name do you mean the name of the worksheet?"}, {"owner": {"reputation": 163, "user_id": 8972506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcc4936069670aadc87d9e180bcb5110?s=128&d=identicon&r=PG&f=1", "display_name": "AgentNo", "link": "https://stackoverflow.com/users/8972506/agentno"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553696309, "post_id": 55379214, "comment_id": 97481041, "body": "I maybe wasn&#39;t clear, sorry. I&#39;m importing two string fields from an excel sheet into word to mail merge - called Date and Name. The Date attribute I am referred to is what is pulled into the word document from the excel sheet via the mail merge. When I run the merge I get a long document. The code above takes each page and makes it its own document. Instead of using the naming convention there, I would like to use the Date as it is pulled in from the mail merge to name each document."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553696426, "post_id": 55379214, "comment_id": 97481117, "body": "Have you discovered how to refer to this Date merge field? Once you can obtain its value you can just use it to assign a value to strNewFileName."}, {"owner": {"reputation": 163, "user_id": 8972506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcc4936069670aadc87d9e180bcb5110?s=128&d=identicon&r=PG&f=1", "display_name": "AgentNo", "link": "https://stackoverflow.com/users/8972506/agentno"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553696904, "post_id": 55379214, "comment_id": 97481417, "body": "I&#39;m working off what is in the MS Office Dev Centre, but I&#39;m having difficulty getting it working. I can see how to assign a merge field, but I can&#39;t figure out how to get it to change with each page without breaking the code completely."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1553721360, "post_id": 55379214, "comment_id": 97495039, "body": "There would be two basic approaches: 1) Knowing <i>exactly</i> where the data is located on each page so that the code can pick it up as part of the loop. 2) don&#39;t use mail merge; create each document for each record in Excel using automation (either Word VBA reads the Excel sheet or Excel writes to Word). There are lots of examples around for (2); no one here can help you with (1) since we have no idea how the mail merge result pages are structured / where the date is on the page."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1553723105, "creation_date": 1553723105, "answer_id": 55386948, "question_id": 55379214, "link": "https://stackoverflow.com/questions/55379214/how-to-rename-a-word-document-according-to-a-mail-merge-attribute-in-vba/55386948#55386948", "title": "How to rename a word document according to a mail merge attribute in VBA?", "body": "<p>A far better approach is to create the separate documents from the outset. By adding the following macro to your mailmerge main document, you can generate one output file per record. Files are saved to the same folder as the mailmerge main document, using the 'Date' field in the data source for the filenames. PDF &amp; DOCX output formats are catered for. Do be aware that, should your data source have duplicate dates, only the last one processed will survive.</p>\n\n<pre><code>Sub Merge_To_Individual_Files()\n'Merges one record at a time to the folder containing the mailmerge main document.\n' Sourced from: http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\nApplication.ScreenUpdating = False\nDim StrFolder As String, StrName As String, MainDoc As Document, i As Long, j As Long\nSet MainDoc = ActiveDocument\nWith MainDoc\n  StrFolder = .Path &amp; Application.PathSeparator\n  For i = 1 To .MailMerge.DataSource.RecordCount\n    With .MailMerge\n      .Destination = wdSendToNewDocument\n      .SuppressBlankLines = True\n      With .DataSource\n        .FirstRecord = i\n        .LastRecord = i\n        .ActiveRecord = i\n        If Trim(.DataFields(\"Date\")) = \"\" Then Exit For\n        StrName = Format(.DataFields(\"Date\"), \"YYYY-MM-DD\")\n      End With\n      .Execute Pause:=False\n      If Err.Number = 5631 Then\n        Err.Clear\n        GoTo NextRecord\n      End If\n    End With\n    With ActiveDocument\n      .SaveAs FileName:=StrFolder &amp; StrName &amp; \".docx\", FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n      ' and/or:\n      .SaveAs FileName:=StrFolder &amp; StrName &amp; \".pdf\", FileFormat:=wdFormatPDF, AddToRecentFiles:=False\n      .Close SaveChanges:=False\n    End With\nNextRecord:\n  Next i\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Note 1:</strong> The above code defaults to saving the output to the mailmerge main document's folder. You can change the destination folder by editing:</p>\n\n<pre><code>StrFolder = .Path &amp; Application.PathSeparator\n</code></pre>\n\n<p><strong>Note 2:</strong> If you rename the above macro as 'MailMergeToDoc', clicking on the 'Edit Individual Documents' button will intercept the merge and the process will run automatically. The potential disadvantage of intercepting the 'Edit Individual Documents' process this way is that you no longer get to choose which records to merge at that stage. However, you can still achieve the same outcome - and with greater control - via the 'Edit Recipient List' tools.</p>\n"}], "owner": {"reputation": 163, "user_id": 8972506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcc4936069670aadc87d9e180bcb5110?s=128&d=identicon&r=PG&f=1", "display_name": "AgentNo", "link": "https://stackoverflow.com/users/8972506/agentno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2208, "favorite_count": 0, "accepted_answer_id": 55386948, "answer_count": 1, "score": 0, "last_activity_date": 1582888131, "creation_date": 1553695556, "last_edit_date": 1582888131, "question_id": 55379214, "link": "https://stackoverflow.com/questions/55379214/how-to-rename-a-word-document-according-to-a-mail-merge-attribute-in-vba", "title": "How to rename a word document according to a mail merge attribute in VBA?", "body": "<p>The title may be a bit gory, but here we are.</p>\n\n<p>Currently I've got a word document that uses mail merge to insert two attributes from an Excel sheet (date and name). Once the merge is generated, I then have a macro to split each page of the resultant document into it's own separate document. The macro I'm using is just copied and pasted from <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=727\" rel=\"nofollow noreferrer\">VBA Express here</a>, seen below.</p>\n\n<pre><code>Sub SplitIntoPages()\n    Dim docMultiple As Document\n    Dim docSingle As Document\n    Dim rngPage As Range\n    Dim iCurrentPage As Integer\n    Dim iPageCount As Integer\n    Dim strNewFileName As String\n\n    Application.ScreenUpdating = False 'Makes the code run faster and reduces screen _\n    flicker a bit.\n    Set docMultiple = ActiveDocument 'Work on the active document _\n    (the one currently containing the Selection)\n    Set rngPage = docMultiple.Range 'instantiate the range object\n    iCurrentPage = 1\n     'get the document's page count\n    iPageCount = docMultiple.Content.ComputeStatistics(wdStatisticPages)\n    Do Until iCurrentPage &gt; iPageCount\n        If iCurrentPage = iPageCount Then\n            rngPage.End = ActiveDocument.Range.End 'last page (there won't be a next page)\n        Else\n             'Find the beginning of the next page\n             'Must use the Selection object. The Range.Goto method will not work on a page\n            Selection.GoTo wdGoToPage, wdGoToAbsolute, iCurrentPage + 1\n             'Set the end of the range to the point between the pages\n            rngPage.End = Selection.Start\n        End If\n        rngPage.Copy 'copy the page into the Windows clipboard\n        Set docSingle = Documents.Add 'create a new document\n        docSingle.Range.Paste 'paste the clipboard contents to the new document\n         'remove any manual page break to prevent a second blank\n        docSingle.Range.Find.Execute Findtext:=\"^m\", ReplaceWith:=\"\"\n         'build a new sequentially-numbered file name based on the original multi-paged file name and path\n        strNewFileName = Replace(docMultiple.FullName, \".doc\", \"_\" &amp; Right$(\"000\" &amp; iCurrentPage, 4) &amp; \".doc\")\n        docSingle.SaveAs strNewFileName 'save the new single-paged document\n        iCurrentPage = iCurrentPage + 1 'move to the next page\n        docSingle.Close 'close the new document\n        rngPage.Collapse wdCollapseEnd 'go to the next page\n    Loop 'go to the top of the do loop\n    Application.ScreenUpdating = True 'restore the screen updating\n\n     'Destroy the objects.\n    Set docMultiple = Nothing\n    Set docSingle = Nothing\n    Set rngPage = Nothing\nEnd Sub\n</code></pre>\n\n<p>However, there are over 90 pages of the mail merge and, as seen in the code above, they are all named by just adding numbers to the end of the file name. Instead of this, I would like to have it so that it would read the merged Date attribute from each page and use that as the file name instead. I've tried tinkering around with the code and reading up about it on the MS Dev Centre, but I've had no luck. </p>\n\n<p>Can anyone help? Thanks.</p>\n"}, {"tags": ["excel", "vba", "csv", "export-to-csv"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8016388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a91a2208dcf6b90afbb4c2422f1e48?s=128&d=identicon&r=PG", "display_name": "Kasandra Murray", "link": "https://stackoverflow.com/users/8016388/kasandra-murray"}, "edited": false, "score": 0, "creation_date": 1554392317, "post_id": 55380913, "comment_id": 97744415, "body": "I am having an error with the following line: &quot;&amp; r.Cells(1) &amp; &quot;_Communication.csv&quot;, dcsv&quot; I get a compiling error."}, {"owner": {"reputation": 65, "user_id": 8016388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a91a2208dcf6b90afbb4c2422f1e48?s=128&d=identicon&r=PG", "display_name": "Kasandra Murray", "link": "https://stackoverflow.com/users/8016388/kasandra-murray"}, "edited": false, "score": 1, "creation_date": 1554399244, "post_id": 55380913, "comment_id": 97748129, "body": "Looks like you just need to add an underscore after the line above it: &quot;saveFile ThisWorkbook.Path &amp; Application.PathSeparator_&quot;"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 65, "user_id": 8016388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a91a2208dcf6b90afbb4c2422f1e48?s=128&d=identicon&r=PG", "display_name": "Kasandra Murray", "link": "https://stackoverflow.com/users/8016388/kasandra-murray"}, "edited": false, "score": 0, "creation_date": 1554476971, "post_id": 55380913, "comment_id": 97780190, "body": "Yes, I think it wrapped the line -- I&#39;ll fix it."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1616462718, "post_id": 55380913, "comment_id": 118004836, "body": "Nice one Logan!!!"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 2, "last_activity_date": 1554477004, "last_edit_date": 1554477004, "creation_date": 1553700480, "answer_id": 55380913, "question_id": 55379075, "link": "https://stackoverflow.com/questions/55379075/how-to-export-each-individual-excel-row-to-its-own-individual-csv-file/55380913#55380913", "title": "How to export each individual excel row to its own individual csv file?", "body": "<p>One way to approach this is by writing out csv files from VBA macro:</p>\n\n<pre><code>Sub SaveRowsToSeparateCsv()\n\n    Dim h As Range       ' header\n    Dim d As Range       ' data\n    Dim r As Range       ' row\n    Dim c As Range       ' cell\n\n    Dim i As Long\n\n    Dim ha2d As Variant  ' header 2d array\n    Dim ha1d As Variant  ' header 1d array\n    Dim hcsv As String   ' header in csv format\n\n    Dim da2d As Variant  ' data 2d array\n    Dim da1d As Variant  ' data 1d array\n    Dim dcsv As String   ' data in csv format\n\n    ' init ranges with header and data\n    With [a1].CurrentRegion\n        Set h = .Rows(1)\n        Set d = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n    End With\n\n    ' we'll need header multiple times, so lets prepare it\n    ha2d = h.Value\n    ReDim ha1d(LBound(ha2d, 2) To UBound(ha2d, 2))\n    For i = LBound(ha1d) To UBound(ha1d)\n        ha1d(i) = ha2d(1, i)\n    Next\n    hcsv = Join(ha1d, \",\") &amp; vbNewLine\n\n    ' now lets go through each row and save it seaprately as a csv\n    For Each r In d.Rows\n        da2d = r.Value\n        ReDim da1d(LBound(da2d, 2) To UBound(da2d, 2))\n        For i = LBound(da1d) To UBound(da1d)\n            da1d(i) = da2d(1, i)\n        Next\n        dcsv = hcsv &amp; Join(da1d, \",\") &amp; vbNewLine\n\n        saveFile ThisWorkbook.Path &amp; Application.PathSeparator _\n                 &amp; r.Cells(1) &amp; \"_Communication.csv\", dcsv\n    Next r\n\nEnd Sub\n\nSub saveFile(pathname As String, sText As String)\n    Dim fNum As Integer: fNum = FreeFile\n    Open pathname For Output As fNum\n    Print #fNum, sText;\n    Close #fNum\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8016388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a91a2208dcf6b90afbb4c2422f1e48?s=128&d=identicon&r=PG", "display_name": "Kasandra Murray", "link": "https://stackoverflow.com/users/8016388/kasandra-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 1, "accepted_answer_id": 55380913, "answer_count": 1, "score": 1, "last_activity_date": 1554479366, "creation_date": 1553695206, "last_edit_date": 1554479366, "question_id": 55379075, "link": "https://stackoverflow.com/questions/55379075/how-to-export-each-individual-excel-row-to-its-own-individual-csv-file", "title": "How to export each individual excel row to its own individual csv file?", "body": "<p>I am trying to build a variable data report in Adobe Illustrator. This report will have graphs and data for each individual listed in an excel/csv file. To be able to generate the graphs there needs to be a .csv file of the data only pertaining to the graph relevant to that specific individual.</p>\n\n<p>So for example I have three individuals: John, Joe, and Ann.</p>\n\n<p>Each individual will have a bar graph showing their growth in communication, and they will also have a graph showing  their growth in confidence.</p>\n\n<p>Each individual needs a csv for both graphs. Which means I will need a total of 6 csv files to start building the variable data report in excel.</p>\n\n<p>Obviously all of the data will be together in one excel file that I will need to separate out and save as the individual csv files.</p>\n\n<p>Is there a script I can use that will export each row (representative of the individual) as it's own separate csv file and name it based on the data in cell A2 and B1?</p>\n\n<p>I have done some research and I have found some solutions that only reference the columns or how to export selected rows, but I will need to do this for 100+ individuals and these solutions will not work for the volume I need them to. I am somewhat familiar with VBA coding, but I am having a hard time finding anything that can help with this issue.  </p>\n\n<p>So if my cells look like this:</p>\n\n<pre><code>    A       B               C\n1   Name    Communication   Communication End\n2   John    20              25\n3   Joe     16              18\n4   Ann     23              27\n</code></pre>\n\n<p>My file names will look like this:\nJohn_Communication.csv, Joe_Communication.csv, Ann_Communication.csv</p>\n\n<p>And will only export the data from each individual row as it's own csv file so that I can import the data into Adobe Illustrator to create the graphs I need for the individual's reports?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553694687, "post_id": 55378701, "comment_id": 97479897, "body": "Have you done any research? Row loops questions are extremely common here which means the amount of already written solutions is plentiful. You just need a variable row with a loop. <code>Range(&quot;A&quot; &amp; i)</code> .... <code>Next i</code>. Also, you should create a variable for your work sheets. It will go a long way with readability here. No need to keep restating <code>wb.Sheets(&quot;GLOBAL ISU&quot;)</code>. Just turn that into a variable (maybe <i>ISU</i>) and then you can just use <code>ISU.Range(&quot;A&quot; &amp; i)</code>"}, {"owner": {"reputation": 35, "user_id": 9120041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6751b76067a468b8877b757d3b8193f4?s=128&d=identicon&r=PG&f=1", "display_name": "William76", "link": "https://stackoverflow.com/users/9120041/william76"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553695031, "post_id": 55378701, "comment_id": 97480143, "body": "urdearboy, Yeah I did as much research on Mr. Excel and Stackoverflow and that is how I came up with the <code>twb.Worksheets(&quot;Log&quot;).Range(&quot;A65536&quot;).End(xlUp).Offset(1, 0).Select</code> code. So is this is not correct then. I also saw the <code>Dim i as Integer</code> method and didn&#39;t know if that was applicable."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553695393, "post_id": 55378701, "comment_id": 97480399, "body": "You should declare your worksheets for shorten your code <code>Dim wsForm As Worksheet</code> and then <code>Set wsForm = wb.Sheets(&quot;ISU FORM&quot;)</code>. So you can use <code>wsForm</code> instead <code>wb.Sheets(&quot;ISU FORM&quot;)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1553695415, "post_id": 55378701, "comment_id": 97480411, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">THIS</a> on how to find the last row. Also avoid the use of <code>.Select</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">THIS</a>"}, {"owner": {"reputation": 35, "user_id": 9120041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6751b76067a468b8877b757d3b8193f4?s=128&d=identicon&r=PG&f=1", "display_name": "William76", "link": "https://stackoverflow.com/users/9120041/william76"}, "edited": false, "score": 0, "creation_date": 1553696611, "post_id": 55378701, "comment_id": 97481231, "body": "Damian Thanks, I will update the declarations to your suggestions. Siddharth Rout, I will review the link you provided when I have a moment, thank you both for your help."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9120041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6751b76067a468b8877b757d3b8193f4?s=128&d=identicon&r=PG&f=1", "display_name": "William76", "link": "https://stackoverflow.com/users/9120041/william76"}, "is_accepted": false, "score": 0, "last_activity_date": 1553781418, "creation_date": 1553781418, "answer_id": 55399401, "question_id": 55378701, "link": "https://stackoverflow.com/questions/55378701/how-to-move-to-next-available-row-excel-vba/55399401#55399401", "title": "How to move to next available row - EXCEL VBA", "body": "<p>Thank you all for your help. I was able to successfully able to accomplish this using the following bit of code: </p>\n\n<pre><code>Dim nextrow As Long\n\nnextrow = Cells(Rows.Count, \"A\").End(xlUp).row\n</code></pre>\n\n<p>I had to change a line or two in the existing code to get it to run, but it works! :) Thank you all for your links to articles that explained what I needed. Cheers!</p>\n"}], "owner": {"reputation": 35, "user_id": 9120041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6751b76067a468b8877b757d3b8193f4?s=128&d=identicon&r=PG&f=1", "display_name": "William76", "link": "https://stackoverflow.com/users/9120041/william76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553781418, "creation_date": 1553694141, "question_id": 55378701, "link": "https://stackoverflow.com/questions/55378701/how-to-move-to-next-available-row-excel-vba", "title": "How to move to next available row - EXCEL VBA", "body": "<p>I have a Excel VBA code that looks through a folder and copies data to the current workbook. Where would I place a code line for move to next available blank row when the code is run again?</p>\n\n<p>I assume I would use the following line of code but it doesn't seem to work in the place where I have it located in the \"Select Values from Cells\" section:</p>\n\n<pre><code>    twb.Worksheets(\"Log\").Range(\"A65536\").End(xlUp).Offset(1, 0).Select\n</code></pre>\n\n<p>My full code is:</p>\n\n<pre><code>    Sub RenameExcelInDir()\n\n    Dim MyPath As String\n    Dim MyFile As String\n    Dim MyExt As String\n    Dim MyNewName As String\n    Dim MyVendor As String\n    Dim MyFAC As String\n    Dim MyFabric As String\n    Dim MyFiberC As String\n    Dim MyKnit As String\n    Dim MyWoven As String\n    Dim MyDesc As String\n    Dim wb As Workbook\n    Dim twb As Workbook\n    Dim wks As Worksheet\n    Dim r As Range\n    Dim getDate As String\n\n    'Opens File Dialog Window to choose dir to search in\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n   .Show\n   MyPath = .SelectedItems(1)\nEnd With\n\ngetDate = Date\n\nSet twb = ThisWorkbook\n\nSet r = twb.Worksheets(\"Log\").Range(\"A2\")\n\nMyFile = Dir(MyPath &amp; \"\\*.*\")\n\nDo While Len(MyFile) &gt; 0\n    MyExt = Split(MyFile, \".\")(UBound(Split(MyFile, \".\")))\n\n    Set wb = Workbooks.Open(MyPath &amp; \"\\\" &amp; MyFile, UpdateLinks:=0)\n\n\n    'Loops through the worksheet collection\n\nFor Each wks In wb.Worksheets\n\nSelect Case wks.Name\n\n    Case \"ISU Form\"\n    MyNewName = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C23\").Value &amp; \".\" &amp; MyExt)\n    MyVendor = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C21\").Value)\n    MyFAC = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C25\").Value)\n    MyDesc = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C14\").Value)\n    MyFabric = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C15\").Value)\n    MyFiberC = ValidFileName(FileName:=wb.Sheets(\"ISU FORM\").Range(\"C17\").Value)\n\n    Case \"GLOBAL ISU\"\n    MyNewName = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"M26\").Value &amp; \".\" &amp; MyExt)\n    MyVendor = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D18\").Value)\n    MyFAC = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D21\").Value)\n    MyDesc = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D26\").Value)\n    MyFabric = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D64\").Value)\n    MyFiberC = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D66\").Value)\n    MyKnit = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"D68\").Value)\n    MyWoven = ValidFileName(FileName:=wb.Sheets(\"GLOBAL ISU\").Range(\"F68\").Value)\n\nEnd Select\n\nNext wks\n\nwb.Close\n\n      'Select Values from cells\ntwb.Worksheets(\"Log\").Range(\"A65536\").End(xlUp).Offset(1, 0).Select\nr.Value = MyFile\nr.Offset(, 1).Value = MyNewName\nr.Offset(, 2).Value = getDate\nr.Offset(, 3).Value = MyVendor\nr.Offset(, 4).Value = MyFAC\nr.Offset(, 5).Value = MyDesc\nr.Offset(, 6).Value = MyFabric\nr.Offset(, 7).Value = MyFiberC\nr.Offset(, 8).Value = MyKnit\nr.Offset(, 9).Value = MyWoven\nr.Offset(, 10).Value = MyPath\nSet r = r.Offset(1)\nName MyPath &amp; \"\\\" &amp; MyFile As MyPath &amp; \"\\\" &amp; MyNewName\nMyFile = Dir\n\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>and the ValidFileNameFunction is:</p>\n\n<pre><code>   Function ValidFileName(ByVal FileName As String) As String\nDim myarray() As Variant\nDim x\n'check for illegal characters\nmyarray = Array(\"[\", \"]\", \"\\\\\", \"/\", \"*\", \"\\\", \"?\", \"&lt;&gt;\", \"&lt;\", \"&gt;\", \":\", \"|\", \"&amp;\")\nFor x = LBound(myarray) To UBound(myarray)\n    FileName = Replace(FileName, myarray(x), \"\", 1)\nNext x\nValidFileName = FileName\n    End Function\n</code></pre>\n\n<p>I would like it to move to the next line in the worksheet \"Log\" when the code is ran again. My current testing results is just overwriting the first two lines in the test folder. Any help would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1553694033, "post_id": 55378289, "comment_id": 97479399, "body": "That runs reasonably quickly for me, how long does format_table take? You could work with <code>FirstRow</code>, <code>LastCol</code> etc to improve it slightly. You could consider have a hidden slide with an empty table already created that you could just copy when you need a new one."}, {"owner": {"reputation": 345, "user_id": 544777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f461ca9cb13e2380dc87a0c0973b0a?s=128&d=identicon&r=PG", "display_name": "JackStoneS", "link": "https://stackoverflow.com/users/544777/jackstones"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553694241, "post_id": 55378289, "comment_id": 97479538, "body": "Both <code>format_table</code> and <code>format_planning_table</code> take about 10 seconds, for a table thats 10x18 (although that does include the time for creating the table in the first place). I like the idea of having an empty (formatted) table ready, and just copying that in."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553694349, "post_id": 55378289, "comment_id": 97479624, "body": "I suppose you could also consider starting with a table with just 2 or 3 rows, formatting it (with banded rows) then, eventually, add some more rows to it. I would go with copying first."}], "owner": {"reputation": 345, "user_id": 544777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f461ca9cb13e2380dc87a0c0973b0a?s=128&d=identicon&r=PG", "display_name": "JackStoneS", "link": "https://stackoverflow.com/users/544777/jackstones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553692984, "creation_date": 1553692984, "question_id": 55378289, "link": "https://stackoverflow.com/questions/55378289/formatting-powerpoint-table-using-vba-very-slow", "title": "Formatting PowerPoint table using VBA very slow", "body": "<p>I'm using VBA to create a table with very specific formatting. For some reason adding a 10x18 table takes about 10 seconds. That seems overly long, but I can't find out why. Any ideas on how to speed this up? </p>\n\n<p>I think it might have to do with PowerPoint trying to render each change. I'd love to be able to just create the table, and only then to display it. </p>\n\n<pre><code>Public Sub format_planning_table(tbl As Table, isNew As Boolean)\n    Dim row, col As Integer\n\n    'First do default formatting so we don't have to change everything\n    format_table tbl, isNew, 11\n\n    With tbl\n\n        .Cell(1, 1).Shape.Fill.Transparency = 0\n        .Cell(1, 1).Shape.Fill.ForeColor.ObjectThemeColor = msoThemeColorAccent2\n\n        'Set column widths\n        .Columns(1).width = 130.1576\n        .Columns(2).width = 137.4546\n        .Columns(3).width = 53.09087\n        For col = 4 To .Columns.Count\n            .Columns(col).width = 38.31606\n        Next col\n\n        'Set height for top two rows\n        .Rows(1).height = 20.4\n        .Rows(2).height = 20.4\n        For col = 1 To .Columns.Count\n            'Format top row (some merged cells)\n            .Cell(1, col).Shape.Fill.ForeColor.ObjectThemeColor = msoThemeColorAccent5\n            .Cell(2, col).Shape.Fill.ForeColor.ObjectThemeColor = msoThemeColorAccent5\n            .Cell(1, col).Shape.TextFrame.VerticalAnchor = msoAnchorMiddle 'Vertical alignment to middle\n            .Cell(2, col).Shape.TextFrame.VerticalAnchor = msoAnchorMiddle 'Vertical alignment to middle\n            .Cell(2, col).Shape.TextFrame.TextRange.Font.Color.ObjectThemeColor = msoThemeColorLight1\n            .Cell(2, col).Shape.TextFrame.TextRange.Font.Bold = msoTrue\n\n            'Weeks\n            If col &gt;= 4 Then\n                .Cell(1, col).Shape.TextFrame.TextRange.ParagraphFormat.Alignment = ppAlignCenter 'Horizontal alignment center\n                .Cell(2, col).Shape.TextFrame.TextRange.ParagraphFormat.Alignment = ppAlignCenter 'Horizontal alignment center\n\n                'Set alternating shading. 1 is gray, 0 is white\n                For row = 3 To .Rows.Count\n                    If .Cell(3, col).Shape.TextFrame.TextRange.Text = \"@@1\" Then\n                        .Cell(row, col).Shape.Fill.ForeColor.ObjectThemeColor = msoThemeColorLight1\n                    End If\n                    .Rows(row).Cells.Borders(ppBorderLeft).Transparency = 1 'Remove border.\n\n                Next row\n                .Cell(3, col).Shape.TextFrame.TextRange.Text = \"\" 'Empty the temporary text\n\n            End If\n        Next col\n\n        'For the data part, set the bottom border for the entire row, then reset for first two columns\n        For row = 3 To .Rows.Count\n            .Cell(row, 1).Shape.TextFrame.TextRange.Font.Color.ObjectThemeColor = msoThemeColorLight1\n            .Cell(row, 2).Shape.TextFrame.TextRange.Font.Color.ObjectThemeColor = msoThemeColorLight1\n            With .Rows(row).Cells.Borders(ppBorderBottom)\n                .DashStyle = 11\n                .Weight = 1.5\n                .ForeColor.ObjectThemeColor = msoThemeColorText1\n            End With\n            With .Cell(row, 1).Borders(ppBorderBottom) 'Reset first column\n                .DashStyle = msoLineSolid\n                .Weight = 2.25\n                .ForeColor.ObjectThemeColor = msoThemeColorLight1\n            End With\n            With .Cell(row, 2).Borders(ppBorderBottom) 'Reset second column\n                .DashStyle = msoLineSolid\n                .Weight = 2.25\n                .ForeColor.ObjectThemeColor = msoThemeColorLight1\n            End With\n        Next row\n    End With\nEnd Sub\n</code></pre>\n\n<p>I'm setting some column widths with hard values. I know that's ugly, but it'll do for now.</p>\n"}, {"tags": ["excel", "vba", "file", "text"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553692903, "post_id": 55378145, "comment_id": 97478664, "body": "Yes, it is possible. You cannot directly edit the file. You can iterate the lines of the file writing them to a new, perhaps temporary, file. Or collect all the lines into a data structure first, if possible."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1553699319, "post_id": 55378145, "comment_id": 97483182, "body": "@Pishti - Referring to the existing XML file, it would be helpful to edit some hints to its <b>node structure</b> to define an <code>XPath</code> where to locate your search text and to insert new contents using e.g. XMLDOM and its <code>InsertBefore</code> method. Or post another question with more precise indications describing the XML file and which code you tried by your own; recommended reading at SO  <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example - MCVE</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553704726, "post_id": 55378145, "comment_id": 97486739, "body": "Seems like you&#39;d really want to consider different approaches based on whether it&#39;s actually xml vs just text."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1553698703, "last_edit_date": 1553698703, "creation_date": 1553697987, "answer_id": 55380066, "question_id": 55378145, "link": "https://stackoverflow.com/questions/55378145/insert-lines-of-text-into-an-already-existing-txt-xml-file/55380066#55380066", "title": "insert lines of text into an already existing .txt/.xml file?", "body": "<p>A text file is sequential. That means that after a line follows immediately the next line. There is no room to insert.</p>\n\n<p>To insert a line in an existing text file, you need to \"spool\" the file and at the place where you want to \"insert\" the line, write it and then spool the remainder. The following is an example:</p>\n\n<pre><code>Sub spool(myFile As String, myPath As String)\n    Dim textline\n\n    Open myPath &amp; myFile For Input As #1\n    Open myPath &amp; \"tmp.txt\" For Output As #2\n    While Not EOF(1)\n        Line Input #1, textline\n        ' do your check here and insert the line\n        If (myCondition = True) Then\n            Print #2, \"Hello World!\"\n        End If\n        Print #2, textline\n    Wend\n    Close #1\n    Close #2\n    Kill myPath &amp; myFile\n    Name myPath &amp; \"tmp.txt\" As myPath &amp; myFile\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8494939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Bn8JJ0loN6o/AAAAAAAAAAI/AAAAAAAAABY/edIQQs_2l3k/photo.jpg?sz=128", "display_name": "Pishti", "link": "https://stackoverflow.com/users/8494939/pishti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553698703, "creation_date": 1553692545, "last_edit_date": 1553692807, "question_id": 55378145, "link": "https://stackoverflow.com/questions/55378145/insert-lines-of-text-into-an-already-existing-txt-xml-file", "title": "insert lines of text into an already existing .txt/.xml file?", "body": "<p>I've been assigned to update a large, existing XML file with some data from an excel file. I want to use a VBA code for a quicker way to update since the number of excel rows and text lines is quite large and can change in the future.</p>\n\n<p>I've already searched and found varying amount of code on how to read and write into a txt/xml file (doesn't matter which). However I haven't been able to find any on how to write in an already existing txt/xml file without deleting all of it's already existing content.\nJust for example purposes, I've written bellow a text on which to work on (I'm not using the original text since it's hundreds of lines long).</p>\n\n<pre><code>How to improve on life!\nPro tips:\n\nEnjoy!\n</code></pre>\n\n<p>What I would want is to be able to insert multiple lines of text in that space, either by using a text line as a reference (after \"Pro tip:\" or before \"Enjoy!\") or by detecting an empty line and use that as a starting point. I do not know the number of text lines and excel rows, however I do have some reference points in that the file has a preexisting structure, thus I can use the text in some lines as points of reference.</p>\n\n<p>Is it possible to do this in excel VBA?</p>\n"}, {"tags": ["vba", "vsto", "powerpoint", "office-addins"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1553701718, "post_id": 55378132, "comment_id": 97484826, "body": "This seems to be a bug, and it appears to have been fixed; I&#39;m not getting any errors in the current Insider build when I run your code then add a picture, accept one of the Designer suggestions and run GetCustomProperty again. When that fix will reach all copies of 365 is anybody&#39;s guess, though it probably will be w/in months if not weeks."}, {"owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "edited": false, "score": 2, "creation_date": 1578975212, "post_id": 55378132, "comment_id": 105604820, "body": "Here I am in Jan 2020, with exactly the same problem. Hello MS?!"}, {"owner": {"reputation": 1647, "user_id": 67420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8496c3885653e026bc72db12aa9444d9?s=128&d=identicon&r=PG", "display_name": "Jozef Izso", "link": "https://stackoverflow.com/users/67420/jozef-izso"}, "edited": false, "score": 0, "creation_date": 1600336836, "post_id": 55378132, "comment_id": 113058304, "body": "It is still not fixed in PowerPoint Version 2008 (Build 13127.20408)"}], "owner": {"reputation": 108, "user_id": 6718200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3115fb86134f19e6a83296e55244c29?s=128&d=identicon&r=PG&f=1", "display_name": "Suleman Ahmad", "link": "https://stackoverflow.com/users/6718200/suleman-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1553692523, "creation_date": 1553692523, "question_id": 55378132, "link": "https://stackoverflow.com/questions/55378132/why-does-powerpoint-reset-clear-the-customdocumentproperties-when-using-design", "title": "Why does PowerPoint reset/clear the CustomDocumentProperties when using &quot;Design Ideas&quot; feature of Office 365?", "body": "<p>We've developed a PowerPoint VSTO add-in. To work with multiple Presentations at the same time we use a unique GUID for each presentation and store it in CustomDocumentProperties as <a href=\"https://stackoverflow.com/a/28320436/6718200\">mentioned here</a>.</p>\n\n<p>With Office 365 Microsoft has introduced a new feature in PowerPoint called design ideas. (It is the last item on the Design tab) When we use this add-in, interestingly the CustomDocuementProperties stored in the presentation are removed.   </p>\n\n<p><a href=\"https://i.stack.imgur.com/bYpy8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bYpy8.png\" alt=\"Design Ideas\"></a></p>\n\n<p>It is easily reproducible with following VBA code. First, run the AddCustomProperty method and verify it with GetCustomProperty, then use the Design Ideas on a slide. After this when GetCustomProperty is called an exception is thrown.</p>\n\n<pre><code>Public Sub AddCustomProperty()\n    On Error Resume Next\n    ActivePresentation.CustomDocumentProperties(\"PresentationID\").Value = \"bb999da6f94c4692b31106994636d962\"\n    If Err.Number &gt; 0 Then\n        ActivePresentation.CustomDocumentProperties.Add _\n            Name:=\"PresentationID\", _\n            LinkToContent:=False, _\n            Type:=MsoDocProperties.msoPropertyTypeString, _\n            Value:=\"bb999da6f94c4692b31106994636d962\"\n    End If\nEnd Sub\n\nSub GetCustomProperty()\n    MsgBox ActivePresentation.CustomDocumentProperties(\"PresentationID\")\nEnd Sub\n</code></pre>\n\n<p>I've found a solution for this is to use Presentation Tags instead of CustomDocumentProperties but the current codebase heavily relies on the later that's why I'm looking for other possibly easier alternatives.</p>\n\n<p>Also, Can we somehow disable this feature with our add-in?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553693014, "post_id": 55378123, "comment_id": 97478737, "body": "Always use <code>Option Explicit</code> and fully declare your variables. Rather than using a <code>Do</code> loop, get the row count then use a <code>FOR</code> loop. Always use qualified workbook/worksheets. When you say <code>Cells(r, 10).Value</code>, you are looking at whatever the active sheet is (which may not be the sheet you want to look at). Also, <code>If Cells(r, 10).Value = &quot;Yes&quot; Then</code> should be the first thing you do in the loop"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553693165, "post_id": 55378123, "comment_id": 97478851, "body": "I picked up most of that code from elsewhere, it&#39;s nothing that I&#39;ve ever tried before - I only want to look at the active sheets but have no idea about Option Explicit?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553693333, "post_id": 55378123, "comment_id": 97478957, "body": "<code>Option Explicit</code> forces you to declare your variables. If you don&#39;t declare a variable, in VBA, the variable is set are a variant <b><code>type</code></b>. This could give you unwanted results"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553693589, "post_id": 55378123, "comment_id": 97479109, "body": "Also, a <code>FOR </code>loop - how would I incorporate that?  Like I say, I have no idea how to go about it."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1553695415, "post_id": 55378123, "comment_id": 97480412, "body": "A simple working example has been uploaded to dropbox. please go through it. It is yet to be worked out for certain options. &lt;<a href=\"https://www.dropbox.com/s/zii6rghcc99zfqt/55378123-trying-to-import-excel-data-as-an-outlook-appointment.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/zii6rghcc99zfqt/&hellip;</a>&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553697607, "post_id": 55379823, "comment_id": 97481923, "body": "How would I get it to ignore a cell with False in?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553698229, "post_id": 55379823, "comment_id": 97482379, "body": "@ffc2004 I shall try to incorporate that situation. Which item you want to check. Is it BusyStatus."}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553698654, "post_id": 55379823, "comment_id": 97482712, "body": "In the worksheet I&#39;m trying to use it in, it&#39;s a column named &quot;Needs Chasing&quot; - I only want it to add an appointment for those that say &quot;Yes&quot;"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553700455, "post_id": 55379823, "comment_id": 97484003, "body": "@ffc2004 Please see my edit. incorporating condition of &quot;Needs Chasing&quot; column."}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553701061, "post_id": 55379823, "comment_id": 97484400, "body": "I&#39;m getting &quot;Compile Error - User-defined type not defined&quot; for the section <code>OL As Outlook.Application</code>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553701666, "post_id": 55379823, "comment_id": 97484791, "body": "@ffc2004  I think you have to add reference to Outlook Object Library. Go to VB Editor <code>Tools</code> tab . In <code>Tools</code> tab goto <code>References</code> then search for &#39;Microsoft Outlook 16.0 Object Library` or other version number as per your system and check it to select.Please note that you can add references when you come out of debugging mode. In case of difficulty try out my sample file &lt;<a href=\"https://www.dropbox.com/s/izlebd8ffmldyko/55378123-trying-to-import-excel-data-V2.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/izlebd8ffmldyko/&hellip;</a>&gt; after correcting version number of outlook library."}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553766826, "post_id": 55379823, "comment_id": 97509566, "body": "That&#39;s great, thank you. Another query I have, should you be able to help, is this - is there any way to get it to skip any appointments that have previously been added?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553775737, "post_id": 55379823, "comment_id": 97515095, "body": "@ffc2004 If my answer helped you. Please accept my answer . To accept the answer please click on the check mark beside the answer below down pointing triangle to toggle it from greyed out to filled in.. Regarding your other point I understand you want to delete the appointment.Some thing like this continued..."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553775846, "post_id": 55379823, "comment_id": 97515165, "body": "@ffc2004   somt thing like this <code>sFilter = &quot;[Start] = &#39;&quot; &amp; Format(OutlookStartTime, &quot;ddddd h:nn AMPM&quot;) &amp; _     &quot;&#39; And [End] = &#39;&quot; &amp; Format(OutlookEndTime, &quot;ddddd h:nn AMPM&quot;) &amp; &quot;&#39; &quot; &amp; _     &quot; And [Subject] = &#39;&quot; &amp; Me.AP_With_Whom &amp; &quot; - &quot; &amp; Me.AP_Type &amp; &quot;&#39;&quot;</code>     ` Set objAppointment = objAppointments.items.Find(sFilter)`     ` If Not TypeName(objAppointment) = &quot;Nothing&quot; Then`   `  objAppointment.Delete` `  End If`"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553776260, "post_id": 55379823, "comment_id": 97515441, "body": "I&#39;m not sure where I&#39;d place that code? Also it stated that  _ and ` were invalid characters, and invalid use of Me keyword"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1553776366, "post_id": 55379823, "comment_id": 97515512, "body": "@ffc2004 I am giving here a link which shall help you to place correct syntax in place.&lt;<a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/6007cd79-d17b-42d3-8c51-57c775bd3371/find-and-delete-outlook-calendar-item-using-vba?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>&gt;"}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 1, "last_activity_date": 1553700362, "last_edit_date": 1553700362, "creation_date": 1553697310, "answer_id": 55379823, "question_id": 55378123, "link": "https://stackoverflow.com/questions/55378123/create-an-outlook-appointment-if-a-cell-contains-certain-text/55379823#55379823", "title": "Create an Outlook appointment IF a cell contains certain text", "body": "<p>Sample example worksheet snapshot is appended below.\n<a href=\"https://i.stack.imgur.com/K1dJu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K1dJu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Following example code works for me .</p>\n\n<pre><code>Option Explicit    \nSub test2()\n\n        Dim OL As Outlook.Application, Appoint As Outlook.AppointmentItem, ES As Worksheet, _\n        r As Long, i As Long, WB As ThisWorkbook\n\n        Set WB = ThisWorkbook\n        Set ES = WB.Sheets(\"Sheet1\")\n        r = ES.Cells(Rows.Count, 1).End(xlUp).Row\n        Set OL = New Outlook.Application\n    For i = 2 To r\n        Set Appoint = OL.CreateItem(olAppointmentItem)\n        With Appoint\n            .Subject = ES.Cells(i, 1).Value\n            .Start = ES.Cells(i, 2).Value\n            .End = ES.Cells(i, 3).Value\n            .Location = ES.Cells(i, 4).Value\n            .AllDayEvent = ES.Cells(i, 5).Value\n            .Categories = ES.Cells(i, 6).Value &amp; \" Category\"\n            .BusyStatus = ES.Cells(i, 7).Value\n            .ReminderSet = True\n            .ReminderMinutesBeforeStart = 60\n            .Body = ES.Cells(i, 8).Value\n            .Save\n        End With\n    Next i\n     Set OL = Nothing\n\n    End Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Based on OP's comments , putting \"Needs Chasing\" in <code>Column10</code> . Revised code works out as follows.</p>\n\n<pre><code>Sub test3()\n\n    Dim OL As Outlook.Application, Appoint As Outlook.AppointmentItem, ES As Worksheet, _\n    r As Long, i As Long, WB As ThisWorkbook\n\n    Set WB = ThisWorkbook\n    Set ES = WB.Sheets(\"Sheet1\")\n    r = ES.Cells(Rows.Count, 1).End(xlUp).Row\n    Set OL = New Outlook.Application\nFor i = 2 To r\n    If ES.Cells(i, 10) = \"Yes\" Then\n    Set Appoint = OL.CreateItem(olAppointmentItem)\n    With Appoint\n        .Subject = ES.Cells(i, 1).Value\n        .Start = ES.Cells(i, 2).Value\n        .End = ES.Cells(i, 3).Value\n        .Location = ES.Cells(i, 4).Value\n        .AllDayEvent = ES.Cells(i, 5).Value\n        .Categories = ES.Cells(i, 6).Value &amp; \" Category\"\n        .BusyStatus = ES.Cells(i, 7).Value\n        .ReminderSet = True\n        .ReminderMinutesBeforeStart = 60\n        .Body = ES.Cells(i, 8).Value\n        .Save\n    End With\n    End If\nNext i\n Set OL = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1559622231, "creation_date": 1559622231, "answer_id": 56437327, "question_id": 55378123, "link": "https://stackoverflow.com/questions/55378123/create-an-outlook-appointment-if-a-cell-contains-certain-text/56437327#56437327", "title": "Create an Outlook appointment IF a cell contains certain text", "body": "<p>How about this?</p>\n\n<pre><code>Sub AppointmentAutomation()\n\n    Dim OutApp As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    Dim oAppt As AppointmentItem\n    Dim oPattern As RecurrencePattern\n    Set oAppt = OutApp.CreateItem(olAppointmentItem)\n    Set oPattern = oAppt.GetRecurrencePattern\n    With oPattern\n        .RecurrenceType = olRecursWeekly\n        .DayOfWeekMask = olMonday\n        .PatternStartDate = Worksheets(\"Sheet1\").Range(\"A2\")\n        .PatternEndDate = Worksheets(\"Sheet1\").Range(\"B2\")\n        .Duration = 60\n        .StartTime = Worksheets(\"Sheet1\").Range(\"C2\")\n        .EndTime = Worksheets(\"Sheet1\").Range(\"D2\")\n    End With\n    oAppt.Subject = Worksheets(\"Sheet1\").Range(\"E2\")\n    oAppt.Save\n    oAppt.Display\n\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/k4reZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k4reZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 55379823, "answer_count": 2, "score": 0, "last_activity_date": 1562460925, "creation_date": 1553692480, "last_edit_date": 1562460925, "question_id": 55378123, "link": "https://stackoverflow.com/questions/55378123/create-an-outlook-appointment-if-a-cell-contains-certain-text", "title": "Create an Outlook appointment IF a cell contains certain text", "body": "<p>I'm trying to create a new Outlook appointment with Excel data, if a cell contains the word \"Yes\".</p>\n\n<pre><code>Sub AddAppointments()\n\n' Create the Outlook session\nSet myOutlook = CreateObject(\"Outlook.Application\")\n\n' Start at row 4    \nr = 4\n\nDo Until Trim(Cells(r, 1).Value) = \"\"\n\n    ' Create the AppointmentItem\n    Set myApt = myOutlook.CreateItem(1)\n\n    ' Set the appointment properties\n    myApt.Subject = Cells(r, 3).Value\n    myApt.Start = Cells(r, 7) + Cells(r, 8).Value\n\n    If Trim(Cells(r, 5).Value) = \"\" Then\n        myApt.BusyStatus = 2\n    Else\n        myApt.BusyStatus = Cells(r, 5).Value\n    End If\n\n    If Cells(r, 10).Value = \"Yes\" Then\n        myApt.ReminderSet = True\n    Else\n        myApt.ReminderSet = False\n    End If\n\n    myApt.Body = \"\u00a3\" &amp; Cells(r, 6).Value\n        myApt.Save\n        r = r + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>If the cell contains \"No\", or \"N/A\" it stops. I would like it to ignore those.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553692204, "post_id": 55377999, "comment_id": 97478141, "body": "Hi, welcome to SO. What have you tried so far? Post your code here so that we can help"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1553693566, "post_id": 55378298, "comment_id": 97479095, "body": "Hi Scott. Thanks for the TEXTJOIN UDF. I tried it now. Unfortunately, it returns values from Data1 column. However, i am looking to match on Data1 but return values from Data2. For, example, your formula returns - &quot;Very blue sky.,Blue sky forever.&quot; whereas the answer i want is &quot;Sky1,Sky3&quot;"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1553693669, "last_edit_date": 1553693669, "creation_date": 1553693017, "answer_id": 55378298, "question_id": 55377999, "link": "https://stackoverflow.com/questions/55377999/excel-udf-vlookup-with-partial-match-and-concatenate-results-in-single-cell/55378298#55378298", "title": "Excel UDF - VLOOKUP with partial match and concatenate results in single cell", "body": "<p>If you have Office 365 Excel then you can use TEXTJOIN as an Array Formula:</p>\n\n<pre><code> =TEXTJOIN(\",\",TRUE,IF(ISNUMBER(SEARCH(D2,$A$2:$A$6)),$B$2:$B$6,\"\"))\n</code></pre>\n\n<p>Being an array formula it needs to be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode. </p>\n\n<hr>\n\n<p>If you do not have Office 365 then put this code in a Module and then use the formula as described above:</p>\n\n<pre><code>Function TEXTJOIN(delim As String, skipblank As Boolean, arr)\n    Dim d As Long\n    Dim c As Long\n    Dim arr2()\n    Dim t As Long, y As Long\n    t = -1\n    y = -1\n    If TypeName(arr) = \"Range\" Then\n        arr2 = arr.Value\n    Else\n        arr2 = arr\n    End If\n    On Error Resume Next\n    t = UBound(arr2, 2)\n    y = UBound(arr2, 1)\n    On Error GoTo 0\n\n    If t &gt;= 0 And y &gt;= 0 Then\n        For c = LBound(arr2, 1) To UBound(arr2, 1)\n            For d = LBound(arr2, 1) To UBound(arr2, 2)\n                If arr2(c, d) &lt;&gt; \"\" Or Not skipblank Then\n                    TEXTJOIN = TEXTJOIN &amp; arr2(c, d) &amp; delim\n                End If\n            Next d\n        Next c\n    Else\n        For c = LBound(arr2) To UBound(arr2)\n            If arr2(c) &lt;&gt; \"\" Or Not skipblank Then\n                TEXTJOIN = TEXTJOIN &amp; arr2(c) &amp; delim\n            End If\n        Next c\n    End If\n    TEXTJOIN = Left(TEXTJOIN, Len(TEXTJOIN) - Len(delim))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 55378298, "answer_count": 1, "score": 0, "last_activity_date": 1553693748, "creation_date": 1553692069, "last_edit_date": 1553693748, "question_id": 55377999, "link": "https://stackoverflow.com/questions/55377999/excel-udf-vlookup-with-partial-match-and-concatenate-results-in-single-cell", "title": "Excel UDF - VLOOKUP with partial match and concatenate results in single cell", "body": "<p>I have 2 column data and a third column of query terms. The query terms have a partial but exact match in column1 of data (\"Data1\"). I want to find all matches for the query term in \"Data1\" column and return comma separated values from \"Data2\" column.</p>\n\n<p>Please see the image.</p>\n\n<p>There is already a UDF for similar problem on this site but that doesnt quite do what i want.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/46901262/excel-return-multiple-matches-in-a-single-cell-while-doing-a-partial-match/55372713#55372713\">Excel: Return multiple matches in a single cell while doing a partial match</a></p>\n\n<p>Thank you so much for your help. Best Wishes Manoj<a href=\"https://i.stack.imgur.com/bTKsx.png\" rel=\"nofollow noreferrer\">Data Image</a></p>\n\n<p>I have tried this UDF:</p>\n\n<pre><code>Public Function ConcatPartLookUp(rngInput As Range, rngSource As Range, Optional strDelimiter As String, Optional blCaseSensitive)\nDim rng As Range\n\nIf strDelimiter = \"\" Then strDelimiter = \"|\"\nIf IsMissing(blCaseSensitive) Then\n    blCaseSensitive = False\nElse\n    blCaseSensitive = True\nEnd If\n\nFor Each rng In rngSource\n    If blCaseSensitive Then\n        If InStr(1, rng.Value, rngInput.Value, vbBinaryCompare) &gt; 0 Then ConcatPartLookUp = ConcatPartLookUp &amp; strDelimiter &amp; rng.Value\n    Else\n        If InStr(1, rng.Value, rngInput.Value, vbTextCompare) &gt; 0 Then ConcatPartLookUp = ConcatPartLookUp &amp; strDelimiter &amp; rng.Value\n    End If\nNext\n\nIf Len(ConcatPartLookUp) &gt; 0 Then ConcatPartLookUp = Mid(ConcatPartLookUp, 2, Len(ConcatPartLookUp))\n\nEnd Function\n</code></pre>\n\n<p>This code will return matches from \"Data1\" column (Very blue sky.|Blue sky forever.). I am looking to match on Data1 but return values from Data2.\nThanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1553691502, "post_id": 55377723, "comment_id": 97477629, "body": "I believe that is using the alphabet... b comes after a, so <code>b&gt;a</code> even thought <code>aaaaa</code>could seem greater than <code>b</code>, <code>b</code> stills comes after <code>a</code>. Look at it af it were car plates,  <code>A1000</code> is older than <code>B0001</code> so older means lower and newer means bigger. At least this is what I get from the tests."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1553691794, "post_id": 55377723, "comment_id": 97477837, "body": "Are you actually trying to accomplish something here?  There are better ways to compare strings."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 11090784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0af3ff8547b4ca3a21e8ff7af8961fc?s=128&d=identicon&r=PG", "display_name": "Sirch", "link": "https://stackoverflow.com/users/11090784/sirch"}, "edited": false, "score": 0, "creation_date": 1553692312, "post_id": 55377836, "comment_id": 97478218, "body": "Thank you! The other question you linked was helpful."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 1, "last_activity_date": 1553691585, "creation_date": 1553691585, "answer_id": 55377836, "question_id": 55377723, "link": "https://stackoverflow.com/questions/55377723/how-does-excel-compare-strings-using-less-than-and-greater-than/55377836#55377836", "title": "How does Excel compare strings using less than and greater than?", "body": "<p>It's done following alphabetic ordering, you can see this by putting all mentioned strings within one column and sort that column Z->A, you'll end up with following order:</p>\n\n<pre><code>faf\nbbb\nbab\naaf\naab\n</code></pre>\n\n<p>Which corresponds to your findings.</p>\n"}], "owner": {"reputation": 185, "user_id": 11090784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0af3ff8547b4ca3a21e8ff7af8961fc?s=128&d=identicon&r=PG", "display_name": "Sirch", "link": "https://stackoverflow.com/users/11090784/sirch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 0, "closed_date": 1553691937, "accepted_answer_id": 55377836, "answer_count": 1, "score": 0, "last_activity_date": 1553691847, "creation_date": 1553691267, "last_edit_date": 1553691847, "question_id": 55377723, "link": "https://stackoverflow.com/questions/55377723/how-does-excel-compare-strings-using-less-than-and-greater-than", "closed_reason": "Duplicate", "title": "How does Excel compare strings using less than and greater than?", "body": "<p>In Excel it is possible to do comparisons between non-numeric cells with <code>&lt;</code> and <code>&gt;</code>. Any string is handled as greater than any numeric input, such as <code>=\"string\"&gt;1000</code> evaluating to <code>TRUE</code>. Additionally <code>TRUE</code>and <code>FALSE</code> are evaluated as greater than any string or numeric input. For instance, both <code>=FALSE&gt;\"string\"</code> and <code>TRUE&gt;\"string\"</code> evaluate as <code>TRUE</code>. </p>\n\n<p>This also works for comparing two strings, which appears to be connected to character codes, but I can't figure out exactly how. For instance, <code>=\"bbb\"&gt;\"aab\"</code> and <code>=\"bbb\"&gt;\"bab\"</code> both evaluate to <code>TRUE</code>, but <code>=\"bbb\"&gt;\"aaf\"</code> evaluates to <code>TRUE</code>  while <code>=\"bbb\"&gt;\"faf\"</code> evaluates to <code>FALSE</code>. Initially I thought that each character's code was being compared, but the last formula seems to suggest that this is incorrect.</p>\n\n<p>I would appreciate if someone could help me to understand what calculations are happening here. Thank you!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1553691785, "post_id": 55377774, "comment_id": 97477835, "body": "I recommend always to activate <code>Option Explicit</code> and declare all variables properly: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>. \u2022 Here it should be <code>Dim LCol As Long, i As Long, LRow As Long</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553691866, "post_id": 55377774, "comment_id": 97477896, "body": "Plus1: a lot of people don&#39;t remember the <code>Step -1</code> part of <code>FOR</code> :). I would however suggest to have the <code>Worksheet</code> object passed to the UDF that way it becomes dynamic"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1553692482, "post_id": 55377774, "comment_id": 97478341, "body": "<code>Step - 1</code> saves you from a lot of headaches if you want to delete any list of objects. Very useful indeed. It does not appear OP made a <code>UDF</code> but I would agree."}, {"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "edited": false, "score": 1, "creation_date": 1553692552, "post_id": 55377774, "comment_id": 97478394, "body": "thank you Tim, its working but if the rows has values in few top and bottom rows its not deleting. there are total 200 rows but some of the columns has blank cells in between, i would like to delete those columns"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "edited": false, "score": 0, "creation_date": 1553692755, "post_id": 55377774, "comment_id": 97478549, "body": "@sunil replace <code>LRow = .Cells(.Rows.Count, i).End(xlUp).Row</code> with <code>LRow = Application.WorksheetFunction.CountA(.Columns(i))</code> if you want to count only cells that contain data."}, {"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "edited": false, "score": 1, "creation_date": 1553693711, "post_id": 55377774, "comment_id": 97479180, "body": "Hey Tim and Peh you both are great, its working perfectly, you guys saved my time, than you again"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1553693808, "post_id": 55377774, "comment_id": 97479247, "body": "Glad to have helped"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 2, "last_activity_date": 1553692899, "last_edit_date": 1553692899, "creation_date": 1553691427, "answer_id": 55377774, "question_id": 55377591, "link": "https://stackoverflow.com/questions/55377591/want-to-delete-entire-column-if-it-has-30-rows/55377774#55377774", "title": "Want to delete entire column if it has &lt;30 rows", "body": "<p>Try</p>\n\n<pre><code>Sub Delete_EntireColumn()\nDim LCol as Long, LRow as Long, i as Long\n\nWith Workbooks(REF).Sheets(REF)\n\n    LCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    For i = LCol To 1 Step - 1\n        LRow = .Cells(.Rows.Count, i).End(xlUp).Row\n        If LRow &lt; 30 Then\n            .Columns(i).EntireColumn.Delete\n        End If\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>In case the rows are not consecutively filled:</p>\n\n<pre><code>Sub Delete_EntireColumn()\nDim LCol as Long, LRow as Long, i as Long\n\nWith Workbooks(REF).Sheets(REF)\n\n    LCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    For i = LCol To 1 Step - 1\n        LRow = Application.WorksheetFunction.CountA(.Columns(i))\n        If LRow &lt; 30 Then\n            .Columns(i).EntireColumn.Delete\n        End If\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55377774, "answer_count": 1, "score": 1, "last_activity_date": 1553693349, "creation_date": 1553690881, "last_edit_date": 1553691619, "question_id": 55377591, "link": "https://stackoverflow.com/questions/55377591/want-to-delete-entire-column-if-it-has-30-rows", "title": "Want to delete entire column if it has &lt;30 rows", "body": "<p>I have multiple columns and multiple rows (>200 rows). i would like to delete entire column if any of the column has &lt;30 rows data. Please help</p>\n\n<pre><code>Sub Delete_EntireColumn()\nDim iCntr\n    For iCntr = 1 To 10 Step 1\n        Columns(1).EntireColumn.Delete\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1553693353, "post_id": 55377984, "comment_id": 97478963, "body": "Gustav, strFile = strPath2 &amp; strFile is what I tried &amp; fails.  The trailing backslash would be necessary in strPath2,"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1553698443, "post_id": 55377984, "comment_id": 97482544, "body": "Yes, that will fail. Just replace <code>strPath</code> with <code>strPath2</code> - see extended answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1553698382, "last_edit_date": 1553698382, "creation_date": 1553692037, "answer_id": 55377984, "question_id": 55377043, "link": "https://stackoverflow.com/questions/55377043/msaccess-select-into-for-csv-file-in-a-different-path/55377984#55377984", "title": "MSAccess: Select * Into for CSV file in a different Path", "body": "<p><code>CurrentProject.Path</code> does not have a trailing backslash, so try with:</p>\n\n<pre><code>strPath2 = CurrentProject.Path &amp; \"\\Backend_Data\"\n\nstrSQL = \"SELECT * INTO TempItem FROM [Text;HDR=NO;FMT=Delimited(,);Database=\" &amp; strPath2 &amp; \"].[\" &amp; strFile &amp; \"];\"\ndb.Execute (strSQL)\n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553698382, "creation_date": 1553689163, "last_edit_date": 1553690073, "question_id": 55377043, "link": "https://stackoverflow.com/questions/55377043/msaccess-select-into-for-csv-file-in-a-different-path", "title": "MSAccess: Select * Into for CSV file in a different Path", "body": "<p>I need to copy CSV data into an Access table.  TransferText works as expected, but is much slower than \"Select * Into\".  500K records, 43 columns (not my data).</p>\n\n<p>The following works as needed, but only when the CSV file resides on the same Path as the database (strPath, in this case).</p>\n\n<pre><code>strFile = \"testfile.csv\"\nstrPath = CurrentProject.Path\nstrPath2 = CurrentProject.Path &amp; \"\\Backend_Data\\\"\n\nstrSQL = \"SELECT * INTO TempItem FROM [Text;HDR=NO;FMT=Delimited(,);Database=\" &amp; strPath &amp; \"].[\" &amp; strFile &amp; \"];\"\ndb.Execute (strSQL)\n</code></pre>\n\n<p>The CSV file will be landing in strPath2 (\\Backend_Data).  Adding strPath2 to strSQL above, in front of strFile, does not work or complain.</p>\n\n<p>Is this a SQL syntax issue, or do I just need to keep the CSV File in the same Path as the database?</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "yahoo-finance", "queryselector"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 0, "creation_date": 1553691368, "post_id": 55377588, "comment_id": 97477529, "body": "Thank you so much for helping me! As a total beginner, I thought it definitely needed complicated tools for extracting these numbers. Could you tell me how you got the order number of &lt;table&gt; tag and &lt;tr&gt;? Did you just count it or is there any tool for that?"}, {"owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 0, "creation_date": 1553750819, "post_id": 55377588, "comment_id": 97502455, "body": "Thank you so much for the added code and explanation! Your answer helped me a lot though I think I should study it more deeply to understand new concepts and terms:)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1553695891, "last_edit_date": 1553695891, "creation_date": 1553690877, "answer_id": 55377588, "question_id": 55376854, "link": "https://stackoverflow.com/questions/55376854/vba-data-reactid-for-yahoo-finances-financial-numbers/55377588#55377588", "title": "VBA data-reactid for Yahoo Finance&#39;s financial numbers", "body": "<p><code>getElementById</code> returns a single node so you wouldn't index into it as you are doing. There is no method <code>getElementsById</code> so that should fail with an error.</p>\n\n<p>You could use the class and escape the special characters and index into returned collection</p>\n\n<pre><code>MsgBox HTMLDoc.querySelectorAll(\".Bdbw\\(0px\\)\\!\")(1).innerText\n</code></pre>\n\n<p>Or pass the compound class to <code>getElementsByClassName</code>:</p>\n\n<pre><code>MsgBox HTMLDoc.getElementsByClassName(\"Bdbw(0px)! H(36px)\")(1).innerText\n</code></pre>\n\n<p>The <strong>attribute</strong>  (not id) <code>data-reactid</code> can vary between page and output (as it does in this case - the id is 113 for the row in the output. In this instance it may be safer to use table and row indices</p>\n\n<pre><code>MsgBox HTMLDoc.getElementsByTagName(\"table\")(2).getElementsByTagName(\"tr\")(9).innerText\n</code></pre>\n\n<p>If you want column by column for that row:</p>\n\n<pre><code>Dim td As Object, tds As Object\nSet tds = HTMLDoc.getElementsByTagName(\"table\")(2).getElementsByTagName(\"tr\")(9).getElementsByTagName(\"td\")\nFor Each td In tds\n    Debug.Print td.innerText\nNext\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>Dim td As Object, tds As Object\nSet tds = HTMLDoc.getElementsByClassName(\"Bdbw(0px)! H(36px)\")(1).getElementsByTagName(\"td\")\nFor Each td In tds\n    Debug.Print td.innerText\nNext\n</code></pre>\n\n<p>As I said, the data-reactid can flex but if you want to know how to apply an attribute selector for this, see:</p>\n\n<pre><code>MsgBox HTMLDoc.querySelector(\"tr[data-reactid='113']\").innerText\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553695781, "post_id": 55378368, "comment_id": 97480676, "body": "\ud83d\udc40  parentnode.parentnode +"}, {"owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 0, "creation_date": 1553751012, "post_id": 55378368, "comment_id": 97502518, "body": "I really appreciate your answer for the proper loop as a solution:) I will study it hard:))"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 1, "creation_date": 1553959215, "post_id": 55378368, "comment_id": 97583379, "body": "The code is working the way it should be. I just tested right now @BangolPhoenix."}, {"owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 0, "creation_date": 1555079659, "post_id": 55378368, "comment_id": 97996704, "body": "@SIM Sorry I just found a way to check it and thank you so much for your code!; I think I didn&#39;t import reference modules when it didn&#39;t run and didn&#39;t know how to turn on debug window"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 2, "last_activity_date": 1553693224, "creation_date": 1553693224, "answer_id": 55378368, "question_id": 55376854, "link": "https://stackoverflow.com/questions/55376854/vba-data-reactid-for-yahoo-finances-financial-numbers/55378368#55378368", "title": "VBA data-reactid for Yahoo Finance&#39;s financial numbers", "body": "<p>You can try the following to play safe. Once the <code>for loop</code> gets the required node, it will fetch you the desired content and exit the loop.</p>\n\n<pre><code>Sub FetchFinanceInfo()\n    Dim XMLReq As New XMLHTTP60, HTMLDoc As New HTMLDocument\n    Dim post As Object, I&amp;\n\n    XMLReq.Open \"GET\", \"https://finance.yahoo.com/quote/BABA/cash-flow?p=BABA\", False\n    XMLReq.send\n    HTMLDoc.body.innerHTML = XMLReq.responseText\n\n    For Each post In HTMLDoc.getElementsByTagName(\"span\")\n        If InStr(post.innerText, \"From Operating Activities\") &gt; 0 Then\n            With post.ParentNode.ParentNode.getElementsByTagName(\"td\")\n                For I = 1 To .Length - 1\n                    Debug.Print .Item(I).innerText\n                Next I\n            End With\n            Exit For\n        End If\n    Next post\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 55377588, "answer_count": 2, "score": -1, "last_activity_date": 1561365443, "creation_date": 1553688563, "last_edit_date": 1561365443, "question_id": 55376854, "link": "https://stackoverflow.com/questions/55376854/vba-data-reactid-for-yahoo-finances-financial-numbers", "title": "VBA data-reactid for Yahoo Finance&#39;s financial numbers", "body": "<p>I googled data-reactid and it seems it won't work with VBA in most cases. </p>\n\n<p>But I still think there maybe a possibility to get an answer. \nI want to get numbers in \"<strong>Total Cash Flow From Operating Activities</strong>\"</p>\n\n<p><a href=\"http://Total%20Cash%20Flow%20From%20Operating%20Activities%20From%20Yahoo%20Finance\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/BABA/cash-flow?p=BABA</a></p>\n\n<pre><code>Sub YFinance()\n\n    Dim XMLReq As New MSXML2.XMLHTTP60\n    Dim HTMLDoc As New MSHTML.HTMLDocument\n    Dim i As Integer\n    Dim strUrl As String\n\n\n\n    XMLReq.Open \"GET\", \"https://finance.yahoo.com/quote/BABA/cash-flow?p=BABA\", False\n    XMLReq.send\n\n    If XMLReq.Status &lt;&gt; 200 Then\n        MsgBox \"Error!\"\n        Exit Sub\n    End If\n\n    HTMLDoc.body.innerHTML = XMLReq.responseText\n\n    Set XMLReq = Nothing\n\n    MsgBox HTMLDoc.getElementsById(\"Bdbw(0px)! H(36px)\")(0).innerText\n\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "compare", "msgbox"], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1553688440, "creation_date": 1553688440, "answer_id": 55376818, "question_id": 55376736, "link": "https://stackoverflow.com/questions/55376736/excel-vba-if-statement-for-msgbox-range1range2range3-then/55376818#55376818", "title": "Excel VBA IF statement for Msgbox (range1&lt;&gt;range2+range3) then", "body": "<p>This is it:</p>\n\n<pre><code>Option Explicit\nSub Warning()\n\n    Dim A As Long, B As Long, C As Long 'in case you have floating numbers use Single or Double instead\n\n    With ThisWorkbook.Sheets(\"NameOfYourSheet\")\n        A = .Cells(.Rows.Count, \"A\").End(xlUp)\n        B = .Cells(.Rows.Count, \"B\").End(xlUp)\n        C = .Cells(.Rows.Count, \"C\").End(xlUp)\n    End With\n\n    If B + C &lt;&gt; A Then\n        MsgBox \"Error, wrong number of sent goods\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I'm assuming you are trying the last row of every column.</p>\n"}], "owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55376818, "answer_count": 1, "score": 0, "last_activity_date": 1553688440, "creation_date": 1553688189, "question_id": 55376736, "link": "https://stackoverflow.com/questions/55376736/excel-vba-if-statement-for-msgbox-range1range2range3-then", "title": "Excel VBA IF statement for Msgbox (range1&lt;&gt;range2+range3) then", "body": "<p>VBA noob here,</p>\n\n<p>So i have 3 Columns (A,B and C)</p>\n\n<pre><code>A = Received Goods\nB = Sent Goods for Shop 1\nC = Sent Goods for Shop 2\n</code></pre>\n\n<p>I want values cells in  <strong>B</strong>+<strong>C</strong> = <strong>A</strong>  otherwise give me an error message.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>If Range(\"A1\").End(xlDown).Value &lt;&gt; Range(\"B1\").End(xlDown).Value &amp; Range(\"C1\").End(xlDown).Value Then\nMsgBox \"Error, wrong number of sent goods\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1553688625, "post_id": 55376717, "comment_id": 97475752, "body": "Excel formulas cannot return nothing. <code>0</code> and <code>&quot;&quot;</code> are common things to return, and in case of a <code>0</code> you would <a href=\"https://stackoverflow.com/q/32169958/11683\">hide it with cell formatting</a>. Is your problem that you don&#39;t know <a href=\"https://stackoverflow.com/q/9024724/11683\">how to put <code>&quot;&quot;</code> into a string literal</a>?"}, {"owner": {"reputation": 7, "user_id": 9494038, "user_type": "registered", "profile_image": "https://graph.facebook.com/2055095247853351/picture?type=large", "display_name": "Eraaz", "link": "https://stackoverflow.com/users/9494038/eraaz"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1553688908, "post_id": 55376717, "comment_id": 97475910, "body": "Thats exactly what I wanted. Feel idiot to not tried it before. Thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 9494038, "user_type": "registered", "profile_image": "https://graph.facebook.com/2055095247853351/picture?type=large", "display_name": "Eraaz", "link": "https://stackoverflow.com/users/9494038/eraaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1553688963, "creation_date": 1553688963, "answer_id": 55376988, "question_id": 55376717, "link": "https://stackoverflow.com/questions/55376717/return-nothing-in-vba-fomula/55376988#55376988", "title": "Return nothing in VBA fomula", "body": "<p>So thanks to GSerg. The correct way was.</p>\n\n<pre><code> tbl.DataBodyRange(1, 5).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE))),\"\"\"\", VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE))\"\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9494038, "user_type": "registered", "profile_image": "https://graph.facebook.com/2055095247853351/picture?type=large", "display_name": "Eraaz", "link": "https://stackoverflow.com/users/9494038/eraaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553688963, "creation_date": 1553688114, "last_edit_date": 1553688551, "question_id": 55376717, "link": "https://stackoverflow.com/questions/55376717/return-nothing-in-vba-fomula", "title": "Return nothing in VBA fomula", "body": "<p>I have an Excel formula set up from VBA with a <code>IF</code> condition and I want it to return nothing if it's true.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Set tbl = .ListObjects(\"Tableau4\")\n\nvCherchee = tbl.DataBodyRange(1, 1)\n\n.PivotTables(\"Tab1\").TableRange1.Select\nmatrice = Selection.Address(ReferenceStyle:=xlA1, RowAbsolute:=True, ColumnAbsolute:=False)\n\ntbl.DataBodyRange(1, 3).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",3,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",3,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",3,FALSE))\"\ntbl.DataBodyRange(1, 4).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",4,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",4,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",4,FALSE))\"\ntbl.DataBodyRange(1, 5).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",5,FALSE))\"\ntbl.DataBodyRange(1, 6).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",6,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",6,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",6,FALSE))\"\ntbl.DataBodyRange(1, 7).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",7,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",7,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",7,FALSE))\"\ntbl.DataBodyRange(1, 8).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",8,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",8,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",8,FALSE))\"\ntbl.DataBodyRange(1, 9).Formula = \"=IF(OR(ISNA(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",9,FALSE)), ISBLANK(VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",9,FALSE))),1, VLOOKUP([@[Code Frns]],\" &amp; matrice &amp; \",9,FALSE))\"\n</code></pre>\n\n<p>Actually it returns 1, but if I don't put anything, it returns 0 and if I put <code>\"\"</code> it gives me an error. How can I do this? Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553689761, "post_id": 55376594, "comment_id": 97476470, "body": "You need to <code>Set CellsRange = Selection</code> and then loop through all the selected cells <code>For Each C in CellsRange</code> using the <code>Cells(C.Row, &quot;YourColumn&quot;)</code>for example."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553692492, "post_id": 55376594, "comment_id": 97478349, "body": "Have a look at <code>Intersect</code>"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1553697466, "post_id": 55376594, "comment_id": 97481799, "body": "What is the context of this code? I would like to see the beginning and the end of the Sub. Is it called by pressing a hotkey, as a response to selecting cells, or called by another Sub?"}, {"owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1553698597, "post_id": 55376594, "comment_id": 97482662, "body": "@z32a7ul there are 2 subs(1 for each button). this is the second button. context: the first button automatically ticks the respective box if the number is positive. it will also register the date it was ticked and ask + register the collab&#39;s number to identify the responsible for the act in case it becomes necessary to know. all of this must happen in dozens of cells and all this info is gathered horizontally. this second button is used for when a negative number turns positive, but since it was negative before, the first button didnt register it, thats where the second one comes in."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "is_accepted": false, "score": 0, "last_activity_date": 1553700152, "last_edit_date": 1553700152, "creation_date": 1553696941, "answer_id": 55379705, "question_id": 55376594, "link": "https://stackoverflow.com/questions/55376594/how-do-i-apply-this-code-to-multiple-cells/55379705#55379705", "title": "How do i apply this code to multiple cells?", "body": "<p>This is the answer i was able to pull through, it may not be the most effective but it does its job.\n(i have to apply this to each line, pretty painful if there are dozens/hundreds of lines</p>\n\n<pre><code>If cel.Value = Range(\"H3\") 0 Then                                                                                                                                                                                                                                                                                                                                                                                                                                                         'What's up? nice, you found me. yeah it was the intern. so many \"if\" statements for no reason? i like the extra work :D\n    If Range(\"l3\").Value = \"\" Then\n       Range(\"bk3\").Value = True\n       Range(\"l3\").Value = Now\n       If MsgBox(\"Do you want to sign?\", vbYesNo, \"Signature Confirmation\") = vbYes Then  '&lt;---- Confirmation Pop-Up\n          VarNUMCB = InputBox(\"Place Collab. Number\") '&lt;---- Collab. Numb.Pop-Up\n       Else\n       End If\n\n          If Range(\"h3\").Value &lt;= 0 Then\n             Range(\"j3\").Value = Range(\"j3\").Value &amp; \" | \" &amp; VarNUMCB\n          Else\n          End If\n\n    Else\n    End If\n\n  Else\n  End If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553700152, "creation_date": 1553687700, "question_id": 55376594, "link": "https://stackoverflow.com/questions/55376594/how-do-i-apply-this-code-to-multiple-cells", "title": "How do i apply this code to multiple cells?", "body": "<p>I made a code that lets me modify a specific cell's information from other cells as long as it's selected, but i needed to be able to select multiple cells.</p>\n\n<p>i've tried multiplying the below code but with h4,h5,h6,etc instead of h3 and doesn't work. it instead completely disables the code, even the already functioning part and i have to restart excel.</p>\n\n<pre><code>With Selection\n\n\nIf Selection.Value = Range(\"h3\") Then\n   Range(\"bk3\").Value = True\n   Range(\"l3\").Value = Now\n   If MsgBox(\"Do you want to sign?\", vbYesNo, \"Signature Confirmation\") = vbYes Then  '&lt;---- Confirmation Pop-Up\n    VarNUMCB = InputBox(\"Type Collab. Number\") '&lt;---- Collab. Number Pop-Up.\n    Range(\"j3\").Value = Range(\"j3\").Value &amp; \" | \" &amp; VarNUMCB\n   Else\n   End If\nElse\n   Range(\"bk3\").Value = False\n\nEnd If\n\nEnd with\n</code></pre>\n\n<p>note: i don't want the changes to be made on l3,j3 and bk3 from any selected cell. each cell should be linked to its own line(horizontal) and selecting multiple cells from the H column should properly fill the rest of the linked information.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1553687063, "post_id": 55376310, "comment_id": 97474797, "body": "Works fine for me. You will get a <code>0</code> if the cell has a <code>0</code> else you will get a &quot;blank value&quot;"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553687168, "post_id": 55376310, "comment_id": 97474866, "body": "What happens if you actually try that formula directly in a cell?"}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553688145, "post_id": 55376310, "comment_id": 97475467, "body": "@Zac if works by using it directly in the cell, but I cannot. The client uses an userform to complete the empty data after the VLOOKUP, this is why I used it in VBA, because after I copy paste it to remove the formula"}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1553688339, "post_id": 55376561, "comment_id": 97475591, "body": "In excel, TRUE and FALSE are treated as 1 and 0 respectively.  I use 1 and 0 for the true false portion VLOOKUP/HLOOKUP all the time without issue."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1553687925, "last_edit_date": 1553687925, "creation_date": 1553687599, "answer_id": 55376561, "question_id": 55376310, "link": "https://stackoverflow.com/questions/55376310/delete-n-a-when-using-vlookup/55376561#55376561", "title": "Delete N/A when using VLOOKUP", "body": "<ul>\n<li>You could use <em>=<strong>IFNA</em></strong> instead of <em>=<strong>IFERROR</em></strong> because the code in case of error generate <strong>#N/A</strong> error.</li>\n<li>Lastly, in your formula after the number of column you want to return (in your case column number 3) you use number <strong>0</strong> instead of <strong>TRUE</strong> or <strong>FALSE</strong>.</li>\n</ul>\n\n<p>The below code is not the answer but a sample of the formula.</p>\n\n<p><strong>Code Sample:</strong></p>\n\n<pre><code>=IFNA(VLOOKUP(A2,$D$1:$E$2,2,FALSE),\"\") 'In excel\n\n.FormulaR1C1 = \"=VLOOKUP(RC[-1],R1C4:R2C5,2,FALSE)\" 'In VBA\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553691499, "creation_date": 1553686788, "last_edit_date": 1553691499, "question_id": 55376310, "link": "https://stackoverflow.com/questions/55376310/delete-n-a-when-using-vlookup", "title": "Delete N/A when using VLOOKUP", "body": "<p>I'm trying to bring the values from Sheet2 to Sheet1 using VLOOKUP formula (in VBA, after using the formula I copy paste in order to just see the value). But when the cells from Sheet2 are empty I get the \"#N/A\", which I don't want. What can I do to get the cell empty if there isn't any value, like replace the #N/A with nothing.</p>\n\n<p>I have tried using the IFERROR formula, but I get 0 instead of nothing.</p>\n\n<pre><code>comm.Range(.Cells(2, \"C\"), .Cells(lr, \"C\")).FormulaR1C1 = \"=IFERROR(VLOOKUP(RC[-2],Sheet2!C[-2]:C[22],3,0),\"\"\"\")\"\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 0, "last_activity_date": 1553686407, "creation_date": 1553686407, "answer_id": 55376203, "question_id": 55375944, "link": "https://stackoverflow.com/questions/55375944/word-vba-will-not-accept-wdcell-as-a-valid-unit-to-move/55376203#55376203", "title": "Word VBA will not accept wdCell as a valid unit to move", "body": "<p>For some reason, you cannot use <code>wdCell</code> as a parameter to <code>Move*</code>, which does not appear to be a documented fact.</p>\n\n<p>One workaround would be to jump to the end of the cell and then move one line down:</p>\n\n<pre><code>With Selection\n    .MoveEnd wdCell\n    .MoveDown wdLine, Count:=1\n    .Expand wdCell\nEnd With\n</code></pre>\n\n<p>Another workaround would be to <a href=\"https://stackoverflow.com/a/14327376/11683\">locate yourself in the table</a> and jump to the next cell by index:</p>\n\n<pre><code>With Selection\n    Dim r As Long, c As Long\n    r = .Rows(1).Index\n    c = .Columns(1).Index\n\n    If .Rows(1).Parent.Rows.Count &gt;= r + 1 Then\n        .Rows(1).Parent.Rows(r + 1).Cells(c).Range.Select\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10998738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97bd24229bd45aa9924f86f48761189?s=128&d=identicon&r=PG&f=1", "display_name": "Hany E", "link": "https://stackoverflow.com/users/10998738/hany-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553721793, "creation_date": 1553685581, "last_edit_date": 1553721793, "question_id": 55375944, "link": "https://stackoverflow.com/questions/55375944/word-vba-will-not-accept-wdcell-as-a-valid-unit-to-move", "title": "Word VBA will not accept wdCell as a valid unit to move", "body": "<p>I am trying to move down one cell in a word table using VBA; the problem is when I use the <code>unit:=wdCell</code> it gives me a run-time error. I can use the default <code>wdLine</code> and it works fine, but if the cell has more than one line, I end up on the second line instead of the next cell.</p>\n\n<pre><code>With Selection\n  .MoveDown Unit:=wdCell, Count:=1, Extend:=wdMove\n  .Expand wdCell\n  .Range.Text = \"Hello World\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "function", "if-statement", "formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553684168, "post_id": 55375430, "comment_id": 97472975, "body": "Does it work when there is data in G25"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553684437, "post_id": 55375430, "comment_id": 97473134, "body": "Do 46mm and 90mm do the same thing?  I would recommend changing the <code>IF</code> part to where the it is actually needed, so in this case, it looks like you&#39;d need, <code>....IF(OR(G25=&quot;46mm&quot;,G25=&quot;90mm&quot;),(Matrix!$C$5:$G$5&gt;=I25),(Ma&zwnj;&#8203;trix!$C$5:$K$5&gt;=I25)&zwnj;&#8203;)...</code> within the AGGREGATE."}, {"owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553684541, "post_id": 55375430, "comment_id": 97473204, "body": "The formula works as a formula, but generates a #value! error of there&#39;s no data in the G25:g56 range."}, {"owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553684589, "post_id": 55375430, "comment_id": 97473239, "body": "It&#39;s basically a price matrix for something that is 46mm and 90mm, so it&#39;s looking up two different prices"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553684844, "post_id": 55375430, "comment_id": 97473402, "body": "For a matrix, you can use <code>INDEX(matrix,MATCH(yValue,column1,false),MATCH(xHeader,colum&zwnj;&#8203;n1,false))</code> so if I wanted to know how much customer1 pays for a drill, I could say <code>INDEX(A1:X1000,MATCH(&quot;Customer1&quot;,a1:a100,false),MATCH(&quot;Drill&zwnj;&#8203;&quot;,a1:x1,false))</code>  with customers being in column A and the header for products in row 1"}], "owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553683915, "creation_date": 1553683915, "question_id": 55375430, "link": "https://stackoverflow.com/questions/55375430/vba-function-query-using-if-formula", "title": "VBA Function query using IF formula", "body": "<p>I'm trying to create a VBA function which generates quite a complex formula if there's a particular value in Cell G25. Can anyone help please?</p>\n\n<p>My formula is: \n=IF(G25=\"46mm\",INDEX(Matrix!A:K,AGGREGATE(15,3,((Matrix!$B$6:$B$13>=M25)/(Matrix!$B$6:$B$13>=M25))*ROW(Matrix!$B$6:$B$13),1),AGGREGATE(15,3,((Matrix!$C$5:$G$5>=I25)/(Matrix!$C$5:$G$5>=I25))*COLUMN(Matrix!$C$5:$G$5),1)),IF(G25=\"67mm\",INDEX(Matrix!A:K,AGGREGATE(15,3,((Matrix!$B$6:$B$13>=M25)/(Matrix!$B$6:$B$13>=M25))*ROW(Matrix!$B$6:$B$13),1),AGGREGATE(15,3,((Matrix!$C$5:$K$5>=I25)/(Matrix!$C$5:$K$5>=I25))*COLUMN(Matrix!$C$5:$K$5),1)),IF(G25=\"90mm\",INDEX(Matrix!A:K,AGGREGATE(15,3,((Matrix!$B$6:$B$13>=M25)/(Matrix!$B$6:$B$13>=M25))*ROW(Matrix!$B$6:$B$13),1),AGGREGATE(15,3,((Matrix!$C$5:$G$5>=I25)/(Matrix!$C$5:$G$5>=I25))*COLUMN(Matrix!$C$5:$G$5),1)))))+AL25</p>\n\n<p>I'm currently using the above formula in Cell AG25 but it's generating a #VALUE! error where there's no content in cell G25.</p>\n\n<p>Ideally this function will apply to any cells in range g25:g56 dependant on the value in range a25:a56</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1553683132, "last_edit_date": 1553683132, "creation_date": 1553682616, "answer_id": 55375012, "question_id": 55374709, "link": "https://stackoverflow.com/questions/55374709/exportasfixedformat-generates-run-time-error-file-is-read-only/55375012#55375012", "title": "ExportAsFixedFormat generates run time error: file is read only", "body": "<p>You are getting that error because you are trying to overwrite a pdf with the same name which is currently open? When I say <strong>OPEN</strong>, I do not mean open in a web browser but open in applications like Adobe Reader etc... Close the open file and then try again :)</p>\n\n<p>Alternatively, check in the code if the file is open or not and then try to write it. See this example.</p>\n\n<pre><code>Sub PrintButtonClick()\n    Dim pdfFileName As String\n\n    With DataBaseSheet\n        .Unprotect Password:=pw\n        pdfFileName = .Cells(5, 5).Value\n\n        If pdfFileName = \"Print\" Then\n            pdfFileName = .Cells(5, 5) &amp; \".pdf\"\n            If IsPDFOpen(pdfFileName) Then\n                MsgBox \"A pdf with the same name is currently open. Please close that and try again\"\n            Else\n                .ExportAsFixedFormat Type:=xlTypePDF, FileName:=pdfFileName, _\n                                     Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                                     IgnorePrintAreas:=True, OpenAfterPublish:=True\n            End If\n        Else\n            MsgBox \"You cannot print this sheet\"\n        End If\n\n        .Cells(2, 2).Locked = False\n        .Protect Password:=pw\n    End With\nEnd Sub\n\n'~~&gt; Function to check if the pdf with same name is open\nFunction IsPDFOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n    Case 70:   IsPDFOpen = True\n    Case Else: IsPDFOpen = False\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 55375012, "answer_count": 1, "score": 1, "last_activity_date": 1559693146, "creation_date": 1553681665, "last_edit_date": 1559693146, "question_id": 55374709, "link": "https://stackoverflow.com/questions/55374709/exportasfixedformat-generates-run-time-error-file-is-read-only", "title": "ExportAsFixedFormat generates run time error: file is read only", "body": "<p>When the user clicks the \"Print Button\" the activesheet should be printed as PDF.</p>\n\n<p>I am having a problem with the <code>.ExportAsFixedFormat</code> method. I am getting the following error message: </p>\n\n<blockquote>\n  <p>Run time error '-2147018887 (80071779)': automation error, file is read only</p>\n</blockquote>\n\n<p>This is the code:</p>\n\n<pre><code>Sub PrintButtonClick()\n'++++Print to PDF Function++++\n'For more Information: https://docs.microsoft.com/de-de/office/vba/api/excel.worksheet.exportasfixedformat\n'DEPENDS ON LOCATION OF HEADING (Heading row index/column index)\n'allows to print material information, NO general list of materials\n\n    DataBaseSheet.Unprotect password:=pw\n\n    'PRINT PROCEDURE:\n    If DataBaseSheet.Cells(5, 5).value = \"Print\" Then\n\n        'Error in following line!!!!!\n        DataBaseSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _\n          DataBaseSheet.Cells(5, 5) &amp; \".pdf\", Quality:=xlQualityStandard, _\n          IncludeDocProperties:=True, IgnorePrintAreas:=True, _ \n          OpenAfterPublish:=True\n\n    Else: MsgBox \"You cannot print this sheet\"\n    End If\n\n    DataBaseSheet.Cells(2, 2).Locked = False\n    DataBaseSheet.Protect password:=pw\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553682145, "post_id": 55374650, "comment_id": 97471752, "body": "It is, how do you want it, in the same cell, in adjacent cells.  What code have you tried so far also?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553690002, "post_id": 55374650, "comment_id": 97476605, "body": "If you wanted horizontally and knew a max number of sections of 10, you could use <code>Range(&quot;A1&quot;).TextToColumns _         Destination:=Range(&quot;A1&quot;), _         DataType:=xlFixedWidth, _         FieldInfo:=Array( _                             Array(0, 1), _                             Array(10, 1), _                             Array(20, 1), _                             Array(30, 1), _                             Array(40, 1), _                             Array(50, 1))</code> or use Text To Columns from Excel."}], "answers": [{"comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 3, "creation_date": 1553682458, "post_id": 55374824, "comment_id": 97471929, "body": "You could improve your answer with a few comments, tidying and indenting."}], "tags": [], "owner": {"reputation": 756, "user_id": 6774506, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TZi7l96G9ek/AAAAAAAAAAI/AAAAAAAACHA/BcB6WC7RtAM/photo.jpg?sz=128", "display_name": "Kemal AL GAZZAH", "link": "https://stackoverflow.com/users/6774506/kemal-al-gazzah"}, "is_accepted": false, "score": 1, "last_activity_date": 1553683024, "last_edit_date": 1553683024, "creation_date": 1553682042, "answer_id": 55374824, "question_id": 55374650, "link": "https://stackoverflow.com/questions/55374650/how-to-split-a-string-every-nth-character-on-vba-excel/55374824#55374824", "title": "How to split a string every nth character on VBA excel?", "body": "<p>You can use this code\nit uses a loop using <a href=\"https://www.techonthenet.com/excel/formulas/mid.php\" rel=\"nofollow noreferrer\">the function MID</a> which retreives n caratcters from a string\n(3 paramaetres string, start and length)</p>\n\n<p>The below code has one function with the strig to split as parameter\nI putted this string in cells(1,2) and the results in column 1, starting from row 1: You can change that of course</p>\n\n<pre><code>Sub splitstring(mystring)\nn = Int(1 + Len(s) / 10)\nmystring1= mystring\n\nFor i = 0 To n\n  mystring1= Mid(mystring, 1 + i * 10, 10)\n  Cells(i + 1, 1) = mystring1\nNext\nEnd Sub\nSub call_me()\n'splitstring (\"1111 2222222 3333 77777 44444 55555 6666 99999\")\nsplitstring (Cells(1, 2))\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pu3fw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pu3fw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1553686080, "last_edit_date": 1553686080, "creation_date": 1553684169, "answer_id": 55375502, "question_id": 55374650, "link": "https://stackoverflow.com/questions/55374650/how-to-split-a-string-every-nth-character-on-vba-excel/55375502#55375502", "title": "How to split a string every nth character on VBA excel?", "body": "<p>You can achieve this quite easily using the <code>Mid</code> function as similar to @Kemal Al GAZZAH answer but using the <code>Step</code> option for the loop instead of calculating the number of outputs you'd have</p>\n\n<pre><code>Sub test()\n    Dim TestStr\n    Dim i As Long, n As Long\n    Dim SplitStr As String\n\n    TestStr = \"1111 2222222 3333 77777 44444 55555 6666 99999\"\n\n    n = 10\n\n    For i = 1 To Len(TestStr) Step n\n        SplitStr = SplitStr &amp; Mid(TestStr, i, n) &amp; vbNewLine\n    Next i\n\n    MsgBox SplitStr\nEnd Sub\n</code></pre>\n\n<p>You could also write this as a <code>Function</code> which would make it a lot more usable</p>\n\n<pre><code>Option Explicit\nPublic Function SplitString(StringToSplit As String, n As Long) As String()\n    Dim i As Long, arrCounter As Long\n    Dim tmp() As String\n\n    ReDim tmp(0 To CLng(Len(StringToSplit) / n))\n\n    For i = 1 To Len(StringToSplit) Step n\n        tmp(arrCounter) = Mid(StringToSplit, i, n)\n        arrCounter = arrCounter + 1\n    Next i\n\n    SplitString = tmp\nEnd Function\nPublic Sub test()\n    Dim TestStr As String\n\n    TestStr = \"1111 2222222 3333 77777 44444 55555 6666 99999\"\n\n    MsgBox Join(SplitString(TestStr, 10), vbNewLine)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8091097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae2d10bcdc22616335c3899dc17c9db?s=128&d=identicon&r=PG&f=1", "display_name": "attemptingpython", "link": "https://stackoverflow.com/users/8091097/attemptingpython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 0, "accepted_answer_id": 55375502, "answer_count": 2, "score": 0, "last_activity_date": 1557935237, "creation_date": 1553681480, "last_edit_date": 1557935237, "question_id": 55374650, "link": "https://stackoverflow.com/questions/55374650/how-to-split-a-string-every-nth-character-on-vba-excel", "title": "How to split a string every nth character on VBA excel?", "body": "<p>I have a string similar to</p>\n\n<pre><code> \"1111 2222222 3333 77777 44444 55555 6666 99999\"\n</code></pre>\n\n<p>Is it possible to split the string after each 10th character, i.e,</p>\n\n<pre><code>1111 22222\n22 3333 77\n777 44444 \n55555 6666\n99999\n</code></pre>\n"}, {"tags": ["excel", "vba", "xsl-stylesheet"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1553681539, "post_id": 55374604, "comment_id": 97471393, "body": "You\u2019re missing a NEXT for your FOR and I reckon you\u2019d be better to write a UDD rather than the macro like that. It means it could be applied anywhere independent of the range."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1553681793, "post_id": 55374604, "comment_id": 97471532, "body": "This is one of the main reason why you should always indent your code :)  I have mentioned this problem <a href=\"http://www.siddharthrout.com/index.php/2017/12/15/to-err-is-human/\" rel=\"nofollow noreferrer\">HERE - See point no 4</a> as well"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1553684765, "post_id": 55374604, "comment_id": 97473355, "body": "You can count the number of &#39;words&#39; in a cell by counting the number of spaces and adding one. That can be done with a formula, you don&#39;t need VBA at all.."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1553687731, "post_id": 55374604, "comment_id": 97475199, "body": "I agree with @CLR: But if you want to use VBA, just <code>Split</code> the text in an array and get the array count. That should be the word count. Also, consider looking at: <b>why we shouldn&#39;t use <code>Select</code> or <code>Activate</code> in VBA</b>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 0, "creation_date": 1553683090, "post_id": 55374764, "comment_id": 97472325, "body": "I have added the NEXT and the pointer is moving correctly cell to cell in a row but but getting inside the For loop and not setting value to (0,12) cell"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 0, "creation_date": 1553683216, "post_id": 55374764, "comment_id": 97472412, "body": "Did you consider using my UDF?  It would be a better and more sustainable approach.  I strongly suggest it."}, {"owner": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 0, "creation_date": 1553683373, "post_id": 55374764, "comment_id": 97472496, "body": "Actually I need to work on VBA that&#39;s why, else would have tried that..."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 0, "creation_date": 1553683864, "post_id": 55374764, "comment_id": 97472786, "body": "@MrE the function is VBA though.  Anyway, check your MID statement.  It&#39;s not correct.  Mid works like ... Mid(&quot;This is the text&quot;, 4, 1) ... that will give you &quot;s&quot; ... you&#39;re passing in 2 integers.  Check the documentation on it.  Something like this ... If Mid(ActiveCell.Offset(0, 13).Value, start_point, 1) = &quot; &quot; Then"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 1, "creation_date": 1553684133, "post_id": 55374764, "comment_id": 97472950, "body": "@MrE ... be careful with what you&#39;re doing.  You have changed your original question.  I answered your original question and now you have changed it and unflagged my answer.  My answer should stand as correct.  You need to be clearer in relation to what you&#39;re trying to achieve if you want help with the business logic.  Your syntax error was answered and answered correctly."}, {"owner": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "edited": false, "score": 0, "creation_date": 1553749755, "post_id": 55374764, "comment_id": 97502138, "body": "How can I convert the UDF to take whole selected column and show output in column form only"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553683965, "last_edit_date": 1553683965, "creation_date": 1553681859, "answer_id": 55374764, "question_id": 55374604, "link": "https://stackoverflow.com/questions/55374604/counting-number-of-words-of-each-column-in-vba/55374764#55374764", "title": "Counting number of words of each column in VBA", "body": "<p>This UDF approach would be an easier option ... well ... in my opinion anyway.</p>\n\n<pre><code>Public Function CountWords(ByVal strText As String) As Long\n    Application.Volatile\n    CountWords = UBound(Split(strText, \" \")) + 1\nEnd Function\n</code></pre>\n\n<p>... you can then use that in any cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZdOZq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZdOZq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to go with your original approach, you were missing a NEXT.</p>\n\n<pre><code>Sub Command()\n    total_words = 1\n\n    Dim ans_length As Integer\n    Dim start_point As Integer\n\n    Range(\"N3\").Select\n\n    Do Until ActiveCell.Value = \"\"\n        ans_length = Len(ActiveCell.Offset(0, 13).Value)\n\n        For start_point = 1 To ans_length\n            If (Mid(ans_length, start_point, 1)) = \" \" Then\n                total_words = total_words + 1\n            End If\n        Next start_point\n\n        ActiveCell.Offset(0, 12).Value = total_words\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7765349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db5ccd102b231d379e273e1638220df?s=128&d=identicon&r=PG&f=1", "display_name": "MrE", "link": "https://stackoverflow.com/users/7765349/mre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55374764, "answer_count": 1, "score": 0, "last_activity_date": 1553701425, "creation_date": 1553681349, "last_edit_date": 1553701425, "question_id": 55374604, "link": "https://stackoverflow.com/questions/55374604/counting-number-of-words-of-each-column-in-vba", "title": "Counting number of words of each column in VBA", "body": "<p>I'am trying to implement a code so that all the number of words from each cell in a column can be calculated and displayed in a cell just next to them.</p>\n\n<p>I have written this code, but it shows Complie Error: Loop without Do, where as I'am having it.</p>\n\n<pre><code>Sub Command()\n    total_words = 1\n    Dim ans_length As Integer\n    Dim start_point As Integer\n\n    Range(\"N3\").Select\n\n    Do Until ActiveCell.Value = \"\"\n\n        ans_length = Len(ActiveCell.Offset(0, 13).Value)\n        For start_point = 1 To ans_length\n            If (Mid(ans_length, start_point, 1)) = \" \" Then\n            total_words = total_words + 1\n            End If\n        ActiveCell.Offset(0, 12).Value = total_words\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n\n<p>say i have this content:</p>\n\n<pre><code>      Col1                      Col2\nThe only way to do multi   |      6\nline comments in VB        |      4\nthe only option you have   |      5\nis the single              |      3 \n</code></pre>\n\n<p>here i have col2 by default and writing VBA code for col2</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 679, "user_id": 10901808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jY9w7So-0sU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb4akbBkb5AR60MFcRHBIZqJGg_Kw/mo/photo.jpg?sz=128", "display_name": "jbud", "link": "https://stackoverflow.com/users/10901808/jbud"}, "edited": false, "score": 0, "creation_date": 1553682739, "post_id": 55374081, "comment_id": 97472103, "body": "Are you sure, you need to deduct the VAT value if the checkbox is not checked? Or do you mean is should remain zero?"}, {"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "reply_to_user": {"reputation": 679, "user_id": 10901808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jY9w7So-0sU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb4akbBkb5AR60MFcRHBIZqJGg_Kw/mo/photo.jpg?sz=128", "display_name": "jbud", "link": "https://stackoverflow.com/users/10901808/jbud"}, "edited": false, "score": 0, "creation_date": 1553694457, "post_id": 55374081, "comment_id": 97479710, "body": "The checkbox&#39;s default state is No/Unchecked. When I check the checkbox, the VAT simply adds 15% of the Amount in its value. If I uncheck the checkbox again, obviously the VAT will subtract that 15% off."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553696151, "post_id": 55375295, "comment_id": 97480925, "body": "ctrVAT also gets modified from checking the booVAT checkbox. If you check it, that item will be included in VAT calculation; if not, it is excluded. To do this, I am using macro with AfterUpdate event on the checkbox booVAT (in the subform) to modify the ctrVAT (in the parent form).  AfterUpdate event of SalesDetail subform seems to have some conflict with AfterUpdate event of booVAT checkbox. It looks like the one of SalesDetail fires before that of the checkbox."}, {"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553697647, "post_id": 55375295, "comment_id": 97481951, "body": "For some reason AfterUpdate event doesn&#39;t work when I press enter, only when I click out of the form.  As for <code>booVAT</code> belongs to the subform, though. My database can nitpick which item to be included in VAT calculation. In order to check <code>booVat</code> state I have to use macro, since control source doesn&#39;t work well with <code>iif</code> and <code>ctrVAT</code>"}, {"owner": {"reputation": 679, "user_id": 10901808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jY9w7So-0sU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb4akbBkb5AR60MFcRHBIZqJGg_Kw/mo/photo.jpg?sz=128", "display_name": "jbud", "link": "https://stackoverflow.com/users/10901808/jbud"}, "reply_to_user": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553698649, "post_id": 55375295, "comment_id": 97482704, "body": "I&#39;ve updated my answer, you can remove the event on the checkbox. Use a calculated field to calculate the VAT for the line item, and the form&#39;s (subform) AfterUpdate event to update the totals in your main form."}, {"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553700599, "post_id": 55375295, "comment_id": 97484104, "body": "For some reason it doesn&#39;t work out... First of all, <code>ctrVAT</code> is in the parent form, and me using <code>ctrVAT = Sum([subSalesDetail.Form!VATAmount])</code> just turns to error. I have to use a textbox <code>txtSumVAT</code> in the subform&#39;s Footer to calculate the sum first, then extract that <code>txtSumVAT</code> to the parent form&#39;s <code>ctrVAT</code>. Anyhow, each time the AfterUpdate fires, <code>ctrVAT</code> &quot;updates&quot; the second-last modification, and not the last modification."}, {"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553700829, "post_id": 55375295, "comment_id": 97484243, "body": "Example, I have three records in <code>SalesDetail</code>. I modify the first record, jump to the next record, but <code>ctrVAT</code> does not change. I modify the second record, jump to the third record, then <code>ctrVAT</code> changes, but with the modification of the first record, not with the latest one (in the second record)."}, {"owner": {"reputation": 679, "user_id": 10901808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jY9w7So-0sU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb4akbBkb5AR60MFcRHBIZqJGg_Kw/mo/photo.jpg?sz=128", "display_name": "jbud", "link": "https://stackoverflow.com/users/10901808/jbud"}, "reply_to_user": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553701243, "post_id": 55375295, "comment_id": 97484522, "body": "why don&#39;t you just build a query to calculate the total VAT per SalesId on the SalesDetail table, and use a DLookup to get and update the value in to Sales.Vat. This would be in my opinion the easiest and safest way to get the correct calculation. You would still use the afterupdate event in the subform."}, {"owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "edited": false, "score": 0, "creation_date": 1553745442, "post_id": 55375295, "comment_id": 97501160, "body": "Thanks for the idea. Using query to calculate sum did not pass my mind at all. However, AfterUpdate event in the subform does not work at all, even if I press Tab, Enter, or pass to the next record."}], "tags": [], "owner": {"reputation": 679, "user_id": 10901808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jY9w7So-0sU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb4akbBkb5AR60MFcRHBIZqJGg_Kw/mo/photo.jpg?sz=128", "display_name": "jbud", "link": "https://stackoverflow.com/users/10901808/jbud"}, "is_accepted": false, "score": 0, "last_activity_date": 1553700911, "last_edit_date": 1553700911, "creation_date": 1553683468, "answer_id": 55375295, "question_id": 55374081, "link": "https://stackoverflow.com/questions/55374081/how-to-update-a-field-in-main-table-based-on-child-tables-in-a-form-with-subfor/55375295#55375295", "title": "How to update a field in main table based on child tables in a form (with subform)?", "body": "<p>Since the value of <code>ctrVAT</code> only changes when you update/add the Amount field in the SalesDetail form, you can use the AfterUpdate event of the subform.</p>\n\n<p>In the AfterUpdate event of the SalesDetail subform you can do something like this:</p>\n\n<p><code>forSales!Vat = forSales!ctrVAT</code></p>\n\n<p>You will need to update the query on which your subform is based on, add a calculated field: <code>VATAmount: iif([booVAT], [Amount]*0.15, [Amount])</code></p>\n\n<p>Then update your control source of the <code>ctrVAT</code> to <code>=Sum([subSalesDetail.Form!VATAmount])</code>.</p>\n\n<p>You'll probably need to add the <code>VATAmount</code> as a hidden field/column in the subform.</p>\n"}], "owner": {"reputation": 1, "user_id": 11264081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZifYntr2UEY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLW_7vC0dqfr6WnULa-EQImfLanw/mo/photo.jpg?sz=128", "display_name": "Emmanuel Goldstein", "link": "https://stackoverflow.com/users/11264081/emmanuel-goldstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553700911, "creation_date": 1553679881, "last_edit_date": 1553694341, "question_id": 55374081, "link": "https://stackoverflow.com/questions/55374081/how-to-update-a-field-in-main-table-based-on-child-tables-in-a-form-with-subfor", "title": "How to update a field in main table based on child tables in a form (with subform)?", "body": "<p>I have two tables, one parent table named <em>Sales</em> which records transaction, and one child table named <em>SalesDetail</em> that records all items of each transaction.</p>\n\n<p>Table <em>Sales</em> has the following fields: SalesID, Customer, CustomerInfo, VAT:</p>\n\n<ul>\n<li>SalesID: Primary Key </li>\n<li>Customer, Customer Info: other information fields </li>\n<li>VAT: VAT (tax) value of the transaction.</li>\n</ul>\n\n<p>Table <em>SalesDetail</em> has the following fields: SalesDetailID, SalesMasterID, ItemName, UnitPrice, Qty, Amount, booVAT:</p>\n\n<ul>\n<li>SalesDetailID: Primary Key</li>\n<li>SalesMasterID: lookup field toward the primary key SalesID of the parent table <em>Sales</em></li>\n<li>ItemName, UnitPrice, Qty: Item name, unit price (VAT excluded) and quantity of the selected item.</li>\n<li>Amount: the amount (price) of the selected item. A calculated field where Amount = UnitPrice * Qty</li>\n<li>booVAT: boolean</li>\n</ul>\n\n<p>The moral of the story is, some items have VAT exemption (15%) for specific customers, that's why I cannot include the VAT directly into the price. Only those who are not exempt will have to pay the VAT, which will be checked in booVAT checkbox.</p>\n\n<p>Each time the booVAT checkbox is ticked, 15% of Amount field in <em>SalesDetail</em> will be added to VAT field in <em>Sales</em>, and if it is unchecked, the same amount will be deduced.</p>\n\n<p>Currently, I am having a Form named forSales where you can add or edit each <em>Sales</em> transaction, with a subform (datasheet) of <em>SalesDetail</em> subSalesDetail for all of items in each transaction. I also used some codes and macro to automatically update <em>Sales</em>.VAT, by using another Control of the parent Form (I named this control ctrVAT), with ctrVAT = Sum([subSalesDetail.Form!Amount]) * 0.15. However, when it comes to updating ctrVAT into <em>Sales</em>.VAT, I can't find any workaround it as I cannot catch the moment when ctrVAT is modified. Most event only fires for direct data modification, not with dynamic modification via calculated field nor VBA.</p>\n\n<p>I also thought about using On Timer event, but using On Timer is not really elegant: having a macro constantly running in background can be a bit taxing on low-end computers.</p>\n\n<p>Is there any way to work around this? I would like the calculation to be as automatic as possible to avoid human errors.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "edited": false, "score": 0, "creation_date": 1553681419, "post_id": 55373993, "comment_id": 97471323, "body": "above looks super complex. have pasted exactly and changed range as well as the name of sheet with pivot table but code is bombing out at Set SI = SC.SlicerItems checking further"}, {"owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "edited": false, "score": 0, "creation_date": 1553693752, "post_id": 55373993, "comment_id": 97479215, "body": "this works like a charm! thanks a ton. i upvoted your solution but it doesnt show because im under 11 points rep"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1553681896, "last_edit_date": 1553681896, "creation_date": 1553679628, "answer_id": 55373993, "question_id": 55373539, "link": "https://stackoverflow.com/questions/55373539/filtering-pivot-slicer-using-a-range-of-values/55373993#55373993", "title": "Filtering Pivot Slicer using a range of values", "body": "<p>This should work:</p>\n\n<pre><code>Option Explicit\nSub filterSlicers()\n\n    Dim i As Long, SI As SlicerItem, SC As SlicerCache, PvT As PivotTable, C As Range, Cell As Range, ws As Worksheet\n    Dim DictFilter As Scripting.Dictionary 'You need Microsoft Scripting Runtime for this to work\n\n    For Each PvT In ThisWorkbook.Sheets(\"TheSheetContainingThePivotTables\").PivotTables 'this will improve a lot the performance\n        PvT.ManualUpdate = True\n    Next PvT\n\n    Set ws = ThisWorkbook.Sheets(\"Macro\")\n    Set C = ws.Range(\"A1:A12\")  'change your range\n\n    Set DictFilter = New Scripting.Dictionary 'initialize the dictionary\n    For Each Cell In C\n        DictFilter.Add Cell.Value, 1 'store the values you want  to filter on the dictionary\n    Next Cell\n\n\n    Set SC = ThisWorkbook.SlicerCaches(\"Slicer_Month_and_Year\")\n    SC.ClearAllFilters\n    For Each SI In SC.VisibleSlicerItems\n        Set SI = SC.SlicerItems(SI.Name)\n        If DictFilter.Exists(SI.Name) Then\n            SI.Selected = True\n        Else\n            SI.Selected = False\n        End If\n    Next\n\n    For Each PvT In ThisWorkbook.Sheets(\"TheSheetContainingThePivotTables\").PivotTables 'return the automatic update to the pivot tables\n        PvT.ManualUpdate = False\n    Next PvT\n\nEnd Sub\n</code></pre>\n\n<p>Note that I've add some extra code for performance (turning off the manual update for the pivot tables that are using the slicer)</p>\n"}], "owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 55373993, "answer_count": 1, "score": 0, "last_activity_date": 1576000534, "creation_date": 1553678219, "last_edit_date": 1553680046, "question_id": 55373539, "link": "https://stackoverflow.com/questions/55373539/filtering-pivot-slicer-using-a-range-of-values", "title": "Filtering Pivot Slicer using a range of values", "body": "<p>I have a pivot table that is filtered by a date filed pivot slicer.\nOn another sheet i have a 12 month date range example from cell A1:A12.\nI have code that loops through the slicer and tries to match whats in the slicer compared to the range. Ideally i would want the slicer to then only select the values that exist within the range A1:A12. The code below runs but selected everything once the loop has terminated.</p>\n\n<p>Any ideas? </p>\n\n<pre><code>Sub DateSelect()\n\nDim ws As Worksheet\nDim i As Integer, iLookupColumn As Integer\nDim sl As SlicerCache\nDim sDate As String\nSet sl = ThisWorkbook.SlicerCaches(\"Slicer_Month_and_Year\")\n\nSet ws = ThisWorkbook.Sheets(\"Macro\")\nFor i = 1 To sl.SlicerItems.Count\n    sDate = sl.SlicerItems(i).Name\n    If IsError(Application.Match(sDate, ws.Range(ws.Cells(1, 14), ws.Cells(13, 14)), 0)) Then\n        ThisWorkbook.SlicerCaches(\"Slicer_Month_and_Year\").SlicerItems(i).Selected = False\n    Else\n        ThisWorkbook.SlicerCaches(\"Slicer_Month_and_Year\").SlicerItems(i).Selected = True\n    End If\nNext i\n\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["regex", "vba", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 752306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McjL2.jpg?s=128&g=1", "display_name": "Eddict", "link": "https://stackoverflow.com/users/752306/eddict"}, "edited": false, "score": 0, "creation_date": 1553682711, "post_id": 55373631, "comment_id": 97472086, "body": "it works after replacing the other 2 ^ by \\n  `  .Pattern = &quot;(?:-{10}\\r?\\nPath = |^Size = |^Modified = )(.*)&quot;`  why is that?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 45, "user_id": 752306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McjL2.jpg?s=128&g=1", "display_name": "Eddict", "link": "https://stackoverflow.com/users/752306/eddict"}, "edited": false, "score": 0, "creation_date": 1553682946, "post_id": 55373631, "comment_id": 97472233, "body": "@Eddict You did not show any input string, nor your code. So, you have multiline text, add <code>.Multiline = True</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 45, "user_id": 752306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McjL2.jpg?s=128&g=1", "display_name": "Eddict", "link": "https://stackoverflow.com/users/752306/eddict"}, "edited": false, "score": 0, "creation_date": 1553683182, "post_id": 55373631, "comment_id": 97472391, "body": "@Eddict It is there by default :)"}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1553682918, "last_edit_date": 1553682918, "creation_date": 1553678490, "answer_id": 55373631, "question_id": 55373499, "link": "https://stackoverflow.com/questions/55373499/how-to-find-specific-instance-of-a-word-without-lookbehind-support/55373631#55373631", "title": "How to find specific instance of a word without Lookbehind support", "body": "<p>Use a non-capturing group to set the left-hand side context and use a capturing group to grab the required result:</p>\n\n<pre><code>(?:-{10}\\r?\\nPath = |^Size = |^Modified = )(.*)\n^--------- non-capturing group -----------^\n                                           ^--^ - capturing group\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/lySUHL/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p>VBA demo:</p>\n\n<pre><code>Dim re, testString, colMatch, objMatch\nSet re = New RegExp\nWith re\n  .Pattern = \"(?:-{10}\\r?\\nPath = |^Size = |^Modified = )(.*)\"\n  .Global = True\n  .Multiline = True\n  .IgnoreCase = True\nEnd With\ntestString = \"----------\" &amp; vbCrLf &amp; \"Path = some/path/here\"\n\nSet colMatch = re.Execute(testString)\nFor Each objMatch In colMatch\n  Debug.Print objMatch.SubMatches(0)  ' &lt;- The first submatch is your value\nNext\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 752306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McjL2.jpg?s=128&g=1", "display_name": "Eddict", "link": "https://stackoverflow.com/users/752306/eddict"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55373631, "answer_count": 1, "score": 1, "last_activity_date": 1553682918, "creation_date": 1553678111, "question_id": 55373499, "link": "https://stackoverflow.com/questions/55373499/how-to-find-specific-instance-of-a-word-without-lookbehind-support", "title": "How to find specific instance of a word without Lookbehind support", "body": "<p><a href=\"https://regex101.com/r/55DgSB/2\" rel=\"nofollow noreferrer\">https://regex101.com/r/55DgSB/2</a></p>\n\n<p>I need to find the values of 3 properties, 'Path =', 'Size =' and 'Modified =' inside this 7-Zip output. I'm using VBScript.RegExp so (Positive) Lookbehind is not supported. I'm struggling with the 'Path =' one as that one is in there twice and i need to have the second instance (the one after the 10 dashes).</p>\n\n<pre class=\"lang-regex prettyprint-override\"><code>^((?&lt;=-{10}\\n)Path = |^Size = |^Modified = ).*\n</code></pre>\n\n<p>above obviously not working as it's using Lookbehind to check for the 10 dashes.\nhow to solve?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553680443, "post_id": 55373386, "comment_id": 97470678, "body": "Reading this <a href=\"https://forums.windowssecrets.com/showthread.php/105224-TransferDatabase-Password-(Access-2007)\" rel=\"nofollow noreferrer\">forums.windowssecrets.com/showthread.php/&hellip;</a> you may need to open the database and that property doesn&#39;t apply to Access DB&#39;s.  Maybe the link option in here <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transferdatabase\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> or look at SQL <code>Select Into</code> specifying a connection string in the from."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 4, "last_activity_date": 1553680856, "creation_date": 1553680856, "answer_id": 55374442, "question_id": 55373386, "link": "https://stackoverflow.com/questions/55373386/ms-access-docmd-transferdatabase-when-source-has-a-password/55374442#55374442", "title": "MS Access DoCmd.Transferdatabase when source has a password", "body": "<p>Open the database with DAO, supplying the password, then you can import the tables.</p>\n\n<pre><code>Public Sub ImportEncr()\n\n    Const dbImport = \"D:\\DbEncr.accdb\"\n    Const sPassword = \"foobar\"\n\n    Dim DB As DAO.Database\n    Set DB = DBEngine.OpenDatabase(Name:=dbImport, Options:=False, ReadOnly:=False, Connect:=\";PWD=\" &amp; sPassword)\n\n    DoCmd.TransferDatabase acImport, \"Microsoft Access\", dbImport, acTable, \"tblEncr\", \"tblEncr\", False\n\n    DB.Close\n    Set DB = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><code>StoreLogin</code> applies to linking tables from ODBC databases.</p>\n"}, {"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1553693540, "post_id": 55374663, "comment_id": 97479080, "body": "Thank you for your answer. +1 I ended up using Andre&#39;s but will test your solution."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1553681512, "creation_date": 1553681512, "answer_id": 55374663, "question_id": 55373386, "link": "https://stackoverflow.com/questions/55373386/ms-access-docmd-transferdatabase-when-source-has-a-password/55374663#55374663", "title": "MS Access DoCmd.Transferdatabase when source has a password", "body": "<p>You can use SQL and build a SQL statement and <code>.RunSQL</code> that I believe.</p>\n\n<p>An example SQL would be</p>\n\n<p><code>SELECT * into tblIMPORT\nFROM xyz IN '' '; database=C:\\Workspace\\Database1.accdb;PWD=test';</code></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3063, "favorite_count": 0, "accepted_answer_id": 55374442, "answer_count": 2, "score": 3, "last_activity_date": 1553681512, "creation_date": 1553677739, "last_edit_date": 1553680891, "question_id": 55373386, "link": "https://stackoverflow.com/questions/55373386/ms-access-docmd-transferdatabase-when-source-has-a-password", "title": "MS Access DoCmd.Transferdatabase when source has a password", "body": "<p>I need to import tables from various databases on a monthly basis. Once the tables are imported, the databases are archived and not looked at again.</p>\n\n<p>I have the following VBA code which works fine when a DB is not password protected:</p>\n\n<pre><code>Private Sub ImportTheData(ByVal dbImport As String)\n\nDoCmd.SetWarnings False 'Turn OFF display alerts\n\n'Import the full activity &amp; comments table from the Import DB to a temporary table\nDoCmd.TransferDatabase acImport, \"Microsoft Access\", dbImport, acTable, \"tbl_Activity\", \"tbl_TempActivity\", True\nDoCmd.TransferDatabase acImport, \"Microsoft Access\", dbImport, acTable, \"tbl_Comments\", \"tbl_TempComments\", True\n\n'code continues ...\n</code></pre>\n\n<p>The last parameter (storelogin) is set to true, but there seems to be no way to programmatically set those login parameters (password).</p>\n\n<p>When I run the code, the user is prompted to enter the password (despite the SetWarnings = False). As I'm importing dozens of files each time this is not a viable solution.</p>\n\n<p><strong>Is there a way to programatically import tables using <code>DoCmd.TransferDatabase</code> when a file is password protected and if so how?</strong></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553679204, "post_id": 55373376, "comment_id": 97469942, "body": "I don&#39;t see why the same value in stock should be needed. Wouldn&#39;t it make sense that if Stock 3 has 100 items and if Stock 1 has -20 that they send 20 even if it is not the same amount they have?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553679422, "post_id": 55373610, "comment_id": 97470081, "body": "Thanks for the suggestion the script is marking the side if the value is 0 in every cell not +50 and -50 or +10 and -10"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553679597, "post_id": 55373610, "comment_id": 97470201, "body": "if you add together +50, -50, +10,10 is equal to 0"}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553679783, "post_id": 55373610, "comment_id": 97470300, "body": "Yes you are correct but i need the cell to be blue if 2 of the 4 cells have the same value just in negative and minus so i can see the product from that place went there as in my example"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553679957, "post_id": 55373610, "comment_id": 97470394, "body": "Ok, if column A has a value must have the negatice one in column D and if column B has a value column C will have the negative?"}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553680546, "post_id": 55373610, "comment_id": 97470758, "body": "I added a screenshot that should clarify the purpose of the formula, the positive and negative could be in any of the 4 cells maybe a and d or c and a ...."}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553684530, "post_id": 55373610, "comment_id": 97473196, "body": "Thanks alot this works Great  if i could i would mark your answer as correct too"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553684678, "post_id": 55373610, "comment_id": 97473303, "body": "@Cedric glad to hear that my answer helps you. i think you can only mark one answer as the correct. You have mark my answer as correct at first place but then you remove it."}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 1, "creation_date": 1553692512, "post_id": 55373610, "comment_id": 97478358, "body": "Yes im sorry about it but i am using the excel in my worksheet because its a bit less complicated to use but as i said both answers work if i could i would give you both the correct one :("}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1553682617, "last_edit_date": 1553682617, "creation_date": 1553678448, "answer_id": 55373610, "question_id": 55373376, "link": "https://stackoverflow.com/questions/55373376/how-to-check-if-cell-values-balance-each-other/55373610#55373610", "title": "How to check if Cell values balance each other", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Row As Long, Column As Long\n    Dim rng As Range\n\n    'Let us assume that we use Sheet1 &amp; columns A to F\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        For Row = 2 To 100 ' &lt;- Let us assume that data starts in row 2 and ends in row 100\n            Set rng = .Range(\"B\" &amp; Row &amp; \":E\" &amp; Row)\n\n            For Column = 2 To 6\n                If .Cells(Row, Column).Value &lt;&gt; 0 Then\n                    If Application.WorksheetFunction.CountIf(rng, (-1 * .Cells(Row, Column).Value)) &gt; 0 Then\n                        .Range(\"F\" &amp; Row).Interior.Color = vbBlue\n                        Exit For\n                    End If\n                End If\n            Next Column\n        Next Row\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553680192, "post_id": 55373833, "comment_id": 97470542, "body": "This Formula works but it marks every cell with no differences as true by only that result i cant see which cells have 2 numbers that equal each other"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "reply_to_user": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1553680610, "post_id": 55373833, "comment_id": 97470798, "body": "@Cedric: I adapted my answer accordingly, I just merged the <code>AND()</code>-clause in the formula, as I mentioned, and it seems to work: I set the values 1, 2, -4, 4 and the formula gives <code>TRUE</code>."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 3, "last_activity_date": 1553680527, "last_edit_date": 1553680527, "creation_date": 1553679148, "answer_id": 55373833, "question_id": 55373376, "link": "https://stackoverflow.com/questions/55373376/how-to-check-if-cell-values-balance-each-other/55373833#55373833", "title": "How to check if Cell values balance each other", "body": "<p>You can do this, using conditional formatting, using this formula (just for the first row):</p>\n\n<pre><code>=OR(A1+B1=0;B1+C1=0;C1+D1=0)\n</code></pre>\n\n<p>This formula checks if the sum of two adjacent cells equals zero, which is another way of saying that they should have the same value, but opposite signs.</p>\n\n<p>Obviously, you might consider changing this formula, e.g.:<br>\nInstead of:</p>\n\n<pre><code>A1+B1=0\n</code></pre>\n\n<p>you put:</p>\n\n<pre><code>AND(A1+B1=0;A1&lt;&gt;0)\n</code></pre>\n\n<p>When the sum of two values equals zero and at least one of them is not zero, then both are not zero.</p>\n\n<p>All this together in one formula yields the following:</p>\n\n<pre><code>=OR(AND(A1+B1=0;A1&lt;&gt;0);AND(B1+C1=0;B1&lt;&gt;0);AND(C1+D1=0;C1&lt;&gt;0))\n</code></pre>\n\n<p>Use such a formula in the conditional formatting of cell <code>E1</code>, and apply this for all cells in <code>E</code> column.</p>\n"}], "owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55373833, "answer_count": 2, "score": -1, "last_activity_date": 1553682617, "creation_date": 1553677691, "last_edit_date": 1553680480, "question_id": 55373376, "link": "https://stackoverflow.com/questions/55373376/how-to-check-if-cell-values-balance-each-other", "title": "How to check if Cell values balance each other", "body": "<p>I am trying to Create a Formula that checks 4 Cells next to each other if they have the same number once positive and once negative see in the example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dh3aq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dh3aq.png\" alt=\"Example to recreate Sheet\"></a></p>\n\n<p>If the formula sees there is a Plus 50 and a Minus 50 its has to colour the cell on the right side or the cells with the numbers blue.</p>\n\n<p>The list is a inventory of multiple stores if one store sells alot of that product and may run out they ask another store to restock the product. Sometimes they forget to send a note. This List is supposed to make the control as easy as possible.</p>\n\n<p>I expect the formula to color the cell on the right side of the list to be colored blue if 2 of the cells have the same value in plus and minus.</p>\n\n<p>I tried to use  cell formatting rules but its not possible to do it with that.</p>\n\n<p>Another Example since people seem to have trouble understanding what the formula should do:</p>\n\n<p>I marked every cell blue like the formula should and yellow colored value is the reason.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uIKN5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uIKN5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553677147, "post_id": 55373171, "comment_id": 97468691, "body": "If you have been &quot;lately trying&quot; then post the results of your labours; what progress have you made? What code?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553677180, "post_id": 55373171, "comment_id": 97468718, "body": "You might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> \u2022 Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 1, "user_id": 11264988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f3a628bc940f16c1f3344ba9200b7a?s=128&d=identicon&r=PG&f=1", "display_name": "WolowitzHoward", "link": "https://stackoverflow.com/users/11264988/wolowitzhoward"}, "edited": false, "score": 0, "creation_date": 1553677896, "post_id": 55373171, "comment_id": 97469146, "body": "Thanks for the warm welcome... As i already i just freshly joined the Forum.. and for you kind information i havent asked anyone to do all the work for me, and yeah i know its not a free code writing service... As you can clearly see from my table how beginner i am in excel, beacuse i am a school student who likes to create something or learn something when i am free.... I was just looking for a hint or clue, how could i connect this things......"}, {"owner": {"reputation": 1, "user_id": 11264988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f3a628bc940f16c1f3344ba9200b7a?s=128&d=identicon&r=PG&f=1", "display_name": "WolowitzHoward", "link": "https://stackoverflow.com/users/11264988/wolowitzhoward"}, "edited": false, "score": 0, "creation_date": 1553677946, "post_id": 55373171, "comment_id": 97469191, "body": "As from your profile, i can clearly see how professional you guys are in this stuffs... i just have an advice for you.... P.S : Be a good Human, before being a good professionals....."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553682680, "post_id": 55373171, "comment_id": 97472059, "body": "Well it&#39;s no problem if you are new to Excel or VBA but still you can do some research and come up with an idea (we would tell you if this is a completely stupid idea or the right way to go). But if you haven&#39;t researched or tried something we have to assume that you did nothing at all yet. This is not about beeing a good or bad guy, but according to <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> your question is just to broad to answer (actually it is not an actual question as explained in the link). The thing is if you put enough effort into asking a good question people will also put effort into writing a good answer."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553682792, "post_id": 55373171, "comment_id": 97472138, "body": "Actually I explained you, that your question was too broad to answer and not a good question but as you might not have realized I still posted an answer at the same time (see below). So there is nothing to complain. Just beeing new or unexperienced doesn&#39;t mean the rules explained in the <a href=\"https://stackoverflow.com/help\">help center</a> do not apply to you. Still I was patient and posted an answer even your question got 4 close votes by the communitiy because it was not fulfilling the rules."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11264988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f3a628bc940f16c1f3344ba9200b7a?s=128&d=identicon&r=PG&f=1", "display_name": "WolowitzHoward", "link": "https://stackoverflow.com/users/11264988/wolowitzhoward"}, "edited": false, "score": 0, "creation_date": 1553686279, "post_id": 55373369, "comment_id": 97474298, "body": "Thanks a lot for your answer... I have already tried this Formula... actually my question was if the sheet contains the data of the whole year, (i.e 52 Weeks) , then i need to write the formula for every shells for the whole 52 weeks... i would try something new , so that i must not put the formula everywhere.."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 11264988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f3a628bc940f16c1f3344ba9200b7a?s=128&d=identicon&r=PG&f=1", "display_name": "WolowitzHoward", "link": "https://stackoverflow.com/users/11264988/wolowitzhoward"}, "edited": false, "score": 0, "creation_date": 1553688938, "post_id": 55373369, "comment_id": 97475926, "body": "I wrote this formula only once and then copy/pasted it into the other cells. Excel adjusts the formula automatically."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1553677673, "creation_date": 1553677673, "answer_id": 55373369, "question_id": 55373171, "link": "https://stackoverflow.com/questions/55373171/how-to-extract-data-using-two-filters-in-excel/55373369#55373369", "title": "How to extract data using two Filters in Excel?", "body": "<p>There is no need for VBA. You can use a simple formula for this in the example shown below:</p>\n\n<pre><code>=COUNTIFS(Tabelle1[Responsible Department],$F2,Tabelle1[Delivered KW],G$1)\n</code></pre>\n\n<p>Enter this formula in G2 and copy it to the other cells. <code>Tabelle1</code> is the name of the formatted table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zv5jq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zv5jq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11264988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f3a628bc940f16c1f3344ba9200b7a?s=128&d=identicon&r=PG&f=1", "display_name": "WolowitzHoward", "link": "https://stackoverflow.com/users/11264988/wolowitzhoward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1553683054, "creation_date": 1553676982, "last_edit_date": 1553683054, "question_id": 55373171, "link": "https://stackoverflow.com/questions/55373171/how-to-extract-data-using-two-filters-in-excel", "title": "How to extract data using two Filters in Excel?", "body": "<p>I am school student and new to the Forum and I need help with some problems. </p>\n\n<p>I have been lately trying to build a Inventory Sheet in Excel, where there is a table of Partnumber, Responsible Department, Delivered Calendar Week and Product type. </p>\n\n<p>I want to filter the data using two filters, for example: The parts that has been taken by customer on calendar week KW(10).</p>\n\n<p><a href=\"https://i.stack.imgur.com/shFIk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/shFIk.png\" alt=\"Table\"></a></p>\n\n<p>And I then need to take the total number of this filtered parts to another sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1apuw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1apuw.png\" alt=\"Next Sheet\"></a></p>\n\n<p>Can anyone help me with this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 4, "last_activity_date": 1553676333, "last_edit_date": 1553676333, "creation_date": 1553676178, "answer_id": 55372936, "question_id": 55372881, "link": "https://stackoverflow.com/questions/55372881/how-to-get-workbook-name-after-opening-the-workbook-using-workbooks-open/55372936#55372936", "title": "How to get Workbook Name after opening the workbook using workbooks.open?", "body": "<p>You need to use references and reference the workbook and the sheet for example:</p>\n\n<pre><code>Option Explicit\n\nSub OpenWorkbook()\n\n   Dim wb As Workbook, ws As Worksheet\n\n   Set wb = Workbooks.Open(\"C:\\abc.xlsx\", UpdateLinks:=False, ReadOnly:=True)\n   Set ws = wb.Sheets(\"Sheet1\")\n\n   ws.Range(\"A1:B7\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>Note that the parameters on the openworkbook such as <code>Updatelinks</code>and <code>ReadOnly</code> can be modified to <code>True</code> or <code>False</code>as you need to.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 3, "last_activity_date": 1553676210, "creation_date": 1553676210, "answer_id": 55372941, "question_id": 55372881, "link": "https://stackoverflow.com/questions/55372881/how-to-get-workbook-name-after-opening-the-workbook-using-workbooks-open/55372941#55372941", "title": "How to get Workbook Name after opening the workbook using workbooks.open?", "body": "<p>Create an object of type Excel.Workbook and open the workbook into that.</p>\n\n<p>Like so</p>\n\n<pre><code>Dim w as Excel.Workbook\nset w= Workbooks.Open (\"C:\\abc.xlsx\")\n</code></pre>\n\n<p>and then you can say</p>\n\n<pre><code>w.worksheets.add.....\n</code></pre>\n\n<p>etc</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1553678864, "creation_date": 1553678864, "answer_id": 55373744, "question_id": 55372881, "link": "https://stackoverflow.com/questions/55372881/how-to-get-workbook-name-after-opening-the-workbook-using-workbooks-open/55373744#55373744", "title": "How to get Workbook Name after opening the workbook using workbooks.open?", "body": "<p>You can shorten your code:</p>\n\n<pre><code>Option Explicit\n\nSub OpenWb()\n\n    Dim ws As Worksheet\n\n    Set ws = Workbooks.Open(\"C:\\abc.xlsx\").Worksheets(\"Sheet1\")\n\n    With ws '&lt;- Use With Statement to avoid sheet repetition\n        .Range(\"A1:B7\").ClearContents\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1553678864, "creation_date": 1553675977, "last_edit_date": 1553676142, "question_id": 55372881, "link": "https://stackoverflow.com/questions/55372881/how-to-get-workbook-name-after-opening-the-workbook-using-workbooks-open", "title": "How to get Workbook Name after opening the workbook using workbooks.open?", "body": "<pre><code>Workbooks.Open \"C:\\abc.xlsx\"\nWorkbooks(\"abc\").Worksheets(\"Sheet1\").Range(\"A1:B7\").Clear\n</code></pre>\n\n<p>In the above code I am opening the workbook  using <code>Workbooks.Open</code> in first line. In the second line I am accessing the opened workbook using the workbook name. </p>\n\n<p>How can I access the opened workbook without the filename in second line?</p>\n\n<p>(I want to create a function and I don't want to pass both the file paths and filenames separately)</p>\n"}, {"tags": ["python", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1553674785, "post_id": 55372535, "comment_id": 97467418, "body": "Have a look here: <a href=\"https://stackoverflow.com/questions/15951837/wait-for-shell-command-to-complete\" title=\"wait for shell command to complete\">stackoverflow.com/questions/15951837/&hellip;</a>."}, {"owner": {"reputation": 219, "user_id": 9805362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2ac4dc565a302b21dbf471993fff02?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia", "link": "https://stackoverflow.com/users/9805362/sonia"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1553682940, "post_id": 55372535, "comment_id": 97472224, "body": "@Sam, I have seen that stack overflow post &amp; tried also.But that was also not working"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1553693572, "post_id": 55372535, "comment_id": 97479099, "body": "The first thing to find out is if it runs synchronously or asynchronously. If you are running it asynchronously, then your msgbox will come directly, regardless of the result."}, {"owner": {"reputation": 219, "user_id": 9805362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2ac4dc565a302b21dbf471993fff02?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia", "link": "https://stackoverflow.com/users/9805362/sonia"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1553837574, "post_id": 55372535, "comment_id": 97541833, "body": "@Sam I don&#39;t think this is happening due to asynchronous run as I ran the python script first using command prompt &amp; the time taken to get the message box using VBA is slightly more than the time taken to run the code using python in command prompt. My guess is there is some issue in my VBA code."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1553861506, "post_id": 55372535, "comment_id": 97553227, "body": "Wild guesses coming... Do you have more than one python installation in your system? If so, use a fully qualified path to the one you want to use."}, {"owner": {"reputation": 219, "user_id": 9805362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2ac4dc565a302b21dbf471993fff02?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia", "link": "https://stackoverflow.com/users/9805362/sonia"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1554111908, "post_id": 55372535, "comment_id": 97618148, "body": "No I have only python 3.7 in my system"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1554117007, "post_id": 55372535, "comment_id": 97620989, "body": "Then I suggest that you try various combinations of <code>cmd &#47;c *something something*</code> and/or putting the call in a bat file."}], "owner": {"reputation": 219, "user_id": 9805362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2ac4dc565a302b21dbf471993fff02?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia", "link": "https://stackoverflow.com/users/9805362/sonia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553674556, "creation_date": 1553674556, "question_id": 55372535, "link": "https://stackoverflow.com/questions/55372535/execute-python-code-with-command-line-argument-using-vba", "title": "Execute python code with command line argument using VBA", "body": "<p>I'm trying to execute a python code with command line argument using VBA. My python file name is test.py. While I'm executing following command using command prompt </p>\n\n<pre><code>python test.py Sales\n</code></pre>\n\n<p>Then my python code process sales data &amp; store the processed output in a table in SQL server.I can able to see the uploaded data in SQL server. I would like to execute this python script using VBA. So I wrote following code</p>\n\n<pre><code>Sub executePython1()\n Dim wsh As Object\n Set wsh = CreateObject(\"WScript.Shell\")\n arg = \"Sales\"\n Dim shell_exec As Object\n Set shell_exec = wsh.Exec(\"\"\"python.exe\"\"\" &amp; \n \"\"\"C:\\x1\\test.py \"\"\" &amp; arg)\n MsgBox \"Executed\"\nEnd Sub\n</code></pre>\n\n<p>After running the code I'm seeing \"Executed\" message but I'm unable to see any data in my SQL Server table. Can you help me to resolve this issue?</p>\n\n<p>I'm working on Windows azure &amp; running python 3.7</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1553676627, "post_id": 55372530, "comment_id": 97468360, "body": "Is it necessary you have multiple similar workbooks that all hold the same code? From the looks of it you might as well use a workbook that holds the code, and execute that code for the other workbooks. If your code acts on a certain workbook, the code itself has not to be inside the same workbook."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553677035, "post_id": 55372530, "comment_id": 97468616, "body": "You could investigate the use of an add-in for the functions."}], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1553683825, "last_edit_date": 1592644375, "creation_date": 1553683825, "answer_id": 55375406, "question_id": 55372530, "link": "https://stackoverflow.com/questions/55372530/sharing-vba-modules-across-workbooks/55375406#55375406", "title": "Sharing VBA Modules across Workbooks", "body": "<p>I got an amateur fix for this kind of stuff. At my office, there are like 15 persons who share some utilities and UDFS on EXCEL. We had to change 15 Excel Workbooks when the code had to be revised or improved. Waste of time</p>\n<blockquote>\n<p>First of all, I must say that for this solution to work, all users\nneeds to share a folder where you can put a shared workbook for\neveryone to access. <strong>If users cannot share anything, then this solution\nwon't work.</strong></p>\n</blockquote>\n<p>We found an easy solution for us. <strong>I'm pretty sure there is, indeed, a better way to do this, and more elegant</strong>, but this works for us for the last 10 years and we've had enough.</p>\n<p>We created a <strong>MASTER WORKBOOK</strong> with all subs and functions we needed. I'll make a quick example. This master workbook is named MASTER_WB (title of VBAProject is also MASTER_WB)</p>\n<p><a href=\"https://i.stack.imgur.com/qkKHQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qkKHQ.jpg\" alt=\"enter image description here\" /></a></p>\n<p>This MASTER_WB would hold all your utilities and common codes. As you can see in the image, I typed 1 sub and 1 UDF really simple (as <code>Public</code>, to be called from anywhere).</p>\n<p>Also, I strongly recommend to use MW initials in every sub/Function you type in MASTER_WB. That way you make 100% sure there is no conflict of names between USER_WB and MASTER_WB calling same procedure. <strong>This is just a personal fixation.</strong></p>\n<p>In this MASTER_WB, the relevant code is in the workbook object:</p>\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nThisWorkbook.Saved = True\nEnd Sub\n\nPrivate Sub Workbook_Open()\nIf Application.Workbooks.Count &gt; 2 Then '2 BECAUSE I got also PERSONAL MACRO WORKBOOK\n    ThisWorkbook.IsAddin = True\nElse\n    ThisWorkbook.IsAddin = False\nEnd If\nEnd Sub\n</code></pre>\n<p>Now we save and close MASTER_WB and then in every USER_WB in a module we add the newly created MASTER_WB as a reference:</p>\n<p><a href=\"https://i.stack.imgur.com/h8akB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h8akB.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Notice that in every USER_WB we also type codes to call those public subs and UDF we created in MASTER_WB:</p>\n<pre><code>Option Explicit\n\nSub ESTE_LIBRO()\nCall MASTER_UTILITIES.MW_ESTE_LIBRO(ThisWorkbook)\nEnd Sub\n\nFunction PORTRES(vRNG As Range) As Double\nPORTRES = MASTER_UTILITIES.MW_PORTRES(vRNG)\nEnd Function\n</code></pre>\n<p>And that would be all! Now every USER_WB can access the UDF and subs stored in MASTER_WB. And when we need to make an update/change, we just update MASTER_WB.</p>\n<p>If we create a <strong>new</strong> UDF/SUB, then yes, it needs to be created in both workbooks. MASTER_WB would hold the code itself and <strong>every USER_WB needs to add in their modules something like:</strong></p>\n<pre><code>Sub MY_NEW_SUB()\nCall MASTER_UTILITIES.MY_NEW_SUB\nEnd Sub\n</code></pre>\n<p>Also, if parameters/arguments of a sub/udf change, yes, you also need to update every USER_WB.</p>\n<p>But believe me when I say is worth it, at least in our office, because those cases are uncommon. The most usual one is just improving/adding new line of codes, so updating MASTER_WB will make the new code available for all USER_WB connected, without doing it 15 times.</p>\n<p>As I said in first line. this solution <strong>is not</strong> the most elegant one, and for sure there is a better one, but I can tell it works for us. I would like to learn some day about developing add-ins, but for now, we use this amateur fix.</p>\n<p>Hope you can adapt this to your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 2, "last_activity_date": 1553684075, "creation_date": 1553684075, "answer_id": 55375475, "question_id": 55372530, "link": "https://stackoverflow.com/questions/55372530/sharing-vba-modules-across-workbooks/55375475#55375475", "title": "Sharing VBA Modules across Workbooks", "body": "<p>Move the code into a separate Excel workbook and save it as <code>.xlam</code> (Excel macro-enabled add-in).</p>\n\n<p>Reference the add-in from all the other files' Tools - References (click Browse, change the file type to \"Microsoft Excel files\" and navigate to the xlam file).</p>\n\n<p>Go through the code and make sure it is written correctly and properly references workbooks and worksheets. E.g. <code>ThisWorkbook</code> will now refer to the add-in workbook, not to the document calling it.</p>\n"}], "owner": {"reputation": 105, "user_id": 6567469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627a5a59fc9106281270f92efd5c2a5e?s=128&d=identicon&r=PG&f=1", "display_name": "user40966", "link": "https://stackoverflow.com/users/6567469/user40966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2347, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1553684075, "creation_date": 1553674525, "question_id": 55372530, "link": "https://stackoverflow.com/questions/55372530/sharing-vba-modules-across-workbooks", "title": "Sharing VBA Modules across Workbooks", "body": "<p>I have a number of workbooks. Each workbook contains a number of spreadsheets, and all workbooks are exactly the same, except for the data they carry. Each workbook has a number of VBA modules, and when I make changes to one module, I then need to push the same changes to all other modules to all other workbooks. </p>\n\n<p>Is there a way to share the VBA modules across all of my Workbooks, so I can make changes only in one place?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "is_accepted": false, "score": 0, "last_activity_date": 1553673493, "creation_date": 1553673493, "answer_id": 55372278, "question_id": 55371677, "link": "https://stackoverflow.com/questions/55371677/cannot-merge-excel-files-with-same-worksheet-name/55372278#55372278", "title": "Cannot merge Excel files with same worksheet name", "body": "<p>In Excel2016 this issue cannot be re-created, as Excel automatically adds \"(1)\", \"(2)\"... to the name of a sheet that has a same name as copied sheet.</p>\n\n<p>If you are using an older version of Excel, solving this issue would require to re-create this behavior.</p>\n\n<p>To rename a sheet I'm referencing this answer: <a href=\"https://stackoverflow.com/questions/40464553/excel-rename-sheet-with-if-sheet-name-already-exists\">Excel rename sheet with if sheet name already exists</a></p>\n\n<p>Create a new function to check worksheet names in both workbooks:</p>\n\n<pre><code>Private Function VerifySheetName(ByVal sourceWorkbook As Workbook, ByVal targetWorkbook As Workbook, ByVal sheetName As String) As String\nDim combinedSheets As New Collection\nDim tempSheet As Worksheet\n\nFor Each tempSheet In sourceWorkbook.Sheets\n    combinedSheets.Add tempSheet\nNext tempSheet\n\nFor Each tempSheet In targetWorkbook.Sheets\n    combinedSheets.Add tempSheet\nNext tempSheet\n\nFor Each tempSheet In combinedSheets\n    If tempSheet.Name = sheetName Then\n        VerifySheetName = sheetName &amp; \"_\" &amp; combinedSheets.Count\n    End If\nNext tempSheet\n\nEnd Function\n</code></pre>\n\n<p>Call this function in your loop:</p>\n\n<pre><code>For Each wksCurSheet In wbkSrcBook.Sheets\ntempSheetName = VerifySheetName(wbkSrcBook, wbkCurBook, wksCurSheet.Name)\nIf Not wksCurSheet.Name = tempSheetName Then\n    wksCurSheet.Name = tempSheetName\nEnd If\n\ncountSheets = countSheets + 1\nwksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\nNext \n</code></pre>\n\n<p>And don't forget to add new variable declaration if you're using <code>Option Explicit</code> (you should!)</p>\n\n<pre><code>Dim tempSheetName As String\n</code></pre>\n\n<p>P.S.\nWhen initiating multiple variables in the same line, if you omit the variable type, by default it's cast as variant:</p>\n\n<pre><code>Dim countFiles, countSheets As Integer\n</code></pre>\n\n<p>In this case, countFiles is of variant type ans countSheets is of integer type. If you need explicit variably type, you need to assign type to each variable:</p>\n\n<pre><code>Dim countFiles as Integer, countSheets As Integer\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6338879, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dz02ruBQ5mo/AAAAAAAAAAI/AAAAAAAAAYY/FNa-NzbwYWs/photo.jpg?sz=128", "display_name": "KereX", "link": "https://stackoverflow.com/users/6338879/kerex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553674235, "creation_date": 1553670845, "last_edit_date": 1553674235, "question_id": 55371677, "link": "https://stackoverflow.com/questions/55371677/cannot-merge-excel-files-with-same-worksheet-name", "title": "Cannot merge Excel files with same worksheet name", "body": "<p>I am quite new to VB coding and am attempting to merge Excel spreadsheets then combine the data into one spreadsheet. I found <a href=\"https://www.ablebits.com/office-addins-blog/2017/11/08/merge-multiple-excel-files-into-one/\" rel=\"nofollow noreferrer\">this code</a> that worked perfectly until I encountered files that had the same worksheet name.</p>\n\n<pre><code>Sub MergeExcelFiles()\nDim fnameList, fnameCurFile As Variant\nDim countFiles, countSheets As Integer\nDim wksCurSheet As Worksheet\nDim wbkCurBook, wbkSrcBook As Workbook\n\nfnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\nIf (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n    If (UBound(fnameList) &gt; 0) Then\n        countFiles = 0\n        countSheets = 0\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n        Set wbkCurBook = ActiveWorkbook\n\n        For Each fnameCurFile In fnameList\n            countFiles = countFiles + 1\n\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                countSheets = countSheets + 1\n                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n            Next\n\n            wbkSrcBook.Close SaveChanges:=False\n\n        Next\n\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n\n        MsgBox \"Processed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n    End If\n\nElse\n    MsgBox \"No files selected\", Title:=\"Merge Excel files\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>When running this code I get a </p>\n\n<blockquote>\n  <p>run-time error '1004': \n  Cannot rename a sheet to the same as another sheet, a referenced object library or a workbook referenced by Visual Basic.</p>\n</blockquote>\n\n<p>I would like assistance in renaming the worksheets as they get imported.</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1553668795, "post_id": 55371157, "comment_id": 97464801, "body": "Step through the code and see which line is giving you the error"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1553668871, "post_id": 55371157, "comment_id": 97464840, "body": "Then update your question with the error and the line it occurrs on..."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1553670324, "post_id": 55371157, "comment_id": 97465408, "body": "The length of the code is not a problem. My largest project may hold 30 times as much code as in your example. Sometimes, lines of code cause Excel to crash. In rare cases, the workbook is corrupted. I&#39;d do what @SiddharthRout suggested and step through the code using <code>F8</code>"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1553670834, "post_id": 55371157, "comment_id": 97465608, "body": "NOt sure if it&#39;ll help, but I&#39;ve seen cases where using RowSource causes havoc. Best to use <code>List7880.List = Range(&quot;acct7880&quot;).Value</code>"}, {"owner": {"reputation": 1, "user_id": 11264224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-72mji5IP9_M/AAAAAAAAAAI/AAAAAAAAB3I/JNOkDAdh_88/photo.jpg?sz=128", "display_name": "Tim Snow", "link": "https://stackoverflow.com/users/11264224/tim-snow"}, "edited": false, "score": 0, "creation_date": 1553692093, "post_id": 55371157, "comment_id": 97478062, "body": "If I step through the VBA code I never receive any error. Only when I try to run it from ActiveX Macro Button or select run in the VBA Macros menu. Also, I only provided the snippets of code that I thought might be causing the problem and where the error is found. Entire Userform code lines are 7,175. I will try switching the Rowsource to .list"}], "owner": {"reputation": 1, "user_id": 11264224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-72mji5IP9_M/AAAAAAAAAAI/AAAAAAAAB3I/JNOkDAdh_88/photo.jpg?sz=128", "display_name": "Tim Snow", "link": "https://stackoverflow.com/users/11264224/tim-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553668468, "creation_date": 1553668468, "question_id": 55371157, "link": "https://stackoverflow.com/questions/55371157/microsoft-excel-encounters-error-after-opening-userform-or-running-a-long-sectio", "title": "Microsoft Excel Encounters Error after opening userform or running a long section of code. Is there a fix?", "body": "<p>I had no problems with my VBA user form until recently but based on some piece of code or the sheer length of the code is causing Excel to crash when attempting to run. This form is used to gather information from budget owners who we need to supply more information than just financial and we wish them to not have to make any major calculations. \n  Recently, when I launch the code the workbook goes white and says Excel has encountered an error and gives me the option to recover the file.\n(unsure if this is related but it seems that my code may be preventing the user from hitting the x in the excel application nor allowing them to user the save as button. When they click nothing happens)</p>\n\n<p>I have tried previous versions with success on the oldest files which did not contain many lines of code, no close user form feature, and no save user form feature.\nIf I step through or open Visual Basic window prior to running code I experience no issues.\nIf I save the file as a different file immediately after opening workbook then it works everytime.</p>\n\n<pre><code>Sub Call_Userform()\n'Unhide All sheets    \nCall unhidesheets\nSheets(\"Headcount\").Select\n\n'Opens the Userform\nTest.Show\nEnd Sub\n_________________________________________________________\nSub unhidesheets()\n'Variables\nDim ws As Worksheet\n'Unhide sheets\nApplication.ScreenUpdating = False\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Visible = xlSheetVisible\nNext ws\nApplication.ScreenUpdating = True\nEnd Sub\n__________________________________________________________\nPrivate Sub UserForm_Initialize()\n'Variables\nDim ws As Worksheet\nSet ws = Worksheets(\"Data\")\n\n'Department specific accounts allowed\nIf ws.Range(\"B1\").Value = \"625 - Bedre Manufacturing\" Then\n   Me.MultiPage1.Pages(8).Visible = True 'Product Development\nElseIf ws.Range(\"D1\").Value = \"217 - Business Support Center\" Then\n   Me.MultiPage1.Pages(8).Visible = True 'Product Development\nElseIf ws.Range(\"D1\").Value = \"216 - Health Branding\" Then\n   Me.MultiPage1.Pages(8).Visible = True 'Product Development\nElseIf ws.Range(\"D1\").Value = \"964 - Outreach\" Then\n   Me.MultiPage1.Pages(8).Visible = True 'Product Development\nElseIf ws.Range(\"B1\").Value = \"978 - Tribal Health\" Then\n   Me.Trvlexp.Visible = True 'Travel Expense\n   Me.trvlexpenselbl.Visible = True 'Travel Expense label\nElseIf ws.Range(\"D1\").Value = \"103 - Deputy Secretary of Commerce\" Then\n   Me.Trvlexp.Visible = True 'Travel Expense\n   Me.trvlexpenselbl.Visible = True 'Travel Expense label\nElse\n   Me.MultiPage1.Pages(8).Visible = False 'Product Development\n   Me.Trvlexp.Visible = False 'Travel Expense\n   Me.trvlexpenselbl.Visible = False 'Travel Expense label\nEnd If\n\n'Populate lists with present data\nIf ws.Range(\"J2\") &gt; 0 Then\n    List7005.RowSource = \"acct7005\"\nEnd If\nIf ws.Range(\"J3\") &gt; 0 Then\n    Listtrvl.RowSource = \"accttrvl\"\nEnd If\n    If ws.Range(\"J4\") &gt; 0 Then\n    List7120_1.RowSource = \"VehTag\"\nEnd If\nIf ws.Range(\"J5\") &gt; 0 Then\n    List7120.RowSource = \"acct7120\"\nEnd If\nIf ws.Range(\"J6\") &gt; 0 Then\n    List7200.RowSource = \"acct7200\"\nEnd If\nIf ws.Range(\"J7\") &gt; 0 Then\n    List7230.RowSource = \"acct7230\"\nEnd If\nIf ws.Range(\"J8\") &gt; 0 Then\n    List7270.RowSource = \"acct7270\"\nEnd If\nIf ws.Range(\"J9\") &gt; 0 Then\n    List7330.RowSource = \"acct7330\"\nEnd If\nIf ws.Range(\"J10\") &gt; 0 Then\n    List7335.RowSource = \"acct7335\"\nEnd If\nIf ws.Range(\"J11\") &gt; 0 Then\n    Costs7510.RowSource = \"Phonecosts\"\nEnd If\nIf ws.Range(\"J12\") &gt; 0 Then\n    List7620.RowSource = \"acct7620\"\nEnd If\nIf ws.Range(\"J13\") &gt; 0 Then\n   List7640.RowSource = \"acct7640\"\nEnd If\nIf ws.Range(\"J14\") &gt; 0 Then\n    List7670.RowSource = \"acct7670\"\nEnd If\nIf ws.Range(\"J15\") &gt; 0 Then\n    List7710.RowSource = \"acct7710\"\nEnd If\nIf ws.Range(\"J16\") &gt; 0 Then\n    List7780.RowSource = \"acct7780\"\nEnd If\nIf ws.Range(\"J17\") &gt; 0 Then\n    List7790.RowSource = \"acct7790\"\nEnd If\nIf ws.Range(\"J23\") &gt; 0 Then\n    List7790_1.RowSource = \"Vehlease\"\nEnd If\nIf ws.Range(\"J18\") &gt; 0 Then\n    List7880.RowSource = \"acct7880\"\nEnd If\nIf ws.Range(\"J19\") &gt; 0 Then\n    List2000.RowSource = \"acct2000\"\nEnd If\n\n'Bring in last records\nIf Worksheets(\"Headcount\").Range(\"B1\").Value = \"\" Then\nElse\nMe.cb_bus = Worksheets(\"Headcount\").Range(\"B1\").Value\nMe.cb_dept = Worksheets(\"Headcount\").Range(\"D1\").Value\n'Report Kronos date\nMe.tb_test.Value = Worksheets(\"Headcount\").Range(\"I1\").Value\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub    \n_________________________________________________________________\nPrivate Sub cbsave_Click()\nfileSaveName = Application.GetSaveAsFilename( _\nfileFilter:=\"Text Files (*.xlsm), *.xlsm\")\nIf fileSaveName &lt;&gt; False Then\nActiveWorkbook.SaveAs _\n    Filename:=fileSaveName, _\n    FileFormat:=xlOpenXMLWorkbookMacroEnabled\nEnd If\n\nEnd Sub\n__________________________________________________________________\nPrivate Sub closeform_Click()\n'Variables\n Dim ws As Worksheet\n'Hide sheets\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Visible = xlSheetHidden\n    Sheets(\"Start and Instructions\").Visible = True\nNext ws\nIf Sheets(\"Start and Instructions\").Range(\"CA1\").Value = \"Complete\" Then\n    Sheets(\"TM1 Upload\").Visible = True\n    Sheets(\"CapEx\").Visible = True\n    Sheets(\"TM1 Upload\").Select\nEnd If\n\n'Close User Form\nHide\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553776964, "post_id": 55382374, "comment_id": 97515936, "body": "Hi Tony, thank you for your effort. However you are aware that in the code the olFreeBusyAndSubject is only and constant 1 or 2 as described above. Changing to olFullDetails still results in a 1 or 2. And 1 results in only Free/Busy being exported and a 2 that all details are exported. I hope I have not misunderstood you."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553777950, "post_id": 55382374, "comment_id": 97516640, "body": "@Tune .CalendarDetail only has three options: (0) Free Busy Only, (1) Free Busy and Subject and (2) Full Details.  If you want a different level of detail, you will have to create the report yourself.  You could create the full report then extract the details you want to share.  Alternatively, you could generate the report yourself.  Somewhere I have a routine that demonstrates how to decode calendar entries.  If you think that would be useful, I will search for it."}, {"owner": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553778939, "post_id": 55382374, "comment_id": 97517289, "body": "Thank you Tony. Than it is a bit more complicated than I had hoped. I&#39;d like option (1) but also the location of meeting."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553797532, "post_id": 55382374, "comment_id": 97529494, "body": "Having tried your code, I cannot see the issue.  I agree &quot;Free Busy and Subject&quot; does not include Location while &quot;Full Details&quot; does.  However, my &quot;Full Details&quot; listing does not contain much more than &quot;Free Busy, Subject and Location&quot;.  I am retired so my calendar does not contain everything that could be in a calendar item.  What is in your &quot;Full Details&quot; listing that you would want omitted?"}, {"owner": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553797906, "post_id": 55382374, "comment_id": 97529677, "body": "In the Full Details it also includes all information ,text etc in the meeting details. (Describing the topic agenda etc). This could be sensitive information and not allowed to be shared to an external email account."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1553816078, "post_id": 55382374, "comment_id": 97537165, "body": "@Tune My brief investigation suggests option 1 should not be too difficult.  My emails have a brief entry (date &amp; time, subject and location) for each calendar entry followed by the header &quot;Details&quot; followed by a detailed entry for each calendar entry which contains a repeat of the brief entry and any extra information.  Does this match your emails?  Deleting everything after the header &quot;Details&quot; would be easy.  Deleting the links from the brief entries to the detailed entries would be a little more difficult but not impossibly difficult.  Would this meet your requirement?"}, {"owner": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1554565436, "post_id": 55382374, "comment_id": 97802731, "body": "Sorry for my late answer. Removing everything from &quot;Details&quot; and down, but actually I would need to have the same change in the attached Ics-file and not only the email body. The reason for that is to easily have the info into Google calendar. Thank you again for your effort!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1554577227, "post_id": 55382374, "comment_id": 97806126, "body": "@Tune I had not noticed the ICS attachment since it is at the bottom of a long list of GIF attachments."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1554577262, "post_id": 55382374, "comment_id": 97806135, "body": "An ICS file is a text file.  Each line is of the format &quot;XXXXXX:value&quot; where XXXXXX identifies the type of the value.  Examples of &quot;XXXXXX&quot; are: &quot;LOCATION&quot;, &quot;DESCRIPTION&quot; and &quot;X-ALT-DESC;FMTTYPE=text/html&quot;.  The values for &quot;LOCATION&quot; and &quot;DESCRIPTION&quot; are unchanged from the Outlook calendar item.  The value for &quot;X-ALT-DESC;FMTTYPE=text/html&quot; seems to be an Html version of the &quot;DESCRIPTION&quot; split into lines.  Apparently with Outlook 2013 you would always see the &quot;X-ALT-DESC;FMTTYPE=text/html&quot; version of description but with Outlook 2016 you would see the &quot;DESCRIPTION&quot; version."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "edited": false, "score": 0, "creation_date": 1554577523, "post_id": 55382374, "comment_id": 97806212, "body": "This change from Outlook 2013 to Outlook 2016 was being treated as a bug in 2016 so it might have been fixed.  Deleting both descriptions does not look too difficult.  Would this give you what you need?"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1553704785, "creation_date": 1553704785, "answer_id": 55382374, "question_id": 55370950, "link": "https://stackoverflow.com/questions/55370950/script-to-send-outlook-calendar-by-e-mail-change-detail-level/55382374#55382374", "title": "Script to send Outlook calendar by e-mail, change detail level?", "body": "<p>In <code>.CalendarDetail = olFreeBusyAndSubject</code> replace <code>olFreeBusyAndSubject</code> by <code>olFullDetails</code>.</p>\n\n<p>To discover this I used Bing and searched for \"Outlook CalendarDetail\".  I find this an easy method for discovering the permitted values for a property.</p>\n"}], "owner": {"reputation": 1, "user_id": 3426470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be31567f1e30026ee3eb9d9c59b4da73?s=128&d=identicon&r=PG", "display_name": "Tune", "link": "https://stackoverflow.com/users/3426470/tune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592684478, "creation_date": 1553667566, "last_edit_date": 1592684478, "question_id": 55370950, "link": "https://stackoverflow.com/questions/55370950/script-to-send-outlook-calendar-by-e-mail-change-detail-level", "title": "Script to send Outlook calendar by e-mail, change detail level?", "body": "<p>I have a script found on <a href=\"https://www.crestwood.com/2018/08/17/automating-outlook-calendar-to-send-daily-agenda/\" rel=\"nofollow noreferrer\">https://www.crestwood.com/2018/08/17/automating-outlook-calendar-to-send-daily-agenda/</a>. This works but I can not control the details of the calendar. Or more correctly I can't figure out how to send <strong>Meeting subject and Location</strong>. </p>\n\n<p>Is there a way with this code? Or could I go about it in some other way?\nWhen doing it manually in Outlook it is called \"Limited details\" - this is my desired outcome.</p>\n\n<p>I can change the constant: olFreeBusyAndSubject between 0, 1, 2. But none of these return my desired outcome. They result in (only seeing busy/free, Only seeing subject, Full details including description of event). I do not want full details since their might be sensitive information which I do not want on my secondary e-mail.</p>\n\n<pre><code>' -------------------------------------------------\n' Modify this \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n\nConst myEmailAddress = \"some@email.com\"\n\nConst includePrivateDetails = TRUE\n\nConst howManyDaysToDisplay = 1\n\n' Modify this /////////////////////////////////////\n\n' -------------------------------------------------\n\nConst olCalendarMailFormatDailySchedule = 0\n\nConst olFreeBusyAndSubject = 2\n\n' Const olFullDetails = 1\n\nConst olFolderCalendar = 9\n\nSendCalendar myEmailAddress, Date, (Date + (howManyDaysToDisplay - 1))\n\nSub SendCalendar(strAdr, datBeg, datEnd)\n\nDim olkApp, olkSes, olkCal, olkExp, olkMsg\n\nSet olkApp = CreateObject(\"Outlook.Application\")\n\nSet olkSes = OlkApp.GetNameSpace(\"MAPI\")\n\nolkSes.Logon olkApp.DefaultProfileName\n\nSet olkCal = olkSes.GetDefaultFolder(olFolderCalendar)\n\nSet olkExp = olkCal.GetCalendarExporter\n\nWith olkExp\n\n.CalendarDetail = olFreeBusyAndSubject\n\n.IncludePrivateDetails = includePrivateDetails\n\n.RestrictToWorkingHours = False\n\n.StartDate = datBeg\n\n.EndDate = datEnd\n\nEnd With\n\nSet olkMsg = olkExp.ForwardAsICal(olCalendarMailFormatDailySchedule)\n\nWith olkMsg\n\n.To = strAdr\n\n.Send\n\nEnd With\n\nSet olkCal = Nothing\n\nSet olkExp = Nothing\n\nSet olkMsg = Nothing\n\nolkSes.Logoff\n\nSet olkSes = Nothing\n\nSet olkApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>As described desired outcome is to thorugh a VBA-script (or other automated way) send \"Limited details\"-Outlook-calendar by e-mail.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["asp.net", ".net", "vba", "vb.net", "thread-sleep"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6434233, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-yhgVfkobWjA/AAAAAAAAAAI/AAAAAAAAABU/CkSkttCqTgE/photo.jpg?sz=128", "display_name": "dasran rajlui", "link": "https://stackoverflow.com/users/6434233/dasran-rajlui"}, "is_accepted": true, "score": 0, "last_activity_date": 1554103655, "creation_date": 1554103655, "answer_id": 55449991, "question_id": 55370944, "link": "https://stackoverflow.com/questions/55370944/thread-sleep-with-timer-for-schedule/55449991#55449991", "title": "Thread.Sleep () with Timer for schedule", "body": "<p>i found the answer, below is the way to fix the issue.</p>\n\n<pre><code>       Private WithEvents tmr_Imp_Pms_File As New Timers.Timer(950) 'for PMS File\n\n       Private Sub tmr_Imp_Pms_File_Elasped(ByVal sender As System.Object, ByVal e As Timers.ElapsedEventArgs) Handles tmr_Imp_Pms_File.Elapsed\n\n            Select Case .Enable_Schedule\n                       Case 1 ' Schedule - Daily Option\n                           If .Enable_Daily_Option_1 = 1 Then\n                               If _\n                                   TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                                   TimeSerial(.Daily_Option_1_Time.Hour, .Daily_Option_1_Time.Minute,\n                                              .Daily_Option_1_Time.Second) Then\n\n\n                               logger.log.Info(\"Daily Schedule Option 2 Hit, \" &amp; Now.ToString(\"HH:mm:ss.fff\"))\n\n                               tmr_Imp_Pms_File.Stop() : Thread.Sleep(50)\n\n                               End If\n                           End If\n\n\n                           If .Enable_Daily_Option_2 = 1 Then\n                               If _\n                                   TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                                   TimeSerial(.Daily_Option_2_Time.Hour, .Daily_Option_2_Time.Minute,\n                                              .Daily_Option_2_Time.Second) Then\n\n\n                               logger.log.Info(\"Daily Schedule Option 2 Hit, \" &amp; Now.ToString(\"HH:mm:ss.fff\"))\n\n                               tmr_Imp_Pms_File.Stop() : Thread.Sleep(50)\n\n                               End If\n                           End If\n\n\n                           If .Enable_Daily_Option_3 = 1 Then\n                               If _\n                                   TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                                   TimeSerial(.Daily_Option_3_Time.Hour, .Daily_Option_3_Time.Minute,\n                                              .Daily_Option_3_Time.Second) Then\n\n\n                               logger.log.Info(\"Daily Schedule Option 2 Hit, \" &amp; Now.ToString(\"HH:mm:ss.fff\"))\n\n                               tmr_Imp_Pms_File.Stop() : Thread.Sleep(50)\n\n                               End If\n                           End If\n            End Select\n\n               End Sub\n   ```\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6434233, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-yhgVfkobWjA/AAAAAAAAAAI/AAAAAAAAABU/CkSkttCqTgE/photo.jpg?sz=128", "display_name": "dasran rajlui", "link": "https://stackoverflow.com/users/6434233/dasran-rajlui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55449991, "answer_count": 1, "score": 0, "last_activity_date": 1554103655, "creation_date": 1553667547, "last_edit_date": 1553760128, "question_id": 55370944, "link": "https://stackoverflow.com/questions/55370944/thread-sleep-with-timer-for-schedule", "title": "Thread.Sleep () with Timer for schedule", "body": "<p>I have a select case of options which can run according to the set schedules. Therefore, I've written the code provided below.</p>\n\n<pre><code>Private WithEvents tmr_Imp_Pms_File As New Timers.Timer(950) 'for PMS File\n\nPrivate Sub tmr_Imp_Pms_File_Elasped(ByVal sender As System.Object, ByVal e As Timers.ElapsedEventArgs) Handles tmr_Imp_Pms_File.Elapsed\n\nThread.Sleep(50)\n\n     Select Case .Enable_Schedule\n                Case 1 ' Schedule - Daily Option\n                    If .Enable_Daily_Option_1 = 1 Then\n                        If _\n                            TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                            TimeSerial(.Daily_Option_1_Time.Hour, .Daily_Option_1_Time.Minute,\n                                       .Daily_Option_1_Time.Second) Then\n\n                            logger.log.Info(\"Checking Running Daily Schedule Option 1, \" &amp; Now.ToString)\n\n                        End If\n                    End If\n\n\n                    If .Enable_Daily_Option_2 = 1 Then\n                        If _\n                            TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                            TimeSerial(.Daily_Option_2_Time.Hour, .Daily_Option_2_Time.Minute,\n                                       .Daily_Option_2_Time.Second) Then\n\n                            logger.log.Info(\"Checking Running Daily Schedule Option 2, \" &amp; Now.ToString)\n\n                        End If\n                    End If\n\n\n                    If .Enable_Daily_Option_3 = 1 Then\n                        If _\n                            TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                            TimeSerial(.Daily_Option_3_Time.Hour, .Daily_Option_3_Time.Minute,\n                                       .Daily_Option_3_Time.Second) Then\n\n                            logger.log.Info(\"Checking Running Daily Schedule Option 3, \" &amp; Now.ToString)\n\n                        End If\n                    End If\n     End Select\n\n        End Sub\n\n</code></pre>\n\n<p>Here I have 3 options of schedule,  I enable all 3 schedules for my program to run. But there is a random and rarely happened issue where the program will skip the second option from running. I believe it is something to do with this part shown below.</p>\n\n<pre><code> \" TimeSerial(Now.Hour, Now.Minute, Now.Second) =\n                        TimeSerial(.Daily_Option_1_Time.Hour, .Daily_Option_1_Time.Minute,\n                                   .Daily_Option_1_Time.Second) Then\"\n</code></pre>\n\n<p>How may I enhance this piece of code to solve the issue?\nAre there any other ways to write the code? \"I know there are...\" but can someone show me some example of a better way to handle this issue.</p>\n\n<p>Appreciate your help, thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "colors", "row"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1553668284, "post_id": 55370888, "comment_id": 97464595, "body": "<a href=\"https://stackoverflow.com/questions/15887257/how-to-count-up-text-of-a-different-font-colour-in-excel\" title=\"how to count up text of a different font colour in excel\">stackoverflow.com/questions/15887257/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553670751, "creation_date": 1553670751, "answer_id": 55371646, "question_id": 55370888, "link": "https://stackoverflow.com/questions/55370888/vba-remove-rows-that-have-every-cell-in-the-range-that-contain-black-text/55371646#55371646", "title": "VBA - Remove rows that have every cell in the range that contain black text", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        For i = 2000 To 2 Step -1\n\n            If .Range(\"C\" &amp; i).Value = \"\" And .Range(\"D\" &amp; i).Value = \"\" And .Range(\"E\" &amp; i).Value = \"\" And .Range(\"F\" &amp; i).Value = \"\" _\n                And .Range(\"G\" &amp; i).Value = \"\" And .Range(\"H\" &amp; i).Value = \"\" And .Range(\"I\" &amp; i).Value = \"\" And .Range(\"J\" &amp; i).Value = \"\" Then\n\n                .Rows(i).Delete\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11262953"}, "is_accepted": false, "score": 0, "last_activity_date": 1553674069, "creation_date": 1553674069, "answer_id": 55372413, "question_id": 55370888, "link": "https://stackoverflow.com/questions/55370888/vba-remove-rows-that-have-every-cell-in-the-range-that-contain-black-text/55372413#55372413", "title": "VBA - Remove rows that have every cell in the range that contain black text", "body": "<p>You can use AutoFilter to filter by font color. It does not matter whether the color was derived by manual formatting or conditional formatting.</p>\n\n<p>In your case, you are 'proofing a negative' across many columns. A helper column appears necessary. The code below cycles through columns C:J and marks the 'helper' column every time it encounters filtered rows with a red font.</p>\n\n<pre><code>Sub anyRedFont()\n\n    Dim c As Long\n\n    With Worksheets(\"sheet1\")\n\n        'remove any AutoFilters\n        If .AutoFilterMode Then .AutoFilterMode = False\n\n        'insert a 'helper' column and label it\n        .Columns(\"C\").Insert\n        .Cells(1, \"C\") = \"helper\"\n\n        'filter for red font color\n        With .Range(Cells(1, \"C\"), .Cells(.Rows.Count, \"K\").End(xlUp))\n\n            'cycle through columns looking for red font\n            For c = 2 To 9\n\n                'fliter for red font\n                .AutoFilter Field:=c, Criteria1:=vbRed, _\n                            Operator:=xlFilterFontColor, VisibleDropDown:=False\n\n                'put a value into the 'helper' column\n                On Error Resume Next\n                With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                    Debug.Print .SpecialCells(xlCellTypeVisible).Address(0, 0)\n                    .SpecialCells(xlCellTypeVisible) = 1\n                End With\n                On Error GoTo 0\n\n                'remove fliter for red font\n                .AutoFilter Field:=c\n\n            Next c\n\n            'fliter for non-blank helper column\n            .AutoFilter Field:=1, Criteria1:=1, VisibleDropDown:=False\n\n        End With\n\n        'Do your work with the rows containing at least one cell\n        'with red font here\n\n        'remove 'helper' column\n        'this removes the AutoFilter since the 'helper' column\n        'is the primary filter column at this point\n        '.Columns(Application.Match(\"helper\", .Rows(1), 0)).Delete\n\n        'remove AutoFilter (manually with Data, Data Tools, Clear)\n        'If .AutoFilterMode Then .AutoFilterMode = False\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've commented out removing the 'helper' column. The 'helper' is the primary filter column so removing it also removes the AutoFilter.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553689072, "post_id": 55373585, "comment_id": 97476022, "body": "This code nearly does the job! Sometimes my data has blank cells I found, so a row the has black text cells and blank cells need to be removed?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553714879, "post_id": 55373585, "comment_id": 97491995, "body": "@RailMan ok but I\u2019m not sure I follow. Even if you have blank cells, if the text color is black for all cells, it should remove the line. Is that not happening?"}, {"owner": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553720392, "post_id": 55373585, "comment_id": 97494591, "body": "Yep so what I mean is that some rows have cells that contain black text and cells that are just blank. Those rows still remain (but I need them removed). So far only the rows that have every cell containing black text are being removed. Those that make sense?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553720462, "post_id": 55373585, "comment_id": 97494625, "body": "@RailMan yep, 100%. The cell itself, if not touched must not have the color black set ... or something. I\u2019ll get back to you with the fix."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553720832, "post_id": 55373585, "comment_id": 97494796, "body": "@RailMan I updated the answer. You may need to delete and put back the double quotes, I changed the answer on my phone and they look a bit weird."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553721953, "post_id": 55373585, "comment_id": 97495337, "body": "@RailMan scrap that, I found a way to fix the quotes. The good old copy/paste! :-)"}, {"owner": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "edited": false, "score": 0, "creation_date": 1553746043, "post_id": 55373585, "comment_id": 97501272, "body": "Yep that seems to do what I need - thanks greatly for that!"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553721918, "last_edit_date": 1553721918, "creation_date": 1553678360, "answer_id": 55373585, "question_id": 55370888, "link": "https://stackoverflow.com/questions/55370888/vba-remove-rows-that-have-every-cell-in-the-range-that-contain-black-text/55373585#55373585", "title": "VBA - Remove rows that have every cell in the range that contain black text", "body": "<p>I may as well offer another opinion, just for fun.  :-)</p>\n\n<p>Copy and paste the below into a new module, select the area of cells you want to run this over and then execute the macro.</p>\n\n<pre><code>Public Sub RemoveAllRowsWithBlackText()\n    Dim rngCells As Range, bFoundNonBlack As Boolean, lngRow As Long\n    Dim lngCol As Long\n\n    Set rngCells = Selection\n\n    Application.ScreenUpdating = False\n\n    With rngCells\n        For lngRow = .Rows.Count To 1 Step -1\n            bFoundNonBlack = False\n\n            For lngCol = 1 To .Columns.Count\n                If .Cells(lngRow, lngCol).Font.Color &lt;&gt; 0 And Trim(.Cells(lngRow, lngCol)) &lt;&gt; \"\" Then\n                    bFoundNonBlack = True\n                    Exit For\n                End If\n            Next\n\n            If Not bFoundNonBlack Then\n                .Cells(lngRow, lngCol).EntireRow.Delete xlShiftUp\n            End If\n        Next\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>... it's not bound to your columns, it will move with the selection you make.</p>\n\n<p><a href=\"https://i.stack.imgur.com/iHyRR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iHyRR.jpg\" alt=\"Select Cells\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 11242718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14a3778686deb5c68fe72b669955e547?s=128&d=identicon&r=PG&f=1", "display_name": "RailMan", "link": "https://stackoverflow.com/users/11242718/railman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55373585, "answer_count": 3, "score": 0, "last_activity_date": 1553721918, "creation_date": 1553667319, "question_id": 55370888, "link": "https://stackoverflow.com/questions/55370888/vba-remove-rows-that-have-every-cell-in-the-range-that-contain-black-text", "title": "VBA - Remove rows that have every cell in the range that contain black text", "body": "<p>I've been tasked to analyse a workbook where I need to isolate the data based on the colour (red or black) that the text is in relating to the rows.</p>\n\n<p>I essentially need to develop a macro that will remove all the rows that contain data (text) that is 'all black' in the range (column C-J) and leave all the rows that contain at least one cell in the range (column C-J) that contains text that is 'red' (255,0,0).</p>\n\n<p>The completed result should be that every row will contain at least one cell that contains red text between between Column C-J.</p>\n\n<p>The data is set our as follows:</p>\n\n<p>Names: </p>\n\n<p>A1,B1</p>\n\n<p>A2,B2 all the way to</p>\n\n<p>A2000,B2000</p>\n\n<p>Data (text) is set up like the following:</p>\n\n<p>C1 to J1</p>\n\n<p>C2 to J2 all the way to</p>\n\n<p>C2000, J2000</p>\n\n<p>I've found numerous codes that conditionally colour format but I can't seem to develop one that does what I want above.</p>\n\n<p>Any help will be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11212267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gbQyO6DD0lA/AAAAAAAAAAI/AAAAAAAACEM/kUdQyijRnsY/photo.jpg?sz=128", "display_name": "Afzal Ashraf", "link": "https://stackoverflow.com/users/11212267/afzal-ashraf"}, "edited": false, "score": 0, "creation_date": 1553926808, "post_id": 55372378, "comment_id": 97575849, "body": "How About Subtracting the date"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 11212267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gbQyO6DD0lA/AAAAAAAAAAI/AAAAAAAACEM/kUdQyijRnsY/photo.jpg?sz=128", "display_name": "Afzal Ashraf", "link": "https://stackoverflow.com/users/11212267/afzal-ashraf"}, "edited": false, "score": 0, "creation_date": 1553932434, "post_id": 55372378, "comment_id": 97576871, "body": "@AfzalAshraf You should really read the documentation if I already give you the direct link: <i>&quot;Days - The number of workdays before or after the start_date. A positive value yields a future date; a negative value yields a past date; a 0 (zero) value yields the start_date. Day-offset is truncated to an integer.&quot;</i>"}, {"owner": {"reputation": 1, "user_id": 11212267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gbQyO6DD0lA/AAAAAAAAAAI/AAAAAAAACEM/kUdQyijRnsY/photo.jpg?sz=128", "display_name": "Afzal Ashraf", "link": "https://stackoverflow.com/users/11212267/afzal-ashraf"}, "edited": false, "score": 0, "creation_date": 1553940751, "post_id": 55372378, "comment_id": 97578671, "body": "I&#39;m Sorry I didn&#39;t Check that. But Now I understood. You are very Kind and Helpful!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1553673957, "creation_date": 1553673957, "answer_id": 55372378, "question_id": 55370586, "link": "https://stackoverflow.com/questions/55370586/date-addition-using-excluding-weekends-friday-in-vba/55372378#55372378", "title": "Date Addition using excluding weekends (Friday) in VBA", "body": "<p>Just use the same as you did for H5. The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.workday_intl\" rel=\"nofollow noreferrer\">WorksheetFunction.WorkDay_Intl method</a> is already adding one day (given by the second parameter which is <code>1</code>) so you don't need to use <code>DateAdd</code>.</p>\n\n<pre><code>Option Explicit\n\nSub DateAddition()\n    Range(\"H4\").Value = WorksheetFunction.WorkDay_Intl(Range(\"H4\").Value, 1, 16, 0)\n    Range(\"H5\").Value = WorksheetFunction.WorkDay_Intl(Range(\"H4\").Value, 1, 16, 0)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11212267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gbQyO6DD0lA/AAAAAAAAAAI/AAAAAAAACEM/kUdQyijRnsY/photo.jpg?sz=128", "display_name": "Afzal Ashraf", "link": "https://stackoverflow.com/users/11212267/afzal-ashraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55372378, "answer_count": 1, "score": 0, "last_activity_date": 1553673957, "creation_date": 1553665791, "last_edit_date": 1553673644, "question_id": 55370586, "link": "https://stackoverflow.com/questions/55370586/date-addition-using-excluding-weekends-friday-in-vba", "title": "Date Addition using excluding weekends (Friday) in VBA", "body": "<p>I Have a code which gives in \"H5\" cell excluding Fridays but it refers from \"H4\". And I need \"H4\" Also <strong><em>excluding Fridays.</em></strong></p>\n\n<pre><code>Sub DateAddition()\n\nRange(\"H4\").Value = DateAdd(\"d\", 1, CDate(Range(\"H4\").Value))\n\nRange(\"H5\").Value = WorksheetFunction.WorkDay_Intl(Range(\"H4\").Value, 1, 16, 0)\n\nEnd Sub\n</code></pre>\n\n<p><em>I've tried using Like this Unfortunately Doesn't work.</em></p>\n\n<pre><code>Range(\"H4\").Value = DateAdd(\"d\", 1, CDate(WorksheetFunction.WorkDay_Intl(Range(\"H4\").Value, 1, 16, 0))\n</code></pre>\n\n<p>I Know if a change given to this line i can make it. But Dont Know the code</p>\n\n<pre><code>Range(\"H4\").Value = DateAdd(\"d\", 1, CDate(Range(\"H4\").Value))\n</code></pre>\n\n<p><strong><em>I need \"H4\" Cell out put to be a date must exclude Fridays</em></strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1553664807, "creation_date": 1553664807, "answer_id": 55370407, "question_id": 55370358, "link": "https://stackoverflow.com/questions/55370358/how-to-fix-application-defined-or-object-defined-error/55370407#55370407", "title": "How to Fix &#39;Application-Defined or Object-defined error&#39;", "body": "<p>You are getting error because of</p>\n\n<pre><code>LastCol = ActiveSheet.Cells.SpecialCells(xlcelltypelast).Column\nLastRow = ActiveSheet.Cells.SpecialCells(xlcelltypelast).Row\n</code></pre>\n\n<p>There is no constant like <code>xlcelltypelast</code>. What you need is <code>xlCellTypeLastCell</code></p>\n\n<p>I would recommed reading up on <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\">Range.SpecialCells method (Excel)</a></p>\n\n<p>Also if you want to find the last cell in  a row or column then you may want to use <code>.Find</code> as shown <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">Here</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9804014, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Help the Newbie", "link": "https://stackoverflow.com/users/9804014/help-the-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553664807, "creation_date": 1553664534, "question_id": 55370358, "link": "https://stackoverflow.com/questions/55370358/how-to-fix-application-defined-or-object-defined-error", "title": "How to Fix &#39;Application-Defined or Object-defined error&#39;", "body": "<p>I'm trying to converting an excel file into a text file but every time I run the code, I get 'Application-defined or object-defined error'</p>\n\n<p>Thanks in Advance!!!!!</p>\n\n<pre><code>Sub ExceltoText()\n    `Declaration\n    Dim FileName As String, sLine As String, Deliminator As String\n    Dim LastCol As Integer, LastRow As Integer, FileNumber As Integer\n\n    `Location and File Name\n    FileName = \"C:\\Users\\Admin\\Documents\\New folder\\ExceltoText.txt\"\n    Deliminator = \"|\"\n    LastCol = ActiveSheet.Cells.SpecialCells(xlcelltypelast).Column\n    LastRow = ActiveSheet.Cells.SpecialCells(xlcelltypelast).Row\n    FileNumber = FreeFile\n\n    `To create txtfile\n    Open FileName For Output As FileNumber\n\n    `To read data from excel\n    For i = 1 To LastRow\n    For j = 1 To LastCol\n    If j = LastCol Then\n    sLine = sLine &amp; Cells(i, j).Value\n    Else\n    sLine = sLine &amp; Cells(i, j).Value &amp; Deliminator\n    End If\n    Next j\n\n    `Wrighting data\n    Print #FileNumber, sLine\n    sLine = \"\"\n    Next i\n    Close #FileNumber\n    MsgBox \"The text file has been generated\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11116827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1601e0de8e32aa2138de2ef14f96927?s=128&d=identicon&r=PG&f=1", "display_name": "The Gaboon", "link": "https://stackoverflow.com/users/11116827/the-gaboon"}, "edited": false, "score": 0, "creation_date": 1553683969, "post_id": 55370085, "comment_id": 97472852, "body": "Ok let me try this ! Thx"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1553663094, "last_edit_date": 1553663094, "creation_date": 1553662760, "answer_id": 55370085, "question_id": 55370023, "link": "https://stackoverflow.com/questions/55370023/if-the-cells-value-does-not-contains-30g-then/55370085#55370085", "title": "If the cells.value does not contains &quot;*30G*&quot; Then", "body": "<blockquote>\n  <p>If the cells.value does not contains \u201c<em>30G</em>\u201d Then</p>\n</blockquote>\n\n<p>Use <strong><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/instr-function\" rel=\"nofollow noreferrer\">InStr function</a></strong></p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>If Len(Trim(Cells(i, 10).Value)) = 0 And _\n   Cells(i, 26).Value &lt;= 61 And _\n   InStr(1, Cells(i, 1).Value, \"30G\", vbTextCompare) = 0 Then\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11116827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1601e0de8e32aa2138de2ef14f96927?s=128&d=identicon&r=PG&f=1", "display_name": "The Gaboon", "link": "https://stackoverflow.com/users/11116827/the-gaboon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553671725, "creation_date": 1553662416, "last_edit_date": 1553671725, "question_id": 55370023, "link": "https://stackoverflow.com/questions/55370023/if-the-cells-value-does-not-contains-30g-then", "title": "If the cells.value does not contains &quot;*30G*&quot; Then", "body": "<p>I'm facing issue with a condition within a VBA code.</p>\n\n<pre><code>If Cells(i, 10).Value = Blank And Cells(i, 26).Value &lt;= 61 _\n       And Cells(i, 1).Value &lt;&gt; \"*30G*\" Then\n</code></pre>\n\n<p>I would like to ignore the row which contains the following string in his cells value (col A). Basically, the Cells(I, 1).Value are ID number. The objective is to send email only for the #ID that does not contains or starting with \"30G\". Otherwise, the code is running well, I'm stuck with this new constraint.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553661714, "post_id": 55369792, "comment_id": 97462652, "body": "What is the problem you&#39;re seeing?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553663899, "post_id": 55369792, "comment_id": 97463198, "body": "Since the source and destination sheets have the same structure, you could use a single collection and  <code>myCollection.Add sheet.Cells(i, 1).Resize(1, 10).value</code> and in reverse <code>Sheet1.Cells(j, 1).Resize(1, 10).Value = myCollection(i)</code>"}, {"owner": {"reputation": 3, "user_id": 7730533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf951fc7ebe843f21f7a09e1385ff156?s=128&d=identicon&r=PG&f=1", "display_name": "vetha", "link": "https://stackoverflow.com/users/7730533/vetha"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553670670, "post_id": 55369792, "comment_id": 97465545, "body": "@TimWilliams, i can understand you but that&#39;s not my exact problem, my problem is when i close the excel where i collected the data, the collection variable loses its data too."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553698698, "post_id": 55369792, "comment_id": 97482753, "body": "I can&#39;t see from your code how that could happen unless the workbook with the code saved and closed <i>itself</i>"}, {"owner": {"reputation": 3, "user_id": 7730533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf951fc7ebe843f21f7a09e1385ff156?s=128&d=identicon&r=PG&f=1", "display_name": "vetha", "link": "https://stackoverflow.com/users/7730533/vetha"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553752832, "post_id": 55369792, "comment_id": 97503061, "body": "have the code trail in a excel, so that you will be finding my issue exactly, since the code sounds good to read or analyze but doesn&#39;t work is the problem here! @TimWilliams"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7730533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf951fc7ebe843f21f7a09e1385ff156?s=128&d=identicon&r=PG&f=1", "display_name": "vetha", "link": "https://stackoverflow.com/users/7730533/vetha"}, "edited": false, "score": 0, "creation_date": 1553769104, "post_id": 55391196, "comment_id": 97510975, "body": "i think the problem is fixed, lemme check once with my code and will let you know the fix, thanks for the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1553753684, "creation_date": 1553753684, "answer_id": 55391196, "question_id": 55369792, "link": "https://stackoverflow.com/questions/55369792/collected-data-in-collection-erased-on-external-excel-close-excel-vba/55391196#55391196", "title": "Collected data in collection erased on external excel close - excel vba", "body": "<p>I missed it earlier but here is your problem:</p>\n\n<pre><code>projectname.Add (sheet.Cells(i, 3))\n</code></pre>\n\n<p>What are you actually adding to the <code>projectname</code> collection when you do this?  </p>\n\n<p>You might expect it to be the cell's value (since that's the default property of <code>Range</code>), but <em>you're actually adding a reference to the cell itself</em>, and once you've closed the source workbook, you can no longer access that.</p>\n\n<p>Here's the fix:</p>\n\n<pre><code> projectname.Add sheet.Cells(i, 3).Value\n</code></pre>\n\n<p>Another reason never to write code which uses default properties without explicitly including them...</p>\n\n<p>And you don't need the <code>()</code> here.</p>\n"}], "owner": {"reputation": 3, "user_id": 7730533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf951fc7ebe843f21f7a09e1385ff156?s=128&d=identicon&r=PG&f=1", "display_name": "vetha", "link": "https://stackoverflow.com/users/7730533/vetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 55391196, "answer_count": 1, "score": -1, "last_activity_date": 1553753684, "creation_date": 1553660636, "last_edit_date": 1553661503, "question_id": 55369792, "link": "https://stackoverflow.com/questions/55369792/collected-data-in-collection-erased-on-external-excel-close-excel-vba", "title": "Collected data in collection erased on external excel close - excel vba", "body": "<p>i have a vba code in one excel which reads data from many other excel at a specific location, but data gets vanished on external excel close</p>\n\n<p>below gives the code which affects the collection after the line </p>\n\n<pre><code>Workbooks(fileName).Save\nWorkbooks(fileName).Close\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Sub filefindermacro()\n    Dim directory As String\n    Dim fileName As String\n    Dim sheet As Worksheet\n    Dim i As Integer\n    Dim j As Integer\n    Dim datecollection As New Collection\n    Dim majorcategory As New Collection\n    Dim projectname As New Collection\n    Dim partname As New Collection\n    Dim username As New Collection\n    Dim designerchecker As New Collection\n    Dim fpactualhours As New Collection\n    Dim ractualhours As New Collection\n    Dim currentstatus As New Collection\n    Dim softwareused As New Collection\n    Application.ScreenUpdating = False\n    directory = \"D:\\cam\\UserExcel\\\"\n    fileName = Dir(directory &amp; \"*.xl??\")\n\n    Set projectname = New Collection\n\n    Do While fileName &lt;&gt; \"\"\n        i = i + 1\n        j = 2\n        Workbooks.Open (directory &amp; fileName)\n        For Each sheet In Workbooks(fileName).Worksheets\n            If sheet.Name = \"HAI\" Then\n                Dim counter\n                counter = sheet.UsedRange.Rows.Count\n                For i = 3 To counter\n                    datecollection.Add (sheet.Cells(i, 1))\n                    majorcategory.Add (sheet.Cells(i, 2))\n                    projectname.Add (sheet.Cells(i, 3))\n                    partname.Add (sheet.Cells(i, 4))\n                    username.Add (sheet.Cells(i, 5))\n                    designerchecker.Add (sheet.Cells(i, 6))\n                    fpactualhours.Add (sheet.Cells(i, 7))\n                    ractualhours.Add (sheet.Cells(i, 8))\n                    currentstatus.Add (sheet.Cells(i, 9))\n                    softwareused.Add (sheet.Cells(i, 10))\n                    'MsgBox projectname(i - 2)\n                Next\n            End If\n        Next sheet\n        **Workbooks(fileName).Save\n        Workbooks(fileName).Close**\n        fileName = Dir()\n    Loop\n    Dim projectfile, projname\n    projectfile = Replace(ThisWorkbook.Name, \".xlsm\", \"\")\n    j = 1\n\n    For i = 1 To projectname.Count\n        'MsgBox projectname.Count\n        **If projectname.Item(i) = projectfile Then**\n            Sheet1.Cells(j, 1) = datecollection(i)\n            Sheet1.Cells(j, 2) = majorcategory(i)\n            Sheet1.Cells(j, 3) = projectname(i)\n            Sheet1.Cells(j, 4) = partname(i)\n            Sheet1.Cells(j, 5) = username(i)\n            Sheet1.Cells(j, 6) = designerchecker(i)\n            Sheet1.Cells(j, 7) = fpactualhours(i)\n            Sheet1.Cells(j, 8) = ractualhours(i)\n            Sheet1.Cells(j, 9) = currentstatus(i)\n            Sheet1.Cells(j, 10) = softwareused(i)\n            j = j + 1\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553658719, "post_id": 55369506, "comment_id": 97462021, "body": "&quot;my &quot;Calculation&quot; worksheet has the name &quot;Calculation&quot; but the (name) &quot;calc&quot;:&quot; ...uh, what? how did you declare <code>calc</code>?  You likely just need <code>Worksheets(&quot;Calculation&quot;)...</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553658760, "post_id": 55369506, "comment_id": 97462030, "body": "<code>calc.Activate</code>  &quot;codename&quot; is the term you&#39;re missing in your question ;-)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553659145, "post_id": 55369506, "comment_id": 97462108, "body": "Note though if you&#39;re using your function as a UDF it won&#39;t work..."}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553659234, "post_id": 55369506, "comment_id": 97462127, "body": "@BruceWayne Working with Worksheets(&quot;Calculation&quot;) is what I want to AVOID because if I give the Workbook to someone else to work with I don&#39;t want my code to stop working because the User changes the Worksheet name on the Front-End. A sheet in VBA has 2 names: name and (name) where name is specified in the front-end and (name) is hidden and only visible in the VBA editor (in the properties tab of the sheet)"}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553659352, "post_id": 55369506, "comment_id": 97462148, "body": "@TimWilliams thank you for your fast answer! your provided solution is working fine. just one more questions: what do you mean with &quot;codename&quot;? (so I can specify my future questions better)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553659443, "post_id": 55369506, "comment_id": 97462163, "body": "A general comment, re: &quot;...to make my sheet &#39;idiot proof&#39;&quot;...  I might suggest simply throwing an error telling the user &quot;Could not find <code>Calculation</code> worksheet. Please rename to continue.&quot; or something...To quote Douglas Adams, &quot;A common mistake that people make when trying to design something completely foolproof is to underestimate the ingenuity of complete fools.&quot;"}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553660050, "post_id": 55369506, "comment_id": 97462272, "body": "@BruceWayne Thanks for your input! I get your point and I&#39;ll keep it in mind for the future. But personally I think my wording was off and making my code independable of the front-end worksheet name is more &quot;User-friendly&quot;, and maybe not so much &quot;foolproof&quot;. And that&#39;s what I am trying to accomplish here."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553660363, "post_id": 55369506, "comment_id": 97462344, "body": "@TimWilliams - So, even if the user renames the Worksheet &quot;Calculation&quot; to &quot;ZXY&quot;, you can still refer to that sheet with <code>Calc.</code> in VBA? Can you expand on that a little, that&#39;s interesting!"}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1553660821, "post_id": 55369506, "comment_id": 97462442, "body": "@BruceWayne I found what Tim tried to tell me with <code>Worksheet.CodeName</code>. For a more detailed explanation of this read <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.codename\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> where it states: &quot;It&#39;s possible for the sheet name to be different from the code name. When you create a sheet, the sheet name and code name are the same, but changing the sheet name doesn&#39;t change the code name, and changing the code name (using the Properties window in the Visual Basic Editor) doesn&#39;t change the sheet name.&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553660968, "post_id": 55369506, "comment_id": 97462475, "body": "Thanks for that Michael!  One final clarification - I can only assume you&#39;re actually creating the &quot;Calculation&quot; worksheet with VBA, yes? (e.g. <code>Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = &quot;Calculation&quot;</code>), otherwise wouldn&#39;t the CodeName be <code>Sheet1</code> or <code>Sheet2</code> (or whatever)?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1553661400, "post_id": 55369506, "comment_id": 97462579, "body": "@BruceWayne - Yes typically the codename for a new sheet would be (eg) <code>Sheet3</code> etc (in an English language setup).  FYI <code>Sheets.Add()</code> just returns a boolean, not a reference to the new sheet, so you can&#39;t tag on the <code>.Name</code> there: a shame since that would be more convenient."}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553662366, "post_id": 55369506, "comment_id": 97462804, "body": "@BruceWayne after some digging I came to this conclusion: since the <code>Worksheet.CodeName</code> property is Read-Only (as stated in the microsoft document) you cannot change the CodeName programmatically (only by hand in the properties tab in the VBA editor). So even after creating a Sheet with a desired name (f.e. <code>test</code>), the CodeName of <code>test</code> will still be <code>sheet1</code>, <code>sheet2</code>, ..."}, {"owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553662451, "post_id": 55369506, "comment_id": 97462817, "body": "@BruceWayne You CAN however change the CodeName programmatically when you permit Access to the VBA Project (which by default is not permitted for security reasons: see <a href=\"https://support.microsoft.com/en-us/help/282830/programmatic-access-to-office-vba-project-is-denied\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/282830/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1553662834, "last_edit_date": 1553662834, "creation_date": 1553659734, "answer_id": 55369671, "question_id": 55369506, "link": "https://stackoverflow.com/questions/55369506/trying-to-activate-a-worksheet-by-internal-name-results-in-index-out-of-range-er/55369671#55369671", "title": "Trying to activate a worksheet by internal name results in Index out of range Error", "body": "<p><code>(name).Activate</code> does the trick.\nIn my example it would be:</p>\n\n<p><code>calc.Activate</code></p>\n\n<p>Thanks to @TimWilliams</p>\n\n<p>Edit:\nThis Property is called <code>CodeName</code> and is read-only!</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.codename\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.codename</a></p>\n\n<p>If you are trying to change it programmatically it throws this error:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/282830/programmatic-access-to-office-vba-project-is-denied\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/282830/programmatic-access-to-office-vba-project-is-denied</a></p>\n\n<p>Therefor it can only be changed programmatically if you permit access to the VBA Project which is not permitted by default for security reasons!</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553671255, "creation_date": 1553671255, "answer_id": 55371776, "question_id": 55369506, "link": "https://stackoverflow.com/questions/55369506/trying-to-activate-a-worksheet-by-internal-name-results-in-index-out-of-range-er/55371776#55371776", "title": "Trying to activate a worksheet by internal name results in Index out of range Error", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Activate '&lt;- Activate sheet using the name shown outside\n    ws1.Activate '&lt;- Activate sheet using the name shown in the VBA Editor\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9692251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MichaelS", "link": "https://stackoverflow.com/users/9692251/michaels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553692752, "creation_date": 1553658560, "last_edit_date": 1553692752, "question_id": 55369506, "link": "https://stackoverflow.com/questions/55369506/trying-to-activate-a-worksheet-by-internal-name-results-in-index-out-of-range-er", "title": "Trying to activate a worksheet by internal name results in Index out of range Error", "body": "<p>I am having troubles with a very simple function in VBA:</p>\n\n<p>I am working with 2 worksheets (Calculation and Plotting). So now I want to activate the worksheets when necessary with calling them by (name) and not name (specified in the properties of the sheet) to make my sheet \"idiot-proof\". I dont want to use the sheetname but the sheet(name) so when the User changes the sheetnames on the frontend the executed code still works.</p>\n\n<p>F.e. my \"Calculation\" worksheet has the name \"Calculation\" but the (name) \"calc\":</p>\n\n<p><code>Worksheets(\"calc\").Activate</code> (throws Index out Range error)</p>\n\n<p><code>calc.Cells()</code> (works just fine)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 10867189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gV_nfI5zrLQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYzWv5emqCz9bfWiaFYLBB7rVHMcg/mo/photo.jpg?sz=128", "display_name": "Mehmet Canbulat", "link": "https://stackoverflow.com/users/10867189/mehmet-canbulat"}, "is_accepted": true, "score": 1, "last_activity_date": 1553669797, "creation_date": 1553669797, "answer_id": 55371411, "question_id": 55369241, "link": "https://stackoverflow.com/questions/55369241/is-there-a-way-to-copy-a-variable-into-another-sheet/55371411#55371411", "title": "Is there a way to copy a variable into another sheet?", "body": "<p>I can't understand how you copy and paste multiple cells to a new worksheet. Do you want to keep source pattern or do you want to save it as dataset format? Anyway, my solution is copy source range to a new sheet and clear the cells that not match with your criteria. I tested at my pc.</p>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet\nDim wsa As Worksheet\nDim cll As Range\n\nThisWorkbook.Sheets.Add\n\nSet wsa = ActiveSheet\n\nlr = 1\n\nFor Each ws In ThisWorkbook.Worksheets\n    If wsa.CodeName &lt;&gt; ws.CodeName Then\n        ws.UsedRange.Copy wsa.Range(\"A\" &amp; lr)\n        For Each cll In wsa.UsedRange.Cells\n            If InStr(1, cll.Value, \"Your Criteria String\") = 0 Then\n                cll.Value = \"\"\n            End If\n        Next cll\n        lr = lr + ws.UsedRange.Rows.Count\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11122616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed2818d191e99695c66628b61be2e32?s=128&d=identicon&r=PG&f=1", "display_name": "MarkLee", "link": "https://stackoverflow.com/users/11122616/marklee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55371411, "answer_count": 1, "score": 0, "last_activity_date": 1553673581, "creation_date": 1553656505, "last_edit_date": 1553673581, "question_id": 55369241, "link": "https://stackoverflow.com/questions/55369241/is-there-a-way-to-copy-a-variable-into-another-sheet", "title": "Is there a way to copy a variable into another sheet?", "body": "<p>Im trying to copy all cells that has GROUP in it and paste it into another sheet.\nThis is my code so far.\nBut I keep getting a 438 error.\nIm very new to vba so any help will be appreciated.</p>\n\n<pre><code> Sub FindAndExecute()\n\nDim Sh As Worksheet\nDim Loc As Range\n\nFor Each Sh In ThisWorkbook.Worksheets\n    With Sh.UsedRange\n        Set Loc = .Cells.Find(What:=\"GROUP*\")\n        If Not Loc Is Nothing Then\n            Do Until Loc Is Nothing\n                'Copy the data\n                Sheets(\"Sheet1\").Value(Loc).Copy\n                'Activate the destination worksheet\n                Sheets(\"Sheet2\").Activate\n                'Select the target range\n                Range(\"A1\").Select\n                'Paste in the target destination\n                ActiveSheet.Paste\n                Set Loc = .FindNext(Loc)\n            Loop\n        End If\n    End With\n    Set Loc = Nothing\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic"], "owner": {"reputation": 21, "user_id": 11263341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36d9c7308fde6239a4594afd90440d3?s=128&d=identicon&r=PG&f=1", "display_name": "CrashCodingBandicoot", "link": "https://stackoverflow.com/users/11263341/crashcodingbandicoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1553655945, "creation_date": 1553655945, "question_id": 55369177, "link": "https://stackoverflow.com/questions/55369177/dynamic-list-that-requires-parsing-and-then-aggregation", "title": "Dynamic list that requires parsing, and then aggregation", "body": "<p>I really would appreciate some extra eyes on this, I\u2019m thoroughly stumped. Let me know if you have any questions or clarifications. </p>\n\n<p>I have a daily reconciliation with 4 unfortunately un linked data sources. Thus far I have created a macro that can handle 3/4 sources but I've hit a wall on the 4th. </p>\n\n<p>There is a sheet called \"Data\" with two columns that are causing issue, for discussions sake \"A\" &amp; \"B\". A has a tag (RS##### format) and the adjacent cell B has a string of contiguous numerical text values (5-6 Digits) which are separated by commas (1234,54321,51423).</p>\n\n<p>I need to parse the data in each cell of column B (row length varies from day to day).</p>\n\n<p>With the Original 1st value remaining in column B and each subsequent 4-5 digit number in their own cell to the right of the original value in column Beta (which I can do successfully through VBA logic akin to text to columns, although I'm not sure its the most efficient way). </p>\n\n<p>Then for each of the cells in a row, I need to re aggregate the original value and the subsequent values to the right into one contiguous list an another sheet. </p>\n\n<p>EX.</p>\n\n<p>The whole process would:</p>\n\n<p>Step 1 (no issue - info purposes only)\n\u2018Original Data</p>\n\n<p>\u2018Sheet \u201cData\u201d\n \u2018 Columns A &amp; B*</p>\n\n<pre><code>  A3            B3\n</code></pre>\n\n<p>RS1234   |  \u201c12345, 54321, 51423\u201d</p>\n\n<p>BR4353   | \u201c 34567,23145,2345,6789,22222,34543\u201d</p>\n\n<p>Etc.*         | Etc.    (Until last Row)*</p>\n\n<ul>\n<li>Last row A &amp; B always the same</li>\n</ul>\n\n<p>Step 2 (have achieved using text to columns but interested in different approaches if anyone has a better idea) - mostly info purposes only)</p>\n\n<pre><code>Result of parsing:\n</code></pre>\n\n<p>\u2018Sheet \u201cData\u201d\n\u2018Columns A | B &amp; Last column with data</p>\n\n<p>A3   |   B3   |   C3  | D3     |     E3</p>\n\n<p>RS1234 | 12345  | 54321 | 51423  |  55443</p>\n\n<p>BR4353 |  34567 | 23145 | etc..</p>\n\n<p>Etc..</p>\n\n<ul>\n<li>Note: if there is some way to skip this step that makes it easier I\u2019m open to it, this was just my thinking as to where there might be a way forward. \n\u2028</li>\n</ul>\n\n<p>Step 3\nResult of re-aggregation:</p>\n\n<p>\u2018Sheet \u201cMulti\u201d</p>\n\n<p>Next available cell in Row Y|    Next available cell in row Z</p>\n\n<pre><code>RS1234      |       12345\n\nRS1234      |       54321\n\nRS1234      |       51423\n\nBR3453      |       34567\n\nBR4353      |       23415\n\netc*            |       etc. (until last row \u201cA:B\u201dwith value on sheet \u201cData\u201d)\n</code></pre>\n\n<p>Step 4: I can pick back up the process from this point.</p>\n\n<p>Admittedly, I\u2019m really stuck. I\u2019m not a coder by trade, more of a puzzler who\u2019s looking for answers to a problem that I can\u2019t put down. It would save me ages and I feel like its feasible and It\u2019s driving me nuts.</p>\n\n<p>Thanks,\nCrashCoding</p>\n\n<p>Im stuck - I've tried to dig into loops because that's where I think this could be simplified but Im struggling to wrap my head around it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1553656571, "post_id": 55369175, "comment_id": 97461618, "body": "Correct. I get Table3 but no headers"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1553656684, "post_id": 55369175, "comment_id": 97461644, "body": "I know when  named the range as Table3, I checked the box that says my table has headers. Not sure how that might play out."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1553656960, "creation_date": 1553656960, "answer_id": 55369308, "question_id": 55369175, "link": "https://stackoverflow.com/questions/55369175/vba-excel-setting-print-area/55369308#55369308", "title": "VBA excel setting print area", "body": "<p>A table is a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject\" rel=\"nofollow noreferrer\"><code>ListObject</code></a>. Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject.range\" rel=\"nofollow noreferrer\"><code>ListObject.Range</code></a> property to return the <code>Range</code> that the table refers to (includes headers).</p>\n\n<pre><code>Dim myTbl as ListObject\nSet myTbl = ThisWorkbook.Sheets(\"mysheetname\").ListObjects(\"Table3\")\n...\nThisWorkbook.Sheets(\"mysheetname\").PageSetup.PrintArea = myTbl.Range.Address\n</code></pre>\n\n<p>Change the sheet name as needed.</p>\n"}], "owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 55369308, "answer_count": 1, "score": 0, "last_activity_date": 1553656960, "creation_date": 1553655941, "last_edit_date": 1553656139, "question_id": 55369175, "link": "https://stackoverflow.com/questions/55369175/vba-excel-setting-print-area", "title": "VBA excel setting print area", "body": "<p>I am setting a print area using named range, since it's a table and it grows.\nWhen I execute, the headings wont print. How can I adjust this to print the named range(Table3) along with the headers?</p>\n\n<p>I tried;\n<code>ActiveSheet.PageSetup.PrintArea = Range(\"Table3{Headers}\").Address</code>\nbut only printed the Headers.</p>\n\n<pre><code>Application.Dialogs(xlDialogPrinterSetup).Show\n    Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .PrintTitleRows = \"\"\n        .PrintTitleColumns = \"\"\n    End With\n    Application.PrintCommunication = True\n    ActiveSheet.PageSetup.PrintArea = Range(\"Table3\").Address\n    Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n</code></pre>\n\n<p>I want the headers and Table3 to print.</p>\n"}, {"tags": ["excel", "vba", "selenium", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "edited": false, "score": 0, "creation_date": 1553703746, "post_id": 55369479, "comment_id": 97486160, "body": "Thanks for responding, the format that works for other selectors is <code>CandidateName = bot.FindElementByCss(&quot;[class$=&#39;candidate-name ng-binding&#39;]&quot;).Attribute(&quot;innerText&quot;)</code> Using just the ng-binding.ng-scope doesn&#39;t work as it&#39;s commonly used throughout the rest of the html. This is just a very small code snippet out of the full code. The first example doesn&#39;t work. I tried adding .Attribute(&quot;innerText&quot;) to the end and that didn&#39;t change anything either."}, {"owner": {"reputation": 1285, "user_id": 8163071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101e4bdb5e073ed2b1afcb1c61d159b2?s=128&d=identicon&r=PG&f=1", "display_name": "C. Peck", "link": "https://stackoverflow.com/users/8163071/c-peck"}, "reply_to_user": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "edited": false, "score": 0, "creation_date": 1553704078, "post_id": 55369479, "comment_id": 97486357, "body": "Well I\u2019m going to have a hard time specifying any unique selector unless I see the full HTML. If you post all your html I\u2019m sure you\u2019ll get an answer."}], "tags": [], "owner": {"reputation": 1285, "user_id": 8163071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101e4bdb5e073ed2b1afcb1c61d159b2?s=128&d=identicon&r=PG&f=1", "display_name": "C. Peck", "link": "https://stackoverflow.com/users/8163071/c-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1553658770, "last_edit_date": 1553658770, "creation_date": 1553658373, "answer_id": 55369479, "question_id": 55369118, "link": "https://stackoverflow.com/questions/55369118/selenium-ng-if-or-next-element/55369479#55369479", "title": "Selenium - NG-IF or Next Element?", "body": "<p>In the css selector looks like you're mixing the syntax for XPath in there; and both examples will probably get tripped up by the space in your class name.  I would use:</p>\n\n<pre><code>CandidateEmail = bot.FindElementByCss(\".hire-icon-email-outline.header-list-icon\")\n</code></pre>\n\n<p>the initial dot tells it to look for elements with the specified class name, and you need to replace the space in the class with a dot, otherwise it will be considered as two classes.</p>\n\n<p>Oh, I've just noticed you are looking for the 'a' element which should be able to be located by the following (if that is the entirety of the HTML):</p>\n\n<pre><code>CandidateEmail = bot.FindElementByCss(\"a.ng-binding.ng-scope\")\n</code></pre>\n\n<p>Or (again if what you've posted is the whole HTML), there is only one 'a' element in there, meaning the following should work:</p>\n\n<pre><code>CandidateEmail = bot.FindElementByCss(\"a\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "edited": false, "score": 0, "creation_date": 1553703493, "post_id": 55370451, "comment_id": 97486011, "body": "I appreciate the response - I&#39;d rather not use something specific to find the href as this is a common challenge throughout the website and not just specific to the email address. As an example, even trying to find the phone number in the given code I have to follow the same method. I tried using the adjacent sibling combinator and it isn&#39;t working."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "edited": false, "score": 0, "creation_date": 1553705207, "post_id": 55370451, "comment_id": 97487037, "body": "They have a similar structure so you can have a list substrings and concatenate those in during a loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "edited": false, "score": 0, "creation_date": 1554399231, "post_id": 55370451, "comment_id": 97748120, "body": "Did you try the edit as css selectors should be faster method."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1553744981, "last_edit_date": 1553744981, "creation_date": 1553665064, "answer_id": 55370451, "question_id": 55369118, "link": "https://stackoverflow.com/questions/55369118/selenium-ng-if-or-next-element/55370451#55370451", "title": "Selenium - NG-IF or Next Element?", "body": "<p>Consider using a css attribute = value selector combination with ^ starts with operator to target the email element by its href value.</p>\n\n<pre><code>bot.FindElementByCss(\"[href^=mailto]\")\n</code></pre>\n\n<p>You could further specify, if needed, adding an additional attribute selector (or indeed swopping the second for the first in the above):</p>\n\n<pre><code>bot.FindElementByCss(\"[href^=mailto][ng-if='candidate.hasEmailAddress()']\")\n</code></pre>\n\n<p>Also, consider an adjacent sibling combinator where you specify the a tag after the email icon.</p>\n\n<pre><code>bot.FindElementByCss(\".hire-icon-email-outline ~ a\")\n</code></pre>\n\n<hr>\n\n<p>Here is one potential application of substring matching</p>\n\n<pre><code>Dim dict As Object, key As Variant\nSet dict = CreateObject(\"Scripting.Dictionary\")\ndict.Add \"hasEmailAddress\", vbNullString\ndict.Add \"hasPhoneNumber\", vbNullString\n\nFor Each key In dict.keys\n    On Error Resume Next\n    dict(key) = bot.FindElementByCss(\"[ng-if*=\" &amp; key &amp; \"]\").Text 'assuming no illegal characters in string\n    Debug.Print key, bot.FindElementByCss(\"[ng-if*=\" &amp; key &amp; \"]\").Text\n    On Error GoTo 0\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "is_accepted": false, "score": 0, "last_activity_date": 1553723790, "creation_date": 1553723790, "answer_id": 55387092, "question_id": 55369118, "link": "https://stackoverflow.com/questions/55369118/selenium-ng-if-or-next-element/55387092#55387092", "title": "Selenium - NG-IF or Next Element?", "body": "<p>Apparently I had everything I needed, just needed to play with it more. </p>\n\n<p>Was able to get it working through the following</p>\n\n<pre><code>CandidateEmail = bot.FindElementByXPath(\"//a[@ng-if='candidate.hasEmailAddress()']\").Attribute(\"innerText\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11132136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SomnaDcd1CI/AAAAAAAAAAI/AAAAAAAACVk/EL-3q5ovx8w/photo.jpg?sz=128", "display_name": "Mathias Miharkula", "link": "https://stackoverflow.com/users/11132136/mathias-miharkula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1553744981, "creation_date": 1553655485, "last_edit_date": 1553665182, "question_id": 55369118, "link": "https://stackoverflow.com/questions/55369118/selenium-ng-if-or-next-element", "title": "Selenium - NG-IF or Next Element?", "body": "<p>I'm developing a VBA web scraper for internal intranet using Selenium and am stuck extracting a couple pieces. I have had good luck in accessing most of the data using CSS but have run into a couple cases where the class is commonly used and the location of the certain element may vary.</p>\n\n<pre><code>&lt;div class=\"col-xs-12 col-sm-4 header-section header-list\"&gt;\n\n&lt;li&gt;\n    &lt;i class=\"hire-icon-contactcard-outline header-list-icon\"&gt;&lt;/i&gt;\n    &lt;span class=\"modal-link ng-binding\" data-ng-click=\"createContactCardModal()\"&gt;View full contact card&lt;/span&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n    &lt;i class=\"hire-icon-email-outline header-list-icon\"&gt;&lt;/i&gt;\n    &lt;!-- ngIf: !candidate.hasEmailAddress() --&gt;\n    &lt;!-- ngIf: candidate.hasEmailAddress() --&gt;\n    &lt;a href=\"mailto:testemail@gmail.com\" ng-if=\"candidate.hasEmailAddress()\" class=\"ng-binding ng-scope\"&gt;testemail@gmail.com&lt;/a&gt;\n    &lt;!-- end ngIf: candidate.hasEmailAddress() --&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n    &lt;i class=\"hire-icon-phone-solid header-list-icon\"&gt;&lt;/i&gt;\n    &lt;!-- ngIf: !candidate.hasPhoneNumber() --&gt;\n    &lt;!-- ngIf: candidate.hasPhoneNumber() --&gt;\n    &lt;span ng-if=\"candidate.hasPhoneNumber()\" class=\"ng-binding ng-scope\"&gt;123-456-7898&lt;/span&gt;\n    &lt;!-- end ngIf: candidate.hasPhoneNumber() --&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p></p>\n\n<p>I have been trying a variety of the following and feel like I'm somewhat close but know my code is likely off.</p>\n\n<pre><code>CandidateEmail = bot.FindElementByCss(\"[class$='hire-icon-email-outline header-list-icon']/following-sibling::[@class='ng-binding ng-scope'])\")\n\nCandidateEmail = bot.FindElementByXPath(\"//i[@class='hire-icon-email-outline header-list-icon']/following-sibling::a[@class='ng-binding ng-scope'])\")\n</code></pre>\n\n<p>Any idea what I might be missing? Additionally, is it possible to simply have selenium select the ngIf element - such as \n\n<p>Thanks in advance for your time and insight! It's greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "edited": false, "score": 0, "creation_date": 1553689942, "post_id": 55369185, "comment_id": 97476575, "body": "Thank you so much for your kind advice and solution!"}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1553655988, "creation_date": 1553655988, "answer_id": 55369185, "question_id": 55369022, "link": "https://stackoverflow.com/questions/55369022/vba-subtraction-for-multiple-table-values/55369185#55369185", "title": "VBA subtraction for multiple table values", "body": "<p>You should really use formulas for something like this, but if you insists on VBA, here it goes.</p>\n\n<p>Whenever you write code for VBA or any similar languages, read what you are writing, what it should/needs to do, as you read it out loud many times the errors pop up. Think of the comments below as \"me reading as I write.\"</p>\n\n<pre><code>Sub OperationO()\n    'Initiate a Variable type Integer for number storage\n    Dim OE as Integer\n    'Initiate another variable same type to use in the loop\n    Dim i as Integer\n    'Start a loop from 3 to 6 (because these are the columns you are working with)\n    For i = 3 to 6\n        'Set the value in Column \"i\" on Row 6 to the value in Row 2 minus Row 4 in the same column\n        'Now here is the thing, when you subtract a negative number, you are adding it, crazy math rules i know, so if the number is negative, you need to Add instead.\n        Cells(6, i).Value = (Cells(2, i).Value + Cells(4, i).Value)\n        'If both cells don't contain a number, this will fail, additional checks may help, like IsNumber\n    Next i\n'Its the end of the Sub and you never used the Variable OE, it was declared for nothing.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4370293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i6eWn20Cc-U/AAAAAAAAAAI/AAAAAAAAACQ/WmK_rONzkKc/photo.jpg?sz=128", "display_name": "BangolPhoenix", "link": "https://stackoverflow.com/users/4370293/bangolphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553655988, "creation_date": 1553654666, "last_edit_date": 1553655371, "question_id": 55369022, "link": "https://stackoverflow.com/questions/55369022/vba-subtraction-for-multiple-table-values", "title": "VBA subtraction for multiple table values", "body": "<p>Hi I am writing Excel VBA code. I just wanted to do subtraction for this kind of table</p>\n\n<p><a href=\"https://i.stack.imgur.com/OCSap.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OCSap.png\" alt=\"cash - spending for all of the items\"></a></p>\n\n<p>But I can't figure out how to do that using VBA. Is the code below correct?</p>\n\n<pre><code>Sub OperationO()\n\n    Dim OE As Integer\n    Dim i As Integer\n\n    For i = 3 To Range(\"F6\")\n        Cells(6, i).Value = Cells(2, i).Value - Cells(4, i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1553644674, "post_id": 55367849, "comment_id": 97459264, "body": "This has nothing to do with greediness. Do you want to extract the first date on a line? If yes, use <code>regEx.Multiline = True</code> and then <code>^.*?((?:\\b\\d{1,2}\\D{0,3})?\\b(?:Jan(?:uary)?|Feb(?:ruary)?|Ma&zwnj;&#8203;r(?:ch)?|Apr(?:il)?|&zwnj;&#8203;May|June?|July?|Aug(&zwnj;&#8203;?:ust)?|Sep(?:tember&zwnj;&#8203;)?|Oct(?:ober)?|(?:N&zwnj;&#8203;ov|Dec)(?:ember)?)\\D&zwnj;&#8203;?(?:\\d{1,2}\\D?)?\\D?(&zwnj;&#8203;?:(?:19[7-9]\\d|20\\d{&zwnj;&#8203;2})|\\d{2}))</code> pattern and then access <code>match.Submatches(0)</code>"}, {"owner": {"reputation": 189, "user_id": 9013483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75cfbfcf868871bc916951c96bfc8a64?s=128&d=identicon&r=PG&f=1", "display_name": "qbbq", "link": "https://stackoverflow.com/users/9013483/qbbq"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1553645833, "post_id": 55367849, "comment_id": 97459513, "body": "this worked like a charm! thank you very much. if you want to add this as a solution, I will mark it as correct - I can&#39;t mark your comment as an answer"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1553646475, "post_id": 55367849, "comment_id": 97459676, "body": "All you really need to do is set <code>.global = False</code>  It will stop after returning the first match."}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1553646181, "creation_date": 1553646181, "answer_id": 55368051, "question_id": 55367849, "link": "https://stackoverflow.com/questions/55367849/is-there-a-way-to-make-this-regex-expression-less-greedy-using-excel-vba/55368051#55368051", "title": "Is there a way to make this Regex expression less greedy. Using Excel VBA", "body": "<p>To match the first match on a line you may add <code>^.*?</code> at the beginning of the pattern, wrap what you have with capturing parentheses and set the <code>Multiline</code> regex property to <code>True</code>. Your match is inside <code>match.Submatches(0)</code>.</p>\n\n<pre><code>regEx.Pattern = \"^.*?((?:\\b\\d{1,2}\\D{0,3})?\\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|June?|July?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|(?:Nov|Dec)(?:ember)?)\\D?(?:\\d{1,2}\\D?)?\\D?(?:(?:19[7-9]\\d|20\\d{2})|\\d{2}))\"\nregEx.Multiline = True\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/3HYtEa/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n"}], "owner": {"reputation": 189, "user_id": 9013483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75cfbfcf868871bc916951c96bfc8a64?s=128&d=identicon&r=PG&f=1", "display_name": "qbbq", "link": "https://stackoverflow.com/users/9013483/qbbq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55368051, "answer_count": 1, "score": 1, "last_activity_date": 1553673555, "creation_date": 1553644493, "last_edit_date": 1553673555, "question_id": 55367849, "link": "https://stackoverflow.com/questions/55367849/is-there-a-way-to-make-this-regex-expression-less-greedy-using-excel-vba", "title": "Is there a way to make this Regex expression less greedy. Using Excel VBA", "body": "<p>I have an excel document with a cell with the following information:</p>\n\n<pre><code>A) Current to: Notice of 19 June 2014  Sent on: August 2012\nB) Updated on: October 2018\nC) Updated: 14 January 2009\n</code></pre>\n\n<p>I am using the following regular expression with some success:</p>\n\n<pre><code>(\\b\\d{1,2}\\D{0,3})?\\b((?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|(?:Nov|Dec)(?:ember)?))\\D?(\\d{1,2}\\D?)?\\D?((19[7-9]\\d|20\\d{2})|\\d{2})\n</code></pre>\n\n<p>the output I have is as follows:</p>\n\n<pre><code>A) 19 June2014August2012\nB) October 2018\nC) 14 January 2009\n</code></pre>\n\n<p>B and C extract fine, however I am expecting 19 June 2014 for A</p>\n\n<p>I have tried adding .*? to make the expression less greedy, but (depending where I add the dot-star), I either get no result or I get an inaccurate response</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1553644941, "last_edit_date": 1553644941, "creation_date": 1553644490, "answer_id": 55367847, "question_id": 55367801, "link": "https://stackoverflow.com/questions/55367801/new-sheet-keeps-overwriting-old-name/55367847#55367847", "title": "New Sheet keeps overwriting old name", "body": "<p>You're incrementing the <code>Index</code> too far</p>\n\n<pre><code>Set ws = Sheets(\"Agent Template\")\n\nws.Copy After:=Sheets(\"Summary\")\n\nSet wsNew = Sheets(Sheets(\"Summary\").Index + 1)\n</code></pre>\n\n<p>Note you can get unpredictable results if any sheets are hidden:\n<a href=\"https://stackoverflow.com/questions/7692274/copy-sheet-and-get-resulting-sheet-object\">Copy sheet and get resulting sheet object?</a></p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1553646202, "last_edit_date": 1553646202, "creation_date": 1553645656, "answer_id": 55367971, "question_id": 55367801, "link": "https://stackoverflow.com/questions/55367801/new-sheet-keeps-overwriting-old-name/55367971#55367971", "title": "New Sheet keeps overwriting old name", "body": "<p>As I understand it, the <code>Copy()</code> function automatically sets the new worksheet as the <code>ActiveSheet</code>. So you wouldn't need to find it by index. You could simply access the properties of the <code>ActiveSheet</code> object:</p>\n\n<pre><code>With ThisWorkbook.Worksheets\n    .Item(\"Agent Template\").Copy After:=.Item(\"Summary\")\nEnd With\n\nWith ThisWorkbook.ActiveSheet\n    .Name = ThisWorkbook.Worksheets(\"Summary\").Range(\"E5\").Value2\n    .Range(\"C4\").Value = .Name\nEnd With\n</code></pre>\n\n<p>If my understanding is correct, then I'd favour this way, as you could lose control of indexing if users start moving sheets around.</p>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55367971, "answer_count": 2, "score": 0, "last_activity_date": 1553673496, "creation_date": 1553644198, "last_edit_date": 1553673496, "question_id": 55367801, "link": "https://stackoverflow.com/questions/55367801/new-sheet-keeps-overwriting-old-name", "title": "New Sheet keeps overwriting old name", "body": "<p>I am trying to copy a worksheet and rename it based on a variable and that is working. The issue is that it changes the name of the template sheet in the process of copying. Any ideas how to fix it?</p>\n\n<pre><code>Sub AddAgent()\n\n    Dim wsname As String\n    Dim lRow As Long\n\n    wsname = ActiveWorkbook.Sheets(\"Summary\").Range(\"E5\").Value\n\n    Set ws = Sheets(\"Agent Template\")\n\n    ws.Copy After:=Sheets(\"Summary\")\n\n    Set wsNew = Sheets(Sheets(\"Summary\").Index + 2)\n\n    wsNew.Range(\"C4\").Value = wsname\n    wsNew.Name = wsname\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11263073, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213297390971100/picture?type=large", "display_name": "Craig Spencer", "link": "https://stackoverflow.com/users/11263073/craig-spencer"}, "is_accepted": false, "score": 0, "last_activity_date": 1553642236, "creation_date": 1553642236, "answer_id": 55367537, "question_id": 55367331, "link": "https://stackoverflow.com/questions/55367331/run-time-error-1004-that-errors-on-an-autoshape-command/55367537#55367537", "title": "Run-time Error &#39;1004&#39; that errors on an Autoshape Command", "body": "<p>I guess I posted this about 10 minutes too soon.  I found on another question that I needed to be sure the Microsoft Office 15.0 Object Library is checked in the VBA menu under Tools\\ References.  I did so and it fixed the issue. </p>\n"}], "owner": {"reputation": 11, "user_id": 11263073, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213297390971100/picture?type=large", "display_name": "Craig Spencer", "link": "https://stackoverflow.com/users/11263073/craig-spencer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553673412, "creation_date": 1553640769, "last_edit_date": 1553673412, "question_id": 55367331, "link": "https://stackoverflow.com/questions/55367331/run-time-error-1004-that-errors-on-an-autoshape-command", "title": "Run-time Error &#39;1004&#39; that errors on an Autoshape Command", "body": "<p>I have a template that creates a new tab when a button is pushed on the main menu.  On that new tab it brings over some data from the main menu and creates two buttons (autoshapes) that also gets assigned text and a macro for each because the actions are different for each button.  However when it gets to the autoshape command it returns a Run-time Error '1004'.  I have prior versions of the spreadsheet that do not have all the bells and whistles of the new spreadsheet, but if I run the functionality from the prior version it works fine.  If I copy and paste the VB specific to this functionality it still runs into the Run-time Error.  It has no problem making the autoshape using exactly the same code in the prior version..... I'm at a loss. </p>\n\n<p>The exact code that causes the error is:</p>\n\n<pre><code>ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 603.75, 7.5, 156.75, 49.5).Select\n</code></pre>\n\n<p>I've copied the code that works in prior versions to the current version and it still runs into the same error.</p>\n\n<pre><code>ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 603.75, 7.5, 156.75, 49.5).Select\n</code></pre>\n\n<p>I want a Rounded Rectangular shape created so I can assign text and a macro to it for some additional functionality after user data input.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553640480, "post_id": 55367107, "comment_id": 97458149, "body": "&quot;If none of those conditions are meet then A1 = D&quot; - seems like that&#39;s already covered in (2), with the result being &quot;C&quot; ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553640564, "post_id": 55367107, "comment_id": 97458177, "body": "How can you get by the first rule.  A1 is either A or do nothing, nothing would preclude A1 from being anything else."}, {"owner": {"reputation": 41, "user_id": 11001266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0625d0e5b096ce04540f8a4c0decf31?s=128&d=identicon&r=PG&f=1", "display_name": "accurist", "link": "https://stackoverflow.com/users/11001266/accurist"}, "edited": false, "score": 0, "creation_date": 1553641929, "post_id": 55367107, "comment_id": 97458574, "body": "Ok let\u2019s put it differently. The value in A1 depends from the option I choose from drop dawn list. Let\u2019s say I need:  A1 = A if  answered \u201cyes\u201d otherwise D if answered \u201cNo\u201d OR A1 = B if answered \u201cred\u201d otherwise A1 = C if answered \u201cblack\u201d These would be my dependent conditions. How could you put it into excel formula ?."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553642481, "post_id": 55367107, "comment_id": 97458728, "body": "<code>IF(range1 = &quot;yes&quot;, &quot;A&quot;, IF(range1=&quot;no&quot;, &quot;D&quot;, &quot;&quot;))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11001266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0625d0e5b096ce04540f8a4c0decf31?s=128&d=identicon&r=PG&f=1", "display_name": "accurist", "link": "https://stackoverflow.com/users/11001266/accurist"}, "edited": false, "score": 1, "creation_date": 1553716689, "post_id": 55368241, "comment_id": 97492870, "body": "It worked like a charm. I have extended this with few more conditions but kept the the principle. Thanks for that"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1553648057, "creation_date": 1553648057, "answer_id": 55368241, "question_id": 55367107, "link": "https://stackoverflow.com/questions/55367107/dependent-cell-value-with-multiple-conditions-in-excel/55368241#55368241", "title": "Dependent cell value with multiple conditions in excel", "body": "<p>From your comment, looks like this will work:</p>\n\n<pre><code>=IF(nameRange1=\"yes\",\"A\",IF(nameRange2=\"red\",\"B\",IF(nameRange2=\"black\",\"C\",\"D\")))\n</code></pre>\n\n<p>If that is not exactly what you need, you can at least see the IF embedding pattern and adjust for your needs.</p>\n"}], "owner": {"reputation": 41, "user_id": 11001266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0625d0e5b096ce04540f8a4c0decf31?s=128&d=identicon&r=PG&f=1", "display_name": "accurist", "link": "https://stackoverflow.com/users/11001266/accurist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55368241, "answer_count": 1, "score": 0, "last_activity_date": 1553673406, "creation_date": 1553639496, "last_edit_date": 1553673406, "question_id": 55367107, "link": "https://stackoverflow.com/questions/55367107/dependent-cell-value-with-multiple-conditions-in-excel", "title": "Dependent cell value with multiple conditions in excel", "body": "<p>I was hoping someone could lead me in right direction here.</p>\n\n<p>Basically I am looking for a formula or VBA code to change the cell A1 value depending on multiple different conditions. The conditions are different name ranges ( in form of drop down list ) in different worksheets. So for example here are the 3 different conditions:</p>\n\n<ol>\n<li><p>If the NameRange1 in sheet1 = \u201cyes\u201d then cell A1 = A otherwise do nothing</p></li>\n<li><p>If NameRange2 in Sheet2 = 2 Then A1 = B otherwise A1 = C </p></li>\n<li><p>If none of those conditions are meet then A1 = D</p></li>\n</ol>\n\n<p>I am new to Excel and I know it\u2019s quite messy but I was thinking of nested if statements with first two conditions nested inside true statement and last condition in false?</p>\n\n<pre><code>=IF(A1=\"\",IF(condition1,IF(condition2),condition3))\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["excel", "vba", "fibonacci"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553638081, "post_id": 55366847, "comment_id": 97457387, "body": "remove the <code>While</code> from the <code>Do</code> and add <code>While sum + a &lt; 100</code> to <code>Loop</code>."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553638862, "post_id": 55366847, "comment_id": 97457613, "body": "Or just replace <code>Do While sum &lt; 100</code> with <code>Do While a + b &lt; 100</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553639507, "post_id": 55366847, "comment_id": 97457829, "body": "Both methods above return <code>88</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553639601, "post_id": 55366847, "comment_id": 97457868, "body": "BTW, it does not only do even.  Every 3rd loop after the second returns an odd number for SUM."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553640085, "post_id": 55366847, "comment_id": 97458017, "body": "You will also need to change the <code>a = a + 1</code> to <code>a = IIf(a = 0, 1, a)</code> the other is causing the sequence to not be correct."}], "owner": {"reputation": 1, "user_id": 11262945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e92a680b59a3805174ab689f895adaa1?s=128&d=identicon&r=PG&f=1", "display_name": "goodk", "link": "https://stackoverflow.com/users/11262945/goodk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553673278, "creation_date": 1553637814, "last_edit_date": 1553673278, "question_id": 55366847, "link": "https://stackoverflow.com/questions/55366847/vba-sum-of-fibonacci-even-numbers-till-sum-100", "title": "VBA Sum of Fibonacci even numbers till sum &lt; 100", "body": "<p>I need your help regarding my homework.\nThe aim is to sum all even numbers from Fibonacci sequence till the sum reach &lt; 100</p>\n\n<p>I have created formula as below </p>\n\n<pre><code>Sub fibbo()\n\nDim sum As Long\nDim a As Long\nDim b As Long\nsum = 0\n\n    Do While sum &lt; 100\n\n        sum = a + b\n        a = b\n        b = sum\n        a = a + 1\n\n    Loop\n\nRange(\"A1\").Value = sum\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that sum is over 100.</p>\n\n<p>Please help. Thank you in advance.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1553637868, "post_id": 55366500, "comment_id": 97457322, "body": "Could you please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that we have complete context for testing? As it stands, we can&#39;t be <i>sure</i> what <code>objWord</code> is, nor how <code>objSelection</code> is declared. We can <i>guess</i> that this is being called from another application, but it&#39;s not clear if that&#39;s the case, nor which application it might be. It would also be very important to know WHAT is selected at this moment. Possibly, it&#39;s something that doesn&#39;t allow the action being executed..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553642661, "post_id": 55366500, "comment_id": 97458772, "body": "See my question in my answer to your earlier question today.  If that makes sense.   <a href=\"https://stackoverflow.com/questions/55364402/error-when-trying-to-get-to-a-bookmark-in-word-doc-using-vba-run-time-error-43\" title=\"error when trying to get to a bookmark in word doc using vba run time error 43\">stackoverflow.com/questions/55364402/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 11262245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34365d24819e1d185241ab9fcb5a8d9?s=128&d=identicon&r=PG&f=1", "display_name": "lbj420420", "link": "https://stackoverflow.com/users/11262245/lbj420420"}, "edited": false, "score": 0, "creation_date": 1553643598, "post_id": 55366500, "comment_id": 97459016, "body": "i have provided my context to the problem. To Tim Williams, you answered my question earlier but now i tried to used the code earlier into a while loop, and now it is not working again."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1553647145, "post_id": 55366500, "comment_id": 97459786, "body": "My earlier question was about adding a reference to the Word Object Library to your VB Project - see @CindyMeister&#39;s answer below.  <a href=\"https://stackoverflow.com/questions/36800137/how-to-add-references-to-excel-vba-for-word-programming\" title=\"how to add references to excel vba for word programming\">stackoverflow.com/questions/36800137/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11262245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34365d24819e1d185241ab9fcb5a8d9?s=128&d=identicon&r=PG&f=1", "display_name": "lbj420420", "link": "https://stackoverflow.com/users/11262245/lbj420420"}, "edited": false, "score": 0, "creation_date": 1553642077, "post_id": 55366907, "comment_id": 97458620, "body": "i got compile error: user-defined type not defined on &quot;Dim rng as Word.Range&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 11262245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34365d24819e1d185241ab9fcb5a8d9?s=128&d=identicon&r=PG&f=1", "display_name": "lbj420420", "link": "https://stackoverflow.com/users/11262245/lbj420420"}, "edited": false, "score": 0, "creation_date": 1553666326, "post_id": 55366907, "comment_id": 97463902, "body": "@lbj420420 Look at the comment to the right of <code>Dim rng as Word.Range</code>. Since you provided no context in the question, originally, I could not know which declaration was appropriate when I composed my answer. A certain basic understanding of what you&#39;re doing is assumed when you ask questions on Stack Overflow..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1553786496, "last_edit_date": 1553786496, "creation_date": 1553638142, "answer_id": 55366907, "question_id": 55366500, "link": "https://stackoverflow.com/questions/55366500/bad-parameter-when-using-objselection-endkey-to-move-to-the-bottom-of-a-word-doc/55366907#55366907", "title": "Bad Parameter when using objSelection.EndKey to move to the bottom of a word doc", "body": "<p>A more reliable way to get to the end of the document:</p>\n\n<pre><code>Dim rng as Object ' or Word.Range\nSet rng = ActiveDocument.Content\nrng.Collapse wdCollapseEnd\nrng.Paste\n</code></pre>\n\n<p>Note, however, if Word is being automated from another application (Excel, for example) <em>and</em> there is no reference to the Word object library in that project, that Word-specific enumeration cannot be used since VBA in the other application will not be able to recognize it. In this case, the numerical equivalent needs to be provided instead of the <code>wd</code> enumeration. So:</p>\n\n<pre><code>rng.Collapsed 0\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11262245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34365d24819e1d185241ab9fcb5a8d9?s=128&d=identicon&r=PG&f=1", "display_name": "lbj420420", "link": "https://stackoverflow.com/users/11262245/lbj420420"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553786496, "creation_date": 1553635871, "last_edit_date": 1553643974, "question_id": 55366500, "link": "https://stackoverflow.com/questions/55366500/bad-parameter-when-using-objselection-endkey-to-move-to-the-bottom-of-a-word-doc", "title": "Bad Parameter when using objSelection.EndKey to move to the bottom of a word doc", "body": "<p>I'm trying to move the cursor to the very end of a word doc and paste a chart. But i'm getting an error message of \"Bad Parameter\" on this line \"objSelection.EndKey Unit:=wdStory\"</p>\n\n<pre><code> Dim objWord As Object\n Set objWord = CreateObject(\"Word.Application\")\n\n objWord.Documents.Open \"N:\\Template\\Template.docx\"\n objWord.Visible = True\n ThisWorkbook.Activate\n...\n</code></pre>\n\n<p>then i had this in a while loop:</p>\n\n<pre><code>Do While IsEmpty(Range(\"A1\").Value) = False\n...\nRange(\"D:D,F:F\").Select 'select date and value\n\nRange(\"F1\").Activate\nActiveSheet.Shapes.AddChart2(227, xlLine).Select\n\nActiveChart.ChartTitle.Text = subregion &amp; \" \" &amp; typ &amp; \" \" &amp; cate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlCategory).Select\nActiveChart.PlotArea.Select\nActiveChart.FullSeriesCollection(1).Select\nActiveChart.FullSeriesCollection(1).ApplyDataLabels\nActiveChart.Axes(xlCategory).Select\nSelection.TickLabels.NumberFormat = \"m/yyyy\"\nActiveChart.Parent.Copy\nobjWord.Activate\nobjWord.Visible = True\nSet objSelection = objWord.Selection                 \nobjSelection.EndKey Unit:=wdStory                                \nobjWord.Selection.Paste\n...\nloop\n</code></pre>\n\n<p>The same code worked in a smaller sample without the while loop. Now i am trying to incorporate the code with my while loop and the oibjSelection.EndKey line kills the macro</p>\n\n<p>my smaller sample that worked: </p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    Dim objWord As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    'Change the directory path and file name to the location'of the document you want to open from Excel\n    objWord.Documents.Open \"N:\\Template\\Template.docx\"\n    objWord.Visible = True\n    ThisWorkbook.Activate\n\n\n    Range(\"A:A,C:C\").Select\n    Range(\"C1\").Activate\n    ActiveSheet.Shapes.AddChart2(227, xlLine).Select\n    ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A:$A,Sheet1!$C:$C\")\n    ActiveChart.Axes(xlCategory).Select\n    Selection.TickLabels.NumberFormat = \"m/yyyy\"\n\n    ActiveChart.Parent.Copy\n    objWord.Activate\n    objWord.Visible = True\n    Set objSelection = objWord.Selection\n\n    objSelection.EndKey Unit:=wdStory\n\n    objWord.Selection.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "windows", "batch-file", "cmd", "sendkeys"], "comments": [{"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 1, "creation_date": 1553635663, "post_id": 55366094, "comment_id": 97456440, "body": "Batch files do not have a send keys method.  That is only available in VB and Jscript."}, {"owner": {"reputation": 25, "user_id": 9650481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ryan dunno", "link": "https://stackoverflow.com/users/9650481/ryan-dunno"}, "reply_to_user": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 0, "creation_date": 1553636665, "post_id": 55366094, "comment_id": 97456860, "body": "Yes, I use JScript in the batch file with:          rem Use %SendKeys% to send keys to the keyboard buffer     set SendKeys=CScript //nologo //E:JScript &quot;%~F0&quot;      var WshShell = WScript.CreateObject(&quot;WScript.Shell&quot;);     WshShell.SendKeys(WScript.Arguments(0));"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1553636668, "post_id": 55366094, "comment_id": 97456863, "body": "Convert your batch file to vbs and for the <i>Shift</i> key, refer to <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/sendkeys-statement\" rel=\"nofollow noreferrer\">SendKeys statement</a> from MS Docs."}, {"owner": {"reputation": 25, "user_id": 9650481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ryan dunno", "link": "https://stackoverflow.com/users/9650481/ryan-dunno"}, "edited": false, "score": 0, "creation_date": 1553636783, "post_id": 55366094, "comment_id": 97456908, "body": "Yeah, I got that, I just don&#39;t know hot to hold shift down while continually holding pressing the arrow key so I can highlight strings."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9650481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ryan dunno", "link": "https://stackoverflow.com/users/9650481/ryan-dunno"}, "edited": false, "score": 0, "creation_date": 1553709625, "post_id": 55367440, "comment_id": 97489401, "body": "Yeah a typo by me, I use ^c and ^v even and didn&#39;t even notice that!  Thanks for your help!"}], "tags": [], "owner": {"reputation": 1113, "user_id": 11059320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCWZp.jpg?s=128&g=1", "display_name": "shadow2020", "link": "https://stackoverflow.com/users/11059320/shadow2020"}, "is_accepted": true, "score": 1, "last_activity_date": 1553642363, "last_edit_date": 1553642363, "creation_date": 1553641480, "answer_id": 55367440, "question_id": 55366094, "link": "https://stackoverflow.com/questions/55366094/batch-file-hold-shift-key-to-hightlight/55367440#55367440", "title": "Batch file hold shift key to hightlight", "body": "<p>Try this for your sendkeys.</p>\n\n<p>Example</p>\n\n<pre><code>%SendKeys% \"+{right}\"\n</code></pre>\n\n<p>^ is for CTRL key rather than shift.</p>\n\n<p>Then for delay try cmd command <code>timeout /t 5</code></p>\n\n<p>On another note since you're using vbs also, you can use that to switch your windows as well.</p>\n\n<pre><code>Dim ObjShell :Set ObjShell = CreateObject(\"Wscript.Shell\")\nObjShell.AppActivate(\"Notepad\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9650481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ryan dunno", "link": "https://stackoverflow.com/users/9650481/ryan-dunno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 55367440, "answer_count": 1, "score": 0, "last_activity_date": 1553642363, "creation_date": 1553633915, "last_edit_date": 1553634003, "question_id": 55366094, "link": "https://stackoverflow.com/questions/55366094/batch-file-hold-shift-key-to-hightlight", "title": "Batch file hold shift key to hightlight", "body": "<p>we run WinSQL with DB2's begin and end statements.  We have multiple scripts in one file.  I was wondering if there was a way to hold down shift with SendKeys to use the right arrow/down arrows to highlight the text I want to run.  Does it need a loop?  And how do I do a 5 second delay before it starts so I can switch the windows when I run it?  I tried:</p>\n\n<pre><code>set /P \"=Wait and send a command: \" &lt; NUL\nping -n 1 -w 1 127.0.0.1 &gt; NUL\n%SendKeys% \"^{RIGHT}\"\n</code></pre>\n\n<p>for the highlighting, multiple times, but it forgets about the shift key and just moves right multiple times.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 4, "creation_date": 1553633499, "post_id": 55365968, "comment_id": 97455578, "body": "Try using Resize without 0 in that way <code>Set rng1 = .Range(&quot;A&quot; &amp; i).Resize(, 16)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1553633581, "post_id": 55365968, "comment_id": 97455598, "body": "You can&#39;t resize to zero rows, has to be at least 1, as per YasserKhalil&#39;s comment."}, {"owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "edited": false, "score": 1, "creation_date": 1553633730, "post_id": 55365968, "comment_id": 97455647, "body": "Yep, this was exactly my issue! Thanks both of you!"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "is_accepted": false, "score": 0, "last_activity_date": 1553633698, "creation_date": 1553633698, "answer_id": 55366039, "question_id": 55365968, "link": "https://stackoverflow.com/questions/55365968/resize-range-copy-and-paste-new-range/55366039#55366039", "title": "Resize range, copy and paste new range", "body": "<p>Per YasserKhalil (and SJR) you cannot resize to zero, so just omit the zero and change to <code>Resize(, 16)</code></p>\n"}], "owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553633698, "creation_date": 1553633423, "question_id": 55365968, "link": "https://stackoverflow.com/questions/55365968/resize-range-copy-and-paste-new-range", "title": "Resize range, copy and paste new range", "body": "<p>I am trying to loop through the rows of an Excel worksheet, select a row of data as a range, copy and paste it into the desired worksheet. </p>\n\n<p>I am currently trying the below method which gives an error on the <code>.Resize()</code> part.</p>\n\n<pre><code>With ws1\n    For i = 2 To LastRow\n        Set rng1 = .Range(\"A\" &amp; i).Resize(0, 16)\n        rng1.Copy Destination:=wb1.Sheets(destination).Range(\"A\" &amp; lastRow2 + 1) \n</code></pre>\n\n<p>I get a 1004 error on the third line. I am using the copy/paste methodology from earlier in the code, so I think that is working correctly. </p>\n\n<p>I have tried to use:</p>\n\n<pre><code>Set rng1 = .Range(\"A\" &amp; i)\nrng1.Resize(0, 16)\n</code></pre>\n\n<p>and also</p>\n\n<pre><code>Set rng1 = .Range(\"A\" &amp; i)\nSet rng1 = rng1.Resize(0, 16)\n</code></pre>\n\n<p>but I get the same error each time. I know this is likely a simple syntax issue but I've spent the past 20 minutes looking online and cant figure out what the solution is.</p>\n\n<p>I have thought about maybe trying the <code>EntireRow</code> method but I am stubbornly trying to understand what is wrong with my current methodology. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553633686, "post_id": 55365957, "comment_id": 97455637, "body": "You&#39;re looping through C and D and clearing the column one to the right, i.e. D and E."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "edited": false, "score": 0, "creation_date": 1553693362, "post_id": 55366088, "comment_id": 97478971, "body": "Thanks! This works perfectly. Now I have 3 sets of &quot;columns&quot; on the same page next to each other. Instead of repeating the code 2 more times and changing &quot;A:E&quot; for &quot;F:J&quot;, etc. (I tried doing this and it works but makes the code longer) is there a simpler way to do this? Thanks so much!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1553696004, "last_edit_date": 1553696004, "creation_date": 1553633887, "answer_id": 55366088, "question_id": 55365957, "link": "https://stackoverflow.com/questions/55365957/vba-clear-cells-adjacent-to-the-column-if-it-is-empty/55366088#55366088", "title": "VBA clear cells adjacent to the column if it is empty", "body": "<p>Something like this might be what you're looking for:</p>\n\n<pre><code>Sub ClearCust()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rLast As Range\n\n    'Set wb = Workbooks(\"OH Details_v1\")\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet1\")\n    Set rLast = ws.Range(\"A:E\").Find(\"*\", ws.Range(\"A1\"), xlValues, , , xlPrevious)\n    If rLast Is Nothing Then Exit Sub   'No data\n\n    With ws.Range(\"C1:C\" &amp; rLast.Row)\n        .AutoFilter 1, \"=\"\n        Intersect(.Parent.Range(\"A:E\"), .Offset(1).EntireRow).ClearContents\n        .AutoFilter\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>To address your request of iterating over sets of columns to perform this same task, you can do something like this:</p>\n\n<pre><code>Sub ClearCust()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rLast As Range\n    Dim aClearAreas() As String\n    Dim i As Long\n\n    'Set wb = Workbooks(\"OH Details_v1\")\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet1\")\n    ReDim aClearAreas(1 To 3, 1 To 2)\n        'Define columns that will be cleared    Define column within that range to evaluate for blanks\n        aClearAreas(1, 1) = \"A:E\":              aClearAreas(1, 2) = \"C\"\n        aClearAreas(2, 1) = \"F:J\":              aClearAreas(2, 2) = \"H\"\n        aClearAreas(3, 1) = \"K:O\":              aClearAreas(3, 2) = \"M\"\n\n    'loop through your array that contains your clear area data\n    For i = LBound(aClearAreas, 1) To UBound(aClearAreas, 1)\n        'Get last populated row within the defined range\n        Set rLast = ws.Range(aClearAreas(i, 1)).Find(\"*\", ws.Range(aClearAreas(i, 1)).Cells(1), xlValues, , , xlPrevious)\n        If Not rLast Is Nothing Then\n            'Filter on the column to be evaluated\n            With ws.Range(aClearAreas(i, 2) &amp; \"1:\" &amp; aClearAreas(i, 2) &amp; rLast.Row)\n                .AutoFilter 1, \"=\"                                                                  'Filter for blanks\n                Intersect(.Parent.Range(aClearAreas(i, 1)), .Offset(1).EntireRow).ClearContents     'Clear cells only in the defined range\n                .AutoFilter                                                                         'Remove the filter\n            End With\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 10867189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gV_nfI5zrLQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYzWv5emqCz9bfWiaFYLBB7rVHMcg/mo/photo.jpg?sz=128", "display_name": "Mehmet Canbulat", "link": "https://stackoverflow.com/users/10867189/mehmet-canbulat"}, "is_accepted": false, "score": 0, "last_activity_date": 1553670996, "last_edit_date": 1553670996, "creation_date": 1553670695, "answer_id": 55371633, "question_id": 55365957, "link": "https://stackoverflow.com/questions/55365957/vba-clear-cells-adjacent-to-the-column-if-it-is-empty/55371633#55371633", "title": "VBA clear cells adjacent to the column if it is empty", "body": "<p>Your explanation and title are two different subjects but based on your explanation-i understand you want to loop through column C and if a cell is empty, then you make other cells value to blank-i wrote below code. You may use. Tested</p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\n\nSet ws = ActiveSheet\n\nWith ws\n\n    lr = .Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    For i = 2 To lr\n        If .Cells(i, \"C\") = \"\" Then\n            .Cells(i, \"A\") = \"\"\n            .Cells(i, \"B\") = \"\"\n            .Cells(i, \"D\") = \"\"\n            .Cells(i, \"E\") = \"\"\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 55366088, "answer_count": 2, "score": 0, "last_activity_date": 1553696004, "creation_date": 1553633387, "last_edit_date": 1553694357, "question_id": 55365957, "link": "https://stackoverflow.com/questions/55365957/vba-clear-cells-adjacent-to-the-column-if-it-is-empty", "title": "VBA clear cells adjacent to the column if it is empty", "body": "<p>I have 5 columns. If column 3 has no value, I want all other adjacent cells (column 1,2,4,5) to clear.\nI got this from another site:</p>\n\n<pre><code>    Sub ClearCust()\n'Clears data in column if there is no Amt number next to it.\n'Used in conjunction to fill blanks.\nDim j As Range\nFor Each j In Workbooks(\"OH Details_v1\").Worksheets(\"Sheet1\").Range(\"C2:D\" &amp; Worksheets(\"Sheet1\").Range(\"a65536\").End(xlUp).Row)\n    If j.Value = 0 Then\n        j.Offset(0, 1).ClearContents\n    End If\nNext j\n</code></pre>\n\n<p>End Sub</p>\n\n<p>But it only clears column C, D, E...</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1553634737, "creation_date": 1553634737, "answer_id": 55366260, "question_id": 55365902, "link": "https://stackoverflow.com/questions/55365902/how-do-i-add-spaces-to-each-column-in-a-range-where-the-character-counts-of-eac/55366260#55366260", "title": "How do I add spaces to each column in a range, where the character counts of each column equals 20?", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub tgr()\n\n    'Change this to be the columns you need to adjust\n    Const sColumns As String = \"A:D,F:F\"\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rArea As Range\n    Dim rData As Range\n    Dim rLast As Range\n    Dim aData() As Variant\n    Dim i As Long, j As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"osbstd\")\n\n    For Each rArea In ws.Range(sColumns).Areas\n        Set rLast = rArea.Find(\"*\", rArea.Cells(1), xlValues, , , xlPrevious)\n        If Not rLast Is Nothing Then\n            With rArea.Resize(rLast.Row)\n                If .Cells.Count = 1 Then\n                    ReDim aData(1 To 1, 1 To 1)\n                    aData(1, 1) = .Value\n                Else\n                    aData = .Value\n                End If\n                For i = 1 To UBound(aData, 1)\n                    For j = 1 To UBound(aData, 2)\n                        If Len(aData(i, j)) &gt; 0 Then aData(i, j) = Left(aData(i, j) &amp; Space(20), 20)\n                    Next j\n                Next i\n                .Value = aData\n                Erase aData\n            End With\n        End If\n    Next rArea\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 6441562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E2h7P.png?s=128&g=1", "display_name": "MikeR", "link": "https://stackoverflow.com/users/6441562/miker"}, "is_accepted": false, "score": 0, "last_activity_date": 1553635303, "creation_date": 1553635303, "answer_id": 55366381, "question_id": 55365902, "link": "https://stackoverflow.com/questions/55365902/how-do-i-add-spaces-to-each-column-in-a-range-where-the-character-counts-of-eac/55366381#55366381", "title": "How do I add spaces to each column in a range, where the character counts of each column equals 20?", "body": "<p>For me the simplest way to do that is like this :</p>\n\n<pre><code>Dim result As String\nFor j = 1 To 23\n    For i = 1 To 10000\n        result = Cells(i, j).Value\n        Do While Len(result) &lt; 20\n            result = result &amp; \" \"\n        Loop\n        Cells(i, j).Value = result\n    Next i\nNext j\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11239909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c514275641df4d341a87632d2ddb58ec?s=128&d=identicon&r=PG&f=1", "display_name": "entrylevelguy", "link": "https://stackoverflow.com/users/11239909/entrylevelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553637365, "creation_date": 1553633053, "last_edit_date": 1553633330, "question_id": 55365902, "link": "https://stackoverflow.com/questions/55365902/how-do-i-add-spaces-to-each-column-in-a-range-where-the-character-counts-of-eac", "title": "How do I add spaces to each column in a range, where the character counts of each column equals 20?", "body": "<p>There is a program I use that only takes data with 20 characters in each cell. Each column has the same number of characters per cell, but they vary from one to eight. Is there anyway to enter spaces in each cell so that they add up to 20 characters? </p>\n\n<pre><code>Dim wb1 As Workbook\nDim ws1 As Worksheet\nDim rang As range\nDim colA As range\n\nSet wb1 = ThisWorkbook\nSet ws1 = wb1.Sheets(\"osbstd\")\nSet rng = ws1.range(\"A1:FJ10000\")\nSet colA = ws1.range(\"A1:A10000\")\n\nFor Each one In Selection\n   If colA.Value &lt;&gt; \"\" Then colA.Value = colA.Value &amp; Space(19)\nNext\n</code></pre>\n\n<p>Looking for a simpler way to do this instead of dimming each column (because there is 23 columns) and doing an if statement for each column</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1553634360, "post_id": 55365754, "comment_id": 97455934, "body": "There are two statements on the same line. Try just <code>C.Shape.TextFrame.AutoSize = True</code>"}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1553690990, "post_id": 55365754, "comment_id": 97477262, "body": "Thank you for the response. I have just tried this line in the place of my previous incorrect line. It gave error 438. &quot;Object doesn&#39;t support this property or method&quot;. So I added <code>C.COMMENT.Shape.TextFrame.AutoSize = True</code> and it worked. Thank you so much."}], "owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1099, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1553632477, "creation_date": 1553632304, "last_edit_date": 1553632477, "question_id": 55365754, "link": "https://stackoverflow.com/questions/55365754/how-to-auto-size-comment-box-to-fit-its-content", "title": "How to auto-size comment box to fit its content?", "body": "<p>I am trying to turn the text contents of a single cell into a comment on that cell and then have the comment auto size to fit the true size of the contents. I found two separate macros that work but I am having trouble combining them into one macro.</p>\n\n<p>The below code works by converting the selected cell into a comment.\n<a href=\"https://sumtips.com/tips-n-tricks/convert-excel-cell-contents-comments-vba/\" rel=\"nofollow noreferrer\">https://sumtips.com/tips-n-tricks/convert-excel-cell-contents-comments-vba/</a></p>\n\n<pre><code>Sub ConvertToComment()\nDim C As Range\nFor Each C In Selection\n    C.ClearComments\n    If Len(C.Value) &gt; 0 Then\n        C.AddComment\n        C.COMMENT.Text C.Value &amp; \"\"\n    End If\n    'Optional: Delete cell content after converting\n    C = \"See Comment\"\n    Next C\nEnd Sub\n</code></pre>\n\n<p>The below code works in auto sizing all the comments on the sheet.\n<a href=\"https://quadexcel.com/how-to-auto-size-comment-box-to-fit-its-content-in-excel/\" rel=\"nofollow noreferrer\">https://quadexcel.com/how-to-auto-size-comment-box-to-fit-its-content-in-excel/</a></p>\n\n<pre><code>Sub FitComments()\nDim xComment As Comment\nFor Each xComment In Application.ActiveSheet.Comments\nxComment.Shape.TextFrame.AutoSize = True\nNext\nEnd Sub\n</code></pre>\n\n<p>How can I incorporate the below line into the ConvertToComment() macro at the top?</p>\n\n<pre><code>xComment.Shape.TextFrame.AutoSize = True\n</code></pre>\n\n<p>The below code is my sad attempt to add a line I think is important to make it work the way I want it to. Create the comment and Autosize the created comment to fit the content. I am still very new to VBA.</p>\n\n<pre><code>Sub ConvertToComment()\nDim C As Range\nDim xComment As COMMENT\nFor Each C In Selection\n    C.ClearComments\n    If Len(C.Value) &gt; 0 Then\n        C.AddComment\n        C.COMMENT.Text C.Value &amp; \"\"\n  --&gt;   COMMENT.Text C.Shape.TextFrame.AutoSize = True\n    End If\n    'Optional: Delete cell content after converting\n    C = \"See Comment\"\n    Next C\nEnd Sub\n</code></pre>\n\n<p>Error Message \"Object doesn't support this project or method\"</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11261839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e493e377dcf691265f6e21cd1973b?s=128&d=identicon&r=PG&f=1", "display_name": "Ebartsch", "link": "https://stackoverflow.com/users/11261839/ebartsch"}, "edited": false, "score": 0, "creation_date": 1553956977, "post_id": 55371440, "comment_id": 97582738, "body": "Awww yeah! Thanks, Gustav, that totally worked. Can you explain (or link to an explanation) this bit:  &quot;[ID] = &quot; &amp; Me![ID].Value &amp; &quot;&quot;  And thanks again! I was way stumped!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 5, "user_id": 11261839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e493e377dcf691265f6e21cd1973b?s=128&d=identicon&r=PG&f=1", "display_name": "Ebartsch", "link": "https://stackoverflow.com/users/11261839/ebartsch"}, "edited": false, "score": 0, "creation_date": 1553964256, "post_id": 55371440, "comment_id": 97584653, "body": "It is the filter expression that - when the report opens - filters the report on this single record."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1553669899, "creation_date": 1553669899, "answer_id": 55371440, "question_id": 55365743, "link": "https://stackoverflow.com/questions/55365743/ms-access-16-query-not-pulling-a-value-from-a-field/55371440#55371440", "title": "MS Access &#39;16 - Query not pulling a value from a field", "body": "<p>That's because you move a new (empty) record - having no ID.</p>\n\n<p>I guess, all you need is to use the current ID of the form - and use the correct syntax for the filter:</p>\n\n<pre><code>Private Sub Add_Rpt_Btn_Click()\n\n    If MsgBox(\"Are you sure? No backsies.\", vbYesNo, \"Add Report?\") = vbNo Then\n        Exit Sub\n    End If\n\n    ' Check for Necessary Fields and Add New Record\n    If (IsNull(Me.Person_Filing) Or IsNull(Me.Nature_Lst) Or IsNull(Me.Location_Cmb) Or IsNull(Me.Summary) Or IsNull(Me.Narrative)) = True Then\n        MsgBox \"Looks like you left some important information out. Please fill out all fields with an asterisk.\", vbOKOnly, Whoops\n        Exit Sub\n    End If\n\n    ' If not saved, save the current record.\n    If Me.Dirty = True Then\n        Me.Dirty = False\n    End If\n\n    DoCmd.OpenReport \"Incident_Report_1\", acViewReport, , \"[ID] = \" &amp; Me![ID].Value &amp; \"\"\n\n    ' Close Form without Saving\n    DoCmd.Close acForm, Me.Name, acSaveNo\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11261839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e493e377dcf691265f6e21cd1973b?s=128&d=identicon&r=PG&f=1", "display_name": "Ebartsch", "link": "https://stackoverflow.com/users/11261839/ebartsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55371440, "answer_count": 1, "score": 0, "last_activity_date": 1594620922, "creation_date": 1553632259, "last_edit_date": 1594620922, "question_id": 55365743, "link": "https://stackoverflow.com/questions/55365743/ms-access-16-query-not-pulling-a-value-from-a-field", "title": "MS Access &#39;16 - Query not pulling a value from a field", "body": "<p>[Disclaimer: I'm self-taught and a total novice!]</p>\n\n<p>I have a FORM with which a QUERY pulls data and uses it to populate a REPORT. As the end user finishes the report and clicks a button, the following is supposed to happen:</p>\n\n<p>1) The FORM saves all the data in a new record on the TABLE <br/> 2) A query pulls that record by the ID (which is autonumbered) from the FORM <br/> 3) The QUERY populates a REPORT with the data from the TABLE <br/> 4) The FORM and QUERY close - no need to save.</p>\n\n<p>The QUERY pulls all the data from the corresponding TABLE with the following criteria: [Forms]![Data_Input_Form]![ID]</p>\n\n<p>However, my REPORT comes up blank! Eek!</p>\n\n<p>I have a similar QUERY that pulls data from the same TABLE and populates it to a similar REPORT with the following criteria: Like Nz([Forms]![Home_Form]![Incident_ID_Lookup_text],\"*\")</p>\n\n<p>Unsurprisingly, when I added this to the QUERY that wasn't working how I wanted it to, it reported ALL the previous records. </p>\n\n<pre><code>'------------------------------------------------------------\n' Add Report [and Open Report] Button Click\n'\n'\n'------------------------------------------------------------\n\nPrivate Sub Add_Rpt_Btn_Click()\n\nIf MsgBox(\"Are you sure? No backsies.\", vbYesNo, \"Add Report?\") = vbNo Then\n    Exit Sub\nEnd If\n\n 'Check for Necessary Fields and Add New Record\nIf (IsNull(Me.Person_Filing) Or IsNull(Me.Nature_Lst) Or IsNull(Me.Location_Cmb) Or IsNull(Me.Summary) Or IsNull(Me.Narrative)) = True Then\n    MsgBox \"Looks like you left some important information out. Please fill out all fields with an asterisk.\", vbOKOnly, Whoops\n    Exit Sub\nElse\n    DoCmd.GoToRecord , , acNewRec\nEnd If\n\n 'Run Query to Open Report\nDoCmd.OpenQuery \"Form_to_Report_Qry\"\n\nDoCmd.OpenReport \"Incident_Report_1\", acViewReport, , [ID] = [Forms]![Data_Input_Form]![ID]\n\n 'Close Query without Saving\nDoCmd.Close acQuery, \"Form_to_Report_Qry\", acSaveNo\n\n 'Close Form without Saving\nDoCmd.Close acForm, \"Data_Input_Form\", acSaveNo\n\nEnd Sub\n</code></pre>\n\n<p>The REPORT needs to populate with the most recent record, but it keeps coming up blank.</p>\n"}, {"tags": ["excel", "vba", "range", "vlookup"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553632531, "post_id": 55365720, "comment_id": 97455181, "body": "Which line are you getting the error on?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553632736, "post_id": 55365720, "comment_id": 97455260, "body": "Also, if you&#39;re adding a VBA reference into a string equation for Excel, you need to add the variables like <code>&quot;=IfError(Vlookup(&quot; &amp; &quot;namerng &amp; &quot;,&quot; &amp; rng &amp; &quot;,2,FALSE), &quot;&quot;&quot;&quot;)&quot;</code> (Note the extra quotation marks to add them to the string. if you did <code>Debug.Print &quot;=IfError(Vlookup(namerng,rng,2,FALSE), &quot;&quot;)&quot;</code>, the output would be <code>=IfError(Vlookup(namerng,rng,2,FALSE), &quot;)</code>)"}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553632809, "post_id": 55365720, "comment_id": 97455286, "body": "I am getting the error on the Range(&quot;B&quot; &amp; depti) = dept line"}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553633025, "post_id": 55365720, "comment_id": 97455374, "body": "Adding that debug.print got the program to run, but no values are in column B for the department"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553633559, "post_id": 55365720, "comment_id": 97455592, "body": "I believe if you use <code>dept = &quot;=IfError(Vlookup(&quot; &amp; namerng.Address &amp; &quot;,&quot; &amp; rng.Address &amp; &quot;,2,FALSE), &quot;&quot;&quot;&quot;)&quot;</code>, it should run and insert the equation. However, I&#39;m not convinced that this equation is what you want. Right now, there are circular references (everything&#39;s happening on the same sheet), and VLOOKUP only accepts one value for the first param, not a range of multiple cells."}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553634074, "post_id": 55365720, "comment_id": 97455800, "body": "Hmm yes, you are right.. It was working in the sheet because we could drag down the equation for each cell."}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553634099, "post_id": 55365720, "comment_id": 97455815, "body": "Maybe I need to take a new approach, if you have any ideas let me know!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553634121, "post_id": 55365720, "comment_id": 97455827, "body": "I&#39;m adding an answer now, that I think will work."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553637264, "post_id": 55365720, "comment_id": 97457097, "body": "I believe this can all be done with a simple formula without VBA, if you could share more, a screenshot or a sample file/data, this would be easier."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "edited": false, "score": 0, "creation_date": 1553717844, "post_id": 55366184, "comment_id": 97493412, "body": "Thank you so much for the comment! This worked very well for me, with the exception of a few tweaks just because, you are right, I picked a select part from my code to post so I had a few more things going along with it I had to account for. Thank you again!!"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "edited": false, "score": 0, "creation_date": 1553718107, "post_id": 55366184, "comment_id": 97493530, "body": "You are welcome. If my answer worked for you, please mark it as the answer by clicking the check mark."}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "edited": false, "score": 0, "creation_date": 1553721941, "post_id": 55366184, "comment_id": 97495329, "body": "Just did! Sorry still new to this site haha"}], "tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": true, "score": 0, "last_activity_date": 1553634702, "last_edit_date": 1553634702, "creation_date": 1553634373, "answer_id": 55366184, "question_id": 55365720, "link": "https://stackoverflow.com/questions/55365720/vlookup-function-in-vba-return-a-department-value-based-on-name-value/55366184#55366184", "title": "VLookup function in VBA - Return a department value based on name value", "body": "<p>It looks like you're missing some code to try and fulfill what you're wanting, so some of the below is an assumption.</p>\n\n<pre><code>Sub find()\n\n    Dim namerng As Range 'List of Randomly Organized Names Only\n    Dim Lookuprng As Range 'List of Names and Departments\n    Dim sh1 As Worksheet\n    Dim sh2 As Worksheet\n\n    Set sh1 = ThisWorkbook.Worksheets(1) 'List of Randomly Organized Names Only\n    Set sh2 = ThisWorkbook.Worksheets(2) 'List of Names and Departments\n\n    'List of Names and Departments\n    sh1.Activate\n    Set Lookuprng = sh1.Range(Cells(1, 1), (Cells(Rows.Count, 2).End(xlUp)))\n\n    'List of Randomly Organized Names Only  ******NEED TO SPECIFY WHERE THESE NAMES ARE COMING FROM, I used Sheet1\n    sh2.Activate\n    Set namerng = sh2.Range(Cells(1, 1), (Cells(Rows.Count, 1).End(xlUp)))\n\n    'Put correct department with name\n    namerng.Offset(0, 1) = Application.VLookup(namerng, Lookuprng, 2, False)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1553634552, "post_id": 55366187, "comment_id": 97456011, "body": "W-hit&#39;s answer looks like it will fill in the actually department values, while mine will fill in an excel equation which returns them. (<a href=\"https://stackoverflow.com/a/55366184\">stackoverflow.com/a/55366184</a>)"}, {"owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "edited": false, "score": 0, "creation_date": 1553717722, "post_id": 55366187, "comment_id": 97493351, "body": "Thank you so much for the response! This was getting the program to run, but would not pull the values from the second sheet that I needed. I think it was an issue on my end however, as my formulas in the sheet got messed up along the line, and anyone who sees this in the future can use this to help them out"}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1553634762, "last_edit_date": 1553634762, "creation_date": 1553634376, "answer_id": 55366187, "question_id": 55365720, "link": "https://stackoverflow.com/questions/55365720/vlookup-function-in-vba-return-a-department-value-based-on-name-value/55366187#55366187", "title": "VLookup function in VBA - Return a department value based on name value", "body": "<p>Based on your description of the issue and the problem you want to solve, I believe that the following code should work as needed.</p>\n\n<pre><code>Sub find()\n\nDim rng As Range\nDim depti As Integer\nDim dept As String\n\nSet rng = Sheet1.Range(\"A1:B250\") 'range of names in col A and dept in col B\n\n    For depti = 3 To 250\n     dept = \"=IfError(Vlookup(A\" &amp; depti &amp; \",'\" &amp; Sheet1.Name &amp; \"'!\" &amp; rng.Address &amp; \",2,FALSE), \"\"\"\")\"\n     Range(\"B\" &amp; depti) = dept\n    Next\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Notes</strong></p>\n\n<p>I eliminated the <code>namerng</code> variable, because we don't need it for the updated equation. Since VLookup only takes a single value as the first param, that value should be dependent on the value of the loop variable, same as the destination range is.</p>\n\n<p>I also escaped the quotation marks, so that the function would be valid, and added in the sheet1.name, so that the range address will point to the correct sheet (with single quotation marks, in case the sheet name has a space in it).</p>\n\n<p>A cautionary note: the way this is coded, the equation will be inserted on whichever sheet is the active one at the time of the code run. This means that if <code>Sheet1</code> is active, the departments will get overwritten with a circular-formula.</p>\n"}], "owner": {"reputation": 3, "user_id": 11262502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a55ab5c820286eab93179042735a4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jpb104", "link": "https://stackoverflow.com/users/11262502/jpb104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55366184, "answer_count": 2, "score": 0, "last_activity_date": 1553673262, "creation_date": 1553632160, "last_edit_date": 1553673262, "question_id": 55365720, "link": "https://stackoverflow.com/questions/55365720/vlookup-function-in-vba-return-a-department-value-based-on-name-value", "title": "VLookup function in VBA - Return a department value based on name value", "body": "<p>I am looking to return a department value based off a name value. The name list is imported from a third party vendor, which randomizes the order each time, so I cannot set a department value to a specified cell. I have a range of data (dim rng) which has a name and column A and a department in column B. I would like the department associated with the name to be returned with the same on the new sheet. I have attached my code but am getting application defined or object-defined error and I am not sure why.</p>\n\n<pre><code>Sub find()\n\nDim namerng As Range\nDim rng As Range\nDim depti As Integer\nDim dept As String\n\nSet namerng = Range(\"A1:A250\") 'range of names\nSet rng = Sheet1.Range(\"A1:B250\") 'range of names in col A and dept in col B\n\n    For depti = 3 To 250\n     dept = \"=IfError(Vlookup(namerng,rng,2,FALSE), \"\")\"\n     Range(\"B\" &amp; depti) = dept\n\n    Next\n\nEnd Sub\n</code></pre>\n"}]