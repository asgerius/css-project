[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1477526047, "creation_date": 1477526047, "answer_id": 40273953, "question_id": 40273805, "link": "https://stackoverflow.com/questions/40273805/autofilter-with-more-than-3-criteria/40273953#40273953", "title": "Autofilter with more than 3 criteria", "body": "<p><em>64</em> is beyond column <strong>BK</strong>.  The max you can have is <em>63</em></p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 40273953, "answer_count": 1, "score": 0, "last_activity_date": 1477526047, "creation_date": 1477524984, "question_id": 40273805, "link": "https://stackoverflow.com/questions/40273805/autofilter-with-more-than-3-criteria", "title": "Autofilter with more than 3 criteria", "body": "<p>I am using the following code to autofilter a column using more than 3 criteria - however, it is saying the \"Autofilter method of range class failed\"</p>\n\n<p>This code looked to be working on another SO post.</p>\n\n<p>Can anyone assist?</p>\n\n<p>Thanks</p>\n\n<pre><code>Public Sub autofilter2()\nDim ws As Worksheet\nDim wsOut As Worksheet\nDim a As String\n\nDim b As String\nDim c As String\n\nSet ws = Worksheets(\"Raw Data\")\n'AutoFilterMode = False\na = Cells(69, 6).Value\nb = Cells(69, 7).Value\nc = Cells(69, 8).Value\n\n\nws.Range(\"A:bk\").autofilter field:=64, _\nCriteria1:=Array(a, b, c), _\nOperator:=xlFilterValues\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1477524820, "post_id": 40273706, "comment_id": 67807179, "body": "I know a simple answer is just to put in two separate conditional formulas, and I may do that, but I was just curious if there was a way to search for both in one statement."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 4, "creation_date": 1477525594, "post_id": 40273706, "comment_id": 67807362, "body": "it should be <code>&quot;&quot;&quot;&quot;</code> in the formula and <code>&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</code> (8 <code>&quot;</code>) in VBA, or <code>CHAR(34)</code> in both <a href=\"https://exceljet.net/formula/double-quotes-inside-a-formula\" rel=\"nofollow noreferrer\">exceljet.net/formula/double-quotes-inside-a-formula</a>"}, {"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477609171, "post_id": 40273706, "comment_id": 67849403, "body": "Wow, eight double quotes! Thanks, this worked for me."}], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477524290, "creation_date": 1477524290, "question_id": 40273706, "link": "https://stackoverflow.com/questions/40273706/excel-vba-conditional-formatting-find-multiple-items", "title": "Excel VBA Conditional Formatting find multiple items", "body": "<p>I am using VBA to write conditional formatting to find a double quote. I have tried various techniques, but it doesn't seem to work</p>\n\n<pre><code>Sub CondForm()\n     With Range(\"A19:AG10000\")\n       .FormatConditions.Add xlExpression, Formula1:=\"=AND(SUM(--ISNUMBER(FIND(\"\"|\"\",A19)))&gt;0,SUM(--ISNUMBER(FIND(\" &amp; Chr(34) &amp; Chr(34) &amp; \",A19)))&gt;0)\"\n       .FormatConditions(2).StopIfTrue = False\n       .FormatConditions(2).Interior.Color = -16776961\n       .FormatConditions(2).Font.Bold = True\n End With\nEnd Sub\n</code></pre>\n\n<p>This generates a correct looking formula\n    <code>=AND(SUM(--ISNUMBER(FIND(\"|\",A19)))&gt;0,SUM(--ISNUMBER(FIND(\"\",A19)))&gt;0)</code>\nBut it only triggers when the 'pipe' value is entered. If I take out the first conditional and just use <code>=SUM(--ISNUMBER(FIND(\"\"\"\",A19)))&gt;0</code> it also works. Does anyone know how to look for BOTH conditions?</p>\n"}, {"tags": ["excel", "vba", "list"], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 6569087, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154248943373290/picture?type=large", "display_name": "kpg987", "link": "https://stackoverflow.com/users/6569087/kpg987"}, "is_accepted": true, "score": 1, "last_activity_date": 1477534641, "creation_date": 1477534641, "answer_id": 40275061, "question_id": 40273353, "link": "https://stackoverflow.com/questions/40273353/appending-items-from-a-list-to-a-new-list-ms-excel/40275061#40275061", "title": "appending items from a list to a new list (MS Excel)", "body": "<p>You may want to try something like I've provided below. Notice that you can grab the cells that you specify by the all the 'x' checkmarks by using the <code>.Offset</code> property. Code below:</p>\n\n<pre><code>Sub move_diagnoses()\nDim diagnosesheet As Worksheet\nDim copysheet As Worksheet\nDim last_diagnosis_row As Integer\nDim last_list_row As Integer\nDim loserange As Range\nDim losecell As Range\n\n'Set your worksheets first\nSet diagnosesheet = Worksheets(\"Diagnoses\")\n'I titled the worksheet you have the diagnoses on as 'Diagnoses' since you didn't specify\nSet copysheet = Worksheets(\"List\")\n\n'Now set the range (i.e. collection of cells) that enumerate all the potential diagnoses\n'First find the last row in the diagnoses column\n'Then find the last used row in the 'List' worksheet\nlast_diagnosis_row = diagnosesheet.Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nlast_list_row = diagnosesheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet loserange = diagnosesheet.Range(\"D2:D\" &amp; last_diagnosis_row)\n'Notice the loserange (i.e. the range that contains the all the checkmarks is defined from D2 onwards\n\nFor Each losecell In loserange.Cells\n    If Trim(losecell.Value) = \"x\" Then\n        copysheet.Cells(last_list_row, 1).Value = losecell.Offset(0, 1).Text\n        copysheet.Cells(last_list_row, 2).Value = losecell.Offset(0, 2).Text\n        last_list_row = last_list_row + 1\n    End If\nNext losecell\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5372620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5969c54261a3426fdbe2c7beab87a0c0?s=128&d=identicon&r=PG&f=1", "display_name": "MonteCristo", "link": "https://stackoverflow.com/users/5372620/montecristo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 40275061, "answer_count": 1, "score": 0, "last_activity_date": 1477534641, "creation_date": 1477522174, "last_edit_date": 1495535253, "question_id": 40273353, "link": "https://stackoverflow.com/questions/40273353/appending-items-from-a-list-to-a-new-list-ms-excel", "title": "appending items from a list to a new list (MS Excel)", "body": "<p>Thank you all for helping with my earlier <a href=\"https://stackoverflow.com/questions/40261129/creating-a-search-function-in-ms-excel\">query</a>. I have included my next obstacle as a separate thread and hope that doesn't violate any rules/etiquette.</p>\n\n<p>I now have a search facility that creates a list of <em>potentially</em> relevant diagnoses:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JwrBf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JwrBf.png\" alt=\"Potentially relevant diagnoses\"></a></p>\n\n<p>What I'd like to be able to do is work down the list of potentially relevant diagnoses and manually eliminate those that are not relevant by placing a \"x\" in the adjacent cell. I would then like to press a button and for all checked diagnoses to be appended to a list on another sheet (titled \"List\"):</p>\n\n<p><a href=\"https://i.stack.imgur.com/lQ94b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lQ94b.png\" alt=\"Dream list!\"></a></p>\n\n<p>In an ideal world, repeating the search/select/button process would then simply append new diagnoses to the same list, i.e. identify the next blank cell in a column on \"List\" and carry on from there. One potential difficulty is that I need to copy the diagnosis text out of each cell rather than the formula that's actually there.</p>\n\n<p>Gary's Student has answered a similar <a href=\"https://stackoverflow.com/questions/30308914/how-to-add-text-to-last-row-of-a-column\">query</a> previously with this script but it doesn't quite get me far enough as it takes data from a single cell and doesn't distinguish between text/formulae:</p>\n\n<pre><code>Sub ButtonCode()\n   Dim N As Long\n   N = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n   Cells(N, \"A\").Value = Range(\"C3\").Value\nEnd Sub\n</code></pre>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1477521202, "post_id": 40273127, "comment_id": 67806165, "body": "You never initialize the <code>mort_price</code> and <code>yield_calc</code> arrays."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1477521348, "post_id": 40273127, "comment_id": 67806213, "body": "Also, constructs like <code>If -0.0001 &lt; coupon &lt; 25.0001 Then</code> are not doing what you think they are (and <code>coupon</code> isn&#39;t declared or initialized anywhere anyway).  See <a href=\"http://stackoverflow.com/documentation/vba/5813/operators/20479/comparison-operators#t=20161026223525440529\">this example</a> from Documentation."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477710821, "post_id": 40276853, "comment_id": 67888413, "body": "<code>If 49.9999 &lt; Yield &lt; 200.0001 Then</code> is <b><i>not</i></b> fine.  <code>49.9999 &lt; Yield</code> will evaluate either to <code>True</code> (-1) or <code>False</code> (0), which will <b><i>always</i></b> be <code>&lt; 200.0001</code>.  See <a href=\"http://stackoverflow.com/documentation/vba/5813/operators/20479/comparison-operators#t=201610290313036822703\">Comparison Operators</a> in Documentation."}, {"owner": {"reputation": 290, "user_id": 1433137, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MzpPY.jpg?s=128&g=1", "display_name": "LeasMaps", "link": "https://stackoverflow.com/users/1433137/leasmaps"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478239785, "post_id": 40276853, "comment_id": 68081961, "body": "True - they won&#39;t run as expected. But they will also not cause the error described."}], "tags": [], "owner": {"reputation": 290, "user_id": 1433137, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MzpPY.jpg?s=128&g=1", "display_name": "LeasMaps", "link": "https://stackoverflow.com/users/1433137/leasmaps"}, "is_accepted": false, "score": -1, "last_activity_date": 1477547062, "last_edit_date": 1477547062, "creation_date": 1477546483, "answer_id": 40276853, "question_id": 40273127, "link": "https://stackoverflow.com/questions/40273127/subscript-out-of-range-for-a-function/40276853#40276853", "title": "Subscript out of Range for a function?", "body": "<p>By my count the lines '21 thru 24' are as follows:</p>\n\n<p>If 49.9999 &lt; Yield &lt; 200.0001 Then</p>\n\n<p>Cells(3, 2).Value = mtgprice</p>\n\n<p>End If</p>\n\n<hr>\n\n<p>Which seem fine.</p>\n\n<ol>\n<li><p>If your functions mort_price, yield_calc or fderiv aren't declared properly you will get \"Subscript out of range\"</p></li>\n<li><p>You will also get \"Subscript out of range\" if a worksheet named 'Sheet1' does not exist in your workbook already.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 7077513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b07234ed5701231c6f23638f973366df?s=128&d=identicon&r=PG&f=1", "display_name": "willshep", "link": "https://stackoverflow.com/users/7077513/willshep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477547062, "creation_date": 1477520880, "question_id": 40273127, "link": "https://stackoverflow.com/questions/40273127/subscript-out-of-range-for-a-function", "title": "Subscript out of Range for a function?", "body": "<p>I'm relatively new to VBA.</p>\n\n<p>I am receiving a \"Subscript out of range\" error while running the below code. The error occurs when attempting call values from the created functions, see lines 21 thru 24</p>\n\n<p>Any help would be much appreciated! </p>\n\n<p>Thanks</p>\n\n<pre><code>Public Sub MtgLnYTM()\n\n Dim cpn As Single, maturity As Integer, price As Integer, mtgprice As Integer,    mort_price() As Double, yield_calc() As Double, calc_price As Integer\n Dim row As Integer\n\n\n'asks user for Coupon rate\ncpn = InputBox(\"Please enter the coupon rate of the security(in X.XX form)\")\nIf -0.0001 &lt; coupon &lt; 25.0001 Then\nCells(1, 2).Value = cpn\nEnd If\n\n'asks user for number of years until maturity\nmaturity = InputBox(\"Please enter the periods until maturity\")\nIf 179 &lt; maturity &lt; 361 Then\nCells(2, 2).Value = maturity\nEnd If\n\n'asks user for yield rate\nmtgprice = InputBox(\"Please enter the Mortgage price per $100 principal value, in percent\")\nIf 49.9999 &lt; Yield &lt; 200.0001 Then\nCells(3, 2).Value = mtgprice\nEnd If\n\nFor row = 6 To 16\n        Cells(row, 2).Value = mort_price(mtgprice, cpn, maturity)\n        Cells(row, 1).Value = yield_calc(mtgprice, fderiv(mtgprice, cpn, maturity), mort_price(mtgprice, cpn, maturity))\nNext row\n\nDim mychart As ChartObject\nDim mylo As Integer, myhi As Integer\n\nmylo = -1 + WorksheetFunction.Min(Range(\"B6:B16\"))\nmyhi = 1 + WorksheetFunction.Max(Range(\"B6:B16\"))\n\nSet mychart = Sheets(\"Sheet1\").ChartObjects.Add _\n    (Left:=300, Top:=25, Width:=400, Height:=300)\n\nWith mychart\n    .Chart.ChartType = xlXYScatterLines\n    .Chart.HasTitle = True\n    .Chart.ChartTitle.Text = \"Price of a \" &amp; maturity &amp; \" month mortgage loan with an annual coupon rate of \" &amp; cpn &amp; \"%\"\n    .Chart.SetSourceData Source:=Range(\"A6:B16\")\n    .Chart.Axes(xlValue).MinimumScale = mylo\n    .Chart.Axes(xlValue).MaximumScale = myhi\n    .Chart.Legend.Clear\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1553797117, "last_edit_date": 1553797117, "creation_date": 1477530676, "answer_id": 40274529, "question_id": 40272678, "link": "https://stackoverflow.com/questions/40272678/copying-filtered-data-from-one-sheet-to-another/40274529#40274529", "title": "Copying Filtered Data From One Sheet to Another", "body": "<h2>Copy Rows Based On Matching Criteria From One Sheet To Another</h2>\n\n<hr>\n\n<p><strong><em>There's 2 ways we can go about this.</em></strong> </p>\n\n<h2>Code 1</h2>\n\n<p><strong>The first is sticking with what you were doing, which may or may not be the slower way of accomplishing this (depending on how many cells you're moving through.)</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Dim wsWO As Worksheet: Set wsWO = ThisWorkbook.Sheets(\"Scheduled WO's\")\n    Dim wsB As Worksheet: Set wsB = ThisWorkbook.Sheets(\"Branden\")\n    Dim LastRow As Long: LastRow = wsWO.Cells(wsWO.Rows.Count, 1).End(xlUp).Row\n    Dim i As Long\n\n    wsB.Range(\"A2:Q10000\").ClearContents\n\n    For i = 2 To LastRow\n        If wsWO.Cells(i, \"G\").Value = \"Branden\" Then _\n            wsWO.Cells(i, \"G\").EntireRow.Copy _\n            wsB.Range(\"A\" &amp; wsB.Cells(ws.Rows.Count, 1).End(xlUp).Row + 1)\n    Next i\nEnd Sub\n</code></pre>\n\n<h2>Code 2</h2>\n\n<p><strong>The other way we can do this is by specifically finding only occurences of \"Branden\", and copying those rows over.</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Dim wsWO As Worksheet: Set wsWO = ThisWorkbook.Sheets(\"Scheduled WO's\")\n    Dim wsB As Worksheet: Set wsB = ThisWorkbook.Sheets(\"Branden\")\n    Dim findBranden As Range: Set findBranden = wsWO.Range(\"G:G\") _\n        .Find(What:=\"Branden\", LookIn:=xlValues, LookAt:=xlWhole)\n    Dim firstResult As String\n\n    wsB.Range(\"A2:Q10000\").ClearContents\n\n    If Not findBranden Is Nothing Then\n        firstResult = findBranden.Address\n        Do\n            findBranden.EntireRow.Copy _\n            wsB.Range(\"A\" &amp; wsB.Cells(wsB.Rows.Count, 1).End(xlUp).Row + 1)\n            Set findBranden = wsWO.Range(\"G:G\").FindNext(findBranden)\n        Loop While Not findBranden Is Nothing And findBranden.Address &lt;&gt; firstResult\n    Else: MsgBox \"Nothing to move today.\", vbInformation, \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>You'll notice there's a couple new things in both codes.</h2>\n\n<p><strong>An important one is <code>Option Explicit</code>. Including this at the top of your code module will alert you at compile if you have any variables that aren't declared. This is incredibly useful because it will catch spelling mistakes and the like before your code runs. I dare say all experienced VBA coders use <code>Option Explicit</code> or have <code>Require Variable Declaration</code> turned on in the Tools > Options > Editor menu.</strong></p>\n\n<p><strong>Another very important change was declaring the specific <em>type</em> of variables we are using. In your code, <code>LastRow</code> and <code>i</code> are assumed as <code>Variant</code> types because you never specified their use. It's good practice to be as specific as you can in coding, especially with variable declarations, because it will make troubleshooting your code a lot more simple.</strong></p>\n\n<p><strong>I also declared your worksheets as variables to make the written code smaller, and easier to read.</strong></p>\n\n<hr>\n\n<h2>Literature You May Find Useful</h2>\n\n<p><a href=\"http://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Why <code>Option Explicit</code>?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/1139321/how-do-i-force-vba-access-to-require-variables-to-be-defined\">Why <code>Require Variable Declaration</code>?</a></p>\n\n<p><a href=\"http://powerspreadsheets.com/declare-variables-vba-excel/\" rel=\"nofollow noreferrer\">Why declare the specific <em>type</em> of variable?</a></p>\n\n<hr>\n\n<p><strong><em>Both methods are viable and easy to manipulate. Let me know if I've managed to help :)</em></strong></p>\n"}, {"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477570582, "post_id": 40279371, "comment_id": 67826976, "body": "I think clearing that sheet is intentional though, and it also isn&#39;t related to his question."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477572138, "post_id": 40279371, "comment_id": 67828093, "body": "@Tyeler, to me that <i>clearing</i> is the only possible reason of OP&#39;s issue. Removing it his code runs fine: the <code>Rows.Count</code> matter isn&#39;t effective since all range reference, implicitly, the same <code>Workbook</code> so <code>Rows.Count</code> isn&#39;t an issue"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477573643, "post_id": 40279371, "comment_id": 67829131, "body": "It only runs that clearing line once, on workbook open. He was saying that the loop was copying each row from the first sheet onto the same row of the second sheet, ultimately leaving him with only one (the last matching row) on his second sheet. The only way I can see that happening is because he&#39;s referencing a <code>Rows.Count</code> to offset from except that <code>Rows.Count</code> never changes, so the offset never changes. Am I wrong?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477578677, "post_id": 40279371, "comment_id": 67832892, "body": "That Rows.Count is always followed by a End(xlUp) so that the final offset constantly keeps track of the last not empty cell in the column. As for the rest: it&#39;s a Workbook_ Open() event handler so all the code (not only the cells clearance) is executed only once at the workbook opening and gets executed again only at the next workbook opening. Any how we must wait for OP comments"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477581716, "post_id": 40279371, "comment_id": 67835094, "body": "@Tyeler, I missed to address to you my last comment"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477584311, "post_id": 40279371, "comment_id": 67836901, "body": "I guess I just don&#39;t understand how <code>Rows.Count</code> in his code is being read specifically from <code>Sheets(&quot;Branden&quot;)</code> and not the <code>ActiveSheet</code>.... I can&#39;t find where to answer this for myself."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477587512, "post_id": 40279371, "comment_id": 67838848, "body": "<code>Row.Count</code> without any explicit worksheet qualification is actually being read from <code>ActiveSheet</code>. But the value returned is the same as if it were read from <code>Sheets(&quot;Branden&quot;)</code> or any other worksheet in the same Workbook since it only depends on the Workbook <i>format</i>: in the same workbook all worksheets return the same <code>Rows.Count</code>. While it can differ between worksheets belonging to different workbooks if these latter have different <i>formats</i> (before and after Excel 2003, if I correctly recall)"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477588819, "post_id": 40279371, "comment_id": 67839614, "body": "Ah I see it now... I believe this is the second time you&#39;ve educated me on something I thought I already knew about. Should I delete my answer? After reading his code, I&#39;m not sure I understand why his data is being copied to the same line.."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 1, "creation_date": 1477590693, "post_id": 40279371, "comment_id": 67840589, "body": "We all are being educated each day. As to your answer it&#39;s entirely up to you. Since you pointed out useful issues you may edit it to erase just the part that doesn&#39;t actually solve OP issue and leave the rest as good coding practice suggestions. Although this could expose your answer to the downvote by any too &quot;efficient&quot;  SO user (not me for sure)..."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1477555625, "creation_date": 1477555625, "answer_id": 40279371, "question_id": 40272678, "link": "https://stackoverflow.com/questions/40272678/copying-filtered-data-from-one-sheet-to-another/40279371#40279371", "title": "Copying Filtered Data From One Sheet to Another", "body": "<p>you have to take off the statement</p>\n\n<pre><code>Sheets(\"Branden\").Range(\"A2:Q10000\").ClearContents\n</code></pre>\n\n<p>which clears \"Branden\" worksheet cells at every opening of the workbook it resides in</p>\n\n<p>furthermore, since your need is <em>filtering</em>, you may want to use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\">Autofilter</a> and avoid looping through cells</p>\n\n<pre><code>Private Sub Workbook_Open()\n    With Worksheets(\"Scheduled WO's\")\n        With .Range(\"G1:G\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)\n            .AutoFilter field:=1, Criteria1:=\"Branden\"\n            If Application.WorksheetFunction.Subtotal(103, .Cells) - 1 &gt; 0 Then .Offset(1).Resize(.Rows.Count - 1).SpecialCells(XlCellType.xlCellTypeVisible).EntireRow.Copy Worksheets(\"Branden\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7077443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa2ccff190a37d528bbe4f85e5d778c?s=128&d=identicon&r=PG&f=1", "display_name": "ITPRO", "link": "https://stackoverflow.com/users/7077443/itpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2329, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1557132997, "creation_date": 1477518625, "last_edit_date": 1557132997, "question_id": 40272678, "link": "https://stackoverflow.com/questions/40272678/copying-filtered-data-from-one-sheet-to-another", "title": "Copying Filtered Data From One Sheet to Another", "body": "<p>I am attempting to copy filtered data from one sheet to another. It copies everything to the same line. </p>\n\n<p>How do populates all the rows instead of copying them over the same one? </p>\n\n<p>Here is the code I modified:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim i, LastRow\n\n    LastRow = Sheets(\"Scheduled WO's\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sheets(\"Branden\").Range(\"A2:Q10000\").ClearContents\n\n    For i = 2 To LastRow\n        If Sheets(\"Scheduled WO's\").Cells(i, \"G\").Value = \"Branden\" Then\n            Sheets(\"Scheduled WO's\").Cells(i, \"G\").EntireRow.Copy Destination:=Sheets(\"Branden\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2010"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1477518668, "post_id": 40272529, "comment_id": 67805314, "body": "Which part of the code did not work, and what sort of error message did it give?"}, {"owner": {"reputation": 1, "user_id": 4054783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6006f8b86a70d4a8e59f143b6b316d4?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/4054783/martin"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477925755, "post_id": 40272529, "comment_id": 67943618, "body": "The code runs and gives objXMLHTTP.Status of 400 but no response text.   I&#39;m passing the list name, Sharepoint URL, a value, and field name to Add_Item. Example ValueVar = &quot;test_title&quot; and FieldNameVar = &quot;Title&quot;.  However, I&#39;m not sure I&#39;m passing the FieldNameVar and ValueVar correctly, since i&#39;m trying to add an entire new entry which includes multiple cols/fields, but only pass information for one field."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477926577, "post_id": 40272529, "comment_id": 67944154, "body": "That sounds like <code>SharepointUrl + &quot;_vti_bin&#47;Lists.asmx&quot;</code> doesn&#39;t exist."}], "owner": {"reputation": 1, "user_id": 4054783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6006f8b86a70d4a8e59f143b6b316d4?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/4054783/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477517938, "creation_date": 1477517938, "last_edit_date": 1495541207, "question_id": 40272529, "link": "https://stackoverflow.com/questions/40272529/vba-example-on-how-add-a-item-to-a-sharepoint-list-programmatically", "title": "vba example on how add a item to a Sharepoint list programmatically", "body": "<p>I need to update and add items/rows to a SharePoint list using VBA. Each Item in my list has 5 fields.  I have tried the code in the following link, but could not get it to to work: <a href=\"https://stackoverflow.com/questions/22450717/add-and-update-single-item-in-sharepoint-list-via-vba\">Add and Update Single Item in Sharepoint List via VBA</a>.</p>\n\n<p>I feel that I just need good vba examples of how to update and add items.  Any insight and examples are appreciated. </p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1477517622, "post_id": 40272381, "comment_id": 67804940, "body": "You&#39;re missing a couple <code>&amp;</code> operators: <code>&quot;=if(F&quot; &amp; i - 1 &amp; &quot;=0,&quot;&quot;&quot;&quot;,F&quot; &amp; i - 1 &amp; &quot;)&quot;</code>"}, {"owner": {"reputation": 35, "user_id": 4703664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261769ec2c6bb291839b55eb2943f629?s=128&d=identicon&r=PG&f=1", "display_name": "Renaud liber", "link": "https://stackoverflow.com/users/4703664/renaud-liber"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477517813, "post_id": 40272381, "comment_id": 67805023, "body": "Thank you so much Cominterm. I should have catch that - I guess it s a sign that it is time to go to bed :). Thanks again!"}], "owner": {"reputation": 35, "user_id": 4703664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261769ec2c6bb291839b55eb2943f629?s=128&d=identicon&r=PG&f=1", "display_name": "Renaud liber", "link": "https://stackoverflow.com/users/4703664/renaud-liber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477519404, "creation_date": 1477517209, "last_edit_date": 1477519404, "question_id": 40272381, "link": "https://stackoverflow.com/questions/40272381/set-up-a-an-if-formula-through-vba-but-if-cell-is-blank-return-an-empty-cell", "title": "Set up a an IF formula through VBA but if cell is blank return an empty cell", "body": "<p>Hello Stackoverflow Community,</p>\n\n<p>Thanks in advance for any help you can give. </p>\n\n<p>I am currently trying to set an IF formula through VBA that refers to the cell above. If the cell is equal to 0 then it would return a blank value other wise it would return the same value as above.</p>\n\n<p>I am using Belgium setting hence if formula has a comma and not a semicolon\nBelow is the code. note that the first line help me refer to the cell above.</p>\n\n<pre><code>v = i - 1\nCells(i, \"F\").Formula = \"=if(F\" &amp; i - 1\"=0,\"\"\"\",F\" &amp; i - 1\")\"\n</code></pre>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1477523038, "post_id": 40272347, "comment_id": 67806702, "body": "&quot;stopped working&quot; and &quot;errors out&quot; are not really helpful. What is the full error message?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1477523073, "post_id": 40272347, "comment_id": 67806715, "body": "And: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a>"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1477531073, "post_id": 40272347, "comment_id": 67808605, "body": "I would try: [Form_Qry_MasterQarl subform1].form.RecordsetClone"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4250913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04862afc278e5895f424b1c44712f636?s=128&d=identicon&r=PG&f=1", "display_name": "UnderTheair", "link": "https://stackoverflow.com/users/4250913/undertheair"}, "edited": false, "score": 0, "creation_date": 1477662897, "post_id": 40277888, "comment_id": 67870418, "body": "This syntax seems like the right track but i get a &quot;Microsoft Office Access can&#39;t find the field &#39;|&#39; referred to in your expressions&quot; error when I try it."}, {"owner": {"reputation": 111, "user_id": 4250913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04862afc278e5895f424b1c44712f636?s=128&d=identicon&r=PG&f=1", "display_name": "UnderTheair", "link": "https://stackoverflow.com/users/4250913/undertheair"}, "edited": false, "score": 0, "creation_date": 1477665647, "post_id": 40277888, "comment_id": 67872173, "body": "Nevermind. I think i got it. I was being stupid and forgot [Form_Qry_MasterQarl subform1] had the Form call in the front.  I just did what you suggested and Set Tst = Me![Qry_MasterQarl subform1].Form.RecordsetClone   Thanks!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 111, "user_id": 4250913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04862afc278e5895f424b1c44712f636?s=128&d=identicon&r=PG&f=1", "display_name": "UnderTheair", "link": "https://stackoverflow.com/users/4250913/undertheair"}, "edited": false, "score": 0, "creation_date": 1477665760, "post_id": 40277888, "comment_id": 67872233, "body": "Great! Have a nice weekend."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1477550663, "creation_date": 1477550663, "answer_id": 40277888, "question_id": 40272347, "link": "https://stackoverflow.com/questions/40272347/recordsetclone-stopped-working-between-access-2010-and-2016/40277888#40277888", "title": "RecordsetClone stopped working between Access 2010 and 2016", "body": "<p>The full syntax for referencing such recordset is:</p>\n\n<pre><code>Set Tst = Me![Form_Qry_MasterQarl subform1].Form.RecordsetClone\n</code></pre>\n\n<p>where <em>Form_Qry_MasterQarl subform1</em> is the name of the subform <em>control</em>, not the name of the subform.</p>\n"}], "owner": {"reputation": 111, "user_id": 4250913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04862afc278e5895f424b1c44712f636?s=128&d=identicon&r=PG&f=1", "display_name": "UnderTheair", "link": "https://stackoverflow.com/users/4250913/undertheair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 40277888, "answer_count": 1, "score": 0, "last_activity_date": 1477550663, "creation_date": 1477517015, "question_id": 40272347, "link": "https://stackoverflow.com/questions/40272347/recordsetclone-stopped-working-between-access-2010-and-2016", "title": "RecordsetClone stopped working between Access 2010 and 2016", "body": "<p>I have these two lines:</p>\n\n<pre><code>Dim Tst As DAO.Recordset\nSet Tst = [Form_Qry_MasterQarl subform1].RecordsetClone\n</code></pre>\n\n<p>They work fine in acccess 2010 but for some reason it errors out on access 2016. I'm trying to get a recordset clone of a subform thats on the mainform as a datasheet. I'm assuming it's the call to the subform that's the problem \"[Form_Qry_MasterQarl subform1] \"and Access 2016 dropped support for this syntax or something.  Any insight to get it to work? I've tried a bunch of different references to little avail.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1477516010, "post_id": 40272082, "comment_id": 67804170, "body": "Apparently you meant <code>Chr</code> instead of <code>Asc</code>. Then again, you could simply use the literal letters <code>&quot;A&quot;</code> and <code>&quot;Z&quot;</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477516882, "post_id": 40272082, "comment_id": 67804600, "body": "You say letters (plural), but assuming that you corrected <code>Asc</code> to <code>Chr</code>, you&#39;d still only testing the first letter. What is a valid entry for the field?"}, {"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1477591053, "post_id": 40272082, "comment_id": 67840802, "body": "A to Z, small or large letters"}], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1477935149, "post_id": 40272518, "comment_id": 67949292, "body": "I am getting Run Time Error &#39;424&#39;"}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1477936098, "post_id": 40272518, "comment_id": 67949795, "body": "Does debugger shows where error occurs? (which line)"}, {"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1477937647, "post_id": 40272518, "comment_id": 67950562, "body": "It works, I fixed it, it was the naming convention on the object, I had txtBoxName instead of Name_Box.Text, the run time was naming match error. Can someone please break down the FOR i = 1 loop, so I can understand it, rather than copying."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 1, "last_activity_date": 1477517898, "creation_date": 1477517898, "answer_id": 40272518, "question_id": 40272082, "link": "https://stackoverflow.com/questions/40272082/vba-if-logic-using-asc-function/40272518#40272518", "title": "VBA If logic using Asc function", "body": "<p>Try this function:</p>\n\n<pre><code>Private Sub cmd_Submit_Click()\n    For i = 1 To Len(Name_Box.Text)\n        If Asc(Mid(Name_Box.Text, i, 1)) &lt; 65 Or Asc(Mid(Name_Box.Text, i, 1)) &gt; 90 Then\n            MsgBox \"Enter A to Z\"\n            Exit For\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477517898, "creation_date": 1477515855, "last_edit_date": 1531164843, "question_id": 40272082, "link": "https://stackoverflow.com/questions/40272082/vba-if-logic-using-asc-function", "title": "VBA If logic using Asc function", "body": "<p>I have a userform that contains a TextBox. I created an <code>If</code> function to validate if the user entered letters or not. I am getting a runtime error 13 on my code. Please help me if I can do the if logic correctly. </p>\n\n<pre><code>Private Sub cmd_Submit_Click()\n    'it will not accept any ASCII variables from 0 to 65\n    If Name_Box.Text &lt; Asc(65) Then\n        MsgBox \"Enter A to Z\"\n        'Shall not contain any ASCII characters past 90\n    ElseIf Name_Box.Text &gt; Asc(90) Then\n        MsgBox \"Enter A to Z\"\n    Else\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477516336, "post_id": 40272086, "comment_id": 67804315, "body": "Thanks @RobertColumbia. It is transferring each row individually now! However it is transferring the last row twice. For &quot;row 24&quot; that is the first row it can enter into. &quot;row 23&quot; has headings. I have also changed For r = 1 To LR to 2 To LR as it was picking up the column headers."}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "reply_to_user": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477516595, "post_id": 40272086, "comment_id": 67804453, "body": "I updated my answer. How would that work? If it is still slightly off, then let me know what is happening or you can try to fiddle with the arithmetic slightly by adding or subtracting one."}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477516885, "post_id": 40272086, "comment_id": 67804601, "body": "Thanks for your help @RobertColumbia. Limak has solved it with the way he has used &#39;tr&#39;."}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477517200, "post_id": 40272086, "comment_id": 67804772, "body": "@ RobertColumbia, Is it possible to get this macro to run not only when the worksheet is initialized but also whenever there is any change within the whole workbook? Or am I best to create a Sub Workbook_Change () macro with the exact same code?"}], "tags": [], "owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "is_accepted": false, "score": 0, "last_activity_date": 1477516553, "last_edit_date": 1477516553, "creation_date": 1477515873, "answer_id": 40272086, "question_id": 40272022, "link": "https://stackoverflow.com/questions/40272022/my-vba-is-only-transferring-the-last-row-of-data-even-though-other-rows-meet-cri/40272086#40272086", "title": "My VBA is only transferring the last row of Data even though other rows meet Criteria", "body": "<p>You are copying to the same <code>tr</code> rows for each iteration of <code>r</code>. Did you mean to use \"row 24\" as an <em>offset</em>? For example,</p>\n\n<pre><code>For r = 2 To LR\n    If SourceD.Cells(r, 6).Value &gt;= Date Then\n        For tr = 24 To tLR\n            Target.Cells((tLR - 24 + 1) * r + tr - 24, 1).Value = SourceD.Cells(r, 5).Value\n            Target.Cells((tLR - 24 + 1) * r + tr - 24, 5).Value = SourceD.Cells(r, 4).Value\n            Target.Cells((tLR - 24 + 1) * r + tr - 24, 6).Value = SourceD.Cells(r, 3).Value\n        Next\n    End If\nNext\n</code></pre>\n\n<p>That would guarantee that each row <code>r</code> has its own set of Production Schedule rows.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477516715, "post_id": 40272227, "comment_id": 67804518, "body": "That&#39;s working perfectly. Thank you @Limak and lots tidier too! :)"}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 0, "last_activity_date": 1477516419, "creation_date": 1477516419, "answer_id": 40272227, "question_id": 40272022, "link": "https://stackoverflow.com/questions/40272022/my-vba-is-only-transferring-the-last-row-of-data-even-though-other-rows-meet-cri/40272227#40272227", "title": "My VBA is only transferring the last row of Data even though other rows meet Criteria", "body": "<p>Value of <code>tr</code> is whole the time the same. If I understand your expectations well, the following code should work better:</p>\n\n<pre><code>Private Sub Worksheet_Initialize()\n    Dim SourceJ As Worksheet, SourceD As Worksheet, Target As Worksheet\n    Dim LR As Long\n    Dim r As Long\n    Dim tLR As Long\n    Dim tr As Long\n\n    Set SourceJ = Worksheets(\"Jobs\")\n    Set SourceD = Worksheets(\"Doors\")\n    Set Target = Worksheets(\"Production Schedule\")\n    LR = SourceD.Range(\"A\" &amp; SourceD.Rows.Count).End(xlUp).Row\n\n    tLR = Target.Range(\"A\" &amp; Target.Rows.Count).End(xlUp).Row + 1\n    tr = 24\n    For r = 1 To LR\n        If SourceD.Cells(r, 6).Value &gt;= Date Then\n            Target.Cells(tr, 1).Value = SourceD.Cells(r, 5).Value\n            Target.Cells(tr, 5).Value = SourceD.Cells(r, 4).Value\n            Target.Cells(tr, 6).Value = SourceD.Cells(r, 3).Value\n            tr = tr + 1\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40272227, "answer_count": 2, "score": 0, "last_activity_date": 1477516553, "creation_date": 1477515599, "question_id": 40272022, "link": "https://stackoverflow.com/questions/40272022/my-vba-is-only-transferring-the-last-row-of-data-even-though-other-rows-meet-cri", "title": "My VBA is only transferring the last row of Data even though other rows meet Criteria", "body": "<p>I have three worksheets that I am working with: \n\"Doors\" which is the one that must match the criteria, \"Jobs\" it takes some values off here if criteria is met and \"Productions Schedule\" where the data is transferred to. </p>\n\n<p>So the criteria is that each row on \"Doors\" is check that the date is equal to or greater than today's date. If it is then data from specific columns &amp; sheets are then transferred onto \"Production Schedule\" from Row 24 and down. </p>\n\n<p>The data is transferring correctly other than the fact that it is only taking the last used row from \"Doors\" not <em>all</em> rows that meet the criteria. How do I fix this?                                                                                                                                                                                                                                           </p>\n\n<pre><code>Private Sub Worksheet_Initialize()\n   Dim SourceJ As Worksheet, SourceD As Worksheet, Target As Worksheet\n   Set SourceJ = Worksheets(\"Jobs\")\n   Set SourceD = Worksheets(\"Doors\")\n   Set Target = Worksheets(\"Production Schedule\")\n   Dim LR As Long\n   Dim r As Long\n   LR = SourceD.Range(\"A\" &amp; SourceD.Rows.Count).End(xlUp).row\n   Dim tLR As Long\n   Dim tr As Long\n   tLR = Target.Range(\"A\" &amp; Target.Rows.Count).End(xlUp).row + 1\n     For r = 1 To LR\n     If SourceD.Cells(r, 6).Value &gt;= Date Then\n        For tr = 24 To tLR\n         Target.Cells(tr, 1).Value = SourceD.Cells(r, 5).Value\n         Target.Cells(tr, 5).Value = SourceD.Cells(r, 4).Value\n         Target.Cells(tr, 6).Value = SourceD.Cells(r, 3).Value\n        Next\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1477515518, "post_id": 40271912, "comment_id": 67803925, "body": "Would you be able to share the code you used? I am assuming you used the data validation function to create the drop-down menu."}, {"owner": {"reputation": 99, "user_id": 3542218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734fd076d5eabbf8578f80793f70dcb?s=128&d=identicon&r=PG&f=1", "display_name": "jhinx", "link": "https://stackoverflow.com/users/3542218/jhinx"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1477518127, "post_id": 40271912, "comment_id": 67805123, "body": "sure can. I did not use the data validation function, I am new to VBA and mainly self taught so there is a good chance that I did not use the best practice so any input would be GREATLY appreciated. I will add the code to the original post right now"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1477546813, "post_id": 40271912, "comment_id": 67812601, "body": "Works for me - created 100 drop-downs and on save/re-open they displayed as expected."}, {"owner": {"reputation": 99, "user_id": 3542218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734fd076d5eabbf8578f80793f70dcb?s=128&d=identicon&r=PG&f=1", "display_name": "jhinx", "link": "https://stackoverflow.com/users/3542218/jhinx"}, "edited": false, "score": 0, "creation_date": 1478023246, "post_id": 40271912, "comment_id": 67985018, "body": "It works on all of my other sheets as well, but this one sheet has this anomaly. The drop downs are being created the same way, with the exception of the items being added by a loop rather than individually"}], "owner": {"reputation": 99, "user_id": 3542218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734fd076d5eabbf8578f80793f70dcb?s=128&d=identicon&r=PG&f=1", "display_name": "jhinx", "link": "https://stackoverflow.com/users/3542218/jhinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477518246, "creation_date": 1477515161, "last_edit_date": 1531161705, "question_id": 40271912, "link": "https://stackoverflow.com/questions/40271912/excel-dropdown-selected-value-not-displayed-after-save-and-reopen", "title": "Excel Dropdown selected value not displayed after save and reopen", "body": "<p>I have an excel spreadsheet which uses a button to allow users to add new resources to a list. When the button is clicked, a row is inserted above it and a dropdown is created in the first cell of that row with various resource types. The rows and dropdowns are being created successfully, however if you select the resource types for all of the added rows and then save an exit the workbook, the selections are not displayed when the sheet is re-opened. If another resource row is added, all the drop down selections re-appear. Also, if the drop down box itself is moved at all, the select will re-appear. </p>\n\n<p>On top of that, this does not happen with ever selection. <strong>If</strong> the first drop down option is selected, it is displayed upon re-opening. </p>\n\n<p>All of the combo boxes have a linked cells, and it is being saved as a Macro enabled work book. I cannot think of why they would not be displayed - anyone have any ideas? </p>\n\n<p>---UPDATE---</p>\n\n<p>How the Drop down is being created:</p>\n\n<pre><code>Set curCombo = ActiveSheet.Shapes.AddFormControl(xlDropDown, Left:=Cells(cs, 1).Left, Top:=Cells(cs, 1).Top, Width:=110, Height:=16)\nWith curCombo\n    .ControlFormat.DropDownLines = 4\n    .ControlFormat.AddItem \"Labor - Engineer\"\n    .ControlFormat.AddItem \"Labor - Technician\"\n    .ControlFormat.AddItem \"Labor - Support\"\n    .ControlFormat.AddItem \"Shop\"\n    .Name = \"resource_\" &amp; cs &amp; \"_comboBx\"\nEnd With\n\nActiveSheet.DropDowns(\"resource_\" &amp; cs &amp; \"_comboBx\").LinkedCell = Cells(cs, 1).Address\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-template"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6759352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/no36b.jpg?s=128&g=1", "display_name": "ISAAC", "link": "https://stackoverflow.com/users/6759352/isaac"}, "edited": false, "score": 0, "creation_date": 1477518579, "post_id": 40272546, "comment_id": 67805280, "body": "I saw this (almost identical) answer to a somewhat similar question on S.O., and I completely agree with you, I&#39;m quite familiar with the various versions of excel at least in terms of macro enabled and not enabled. (Personally I solve the whole problem as a vba developer by never using anything other than .XLSB, which solves for BOTH the macro enablement, and also cuts the file size down by about 2/3, so have never seen reason to use anything else!)"}, {"owner": {"reputation": 13, "user_id": 6759352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/no36b.jpg?s=128&g=1", "display_name": "ISAAC", "link": "https://stackoverflow.com/users/6759352/isaac"}, "edited": false, "score": 0, "creation_date": 1477518595, "post_id": 40272546, "comment_id": 67805287, "body": "But what I am saying is that I have an xltx, and I open it, and a macro starts running. Can you explain that?"}, {"owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "reply_to_user": {"reputation": 13, "user_id": 6759352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/no36b.jpg?s=128&g=1", "display_name": "ISAAC", "link": "https://stackoverflow.com/users/6759352/isaac"}, "edited": false, "score": 0, "creation_date": 1477519060, "post_id": 40272546, "comment_id": 67805451, "body": "@ISAACPISORS OK - I misunderstood somewhat. I obviously skim read and focused on the line &quot;I&#39;ve never worked at all with template files&quot;. No, I don&#39;t have any kind of explanation for that"}], "tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": false, "score": 0, "last_activity_date": 1477518030, "creation_date": 1477518030, "answer_id": 40272546, "question_id": 40271876, "link": "https://stackoverflow.com/questions/40271876/xltx-contains-macros-but-then-they-are-not-there-what-gives/40272546#40272546", "title": "XLTX contains macros, but then they are not there - what gives?", "body": "<p>You need to use XLTM (Excel Macro-Enabled Template)- the difference is the same as between XLSX and XLSM - you can write whatever code you like, but if you don't save it in the macro-enabled format, it won't still be there when you re-open the workbook/create a new spreadsheet based on the template.</p>\n\n<p>You should have had this error message when you saved (although if you just clicked \"Yes\" it'll have saved anyway, just without the macro code)</p>\n\n<p><a href=\"https://i.stack.imgur.com/QpkbW.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/QpkbW.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you haven't closed down the template file you're working on, you should still be able to save it as XLTM and retain the code - otherwise it's gone, unless it can be recovered from an autosave:</p>\n"}, {"tags": [], "owner": {"reputation": 290, "user_id": 1433137, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MzpPY.jpg?s=128&g=1", "display_name": "LeasMaps", "link": "https://stackoverflow.com/users/1433137/leasmaps"}, "is_accepted": false, "score": 0, "last_activity_date": 1477547526, "creation_date": 1477547526, "answer_id": 40277066, "question_id": 40271876, "link": "https://stackoverflow.com/questions/40271876/xltx-contains-macros-but-then-they-are-not-there-what-gives/40277066#40277066", "title": "XLTX contains macros, but then they are not there - what gives?", "body": "<p>There will not be any macros in an .XLTX. You can try renaming the file as .XLSM or .XLTM in file explorer to get them back. The message \"ThisWorkbook.RefreshAll err..etc .etc., due to invalid sql connection\".\" also looks like a broken link to a datasource rather than a macro.</p>\n"}], "owner": {"reputation": 13, "user_id": 6759352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/no36b.jpg?s=128&g=1", "display_name": "ISAAC", "link": "https://stackoverflow.com/users/6759352/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477547526, "creation_date": 1477515023, "last_edit_date": 1531164843, "question_id": 40271876, "link": "https://stackoverflow.com/questions/40271876/xltx-contains-macros-but-then-they-are-not-there-what-gives", "title": "XLTX contains macros, but then they are not there - what gives?", "body": "<p>I have an xltx that clearly contains macros when i open it, based on the error \"ThisWorkbook.RefreshAll err..etc .etc., due to invalid sql connection\". </p>\n\n<p>(whether i open the xltx as New or Open).  </p>\n\n<p>Once I go to vba project, there is ZERO code of any kind.</p>\n\n<p>I consider myself a VBA expert, but have to confess, I've never worked at ALL with template files.  (they seem like a completely unnecessary thing to me).  </p>\n\n<p>is there some magic that makes vba code invisible in xltx ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 129, "user_id": 2744516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862732b0fe9513d0e850936cd9597d12?s=128&d=identicon&r=PG&f=1", "display_name": "Chai Xiong", "link": "https://stackoverflow.com/users/2744516/chai-xiong"}, "edited": false, "score": 1, "creation_date": 1477514223, "post_id": 40271527, "comment_id": 67803318, "body": "It is helpful to let us know what kind of error you get.  All errors are weird in their own ways."}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "reply_to_user": {"reputation": 129, "user_id": 2744516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862732b0fe9513d0e850936cd9597d12?s=128&d=identicon&r=PG&f=1", "display_name": "Chai Xiong", "link": "https://stackoverflow.com/users/2744516/chai-xiong"}, "edited": false, "score": 0, "creation_date": 1477514647, "post_id": 40271527, "comment_id": 67803503, "body": "It says, &quot;MS Excel cant determine which row in your list or selection contains columns labels, which are required for this command&quot;"}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "reply_to_user": {"reputation": 129, "user_id": 2744516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862732b0fe9513d0e850936cd9597d12?s=128&d=identicon&r=PG&f=1", "display_name": "Chai Xiong", "link": "https://stackoverflow.com/users/2744516/chai-xiong"}, "edited": false, "score": 0, "creation_date": 1477514698, "post_id": 40271527, "comment_id": 67803530, "body": "I have multiple sheets and I need subtotals on the respective sheet, When I clicked Ok on the error It gave me a subtotal of zero on my active sheet."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477515262, "post_id": 40271836, "comment_id": 67803808, "body": "I tried the above but it&#39;s giving me a run time error&#39;1004&#39;. &quot;This can&#39;t be applied to the selected range. Select a single cell in a range and try again&quot;. I have added a command button on my active sheet and the sheets that I want subtotals on starts from 3rd sheet"}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477515490, "post_id": 40271836, "comment_id": 67803911, "body": "How should I exclude first two sheets. May be that&#39;s why the code didn&#39;t work because 2nd sheet contain some text data which is not to be subtotaled"}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477515733, "post_id": 40271836, "comment_id": 67804042, "body": "I guess I have to do something like this to exclude first 2 sheets If ws1.Name &lt;&gt; &quot;name1&quot; Ad ws1.Name &lt;&gt; &quot;Name2&quot; Then   .......does it seems correct?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477515752, "post_id": 40271836, "comment_id": 67804053, "body": "Change the <code>If Not ws1 Is ActiveSheet Then</code> test to be something that will exclude which sheets you want to exclude - e.g. <code>If ws1.Name &lt;&gt; &quot;Control&quot; And ws1.Name &lt;&gt; &quot;AnotherSheet&quot; Then</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477515796, "post_id": 40271836, "comment_id": 67804077, "body": "@Navy - yep - exactly right (well, if you change <code>Ad</code> to <code>And</code> it is <b>exactly</b> right)"}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477576334, "post_id": 40271836, "comment_id": 67831146, "body": "Thanks! That worked but I ran into another problem. I&#39;ll have to sort the data first on every each sheet and then apply the subtotals. I&#39;ll post the code for the sorting on each page. Please let me know what am I doing wrong there."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1477516005, "last_edit_date": 1477516005, "creation_date": 1477514813, "answer_id": 40271836, "question_id": 40271527, "link": "https://stackoverflow.com/questions/40271527/apply-subtotals-to-each-sheet-except-the-active-sheet/40271836#40271836", "title": "Apply subtotals to each sheet except the active sheet", "body": "<p>Your current code is doing the Subtotal on the active sheet, because you never tell it to use <code>ws1</code> as the sheet on which to perform the task.</p>\n\n<p>Try the following:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim ws1 As Worksheet\n\n    For Each ws1 In Worksheets\n        If Not ws1 Is ActiveSheet Then\n            ws1.Range(\"A1:V5\").Subtotal GroupBy:=9, Function:=xlSum, TotalList:=Array(17, 18), _\n                Replace:=True, PageBreaks:=False, SummaryBelowData:=True\n        End If\n    Next ws1\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>  To exclude several worksheets from being subtotalled, use something similar to:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim ws1 As Worksheet\n\n    For Each ws1 In Worksheets\n        If ws1.Name &lt;&gt; \"Control\" And ws1.Name &lt;&gt; \"AnotherSheet\" Then\n            ws1.Range(\"A1:V5\").Subtotal GroupBy:=9, Function:=xlSum, TotalList:=Array(17, 18), _\n                Replace:=True, PageBreaks:=False, SummaryBelowData:=True\n        End If\n    Next ws1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 40271836, "answer_count": 1, "score": 0, "last_activity_date": 1477516005, "creation_date": 1477513473, "last_edit_date": 1477514355, "question_id": 40271527, "link": "https://stackoverflow.com/questions/40271527/apply-subtotals-to-each-sheet-except-the-active-sheet", "title": "Apply subtotals to each sheet except the active sheet", "body": "<p>I need to apply subtotals to each sheet in excel except the current or the active sheet according to following criteria:\nSubtotals\nAt each change in \nColumn 9\nSum\ncolumn 17 and column 18</p>\n\n<p>I used the following code but it's giving me some weird error.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim ws1 As Worksheet\n\nFor Each ws1 In Sheets\n    If Not ws1 Is ActiveSheet Then\n        Range(\"A1:V5\").Select\n        Selection.Subtotal GroupBy:=9, Function:=xlSum, TotalList:=Array(17, 18), _\n            Replace:=True, PageBreaks:=False, SummaryBelowData:=True\n    End If\nNext ws1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "batch-file", "macros"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477513636, "post_id": 40271500, "comment_id": 67803045, "body": "You could either use VBScript, or you could just write it as VBA and send the user the .xlsm file containing the macro you wrote."}], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "edited": false, "score": 0, "creation_date": 1477519199, "post_id": 40272681, "comment_id": 67805507, "body": "I&#39;ve deleted this answer and undeleted it - I&#39;m undecided on whether this is at all the sort of solution you&#39;re looking for - if not let me know and I&#39;ll re-delete"}], "tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": false, "score": 0, "last_activity_date": 1477518629, "creation_date": 1477518629, "answer_id": 40272681, "question_id": 40271500, "link": "https://stackoverflow.com/questions/40271500/run-vba-for-all-excel-but-not-through-project/40272681#40272681", "title": "Run VBA for all Excel but not through Project", "body": "<p>I wrote a very brief module which does this kind of thing - principally the exporting/importing of modules as .bas files.</p>\n\n<p>You need to enable the \"Microsoft Visual Basic for Applications Extensibility\"  reference (mine is 5.3 - I'm not sure if there are different versions), but once you've done that it should work</p>\n\n<pre><code>Public Sub CopyModule(Workbook1 As Workbook, ModuleName As String, Workbook2 As Workbook)\n''copies a named module between two workbooks VBA projects\n''also acts as a backup as it saves a copy of the module as at today's date\n\n'set name of exported module file\nwbname = Workbook1.name &amp; \".\" &amp; ModuleName &amp; \".\" &amp; Format(Now, \"YYYYMMDD\")\nDim filename As String: filename = \"H:\\ASC\\Reporting Files\\CMT\\\" &amp; wbname &amp; \".bas\"\n\n'define module to be copied from book 1 based on input arguments\nDim CopyModule As VBComponent\nSet CopyModule = Workbook1.VBProject.VBComponents(ModuleName)\n\n'export module\nCopyModule.Export (filename)\n\n'import module into book 2\nWorkbook2.VBProject.VBComponents.Import (filename)\n\nEnd Sub\n</code></pre>\n\n<p>The idea here was to copy the module between two workbooks that were already open, and also to back the module up at the same time. But you can treat the export/import lines as seperate routines and run them at different times. Hope this helps!</p>\n"}], "owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477518629, "creation_date": 1477513356, "last_edit_date": 1531164843, "question_id": 40271500, "link": "https://stackoverflow.com/questions/40271500/run-vba-for-all-excel-but-not-through-project", "title": "Run VBA for all Excel but not through Project", "body": "<p>I want to run VBA on Excel files (a clean-up function) However, I want this to be available to certain users only. </p>\n\n<p>Example would be to send the user a .bat file and tell them to save it and double click on this.</p>\n\n<ol>\n<li>It would open VBA Macro</li>\n<li>Macro will ask the user to choose the 'file' among all opened files to run macro which would be housed in a network location</li>\n<li>Macro checks if user selected a valid Excel file, then runs</li>\n</ol>\n\n<p>However, how would I go on to do this? I've done some research and read that I need to create VBS file. </p>\n\n<p>Can someone please give me a right path to start? Should I write .batch to call VBS which will house the code?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 387, "user_id": 1683034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c9c813e1392fd75cd8acfe2f048c31?s=128&d=identicon&r=PG", "display_name": "Apostolos55", "link": "https://stackoverflow.com/users/1683034/apostolos55"}, "edited": false, "score": 0, "creation_date": 1477513571, "post_id": 40271323, "comment_id": 67803009, "body": "hello, in the multi worksheet code you forgot set (like you had at the single sheet code):     set r = .UsedRange"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 7077020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98dfda5ac86828a1a900f0a52429ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sam L", "link": "https://stackoverflow.com/users/7077020/sam-l"}, "edited": false, "score": 0, "creation_date": 1477535014, "post_id": 40271742, "comment_id": 67809524, "body": "I actually didnt even think to do that, the first thing that came to my mind was just to build an array."}], "tags": [], "owner": {"reputation": 96, "user_id": 6759172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/668f29230054d84653914b4a2cb566c9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Small", "link": "https://stackoverflow.com/users/6759172/j-small"}, "is_accepted": false, "score": 0, "last_activity_date": 1477514428, "creation_date": 1477514428, "answer_id": 40271742, "question_id": 40271323, "link": "https://stackoverflow.com/questions/40271323/excel-vba-using-array-to-move-through-worksheets-and-then-copy-paste-nth-row/40271742#40271742", "title": "Excel VBA - Using Array to move through worksheets and then copy paste nth row", "body": "<p>Instead of manually typing in which sheets you want could you not just cycle through all the work sheets in the workbook?</p>\n\n<pre><code>Sub test()\nDim i As Integer\nDim x As Integer\nDim r As Range\n\nFor Each wsheet In ActiveWorkbook.worksheets\n\n    Set r = wsheet.UsedRange\n    k = r.Rows.Count\n    x = 2000\n    i = 2\n\n    Do While x &lt; k\n        wsheet.Range((\"A\" &amp; x) &amp; (\":L\" &amp; x)).Copy\n        wsheet.Rows.End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\n\n        i = i + 1\n        x = 1000 * i\n    Loop\n\nNext wsheet\n\nEnd Sub\n</code></pre>\n\n<p>This will cycle through each worksheet in the current workbook you are running the macro from and copy every 1000th row to the end of worksheet.</p>\n\n<p>(Any sheet with less than 2000 rows will skip over the do while loop and be ignored)</p>\n"}, {"comments": [{"owner": {"reputation": 142, "user_id": 7077020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98dfda5ac86828a1a900f0a52429ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sam L", "link": "https://stackoverflow.com/users/7077020/sam-l"}, "edited": false, "score": 0, "creation_date": 1477534864, "post_id": 40272383, "comment_id": 67809502, "body": "Wow, I kind of feel dumb now :) thanks for that! Also thanks for the tip on condensing my code! Always looking to be more efficient"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1477517214, "creation_date": 1477517214, "answer_id": 40272383, "question_id": 40271323, "link": "https://stackoverflow.com/questions/40271323/excel-vba-using-array-to-move-through-worksheets-and-then-copy-paste-nth-row/40272383#40272383", "title": "Excel VBA - Using Array to move through worksheets and then copy paste nth row", "body": "<p>you must type</p>\n\n<pre><code>Set r = .UsedRange\n</code></pre>\n\n<p>Since UsedRange is an object (namely a Range object)</p>\n\n<p>You may also want to use a more compact code like follows:</p>\n\n<pre><code>Sub Test()\n\nDim wsArrayCrnt As Variant\nDim x As Long\n\nFor Each wsArrayCrnt In Array(\"Usage\", \"Use\")\n    With Worksheets(wsArrayCrnt)\n        x = 2000\n        Do While x &lt; .UsedRange.Rows.Count\n           .Range((\"A\" &amp; x) &amp; (\":L\" &amp; x)).Copy\n           .End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\n           x = x + 1000\n       Loop\n    End With\nNext wsArrayCrnt\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 7077020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98dfda5ac86828a1a900f0a52429ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sam L", "link": "https://stackoverflow.com/users/7077020/sam-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 40272383, "answer_count": 2, "score": 0, "last_activity_date": 1477517214, "creation_date": 1477512670, "question_id": 40271323, "link": "https://stackoverflow.com/questions/40271323/excel-vba-using-array-to-move-through-worksheets-and-then-copy-paste-nth-row", "title": "Excel VBA - Using Array to move through worksheets and then copy paste nth row", "body": "<p>I am a little new to VBA, I just started using it in excel recently and have reached a road block.</p>\n\n<p>I am creating a crosswalk in order to upload my data to a business intelligence application. Unfortunately I do not have a connection to the database to run my reports so I have to do this with excel. The issue that I am running into is that there is a bug in our application where after the 1000th row in an excel document it will skip every 1000th line. Our development team is aware of this but there is no ETA to resolve the issue. As a work around I am trying to use VBA to copy the 1000th line (starting with 2000) to the end of the same sheet.</p>\n\n<p>I currently have code wrote for this that works on a single worksheet, but I have several pages that have over 1000 rows, so I am trying to feed the names of those sheets into an array and cycle through each one and do the copy/pasting.</p>\n\n<p>My working code for 1 worksheet:</p>\n\n<pre><code>Sub Test()\n\nDim WB As Workbook\nDim WS As Worksheet\nDim i As Integer\nDim x As Integer\nDim r As Range\n\n\n\nSet WB = Workbooks(\"macrotesting.xlsm\")\nSet WS = Worksheets(\"Usage\")\n\nSet r = WS.UsedRange\nk = r.Rows.Count\nx = 2000\ni = 2\n\nDo While x &lt; k\n\nWS.Range((\"A\" &amp; x) &amp; (\":L\" &amp; x)).Copy\nWS.Rows.End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\n\ni = i + 1\nx = 1000 * i\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I was able to find some help with this here but it is failing. Code with the Array:</p>\n\n<pre><code>Sub Test()\n\nDim wsArray As Variant\nDim wsArrayCrnt As Variant\nDim i As Integer\nDim x As Integer\nDim r As Range\n\nwsArray = Array(\"Usage\", \"Use\")\n\nFor Each wsArrayCrnt In wsArray\nWith Worksheets(wsArrayCrnt)\n\n    r = .UsedRange\n    k = r.Rows.Count\n    x = 2000\n    i = 2\n\n    Do While x &lt; k\n\n    .Range((\"A\" &amp; x) &amp; (\":L\" &amp; x)).Copy\n    .End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\n\n    i = i + 1\n    x = 1000 * i\n\n    Loop\nEnd With\nNext wsArrayCrnt\n\nEnd Sub\n</code></pre>\n\n<p>It seems to be failing at the </p>\n\n<pre><code> k = r.Rows.Count\n</code></pre>\n\n<p>Though I am not sure if it will finish after this.</p>\n\n<p>I have also tried to dimension the workbook and add it to the with statement and all the variables after.</p>\n"}, {"tags": ["excel", "indexing", "find", "match", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "edited": false, "score": 0, "creation_date": 1477518985, "post_id": 40271786, "comment_id": 67805426, "body": "Thank you!!! Wow, That is a thing of beauty that I could never have created. I was somewhat on the same track when you replied. Find the item. Find the owner. If the owner is NOT empty, move down one row until you find an empty owner.   It was getting stuck on the  firstResult = ItemRange.Address bit...but now it&#39;s going through. It is not, however, adding the owner to the OWNER cell."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "edited": false, "score": 0, "creation_date": 1477520048, "post_id": 40271786, "comment_id": 67805765, "body": "So the code runs now, without error, but it&#39;s not placing the owner in the OWNER cell? The message box come up properly? You see the line where it&#39;s doing that right? I assumed that your spreadsheet was setup similar to how it is in your question. Is it in fact 2 columns to the right of the ITEM Column?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "edited": false, "score": 0, "creation_date": 1477520417, "post_id": 40271786, "comment_id": 67805878, "body": "Ahhh can&#39;t believe I did that... I&#39;ve changed the code to fix the problem. It was where <code>firstResult</code> was declared. It should be a String, not a Range. See if the code works properly for you now. :)"}, {"owner": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "edited": false, "score": 0, "creation_date": 1477521431, "post_id": 40271786, "comment_id": 67806246, "body": "Works brilliantly. Thank you so much. I wish I had your talent."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "edited": false, "score": 0, "creation_date": 1477522723, "post_id": 40271786, "comment_id": 67806607, "body": "If I have answered your question, would you mind hitting the check mark to accept this as the answer? It&#39;s my reward for being useful to you :)"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1477520369, "last_edit_date": 1477520369, "creation_date": 1477514595, "answer_id": 40271786, "question_id": 40271259, "link": "https://stackoverflow.com/questions/40271259/find-first-blank-cell-matching-specific-criteria-with-matching-values/40271786#40271786", "title": "Find First Blank Cell Matching Specific Criteria with Matching Values", "body": "<h2>Search for Available Items Based on Empty Owner</h2>\n\n<p><em>I've written some raw code for your review. You were on the right track, but with the methods below we avoid using worksheet functions and instead use VBA methods.</em></p>\n\n<hr>\n\n<p><strong>First thing we want to do is find the first occurrence of the user-defined <code>ITEM</code></strong></p>\n\n<p><strong>After that we check if it has an <code>OWNER</code> or not. If it does, find the next <code>ITEM</code>. If it doesn't, assign the user-defined <code>OWNER</code> to the user-defined <code>ITEM</code>.</strong></p>\n\n<p><strong><em>I've included some message boxes for clarity and convenience of the end-user.</em></strong></p>\n\n<hr>\n\n<h2>The Code</h2>\n\n<pre><code>Sub FindBlankOwner()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Owners\")\n    Dim ITEM As String: ITEM = ComboBox1.Value\n    Dim OWNER As String: OWNER = ComboBox2.Value\n    Dim BlankOwnerFound As Boolean: BlankOwnerFound = False\n    Dim firstResult As String\n    Dim ItemRange As Range: Set ItemRange = ws.Range(\"A:A\").Find(What:=ITEM, LookIn:=xlValues, LookAt:=xlWhole)\n\n    If Not ItemRange Is Nothing Then\n        firstResult = ItemRange.Address\n        Do\n            If Trim(ItemRange.Offset(0, 2).Value) = \"\" Then\n                ItemRange.Offset(0, 2).Value = OWNER\n                BlankOwnerFound = True\n            Else\n                Set ItemRange = ws.Range(\"A:A\").FindNext(ItemRange)\n            End If\n        Loop While Not ItemRange Is Nothing And ItemRange.Address &lt;&gt; firstResult And BlankOwnerFound = False\n    Else: MsgBox \"No results for \" &amp; ITEM &amp; \" found.\", vbCritical, \"Cannot Find \" &amp; ITEM\n    End If\n\n    If BlankOwnerFound = True Then\n        MsgBox OWNER &amp; \" has checked out \" &amp; ITEM &amp; \" with Serial Number \" &amp; ItemRange.Offset(0, 1).Value &amp; \".\", _\n               vbOKOnly, ITEM &amp; \" Check-Out Successful\"\n    Else: MsgBox \"No available \" &amp; ITEM &amp; \" in inventory.\", vbCritical, \"All \" &amp; ITEM &amp; \" are checked out.\"\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>NOTE:</strong> I haven't tested this code aside from reading it to myself to ensure it makes sense. There may be a couple errors (hopefully not) and if you can't solve them, please don't hesitate to let me know so we can work on it together. Let me know if this works for you</em> :)</p>\n"}], "owner": {"reputation": 3, "user_id": 4705100, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ixVvf81VZEg/AAAAAAAAAAI/AAAAAAAABWo/R6HCMEYjXfs/photo.jpg?sz=128", "display_name": "user4705100", "link": "https://stackoverflow.com/users/4705100/user4705100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 40271786, "answer_count": 1, "score": 0, "last_activity_date": 1477520369, "creation_date": 1477512411, "last_edit_date": 1531161705, "question_id": 40271259, "link": "https://stackoverflow.com/questions/40271259/find-first-blank-cell-matching-specific-criteria-with-matching-values", "title": "Find First Blank Cell Matching Specific Criteria with Matching Values", "body": "<p>Yeow... That was a mouthful. </p>\n\n<p>I'm setting up a log to track inventory in the office. For some items we have multiple copies of the same tool. I've gotten the VBA to track the owners with userforms and vba, but the multiple-identical-names, first-occurance, blank cell trick is proving to be too much for me. </p>\n\n<p>So what you have is this:</p>\n\n<pre><code>Item      Serial Number     Owner\nItem A     999999999\nItem A     999999991\nItem A     999999992\nItem B     22221\nItem B     22222\nItem B     22223\nItem C     hhhg77\nItem C     hhhg78\nItem C     hhhg79\n</code></pre>\n\n<p>I need the code to search for the ITEM name, gathered from ComboBox1 on the Userform, and find the first occurance of the ITEM WITHOUT an owner, (so the corresponding \"OWNER\" cell should be blank, and put the OWNER, gathered from ComboBox2 on the userform, in that spot. </p>\n\n<p>I've been fooling around with Index &amp; Match and VLookup and countless searches for \"Finding First Row\" but I've come up empty. </p>\n\n<p>The ranges might be changed, so I'm hesitant to be so specific as to say search between A2:A4, so a search would be best, I think. </p>\n\n<p>What I have so far is this....and it's weak, I apologize.</p>\n\n<pre><code>Public Sub FindBlankOwner()\n    Dim MultiItem As Range\n    Dim MultiOwner As Range\n    Dim ITEM As String\n    Dim OWNER As String\n    Dim MultiSerial As Range\n    Dim NO As Range\n\n    ITEM = ComboBox1.Value\n    STATUS = Application.WorksheetFunction.VLookup(ITEM, LUP, 6, False)\n    OWNER = ComboBox2.Value\n\n    Set ws = Worksheets(\"Owners\")\n    Set MultiItem = Worksheets(\"Owners\").Range(\"A1:A28\")\n    Set MultiOwner = Worksheets(\"Owners\").Range(\"C1:C28\")\n    Set MultiSerial = Worksheets(\"Owners\").Range(\"B1:B28\")\n\nFillin = Evaluate(\"INDEX(MultiOwner, MATCH(ITEM, &amp;\n\n'    Set FILLIN = Application.WorksheetFunction.Match(ITEM, (MultiItem), 0) And (Application.WorksheetFunction.Match(\" \", (MultiOwner), 0))\n '   NO.Value = OWNER\n\n    'Set FILLIN = MultiItem.Find(What:=ITEM) And MultiOwner.Find(What:=\"\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1477512114, "post_id": 40271131, "comment_id": 67802290, "body": "please show the code you are trying."}], "answers": [{"comments": [{"owner": {"reputation": 483, "user_id": 2439016, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/407be523f4f71453e05e379bba49355f?s=128&d=identicon&r=PG", "display_name": "Dakota Miller", "link": "https://stackoverflow.com/users/2439016/dakota-miller"}, "edited": false, "score": 0, "creation_date": 1477512743, "post_id": 40271179, "comment_id": 67802602, "body": "Thank you ill give it a shot here. All the names are in the same column so it should be fine."}, {"owner": {"reputation": 483, "user_id": 2439016, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/407be523f4f71453e05e379bba49355f?s=128&d=identicon&r=PG", "display_name": "Dakota Miller", "link": "https://stackoverflow.com/users/2439016/dakota-miller"}, "edited": false, "score": 0, "creation_date": 1477513689, "post_id": 40271179, "comment_id": 67803065, "body": "Ok so when I put this in where the enter button is pressed It comes up with a compiler error expected list separator or ). The code I have is Match(NEName.Value,A1:A100,0)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 483, "user_id": 2439016, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/407be523f4f71453e05e379bba49355f?s=128&d=identicon&r=PG", "display_name": "Dakota Miller", "link": "https://stackoverflow.com/users/2439016/dakota-miller"}, "edited": false, "score": 0, "creation_date": 1477515073, "post_id": 40271179, "comment_id": 67803713, "body": "@DakotaMiller - You&#39;ll need to translate this to VBA. I think it&#39;d be <code>worksheetfunction.Match(neName.Value,Range(&quot;A1:A100&quot;),0)</code>"}, {"owner": {"reputation": 483, "user_id": 2439016, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/407be523f4f71453e05e379bba49355f?s=128&d=identicon&r=PG", "display_name": "Dakota Miller", "link": "https://stackoverflow.com/users/2439016/dakota-miller"}, "edited": false, "score": 0, "creation_date": 1477516302, "post_id": 40271179, "comment_id": 67804301, "body": "Thank You! It worked like it should, ill mark this as the answer!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1477519185, "last_edit_date": 1477519185, "creation_date": 1477512125, "answer_id": 40271179, "question_id": 40271131, "link": "https://stackoverflow.com/questions/40271131/trying-to-find-a-specific-row-with-a-name-in-that-row-in-vba-excel/40271179#40271179", "title": "Trying to find a specific row with a name in that row in vba excel", "body": "<p>You could use a quick <code>Match()</code>:</p>\n\n<p><code>=Match(\"MyName\",$A$1:$A$10000)</code></p>\n\n<p>That should return the row number. Note this is relative. If the name is in <code>A1</code>, the above will return <code>1</code>.</p>\n\n<p>If you do this, however, <code>=match(\"myName\",A2:A100)</code>, and the name is in <code>A2</code>, it will also return <code>1</code>.  </p>\n\n<p>Edit: Sorry, for VBA this should work <code>worksheetfunction.Match(neName.Value,Range(\"A1:A100\"),0)</code></p>\n"}], "owner": {"reputation": 483, "user_id": 2439016, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/407be523f4f71453e05e379bba49355f?s=128&d=identicon&r=PG", "display_name": "Dakota Miller", "link": "https://stackoverflow.com/users/2439016/dakota-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 40271179, "answer_count": 1, "score": 0, "last_activity_date": 1477519185, "creation_date": 1477511928, "question_id": 40271131, "link": "https://stackoverflow.com/questions/40271131/trying-to-find-a-specific-row-with-a-name-in-that-row-in-vba-excel", "title": "Trying to find a specific row with a name in that row in vba excel", "body": "<p>I have a spreadsheet with column A having a list of names in it. I then have a userform that uses those names to make an attendance report. When The enter button is pressed it takes the name and finds what row that name is at then finds the next empty cell in that row and puts the info in that cell. My question is how do I search for that name and get the row that is associated with that name? I have done some research but what I have found I didn't quite understand how they are being implemented. I thought about vlookup but wasn't sure if that would give me the row number?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1477520973, "post_id": 40271099, "comment_id": 67806064, "body": "Currently your code seems to be replacing the last value in column A. Are you aware of this? Also, are you just trying to copy of cell A1 into the EXPORT_DATA or the entire column?"}, {"owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1477525216, "post_id": 40271099, "comment_id": 67807273, "body": "@VBAPete You&#39;re right. I pasted the wrong macro. Updated. Thx!"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": true, "score": 1, "last_activity_date": 1477517750, "creation_date": 1477517750, "answer_id": 40272485, "question_id": 40271099, "link": "https://stackoverflow.com/questions/40271099/excel-vba-to-copy-values-to-specific-row/40272485#40272485", "title": "Excel: VBA to copy values to specific row", "body": "<p>See how this goes for you. Not sure how you are calling etc but it should be a reasonable starting point. I only gave it a really quick test </p>\n\n<pre><code>Sub copy_values_SINGLE(cValue As Variant, Optional Source As String = \"A1\", Optional Source2 As String = \"A1\")\n' Not sure of what value type c in your question would be but expects a single value to test against the column provided as Source\n' Requires cValue to be provided\n\n    Dim R As Range\n    Dim col As Long\n    Dim destRow As Integer\n\n    col = Range(Source).Column\n\n    On Error Resume Next\n    destRow = 0\n    destRow = Worksheets(\"EXPORT_DATA\").Columns(col).Find(cValue, SearchDirection:=xlPrevious).Row\n    If destRow = 0 Then destRow = Worksheets(\"EXPORT_DATA\").Cells(Rows.Count, col).End(xlUp).Row + 1 ' if cValue isnt found reverts to the last row as per previous code\n    On Error GoTo 0\n\n    Set R = Worksheets(\"EXPORT_DATA\").Cells(destRow, col)\n    R.Value = Worksheets(\"BACKEND\").Range(Source2).Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "is_accepted": false, "score": 0, "last_activity_date": 1477525480, "creation_date": 1477525480, "answer_id": 40273871, "question_id": 40271099, "link": "https://stackoverflow.com/questions/40271099/excel-vba-to-copy-values-to-specific-row/40273871#40273871", "title": "Excel: VBA to copy values to specific row", "body": "<p>This may work</p>\n\n<pre><code>Sub copy_values(Optional Source As String = \"A1\", Optional Source2 As String = \"A1\")\n\n    Dim R As Variant\n    Dim col As Long\n    col = Range(Source).Column\n\n    Dim mrn As String\n    Dim FoundCell As Excel.Range\n    Dim myVal As String\n\n    R = Worksheets(\"BACKEND\").Range(Source2).Text\n    myVal = Worksheets(\"BACKEND\").Range(Source2).Text\n    mrn = Worksheets(\"BACKEND\").Range(\"A5\").Value\n    Set FoundCell = Worksheets(\"EXPORT_DATA\").Range(\"A:A\").Find(what:=mrn, lookat:=xlWhole, searchdirection:=xlPrevious)\n\n    If Not FoundCell Is Nothing Then\n'        MsgBox (R &amp; \" \" &amp; col &amp; \" \" &amp; FoundCell.Row)\n        Worksheets(\"EXPORT_DATA\").Range(\"Q\" &amp; FoundCell.Row).Value = R\n        Else\n        MsgBox \"error\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 0, "last_activity_date": 1477525857, "creation_date": 1477525857, "answer_id": 40273919, "question_id": 40271099, "link": "https://stackoverflow.com/questions/40271099/excel-vba-to-copy-values-to-specific-row/40273919#40273919", "title": "Excel: VBA to copy values to specific row", "body": "<p>Still not 100% certain, but I think this is what you are after. The file loop all values in column A of the EXPORT_DATA file and compared them to the value in cell A1 of the BACKEND worksheet. If it finds the value it replaces the value in column B, if it cannot find the value, it adds it at the end:</p>\n\n<pre><code>Sub copy_values_SINGLE()\n\nDim R As Range\nDim rowCount As Long\nDim varValue As Variant\n\n\nrowCount = Application.WorksheetFunction.CountA(Worksheets(\"EXPORT_DATA\").Range(\"A:A\"))\n\nFor s = 1 To rowCount\n    If Worksheets(\"EXPORT_DATA\").Range(\"A\" &amp; s).Value = Worksheets(\"BACKEND\").Range(\"A1\").Value Then\n    Worksheets(\"EXPORT_DATA\").Range(\"A\" &amp; s &amp; \":B\" &amp; s).Value = Worksheets(\"BACKEND\").Range(\"A1:B1\").Value\n    Exit For\n    Else\n        If s = rowCount Then\n        Set R = Worksheets(\"EXPORT_DATA\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        R.Value = Worksheets(\"BACKEND\").Range(\"A1:B1\").Value\n        End If\n    End If\nNext s\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this works for you.</p>\n"}], "owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 0, "accepted_answer_id": 40272485, "answer_count": 3, "score": 0, "last_activity_date": 1477525857, "creation_date": 1477511803, "last_edit_date": 1531161705, "question_id": 40271099, "link": "https://stackoverflow.com/questions/40271099/excel-vba-to-copy-values-to-specific-row", "title": "Excel: VBA to copy values to specific row", "body": "<p>I currently have a macro that copies the value from a specific cell from one sheet(BACKEND), and pastes in specific column in another sheet (EXPORT_DATA), in the next blank row.</p>\n\n<pre><code>Sub copy_values(Optional Source As String = \"A1\", Optional Source2 As String = \"A1\")\n\n    Dim R As Range\n    Dim col As Long\n    col = Range(Source).Column\n\n    Set R = Worksheets(\"EXPORT_DATA\").Cells(Rows.Count, col).End(xlUp)\n    If Len(R.Value) &gt; 0 Then Set R = R.Offset(1)\n    R.Value = Worksheets(\"BACKEND\").Range(Source2).Value\n\nEnd Sub\n</code></pre>\n\n<p>It works well, but I want to replace the the function in where it pastes the data in the next blank cell in a column, to a function in where it pastes the data in a row in where a cell holds a specified value.</p>\n\n<p>For example, the older function would do the following</p>\n\n<p>step 1:</p>\n\n<pre><code>c1    c2    c3\na     b     4\nc     d     6\n</code></pre>\n\n<p>step 2 (after macro executed):</p>\n\n<pre><code>c1    c2    c3\na     b     4\nc     d     6\nc     d     5\n</code></pre>\n\n<p>But I need a new function that does this:</p>\n\n<p>step 2 (C1 value of \"c\" specified, macro executed):</p>\n\n<pre><code>c1    c2    c3\na     b     4\nc     d     5\n</code></pre>\n"}, {"tags": ["ms-access", "ms-word", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7066080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-x3UBDvulOvI/AAAAAAAAAAI/AAAAAAAAJCA/Gj0VCNKHLwc/photo.jpg?sz=128", "display_name": "Rob Riggle", "link": "https://stackoverflow.com/users/7066080/rob-riggle"}, "edited": false, "score": 0, "creation_date": 1477578384, "post_id": 40272446, "comment_id": 67832681, "body": "Fantastic!  Thanks a bunch."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1477517499, "last_edit_date": 1495540098, "creation_date": 1477517499, "answer_id": 40272446, "question_id": 40271015, "link": "https://stackoverflow.com/questions/40271015/vba-access-object-code-for-dropdownlist-contentcontrols/40272446#40272446", "title": "VBA Access object code for DropDownList ContentControls", "body": "<p>This is probably your problem:</p>\n\n<pre><code>Set objCC = ActiveDocument.ContentControls(1)\n</code></pre>\n\n<p>It should be</p>\n\n<pre><code>Set objCC = .ActiveDocument.ContentControls(1)\n</code></pre>\n\n<p>But much better would be:</p>\n\n<pre><code>Set wDoc = WordApp.Documents.Add(Template:=strTemplateLocation, newtemplate:=False)\n</code></pre>\n\n<p>and then always use <code>wDoc</code> instead of <code>WordApp.ActiveDocument</code>.</p>\n\n<p>See here: <a href=\"https://stackoverflow.com/questions/24082705/vba-activedocument-concerns-alternatives\">VBA ActiveDocument Concerns / Alternatives?</a></p>\n"}], "owner": {"reputation": 47, "user_id": 7066080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-x3UBDvulOvI/AAAAAAAAAAI/AAAAAAAAJCA/Gj0VCNKHLwc/photo.jpg?sz=128", "display_name": "Rob Riggle", "link": "https://stackoverflow.com/users/7066080/rob-riggle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 40272446, "answer_count": 1, "score": 0, "last_activity_date": 1594641196, "creation_date": 1477511441, "last_edit_date": 1594641196, "question_id": 40271015, "link": "https://stackoverflow.com/questions/40271015/vba-access-object-code-for-dropdownlist-contentcontrols", "title": "VBA Access object code for DropDownList ContentControls", "body": "<p>I am coding an Access database that will collect user input, then open a Word document and fill out various parts of the document.  </p>\n\n<p>The problem I am having is it will only work once for Drop Down Lists.  Not sure why or where to look to fix this one.  There are three types of items I am programmatically filling in.  The first is bookmarks, no problem with this.  Second is Content Control Checkboxes, these also work with no problems.  The third is Content Control Drop Down Lists, this is where the problem is.  First time I open the Access Database it works, but if I click the command button again, nothing (for Drop Downs).  The main problem is that it doesn't produce an error message, so I am not sure where to look.</p>\n\n<p>I am guessing it has something to do with the objects I am creating to do the drop down updates?  any help would be great:</p>\n\n<pre><code>Dim WordApp As Word.Application\nDim strTemplateLocation As String\nDim dir As String\nDim path As String\nDim wDoc As Word.Document\n\npath = Left(CurrentDb.Name, InStrRev(CurrentDb.Name, \"\\\"))\nstrTemplateLocation = path &amp; \"UserDoc.docx\"\n\nOn Error Resume Next\nSet WordApp = GetObject(, \"Word.Application\")\nIf Err.Number &lt;&gt; 0 Then\n  Set WordApp = CreateObject(\"Word.Application\")\nEnd If\n\nWordApp.Visible = True\nWordApp.WindowState = wdWindowStateMaximize\nWordApp.Documents.Add Template:=strTemplateLocation, newtemplate:=False\n\nWith WordApp\n\n'Working Bookmark   \n  .Selection.GoTo what:=wdGoToBookmark, Name:=\"COMPANY\": .Selection.TypeText [fac]\n\n'Working checkbox\nIf Me.RD = True Then: .ActiveDocument.ContentControls(9).Checked = True\n\n'Works ONCE drop down\n Dim objCC As ContentControl\n Dim objCE As ContentControlListEntry\n Dim ListSelection As String\n\n ListSelection = Me.System_Type.ListIndex + 2\n Set objCC = ActiveDocument.ContentControls(1): Set objCE = objCC.DropdownListEntries.Item(ListSelection): objCE.Select\n\nEnd With\n</code></pre>\n\n<p>Should I be closing out the objCE and objCC at the end or something? </p>\n"}, {"tags": ["html", "vba", "excel", "web-scraping", "html-tableextract"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1477511055, "post_id": 40270890, "comment_id": 67801762, "body": "&quot;ends up ??&quot;  huh?"}, {"owner": {"reputation": 13, "user_id": 3095357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38d6324dc318b3cdfc9c065c479c2298?s=128&d=identicon&r=PG", "display_name": "user176705", "link": "https://stackoverflow.com/users/3095357/user176705"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1477511298, "post_id": 40270890, "comment_id": 67801883, "body": "There are about 300+ string in 300+ raw, mean last (row) string of the txt file, like TikerName.txt"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3095357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38d6324dc318b3cdfc9c065c479c2298?s=128&d=identicon&r=PG", "display_name": "user176705", "link": "https://stackoverflow.com/users/3095357/user176705"}, "edited": false, "score": 0, "creation_date": 1477512933, "post_id": 40271032, "comment_id": 67802693, "body": "showing not responding :( 300+ link access simultaneously from excel in same site, should it be ok??"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 3095357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38d6324dc318b3cdfc9c065c479c2298?s=128&d=identicon&r=PG", "display_name": "user176705", "link": "https://stackoverflow.com/users/3095357/user176705"}, "edited": false, "score": 0, "creation_date": 1477513465, "post_id": 40271032, "comment_id": 67802947, "body": "@user176705 - I&#39;m not sure I understand your comment.  I can only guess that you mean that your question wasn&#39;t meant to be &quot;How do I loop/run the code According to a list in .txt file, until the list is ends up??&quot; but &quot;How do I get sufficient resources so that Excel can perform 300 queries simultaneously&quot;.  If so, I suggest you create a new question as that one is wildly different to what you asked."}, {"owner": {"reputation": 13, "user_id": 3095357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38d6324dc318b3cdfc9c065c479c2298?s=128&d=identicon&r=PG", "display_name": "user176705", "link": "https://stackoverflow.com/users/3095357/user176705"}, "edited": false, "score": 0, "creation_date": 1477513760, "post_id": 40271032, "comment_id": 67803097, "body": "Thanks for your nice understanding my friend. I will make a new question soon."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1477511514, "creation_date": 1477511514, "answer_id": 40271032, "question_id": 40270890, "link": "https://stackoverflow.com/questions/40270890/macro-for-multiple-links/40271032#40271032", "title": "Macro for Multiple links", "body": "<p>Create a structure something like this:</p>\n\n<pre><code>Sub FundData()\n\n    Dim TikerName As String\n\n    Open \"C:\\somepath\\sometextfile.txt\" For Input As #1\n    Do While Not EOF(1)\n        Line Input #1, TikerName\n\n        ' your main code goes here\n\n    Loop\n    Close #1\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3095357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38d6324dc318b3cdfc9c065c479c2298?s=128&d=identicon&r=PG", "display_name": "user176705", "link": "https://stackoverflow.com/users/3095357/user176705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 1, "accepted_answer_id": 40271032, "answer_count": 1, "score": 0, "last_activity_date": 1477514270, "creation_date": 1477510934, "last_edit_date": 1477514270, "question_id": 40270890, "link": "https://stackoverflow.com/questions/40270890/macro-for-multiple-links", "title": "Macro for Multiple links", "body": "<p>How do I loop/run the code According to a list in .txt file, until the list is ends ?? </p>\n\n<p>How do I loop/run the code According to a list in .txt file, until the list is ends ?? </p>\n\n<pre><code>Sub FundData()\n\nDim TikerName As String\n\n    TikerName = 'check &amp; execute the names in list one after one in .txt file until it ends up\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://example.com/index.php?name=\" &amp; TikerName, Destination:=Range( _\n        \"$A$1\"))\n        '.CommandType = 0\n        .Name = \"name=\" &amp; TikerName\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"\"\"company\"\"\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n    ActiveSheet.Name = TikerName\n    Sheets.Add After:=ActiveSheet\n    ThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7066972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f204dcc0cb7b5ec89c8b5f02c892db?s=128&d=identicon&r=PG&f=1", "display_name": "K Hallie", "link": "https://stackoverflow.com/users/7066972/k-hallie"}, "edited": false, "score": 0, "creation_date": 1477512130, "post_id": 40270957, "comment_id": 67802298, "body": "Wow that is much easier than my method! I appreciate it tons."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1477511799, "last_edit_date": 1477511799, "creation_date": 1477511198, "answer_id": 40270957, "question_id": 40270806, "link": "https://stackoverflow.com/questions/40270806/is-there-a-way-to-reverse-a-range-of-strings-using-a-button-instead-of-using-a-f/40270957#40270957", "title": "Is there a way to reverse a range of strings using a button instead of using a function?", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/e462ax87\" rel=\"nofollow\"><code>StrReverse</code></a></p>\n\n<pre><code>Private Sub btnReverse_Click()\n    For Each cell In [D38:D41]\n        cell.Value = StrReverse(cell.Value)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7066972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f204dcc0cb7b5ec89c8b5f02c892db?s=128&d=identicon&r=PG&f=1", "display_name": "K Hallie", "link": "https://stackoverflow.com/users/7066972/k-hallie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477511799, "creation_date": 1477510639, "last_edit_date": 1531161705, "question_id": 40270806, "link": "https://stackoverflow.com/questions/40270806/is-there-a-way-to-reverse-a-range-of-strings-using-a-button-instead-of-using-a-f", "title": "Is there a way to reverse a range of strings using a button instead of using a function?", "body": "<p>I know there is a way to reverse strings in excel (and even this throws me a #NAME? error on the spreadsheet), but I do not want to call a function in the spreadsheet. I instead want to use a button to perform the action for me. </p>\n\n<p>However, I can physically go in and and reverse one myself, but am unsure of the syntax (for this method) if I wanted to do this 4 other times. This will reverse the value I wanted and with a button press toggle it back to the original, however how would I go about doing this for other entries within the same range?</p>\n\n<pre><code>Private Sub btnReverse_Click()\nSelect Case btnReverse.Value\nCase True\nSheet1.Range(\"D38:D41\").Columns.Replace _\nWhat:=\"iphone\", Replacement:=\"enohpi\" _\n\nCase False\nSheet1.Range(\"D38:D41\").Columns.Replace _\nWhat:=\"enohpi\", Replacement:=\"iphone\" _\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477510213, "post_id": 40270021, "comment_id": 67801304, "body": "I tried this. It deleted the column from the first sheet too"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1477507801, "creation_date": 1477507801, "answer_id": 40270021, "question_id": 40269933, "link": "https://stackoverflow.com/questions/40269933/delete-fist-column-from-all-sheet-except-current-sheet-in-excel/40270021#40270021", "title": "Delete fist column from all sheet except current sheet in excel", "body": "<p>Test whether ws = to the active sheet:</p>\n\n<pre><code>Sub deletefirstcolum()\n    Dim aWs As Worksheet\n    Set aWs = ActiveSheet\n\n    Dim ws As Worksheet\n\n    For Each ws In Sheets\n        If aWs.Name &lt;&gt; ws.Name Then\n            ws.Cells(1, 1).EntireColumn.Delete\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1477508530, "post_id": 40270040, "comment_id": 67800439, "body": "I would prefer to use <code>ws.Columns(1).Delete</code>.  But this works +1."}, {"owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "edited": false, "score": 0, "creation_date": 1477510379, "post_id": 40270040, "comment_id": 67801398, "body": "Thanks a lot for all your help. I really appreciate it."}], "tags": [], "owner": {"reputation": 118, "user_id": 6332914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a379561a3c273d4b128874d7a2df54?s=128&d=identicon&r=PG&f=1", "display_name": "akovner", "link": "https://stackoverflow.com/users/6332914/akovner"}, "is_accepted": true, "score": 1, "last_activity_date": 1477508076, "last_edit_date": 1477508076, "creation_date": 1477507894, "answer_id": 40270040, "question_id": 40269933, "link": "https://stackoverflow.com/questions/40269933/delete-fist-column-from-all-sheet-except-current-sheet-in-excel/40270040#40270040", "title": "Delete fist column from all sheet except current sheet in excel", "body": "<p>Put an <code>If</code> condition on the worksheet:</p>\n\n<pre><code>Sub deletefirstcolum()\n\n    Dim ws As Worksheet\n\n    For Each ws In Sheets\n        If Not ws Is ActiveSheet Then\n            ws.Cells(1, 1).EntireColumn.Delete\n        End If\n\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6353766, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4cd1a2b32ff641e79ad591ca4061581a?s=128&d=identicon&r=PG&f=1", "display_name": "Navy", "link": "https://stackoverflow.com/users/6353766/navy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 40270040, "answer_count": 2, "score": 0, "last_activity_date": 1477508076, "creation_date": 1477507504, "last_edit_date": 1477507691, "question_id": 40269933, "link": "https://stackoverflow.com/questions/40269933/delete-fist-column-from-all-sheet-except-current-sheet-in-excel", "title": "Delete fist column from all sheet except current sheet in excel", "body": "<p>I want to delete the first column(A:A) in each sheet except in the first or the current sheet. Can somebody help me.\nI used the following code which deletes first column from each sheet.</p>\n\n<pre><code>Sub deletefirstcolum()\n\n    Dim ws As Worksheet\n\n    For Each ws In Sheets\n\n    ws.Cells(1, 1).EntireColumn.Delete\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Please help. How do I exclude first or current sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7076509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/912af7bc31a8b59616bb74369adedddd?s=128&d=identicon&r=PG&f=1", "display_name": "Jim V.", "link": "https://stackoverflow.com/users/7076509/jim-v"}, "edited": false, "score": 0, "creation_date": 1477572851, "post_id": 40269451, "comment_id": 67828607, "body": "Worked perfect thank you J.Reid !"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7076509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/912af7bc31a8b59616bb74369adedddd?s=128&d=identicon&r=PG&f=1", "display_name": "Jim V.", "link": "https://stackoverflow.com/users/7076509/jim-v"}, "edited": false, "score": 0, "creation_date": 1478198831, "post_id": 40269740, "comment_id": 68068225, "body": "J.Reid I have an additional question after I add a yellow line to separate data based on a date change as reflected above, now I would like to add the &quot;Day&quot; corresponding with the inserted yellow line in column A. Your help will be greatly appreciated."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 1, "user_id": 7076509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/912af7bc31a8b59616bb74369adedddd?s=128&d=identicon&r=PG&f=1", "display_name": "Jim V.", "link": "https://stackoverflow.com/users/7076509/jim-v"}, "edited": false, "score": 0, "creation_date": 1478222529, "post_id": 40269740, "comment_id": 68077566, "body": "You are saying &#39;Day&#39; as in Thursday or 03 (11/03/2016). I don&#39;t quite follow what you mean by Day. Also without an example data set this is quite vague. If the date change was from 11/01/2016 to 11/03/2016 what value do you want in Column A?"}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": false, "score": 1, "last_activity_date": 1477506792, "creation_date": 1477506792, "answer_id": 40269740, "question_id": 40269451, "link": "https://stackoverflow.com/questions/40269451/adding-a-yellow-row-vba-code-in-excel/40269740#40269740", "title": "Adding a yellow row vba code in excel", "body": "<p>Add this line after inserting your row  </p>\n\n<pre><code>Range(Cells(iRow + 1, 1), Cells(iRow + 1, iCol)).Interior.Color = vbYellow\n</code></pre>\n\n<p>Where the first Cell is the start of the Row and the Second Cell is the end of the row. If you want the entire row then do this</p>\n\n<pre><code>Rows(iRow + 1).Interior.Color = vbYellow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7076509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/912af7bc31a8b59616bb74369adedddd?s=128&d=identicon&r=PG&f=1", "display_name": "Jim V.", "link": "https://stackoverflow.com/users/7076509/jim-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478199101, "creation_date": 1477505800, "last_edit_date": 1531164843, "question_id": 40269451, "link": "https://stackoverflow.com/questions/40269451/adding-a-yellow-row-vba-code-in-excel", "title": "Adding a yellow row vba code in excel", "body": "<p>I'm using the code below to insert and entire yellow row after a date change in my spreadsheet and it is working great however, I would now like to actually add the DAY in the yellow high-lighed row in column A corresponding with the date change. I would greatly appreciate any guidance.</p>\n\n<pre><code>   Dim iRow As Integer, iCol As Integer\nDim oRng As Range\n\nSet oRng = Range(\"L7:L500\")\n\niRow = oRng.Row\niCol = oRng.Column\n\nDo\n'\n\nIf iRow = 500 Then\n    End\nElseIf Cells(iRow, iCol).Text = \"\" Then\n    iRow = iRow + 1\nElseIf Cells(iRow + 1, iCol).Text = \"\" Then\n    If Left(Cells(iRow + 2, iCol), 14) &lt;&gt; Left(Cells(iRow, iCol), 14) Then\n        Cells(iRow + 2, iCol).EntireRow.Insert shift:=xlDown\n        Range(Cells(iRow + 2, 1), Cells(iRow + 2, 22)).Interior.Color = vbYellow\n'        Rows(iRow + 2).Interior.Color = vbYellow\n        iRow = iRow + 3\n    Else\n        iRow = iRow + 2\n    End If\nElseIf Left(Cells(iRow + 1, iCol), 14) &lt;&gt; Left(Cells(iRow, iCol), 14) Then\n    Cells(iRow + 1, iCol).EntireRow.Insert shift:=xlDown\n    Range(Cells(iRow + 1, 1), Cells(iRow + 1, 22)).Interior.Color = vbYellow\n'    Rows(iRow + 1).Interior.Color = vbYellow\n    iRow = iRow + 2\nElse\n    iRow = iRow + 1\nEnd If\n'\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1477506025, "post_id": 40269440, "comment_id": 67799012, "body": "<code>InputBox</code> was really meant for development/debugging, not for collecting actual user input. It&#39;s much easier (and user-friendly) to implement proper validation with a custom <code>UserForm</code>."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477507328, "post_id": 40269486, "comment_id": 67799796, "body": "I have one problem this loop doesn&#39;t work for my second numeric input, I don&#39;t know what I have done wrong. This is your code adapted to the variable e:           <code>Do     e = InputBox(&quot;Please enter the starting 5 digit MRN number&quot;)     If Not (IsNumeric(e) And Len(e) = 5) Then MsgBox e &amp; &quot; is not a 5 digit number&quot; Loop Until IsNumeric(e) And Len(e) = 5</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477507647, "post_id": 40269486, "comment_id": 67799975, "body": "@CharlieWest the code works for me.  see edit for a tested version."}, {"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477509273, "post_id": 40269486, "comment_id": 67800801, "body": "I&#39;m still getting the same problem, for some reason it thinks a five digit number has a len = 2. Not sure why."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477509606, "post_id": 40269486, "comment_id": 67800988, "body": "Not sure what is happening as I have tested the code and am not having an issue."}, {"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477509764, "post_id": 40269486, "comment_id": 67801074, "body": "well thanks for the help I&#39;ll keep messing with it hopefully I can figure out why its not working."}, {"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477510610, "post_id": 40269486, "comment_id": 67801538, "body": "I figured out my problem I had my s and e variables assigned as integers, when I removed the <code>Dim s, e As integers</code> piece of code it started to work."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477510672, "post_id": 40269486, "comment_id": 67801568, "body": "Yes s was being declared as a variant and e as an integer use this instead <code>Dim s as long, e as long</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1477510697, "post_id": 40269486, "comment_id": 67801583, "body": "Remember to marks as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1477507623, "last_edit_date": 1477507623, "creation_date": 1477505948, "answer_id": 40269486, "question_id": 40269440, "link": "https://stackoverflow.com/questions/40269440/is-it-possible-to-have-a-inputbox-require-5-digits/40269486#40269486", "title": "Is it possible to have a inputbox require 5 digits?", "body": "<p>Wrap each entry in a Do Loop:</p>\n\n<pre><code>Do\n    s = InputBox(\"Please enter the starting 5 digit MRN number\")\n    If Not (IsNumeric(s) And Len(s) = 5) Then MsgBox s &amp; \" is not a 5 digit number\"\nLoop Until IsNumeric(s) And Len(s) = 5\n</code></pre>\n\n<p>So for <code>e</code></p>\n\n<pre><code>Do\n    e = InputBox(\"Please enter the ending 5 digit MRN number\")\n    If Not (IsNumeric(e) And Len(e) = 5) Then MsgBox e &amp; \" is not a 5 digit number\"\nLoop Until IsNumeric(e) And Len(e) = 5\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 40269486, "answer_count": 1, "score": 1, "last_activity_date": 1477507623, "creation_date": 1477505758, "last_edit_date": 1531164843, "question_id": 40269440, "link": "https://stackoverflow.com/questions/40269440/is-it-possible-to-have-a-inputbox-require-5-digits", "title": "Is it possible to have a inputbox require 5 digits?", "body": "<p>I am currently designing a macro that will require 3 inputs from a user, I want to know if I could somehow require the numeric inputs to require a 5 digit serial number. And restrict anything that is more or less then five digits. This is my code so far: </p>\n\n<pre><code>Sub MRN_numbers()\n\n  Dim s, e As Integer\n  Dim m As String\n\n  s = InputBox(\"Please enter the starting 5 digit MRN number\")\n  m = InputBox(\"please enter the material type\")\n     If Not m = \"ebara\" Or m = \"mirra\" Or m = \"300mm\" Then\n     MsgBox (\"Please enter valid material name!\")\n     m = InputBox(\"Please enter the material type\")\n     End If\n\n  e = InputBox(\"pleae enter the ending 5 digit MRN number\")\n\nRange(\"D1\").Activate\nRange(\"D65536\").End(xlUp).Offset(1, 0).Activate\n\nFor i = s To e\nIf m = \"ebara\" Or m = \"mirra\" Or m = \"300mm\" Then\n\n    If m = \"ebara\" Then\n        For l = 1 To 5\n            ActiveCell.Value = i &amp; \"-\" &amp; l\n            ActiveCell.Offset(1, 0).Activate\n            ActiveCell.Offset(-1, -1).Value = \"Ebara\"\n        Next l\n\n    End If\n\n    If m = \"mirra\" Then\n        For r = 1 To 6\n\n            ActiveCell.Value = i &amp; \"-\" &amp; r\n            ActiveCell.Offset(1, 0).Activate\n            ActiveCell.Offset(-1, -1).Value = \"Mirra\"\n        Next r\n    End If\n\n    If m = \"300mm\" Then\n        For y = 1 To 4\n            ActiveCell.Value = i &amp; \"-\" &amp; y\n            ActiveCell.Offset(1, 0).Activate\n            ActiveCell.Offset(-1, -1).Value = \"300mm\"\n        Next y\n    End If\n\n\nEnd If\n\n\n  Range(\"D65536\").End(xlUp).Offset(1, 0).Activate\n\n\n\n\n\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure where to start on this, I watched videos but didn't find anything that helped, I am going to keep looking and trying different ways in the mean time, but any help on this would be appreciated. </p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 4, "creation_date": 1477504703, "post_id": 40268964, "comment_id": 67798271, "body": "Greetings! What&#39;s the question?"}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477512738, "post_id": 40268964, "comment_id": 67802599, "body": "So, currently it only deletes the old sheet and copies over each line from the master list when it find a line that matches the specified criteria.  I need to modify so that it checks all lines first to confirm whether or not there are any lines that meet the specified criteria and, if not, then it deletes the old sheet and creates a new sheet in its place."}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477513262, "post_id": 40268964, "comment_id": 67802850, "body": "Currently, if it goes through and does not find any line matching the specified criteria then it leaves the old sheet and old information.  I need to find a way so that (1) the old information is deleted, as it does now, and (2) the new sheet reflects that no entry was found based on the criteria entered.  No msgboxes because this is only one portion of a larger process that runs a larger data pull, and I don&#39;t want that larger process stopping to deal with a msgbox popup."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1477516101, "post_id": 40268964, "comment_id": 67804212, "body": "I see towards the end, you stopped stating the worksheet to use.  for example <code>LastRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code> needs the worksheet before <code>Cells()</code>, and <code>Rows.Count</code>. do that for all range objects"}, {"owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "edited": false, "score": 0, "creation_date": 1477897974, "post_id": 40268964, "comment_id": 67930330, "body": "So, if you do that manually, is it like that you will use <code>ctrl+f</code> and search <code>c.value</code> and <code>d.value</code> on <code>Item</code> sheet. If there is no match, you will delete the sheet. is it correct?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1477907840, "post_id": 40268964, "comment_id": 67934114, "body": "Which columns would the values you&#39;re looking for be located in? Also, it&#39;s unclear what you&#39;re trying to accomplish... if it finds any of the values you&#39;re looking for, what exactly do you want the code to do? Also - if it doesn&#39;t find any of the values, delete the sheet, make a new one, and put a statement in <code>G2</code> - correct?"}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477917846, "post_id": 40268964, "comment_id": 67938864, "body": "c and d values are located in columns &quot;AI&quot; and &quot;H&quot; of the shtMaster, respectively.  The code works, as is, when the c and d value combination is found.  Your last question is correct - I need to modify so that, if the combination of c and d values is not found, then it just deletes the old sheet, makes a new one, and puts some statement on the new, blank sheet (&quot;G2&quot; is fine as an example)."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1477938445, "post_id": 40268964, "comment_id": 67950996, "body": "I assume you only want this check done once, and not on every iteration of <code>c</code> (as you are doing right now)? Otherwise you&#39;re going to run into trouble when you suddenly have a workbook with some tens of thousands of worksheets... And what worksheet are you looking for <code>c.Value</code> and <code>d.Value</code> in? I am assuming it would be <code>shtRpt</code>, but you don&#39;t declare it, and the way you frame your question makes it sound like there might be several worksheets (or even workbooks) - and yet you don&#39;t iterate over any?"}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477942238, "post_id": 40268964, "comment_id": 67952953, "body": "The check needs to be done only once initially. If no rows are found that meet the c and d.value criteria then old sheet gets deleted and new, blank template sheet replaces.  If any rows are found that match the c and d.Value criteria then it would move to the rest of the code to identify each row that matches and copy those rows over to the newly generated sheet (as it does now).  And the values are searched in shtMaster, which is shown."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477927001, "post_id": 40342839, "comment_id": 67944424, "body": "It&#39;s not a search to verify whether they exist independently in the respective ranges.  Similar to above, it needs to go through each row to verify whether or not any row on the shtMaster meets the c and d value criteria - if there is no row containing the c and d value pair then the old destination worksheet needs to be deleted and replaced with an empty sheet of the same name.  If any row is found that meets the c and d value criteria then the old sheet should be removed and replaced with a new one and the matching rows are then copied over to the new destination sheet from shtMaster."}, {"owner": {"reputation": 110, "user_id": 4460023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiFp7.jpg?s=128&g=1", "display_name": "RiverBanana", "link": "https://stackoverflow.com/users/4460023/riverbanana"}, "reply_to_user": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477929497, "post_id": 40342839, "comment_id": 67946051, "body": "Ok my apologies, I misunderstood. What about something like this:"}, {"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477945170, "post_id": 40342839, "comment_id": 67954373, "body": "Am getting &quot;invalid procedure call or argument&quot; error at <code>Set currCell = rng.FindNext(currCell)</code>"}, {"owner": {"reputation": 110, "user_id": 4460023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiFp7.jpg?s=128&g=1", "display_name": "RiverBanana", "link": "https://stackoverflow.com/users/4460023/riverbanana"}, "reply_to_user": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1477947370, "post_id": 40342839, "comment_id": 67955388, "body": "Hmm strange, this code worked for me on a little sample I had created. Hopefully the overall logic makes sense though (ie. find each row with the 2516 value, and then check if the other column in the same row has the value &quot;37A&quot;. Just loop this until you&#39;re back at your original cell)"}], "tags": [], "owner": {"reputation": 110, "user_id": 4460023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiFp7.jpg?s=128&g=1", "display_name": "RiverBanana", "link": "https://stackoverflow.com/users/4460023/riverbanana"}, "is_accepted": false, "score": 0, "last_activity_date": 1477929682, "last_edit_date": 1477929682, "creation_date": 1477919270, "answer_id": 40342839, "question_id": 40268964, "link": "https://stackoverflow.com/questions/40268964/modifying-existing-loop-when-no-instance-of-matched-criteria-is-present/40342839#40342839", "title": "Modifying existing loop when no instance of matched criteria is present", "body": "<p>Based on what I've read, it sounds like you should just search for the values in their respective columns beforehand. This is also assuming that if one of those conditions is false, you'll enter your new code. So you could do something like:</p>\n\n<pre><code>Set cRange = shtMaster.Columns(\"AI:AI\")\nSet dRange = shtMaster.Columns(\"H:H\")\n\nIf cRange.Find(2516) Is Nothing Or dRange.Find(\"37A\") Is Nothing Then\n    'do code when either one of these conditions is false\n\nElse\n    'both values are found in their respective columns\n    'do existing code\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>Set rng = Range(\"AI:AI\")\n\nSet origCell = rng.Find(2516)\nSet currCell = origCell\n\nDo\n    Set currCell = rng.FindNext(currCell)\n\n    If shtMaster.Range(\"H\" &amp; currCell.Row).Value = \"37A\" Then\n        boolMatchingPair = True\n        Exit Do\n    End If\nLoop While currCell.Row &lt;&gt; origCell.Row\n\nIf boolMatchingPair = True\n    'found match\nElse\n    'no match\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "edited": false, "score": 0, "creation_date": 1478012037, "post_id": 40353668, "comment_id": 67978151, "body": "A clean solution for what I was asking.  Not having any issues with adaptation into larger processes.  Thank you!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1477970295, "creation_date": 1477970295, "answer_id": 40353668, "question_id": 40268964, "link": "https://stackoverflow.com/questions/40268964/modifying-existing-loop-when-no-instance-of-matched-criteria-is-present/40353668#40353668", "title": "Modifying existing loop when no instance of matched criteria is present", "body": "<p>It seems to me that you always want a new Worksheet for the <code>Item</code>.\nSo create the new worksheet first, then run the routine to find and fill the new worksheet with the records from the Master worksheet and use a variable (<code>Dim blItmFound As Boolean</code>) to flag when any record is found and at the end if there where no records found then enter in the new worksheet at <code>G2</code> the generic string you want <em>(see <code>Rem Validate Records</code>)</em>.</p>\n\n<p>Please note that I changed <code>\"Item\"</code> for the value of the Variable <code>Item</code> and also changed this line: </p>\n\n<pre><code>Loop Until IsEmpty(c.Offset(0, -1)) \n</code></pre>\n\n<p>for this:</p>\n\n<pre><code>Loop Until c.Value = Empty\n</code></pre>\n\n<p>for more details see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264227(v=office.15).aspx\" rel=\"nofollow\">IsEmpty Function</a></p>\n\n<p>This is your code adjusted:</p>\n\n<pre><code>Sub CreateDeptReport(Item As String)\nDim shtRpt As Excel.Worksheet, shtMaster As Excel.Worksheet, shtPrevious As Excel.Worksheet\nDim LCopyToRow As Long\nDim LCopyToCol As Long\nDim LastRow As Long\nDim arrColsToCopy\nDim c As Range, d As Range, e As Range, x As Integer\nDim blItmFound As Boolean\n\n    arrColsToCopy = Array(1, 8, 3, 7, 9, 10, 39, 19, 24, 25, 27, 29, 33, 34, 35)\n\n    Application.ScreenUpdating = False\n    Set shtMaster = ThisWorkbook.Sheets(\"CurrentMaster\")\n    Set shtPrevious = ThisWorkbook.Sheets(\"PreviousMaster\")\n    Set c = shtMaster.Range(\"AI5\")\n    Set d = shtMaster.Range(\"H5\")\n    Set e = shtMaster.Range(\"X5\")\n\n    Rem Delete Item Worksheet\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    ThisWorkbook.Sheets(Item).Delete\n    Application.DisplayAlerts = True\n    On Error GoTo Err_Execute\n\n    Rem Add New Item Worksheet\n    ThisWorkbook.Sheets(\"Template\").Visible = xlSheetVisible\n    ThisWorkbook.Sheets(\"Template\").Copy After:=shtPrevious\n    Set shtRpt = ThisWorkbook.Sheets(shtPrevious.Index + 1)\n    shtRpt.Name = Item\n    Range(\"G2\").Value = Item\n    Range(\"C3\").Value = Date\n    ThisWorkbook.Sheets(\"Template\").Visible = xlSheetVeryHidden\n\n    Rem Get Records from Master\n    LCopyToRow = 11\n    blItmFound = False\n    Do\n        If c.Value = 2516 _\n            And d.Value = \"37A\" _\n            And Not e.Value = \"T1\" _\n            And Not e.Value = \"T3\" Then\n\n            blItmFound = True\n            LCopyToCol = 1\n            shtRpt.Cells(LCopyToRow, LCopyToCol).EntireRow.Insert Shift:=xlDown\n            For x = LBound(arrColsToCopy) To UBound(arrColsToCopy)\n                shtRpt.Cells(LCopyToRow, LCopyToCol).Value = c.EntireRow.Cells(arrColsToCopy(x)).Value\n                LCopyToCol = LCopyToCol + 1\n            Next x\n            LCopyToRow = LCopyToRow + 1\n        End If\n\n        Set c = c.Offset(1, 0)\n        Set d = d.Offset(1, 0)\n        Set e = e.Offset(1, 0)\n\n    Loop Until c.Value = Empty\n\n    Rem Validate Records\n    Select Case blItmFound\n    Case True\n        ThisWorkbook.Worksheets(Item).Rows(\"10:10\").Delete\n        LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        If LastRow &lt;&gt; 0 Then\n            Rows(LastRow).EntireRow.Delete\n        End If\n\n    Case False\n        ThisWorkbook.Worksheets(Item).Range(\"G2\").Value = \"Item: [\" &amp; Item &amp; \"] code not located\"\n\n    End Select\n\n    Range(\"A9\").Select\n    Application.ScreenUpdating = True\n\nExit Sub\n\nErr_Execute:\n    MsgBox \"An error occurred.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 40353668, "answer_count": 2, "score": 0, "last_activity_date": 1477970295, "creation_date": 1477504185, "last_edit_date": 1477512538, "question_id": 40268964, "link": "https://stackoverflow.com/questions/40268964/modifying-existing-loop-when-no-instance-of-matched-criteria-is-present", "title": "Modifying existing loop when no instance of matched criteria is present", "body": "<p>I've included the base code that currently runs to essentially pull out info for a specific product category based on a larger master listing (approx. 4000 lines by 36 columns).  Previously this was not an issue, as the only codes listed and pulled out to individual sheets, were all is use; over time though, some of the older assigned product numbers are being discontinued and no longer in use.  All I'm trying to do is modify the existing structure so that it first does a sweep through the master listing to verify whether or not any lines match the c.Value and d.Value - if there are no lines that meet the matching c.Value and d.Value criteria then it should just perform the action in the If statement inside the loop (ie. delete the old sheet, make a new one, and populate \"G2\" with a generic \"item code not located\" value); if any lines are found that meet the c and d.value criteria then it goes through the normal process.</p>\n\n<pre><code>Option Explicit\n\nSub Item()\n    CreateDeptReport \"Item\"\nEnd Sub\n\n\nSub CreateDeptReport(Item As String)\n\n    Dim shtRpt As Excel.Worksheet, shtMaster As Excel.Worksheet, shtPrevious As Excel.Worksheet\n    Dim LCopyToRow As Long\n    Dim LCopyToCol As Long\n    Dim LastRow As Long\n    Dim arrColsToCopy\n    Dim c As Range, d As Range, e As Range, x As Integer\n\n    On Error GoTo Err_Execute\n\n    Application.ScreenUpdating = False\n\n    arrColsToCopy = Array(1, 8, 3, 7, 9, 10, 39, 19, 24, 25, 27, 29, 33, 34, 35)\n\n    Set shtMaster = ThisWorkbook.Sheets(\"CurrentMaster\")\n    Set shtPrevious = ThisWorkbook.Sheets(\"PreviousMaster\")\n    Set c = shtMaster.Range(\"AI5\")\n    Set d = shtMaster.Range(\"H5\")\n    Set e = shtMaster.Range(\"X5\")\n\n    LCopyToRow = 11\n\n    Do\n\n        If c.Value = 2516 And d.Value = \"37A\" And Not e.Value = \"T1\" And Not e.Value = \"T3\" Then\n\n            If shtRpt Is Nothing Then\n                On Error Resume Next\n                Application.DisplayAlerts = False\n                ThisWorkbook.Sheets(\"Item\").Delete\n                Application.DisplayAlerts = True\n                On Error GoTo 0\n                ThisWorkbook.Sheets(\"Template\").Visible = xlSheetVisible\n                ThisWorkbook.Sheets(\"Template\").Copy After:=shtPrevious\n                Set shtRpt = ThisWorkbook.Sheets(shtPrevious.Index + 1)\n                shtRpt.Name = Item\n                Range(\"G2\").Value = \"Item\"\n                Range(\"C3\").Value = Date\n                ThisWorkbook.Sheets(\"Template\").Visible = xlSheetVeryHidden\n            End If\n\n            LCopyToCol = 1\n\n            shtRpt.Cells(LCopyToRow, LCopyToCol).EntireRow.Insert Shift:=xlDown\n\n            For x = LBound(arrColsToCopy) To UBound(arrColsToCopy)\n\n            shtRpt.Cells(LCopyToRow, LCopyToCol).Value = c.EntireRow.Cells(arrColsToCopy(x)).Value\n\n            LCopyToCol = LCopyToCol + 1\n\n            Next x\n\n            LCopyToRow = LCopyToRow + 1\n        End If\n\n        Set c = c.Offset(1, 0)\n        Set d = d.Offset(1, 0)\n        Set e = e.Offset(1, 0)\n\n    Loop Until IsEmpty(c.Offset(0, -1))\n\n    ThisWorkbook.Worksheets(\"Item\").Rows(\"10:10\").Delete\n\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n        If LastRow &lt;&gt; 0 Then\n            Rows(LastRow).EntireRow.Delete\n        End If\n\n    Range(\"A9\").Select\n\n    Application.ScreenUpdating = True\n\n    Exit Sub\n\nErr_Execute:\n        MsgBox \"An error occurred.\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1477503708, "post_id": 40268771, "comment_id": 67797710, "body": "Can you post what your data looks like and what you have tried so far?"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 1, "creation_date": 1477503822, "post_id": 40268771, "comment_id": 67797783, "body": "If the cell containing a date is NOT formatted as a date there could be trouble, is the date always formatted properly?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1477504369, "post_id": 40268771, "comment_id": 67798099, "body": "How about testing each cell with <code>ISDATE</code> ?  (ref: <a href=\"https://www.techonthenet.com/excel/formulas/isdate.php\" rel=\"nofollow noreferrer\">TechOnTheNet</a>)"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1477505230, "post_id": 40268771, "comment_id": 67798539, "body": "@PeterT that&#39;s what I meant by there could be trouble, if the cell contains a date but is formatted as a number <code>ISDATE</code> returns false"}], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1477505470, "post_id": 40269323, "comment_id": 67798684, "body": "That looks like it will error because you have not initialized <code>DestCol</code>."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1477505581, "post_id": 40269323, "comment_id": 67798748, "body": "@Brian right-o! Thanks, Good catch, that&#39;s what I get for not testing the code."}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": false, "score": 1, "last_activity_date": 1477505558, "last_edit_date": 1477505558, "creation_date": 1477505336, "answer_id": 40269323, "question_id": 40268771, "link": "https://stackoverflow.com/questions/40268771/storing-dates-using-excel-vba/40269323#40269323", "title": "Storing dates using Excel VBA", "body": "<pre><code>Public Sub Answer()\n\nDim DestWS As Worksheet\nDim DestCol As Integer\nDim ColumnA As Variant\n\nSet DestWS = ThisWorkbook.Worksheets(\"Chart\")\nColumnA = ThisWorkbook.Worksheets(\"Data\").Columns(1)\n\nDestCol = 1\nFor Each c In ColumnA\n   If IsDate(c) Then\n      DestWS.Cells(1, DestCol) = c\n      DestCol = DestCol + 1\n   End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7076491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ff6fd62b0ac88511e433dcabac95f3?s=128&d=identicon&r=PG&f=1", "display_name": "BRox", "link": "https://stackoverflow.com/users/7076491/brox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477505558, "creation_date": 1477503556, "question_id": 40268771, "link": "https://stackoverflow.com/questions/40268771/storing-dates-using-excel-vba", "title": "Storing dates using Excel VBA", "body": "<p>I have a sheet called 'Data,' and in Column A of this sheet, there are various text values, blank values, and date values. I'm trying to find a way to copy each of the date values in Column A of 'Data' and paste it into the first row of another sheet 'Chart.' The end result I'm looking for is to create a chart with column headings for each of the dates. There's more to do with the chart that I've been piecing together little-by-little, but I'm pretty stuck on how to accomplish the column headings.</p>\n\n<p>The main piece I'm looking for is how to copy each of just the date values. I've looked a bit into the Find function, but I can't quite get it to hone in on only date values.</p>\n\n<p>Thank you so much for any help!</p>\n\n<p>Cheers,<br>\nB</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 2, "creation_date": 1477502688, "post_id": 40268377, "comment_id": 67797147, "body": "So you want to put the variable name in a variable?  ummm...  Maybe consider using an array of sheets.  Dim an variable as an array of variant, and set each index of the array to a sheet?  What&#39;s the point of that, though, if the sheets are already in an array (i.e. the workbook).  but you can loop through the sheets with a for each sh in sheets kind of thing.  Or, you can just use the codenames of the sheets as variables.  or create a dictionary, with the &quot;variable name&quot; as the key."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1477502864, "post_id": 40268377, "comment_id": 67797246, "body": "Please show us the declarations for these variables, it&#39;s hard to tell what you&#39;re trying to achieve with just bogus code and &quot;it doesn&#39;t work&quot;."}, {"owner": {"reputation": 348, "user_id": 7002050, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Gv7r0.jpg?s=128&g=1", "display_name": "gioxc88", "link": "https://stackoverflow.com/users/7002050/gioxc88"}, "edited": false, "score": 0, "creation_date": 1477552302, "post_id": 40268377, "comment_id": 67815377, "body": "Thank you for the answer. I admit I have not been very clear .. I am sorry for that. The point of doing this is to be able to use intellisense for every worksheet in the workbook. And since I can&#39;t loop through the sheets it very useful to me"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 7002050, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Gv7r0.jpg?s=128&g=1", "display_name": "gioxc88", "link": "https://stackoverflow.com/users/7002050/gioxc88"}, "edited": false, "score": 0, "creation_date": 1477552458, "post_id": 40269363, "comment_id": 67815467, "body": "thank you very much for the answer .. I am new to vba and I didn&#39;t know I could dim an array as worksheet"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1477527736, "last_edit_date": 1477527736, "creation_date": 1477505462, "answer_id": 40269363, "question_id": 40268377, "link": "https://stackoverflow.com/questions/40268377/loop-to-set-variables-as-worksheet/40269363#40269363", "title": "loop to set variables as worksheet", "body": "<p>You can use an array for this:</p>\n\n<pre><code>Dim n\nDim ws() as Worksheet\n\nn = 50\n\nRedim ws(1 to n)\n\nfor i = 1 to n\n    set ws(i) = thisworkbook.Sheets(i)\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 5529605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93f0b21f2cf6269f1c24a136492651c?s=128&d=identicon&r=PG&f=1", "display_name": "Poutnik", "link": "https://stackoverflow.com/users/5529605/poutnik"}, "is_accepted": true, "score": 1, "last_activity_date": 1509007827, "creation_date": 1509007827, "answer_id": 46949756, "question_id": 40268377, "link": "https://stackoverflow.com/questions/40268377/loop-to-set-variables-as-worksheet/46949756#46949756", "title": "loop to set variables as worksheet", "body": "<p>Or this way:</p>\n\n<pre><code>    Sub AssignWSobjectsToWorksheets()\n\n        Dim i As Integer, n As Integer\n        Dim ws() As Worksheet\n\n        n = ThisWorkbook.Worksheets.Count\n\n        ReDim ws(1 To n)\n\n        For i = 1 To n\n            Set ws(i) = ThisWorkbook.Worksheets(i)\n        Next\n    End Sub\n</code></pre>\n\n<p>Note that <strong>Sheets</strong> is the collection of all tabs(e.g. including charts), <strong>Worksheets</strong> just of spreadsheets</p>\n"}], "owner": {"reputation": 348, "user_id": 7002050, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Gv7r0.jpg?s=128&g=1", "display_name": "gioxc88", "link": "https://stackoverflow.com/users/7002050/gioxc88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 46949756, "answer_count": 2, "score": -2, "last_activity_date": 1509007827, "creation_date": 1477502115, "last_edit_date": 1531164843, "question_id": 40268377, "link": "https://stackoverflow.com/questions/40268377/loop-to-set-variables-as-worksheet", "title": "loop to set variables as worksheet", "body": "<p>Hello my problem is the following:\nI use to declare for example ws as worksheet and then set it to a specific worksheet. This way when I type the dot after ws I get suggestions for the methods that can be used.</p>\n\n<p>Now I have a workbook with a lot of worksheet and I would like to be able to set each one of them to a different worksheet.</p>\n\n<p>Do you think is it possible to achieve with a loop? thanks</p>\n\n<p>I tried something like \nEDIT </p>\n\n<pre><code>Dim x as Worksheet \nfor i=1 to 50\n    x = \"ws\" &amp; i\n    set x = thisworkbook.Sheets(i)\nNext\n</code></pre>\n\n<p>But it does't work\nThak you to everyone for your help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 1, "creation_date": 1477502140, "post_id": 40268024, "comment_id": 67796828, "body": "Thanks for replying but I&#39;m not sure if I understand how you&#39;re applying this, is this as a rule for a conditional formatting formula? Please see my edit - when I apply that it does not seem to work"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1477507155, "post_id": 40268024, "comment_id": 67799694, "body": "You&#39;ve forgot the equals"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1477509977, "post_id": 40268024, "comment_id": 67801174, "body": "what do you mean? I have the equals sign in the rule, where am I missing it?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1477553715, "post_id": 40268024, "comment_id": 67816294, "body": "you have =&quot;match....&quot; as in the cell value is the formula text, make it =MATCH w/o the quotes"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1477500795, "creation_date": 1477500795, "answer_id": 40268024, "question_id": 40267905, "link": "https://stackoverflow.com/questions/40267905/issue-with-excel-handling-conditional-formatting/40268024#40268024", "title": "Issue with Excel Handling Conditional Formatting", "body": "<p>Using test data in A1:B10, with banks in each, I used the following on column b</p>\n\n<p><code>=MATCH(B1,$A$1:$A$10,0)&gt;ROW(B1)</code>  ---> RED\n<code>=MATCH(B1,$A$1:$A$10,0)&lt;ROW(B1)</code>  ---> GREEN</p>\n\n<p><a href=\"https://i.stack.imgur.com/bug81.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/bug81.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 60, "user_id": 6534228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f781c968aa85b35d1432d0e0c0b0ec23?s=128&d=identicon&r=PG&f=1", "display_name": "KromeWing", "link": "https://stackoverflow.com/users/6534228/kromewing"}, "is_accepted": true, "score": 1, "last_activity_date": 1477511027, "creation_date": 1477511027, "answer_id": 40270911, "question_id": 40267905, "link": "https://stackoverflow.com/questions/40267905/issue-with-excel-handling-conditional-formatting/40270911#40270911", "title": "Issue with Excel Handling Conditional Formatting", "body": "<p>I tryed the Nathan_Sav's solution, but it didn't work because I inserted a header in each column (since you have a date as header). This happens because the match result is no longer aligned with the row index when you have headers.</p>\n\n<p>The solution I found (based on Nathan's solution) is to compare the match result of the previous column with the match result of the selected column. Would be something like this:</p>\n\n<p><code>=MATCH(B3,A$2:A$11,0)&lt;MATCH(B3,B$2:B$11,0)</code> for RED</p>\n\n<p><code>=MATCH(B3,A$2:A$11,0)&gt;MATCH(B3,B$2:B$11,0)</code> for GREEN</p>\n\n<p>And yes, this is a rule for conditional formatting formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1bDet.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/1bDet.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I tryed to comment on Nathan's answer, but I don't have reputation to do so...</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 40270911, "answer_count": 2, "score": 2, "last_activity_date": 1477511027, "creation_date": 1477500357, "last_edit_date": 1477502446, "question_id": 40267905, "link": "https://stackoverflow.com/questions/40267905/issue-with-excel-handling-conditional-formatting", "title": "Issue with Excel Handling Conditional Formatting", "body": "<p>I have a table which updates the rankings for global banks. It looks something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xSV3c.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/xSV3c.jpg\" alt=\"4 columns of data, each with a date header\"></a></p>\n\n<p>Each day it updates the rankings and shows the last four weeks. </p>\n\n<p>I want to use conditional formatting so that if a bank moves up in the rankings from one week to the next, it's highlighted in Green, and if it moves down, it's highlighted in Red. </p>\n\n<p>So for instance RBC during 10/19/2016 would be highlighted in Red, and during 10/26/2016 it would be highlighted in Green. </p>\n\n<p>This is problematic to apply with conditional formatting because the positions of the conditional cells aren't fixed and will move around as the rankings change. For instance if I'd written something like F24 &lt; G24 as my conditional rule, it would be comparing RBC's ranking with CIBC's ranking rather than last week's RBC ranking. I need to use relative references here and overlapping formulas and I don't see a way to do that with conditional formatting rules available. </p>\n\n<p>I think I could wrap the formulas in an IF statement to get around this, but I don't think there's a way to apply conditional formatting to an IF statement. How can I conditionally format the way that I need to?   </p>\n\n<p><a href=\"https://i.stack.imgur.com/HoJAN.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/HoJAN.jpg\" alt=\"conditional formatting rule highlights $B1:$B10 in bright green\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 867, "user_id": 2622984, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZPf9s.jpg?s=128&g=1", "display_name": "Ambulare", "link": "https://stackoverflow.com/users/2622984/ambulare"}, "edited": false, "score": 0, "creation_date": 1477500701, "post_id": 40267902, "comment_id": 67796127, "body": "Have you checked your final strSQL to find out if it&#39;s valid SQL? For example, I&#39;m wondering if your criteria1, 2, 3 etc will end up as a string starting with a comma, since the first loop will concatenate a comma to an empty variable."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1477505961, "post_id": 40267902, "comment_id": 67798973, "body": "Are all of your criteria fields numerical?"}, {"owner": {"reputation": 39, "user_id": 1301250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7187192a28578a52697dca597e53e6ea?s=128&d=identicon&r=PG", "display_name": "lPaclMan", "link": "https://stackoverflow.com/users/1301250/lpaclman"}, "edited": false, "score": 0, "creation_date": 1477512389, "post_id": 40267902, "comment_id": 67802411, "body": "All criteria is setup as Short Text."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1477646709, "post_id": 40267902, "comment_id": 67861345, "body": "Paste <code>strSQL</code> into a new query in SQL view. Try to switch to datasheet view. Access will point out the problematic part of the SQL. <a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 1301250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7187192a28578a52697dca597e53e6ea?s=128&d=identicon&r=PG", "display_name": "lPaclMan", "link": "https://stackoverflow.com/users/1301250/lpaclman"}, "edited": false, "score": 0, "creation_date": 1477590995, "post_id": 40279855, "comment_id": 67840758, "body": "I made the suggested edits but the runtime error I&#39;m getting is still the same. I have a feeling that the strSQL is not properly formatted but with my lack of experience with it, I am not sure how to know what is wrong.   <code>Run-time error &#39;3075&#39;: Syntax Error (missing operator) in query expression &#39;Supervisors.SupervisorFrom ((Treammates INNER JOIN warehouseMetrics ON Teammates.[User ID] = warehouseMetrics.[User ID]) INNER JOIN Supervisors ON Teammates.Supervisors.Supervisor) IINER JOIN JobDescriptions ON warehouseMetrics.[Job Code Description] = JobDescriptions.[Job Code Description] Where</code>"}, {"owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "reply_to_user": {"reputation": 39, "user_id": 1301250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7187192a28578a52697dca597e53e6ea?s=128&d=identicon&r=PG", "display_name": "lPaclMan", "link": "https://stackoverflow.com/users/1301250/lpaclman"}, "edited": false, "score": 0, "creation_date": 1477644493, "post_id": 40279855, "comment_id": 67860204, "body": "I&#39;ve edited my original answer, there are a number of issues with your SQL statement that I didn&#39;t notice originally - you have carried your query over to the next line without a space between the words, which is why you&#39;re getting &#39;Supervisors.SupervisorFrom&#39;. Can you try again with the edited code?"}], "tags": [], "owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "is_accepted": false, "score": 0, "last_activity_date": 1477644359, "last_edit_date": 1477644359, "creation_date": 1477557286, "answer_id": 40279855, "question_id": 40267902, "link": "https://stackoverflow.com/questions/40267902/multiple-multi-select-list-boxes-vba-sql-query/40279855#40279855", "title": "Multiple Multi Select list boxes VBA/ SQL Query", "body": "<p>The Criteria variables need to be wrapped with single quotes if they are of a text datatype. Since you're looping through multiple items and using an IN statement in the SQL for each Criteria, you probably need to add these in the for loops:</p>\n\n<pre><code>For Each itm In Me!lstSupervisor.ItemsSelected\n    Criteria1 = Criteria1 &amp; \", '\" &amp; &amp; Me!lstSupervisor.ItemData(itm) &amp; \"'\"\nNext itm\n\nFor Each itm In Me!lstClient.ItemsSelected\n    Criteria2 = Criteria2 &amp; \", '\" &amp; Me!lstClient.ItemData(itm) &amp; \"'\"\nNext itm\n\nFor Each itm In Me!lstTeammates.ItemsSelected\n    Criteria3 = Criteria3 &amp; \", '\" &amp; Me!lstTeammates.ItemData(itm) &amp; \"'\"\nNext itm\n\nFor Each itm In Me!lstJobs.ItemsSelected\n    Criteria4 = Criteria4 &amp; \", '\" &amp; Me!lstJobs.ItemData(itm) &amp; \"'\"\nNext itm\n</code></pre>\n\n<p>There are also several issues with the spacing of your SQL statement:</p>\n\n<pre><code>strSQL = \"SELECT warehouseMetrics.Date, warehouseMetrics.Client, Teammates.[User ID], \" &amp; _\n\"JobDescriptions.[Job Code Description], warehouseMetrics.[Perf Percent],   Supervisors.Supervisor \" &amp; _\n\"FROM ((Teammates INNER JOIN warehouseMetrics ON Teammates.[User ID] = warehouseMetrics.[User ID]) \" &amp; _\n\"INNER JOIN Supervisors ON Teammates.Supervisor = Supervisors.Supervisor) INNER JOIN \" &amp; _\n\"JobDescriptions ON warehouseMetrics.[Job Code Description] = JobDescriptions.[Job Code Description] \" &amp; _\n\"WHERE warehouseMetrics.Client IN (\" &amp; Criteria2 &amp; \") \" &amp; _\n\"Supervisors.Supervisor IN (\" &amp; Criteria1 &amp; \") \" &amp; _\n\"Teammates.[User ID] IN (\" &amp; Criteria3 &amp; \") \" &amp; _\n\"JobDescriptions.[Job Code Description] IN (\" &amp; Criteria4 &amp; \");\"`\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 1301250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7187192a28578a52697dca597e53e6ea?s=128&d=identicon&r=PG", "display_name": "lPaclMan", "link": "https://stackoverflow.com/users/1301250/lpaclman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593984227, "creation_date": 1477500345, "last_edit_date": 1593984227, "question_id": 40267902, "link": "https://stackoverflow.com/questions/40267902/multiple-multi-select-list-boxes-vba-sql-query", "title": "Multiple Multi Select list boxes VBA/ SQL Query", "body": "<p>I think I am almost there with this project but I need some help with the SQL part of my code. I have limited experience with the SQL part and need some help with the syntax as I am getting 'Run-Time error 3075 Syntax error missing operator in query expression'. And if I am incoorporating the SQL correctly with the Query SQL. The SQL from the query table is.</p>\n\n<pre><code>SELECT warehouseMetrics.Date, warehouseMetrics.Client, Teammates.[User ID], JobDescriptions.[Job Code Description], warehouseMetrics.[Perf Percent],     Supervisors.Supervisor\nFROM ((Teammates INNER JOIN warehouseMetrics ON Teammates.[User ID] = warehouseMetrics.[User ID]) INNER JOIN Supervisors ON Teammates.Supervisor =     Supervisors.Supervisor) INNER JOIN JobDescriptions ON warehouseMetrics.[Job Code     Description] = JobDescriptions.[Job Code Description]\nWHERE (((warehouseMetrics.Date) Between [Forms]![MasterForm]![txtBeginDate] And [Forms]![MasterForm]![txtEndDate]))\nORDER BY warehouseMetrics.Date;\n</code></pre>\n\n<p>And the code that runs the query is...</p>\n\n<pre><code>Dim Q As QueryDef, DB As Database\n\nDim Criteria1 As String\nDim Criteria2 As String\nDim Criteria3 As String\nDim Criteria4 As String\nDim itm As Variant\nDim strSQL As String\n\nSet DB = CurrentDb()\nSet QueryDef = DB.QueryDefs(\"MasterReportQuery\")\n\nFor Each itm In Me!lstSupervisor.ItemsSelected\n    Criteria1 = Criteria1 &amp; \",\" &amp; Me!lstSupervisor.ItemData(itm) &amp; \"\"\nNext itm\n\nFor Each itm In Me!lstClient.ItemsSelected\n    Criteria2 = Criteria2 &amp; \",\" &amp; Me!lstClient.ItemData(itm) &amp; \"\"\nNext itm\n\nFor Each itm In Me!lstTeammates.ItemsSelected\n    Criteria3 = Criteria3 &amp; \",\" &amp; Me!lstTeammates.ItemData(itm) &amp; \"\"\nNext itm\n\nFor Each itm In Me!lstJobs.ItemsSelected\n    Criteria4 = Criteria4 &amp; \",\" &amp; Me!lstJobs.ItemData(itm) &amp; \"\"\nNext itm\n\nIf Len(Criteria1) = 0 Or Len(Criteria2) = 0 Or Len(Criteria3) = 0 Or Len(Criteria4) = 0 Then\nMsgBox \"You did not select anything\"\nExit Sub\nEnd If\n\nCriteria1 = Right(Criteria1, Len(Criteria1) - 1)\nCriteria2 = Right(Criteria2, Len(Criteria2) - 1)\nCriteria3 = Right(Criteria3, Len(Criteria3) - 1)\nCirteria4 = Right(Criteria4, Len(Criteria4) - 1)\n\nMsgBox (Criteria1)\nMsgBox (Criteria2)\nMsgBox (Criteria3)\nMsgBox (Criteria4)\n\nstrSQL = \"SELECT warehouseMetrics.Date, warehouseMetrics.Client, Teammates.  [User ID],\" &amp; _\n\"JobDescriptions.[Job Code Description], warehouseMetrics.[Perf Percent],   Supervisors.Supervisor\" &amp; _\n\"FROM ((Teammates INNER JOIN warehouseMetrics ON Teammates.[User ID] = warehouseMetrics.[User ID])\" &amp; _\n\"INNER JOIN Supervisors ON Teammates.Supervisor = Supervisors.Supervisor) INNER JOIN\" &amp; _\n\"JobDescriptions ON warehouseMetrics.[Job Code Description] = JobDescriptions.[Job Code Description]\" &amp; _\n\"WHERE warehouseMetrics.Client IN (\" &amp; Criteria2 &amp; \")\" &amp; _\n\"Supervisors.Supervisor IN (\" &amp; Criteria1 &amp; \")\" &amp; _\n\"Teammates.[User ID] IN (\" &amp; Criteria3 &amp; \")\" &amp; _\n\"JobDescriptions.[Job Code Description] IN (\" &amp; Criteria4 &amp; \");\"\n\nQueryDef.SQL = strSQL\nDoCmd.OpenQuery \"MasterReportQuery\"\nSet DB = Nothing\nSet QueryDef = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1477499988, "post_id": 40267639, "comment_id": 67795715, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid using <code>.Select</code></a>, that should help.  Also, if the code works but you just need tweaking, this may be better suited for <a href=\"http://codereview.stackexchange.com/\">CodeReview</a>.  Another idea is to sort the table (assuming it&#39;s a table) by the column where you have the values to check, then just check that range?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1477499989, "post_id": 40267639, "comment_id": 67795716, "body": "since it&#39;s a working code, then post it to <a href=\"http://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1477503208, "post_id": 40267639, "comment_id": 67797423, "body": "And turn off screen updating while it&#39;s running."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1477500478, "last_edit_date": 1477500478, "creation_date": 1477500070, "answer_id": 40267812, "question_id": 40267639, "link": "https://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a/40267812#40267812", "title": "I need a faster excel vba macro that deletes every row with a 0 in Column A", "body": "<p>Perhaps using something like this</p>\n\n<pre><code> Sub DeleteZeroRows()\n\n    Dim a() As Variant\n    Dim l As Long\n\n    a = Range(\"a1:a300000\").Value\n\n    For l = UBound(a) To 1 Step -1\n       If a(l, 1) = 0 Then\n          Debug.Print \"Row \" &amp; l &amp; \" delete\"\n          Rows(l).EntireRow.Delete\n      End If\n   Next l\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477500472, "post_id": 40267900, "comment_id": 67796009, "body": "This code should be okay with 2k rows, I would not do 300k rows at once, maybe break up into chunks of 2k rows?"}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": false, "score": 1, "last_activity_date": 1477500344, "creation_date": 1477500344, "answer_id": 40267900, "question_id": 40267639, "link": "https://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a/40267900#40267900", "title": "I need a faster excel vba macro that deletes every row with a 0 in Column A", "body": "<p>Don't read 1-by-1. Delete all at once.  </p>\n\n<pre><code>Sub Loop_Example()\n    Dim Firstrow As Long\n    Dim Lastrow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n    Dim Data As Variant\n    Dim DelRange As Range\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n    End With\n\n    'We use the ActiveSheet but you can replace this with\n    'Sheets(\"MySheet\")if you want\n    With ActiveSheet\n\n        'We select the sheet so we can change the window view\n        .Select\n\n        'If you are in Page Break Preview Or Page Layout view go\n        'back to normal view, we do this for speed\n        ViewMode = ActiveWindow.View\n        ActiveWindow.View = xlNormalView\n\n        'Turn off Page Breaks, we do this for speed\n        .DisplayPageBreaks = False\n\n        'Set the first and last row to loop through\n        Firstrow = .UsedRange.Cells(1).Row\n        Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n        Data = .Range(\"A1:A\" &amp; Lastrow)\n\n        'We loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n\n            If Not IsError(Data(Lrow, 1)) And Not IsEmpty(Data(Lrow, 1)) Then\n               If Data(Lrow, 1) = 0 Then\n                  If DelRange Is Nothing Then\n                     Set DelRange = .Rows(Lrow)\n                  Else\n                     Set DelRange = Union(DelRange, .Rows(Lrow))\n                  End If\n               End If\n            End If\n\n        Next Lrow\n\n        DelRange.Delete\n\n    End With\n\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1477508305, "creation_date": 1477508305, "answer_id": 40270159, "question_id": 40267639, "link": "https://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a/40270159#40270159", "title": "I need a faster excel vba macro that deletes every row with a 0 in Column A", "body": "<p>If the data does not contain any formulae then refactoring could shave maybe 10 to 15 seconds off the execution time.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cXUoX.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/cXUoX.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code>Sub DeleteRows()\n    Const PageSize As Long = 20000\n    Dim rw As Range\n    Dim Data\n    Dim lStart As Long, lEnd As Long, lNextRow As Long\n    Dim list As Object: Set list = CreateObject(\"System.Collections.ArrayList\")\n\n    ToggleEvents False\n    MonitorTimes True\n\n    With Worksheets(\"Sheet1\").UsedRange\n        For Each rw In .Rows\n            If Not IsError(rw.Cells(1).Value) Then\n                If rw.Cells(1).Value &lt;&gt; 0 Then list.Add rw.Formula\n            End If\n        Next\n\n        MonitorTimes\n\n        .Cells.ClearContents\n        For lStart = 0 To list.Count Step PageSize\n            lEnd = IIf(lStart + PageSize - 1 &lt;= list.Count, PageSize, list.Count - lStart)\n            Data = Application.Transpose(list.GetRange(lStart, lEnd).ToArray)\n            Data = Application.Transpose(Data)\n            With .Range(\"A1\").Offset(lNextRow)\n                .Resize(UBound(Data, 1), UBound(Data, 2)).Value = Data\n                lNextRow = lNextRow + PageSize\n            End With\n        Next\n    End With\n\n    MonitorTimes\n\n    ToggleEvents True\nEnd Sub\n\nStatic Sub ToggleEvents(EnableEvents As Boolean)\n    Dim CalcMode As Long\n    If EnableEvents Then\n        With Application\n            CalcMode = .Calculation\n            .Calculation = xlCalculationManual\n            .ScreenUpdating = False\n        End With\n    Else\n        With Application\n            .ScreenUpdating = True\n            .Calculation = CalcMode\n        End With\n    End If\nEnd Sub\n\nStatic Sub MonitorTimes(Optional ResetVariables As Boolean)\n    Dim tLoad, Start\n    Dim RowCount As Long, ColumnCount As Long\n\n    If ResetVariables Then\n        Start = 0\n        tLoad = 0\n    End If\n\n    With Worksheets(\"Sheet1\")\n        If Start = 0 Then\n            Start = Timer\n            Debug.Print \"Before: \"; \"Rows-&gt;\"; WorksheetFunction.CountA(.Columns(1)); \"Columns-&gt;\"; WorksheetFunction.CountA(.Rows(1))\n        ElseIf tLoad = 0 Then\n            tLoad = Timer - Start\n        Else\n            Debug.Print \"After: \"; \"Rows-&gt;\"; WorksheetFunction.CountA(.Columns(1)); \"Columns-&gt;\"; WorksheetFunction.CountA(.Rows(1))\n            Debug.Print \"Load Time in Second(s): \"; tLoad\n            Debug.Print \"Write Time in Second(s): \"; Timer - Start - tLoad\n            Debug.Print \"Execution Time in Second(s): \"; Timer - Start\n        End If\n    End With\n\nEnd Sub\n\nSub RestoreTestData()\n    Worksheets(\"Original\").Cells.Copy Worksheets(\"Sheet1\").Cells\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477521282, "post_id": 40272934, "comment_id": 67806189, "body": "@mjcox13 fastest is sorting the values so that the rows are in one area that can be deleted all at once. This should be the second fastest if sorting is not an option, but I wouldn&#39;t use CountA to find the last row <a href=\"https://stackoverflow.com/documentation/excel-vba/918/methods-for-finding-the-last-used-row-or-column-in-a-worksheet\">stackoverflow.com/documentation/excel-vba/918/&hellip;</a>. Compromise between the two can be with a helper function that can be sorted by in a way that preserves the order of the rest of the rows and delete the area with all of the rows at once (preferably towards the end of the sheet)"}], "tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": false, "score": 2, "last_activity_date": 1477520600, "last_edit_date": 1477520600, "creation_date": 1477519875, "answer_id": 40272934, "question_id": 40267639, "link": "https://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a/40272934#40272934", "title": "I need a faster excel vba macro that deletes every row with a 0 in Column A", "body": "<p>I can't comment on whether this is the fastest way but it's probably the shortest in terms of actual code that you'll find on these answers:</p>\n\n<pre><code>'get number of cells in A column\nDim x as long: x = WorksheetFunction.CountA(ActiveSheet.Range(\"A:A\"))\n'AutoFilter to pick up only zeroes\nActiveSheet.Range(\"$A$1:$Z\" &amp; x).AutoFilter Field:=1, Criteria1:=0\n'delete what is currently filtered\nActiveSheet.Rows(\"2:\" &amp; x).Delete Shift:= xlUp\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$Z\" &amp; x).AutoFilter\n</code></pre>\n\n<p>-adding this on the end turns the autofilter off afterwards</p>\n\n<p>The autofilter here is sorting by column A (Field 1 in A:Z) and looking for zeroes (Criteria:= 0) - might need adapting slightly for your purposes but it's simple enough</p>\n\n<p>note: This does take a while with 300,000 + rows - I have a routine which takes out about 200,000 + rows out of a data set like this on a bi-weekly basis. Which probably sounds mad, except I'm only using that data to summarise it in a Pivot Table - once that's been refreshed, most of the data can go.</p>\n"}], "owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1477520600, "creation_date": 1477499525, "last_edit_date": 1477499816, "question_id": 40267639, "link": "https://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a", "title": "I need a faster excel vba macro that deletes every row with a 0 in Column A", "body": "<p>Right now, I'm using the macro below to delete every row with a 0 in column A. The problem is that it is too slow. It took about thirty seconds to do the job for two thousand rows, but I need a macro to work on 300,000 rows. The current macro freezes my computer with that many rows. I've tried the first five solutions on this site with no luck: <a href=\"http://www.dummies.com/software/microsoft-office/excel/10-ways-to-speed-up-your-macros/\" rel=\"nofollow\">http://www.dummies.com/software/microsoft-office/excel/10-ways-to-speed-up-your-macros/</a></p>\n\n<pre><code>Sub Loop_Example()\n    Dim Firstrow As Long\n    Dim Lastrow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n    End With\n\n    'We use the ActiveSheet but you can replace this with\n    'Sheets(\"MySheet\")if you want\n    With ActiveSheet\n\n        'We select the sheet so we can change the window view\n        .Select\n\n        'If you are in Page Break Preview Or Page Layout view go\n        'back to normal view, we do this for speed\n        ViewMode = ActiveWindow.View\n        ActiveWindow.View = xlNormalView\n\n        'Turn off Page Breaks, we do this for speed\n        .DisplayPageBreaks = False\n\n        'Set the first and last row to loop through\n        Firstrow = .UsedRange.Cells(1).Row\n        Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n        'We loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n\n            'We check the values in the A column in this example\n            With .Cells(Lrow, \"A\")\n\n                If Not IsError(.Value) Then\n\n                    If .Value = \"0\" Then .EntireRow.Delete\n                    'This will delete each row with the Value \"ron\"\n                    'in Column A, case sensitive.\n\n                End If\n\n            End With\n\n        Next Lrow\n\n    End With\n\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sum"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1477499656, "post_id": 40267600, "comment_id": 67795510, "body": "What&#39;s your actual problem?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1477500523, "post_id": 40267600, "comment_id": 67796036, "body": "You can&#39;t change <code>CheckTotal</code> in the <code>CheckTotal_Change</code> handler; doing so will cause it to change again, which fires the event again, which causes it to change again, which fires the event again, etc. Common sense should tell you that won&#39;t work, right?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1477584256, "post_id": 40267920, "comment_id": 67836873, "body": "Hi, thanks for your kind input, for some reasons the code works with no error, but the label just shows nothing, is there something I need to turn on for the label to update in real time? I tried to make a simple statement like this: if one textbox.value is &lt;&gt; 0 then label.caption = &quot;Y&quot; Else &quot;N&quot;, but not a single change."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1477587167, "post_id": 40267920, "comment_id": 67838642, "body": "which sub did you put that code in? What&#39;s the name of the label?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1477500400, "creation_date": 1477500400, "answer_id": 40267920, "question_id": 40267600, "link": "https://stackoverflow.com/questions/40267600/would-like-to-textbox-to-show-message-when-cell-values-are-unequal/40267920#40267920", "title": "Would like to textbox to show message when cell values are unequal", "body": "<p>since you only need to notify the user, use a <code>Label</code> control instead of a <code>TextBox</code> one (you can keep naming it after <code>CheckTotal</code>), so that you don't even need to disable it (a user can't edit a label control)</p>\n\n<p>then write:</p>\n\n<pre><code>If (CDbl(MCash.Text) + CDbl(PCash.Text)) - (CDbl(Cash.Text) + CDbl(CCash.Text)) - (CDbl(SubTypeCash1.Text) + CDbl(SubTypeCash2.Text) + CDbl(SubtypeCash3.Text)) = 0 Then\n    CheckTotal.Caption = \"Match!\"\nElse\n    CheckTotal.Caption = \"NOT Match!\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477672939, "creation_date": 1477499382, "last_edit_date": 1477672939, "question_id": 40267600, "link": "https://stackoverflow.com/questions/40267600/would-like-to-textbox-to-show-message-when-cell-values-are-unequal", "title": "Would like to textbox to show message when cell values are unequal", "body": "<p>I am working on an userform and user needs to enter the same amount but in  different breakdowns for three times. I would like to create a textbox that can alert user in realtime if the amount is equal in those three areas.</p>\n\n<p>My simple logic and code is stated below:</p>\n\n<p>Sum of 1st breakdown - Sum of 2nd breakdown - Sum of 3rd breakdown = 0 means true.</p>\n\n<p>Got it work finally!</p>\n\n<pre><code>Private Sub CheckSum1()\n\n'Sum of 1st - 3rd breakdown\nOn Error Resume Next\nMe.CCTotal = (IIf(Me.Cash.Value = vbNullString, 0, Me.Cash) + 0) + (IIf(Me.CCash.Value = vbNullString, 0, Me.CCash) + 0) - (IIf(Me.TotalBox1 = vbNullString, 0, Me.TotalBox1) + 0)\n\nEnd Sub\n\nPrivate Sub CheckSum()\n\n'Sum 2nd break down - 3rd breakdown\nOn Error Resume Next\nMe.Test = (IIf(Me.MCash.Value = vbNullString, 0, Me.MCash) + 0) + (IIf(Me.PCash.Value = vbNullString, 0, Me.PCash) + 0) - (IIf(Me.TotalBox1 = vbNullString, 0, Me.TotalBox1) + 0)\n\nEnd Sub\n\n\nPrivate Sub CheckTotal_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n'Use a label to check if both are 0\nIf (IIf(Me.Test.Value = vbNullString, 0, Me.Test) + 0) And (IIf(Me.CCTotal.Value = vbNullString, 0, Me.CCTotal) + 0) &lt;&gt; 0 Then\nCheckTotal.Caption = \"Match\"\nFinish.Enabled = False\nElse\n    CheckTotal.Caption = \"Unmatch\"\n    Finish.Enabled = True\n    End If\n\n End Sub\n\nPrivate Sub CCtotal_Change()\n\nCall CheckSum\nCall CheckSum1\n\nEnd Sub\n\nPrivate Sub TotalBox1_Change()\n\nCall CheckSum\nCall CheckSum1\n\nEnd Sub     \n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477520354, "post_id": 40267587, "comment_id": 67805857, "body": "What are you searching? String on Attachment Name or inside the attachment file?"}, {"owner": {"reputation": 11, "user_id": 7066428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03874d4528996443aa4d87d3b1b40d40?s=128&d=identicon&r=PG&f=1", "display_name": "ehenryindy", "link": "https://stackoverflow.com/users/7066428/ehenryindy"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477570083, "post_id": 40267587, "comment_id": 67826648, "body": "Inside the attacment file"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477599348, "post_id": 40267587, "comment_id": 67845329, "body": "in order to search inside attachment, you will have to save it first, what type files are they? spreadsheet? word?"}, {"owner": {"reputation": 11, "user_id": 7066428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03874d4528996443aa4d87d3b1b40d40?s=128&d=identicon&r=PG&f=1", "display_name": "ehenryindy", "link": "https://stackoverflow.com/users/7066428/ehenryindy"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477622051, "post_id": 40267587, "comment_id": 67852430, "body": "OK. I&#39;m now writing it to run a different process for xls, pdf, and doc files. I&#39;ll post that code when I&#39;m done since that may be the best answer. If anyone else has insight though i&#39;d appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7066428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03874d4528996443aa4d87d3b1b40d40?s=128&d=identicon&r=PG&f=1", "display_name": "ehenryindy", "link": "https://stackoverflow.com/users/7066428/ehenryindy"}, "is_accepted": true, "score": 0, "last_activity_date": 1477688555, "creation_date": 1477688555, "answer_id": 40313174, "question_id": 40267587, "link": "https://stackoverflow.com/questions/40267587/excel-vba-for-searching-string-within-an-outlook-attachment-flagging-email-if-m/40313174#40313174", "title": "Excel VBA for searching String within an Outlook Attachment, flagging email if match is found", "body": "<p>Here's a solution if you only need to search the contents PDFs, MSWord, and Excel. There's a different procedure for each. A caveat is that you need to have a version of Adobe that you pay for. This won't work on plain Adobe Reader. I've tested it a few times and it works, but it seems kind of chunky in some parts so I'm open to suggestions.</p>\n\n<pre><code>            Sub attachsearch()\n            Dim ns As Namespace\n            Dim inbox As MAPIFolder\n            Dim subfolder As MAPIFolder\n            Dim item As Object\n            Dim atmt As Attachment\n            Dim tempfilepath As String\n            Dim tempfilename As String\n            Dim i As Integer\n            Dim workbk As Workbook\n            Dim LastRow As Long\n            Dim TextToFind  As String\n            Dim Loc As Range\n            Dim Sh As Worksheet\n            Dim WS_Count As Integer\n            Dim x As Integer\n            Dim WS_Name As String\n\n            Set ns = GetNamespace(\"MAPI\")\n            Set inbox = ns.GetDefaultFolder(olFolderInbox)\n            Set subfolder = inbox.Folders(\"test\")\n            Set workbk = Workbooks.Open(\"C:\\Users\\John.Doe\\Desktop\\10 25 2016 Pricing Team Macro.xlsx\")\n            LastRow = Workbooks(\"10 25 2016 Pricing Team Macro\").Worksheets(\"NDC Sort\").Cells(Worksheets(\"NDC Sort\").Rows.Count, \"A\").End(xlUp).Row\n            i = 0\n            If subfolder.Items.Count = 0 Then\n            MsgBox \"There are no emails to look at. Please stop wasting my time.\", vbInformation, \"Folder is Empty\"\n            Exit Sub\n            End If\n\n            For Each item In subfolder.Items\n            For Each atmt In item.Attachments\n            If item.FlagStatus = Empty Then\n                If Right(atmt.Filename, 4) Like \"xl**\" Or Right(atmt.Filename, 3) Like \"xl*\" Then\n                    tempfilepath = \"O:\\aaaTEST\\\"\n                    tempfilename = Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilepath &amp; tempfilename\n                    Workbooks.Open (tempfilepath &amp; tempfilename)\n                    Workbooks(tempfilename).Activate\n                    WS_Count = Workbooks(tempfilename).Worksheets.Count\n                    'Clearing any selections that may limit the search unintentionally\n                    For x = 1 To WS_Count\n                    With ActiveWorkbook.Worksheets(x)\n                    .Select\n                    .Cells(1, 1).Select\n                    Application.CutCopyMode = False\n                    End With\n                    Next x\n                For rwindex = 2 To LastRow\n                    If item.FlagStatus = Empty Then\n                    TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                        If TextToFind &lt;&gt; \"\" Then\n                            Workbooks(tempfilename).Activate\n                            For x = 1 To WS_Count\n                            With ActiveWorkbook.Worksheets(x)\n                                    .Select\n                                    .UsedRange.Select\n                                   Set Loc = .Cells.Find(TextToFind)\n                            If item.FlagStatus = Empty Then\n                                If Not Loc Is Nothing Then\n                                 i = i + 1\n                                 With item\n                                .FlagRequest = \"Follow up\"\n                                .Save\n                                End With\n                                End If\n                            End If\n                            Set Loc = Nothing\n                            End With\n                            Next x\n                        End If\n                     End If\n                     Next rwindex\n                     Workbooks(tempfilename).Close Savechanges:=False\n                End If\n\n            'PDF Check\n                If Right(atmt.Filename, 3) = \"pdf\" Then\n                    tempfilename = \"O:\\aaaTEST\\\" &amp; _\n                    Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilename\n                    PDFPath = tempfilename\n\n                Set App = CreateObject(\"AcroExch.App\", \"\")\n\n                Set AVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n                        If AVDoc.Open(PDFPath, \"\") = True Then\n                          AVDoc.BringToFront\n                          For rwindex = 2 To 3593\n                            If item.FlagStatus = Empty Then\n                            TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                                If AVDoc.FindText(TextToFind, False, True, False) = True Then\n                                i = i + 1\n                                With item\n                                .FlagRequest = \"Follow up\"\n                                .Save\n                                End With\n                                End If\n                            AVDoc.Close True\n                            App.Exit\n                            End If\n                        Next rwindex\n                        End If\n                End If\n\n                'MSWord check\n                If Right(atmt.Filename, 4) Like \"doc*\" Or Right(atmt.Filename, 3) Like \"doc\" Then\n                    tempfilepath = \"O:\\aaaTEST\\\"\n                    tempfilename = Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilepath &amp; tempfilename\n                    Set wordapp = CreateObject(\"word.Application\")\n                    wordapp.Documents.Open Filename:=tempfilepath &amp; tempfilename\n                    wordapp.Visible = True\n                    For rwindex = 2 To 5\n                        If item.FlagStatus = Empty Then\n                        TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                            If TextToFind &lt;&gt; \"\" Then\n                                With wordapp.ActiveDocument.Content.Find\n                                .ClearFormatting\n                                .Execute FindText:=TextToFind\n                                If .Found = True Then\n                                    i = i + 1\n                                    With item\n                                        .FlagRequest = \"Follow up\"\n                                        .Save\n                                    End With\n                                End If\n                                End With\n                            End If\n                        End If\n                    Next rwindex\n                wordapp.ActiveDocument.Close Savechanges:=wdDoNotSaveChanges\n                wordapp.Quit Savechanges:=wdDoNotSaveChanges\n                End If\n            End If\n            Next atmt\n            Next item\n            Workbooks(\"10 25 2016 Pricing Team Macro\").Close Savechanges:=False\n\n            If i &gt; 0 Then\n            MsgBox \"I found \" &amp; i &amp; \" attached files with a specific name.\"\n            Else\n            MsgBox \"I didn't find any files\"\n            End If\n            Set atmt = Nothing\n            Set item = Nothing\n            Set ns = Nothing\n            Exit Sub\n\n            End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7066428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03874d4528996443aa4d87d3b1b40d40?s=128&d=identicon&r=PG&f=1", "display_name": "ehenryindy", "link": "https://stackoverflow.com/users/7066428/ehenryindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2175, "favorite_count": 2, "accepted_answer_id": 40313174, "answer_count": 1, "score": 1, "last_activity_date": 1477688555, "creation_date": 1477499342, "last_edit_date": 1477574947, "question_id": 40267587, "link": "https://stackoverflow.com/questions/40267587/excel-vba-for-searching-string-within-an-outlook-attachment-flagging-email-if-m", "title": "Excel VBA for searching String within an Outlook Attachment, flagging email if match is found", "body": "<p>Basically I have a list of 5000 strings populated in an Excel spreadsheet. I want VBA to go through the attachments in an Outlook Inbox and if it finds a string match, I want the particular email to be flagged. Here's the code I have so far</p>\n\n<pre><code>Sub attachsearch()\nOn Error GoTo bigerror\nDim ns As Namespace\nDim inbox As MAPIFolder\nDim subfolder As MAPIFolder\nDim item As Object\nDim atmt As Attachment\nDim filename As String\nDim i As Integer\nDim varresponse As VbMsgBoxResult\nDim workbk As Workbook\nDim SearchString As String\nSet ns = GetNamespace(\"MAPI\")\nSet inbox = ns.GetDefaultFolder(olFolderInbox)\nSet subfolder = inbox.Folders(\"test\")\nSet workbk = Workbooks.Open(\"C:\\Users\\John.Doe\\Desktop\\10 25 2016 Pricing Team Macro.xlsm\")\ni = 0\nIf subfolder.Items.Count = 0 Then\nMsgBox \"There are no emails to look at. Please stop wasting my time.\", vbInformation, \"Folder is Empty\"\nExit Sub\nEnd If\nFor Each item In subfolder.Items\nFor Each atmt In item.Attachments\nFor rwindex = 1 To 5000\nSearchString = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n</code></pre>\n\n<p>Below is the problem code, index proberty is not used correctly here, but I'm unsure what to use. I know that Microsoft indexes the words within the attachment because when I manually type in the search string in Outlook, it pulls up the email even though the string is only present within the attachment. So ultimately, my question is, how do I leverage that attachment index in VBA?</p>\n\n<pre><code>If atmt.Index Like \"*\" &amp; Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value &amp; \"*\" Then\ni = i + 1\nWith item\n    .FlagRequest = \"Follow up\"\n    .Save\nEnd With\nEnd If\nNext rwindex\nNext atmt\nNext item\nIf i &gt; 0 Then\nMsgBox \"I found \" &amp; i &amp; \" attached files with a specific name.\"\nElse\nMsgBox \"I didn't find any files\"\nEnd If\nSet atmt = Nothing\nSet item = Nothing\nSet ns = Nothing\nworkbk.Close savechanges:=False\nExit Sub\nbigerror:\nMsgBox \"something went wrong\"\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated, thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 1, "creation_date": 1477511856, "post_id": 40266964, "comment_id": 67802163, "body": "this lead my down the right path.  See my edited post for more details."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477516164, "post_id": 40266964, "comment_id": 67804241, "body": "Thank you for the recognition :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1477497495, "creation_date": 1477497495, "answer_id": 40266964, "question_id": 40266840, "link": "https://stackoverflow.com/questions/40266840/vba-get-string-associated-with-max-value-in-range/40266964#40266964", "title": "VBA - Get String Associated with Max Value in Range", "body": "<p>You just need an <a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=index%20match%20excel\" rel=\"nofollow\">index(Match,Match)</a> function.\nIt would take a look at the highest number in B and return the A.</p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477500458, "post_id": 40267018, "comment_id": 67796001, "body": "I am getting a &quot;Object Variable or with block variable not set&quot;  Any thoughts on why that might be?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477503377, "post_id": 40267018, "comment_id": 67797514, "body": "On which line?  What are the value of highestNum at the time of the error?"}, {"owner": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477503797, "post_id": 40267018, "comment_id": 67797772, "body": "the debug.Print Line.  The value of highestNum is 0.0611...which happens to be the highest value in my actual data set.  highestNum is set to double if that helps."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477503965, "post_id": 40267018, "comment_id": 67797885, "body": "It is not finding a match for some reason. Try @user3598756 code.  It might be a rounding/floating decimal issue."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477504962, "post_id": 40267018, "comment_id": 67798403, "body": "@user2828701 see edit for a work around on the floating decimal."}, {"owner": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "edited": false, "score": 0, "creation_date": 1477511804, "post_id": 40267018, "comment_id": 67802132, "body": "@ Scott Craner - Thanks for helping me out.  Your latest edit did not help either, I continued to have issues.  I am editing my post above with the answer I ended up with.  Thanks again."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1477504934, "last_edit_date": 1477504934, "creation_date": 1477497620, "answer_id": 40267018, "question_id": 40266840, "link": "https://stackoverflow.com/questions/40266840/vba-get-string-associated-with-max-value-in-range/40267018#40267018", "title": "VBA - Get String Associated with Max Value in Range", "body": "<p>You can use Range.Find() to return the cell in which the max value is found.</p>\n\n<p>Then use offset to return the value from the cell directly to the left:</p>\n\n<pre><code> Dim mtch As Range\n Set myrange = Application.InputBox( _\n prompt:=\"Please select the Range.\", Title:=\"Graph Range\", Type:=8)\n highestNum = Application.WorksheetFunction.Max(myrange)\n Set mtch = myrange.Find(highestNum)\n Debug.Print mtch.Offset(, -1).Value\n</code></pre>\n\n<hr>\n\n<p>Edit</p>\n\n<p>It seems you are experiencing a rounding/floating decimal problem.  To help deal with that we need to change to a For Each loop and load each value into another double so the rounding is the same:</p>\n\n<pre><code>Dim mtch As Range\nDim highestNum As Double\nDim t As Double\nDim myrange As Range\n Set myrange = Application.InputBox( _\n prompt:=\"Please select the Range.\", Title:=\"Graph Range\", Type:=8)\n highestNum = Application.WorksheetFunction.Max(myrange)\n t = Range(\"B3\").Value\n r = t = highestNum\n For Each mtch In myrange\n    t = mtch.Value\n    If t = highestNum Then\n        Debug.Print mtch.Offset(, -1).Value\n        Exit For\n    End If\nNext mtch\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1477499538, "creation_date": 1477499538, "answer_id": 40267647, "question_id": 40266840, "link": "https://stackoverflow.com/questions/40266840/vba-get-string-associated-with-max-value-in-range/40267647#40267647", "title": "VBA - Get String Associated with Max Value in Range", "body": "<p>just to play a little bit with Scott's solution:</p>\n\n<pre><code>With Application.InputBox(prompt:=\"Please select the Range.\", Title:=\"Graph Range\", Type:=8)\n    Debug.Print Cells.Find(Application.WorksheetFunction.Max(.Cells)).Offset(, -1).Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 2828701, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/251ff7744bf38b4bdf8e266a151fa6eb?s=128&d=identicon&r=PG&f=1", "display_name": "user2828701", "link": "https://stackoverflow.com/users/2828701/user2828701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 1, "accepted_answer_id": 40266964, "answer_count": 3, "score": 1, "last_activity_date": 1477512142, "creation_date": 1477497192, "last_edit_date": 1531164843, "question_id": 40266840, "link": "https://stackoverflow.com/questions/40266840/vba-get-string-associated-with-max-value-in-range", "title": "VBA - Get String Associated with Max Value in Range", "body": "<p>I am in the process of writing a macro in excel and need to get the string or text associated with the max value in a range.</p>\n\n<p>My range looks something like this:</p>\n\n<p>A | B <br>\nCR1 | 2.33 <br>\nCR2 | 5.1 <br>\nCR3 | 10.0 <br>\nCR4 | 3.8 <br></p>\n\n<p>I was able to find the MAX value in column B, but now I need the associated string in column A.  So in this case, given B3 (10.0) is the max value, I want to pull out 'CR3'.</p>\n\n<p>So my code for pulling the max value is:</p>\n\n<pre><code> Set myRange = Application.InputBox( _\n prompt:=\"Please select the Range.\", Title:=\"Graph Range\", Type:=8)\n highestNum = Application.WorksheetFunction.Max(myRange)\n</code></pre>\n\n<p>What can I do to get the associated string in column A?\nI've tried using .Address, but that hasn't gotten me anywhere.</p>\n\n<p>Thanks in advance!</p>\n\n<p><br><br></p>\n\n<p>!!!!!!! Edit/Update - Solved: !!!!!!!\n<br></p>\n\n<p>As another contributer suggested, I needed to use inded + Match.  See below for Solution.</p>\n\n<pre><code>Set myRange = Application.InputBox( _\nprompt:=\"Please select the Primary KPI 'Lift' Data to Graph.\", Title:=\"Graph Range\", Type:=8)\n\nSet rngColumn2 = myRange.Areas(2)\n\nhighestNum = Application.WorksheetFunction.Max(myRange)\n\ntest = Application.WorksheetFunction.Index(myRange, Application.WorksheetFunction.Match(highestNum, rngColumn2, 1), 1)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477500346, "post_id": 40266835, "comment_id": 67795939, "body": "another option can be <code>Data</code> tab &gt; <code>From Text</code> and in the Properties you can change when the data should be refreshed."}], "answers": [{"comments": [{"owner": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "edited": false, "score": 0, "creation_date": 1477498614, "post_id": 40267274, "comment_id": 67794903, "body": "thanks definitely cleaner! Still trying to stop using clipboard! :)"}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "reply_to_user": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "edited": false, "score": 0, "creation_date": 1477498814, "post_id": 40267274, "comment_id": 67795028, "body": "I do not know other way than using <code>.Copy</code> if you are trying to get a specific cell and then copy its value. At least this way you avoid the use of <code>.Activate</code> and <code>.Select</code> :)"}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "reply_to_user": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "edited": false, "score": 0, "creation_date": 1477499309, "post_id": 40267274, "comment_id": 67795308, "body": "@StevenG, this way you do not use <code>.Copy</code> but it is pretty similar and will return the same results."}], "tags": [], "owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "is_accepted": false, "score": 1, "last_activity_date": 1477499169, "last_edit_date": 1477499169, "creation_date": 1477498474, "answer_id": 40267274, "question_id": 40266835, "link": "https://stackoverflow.com/questions/40266835/copy-paste-block-data-from-a-csv-into-another-excel-file/40267274#40267274", "title": "Copy Paste block data from a csv into another excel file", "body": "<p>Maybe you are looking for something more \"clean\" like this?</p>\n\n<pre><code>Option Explicit\n\nSub CopyValueFromSheet()\n\n    Dim MyWB As Workbook\n    Dim DataWS As Worksheet\n    Dim TermDataRange As Range\n    Dim OtherWB As Workbook\n\n    ' To avoid screen flashing\n    Application.ScreenUpdating = False\n\n    Set MyWB = ThisWorkbook\n    Set DataWS = MyWB.Worksheets(\"Sheetname\")\n    Set TermDataRange = DataWS.Range(\"DestinationCell\")\n\n    Set OtherWB = Workbooks.Open(\"C:\\Users\\YourUsername\\Desktop\\CsvFileName.csv\")\n    ' When opening a csv file there is only one worksheet with the same name as the csv file\n    OtherWB.Worksheets(\"CsvFileName\").Range(\"SourceCell\").Copy\n    TermDataRange.PasteSpecial Paste:=xlPasteValues\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>\nAnother possible way would result in storing the value of the source cell in a VBA variable and then set it to the destination cell, but it will be pretty much the same:</p>\n\n<pre><code>    Dim VarValue As String\n    VarValue = OtherWB.Worksheets(\"CsvFileName\").Range(\"SourceCell\").Value\n    TermDataRange.Value = VarValue\n</code></pre>\n\n<p>HTH ;)</p>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": true, "score": 3, "last_activity_date": 1477499835, "last_edit_date": 1477499835, "creation_date": 1477498523, "answer_id": 40267290, "question_id": 40266835, "link": "https://stackoverflow.com/questions/40266835/copy-paste-block-data-from-a-csv-into-another-excel-file/40267290#40267290", "title": "Copy Paste block data from a csv into another excel file", "body": "<p>Selecting the range directly is as easy as meshing your three lines together:</p>\n\n<pre><code>Set TermDataRange = ActiveWorkbook.Worksheets(\"Data\").Range(\"celltopaste\")\n</code></pre>\n\n<p><em>edited - my mistake - I'd skipped more steps than I thought and was actually condensing three of your lines, rather than two, into one : )</em></p>\n\n<p>(to be honest I would never normally give a seperate name to ActiveWorkbook itself, unless I needed to refer to it as a workbook later in the code)</p>\n\n<p>Avoiding Copy/Paste is pretty easy. The trick is to make sure that your source range and destination range are the same size and shape - once this is true you can simply use the code</p>\n\n<pre><code>RangeA.Value = RangeB.Value\n</code></pre>\n\n<p>In your case, your best bet is to measure the size of your data first. e.g.</p>\n\n<pre><code>'give range(\"A1\").current region a name just to make it less unwieldy\nCopyRange = Range(\"A1\").CurrentRegion\nDatarows = CopyRange.Rows.Count\nDatacols = CopyRange.Columns.Count\n'set a range of same size starting from TermDataRange to move the values to\nset DestRange = Range(TermDataRange, TermDataRange(offset(Datarows -1, Datacolumns -1))\n'move values directly rather than via copy-paste\nDestRange.Value = CopyRange.Value\n</code></pre>\n"}], "owner": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 40267290, "answer_count": 2, "score": 0, "last_activity_date": 1477499835, "creation_date": 1477497186, "last_edit_date": 1531161705, "question_id": 40266835, "link": "https://stackoverflow.com/questions/40266835/copy-paste-block-data-from-a-csv-into-another-excel-file", "title": "Copy Paste block data from a csv into another excel file", "body": "<p>is there a way not to select workbook back and forth and copy a block of data efficiently?</p>\n\n<p>this is how I am doing it right now:</p>\n\n<pre><code>Set MyWB = ActiveWorkbook\nSet DataWS = MyWB.Worksheets(\"Data\")\nSet TermDataRange = DataWS.Range(\"celltopaste\")\n\nWorkbooks(\"data.csv\").Activate\nRange(\"A1\").CurrentRegion.Copy  'selecting block data\nMyWB.Activate\nTermDataRange.Select\nSelection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>is there a way without selecting MyWB, then the range?</p>\n\n<p>also, selection.paste feels kind of wierd, I hate copying data to clipboard.</p>\n\n<p>I was hoping for something like:</p>\n\n<pre><code>Workbooks(\"data.csv\").Activate\nTermDataRange = Range(\"A1\").CurrentRegion\n</code></pre>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1477497380, "post_id": 40266817, "comment_id": 67794105, "body": "This question may be better suited for <a href=\"http://superuser.com/\">SuperUser</a>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1477497451, "post_id": 40266817, "comment_id": 67794149, "body": "&quot;Not responding&quot; and exceeding available memory are very different things. No, they generally can&#39;t be predicted beforehand, and no, they are not specific to VBA. If you want to know why a Windows program may freeze on a long running sub, you should read about message loops. If you want to avoid this effect in this particular macro, call <code>DoEvents</code> every so often."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477497574, "post_id": 40266817, "comment_id": 67794245, "body": "up to 64K of compiled code in a single procedure <a href=\"http://excel.tips.net/T003174_Maximum_Length_Limit_for_a_Macro.html\" rel=\"nofollow noreferrer\">excel.tips.net/T003174_Maximum_Length_Limit_for_a_Macro.html</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1477497949, "post_id": 40266817, "comment_id": 67794514, "body": "I don&#39;t think you need to check the lot like that, with some <code>GoTo</code>s you could say, after <code>for b=.....</code>  <code>if b=a then goto next_b_val</code>, maybe?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1477499086, "post_id": 40266817, "comment_id": 67795176, "body": "@GSerg or just disable <code>Application.ScreenUpdating</code> (and re-enable it after); <code>DoEvents</code> will keep the host responsive, but will also make your monster loop take much longer to complete."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1477500413, "post_id": 40266817, "comment_id": 67795976, "body": "@Slai whoever reading this comment without clicking the link might actually think 63K of compiled code in a single procedure is &quot;fine&quot;. Note to the reader: <b><i>IT ISN&#39;T</i></b>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1477503769, "post_id": 40266817, "comment_id": 67797760, "body": "This code performs 21.1 billion boolean comparisons.  That will take some time. My machine will do roughly 150 million per second. That&#39;s about 2 and a half minutes for the <code>If</code> tests <b><i>alone</i></b>. Add that to the 362,880 cells that you&#39;re writing individually, and I&#39;m guessing you aren&#39;t waiting long enough for it to complete.  This would seem to indicate that &quot;a brute force method&quot; probably isn&#39;t the best solution to the problem."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1477506543, "post_id": 40266817, "comment_id": 67799314, "body": "@Mat&#39;sMug year ago I converted a VBA template to C# Add-In. The VBA version has Sub split into 47 Subs of If-ElseIf statements (now I realize why it was split :] ), but it ran almost as fast as the C# version (about a second). It&#39;s not &quot;fine&quot;, but just example that ~3MB of VBA source code (somehow ~5.5 MB compiled) can be a thing used for many years without noticeable problems."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1477498904, "creation_date": 1477498904, "answer_id": 40267421, "question_id": 40266817, "link": "https://stackoverflow.com/questions/40266817/is-there-a-limit-on-the-number-of-operations-vba-can-perform/40267421#40267421", "title": "Is there a limit on the number of operations VBA can perform?", "body": "<p>Not an answer, but can it be tackled by just looping the numbers?  Something along these lines, is checking the 1st char against the rest</p>\n\n<pre><code>Dim l As Long\nDim i As Integer\n\nFor l = 11111111 To 99999999\n    For i = 2 To 8\n        DoEvents\n        If (Mid(l, i, 1) &lt;&gt; Mid(l, 1, 1)) Then\n            Debug.Print l\n        End If\n    Next i\nNext l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1477499532, "creation_date": 1477499532, "answer_id": 40267644, "question_id": 40266817, "link": "https://stackoverflow.com/questions/40266817/is-there-a-limit-on-the-number-of-operations-vba-can-perform/40267644#40267644", "title": "Is there a limit on the number of operations VBA can perform?", "body": "<p>You should attempt to do a tiny bit of maths before you begin.</p>\n\n<p>Your code generates all the permutations of 9 thing taken 9 at a time.  Before you begin, you know this this will fill <em>362880</em> rows;  so the code should work.</p>\n\n<p>A separate issue is how much time will it take, and is this the most efficient method .</p>\n"}], "owner": {"reputation": 11, "user_id": 7048531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5b453ad11f145a8f490c5d78f01880?s=128&d=identicon&r=PG&f=1", "display_name": "SaintJeremy", "link": "https://stackoverflow.com/users/7048531/saintjeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477499532, "creation_date": 1477497155, "last_edit_date": 1492087846, "question_id": 40266817, "link": "https://stackoverflow.com/questions/40266817/is-there-a-limit-on-the-number-of-operations-vba-can-perform", "title": "Is there a limit on the number of operations VBA can perform?", "body": "<p>Inspired by a <a href=\"https://puzzling.stackexchange.com/questions/44997/ane-and-her-block-toys\">puzzle</a>  I saw online , and since I'm a VBA newbie, I thought it might be an interesting exercise to help me learn how to use <code>For</code> loops by making a brute force method to search for solutions to it.</p>\n\n<p>This led to creating a monstrosity that takes ages to partially run and actually won't fully run at all.\nAll the code is meant to do is print 3 columns of valid combinations</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim j As Long\nDim abc As String\nDim def As String\nDim ghi As String\n\nj = 1\n\n   For a = 1 To 9\n    For b = 1 To 9\n     For c = 1 To 9\n      For d = 1 To 9\n       For e = 1 To 9\n        For f = 1 To 9\n         For g = 1 To 9\n          For h = 1 To 9\n           For i = 1 To 9\n'Line breaks included for ease of reading\n            If a = b Or a = c Or a = d Or a = e Or a = f Or a = g Or a = h Or a = i \n            Or b = c Or b = d Or b = e Or b = f Or b = g Or b = h Or b = i \n            Or c = d Or c = e Or c = f Or c = g Or c = h Or c = i \n            Or d = e Or d = f Or d = g Or d = h Or d = i \n            Or e = f Or e = g Or e = h Or e = i \n            Or f = g Or f = h Or f = i \n            Or g = h Or g = i \n            Or h = i Then\n\n           Else\n           abc = a &amp; b &amp; c\n           def = d &amp; e &amp; f\n           ghi = g &amp; h &amp; i\n\n           ThisWorkbook.Sheets(\"Sheet1\").Cells(j, 1).Value = abc\n           ThisWorkbook.Sheets(\"Sheet1\").Cells(j, 2).Value = def\n           ThisWorkbook.Sheets(\"Sheet1\").Cells(j, 3).Value = ghi\n\n           j = j + 1\n           End If\n\n         Next i\n        Next h\n       Next g\n      Next f\n     Next e\n    Next d\n   Next c\n  Next b\n Next a\nEnd Sub\n</code></pre>\n\n<p>This obviously involves lots of simple operations, and results in variously (Not Responding) messages or it just doesn't run. Was it possible to tell before clicking \"Go\" that that would be the case?</p>\n\n<p>My job has me working on, and adding to, spread sheets that perform lots of operations on other spread sheets with conceivably hundreds of thousands of data items in each. Continuing to add functionality to these files may or may not be sustainable, I need to know how to tell before I sink time into further development.</p>\n\n<p>Is there a hard limit to what can be done with VBA in terms of volumes/numbers of operations? Is there a tool that will estimate the viability of a macro actually running to completion? A heuristic commonly employed in industry?</p>\n\n<p>Basically, what methods or tools exist to inform as to whether the demands of a macro or series of macros will exceed available memory?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1477498938, "post_id": 40266650, "comment_id": 67795092, "body": "I see you&#39;re using loops. Have you tried extending the concept to iterate rows? Also, I&#39;d suggest you <i>indent</i> your code - with everything stuck to the left it&#39;s pretty hard to tell which loop/conditional starts/ends where."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1477501337, "creation_date": 1477501337, "answer_id": 40268177, "question_id": 40266650, "link": "https://stackoverflow.com/questions/40266650/vba-from-tag-to-bold/40268177#40268177", "title": "VBA from tag to bold", "body": "<p>have you Sub accept a <code>Range</code> variable as its argument (say it's called <code>cell</code>) and then call it form inside a loop of an outer \"Main\" Sub</p>\n\n<p>like follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range\n\n    With Worksheets(\"bolds\") '&lt;--| change \"bolds\" to your actual worksheet name\n        For Each cell In .UsedRange.SpecialCells(XlCellType.xlCellTypeConstants, xlTextValues)\n            ProcessBolds cell\n        Next cell\n    End With\nEnd Sub\n\nSub ProcessBolds(cell As Range)\n    Dim str As String\n    Dim nBold() As Long\n    Dim nEndBold() As Long\n    Dim nChars() As Long\n    Dim nTimes As Long\n    Dim iCtr As Long\n\n    With cell\n        str = .Text\n        nTimes = (Len(str) - Len(Replace(str, \"&lt;b&gt;\", \"\"))) / Len(\"&lt;b&gt;\")\n        If nTimes = 0 Then\n            'do nothing\n        Else\n            ReDim nBold(1 To nTimes)\n            ReDim nEndBold(1 To nTimes)\n            ReDim nChars(1 To nTimes)\n\n            For iCtr = 1 To nTimes\n                nBold(iCtr) = InStr(str, \"&lt;b&gt;\")\n                nEndBold(iCtr) = InStr(nBold(iCtr), str, \"&lt;/b&gt;\")\n                If nEndBold(iCtr) = 0 Then\n                    nEndBold(iCtr) = 32767\n                End If\n                nChars(iCtr) = nEndBold(iCtr) - nBold(iCtr) - 3\n                str = Replace(Replace(str, \"&lt;b&gt;\", \"\", 1, 1), \"&lt;/b&gt;\", \"\", 1, 1)\n            Next iCtr\n\n            str = Replace(str, \"&lt;/b&gt;\", \"\")\n            .Value = str\n\n            For iCtr = 1 To nTimes\n                .Characters(nBold(iCtr), nChars(iCtr)).Font.Bold = True\n            Next iCtr\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7075942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0fa826e74eac593d252ce0a74990240?s=128&d=identicon&r=PG&f=1", "display_name": "Isabelle_FR", "link": "https://stackoverflow.com/users/7075942/isabelle-fr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477570316, "creation_date": 1477496682, "question_id": 40266650, "link": "https://stackoverflow.com/questions/40266650/vba-from-tag-to-bold", "title": "VBA from tag to bold", "body": "<p>in Excel, I have different data in several rows containing bold tags like this :</p>\n\n<pre><code>bonjour, &lt;b&gt;je&lt;/b&gt; voudrais &lt;b&gt;savoir&lt;/b&gt; un truc\n</code></pre>\n\n<p>i need to transform the text between tags in bold and strip away the tags in all the spreadsheet. Here's the result I'm looking for :</p>\n\n<p>bonjour, <b>je</b> voudrais <b>savoir</b> un truc</p>\n\n<p>Since I'm starting on VBA, I've grabbed some portions of code from other forums to try to achieve this, but all it can do is make the transformation one row at a time. I would like this macro to run on all the spreadsheet.</p>\n\n<p>Do you guys have any idea how to get that done ?</p>\n\n<p>Heres's the code :</p>\n\n<pre><code>Option Explicit\nSub testme01()\n\nDim str As String\nDim nBold() As Long\nDim nEndBold() As Long\nDim nChars() As Long\nDim nTimes As Long\nDim iCtr As Long\n\nWith ActiveCell\nstr = .Text\nnTimes = (Len(str) - Len(Replace(str, \"&lt;b&gt;\", \"\"))) / Len(\"&lt;b&gt;\")\nIf nTimes = 0 Then\n'do nothing\nElse\nReDim nBold(1 To nTimes)\nReDim nEndBold(1 To nTimes)\nReDim nChars(1 To nTimes)\n\nFor iCtr = 1 To nTimes\nnBold(iCtr) = InStr(str, \"&lt;b&gt;\")\nnEndBold(iCtr) = InStr(nBold(iCtr), str, \"&lt;/b&gt;\")\nIf nEndBold(iCtr) = 0 Then\nnEndBold(iCtr) = 32767\nEnd If\nnChars(iCtr) = nEndBold(iCtr) - nBold(iCtr) - 3\nstr = Replace(Replace(str, \"&lt;b&gt;\", \"\", 1, 1), \"&lt;/b&gt;\", \"\", 1, 1)\nNext iCtr\n\nstr = Replace(str, \"&lt;/b&gt;\", \"\")\n.Value = str\n\nFor iCtr = 1 To nTimes\n.Characters(nBold(iCtr), nChars(iCtr)).Font.Bold = True\nNext iCtr\n\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanx :)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1477495853, "creation_date": 1477495853, "answer_id": 40266379, "question_id": 40266247, "link": "https://stackoverflow.com/questions/40266247/most-efficent-way-to-select-a-matrix-of-data-excel-vba/40266379#40266379", "title": "most efficent way to select a matrix of data excel vba", "body": "<p>If you are dealing with a <strong>block</strong> of data and the upper left-hand corner is <strong>A1</strong>, then:</p>\n\n<pre><code>Range(\"A1\").CurrentRegion.Copy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": false, "score": 1, "last_activity_date": 1477495897, "creation_date": 1477495897, "answer_id": 40266389, "question_id": 40266247, "link": "https://stackoverflow.com/questions/40266247/most-efficent-way-to-select-a-matrix-of-data-excel-vba/40266389#40266389", "title": "most efficent way to select a matrix of data excel vba", "body": "<p>If you know the end point, then yes, you can define two ranges within the \"Range\" reference and it will use one as the start point, and the other as the end point, e.g. </p>\n\n<pre><code>Range(Range(\"A1\"),Range(\"Z10\")).Copy\n</code></pre>\n\n<p>is analogous to</p>\n\n<pre><code>Range(\"A1:Z10\").Copy\n</code></pre>\n\n<p>similarly, if you have a range RangeX, you can use</p>\n\n<pre><code>Range(RangeX, RangeX.offset(2,2)).Copy\n</code></pre>\n\n<p>Which will always select a square range of 3x3 cells originating from \"RangeX\"</p>\n"}], "owner": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 40266379, "answer_count": 2, "score": 0, "last_activity_date": 1477495897, "creation_date": 1477495519, "last_edit_date": 1531161705, "question_id": 40266247, "link": "https://stackoverflow.com/questions/40266247/most-efficent-way-to-select-a-matrix-of-data-excel-vba", "title": "most efficent way to select a matrix of data excel vba", "body": "<p>I am wondering if there's a more efficient way to select a matrix of data strating from 'A1' but with a variable row and column range.</p>\n\n<p>I am using the following code to do such task</p>\n\n<pre><code>Range(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\n</code></pre>\n\n<p>is there a quicker way to get to the same range selected?</p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2906801"}, "is_accepted": true, "score": 1, "last_activity_date": 1477498593, "creation_date": 1477498593, "answer_id": 40267312, "question_id": 40266054, "link": "https://stackoverflow.com/questions/40266054/automate-changing-of-page-layout-orientation-of-excel-and-printing/40267312#40267312", "title": "automate changing of page layout orientation of excel and printing", "body": "<p>I would say the best way would be to record the majority of what you want as a Macro (the orientation and printing) and then using VBA to open each of the files call that macro you recorded and then close the file once it has been printed.</p>\n\n<pre><code>Sub Macro()\nDim fpath As String\n\nfpath = Worksheets(\"Sheet1\").Range(\"H4\").Value \n\n'I use a file that has a file path cell which helps with dealing with lots of sheets\n\n.DisplayAlerts = False\n.ScreenUpdating = False\n\nWorkbooks.Open Filename:= _\n    fpath &amp; \"\\\" &amp; \"Test File.xlsx\"\n    Sheets(\"Sheet1\").Select\n   'Call the macro at this point \n    Windows(\"Test File.xlsx\").Activate\n    ActiveWorkbook.Close\n\n.DisplayAlerts = True\n.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I tested it very quickly and it seemed to work well for me.</p>\n\n<p>But there may be an easier way of going about it, but that's how I would approach it</p>\n"}], "owner": {"reputation": 2539, "user_id": 4677278, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1cb766e72045dedd3adaf4353479fa26?s=128&d=identicon&r=PG&f=1", "display_name": "ytk", "link": "https://stackoverflow.com/users/4677278/ytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 40267312, "answer_count": 1, "score": 0, "last_activity_date": 1477498593, "creation_date": 1477494970, "question_id": 40266054, "link": "https://stackoverflow.com/questions/40266054/automate-changing-of-page-layout-orientation-of-excel-and-printing", "title": "automate changing of page layout orientation of excel and printing", "body": "<p>I am generating a bunch of excel workbooks, each with one sheet, in <code>R</code> using the <a href=\"https://cran.r-project.org/web/packages/openxlsx/openxlsx.pdf\" rel=\"nofollow\">openxlsx</a> package. Now to print these out, I have to open up each of these files, go to Page Layout > Orientation > Landscape, then go to File > Print > Scaling > Fit All Columns on One Page and then print it. It gets really tedious, especially when I'm generating over 200 excel files. Is there any way to automate this? None of the <code>R</code> packages I looked at seem to have a way to do this, and I'm open to any language/tool.</p>\n"}, {"tags": ["excel", "forms", "vba", "box"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1477497166, "creation_date": 1477497166, "answer_id": 40266821, "question_id": 40265773, "link": "https://stackoverflow.com/questions/40265773/excel-vba-combo-box-value-on-form-load/40266821#40266821", "title": "Excel-VBA combo box value on form load", "body": "<blockquote>\n  <p>I have some combo boxes, that on the form, when they are selected will\n  enter a number in the corresponding cell</p>\n</blockquote>\n\n<p>Then you'd need to do the opposite of your code attempt, i.e.:</p>\n\n<pre><code> Worksheets(\"Req Sheet\").Range(\"C27\").Value = ReqSetup.MinPerKgCB.Value\n</code></pre>\n\n<p>That you'd better wrap inside a check that any combobox value is actually selected :</p>\n\n<pre><code>With ReqSetup.MinPerKgCB\n    If .ListIndex &lt;&gt; -1 Then Worksheets(\"Req Sheet\").Range(\"C27\").Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477497166, "creation_date": 1477494165, "question_id": 40265773, "link": "https://stackoverflow.com/questions/40265773/excel-vba-combo-box-value-on-form-load", "title": "Excel-VBA combo box value on form load", "body": "<p>I have a VBA form which is used to enter data on a sheet. I am currently coding the form so as it will load any data already existing in the sheet back into the form.</p>\n\n<p>For simple text strings it works perfectly.</p>\n\n<p>e.g.</p>\n\n<pre><code>ReqSetup.ReqText = Application.Worksheets(\"Req Sheet\").Range(\"F11\").Value\n</code></pre>\n\n<p>However, I have some combo boxes, that on the form, when they are selected will enter a number in the corresponding cell. </p>\n\n<p>Fail 1. - Run Time Error 380 - Invalid property value.</p>\n\n<pre><code>    ReqSetup.MinPerKgCB = Application.Worksheets(\"Req Sheet\").Range(\"C27\").Value\n</code></pre>\n\n<p>Fail 2.</p>\n\n<pre><code>    Dim MinPerKg As Range\n    Set MinPerKg = Application.Worksheets(\"Req Sheet\").Range(\"C27\")\n\n    ReqSetup.MinPerKgCB = MinPerKg\n</code></pre>\n\n<p>I'm obviously doing something really simple wrong but I can't work out what it is!!</p>\n\n<p>Kind Regards!</p>\n"}, {"tags": ["xml", "vba", "ms-access", "import"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1477587900, "last_edit_date": 1477587900, "creation_date": 1477586886, "answer_id": 40290168, "question_id": 40265556, "link": "https://stackoverflow.com/questions/40265556/unable-to-upload-xml-file-to-a-new-table-in-ms-access-using-vba/40290168#40290168", "title": "Unable to upload .xml file to a new table in MS Access using vba", "body": "<p>Simply pass the file name in the method. The issue you face is attempting to pass the text value of the XML <em>MyOutput</em> and not the actual saved file which <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823157.aspx\" rel=\"nofollow\">Application.ImportXML</a> expects:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.ImportXML \"C:\\Users\\los07\\Documents\\test.xml\", acStructureAndData\n</code></pre>\n\n<p>Also, consider saving the XML content using a MSXML DOM object, specifically its <a href=\"https://msdn.microsoft.com/en-us/library/ms753769(v=vs.85).aspx\" rel=\"nofollow\">Save</a> method. Text file dumps may affect encoding of content as Windows text files default content to <em>ANSI</em> and may not retain <em>UTF</em>, <em>ISO</em>, etc. encodings. Recall XMLs are not quite text files but special markup documents.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command2_Click()    \n    Dim xmlhttp As New MSXML2.ServerXMLHTTP60, xmlDoc As New MSXML2.DOMDocument60\n    Dim myurl As String, MyOutput As String, xmlFile as String\n\n    myurl = \"http://10.74.18.2:8000/service=46&amp;ticket_number=RQTASK1381986&amp;xml=true\"\n    xmlhttp.Open \"GET\", myurl, False\n    xmlhttp.send\n\n    MyOutput = Mid(xmlhttp.responseText, 5)\n    xmlFile = \"C:\\Users\\los07\\Documents\\test.xml\"\n    xmlDoc.Save xmlFile\n\n    Application.ImportXML xmlFile, acStructureAndData\n\n    Set xmlhttp = Nothing\n    Set xmlDoc = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7075704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6431bf6d5df33f71c7ac72f2d5ddff30?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7075704/lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1477646694, "creation_date": 1477646694, "answer_id": 40302027, "question_id": 40265556, "link": "https://stackoverflow.com/questions/40265556/unable-to-upload-xml-file-to-a-new-table-in-ms-access-using-vba/40302027#40302027", "title": "Unable to upload .xml file to a new table in MS Access using vba", "body": "<p>Got it working. There was also an error as the description column was over 255 characters and exceeded the limit. This column was not needed so I had to remove it. \nGot the import working by saving as a file, reopening it and deleting the node which was over 255 characters, saving it as a new file and uploading the new file. </p>\n\n<pre><code>Private Sub Command0_Click()\n\nDim xmlhttp As New MSXML2.ServerXMLHTTP60, myurl As String, MyOutput As String\n\nmyurl = \"http://10.74.18.2:8000/service=46&amp;ticket_number=RQTASK1381986&amp;xml=true\"\nxmlhttp.Open \"GET\", myurl, False\nxmlhttp.send\n\n\n MyOutput = Mid(xmlhttp.responseText, 5)\n    'takes out first 4 charachters\n\n\nOpen \"\\\\livoffice04\\CRM\\SkyCRM\\Data Team\\Working Docs\\Lee Osborne\\test.xml\" For Output As #1\nPrint #1, MyOutput\nClose #1\n    'Opens xml and saves as xml document called \"test.xml\" then closes the document\n\n\nSet xmldoc = CreateObject(\"Microsoft.XMLDOM\")\nxmldoc.Load \"test.xml\"\n    'Opens xml document\n\n\nSet nNode = xmldoc.selectSingleNode(\"//spark/description\")\n    'Finds description node\n\nnNode.Text = \"\"\n    'Deletes text in the selected node\n\n\n\nstrResult = xmldoc.Save(\"test1.xml\")\n    'Saves the xml document with the new settings and as a new file called \"test1.xml\".\n\n\nApplication.ImportXML \"\\\\livoffice04\\CRM\\SkyCRM\\Data Team\\Working Docs\\Lee Osborne\\test1.xml\", acAppendData\n    'Imports the data from test1.xml to a table called \"spark\"\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 31, "user_id": 7075704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6431bf6d5df33f71c7ac72f2d5ddff30?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7075704/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477646694, "creation_date": 1477493618, "question_id": 40265556, "link": "https://stackoverflow.com/questions/40265556/unable-to-upload-xml-file-to-a-new-table-in-ms-access-using-vba", "title": "Unable to upload .xml file to a new table in MS Access using vba", "body": "<p>I am trying to have an xml file import to a new table in Access using VBA. </p>\n\n<p>So far the code I have pulls the data from an API and saves it as an xml file. The problem is that when i am trying to import that file into a new Access table I get the Run-Time error <strong><em>'-2146697203 (800c000d)': Method 'ImportXML' of object '_Application' failed.</em></strong></p>\n\n<p>So far the code I have is;</p>\n\n<pre><code>Private Sub Command2_Click()\n\nDim xmlhttp As New MSXML2.ServerXMLHTTP60, myurl As String, MyOutput As String\n\nmyurl = \"http://10.74.18.2:8000/service=46&amp;ticket_number=RQTASK1381986&amp;xml=true\"\nxmlhttp.Open \"GET\", myurl, False\nxmlhttp.send\n\n   MyOutput = Mid(xmlhttp.responseText, 5)\n\n\nOpen \"C:/Users/los07/Documents/test.xml\" For Output As #1\nPrint #1, MyOutput\n\nApplication.ImportXML MyOutput, acStructureAndData\n\nEnd Sub\n</code></pre>\n\n<p>`\nAny help would be appreciated.</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["vba", "excel", "paste"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1477493411, "post_id": 40265447, "comment_id": 67791307, "body": "Can you kindly post the code?"}, {"owner": {"reputation": 1, "user_id": 7075776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c3560dcc1e321bdaa18478f1ea4532d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Piggott", "link": "https://stackoverflow.com/users/7075776/daniel-piggott"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1477493465, "post_id": 40265447, "comment_id": 67791342, "body": "Sheets(&quot;SITS Requests&quot;).Select     Range(&quot;A5&quot;, Range(&quot;A5&quot;).End(xlDown)).SpecialCells(xlCellTypeVisible).Cop&zwnj;&#8203;y     Sheets(&quot;Refund Data&quot;).Select     Range(&quot;A7&quot;).Select     Application.DisplayAlerts = False     ActiveSheet.Paste"}, {"owner": {"reputation": 1, "user_id": 7075776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c3560dcc1e321bdaa18478f1ea4532d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Piggott", "link": "https://stackoverflow.com/users/7075776/daniel-piggott"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1477493544, "post_id": 40265447, "comment_id": 67791402, "body": "Could this be a code issue though? If it works perfectly on my computer but has a completely different outcome on my colleagues?"}], "answers": [{"tags": [], "owner": {"reputation": 1233, "user_id": 6903997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ1mr.png?s=128&g=1", "display_name": "Tim Schmidt", "link": "https://stackoverflow.com/users/6903997/tim-schmidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1477493804, "creation_date": 1477493804, "answer_id": 40265623, "question_id": 40265447, "link": "https://stackoverflow.com/questions/40265447/excel-pasting-values-into-a-table-different-outcomes-on-different-machines/40265623#40265623", "title": "Excel Pasting Values into a Table - Different Outcomes on Different Machines", "body": "<p>I can\u00b4t see a problem with you code, but I still have some advice for you:</p>\n\n<p>You shouldn\u00b4t use <code>.Select</code> and <code>Selection.</code> if you can avoid it.</p>\n\n<pre><code>Application.DisplayAlerts = False\nSheets(\"SITS Requests\").Range(\"A5\", Sheets(\"SITS Requests\").Range(\"A5\").End(xlDown)).SpecialCells(xlCellTypeVisible).Cop\u200c\u200by\nSheets(\"Refund Data\").Range(\"A7\").Paste \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7075776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c3560dcc1e321bdaa18478f1ea4532d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Piggott", "link": "https://stackoverflow.com/users/7075776/daniel-piggott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477493804, "creation_date": 1477493348, "question_id": 40265447, "link": "https://stackoverflow.com/questions/40265447/excel-pasting-values-into-a-table-different-outcomes-on-different-machines", "title": "Excel Pasting Values into a Table - Different Outcomes on Different Machines", "body": "<p>I've have a bit of an issue with Excel. The VBA code works perfectly on my computer. It takes non continuous data and pastes it into a table and Excel automatically inserts the rows and the formulas.</p>\n\n<p>However on my colleagues computer, only the first piece of data goes into the table and the rest goes into the cells below the table. It hasn't inserted the rows and therefore the formulas haven't come down either.</p>\n\n<p>Is there some settings I need to enable/disable on their computers to get this to work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1477492549, "post_id": 40264974, "comment_id": 67790608, "body": "I notice in both <code>Loop Until</code> statements you have <code>j = lastrow3 + 1</code>, but I don&#39;t see where you are incrementing <code>j</code> in your loops."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477496129, "post_id": 40265370, "comment_id": 67793264, "body": "Tried but get run time error 13 on &quot;monthsk = sht4.Cells(k, &quot;A&quot;).Value&quot;"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477496479, "post_id": 40265370, "comment_id": 67793487, "body": "That&#39;s a <a href=\"https://msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Type mismatch</a>, so it sounds like not all of the values in column A of sht4 are dates."}, {"owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477498241, "post_id": 40265370, "comment_id": 67794683, "body": "how would you suggest to bring the setting monthsi, monthsj and monthsk inside the loop? I might be doing something wrong..."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477499163, "post_id": 40265370, "comment_id": 67795226, "body": "Edited for clarification."}, {"owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477500592, "post_id": 40265370, "comment_id": 67796068, "body": "Thats how I was doing...Still getting error 13. @PartyHatPanda I guess it should not increase it will only be increasing as a result of i. so I removed that bit. I just don&#39;t understand the error on that statement now (monthsi=sht3.Cells(i, &quot;C&quot;).value) after &quot;Do&quot;."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477502246, "post_id": 40265370, "comment_id": 67796888, "body": "Hmm, I can&#39;t reproduce that I&#39;m afraid - the code works for me so it does sound like a data issue. Have you tried debugging? What is the type of <code>sht3.Cells(i, &quot;C&quot;).value</code> when it falls over?"}, {"owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477588348, "post_id": 40265370, "comment_id": 67839325, "body": "I am away and only be able to check that on Monday. I have to learn a bit how to do debugging properly..I&#39;ll let you know. thanks anyway."}, {"owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "edited": false, "score": 0, "creation_date": 1477913994, "post_id": 40265370, "comment_id": 67936886, "body": "Thanks @bobajob I have been deugging the code and yes you were right. The cells on sht4 though defined as date the order was messed up. The error 13 I was getting had to do with this. However, I am still debugging the code because now I have the error &quot;1004 Method range of object worksheet failed&quot;. The error seems to fall when doing the operation paste special in on sht5 where the value is &quot;Application defined or object defined error&quot;. I edited the code above. Do you have any suggestions on how to approache this error. Thanks in advance"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1477498738, "last_edit_date": 1477498738, "creation_date": 1477493158, "answer_id": 40265370, "question_id": 40264974, "link": "https://stackoverflow.com/questions/40264974/copy-paste-a-range-of-data-from-non-contiguous-to-non-contiguous-columns-in-a-di/40265370#40265370", "title": "copy/paste a range of data from non contiguous to non-contiguous columns in a different worksheet based on condition", "body": "<p>It looks like you may want to bring the setting of <code>monthsi</code>, <code>monthsj</code> and <code>monthsk</code> inside your loops. You increase <code>i</code> in the first loop for example, but that doesn't change <code>monthsi</code>, so if the comparison is false to begin with, the if statement will never run.</p>\n\n<p>For example, the first loop would become:</p>\n\n<pre><code>Do\n    monthsi = sht3.Cells(i, \"C\").Value\n    If monthsj = monthsi Then\n        sht3.Range(Cells(i, \"D\"), Cells(i, \"E\")).Copy\n        sht5.Range(Cells(j, \"VA\"), Cells(j, \"VB\")).PasteSpecial xlPasteValues\n        sht3.Range(Cells(i, \"G\"), Cells(i, \"H\")).Copy\n        sht5.Range(Cells(j, \"VE\"), Cells(j, \"VF\")).PasteSpecial xlPasteValues\n        sht3.Range(Cells(i, \"J\"), Cells(i, \"K\")).Copy\n        sht5.Range(Cells(j, \"VI\"), Cells(j, \"VJ\")).PasteSpecial xlPasteValues\n        sht3.Range(Cells(i, \"M\"), Cells(i, \"N\")).Copy\n        sht5.Range(Cells(j, \"VM\"), Cells(j, \"VN\")).PasteSpecial xlPasteValues\n        sht3.Range(Cells(i, \"P\"), Cells(i, \"Q\")).Copy\n        sht5.Range(Cells(j, \"VQ\"), Cells(j, \"VR\")).PasteSpecial xlPasteValues\n    End If\n    i = i + 1\nLoop Until i = lastrow1 + 1 Or j = lastrow3 + 1\n</code></pre>\n\n<p>This still leaves the question raised by PartyHatPanda of why you are checking against <code>j</code> to end the loop when <code>j</code> isn't changing, so there may be a deeper error in your logic. ie if <code>j</code> should be increasing as well, then the assignment of <code>monthsj</code> should also be brought into the loop in the same way.</p>\n"}], "owner": {"reputation": 1, "user_id": 7032092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c910799ca5e6f6659ff997efee363a92?s=128&d=identicon&r=PG&f=1", "display_name": "excel user 2016", "link": "https://stackoverflow.com/users/7032092/excel-user-2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477914611, "creation_date": 1477492089, "last_edit_date": 1531164843, "question_id": 40264974, "link": "https://stackoverflow.com/questions/40264974/copy-paste-a-range-of-data-from-non-contiguous-to-non-contiguous-columns-in-a-di", "title": "copy/paste a range of data from non contiguous to non-contiguous columns in a different worksheet based on condition", "body": "<p>So following the prious question (<a href=\"https://stackoverflow.com/questions/40135104/vba-migrating-data-from-different-worksheets-to-one-worksheet-at-specific-locati\">VBA migrating data from different worksheets to one worksheet at specific locations</a>) I have edited the code to the following below based on posts from other code researchers/experts. </p>\n\n<p>The previous codes (see link) were working up to a certain point where a running time error would come up. I have followed the suggestions and removed .Select. and .Activate from the copy/paste operations however currently the code below does not do anything from the point 'copy from feedstock records sheet' onwards. I am sure I am doing something wrong or that I could approach my problem in a different way but I am struggling to find a solution. Does anyone have any ideas?</p>\n\n<p>After debugging I have managed to overcome the error 13 which was related to cells though defined as date the order of date was messed up and once I changed the order of the cells it was ok. However I know have the error 1004 as decribed in the comments below (see my last comment). I was wondering if anyone has any approche on how to solve this issue. I have marked where the error appears (it's on the second loop). in sht5 the date only starts on 01/01/2015 however sht4 starts on 07/08/2014. After I fixed the problem on the first days in 2014 the code was able to run until it reached the value 01/01/2015 when past special the range specified in <strong>bold</strong> below. Could anyone help? Thanks</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\n'open/close worksheets from huddle folder and teamviewer'\n\nDim Wb1 As Workbook\nDim Wb2 As Workbook\nDim Wb3 As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim sht3 As Worksheet\nDim sht4 As Worksheet\nDim sht5 As Worksheet\nDim i As Long, j As Long, k As Long, lastrow1 As Long, lastrow2 As Long, lastrow3 As Long\nDim monthsi As Date, monthsk As Date, monthsj As Date\n\nWith Application\n.ScreenUpdating = False\n.EnableEvents = False\n.DisplayAlerts = False\nEnd With\n\nSet Wb1 = Workbooks.Open(\"U:\\Data from plants\\Huddle\\EEL Feedstock Records -  NEW VERSION.xlsx\")\nSet Wb2 = Workbooks.Open(\"U:\\Data from plants\\Teamviewer\\EE.xlsx\")\nSet Wb3 = ThisWorkbook\nSet sht1 = Wb1.Sheets(\"Feedstock Usage (Non-beet site)\")\nSet sht2 = Wb2.Sheets(\"Sheet1\")\nSet sht3 = Wb3.Sheets(\"Feedstock records\")\nSet sht4 = Wb3.Sheets(\"Teamviewer\")\nSet sht5 = Wb3.Sheets(\"Plants data\")\n\nsht3.Cells.Delete Shift:=xlUp\nsht4.Cells.Delete Shift:=xlUp\n\nsht1.Cells.Copy\nsht3.Range(\"A1\").PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\nWb1.Close False\n\nsht2.Cells.Copy\nsht4.Range(\"A1\").PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\nWb2.Close False\n\n\n'copy from feedstock records sheet'\nlastrow1 = sht3.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\ni = 10\nlastrow2 = sht4.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nk = 4\nlastrow3 = sht5.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nj = 5\n\nDo\n    monthsi = sht3.Cells(i, \"C\").Value\n    If sht5.Cells(j, \"A\").Value = monthsi Then\n    sht3.Range(Cells(i, \"D\"), Cells(i, \"E\")).Copy\n    sht5.Range(Cells(j, \"VE\"), Cells(j, \"VF\")).PasteSpecial xlPasteValues\n    sht3.Range(Cells(i, \"G\"), Cells(i, \"H\")).Copy\n    sht5.Range(Cells(j, \"VI\"), Cells(j, \"VJ\")).PasteSpecial xlPasteValues\n    sht3.Range(Cells(i, \"J\"), Cells(i, \"K\")).Copy\n    sht5.Range(Cells(j, \"VM\"), Cells(j, \"VN\")).PasteSpecial xlPasteValues\n    sht3.Range(Cells(i, \"M\"), Cells(i, \"N\")).Copy\n    sht5.Range(Cells(j, \"VY\"), Cells(j, \"VZ\")).PasteSpecial xlPasteValues\n    sht3.Range(Cells(i, \"P\"), Cells(i, \"Q\")).Copy\n    sht5.Range(Cells(j, \"VQ\"), Cells(j, \"VR\")).PasteSpecial xlPasteValues\n    End If\n    i = i + 1\nLoop Until i = lastrow1 + 1\n\nDo\nmonthsk = sht4.Cells(k, \"A\").Value\n\n    If sht5.Cells(j, \"A\").Value = monthsk Then\n     sht4.Cells(k, \"H\").Copy\n     sht5.Cells(j, \"XW\").PasteSpecial xlPasteValues\n     sht4.Cells(k, \"I\").Copy\n     sht5.Cells(j, \"YJ\").PasteSpecial xlPasteValues\n     sht4.Range(Cells(k, \"J\"), Cells(k, \"O\")).Copy\n     **sht5.Range(Cells(j, \"ZK\"), Cells(j, \"ZP\")).PasteSpecial xlPasteValues**\n     sht4.Cells(k, \"U\").Copy\n     sht5.Cells(j, \"XU\").PasteSpecial xlPasteValues\n     sht4.Cells(k, \"X\").Copy\n     sht5.Cells(j, \"XV\").PasteSpecial xlPasteValues\n     sht4.Cells(k, \"Y\").Copy\n     sht5.Cells(j, \"YH\").PasteSpecial xlPasteValues\n     sht4.Cells(k, \"AB\").Copy\n     sht5.Cells(j, \"YI\").PasteSpecial xlPasteValues\n     sht4.Range(Cells(k, \"AN\"), Cells(i, \"AP\")).Copy\n     sht5.Range(Cells(j, \"XR\"), Cells(j, \"XT\")).PasteSpecial xlPasteValues\n     sht4.Cells(k, \"AQ\").Copy\n     sht5.Cells(j, \"XQ\").PasteSpecial xlPasteValues\n     End If\n     k = k + 1\nLoop Until k = lastrow2 + 1\n\nWith Application\n.ScreenUpdating = True\n.EnableEvents = True\n.DisplayAlerts = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477494981, "post_id": 40264880, "comment_id": 67792497, "body": "Try filename = path &amp; &quot;TD&quot; &amp; Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Text - assuming the IRN is in cell A1"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477495511, "post_id": 40264880, "comment_id": 67792859, "body": "See How to save it using cell value <a href=\"http://stackoverflow.com/a/30393989/4539709\">stackoverflow.com/a/30393989/4539709</a>"}, {"owner": {"reputation": 27, "user_id": 7070865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed3321db3825fa2249982f3d0442e9c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Price", "link": "https://stackoverflow.com/users/7070865/b-price"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477496200, "post_id": 40264880, "comment_id": 67793305, "body": "Thank you Om3r, I didn&#39;t include it in my text but the variable IRN was set to that specific cell in the sheet but it wouldn&#39;t include it in the filename for some reason, but linking directly to the cell like you indicated worked perfectly. Do you know how I can add the word doc as an attachment to my open Outlook email by chance?"}, {"owner": {"reputation": 27, "user_id": 7070865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed3321db3825fa2249982f3d0442e9c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Price", "link": "https://stackoverflow.com/users/7070865/b-price"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477496940, "post_id": 40264880, "comment_id": 67793794, "body": "I have tried it with Doc.filename and filename, neither work. I get an error that states &quot;Cannot find this file. Verify the path and file name are correct&quot;"}, {"owner": {"reputation": 27, "user_id": 7070865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed3321db3825fa2249982f3d0442e9c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Price", "link": "https://stackoverflow.com/users/7070865/b-price"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1477497582, "post_id": 40264880, "comment_id": 67794256, "body": "Ok sounds good. No unfortunately that file name or directory name is not valid"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7070865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed3321db3825fa2249982f3d0442e9c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Price", "link": "https://stackoverflow.com/users/7070865/b-price"}, "edited": false, "score": 1, "creation_date": 1477581690, "post_id": 40271309, "comment_id": 67835075, "body": "Sorry for the delay. I was able to get both aspects working. Thank you for all of your help Om3r!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1477512613, "creation_date": 1477512613, "answer_id": 40271309, "question_id": 40264880, "link": "https://stackoverflow.com/questions/40264880/attach-created-word-doc-to-outlook-message/40271309#40271309", "title": "Attach created Word doc to Outlook Message", "body": "<blockquote>\n  <p>Everything works perfectly, but now all I am trying to do is add to the Word doc the name of the string \"IRN\" which is a cell in the Excel worksheet. </p>\n</blockquote>\n\n<p>To get the Cell Value Try this</p>\n\n<p><strong><code>FileName = Path &amp; \"\\TD\" &amp; Sheets(\"Sheet1\").Range(\"A1\").Text &amp; \".docx\"</code></strong></p>\n\n<blockquote>\n  <p>I also need to attach the created Word doc to an Outlook message. </p>\n</blockquote>\n\n<p>To attached saved file, change this </p>\n\n<p><strong><code>objOutlookMsg.Attachments.Add Doc.filename</code></strong> To this \n<strong><code>ObjOutlookMsg.Attachments.Add (FileName)</code></strong></p>\n"}], "owner": {"reputation": 27, "user_id": 7070865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed3321db3825fa2249982f3d0442e9c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Price", "link": "https://stackoverflow.com/users/7070865/b-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 40271309, "answer_count": 1, "score": 1, "last_activity_date": 1593248332, "creation_date": 1477491855, "last_edit_date": 1593248332, "question_id": 40264880, "link": "https://stackoverflow.com/questions/40264880/attach-created-word-doc-to-outlook-message", "title": "Attach created Word doc to Outlook Message", "body": "<p>I have read numerous responses that are close to what I am looking for, but each time it doesn't work in my code. </p>\n\n<p>This should be a pretty basic question, but I am hoping someone can look at this and see my error quickly. </p>\n\n<p>I am using Excel to create a Word Doc which is then saved on the users Desktop in a folder named with the current date. </p>\n\n<p>Everything works perfectly, but now all I am trying to do is add to the Word doc the name of the string \"IRN\" which is a cell in the Excel worksheet. </p>\n\n<p>I also need to attach the created Word doc to an Outlook message. </p>\n\n<p>I will only include the intro and end of my code as the body should not matter.</p>\n\n<pre><code>Sub TDOutlook()\n\nDim TD As Word.Application\nDim Doc As Word.Document\nDim path As String\nDim filename As String\nDim StudentName As String\nDim StudentAddress1 As String\nDim City As String\nDim MrMrs As String\nDim StudentLast As String\nDim IRN As String\nDim CourseReq As String\nDim CourseName As String\nDim CourseStart As String\nDim Cost As String\nDim Deferred As String\nDim Graphic As String\nDim Footer1 As Word.Range\nDim Body As Word.Paragraph\nDim OutApp As Outlook.Application\nDim objOutlookMsg As Outlook.MailItem\n\npath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; Format(Now, \"mm-dd-yyyy\")\n    On Error Resume Next\n    MkDir path\n    On Error GoTo 0\n\n'Outlook\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet objOutlookMsg = OutApp.CreateItem(olMailItem)\n\nobjOutlookMsg.SentOnBehalfOfName = \"bbb@ppp.edu\"\nobjOutlookMsg.Subject = \"FinServ-TD\"\nobjOutlookMsg.HTMLBody = \"Testing this macro\" &amp; vbCrLf &amp; vbCrLf\n\n\n'Display Outlook\nobjOutlookMsg.Display\n\n'Opens Word\nSet TD = CreateObject(\"Word.Application\")\n\n'Displays the document\nTD.Visible = False\n\n'Add New Document\nSet Doc = TD.Documents.Add\n\nfilename = path &amp; \"\\TD\" '&amp; IRN\nDoc.SaveAs filename\n\n'Attach Word to Outlook\nobjOutlookMsg.Attachments.Add Doc.filename    &lt;----This is broken\n\nDoc.Close\n\nTD.Quit\n\n'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vb.net", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477570023, "post_id": 40264945, "comment_id": 67826607, "body": "thank you for this quick answer.  But I am having a new error message: Method &#39;Open&#39; of object _recordset&#39; failed. Here is my request: SELECT * FROM TABLE WHERE T2.<code>R&#233;pondu le</code> IS NULL AND (CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30)) = &#39;3&#39;  OR CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30)) = &#39;F&#39;)"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477570390, "post_id": 40264945, "comment_id": 67826844, "body": "Yes. there was an parenthesis error near cast. I fixed it"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477570436, "post_id": 40264945, "comment_id": 67826882, "body": "yes it is a column and there are back quotes, used, the # is replacing dot (.)"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477570478, "post_id": 40264945, "comment_id": 67826909, "body": "method Open is failing. SELECT * FROM [sheet1$] as T2 WHERE T2.<code>R&#233;pondu le</code> IS NULL AND (CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30) )= &#39;3&#39;  OR CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30)) = &#39;F&#39;)"}, {"owner": {"reputation": 11618, "user_id": 4964923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Q3Dk.jpg?s=128&g=1", "display_name": "Jaydip Jadhav", "link": "https://stackoverflow.com/users/4964923/jaydip-jadhav"}, "reply_to_user": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477570555, "post_id": 40264945, "comment_id": 67826953, "body": "Not sure but it is your code level error. if possible update your quetion with some more details"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477576312, "post_id": 40264945, "comment_id": 67831129, "body": "&quot;SELECT * from [Active_CD_PDX_ECM_Users$] AS T2 WHERE T2.<code>R&#233;pondu le</code> IS NULL AND (CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30) )= &#39;3&#39;  OR CAST(T2.<code>Typ# Mod#</code> AS VARCHAR(30)) = &#39;F&#39;) &quot;     It generate a runtime error - Method &#39;Open&#39; Of Object _Recordset failed"}, {"owner": {"reputation": 11618, "user_id": 4964923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Q3Dk.jpg?s=128&g=1", "display_name": "Jaydip Jadhav", "link": "https://stackoverflow.com/users/4964923/jaydip-jadhav"}, "reply_to_user": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477576582, "post_id": 40264945, "comment_id": 67831299, "body": "It wont helpful until and unless you update your question with more detail"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477576689, "post_id": 40264945, "comment_id": 67831384, "body": "with My_sql_cmd_string(index) =&quot;SELECT * FROM [sheet1$] as T2 WHERE T2.R&#233;pondu le IS NULL AND (CAST(T2.Typ# Mod# AS VARCHAR(30) )= &#39;3&#39; OR CAST(T2.Typ# Mod# AS VARCHAR(30)) = &#39;F&#39;) &quot;"}, {"owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "edited": false, "score": 0, "creation_date": 1477576784, "post_id": 40264945, "comment_id": 67831471, "body": "What do you mean with more details? what other details would you like to get?   the code level::: objRecordset_tab(index).Open My_sql_cmd_string(index), _                 ObjConnection_tab(index), adOpenStatic, adLockOptimistic, adCmdText"}], "tags": [], "owner": {"reputation": 11618, "user_id": 4964923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Q3Dk.jpg?s=128&g=1", "display_name": "Jaydip Jadhav", "link": "https://stackoverflow.com/users/4964923/jaydip-jadhav"}, "is_accepted": false, "score": 0, "last_activity_date": 1477492011, "creation_date": 1477492011, "answer_id": 40264945, "question_id": 40264800, "link": "https://stackoverflow.com/questions/40264800/vb-sql-query-on-field-of-different-types/40264945#40264945", "title": "vb sql query on field of different types", "body": "<p>There may be another solution to this problem, but you can use this approach as well</p>\n\n<pre><code>SELECT * \nFROM TABLE \nWHERE CAST(param AS VARCHAR(30)) = '3' OR CAST(param AS VARCHAR(30)) = 'F'\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7075502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3b938a5630a7d1cdae1469dfdd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Matt-Blois", "link": "https://stackoverflow.com/users/7075502/matt-blois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477492011, "creation_date": 1477491625, "last_edit_date": 1531164843, "question_id": 40264800, "link": "https://stackoverflow.com/questions/40264800/vb-sql-query-on-field-of-different-types", "title": "vb sql query on field of different types", "body": "<p>I am using SQL command with VB on recordset object.\nI am retrieving data from a table in excel, my column of data(param) contains 2 types of data either numbers or characters.\nWhen I run the query I get a type mismatch error.\nthe query is for instance: </p>\n\n<pre><code>SELECT * FROM TABLE WHERE param=3 OR param=F\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>SELECT * FROM TABLE WHERE param=3 OR param='F'\n</code></pre>\n\n<p>with quotes and same miss match error</p>\n\n<p>When I try:</p>\n\n<pre><code>SELECT * FROM TABLE WHERE param=3 \n</code></pre>\n\n<p>the query returns data correctly.</p>\n\n<p>any idea what I need to do?</p>\n\n<p>thanks for your help.</p>\n"}, {"tags": ["vba", "macros", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1477550793, "post_id": 40273632, "comment_id": 67814485, "body": "i find the solution by looping the shape. Thanks Jamie"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1477523800, "creation_date": 1477523800, "answer_id": 40273632, "question_id": 40264771, "link": "https://stackoverflow.com/questions/40264771/vba-powerpoint-to-delete-a-textbox/40273632#40273632", "title": "VBA Powerpoint to delete a TextBox", "body": "<p>Are your shapes positioned EXACTLY as per the values in you code. You can check by selecting them in turn and typing the following in the immediate window:</p>\n\n<pre><code>?ActiveWindow.Selection.ShapeRange(1).Left\n\n?ActiveWindow.Selection.ShapeRange(1).Top\n</code></pre>\n\n<p>Also, you can optimise the code by looping through the shapes once and evaluating all 3 positioning conditions only once on each shape. </p>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 811, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477523800, "creation_date": 1477491552, "question_id": 40264771, "link": "https://stackoverflow.com/questions/40264771/vba-powerpoint-to-delete-a-textbox", "title": "VBA Powerpoint to delete a TextBox", "body": "<p>I want to delete three TextBox that are in the first slide. I wrote this code but it doesn't work!!\nThis is my code: </p>\n\n<pre><code>Sub deleteTextBox()\nDim osld As Slide\nDim oShp As Shape\nDim oShp1 As Shape\nDim oShp2 As Shape\nSet osld = ActivePresentation.Slides(1)\nFor Each oShp In osld.Shapes\nIf oShp.HasTextFrame Then\nIf oShp.Left = 20 And oShp.Top = 150 Then\noShp.Delete\nEnd If\nEnd If\nNext oShp\nFor Each oShp1 In osld.Shapes\nIf oShp1.HasTextFrame Then\nIf oShp1.Left = 20 And oShp1.Top = 200 Then\noShp1.Delete\nEnd If\nEnd If\nNext oShp1\nFor Each oShp2 In osld.Shapes\nIf oShp2.HasTextFrame Then\nIf oShp2.Left = 35 And oShp2.Top = 490 Then\noShp2.Delete\nEnd If\nEnd If\nNext oShp2\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477490664, "post_id": 40264050, "comment_id": 67789270, "body": "why are you describing the file name dates as being separated by &quot;.&quot; but in your formula they are separated by &quot;-&quot;. Is that intentional?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477491753, "post_id": 40264050, "comment_id": 67790062, "body": "or Record Macro of <code>Data</code> tab &gt; <code>Edit Links</code> &gt; <code>Change Source...</code> and check the generated VBA code ( sorry, I have a bad habit of answering before I read the question :] )"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477491950, "post_id": 40264050, "comment_id": 67790199, "body": "I think all of this would be a lot easier using only VBA..."}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1477492131, "post_id": 40264050, "comment_id": 67790314, "body": "it will replace 05.10.2016 with &quot;A1&quot; - not the value, just &quot;A1&quot;."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1477492300, "post_id": 40264050, "comment_id": 67790431, "body": "<code>[e3:e4].Replace &quot;[dones 05.10.2016.xls]&quot;, &quot;[dones &quot; &amp; [a1] &amp; &quot;.xls]&quot;, xlPart</code> ?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1477492638, "post_id": 40264050, "comment_id": 67790691, "body": "The problem is that i don&#39;t know the dates from E3:E4 , F3:F4...  and even from A1,A2... to make a standard."}], "answers": [{"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1477492787, "last_edit_date": 1477492787, "creation_date": 1477490982, "answer_id": 40264559, "question_id": 40264050, "link": "https://stackoverflow.com/questions/40264050/how-can-i-replace-only-the-date-in-a-filename-with-vba/40264559#40264559", "title": "How can I replace only the date in a filename with VBA?", "body": "<p>You will need to work with the string functions <code>InStr</code> and <code>Mid</code> here. Maybe this can help you:</p>\n\n<pre><code>Dim str As String\nDim intPos1 As Integer\nDim intPos2 As Integer\nDim intLastPos As Integer\n\n'Formula as string\n   str = \"\\\\share\\done\\[dones 05-10-2016.xls]done'!$A$2:$A$49,0),0),VLOOKUP($C3,'\\\\share\\done\\[dones 05-10-2016.xls]done\"\n\n'Get the start and the End Position of the First Excel File\n  intPos1 = InStr(1, str, \"[dones\") - 1\n  intPos2 = InStr(1, str, \".xls\") + 5\n\n'Save the Last Postion for the second Replacement\n  intLastPos = intPos2\n\n\n'Replace old  File with [dones 01-10-1911.xls]\n\n  str = Mid(str, 1, intPos1) &amp; \"[dones 01-10-1911.xls]\" &amp; Mid(str, intPos2, Len(str))\n\n'Get the start and the End Position of the second Excel File\n  intPos1 = InStr(intLastPos, str, \"[dones\")\n  intPos2 = InStr(intLastPos, str, \".xls\")\n\n\n'Replace the second File with [dones 01-10-1911.xls]\n  str = Mid(str, 1, intPos1) &amp; \"[dones 01-10-1911.xls]\" &amp; Mid(str, intPos2, Len(str))\n</code></pre>\n\n<p>After that you can read back the formula.</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1477636916, "post_id": 40265338, "comment_id": 67856616, "body": "Thank you verrry much for your help. Works for other file names too :) . Now i can modify for ~ 800 files :D ."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 4, "last_activity_date": 1477494793, "last_edit_date": 1477494793, "creation_date": 1477493093, "answer_id": 40265338, "question_id": 40264050, "link": "https://stackoverflow.com/questions/40264050/how-can-i-replace-only-the-date-in-a-filename-with-vba/40265338#40265338", "title": "How can I replace only the date in a filename with VBA?", "body": "<pre><code>Sub modify()\n    Dim c As Range, r As Range\n    Set c = [a1]\n    Set r = [e3:e4]\n    Application.DisplayAlerts = False ' optional to hide dialogs\n\n    While c &gt; \"\"\n        Debug.Print c.Address(0, 0), r.Address(0, 0) ' optional to check the address\n\n        r.Replace \"[dones ??.??.????.xls]\", \"[dones \" &amp; c &amp; \".xls]\", xlPart\n        Set c = c.Offset(1, 0) ' A1 to A2\n        Set r = r.Offset(0, 1) ' E3:E4 to F3:F4\n    Wend\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Replace with wildcards:</p>\n\n<pre><code>[e3:e4].Replace \"[dones ??.??.????.xls]\", \"[dones \" &amp; [a1] &amp; \".xls]\", xlPart\n</code></pre>\n\n<p><code>?</code> matches any single character and <code>*</code> can be used to match 0 or more characters:</p>\n\n<pre><code>[e3:e4].Replace \"[*.xls*]\", \"[dones \" &amp; [a1] &amp; \".xls]\", xlPart\n</code></pre>\n\n<p><a href=\"https://www.ablebits.com/office-addins-blog/2015/09/29/using-excel-find-replace/#find-replace-wildcards\" rel=\"nofollow\">https://www.ablebits.com/office-addins-blog/2015/09/29/using-excel-find-replace/#find-replace-wildcards</a></p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1477493888, "creation_date": 1477493888, "answer_id": 40265659, "question_id": 40264050, "link": "https://stackoverflow.com/questions/40264050/how-can-i-replace-only-the-date-in-a-filename-with-vba/40265659#40265659", "title": "How can I replace only the date in a filename with VBA?", "body": "<p>Instead of hard-coding <code>\"dones 05.10.2016.xls\"</code>, you'll have to <em>build</em> that string from the cell values. Also, you'll need some looping logic to track which row you're reading from and which column you're writing to.</p>\n\n<p>Assuming a date read in row 1 goes in column 5, a date read in row 2 goes in column 6, and so on, something like this should be good enough:</p>\n\n<pre><code>Dim targetColumn As Long\nDim sourceRow As Long\n\nWith ActiveSheet\n    For sourceRow = 1 To WhateverTheLastRowIs\n        targetColumn = 4 + sourceRow 'column 5 / \"E\" for sourceRow 1\n\n        Dim sourceDateValue As Variant\n        sourceDateValue = .Cells(sourceRow, 1).Value\n        Debug.Assert VarType(sourceDateValue) = vbDate\n\n        Dim formattedSourceDate As String\n        formattedSourceDate = Format(sourceDateValue.Value, \"MM.DD.YYYY\")\n\n        'replace string in rows 3 &amp; 4 of targetColumn:\n        .Range(.Cells(3, targetColumn), .Cells(4, targetColumn) _\n            .Replace \"[*.xls]\", \"[dones \" &amp; formattedSourceDate &amp; \".xls]\", xlPart\n    Next\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1477518788, "creation_date": 1477518788, "answer_id": 40272718, "question_id": 40264050, "link": "https://stackoverflow.com/questions/40264050/how-can-i-replace-only-the-date-in-a-filename-with-vba/40272718#40272718", "title": "How can I replace only the date in a filename with VBA?", "body": "<p>My understanding of the requirements is this:</p>\n\n<ol>\n<li>There is a List of Dates in Column A starting at Row 1</li>\n<li>A formula needs to be entered in rows <code>3:4</code> starting in Column <code>E</code> and moving one column to the right for each value in the List of Dates, i.e. Formula in column <code>E</code> has date from row <code>1</code>, column <code>F</code> has date from row <code>2</code>, \u2026</li>\n<li><p>This is the formula, in which the date <code>05.10.2016</code> in the filename <code>'\\\\share\\done\\[dones 05.10.2016.xls]done</code> should be update with corresponding value from the List of Dates as per point 2.</p>\n\n<p><code>=IF(\nIFERROR(MATCH($C3,'\\\\share\\done\\[dones 05.10.2016.xls]done'!$A$2:$A$49,0),0),\nVLOOKUP($C3,'\\\\share\\done\\[dones 05.10.2016.xls]done'!$A$2:$B$49,2,FALSE),0)</code></p></li>\n</ol>\n\n<p>This solution assumes the dates in column <code>A</code> are already formated as required by the filename link.</p>\n\n<p>This solution uses a variable to hold the Link Formula and another variable to update the Link Formula with each Value in the List of Dates.\nAlso to simplify the update\\replacement of the date let\u2019s change the original date in the formula for <code>05.10.2016</code> for an unique key such as <code>#DATE</code> </p>\n\n<pre><code>Dim sFmlLink As String, sFml As String\nsFmlLink = \"=IF(\" &amp; Chr(10) &amp; _\n    \"IFERROR(MATCH($C3,'\\\\share\\done\\[dones #DATE.xls]done'!$A$2:$A$49,0),0),\" &amp; Chr(10) &amp; _\n    \"VLOOKUP($C3,'\\\\share\\done\\[dones #DATE.xls]done'!$A$2:$A$49,2,FALSE),0)\"\n</code></pre>\n\n<p>Then we set a Range with the List of Dates and loop trough it to update and enter the formula as per point 2.</p>\n\n<pre><code>Sub FormulaLink()\nDim sFmlLink As String, sFml As String\nsFmlLink = \"=IF(\" &amp; Chr(10) &amp; _\n    \"IFERROR(MATCH($C3,'\\\\share\\done\\[dones #DATE.xls]done'!$A$2:$A$49,0),0),\" &amp; Chr(10) &amp; _\n    \"VLOOKUP($C3,'\\\\share\\done\\[dones #DATE.xls]done'!$A$2:$A$49,2,FALSE),0)\"\nDim rDates As Range, lRow As Long, iCol As Integer\n\n    Rem Set Start Column\n    iCol = 5\n    With ThisWorkbook.Sheets(\"DATA\")\n        Rem Set Dates List Range\n        Set rDates = Range(.Cells(1), .Cells(Rows.Count, 1).End(xlUp))\n        Rem Enter Link Formula in Rows 3:4, starting at Column 5\n        Rem and moving one column to the right for each Date in Column A\n        For lRow = 1 To rDates.Rows.Count\n            Rem Refresh Link Formula with Date from Column A\n            sFml = Replace(sFmlLink, \"#DATE\", rDates.Cells(lRow).Value)\n            Rem Enter Formula in Column iCol Rows 3:4\n            .Cells(3, iCol).Resize(2).Formula = sFml\n            Rem Move One Column to the right\n            iCol = 1 + iCol\n    Next: End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 40265338, "answer_count": 4, "score": 2, "last_activity_date": 1477518788, "creation_date": 1477489605, "last_edit_date": 1477496748, "question_id": 40264050, "link": "https://stackoverflow.com/questions/40264050/how-can-i-replace-only-the-date-in-a-filename-with-vba", "title": "How can I replace only the date in a filename with VBA?", "body": "<p><strong>I have the following formula:</strong></p>\n\n<pre><code>=IF(IFERROR(MATCH($C3,'\\\\share\\done\\[dones 05.10.2016.xls]done'!$A$2:$A$49,0),0),VLOOKUP($C3,'\\\\share\\done\\[dones 05.10.2016.xls]done'!$A$2:$B$49,2,FALSE),0)\n</code></pre>\n\n<p>In <code>A1</code> I have another date: <code>10.10.2016</code></p>\n\n<p>How can I replace <em>only the date</em> that is in the file name from the formula?</p>\n\n<p>Until now, I've been using this:</p>\n\n<pre><code>Sub modify()\n    Dim a As Range\n    Set a = Range(\"a1\")\n    [e3:e4].Replace \"dones 05.10.2016.xls\", (\"dones \" &amp; a &amp; \".xls\"), xlPart\nEnd Sub\n</code></pre>\n\n<p>The problem that in <code>A2</code> I have another date and <code>F3:F4</code> must have the date from <code>A2</code>, and so on until <code>A300</code>. <strong>How can I replace only the date of the file name in the formula?</strong>  </p>\n\n<p>The names of the files are standard: <code>dones dd.mm.yyyy.xls</code></p>\n"}, {"tags": ["excel", "loops", "if-statement", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1477489953, "post_id": 40264027, "comment_id": 67788738, "body": "Comment out <code>On Error Resume Next</code> and see if you&#39;re getting run-time errors."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1477492285, "post_id": 40264027, "comment_id": 67790419, "body": "<code>.Select</code> should, by good VBA code writing practice, be avoided if possible. I&#39;ll <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">leave this here</a> for you to read through. It will help you in the long run if you plan to continue writing VBA. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 2, "last_activity_date": 1477491883, "last_edit_date": 1477491883, "creation_date": 1477491539, "answer_id": 40264767, "question_id": 40264027, "link": "https://stackoverflow.com/questions/40264027/loop-as-if-condition/40264767#40264767", "title": "Loop as if condition", "body": "<p>Always use <code>Option Explicit</code> at the beginning. That would have flagged up to you that you dim and set <code>LastRow_2</code>, and then try to use <code>Last_row_2</code>...</p>\n"}, {"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1477528148, "last_edit_date": 1525816189, "creation_date": 1477495996, "answer_id": 40266424, "question_id": 40264027, "link": "https://stackoverflow.com/questions/40264027/loop-as-if-condition/40266424#40266424", "title": "Loop as if condition", "body": "<h2>Code Review</h2>\n\n<p><em><strong>I don't think your question applies to your problem after careful review of your code. You had many errors present which I've corrected for you below:</strong></em></p>\n\n<pre><code>Option Explicit\nSub Sort3()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"EQ_CLEAN\")\n    Dim LastRow As Long, LastRow_2 As Long\n    Dim lenght As String\n    Dim L_text As String, R_text As String, M_text As String\n    Dim n As Long, x As Long, i As Long\n\n    LastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row\n\n    LastRow_2 = ws.Cells(ws.Rows.Count, \"J\").End(xlUp).Row\n\n    For i = 2 To LastRow\n\n        lenght = ws.Range(\"G\" &amp; i).Value\n\n        If Len(lenght) = 25 Then\n\n            L_text = Left(ws.Range(\"A\" &amp; i).Value, 12)\n            R_text = Right(ws.Range(\"A\" &amp; i).Value, 12)\n\n            For x = 2 To LastRow_2\n\n                'On Error Resume Next 'You should never use this unless you know exactly which error\n                'is popping up and why it can't be avoided. Usually this is for 1004 errors that occur\n                'outside of excel... It's better to use proper error handling instead of skipping all errors.\n                'You also never tell excel to recognize errors via On Error GoTo 0. I advise you stay away\n                'from handling errors with these two statements.\n\n                'don't make it a habit to assign rogue variables values\n                n = ws.Range(\"D1:D6000\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n                If L_text &lt;&gt; ws.Range(\"J\" &amp; x).Value Then\n                    ws.Range(ws.Cells(x, 1), ws.Cells(x, 2)).Copy\n                    ws.Range(\"D\" &amp; (n + 1)).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n                        SkipBlanks:=False, Transpose:=False\n                    Application.CutCopyMode = xlCopy 'this is the proper format to remove the marching ants\n                End If\n            Next x\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>I tried to put comments where changes were made.</em></p>\n\n<p>I ran your code on a blank sheet and it doesn't throw any errors. See if it achieves what you're looking for.</p>\n\n<hr>\n\n<h2>Literature To Reference</h2>\n\n<p><strong><a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">Error Handling</a></strong></p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoiding Use of <code>.Select</code></a></strong></p>\n\n<p><strong><a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow noreferrer\">What Microsoft says about Option Explicit</a></strong></p>\n\n<p><strong><a href=\"http://www.homeandlearn.org/other_excel_vba_ariable_types.html\" rel=\"nofollow noreferrer\">Why I changed your Row based variables to Long</a></strong></p>\n"}], "owner": {"reputation": 1, "user_id": 7044394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4b37df6692ce57b20af3d52c4883e1?s=128&d=identicon&r=PG&f=1", "display_name": "mach08ag", "link": "https://stackoverflow.com/users/7044394/mach08ag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477528148, "creation_date": 1477489553, "last_edit_date": 1531164843, "question_id": 40264027, "link": "https://stackoverflow.com/questions/40264027/loop-as-if-condition", "title": "Loop as if condition", "body": "<p>I have the following question. </p>\n\n<p>In the below code i am trying to get my sub to run a loop after the if then statement, and then have the code go back to the first loop and start from the next i. In my below code,everything works fine, but when the condition in the first IF- statement is met, it starts the second loop, but then imidiately exits it again without running it. </p>\n\n<p>So my question is, how do you make a loop after the then statement in a IF- statement? </p>\n\n<pre><code>Sub Sort3()\n\n    Dim i As Integer\n    Dim LastRow As Long\n    Dim lenght As String\n    Dim LastRow_2 As String\n    Dim L_text As Variant\n    Dim R_text As Variant\n    Dim M_text As Variant\n\n    ThisWorkbook.Sheets(\"EQ_CLEAN\").Select\n\n    LastRow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\n    LastRow_2 = Range(\"J\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow\n\n        lenght = Range(\"G\" &amp; i)\n\n        If Len(lenght) = 25 Then\n\n            L_text = Left(Range(\"A\" &amp; i), 12)\n            R_text = Right(Range(\"A\" &amp; i), 12)\n\n            For x = 2 To Last_row_2\n\n                On Error Resume Next\n                n = Worksheets(\"EQ_CLEAN\").Range(\"D1:D6000\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n                If L_text &lt;&gt; Sheets(\"EQ_CLEAN\").Range(\"J\" &amp; x) Then\n\n                    Sheets(\"EQ_CLEAN\").Range(Cells(x, 1), Cells(x, 2)).Select\n                    Application.CutCopyMode = False\n                    Selection.Copy\n                    Range(\"D\" &amp; (n + 1)).Select\n                    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n                    SkipBlanks:=False, Transpose:=False\n                End If\n            Next x\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "reminders"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477490925, "post_id": 40264020, "comment_id": 67789443, "body": "Do you have a table called Status?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477492505, "post_id": 40264020, "comment_id": 67790581, "body": "No, do I need to have a table for each? I was hoping I could use the headers under the table for Tasks since the form I&#39;m using adds all the information there."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477492725, "post_id": 40264020, "comment_id": 67790752, "body": "<code>DCount</code>&#39;s 3 arguments are <code>field</code>, <code>table&#47;query</code>, <code>expression</code>. You&#39;ve put &quot;Status&quot; in the part where it&#39;s expecting a <code>table&#47;query</code>, and since you don&#39;t have a table/query with that name, it&#39;s triggering the error. I think if you just replace &quot;Status&quot; with &quot;Tasks&quot; it will probably work.. let us know if doesn&#39;t and what error message you get."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477493506, "post_id": 40264020, "comment_id": 67791370, "body": "Okay so using the following code   <code>intStore = DCount(&quot;[TaskName]&quot;, &quot;[Tasks]&quot;, &quot;[DueDate] &lt;=Now() AND [Complete] =0&quot;)</code>    I get the following error: &quot;the expression you entered as a query parameter produced this error: &#39;[TaskName]&#39;"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477494434, "post_id": 40264020, "comment_id": 67792100, "body": "Are <code>TaskName</code>, <code>DueDate</code> and <code>Complete</code> all fields in the <code>Tasks</code> table and spelled as shown? You mentioned in your original question that you have a field called <code>Task Name</code>.. suggesting it has a space. If it has a space you need to to write it as <code>DCount(&quot;[Task Name]&quot;, ...</code>"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477496083, "post_id": 40264020, "comment_id": 67793234, "body": "I added the spaces but having a strange issue. Task Name works but Due Date and Percent Complete say &quot;The expression you entered as a query parameter produced this error &quot;[Due Date]&quot; and this happens for both. if I remove the space they go through and the pop up comes up (progress!!) but it opens Form1 but the other form that&#39;s supposed to come up and show me the uncompleted tasks doesn&#39;t appear."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477497639, "post_id": 40264020, "comment_id": 67794295, "body": "You have to refer to the field names <i>exactly</i> how you set them up for the table. I&#39;m not too sure on the issue with the form not opening.. possibly need to reselect the form you want to minimize before minimizing it. Take a look at <code>DoCmd.SelectObject</code> <a href=\"https://technet.microsoft.com/en-us/library/ff835629\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/ff835629</a>"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477498621, "post_id": 40264020, "comment_id": 67794907, "body": "Okay so quick update. I&#39;ve got the pop up working, it&#39;s showing the proper number of items uncompleted etc... the problem I&#39;m having now is, while it opens the main form (Form1) and it opens a form I created called &quot;Tasks&quot; which displays the task records. It doesn&#39;t exactly show only the uncompleted tasks like I&#39;m hoping for. Is there something I need to do to the &quot;Tasks&quot; form I created so it shows only those items that are uncompleted and not all the records? I&#39;ll update the code above"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477561667, "post_id": 40264020, "comment_id": 67821165, "body": "You&#39;ll need to filter the Tasks form I would think.. perhaps start a new question at this stage as I think this is moving away from the original coding problem you raised."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1477574056, "post_id": 40264020, "comment_id": 67829422, "body": "I will do that Matt. Thanks so much for all your help!!!"}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "is_accepted": true, "score": 1, "last_activity_date": 1477493009, "creation_date": 1477493009, "answer_id": 40265313, "question_id": 40264020, "link": "https://stackoverflow.com/questions/40264020/ms-access-code-issue-for-reminders/40265313#40265313", "title": "MS Access Code issue for Reminders", "body": "<p>You can only perform a DCount on one field (primary key is best if you are just doing a general count on the table). You have entered \"[Status]\" where Access is expecting a table or query name to be used as the source of the [TaskName] field.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/office/aa211471(v=office.11).aspx\" rel=\"nofollow\">here</a> for more information.</p>\n\n<p>Judging by your other code example I expect that your code needs to be:</p>\n\n<pre><code>intStore = DCount(\"[TaskName]\", \"[Tasks]\", \"[DueDate] &lt;=Now() AND [Complete] =0\")\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 40265313, "answer_count": 1, "score": 0, "last_activity_date": 1477571251, "creation_date": 1477489538, "last_edit_date": 1477571251, "question_id": 40264020, "link": "https://stackoverflow.com/questions/40264020/ms-access-code-issue-for-reminders", "title": "MS Access Code issue for Reminders", "body": "<p>I'm trying to setup reminders based on tasks added from a Table called \"Tasks\" Here is the code I'm using but something isn't right as it keeps giving me issues with the following line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>intStore = DCount(\"[TaskName]\", \"[Status]\", \"[DueDate] &lt;=Now() AND [Complete] =0\")\n</code></pre>\n\n<p>When the code runs I get the error:</p>\n\n<blockquote>\n  <p>Microsoft Access database engine cannot find the input table or query\n  for 'Status' Make sure it exists and is spelled correctly.</p>\n</blockquote>\n\n<p>In my table I have fields for <strong>Task Name</strong>, <strong>Status</strong>, and <strong>Due Date</strong> so I'm not exactly sure why this is coming up. </p>\n\n<p>Below is the entire line of code: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n\n    'On Load of the switchboard check Jobs table for any uncompleted jobs\n\n    Dim intStore As Integer\n\n    intStore = DCount(\"[Priority]\", \"[Tasks]\", \"[DueDate] &lt;=Now() AND [PercentComplete] &lt;=0\")\n\n    If intStore = 0 Then\n        Exit Sub\n    Else        \n        If MsgBox(\"There are \" &amp; intStore &amp; \" uncompleted jobs\" &amp; _\n        vbCrLf &amp; vbCrLf &amp; \"Would you like to see these now?\", _\n        vbYesNo, \"You Have Uncomplete Jobs...\") = vbYes Then\n            DoCmd.Minimize\n            DoCmd.OpenForm \"Tasks\", acNormal\n        Else\n            Exit Sub\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "ms-office", "ribbon", "ribbonx"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1480088011, "post_id": 40808260, "comment_id": 68837262, "body": "Actually, that&#39;s the reverse of what you want, isn&#39;t it? This will import a ribbon, not export."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "edited": false, "score": 0, "creation_date": 1480938022, "post_id": 40808260, "comment_id": 69155883, "body": "Yes, this is reverse of that what I want. Thanks anyway."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "is_accepted": false, "score": 0, "last_activity_date": 1480087886, "creation_date": 1480087886, "answer_id": 40808260, "question_id": 40263993, "link": "https://stackoverflow.com/questions/40263993/how-to-export-whole-custom-ribbon-xml-using-vba/40808260#40808260", "title": "How to export whole custom ribbon xml using VBA", "body": "<p>Try <a href=\"https://msdn.microsoft.com/en-us/library/office/ee767705(v=office.14).aspx\" rel=\"nofollow\">this</a> link from Microsoft. The core of the code is here:</p>\n\n<pre><code>Private Sub AddHighlightRibbon()\nDim ribbonXml As String\n\nribbonXml = \"&lt;mso:customUI xmlns:mso=\"\"http://schemas.microsoft.com/office/2009/07/customui\"\"&gt;\"\nribbonXml = ribbonXml + \"  &lt;mso:ribbon&gt;\"\nribbonXml = ribbonXml + \"    &lt;mso:qat/&gt;\"\nribbonXml = ribbonXml + \"    &lt;mso:tabs&gt;\"\nribbonXml = ribbonXml + \"      &lt;mso:tab id=\"\"highlightTab\"\" label=\"\"Highlight\"\" insertBeforeQ=\"\"mso:TabFormat\"\"&gt;\"\nribbonXml = ribbonXml + \"        &lt;mso:group id=\"\"testGroup\"\" label=\"\"Test\"\" autoScale=\"\"true\"\"&gt;\"\nribbonXml = ribbonXml + \"          &lt;mso:button id=\"\"highlightManualTasks\"\" label=\"\"Toggle Manual Task Color\"\" \"\nribbonXml = ribbonXml + \"imageMso=\"\"DiagramTargetInsertClassic\"\" onAction=\"\"ToggleManualTasksColor\"\"/&gt;\"\nribbonXml = ribbonXml + \"        &lt;/mso:group&gt;\"\nribbonXml = ribbonXml + \"      &lt;/mso:tab&gt;\"\nribbonXml = ribbonXml + \"    &lt;/mso:tabs&gt;\"\nribbonXml = ribbonXml + \"  &lt;/mso:ribbon&gt;\"\nribbonXml = ribbonXml + \"&lt;/mso:customUI&gt;\"\n\nActiveProject.SetCustomUI (ribbonXml)\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480087886, "creation_date": 1477489483, "question_id": 40263993, "link": "https://stackoverflow.com/questions/40263993/how-to-export-whole-custom-ribbon-xml-using-vba", "title": "How to export whole custom ribbon xml using VBA", "body": "<p>I'm working with VBA in Word.\nI have to have a copy of my work in txt files.\nI'm saving content of every module/class/form.</p>\n\n<p>Now, I need to save also custom ribbon.\nI don't know how to get access to ribbon xml.\nI know how to manipulate my ribbons (create or disable/enable buttons and other funny things) but I dont know how to get whole xml.</p>\n\n<p>I'm generating my txt files using BeforeSave event (before every save I make a txt copy of my macros) - I'd like to save copy of ribbon too.</p>\n\n<p>There are a lot of examples how to load or change ribbon, but about exporting existing ribbon using VBA I can't find anything.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1477489308, "creation_date": 1477489308, "answer_id": 40263914, "question_id": 40263740, "link": "https://stackoverflow.com/questions/40263740/delete-activex-checkboxes-in-selection/40263914#40263914", "title": "Delete Activex checkboxes in selection", "body": "<p>This will delete all ActiveX Checkboxes within a selection:</p>\n\n<pre><code>Sub DeleteActiveXCheckboxes()\n\nDim Shape As Shape\n\nFor Each Shape In ActiveSheet.Shapes\n    If Shape.Type = 12 Then\n        If Not Intersect(Shape.TopLeftCell, Selection) Is Nothing Then\n            Shape.Delete\n        End If\n    End If\nNext Shape\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1477489789, "post_id": 40264058, "comment_id": 67788605, "body": "Works great . Thanks"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1477489639, "creation_date": 1477489639, "answer_id": 40264058, "question_id": 40263740, "link": "https://stackoverflow.com/questions/40263740/delete-activex-checkboxes-in-selection/40264058#40264058", "title": "Delete Activex checkboxes in selection", "body": "<pre><code>If Not Intersect(rng, cbx.TopLeftCell) Is Nothing Then cbx.Delete\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 40264058, "answer_count": 2, "score": 0, "last_activity_date": 1477489639, "creation_date": 1477488862, "question_id": 40263740, "link": "https://stackoverflow.com/questions/40263740/delete-activex-checkboxes-in-selection", "title": "Delete Activex checkboxes in selection", "body": "<p>I was trying to write a macro that would delete all activex checkboxes within selected range. I wrote this code, but it keeps returning \"Object doesn't support this property or method\" error. Please help.</p>\n\n<pre><code>Dim cbx As OLEObject\nDim rng As Range\nSet rng = selection\nFor Each cbx In ActiveSheet.OLEObjects\n    If Not Intersect(rng, cbx.Object.TopLeftCell) Is Nothing Then cbx.Delete\nNext\n</code></pre>\n"}, {"tags": ["vba", "thomson-reuters-eikon"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 6749690, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47e66be475b356e41eb4f93162e47af1?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas K", "link": "https://stackoverflow.com/users/6749690/andreas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1478861964, "creation_date": 1478861964, "answer_id": 40546548, "question_id": 40263461, "link": "https://stackoverflow.com/questions/40263461/using-vba-to-execute-com-add-in-specific-formula/40546548#40546548", "title": "Using VBA to execute COM add-in specific formula", "body": "<p>I found out, that \"Cells(...).FormulaLocal\" does the trick.</p>\n"}], "owner": {"reputation": 63, "user_id": 6749690, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47e66be475b356e41eb4f93162e47af1?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas K", "link": "https://stackoverflow.com/users/6749690/andreas-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478861964, "creation_date": 1477488042, "question_id": 40263461, "link": "https://stackoverflow.com/questions/40263461/using-vba-to-execute-com-add-in-specific-formula", "title": "Using VBA to execute COM add-in specific formula", "body": "<p>I am trying to use a VBA macro to execute formulas in an excel sheet, which were added by an add-in. Specifically, the add-in is Thomson Reuter's Eikon and it provides functions starting with \"=TR(....)\".</p>\n\n<p>My add-in works as follows: It puts together the formula starting with \"=TR\" as a string. Than I want to paste these strings into an excel sheet, so that they are executed seperately. When I do so, I always get runtime error 1004.</p>\n\n<p>I tried to paste the formula using Cells().Formula, which works, if I try a standard excel formula. However, it does not work with the add-in specific formula. </p>\n"}, {"tags": ["excel", "vbscript", "powershell-2.0", "powershell-3.0", "vba"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1477492313, "post_id": 40263450, "comment_id": 67790443, "body": "<code>Get-Content</code> is for reading text files. Excel workbooks are not text files."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5669477, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69b47dc8fe7a37d12e4bd42622f2e261?s=128&d=identicon&r=PG&f=1", "display_name": "MMbill", "link": "https://stackoverflow.com/users/5669477/mmbill"}, "edited": false, "score": 0, "creation_date": 1477492735, "post_id": 40265045, "comment_id": 67790761, "body": "I&#39;ll give this a shot.  Thank you very much!"}], "tags": [], "owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "is_accepted": false, "score": 1, "last_activity_date": 1477492260, "creation_date": 1477492260, "answer_id": 40265045, "question_id": 40263450, "link": "https://stackoverflow.com/questions/40263450/script-to-compare-contrast-two-separate-excel-files-export-differences-for-bot/40265045#40265045", "title": "Script to compare/contrast two separate Excel files - export differences for both", "body": "<p>It might be faster to just copy and paste the names from File1 into column A of a new file, 'File3', and paste the names from File2 into column B of File3...then in Column C of File3 you could just do =MATCH(B1,A:A,0) and in Column D of File3 just do =MATCH(A1,B:B,0)...the cells that return values mean you have a match and the cells that give an error do not have a match. I don't think you'd need VBA for this...would that work?</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 5669477, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69b47dc8fe7a37d12e4bd42622f2e261?s=128&d=identicon&r=PG&f=1", "display_name": "MMbill", "link": "https://stackoverflow.com/users/5669477/mmbill"}, "edited": false, "score": 0, "creation_date": 1477492758, "post_id": 40265096, "comment_id": 67790779, "body": "This does sound a whole lot easier, I&#39;ll give this a shot!  Thank you very much."}], "tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": true, "score": 1, "last_activity_date": 1477492390, "creation_date": 1477492390, "answer_id": 40265096, "question_id": 40263450, "link": "https://stackoverflow.com/questions/40263450/script-to-compare-contrast-two-separate-excel-files-export-differences-for-bot/40265096#40265096", "title": "Script to compare/contrast two separate Excel files - export differences for both", "body": "<p>To be honest this is the kind of task I wouldn't even consider worthy of writing a script for. Instead, it seems much simpler just to use the =COUNTIF() function on each file, within the Excel worksheet, to check if each name appears in the other one.</p>\n\n<p>So what you'd end up with is a list of people in each file where =COUNTIF(list in other worksheet, person's name) = 1. This is your list of people which are common between both files. You'd also have a number of them where the same COUNTIF = 0, these are your unique entries.</p>\n\n<p>Of course, with names you have to be careful that they're formatted the same, but the work to do this is the same whether you're doing it in VBA or in the worksheet.</p>\n\n<p>Using COUNTIF also has the added bonus that you will spot any duplicates within a worksheet (although you'll spot it against that name, in the other worksheet), should this also be a potential issue.</p>\n"}], "owner": {"reputation": 67, "user_id": 5669477, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69b47dc8fe7a37d12e4bd42622f2e261?s=128&d=identicon&r=PG&f=1", "display_name": "MMbill", "link": "https://stackoverflow.com/users/5669477/mmbill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4029, "favorite_count": 0, "accepted_answer_id": 40265096, "answer_count": 2, "score": 0, "last_activity_date": 1477492390, "creation_date": 1477488019, "last_edit_date": 1531161705, "question_id": 40263450, "link": "https://stackoverflow.com/questions/40263450/script-to-compare-contrast-two-separate-excel-files-export-differences-for-bot", "title": "Script to compare/contrast two separate Excel files - export differences for both", "body": "<p>So, today I got a task plopped on my desk and I can't seem to get this script working correctly to complete said task.  My boss gave me two separate .xlsx files with a list of names on both.  She is asking that I find and list which names appear on both excel files, and also find and list which names do not appear on each file individually.  </p>\n\n<p>For example</p>\n\n<ul>\n<li>FileA has Henry and Terry</li>\n<li>FileB has Henry and Samantha</li>\n<li>Generate FileC to show that Henry appears on both FileA and FileB</li>\n<li>Generate FileD to show Terry appears on FileA but not FileB</li>\n<li>Generate FileE to show that Samantha appears on FileB but not FileA</li>\n</ul>\n\n<p>I started with trying to do the first part of pulling a compare list, but I already can't get this to work.  It completes, but It's not exporting right.  All users are listed in both xlsx files in column A.</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>$strReference = Get-Content \"C:\\Users\\person\\Desktop\\FileA.xlsx\"\n$strDifference = Get-Content \"C:\\Users\\person\\Desktop\\FileB.xlsx\"\nCompare-Object $strReference $strDifference\n</code></pre>\n"}, {"tags": ["forms", "vba", "excel", "tabs"], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "edited": false, "score": 0, "creation_date": 1477734231, "post_id": 40264057, "comment_id": 67891886, "body": "Thank you very much for your time. Your answer worked perfect, but I did not state clearly exhactly what I wanted. I have edited my question. If you could give it a try, I would be thankful."}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 0, "last_activity_date": 1477489638, "creation_date": 1477489638, "answer_id": 40264057, "question_id": 40263323, "link": "https://stackoverflow.com/questions/40263323/remove-tab-from-tabstrip-in-userform-vba-excel/40264057#40264057", "title": "Remove tab from tabstrip in userform - vba excel", "body": "<p>Hi you can Remove a Tab by the <code>TabStrip1.Tabs.Remove</code> Line.</p>\n\n<pre><code>Private Sub CommandButton1_Click() 'Insert the Tap Test\n       TabStrip1.Tabs.Add (\"Test\")\n    End Sub\n\n    Private Sub CommandButton2_Click()'Removes the Tap Test\n       TabStrip1.Tabs.Remove (\"Test\")\n    End Sub\n</code></pre>\n\n<p>The Rest you can Handle with a something Like this:</p>\n\n<pre><code>If TabStrip1.Tabs.Count &gt;= 2 Then\n    TabStrip1.Tabs.Remove (TabStrip1.Tabs.Count - 1)\nEnd If\n</code></pre>\n\n<p>You have to check fist if there are more then two Taps. If yes delete the last Tap.\nThe Hint her is, that the Index starts with the Second Tap!</p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "is_accepted": false, "score": 1, "last_activity_date": 1477735604, "creation_date": 1477735604, "answer_id": 40317995, "question_id": 40263323, "link": "https://stackoverflow.com/questions/40263323/remove-tab-from-tabstrip-in-userform-vba-excel/40317995#40317995", "title": "Remove tab from tabstrip in userform - vba excel", "body": "<p>Finally found the way.\n<code>remove</code> method accepts a tab's <code>caption</code> as an argument and not its <code>name</code>.</p>\n\n<p>In this case the following worked great:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim nm As String\n\n    With TabStrip1\n        nm = .SelectedItem.Caption\n        .Tabs.Remove (nm)\n    End With\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    With TabStrip1\n        .Tabs.Remove (.SelectedItem.Caption)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1841, "favorite_count": 0, "accepted_answer_id": 40264057, "answer_count": 2, "score": 1, "last_activity_date": 1477735604, "creation_date": 1477487711, "last_edit_date": 1477734890, "question_id": 40263323, "link": "https://stackoverflow.com/questions/40263323/remove-tab-from-tabstrip-in-userform-vba-excel", "title": "Remove tab from tabstrip in userform - vba excel", "body": "<p>I have a form with several controls. It includes a tabstrip with one tab. I allow users to add tabs, by clicking commandbutton1. So far so well.</p>\n\n<p>Now I also want users to be able to remove the last tab (except for the first one) by clicking commandbutton2. The problem is that, despite the fact that I've been searching for about two hours, I cannot find the right syntax for method \"remove\" when it comes to tabs. Any help appresiated.</p>\n\n<p><strong>edited:</strong></p>\n\n<p>Making the above question more specific: What's the right syntax for \"remove\" method when it's parameter is a string-variable and not a specific tab name. (for example removing the current tab)</p>\n\n<p>e.g.\nIt would be great if one of the following would work:</p>\n\n<pre><code>Sub test\n    Dim nm As String\n\n    With TabStrip1\n        nm = .SelectedItem.Name\n        .Tabs.Remove (nm)\n    End With\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub test\n    With TabStrip1\n        .Tabs.Remove (.SelectedItem.Name)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "bcc"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1477486587, "creation_date": 1477486587, "answer_id": 40262916, "question_id": 40262446, "link": "https://stackoverflow.com/questions/40262446/automatically-send-bccs-to-mailbox-sent-from/40262916#40262916", "title": "Automatically Send BCCs to Mailbox Sent From", "body": "<p>To have the mail sent from the mailbox account you need to do the following:</p>\n\n<pre><code>With oMailItem\nSet .SendUsingAccount = oOutlook.Session.Accounts.Item(iAccount)\n...\nEnd With\n</code></pre>\n\n<p>Where <code>oMailItem</code> and <code>oOutlook</code> refer to your relevant objects and <code>iAccount</code> is the index number of the mailbox you want to use.  In my case I have two mailboxes available to send from, my personal one and the group one.  My personal account is first (index 1) and the group mailbox is second (index 2).</p>\n\n<p>Mail Items I send using this code always move to the Sent Items folder in the group mailbox rather than my personal one.</p>\n"}], "owner": {"reputation": 63, "user_id": 6008668, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e70dd73efdf2134dd751cd0b3014f67?s=128&d=identicon&r=PG&f=1", "display_name": "RhaegoT", "link": "https://stackoverflow.com/users/6008668/rhaegot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543858903, "creation_date": 1477485219, "question_id": 40262446, "link": "https://stackoverflow.com/questions/40262446/automatically-send-bccs-to-mailbox-sent-from", "title": "Automatically Send BCCs to Mailbox Sent From", "body": "<p>We've got multiple users using an existing mailbox on Outlook. Everyone who sends from the mailbox recieves the \"sent items\" in their own personal mailbox. I've looked in rules and cannot find anything to have the sent items appear in the group mailbox's sent items instead.</p>\n\n<p>I've got the following code, but cannot work out why it's not running.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, _\n                             Cancel As Boolean)\nDim objRecip As Recipient\nDim strMsg As String\nDim res As Integer\nDim strBcc As String\nOn Error Resume Next\n\nstrBcc = \"&lt;mailboxname&gt;\"\n\nIf Item.SendUsingAccount = \"&lt;mailboxname&gt;\" Then\n\nSet objRecip = Item.Recipients.Add(strBcc)\nobjRecip.Type = olBCC\n\n'Set variable objRecip (recipient) = Item.Recipients.Add (strBcc)\nIf Not objRecip.Resolve Then\n    strMsg = \"Could not resolve the Bcc recipient. \" &amp; _\n             \"Do you want to send the message?\"\n    res = MsgBox(strMsg, vbYesNo + vbDefaultButton1, _\n            \"Could Not Resolve Bcc\")\n    If res = vbNo Then\n        Cancel = True\n    End If\nEnd If\n\nEnd If\n\nSet objRecip = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7074864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f442a24af05d9d2348ac02f050bdf613?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menezes", "link": "https://stackoverflow.com/users/7074864/gabriel-menezes"}, "edited": false, "score": 0, "creation_date": 1477491444, "post_id": 40263953, "comment_id": 67789854, "body": "Thanks for the help! I am getting the Runtime Error 6: Overflow of the line      Case CInt(.Text) = CDbl(.Text)  As I am not familiar with these methods, I have to ask. This     Range(dataSource).Cells(1, 1) Is it looking at the chart values or it&#39;s name for the formats? Because if it&#39;s looking at the formats, I don&#39;t think it&#39;s going to work, since the values are determined by lookup formula. If it&#39;s looking at the name, the format code is at one cell before (offset (0 , -1))."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 55, "user_id": 7074864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f442a24af05d9d2348ac02f050bdf613?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menezes", "link": "https://stackoverflow.com/users/7074864/gabriel-menezes"}, "edited": false, "score": 0, "creation_date": 1477498761, "post_id": 40263953, "comment_id": 67794988, "body": "The overflow must be due to <code>CInt(.Text)</code> when <code>.Text</code> exceeds the range \u201332,768 to 32,767 (I did my tests with <i>little</i> integers...). See edited answer where .Text is first cast to a <code>Double</code>  (which ranges from \u20131.79769313486232E+308 to 1.79769313486232E308, should be big enough ...) and then rounded down to the nearest integer by means of <code>Int()</code> function"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 55, "user_id": 7074864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f442a24af05d9d2348ac02f050bdf613?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menezes", "link": "https://stackoverflow.com/users/7074864/gabriel-menezes"}, "edited": false, "score": 0, "creation_date": 1477499237, "post_id": 40263953, "comment_id": 67795258, "body": "<code>Range(dataSource).Cells(1, 1)</code> references the first cell of the data source. In my test I assumed a &quot;line chart&quot; so that  <code>Sheets(&quot;Dashboard&quot;).ChartObjects(whichchart).Chart.SeriesCol&zwnj;&#8203;lection(i).Formula</code> returned a string like <code>=SERIES(,,sheetname!sheetRange,1)</code> whose 3rd &quot;element&quot; (i.e. <code>sheetname!sheetRange</code>) is the &quot;full&quot; address of the <i>values</i> range"}, {"owner": {"reputation": 55, "user_id": 7074864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f442a24af05d9d2348ac02f050bdf613?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menezes", "link": "https://stackoverflow.com/users/7074864/gabriel-menezes"}, "edited": false, "score": 0, "creation_date": 1477503448, "post_id": 40263953, "comment_id": 67797559, "body": "I used conditional formatting to apply the format directly to the data source, as well as changed the &#39;CInt(.Text)&#39; to &#39;CLng(.Text)&#39; and the problems were solved!! Thank you very much, user3598756!!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1477497785, "last_edit_date": 1477497785, "creation_date": 1477489383, "answer_id": 40263953, "question_id": 40261969, "link": "https://stackoverflow.com/questions/40261969/formatting-chart-data-labels-with-vba/40263953#40263953", "title": "Formatting chart data labels with VBA", "body": "<p>You can climb up to a series source range via its <code>Formula</code> property.</p>\n\n<p>Since it has the format: </p>\n\n<pre><code>=SERIES(,,sheetname!sheetRange,)\n</code></pre>\n\n<p>then you're interested in its \"3rd element\", if you split it into an array with \",\" as delimiter</p>\n\n<p>so you can code:</p>\n\n<pre><code>Sub FixLabels(whichchart As String)\n    Dim cht As Chart\n    Dim i As Long\n\n    With Sheets(\"Dashboard\").ChartObjects(whichchart).Chart '&lt;--| reference your chart\n        For i = 1 To .SeriesCollection.Count '&lt;--| loop through all series\n            With .SeriesCollection(i) '&lt;--| reference current series\n                If .Name = \"#N/D\" Then\n                    .DataLabels.ShowValue = False\n                Else\n                    .HasDataLabels = True '&lt;--| be sure labels are \"activated\"\n                    .DataLabels.ShowValue = True '&lt;--| show data labels\n                    .DataLabels.NumberFormat = GetFormat(Split(.Formula, \",\")(2)) '&lt;-- set data label format\n                End If\n            End With\n        Next i\n    End With\nEnd Sub\n\n\nFunction GetFormat(dataSource As Variant) As String\n    With Range(dataSource).Cells(1, 1) '&lt;-- reference the first cell of the data source\n        Select Case True\n            Case InStr(.Text, \"%\") &gt; 0\n                GetFormat = \"#.0%\"\n            Case Int(CDbl(.Text)) = CDbl(.Text)\n                GetFormat = \"#\"\n            Case Else\n                GetFormat = \"#,###\"\n        End Select\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7074864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f442a24af05d9d2348ac02f050bdf613?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menezes", "link": "https://stackoverflow.com/users/7074864/gabriel-menezes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15830, "favorite_count": 1, "accepted_answer_id": 40263953, "answer_count": 1, "score": 5, "last_activity_date": 1477497785, "creation_date": 1477483960, "question_id": 40261969, "link": "https://stackoverflow.com/questions/40261969/formatting-chart-data-labels-with-vba", "title": "Formatting chart data labels with VBA", "body": "<p>I am developing a dashboard that will have lots of charts, and as the data shown on these charts change, so will the format of the numbers. At the point I am right now, I've run into a problem trying to retrieve the intended format code from the spreadsheet where the data is based on, in the midst of looping through all the series in the chart.\nHere's the code so far:</p>\n\n<pre><code>Sub FixLabels(whichchart As String)\nDim cht As Chart\nDim i, z As Variant\nDim seriesname, seriesfmt As String\nDim seriesrng As Range\n\nSet cht = Sheets(\"Dashboard\").ChartObjects(whichchart).Chart\n\n    For i = 1 To cht.SeriesCollection.Count\n        If cht.SeriesCollection(i).name = \"#N/D\" Then\n            cht.SeriesCollection(i).DataLabels.ShowValue = False\n            Else\n            cht.SeriesCollection(i).DataLabels.ShowValue = True\n                seriesname = cht.SeriesCollection(i).name\n                Debug.Print seriesname\n</code></pre>\n\n<p>With this I am able to retrieve the name of de series that do not result in error, and hide the series that do. So far so good. \nNow on to the formatting: There's a column where all the possible series names for this workbook are stored, and one column to the left, there are my formatting codes, which are \"int\", for integer numbers, \"#,#\" for numbers with important decimal cases, and \"%\" for percent rates. These are stored as plain text. So the last bit of the code would look like:</p>\n\n<pre><code>Select Case seriesfmt\n   Case \"int\"\n      Cht.SeriesCollection(i).DataLabels.NumberFormat = \"#\"\n   Case \"#,#\"\n      Cht.SeriesCollection(i).DataLabels.NumberFormat = \"#,###\"\n   Case \"%\"\n      Cht.SeriesCollection(i).DataLabels.NumberFormat = \"#.0%\"\nEnd Select\nEnd If\nNext i\n</code></pre>\n\n<p>Finally the real problem here: what goes in between. I cannot retrieve the series format! My best guess was:</p>\n\n<pre><code>With Sheets(\"CxC\").Range(\"K22:K180\")\nseriesfmt = .Find(seriesname).Offset(0, -1).Value\nEnd With\n</code></pre>\n\n<p>I got errors, telling me the With block was not defined. I tried several combinations of the same command, with or without the With method, with and without the Set method, I tried WorksheetFunction Match, to no avail. Any help solving this issue is greatly apreciated!</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2906801"}, "edited": false, "score": 0, "creation_date": 1477486425, "post_id": 40261740, "comment_id": 67786007, "body": "Thats brilliant, It was the using the path as the link text that I was trying to get sorted. I&#39;ve looked at MrExcel before but it never came up when I was searching for a solution. Thank you"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1477492076, "post_id": 40261740, "comment_id": 67790283, "body": "Using <code>HTMLBody</code> will also include the users signature when it generates the email.  I&#39;m not sure how it works with <code>.Send</code> because when I use it I am using <code>.Display</code> so the user can enter extra information if needed.  Note that the sample code has <code>.Send</code> so you will not see a preview of the email."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1477492240, "post_id": 40261740, "comment_id": 67790394, "body": "Just something to keep in mind, I&#39;ve encountered this warning message when making Excel call up Outlook - <a href=\"https://support.office.com/en-us/article/I-get-warnings-about-a-program-accessing-e-mail-address-information-or-sending-e-mail-on-my-behalf-df007135-c632-4ae4-8577-dd4ba26750a2?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>  The fix involved changing the security of the file but I&#39;m not sure how or what as someone else did it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2906801"}, "edited": false, "score": 0, "creation_date": 1477492350, "post_id": 40261740, "comment_id": 67790478, "body": "I do use .Send and it still attaches the users email signature at the bottom of the email through the exchange server. Haven&#39;t encountered that issue before, but if I do I thank you in advance!"}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": true, "score": 2, "last_activity_date": 1477483260, "creation_date": 1477483260, "answer_id": 40261740, "question_id": 40260657, "link": "https://stackoverflow.com/questions/40260657/insert-filepath-as-hyperlink-excel-vba/40261740#40261740", "title": "Insert filepath as hyperlink Excel VBA", "body": "<p>If you are currently using HTMLBody in your email code, it's quite easy to do.  I'll assume you are using code similar to below.  Take note of <code>strbody</code> and <code>.HTMLBody</code>.  Assuming your <code>fpath</code> is formatted like <code>C:\\Users\\tjb1\\Desktop\\file.docx</code> then you don't need to add anything else to it.  The section creating the hyperlink is <code>\"&lt;A href=\" &amp; fpath &amp; \"&gt;test link&lt;/A&gt;\"</code>.  You can change test link to say whatever you want or change the line to <code>\"&lt;A href=\" &amp; fpath &amp; \"&gt;\" &amp; fpath &amp; \"&lt;/A&gt;\"</code> to use the path as the link text.</p>\n\n<pre><code>Sub MailURL()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    strbody = \"&lt;A href=\" &amp; fpath &amp; \"&gt;test link&lt;/A&gt;\"\n    On Error Resume Next\n    With OutMail\n        .To = \"APerson@Somewhere.com\"\n        .Subject = \"Testing URL\"\n        .HTMLBody = strbody\n        .Send\n    End With\n    On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>I found the code above at <a href=\"http://www.mrexcel.com/forum/excel-questions/492801-putting-active-link-htmlbody-cdo-2.html#post2435236\" rel=\"nofollow\">MrExcel</a> and just formatted it a bit to work with your variable.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2906801"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9491, "favorite_count": 0, "accepted_answer_id": 40261740, "answer_count": 1, "score": 1, "last_activity_date": 1544464118, "creation_date": 1477479932, "question_id": 40260657, "link": "https://stackoverflow.com/questions/40260657/insert-filepath-as-hyperlink-excel-vba", "title": "Insert filepath as hyperlink Excel VBA", "body": "<p>I have a VBA set of code that generates an email and automatically sends it.</p>\n\n<p>One of the things that I cannot get to work properly is putting a hyperlink to a specified folder location within the email.</p>\n\n<pre><code>Dim fpath As String\n\nfpath = Worksheets(\"MS_JRNL_OPEN_TU_FR-4333635\").Range(\"AD5\").Value\n\n\"file://\" &amp; fpath &amp; _\n</code></pre>\n\n<p>Essentially the user has to input a folder location when running the Macro which is in Cell AD5, but I want this is appear as the full folder location as a hyperlink once the email is generated.</p>\n\n<p>Any help would be greatly appreciated</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 4, "last_activity_date": 1477479776, "creation_date": 1477479776, "answer_id": 40260589, "question_id": 40260455, "link": "https://stackoverflow.com/questions/40260455/multiple-cell-value-change-to-trigger-macros/40260589#40260589", "title": "Multiple cell value change to trigger macros", "body": "<p>out this in your worksheet code pane</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"G3:G4\")) Is Nothing Then        \n        'code when some cell in range \"G3:G4\" is changed\n    ElseIf Not Intersect(Target, Range(\"D15:D10000\")) Is Nothing Then\n        'code when some cell in range \"D15:D10000\" is changed\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1477480533, "last_edit_date": 1477480533, "creation_date": 1477479819, "answer_id": 40260607, "question_id": 40260455, "link": "https://stackoverflow.com/questions/40260455/multiple-cell-value-change-to-trigger-macros/40260607#40260607", "title": "Multiple cell value change to trigger macros", "body": "<p>Put the code below in your relevant worksheet, in the <code>Worksheet_Change</code> event.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim WatchRange                  As Range\nDim IntersectRange              As Range\n\nSet WatchRange = Application.Union(Range(\"G3:G4\"), Range(\"D15:D10000\"))\nSet IntersectRange = Intersect(Target, WatchRange)\n\nIf Not IntersectRange Is Nothing Then\n\n    Select Case Target.Column\n        Case 4 ' column D\n            Call A\n\n        Case 7 ' column G\n            Call B\n\n    End Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Below are examples of <code>Sub A</code> and <code>Sub B</code>:</p>\n\n<pre><code>Sub A()\n\nMsgBox \"Running Sub A\"\n\nEnd Sub\n\n\nSub B()\n\nMsgBox \"Running Sub B\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "accepted_answer_id": 40260589, "answer_count": 2, "score": 0, "last_activity_date": 1477480533, "creation_date": 1477479425, "question_id": 40260455, "link": "https://stackoverflow.com/questions/40260455/multiple-cell-value-change-to-trigger-macros", "title": "Multiple cell value change to trigger macros", "body": "<p>I have different set of values in cells G3:G4 and D15:D10000 in a single sheet. I want run two separate codes when G columns or D columns are changed. How I can identify which set of columns are changed?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1477478298, "post_id": 40259910, "comment_id": 67780741, "body": "Does <code>ActiveWorkbook.WorkSheets</code> and `worksheets(sheet.name)&#39; work?"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1477478669, "post_id": 40259910, "comment_id": 67780968, "body": "Did you try running the code in debug mode, setting a breakpoint just after the like <code>For each...</code> and examine the value of <code>sheet</code>? Which version of Office are you using right now?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1477479210, "creation_date": 1477479210, "answer_id": 40260374, "question_id": 40259910, "link": "https://stackoverflow.com/questions/40259910/vba-excel-sheet-method-doesnt-work-after-office-updates/40260374#40260374", "title": "VBA Excel Sheet Method doesn&#39;t work after Office updates", "body": "<p><strong>Note</strong>: This is not necessarily the answer, but it is too long to write down as a comment.</p>\n\n<p>You can keep your coding a lot cleaner and simplier: I prefer not to use <code>sheet</code> as it's very similer to <code>Sheet</code>.\nAlso, it's better if you avoid using <code>ActiveWorkbook</code>.</p>\n\n<pre><code>Dim Sht             As Worksheet\n\nFor Each Sht In ActiveWorkbook.Sheets\n    Select Case Sht.Name\n\n        Case \"Archive\", \"Trend\", \"PivotTable\"\n            Sht.Delete\n\n    End Select\n\nNext Sht\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1477480592, "creation_date": 1477480592, "answer_id": 40260885, "question_id": 40259910, "link": "https://stackoverflow.com/questions/40259910/vba-excel-sheet-method-doesnt-work-after-office-updates/40260885#40260885", "title": "VBA Excel Sheet Method doesn&#39;t work after Office updates", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193217.aspx\" rel=\"nofollow\">Sheets</a> can contain <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194426.aspx\" rel=\"nofollow\">Chart</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835542(v=office.15).aspx\" rel=\"nofollow\">Worksheets</a> objects</p>\n\n<p>then </p>\n\n<p>if you want to delete <code>Worksheets</code> only then:</p>\n\n<pre><code>Dim sheet As Worksheet\nFor Each sheet In ActiveWorkbook.Worksheets '&lt;-- loop through Worksheets collection\n    Select Case sheet.Name\n        Case \"Archive\": Sheets(sheet.Name).Delete\n        Case \"Trend\":  Sheets(sheet.Name).Delete\n        Case \"PivotTable\": Sheets(sheet.Name).Delete\n    End Select\nNext\n</code></pre>\n\n<p>if you want to delete both <code>Worksheets</code> and <code>Charts</code> then:</p>\n\n<pre><code>Dim sheet As variant '&lt;-- a Variant variable can be assigned both a Worksheet and a Chart object\nFor Each sheet In ActiveWorkbook.Sheets '&lt;-- loop through Worksheets and Charts collections\n    Select Case sheet.Name\n        Case \"Archive\": Sheets(sheet.Name).Delete\n        Case \"Trend\":  Sheets(sheet.Name).Delete\n        Case \"PivotTable\": Sheets(sheet.Name).Delete\n    End Select\nNext\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 1885971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fc695f3dad71c80c9a3dffa606d90437?s=128&d=identicon&r=PG", "display_name": "chianta", "link": "https://stackoverflow.com/users/1885971/chianta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477480592, "creation_date": 1477477966, "question_id": 40259910, "link": "https://stackoverflow.com/questions/40259910/vba-excel-sheet-method-doesnt-work-after-office-updates", "title": "VBA Excel Sheet Method doesn&#39;t work after Office updates", "body": "<p>I have a script that it takes datas from CSV file and after it generates a graphic. After many Office updates this script has finished to work. It isn't possible come back with Office version.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Dim sheet\n    For Each sheet In ActiveWorkbook.Sheets\n        Select Case sheet.Name\n            Case \"Archive\": Sheets(sheet.Name).Delete\n            Case \"Trend\":  Sheets(sheet.Name).Delete\n            Case \"PivotTable\": Sheets(sheet.Name).Delete\n        End Select\nNext\n</code></pre>\n\n<p>I receive the follow error: \"Application defined or object defined error\". This error arrives on Select Case, because my object \"sheet\" hasn't the method \"Name\".</p>\n\n<p>I have tryed to declare \"sheet\" as Worksheet</p>\n\n<pre><code>Dim sheet as Worksheet\n    For Each sheet In ActiveWorkbook.Sheets\n        Select Case sheet.Name\n            Case \"Archive\": Sheets(sheet.Name).Delete\n            Case \"Trend\":  Sheets(sheet.Name).Delete\n            Case \"PivotTable\": Sheets(sheet.Name).Delete\n        End Select\n    Next\n</code></pre>\n\n<p>At the first cicle of script I haven't any problem, from the second cicle I have the error: \"Type mismatch\"</p>\n\n<p>How can I solve it?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 6360455, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80565f09e9126b2097da3b6ea8cfd33e?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/6360455/srikanth"}, "is_accepted": true, "score": 0, "last_activity_date": 1478072018, "creation_date": 1478072018, "answer_id": 40374565, "question_id": 40259735, "link": "https://stackoverflow.com/questions/40259735/add-a-textbox-below-an-inline-shape-on-ms-word-using-vba/40374565#40374565", "title": "Add a TextBox below an Inline Shape on MS Word using VBA", "body": "<p>I managed to find a solution for getting the coordinates for the shape from here: <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-48831.html\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/archive/index.php/t-48831.html</a></p>\n\n<p>Here's my code: </p>\n\n<pre><code>Sub AddTextBox\n\n    Set shp = Selection.InlineShapes(1)\n    Set rng = shp.Range       \n    Set tb = ActiveDocument.Shapes.AddTextbox(1, fcnXCoord, fcnYCoord + shp.Height, shp.Width, shp.Height / 6)\n\nEnd Sub\n\nFunction fcnXCoord() As Double\n    fcnXCoord = Selection.Information(wdHorizontalPositionRelativeToPage)\nEnd Function\n\nFunction fcnYCoord() As Double\n    fcnYCoord = Selection.Information(wdVerticalPositionRelativeToPage)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6360455, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80565f09e9126b2097da3b6ea8cfd33e?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth", "link": "https://stackoverflow.com/users/6360455/srikanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 40374565, "answer_count": 1, "score": 0, "last_activity_date": 1478072018, "creation_date": 1477477488, "last_edit_date": 1478009213, "question_id": 40259735, "link": "https://stackoverflow.com/questions/40259735/add-a-textbox-below-an-inline-shape-on-ms-word-using-vba", "title": "Add a TextBox below an Inline Shape on MS Word using VBA", "body": "<p>I'm trying to insert a textbox below a chosen image with Inline text wrapping and position it at the left bottom of the image. I'm using the below code without much success. I'm not too sure whether to use a ShapeRange or an InlineShape. Any pointers?</p>\n\n<pre><code>Dim shp As Object\n'Set shp = Selection.ShapeRange(1)\n'Set rng = shp.Anchor\nSet shp = Selection.InlineShapes(1)\nSet rng = shp.Range\n\nWith ActiveDocument.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=shp.Left, Top:=(shp.Top + shp.Height), Width:=shp.Width / 3, Height:=shp.Height / 6, Anchor:=rng)\n    .TextFrame.TextRange.Font.Size = 14\n    .TextFrame.TextRange.Font.Color = RGB(186, 14, 29)\n    .TextFrame.TextRange.Font.Name = \"Sabon MT\"\n    .TextFrame.TextRange = \"T\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1477477714, "post_id": 40259643, "comment_id": 67780419, "body": "<code>USER1</code> or <code>userid</code> (as well as Sergeys answer)."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1477478092, "post_id": 40259788, "comment_id": 67780648, "body": "Thank you for the reply. When I use your expression I get the following error: = #Name? instead of #NA"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1477478450, "post_id": 40259788, "comment_id": 67780837, "body": "That&#39;ll be because <code>CDP1</code> isn&#39;t a control on a form... try changing it to <code>[User1]</code> as you have on your OP.  Or confirm that it is a control on a form?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1477486464, "post_id": 40259788, "comment_id": 67786038, "body": "What was the final <code>DLookUp</code> if Sergeys gave a #Name error?"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1477477616, "creation_date": 1477477616, "answer_id": 40259788, "question_id": 40259643, "link": "https://stackoverflow.com/questions/40259643/na-in-textbox-following-dlookup/40259788#40259788", "title": "NA in textbox following DLOOKUP", "body": "<p>As soon as the table <code>[Hourly1]</code> has only two fields, it means that it has no field <code>[CDP1]</code>. If this is the name of control of your form, use this for numeric CDP1:</p>\n\n<pre><code>=DLookUp(\"[Total Calls Answered]\",\"[Hourly1]\",\"[userid] = \" &amp; [CDP1])\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 40259788, "answer_count": 1, "score": 0, "last_activity_date": 1594023073, "creation_date": 1477477240, "last_edit_date": 1594023073, "question_id": 40259643, "link": "https://stackoverflow.com/questions/40259643/na-in-textbox-following-dlookup", "title": "NA in textbox following DLOOKUP", "body": "<p>I am using a dlookup to display some table content in a textbox but its returning #NA</p>\n\n<p>For example: I have a table with 2 columns called USER1 &amp; Total Calls Answered, and the table is called hourly1</p>\n\n<p>My Dlookup is:</p>\n\n<pre><code> =DLookUp(\"[Total Calls Answered]\",\"[Hourly1]\",\"[userid] = [USER1]\")\n</code></pre>\n\n<p>Why is my textbox showing #NA </p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 3, "creation_date": 1477477046, "post_id": 40259392, "comment_id": 67780026, "body": "try nz(amount,0) * nz(weighting,0) as [amount_weighted]"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1477479711, "post_id": 40259392, "comment_id": 67781635, "body": "Number stored as text isn&#39;t actually an error - you can convert them to a number by clicking on the warning flag"}, {"owner": {"reputation": 117, "user_id": 5144085, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dddd6f37bd5af8474f05f1684aefc2da?s=128&d=identicon&r=PG&f=1", "display_name": "Alwin", "link": "https://stackoverflow.com/users/5144085/alwin"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1477574599, "post_id": 40259392, "comment_id": 67829810, "body": "@krishKM: Thank you, that worked!"}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 5144085, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dddd6f37bd5af8474f05f1684aefc2da?s=128&d=identicon&r=PG&f=1", "display_name": "Alwin", "link": "https://stackoverflow.com/users/5144085/alwin"}, "is_accepted": true, "score": 0, "last_activity_date": 1477647506, "creation_date": 1477647506, "answer_id": 40302285, "question_id": 40259392, "link": "https://stackoverflow.com/questions/40259392/data-type-changing-after-multiplying-two-columns-in-ms-access/40302285#40302285", "title": "Data type changing after multiplying two columns in MS Access", "body": "<p>The fact that single lines were empty caused the Problem. </p>\n\n<pre><code>nz(amount,0) * nz(weighting,0) as [amount_weighted]\n</code></pre>\n\n<p>Using this instead of CDbl and therefore inserting \"0\" into the empty lines solved the problem. </p>\n"}], "owner": {"reputation": 117, "user_id": 5144085, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dddd6f37bd5af8474f05f1684aefc2da?s=128&d=identicon&r=PG&f=1", "display_name": "Alwin", "link": "https://stackoverflow.com/users/5144085/alwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40302285, "answer_count": 1, "score": 0, "last_activity_date": 1593957923, "creation_date": 1477476529, "last_edit_date": 1593957923, "question_id": 40259392, "link": "https://stackoverflow.com/questions/40259392/data-type-changing-after-multiplying-two-columns-in-ms-access", "title": "Data type changing after multiplying two columns in MS Access", "body": "<p>I want to multiply two columns with each other and use the following code</p>\n\n<pre><code>CDbl(amount) * CDbl(weighting)\nAS [amount_weighted],\n</code></pre>\n\n<p>\"Amount\" is a regular number while \"weighting\" is a value between 0 and 1. \nThe resulting column is formatted as \"short text\" in Access, although it should be a number. Occasionally the column \"weighting\" or \"amount\" can be empty, may this be a reason for the malfunctioning? \nThe wrong formatting gives causes a \"number stores as text\" error when I want to export the resulting column into Excel.</p>\n"}, {"tags": ["vba", "macros", "powerpoint"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477482522, "post_id": 40259307, "comment_id": 67783390, "body": "let me know if the code below works for you"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1477478662, "creation_date": 1477478662, "answer_id": 40260165, "question_id": 40259307, "link": "https://stackoverflow.com/questions/40259307/vba-powerpoint-to-check-if-a-filenma-already-exist/40260165#40260165", "title": "VBA PowerPoint to check if a FileNma already exist", "body": "<p>Try the code below, it will check if <code>NewFileName</code> of the PowerPoint presentation already exists in the same folder, and if it does will bring-up the <code>MsgBox</code> you wanted.</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim NewFileName             As String\nDim OwnPathName             As String\n\noldWeekDay = Weekday(Now)\n\nSelect Case oldWeekDay\n\n    Case 1\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 4, \"yyyymmdd\")\n    Case 2\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 3, \"yyyymmdd\")\n    Case 3\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 2, \"yyyymmdd\")\n    Case 4\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 1, \"yyyymmdd\")\n    Case 5\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date, \"yyyymmdd\")\n    Case 6\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 6, \"yyyymmdd\")\n    Case 7\n        NewFileName = \"PT PM Weekly \" &amp; Format(Date + 5, \"yyyymmdd\")\n\nEnd Select\n\nOwnPathName = ActivePresentation.Path\nFullFileName = OwnPathName &amp; \"\\\" &amp; NewFileName\n\n' for debug only (can remove it later)\nMsgBox OwnPathName\nMsgBox FullFileName\n\n\nDim StrFile             As String\nDim FileFound           As Boolean\n\nFileFound = False\n' look for all types of PowerPoint files only (filter only to PowerPoint files to save time)\nStrFile = Dir(OwnPathName &amp; \"\\*ppt*\")\n\nDo While Len(StrFile) &gt; 0\n    If InStr(StrFile, NewFileName) &gt; 0 Then\n        FileFound = True\n        Exit Do\n    End If\n    StrFile = Dir\nLoop\n\nIf FileFound Then\n    MsgBox \"Modification already done\"\nElse\n    ' do something .... your logics\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40260165, "answer_count": 1, "score": 0, "last_activity_date": 1477478662, "creation_date": 1477476318, "question_id": 40259307, "link": "https://stackoverflow.com/questions/40259307/vba-powerpoint-to-check-if-a-filenma-already-exist", "title": "VBA PowerPoint to check if a FileNma already exist", "body": "<p>What i want to do is to check if a File Name already exist and than make my my modification. I tried several methode but no one work!!\nCan you help me please finding the solution?</p>\n\n<p>this is what i wrote with the three different Methods:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim lRetVal As Long\nDim ObjFso As Object\nDim CheckExists As Boolean\n\nTodate = DateValue(Now)\noldWeekDay = Weekday(Todate)\nSelect Case oldWeekDay\n\nCase 1\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 4, \"yyyymmdd\")\nCase 2\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 3, \"yyyymmdd\")\nCase 3\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 2, \"yyyymmdd\")\nCase 4\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 1, \"yyyymmdd\")\nCase 5\nNewFileName = \"PT PM Weekly \" &amp; Format(Date, \"yyyymmdd\")\nCase 6\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 6, \"yyyymmdd\")\nCase 7\nNewFileName = \"PT PM Weekly \" &amp; Format(Date + 5, \"yyyymmdd\")\n\nEnd Select\nOwnPathName = Application.ActivePresentation.Path\nFullFileName = OwnPathName &amp; \"\\\" &amp; NewFileName\nMsgBox OwnPathName\nMsgBox FullFileName\n'-------------------------------------------------------------------\n'lRetVal = Application.Presentations.Open(FullFileName)\n'If lRetVal &lt;&gt; HFILE_ERROR Then\n'  MsgBox \"Modification already done\"\n'------------------------------------------------------------------\n   'If Dir(FullFileName) &lt;&gt; \"\" Then\n   'MsgBox \"Modification already done\"\n\n'-------------------------------------------------------------------\n        'Set ObjFso = CreateObject(\"PowerPoint.Application\")\n        'CheckExists = ObjFso.FileExists(FullFileName)\n        'If CheckExists = True Then\n        'MsgBox \"Modification already done\"\nElse\ndeleteTextBox\nAllBlackAndDate\nLastModifiedDate\nSaveAllPresentations (FullFileName)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477475769, "post_id": 40258906, "comment_id": 67779197, "body": "<code>Application.DisplayAlerts = False</code> perhaps?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 1, "creation_date": 1477475890, "post_id": 40258906, "comment_id": 67779296, "body": "That&#39;s already in the <code>With Application</code> bit :)"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477477123, "post_id": 40258906, "comment_id": 67780082, "body": "My apologies, shouldn&#39;t answer off the top of my head! :o)"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477478249, "post_id": 40258906, "comment_id": 67780713, "body": "No problem, I had that epiphany myself and was gutted to see it didn&#39;t work..."}], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": true, "score": 0, "last_activity_date": 1529482211, "creation_date": 1529482211, "answer_id": 50943369, "question_id": 40258906, "link": "https://stackoverflow.com/questions/40258906/automate-the-import-data-form-isy-sharepoint/50943369#50943369", "title": "Automate the Import Data form (.isy - SharePoint)", "body": "<p>I didn't even need to macro the .isy download / import, I can simply refresh the data connection as part of my macro. </p>\n\n<pre><code>ActiveWorkbook.RefreshAll\n</code></pre>\n"}], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50943369, "answer_count": 1, "score": 0, "last_activity_date": 1529482283, "creation_date": 1477475184, "last_edit_date": 1531164843, "question_id": 40258906, "link": "https://stackoverflow.com/questions/40258906/automate-the-import-data-form-isy-sharepoint", "title": "Automate the Import Data form (.isy - SharePoint)", "body": "<p>So I've automated IE to <code>.click</code> 'Export to Excel' on SharePoint in a new Excel Workbook (for security our organisation has disabled Visual Basic for SharePoint).</p>\n\n<p>I have used <code>.SendKeys</code> to interact with the first message box and used some nasty settings to shut the data connections security warning up.</p>\n\n<p>That just leaves the Import Data form to deal with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CvDPG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CvDPG.png\" alt=\"The hurdle\"></a></p>\n\n<p>When I try to use <code>.SendKeys</code> to imitate Return or Spacebar, the keypress is happening elsewhere, whether in my code when developer is open or in another application when it is not.</p>\n\n<p>I have tried to select Sheet1 as if I was to do this manually the form would gain focus.</p>\n\n<p>Any ideas how I can automate control of this form or force it to gain focus so that <code>.SendKeys</code> will work?</p>\n\n<p>For clarity, here's my full code:</p>\n\n<pre><code>Sub export()\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .DisplayAlerts = False\n        .EnableEvents = False\n    End With\n\n    Dim IE As Object\n    Set IE = Nothing\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    IE.Navigate \"SITE CANNOT BE DISCLOSED\"\n\n    Do Until (IE.readystate = 4 And Not IE.Busy)\n    DoEvents\n    Loop\n\n    Dim list\n\n    Set list = IE.Document.getElementById(\"Ribbon.List-Title\").getElementsByTagName(\"a\")(0)\n\n    list.Click\n    'list.FireEvent (\"onclick\") alternative\n\n    Do Until (IE.readystate = 4 And Not IE.Busy)\n    DoEvents\n    Loop\n\n    Dim export\n\n    Set export = IE.Document.getElementById(\"Ribbon.List.Actions.ExportToSpreadsheet-Large\")\n    export.Click\n\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Application.SendKeys \"%{O}\" 'works up to here need to make focus change before next keypress\n\n    Workbooks(\"Reporting Macro\").Sheets(\"Sheet1\").Select\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Application.SendKeys \" \"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 420, "user_id": 7008334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bca0d8de6f06f4339fa754b726a90e?s=128&d=identicon&r=PG&f=1", "display_name": "danl", "link": "https://stackoverflow.com/users/7008334/danl"}, "is_accepted": false, "score": 0, "last_activity_date": 1477477092, "creation_date": 1477477092, "answer_id": 40259600, "question_id": 40258894, "link": "https://stackoverflow.com/questions/40258894/comparing-2-excel-workbooks-and-highlighting-the-differences/40259600#40259600", "title": "Comparing 2 excel workbooks and highlighting the differences", "body": "<p>My solution is for code 2</p>\n\n<p>Your main problem appears to be the following line:</p>\n\n<pre><code>Nieuweversie.Sheets(gebouwen).Cells(iRow, iCol).Interior.Color = vbYellow\n</code></pre>\n\n<p>You don't have variables set for \"Nieuweversie\" or \"gebouwen\". The former appears to be a remnant in code 2 left over from code 1, I'm assuming what you actually need this line to be is:</p>\n\n<pre><code>wbkA.Sheets(\"gebouwen\").Cells(iRow, iCol).Interior.Color = vbYellow\n</code></pre>\n\n<p>I've tested this solution myself and it appears that fixing the worksheet reference causes the sub to run correctly</p>\n\n<p>also - this isn't working in code 1 either due to the same line (I haven't checked the rest of the code though, there may be other issues). Your variable \"Nieuwerversie\" is a worksheet, and what you're doing is referring to a \"Worksheet.Sheets\" object, which is not a valid reference. If you just used</p>\n\n<pre><code>Nieuweversie.Cells(iRow, iCol).Interior.Color = vbYellow\n</code></pre>\n\n<p>Then this should fix the same line in code 1, although as I say I haven't tested the rest of the code</p>\n"}], "owner": {"reputation": 11, "user_id": 7074164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebccccf17937d9bf8b63d7f6ea2bbfe?s=128&d=identicon&r=PG&f=1", "display_name": "user7074164", "link": "https://stackoverflow.com/users/7074164/user7074164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477477092, "creation_date": 1477475158, "last_edit_date": 1531164843, "question_id": 40258894, "link": "https://stackoverflow.com/questions/40258894/comparing-2-excel-workbooks-and-highlighting-the-differences", "title": "Comparing 2 excel workbooks and highlighting the differences", "body": "<p>I'm trying to create a macro to compare 2 excel work books and then highlight the differences. I've looked to previous solutions and they helped a lot, however I still can't get this macro running. I've created 2 scripts to see which one works best.</p>\n\n<p><strong>1.</strong></p>\n\n<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim strRangeToCheck As String\nDim iRow As Long\nDim iCol As Long\n\nstrRangeToCheck = \"A1:AK900\"\n\n'Get worksheets from the workbooks\nSet wbkN = Workbooks.Open(Filename:=\"U:\\gebouwensep.xlsx\")\nSet Nieuweversie = wbkN.Worksheets(\"gebouwen\")\n\n\nSet wbkO = Workbooks.Open(Filename:=\"U:\\gebouwenaug.xlsx\")\nSet Oudeversie = wbkO.Worksheets(\"gebouwen\")\n\nIf Nieuweversie &lt;&gt; Oudeversie Then\n    Nieuweversie.Sheets(gebouwen).Cells(iRow, iCol).Interior.Color = vbYellow\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>2</strong></p>\n\n<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim strRangeToCheck As String\nDim iRow As Long\nDim iCol As Long\nDim mycell As Range\nDim mydiffs As Integer\n\nNlin = 1\nNcol = 1\n\n'get worksheets from the workbooks\nSet wbkA = Workbooks.Open(Filename:=\"U:\\gebouwensep.xlsx\")\nSet varSheetA = wbkA.Worksheets(\"gebouwen\") \n\nSet wbkB = Workbooks.Open(Filename:=\"U:\\gebouwenaug.xlsx\")\nSet varSheetB = wbkB.Worksheets(\"gebouwen\")\n\nstrRangeToCheck = \"A1:AK900\"\n\nvarSheetA = varSheetA.Range(strRangeToCheck)\nvarSheetB = varSheetB.Range(strRangeToCheck)\n\nFor iRow = LBound(varSheetA, 1) To UBound(varSheetA, 1)\n    For iCol = LBound(varSheetA, 2) To UBound(varSheetA, 2)\n        If Not varSheetA(iRow, iCol) = varSheetB(iRow, iCol) Then\n\n        Else\n              Nieuweversie.Sheets(gebouwen).Cells(iRow, iCol).Interior.Color = vbYellow\n        End If\n    Next iCol\nNext iRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 3, "creation_date": 1477476755, "post_id": 40258872, "comment_id": 67779833, "body": "Try the link here on SO (works very nice) <a href=\"http://stackoverflow.com/questions/12796973/function-to-convert-column-number-to-letter\" title=\"function to convert column number to letter\">stackoverflow.com/questions/12796973/&hellip;</a>"}, {"owner": {"reputation": 1753, "user_id": 1802705, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q7FNO.jpg?s=128&g=1", "display_name": "Fred Smith", "link": "https://stackoverflow.com/users/1802705/fred-smith"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477482447, "post_id": 40258872, "comment_id": 67783350, "body": "<a href=\"http://stackoverflow.com/questions/12796973/function-to-convert-column-number-to-letter\">This solution solved my problem</a>"}], "owner": {"reputation": 1753, "user_id": 1802705, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q7FNO.jpg?s=128&g=1", "display_name": "Fred Smith", "link": "https://stackoverflow.com/users/1802705/fred-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1477486800, "answer_count": 0, "score": 0, "last_activity_date": 1477475105, "creation_date": 1477475105, "question_id": 40258872, "link": "https://stackoverflow.com/questions/40258872/vba-how-to-convert-a-column-to-a-number", "closed_reason": "Duplicate", "title": "VBA How to convert a column to a number", "body": "<p>In several VBA codes, I often find a column number like 180 or any other integer number.\nIs there a VBA formula or a coded method to calculate that it is column \"FX\" without counting it manually ?</p>\n"}, {"tags": ["php", "vba", "http-headers", "http-post", "server-side"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1477476763, "post_id": 40258743, "comment_id": 67779838, "body": "Fascinating.  I dunno much about PHP but have you tested your server side code from a web page?  That might help diagnostics."}, {"owner": {"reputation": 47, "user_id": 7074078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770980cb1ecaf3d0b6ad4a02e5ec868b?s=128&d=identicon&r=PG&f=1", "display_name": "Supertramp", "link": "https://stackoverflow.com/users/7074078/supertramp"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1477487234, "post_id": 40258743, "comment_id": 67786568, "body": "Yes, I have a simple webpage to test it, I didn&#39;t get any error, but at same time I can&#39;t receive my file. Meanwhile if I use the 2nd code I wrote, I can get the file, but it&#39;s not the best way to do it."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1477495736, "post_id": 40258743, "comment_id": 67792994, "body": "What PHP server are you running?"}, {"owner": {"reputation": 47, "user_id": 7074078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770980cb1ecaf3d0b6ad4a02e5ec868b?s=128&d=identicon&r=PG&f=1", "display_name": "Supertramp", "link": "https://stackoverflow.com/users/7074078/supertramp"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1477502430, "post_id": 40258743, "comment_id": 67796996, "body": "@SMeaden Meaden I&#39;m not sure. I&#39;m running PHP on a NAS Server.  I&#39;m a rookie in  PHP."}], "owner": {"reputation": 47, "user_id": 7074078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770980cb1ecaf3d0b6ad4a02e5ec868b?s=128&d=identicon&r=PG&f=1", "display_name": "Supertramp", "link": "https://stackoverflow.com/users/7074078/supertramp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1477474759, "creation_date": 1477474759, "question_id": 40258743, "link": "https://stackoverflow.com/questions/40258743/send-a-file-from-vba-to-php", "title": "Send a file from VBA to PHP", "body": "<p>Hello guys I use that code to send a zip file to my server, from here:\n<a href=\"https://wqweto.wordpress.com/2011/07/12/vb6-using-wininet-to-post-binary-file/\" rel=\"nofollow\">https://wqweto.wordpress.com/2011/07/12/vb6-using-wininet-to-post-binary-file/</a></p>\n\n<p>I use it to send zip files to my server, but my server-side has a script that can't receive my files, don't know if the problem is from my VBA or my PHP. I will let you with both codes to try to get help from you guys. Much thanks.</p>\n\n<pre><code>Public Function pvPostFile(sUrl As String, sFileName As String, Optional ByVal bAsync As Boolean) As String\n'Const STR_BOUNDARY  As String = \"3fbd04f5-b1ed-4060-99b9-fca7ff59c113\"\nDim nFile           As Integer\nDim baBuffer()      As Byte\nDim sPostData       As String\n\n'--- read file\nnFile = FreeFile\nOpen sFileName For Binary Access Read As nFile\nIf LOF(nFile) &gt; 0 Then\n    ReDim baBuffer(0 To LOF(nFile) - 1) As Byte\n    Get nFile, , baBuffer\n    sPostData = StrConv(baBuffer, vbUnicode)\nEnd If\nClose nFile\n\n'--- prepare body\nsPostData = \"Content-Disposition: form-data; filename=\"\"\" &amp; Mid$(sFileName, InStrRev(sFileName, \"\\\") + 1) &amp; vbCrLf &amp; _\n    \"Content-Type: application/octet-stream\" &amp; vbCrLf &amp; vbCrLf &amp; _\n    sPostData &amp; vbCrLf\n\n'--- post\nWith CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    .Open \"POST\", sUrl, bAsync\n    .SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    .SetRequestHeader \"Content-Type\", \"multipart/form-data;\"\n    .SetRequestHeader \"Name\", FindLastModified\n    .SetRequestHeader \"Connection\", \"close\"\n    .Send pvToByteArray(sPostData)\n    If Not bAsync Then\n        pvPostFile = .ResponseText\n    End If\nEnd With\nEnd Function\n\nPrivate Function pvToByteArray(sText As String) As Byte()\n   pvToByteArray = StrConv(sText, vbFromUnicode)\nEnd Function\n</code></pre>\n\n<p>My server-side code:</p>\n\n<pre><code>error_reporting(E_ALL);\nini_set('display_errors', '1');\n\n$headers = getallheaders();\n$input = print_r($_FILES, true);\n$sDate = date('Y-m-d H:i:s');\n</code></pre>\n\n<p>It is a part of my server side code. But the problem is here I think, because I can't get my FILE with \"$input = print_r($_FILES, true);\".\nInstead I use it to receive the files, but its not the way it should be:</p>\n\n<pre><code>$input = file_get_contents('php://input');\n\n$i = strpos($input, \"\\r\\n\\r\\n\");\nif ($i !== false)\n   $input = substr($input, $i + 4);\n\nfile_put_contents('resultado.zip', $input);\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477476861, "post_id": 40258456, "comment_id": 67779907, "body": "what language settings are you running that you are getting <code>#NV</code> instead of <code>#NA</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1477479510, "creation_date": 1477479510, "answer_id": 40260492, "question_id": 40258456, "link": "https://stackoverflow.com/questions/40258456/if-cell-value-is-nv-get-another-cell/40260492#40260492", "title": "If cell value is #NV get another cell", "body": "<p>you may want to try this:</p>\n\n<pre><code>Dim cell As Range\n\nSet SourceRange = Sheets(\"Sheet1\").Range(\"AW2:AW\" &amp; lastRow)\nSet ResultRange = Sheets(\"Sheet2\").Range(\"A2:H\" &amp; lastRow)\n\ni = 1\n\nstrng = \"O X P J K G H I\" '&lt;-- list the columns index you want to grab data from, in order\nWith ResultRange\n    For Each cell In SourceRange\n        If cell.Value = 1 Then\n            .Cells(i, 1).Resize(, 8).FormulaR1C1 = Split(\"=Sheet1!\" &amp; Replace(strng, \" \", cell.Row &amp; \" =Sheet1!\") &amp; cell.Row)\n            .Cells(i, 1).Resize(, 8).Value = .Cells(i, 1).Resize(, 8).Value\n            If .Cells(i, 2) = \"#NV\" Then .Cells(i, 2).Value = Sheets(\"Sheet1\").Range(\"AA\" &amp; cell.Row).Value\n            i = i + 1\n        End If\n    Next cell\n    .Value = .Value\nEnd With \n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 40260492, "answer_count": 1, "score": 0, "last_activity_date": 1477479510, "creation_date": 1477473960, "question_id": 40258456, "link": "https://stackoverflow.com/questions/40258456/if-cell-value-is-nv-get-another-cell", "title": "If cell value is #NV get another cell", "body": "<p>I've got the following code to work with</p>\n\n<pre><code>    Set sourcerange = Sheets(\"Sheet1\").Range(\"AW2:AW\" &amp; lastRow)\n    Set resultrange = Sheets(\"Sheet2\").Range(\"A2:H\" &amp; lastRow)\n\n    i = 1\n\n\n    For Each cell In sourcerange\n        If cell.Value = 1 Then\n            resultrange.Rows.Cells(i, 1).Value = Sheets(\"Sheet1\").Range(\"O\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 2).Value = Sheets(\"Sheet1\").Range(\"X\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 3).Value = Sheets(\"Sheet1\").Range(\"P\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 4).Value = Sheets(\"Sheet1\").Range(\"J\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 5).Value = Sheets(\"Sheet1\").Range(\"K\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 6).Value = Sheets(\"Sheet1\").Range(\"G\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 7).Value = Sheets(\"Sheet1\").Range(\"H\" &amp; cell.row).Value\n            resultrange.Rows.Cells(i, 8).Value = Sheets(\"Sheet1\").Range(\"I\" &amp; cell.row).Value\n            i = i + 1\n        End If\nNext cell\n</code></pre>\n\n<p>Now to my problem:\nSometimes it happens, that the value from this code:</p>\n\n<pre><code>resultrange.Rows.Cells(i, 2).Value = Sheets(\"Sheet1\").Range(\"X\" &amp; cell.row).Value\n</code></pre>\n\n<p>is #NV. In this case, I want to copy the value from the column \"AA\". But I've got no idea how to accomplish this. Is there a way to add something in my code to bring it to work? Or do I have to rewrite everything?</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting", "array-formulas"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477474505, "post_id": 40257529, "comment_id": 67778409, "body": "As I understand it, table 1 is loaded from the database. I do not understand &quot;RequirementSet&quot;. Has this come from the database? A driver for Car 1 must have a type A licence. So Requirement 1 looks more appropriate than requirement 2. I think you need to concentrate on how to decide which requirement (or requirements?) apply to which database row. Until you know the complexity of the requirement applying process, you cannot decide the best approach to implementing that process."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477474540, "post_id": 40257529, "comment_id": 67778435, "body": "I find conditional formatting useful when the user is entering data.  As I understand it, you load table 1 from a database, run a macro to check the data against requirements then review the results of that check.  Why not just colour the cells?  Why is the macro generating formulae for Excel to obey when it has already decided what colour or other format is required?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1477474713, "post_id": 40257529, "comment_id": 67778554, "body": "This site is for programming questions not design questions.  I do not know where this question should be posted but please do not be surprised if it is moved or closed as inappropriate."}, {"owner": {"reputation": 1915, "user_id": 1134726, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ce051c0c10ccf440d318d36f2b25ea5?s=128&d=identicon&r=PG", "display_name": "ExternalUse", "link": "https://stackoverflow.com/users/1134726/externaluse"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477474950, "post_id": 40257529, "comment_id": 67778710, "body": "Thanks for your response; it really is a development question however I don&#39;t yet know what to develop... In response: Table 1 is loaded from the database and every record carries the information of its requirement set to be used. The driver in car 1 <i>has</i> an A license, but requirementset 2 (which it is) demands a B license. Therefore in the example it would be displayed as red (bad) instead of green (ok)."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1477475451, "post_id": 40257529, "comment_id": 67779024, "body": "Look at other questions?  \u201cI am trying to achieve Effect X with these statements but I get Effect Y\u201d is typical.  Questions like \u201cHere is my problem? What should I do?\u201d get voted down and closed. You have clearly put effort into understanding and describing your problem which may save your question.  I confess that I like design questions but I appear to be in a minority."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477475807, "post_id": 40257529, "comment_id": 67779231, "body": "In your Table 2, requirements are identified by sequential numbers.  Does this match reality?  A dictionary would be useful if requirements were identified by unique, discontinuous keys. An array would be better with sequential or nearly sequential numbers."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477478466, "post_id": 40257529, "comment_id": 67780849, "body": "If requirements are numbered 1, 2, 3, etc. I would load Table 2 (<code>Variant = Range.Value</code>) to an array.  I would run down Table 1, checking conditions and colouring rows as appropriate.  If the user wants a reason, I would consider recording a comment in column A."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477478498, "post_id": 40257529, "comment_id": 67780868, "body": "If requirement ids are discontinuous, I would sort both worksheets by requirement id and then work down the two tables matching on requirement id.  If I could not sort the worksheets or if I was worried about the time to physically re-sequence 71 column rows, I would load them to arrays and use an indexed sort. I would then use the indices to work down the two tables matching on requirement id."}, {"owner": {"reputation": 1915, "user_id": 1134726, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ce051c0c10ccf440d318d36f2b25ea5?s=128&d=identicon&r=PG", "display_name": "ExternalUse", "link": "https://stackoverflow.com/users/1134726/externaluse"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477481093, "post_id": 40257529, "comment_id": 67782543, "body": "The only difference between present and f(u|ea)ture is that I presently check against a fixed set of requirements. So if table 2&#39;s header in column B is &quot;MinHorsepower&quot;, then B2 (which contains the value) is the named Range MinHorsepower. The added complexity is when obtaining more than 1 such requirement row. Now I would need to match the data&#39;s (table 1) requirement set id to the corresponding set first, then matching the required value for comparison with the actual data. I&#39;ll look at your suggestion with loading the table 2 now and update my question accordingly. Thanks for your effort!"}, {"owner": {"reputation": 1915, "user_id": 1134726, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ce051c0c10ccf440d318d36f2b25ea5?s=128&d=identicon&r=PG", "display_name": "ExternalUse", "link": "https://stackoverflow.com/users/1134726/externaluse"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477745039, "post_id": 40257529, "comment_id": 67894392, "body": "I have <a href=\"http://stackoverflow.com/questions/27180646/excel-vba-nested-dictionary-accessing-items\">found my answer</a>. I would like to give <a href=\"http://stackoverflow.com/users/478884/tim-williams\">Tim Williams</a> credit but don&#39;t know if that is possible? I wouldn&#39;t necessarily like to answer my own question using his knowledge."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1477756190, "post_id": 40257529, "comment_id": 67897402, "body": "You can vote up Tim&#39;s answer by clicking the upward facing triangle at the top. That is worth 10 points on his reputation. I suspect that most of the time knowing our efforts are helpful and appreciated is more important that the points. If you include @ followed by his name in a comment, he will be get a message in his Inbox telling him to read the comment."}, {"owner": {"reputation": 1915, "user_id": 1134726, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ce051c0c10ccf440d318d36f2b25ea5?s=128&d=identicon&r=PG", "display_name": "ExternalUse", "link": "https://stackoverflow.com/users/1134726/externaluse"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1477912575, "post_id": 40257529, "comment_id": 67936212, "body": "I&#39;ve already voted it up, thanks. Should I vote to close mine? Add an answer mentioning the original solution? @tim-williams Not sure you see this comment unless you&#39;ve been involved in the thread, but if you do, thanks! If you reply I&#39;ll happily accept it as the answer."}], "owner": {"reputation": 1915, "user_id": 1134726, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8ce051c0c10ccf440d318d36f2b25ea5?s=128&d=identicon&r=PG", "display_name": "ExternalUse", "link": "https://stackoverflow.com/users/1134726/externaluse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1477745572, "creation_date": 1477471238, "last_edit_date": 1495542802, "question_id": 40257529, "link": "https://stackoverflow.com/questions/40257529/excel-vba-conditional-formatting-dictionary-of-dictionaries", "title": "Excel/VBA/Conditional Formatting: Dictionary of Dictionaries", "body": "<p>I've got an Excel workbook that obtains data from an MS SQL database. One of the sheets is used to check the data against requirements and to highlight faults. In order to do that, I've got a requirements sheet where the requirement is in a named range; after updating the data I copy the conditional formatting of the table header to all data rows. That works pretty nicely so far. The problem comes when I have more than one set of requirements:</p>\n\n<p>An (agreeably silly) example could be car racing, where requirements may exist for driver's license and min/max horsepower. When looking at the example, please imagine there are a few thousand rows and 71 columns presently...</p>\n\n<pre><code>+-----+--------+----------------+------------+---------+\n| Car |  Race  | RequirementSet | Horsepower | License |\n+-----+--------+----------------+------------+---------+\n|  1  | Monaco |        2       |     200    |    A    |\n+-----+--------+----------------+------------+---------+\n|  2  | Monaco |        2       |     400    |    B    |\n+-----+--------+----------------+------------+---------+\n|  3  |  Japan |        3       |     200    |    C    |\n+-----+--------+----------------+------------+---------+\n|  4  |  Japan |        3       |     300    |    A    |\n+-----+--------+----------------+------------+---------+\n|  5  |  Japan |        3       |     350    |    B    |\n+-----+--------+----------------+------------+---------+\n|  6  | Mexico |        1       |     200    |    A    |\n+-----+--------+----------------+------------+---------+\n</code></pre>\n\n<p>The individual data now needs to be checked against the requirements set in another sheet:</p>\n\n<pre><code>+-------------+---------------+---------------+---------+\n| Requirement | MinHorsepower | MaxHorsepower | License |\n+-------------+---------------+---------------+---------+\n| 1           | 200           | 250           | A       |\n+-------------+---------------+---------------+---------+\n| 2           | 250           | 500           | B       |\n+-------------+---------------+---------------+---------+\n| 3           | 250           | 400           | A       |\n+-------------+---------------+---------------+---------+\n</code></pre>\n\n<p>In order to relate back to my present situation, I am only looking at either the Monaco, Japan or Mexico Race, and there is only 1 record in the requirements sheet, where the value in e.g. Cell B2 is always the MinHorsepower and the value in C2 is always the MaxHorsepower. So these cells are a named range that I can access in my data sheet.</p>\n\n<p>Now however I would like to obtain all races at once, and refer conditional formatting formulas to the particular requirement. </p>\n\n<p>Focussing on \"Horsepower\" in Monaco (requirement set 2), I can now find out that the min Horsepower is 250 and the max is 500 - so I will colour that column for car 1 as red and for car 2 as green.\nThe formula is programatically copied from the header row (the first conditional format rule is <code>if row(D1) = 1 then do nothing</code>)</p>\n\n<p>I can't decide what the best approach to the problem is. Ideally, the formula is readable, something like `AND(D2 >= MinHorsepower; D2 &lt;= MaxHorsepower) - I cannot imagine it to be maintainable if I had to use Vlookup combined with Indirect and Match to match a column header in requirements for that particular requirement - especially when it comes to combining criteria like in the HP example with min and max above.</p>\n\n<p>I am wondering if I should read the requirements table into a dictionary or something in VBA, and then use a function like</p>\n\n<pre><code>public function check(requirementId as int, requirement$)\n</code></pre>\n\n<p>which then in Excel I could use like <code>=D2 &gt;= check(c2, \"MinHorsepower\")</code></p>\n\n<p>Playing around with this a little bit it appears to be pretty slow as opposed to the previous system where I could only have one requirement. It would be fantastic if you could help me out with a fresh approach to this problem. I'll update this question as I go along; I'm not sure if I managed to illustrate the example really well but the actual data wouldn't mean anything to you.\nIn any case, thanks for hanging in until here!</p>\n\n<p><strong>Edit 29 October 2016</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/27180646/excel-vba-nested-dictionary-accessing-items\" title=\"Excel vba nested dictionary - accessing items\">I have found a solution</a> as basis for mine. Using the following code I can add my whole requirements table to a dictionary, and access the requirement.</p>\n\n<p>Using a class clsRangeToDictionary (based on Tim Williams clsMatrix) </p>\n\n<pre><code>Option Explicit\n\nPrivate m_array As Variant\nPrivate dictRows As Object\nPrivate dictColumns As Object\n\nPublic Sub Init(vArray As Variant)\n    Dim i As Long\n    Set dictRows = CreateObject(\"Scripting.Dictionary\")\n    Set dictColumns = CreateObject(\"Scripting.Dictionary\")\n\n    'add the row keys and positions. Skip the first row as it contains the column key\n    For i = LBound(vArray, 1) + 1 To UBound(vArray, 1)\n        dictRows.Add vArray(i, 1), i\n    Next i\n    'add the column keys and positions, skipping the first column\n    For i = LBound(vArray, 2) + 1 To UBound(vArray, 2)\n        dictColumns.Add vArray(1, i), i\n    Next i\n    ' store the array for future use\n    m_array = vArray\nEnd Sub\n\nPublic Function GetValue(rowKey, colKey) As Variant\n    If dictRows.Exists(rowKey) And dictColumns.Exists(colKey) Then\n        GetValue = m_array(dictRows(rowKey), dictColumns(colKey))\n    Else\n        Err.Raise 1000, \"clsRangeToDictionary:GetValue\", \"The requested row key \" &amp; CStr(rowKey) &amp; \" or column Key \" &amp; CStr(colKey) &amp; \" does not exist\"\n    End If\nEnd Function\n\n'   return a zero-based array of RowKeys\nPublic Function RowKeys() As Variant\n    RowKeys = dictRows.Keys\nEnd Function\n'   return a zero-based array of ColumnKeys\nPublic Function ColumnKeys() As Variant\n    ColumnKeys = dictColumns.Keys\nEnd Function\n</code></pre>\n\n<p>I can now read the whole RequirementSet table into a dictionary and write a helper to obtain the particular requirement roughly so:</p>\n\n<pre><code>myDictionaryObject.GetValue(table1's RequirementSet, \"MinHorsePower\")\n</code></pre>\n\n<p>If someone could help me figure out how to put this into an answer giving the credit due to Tim Williams that'd be great.</p>\n"}, {"tags": ["excel", "printing", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477477419, "post_id": 40257229, "comment_id": 67780241, "body": "<code>Application.DisplayAlerts = False</code>, perhaps? I can&#39;t say for sure without seeing the code."}, {"owner": {"reputation": 1, "user_id": 7073824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c27f76fe0523f0a71ca6aed9820ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Mouton", "link": "https://stackoverflow.com/users/7073824/mouton"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477578110, "post_id": 40257229, "comment_id": 67832488, "body": "Sub invoer() Application.DisplayAlerts = False Dim STDprinter As String  STDprinter = Application.ActivePrinter ActiveSheet.PrintOut ActivePrinter:=&quot;\\\\SRPGEN23055\\PR251419&quot; Application.ActivePrinter = STDprinter  End Sub"}, {"owner": {"reputation": 1, "user_id": 7073824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c27f76fe0523f0a71ca6aed9820ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Mouton", "link": "https://stackoverflow.com/users/7073824/mouton"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1477578181, "post_id": 40257229, "comment_id": 67832548, "body": "It isn&#39;t working. your code was already in my macro ..."}], "owner": {"reputation": 1, "user_id": 7073824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c27f76fe0523f0a71ca6aed9820ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Mouton", "link": "https://stackoverflow.com/users/7073824/mouton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477727438, "creation_date": 1477470355, "last_edit_date": 1531161705, "question_id": 40257229, "link": "https://stackoverflow.com/questions/40257229/print-file-without-entering-user-id", "title": "Print file without entering user-ID", "body": "<p>I have an excel file I want to print from a macro.\nthis i my code </p>\n\n<pre><code>ActiveSheet.PrintOut ActivePrinter:=\"\\\\printer name\".\n</code></pre>\n\n<p>I get now a box where I need to enter a user-id. The user ID is already entered and then I have to press OK, but I do not want to have that box. I just want to print this automatically.</p>\n\n<p>PS. I cannot chance the print options, I am in a business environment...</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1477467827, "post_id": 40256226, "comment_id": 67774308, "body": "This one may explain why you got digit (<a href=\"http://stackoverflow.com/questions/11450055/when-i-import-the-date-format-in-exceldd-mm-yyyy-to-msaccess-it-is-showing-non\" title=\"when i import the date format in exceldd mm yyyy to msaccess it is showing non\">stackoverflow.com/questions/11450055/&hellip;</a>), and <code>hh:nn:ss</code> is typo? should it be <code>hh:mm:ss</code>?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1477468323, "post_id": 40256226, "comment_id": 67774608, "body": "@Alex mm is month."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1477468389, "post_id": 40256226, "comment_id": 67774653, "body": "I suggest you import to an existing empty table with a date format for that column."}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1477468418, "post_id": 40256226, "comment_id": 67774664, "body": "@Fionnuala, you are correct, confuse with other date time format"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1477468469, "post_id": 40256226, "comment_id": 67774693, "body": "Thanks for the input all - Fionnuala I will also try that method now"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1477468944, "post_id": 40256226, "comment_id": 67774937, "body": "BTW testing with Office 2016, an straight import of time works for me."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1477468979, "post_id": 40256226, "comment_id": 67774955, "body": "I tried your method but doesn&#39;t work unfortunately. When I import the data nothing at all shows in the table when changing the format to hh:nn:ss"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1668, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1477467022, "creation_date": 1477467022, "question_id": 40256226, "link": "https://stackoverflow.com/questions/40256226/time-format-hhnnss-in-access", "title": "Time Format hh:nn:ss in access", "body": "<p>We have reports run for us that shows the amount of time a user has been logged in. The report is in excel and shows the cell format as text, the time shown in the cell is in this format 08:10:31 </p>\n\n<p>When I import this to access it shows as a 5 digit number (e.g 20326)</p>\n\n<p>How do I get access to show it in the same format that its in excel?</p>\n\n<p>I have tried changing the table format in access to hh:nn:ss but then the cell shows as blank.</p>\n\n<p>Help</p>\n"}, {"tags": ["excel", "vba", "duplicates", "formula"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477469081, "post_id": 40255510, "comment_id": 67775015, "body": "Since you want to <i>replace</i> values in different cells then you need VBA for this. UDF can&#39;t change cells other than the ones they are called in (if not by means of some dangerous tricks)"}], "answers": [{"tags": [], "owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "is_accepted": true, "score": 1, "last_activity_date": 1477470776, "creation_date": 1477470776, "answer_id": 40257371, "question_id": 40255510, "link": "https://stackoverflow.com/questions/40255510/how-do-i-replace-all-duplicate-values-in-excel-with-a-formula/40257371#40257371", "title": "How do I replace all duplicate values in Excel with a formula?", "body": "<p>You don't have to use vba, you can use a formula (INDEX MATCH) as well to get your desired result.</p>\n\n<p>As you can see in the picture below, this formula looks for the first occurrance of the word in column B and returns it's corresponding value in column A.\n<a href=\"https://i.stack.imgur.com/6XfoP.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/6XfoP.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 4147665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/10803c862e9be9f5c178bf7a5913f7b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afu Ra", "link": "https://stackoverflow.com/users/4147665/afu-ra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 40257371, "answer_count": 1, "score": 0, "last_activity_date": 1477470776, "creation_date": 1477464625, "last_edit_date": 1477464930, "question_id": 40255510, "link": "https://stackoverflow.com/questions/40255510/how-do-i-replace-all-duplicate-values-in-excel-with-a-formula", "title": "How do I replace all duplicate values in Excel with a formula?", "body": "<p>I'm trying to replace all duplicate values in my spreadsheet with an original value via a formula. However, I'm finding it really hard to use the correct formula to perform this action.</p>\n\n<p>I have multiple apple entries in my spreadsheet with a corresponding number beside them. </p>\n\n<p>On 22/10/2016, I received 2 apples. On the 23rd, I received 4, and so on.</p>\n\n<pre><code>Number | Item\n2      | Apple\n4      | Apple\n5      | Apple\n</code></pre>\n\n<p>My pseudo-code looks something like this:</p>\n\n<p>IF duplicate item is found, replace all number values with an original value (2).</p>\n\n<p>Can someone help me out with a formula, I don't use excel too much.</p>\n\n<p>Any information would help, and/or if you were to point me into the right direction, that would be most beneficial.</p>\n\n<p>If you would like any more information about my problem, then please ask away and I'll try construct this problem better for you.</p>\n\n<p>Thank you for your help.</p>\n\n<p>EDIT: Keep in mind, I may also have other duplicate values in my sheet. I only want the formula to effect apples in this case, and bananas in a different formula.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1477464681, "post_id": 40255462, "comment_id": 67772580, "body": "What have you tried yourself? Show us any code you have written so far so that we can help. SO is not a coding service."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477487309, "post_id": 40255462, "comment_id": 67786630, "body": "Do you want all columns to total 3? or any single column? How many columns of data do you have for each row? All i can think of would be a mentally long formula to work it out with a dual  for next loop that checks each column total.."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477487774, "post_id": 40255462, "comment_id": 67786975, "body": "If it&#39;s a single column of data then I would <code>Dim ClmTtl As Integer</code> and start a &#39;for&#39; &#39;next&#39; loop like you have but before the loop <code>ClmTtl = 0</code> then loop through each row number adding the value of each cell from that column to <code>ClmTtl</code>. After the loop you can then do an if to see if the value = 3 and if not either <code>goto</code> an earlier stage in the code or call the sub again to restart it."}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477527367, "post_id": 40255462, "comment_id": 67807799, "body": "@Glitch_Doctor yeahh. i want all column total 3. can you show me the code. ?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477560618, "post_id": 40255462, "comment_id": 67820491, "body": "Well, it&#39;s certainly achievable but for multiple columns the code would be working extremely hard and if the answer isn&#39;t there it could potentially loop endlessly. To keep the code entirely random the majority of outcomes will not be 3 in every column so will fail and begin again so does it have to be entirely random or could you factor in some assisted code like if total of column is now 3 then filter remaining results to 0 and search special cells instead? just a though as teh code would execute faster..."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477561686, "post_id": 40255462, "comment_id": 67821179, "body": "I mocked up the RAND function on a spreadsheet and had a macro loop calculate for 5 minutes, I have 3000 lines of binary the same width as your example, none of the outcomes had 3 in all columns... Before i put effort into this I want to be sure that the outcome is achievable, I&#39;m guessing you won&#39;t want to leave the program running for longer than 5 minutes every press?"}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477624147, "post_id": 40255462, "comment_id": 67852948, "body": "thank you @Glitch_Doctor. i will try later on. hope for the best result"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477653246, "post_id": 40255462, "comment_id": 67864752, "body": "Good luck, I ran it with 5 lines instead of 17 and it took 1 minute 34 seconds but the 17 lines was still not successful at the end of my shift yesterday - over 3 hours. If you find my answer succesful or helpful pelase remember to mark it as an answer - thank you. Please let me know how it goes."}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "edited": false, "score": 0, "creation_date": 1477893428, "post_id": 40255462, "comment_id": 67929260, "body": "i just tried combine your coding and run, excel not responding. how can i fix? reduce the number of row?@Glitch_Doctor"}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1477932067, "post_id": 40255462, "comment_id": 67947689, "body": "when i try with a little data it can work. but with a lot data its cannot run @Glitch_Doctor"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1478673150, "post_id": 40255462, "comment_id": 68245945, "body": "Sorry I have been ill for a while. It is a working code but there just aren&#39;t enough possible outcomes to run smoothly, only other thing I can think of is to save previous column outcomes in an array and get the script to avoid selecting those again. A lot of work though which I wont have time to attempt. Good luck!"}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1478673782, "post_id": 40255462, "comment_id": 68246160, "body": "hello @Glitch_Doctor . thank you so much. you help me a lot. btw, i have one problem which. i want to do like this but only with one column which column number 43 . can you help me? i try but it does not work."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479305929, "post_id": 40255462, "comment_id": 68501099, "body": "Sorry, I really don&#39;t understand that last comment."}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479357210, "post_id": 40255462, "comment_id": 68525109, "body": "ohh sorry @Glitch_Doctor my bad. just forget it. i  have try and got one problem which is the range. how can i fix it?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479378430, "post_id": 40255462, "comment_id": 68536100, "body": "no problem Jai. Perhaps edit your question with an update to show the problem that you are now facing and I can take a look at it. Specifically any errors that you are getting etc."}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "edited": false, "score": 0, "creation_date": 1479646984, "post_id": 40255462, "comment_id": 68636575, "body": "i think the coding is correct. but when i want to run it. excel suddenly not responding. how can i fix it?"}, {"owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479647582, "post_id": 40255462, "comment_id": 68636740, "body": "@Glitch_Doctor see the previous comment"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479716942, "post_id": 40255462, "comment_id": 68658741, "body": "Probably because of the strain. Your code looks through each possible combination of binary. If the binary is 43 digits long (assumption as you stated column 43) then the possible outcomes: x\u207f where x is the number of possible outcomes per digit and \u207f is the number of digits, 2^43 = 8,796,093,022,208... And that&#39;s without further limitation of the column totals. Not to mention your code doesn&#39;t store previous outcomes and can duplicate increasing this number further."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479717101, "post_id": 40255462, "comment_id": 68658833, "body": "Anyway, SO isn&#39;t a free coding service, if you have errors you should update your code so that we can see what you have done and offer advice based on that. If I have answered your question please mark it as an answer and feel free to begin another thread relating to your other issue."}], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 0, "last_activity_date": 1477564269, "creation_date": 1477564269, "answer_id": 40282314, "question_id": 40255462, "link": "https://stackoverflow.com/questions/40255462/copy-and-paste-in-vba/40282314#40282314", "title": "copy and paste in vba", "body": "<p>This will achieve what you are looking for but the code will take a long time  to execute, I actually mocked up formula that mimics your code using <code>RANDBETWEEN(1,COUNTIF(Sheet1!A:A,\"&lt;&gt;\"&amp;\"\"))</code>  and <code>RandBetweenInt(1,COUNTIF(Sheet1!A:A,\"&lt;&gt;\"&amp;\"\"),***Range of Random Integers from above***)</code> (a user defined function found <a href=\"http://www.mrexcel.com/forum/excel-questions/157520-randbetween-excluding-values.html#\" rel=\"nofollow\">here</a>). This calculates much faster and does not include duplicate random figures. </p>\n\n<pre><code>Sub chkRand()\n\nApplication.Calculation = xlCalculationManual\n\nDo Until Worksheets(\"Sheet3\").Range(\"I18\").Value = 1\nApplication.Calculate\nLoop\n\nEnd Sub\n</code></pre>\n\n<p><code>.Range(\"I18\")</code> has the formula <code>=IF(COUNTIF(B18:H18,3)=7,1,0)</code> so this will force manual calculation and then recalculate until all of the columns total 3.</p>\n\n<p>Be wary though I have left this macro running for 30minutes now and it still hasn't found a match. </p>\n\n<p>Just in-case you were really looking for a VBA only solution I would use:</p>\n\n<pre><code>For Clm = 2 To 8\nClmTtl = 0\n    For copyRow = 1 To percRows\n     ClmTtl = ClmTtl + Sheets(1).Cells(MyRows(copyRow), clm).Value\n    Next\n    If Not ClmTtl = 3 Then Call Random20\nNext\n</code></pre>\n\n<p>Though I would always advise seeking a formula based solution first and use macros only where they are required.</p>\n\n<p>As this can only proceed to the next column when the previous one totals 3 the code can only finish when they all are of the desired total. Hope this helps, good luck reducing the runtime.</p>\n"}], "owner": {"reputation": 3, "user_id": 7073315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a75ad131758b379b788d87a8d975f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Jai Wilshere", "link": "https://stackoverflow.com/users/7073315/jai-wilshere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477564269, "creation_date": 1477464435, "last_edit_date": 1477467637, "question_id": 40255462, "link": "https://stackoverflow.com/questions/40255462/copy-and-paste-in-vba", "title": "copy and paste in vba", "body": "<p>I have a problem with Excel VBA coding. </p>\n\n<p>I want to make one coding may copy data from one sheet to a sheet with certain conditions. my data in the form binary.</p>\n\n<p>data in sheet1 has nearly a thousand row. I just want to take 15 random row of data from sheet1 to sheet 2. The criteria which must be fulfilled is that each column only has the sum of the column is 3. if not met, other data will be taken.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bg0ke.jpg\" rel=\"nofollow\">here the example of my data</a></p>\n\n<p>when i click generate. it will copy from data sheet 1 to sheet 2. i want my data copy like the red circle one. not like the red column one. please help me  </p>\n\n<pre><code>Option Explicit\nSub Random20()\nRandomize\nDim MyRows() As Integer    \nDim numRows, percRows, nxtRow, nxtRnd, chkRnd, copyRow As Integer\n'Determine Number of Rows in Sheet1 Column A\n  numRows = Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n   percRows = 17\n\n    ReDim MyRows(percRows) \n'Create Random numbers and fill array\n     For nxtRow = 1 To percRows\ngetNew:\n'Generate Random number\n      nxtRnd = Int((numRows) * Rnd + 1)\n'Loop through array, checking for Duplicates\n       For chkRnd = 1 To nxtRow\n'Get new number if Duplicate is found\n        If MyRows(chkRnd) = nxtRnd Then GoTo getNew\n       Next\n'Add element if Random number is unique\n      MyRows(nxtRow) = nxtRnd\n     Next\n'Loop through Array, copying rows to Sheet2\n  For copyRow = 1 To percRows\n   Sheets(1).Rows(MyRows(copyRow)).EntireRow.Copy _\n     Destination:=Sheets(2).Cells(copyRow, 1)\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477464741, "post_id": 40255387, "comment_id": 67772614, "body": "it will be easier to assist you if you provide more info about your range, like the worksheet where your range is located, and how the data is located there"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1477464919, "post_id": 40255387, "comment_id": 67772690, "body": "How you have assigned the range to the ListBox1 ? Did you assign it in Listbox1 property ListFillRange ?"}, {"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "edited": false, "score": 0, "creation_date": 1477465948, "post_id": 40255387, "comment_id": 67773254, "body": "Hi Shai Rado - The range is only from C32 to C41. No more than that. Values from that range are the values included in my listbox."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477556059, "post_id": 40256617, "comment_id": 67817652, "body": "@kruk22, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 3, "last_activity_date": 1477468348, "creation_date": 1477468348, "answer_id": 40256617, "question_id": 40255387, "link": "https://stackoverflow.com/questions/40255387/remove-item-in-a-listbox-by-selecting-in-vba/40256617#40256617", "title": "Remove Item in a Listbox by selecting in VBA", "body": "<p>since you're using <code>.RemoveItem()</code> method you must have set your listbox range via its <code>List</code> property and not with <code>RowSource</code> one</p>\n\n<p>then you could use this code in your userform code pane:</p>\n\n<pre><code>Option Explicit\n\nDim listRng As Range '&lt;-- declare a Userform scoped variable of 'Range' type to track the range whose content you fill your ListBox1 with (for instance, in Userform_Initialize())\n\nPrivate Sub btnRemove_Click()\n    Dim i As Long\n    Dim rowsList As String\n\n    For i = ListBox1.ListCount - 1 To 0 Step -1\n        If ListBox1.Selected(i) Then\n            ListBox1.RemoveItem i\n        Else\n            rowsList = rowsList &amp; i + 1 &amp; \" \" '&lt;-- update the rows to be confirmed\n        End If\n    Next i\n    If rowsList &lt;&gt; \"\" Then UpdateListRange Left(rowsList, Len(rowsList) - 1)\nEnd Sub\n\nSub UpdateListRange (rowsList As String)\n    Dim addr As String\n    Dim iRow As Variant\n    Dim rowsListArr As Variant\n\n    rowsListArr = Split(rowsList)\n    For iRow = UBound(rowsListArr) To LBound(rowsListArr) Step -1\n        addr = addr &amp; listRng(rowsListArr(iRow)).address(False, False) &amp; \",\"\n    Next iRow\n\n    If addr &lt;&gt; \"\" Then addr = Left(addr, Len(addr) - 1)\n    Set listRng = listRng.Parent.Range(addr)\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    With Worksheets(\"List\").Range(\"C32:C41\") '&lt;-- change \"List\" to your actual worksheet name with the range whose content you fill ListBox1 list with\n        Me.ListBox1.List = Application.Transpose(.Cells) '&lt;-- fill ListBox1 list\n        Set listRng = .Cells '&lt;-- set the userform scoped range variable to track the \"listbox filling\" range\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41297, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549399887, "creation_date": 1477464143, "last_edit_date": 1477464469, "question_id": 40255387, "link": "https://stackoverflow.com/questions/40255387/remove-item-in-a-listbox-by-selecting-in-vba", "title": "Remove Item in a Listbox by selecting in VBA", "body": "<p>I have a list box which is based on the worksheet range. I put a button included in my Userform that deletes the selected item inside my listbox whenever it is clicked. And everytime there is a deleted item there, <strong>the deleted item should also be removed</strong> in my Worksheet range. <strong><em>Here's my code in removing the item in the listbox:</em></strong> </p>\n\n<pre><code>Private Sub btnRemove_Click()\nDim i As Integer\n\nFor i = 0 To ListBox1.ListCount - 1\n    If ListBox1.Selected(i) Then\n        ListBox1.RemoveItem (i)\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>How to remove the deleted item in the worksheet range? Thank you! :) </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477462500, "post_id": 40254668, "comment_id": 67771521, "body": "can you see what line actually causes that excel pop up? In my Excel 2013 if i try to set a workbook variable opening a workbook that&#39;s already open, it just sets it to the already open workbook and throws no popups"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477463905, "post_id": 40254668, "comment_id": 67772175, "body": "@user3598756  I just tested it in Excel 2016.  If you try and open another workbook twice it will not throw an error but if you try and open the workbook that is calling the code then the popup will appear (e.g. <code>Workbooks.Open ThisWorkbook.FullName</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477464039, "post_id": 40254668, "comment_id": 67772233, "body": "@user3598756 thanks for pointing that out."}, {"owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477464127, "post_id": 40254668, "comment_id": 67772285, "body": "Hey guys I&#39;m using Excel 2010. I think it might have to do with the fact that I &quot;touched the workbooked&quot;, eg., F2 a cell and then click Enter to back out from it which causes Excel to think the workbook has been edited after the last save..."}], "answers": [{"tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": true, "score": 2, "last_activity_date": 1477466193, "creation_date": 1477466193, "answer_id": 40255970, "question_id": 40254668, "link": "https://stackoverflow.com/questions/40254668/how-to-automatically-accept-excel-prompt-using-vba/40255970#40255970", "title": "How to automatically accept Excel prompt using VBA?", "body": "<p>first check if workbook is already opened. If not open try to open it. This can be done in below code. Refer the <a href=\"https://support.microsoft.com/en-in/kb/291295\" rel=\"nofollow\">link</a></p>\n\n<pre><code>Sub TestFileOpened()\n    Dim fullPath As String\n\n    fullPath = \"C:\\Df.xlsx\"\n    ' Test to see if the file is open.\n    If IsFileOpen(fullPath) Then\n      Set dataset = Workbooks(\"Df.xlsx\")\n    Else\n        Set dataset = Workbooks.Open(fullPath)\n    End If\n\nEnd Sub\n\nFunction IsFileOpen(filename As String)\n    Dim filenum As Integer, errnum As Integer\n\n    On Error Resume Next   ' Turn error checking off.\n    filenum = FreeFile()   ' Get a free file number.\n    ' Attempt to open the file and lock it.\n    Open filename For Input Lock Read As #filenum\n    Close filenum          ' Close the file.\n    errnum = Err           ' Save the error number that occurred.\n    On Error GoTo 0        ' Turn error checking back on.\n\n    ' Check to see which error occurred.\n    Select Case errnum\n\n        ' No error occurred.\n        ' File is NOT already open by another user.\n        Case 0\n         IsFileOpen = False\n\n        ' Error number for \"Permission Denied.\"\n        ' File is already opened by another user.\n        Case 70\n            IsFileOpen = True\n\n        ' Another error occurred.\n        Case Else\n            Error errnum\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 40255970, "answer_count": 1, "score": 0, "last_activity_date": 1477466193, "creation_date": 1477461149, "last_edit_date": 1477461589, "question_id": 40254668, "link": "https://stackoverflow.com/questions/40254668/how-to-automatically-accept-excel-prompt-using-vba", "title": "How to automatically accept Excel prompt using VBA?", "body": "<p>I have a VBA sub which checks if a workbook is open, and then copy and paste data from another workbook into it. This is done automatically in an application.ontime loop. I usually leave it minimized while I work on other things and check back on the Excel data copy/pasting occasionally. From time to time Excel will pop up a box saying that the destination workbook is open, and asks if I will want to reopen it. Many sub runs were missed between the time it pops up and the time that I check the workbook. </p>\n\n<p>Code on where the problem occurs:</p>\n\n<pre><code>If dataset Is Nothing Then\n    Set dataset = Workbooks.Open(\"C:\\Users\\Ken\\Desktop\\Df.xlsx\")\nElse\n    Set dataset = Workbooks(\"Df.xlsx\")\nEnd If\n</code></pre>\n\n<p>What can I do to have Excel automatically handle this situation? </p>\n\n<p>Secondary question: I'm suspecting that it may have something to do with the fact that I may have touched the workbook between runs without saving it, causing Excel to think there are changes since the last save. Can someone comment if this could be a reason?</p>\n"}, {"tags": ["vba", "ms-access", "vbscript"], "comments": [{"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1477465570, "post_id": 40254628, "comment_id": 67773063, "body": "Code from access DB will not work directly as vbs script file. You need to connect to Ms Access DB through a connection string and then write the logic to convert PlainText to RichText."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1477472366, "post_id": 40254628, "comment_id": 67777011, "body": "You have a few unnecessary lines. Try <code>Set db = accessApp.OpenCurrentDataBase &quot;D:\\test.mdb&quot;, true</code> and skip <code>Set accessApp.db =  CurrentDB</code>, you do not need it. db is not a property of Access Application. See <a href=\"https://msdn.microsoft.com/en-us/library/office/jj250267.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/jj250267.aspx</a>"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1477472601, "post_id": 40254628, "comment_id": 67777165, "body": "@MukulVarshney that is not quite true. You probably will not be able to change a field type with an ADODB connection, but you can with an Access Application Object."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1477473307, "post_id": 40254628, "comment_id": 67777642, "body": "@Fionnuala you are correct. What I meant is -- its not necessary that every statement in VBA Access will work as it is in VBScript (i.e. without changing). We may have to re-write those statements"}, {"owner": {"reputation": 1, "user_id": 6649608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a840e54178c88fcba5e4a3d0a29b25b2?s=128&d=identicon&r=PG&f=1", "display_name": "S.Imthorn", "link": "https://stackoverflow.com/users/6649608/s-imthorn"}, "edited": false, "score": 0, "creation_date": 1477478617, "post_id": 40254628, "comment_id": 67780944, "body": "@All thanks for the reactions. @ Mukul is this different than changing an field form Yes/No to Text? Because i have also an script to change the data type and that&#39;s working fine. @ Fionnuala I tried your solution but unfortunately it wont work, i get an error &quot;Expected end of statement&quot; line 11 char 40 so thats whe the path &quot;D:\\test.mdb&quot; begins"}], "answers": [{"tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": false, "score": 1, "last_activity_date": 1477662647, "creation_date": 1477662647, "answer_id": 40306538, "question_id": 40254628, "link": "https://stackoverflow.com/questions/40254628/access-change-memo-field-from-plain-text-to-rich-text-using-vbscript/40306538#40306538", "title": "Access change memo field from &quot;plain text&quot; to &quot;rich text&quot; using VBScript", "body": "<p>Try something like the code below. It will need tidying.</p>\n\n<pre><code>Option Explicit\n\nDim accessApp\nDim db\nDim dbname\nDim tdf\nDim fld1\nDim fld2\nDim acTextFormatPlain\nDim acTextFormatHTMLRichText\nDim dbInteger\n\n'acTextFormatPlain=0\n'acTextFormatHTMLRichText=1\ndbInteger=3\n\ndbname=\"D:\\Test.mdb\"\n\nSet accessApp = CreateObject(\"Access.Application\")\naccessApp.OpenCurrentDataBase(dbname)\n\nset db=accessapp.CurrentDb\n\nSet tdf = db.TableDefs(\"2emails\")\n\n'The property may not exist\nSetFieldProperty tdf.Fields(1), \"TextFormat\", dbInteger, 0\nWith tdf.Fields(1).Properties(\"TextFormat\")\n    If .Value = 0 Then\n        .Value = 1\n        msgbox \"TextFormat changed to: \" &amp; .Value\n    End If\nEnd With\n\nSub SetFieldProperty(ByVal fld , ByVal strPropertyName , ByVal iDataType , ByVal vValue )\n    Dim prp\n\n    Set prp = Nothing\n\n    On Error Resume Next\n    Set prp = fld.Properties(strPropertyName)\n    On Error GoTo 0\n\n    If prp Is Nothing Then\n        Set prp = fld.CreateProperty(strPropertyName, iDataType, vValue)\n        fld.Properties.Append prp \n    Else\n        prp.Value = vValue\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6649608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a840e54178c88fcba5e4a3d0a29b25b2?s=128&d=identicon&r=PG&f=1", "display_name": "S.Imthorn", "link": "https://stackoverflow.com/users/6649608/s-imthorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593957918, "creation_date": 1477460980, "last_edit_date": 1593957918, "question_id": 40254628, "link": "https://stackoverflow.com/questions/40254628/access-change-memo-field-from-plain-text-to-rich-text-using-vbscript", "title": "Access change memo field from &quot;plain text&quot; to &quot;rich text&quot; using VBScript", "body": "<p>i have a question about changing a memofield from \"plain text\" to \"rich text\" using VBScript, i found some solutions here and on the internet but all the solutions are for VBScript within access. I try to start an vbscript through Windows, but my script doesn't work. I'm kindly new to VBScripting so i hope you guys can help me. I used an example from the forum for my script:\n<a href=\"https://stackoverflow.com/questions/20828561/how-to-convert-a-text-field-in-an-access-table-to-a-rich-text-memo-using-vba\">How to convert a text field in an Access table to a rich text memo using VBA</a></p>\n\n<p>My Script:</p>\n\n<pre><code>Dim db\nDim tdf\nDim fld1\nDim fld2\nSet accessApp = GetObject(\"D:\\test.mdb\")\nSet accessApp = CreateObject(\"Access.Application\")\n    accessApp.OpenCurrentDataBase \"D:\\test.mdb\", true\n    accessApp.visible = false\n    accessApp.UserControl = true \n\nSet accessApp.db =  CurrentDB\nSet accessApp.tdf = db.TableDefs(\"Database\")\nSet accessApp.fld1 = tdf.Fields(\"Name_Memofield1\")\nSet accessApp.fld2 = tdf.Fields(\"Name_Memofield2\")\nDebug.Print \"acTextFormatPlain: \" &amp; acTextFormatPlain &amp; _\n    \"; acTextFormatHTMLRichText: \" &amp; acTextFormatHTMLRichText\nWith fld1.Properties(\"TextFormat\")\n    Debug.Print \"TextFormat: \" &amp; .Value\n    If .Value = acTextFormatPlain Then\n        .Value = acTextFormatHTMLRichText\n        Debug.Print \"TextFormat changed to: \" &amp; .Value\n    End If\nEnd With    \nWith fld2.Properties(\"TextFormat\")\n    Debug.Print \"TextFormat: \" &amp; .Value\n    If .Value = acTextFormatPlain Then\n        .Value = acTextFormatHTMLRichText\n        Debug.Print \"TextFormat changed to: \" &amp; .Value\n    End If\nEnd With\n</code></pre>\n\n<p>The error what occures tells me that the problem is in the \"Set accessApp.db =  CurrentDB\" the error which occured is: \"Object doesn't support this prperty or method accessApp.db\" If i change \"accessApp.db\" to \"db\" an other error occures: \"Object required: 'CurrentDB' \" </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477478835, "post_id": 40254071, "comment_id": 67781078, "body": "have you tested my answer below ?"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1477480180, "post_id": 40254336, "comment_id": 67781958, "body": "just like @user3598756 wrote, &quot;Would the brave downvoter kindly explain why&quot; ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": -1, "last_activity_date": 1477459898, "last_edit_date": 1477459898, "creation_date": 1477459571, "answer_id": 40254336, "question_id": 40254071, "link": "https://stackoverflow.com/questions/40254071/how-to-implement-formula-into-excel-cells-using-vba/40254336#40254336", "title": "How to Implement Formula into Excel cells using VBA", "body": "<p>When trying to convert long formulas to VBA try using a <code>String</code> variable to help you test it.</p>\n\n<pre><code> Dim FormulaStr              As String\n\n FormulaStr = \"=IF(OR(D\" &amp; 11 + i &amp; \"&gt;0,C\" &amp; 12 + i &amp; \"=\" &amp; Chr(34) &amp; Chr(34) &amp; \"),\" &amp; _\n      Chr(34) &amp; Chr(34) &amp; \",MAX(SUM($C$12:C\" &amp; 12 + i &amp; \")-$D$9,0))\"\n Debug.Print FormulaStr\n</code></pre>\n\n<p>Then, in the immediate window you will get:</p>\n\n<pre><code>=IF(OR(D12&gt;0,C13=\"\"),\"\",MAX(SUM($C$12:C13)-$D$9,0))\n</code></pre>\n\n<p>which is the formula you want to convert to VBA.</p>\n\n<p>Now all you need to do is to add the line below:</p>\n\n<pre><code> Sheet4.Cells(11 + i, 4).Formula = FormulaStr\n</code></pre>\n\n<p>If you want to skip the String variable, you can just replace your line of</p>\n\n<pre><code>Sheet4.Cells(11 + i, 4).Formula = \"=(if(or(D\" &amp; 11 + i &gt; 0 &amp; \",C\" &amp; 12 + i &amp; \"=\" &amp; Chr(34) &amp; Chr(34) &amp; \"),\" &amp; Chr(34) &amp; Chr(34) &amp; \",\" &amp; \"MAX(SUM($C$12:C\" &amp; 12 &amp; i &amp; \")-$D$9,0)\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Sheet4.Cells(11 + i, 4).Formula = \"=IF(OR(D\" &amp; 11 + i &amp; \"&gt;0,C\" &amp; 12 + i &amp; \"=\" &amp; Chr(34) &amp; Chr(34) &amp; \"),\" &amp; Chr(34) &amp; Chr(34) &amp; \",MAX(SUM($C$12:C\" &amp; 12 + i &amp; \")-$D$9,0))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 7036044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15dcc0bf9ccb1b923cf2130ce7d5737?s=128&d=identicon&r=PG&f=1", "display_name": "Sasi Kumar", "link": "https://stackoverflow.com/users/7036044/sasi-kumar"}, "edited": false, "score": 0, "creation_date": 1477468315, "post_id": 40254821, "comment_id": 67774601, "body": "Thank you verymuch , i am getting proper result now thanks once again"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 17, "user_id": 7036044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15dcc0bf9ccb1b923cf2130ce7d5737?s=128&d=identicon&r=PG&f=1", "display_name": "Sasi Kumar", "link": "https://stackoverflow.com/users/7036044/sasi-kumar"}, "edited": false, "score": 0, "creation_date": 1477468431, "post_id": 40254821, "comment_id": 67774671, "body": "you are welcome. Then please mark answer as accepted by clicking on the check mark beside the answer to toggle it from greyed out to filled in. thank you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 17, "user_id": 7036044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15dcc0bf9ccb1b923cf2130ce7d5737?s=128&d=identicon&r=PG&f=1", "display_name": "Sasi Kumar", "link": "https://stackoverflow.com/users/7036044/sasi-kumar"}, "edited": false, "score": 0, "creation_date": 1477468497, "post_id": 40254821, "comment_id": 67774713, "body": "Would the brave downvoter kindly explain why he didn&#39;t like this answer and give suggestions as how to improve it? Or remove the down vote if he was wrong. Thank him"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": -1, "last_activity_date": 1477461838, "creation_date": 1477461838, "answer_id": 40254821, "question_id": 40254071, "link": "https://stackoverflow.com/questions/40254071/how-to-implement-formula-into-excel-cells-using-vba/40254821#40254821", "title": "How to Implement Formula into Excel cells using VBA", "body": "<p>I'd go another way, with no loops and exploiting <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\"><code>SpecialCells()</code></a> method of <code>Range</code> object</p>\n\n<pre><code>Option Explicit\n\nSub adjustoldbills()\n\n    With Sheet4\n        .Range(\"D12\").FormulaR1C1 = \"=MAX(RC[-1]-R9C4,0)\" \n        With .Range(\"A13\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants)\n            With .Offset(, 2).SpecialCells(xlCellTypeConstants)\n                .Offset(, 1).FormulaR1C1 = \"=IF(R[-1]C&gt;0,\"\"\"\",MAX(SUM(R12C[-1]:RC[-1])-R9C4,0))\"\n                With .Areas(.Areas.Count)\n                    .Offset(, 1).Cells(.Rows.Count).Offset(1).FormulaR1C1 = \"=IF(R[-1]C&gt;0,\"\"\"\",MAX(SUM(R12C[-1]:RC[-1])-R9C4,0))\"\n                End With\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7036044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15dcc0bf9ccb1b923cf2130ce7d5737?s=128&d=identicon&r=PG&f=1", "display_name": "Sasi Kumar", "link": "https://stackoverflow.com/users/7036044/sasi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477466391, "creation_date": 1477458073, "last_edit_date": 1477466391, "question_id": 40254071, "link": "https://stackoverflow.com/questions/40254071/how-to-implement-formula-into-excel-cells-using-vba", "title": "How to Implement Formula into Excel cells using VBA", "body": "<p>I want to implement the following formula in to Excel cells</p>\n\n<pre><code>IF(OR(D12&gt;0,C13=\"\"),\"\",MAX(SUM($C$12:C13)-$D$9,0))\n</code></pre>\n\n<p>(once formula is applied I should get following result (formula implemented manually):</p>\n\n<p><a href=\"https://i.stack.imgur.com/u451r.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/u451r.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>so i wrote simple macro as below , but unable to implement formula , formula retuns value as \"true\"</p>\n\n<pre><code>Sub adjustoldbills()\n\nlastRow_sht4 = Sheet4.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheet4.Cells(12, 11) = \"\"\n\nFor i = 1 To lastRow_sht4 - 10\n    If Sheet4.Cells(11 + i, 1) &lt;&gt; \"\" Then\n        '=MAX(SUM($C$12:C15)-$D$9,0)\n        Sheet4.Cells(12, 4).Formula = \"=MAX(SUM($C$12:C\" &amp; 12 &amp; \")-$D$9,0)\"\n        Sheet4.Cells(11 + i, 4).Formula = \"=(if(or(D\" &amp; 11 + i &gt; 0 &amp; \",C\" &amp; 12 + i &amp; \"=\" &amp; Chr(34) &amp; Chr(34) &amp; \"),\" &amp; Chr(34) &amp; Chr(34) &amp; \",\" &amp; \"MAX(SUM($C$12:C\" &amp; 12 &amp; i &amp; \")-$D$9,0)\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>i am getting wrong result after implemented formula via vba macro as in this image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Ol5a.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/9Ol5a.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>how to implement formula and get value as expected.</p>\n"}, {"tags": ["vba", "reporting-services", "sql-server-2012", "formatting"], "answers": [{"tags": [], "owner": {"reputation": 8131, "user_id": 4459617, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9cebe9a45f0438824814ce252c6b0a74?s=128&d=identicon&r=PG&f=1", "display_name": "Hannover Fist", "link": "https://stackoverflow.com/users/4459617/hannover-fist"}, "is_accepted": false, "score": 1, "last_activity_date": 1477504491, "creation_date": 1477504491, "answer_id": 40269056, "question_id": 40253564, "link": "https://stackoverflow.com/questions/40253564/ssrs-2012-chart-label-partial-formatting-possible/40269056#40269056", "title": "SSRS 2012 - chart label partial formatting: possible?", "body": "<p>Unfortunately, there's <strong>not</strong> a way to use <strong>HTML</strong> in a chart.</p>\n\n<p>When you say <strong>Label</strong>, are you referring to the <strong>Chart Title</strong>? Your formula doesn't look like an <strong>Axis label</strong> and seems a bit wordy for a <strong>Tool Tip</strong>. </p>\n\n<p>I usually do not use the Title and use a text box above the chart instead that <strong>can</strong> be formatted.</p>\n"}], "owner": {"reputation": 125, "user_id": 2731068, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d93f06e68df9df5057152ed27731dcb6?s=128&d=identicon&r=PG&f=1", "display_name": "Mchief", "link": "https://stackoverflow.com/users/2731068/mchief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477504491, "creation_date": 1477454776, "question_id": 40253564, "link": "https://stackoverflow.com/questions/40253564/ssrs-2012-chart-label-partial-formatting-possible", "title": "SSRS 2012 - chart label partial formatting: possible?", "body": "<p>I want to format a part of SSRS chat label.\nHere is the code: </p>\n\n<pre><code>=\"Active: \" &amp; Format(Fields!ActiveMembers.Value, \"###,###,###\") &amp; Environment.NewLine() &amp; \"Preserved: \" &amp; Format(Fields!PreservedMembers.Value, \"###,###,###\") &amp; Environment.NewLine() &amp; \"Total: \" &amp; Format(Fields!TotalMembers.Value, \"###,###,###\")\n</code></pre>\n\n<p>Is it possible to make only last line appear in bold?\nDifferent internet sources advise to change markup type to HTML, but that is only suitable for placeholders, could not find markup settings or any solution for chart labels.</p>\n\n<p>Thanks a bunch!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1477453501, "post_id": 40253259, "comment_id": 67768777, "body": "Not sure how the rest of your is code working but maybe try <code>Kill</code> to stop all instances of Excel and reopen the instances you need."}], "answers": [{"comments": [{"owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477455660, "post_id": 40253506, "comment_id": 67769354, "body": "Thanks. Switching schedule to false stops the application. Does breaking the code do the same thing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477456022, "post_id": 40253506, "comment_id": 67769433, "body": "No. <code>Application.OnTime</code> fires even if you initial code falls out of scope."}, {"owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477456981, "post_id": 40253506, "comment_id": 67769652, "body": "Can you explain what on error goto0 and on error resume next do in the code?"}, {"owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477457165, "post_id": 40253506, "comment_id": 67769694, "body": "I get an error when I try to run the code: Method &#39;range&#39; of object &#39;_global&#39; failed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477457245, "post_id": 40253506, "comment_id": 67769712, "body": "If there was no event scheduled then trying to cancel an event will throw an error. On Error Resume Next allows the code to continue executing.  On Error Goto 0 resets the error handling so that any errors after that point will break the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477457503, "post_id": 40253506, "comment_id": 67769778, "body": "You need to name a range <code>NextSchedule</code> or change <code>Range(&quot;NextSchedule&quot;)</code>  to point to a valid range (e.g. Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;))."}, {"owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "edited": false, "score": 0, "creation_date": 1477461187, "post_id": 40253506, "comment_id": 67771010, "body": "Thanks Thomas. I have posted another question if you have time to take a look..: <a href=\"http://stackoverflow.com/questions/40254668/how-to-automatically-accept-excel-prompt-using-vba\" title=\"how to automatically accept excel prompt using vba\">stackoverflow.com/questions/40254668/&hellip;</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1477454310, "creation_date": 1477454310, "answer_id": 40253506, "question_id": 40253259, "link": "https://stackoverflow.com/questions/40253259/how-to-control-vba-to-only-allow-1-instance-of-application-ontime-to-run/40253506#40253506", "title": "How to control VBA to only allow 1 instance of application.ontime to run", "body": "<p>You could store the scheduled time and cancel the previous schedule before creating the next schedule task. </p>\n\n<pre><code>On Error Resume Next\nApplication.OnTime EarliestTime:=Range(\"NextSchedule\"), Procedure:=\"dataextract\", Schedule:=False\nOn Error GoTo 0\n\nRange(\"NextSchedule\") = TimeSerial(Hour(Now), Application.WorksheetFunction.Floor(Minute(Time), 5) + 5, 0)\n\nApplication.OnTime EarliestTime:=Range(\"NextSchedule\"), Procedure:=\"dataextract\", Schedule:=True\n</code></pre>\n"}], "owner": {"reputation": 946, "user_id": 4115378, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a3c0ad731b0764a1037b67c3ca5b22a6?s=128&d=identicon&r=PG&f=1", "display_name": "A1122", "link": "https://stackoverflow.com/users/4115378/a1122"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 40253506, "answer_count": 1, "score": 0, "last_activity_date": 1477455106, "creation_date": 1477452808, "last_edit_date": 1477455106, "question_id": 40253259, "link": "https://stackoverflow.com/questions/40253259/how-to-control-vba-to-only-allow-1-instance-of-application-ontime-to-run", "title": "How to control VBA to only allow 1 instance of application.ontime to run", "body": "<p>I have a time loop using <code>application.ontime</code> which copy and paste blocks of cells from one workbook to another workbook every 5 minutes. From time to time it will copy and paste duplicates, making me suspect that there are multiple instances of it running. Is there a way to prevent multiple version of it running at once? Or is there a way to check how many instances of it is running (pending) at a particular time? </p>\n\n<p>What I have so far in my <code>application.ontime</code> is the following:</p>\n\n<pre><code>Sub timer()\n\n    If Hour(Time) &lt;= 16 Or Hour(Time) &gt;= 18 Then\n\n        Application.OnTime TimeSerial(Hour(Time), Application.WorksheetFunction.Floor(Minute(Time), 5), 0) + TimeValue(\"00:05:00\"), \"dataextract\", , True\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>Secondary question: I don't particularly understand how it works in rich detail. Say I start an instance at 6:30pm... it works fine until 9pm and then I start getting duplicates. When I break the VBA, I get three pop up errors instead of one, confirming that there are multiple instances of it running. However I don't understand what could have caused it to duplicate? Could it be that I initiated application.ontime yesterday at 9pm and it restarted itself? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1477451739, "post_id": 40252948, "comment_id": 67768337, "body": "Did you try turning <code>Application.EnableEvents</code> off inside the <code>WorksheetChange</code> event? I can&#39;t tell from your description."}, {"owner": {"reputation": 1, "user_id": 6927289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lj8UH.jpg?s=128&g=1", "display_name": "DeniseM", "link": "https://stackoverflow.com/users/6927289/denisem"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1477492924, "post_id": 40252948, "comment_id": 67790908, "body": "Yes, I did try turning off Application.EnableEvents - it stopped the crashing behaviour, but also stopped the code from updating column G appropriately."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1477459030, "creation_date": 1477459030, "answer_id": 40254240, "question_id": 40252948, "link": "https://stackoverflow.com/questions/40252948/excel-crashing-on-worksheet-change-but-not-on-worksheet-selectionchange/40254240#40254240", "title": "Excel crashing on Worksheet_Change, but NOT on Worksheet_SelectionChange", "body": "<p>Something like this should work:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rw As Range, r As Range, dataRange As Range\n    Dim rngSingleTag As Range\n    Dim rng3SegmentTag As Range\n    Dim rng5SegmentTag As Range\n    Dim rngTagEntry As Range\n    Dim rngConcatTag As Range\n\n\n    'data entry area only (adjust to suit)...\n    Set dataRange = Application.Intersect(Target, Me.Range(\"A2:F10000\"))\n\n    If dataRange Is Nothing Then Exit Sub 'nothing to do...\n\n    'process each changed row\n    For Each r In dataRange.Rows\n\n        Set rw = r.EntireRow\n\n        Set rngSingleTag = rw.Cells(6)\n        Set rng3SegmentTag = rw.Cells(1).Resize(1, 3)\n        Set rng5SegmentTag = rw.Cells(1).Resize(1, 5)\n        Set rngTagEntry = rw.Cells(1).Resize(1, 6)\n        Set rngConcatTag = rw.Cells(7)\n\n        Select Case True\n            Case filled(rngTagEntry) = 0\n                    rngConcatTag = \"\"\n            Case filled(rng5SegmentTag) &gt; 0 And filled(rngSingleTag) = 1\n                    rngConcatTag = \"Enter either a complete tag or the individual sections, not both\"\n            Case filled(rng5SegmentTag) = 0 And filled(rngSingleTag) = 1\n                    rngConcatTag = UCase(Trim(rngSingleTag))\n            Case filled(rng3SegmentTag) = 3 And filled(rng5SegmentTag) = 3\n                    rngConcatTag = Tag(rng3SegmentTag)\n            Case filled(rng5SegmentTag) = 5\n                    rngConcatTag = Tag(rng5SegmentTag)\n            Case Else\n                rngConcatTag = \"Incomplete Tag\"\n        End Select\n\n    Next r\n\nEnd Sub\n\nFunction filled(rng)\n    filled = Application.CountA(rng)\nEnd Function\n\nFunction Tag(rng) As String\n    Const DELIM As String = \"-\"\n    Dim c As Range, rv As String\n    For Each c In rng.Cells\n        rv = rv &amp; IIf(Len(rv) &gt; 0, DELIM, \"\") &amp; Trim(c.Text)\n    Next c\n    Tag = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6927289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lj8UH.jpg?s=128&g=1", "display_name": "DeniseM", "link": "https://stackoverflow.com/users/6927289/denisem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477459030, "creation_date": 1477450596, "question_id": 40252948, "link": "https://stackoverflow.com/questions/40252948/excel-crashing-on-worksheet-change-but-not-on-worksheet-selectionchange", "title": "Excel crashing on Worksheet_Change, but NOT on Worksheet_SelectionChange", "body": "<p>I have a spreadsheet that is a data-entry tool for pulling equipment tags and line numbers from engineering drawings \u2013 it\u2019s set up with a table that takes either 3-segment tags (columns A-C), 5 segment line numbers (columns A-E), or a list of complete tags (column F), with column G either concatenating the tag segments or pulling across the complete tag. I had this set up using a formula, but I\u2019d rather avoid using complicated formulas in anything that anyone else is going to use and so I took a stab at converting the formula to VBA and putting in a <em>Worksheet_Change</em> procedure.</p>\n\n<p>The code works fine... until you make a change to a cell on the last row of the table and then hit enter or use the down arrow key, at which point Excel crashes. Moving sideways or upwards is fine, and so is moving sideways off the changed cell before hitting enter. I tried converting the table to a regular range, and it still crashes at the last row of the data. I tried turning <em>Application.EnableEvents</em> to False, and that stops the crashing, but then the updating no longer triggers properly.</p>\n\n<p>If the procedure is changed to <em>Worksheet_SelectionChange</em>, it doesn\u2019t crash.</p>\n\n<p>Just to make it more interesting, in both the <em>Worksheet_Change</em> and <em>Worksheet_SelectionChange</em> procedures, using the up/down arrow keys or the enter key fails to trigger a change, but in the <em>Worksheet_SelectionChange</em> procedure arrowing back down/up to the row off which I just moved triggers the update. </p>\n\n<p>I\u2019m sure there are a million ways to fix this, but I have no idea how to do it, and I haven\u2019t had any luck finding an answer.</p>\n\n<p>What I <em>want</em> is for the code to update column G whenever the active cell changes \u2013 regardless of whether I use the enter key, tab key, arrow keys, or the $!#@ mouse to change my cell selection.</p>\n\n<p>I'm working on a Windows 10 machine, using Excel 2016. When I get to work tomorrow I'll see how it goes on Excel 2013.</p>\n\n<p>Spreadsheet screencap, for reference: <a href=\"https://drive.google.com/file/d/0B_wa8YmM1J2ddjlkOWxERE5TM1k/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B_wa8YmM1J2ddjlkOWxERE5TM1k/view?usp=sharing</a></p>\n\n<p>Any assistance would be hugely appreciated - especially if it comes with a thorough explanation about what is going on here. </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim strDelim As String\n    Dim strConcatTag As String\n    Dim intActiveRow As Integer\n\n    Dim rngTagSegment As Range\n    Dim rngSingleTag As Range\n    Dim rng3SegmentTag As Range\n    Dim rng5SegmentTag As Range\n    Dim rngTagEntry As Range\n    Dim rngConcatTag As Range\n    Dim rngCheck As Range\n\n    strDelim = \"-\"\n    intActiveRow = ActiveCell.Row\n\n    Set rngSingleTag = Cells(intActiveRow, 6)\n    Set rng3SegmentTag = Range(Cells(intActiveRow, 1), Cells(intActiveRow, 3))\n    Set rng5SegmentTag = Range(Cells(intActiveRow, 1), Cells(intActiveRow, 5))\n    Set rngTagEntry = Range(Cells(intActiveRow, 1), Cells(intActiveRow, 6))\n    Set rngConcatTag = Cells(intActiveRow, 7)\n\n    If intActiveRow = 1 Then\n        Exit Sub\n        Else\n            Select Case True\n                Case WorksheetFunction.CountA(rngTagEntry) = 0\n                        rngConcatTag = \"\"\n                Case WorksheetFunction.CountA(rng5SegmentTag) &gt; 0 And WorksheetFunction.CountA(rngSingleTag) &gt; 0\n                        rngConcatTag = \"Enter either a complete tag or the individual sections, not both\"\n                Case WorksheetFunction.CountA(rng5SegmentTag) = 0 And WorksheetFunction.CountA(rngSingleTag) &lt;&gt; 0\n                        rngConcatTag = UCase(Trim(rngSingleTag))\n                Case WorksheetFunction.CountA(rng3SegmentTag) = 3 And WorksheetFunction.CountA(rng5SegmentTag) = 3\n                        For Each rngTagSegment In rng5SegmentTag\n                            strConcatTag = IIf(rngTagSegment = \"\", Trim(strConcatTag) &amp; \"\", IIf(strConcatTag = \"\", _\n                            Trim(rngTagSegment.Text), Trim(strConcatTag) &amp; strDelim &amp; Trim(rngTagSegment.Text)))\n                        Next\n                        rngConcatTag = UCase(Trim(strConcatTag))\n                Case WorksheetFunction.CountA(rng3SegmentTag) = 3 And WorksheetFunction.CountA(rng5SegmentTag) = 5\n                        For Each rngTagSegment In rng5SegmentTag\n                            strConcatTag = IIf(rngTagSegment = \"\", Trim(strConcatTag) &amp; \"\", IIf(strConcatTag = \"\", _\n                            Trim(rngTagSegment.Text), Trim(strConcatTag) &amp; strDelim &amp; Trim(rngTagSegment.Text)))\n                        Next\n                        rngConcatTag = UCase(strConcatTag)\n                Case Else\n                    rngConcatTag = \"Incomplete Tag\"\n            End Select\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "edited": false, "score": 0, "creation_date": 1477447626, "post_id": 40252488, "comment_id": 67767365, "body": "Thanks for the response - changed it to that and it still doesn&#39;t work. Also tried outerHTML and innerHTML to see if it did anything but it&#39;s not. Is there some other way you would be inclined to use to extract a string like that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "edited": false, "score": 0, "creation_date": 1477447813, "post_id": 40252488, "comment_id": 67767405, "body": "Is it throwing an error?  If so, what error?  Or is it returning the wrong value."}, {"owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "edited": false, "score": 0, "creation_date": 1477448341, "post_id": 40252488, "comment_id": 67767515, "body": "It doesn&#39;t do anything - doesn&#39;t throw an error and the cell is just blank"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "edited": false, "score": 0, "creation_date": 1477448493, "post_id": 40252488, "comment_id": 67767543, "body": "Can you post your code?  What you should do is set a variable to the element and add a watch to the variable or check the variable in the Locals Window."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477448555, "post_id": 40252488, "comment_id": 67767553, "body": "Could be the page hasn&#39;t finished loading ... might need a <code>IE.ReadyState</code>  I forget the rest before Cells(1, 1)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477448678, "post_id": 40252488, "comment_id": 67767586, "body": "@JReid If the page didn&#39;t finish loading; it would throw an <code>Object variable or With block variable not set </code> error."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477448901, "post_id": 40252488, "comment_id": 67767623, "body": "@ThomasInzina you are more than likely correct! All I know is the code you posted works for me too"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477453283, "post_id": 40252488, "comment_id": 67768722, "body": "@JReid  You were right.  <code>On Error Resume Next</code> strikes again!"}, {"owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "edited": false, "score": 0, "creation_date": 1477454713, "post_id": 40252488, "comment_id": 67769088, "body": "Thanks for the solution - may I ask what the code that you&#39;ve put at the top of the module is for? I also ask because I managed to send the value I need to send, without actually using that code"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1477455299, "post_id": 40252488, "comment_id": 67769250, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686298(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Sleep</a> is an API call to a function inside a DLL file.  It allows you to suspend the execution of a thread for a period of time.  It is more efficient that <code>DoEvents</code>.  The hash marks <code>#</code> indicate compiler directives.  It tells the compiler which version of the function to use base on VBA&#39;s version being 32bit or 64bit."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1477453202, "last_edit_date": 1477453202, "creation_date": 1477446943, "answer_id": 40252488, "question_id": 40252415, "link": "https://stackoverflow.com/questions/40252415/vba-to-extract-source-code-text/40252488#40252488", "title": "VBA to extract Source Code text", "body": "<p>There isn&#39;t an <code>outerText</code> property.  There is an <code>innerHTML</code> and an <code>outerHTML</code> but I think that you are looking for the <code>innerText</code> property.</p>\n\n<pre><code>Cells(1, 1) = IE.Document.getElementByID(&amp;quot;MainPlaceHolder_lblAAMIFull&amp;quot;).innerText\n</code></pre>\n\n<p><strong>Update:</strong>  J Ried was right about the page not loading.  The <code>On Error Resume Next</code> was preventing you from catching the error.  The problem was that after click the submit button it takes time for the page to update.  You were trying to find an element that wasn't loaded yet.  I added a 4 second delay and the code executed properly.</p>\n\n<p>At the top of the module:</p>\n\n<hr>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems\n#End If\n</code></pre>\n\n<h2>Add a 4 second delay after you click the submit button.</h2>\n\n<pre><code>'STEP 5\n\nIE.document.getElementById(\"btnSubmit\").Click\n\nSleep 4000\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 40252488, "answer_count": 1, "score": 1, "last_activity_date": 1509019903, "creation_date": 1477446389, "last_edit_date": 1531164843, "question_id": 40252415, "link": "https://stackoverflow.com/questions/40252415/vba-to-extract-source-code-text", "title": "VBA to extract Source Code text", "body": "<p>I would like to send the value <strong>$871.63</strong> to my spreadsheet, from the following HTML extract:</p>\n\n<pre><code>&lt;tr&gt;\n   &lt;th&gt;Insurer&lt;/th&gt;\n   &lt;th&gt;12-month Price&lt;/th&gt;\n   &lt;th&gt;6-month Price&lt;/th&gt;\n   &lt;th class=\"print-hide-th\"&gt;Price Breakdown&lt;/th&gt;\n   &lt;th&gt;Phone&lt;/th&gt;\n   &lt;th&gt;Web Site&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n   &lt;tr&gt;\n      &lt;td&gt;AAMI&lt;/td&gt;\n      &lt;td&gt;&lt;span id=\"MainPlaceHolder_lblAAMIFull\"&gt;$871.63&lt;/span&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;span id=\"MainPlaceHolder_lblAAMIHalf\"&gt;$447.12&lt;/span&gt;&lt;/td&gt;\n      &lt;td class=\"print-hide-td\"&gt;&lt;a href=\"PriceBreakDown.aspx?companyName=AAMI&amp;policyCost=$871.63&amp;region=Metro&amp;class=1&amp;startDate=2/01/2016\" class=\"info\"&gt;more information&lt;/a&gt;&lt;/td&gt;\n      &lt;td class=\"no-wrap\"&gt;132 244&lt;/td&gt;\n</code></pre>\n\n<p>I've tried</p>\n\n<pre><code>Cells(1, 1) = IE.Document.getElementByID(\"MainPlaceHolder_lblAAMIFull\").outerText\n</code></pre>\n\n<p>But that doesn't work - can you suggest a solution?</p>\n\n<p>Here is the entire code that I've trying and which works until that last line:</p>\n\n<pre><code>Sub GetQuotes()\n\nOn Error Resume Next\n\nDim IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.navigate (\"http://prices.maa.nsw.gov.au/\")\n\nIE.Visible = True\n\nDo\nDoEvents\nLoop Until IE.readystate = 4\n\n'STEP 1\n\nIE.Document.getElementByID(\"Q1a_Day\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q1b_Month\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q1c_Year\").SelectedIndex = 1\n\nIE.Document.getElementByID(\"btnNext\").Click\n\n\n'STEP 2\n\nIE.Document.getElementByID(\"Q2a_VehicleClass\").SelectedIndex = 1\n\n'YOU OFTEN NEED THE WEBPAGE TO UPDATE BEFORE YOU CAN MANIPULATE OTHER FIELDS - SEE dispatchEvent lines\n\nSet evt = IE.Document.createEvent(\"HTMLEvents\")\nevt.initEvent \"change\", True, False\nSet lst = IE.Document.getElementByID(\"Q3_VehicleYear\")\nlst.Value = 2015\nlst.dispatchEvent evt\n\n\nIE.Document.getElementByID(\"Q3b_VehicleMake\").SelectedIndex = 2\nIE.Document.getElementByID(\"Q3b_VehicleMake\").dispatchEvent evt\n\n\nIE.Document.getElementByID(\"Q3c_VehicleModel\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q3c_VehicleModel\").dispatchEvent evt\n\n\nIE.Document.getElementByID(\"Q4_Postcode\").Value = 2000\nIE.Document.getElementByID(\"Q4_Postcode\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q5_CompanyOwned\").SelectedIndex = 2\n\nIE.Document.getElementByID(\"Q6_Usage\").SelectedIndex = 2\n\nIE.Document.getElementByID(\"Q7_CurrentCTP\").Value = \"N\"\n\nIE.Document.getElementByID(\"btnNext\").Click\n\n\n'STEP 3\n\nIE.Document.getElementByID(\"Q7_CurrentCTP\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q7_CurrentCTP\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q8_CurrentCTPCompany\").SelectedIndex = 1\n\nIE.Document.getElementByID(\"Q10_OtherInsurance\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q10_OtherInsurance\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q11_OtherInsuranceCompany\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q11_OtherInsuranceCompany\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q12_OtherInsuranceYears\").SelectedIndex = 1\n\nIE.Document.getElementByID(\"Q13a_NoClaimDiscount\").SelectedIndex = 1\n\nIE.Document.getElementByID(\"btnNext\").Click\n\n\n'STEP 4\n\nIE.Document.getElementByID(\"Q14_OwnerAge\").Value = 25\nIE.Document.getElementByID(\"Q14_OwnerAge\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q15_Demerits\").SelectedIndex = 1\n\nIE.Document.getElementByID(\"Q16_DriverAge\").Value = 23\nIE.Document.getElementByID(\"Q16_DriverAge\").dispatchEvent evt\n\n\nIE.Document.getElementByID(\"Q17_Accidents2yr\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q17_Accidents2yr\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q19_Convictions\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q19_Convictions\").dispatchEvent evt\n\nIE.Document.getElementByID(\"Q17b_YearsDriverWLic\").SelectedIndex = 1\nIE.Document.getElementByID(\"Q17b_YearsDriverWLic\").dispatchEvent evt\n\nIE.Document.getElementByID(\"NRMARadioYes\").Click\n\nIE.Document.getElementByID(\"Q18_Roadside\").SelectedIndex = 3\nIE.Document.getElementByID(\"Q18_Roadside\").dispatchEvent evt\n\nIE.Document.getElementByID(\"btnNext\").Click\n\n\n'STEP 5\n\nIE.Document.getElementByID(\"btnSubmit\").Click\n\n'GET PRICES\n\nCells(1, 1) = IE.Document.getElementByID(\"MainPlaceHolder_lblAAMIFull\").innerText \n\n\n\nEnd Sub\n</code></pre>\n\n<p>I'd be really grateful for a solution!</p>\n"}, {"tags": ["vb.net", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1477446020, "post_id": 40252368, "comment_id": 67766993, "body": "Also note the line continuation &#39;_&#39; character"}, {"owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477446247, "post_id": 40252368, "comment_id": 67767051, "body": "It&#39;s still calling the information in the row hidden by autofilter. I need a way to ignore hidden rows not columns."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477446658, "post_id": 40252368, "comment_id": 67767151, "body": "Unfortunately we are kind of slow because we look at each Cell 1 by 1, we can increase speed by reading all data into a variant array"}, {"owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477446810, "post_id": 40252368, "comment_id": 67767189, "body": "If you can code this, please do. I&#39;m just working as I go and a lot of it could be more efficient. I&#39;d be grateful!"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477447147, "post_id": 40252368, "comment_id": 67767258, "body": "Are you experiencing poor performance with what we have here?"}, {"owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477447217, "post_id": 40252368, "comment_id": 67767269, "body": "It&#39;s not great but it&#39;s manageable. My concern is those in the business who may use this with older computers."}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "reply_to_user": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "edited": false, "score": 0, "creation_date": 1477447658, "post_id": 40252368, "comment_id": 67767370, "body": "Edit Saved. I think you should add <code>Application.ScreenUpdating = False</code> If you data starts at Row 3 then inside the loop every where there is <code>k</code> it should be <code>k-2</code> and the data range should be <code>Range( Cells(3, 1), Cells(LR, LC) )</code>. If all Rows contain the same number of columns you can put both <code>LR = ...</code> and <code>Data = ...</code> outside of your <code>For j</code> loop"}], "tags": [], "owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "is_accepted": false, "score": 0, "last_activity_date": 1477447462, "last_edit_date": 1477447462, "creation_date": 1477445969, "answer_id": 40252368, "question_id": 40252303, "link": "https://stackoverflow.com/questions/40252303/excel-vba-code-to-ignore-filtered-out-hidden-rows/40252368#40252368", "title": "Excel VBA Code to ignore filtered-out (hidden) rows", "body": "<p>Check if it's hidden first  </p>\n\n<pre><code>Sub HideCols()\nDim LC As Integer, j As Integer\nDim LR As Integer, curCnt as Integer\nDim cl As Range, rng As Range\nDim Data As Variant\n\nSet rng = Range(\"Table1\").SpecialCells(xlCellTypeVisible)\n\nLC = Cells(3, Columns.Count).End(xlToLeft).Column\n\n    For j = 3 To LC\n        LR = Cells(Rows.Count, j).End(xlUp).Row\n        curCnt = 0\n        ' its faster to iterate a variant array than it is Cells\n        Data = Range( Cells(1, 1), Cells(LR, LC) )\n        for k = 1 to LR\n           if Rows(k).Hidden = False and Data(k, j) &lt;&gt; \"\" Then _\n           curCnt = curCnt + 1\n        next k\n        Columns(j).Hidden = curCnt &lt; 2\n    Next j\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1477466625, "last_edit_date": 1477466625, "creation_date": 1477463793, "answer_id": 40255301, "question_id": 40252303, "link": "https://stackoverflow.com/questions/40252303/excel-vba-code-to-ignore-filtered-out-hidden-rows/40255301#40255301", "title": "Excel VBA Code to ignore filtered-out (hidden) rows", "body": "<p>I'd go like follows</p>\n\n<pre><code>Option Explicit\n\nSub HideCols()\n    Dim cols As Range\n    Dim iCol As Long\n\n    With Range(\"Table1\")\n        Set cols = .Resize(1, 1).Offset(, .Columns.Count + 1)\n        For iCol = 1 To .Columns.Count\n             If Application.WorksheetFunction.Subtotal(103, .Columns(iCol).SpecialCells(xlCellTypeVisible)) &lt; 2 Then Set cols = Union(cols, .Cells(1, iCol))\n        Next iCol\n        Set cols = Intersect(.Columns, cols)\n        If Not cols Is Nothing Then cols.EntireColumn.Hidden = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>as a side note, if filtering is done out of <code>Autofilter()</code> method then also header rows are not filtered out. in this case you may want to change the right term of If check to <code>&lt; 3</code> </p>\n"}], "owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1651, "favorite_count": 0, "accepted_answer_id": 40255301, "answer_count": 2, "score": 0, "last_activity_date": 1477466625, "creation_date": 1477445412, "question_id": 40252303, "link": "https://stackoverflow.com/questions/40252303/excel-vba-code-to-ignore-filtered-out-hidden-rows", "title": "Excel VBA Code to ignore filtered-out (hidden) rows", "body": "<p>I have a piece of VB code in excel to hide columns with less than 2 data entries (header as a minimum) and I need to know how to use this to hide columns whilst ignoring information in filtered out rows:</p>\n\n<pre><code>Sub HideCols()\nDim LC As Integer, j As Integer\nDim cl As Range, rng As Range\n\nSet rng = Range(\"Table1\").SpecialCells(xlCellTypeVisible)\n\nLC = Cells(3, Columns.Count).End(xlToLeft).Column\n\n    For j = 3 To LC\n        Columns(j).Hidden = WorksheetFunction.CountA(Columns(j)) &lt; 2\n    Next j\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This is what I have, a lot of it makes no sense and needs tidying up but that's only as I've been trying to find my own way to no avail.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["xml", "vba", "excel", "xml-parsing", "geocoding"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1477442590, "post_id": 40251618, "comment_id": 67766119, "body": "<code>type</code> is not a child of <code>long_name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6311811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f63ee3785dd7ef82e995ee37869e09c?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/6311811/maurice"}, "edited": false, "score": 0, "creation_date": 1477493847, "post_id": 40252048, "comment_id": 67791655, "body": "Thanks a whole lot! Managed to get the macro the work. I however still got a secondary question.  With the third and fourth address_component there are 2 types, namely locality and political. Do you by any chance know how I could interpreted these &#39;types&#39;?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 6311811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f63ee3785dd7ef82e995ee37869e09c?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/6311811/maurice"}, "edited": false, "score": 0, "creation_date": 1477500709, "post_id": 40252048, "comment_id": 67796132, "body": "Sorry I&#39;m not a big XPath user, so that next step isn&#39;t something I know..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1477449088, "last_edit_date": 1477449088, "creation_date": 1477443466, "answer_id": 40252048, "question_id": 40251618, "link": "https://stackoverflow.com/questions/40251618/vba-retrieving-google-geocoding-xml-childnodes/40252048#40252048", "title": "VBA retrieving Google Geocoding XML ChildNodes", "body": "<p>You need to select the <code>long_name</code> based off the value of its sibling <code>type</code> element</p>\n\n<p>Eg:</p>\n\n<pre><code>Cells(GeoCount, 4) = Results.SelectSingleNode( _\n     \"//result/address_component[type='street_number']/long_name\").Text\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6311811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f63ee3785dd7ef82e995ee37869e09c?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/6311811/maurice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 40252048, "answer_count": 1, "score": 0, "last_activity_date": 1482771837, "creation_date": 1477439985, "last_edit_date": 1482771837, "question_id": 40251618, "link": "https://stackoverflow.com/questions/40251618/vba-retrieving-google-geocoding-xml-childnodes", "title": "VBA retrieving Google Geocoding XML ChildNodes", "body": "<p>I currently got some address data records some are from the Netherlands which are correctly registered and and some are foreign which are not registered correctly.</p>\n\n<p>So in order to get these addresses registered correctly I am trying to make a macro that adds the missing records to the data records by using the Google Geocoding API.</p>\n\n<p>While trying to retrieve the results from the XML record I get a run-time error. \nThe error is: Run-time error '-2147467259 (80004005)':\nexpected token 'eof' found '='.</p>\n\n<p>//result/address_component/long_name/type-->=&lt;--street_name</p>\n\n<p>As you can see I am having difficulties with retreiving the differnt childNodes I need.</p>\n\n<p>A link to the workbook with the working code, you can find the cod in the second module. (<a href=\"https://drive.google.com/open?id=0B1TucCM4DOwydnp5RDg0elJwRDQ\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=0B1TucCM4DOwydnp5RDg0elJwRDQ</a>)</p>\n\n<p>An example of the xml output from the google API or see below: </p>\n\n<p><a href=\"https://developers.google.com/maps/documentation/geocoding/intro\" rel=\"nofollow noreferrer\">https://developers.google.com/maps/documentation/geocoding/intro</a></p>\n\n<p>As of now I got the following code: </p>\n\n<pre><code>Option Explicit\n\nSub geocode()\n\n    Dim Request         As New XMLHTTP30\n    Dim Results         As New DOMDocument30\n    Dim StatusNode      As IXMLDOMNode\n    Dim GeoCount        As Integer\n    Dim AutoResult      As Integer\n\n    For GeoCount = 2 To 10\n\n        On Error GoTo errorhandler\n\n        Request.Open \"GET\", \"http://maps.googleapis.com/maps/api/geocode/xml?\" _\n        &amp; \"&amp;address=\" &amp; Cells(GeoCount, 1) &amp; \" \" &amp; Cells(GeoCount, 2) &amp; \" \" &amp; Cells(GeoCount, 3) &amp; \"&amp;sensor=false\", False\n\n        Request.send\n\n        Results.LoadXML Request.responseText\n\n        Set StatusNode = Results.SelectSingleNode(\"//status\")\n\n\n            If UCase(StatusNode.Text) = \"OK\" Then\n                Cells(GeoCount, 4) = Results.SelectSingleNode(\"//result/address_component/long_name/type=street_number\").Text\n                Cells(GeoCount, 5) = Results.SelectSingleNode(\"//result/address_component/long_name/type=route\").Text\n                Cells(GeoCount, 6) = Results.SelectSingleNode(\"//result/address_component/long_name/type=postal_code\").Text\n                Cells(GeoCount, 7) = Results.SelectSingleNode(\"//result/address_component/long_name/type=locality\").Text\n                Cells(GeoCount, 8) = Results.SelectSingleNode(\"//result/address_component/long_name/type=country\").Text\n                Cells(GeoCount, 9) = Results.SelectSingleNode(\"//result/geometry/location/lat\").Text\n                Cells(GeoCount, 10) = Results.SelectSingleNode(\"//result/geometry/location/lng\").Text\n            Else\n\n                For AutoResult = 4 To 10\n                    Cells(GeoCount, AutoResult) = UCase(StatusNode.Text)\n                Next AutoResult\n            End If\n\n\n    Set StatusNode = Nothing\n    Set Results = Nothing\n    Set Request = Nothing\nerrorhandler:\n    Set StatusNode = Nothing\n    Set Results = Nothing\n    Set Request = Nothing\n    Next GeoCount\n\n\nEnd Sub\n</code></pre>\n\n<p>example off the XML return: </p>\n\n<pre><code>&lt;GeocodeResponse&gt;\n &lt;status&gt;OK&lt;/status&gt;\n &lt;result&gt;\n  &lt;type&gt;street_address&lt;/type&gt;\n  &lt;formatted_address&gt;1600 Amphitheatre Pkwy, Mountain View, CA 94043, USA&lt;/formatted_address&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;1600&lt;/long_name&gt;\n   &lt;short_name&gt;1600&lt;/short_name&gt;\n   &lt;type&gt;street_number&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;Amphitheatre Pkwy&lt;/long_name&gt;\n   &lt;short_name&gt;Amphitheatre Pkwy&lt;/short_name&gt;\n   &lt;type&gt;route&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;Mountain View&lt;/long_name&gt;\n   &lt;short_name&gt;Mountain View&lt;/short_name&gt;\n   &lt;type&gt;locality&lt;/type&gt;\n   &lt;type&gt;political&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;San Jose&lt;/long_name&gt;\n   &lt;short_name&gt;San Jose&lt;/short_name&gt;\n   &lt;type&gt;administrative_area_level_3&lt;/type&gt;\n   &lt;type&gt;political&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;Santa Clara&lt;/long_name&gt;\n   &lt;short_name&gt;Santa Clara&lt;/short_name&gt;\n   &lt;type&gt;administrative_area_level_2&lt;/type&gt;\n   &lt;type&gt;political&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;California&lt;/long_name&gt;\n   &lt;short_name&gt;CA&lt;/short_name&gt;\n   &lt;type&gt;administrative_area_level_1&lt;/type&gt;\n   &lt;type&gt;political&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;United States&lt;/long_name&gt;\n   &lt;short_name&gt;US&lt;/short_name&gt;\n   &lt;type&gt;country&lt;/type&gt;\n   &lt;type&gt;political&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;address_component&gt;\n   &lt;long_name&gt;94043&lt;/long_name&gt;\n   &lt;short_name&gt;94043&lt;/short_name&gt;\n   &lt;type&gt;postal_code&lt;/type&gt;\n  &lt;/address_component&gt;\n  &lt;geometry&gt;\n   &lt;location&gt;\n    &lt;lat&gt;37.4217550&lt;/lat&gt;\n    &lt;lng&gt;-122.0846330&lt;/lng&gt;\n   &lt;/location&gt;\n   &lt;location_type&gt;ROOFTOP&lt;/location_type&gt;\n   &lt;viewport&gt;\n    &lt;southwest&gt;\n     &lt;lat&gt;37.4188514&lt;/lat&gt;\n     &lt;lng&gt;-122.0874526&lt;/lng&gt;\n    &lt;/southwest&gt;\n    &lt;northeast&gt;\n     &lt;lat&gt;37.4251466&lt;/lat&gt;\n     &lt;lng&gt;-122.0811574&lt;/lng&gt;\n    &lt;/northeast&gt;\n   &lt;/viewport&gt;\n  &lt;/geometry&gt;\n  &lt;place_id&gt;ChIJ2eUgeAK6j4ARbn5u_wAGqWA&lt;/place_id&gt;\n &lt;/result&gt;\n&lt;/GeocodeResponse&gt;\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 62965, "user_id": 3679490, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70f98fb23b16862298ea208aedfd18ae?s=128&d=identicon&r=PG&f=1", "display_name": "vks", "link": "https://stackoverflow.com/users/3679490/vks"}, "edited": false, "score": 0, "creation_date": 1477439540, "post_id": 40251445, "comment_id": 67765463, "body": "You can try <code>[^*]{2}(?=[*])</code> but it will fail if there is a single <code>*</code>"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 2, "last_activity_date": 1477443371, "last_edit_date": 1477443371, "creation_date": 1477443024, "answer_id": 40251992, "question_id": 40251445, "link": "https://stackoverflow.com/questions/40251445/whats-a-simpler-way-to-get-this-array-of-regex-matches/40251992#40251992", "title": "What&#39;s a simpler way to get this array of regex matches?", "body": "<p>Simplest is to Split by <code>\"*\"</code> and get the odd elements of the result:</p>\n\n<pre><code>s = \"There is *AB**XY**DZ* more text\"\na = Split(s, \"*\")\n\nFor i = 1 To UBound(a) Step 2\n    Debug.Print a(i)\nNext\n</code></pre>\n\n<p>Other options can be to experiment with negative and positive lookahead <a href=\"https://regex101.com/r/ZbEb4U/1\" rel=\"nofollow\">https://regex101.com/r/ZbEb4U/1</a>\nor match the <code>*</code>s too <a href=\"https://regex101.com/r/ZbEb4U/2\" rel=\"nofollow\">https://regex101.com/r/ZbEb4U/2</a></p>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 40251992, "answer_count": 1, "score": 0, "last_activity_date": 1477492645, "creation_date": 1477438724, "last_edit_date": 1531164843, "question_id": 40251445, "link": "https://stackoverflow.com/questions/40251445/whats-a-simpler-way-to-get-this-array-of-regex-matches", "title": "What&#39;s a simpler way to get this array of regex matches?", "body": "<p>I have a string starting with some asterisk-bounded substrings, e.g.,</p>\n\n<pre><code>*AB**XY**DZ*There is more text\n</code></pre>\n\n<p>I want to get an array of all these substrings; in this case the array would be as follows:</p>\n\n<pre><code>[1] AB\n[2] XY\n[3] DZ\n</code></pre>\n\n<p>The following strings should not return any matches:</p>\n\n<pre><code>There is *AB**XY**DZ* more text\nThere is more text *AB**XY**DZ*\n</code></pre>\n\n<p>I've implemented this by capturing the whole asterisk-bounded group at the beginning with regex, then processing that result to get the substrings, as follows:</p>\n\n<pre><code>Public Function getCodeArray(commentString As String) As Variant\n\nDim codeString As String\nDim mCol As MatchCollection\nDim regex As RegExp\nDim delimiter As String\n\nSet regex = New RegExp\nregex.Pattern = \"^([*][A-Za-z]{2}[*])+\"\ndelimiter = \"|\"\nSet mCol = regex.Execute(commentString)\ncodeString = mCol(0).Value    \ncodeString = Replace(codeString, \"**\", delimiter)\ncodeString = Replace(\"*\", \"\")\ngetCodeArray = Split(codeString, delimiter)\n\nEnd Function\n</code></pre>\n\n<p>Is there a way that I can set up the regex so that I can directly return the 2-letter substrings as <code>mCol</code>'s matches and not have to use <code>replace()</code> and <code>split()</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477448693, "post_id": 40251228, "comment_id": 67767590, "body": "So you want the conditional formatting to apply to different columns, based on today&#39;s date?"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477448909, "post_id": 40251228, "comment_id": 67767626, "body": "Were you able to see my screen shot?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449037, "post_id": 40251228, "comment_id": 67767652, "body": "Yes, but I confess I wasn&#39;t 100% clear on what you&#39;re trying to accomplish.  I notionally get it (I was a production scheduler in a former life, believe it or not), but I&#39;m not sure what the spreadsheet looks like on 10/26 vs 10/27.  Can you mock that up?  It doesn&#39;t need to be fancy, just demonstrate the before and after."}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449208, "post_id": 40251228, "comment_id": 67767689, "body": "In Columns A to I, I have Jobs/Projects and their details such as Start Date(column G) and End Date(column I). Then along the top from Column AE to KB I have Dates starting from Todays date and onwards. I want to use conditional formatting in VBA to color the cells between the Start and End dates for each job so that it creates a Gantt Chart look. Hope this helps?"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449295, "post_id": 40251228, "comment_id": 67767710, "body": "I&#39;ll try to mock it up."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449315, "post_id": 40251228, "comment_id": 67767714, "body": "I think I get it now..."}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449598, "post_id": 40251228, "comment_id": 67767781, "body": "<b>26/10/2016</b>      <b>27/10/2016</b> <b>Job</b>  <b>Name</b>     <b>Start</b>     <b>End</b>                                               J2345    Edward St   26/10/16   27/10/16        CC                         CC  J2225    Nova St       27/10/16   28/10/16        NC                         CC"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477449612, "post_id": 40251228, "comment_id": 67767787, "body": "NC Stands for a Conditionally Non-Colored cell and CC Stands for a Conditionally Colored cell. Does that help?"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477450361, "post_id": 40251228, "comment_id": 67767959, "body": "Sorry that didn&#39;t work. Explanation: A job(for example J1125) begins on the 26th Oct and ends on the 27th Oct. The columns with those dates will be colored. But for a job that is not to be worked on on those dates will remain colorless."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477451901, "post_id": 40253023, "comment_id": 67768386, "body": "That&#39;s great @Hambone. However it is highlighting just one row and it is the entire row. I am needing only the cells in the row,for each job/row, where the column is within the start to end date. Does that make sense?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477452948, "post_id": 40253023, "comment_id": 67768644, "body": "Can you upload a sample to Dropbox (or whatever)?"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477453426, "post_id": 40253023, "comment_id": 67768759, "body": "How am I best to share it from dropbox?"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477453463, "post_id": 40253023, "comment_id": 67768765, "body": "Does this work? <a href=\"https://www.dropbox.com/s/lx0xo8eywuz01uq/Product%20Schedule.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/lx0xo8eywuz01uq/Product%20Schedule.xlsx?dl=0</a>"}, {"owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "edited": false, "score": 0, "creation_date": 1477453707, "post_id": 40253023, "comment_id": 67768832, "body": "Sorry I didn&#39;t give you the one with the macro in it. Here it is: <a href=\"https://www.dropbox.com/s/rgv9u17acqgr89f/Product%20Schedule.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/rgv9u17acqgr89f/Product%20Schedule.xlsm?dl=0</a>    - The Yellow is what the macro does and the green is what I would like it to look like. I have changed it slightly so that it goes to Last Row and to Column 288 which is what I want."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1477451125, "creation_date": 1477451125, "answer_id": 40253023, "question_id": 40251228, "link": "https://stackoverflow.com/questions/40251228/vba-conditional-formatting-based-on-dynamic-criteria/40253023#40253023", "title": "VBA Conditional formatting based on dynamic criteria", "body": "<p>This is extremely crude, but hopefully it gives you the idea.  This example colors the cells yellow:</p>\n\n<pre><code>Sub FormatGantt()\n\n  Dim r As Range\n  Dim fromDate, toDate, colDate As Date\n  Dim row, col As Integer\n\n  For row = 25 To 29\n    fromDate = Cells(row, 7).Value2\n    toDate = Cells(row, 9).Value2\n\n    For col = 31 To 50 Step 4\n      colDate = Cells(22, col).Value2\n      If colDate &gt;= fromDate And colDate &lt;= toDate Then\n        Range(Cells(row, col), Cells(row, col + 3)).Interior.Color = 65535\n\n      End If\n    Next col\n\n  Next row\n\n\nEnd Sub\n</code></pre>\n\n<p>Here is a screenshot of this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MroVt.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/MroVt.png\" alt=\"enter image description here\"></a></p>\n\n<p>This does it against a very narrow range.  To accomplish what you are seeking to do, when any change is made, you want to fire the Worksheet_Change event (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff839775.aspx</a>), detect what cell(s) we changed and apply the formatting below accordingly.</p>\n"}], "owner": {"reputation": 23, "user_id": 6041980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/l37Dp.jpg?s=128&g=1", "display_name": "Beth", "link": "https://stackoverflow.com/users/6041980/beth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1529409245, "creation_date": 1477437341, "last_edit_date": 1592644375, "question_id": 40251228, "link": "https://stackoverflow.com/questions/40251228/vba-conditional-formatting-based-on-dynamic-criteria", "title": "VBA Conditional formatting based on dynamic criteria", "body": "<p>I have a sheet that I was originally going to manually enter this formula and adapt to suit the cell: =AND(Date(eg.AE22)&gt;=StartDate(eg.G25),Date(same as before)&lt;=EndDate(eg.I25)) <em>This is the formula that was going into Cell AE25.</em>\nFor all the cells in that row that were for that day(eg.26-Oct) would have the exact same formula. Then for then next day(27-Oct) I was going to have to change the Date(from AE22 to AI22) so that formula would be correct.\nFinally I would set the condition formatting to highlight it if it was True and not if it was False.\nI wanted to see if I was able to do this all by VBA so that it automatically updates if there is any changes on worksheet. I'm sure it can be done but I have been able to find anything that can help me.\nThe purpose of the worksheet is to create a dynamic production schedule in a gantlet chart view.</p>\n<h3>Screen shot of the worksheet</h3>\n<p><img src=\"https://i.stack.imgur.com/GSyzc.png\" alt=\"Screen shot of the worksheet\" /></p>\n<p>Let me know if you require any more information.\nThanks in advance.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "ssis", "large-data"], "comments": [{"owner": {"reputation": 492, "user_id": 5157709, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wD6j0.png?s=128&g=1", "display_name": "EMUEVIL", "link": "https://stackoverflow.com/users/5157709/emuevil"}, "edited": false, "score": 1, "creation_date": 1477439110, "post_id": 40251140, "comment_id": 67765382, "body": "use <code>NVARCHAR(MAX)</code> to store the data.  If there are carriage returns <code>CHAR(13)</code> or tabs <code>CHAR(9)</code> in your data, they can cause line breaks in Excel when you paste the data in.  I just <code>REPLACE()</code> them with a space character In order to bring data back in, look into the <code>BULK IMPORT</code> command.  Remember that you can make an SQL connection directly from Excel from the Data tab under Connections."}, {"owner": {"reputation": 43, "user_id": 2088181, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b2af2665477d4c4082b6fd3e1fc1e1a7?s=128&d=identicon&r=PG", "display_name": "Darybrain", "link": "https://stackoverflow.com/users/2088181/darybrain"}, "reply_to_user": {"reputation": 492, "user_id": 5157709, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wD6j0.png?s=128&g=1", "display_name": "EMUEVIL", "link": "https://stackoverflow.com/users/5157709/emuevil"}, "edited": false, "score": 0, "creation_date": 1477442637, "post_id": 40251140, "comment_id": 67766133, "body": "I would still need the line break.s  Users are writing paragraphs of information into 1 cell.  I will try NVarchar(max).  How will an Excek Data Connection help write back to MSSQL a cell that contains 6k+ characters?  The SQL in the command text won&#39;t like such a long string when writing INSERTs or UPDATEs and if it did I could simply carry in using ADO."}], "owner": {"reputation": 43, "user_id": 2088181, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b2af2665477d4c4082b6fd3e1fc1e1a7?s=128&d=identicon&r=PG", "display_name": "Darybrain", "link": "https://stackoverflow.com/users/2088181/darybrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506002363, "creation_date": 1477436683, "last_edit_date": 1506102294, "question_id": 40251140, "link": "https://stackoverflow.com/questions/40251140/read-write-a-large-text-comments-cell-6k-chars-in-excel-from-to-sql-server", "title": "Read/write a large text/comments cell (6k+ chars) in Excel from/to SQL Server", "body": "<p>I am trying to alter an existing Excel 2010 workbook so that the data is hosted on MSSQL since the data is getting to large and the workbook too slow.  I'm using ADO.  My issue here is I don't know how best to handle the cells that contain a large amount of comments which also include carriage returns/line feeds and possible other special characters.  The largest cell contains approx 6000 characters so far.  I don't really expect the text within a given cell to get much bigger than that.</p>\n\n<p>Questions: -</p>\n\n<ul>\n<li>What data type should I use within SQL Server to store this data?  I'm concerned about special characters like carriage returns.</li>\n<li>What is the best method to transfer data back and forth from Excel and MSSQL?  I could probably use a hidden ListObject to read the data, but I'm more concerned about writing any edits back.  The cell length is too long for a SQL string and I don't know how to handle the carriage returns.  I keep getting an Application Object error.  I don't have any problem with most cells and their data, just these large text cells that represent comment descriptions.</li>\n<li>I don't know how to handle the initial large data dump into MSSQL.  The SQL Server Import Wizard keeps failing stating there are characters not within the assigned code page.  There is no indication of the row it failed on or what characters are causing the issue.  Is that down to the data type I've chosen?  It is currently Varchar hence my first question.  Should I just use Text or NText?  Won't they make the database massive?  SSIS uses the import wizard so that will still fail.  Anything that requires a SQL statement such as ADO or OPENROWSET won't like the length of the data unless I'm missing something.</li>\n</ul>\n\n<p>Any suggestions/help would be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477436515, "post_id": 40251087, "comment_id": 67764743, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36157512/show-number-stored-as-text-error\">Show &quot;Number stored as Text&quot; error</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1477439286, "post_id": 40251087, "comment_id": 67765414, "body": "Start by using the macro recorder.  If you run into problems, post back with your code and a clear description of the problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1477444049, "post_id": 40251087, "comment_id": 67766499, "body": "The Text-to-Columns (fixed width, Finish) is the easiest way to convert whole columns of text-that-look-like-a-number into true numbers."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1477442772, "creation_date": 1477442772, "answer_id": 40251966, "question_id": 40251087, "link": "https://stackoverflow.com/questions/40251087/macro-to-convert-every-9th-column-into-numbers-in-excel/40251966#40251966", "title": "Macro to convert every 9th column into numbers in excel", "body": "<p>This is a follow-up to the OP's previous question, which, I answered. </p>\n\n<p>Load the data into an array typecast it into a number then write it back over the original range.</p>\n\n<pre><code>Sub ConvertToNumber()\n    Dim x As Long, y As Long\n    Dim Data\n\n    With Worksheets(\"CPR Test 2013-2015\")\n        For y = 1 To 1582 Step 9\n            Data = .Cells(2, y).Resize(2699, 1).Value\n            For x = 1 To UBound(Data, 1)\n                If IsNumeric(Data(x, 1)) And Not IsEmpty(Data(x, 1)) Then\n                    Data(x, 1) = CDbl(Data(x, 1))\n                End If\n            Next\n            .Cells(2, y).Resize(2699, 1).Value = Data\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 40251966, "answer_count": 1, "score": 0, "last_activity_date": 1477442772, "creation_date": 1477436338, "question_id": 40251087, "link": "https://stackoverflow.com/questions/40251087/macro-to-convert-every-9th-column-into-numbers-in-excel", "title": "Macro to convert every 9th column into numbers in excel", "body": "<p>For some reason, even when I select a column, right click, and format the cells to be numbers, I still get an alert with a green corner in the cell that says that it's a number stored as text. I then highlight the range, click the exclamation point in the yellow box, and convert the range to numbers.</p>\n\n<p>The problem is that I have to do this for hundreds of ranges. </p>\n\n<p>How can I make a macro to highlight a range (e.g. XP2:XP2700) in every 9th column, and convert the entire range to numbers?</p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477436415, "post_id": 40251064, "comment_id": 67764727, "body": "What code is in what module?  Is everything in the userform?  I&#39;d suggest taking a look at <a href=\"http://stackoverflow.com/documentation/vba/5351/user-forms/19036/best-practices#t=201610252259347492268\">this example</a> in documentation for a better approach to form handling."}, {"owner": {"reputation": 138, "user_id": 4490720, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002641253291/picture?type=large", "display_name": "Jonathan Rauscher", "link": "https://stackoverflow.com/users/4490720/jonathan-rauscher"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477436741, "post_id": 40251064, "comment_id": 67764805, "body": "@Comintern I have edited the OP to reflect your questions."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477436937, "post_id": 40251064, "comment_id": 67764852, "body": "Can you add the code for <code>sportsUsrFrm_Initialize</code>?"}, {"owner": {"reputation": 138, "user_id": 4490720, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002641253291/picture?type=large", "display_name": "Jonathan Rauscher", "link": "https://stackoverflow.com/users/4490720/jonathan-rauscher"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477437132, "post_id": 40251064, "comment_id": 67764897, "body": "@Comintern unless that&#39;s code that has been added by default, I do not believe I have written any code for <code>sportsUsrFrm_Initialize</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477437413, "post_id": 40251064, "comment_id": 67764958, "body": "Is there any code in the UserForm at all?"}, {"owner": {"reputation": 138, "user_id": 4490720, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002641253291/picture?type=large", "display_name": "Jonathan Rauscher", "link": "https://stackoverflow.com/users/4490720/jonathan-rauscher"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1477437824, "post_id": 40251064, "comment_id": 67765052, "body": "@Comintern I&#39;ve added any event handlers behind the UserForm and a picture of the UserForm itself."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1506030565, "last_edit_date": 1506030565, "creation_date": 1477438727, "answer_id": 40251446, "question_id": 40251064, "link": "https://stackoverflow.com/questions/40251064/excel-vba-compile-error-method-or-data-member-not-found/40251446#40251446", "title": "Excel VBA: Compile Error: Method or data member not found", "body": "<p>You're getting the error because <code>showInputsDialog</code> isn't a member of the form, it's a member of the module you're calling it from.  You should also be getting compiler errors on these two lines...</p>\n\n<pre><code>Call Initialize\nMe.Show\n</code></pre>\n\n<p>...because you seem to be getting the module and form code mixed up.</p>\n\n<p>That said, you're overthinking this.  A UserForm is a class module, and it can be stored in a variable (or in this case, in a <code>With</code> block), and can have properties.  I'd add a <code>Cancelled</code> property to the form:</p>\n\n<pre><code>'In sportsUsrFrm\nOption Explicit\n\nPrivate mCancel As Boolean\n\nPublic Property Get Cancelled() As Boolean\n    Cancelled = mCancel\nEnd Property\n\nPrivate Sub cmdCnl_Click()\n    Me.Hide\n    mCancel = True\nEnd Sub\n\nPrivate Sub cmdOK_Click()\n    If Valid Then Me.Hide   '&lt;-- You still need to implement `Valid`\nEnd Sub\n</code></pre>\n\n<p>And then call it like this:</p>\n\n<pre><code>Sub sportUserForm()\n    With New sportsUsrFrm\n        .Show\n        Dim sSport As String, sPreference As String\n        If Not .Cancelled Then\n            If .optBaseball.Value Then\n                sSport = \"Baseball\"\n            ElseIf .optBasketball.Value Then\n                sSport = \"Basketball\"\n            Else\n                sSport = \"Football\"\n            End If\n\n            If .optTV.Value Then\n                sPreference = \"watch on TV\"\n            Else\n                sPreference = \"go to games\"\n            End If\n            MsgBox \"Your favorite sport is \" &amp; sSport &amp; \", and you usually \" _\n                   &amp; sPreference &amp; \".\"\n        Else\n            MsgBox \"Sorry you don't want to play.\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 4490720, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002641253291/picture?type=large", "display_name": "Jonathan Rauscher", "link": "https://stackoverflow.com/users/4490720/jonathan-rauscher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33180, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530772943, "creation_date": 1477436186, "last_edit_date": 1477437797, "question_id": 40251064, "link": "https://stackoverflow.com/questions/40251064/excel-vba-compile-error-method-or-data-member-not-found", "title": "Excel VBA: Compile Error: Method or data member not found", "body": "<p>EDIT: To clarify, the code seen below is within a module and the UserForm is all contained within its own code.</p>\n\n<p>I have the following code. When I go to run it, Excel throws me a compile error: <code>Method or data member not found</code> and highlights the following piece of code: <code>.showInputsDialog</code>. I have no idea how to resolve this error.</p>\n\n<p>To give more information, the sub <code>sportUserForm</code> is supposed to call up a UserForm <code>sportsUsrFrm</code>. Any help with this issue is greatly appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub sportUserForm()\n\nDim sSport As String, sPreference As String\n\nIf sportsUsrFrm.showInputsDialog(sSport, sPreference) Then\n    MsgBox \"Your favorite sport is \" &amp; sSport &amp; \", and you usually \" _\n            &amp; sPreference &amp; \".\"\n        Else\n    MsgBox \"Sorry you don't want to play.\"\nEnd If\nEnd Sub\n\nPublic Function showInputsDialog(sSports As String, sPreference As String) As Boolean\nCall Initialize\nMe.Show\nIf Not cancel Then\n    If optBaseball.Value Then sSport = \"Baseball\"\n        ElseIf optBasketball.Value Then sSport = \"Basketball\"\n        Elss sSport = \"Football\"\n    End If\n\n    If optTV.Value Then sPreference = \"watch on TV\" _\n        Else: sPreference = \"go to games\"\n    End If\n\n    showInputsDialog = Not cancel\n    Unload Me\nEnd Function\n</code></pre>\n\n<p>UserForm code for <code>sportUsrFrm</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmdCnl_Click()\n    Me.Hide\n    cancel = True\nEnd Sub\n\nPrivate Sub cmdOK_Click()\n\n    If Valid Then Me.Hide\n    cancel = False\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rl0Sp.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/rl0Sp.png\" alt=\"UserForm image\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1477432698, "post_id": 40250360, "comment_id": 67763506, "body": "See here: <a href=\"http://stackoverflow.com/questions/27421873/select-query-does-not-work-when-converted-to-vba-invalid-sql-statement\" title=\"select query does not work when converted to vba invalid sql statement\">stackoverflow.com/questions/27421873/&hellip;</a>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1477433016, "post_id": 40250360, "comment_id": 67763623, "body": "Consider using table aliases in your SQL (<code>SELECT Summary.[COMPANY ID] FROM [Table - Summary - All Item Forecasts, Sales, and POs] AS Summary</code>) ; it&#39;ll make your statements both shorter and easier to parse."}], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1477433313, "creation_date": 1477433313, "answer_id": 40250554, "question_id": 40250360, "link": "https://stackoverflow.com/questions/40250360/ms-access-writing-sql-in-vba/40250554#40250554", "title": "MS Access - Writing SQL in VBA", "body": "<p>As mentioned in the DoCmd.RunSQL <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194626.aspx\" rel=\"nofollow\">documentation</a>, it is used to run an \"action query\". That is, the <em>SQLStatement</em> is</p>\n\n<blockquote>\n  <p>A string expression that's a valid SQL statement for an action query or a data-definition query. It uses an INSERT INTO, DELETE, SELECT...INTO, UPDATE, CREATE TABLE, ALTER TABLE, DROP TABLE, CREATE INDEX, or DROP INDEX statement.</p>\n</blockquote>\n\n<p>Note that the above list includes <code>SELECT...INTO</code> but not a plain <code>SELECT</code>. To execute a plain <code>SELECT</code> and return a recordset you need to do something like</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Dim cdb As DAO.Database\nSet cdb = CurrentDb\nDim rst As DAO.Recordset\nSet rst = cdb.OpenRecordset(sqlString, dbOpenSnapshot)\n' loop through the Recordset contents\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "is_accepted": false, "score": -1, "last_activity_date": 1477469167, "creation_date": 1477469167, "answer_id": 40256880, "question_id": 40250360, "link": "https://stackoverflow.com/questions/40250360/ms-access-writing-sql-in-vba/40256880#40256880", "title": "MS Access - Writing SQL in VBA", "body": "<p>Also, in your last 2 lines you're missing the space between ...[MaxOfLATEST PO DATE] and HAVING. It will fall over when it tries to run that as SQL.<br>\nI've hit this myself a few times, as I'm very new to VBA - I always put a debug.print SQLstring after the run command as it's easier to find these missing spaces etc in the Immediate window.</p>\n\n<p>HTH, Jenny</p>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477469167, "creation_date": 1477432377, "question_id": 40250360, "link": "https://stackoverflow.com/questions/40250360/ms-access-writing-sql-in-vba", "title": "MS Access - Writing SQL in VBA", "body": "<p><strong>BACKGROUND</strong></p>\n\n<p>Develop a MS Access module that executes SQL code when onClick() event triggered.</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Dim sqlString As String\n\nsqlString = \"SELECT [Table - Summary - All Item Forecasts, Sales, and POs].[COMPANY ID], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[COMPANY NAME], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].ITEM, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].STYLE, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].DESCRIPTION, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[SALE PRICE], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[ON-HAND QTY], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[FORECAST QTY], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[MaxOfLATEST PO DATE] \" _\n    &amp; \"FROM [Table - Active Product Catalog] \" _\n    &amp; \"LEFT JOIN [Table - Summary - All Item Forecasts, Sales, and POs] \" _\n        &amp; \"ON [Table - Active Product Catalog].STYLE = [Table - Summary - All Item Forecasts, Sales, and POs].STYLE \" _\n    &amp; \"GROUP BY [Table - Summary - All Item Forecasts, Sales, and POs].[COMPANY ID], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[COMPANY NAME] , \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].Item, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].Style, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].Description, \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[SALE PRICE], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[ON-HAND QTY], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[FORECAST QTY], \" _\n        &amp; \"[Table - Summary - All Item Forecasts, Sales, and POs].[MaxOfLATEST PO DATE]\" _\n    &amp; \"HAVING ((([Table - Summary - All Item Forecasts, Sales, and POs].[COMPANY NAME]) Like ' * ' &amp; [Enter Company Name:] &amp; ' * '));\"\n\n\nDoCmd.RunSQL sqlString\n</code></pre>\n\n<p><strong>ERROR</strong></p>\n\n<blockquote>\n  <p>Run-time error '2342': A RunSQL action requires an argument consisting of an SQL statement.</p>\n</blockquote>\n\n<p><strong>QUESTION(S)</strong></p>\n\n<ol>\n<li>I've followed the following <a href=\"http://www.fontstuff.com/access/acctut15.htm\" rel=\"nofollow\">tutorial</a> but receive an error. It appears that the RunSQL command isn't recognizing sqlString as a SQL command. However, I am positive that the SQL statement runs correctly in MS Access. Any ideas?</li>\n<li>On the last line of the SQL statement, I have a MsgBox prompt (\"<code>[Enter Company Name:]</code>\"). I am not quite sure if this is throwing off the SQL statement but, as stated before, the syntax runs in MS Access; even if I replace the prompt with a hard-coded value, I receive the same error message. </li>\n</ol>\n\n<p><em>NOTE: I'll most likely create an <code>inputBox</code> that asks for the <code>company name</code> and then place the variable within the last line of the SQL statement.</em> </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1477432590, "post_id": 40250302, "comment_id": 67763453, "body": "You pretty much nailed it. I&#39;d personally leave the <code>Err.HelpFile, Err.HelpContext</code> bit off though."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477439864, "post_id": 40250302, "comment_id": 67765540, "body": "How is <code>Err.Raise</code> really different from <code>throw</code>? You can treat it like a keyword."}, {"owner": {"reputation": 3437, "user_id": 465942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cua5w.png?s=128&g=1", "display_name": "Kap&#233;", "link": "https://stackoverflow.com/users/465942/kap%c3%a9"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477468791, "post_id": 40250302, "comment_id": 67774871, "body": "@JohnColeman Because I&#39;m not sure whether this is the proper way to &#39;rethrow&#39;. In C# for example you can just throw without creating a new exception instance."}, {"owner": {"reputation": 3437, "user_id": 465942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cua5w.png?s=128&g=1", "display_name": "Kap&#233;", "link": "https://stackoverflow.com/users/465942/kap%c3%a9"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1477468847, "post_id": 40250302, "comment_id": 67774895, "body": "@Comintern Why shouldn&#39;t I pass the <code>Err.HelpFile</code> and <code>Err.HelpContext</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 12326399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm_krXNBRVHfQICNeMiHDA3LS12kxRbLzD5x5h=k-s128", "display_name": "BR_DataMiner", "link": "https://stackoverflow.com/users/12326399/br-dataminer"}, "is_accepted": false, "score": -1, "last_activity_date": 1573579106, "last_edit_date": 1573579106, "creation_date": 1573576738, "answer_id": 58823006, "question_id": 40250302, "link": "https://stackoverflow.com/questions/40250302/how-to-rethrow-error-in-vba/58823006#58823006", "title": "How to rethrow error in VBA", "body": "<p>I think that you should use ON ERROR GOTO...</p>\n\n<p>And continue your error handling inside the \"next_step\"</p>\n\n<p>For example:</p>\n\n<pre><code>Sub test()\n    'IF OCCOUR ERROR INSIDE THIS BLOCK THE ERROR CONTINUE IN \"next_step\"\n    On Error GoTo next_step\n\n    If Err.Number = 10 Then\n        Msgbox\"Error!\"\n    End If\n\n    next_step:\n    'YOU CAN CONTINUE YOUR CODE HERE!!\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1603356865, "creation_date": 1603356865, "answer_id": 64478691, "question_id": 40250302, "link": "https://stackoverflow.com/questions/40250302/how-to-rethrow-error-in-vba/64478691#64478691", "title": "How to rethrow error in VBA", "body": "<p>That is the correct method, but no, you don't have to re-state all the err properties.  The values are retained:</p>\n<pre><code>err.raise Err.Number\n</code></pre>\n<p>is the same as</p>\n<pre><code>Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n</code></pre>\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/user-interface-help/raise-method\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/Language/Reference/user-interface-help/raise-method</a></p>\n<p>It can be more complex if you are throwing out of a class module. By default, the err object of a class module is caught and re-created, so depending on how it is declared, properties may be replaced.</p>\n"}], "owner": {"reputation": 3437, "user_id": 465942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cua5w.png?s=128&g=1", "display_name": "Kap&#233;", "link": "https://stackoverflow.com/users/465942/kap%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1603356865, "creation_date": 1477432085, "last_edit_date": 1573579096, "question_id": 40250302, "link": "https://stackoverflow.com/questions/40250302/how-to-rethrow-error-in-vba", "title": "How to rethrow error in VBA", "body": "<p>When there's an error I would like to do some cleanup and then let the error flow up so that it's handled globally.</p>\n\n<p>In C# I would do a <code>try finally</code> but that is not possible with VBA, only <code>On Eror GoTo &lt;mylabel&gt;</code>.</p>\n\n<p>How can I rethrow the error properly when caught in the label?</p>\n\n<p>Is it only possible calling Err.Raise again with all properties, no <code>throw</code> like keyword exists?:</p>\n\n<pre><code>Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1477429643, "post_id": 40249693, "comment_id": 67761972, "body": "There are not 7 columns in ActiveWorkbook.Worksheets(&quot;VIAL TYPES&quot;).Range(&quot;A1:A309&quot;) the 7 is dynamic on the range in the second criterion.  You  need to expand your range to include the column from which you want the value to be returned. <code>ActiveWorkbook.Worksheets(&quot;VIAL TYPES&quot;).Range(&quot;A1:G309&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1477429914, "post_id": 40249693, "comment_id": 67762112, "body": "Also you want to change the first part to <code>VTEST</code> instead of <code>ActiveWorkbook.ActiveSheet.Range(&quot;G9&quot;).Value</code> to make the UDF return the value to the cell in which you place the formula.  A UDF in itself cannot change the value of another cell."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1477430142, "post_id": 40249693, "comment_id": 67762224, "body": "The trick to <code>VLookUp</code> is to make sure that the value you are searching for is always to the left of the value you want to return. Your code is looking in 1 column: A. If column A is the column that contains the <code>VialType</code>, and you want to return the corresponding value from column 7, then you must use <code>.Range(&quot;A1:G309&quot;)</code>. However, if your searched column were column B, then not only would you change the range to <code>.Range(&quot;B1:G309&quot;)</code>, but you would also return column 6 of your range (eeven though its the 7th column on the sheet)."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477431158, "post_id": 40249693, "comment_id": 67762747, "body": "Why the UDF for a <code>=VLOOKUP()</code>?"}, {"owner": {"reputation": 21, "user_id": 7071792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e46ee5439683ca3822648429b2c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "user7071792", "link": "https://stackoverflow.com/users/7071792/user7071792"}, "edited": false, "score": 0, "creation_date": 1477431492, "post_id": 40249693, "comment_id": 67762930, "body": "Y&#39;all solved my problem in like 3 minutes, u da real mvp."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477431866, "post_id": 40249693, "comment_id": 67763108, "body": "I still question your use of a UDF. Not very often they are necessary over a built in formula, especially not when you are self proclaimed &quot;very new to VBA&quot;."}, {"owner": {"reputation": 21, "user_id": 7071792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e46ee5439683ca3822648429b2c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "user7071792", "link": "https://stackoverflow.com/users/7071792/user7071792"}, "edited": false, "score": 0, "creation_date": 1477432517, "post_id": 40249693, "comment_id": 67763426, "body": "Kyle, from here, I&#39;m storing it as a variable and making some additional declarations about the data. I just needed to see that this section of the final program actually works, which you all made happen by being great people."}], "owner": {"reputation": 21, "user_id": 7071792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e46ee5439683ca3822648429b2c1c8?s=128&d=identicon&r=PG&f=1", "display_name": "user7071792", "link": "https://stackoverflow.com/users/7071792/user7071792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1477429552, "creation_date": 1477429552, "question_id": 40249693, "link": "https://stackoverflow.com/questions/40249693/vlookup-function-in-excel-vba", "title": "VLookup function in Excel VBA", "body": "<p>I'm very new to VBA, yet I still find myself writing a UDF for excel and part of that process requires that a value be pulled from another sheet that is open in the same workbook. I don't know what I'm doing obviously, but I'm hoping someone else can point me in the right direction.</p>\n\n<p>A sheet called \"VIAL TYPES\" has the data that I need in the 7th column. \nFor the purpose of this question, I would just like to print the value of VLookup in cell G9. </p>\n\n<p>To run the function, I would manually write in the VialType in an adjacent cell. I expect the Vlookup function to recognize the type entered into cell (=VTEST(cellIwrotethevialtypein)), find it's match in the \"VIAL TYPES\" sheet and then print the value in the 7th column back in the active sheet. Basically, I want it to do exactly what VLOOKUP does, I just need this to work in vba so that I can execute additional things with the value. </p>\n\n<p>I get #Value! in the cell now. </p>\n\n<pre><code>    Function VTEST(VialType As String)\n\n    ActiveWorkbook.ActiveSheet.Range(\"G9\").Value = Application.WorksheetFunction.VLookup(VialType, ActiveWorkbook.Worksheets(\"VIAL TYPES\").Range(\"A1:A309\"), 7, False)\n\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1477430706, "last_edit_date": 1477430706, "creation_date": 1477429890, "answer_id": 40249779, "question_id": 40249684, "link": "https://stackoverflow.com/questions/40249684/vba-script-to-copy-data-from-specfic-cell-range-and-paste-to-a-specific-cell-in/40249779#40249779", "title": "VBA script to copy Data from specfic cell range and paste to a specific cell in a new sheet", "body": "<p>You should be able to use</p>\n\n<pre><code>Sub CopyDATA()\n\n    Sheets(\"TEST\").Range(\"AA:AK\").ClearContents\n\n    Range(\"B1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    ' Paste to sheet Test\n    Sheets(\"TEST\").Range(\"AA1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7071855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13c0aa9d65a91627d69b1f03dc23d53?s=128&d=identicon&r=PG&f=1", "display_name": "TryingHard", "link": "https://stackoverflow.com/users/7071855/tryinghard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1000, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477430706, "creation_date": 1477429521, "last_edit_date": 1531164843, "question_id": 40249684, "link": "https://stackoverflow.com/questions/40249684/vba-script-to-copy-data-from-specfic-cell-range-and-paste-to-a-specific-cell-in", "title": "VBA script to copy Data from specfic cell range and paste to a specific cell in a new sheet", "body": "<p>I have the following script and am trying to work out how to paste the copied data to cell AA1 in sheet TEST, But before it pastes the selected data i need to clear all the data that is in columns AA:AK in sheet TEST. The script copies the data ok but i can't get Selection.PasteSpecial to work with \"offset\", and i cant work out how to clear the contents of AA:AK in advance.\nAny help would be much appreciated.</p>\n\n<p>Sub CopyDATA()</p>\n\n<pre><code>' Set Auto Filter\nSelection.AutoFilter\nSheets(\"SBC_Month\").Select\nRange(\"$AA$1:$AK$5000\").AutoFilter Field:=9, Criteria1:=\"Rep Name\"   ' Filters by Rep Name\n\n' copy filtered data\nRange(\"AA1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\n' Paste to sheet Test\nSheets(\"TEST\").Select\nSelection.PasteSpecial , Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "activex"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1477429048, "post_id": 40249503, "comment_id": 67761627, "body": "To better help, could you post the existing piece of code that you&#39;re modifying?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1477437547, "post_id": 40249503, "comment_id": 67764987, "body": "Are the controls on a Worksheet or a UserForm?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477510235, "post_id": 40251513, "comment_id": 67801319, "body": "This seems to be working, with one added issue... now anytime I click on the combobox, the screen &quot;twitches&quot;, and the cursor jobs somewhere else.  No VBA events are being triggered, since I put breakpoints on every module.  After this happens, I can&#39;t click anywhere on the screen.  I have to alt-tab to another window, then alt tab back into Excel."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477510866, "post_id": 40251513, "comment_id": 67801672, "body": "@ConfusedNoob don&#39;t be convinced that breakpoints aren&#39;t being hit. Note that I said you can&#39;t step through code after a certain point, and some breakpoints will be ignored from that point. Use <code>debug.print</code> statements to confirm code is being hit."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477510903, "post_id": 40251513, "comment_id": 67801686, "body": "@ConfusedNoob Is the control on a sheet or a form?"}, {"owner": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477516303, "post_id": 40251513, "comment_id": 67804302, "body": "Control is on a worksheet.  Good suggestion on the debug.print, did not think of it... I added in the debug.print to every event within my VBA code.  Nothing is triggering..."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477516407, "post_id": 40251513, "comment_id": 67804342, "body": "Are you perhaps in design mode?"}, {"owner": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "edited": false, "score": 0, "creation_date": 1477516612, "post_id": 40251513, "comment_id": 67804463, "body": "No, not in design mode"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1477439165, "creation_date": 1477439165, "answer_id": 40251513, "question_id": 40249503, "link": "https://stackoverflow.com/questions/40249503/recreating-an-activex-control-with-vba-events-using-vba/40251513#40251513", "title": "Recreating an ActiveX control with VBA events, using VBA", "body": "<p>This seems to work for me, in a worksheet:</p>\n\n<p>Start with 2 CommandButtons on a worksheet: <code>CommandButton1</code> and <code>CommandButton2</code>.</p>\n\n<p>You can't step through the code, but it will run.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n  Dim oldObj As OLEObject\n  Dim left As Double, top As Double, width As Double, height As Double\n  Set oldObj = Me.OLEObjects(\"CommandButton2\")\n\n  With oldObj\n    'Rename the control to detach events\n    .Name = \"CommandTEMP\"\n    left = .left\n    top = .top\n    width = .width\n    height = .height\n    .Delete\n  End With\n\n  Dim newObj As Object\n\n  Set newObj = Me.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n        , DisplayAsIcon:=False, left:=left, top:=top, width:=width, height:=height)\n\n  newObj.Name = \"CommandButton2\"\n\nEnd Sub\n\nPrivate Sub CommandButton2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n  Me.CommandButton2.Object.Caption = Timer\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5301710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb386bb8953ef2d2dd90a1ed949a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedNoob", "link": "https://stackoverflow.com/users/5301710/confusednoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 40251513, "answer_count": 1, "score": 2, "last_activity_date": 1477439165, "creation_date": 1477428839, "last_edit_date": 1531164843, "question_id": 40249503, "link": "https://stackoverflow.com/questions/40249503/recreating-an-activex-control-with-vba-events-using-vba", "title": "Recreating an ActiveX control with VBA events, using VBA", "body": "<p>I have a combobox that has multiple events tied to it (eg, ComboBox1_Change, Click, GotFocus, LostFocus).  For my purposes, I need to use an ActiveX control.  </p>\n\n<p>For some background: </p>\n\n<p>I ran into an issue where the ActiveX control glitches when the machine is attached to a projector.  Other's have had the same problem, but no solution.  The best way I found to solve this issue is to create an additional button the user can click which deletes the ActiveX control and recreate it.</p>\n\n<p>The problem is (and my question)... When I do this, the VBA events no longer execute.  The control is named the exact same.  Is there a simple fix (such as property in the ActiveX control I can set), so that I do not need to write VBA code to delete and rewrite existing VBA code (which I'm not even 100% sure will fix the issue)?</p>\n"}, {"tags": ["excel", "vba", "hyperlink", "updates"], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1477428142, "last_edit_date": 1477428142, "creation_date": 1477427739, "answer_id": 40249246, "question_id": 40248926, "link": "https://stackoverflow.com/questions/40248926/check-external-link-status-before-updating/40249246#40249246", "title": "Check external link status before updating", "body": "<p>You can read the links using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821922.aspx\" rel=\"nofollow\">Workbook.LinkSources</a> property, which returns an array of link names, and then you can update each link individually, while ignoring errors:</p>\n\n<pre><code>Sub SafeUpdateLink(LinkName As String)\n    On Error Resume Next\n    ActiveWorkbook.UpdateLink Name:=LinkName\nEnd Sub\n\nSub UpdateAllLinks\n    Dim x As Variant\n    For Each x In ActiveWorkbook.LinkSources\n        SafeUpdateLink x\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5364060, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7cff2527b0145f48c5030f9bf333bc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Aurax22", "link": "https://stackoverflow.com/users/5364060/aurax22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477428142, "creation_date": 1477426494, "last_edit_date": 1477427406, "question_id": 40248926, "link": "https://stackoverflow.com/questions/40248926/check-external-link-status-before-updating", "title": "Check external link status before updating", "body": "<p>I am using the below piece to update multiple links on an Excel workbook.\nHowever currently, if one of the links does not work, it simply flags an error in the code.</p>\n\n<pre><code>ActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources\n</code></pre>\n\n<p>How can I do the following:</p>\n\n<pre><code>'Pseudocode\nIf link is valid Then\n    Update\nElse\n    Go to next link\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477427131, "post_id": 40248912, "comment_id": 67760555, "body": "What is the actual error message and where does it pop up? Nothing in your code looks like it is obviously wrong. Perhaps the error is in how you are trying to use it in the calling code? Note that if the condition is never met then the return value will default to an empty object."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477427356, "post_id": 40248912, "comment_id": 67760676, "body": "I just tested it using a dummy set of Controls (and getting rid of the <code>If</code> statement and just executing the <code>Set</code> for the first object in <code>Controls</code>) and a <code>MsgBox RelateControl_ToggleVsList(TextBox1).Name</code> correctly showed me the name of my first Control.  When you say that you get a Null property, do you just mean the returned ListBox&#39;s Value property is <code>Null</code>?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477427623, "post_id": 40248912, "comment_id": 67760809, "body": "@JohnColeman I just added a SS of the debugger, @.YowE3k the ItemControl (which would be the object itself) is returning as null, hence the Err"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477427752, "post_id": 40248912, "comment_id": 67760868, "body": "Can you show us the code where you are doing the test (returning False) on the returned object."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1477427831, "post_id": 40248912, "comment_id": 67760905, "body": "Mid(ToggleCtrl.Name, 22, 2) is what each time? Is the condition met?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477427835, "post_id": 40248912, "comment_id": 67760908, "body": "@YowE3K It&#39;s the same code that in the approach, I added the SS for where the Error can be seen"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1477427915, "post_id": 40248912, "comment_id": 67760958, "body": "The <code>Null</code> is just saying that the Control&#39;s Value property is Null - it doesn&#39;t mean that the object is Nothing.  So you are returning a valid Control, but that Control hasn&#39;t yet had it&#39;s Value set."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1477427929, "post_id": 40248912, "comment_id": 67760967, "body": "@MacroMarc Yeah, If the ToogleCtrl1 is being analyzed set the ListBox1 so I can anlyze its text; if the ToogleCtrl2 is being analyzed set the ListBox2 and so on"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477428106, "post_id": 40248912, "comment_id": 67761071, "body": "@all Added the Gif to show my debugging process"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477428199, "post_id": 40248912, "comment_id": 67761120, "body": "So your function is showing that it is correctly returning a Control (probably the Control that you want).  (I.e. the very last &quot;hover&quot; before exiting the function shows that the return value has changed from <code>Nothing</code> to be a valid Control.)  Can you show us the code where you are invoking the function, because that is what is causing the error."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477428388, "post_id": 40248912, "comment_id": 67761229, "body": "Maybe the calling code is passing an empty object"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477428516, "post_id": 40248912, "comment_id": 67761298, "body": "@JohnColeman - I suspect that the calling code is just using the returned Control&#39;s <code>Value</code> property, rather than doing something with the Control itself."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477428613, "post_id": 40248912, "comment_id": 67761366, "body": "@.all Added the whole debugging; @YowE3k you&#39;re right, and I know I could change the function to return the text itself but, I rather to return the contorl just for future reference if I need to."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1477428623, "post_id": 40248912, "comment_id": 67761373, "body": "Seeing the animated gifs is not nearly as useful as seeing the actual calling code. The animated gifs are mostly distracting."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477428905, "post_id": 40248912, "comment_id": 67761539, "body": "added the code as text"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477429436, "post_id": 40248912, "comment_id": 67761841, "body": "FWIW - the reason that you couldn&#39;t see the error in the debugger is that, after the Control was returned by the function, it&#39;s <code>Value</code> property was <b>immediately</b> used by the <code>CStr</code> which threw the error.  So you never got a chance in the debugger to look at the returned value <b>after</b> it was returned but before the error was thrown."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477429087, "post_id": 40249547, "comment_id": 67761644, "body": "Looks like you nailed it. Good debugging."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477429518, "post_id": 40249547, "comment_id": 67761894, "body": "@JohnColeman - I wish some of my own bugs were that easy to find!"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477429883, "post_id": 40249547, "comment_id": 67762093, "body": "Yes this is the approach I was thinking about of using if I could not set it as control, however, I rather to have it as control and then play with the properties as needed -today is a text tomorrow could be the height, etc-."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477430029, "post_id": 40249547, "comment_id": 67762172, "body": "@Sgdva - see edit.  (With the &quot;Control&quot; version of the answer, you can leave <code>TxtControl</code> as type <code>String</code>, as it won&#39;t need to be able to hold the <code>Null</code> - it will always be set to a valid <code>String</code> so you won&#39;t need to declare it as a <code>Variant</code>.)"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1477430402, "post_id": 40249547, "comment_id": 67762364, "body": "This lead me to the real solution, I saw my problem, dah long day I guess."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1477430015, "last_edit_date": 1477430015, "creation_date": 1477428983, "answer_id": 40249547, "question_id": 40248912, "link": "https://stackoverflow.com/questions/40248912/get-function-result-as-control/40249547#40249547", "title": "Get Function() result as Control", "body": "<p>Your error is occurring on your line which says</p>\n\n<pre><code>TxtControl = CStr(RelateControl_ToggleVsList(ItemControl).Value)\n</code></pre>\n\n<p>because the returned Control's <code>Value</code> property is currently <code>Null</code> which can't be cast to a String.</p>\n\n<hr>\n\n<p>I recommend that you change <code>TxtControl</code> to be a <code>Variant</code> type, then say</p>\n\n<pre><code>TxtControl = RelateControl_ToggleVsList(ItemControl).Value\nIf IsNull(TxtControl) Then\n    TxtControl = \"\"\nElse\n    TxtControl = CStr(TxtControl)\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Or you could define a Control object and then use it:</p>\n\n<pre><code>Dim MyControl As Control\nMyControl = RelateControl_ToggleVsList(ItemControl)\nIf IsNull(MyControl.Value) Then\n    TxtControl = \"\"\nElse\n    TxtControl = CStr(MyControl.Value)\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477431191, "post_id": 40249960, "comment_id": 67762763, "body": "ListBoxes do have a Value property - it is the value of the currently selected item.  (So if the 5th item is selected, it is equivalent to <code>.List(4)</code>.)"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1477431413, "post_id": 40249960, "comment_id": 67762886, "body": "Yes it does, however, it was not used as intended and hence the error (I wanted to compare the text of it as stated in the background <i>b) If the ListBox1.Value has &quot;mytext&quot; then I have to relate it with ToggleButton1</i>) that&#39;s where my problem was, I was using the wrong property for this matter."}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 0, "last_activity_date": 1477431659, "last_edit_date": 1477431659, "creation_date": 1477430626, "answer_id": 40249960, "question_id": 40248912, "link": "https://stackoverflow.com/questions/40248912/get-function-result-as-control/40249960#40249960", "title": "Get Function() result as Control", "body": "<p><strong><em>Solution:</em></strong>\n<br>The object itself is calling a property which does not belong to it (as intended).\n<br><a href=\"https://msdn.microsoft.com/en-us/library/office/ff862699.aspx\" rel=\"nofollow\">ListBox Properties</a> does not show \"Value\" as its text, the real thing should have called it as:</p>\n\n<pre><code>TxtControl = CStr(RelateControl_ToggleVsList(ItemControl).List(0))CStr(RelateControl_ToggleVsList(ItemControl).List(0))\n</code></pre>\n\n<p><strong><em>Furthermore:</em></strong>\n<br>Thanks to the solutions provided and the debugging process, I could notice even the object is Set in the function, it is shown as the \"value\" property of it while debugging.</p>\n"}], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40249960, "answer_count": 2, "score": 0, "last_activity_date": 1477431659, "creation_date": 1477426397, "last_edit_date": 1531161705, "question_id": 40248912, "link": "https://stackoverflow.com/questions/40248912/get-function-result-as-control", "title": "Get Function() result as Control", "body": "<p><strong><em>Background:</em></strong>\n<br>I needed a function to correlate Controls efficiently based on a STD name and the text analyzed. IG:\n<br> <strong>a)</strong> Some other input throws the variable \"mytext\"\n<br> <strong>b)</strong> If the ListBox1.Value has \"mytext\" then I have to relate it with ToggleButton1\n<br><strong>Approach:</strong>\n<br>I made the following function which <strong><em>partially</em></strong> works\n<br>Code:</p>\n\n<pre><code>Private Function RelateControl_ToggleVsList(ToggleCtrl As Control) As Control\nDim ItemControl As Control\nDim myControl As Object\n    For Each ItemControl In Me.Controls\n    If TypeName(ItemControl) = \"ListBox\" Then ' 1. If TypeName(ItemControl) = \"Label\"\n    'text lenghts const 13 for ListBox_TimeXX and 22 for ToggleButton_PriorityXX\n    If Mid(ItemControl.Name, 13, 2) = Mid(ToggleCtrl.Name, 22, 2) Then Set RelateControl_ToggleVsList = ItemControl: Exit Function\n    End If ' 1. If TypeName(ItemControl) = \"Label\"\n    Next ItemControl\nEnd Function\n</code></pre>\n\n<p><strong><em>Problem:</em></strong>\n<br>I get a null property when Setting the result:</p>\n\n<pre><code>Set RelateControl_ToggleVsList = ItemControl 'This is nullSet \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FfXJ3.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/FfXJ3.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Debugging process:</em></strong>\n<a href=\"https://i.stack.imgur.com/cVqlg.gif\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/cVqlg.gif\" alt=\"enter image description here\"></a>\n<strong><em>Question:</em></strong>\n<br> How can I set a Control as a result of this function? </p>\n\n<p><strong><em>EDIT:</em></strong>\n<br> Per request I add the whole Debugging in order to see where it is being called form\n<br>Calling Code </p>\n\n<pre><code>Private Sub ToggleButtons_Active()\nDim ItemControl As Control\nDim ItemTextBox As Variant\nDim TxtControl As String\n    For Each ItemControl In Me.Controls\n    If TypeName(ItemControl) = \"ToggleButton\" Then ' 1. If TypeName(ItemControl) = \"ToggleButton\"\n    TxtControl = CStr(RelateControl_ToggleVsList(ItemControl).Value)\n    If InStr(TextBox_Notes.Value, TxtControl) &gt; 0 And TxtControl &lt;&gt; \"\" Then ItemControl.Value = True\n    End If ' 1. If TypeName(ItemControl) = \"ToggleButton\"\n    Next ItemControl\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hIWRC.gif\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/hIWRC.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "edited": false, "score": 0, "creation_date": 1477429500, "post_id": 40249083, "comment_id": 67761881, "body": "I had to change the 800 to 1582, but other than that it&#39;s spot on."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "edited": false, "score": 0, "creation_date": 1477432906, "post_id": 40249083, "comment_id": 67763575, "body": "Lol...my break was over.  I never had a chance to review it.  Thanks for accepting my answer."}, {"owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "edited": false, "score": 0, "creation_date": 1477506222, "post_id": 40249083, "comment_id": 67799119, "body": "Is there a way to alter the code so that it only moves a row in the range if it doesn&#39;t contain a zero? So, in the link titled &quot;first range to be copied&quot; in my original post above, all the rows in XG that had zeros wouldn&#39;t be transferred, and only the ones with data would be transferred. Right now, I&#39;m using your macro to move the range to &quot;Maps&quot;, and then trying to use another macro to delete all the rows with zeros, but with almost 300,000 rows to check, that macro freezes my computer."}, {"owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "edited": false, "score": 0, "creation_date": 1477506477, "post_id": 40249083, "comment_id": 67799275, "body": "However, if it&#39;s easier to move the data and then use another macro to delete the zeros, and you know a way to make the macro to delete the zeros run faster, I posted that question <a href=\"http://stackoverflow.com/questions/40267639/i-need-a-faster-excel-vba-macro-that-deletes-every-row-with-a-0-in-column-a?noredirect=1#comment67797423_402676390\">here</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1477432870, "last_edit_date": 1477432870, "creation_date": 1477427111, "answer_id": 40249083, "question_id": 40248504, "link": "https://stackoverflow.com/questions/40248504/using-macro-to-copy-multiple-ranges-from-one-sheet-and-paste-them-into-another/40249083#40249083", "title": "Using macro to copy multiple ranges from one sheet, and paste them into another sheet in the first empty row", "body": "<p>Unless you want to preserve the formmating; it's better to assign the values directly.</p>\n\n<pre><code>Sub CPR_to_Calculator()\n    Dim y As Long\n\n    With Worksheets(\"CPR Test 2013-2015\")\n        For y = 631 To 1582 Step 9\n\n           Worksheets(\"Maps\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(2699, 3).Value = .Cells(2, y).Resize(2699, 3).Value\n\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7071338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fe98594e4cacfbc412f46c8ffc45f?s=128&d=identicon&r=PG&f=1", "display_name": "mjcox13", "link": "https://stackoverflow.com/users/7071338/mjcox13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 40249083, "answer_count": 1, "score": 0, "last_activity_date": 1477432870, "creation_date": 1477424918, "question_id": 40248504, "link": "https://stackoverflow.com/questions/40248504/using-macro-to-copy-multiple-ranges-from-one-sheet-and-paste-them-into-another", "title": "Using macro to copy multiple ranges from one sheet, and paste them into another sheet in the first empty row", "body": "<p>I have to copy hundreds of 2700 row x 3 column ranges, and then paste them into another sheet in the first empty row, (so the first range copied from sheet \"CPR Test 2013-2015\" will be pasted into row 1 on the sheet \"Maps\", the second range will be pasted into row 2701 in \"Maps\", the third range will be pasted into row 5402 in \"Maps\", etc.). If it helps to know why I'm doing this, I've included the explanation at the bottom. If not, I'll continue the nuts and bolts of the problem here:</p>\n\n<p>Each range that needs to be copied is separated from the next range by 6 columns. So, for example, the first range is (XG2:XI2700), six columns later we have the second range (XP2:XR2700), and the last range is (BHP2:BHR2700).*</p>\n\n<p>*Note: XG is column 631, XI is column 633; XP is column 640, XR is column 642; BHP is column 1576, BHR is column 1578.</p>\n\n<p>When pasting the ranges into the sheet \"Maps\", it would be nice to be able to paste them in the first empty row, since the number of rows in the ranges will vary in the future. If this can't be done, pasting the ranges every 2700 rows into \"Maps\" will work for now.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LUTED.png\" rel=\"nofollow\">First range to be copied</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/wVpUQ.png\" rel=\"nofollow\">Pasting the first range in \"Maps\"</a></p>\n\n<p>Here is some code i've tried in the VBA editor (bear with me, I'm a beginner):</p>\n\n<pre><code>Sub CPR_to_Calculator()\n'\n' CPR_to_Calculator Macro\n'\n\n'\nApplication.ScreenUpdating = False\nSheets(\"CPR Test 2013-2015\").Select\n    For ColNum = 631 To 1578 Step 7\n        Sheets(\"CPR Test 2013-2015\").Select\n        Range(Cells(2, ColNum), Cells(2700, ColNum + 2)).Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"Maps\").Select\n        Selection.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial     xlPasteValues\n            Application.CutCopyMode = False\n            Application.ScreenUpdating = True\n    Next ColNum\n\nEnd Sub\n</code></pre>\n\n<p><strong>Why I'm doing this:</strong> I'm calculating the distance between students and universities in the sheet \"Maps\" using data from the sheet \"CPR 2013-2015\". The sheet \"Maps\" is already set up to calculate the distance between zip codes with the push of a button. </p>\n\n<p>The three columns in each range in \"CPR Test 2013-2015\" are ID, Student Zip Code, and School Zip Code. I need to calculate the distance between the Student Zip Codes and the School Zip codes in the sheet \"Maps\". Since each range pertains to a specific university, and there are hundreds of universities in the data set, I don't want to calculate the distances between the student and school zip codes for one university at a time. I would rather copy the ranges for all the universities, and paste them into the \"Maps\" sheet stacked on top of each other. This way, I can just click the <strong>calculate</strong> button in \"Maps\", and it will calculate the distance between the zip codes in each row. I can then use INDEX MATCH formulas in \"CPR Test 2013-2015\" to pull the distance data for each unique ID. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477424508, "post_id": 40248314, "comment_id": 67759030, "body": "You only want the column in A, B and C, even though you copy columns A to IV of each workbook?"}, {"owner": {"reputation": 1772, "user_id": 4150078, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VvMca.png?s=128&g=1", "display_name": "sharp", "link": "https://stackoverflow.com/users/4150078/sharp"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477424614, "post_id": 40248314, "comment_id": 67759099, "body": "@Kyle Yes, just want column A1, B1, and C1. I just changed the code range to A2:C"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1477424862, "post_id": 40248314, "comment_id": 67759253, "body": "Ummmm... <code>Range(&quot;A1&quot;).Value = &quot;customerid&quot;</code>, etc?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1477424908, "post_id": 40248314, "comment_id": 67759271, "body": "@Comintern that made me laugh +1 - sharp - Macro recorder is your best friend!"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477424947, "post_id": 40248314, "comment_id": 67759287, "body": "<code>Thisworkbook.Worksheets(1).Range(&quot;a1:c1&quot;) = bookList.Worksheets(&quot;Sheet name or index&quot;).Range(&quot;a1:c1&quot;)</code>"}, {"owner": {"reputation": 1772, "user_id": 4150078, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VvMca.png?s=128&g=1", "display_name": "sharp", "link": "https://stackoverflow.com/users/4150078/sharp"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477425100, "post_id": 40248314, "comment_id": 67759386, "body": "@Kyle Thanks it works. New to VBA"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1477425103, "post_id": 40248314, "comment_id": 67759389, "body": "One more for the pot: <code>.cells(1, 1).resize(1, 3) = array(&quot;customerid&quot;, &quot;date&quot;, &quot;prediction&quot;)</code>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1477425255, "post_id": 40248314, "comment_id": 67759499, "body": "@sharp Glad I could help. We&#39;ve all been there before."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1477425411, "creation_date": 1477425411, "answer_id": 40248631, "question_id": 40248314, "link": "https://stackoverflow.com/questions/40248314/vba-excel-column-header/40248631#40248631", "title": "VBA excel column header", "body": "<p>Consider:</p>\n\n<pre><code>Sub whatever()\n    Range(\"A1:C1\").Value = Array(\"customerid\", \"date\", \"prediction\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1772, "user_id": 4150078, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VvMca.png?s=128&g=1", "display_name": "sharp", "link": "https://stackoverflow.com/users/4150078/sharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477425411, "creation_date": 1477424324, "last_edit_date": 1477424581, "question_id": 40248314, "link": "https://stackoverflow.com/questions/40248314/vba-excel-column-header", "title": "VBA excel column header", "body": "<p>I have ton of excel files that I am merging into 1 excel file and I need to put the column name or header on the first row. I have 3 columns: customerid, date, prediction. How do I put the column name on cell A1, B1, and C1 in VBA code? Thanks. </p>\n\n<pre><code>Sub simpleXlsMerger()\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n'change folder path of excel files here\nSet dirObj = mergeObj.Getfolder(\"directory\\path\")\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\n'change \"A2\" with cell reference of start point for every files here\n'for example \"B3:IV\" to merge all files start from columns B and rows 3\n'If you're files using more than IV column, change it to the latest column\n'Also change \"A\" column on \"A65536\" to the same column as start point\nRange(\"A2:C\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\nThisWorkbook.Worksheets(1).Activate\n\n'Do not change the following column. It's not the same column as above\nRange(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\nApplication.CutCopyMode = False\nbookList.Close\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1477423463, "post_id": 40248077, "comment_id": 67758400, "body": "Please post the code you have in the Original Post using edit, and explain what you have tried."}, {"owner": {"reputation": 23, "user_id": 7071497, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10207055246152865/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/7071497/nick"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1477423711, "post_id": 40248077, "comment_id": 67758571, "body": "I don&#39;t have any code that relates to what I am trying to do. I am very new to coding, so I don&#39;t really know where to begin with this situation, and have been researching on how to do it for hours."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6281751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08419a4909399708a92c36a7f4c96060?s=128&d=identicon&r=PG&f=1", "display_name": "Markos", "link": "https://stackoverflow.com/users/6281751/markos"}, "is_accepted": false, "score": 0, "last_activity_date": 1477425203, "creation_date": 1477425203, "answer_id": 40248577, "question_id": 40248077, "link": "https://stackoverflow.com/questions/40248077/how-to-format-cells-that-change-every-week/40248577#40248577", "title": "How to Format cells that change every week", "body": "<p>check the below code, especially if .usedrange property works for you.</p>\n\n<pre><code>sub formatBorder()\n\ndim rng as range\ndim wks as worksheet\n\nset wks = thisworkbook.worksheets(\"Sheet1\") 'change sheet name if required\nset rng = intersect(wks.usedrange,wks.range(\"B:L\")) \n\nif rng is nothing then goto terminate\n\nWith rng.Borders\n  .LineStyle = xlContinuous  \n  .Color = vbRed\n  .Weight = xlThin\nEnd With\n\nterminate:\nset wks = nothing\nset rng = nothing\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7071497, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10207055246152865/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/7071497/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1477425203, "creation_date": 1477423397, "question_id": 40248077, "link": "https://stackoverflow.com/questions/40248077/how-to-format-cells-that-change-every-week", "title": "How to Format cells that change every week", "body": "<p>I have a code that searches my spreadsheet for an \"x\" in column L, and if it does, it copies the entire row and pastes it into a new sheet. This continues until there are no more \"x\" in the column.</p>\n\n<p>What I want to do is have the macro also put the \"All Border\" border in these cells. The problem I am running into is that one week the new tab will have 3 rows of data and another week it could have 23. </p>\n\n<p>How can I make it so that it only formats the cells that have data. (In my case, it will always be columns B:L that I need formatted, but the rows will vary).</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1477423513, "post_id": 40248031, "comment_id": 67758444, "body": "What are you trying to do here, and why are you using the <code>Selection.End(xlToRight).Select</code> repeatedly?  Also, while you&#39;re assigning the value to <code>impu</code> variable, you never output that value to the worksheet, such as <code>Range(&quot;A1&quot;).Value = impu</code> ."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1477423546, "post_id": 40248031, "comment_id": 67758461, "body": "(See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code>/<code>.Activate</code></a> to cut down on a lot of your code.)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1477423588, "post_id": 40248031, "comment_id": 67758483, "body": "In other words, the very last thing you&#39;re doing in this code is merely <b>storing</b> the value from <code>InputBox</code> into a <b>variable</b>. And the next line is your <code>End With</code> and then <code>End Sub</code>. Nothing happens to the value that you&#39;ve stored, you do nothing with it, it&#39;s just there in memory."}, {"owner": {"reputation": 1, "user_id": 7016047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c7b286342fed2623659d5bb33d8998?s=128&d=identicon&r=PG&f=1", "display_name": "deejaay", "link": "https://stackoverflow.com/users/7016047/deejaay"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1477423665, "post_id": 40248031, "comment_id": 67758545, "body": "@DavidZemens There are blank cells inbetween my colomns and the ctrl+arrow doen&#39;t skip them so I have added it enough times to get me to the point in my sheet where the new data can be entered.  This code will read e2, and find it in my range j8:j17, move the correct spot and then input box will appear once the cell has been selected, and enter the value that was entered in the input box."}, {"owner": {"reputation": 1, "user_id": 7016047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c7b286342fed2623659d5bb33d8998?s=128&d=identicon&r=PG&f=1", "display_name": "deejaay", "link": "https://stackoverflow.com/users/7016047/deejaay"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1477423825, "post_id": 40248031, "comment_id": 67758636, "body": "@DavidZemens what can I do to have this entered in the sheet and not in memory?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1477423993, "post_id": 40248031, "comment_id": 67758725, "body": "deejaay, @DavidZemens answered this question already. To store the value on the sheet you should insert <code>Range(&quot;A1&quot;).Value = impu</code> after the line <code>impu = InputBox(&quot;Enter New Bottom Pipe Serial Number&quot;, &quot;New Pipe&quot;, 1)</code>. This will output the value from the input box into cell <code>A1</code>. If you want it somewhere else on the sheet then you&#39;ll have to change that. If you want it in another sheet (than the currently active sheet) then you&#39;ll also have to change this line of code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1477424179, "post_id": 40248031, "comment_id": 67758840, "body": "I doubt very much that will reliably find the correct cell for input, but without seeing your worksheet I can&#39;t be certain. If you could explain more about where the data will be going (i.e., is it always in the same column, etc.) then there is about a 99.99% chance that there is a better, more reliable, more concise way to get that output where you want it :)"}, {"owner": {"reputation": 1, "user_id": 7016047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c7b286342fed2623659d5bb33d8998?s=128&d=identicon&r=PG&f=1", "display_name": "deejaay", "link": "https://stackoverflow.com/users/7016047/deejaay"}, "edited": false, "score": 0, "creation_date": 1477425245, "post_id": 40248031, "comment_id": 67759489, "body": "adding         &#39;Range(&quot;A1&quot;).Value = impu&#39;  does not display any value, it continues appearing blank"}, {"owner": {"reputation": 51, "user_id": 6281751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08419a4909399708a92c36a7f4c96060?s=128&d=identicon&r=PG&f=1", "display_name": "Markos", "link": "https://stackoverflow.com/users/6281751/markos"}, "edited": false, "score": 0, "creation_date": 1477426350, "post_id": 40248031, "comment_id": 67760111, "body": "post your code with &#39;Range(&quot;A1&quot;).Value = impu&#39; added"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7016047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c7b286342fed2623659d5bb33d8998?s=128&d=identicon&r=PG&f=1", "display_name": "deejaay", "link": "https://stackoverflow.com/users/7016047/deejaay"}, "is_accepted": false, "score": 0, "last_activity_date": 1477426923, "creation_date": 1477426923, "answer_id": 40249027, "question_id": 40248031, "link": "https://stackoverflow.com/questions/40248031/vba-inputbox-error/40249027#40249027", "title": "VBA InputBox Error", "body": "<p>The following is still leaving a blank cell after number is added in input box.<br>\n    Sub DiscardPipe()\n        Dim str As String\n        Dim rtrn As String\n        Dim impu As Integer</p>\n\n<pre><code>       With Worksheets(ActiveSheet.Name)\n       rtrn = ActiveSheet.Name\n        str = Range(\"e2\").Value\n        End With\n    Set SrchRng = Worksheets(\"Information\").Range(\"J8:J17\").Find(what:=str)\n     Sheets(\"information\").Select\n     Range(\"J8:J17\").Find(what:=str).Select\n     Selection.End(xlToRight).Select\n       Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToLeft).Select\n        ActiveCell.Offset(0, 1).Range(\"A1\").Select\n        impu = InputBox(\"Enter New Bottom Pipe Serial Number\", \"New Pipe\", 8)\n        Range(\"A1\").Value = impu\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7016047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c7b286342fed2623659d5bb33d8998?s=128&d=identicon&r=PG&f=1", "display_name": "deejaay", "link": "https://stackoverflow.com/users/7016047/deejaay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477426923, "creation_date": 1477423224, "question_id": 40248031, "link": "https://stackoverflow.com/questions/40248031/vba-inputbox-error", "title": "VBA InputBox Error", "body": "<p>I am trying to have my inputbox dump a number into a specific cell. I have gotten this to work as far as prompting the box on the correct cell, however when I hit enter or click ok the cell remains blank.\nDoes anyone have any idea how to fix?</p>\n\n<p>Thanks!!</p>\n\n<pre><code>    Sub DiscardPipe()        \n    Dim str As String\n    Dim rtrn As String\n    Dim impu As Integer\n       With Worksheets(ActiveSheet.Name)\n       rtrn = ActiveSheet.Name\n       str = Range(\"e2\").Value\n\n    Set SrchRng = Worksheets(\"Information\").Range(\"J8:J17\").Find(what:=str)\n     Sheets(\"information\").Select\n     Range(\"J8:J17\").Find(what:=str).Select\n     Selection.End(xlToRight).Select\n       Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToRight).Select\n        Selection.End(xlToLeft).Select\n        ActiveCell.Offset(0, 1).Range(\"A1\").Select\n      impu = InputBox(\"Enter New Bottom Pipe Serial Number\", \"New Pipe\", 1)\n\n        End With\n    End Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "ip"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 10, "creation_date": 1477421625, "post_id": 40247533, "comment_id": 67757416, "body": "exactly how do you plan to tell between <code>101.82.223.123</code> and <code>10.182.223.123</code>? Garbage in, garbage out - your inputs are corrupted. Don&#39;t try to &quot;correct&quot; the garbage. Fix whatever produced the garbage in the first place"}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1477422309, "creation_date": 1477422309, "answer_id": 40247773, "question_id": 40247533, "link": "https://stackoverflow.com/questions/40247533/how-can-i-change-10182223123-to-10-182-223-123-ip-in-vba/40247773#40247773", "title": "How can I change 10182223123 to 10.182.223.123 (IP) in VBA?", "body": "<p>As @MarcB points out, you can't distinguish between IPs that have parts with leading 0's, but if you assume the only dropped-zeros are at the start of the string, then you can use this:</p>\n\n<pre><code>Sub test1()\n\n  Const IP As String = \"10182223123\"\n\n  Dim result As String\n\n  result = Format$(IP, \"##0\\.000\\.000\\.000\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1477422322, "creation_date": 1477422322, "answer_id": 40247775, "question_id": 40247533, "link": "https://stackoverflow.com/questions/40247533/how-can-i-change-10182223123-to-10-182-223-123-ip-in-vba/40247775#40247775", "title": "How can I change 10182223123 to 10.182.223.123 (IP) in VBA?", "body": "<p>If you know that the address are all for a private network, and therefore start with <code>10</code>, and the remaining parts have been encoded with leading zeroes (i.e. a sample address might be <code>10056123047</code>) - therefore ensuring that all source strings are 11 characters long - then the following code might work</p>\n\n<pre><code>s = \"10056123047\"\nr = Mid(s, 1, 2) &amp; \".\" &amp; Mid(s, 3, 3) &amp; \".\" &amp; Mid(s, 6, 3) &amp; \".\" &amp; Mid(s, 9, 3)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7071364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb010636066e1a9224da5389074e3c10?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Azevedo", "link": "https://stackoverflow.com/users/7071364/ricardo-azevedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477422322, "creation_date": 1477421522, "last_edit_date": 1531164843, "question_id": 40247533, "link": "https://stackoverflow.com/questions/40247533/how-can-i-change-10182223123-to-10-182-223-123-ip-in-vba", "title": "How can I change 10182223123 to 10.182.223.123 (IP) in VBA?", "body": "<p>I trying to do a macro in VBA but I'm having an issue because some IP addresses came without dots and I need to put the dots in the right place independent of the IP.</p>\n\n<p>For example:\n10182223123 -> 10.182.223.123</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "circular-reference"], "comments": [{"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1477421143, "post_id": 40247344, "comment_id": 67757146, "body": "I would declare more variables and not reuse them for different types of data.  It will make your code clearer and may help you uncover simple errors.  Put <code>option explicit</code> at the top of you VBA file to enforce some of these behaviors.  You use <code>columnName</code> to hold both a range reference (from <code>Intersect</code>) and then to hold a range address (a string).  This may be creating a string you do not expect."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1477421590, "creation_date": 1477421590, "answer_id": 40247555, "question_id": 40247344, "link": "https://stackoverflow.com/questions/40247344/circular-reference-is-user-defined-function-vba-excel/40247555#40247555", "title": "Circular reference is user defined function VBA excel", "body": "<p><code>myRowRange</code> is not explicitly declared (or used, actually) so it is implicitly a <code>Variant</code>.  That means your assignment here...</p>\n\n<pre><code>myRowRange = Range(rowName)\n</code></pre>\n\n<p>...is also making an implicit call to <code>.Value</code>.  That call will evaluate the results of every single cell in <code>Range(rowName)</code> to populate the array of <code>Variant</code> that it returns.  If <em>any</em> of those cells contains a call to <code>SumColumnsWithSuffix</code>, you'll get a circular reference.</p>\n"}], "owner": {"reputation": 574, "user_id": 5852947, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-rciSzjXYSt8/AAAAAAAAAAI/AAAAAAAAALU/LNSOED-dDyY/photo.jpg?sz=128", "display_name": "Istvan Heckl", "link": "https://stackoverflow.com/users/5852947/istvan-heckl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477421590, "creation_date": 1477420808, "question_id": 40247344, "link": "https://stackoverflow.com/questions/40247344/circular-reference-is-user-defined-function-vba-excel", "title": "Circular reference is user defined function VBA excel", "body": "<p>My aim is to add the values of certain columns using a user defined function in the actual row. The columns are given in another table. I am reading the name of rows, calculating the actual value and sum them. This function called once from excel but executed 4 times. At the end it indicates a circular reference error. There is no such error in the excel file, I checked if the udf return just 42 then there is no error. First I suspected Application.Caller, but ruled out.</p>\n\n<pre><code>Function SumColumnsWithSuffix(suffix As String, rowNumber) As Integer\n    'can be used only in \u00d6sszes\u00edto table\n    Dim myTable As Excel.ListObject\n    Dim mySheet As Excel.Worksheet\n    Dim myRow As Excel.ListRow\n\n    Set mySheet = ThisWorkbook.Worksheets(\"\u00f6sszes\u00edto\")\n    Set myTable = mySheet.ListObjects(\"Sz\u00e1ml\u00e1k\")\n    Dim columnName As String\n\n    result = 0\n\n    For Each myRow In myTable.ListRows\n        columnName = Intersect(myRow.Range, myTable.ListColumns(\"Oszlop n\u00e9v\").Range)\n        columnName = \"\u00d6sszes\u00edto[\" &amp; columnName &amp; \" \" &amp; suffix &amp; \"]\"\n        'actualRow = Application.Caller.row\n        'rowName = actualRow &amp; \":\" &amp; actualRow\n         rowName = rowNumber &amp; \":\" &amp; rowNumber\n         myRowRange = Range(rowName)\n         actualValue = Intersect(Range(columnName), Range(rowName))\n         result = result + actualValue\n     Next myRow\n\n    SumColumnsWithSuffix = result\nEnd Function\n</code></pre>\n"}]