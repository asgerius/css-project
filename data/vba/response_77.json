[{"tags": ["excel", "vba", "types", "mismatch"], "comments": [{"owner": {"reputation": 4134, "user_id": 3594588, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/3bdbd93bbb9a84d9635d498d9a50e08b?s=128&d=identicon&r=PG&f=1", "display_name": "bugsyb", "link": "https://stackoverflow.com/users/3594588/bugsyb"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1467243702, "post_id": 38111693, "comment_id": 63657142, "body": "Oh I See. Is there something similar to columns that allows me to pass in numbers?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467245615, "post_id": 38111693, "comment_id": 63657639, "body": "<code>Range(Columns(currentColumn),Columns(currentColumn+1)).Selec&zwnj;&#8203;t</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1467270716, "last_edit_date": 1495540728, "creation_date": 1467270716, "answer_id": 38116229, "question_id": 38111693, "link": "https://stackoverflow.com/questions/38111693/type-mismatch-when-selecting-column-with-a-formula-vbaexcel/38116229#38116229", "title": "Type Mismatch when Selecting Column with a formula VBA(Excel)", "body": "<p>To elaborate on Scott's suggestion:</p>\n\n<p>The problem is not only that <code>Columns</code> doesn't accept inputs like <code>\"2:3\"</code> (<code>Rows</code> would work with that but for <code>Columns</code> you'd need <code>\"B:C\"</code>). The problem is also that <code>\"currentColumn:(currentColumn+1)\"</code> is a string consisting of exactly these characters. The variable <code>currentColumn\"</code> isn't replaced and the addition <code>+1</code> isn't executed either. If you want to build a string with the number currentColumn and not the string <code>\"currentColumn</code> you need to use <code>&amp;</code>:</p>\n\n<pre><code>currentColumn &amp; \":\" &amp; currentColumn + 1 'if currentColumn = 2 then this is the same as \"2:3\"\n</code></pre>\n\n<hr>\n\n<p>note that you usually don't need to <code>Select</code> objects. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Here</a> are some examples on how to avoid it.</p>\n"}], "owner": {"reputation": 4134, "user_id": 3594588, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/3bdbd93bbb9a84d9635d498d9a50e08b?s=128&d=identicon&r=PG&f=1", "display_name": "bugsyb", "link": "https://stackoverflow.com/users/3594588/bugsyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467270716, "creation_date": 1467242938, "question_id": 38111693, "link": "https://stackoverflow.com/questions/38111693/type-mismatch-when-selecting-column-with-a-formula-vbaexcel", "title": "Type Mismatch when Selecting Column with a formula VBA(Excel)", "body": "<p>The following is a code section that I have in my VBA program:</p>\n\n<pre><code>Columns(\"currentColumn:(currentColumn+1)\").Select\n</code></pre>\n\n<p>For some reason I have a type mismatch when I run this. currentColumn is an Integer. This is my first time using VBA so I'm sure I'm missing something. I was wondering if someone could point me towards the right track.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "excel", "vsto", "excel-addins", "vba"], "owner": {"reputation": 17, "user_id": 5336608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1krOL9OYR08/AAAAAAAAAAI/AAAAAAAAAAA/5daO4gJlhDM/photo.jpg?sz=128", "display_name": "Vishal Agarwal", "link": "https://stackoverflow.com/users/5336608/vishal-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1467239005, "creation_date": 1467239005, "last_edit_date": 1531161705, "question_id": 38111032, "link": "https://stackoverflow.com/questions/38111032/how-to-get-openxml-of-cells-and-objects-like-charts-shapes-and-pictures-in-exc", "title": "How to get openxml of cells and objects (like charts,shapes and pictures) in excel VSTO?", "body": "<p>The way we can extract openxml for shapes and pictures from Word document using VSTO, i want to do the same for excel. I tried looping through the custom xml parts but no luck.</p>\n\n<pre><code>Excel.Workbook doc = Globals.ThisAddIn.Application.ActiveWorkbook;\n        foreach (Microsoft.Office.Core.CustomXMLPart p in doc.CustomXMLParts)\n        {\n            string bn = p.DocumentElement.BaseName;\n            string cxml = p.XML;\n        }\n</code></pre>\n\n<p>Code for Word works like this. ctrl is a bookmark and GetInnerRange returns the range of that bookmark.</p>\n\n<pre><code>Word.Range inner = GetInnerRange(ctrl);\n            string xml = inner.WordOpenXML;\n</code></pre>\n"}, {"tags": ["regex", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1467238516, "post_id": 38110831, "comment_id": 63655407, "body": "Interesting. I think I&#39;d go with <code>(Order)\\s(\\d+)</code> to make the whitespace explicit... and because I like groups. Nice answer, taught me something =)"}], "tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": false, "score": 2, "last_activity_date": 1467237903, "creation_date": 1467237903, "answer_id": 38110831, "question_id": 38110699, "link": "https://stackoverflow.com/questions/38110699/insert-link-based-on-number-in-string/38110831#38110831", "title": "Insert link based on number in string", "body": "<p>Without a <a href=\"https://msdn.microsoft.com/en-us/library/kstkz771%28v=vs.84%29.aspx#Anchor_1\" rel=\"nofollow\">capturing group</a> in your regular expression there's nothing to <a href=\"https://msdn.microsoft.com/en-us/library/fzhdcs5c%28v=vs.84%29.aspx\" rel=\"nofollow\">back-reference</a> to.</p>\n\n<p>Change this:</p>\n\n<pre><code>strPattern = \"Order \\d+\"\n</code></pre>\n\n<p>into this:</p>\n\n<pre><code>strPattern = \"Order (\\d+)\"\n</code></pre>\n\n<p>and the problem will disappear.</p>\n"}], "owner": {"reputation": 460, "user_id": 295408, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4316c44533286826a8683df0c3965f85?s=128&d=identicon&r=PG&f=1", "display_name": "Lexo", "link": "https://stackoverflow.com/users/295408/lexo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609948860, "creation_date": 1467237226, "last_edit_date": 1609948860, "question_id": 38110699, "link": "https://stackoverflow.com/questions/38110699/insert-link-based-on-number-in-string", "title": "Insert link based on number in string", "body": "<p>I'm trying add links to emails. A typical email would look something like this:</p>\n<blockquote>\n<p>Hello, I noticed that Order 12345 seems to be incomplete. Specifically, how many widgets were you looking to purchase? Please update Order 12345 with the correct widget quantity. Thank you.</p>\n</blockquote>\n<p>Anywhere &quot;Order 12345&quot; appears, I want to insert a link to <a href=\"http://something.com/order.html?o=12345\" rel=\"nofollow noreferrer\">http://something.com/order.html?o=12345</a>.<br />\nThe email format may change, and the order number may change. I want any instance of &quot;Order&quot; followed by any number to be linked to the appropriate order page on the website.</p>\n<p>RegEx seems like the obvious answer. I enabled the Microsoft VBScript Regular Expressions 5.5 library in my project, and wrote the following code based on <a href=\"https://msdn.microsoft.com/en-us/library/k9z80300(v=vs.84).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/k9z80300(v=vs.84).aspx</a>:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Add_Order_Links()\n    Dim miMessage As Outlook.MailItem\n    Dim rgx As New RegExp\n    Dim strPattern As String\n    Dim strBody As String\n    Dim strReplace As String\n    \n    strPattern = &quot;Order \\d+&quot;\n    strReplace = &quot;&lt;a href='http://something.com/order.html\\?o=$1'&gt;Order $1&lt;/a&gt;&quot;\n    \n    Set miMessage = Application.ActiveInspector.CurrentItem\n    If miMessage Is Nothing Then Exit Sub\n    strBody = miMessage.HTMLBody\n    rgx.Pattern = strPattern\n    rgx.Global = True\n    rgx.IgnoreCase = True\n    miMessage.HTMLBody = rgx.Replace(strBody, strReplace)\nEnd Sub\n</code></pre>\n<p>The script finds the matching &quot;Order 12345&quot; instances and inserts the links, but instead of &quot;Order 12345&quot; I get &quot;Order $1&quot; and ?o=$1 in the URL.</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467236342, "post_id": 38110417, "comment_id": 63654490, "body": "Real quick note, there&#39;s also a <code>Worksheet_SelectionChange</code> event, which will fire when the cell selected changes.  With <code>Worksheet Change</code>, you are required to actually <i>change</i> a cell&#39;s value (or even just double click, as you noted).  Does that help?"}, {"owner": {"reputation": 149, "user_id": 5306940, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/82fDI.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5306940/alex"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467237833, "post_id": 38110417, "comment_id": 63655116, "body": "@BruceWayne Unfortunately I had tried the SelectionChange first with no luck. I switched it to a Change event to try and fix that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467239180, "post_id": 38110417, "comment_id": 63655656, "body": "<i>The user inputs the activity</i> - base your worksheet change on the cells where the user actually inputs data, then test the values of the ranges you have assigned for each day and if its &gt; then .6666 then create the message. Basically modify the value check outside the sub."}], "owner": {"reputation": 149, "user_id": 5306940, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/82fDI.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5306940/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467236038, "creation_date": 1467236038, "question_id": 38110417, "link": "https://stackoverflow.com/questions/38110417/excel-vba-worksheet-change-code-not-automatically-running", "title": "Excel VBA Worksheet_Change code not automatically running", "body": "<p>I have a program that tracks the hours in a day's activities. The user inputs the activity and the hours scheduled for that day and the program auto-calculates the total number of hours he has used and shows him in a bar graph. If the number of hours goes over 16 for the day's activities, the program warns him that he is using too many hours with a <code>MsgBox</code> and changes the color of the bar to yellow with a <code>Worksheet_Change</code> event. </p>\n\n<p>My issue is the warning only shows up after the user double clicks the total cell(which is auto-calculated) where I want it to happen automatically. </p>\n\n<p>I believe I need to change the <code>Worksheet_Change</code> event to a <code>Worksheet_Calculate</code> event however I cannot seem to get that to work in this circumstance as there are 7 possible places that I need it to watch for (one for each day). Any suggestions on how to accomplish this?</p>\n\n<p><strong>Here is the change event (using a case statement for each day):</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Select Case Target\n        Case Is = Range(\"F16\")\n           Call CheckValues(Target, \"Monday\")\n        Case Is = Range(\"I16\")\n            'Change the color of the bar\n        Case Is = Range(\"L16\")\n            'Change the color of the bar\n        Case Is = Range(\"O16\")\n            'Change the color of the bar\n        Case Is = Range(\"R16\")\n           'Change the color of the bar\n        Case Is = Range(\"U16\")\n           'Change the color of the bar\n        Case Is = Range(\"X16\")\n           'Change the color of the bar\n    End Select\nEnd Sub\n</code></pre>\n\n<p><strong>Here is the module called above (currently functional):</strong></p>\n\n<pre><code>Sub CheckValues(Target As Range, day As String)\n    If Target.value &gt;= 0.6666 Then\n        Worksheets(\"ActivityTracker\").ChartObjects(day &amp; \" Total Hours\").Chart.SeriesCollection(1).Interior.Color = RGB(255, 204, 0)\n        MsgBox (\"Warning: You have exceeded 16 hours on \" &amp; day &amp; vbNewLine &amp; \"Current Time: \" &amp; Target.value * 24)\n    Else\n        Worksheets(\"ActivityTracker\").ChartObjects(day &amp; \" Total Hours\").Chart.SeriesCollection(1).Interior.Color = RGB(0, 102, 204)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Also the total time for each day is calculated on a separate worksheet if that makes any difference. </p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6451445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa39c265777caa4819c4403b39b40a?s=128&d=identicon&r=PG&f=1", "display_name": "Greg A", "link": "https://stackoverflow.com/users/6451445/greg-a"}, "edited": false, "score": 0, "creation_date": 1467235266, "post_id": 38110184, "comment_id": 63654005, "body": "I may have found a way to start the y loop dynamically, by adding a variable in the first if statement to change the start of the y loop <code>for y=p to endrow</code> and then in the if statemtn have it <code>p=p+1</code> when it finds a match."}, {"owner": {"reputation": 1, "user_id": 6451445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa39c265777caa4819c4403b39b40a?s=128&d=identicon&r=PG&f=1", "display_name": "Greg A", "link": "https://stackoverflow.com/users/6451445/greg-a"}, "edited": false, "score": 0, "creation_date": 1467235391, "post_id": 38110184, "comment_id": 63654069, "body": "This took it from taking 20 minutes on my data to about 5. Can anyone help with stopping dynamically? so when it doesn&#39;t find a match for the first time it ends the loop?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467235584, "post_id": 38110184, "comment_id": 63654139, "body": "insert a boolean variable to set to true when it finds the first match, then right before Next statement test for that variable result and Exit Loop if False"}, {"owner": {"reputation": 769, "user_id": 4067588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81ea12f9a566214a93474ce048ddd4fe?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose36", "link": "https://stackoverflow.com/users/4067588/mongoose36"}, "edited": false, "score": 0, "creation_date": 1467251745, "post_id": 38110184, "comment_id": 63658986, "body": "I think the command is <code>Exit for</code>...Also have you considered utilizing a 2 dimensional array to iterate through your data?  It&#39;s much faster than iterating through each cell."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1467276989, "post_id": 38110184, "comment_id": 63668918, "body": "Did you think about using a pivot table? Its not vba, but an easy and efficient way to get your desired results (use idx as row header, date as column header and sumof value as result)"}], "owner": {"reputation": 1, "user_id": 6451445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75aa39c265777caa4819c4403b39b40a?s=128&d=identicon&r=PG&f=1", "display_name": "Greg A", "link": "https://stackoverflow.com/users/6451445/greg-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467234953, "creation_date": 1467234953, "last_edit_date": 1531164843, "question_id": 38110184, "link": "https://stackoverflow.com/questions/38110184/restricting-parameters-of-for-if-loops-dynamically-in-vba", "title": "Restricting parameters of for-if loops dynamically in vba", "body": "<p>So I have a list of data that is set up like this</p>\n\n<pre><code>A B C\nA B D\nF X E\n</code></pre>\n\n<p>Where the first column is the ID number, the second is a date, and the third is a value.\nI am taking this list of data and it gets summarized by the first value but is split based on the date in the second column</p>\n\n<p>So it looks somewhat like this </p>\n\n<pre><code>    B     X\nA  (C+D)\nF         E\n</code></pre>\n\n<p>So data in a certain range of dates shows up as 2 lines in the dataset but in the output it is totaled. What I have works but with a large amount of data takes a very long time.</p>\n\n<pre><code>For x = 5 To lastrow\nws2.Select\nz = Cells(x, 2).Value\nws1.Select\nFor y = 1 To 100\no = 0\nm = 0\nn = 0\nws1.Select\nIf Cells(y, 1).Value = z Then\nm = Cells(y, 8).Value\nn = Cells(y, 4).Value\nEnd If\nws2.Select\nIf n &gt; date1 Then\no = Cells(x, 6).Value\nCells(x, 6).Value = m + o\nEnd If\nIf date1 &gt;= n And n &gt; date2 Then\no = Cells(x, 7).Value\nCells(x, 7).Value = m + o\nEnd If\nIf date2 &gt;= n And n &gt; date3 Then\no = Cells(x, 8).Value\nCells(x, 8).Value = m + o\nEnd If\nIf date3 &gt;= n And n &gt; date4 Then\no = Cells(x, 9).Value\nCells(x, 9).Value = m + o\nEnd If\nIf date4 &gt;= n And n &gt; date5 Then\no = Cells(x, 10).Value\nCells(x, 10).Value = m + o\nEnd If\nIf n &lt;= date5 Then\no = Cells(x, 11).Value\nCells(x, 11).Value = m + o\nEnd If\nNext y\nNext x\n</code></pre>\n\n<p>This is the core of what I have but is there a way to restrict the y loop to start at another number dynamically? the x=5 value is going to be the first so many entries in the y list. the x=6 value will be the next so many and so forth. is there someway to ignore rows that have already been pulled into the output?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467235530, "post_id": 38110165, "comment_id": 63654114, "body": "Which line gives you the error?"}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467235651, "post_id": 38110165, "comment_id": 63654167, "body": "It does not give me a line, does not even give the option to Debug.  <a href=\"http://prntscr.com/bmrx1z\" rel=\"nofollow noreferrer\">prntscr.com/bmrx1z</a>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467235943, "post_id": 38110165, "comment_id": 63654304, "body": "Strange. Have you tried fully qualifying the workbook? So <code>WorkbookName.Worksheets(&quot;Validation&quot;)</code>. If the named range &quot;Projects&quot; exists as you say it does, that is the only thing I can see that may cause an issue."}, {"owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 1, "creation_date": 1467235986, "post_id": 38110165, "comment_id": 63654325, "body": "I think Kyle is saying do this: <code>Set ws1 = ActiveWorkbook.Worksheets(&quot;Validation&quot;)</code>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 0, "creation_date": 1467236017, "post_id": 38110165, "comment_id": 63654334, "body": "Caught me in the middle of my edit @bernie!"}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467236430, "post_id": 38110165, "comment_id": 63654518, "body": "I&#39;ve used your suggestion, yet I get the same. Here&#39;s the full code of the userform, Not sure if because I am using two ranges in two different places effects this? <a href=\"http://pastebin.com/iXxyRRjs\" rel=\"nofollow noreferrer\">pastebin.com/iXxyRRjs</a>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1467236880, "post_id": 38110165, "comment_id": 63654709, "body": "Are you sure they didn&#39;t change? Did you do a copy of the sheet? If so the ranges will be referred to the Draft, hence, they don&#39;t exist as such in this Workbook -only as reference- check in the name manager (Formulas-&gt;Name Manager)"}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1467237015, "post_id": 38110165, "comment_id": 63654772, "body": "@Sgdva Yes, I built the whole thing from scratch, Just the code has been copied over, but I&#39;ve kept the same name ranges and layouts."}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 1, "creation_date": 1467237067, "post_id": 38110165, "comment_id": 63654796, "body": "Off Topic : - I made a common newb mistake on the old draft version, I set a login form, and made a typo on sheet to check and now I&#39;m locked out forever. :D"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1467237120, "post_id": 38110165, "comment_id": 63654814, "body": "Don&#39;t worry typos are a common thing, you may delete the question if so"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467237448, "post_id": 38110653, "comment_id": 63654964, "body": "Odd, while running I get an error message, <a href=\"http://prntscr.com/bmsaz4\" rel=\"nofollow noreferrer\">prntscr.com/bmsaz4</a> I have also checked named ranges  <a href=\"http://prnt.sc/bmsahb\" rel=\"nofollow noreferrer\">prnt.sc/bmsahb</a> Sorry if I&#39;m just missing something, my mind is boggled."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467237879, "post_id": 38110653, "comment_id": 63655136, "body": "Apparently, the carriage return caused a mild hick-up. So I removed it (as it was purely visual anyway). Have a look at the adjusted code and see if you can run it now."}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467238421, "post_id": 38110653, "comment_id": 63655365, "body": "Using Debug, I step through code to the Set ws1 - Worksheets(&quot;Validation&quot;) all okay, Then we go into the Named Range Check... I step through the block once, with no errors, on the second run, I the same error appears on :  If nm.RefersToRange.Worksheet.Name &lt;&gt; &quot;Validation&quot; Then"}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467238658, "post_id": 38110653, "comment_id": 63655469, "body": "<a href=\"http://www.filedropper.com/investmenttracker-wip\" rel=\"nofollow noreferrer\">filedropper.com/investmenttracker-wip</a> : link to the file. Username is RiglerKrave, Pass is 0506 Or you can use Username Jon, Pass - 9999"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467240068, "post_id": 38110653, "comment_id": 63655957, "body": "These are indirect named ranges. The named ranges <b>must</b> have changed from the original workbook (when the code still worked). Have a look at the first named range called <code>CurrentUser</code>: <a href=\"http://prnt.sc/bmsahb\" rel=\"nofollow noreferrer\">prnt.sc/bmsahb</a> This is a true named range which can be used. The same is the case with <code>Table2</code> because both directly refer to a range on a sheet. The other ranges need to get evaluated first before they can be used / referenced (because of the <code>OffSet</code>). So, if you are asking here for the <code>rngProjects.Value</code> you are getting back: <code>=OFFSET(Validation!$A$8,,,COUNTA(Validation!$A$8:$A$1000))</code>."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467240433, "post_id": 38110653, "comment_id": 63656077, "body": "Yet, in your code you are using <code>rngProjects.Value</code> to get back the project numbers. Suggestion: I&#39;d remove <b>any</b> use of named ranges in the VBA code and directly reference the sheets. By using named ranges in your VBA code it is prone to break whenever someone fiddles with the ranges. The above code has been changed accordingly."}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467241177, "post_id": 38110653, "comment_id": 63656348, "body": "Would you suggest something like this?                                Private Sub UserForm_Initialize()     With Worksheets(&quot;Sheet1&quot;)         ComboBox1.List = .Range(&quot;A1:A&quot; &amp; .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row).Value     End With End Sub"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467241485, "post_id": 38110653, "comment_id": 63656462, "body": "Yes, absolutely. But stick to the explicit coding and name the form up front. So, use <code>UserForm1.ComboBox1.List = .Range(&quot;A1:A&quot; &amp; .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row).Value2</code>. Using <code>.Value2</code> instead of <code>.Value</code> gives you a little bit of a speed boost."}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467241632, "post_id": 38110653, "comment_id": 63656507, "body": "Thank you so much! You&#39;re code works brilliantly, I didn&#39;t realise it would be so simple.   Is using Me.ComboBox1.list...... not the same?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467242024, "post_id": 38110653, "comment_id": 63656631, "body": "Try to avoid in your code things such as <code>Me</code>, <code>ActiveWorkbook</code>, <code>ActiveSheet</code>, <code>Selection</code>, etc. These are <i>relative</i> references as they change. So, if you code runs a bit too long and I click on another sheet or actually look at another Excel file (which this one is still running) or even at another application (click on my browser) then <code>ActiveWorkbook</code> and <code>ActiveSheet</code> change and will cause your code to fail. The above terms should not be used. Instead, use absolute references which cannot change. Tell VBA exactly which sheet / form / file you want."}, {"owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467242087, "post_id": 38110653, "comment_id": 63656650, "body": "Thank you! That&#39;s cleared it up a lot. If I could buy you a beer I would!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467242376, "post_id": 38110653, "comment_id": 63656737, "body": "Also, (as an additional remark to the last comment) absolute references render your code easier to read. If you are referring to <code>Selection</code> then I have to look in the previous lines of code which cell was last selected. Worse even, if the selection occurred in another sub in another module somewhere else in the file. Now imagine having lots of those. It&#39;s like revealing an archaeological site with a paintbrush. Not much fun."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "edited": false, "score": 0, "creation_date": 1467242434, "post_id": 38110653, "comment_id": 63656762, "body": "Thanks for the beer. I will let you know if I ever get close to you. Yet, now that the UK is leaving the rest of the EU that&#39;s not very likely to happen anytime soon. ;)"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1467240580, "last_edit_date": 1467240580, "creation_date": 1467237117, "answer_id": 38110653, "question_id": 38110165, "link": "https://stackoverflow.com/questions/38110165/run-time-error-1004-range-of-object-failed-vba-2013/38110653#38110653", "title": "Run-time error 1004 - Range of object failed - VBA 2013", "body": "<p>It seems to me that either the sheet name changed (sometimes a leading or trailing space is not recognizable) or the name for the named range changed. Furthermore, it could also be that the named range moved to another sheet (other than the validation sheet).</p>\n\n<p>If you check all of the above and furthermore use explicit references as suggested in the comments then you should be able to find the problem. Here is your code with some additional checks. Give it a try and let us know if this works or made you aware of the problem.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n'Set Variables to populate combobox\nDim rngProjects As Range\nDim ws1 As Worksheet\nDim bolFound As Boolean\nDim nm As Name\n\nFor Each ws1 In ThisWorkbook.Worksheets\n    If ws1.Name = \"Validation\" Then bolFound = True\nNext ws1\nIf bolFound = False Then\n    MsgBox \"Required sheet not found.\"\n    Exit Sub\nEnd If\n\nSet ws1 = Worksheets(\"Validation\")\n\nFor Each rngProjects In ws1.Range(ws1.Cells(8, 1), ws1.Cells(ws1.Rows.Count, 1).End(xlUp))\n    frmAddTransaction.cboProject.AddItem rngProjects.Value\n    frmAddTransaction.cboAccount.AddItem rngProjects.Value\nNext rngProjects\n\n'Add static data for combobox\nfrmAddTransaction.cboTransactionType.AddItem \"Income\"\nfrmAddTransaction.cboTransactionType.AddItem \"Expense\"\n\nEnd Sub\n</code></pre>\n\n<p>As commented below, the indirect named range has been removed. Instead, the sheet is now directly referenced in the code. Like this any change of the named range will have no impact on the code. Instead, the offset of 8 rows is written in the VBA where it is <em>slightly</em> more secure.</p>\n"}], "owner": {"reputation": 3, "user_id": 6530503, "user_type": "registered", "profile_image": "https://graph.facebook.com/701358710005392/picture?type=large", "display_name": "Jon Whiteford", "link": "https://stackoverflow.com/users/6530503/jon-whiteford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 1, "accepted_answer_id": 38110653, "answer_count": 1, "score": 0, "last_activity_date": 1467240580, "creation_date": 1467234860, "last_edit_date": 1467235589, "question_id": 38110165, "link": "https://stackoverflow.com/questions/38110165/run-time-error-1004-range-of-object-failed-vba-2013", "title": "Run-time error 1004 - Range of object failed - VBA 2013", "body": "<p>I'm getting a run time error 1004, Method 'Range' of object '_Worksheet' failed.</p>\n\n<p>This code worked before on a draft of this project, but when imported into new project file, i get this.... none of the named ranges or worksheet names have changed from previous version. Please help!</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'Set Variables to populate combobox\nDim rngProjects As Range\nDim ws1 As Worksheet\n\nSet ws1 = Worksheets(\"Validation\")\n\nFor Each rngProjects In ws1.Range(\"Projects\")\n\nMe.cboProject.AddItem rngProjects.Value\nMe.cboAccount.AddItem rngProjects.Value\n\nNext rngProjects\n\n'Add static data for combobox\nMe.cboTransactionType.AddItem \"Income\"\nMe.cboTransactionType.AddItem \"Expense\"\n</code></pre>\n"}, {"tags": ["vba", "3d", "point", "point-clouds", "autodesk-inventor"], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 4197108, "user_type": "registered", "profile_image": "https://graph.facebook.com/1261292135/picture?type=large", "display_name": "Brian Ekins", "link": "https://stackoverflow.com/users/4197108/brian-ekins"}, "is_accepted": false, "score": 0, "last_activity_date": 1467311615, "creation_date": 1467311615, "answer_id": 38130800, "question_id": 38110160, "link": "https://stackoverflow.com/questions/38110160/get-the-points-coordinates-from-a-geometry-projection-over-a-solid-in-autodesk-i/38130800#38130800", "title": "Get the points coordinates from a geometry projection over a Solid in Autodesk Inventor with VBA", "body": "<p>I just created a blog post that hopefully answers your question about projecting the points onto a solid.</p>\n\n<p><a href=\"http://modthemachine.typepad.com/my_weblog/2016/06/projecting-points-onto-a-solid.html\" rel=\"nofollow\">http://modthemachine.typepad.com/my_weblog/2016/06/projecting-points-onto-a-solid.html</a></p>\n\n<p>Regarding your second question about getting the solid as a point cloud; it is possible.  You'll want to look at the CalculateFacets, CalculateFacetsWithOptions, and GetExistingFacets methods.  These all do the same thing in that they return a set of points that represent a triangle approximation of the solid.</p>\n"}], "owner": {"reputation": 97, "user_id": 6500968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/786e3f96f25e36b1b88d53ea977cf639?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/6500968/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467311615, "creation_date": 1467234844, "question_id": 38110160, "link": "https://stackoverflow.com/questions/38110160/get-the-points-coordinates-from-a-geometry-projection-over-a-solid-in-autodesk-i", "title": "Get the points coordinates from a geometry projection over a Solid in Autodesk Inventor with VBA", "body": "<p>I would like to get the coordinates (in a text or Excel file) of a set of points that are produced after projecting another set of points over a solid (All this done using the software Autodesk Inventor Professional 2016).\nI would like to do this with VBA automatically since I intend to do it with many points.\nFor the moment I have found examples on how to create workpoints on a sketch and how to export the workpoints coordinates into an Excel file (I add a link of a source with a solution below) but I am not able to get the coordinates of the points that are created with the projection (the actual points in the surface of the solid) since it seems that they are not considered as points by Inventor. To get those points I use the \"Project Geometry\" tool.</p>\n\n<p>Is there any way to do this with VBA?</p>\n\n<p>It would also help me if somebody could tell me how to convert the surface of a solid into a point cloud or how to convert this points that are produced with the projection into WorkPoints (so I can use the code I have already).</p>\n\n<p>Link that presents a solution to export points coordinates:</p>\n\n<p><a href=\"http://forums.autodesk.com/t5/inventor-customization/unable-to-export-3d-point-co-ordinates-data-to-excel/td-p/6295396\" rel=\"nofollow\">http://forums.autodesk.com/t5/inventor-customization/unable-to-export-3d-point-co-ordinates-data-to-excel/td-p/6295396</a></p>\n\n<p>I am not currently able to share more links with other sources I have found (in this post).</p>\n\n<p>I have also added a link to an image to illustrate what I am doing.</p>\n\n<p><a href=\"http://i.stack.imgur.com/c5wjw.png\" rel=\"nofollow\">Image of what I am doing</a></p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "email", "ssl", "cdo.message", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1471402419, "post_id": 38109933, "comment_id": 65327302, "body": "Im trying to install the TSL update for window, <a href=\"https://support.microsoft.com/en-us/kb/3140245\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/3140245</a>"}, {"owner": {"reputation": 171, "user_id": 2771843, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4f8a63586176ce73e34f14ff68841cf8?s=128&d=identicon&r=PG&f=1", "display_name": "danKV", "link": "https://stackoverflow.com/users/2771843/dankv"}, "reply_to_user": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1471498990, "post_id": 38109933, "comment_id": 65372880, "body": "Did it work for you? It looks as THE solution."}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1471499320, "post_id": 38109933, "comment_id": 65372994, "body": "it did not work, I believe we need to use the reference of library, but cant find it yet"}, {"owner": {"reputation": 171, "user_id": 2771843, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4f8a63586176ce73e34f14ff68841cf8?s=128&d=identicon&r=PG&f=1", "display_name": "danKV", "link": "https://stackoverflow.com/users/2771843/dankv"}, "reply_to_user": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1471505351, "post_id": 38109933, "comment_id": 65375625, "body": "Damn,  that it wasn&#39;t. I&#39;m attentive towards your experimentations ..."}], "owner": {"reputation": 171, "user_id": 2771843, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4f8a63586176ce73e34f14ff68841cf8?s=128&d=identicon&r=PG&f=1", "display_name": "danKV", "link": "https://stackoverflow.com/users/2771843/dankv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467233967, "creation_date": 1467233967, "last_edit_date": 1531161705, "question_id": 38109933, "link": "https://stackoverflow.com/questions/38109933/sending-e-mail-using-cdo-in-excel-vba-tsl-not-ssl", "title": "Sending e-mail using CDO in EXCEL vba TSL not SSL", "body": "<p>I try to send e-mails using the CDO of Excel VBA. The SMTP server I use require that I send the message with <strong>TSL</strong> encryption and not SSL. (I've tested it with email sent from an ordinary mailprogram changing between SSL and TLS). When sending a message using the</p>\n\n<pre><code>...\nset mail  = CDO_Config.Fields    \nmail.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n...\n</code></pre>\n\n<p>I get 'the transport could not connect to the server' (I've translated it from danish).</p>\n\n<p>All parameters ARE correct concerning the fields. I've tested with other STMP-servers NOT using TSL-encryption, sending mail without problems. Therefore I don't include these lines.</p>\n\n<p>Fields used: <em>sendusing, smtpserver, smtpserverport, smtpauthenticate, smtpusessl, \nsendusername, sendpassword, smtpconnectiontimeout</em>.</p>\n\n<p>Is it possible to send using the TSL encryption? I've found nothing on the net (10+ hours of research)</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "internet-explorer", "ctrl"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1467233594, "post_id": 38109721, "comment_id": 63653204, "body": "Why? Do you need to establish that the text exists in the page content? If yes, read the text into variable and search. That&#39;s more robust."}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1467233696, "post_id": 38109721, "comment_id": 63653264, "body": "I&#39;m trying to select a link named &quot;Gainers&quot;"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467921719, "post_id": 38109721, "comment_id": 63929695, "body": "Can you post your code - it&#39;s possible, and more reliable to use the DOM object to fill in the text and click a button"}], "answers": [{"comments": [{"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "edited": false, "score": 1, "creation_date": 1467276884, "post_id": 38109839, "comment_id": 63668858, "body": "Please edit with more information. Code-only and &quot;try this&quot; answers are discouraged, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;. We make an effort here to be a resource for knowledge."}], "tags": [], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "is_accepted": false, "score": 0, "last_activity_date": 1467920476, "last_edit_date": 1467920476, "creation_date": 1467233618, "answer_id": 38109839, "question_id": 38109721, "link": "https://stackoverflow.com/questions/38109721/how-to-type-into-ctrl-f-text-box-using-vba-and-internet-explorer/38109839#38109839", "title": "How to type into Ctrl + F text box using VBA and Internet Explorer", "body": "<p>To search a string, for this instance \"Gainers\", in a search window in Internet explorer, you can separate out each letter of the string you're searching by placing each letter with a brace.</p>\n\n<p>Code example:</p>\n\n<pre><code>application.SendKeys \"{G}{a}{i}{n}{e}{r}{s}\", true\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467920476, "creation_date": 1467233095, "question_id": 38109721, "link": "https://stackoverflow.com/questions/38109721/how-to-type-into-ctrl-f-text-box-using-vba-and-internet-explorer", "title": "How to type into Ctrl + F text box using VBA and Internet Explorer", "body": "<p>I know this question has been asked, but I can't find a clear answer to something I think should be pretty straight forward. I'm just trying to type the word \"gainers\" after running the code: <code>Application.SendKeys \"^f\", True</code> while using VBA within an Internet Explorer window.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1467234493, "post_id": 38109307, "comment_id": 63653651, "body": "Can you post the code? According to what can I read this is performed in word vba, so why to tag excel-vba?"}, {"owner": {"reputation": 7, "user_id": 6530293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40bf0adee32eb81c7ec5e7494e4baf69?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/6530293/diego"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1467239286, "post_id": 38109307, "comment_id": 63655697, "body": "The form for data input is on an Excel sheet. With the macro, i place the data into a Word Document and i create a LOG with that data, that&#39;s why i&#39;m using Excel macro."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467253520, "post_id": 38109307, "comment_id": 63659382, "body": "Show your code in the macro"}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "is_accepted": false, "score": 0, "last_activity_date": 1467260996, "creation_date": 1467260996, "answer_id": 38114015, "question_id": 38109307, "link": "https://stackoverflow.com/questions/38109307/store-the-path-of-a-document-i-just-saved-with-microsoft-word/38114015#38114015", "title": "Store the path of a document I just saved with Microsoft Word?", "body": "<p>You'll need <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195734.aspx\" rel=\"nofollow\">Application.GetSaveAsFilename</a> which returns the path of the saved file, and returns False if the user cancels it.</p>\n\n<pre><code>varResult = Application.GetSaveAsFilename\n'checks to make sure the user hasn't canceled the dialog \nIf varResult &lt;&gt; False Then \n    'Do something\nEnd If \n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6530293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40bf0adee32eb81c7ec5e7494e4baf69?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/6530293/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467260996, "creation_date": 1467231507, "last_edit_date": 1531164843, "question_id": 38109307, "link": "https://stackoverflow.com/questions/38109307/store-the-path-of-a-document-i-just-saved-with-microsoft-word", "title": "Store the path of a document I just saved with Microsoft Word?", "body": "<p>I just wrote a simple macro where some user can enter some data, and then the macro replaces this input data into bookmarks of a Microsoft Word document, and then the \"Save As\" window is opened. As the file is saved, a log is created in another worksheet.</p>\n\n<p>It works perfects so far, but I'd like to know if there is a way to store the path of the just-saved file?</p>\n\n<p>I'm asking this because I'd like to add a new column called \"file\", for example, which contains a hyperlink to just-saved file. (I dont know the path apriori, because users can choose the path they want)</p>\n"}, {"tags": ["vba", "excel", "graph"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467231466, "post_id": 38109219, "comment_id": 63652143, "body": "Is the <code>With</code> statement correct? I know you can do <code>...ChartObjects(1).Chart</code>, but am not sure about using the chart name.  Try doing <code>With ActiveSheet.Charts(&quot;Chart 2&quot;).Chart</code>."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467231678, "post_id": 38109219, "comment_id": 63652254, "body": "That with statement has worked thus far with me on another graph, I will try your idea"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467231758, "post_id": 38109219, "comment_id": 63652286, "body": "@BruceWayne , it did not work"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467231958, "post_id": 38109219, "comment_id": 63652379, "body": "Sorry - actually, try doing <code>With ActiveSheet.ChartObjects(&quot;Chart 2&quot;)</code> and leave off <code>.chart</code>."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467232324, "post_id": 38109219, "comment_id": 63652539, "body": "@BruceWayne unfortunately that didnt work either. The error says &quot;Object doesnt support this property or method.&quot; the same line is highlighted"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467234354, "post_id": 38109219, "comment_id": 63653589, "body": "Are you positive that the <code>ActiveSheet</code> has a chartobject named &quot;Chart 2&quot;?"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467290834, "post_id": 38109219, "comment_id": 63678467, "body": "Yes, it is named Chart 2"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467291723, "post_id": 38113154, "comment_id": 63679118, "body": "This code is in the worksheet&#39;s code, its not a Macro. Also, when I run this, I get an error under the first Case. The user is typing the dates as text into specific cells, and these cells in the code simply equal those cells that the user types in. I used this method for another graph but without a date-style x-axis and it worked"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467292162, "post_id": 38113154, "comment_id": 63679429, "body": "@JustinAnderson sorry, I don&#39;t seem to follow your needs. I have a code similar to this on a situation where I&#39;m updating a chart&#39;s X-Axis,Y-Axis, and all the Series Collections according to whatever is being typed in a range of cells. I do have a trigerred event (by button, or userform), once the user finished updating the relevant chart&#39;s range, that I am running my code."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467292272, "post_id": 38113154, "comment_id": 63679511, "body": "Yes, that is what I am trying to do! The user is typing the dates into these cells and then clicking a button to update the axis."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467292860, "post_id": 38113154, "comment_id": 63679934, "body": "@JustinAnderson so are you actually in the need to go through the entire range of cells here and collect your Chart data ? if so, the <code>Selece Case</code> code need some modifications..."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467294316, "post_id": 38113154, "comment_id": 63681056, "body": "I just need to go through the starting date they typed in, the ending date they typed in into another cell, then set the correct interval so that the axis starts and ends with those dates, and increments by month"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467303089, "post_id": 38113154, "comment_id": 63687975, "body": "@JustinAnderson did you try the modified code i edited in my answer ?"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467306761, "post_id": 38113154, "comment_id": 63690078, "body": "I am having trouble setting intervals with months. The tick for the x axis needs to be every month, and making the interval 30 is not working (cell L39 value)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467308959, "post_id": 38113154, "comment_id": 63691299, "body": "@JustinAnderson are you getting an error ? what interval are you getting ? Because I am getting &quot;Jun-16&quot;, &quot;Jul-16&quot; , &quot;Aug-16&quot;, etc. what format exactly you want to get at the x-axis ?"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1467319969, "post_id": 38113154, "comment_id": 63697293, "body": "I am getting very random numbers, from years that aren&#39;t even within range. I don&#39;t know how to get the nice even months in the range the user specifies. I will try again when I am back tomorrow and fire it up again."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1467295602, "last_edit_date": 1467295602, "creation_date": 1467254843, "answer_id": 38113154, "question_id": 38109219, "link": "https://stackoverflow.com/questions/38109219/graph-w-dates-on-x-axis/38113154#38113154", "title": "Graph w Dates on x-axis", "body": "<p>Modified code, currenty I just made all the cells address manually, just to make sure the chart is being updated, and it does.</p>\n\n<pre><code>Public Sub Update_Chart()\n\nWith ActiveSheet.ChartObjects(\"Chart 2\").Chart\n    .Axes(xlCategory).MaximumScale = Range(\"$L$37\")\n    .Axes(xlCategory).MinimumScale = Range(\"$L$38\")\n    .Axes(xlCategory).MajorUnit = Range(\"$L$39\")\n\n    ' this line you can modifty to whatever format you want your axis to have, the user doesn't need to keep the format on the worksheet cell itself\n    .Axes(xlCategory).TickLabels.NumberFormat = \"mmm-yy\" '  \"[$-409]d-mmm-yy;@\"\n\n    .Axes(xlValue).MaximumScale = Range(\"$O$37\")\n    .Axes(xlValue).MinimumScale = Range(\"$O$38\")\n    .Axes(xlValue).MajorUnit = Range(\"$O$39\")\n\n     ' change to whatever format you want your Y-Axis you want\n    .Axes(xlValue).TickLabels.NumberFormat = \"mmm-yy\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467295602, "creation_date": 1467231138, "question_id": 38109219, "link": "https://stackoverflow.com/questions/38109219/graph-w-dates-on-x-axis", "title": "Graph w Dates on x-axis", "body": "<p>I have a code set to self-update the x axis based on cell values. I want these values to show up as dates, but with a standard text type of formatting (for example, I have the style month-year, January-16, as each point on my x axis). But, because the user is typing in the min and max value they want into these cells referenced in the code, I want it to only be picked up as text so that this code can recognize it and plot it. I am getting an error at the line marked with ** below. I am not sure what to do. Thanks!</p>\n\n<pre><code>With ActiveSheet.ChartObjects(\"Chart 2\").chart\n    Select Case Target.Address\n      Case \"$L$37\"\n        **.Axes(xlCategory).MaximumScale = Target.Value**\n      Case \"$L$38\"\n        .Axes(xlCategory).MinimumScale = Target.Value\n      Case \"$L$39\"\n        .Axes(xlCategory).MajorUnit = Target.Value\n      Case \"$O$37\"\n        .Axes(xlValue).MaximumScale = Target.Value\n      Case \"$O$38\"\n        .Axes(xlValue).MinimumScale = Target.Value\n      Case \"$O$39\"\n        .Axes(xlValue).MajorUnit = Target.Value\n    End Select\n  End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467234605, "post_id": 38109171, "comment_id": 63653709, "body": "Why on Earth are you accessing <code>UserForm1</code> from the VBIDE API? You know there&#39;s already a global-scope, default instance already pointing to that object, that you can access for free with the global <code>UserForm1</code> identifier? Its <code>MultiPage1</code> can be accessed with <code>UserForm1.MultiPage1</code>. What&#39;s up with the <code>Object</code> and <code>Control</code> types? That said, you shouldn&#39;t use that global-scope object, instead <code>Dim form As UserForm1</code> and then <code>Set form = New UserForm1</code> and work off that <code>form</code> object, so you won&#39;t affect the global instance."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467236917, "post_id": 38109171, "comment_id": 63654722, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10822450/copy-elements-from-one-page-to-another-in-multipage-with-vba-in-excel\">Copy Elements From One Page To Another in Multipage with VBA in Excel</a>"}, {"owner": {"reputation": 1, "user_id": 6530227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99a878b5e579696870806352291cceeb?s=128&d=identicon&r=PG&f=1", "display_name": "rabbithair", "link": "https://stackoverflow.com/users/6530227/rabbithair"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467286089, "post_id": 38109171, "comment_id": 63675149, "body": "Worked like a charm -- thanks for your help!"}, {"owner": {"reputation": 1, "user_id": 6530227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99a878b5e579696870806352291cceeb?s=128&d=identicon&r=PG&f=1", "display_name": "rabbithair", "link": "https://stackoverflow.com/users/6530227/rabbithair"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467303656, "post_id": 38109171, "comment_id": 63688352, "body": "Encountered another issue - when I copy all the controls and paste them to my new page it doesn&#39;t keep the same names. For example I had a ControlBox called &quot;Currency&quot;, but when I pasted it to the new page it takes on a default name of &quot;ControlBox25&quot;. Is there any way to have it take on the same name?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467303722, "post_id": 38109171, "comment_id": 63688392, "body": "They&#39;re two different control instances. Two controls cannot have the same name/identifier in the same form, it would be a duplicate declaration..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467303823, "post_id": 38109171, "comment_id": 63688454, "body": "You could copy the controls one by one and name them appropriately, e.g. call the <code>Currency</code> control <code>CurrencyBox1</code> in tab 1 and name it <code>CurrencyBox2</code> in tab 2 for example."}, {"owner": {"reputation": 1, "user_id": 6530227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99a878b5e579696870806352291cceeb?s=128&d=identicon&r=PG&f=1", "display_name": "rabbithair", "link": "https://stackoverflow.com/users/6530227/rabbithair"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467306655, "post_id": 38109171, "comment_id": 63690017, "body": "How do you copy them one by one? <code>ctl.copy</code> doesn&#39;t work for me (where <code>ctl</code> is a control type)..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467306700, "post_id": 38109171, "comment_id": 63690047, "body": "hmm then you&#39;ll have to manually generate and position them one by one"}], "owner": {"reputation": 1, "user_id": 6530227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99a878b5e579696870806352291cceeb?s=128&d=identicon&r=PG&f=1", "display_name": "rabbithair", "link": "https://stackoverflow.com/users/6530227/rabbithair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467231001, "creation_date": 1467231001, "last_edit_date": 1531164843, "question_id": 38109171, "link": "https://stackoverflow.com/questions/38109171/error-creating-a-new-page-in-a-userform-in-vba", "title": "error Creating a new page in a userform in VBA", "body": "<p>I have a Userform with several pages, one of which is called FXForward1 and if a certain condition is met I want to create a new page in the userform called FXForward2 that has all the same controls as FXForward1. Does anyone know how I can go about doing this? The following is the relevant part of the code I currently have and it's giving me the following error:</p>\n\n<p>Run-Time Error '-2147319767(80028029)': </p>\n\n<p>Could not paste the control. Invalid forward reference, or reference to uncompiled type</p>\n\n<pre><code>Sub UpdateForm()\n\n\nDim vbObject As Object\nDim objControl As Control\nDim OptionNumber As Integer\n\n\nSet vbObject = ThisWorkbook.VBProject.VBComponents(\"UserForm1\")\nSet objControl = vbObject.Designer.Controls(\"MultiPage1\")\n\n' Other code here\n\nIf OptionNumber &gt; 1 Then   \n objControl.Pages.Add (\"FXForward\" &amp; OptionNumber)\n objControl.Pages(FXForward1).Controls.Copy\n objControl.Pages(\"FXForward\" &amp; OptionNumber).Paste  ' This line is where I get the error         \n\nEnd If\n\nUserForm1.Show\n\nEnd sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467231162, "post_id": 38108982, "comment_id": 63651966, "body": "Format dates to known format for sql server."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "reply_to_user": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467231603, "post_id": 38108982, "comment_id": 63652224, "body": "Isn&#39;t that what the CONVERT(DATETIME,txtFromDate,102) is supposed to do?  If it helps, the field in the actual table is datetime type. The text boxes are all ShortDate formats as mm/dd/yyyy."}, {"owner": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467232614, "post_id": 38108982, "comment_id": 63652688, "body": "<code>CONVERT(DATETIME,txtFromDate,102)</code> - and where is that in your code? 102 is <code>yyyy.mm.dd</code> format anyway <a href=\"https://msdn.microsoft.com/en-us/library/ms187928.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms187928.aspx</a>."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "reply_to_user": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467233062, "post_id": 38108982, "comment_id": 63652938, "body": "<code>WHERE      (DateSubmitted BETWEEN CONVERT(DATETIME, [Forms]![frmRptFeedback]![txtFromDate], 102) AND CONVERT(DATETIME,                          [Forms] ! [frmRptFeedback] ! [txtToDate], 102))</code> is the WHERE clause for the recordsource of the report that I&#39;m having problems with. Even if I set it for 101 to match the format, I get the same Unable to parse text and Incorrect syntax near ! error."}, {"owner": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467233314, "post_id": 38108982, "comment_id": 63653064, "body": "ANd where is <code>strCondition</code> used then? &quot;Parse error&quot; is client-side. Probably the problem is in those spaces around <code>!</code> where txtToData is referred."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "reply_to_user": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467233784, "post_id": 38108982, "comment_id": 63653301, "body": "When I try to take the spaces out, Access puts them back after it throws the parse error.  strCondition is used in the VBA on the form to pass the &quot;where&quot; to the report. The Feedback By Employee report works fine, but it uses the main vueRptFeedback SQL as its recordsource which has DateSubmitted as a field in the report.  My Feedback By Team and Feedback By Project reports are all aggregates (counts/sums) that don&#39;t have a date column in the SELECT so I&#39;m having problems passing the dates from the unbound textbox as constraints for the WHERE clause."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "reply_to_user": {"reputation": 7396, "user_id": 5921826, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF8w-5Y_yz8/AAAAAAAAAAI/AAAAAAAAAC0/oIYJ_x2s_3o/photo.jpg?sz=128", "display_name": "Ivan Starostin", "link": "https://stackoverflow.com/users/5921826/ivan-starostin"}, "edited": false, "score": 0, "creation_date": 1467234573, "post_id": 38108982, "comment_id": 63653692, "body": "Even if I strip the CONVERT(DATETIME) out of the picture and just have <code>WHERE      DateSubmitted BETWEEN ([Forms]![frmRptFeedback]![txtFromDate]) AND ([Forms]![frmRptFeedback]![txtToDate])</code> I get the same parse error trying to run the query."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467293181, "post_id": 38112262, "comment_id": 63680172, "body": "When using the FORMAT like you have typed above, I get the following error. <code>Invalid text or symbol. Error in list of function arguments: &#39;!&#39; not recognized. Error in list of function arguments: &#39;&quot;YYYY-MM-DD)) GROUP BY ProjectID, RespEmp, ProjectName ORDER BY ProjectID, RespEmp&#39; not recognized. Unable to parse query text.</code> I think I may need to find a way to pass the  txtFromDate and txtToDate to hidden unbound text boxes on the report, then see if I can change the RecordSource in the OnLoad event."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467299858, "post_id": 38112262, "comment_id": 63685654, "body": "Which query is a pass-through and which one is a regular stored Access query? This error is not coming from the Access engine. Remember pass-thru queries cannot see anything local such as form/report controls."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467299906, "post_id": 38112262, "comment_id": 63685698, "body": "Convert the latter report query to Access. Before posting to test, I put a date textbox on a form, filled it as MM/DD/YYYY and ran the <code>Format()</code> in an Access query whose <code>FROM</code> clause used an ODBC pass-thru query. The query ran perfectly."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467301868, "post_id": 38112262, "comment_id": 63687188, "body": "That may be part of the issue as well. This is an ADP/ADE that connects directly to the SQL Server. There is no ODBC connection."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467311232, "post_id": 38112262, "comment_id": 63692529, "body": "Very pertinent information for your overall post. I do not use ADPs. I&#39;d advise using an .accdb/.mdb file and use linked MSSQL tables/views or pass-thru queries or even passing parameters to stored procedure that returns a resultset. See this <a href=\"http://stackoverflow.com/questions/2500519/pros-and-cons-of-access-data-project-ms-access-front-end-with-sql-server-backend\">SO post on Adp files</a> with <i>Microsoft has been deprecating ADPs for several years</i>."}, {"owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "edited": false, "score": 0, "creation_date": 1467316857, "post_id": 38112262, "comment_id": 63695634, "body": "I know. It&#39;s a legacy database we&#39;ve been using as a sort of Project Management / ERP sorta-kinda thing. In my free time, I&#39;ve been working on an ASP.NET front end to the SQL server so we can dump the thing. Fortunately for me and this post is that after bringing my struggles to management, they are fine with a straight up tabular datasheet view that exports to excel. The main guy that needs the report is an excel guru and is fine exporting the report to an xls file then setting up his own pivot tables."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1467247673, "creation_date": 1467247673, "answer_id": 38112262, "question_id": 38108982, "link": "https://stackoverflow.com/questions/38108982/access-2010-report-constrained-between-dates/38112262#38112262", "title": "Access 2010 report constrained between dates", "body": "<p>Fundamentally, you are conflating two SQL dialects - SQL Server SQL and MS Access SQL. There is no <code>CONVERT()</code> function in Access SQL syntax which appears to be the engine running the recordsource of the report and not the pass-through query, vueRptFeedback, run by MSSQL.</p>\n\n<p>Consider using <a href=\"http://www.techonthenet.com/access/functions/date/format.php\" rel=\"nofollow\">FORMAT()</a> to align dates to ANSI datetime format: YYYY-MM-DD:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT ProjectID, ProjectName, RespEmp, COUNT(FeedbackID) AS CountReports, \n       SUM(QtyIssues) AS SumIssues, SUM(EstHoursImpact) AS SumHours\nFROM vueRptFeedback\nWHERE (DateSubmitted \n       BETWEEN FORMAT([Forms]![frmRptFeedback]![txtFromDate], \"YYYY-MM-DD\") \n           AND FORMAT([Forms]![frmRptFeedback]![txtToDate], \"YYYY-MM-DD\"))\nGROUP BY ProjectID, RespEmp, ProjectName, DateSubmitted\nORDER BY ProjectID, RespEmp\n</code></pre>\n\n<p>On the VBA side, you can still use <code>Format()</code> as many of Access's SQL functions derived from VBA functions (possibly, this is the reason Access SQL differs from its other RDMS counterparts who adhere to ANSI more due to the need to stay compatible in MS Office VBA context):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strFromDate As String\nDim strToDate As String\n\nstrFromDate = Format(txtFromDate.Value, \"YYYY-MM-DD\")\nstrToDate = Format(txtToDate.Value, \"YYYY-MM-DD\")\n...\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467247673, "creation_date": 1467230252, "last_edit_date": 1467245567, "question_id": 38108982, "link": "https://stackoverflow.com/questions/38108982/access-2010-report-constrained-between-dates", "title": "Access 2010 report constrained between dates", "body": "<p>I am trying to get a form setup to launch various reports based on different criteria and I am having problems getting one of the reports that is a GroupBy/Count/Sum based SQL Data source to work between 2 unbound textboxes serving as a FromDate and a ToDate.</p>\n\n<p><strong>VBA</strong> script - <em>calling report from form (frmRptFeedback):</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdPrint_Click()\n\n    If Not chkPrintPreview Then\n        Set Application.Printer = Application.Printers.Item(cboPrinter.Value)\n    End If\n\n    Dim strCondition As String\n\n    Dim strFromDate As String\n    Dim strToDate As String\n\n    strFromDate = txtFromDate.Value\n    strToDate = txtToDate.Value\n\n\n    Select Case opgOptions\n\n        Case 1  ' Feedback By Employee\n            If IsNull(cboEmployee.Value) Then\n                strCondition = \"DateSubmitted BETWEEN '\" &amp; strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            Else\n                strCondition = \"RespEmp = '\" &amp; cboEmployee.Value &amp; \"' AND DateSubmitted BETWEEN '\" &amp; _\n                strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            End If\n\n            Call OpenReport(\"rptFeedbackByEmp\", IIf(chkPrintPreview, acViewPreview, acViewNormal), strCondition)\n\n        Case 2  ' Feedback By Team\n            If IsNull(cboTeam.Value) Then\n                strCondition = \"DateSubmitted BETWEEN '\" &amp; strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            Else\n                strCondition = \"EmpType = '\" &amp; cboTeam.Value &amp; \"' AND DateSubmitted BETWEEN '\" &amp; _\n                strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            End If\n\n            Call OpenReport(\"rptFeedbackByTeam\", IIf(chkPrintPreview, acViewPreview, acViewNormal), strCondition)\n\n        Case 3  ' Feedback By Project #\n            If IsNull(txtProjectID) Then\n                strCondition = \"DateSubmitted BETWEEN '\" &amp; strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            Else\n                strCondition = \"ProjectID = \" &amp; txtProjectID &amp; \"AND DateSubmitted BETWEEN '\" &amp; _\n                strFromDate &amp; \"' AND '\" &amp; strToDate &amp; \"'\"\n            End If\n\n            Call OpenReport(\"rptFeedbackByProject\", IIf(chkPrintPreview, acViewPreview, acViewNormal), strCondition)\n\n    End Select\n\n    If Not chkPreview Then\n        Set Application.Printer = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>SQL</strong> query - <em>initially pulling data into main SQL View (vueRptFeedback):</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT f.FeedbackID, f.BFID, bf.ProjectID, p.ProjectName, e2.Name AS PM, e1.Name AS RespEmp, \n       et.Description AS EmpType, f.SubByInits, f.DateSubmitted, f.QtyIssues, \n       f.EstHoursImpact, f.PlusDelta, f.Notes, f.HowResolved\nFROM dbo.tblEmployee e2 \nINNER JOIN dbo.tblProject p\nINNER JOIN dbo.tblBookingForm bf \n        ON p.ProjectID = bf.ProjectID \n        ON e2.EmployeeID = p.Scope_PM_EmployeeID \nRIGHT OUTER JOIN dbo.tblEmployeeType et \nINNER JOIN dbo.tblEmployee e1 \n        ON et.EmployeeTypeID = e1.EmployeeTypeID \nINNER JOIN dbo.tblFeedback f \n        ON e1.EmployeeID = f.ResponsibleEmpID \n        ON bf.BookingFormID = f.BFID\n</code></pre>\n\n<p><strong>SQL</strong> query - <em>current recordsource for report by Project ID (vueRptFeedbackByProject):</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT ProjectID, ProjectName, RespEmp, COUNT(FeedbackID) AS CountReports, \n       SUM(QtyIssues) AS SumIssues, SUM(EstHoursImpact) AS SumHours\nFROM vueRptFeedback\nWHERE (DateSubmitted \n       BETWEEN CONVERT(DATETIME, [Forms]![frmRptFeedback]![txtFromDate], 102) \n           AND CONVERT(DATETIME, [Forms]![frmRptFeedback]![txtToDate], 102))\nGROUP BY ProjectID, RespEmp, ProjectName, DateSubmitted\nORDER BY ProjectID, RespEmp\n</code></pre>\n\n<p>I know my problem is in the <code>WHERE</code> clause as when I take it out, the report pulls fine but with all records, not the ones between those two dates. Once I can get the report to pull between the <em>txtFromDate</em> and <em>txtToDate</em>, I will probably need to change the <code>OpenReport()</code> to pass the <em>txtFromDate</em> and <em>txtToDate</em> as parameters instead of a Between X and Y, but I keep getting tripped up by syntax on the Recordsource of the report.</p>\n"}, {"tags": ["vba", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467230316, "post_id": 38108943, "comment_id": 63651530, "body": "Add <code>ws.activate</code> as the first line inside the for loop."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467236033, "post_id": 38110305, "comment_id": 63654345, "body": "The reason the the OP is saving before is he/she is saving a copy to which they are doing all the changes.  This is to avoid removing all the formulas from the workbook.  They make a copy, in that copy the remove all the formulas and leave the values, it is this copy which they are iterating and saving as txt files."}, {"owner": {"reputation": 424, "user_id": 2600195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bBglb.jpg?s=128&g=1", "display_name": "ghg565", "link": "https://stackoverflow.com/users/2600195/ghg565"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467236730, "post_id": 38110305, "comment_id": 63654662, "body": "Scott. Sorry, I think I deleted your second comment...I was trying to delete my own."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467236922, "post_id": 38110305, "comment_id": 63654726, "body": "No I deleted it, I wanted to double check that my logic was correct."}, {"owner": {"reputation": 424, "user_id": 2600195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bBglb.jpg?s=128&g=1", "display_name": "ghg565", "link": "https://stackoverflow.com/users/2600195/ghg565"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467237650, "post_id": 38110305, "comment_id": 63655045, "body": "oh, yah...I was thinking it was odd that I would be able to.  It just disappeared when I deleted mine so I started to wonder what I did."}, {"owner": {"reputation": 3, "user_id": 6530197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781a1700c88d5624904132c8685b27c4?s=128&d=identicon&r=PG&f=1", "display_name": "user6530197", "link": "https://stackoverflow.com/users/6530197/user6530197"}, "edited": false, "score": 0, "creation_date": 1467300287, "post_id": 38110305, "comment_id": 63686005, "body": "Thank you, everyone for your comments and help!  Scott and ghg565, the macro works great! If someone reads this, I did make one minor change to the following line:"}, {"owner": {"reputation": 3, "user_id": 6530197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781a1700c88d5624904132c8685b27c4?s=128&d=identicon&r=PG&f=1", "display_name": "user6530197", "link": "https://stackoverflow.com/users/6530197/user6530197"}, "edited": false, "score": 0, "creation_date": 1467300307, "post_id": 38110305, "comment_id": 63686015, "body": "ActiveWorkbook.SaveAs Filename:=&quot;V:\\tech\\dd&quot; &amp; &quot;\\&quot; &amp; ActiveSheet.Name &amp; &quot;.txt&quot;, _     FileFormat:=xlNormal, CreateBackup:=False"}, {"owner": {"reputation": 3, "user_id": 6530197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781a1700c88d5624904132c8685b27c4?s=128&d=identicon&r=PG&f=1", "display_name": "user6530197", "link": "https://stackoverflow.com/users/6530197/user6530197"}, "edited": false, "score": 0, "creation_date": 1467300414, "post_id": 38110305, "comment_id": 63686097, "body": "I updated this from FileFormate=xlNormal to xlText. (Just an FYI depending on the output you want).   Thanks again for the help! Very much appreciated! DD"}, {"owner": {"reputation": 424, "user_id": 2600195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bBglb.jpg?s=128&g=1", "display_name": "ghg565", "link": "https://stackoverflow.com/users/2600195/ghg565"}, "edited": false, "score": 0, "creation_date": 1467309519, "post_id": 38110305, "comment_id": 63691624, "body": "I am glad you got it working the way you desired.  I have modified the answer to reflect the <code>xlText</code> change that you made."}], "tags": [], "owner": {"reputation": 424, "user_id": 2600195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bBglb.jpg?s=128&g=1", "display_name": "ghg565", "link": "https://stackoverflow.com/users/2600195/ghg565"}, "is_accepted": true, "score": 0, "last_activity_date": 1467309452, "last_edit_date": 1467309452, "creation_date": 1467235541, "answer_id": 38110305, "question_id": 38108943, "link": "https://stackoverflow.com/questions/38108943/excel-macro-to-copy-paste-values-from-multiple-sheets-to-separate-text-files/38110305#38110305", "title": "Excel Macro to Copy &amp; Paste Values from Multiple Sheets to Separate Text Files", "body": "<p>There are a couple of things wrong with what you have there.  </p>\n\n<ul>\n<li>The Close statement doesn't need to be called inside the loop</li>\n<li>The FileFormat for the .xlsx workbook needed to be changed to work properly when saving from .xlsm to .xlsx. it should be <code>xlOpenXMLWorkbook</code></li>\n<li><p>As  Scott pointed out, you should activate the worksheet that you are trying to save each time as you iterate.</p>\n\n<pre><code>Sub SaveSheetsAsTxt()\n\nDim ws As Worksheet\nApplication.DisplayAlerts = False\n\n'save as XLSX\nWorksheets.Copy\nActiveWorkbook.SaveAs Filename:=\"V:\\tech\\dd\\FUND_HOLDINGS.xlsx\", _\nFileFormat:=xlOpenXMLWorkbook, Password:=\"\", WriteResPassword:=\"\", _\nReadOnlyRecommended:=False, CreateBackup:=False\n' Close the newly created xlsx file\nActiveWorkbook.Close\n\n'loop through the worksheets\nFor Each ws In ThisWorkbook.Sheets\n    ws.Activate\n    ActiveSheet.Cells.Copy\n    ActiveSheet.Cells.PasteSpecial Paste:=xlPasteValues\n    ActiveSheet.Cells.PasteSpecial Paste:=xlPasteFormats\n    ActiveWorkbook.SaveAs Filename:=\"V:\\tech\\dd\" &amp; \"\\\" &amp; ActiveSheet.Name &amp; \".txt\", _\n    FileFormat:=xlText, CreateBackup:=False\nNext ws\n\n'Close out the workbook now \nActiveWorkbook.Close\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 6530197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781a1700c88d5624904132c8685b27c4?s=128&d=identicon&r=PG&f=1", "display_name": "user6530197", "link": "https://stackoverflow.com/users/6530197/user6530197"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 38110305, "answer_count": 1, "score": 0, "last_activity_date": 1467309452, "creation_date": 1467230109, "question_id": 38108943, "link": "https://stackoverflow.com/questions/38108943/excel-macro-to-copy-paste-values-from-multiple-sheets-to-separate-text-files", "title": "Excel Macro to Copy &amp; Paste Values from Multiple Sheets to Separate Text Files", "body": "<p>I am trying to build a macro to export multiple sheets (with named tabs) to separate text files. The original .xlsm file has formulas built in, so I am trying to paste the values from each named worksheet into individual text files. The script below works, but only saves the main Excel file as .xlsx and the active worksheet. </p>\n\n<p>I am trying to copy/paste all worksheets, but my script is not working:</p>\n\n<pre><code>Sub SaveSheetsAsTxt()\n'\n' SaveSheetsAsTxt Macro\n'\nDim ws As Worksheet\n\nApplication.DisplayAlerts = False\n\n'save as XLSX\n    ActiveWorkbook.SaveAs Filename:=\"V:\\tech\\dd\\FUND_HOLDINGS.xlsx\", _\n        FileFormat:=xlNormal, Password:=\"\", WriteResPassword:=\"\", _\n        ReadOnlyRecommended:=False, CreateBackup:=False\n\nMyPath = ThisWorkbook.Path\n\nFor Each ws In ThisWorkbook.Sheets\nActiveSheet.Cells.Copy\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteValues\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteFormats\nActiveWorkbook.SaveAs Filename:=\"V:\\tech\\dd\" &amp; \"\\\" &amp; ActiveSheet.Name &amp; \".txt\", _\nFileFormat:=xlText, CreateBackup:=False\nActiveWorkbook.Close SaveChanges:=False\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467228594, "post_id": 38108482, "comment_id": 63650683, "body": "<i>I don&#39;t think I&#39;m using them right</i> - is it not working? and what&#39;s not working about it? You can simply by reversing the logic and using <code>Len</code> (which seems to work better)... <code>If Len(Cells(i,4)) = 0 and Len(Cells(i,5)) = 0 Then &#39;do nothing Else &#39;do stuff End If</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467228709, "post_id": 38108482, "comment_id": 63650744, "body": "<code>If Cells(i, 4) &lt;&gt; &quot;&quot; And Cells(i, 5) &lt;&gt; &quot;&quot; Then</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1467229629, "last_edit_date": 1467229629, "creation_date": 1467228965, "answer_id": 38108621, "question_id": 38108482, "link": "https://stackoverflow.com/questions/38108482/checking-to-see-if-two-cells-are-empty/38108621#38108621", "title": "Checking to see if two cells are empty", "body": "<p>These are all valid</p>\n\n<blockquote>\n  <p>If ((Not IsEmpty(Cells(i, 4))) And (Not IsEmpty(Cells(i, 5)))) Then</p>\n  \n  <p>If Cells(i, 4) &lt;> \"\" And Cells(i, 5) &lt;> \"\" Then</p>\n  \n  <p>If Len(Cells(i, 4)) And Len(Cells(i, 5)) Then</p>\n  \n  <p>If Len(Cells(i, 4)) > 0  And Len(Cells(i, 5)) > 0 Then</p>\n</blockquote>\n\n<p>My personal preference is to use Len().  I think it's a clean look.<br>\n<br></p>\n\n<p>Wrapping your code in a with statement will make it easier to compare ranges on different worksheets.</p>\n\n<pre><code>With managerSheet\n\n    For i = 2 To rows \n            If  Len(.Cells(i, 4)) And Len(.Cells(i, 5) Then\n                'Do stuff...\n            else\n                'Do nothing...\n            end if\n    next i\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "is_accepted": false, "score": 0, "last_activity_date": 1467229241, "creation_date": 1467229241, "answer_id": 38108697, "question_id": 38108482, "link": "https://stackoverflow.com/questions/38108482/checking-to-see-if-two-cells-are-empty/38108697#38108697", "title": "Checking to see if two cells are empty", "body": "<p>My problem was not my if statement but rather the scope of my calls.\nI forgot to include the scope of cells. <code>managerSheet.Cells(i, 4).. etc</code>\nThanks for the help</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 1207800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/393a4a09b68c1d5946d8b0d6c4e8d04b?s=128&d=identicon&r=PG", "display_name": "Linear_D", "link": "https://stackoverflow.com/users/1207800/linear-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1467236784, "last_edit_date": 1467236784, "creation_date": 1467236225, "answer_id": 38110464, "question_id": 38108482, "link": "https://stackoverflow.com/questions/38108482/checking-to-see-if-two-cells-are-empty/38110464#38110464", "title": "Checking to see if two cells are empty", "body": "<p>The method I normally go for is to check the cell referenced, to a type. As far as I'm aware, when you reference a cell, the interpreter will return a type which best suits the value, i.e. <code>1</code> returns a <code>Double</code>, <code>\"abc\"</code> returns a <code>String</code> and so on. When a cell is blank, the type returned is <code>Empty</code>.</p>\n\n<p>I carried out a performance test using the technique mentioned <a href=\"http://www.nullskull.com/a/1602/profiling-and-optimizing-vba.aspx\" rel=\"nofollow\">here</a>.</p>\n\n<p>Test 1: Using <code>Len()</code> to compare the cells took 40.9080069854244</p>\n\n<pre><code>dTime = MicroTimer\nFor i = 1 To 10000\n  If Len(Cells(i, 4)) And Len(Cells(i, 5)) Then\n    'Do something\n  Else\n    'Do nothing  \n  End If\nNext i\ndTime = MicroTimer - dTime '40.9080069854244\n</code></pre>\n\n<p>Test 2: Comparing the cells to the type <code>Empty</code> only took 21.0493610010926</p>\n\n<pre><code>dTime = MicroTimer\nFor i = 1 To 10000\n  If Cells(i, 4) &lt;&gt; Empty And Cells(i, 5) &lt;&gt; Empty Then\n    'Do something\n  Else\n    'Do nothing\n  End If\nNext i\ndTime = MicroTimer - dTime '21.0493610010926\n</code></pre>\n\n<p>It may not look as clean, but if definitely has a benefit.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467236784, "creation_date": 1467228491, "last_edit_date": 1467228743, "question_id": 38108482, "link": "https://stackoverflow.com/questions/38108482/checking-to-see-if-two-cells-are-empty", "title": "Checking to see if two cells are empty", "body": "<p>I'm trying to see if two cells are <strong>NOT</strong> empty in VBA. I'm using the <code>IsEmpty()</code> but I don't think I'm using them right. This is what I have. It's not working because it will always go into the if statement. </p>\n\n<p>Inside my <code>if</code>, I'm manipulating some cells. I shouldn't manipulate them if I go into the else.(Which does nothing), but they end up changing also.</p>\n\n<pre><code>For i = 2 To rows \n        If ((Not IsEmpty(Cells(i, 4))) And (Not IsEmpty(Cells(i, 5)))) Then\n            'Do stuff...\n        else\n            'Do nothing...\n        end if\nnext i\n</code></pre>\n\n<p>Is this the best way? </p>\n"}, {"tags": ["vba", "outlook", "lync"], "comments": [{"owner": {"reputation": 111, "user_id": 2800574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d067a9ff8a220a2bbcce328df8309dc6?s=128&d=identicon&r=PG", "display_name": "csg", "link": "https://stackoverflow.com/users/2800574/csg"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1467231661, "post_id": 38108132, "comment_id": 63652247, "body": "Missed Conversations do get saved in the Inbox. Regular conversations are saved under the &quot;Conversation History&quot; folder."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1467233207, "post_id": 38108132, "comment_id": 63652993, "body": "the missed conversation doesn&#39;t trigger the rule / macro cause outlook doesn&#39;t treat them as incoming message.  Here&#39;s a possible work around but it&#39;s kinda reluctant: <a href=\"http://stdout-dev-null.blogspot.ca/2013/09/how-to-process-outlook-rules-on-lync-im.html\" rel=\"nofollow noreferrer\">stdout-dev-null.blogspot.ca/2013/09/&hellip;</a>"}], "owner": {"reputation": 111, "user_id": 2800574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d067a9ff8a220a2bbcce328df8309dc6?s=128&d=identicon&r=PG", "display_name": "csg", "link": "https://stackoverflow.com/users/2800574/csg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1007, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1467227145, "creation_date": 1467227145, "question_id": 38108132, "link": "https://stackoverflow.com/questions/38108132/outlook-vba-rule-on-missed-lync-conversations", "title": "Outlook VBA - Rule on Missed Lync Conversations", "body": "<p>I currently have a rule/VBA combo on all received e-mails that sends a brief e-mail info (sender, subject) to another address. However, this rule does not work on missed Lync conversations that do pop up in the Inbox. Is there any way to work around this?</p>\n\n<p>Current setup for e-mails is using the Rule when message is received, run a script. The script then composes and sends an e-mail based on information on the received item.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1467227191, "post_id": 38108083, "comment_id": 63649920, "body": "Is your checkbox named <code>CheckBox1</code>? How about <code>Sheet1.CheckBox</code>? Is it an activeX checkbox, or a form control checkbox?"}, {"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1467227329, "post_id": 38108083, "comment_id": 63649986, "body": "ActiveX control and I tried sheet(&quot;BalanceSheet&quot;).checkbox1.  Still having issue.  It also is the activesheet."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1467227565, "post_id": 38108083, "comment_id": 63650109, "body": "And you are certain it&#39;s named Checkbox1? Other than that, I don&#39;t see anything wrong with the code."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1467227279, "post_id": 38108146, "comment_id": 63649956, "body": "this is Excel not access vba - I believe I need to pass the sheet name..."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1467227443, "post_id": 38108146, "comment_id": 63650038, "body": "<code>Me</code> is fine to use in Excel VBA, however, it&#39;s superfluous in this instance. If this code is in the worksheet&#39;s vba code, then it will work. If the code is in a module, then <code>me</code> would be referencing the module."}, {"owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "edited": false, "score": 0, "creation_date": 1467227711, "post_id": 38108146, "comment_id": 63650196, "body": "Did you look at this forum at all? - <a href=\"http://www.mrexcel.com/forum/excel-questions/45786-if-clause-visual-basic-applications-look-checkbox-if-its-checked-not.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "is_accepted": false, "score": -1, "last_activity_date": 1467490825, "last_edit_date": 1467490825, "creation_date": 1467227211, "answer_id": 38108146, "question_id": 38108083, "link": "https://stackoverflow.com/questions/38108083/excel-use-checkbox-in-vba/38108146#38108146", "title": "Excel use Checkbox in vba", "body": "<p>Try:</p>\n\n<pre><code>If Me.Checkbox1 = True Then\n  'whatever code goes here\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1467227571, "creation_date": 1467227571, "answer_id": 38108230, "question_id": 38108083, "link": "https://stackoverflow.com/questions/38108083/excel-use-checkbox-in-vba/38108230#38108230", "title": "Excel use Checkbox in vba", "body": "<p>How about:</p>\n\n<pre><code>Sub dural()\n    If ActiveSheet.OLEObjects(\"CheckBox1\").Object.Value = True Then\n        MsgBox \"it is checked\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7KjK9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7KjK9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note this is for a \"standalone\" ActiveX checkbox <em>(not on a userform)</em></p>\n"}], "owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 38108230, "answer_count": 2, "score": 1, "last_activity_date": 1467490825, "creation_date": 1467226996, "last_edit_date": 1531164843, "question_id": 38108083, "link": "https://stackoverflow.com/questions/38108083/excel-use-checkbox-in-vba", "title": "Excel use Checkbox in vba", "body": "<p>I need to verify if an activex checkbox is checked in my vba code, however, when I try - \"  If Checkbox1.Value = True Then\"  it is asking for variable not defined.  What am i missing?</p>\n"}, {"tags": ["xml", "vba", "powerpoint", "powerpoint-2013", "ssml"], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467225721, "creation_date": 1467225721, "question_id": 38107716, "link": "https://stackoverflow.com/questions/38107716/how-to-change-the-voice-using-ssml-xml-in-vba", "title": "How to change the voice using SSML/XML in VBA", "body": "<p>I successfully added text-to-speech synthesis in a MS PowerPoint 2013 application for my students.  The app gives the impression of switching between an adult voice and a child voice by using SSML/XML codes to change the pitch.  This worked well on Windows 7's using the Microsoft Anna voice.  </p>\n\n<p>However, with Windows 10 becoming more and more common, I am needing the PowerPoint to function properly in Windows 10 too.  While the app will run and use the default Microsoft David Desktop voice, the change in pitch is not sufficient when using David to tell that a different voice is speaking.  That's a huge problem for this app because the user needs to take a different action depending on which voice is speaking.</p>\n\n<p>To get the speech to work, the PowerPoint VBA uses a reference to Microsoft Excel 15.0 Object Library and then the following code where SayWhat is the text to speak which incorporates XML for either a high or low pitch:</p>\n\n<pre><code>Excel.Application.Speech.Speak Text:=\"&lt;?xml version='1.0'?&gt; &lt;speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'&gt;\" &amp; SayWhat &amp; \"&lt;/speak&gt;\", SpeakAsync:=Async, SpeakXML:=True\n</code></pre>\n\n<p>And the SayWhat variable would begin with </p>\n\n<pre><code>&lt;prosody pitch = 'high'&gt; \n</code></pre>\n\n<p>and end with</p>\n\n<pre><code>&lt;/prosody&gt; \n</code></pre>\n\n<p>for a child voice and would begin with </p>\n\n<pre><code>&lt;prosody rate = '-15%'&gt;&lt;prosody pitch = 'low'&gt;\n</code></pre>\n\n<p>and end with</p>\n\n<pre><code>&lt;/prosody&gt;&lt;/prosody&gt;\n</code></pre>\n\n<p>for an adult voice.</p>\n\n<p>On Windows 10, Microsoft David Desktop is the default voice in the TTS settings.  </p>\n\n<p>What I am trying to do now, is use the Windows 10 David voice for the adult and the Windows 10 Zira voice for the child.  However, when I use the following code, it is only spoken in David's voice and never Zira's.</p>\n\n<pre><code>Excel.Application.Speech.Speak Text:=\"&lt;?xml version='1.0'?&gt; &lt;speak version='1.1' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'&gt;\" &amp; \"&lt;voice name='MicrosoftZiraDesktop-English(UnitedStates)'&gt;I am Zira.&lt;/voice&gt;&lt;voice name='MicrosoftDavidDesktop-English(UnitedStates)'&gt;I am David.&lt;/voice&gt;\" &amp; \"&lt;/speak&gt;\", SpeakAsync:=Async, SpeakXML:=True\n</code></pre>\n\n<p>That does not work.  Nor does this:</p>\n\n<pre><code>Excel.Application.Speech.Speak Text:=\"&lt;?xml version='1.0'?&gt; &lt;speak version='1.1' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.w3.org/2001/10/synthesis' xml:lang='en-US'&gt;\" &amp; \"&lt;voice name='Zira'&gt;I am Zira.&lt;/voice&gt;&lt;voice name='David'&gt;I am David.&lt;/voice&gt;\" &amp; \"&lt;/speak&gt;\", SpeakAsync:=Async, SpeakXML:=True\n</code></pre>\n\n<p>Nor do any number of variations I try with the voice string.</p>\n\n<p>Although the online documentation I've found for SSML/XML all indicate that my syntax for the  element is correct, I cannot switch voices.  </p>\n\n<p>Can anyone identify the correct SSML/XML code that will work to actually change the voice.</p>\n\n<p>(Note:  If I change the default voice to Zira instead of David, then the above code will speak in Zira's voice instead of David's and will not switch to David.)</p>\n"}, {"tags": ["excel", "named-ranges", "addressing", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467225833, "post_id": 38107714, "comment_id": 63649089, "body": "It is a range. So you can use <code>Dim myCell as Range</code>."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467225980, "post_id": 38107714, "comment_id": 63649164, "body": "Hi @MattCremeens ---Do you mean the strings can be reassigned as ranges? Thanks for your help."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467226076, "post_id": 38107714, "comment_id": 63649227, "body": "You can add a string that represents a cell reference as a parameter to <code>Range(...)</code>. See my answer below."}, {"owner": {"reputation": 875, "user_id": 1393894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AijdQ.jpg?s=128&g=1", "display_name": "hammythepig", "link": "https://stackoverflow.com/users/1393894/hammythepig"}, "edited": false, "score": 0, "creation_date": 1467227852, "post_id": 38107714, "comment_id": 63650286, "body": "@PBG Hi PBG! Rather than adding an edit to thank Matt for his help, you can click the check mark under his answer to mark this question as answered :)"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467226121, "post_id": 38107777, "comment_id": 63649267, "body": "If &quot;G12&quot; itself is a string, would this still work?  Thanks for your help."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467226169, "post_id": 38107777, "comment_id": 63649301, "body": "Not sure what you mean. &quot;G12&quot; is indeed a string itself."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467226552, "post_id": 38107777, "comment_id": 63649531, "body": "If instead of &quot;G12&quot;, I pass a string variable equal to &quot;G12&quot; to a range (i.e. Range(CellReferenceAsString))."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467226600, "post_id": 38107777, "comment_id": 63649556, "body": "Like <code>myCell = &quot;G12&quot;</code> and then <code>Range(myCell)</code>? Yes, you could do that."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467226699, "post_id": 38107777, "comment_id": 63649623, "body": "Thank you. @MattCremeens"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467227083, "post_id": 38107777, "comment_id": 63649862, "body": "Matt ---I actually think we have misunderstood each other.  I am trying to make a named range, specifying the &#39;RefersTo&#39; parameter as a cell reference that is stored in a string variable."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467227870, "post_id": 38107777, "comment_id": 63650293, "body": "Then just do <code>Range(&quot;G12&quot;).Name = &quot;MyRange&quot;</code>"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467227937, "post_id": 38107777, "comment_id": 63650336, "body": "Or if <code>myCell = &quot;G12&quot;</code> then just do <code>Range(myCell).Name = &quot;MyRange&quot;</code>."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467228175, "post_id": 38107777, "comment_id": 63650464, "body": "Thanks, Matt...If you look above at my original post, though, I am trying to use the Names.Add method by substituting something like &#39;myCell&#39; as a cell reference parameter (the method calls for), (see &#39;RefersTo:=...&#39;, specifically)."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467228364, "post_id": 38107777, "comment_id": 63650574, "body": "You can add a name like I demonstrated in my comment. Try it."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467228575, "post_id": 38107777, "comment_id": 63650670, "body": "<code>Range(myCell1, myCell2).Name = &quot;MyRange&quot;</code>"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467228662, "post_id": 38107777, "comment_id": 63650721, "body": "Not sure what your comment means, but you could name a section of cells similarly to <code>Range(cells(1,1), cells(5,5)).Name = &quot;MyRange&quot;</code>."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467228777, "post_id": 38107777, "comment_id": 63650776, "body": "That last comment would assign all cells in the range from A1 to E5 to the name &quot;MyRange&quot;."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467229859, "post_id": 38107777, "comment_id": 63651308, "body": "If you want to name a range that spans cells between <code>G12</code> and <code>AW12</code> (per your question), then you can just do <code>Range(myCell1, myCell2).Name = &quot;MyRange&quot;</code>"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467232692, "post_id": 38107777, "comment_id": 63652727, "body": "I understand, Matt, and thank you for your help.  I was just curious if specifically there is any way to structure the &#39;RefersTo&#39; parameter such that the cell references it calls for could be substituted as string variables representing those cell references."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467233461, "post_id": 38107777, "comment_id": 63653146, "body": "What I showed you and what you were trying to do with the <code>RefersTo</code> way accomplish the exact same thing. The way I showed you is more succinct and I showed you how to use variables that store strings that refer to cell ranges."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467233589, "post_id": 38107777, "comment_id": 63653201, "body": "If you absolutely must use that notation, try <code>Worksheets(&quot;Sheet1&quot;).Names.Add Name:=&quot;MyRange3&quot;, RefersTo:=Range(myCell1, myCell2)</code>."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1467233611, "post_id": 38107777, "comment_id": 63653218, "body": "Matt, I understand that, and so selected your answer.  I appreciate the notation help, just above, too.  Thanks."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 2, "last_activity_date": 1467226710, "last_edit_date": 1467226710, "creation_date": 1467225972, "answer_id": 38107777, "question_id": 38107714, "link": "https://stackoverflow.com/questions/38107714/what-data-type-is-an-excel-cell-reference-vba/38107777#38107777", "title": "What Data Type is an Excel Cell Reference (VBA)?", "body": "<p>What I believe you are meaning to do is</p>\n\n<pre><code>Dim UpperLeftHandCornerOfRangeCellReference As Range    \nSet UpperLeftHandCornerOfRangeCellReference = Range(\"G12\")\n</code></pre>\n\n<p>Must use the <code>Set</code> keyword when assigning ranges to variables.</p>\n\n<p>If you want to store your string like</p>\n\n<pre><code>myCell = \"G12\"\n</code></pre>\n\n<p>then just change the 2nd line above to</p>\n\n<pre><code>Set UpperLeftHandCornerOfRangeCellReference = Range(myCell)\n</code></pre>\n\n<p>Now if you had a cell that was a named range (maybe that is what you mean by a cell reference being a string??), you could do this instead</p>\n\n<pre><code>Set UpperLeftHandCornerOfRangeCellReference = Worksheets(\"Sheet1\").Names(\"MyRangeName\").RefersToRange\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4543, "favorite_count": 1, "accepted_answer_id": 38107777, "answer_count": 1, "score": 0, "last_activity_date": 1467229615, "creation_date": 1467225714, "last_edit_date": 1531161705, "question_id": 38107714, "link": "https://stackoverflow.com/questions/38107714/what-data-type-is-an-excel-cell-reference-vba", "title": "What Data Type is an Excel Cell Reference (VBA)?", "body": "<p>What data type is an Excel cell reference?  I have constructed strings representing cell references (e.g. \"G12\", \"AW12\", etc.), and want to use them to create named ranges;</p>\n\n<pre><code>Dim UpperLeftHandCornerOfRangeCellReference As String\nUpperLeftHandCornerOfRangeCellReference = \"G12\"\nDim LowerRightHandCornerOfRangeCellReference As String    \nLowerRightHandCornerOfRangeCellReference = \"AW12\"\nNamedSheet.Names.Add _\n            name:=RangeName, _\n            RefersTo:=\"=Sheet!UpperLeftHandCornerOfRangeCellReference:LowerRightHandCornerOfRangeCellReference\"\n</code></pre>\n\n<p>but, they are not interpreted as cell references, rather the names of the respective strings, and the named range thus not created.  Any ideas? Please share. Thanks!</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Thank you @MattCremeens for your help.</p>\n\n<p>Consider if it <em>had</em> to be done this way;</p>\n\n<pre><code>Dim myCell1 As String\nmyCell1 = \"G12\"\nDim myCell2 As String\nmyCell2 = \"AW12\"\nNamedSheet.Names.Add _\n            name:=RangeName, _\n            RefersTo:=\"=Sheet!myCell1:myCell2\"\n</code></pre>\n\n<p>such would not work because the quotations in the 'RefersTo' parameter do not allow the string variables 'myCell(1/2)' to be read.  Is there some way to fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467226391, "post_id": 38107655, "comment_id": 63649452, "body": "Duplicate: <a href=\"https://stackoverflow.com/questions/13943501/copy-and-paste-loop-based-on-cell-value/13944057#13944057\" title=\"copy and paste loop based on cell value\">stackoverflow.com/questions/13943501/&hellip;</a>"}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467226829, "post_id": 38107655, "comment_id": 63649712, "body": "@TimWilliams so it does! Many apologies, thank you :)"}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467226903, "post_id": 38107655, "comment_id": 63649755, "body": "<a href=\"https://stackoverflow.com/questions/13943501/copy-and-paste-loop-based-on-cell-value/13944057#13944057\" title=\"copy and paste loop based on cell value\">stackoverflow.com/questions/13943501/&hellip;</a>"}], "owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467225526, "creation_date": 1467225526, "question_id": 38107655, "link": "https://stackoverflow.com/questions/38107655/copy-data-to-another-workbook-and-filter-to-different-sheets-based-on-criteria", "title": "Copy data to another workbook and filter to different sheets based on criteria", "body": "<p>I have written the below script to copy a range of data from one sheet to another workbook based on a set of criteria. I now need to add an extra piece to filter this acceptable data to different sheets named after the values in column G and if the value doesn't already exist to create the sheet named after the value. For example if column G value = JULA then to copy this to sheet JULA however if this doesn't already exist then to create and copy.</p>\n\n<pre><code>Private Sub cmdArchive_click()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nDim LastRow As Integer, i As Integer, erow As Integer\n\niForm = (\"\\\\Insurance\\It\\FileData\\Computers\\Release Note\\Collated Release  Records\\Master.xlsx\")\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To LastRow\n\nIf Cells(i, 1) &lt;&gt; \"\" And Cells(i, 9) = \"\" And Cells(i, 9) = \"\" Then\nRange(Cells(i, 1), Cells(i, 4)).Select\nSelection.Copy\n\nworkbooks.Open Filename:=iForm\n\nWorksheets(\"Scheduled Forms\").Select\nerow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nActiveSheet.Cells(erow, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nActiveWorkbook.Close\nApplication.CutCopyMode = False\nEnd If\n\nNext i\n\nMsgBox (\"iForms have been archived, please clear the Team Release notes  ready for the next implimentation window\"), vbInformation + vbOKOnly,  \"Complete!\"\n\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226010, "creation_date": 1467226010, "answer_id": 38107789, "question_id": 38107647, "link": "https://stackoverflow.com/questions/38107647/make-excel-formula-auto-add-itself-when-new-rows-added/38107789#38107789", "title": "Make Excel Formula auto-add itself when new rows added", "body": "<p>If the formula is already in the cell above, you can do the below:</p>\n\n<pre><code>.Range(.Cells(iRow - 1, 1).Address,.Cells(iRow, 1).Address).Filldown\n</code></pre>\n\n<p>This will fill the formula from the cell above to the cell in question.</p>\n"}, {"comments": [{"owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "edited": false, "score": 0, "creation_date": 1467226853, "post_id": 38107868, "comment_id": 63649726, "body": "This is exactly what I needed! Thanks so much"}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1467226266, "creation_date": 1467226266, "answer_id": 38107868, "question_id": 38107647, "link": "https://stackoverflow.com/questions/38107647/make-excel-formula-auto-add-itself-when-new-rows-added/38107868#38107868", "title": "Make Excel Formula auto-add itself when new rows added", "body": "<p>You can use the range relative formula property <code>.FormulaR1C1</code> to make formula references adjust relatively:</p>\n\n<pre><code>.Cells(iRow, 1).FormulaR1C1 = .Cells(iRow - 1, 1).FormulaR1C1\n</code></pre>\n\n<p>You can also use the regular <code>.Formula</code> properties instead, if you want the exact same formula, without relative references updating.</p>\n\n<p>You can also do it for all 4 columns at once:</p>\n\n<pre><code>.Cells(iRow, 1).Resize(, 4).FormulaR1C1 = .Cells(iRow - 1, 1).Resize(, 4).FormulaR1C1\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 0, "accepted_answer_id": 38107868, "answer_count": 2, "score": 0, "last_activity_date": 1467226266, "creation_date": 1467225498, "question_id": 38107647, "link": "https://stackoverflow.com/questions/38107647/make-excel-formula-auto-add-itself-when-new-rows-added", "title": "Make Excel Formula auto-add itself when new rows added", "body": "<p>I have added a User Form to an excel spreadsheet that asks a user a question and adds it to a new row in a spreadsheet.</p>\n\n<p>Each column in the spreadsheet has its own formula that calculates based off user input. </p>\n\n<p>Is there a way that I can have excel automatically \"pull\" the formula that is contiguous in the column into the added row?</p>\n\n<p>I imagine that I can change it in the code for my User Form, so when a person hits \"Submit\" all the cells update. But I only know how to update the value, not add a formula in place. Here is part of the code I have:</p>\n\n<pre><code>    .Cells(iRow, 6).Value = Me.TextBox1.Value\n    .Cells(iRow, 7).Value = Me.TextBox2.Value\n    .Cells(iRow, 8).Value = Me.TextBox3.Value\n    .Cells(iRow, 9).Value = Me.TextBox4.Value\n    .Cells(iRow, 10).Value = Me.TextBox5.Value\n    .Cells(iRow, 11).Value = Me.TextBox6.Value\n    .Cells(iRow, 12).Value = Me.TextBox7.Value\n    .Cells(iRow, 13).Value = Me.TextBox8.Value\n    .Cells(iRow, 14).Value = Me.TextBox9.Value\n    .Cells(iRow, 15).Value = Me.TextBox10.Value\n</code></pre>\n\n<p>Is it possible to add something to change the cell values 1-4? Maybe like this:</p>\n\n<pre><code>.Cells(iRow, 1).Value = *insert formula here*\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1467230685, "post_id": 38107232, "comment_id": 63651714, "body": "I don&#39;t see where you refresh your recordset for &#39;frmPatients&#39;. Is that form bound to the recordset &#39;tblPatients&#39;? What is the recordsource for form &#39;frmDSA&#39;  Take a look at the following link and see if that helps. <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-access/cannot-add-record-join-key-of-table-is-not-in/9df69347-3303-4442-a1f6-b9302cddf4c2?auth=1\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2010-access/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1467230952, "post_id": 38107232, "comment_id": 63651858, "body": "It sounds like every record in DSAfrm&#39;s recordsource has to have a matching ID in frmPatient&#39;s recordsource. Just by adding the WhereCondition when you open the form is not going to load the matching ID - you&#39;re going to have to set it when you load the form - perhaps by passing a parameter to the OpenForm command?"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1467235247, "post_id": 38107232, "comment_id": 63653998, "body": "@Wayne, I need to refresh record set? The recordsource for form &#39;DSAfrm&#39; is a query qryPatientDSA that joins both tables and contains all the fields.  Is that the problem? Thanks"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1467235629, "post_id": 38107232, "comment_id": 63654159, "body": "Could you please explain how to set ID when I load &#39;DSAfrm&#39;?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1467236305, "post_id": 38107232, "comment_id": 63654468, "body": "If: (a) your query is joining both tables; and (b) the DSA record does not yet exist; and (c) you use an &#39;Inner Join&#39;, you will not have the desired record. A left join would allow you to &#39;see&#39; the Patient in frmDSA, or possibly a better solution is to add code to your above sub to add a &#39;placeholder&#39; DSA record?"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1467236949, "post_id": 38107232, "comment_id": 63654746, "body": "I display information from tblPatients on &#39;DSAfrm&#39;.. that is the reason for the joining both tables. Could you please suggest an example code that will solve this problem? Thanks"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1467255106, "post_id": 38107232, "comment_id": 63659721, "body": "Just before your line of code &#39;&#39;Let the user know it worked.&#39; you can add code to save a DSA record with the required key. Thus when the next form is opened, it will have the TWO recquired records joined together."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1467987718, "post_id": 38107232, "comment_id": 63957466, "body": "After I added code that creates  a new  DSA records the button code above executes.  However, when I close frmDSA and navigate to frmPatient, Access tries to save the new patient twice for some reason.  Please see <a href=\"http://stackoverflow.com/questions/38254905/run-time-error-3022-duplicate-values?noredirect=1#comment63940373_38254905\" title=\"run time error 3022 duplicate values\">stackoverflow.com/questions/38254905/&hellip;</a>. I&#39;m open to any suggestions. Thanks"}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594641799, "creation_date": 1467224113, "last_edit_date": 1594641799, "question_id": 38107232, "link": "https://stackoverflow.com/questions/38107232/access-error-can-not-add-records-joint-key-of-table-tablename-not-in-recordse", "title": "Access error: can not add records joint key of table &#39;TableName&#39; not in recordset", "body": "<p>I have two linked Tables 'tblPatients' and 'tblDSA' and two continues forms 'frmPatients' and 'frmDSA'. When I create a new patient via 'frmPatient'I would like to add a new record for that patient in 'frmDSA' without closing the form. </p>\n\n<p>On 'frmPatients' next to each record there is a button 'SaveNewRecord' that does the following:</p>\n\n<p>(1)saves a new record to 'tblPatients' and also filters \n(2) opens 'frmDSA' to display related records to that Patients. </p>\n\n<p>Here is the filtering code:</p>\n\n<pre><code>If Not Me.NewRecord Then\n    DoCmd.OpenForm \"DSAfrm\", _\n        WhereCondition:=\"LABCODE=\" &amp; Me.LABCODE\nEnd If \n</code></pre>\n\n<p>Here is what happens: </p>\n\n<p>After the 'DSAfrm' pops up and I try to enter a new record I get the following error.\"can not add records joint key of table 'TableName' not in record-set\"</p>\n\n<p>The new patient has been save to 'tblPatients' but Access is not letting me add any new records. Please help!</p>\n\n<p>Here is the code that I use to save the new records:</p>\n\n<pre><code>Private Sub Command385_Click()\n\nDim db As DAO.Database\n\nDim PatientTable As DAO.Recordset\nDim DSAtable As DAO.Recordset2\n\nDim errMsg As String 'Where we will store error messages\n\nDim errData As Boolean 'Default = False   if we have an error we will set it to True.\n\nDim i As Integer 'used as a counter in For..Next loops.\nDim x As Integer 'used as counter in For..Next loops.\n\nDim errorArray(0 To 3) As String 'Array to hold the error messages so we can 'use them if needed.\n\nIf Me.LABCODE.Value = \"\" Then\n            errorArray(0) = \"Must Enter Labcode.\"\n            errData = True\nEnd If\nIf Me.LastName.Value = 0 Then\n            errorArray(1) = \"Must Enter Patient Number\"\n            errData = True\nEnd If\nIf Me.FirstName.Value = \"\" Then\n            errorArray(2) = \"Must Enter Insurance Type\"\n            errData = True\nEnd If\nIf Me.MRN.Value = \"\" Then\n            errorArray(3) = \"Must Enter Intake Nurse\"\n            errData = True\nEnd If\n\n\n\n'MsgBox \"errData = \" &amp; errData\nIf errData = True Then\n  i = 0\n  x = 0\n    For i = 0 To 3\n        If errorArray(i) &lt;&gt; \"\" Then\n            If x &gt; 0 Then\n            errMsg = errMsg &amp; vbNewLine &amp; errorArray(i)\n            Else\n            errMsg = errorArray(i)\n            x = x + 1\n            End If\n        End If\n    Next i\n\n    MsgBox errMsg &amp; vbNewLine &amp; \"Please try again.\"\n    errMsg = \"\"\n    Me.LABCODE.SetFocus\n    Exit Sub\nEnd If\n\nSet db = CurrentDb()\nSet PatientTable = db.OpenRecordset(\"tblPatients\")\n\n    With PatientTable\n        .AddNew\n        !LABCODE = Me.LABCODE.Value\n        !LastName = Me.LastName.Value\n        !FirstName = Me.FirstName.Value\n        !MRN = Me.MRN.Value\n        !MRNTwo = Me.MRN2.Value\n        Debug.Print Me.MRN.Value\n        '!CPI#2 = Me.MRN2.Value\n        !Kidney = Me.cbKidney.Value\n        !Heart = Me.cbHeart.Value\n        !Lung = Me.cbLung.Value\n        !Liver = Me.cbLiver.Value\n        !Pancreas = Me.cbPancreas.Value\n\n        !DateLogged = Format(Date, \"MM/DD/YY\")\n        .Update\n    End With\n'End If\n  Set DSAtable = db.OpenRecordset(\"tblDSA\")\n        With DSAtable\n            .AddNew\n            !LABCODE = Me.LABCODE.Value\n            .Update\n        End With\n'Let the user know it worked.\nMsgBox \"This patient has been added successfully.\", vbOKOnly\n\n 'If Not Me.NewRecord Then\n    DoCmd.OpenForm \"DSAfrm\", _\n        WhereCondition:=\"LABCODE=\" &amp; Me.LABCODE\n'End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1467223300, "post_id": 38106915, "comment_id": 63647535, "body": "I believe the <code>Replace</code> method acts upon a range, not a worksheet."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467223853, "post_id": 38106915, "comment_id": 63647865, "body": "Now that you have your answer (yay!), I <b>highly</b> suggest reading through, and implementing, <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a>. It will make your code tighter, less prone to errors, and will teach you how to work directly with your data. This will allow your macro to run faster as well."}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1467223582, "last_edit_date": 1467223582, "creation_date": 1467223425, "answer_id": 38107015, "question_id": 38106915, "link": "https://stackoverflow.com/questions/38106915/selecting-workbook-and-find-replace/38107015#38107015", "title": "Selecting workbook and find/replace", "body": "<p>You need to change </p>\n\n<pre><code>ActiveSheet.Replace What:=unspecified, Replacement:=organic, LookAt _ :=xlPart, SearchOrder:=xlByRows, MatchCase:=False\n</code></pre>\n\n<p>to the following</p>\n\n<pre><code>ActiveSheet.Cells.Replace What:=unspecified, Replacement:=organic, LookAt _ :=xlPart, SearchOrder:=xlByRows, MatchCase:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467223946, "post_id": 38107160, "comment_id": 63647920, "body": "You mean <code>ws.Cells.Replace...</code>? I&#39;d stay away from <code>ActiveSheet</code>, and use a variable instead ."}, {"owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1467223959, "post_id": 38107160, "comment_id": 63647936, "body": "Sorry i did mean Workbooks."}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467224045, "post_id": 38107160, "comment_id": 63647983, "body": "You would have to quit the Foreach for that to work. If any other sheet follows the Date-Usage sheet it would try to use that one.  I&#39;ll edit my comment to reflect that."}, {"owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1467224150, "post_id": 38107160, "comment_id": 63648062, "body": "No worries. I found out the problem. It is a .csv file, so i just added. *-Usage.csv and it worked. Thank you though!"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467225191, "post_id": 38107160, "comment_id": 63648695, "body": "Workbook.Name should not return the extension though."}], "tags": [], "owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "is_accepted": false, "score": 0, "last_activity_date": 1467224126, "last_edit_date": 1467224126, "creation_date": 1467223892, "answer_id": 38107160, "question_id": 38106915, "link": "https://stackoverflow.com/questions/38106915/selecting-workbook-and-find-replace/38107160#38107160", "title": "Selecting workbook and find/replace", "body": "<p>Now you said that you want a find a <strong>Sheet</strong> that's like <em>(DATES)-Usage</em>, but you're looking in Workbooks:</p>\n\n<pre><code> For Each wb In Workbooks\n      If wb.Name Like \"*-Usage\" Then\n          wb.Activate\n      End If\n  Next\n</code></pre>\n\n<p>Try it like this: <em>(edited)</em></p>\n\n<pre><code> For Each ws In Worksheets\n      If ws.Name Like \"*-Usage\" Then\n          Exit For\n      End If\n  Next\n</code></pre>\n\n<p>Accoriding to MSDN: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194086.aspx\" rel=\"nofollow\">Replace</a>, is a Range method.</p>\n\n<p>So instead of this: </p>\n\n<pre><code>ActiveSheet.Replace What:=unspecified, Replacement:=organic, LookAt _\n  :=xlPart, SearchOrder:=xlByRows, MatchCase:=False\n</code></pre>\n\n<p>Try this:</p>\n\n<pre><code>ws.Cells.Replace What:=unspecified, Replacement:=organic, LookAt _\n      :=xlPart, SearchOrder:=xlByRows, MatchCase:=False\n</code></pre>\n\n<p>Cheers.</p>\n"}, {"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1467225437, "creation_date": 1467225437, "answer_id": 38107628, "question_id": 38106915, "link": "https://stackoverflow.com/questions/38106915/selecting-workbook-and-find-replace/38107628#38107628", "title": "Selecting workbook and find/replace", "body": "<p>Change these lines</p>\n\n<pre><code>Range(\"A3\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nRange(\"B3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=True, Transpose:=False  \n</code></pre>\n\n<p>to these lines</p>\n\n<pre><code>With ActiveSheet\n    .Range(Range(\"A3\"), Range(\"A3\").End(xlDown)).Copy\n    .Range(\"B3\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=True\nEnd With\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>You do not need all the <code>Select</code> methods.</p>\n"}], "owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 38107015, "answer_count": 3, "score": 0, "last_activity_date": 1467225437, "creation_date": 1467223058, "last_edit_date": 1467223944, "question_id": 38106915, "link": "https://stackoverflow.com/questions/38106915/selecting-workbook-and-find-replace", "title": "Selecting workbook and find/replace", "body": "<p>There is actually two questions in this post. Thank you in advance.</p>\n\n<p>My first problem is that I cannot seem to get Excel to choose the Excel workbook that is named \"(DATES)-Usage\", where (DATES) changes each day. </p>\n\n<p>Second problem is that the <code>.Replace</code> Object is giving me and <code>Run-Time error '438': Object doesn't support this property method</code>. Could someone please take a look and tell me where I am making my mistakes. Thank you again!</p>\n\n<pre><code>Sub UsersBySource_Update()\n\n  ' Create variables\n  Dim ws As Worksheet\n  Dim wb As Workbook\n  Dim unspecified As String\n  Dim organic As String\n  Dim TheString As String, Cohort As Date\n\n  ' Ask user for cohort date and return an error if invalid date is entered\n  TheString = Application.InputBox(\"Please Specify The Cohort:\")\n\n  If IsDate(TheString) Then\n      Cohort = DateValue(TheString)\n  Else\n      MsgBox (\"Invalid Date\")\n  End If\n\n  ' Set variables\n  unspecified = \"[Unspecified]\"\n  organic = \"Organic\"\n\n  ' Activate the workbook\n  For Each wb In Workbooks\n      If wb.Name Like \"*-Usage\" Then\n          wb.Activate\n      End If\n  Next\n\n  ' Find and Replace the unspecified and organic variables in the workbook\n  ActiveSheet.Replace What:=unspecified, Replacement:=organic, LookAt _\n  :=xlPart, SearchOrder:=xlByRows, MatchCase:=False\n\n  ' Add Columns and Row to fix formatting to continue\n  Columns(\"B:E\").Insert shift:=xlToRight\n  Range(\"B2\").EntireRow.Insert\n\n  ' Copy and Paste initial date range to start program\n  Range(\"A3\").Select\n  Range(Selection, Selection.End(xlDown)).Select\n  Selection.Copy\n  Range(\"B3\").Select\n  Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n  :=True, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467223641, "post_id": 38106746, "comment_id": 63647737, "body": "Create an <code>UpdateLabel</code> sub and call that from the events for each of the inputs: <code>UpdateLabel</code> would read the control values and change the label as needed."}, {"owner": {"reputation": 33, "user_id": 5551006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8e28abc486cb6e845300b8b93fcfef?s=128&d=identicon&r=PG&f=1", "display_name": "jtrousd", "link": "https://stackoverflow.com/users/5551006/jtrousd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467311498, "post_id": 38106746, "comment_id": 63692660, "body": "Got it working doing this. Thanks, Tim."}], "owner": {"reputation": 33, "user_id": 5551006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f8e28abc486cb6e845300b8b93fcfef?s=128&d=identicon&r=PG&f=1", "display_name": "jtrousd", "link": "https://stackoverflow.com/users/5551006/jtrousd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467222482, "creation_date": 1467222482, "question_id": 38106746, "link": "https://stackoverflow.com/questions/38106746/update-label-output-when-any-input-changes-vba-userform", "title": "Update Label Output when Any Input Changes - VBA Userform", "body": "<p>VBA neophyte here. Here's the code:</p>\n\n<pre><code>Dim oper_state As Integer\nDim r As Integer\nDim c As Integer\nDim timehr As Double\nDim timemin As Double\n\nPublic Sub UserForm_Initialize()\n\nr = 0\nc = 0\n\nAAATemp.Value = \"\"\nLineTemp.Value = \"\"\n\nOperational.Value = False\nDeactivated.Value = False\n\nAAATemp.SetFocus\nHOPA.Output.Caption = \"Insert Temperature Data\"\n\nEnd Sub\n\nPublic Sub Deactivated_Click()\n\nIf Deactivated = True Then\n    oper_state = 0\nEnd If\n\nEnd Sub\n\nPublic Sub Operational_Click()\n\nIf Operational = True Then\n    oper_state = 1\nEnd If\n\nEnd Sub\n\nPublic Sub AAATemp_Change()\n\nIf AAATemp.Value &lt; 18.3 Then\n    r = 3\nElseIf (AAATemp.Value &gt;= 18.3 And AAATemp.Value &lt;= 19.4) Then\n    r = 4\nElseIf (AAATemp.Value &gt;= 19.4 And AAATemp.Value &lt;= 20.6) Then\n    r = 5\nElseIf (AAATemp.Value &gt;= 20.6 And AAATemp.Value &lt;= 21.7) Then\n    r = 6\nElseIf (AAATemp.Value &gt;= 21.7 And AAATemp.Value &lt;= 22.8) Then\n    r = 7\nElseIf (AAATemp.Value &gt;= 22.8 And AAATemp.Value &lt;= 23.9) Then\n    r = 8\nElseIf (AAATemp.Value &gt;= 23.9 And AAATemp.Value &lt;= 25) Then\n    r = 9\nElseIf (AAATemp.Value &gt;= 25 And AAATemp.Value &lt;= 26.1) Then\n    r = 10\nElseIf (AAATemp.Value &gt;= 26.1 And AAATemp.Value &lt;= 27.2) Then\n    r = 11\nElseIf (AAATemp.Value &gt;= 27.2 And AAATemp.Value &lt;= 28.3) Then\n    r = 12\nElseIf (AAATemp.Value &gt;= 28.3 And AAATemp.Value &lt;= 29.4) Then\n    r = 13\nElseIf (AAATemp.Value &gt;= 29.4 And AAATemp.Value &lt;= 30.6) Then\n    r = 14\nElse\n    r = 15\nEnd If\n\nIf (r = 0 Or c = 0) Then\n    HOPA.Output.Caption = \"Insert Temperature Data\"\nElseIf (oper_state = 1 And r &lt;&gt; 0 And c &lt;&gt; 0) Then\n    timehr = Worksheets(\"HOPA Times\").Cells(r, c).Value\n    timemin = timehr * 60\n    If timehr = 9999 Then\n        HOPA.Output.Caption = \"Inf\"\n    ElseIf timehr &lt; 9999 Then\n        HOPA.Output.Caption = timehr &amp; \" (\" &amp; timemin &amp; \" minutes)\"\n    End If\nElseIf (oper_state = 0 And r &lt;&gt; 0 And c &lt;&gt; 0) Then\n    r = r + 16\n    timehr = Worksheets(\"HOPA Times\").Cells(r, c).Value\n    timemin = timehr * 60\n    If timehr = 9999 Then\n        HOPA.Output.Caption = \"Inf\"\n    ElseIf timehr &lt; 9999 Then\n        HOPA.Output.Caption = timehr &amp; \" (\" &amp; timemin &amp; \" minutes)\"\n    End If\nEnd If\n\nEnd Sub\n\nPublic Sub LineTemp_Change()\n\nIf LineTemp.Value &lt; 14.7 Then\n    c = 2\nElseIf (LineTemp.Value &gt;= 14.7 And LineTemp.Value &lt;= 15.8) Then\n    c = 3\nElseIf (LineTemp.Value &gt;= 15.8 And LineTemp.Value &lt;= 16.9) Then\n    c = 4\nElseIf (LineTemp.Value &gt;= 16.9 And LineTemp.Value &lt;= 18) Then\n    c = 5\nElseIf (LineTemp.Value &gt;= 18 And LineTemp.Value &lt;= 19.2) Then\n    c = 6\nElseIf (LineTemp.Value &gt;= 19.2 And LineTemp.Value &lt;= 20.3) Then\n    c = 7\nElseIf (LineTemp.Value &gt;= 20.3 And LineTemp.Value &lt;= 21.4) Then\n    c = 8\nElseIf (LineTemp.Value &gt;= 21.4 And LineTemp.Value &lt;= 22.5) Then\n    c = 9\nElseIf (LineTemp.Value &gt;= 22.5 And LineTemp.Value &lt;= 23.6) Then\n    c = 10\nElseIf (LineTemp.Value &gt;= 23.6 And LineTemp.Value &lt;= 24.7) Then\n    c = 11\nElseIf (LineTemp.Value &gt;= 24.7 And LineTemp.Value &lt;= 25.8) Then\n    c = 12\nElse\n    c = 13\nEnd If\n\nIf (r = 0 Or c = 0) Then\n    HOPA.Output.Caption = \"Insert Temperature Data\"\nElseIf (oper_state = 1 And r &lt;&gt; 0 And c &lt;&gt; 0) Then\n    timehr = Worksheets(\"HOPA Times\").Cells(r, c).Value\n    timemin = timehr * 60\n    If timehr = 9999 Then\n        HOPA.Output.Caption = \"Inf\"\n    ElseIf timehr &lt; 9999 Then\n        HOPA.Output.Caption = timehr &amp; \" (\" &amp; timemin &amp; \" minutes)\"\n    End If\nElseIf (oper_state = 0 And r &lt;&gt; 0 And c &lt;&gt; 0) Then\n    r = r + 16\n    timehr = Worksheets(\"HOPA Times\").Cells(r, c).Value\n    timemin = timehr * 60\n    If timehr = 9999 Then\n        HOPA.Output.Caption = \"Inf\"\n    ElseIf timehr &lt; 9999 Then\n        HOPA.Output.Caption = timehr &amp; \" (\" &amp; timemin &amp; \" minutes)\"\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>These values are determined through a UserForm. The UserForm has two radio buttons, two text inputs, and one label (for output). The label changes dynamically based on the radio button selection and the user inputs - at least, that's what I'd like it to do.</p>\n\n<p>Unfortunately, the label output only updates when I make changes to the AAA or LineTemp text boxes. Nothing happens when I click between radio buttons. If I do change a radio button selection, I need to go in and make a change to a textbox input (typically just delete the decimal and re-enter it). </p>\n\n<p>I've tried moving the radio button logic inside the change subs, but obviously that doesn't work. Is there a way to have Excel look at the entire form and check for changes?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1467249618, "creation_date": 1467249618, "answer_id": 38112494, "question_id": 38106657, "link": "https://stackoverflow.com/questions/38106657/can-i-extract-a-list-of-llayout-names-from-a-powerpoint-template/38112494#38112494", "title": "Can I extract a list of llayout names from a PowerPoint template?", "body": "<p>Like so:</p>\n\n<pre><code>Sub ShowMeStuff()\n    Dim oDes As Design\n    Dim oLay As CustomLayout\n\n    For Each oDes In ActivePresentation.Designs\n        Debug.Print oDes.Name\n        For Each oLay In oDes.SlideMaster.CustomLayouts\n            Debug.Print vbTab &amp; oLay.Name\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6529721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63ee5201b2496c0940660b9b770915b?s=128&d=identicon&r=PG&f=1", "display_name": "Beanie", "link": "https://stackoverflow.com/users/6529721/beanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467249618, "creation_date": 1467222134, "question_id": 38106657, "link": "https://stackoverflow.com/questions/38106657/can-i-extract-a-list-of-llayout-names-from-a-powerpoint-template", "title": "Can I extract a list of llayout names from a PowerPoint template?", "body": "<p>I am updating some presentations and it would be helpful to extract a list of the layout names with VBA or another simple method rather than viewing each layout in slidemaster view and typing a list of all the layout names. </p>\n\n<p>The end goal is to make sure that when I apply the new template to old presentations, no new layouts are added. </p>\n\n<p>I want to compare layouts so that my new template contains defined layouts for all the names that are in the old templates. </p>\n\n<p>This is PPT 2013. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467225118, "post_id": 38106542, "comment_id": 63648657, "body": "Where <i>should</i> each section be pasted?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6529679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c098c7cc01317becbb24dc33c079f4?s=128&d=identicon&r=PG&f=1", "display_name": "salonepekin1", "link": "https://stackoverflow.com/users/6529679/salonepekin1"}, "is_accepted": false, "score": 0, "last_activity_date": 1467316967, "creation_date": 1467316967, "answer_id": 38132281, "question_id": 38106542, "link": "https://stackoverflow.com/questions/38106542/pasting-copied-cells-without-overwriting-previous-data/38132281#38132281", "title": "Pasting Copied Cells without overwriting previous data", "body": "<p>In the worksheet named \"Data\" that's in the wb that contains the macro. I want the succeeding copied data to automatically paste in the cell below the last active cell.</p>\n"}], "owner": {"reputation": 1, "user_id": 6529679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c098c7cc01317becbb24dc33c079f4?s=128&d=identicon&r=PG&f=1", "display_name": "salonepekin1", "link": "https://stackoverflow.com/users/6529679/salonepekin1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467316967, "creation_date": 1467221791, "last_edit_date": 1531164843, "question_id": 38106542, "link": "https://stackoverflow.com/questions/38106542/pasting-copied-cells-without-overwriting-previous-data", "title": "Pasting Copied Cells without overwriting previous data", "body": "<p>I am using file dialog to copy data from various excel files and paste them on a single worksheet. The second file however overwrites the data from the first file. The 1st data was pasted on range A2:E2710 on the destination workbook. If the 2nd set of data range is A2:A118, it will overwrite A2:A118 on the destination workbook. How do I get it to paste and not overwrite the previously pasted data?  I've tried Selection.Insert Shift:=xlDown but that does not paste the data. Please help. </p>\n\n<pre><code>Sub FASB_Select()\n'Create a FileDialog object as a File Picker dialog box.\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    Set ExcelSheet = CreateObject(\"Excel.Sheet\")\n 'Declare a variable to contain the path\n    'of each selected item. Even though the path is a String,\n    'the variable must be a Variant because For Each...Next\n    'routines only work with Variants and Objects.\n    Dim vrtSelectedItem As Variant\n\n    'Use a With...End With block to reference the FileDialog object.\n    With fd\n    'Use the Show method to display the File Picker dialog box and return the user's action.\n    'The user pressed the action button.\n    If .Show = -1 Then\n\n        Sheets(\"Data\").Select\n\n        'Step through each string in the FileDialogSelectedItems collection.\n        For Each vrtSelectedItem In .SelectedItems\n\n            'vrtSelectedItem is a String that contains the path of each selected item.\n            'You can use any file I/O functions that you want to work with this path.\n            'This example simply displays the path in a message box.\n            ThisWorkbook.FollowHyperlink (vrtSelectedItem)\n            'Clear CutCopyMode\n            Application.CutCopyMode = False\n            'Wait some time\n            Application.Wait Now + TimeValue(\"00:00:01\") ' wait 3 seconds\n            DoEvents\n\n            'IN Excel :\n            'SELECT ALL\n             Range(\"A2\").Select\n             Range(Selection, Selection.End(xlToRight)).Select\n             Range(Selection, Selection.End(xlDown)).Select\n             Selection.Copy\n            'EXIT (Close &amp; Exit)\n            Application.Wait Now + TimeValue(\"00:00:01\") ' wait 3 seconds\n            ActiveWorkbook.Close SaveChanges:=False\n\n            'Wait some time\n            Application.Wait Now + TimeValue(\"00:00:01\") ' wait 3 seconds\n             Range(\"A2\").Select\n            'Paste\n\n             ActiveSheet.Paste\n\n            Next vrtSelectedItem  'Loop for each file selected in the file dialog box\n\n    'Exit if the user pressed Cancel\n    Else\n        Exit Sub\n    End If\nEnd With\n\n'Set the object variable to Nothing\nSet fd = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467223772, "post_id": 38106404, "comment_id": 63647820, "body": "You would need VBA for this.  Is the file always open - ie. can it be guaranteed to be open at the required time?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2120683"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467226790, "post_id": 38106404, "comment_id": 63649674, "body": "Hmm, it wouldn&#39;t that&#39;s the thing. It might be a better idea to just input this manually. I figured VBA would be required, if there was something in Excel that would conduct this, I would be all for it. Thanks."}], "owner": {"user_type": "does_not_exist", "display_name": "user2120683"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467221307, "creation_date": 1467221307, "question_id": 38106404, "link": "https://stackoverflow.com/questions/38106404/extracting-cell-data-at-a-specific-point-in-time-in-excel", "title": "Extracting cell data at a specific point in time in Excel", "body": "<p>As the title says, I'm trying to extract the number from a cell at a specific date and time in Excel. In my example, I will be pulling information weekly from 3 particular cells. Ex. I want to pull the information on Friday's at 1:00PM. So I will want data on 7/1/16 1:00PM, 7/8/16 1:00PM, etc. During that exact time I want to pull a number from those cells and place it into a cell so I can create an automated trending graph. </p>\n\n<p>It'll only be 3 numbers that I am pulling so doing this manually wouldn't be difficult, but who wants to do things manually? Especially in Excel. I can't find a specific formula that would complete this for me. </p>\n\n<p>If anyone could provide any help, it would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 50, "user_id": 6529575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2940331d8a347135a34a94bb3a7c98d6?s=128&d=identicon&r=PG&f=1", "display_name": "Y H", "link": "https://stackoverflow.com/users/6529575/y-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467223827, "post_id": 38105834, "comment_id": 63647852, "body": "Not sure what most of this means, sorry. I&#39;m basically trying to filter an Outlook inbox to display items in between two times and then search by email name, get the SentOn date, and then paste the SentOn date to another spreadsheet.  The reason for this is because there are daily emails with the same name and I need to copy the SentOn date for an inputted date. Right now my code just takes the most recent email&#39;s SentOn datetime; I&#39;m trying to filter my inbox using AdvancedSearch and SQL but my syntax is wrong."}, {"owner": {"reputation": 50, "user_id": 6529575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2940331d8a347135a34a94bb3a7c98d6?s=128&d=identicon&r=PG&f=1", "display_name": "Y H", "link": "https://stackoverflow.com/users/6529575/y-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467224507, "post_id": 38105834, "comment_id": 63648296, "body": "Well, AdvancedSearch in VBA can&#39;t take anything other than SQL which is why I tagged this as such. I also tagged VBA and Excel VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467226652, "post_id": 38105834, "comment_id": 63649586, "body": "You&#39;re using the Outlook object model, &quot;Excel&quot; is as irrelevant as &quot;SQL&quot;. I&#39;ve edited your question to remove tags from the title, more precisely name things, and use tags that are appropriate for the API involved."}], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 6529575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2940331d8a347135a34a94bb3a7c98d6?s=128&d=identicon&r=PG&f=1", "display_name": "Y H", "link": "https://stackoverflow.com/users/6529575/y-h"}, "edited": false, "score": 0, "creation_date": 1467312637, "post_id": 38107882, "comment_id": 63693320, "body": "Thanks, worked like a charm. Used this: filterStr = &quot;urn:schemas:httpmail:subject = &#39;&quot; &amp; EmailName &amp; &quot;&#39; AND urn:schemas:httpmail:date &gt;= &#39;&quot; &amp; TDateUTC &amp; &quot;&#39; AND urn:schemas:httpmail:date &lt;= &#39;&quot; &amp; TDateUTCEOD &amp; &quot;&#39; &quot;"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1467227281, "last_edit_date": 1467227281, "creation_date": 1467226315, "answer_id": 38107882, "question_id": 38105834, "link": "https://stackoverflow.com/questions/38105834/application-advancedsearch-syntax-issues/38107882#38107882", "title": "Application.AdvancedSearch syntax issues", "body": "\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866933.aspx\" rel=\"nofollow\">MSDN</a> examples for programmatically performing an <em>Advanced Search</em> shows the proper syntax:</p>\n\n<blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>Const strF As String = \"urn:schemas:mailheader:subject = 'Test'\"  \n</code></pre>\n</blockquote>\n\n<p>Notice:</p>\n\n<ul>\n<li>The <code>urn:schemas:foo:bar</code> part is <strong>not</strong> surrounded by double quotes.</li>\n<li>Field values are surrounded by <strong>single quotes</strong>.</li>\n<li>MSDN makes no mention of a <code>@SQL=</code> prefix.</li>\n</ul>\n\n<p>This means a proper criteria string would look like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>filterStr = \"urn:schemas:httpmail:subject = '\" &amp; EmailName &amp; _\n      \"' AND urn:schemas:httpmail:date &gt;= '\" &amp; TDateUTC &amp; _\n      \"' AND urn:schemas:httpmail:date &lt;= '\" &amp; TDateUTCEOD &amp; '\"\n</code></pre>\n\n<p>Note that this will implicitly convert <code>TDateUTC</code> and <code>TDateUTCEOD</code> to a <code>String</code> value if they're <code>Date</code> variables. You could make that conversion explicit using the built-in <code>CStr</code> conversion function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>filterStr = \"urn:schemas:httpmail:subject = '\" &amp; EmailName &amp; _\n      \"' AND urn:schemas:httpmail:date &gt;= '\" &amp; CStr(TDateUTC) &amp; _\n      \"' AND urn:schemas:httpmail:date &lt;= '\" &amp; CStr(TDateUTCEOD) &amp; '\"\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 6529575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2940331d8a347135a34a94bb3a7c98d6?s=128&d=identicon&r=PG&f=1", "display_name": "Y H", "link": "https://stackoverflow.com/users/6529575/y-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 1, "accepted_answer_id": 38107882, "answer_count": 1, "score": 2, "last_activity_date": 1593328018, "creation_date": 1467219449, "last_edit_date": 1593328018, "question_id": 38105834, "link": "https://stackoverflow.com/questions/38105834/application-advancedsearch-syntax-issues", "title": "Application.AdvancedSearch syntax issues", "body": "<p>I was wondering how to fix this Outlook <em>Advanced Search</em> SQL-like criteria string:</p>\n\n<pre><code>filterStr = \"@SQL=\"\"urn:schemas:httpmail:subject\"\" = \"\"\" &amp; _\n            EmailName &amp; \"\"\" AND \"\"urn:schemas:httpmail:date\"\" &gt;= \"\"\" &amp; _\n            TDateUTC &amp; \"\"\" AND \"\"urn:schemas:httpmail:date\"\" &lt;= \"\"\" &amp; _\n            TDateUTCEOD &amp; \"\"\"\"\n</code></pre>\n\n<ul>\n<li><p><code>EmailName</code> is a string variable which calls an email subject</p></li>\n<li><p><code>TDateUTC</code> is a date variable which calls an input date and then\nconverts it to UTC</p></li>\n<li><p><code>TDateUTCEOD</code> is the above but with the time set to 11:59:59pm</p></li>\n</ul>\n\n<p>My syntax is completely broken because I have no idea how to incorporate variables into an <em>Advanced Search</em> for Outlook VBA.</p>\n"}, {"tags": ["excel", "vba", "batch-file", "updates"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1467219948, "post_id": 38105691, "comment_id": 63645478, "body": "Did you even search for how to do it? it&#39;s very common and all over the net. <a href=\"http://www.homeandlearn.org/write_to_a_text_file.html\" rel=\"nofollow noreferrer\">Here&#39;s one example</a> (a bit more than you need, but has the elements)"}, {"owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467220247, "post_id": 38105691, "comment_id": 63645677, "body": "I just want a single cell not a range.  Many of the ones on the internet are a range and I new to VBA"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467220402, "post_id": 38105691, "comment_id": 63645765, "body": "a single cell is Range as well. <code>Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467222473, "post_id": 38105691, "comment_id": 63647021, "body": "So in your example how would you edit the following to just reference sheet1 and cell A1"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467224777, "post_id": 38105691, "comment_id": 63648470, "body": "replace the entire <code>For ... Next</code> loop with <code>Write #2, Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Text</code>"}, {"owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467226078, "post_id": 38105691, "comment_id": 63649230, "body": "@ScottHoltzman that worked, thank you! One more question if you dont mind when it writes to the text file I get &quot; &quot; marks.  Is there any way to get rid of those?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467226694, "post_id": 38105691, "comment_id": 63649616, "body": "there is, but I forgot how, you can search and find the anser"}, {"owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1467228861, "post_id": 38105691, "comment_id": 63650810, "body": "@ScottHoltzman  I had to use Print instead of Write"}], "answers": [{"comments": [{"owner": {"reputation": 3409, "user_id": 4579155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Dw6Fx.jpg?s=128&g=1", "display_name": "abarisone", "link": "https://stackoverflow.com/users/4579155/abarisone"}, "edited": false, "score": 0, "creation_date": 1467267425, "post_id": 38108615, "comment_id": 63663448, "body": "Please edit with more information. Code-only and &quot;try this&quot; answers are discouraged, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;. We make an effort here to be a resource for knowledge."}], "tags": [], "owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "is_accepted": true, "score": 0, "last_activity_date": 1467228956, "creation_date": 1467228956, "answer_id": 38108615, "question_id": 38105691, "link": "https://stackoverflow.com/questions/38105691/vba-write-data-from-excel-cell-to-text-batch-file/38108615#38108615", "title": "VBA Write Data From Excel Cell to Text/Batch File", "body": "<pre><code>Dim FilePath As String\nDim CellData As String\n\nFilePath = \"C:\\Batch\\copy.bat\"\n\nOpen FilePath For Output As #2\n\nr = Worksheet(\"Sheet1\").Range(\"A1\").Text\n\nPrint #2 r\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5100906, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb9b0118f06fce12847dea8161bdd192?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Staugaitis", "link": "https://stackoverflow.com/users/5100906/justin-staugaitis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2909, "favorite_count": 0, "accepted_answer_id": 38108615, "answer_count": 1, "score": 0, "last_activity_date": 1467228956, "creation_date": 1467218983, "last_edit_date": 1467222532, "question_id": 38105691, "link": "https://stackoverflow.com/questions/38105691/vba-write-data-from-excel-cell-to-text-batch-file", "title": "VBA Write Data From Excel Cell to Text/Batch File", "body": "<p>I have an Excel File that stores a file path within Cell A1 and concatenates with the Function TODAY() to update that file path.  </p>\n\n<p>I also have a batch file that will move files from one folder to another.  I currently use this updating excel cell to get the new move batch command.</p>\n\n<p>How can I use VBA to copy data from Sheet1 in Cell A1 to the batch file automatically?  </p>\n\n<p>Batch file is stored \nC:\\Desktop\\Batch\\update.bat</p>\n\n<p>Here is an example code from the comments below but I just want it to copy data from Sheet 1 and Cell A1</p>\n\n<pre><code>Dim FilePath As String\nDim CellData As String\nDim LastCol As Long\nDim LastRow As Long\n\nLastCol = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Column\n\nLastRow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n\nFilePath = \"C:\\Batch\\copy.bat\"\n\nOpen FilePath For Output As #2\n\nFor i = 1 To LastRow\n\n    For j = 1 To LastCol\n\n        If j = LastCol Then\n\n            CellData = CellData + Trim(ActiveCell(i, j).Value)\n\n        Else\n\n            CellData = CellData + Trim(ActiveCell(i, j).Value) + \",\"\n\n        End If\n\n    Next j\n\n    Write #2, CellData\n    CellData = \"\"\n\nNext i\n\nClose #2\n\nMsgBox (\"Done\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 175, "user_id": 731408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9de8592530e4dd47bae31dbcc5d1ab9f?s=128&d=identicon&r=PG", "display_name": "xLRDxREVENGEx", "link": "https://stackoverflow.com/users/731408/xlrdxrevengex"}, "edited": false, "score": 0, "creation_date": 1467218853, "post_id": 38105633, "comment_id": 63644794, "body": "Forgot to mention should be compatible with Outlook 2013 as well."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1467219079, "post_id": 38105633, "comment_id": 63644966, "body": "*I dont mind using VBA to achieve this * - you will need VBA to achieve this, and i order to get VBA help here, you&#39;ll need to show the efforts you made to accomplish your task and where it&#39;s failing. SO will not write the code for you, especially something as complex as this."}, {"owner": {"reputation": 175, "user_id": 731408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9de8592530e4dd47bae31dbcc5d1ab9f?s=128&d=identicon&r=PG", "display_name": "xLRDxREVENGEx", "link": "https://stackoverflow.com/users/731408/xlrdxrevengex"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467220728, "post_id": 38105633, "comment_id": 63645983, "body": "My apologies I thought i had submitted the code that I had with it, I will get it in when I return back to my computer. Been awhile since I have used the site so formatting got a bit confusing"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 731408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9de8592530e4dd47bae31dbcc5d1ab9f?s=128&d=identicon&r=PG", "display_name": "xLRDxREVENGEx", "link": "https://stackoverflow.com/users/731408/xlrdxrevengex"}, "edited": false, "score": 0, "creation_date": 1467220812, "post_id": 38106235, "comment_id": 63646035, "body": "I thought about using a pivot table as well and still may if it would be easier thanks for the answer"}], "tags": [], "owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "is_accepted": false, "score": 2, "last_activity_date": 1467220690, "creation_date": 1467220690, "answer_id": 38106235, "question_id": 38105633, "link": "https://stackoverflow.com/questions/38105633/multiple-results-from-criteria-in-single-cell/38106235#38106235", "title": "Multiple results from criteria in single cell", "body": "<p>It looks like you are just trying to summarize data.  If so, a PivotTable will be your easiest and best option - plus there is no VBA code or formula writing!  I added in one extra column for counting purposes and created two separate PivotTables.  Below is an example of what I put together... hope this helps!\n<a href=\"https://i.stack.imgur.com/HaQNh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HaQNh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1467228440, "creation_date": 1467228440, "answer_id": 38108464, "question_id": 38105633, "link": "https://stackoverflow.com/questions/38105633/multiple-results-from-criteria-in-single-cell/38108464#38108464", "title": "Multiple results from criteria in single cell", "body": "<p>Try this code:</p>\n\n<pre><code>Sub Demo()\n    Dim dict1 As Object, dictApp As Object, dictNotApp As Object\n    Dim c1 As Variant, k As Variant, j As Variant\n    Dim i As Long, lastRow As Long, rowCount As Long\n    Dim rngName As Range, rngCase As Range, rngNotes As Range, rngFound As Range\n    Dim FirstAddress As String, strApp As String, strNotApp As String, strNotes As String\n    Dim dataSheet As Worksheet, outputSheet As Worksheet\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    'set you worksheets here\n    Set dataSheet = ThisWorkbook.Sheets(\"Sheet1\")\n    Set outputSheet = ThisWorkbook.Sheets(\"Sheet2\")\n\n    Set dict1 = CreateObject(\"Scripting.Dictionary\")\n    Set dictApp = CreateObject(\"Scripting.Dictionary\")\n    Set dictNotApp = CreateObject(\"Scripting.Dictionary\")\n\n    'get last row with data\n    lastRow = dataSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    'you can replace following ranges to your named ranges\n    Set rngName = dataSheet.Range(\"A2:A\" &amp; lastRow)\n    Set rngCase = dataSheet.Range(\"B2:B\" &amp; lastRow)\n    Set rngNotes = dataSheet.Range(\"C2:C\" &amp; lastRow)\n\n    'put unique names to dict1\n    c1 = dataSheet.Range(\"A2:A\" &amp; lastRow)\n    For i = 1 To UBound(c1, 1)\n        dict1(c1(i, 1)) = 1\n    Next i\n\n    rowCount = 2 'this is the starting row no for ouputSheet, row 1 being the header\n    For Each k In dict1.keys\n        strApp = \"\"\n        strNotApp = \"\"\n        strNotes = \"\"\n\n        'for each unique name get the values of case and notes\n        Set rngFound = dataSheet.Columns(1).Find(What:=k, LookAt:=xlWhole, MatchCase:=False)\n        If Not rngFound Is Nothing Then\n            FirstAddress = rngFound.Address\n            Do\n                If rngFound.Offset(0, 2) = \"Approved\" Then\n                    'if value of notes is approved put data in dictApp\n                    dictApp.Add rngFound.Offset(0, 1), rngFound.Offset(0, 2)\n                Else\n                    'if value of notes is not approved put data in dictNotApp\n                    dictNotApp.Add rngFound.Offset(0, 1), rngFound.Offset(0, 2)\n                End If\n\n                Set rngFound = rngName.FindNext(rngFound)\n            Loop While Not rngFound Is Nothing And rngFound.Address &lt;&gt; FirstAddress\n\n            'create case string for approved notes\n            For Each j In dictApp.keys\n                If strApp = \"\" Then\n                    strApp = j\n                Else\n                    strApp = strApp &amp; vbCrLf &amp; j\n                End If\n            Next\n            'create case and notes string for notes not approved\n            For Each j In dictNotApp.keys\n                If strNotApp = \"\" Then\n                    strNotApp = j\n                    strNotes = dictNotApp(j)\n                Else\n                    strNotApp = strNotApp &amp; vbCrLf &amp; j\n                    strNotes = strNotes &amp; vbCrLf &amp; dictNotApp(j)\n                End If\n            Next\n        End If\n\n        'display values in outputSheet\n        outputSheet.Cells(rowCount, 1) = k\n        outputSheet.Cells(rowCount, 2) = Application.WorksheetFunction.CountIf(rngName, k)\n        outputSheet.Cells(rowCount, 3) = Application.WorksheetFunction.CountIfs(rngName, k, rngNotes, \"&lt;&gt;Approved\")\n        outputSheet.Cells(rowCount, 4) = strApp\n        outputSheet.Cells(rowCount, 5) = strNotApp\n        outputSheet.Cells(rowCount, 6) = strNotes\n\n        dictApp.RemoveAll\n        dictNotApp.RemoveAll\n        rowCount = rowCount + 1\n    Next k\n    'center align the data\n    With outputSheet.UsedRange\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n    End With\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>See image for reference:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u6GhS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u6GhS.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 175, "user_id": 731408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9de8592530e4dd47bae31dbcc5d1ab9f?s=128&d=identicon&r=PG", "display_name": "xLRDxREVENGEx", "link": "https://stackoverflow.com/users/731408/xlrdxrevengex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 38108464, "answer_count": 2, "score": 0, "last_activity_date": 1467228440, "creation_date": 1467218810, "last_edit_date": 1467226010, "question_id": 38105633, "link": "https://stackoverflow.com/questions/38105633/multiple-results-from-criteria-in-single-cell", "title": "Multiple results from criteria in single cell", "body": "<p>So I have been going at this for awhile now and I am either just missing something or just dumb. Essentially I am trying to do something similar to the countifs function in Excel where you can use multiple criteria but instead of returning a count I am looking to return the matched cell values in a single cell.</p>\n\n<p>I have named ranges for all three fields that is used to pull into the results for the numbers but now I am looking for a way to grab each case and notes and put them into the perspective cell as shown in the last image. I dont mind using VBA to achieve this or even formulas if possible I have just gone through everything and just cant figure this one out.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fvfZI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fvfZI.png\" alt=\"Data\"></a></p>\n\n<p>This is essentially what I am trying to achieve.\n<a href=\"https://i.stack.imgur.com/lBgu9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lBgu9.png\" alt=\"Results\"></a></p>\n"}, {"tags": ["sql", "vba", "field", "crosstab", "recordset"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1467218328, "post_id": 38105454, "comment_id": 63644532, "body": "show the actual sql statement you&#39;re building with all that..."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1467219102, "post_id": 38105454, "comment_id": 63644981, "body": "@MarcB i did not understand what you meant. I have shown the sql statement and the entire code. I just need to find a way to either modify the SQL statement so that it can populate the 3 new columns from the 1st column OR find a way via VBA to populate the 3 columns. The former is what i would actually like. Also, if there is a way to get rid of the 1st column after populating the 3 columns from its values, then nothing like it! :)"}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1467219695, "post_id": 38105454, "comment_id": 63645327, "body": "so &quot;somevariabletext&quot; is what literally appears in your query? And wow... you really should look up database normalization. having that many columns for essentially &quot;the same&quot; data is ludicrous."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1467219986, "post_id": 38105454, "comment_id": 63645504, "body": "@MarcB , it may contain anything...what is commonly present along with this variable text in the 1st column, will be the word &quot;INNOVATIONS&quot;. So i have to search for this word &quot;INNOVATIONS&quot; to detect the 1st column.."}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1467220154, "post_id": 38105454, "comment_id": 63645613, "body": "variable/arbitrary column names is pretty much always a sign of bad design, and that many similar columns is DEFINITELY a sign of a bad design. you really should go back to the drawing board and rebuild this. all of the above code is simply trying to patch over a bad design."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1467220287, "post_id": 38105454, "comment_id": 63645696, "body": "@MarcB, this is the Crosstab data i get from a web application, on which i need to create some reports. it is not created by me. There are multiple such tables (as xlsx files each representing a country-category combination) that i have to loop thru and create reports."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1467253621, "post_id": 38105454, "comment_id": 63659400, "body": "I am not understanding. Why does the top query statement not work? Simply call that query as a string in recordset. No need to build the SQL statement."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467271057, "post_id": 38105454, "comment_id": 63665337, "body": "The query string is dynamically created from the vba code as the 1st column name can be variable. The only identifiable text in it is the word &quot;INNOVATIONS&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467220790, "post_id": 38105625, "comment_id": 63646016, "body": "thanks for pointing out. the comma testing line was a cut and paste error. i have rectified it in the original post. The column containing the text &quot;INNOVATIONS&quot; is the 1st column from which i want to split and use its values to populate the other 3 columns. Fact column contains only 2 types i.e. &quot;ACV Dist&quot; and &quot;Wgt Dist&quot;. I want to filter the data only on ACV Dist.  &quot;CAST(NULL AS VARCHAR(100)) AS BRAND, CAST(NULL AS VARCHAR(100)) AS INNOTYPE&quot;.....this is interesting and something new to me. Will this work in MSAccess? i will have to try and get back to you."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467220801, "post_id": 38105625, "comment_id": 63646026, "body": "But question is how do i split the 1st column values on &quot; - &quot; and place them in the 3 columns?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467221189, "post_id": 38105625, "comment_id": 63646245, "body": "Yes, i got what you meant by repeating the Innovations and Fact column twice."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467221606, "post_id": 38105625, "comment_id": 63646499, "body": "this is the sql query from the immediate window :  SELECT [Total AR Foods (HD excl#) INNOVATIONS / MDD], CAST(NULL AS VARCHAR(100)) AS BRAND, CAST(NULL AS VARCHAR(100)) AS INNOTYPE,[Fact], [Week Ending 05/01/14],[Week Ending 12/01/14],[Week Ending 19/01/14],[Week Ending 26/01/14],..... ......from [Sheet1$] WHERE Fact=&quot;ACV Distribution (w)&quot; AND BRAND=&quot;&quot; AND INNOTYPE=&quot;&quot; AND RECDATE=&quot;&quot;. ....but now i get an error &quot;-2147467259. VBAProject. Method Open of Object Recordset failed.&quot;"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467221621, "post_id": 38105625, "comment_id": 63646509, "body": "I updated with some potential ways of getting to the data but do a search and you should be able to figure it out.  I always use test data to get exact pattern when I am doing substrings.  I have to run good luck and please accept answer if this works out for you.  Thanks"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467221824, "post_id": 38105625, "comment_id": 63646633, "body": "you are getting an error because you don&#39;t have any values for BRAND, INNOTYPE and RECDATE in your where statement.  <a href=\"http://www.w3schools.com/sql/sql_where.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_where.asp</a>  I hope you don&#39;t take this rudely but at this point you need to spend some time on sql syntax in general."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467223635, "post_id": 38105625, "comment_id": 63647732, "body": "Thanks @Matt . i really appreciate your help to guide me in the right direction. In your update, you have mentioned &quot;LEFT(Innovations,CHARINDEX(&#39;-&#39;,Innovations) - 1)&quot;. My problem is the 1st column has the text &quot;INNOVATIONS&quot; but the other text in 1st column may be variable. What i mean is there are many tables like this table but with different 1st column names, but each containing the word &quot;INNOVATIONS&quot; in them. My problem is how do i get a handle on the 1st column in the WHERE clause?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467227376, "post_id": 38105625, "comment_id": 63650011, "body": "I am sorry, i am lost! tried searching, but most of the functions like CAST, CHARINDEX, REVERSE ARE tsql specific and do not work in Access. I use INSTR but need to know where to place the functions to get the substrings ie. in the SELECT statement OR in the WHERE clause? Also, where were you putting the NULL AS BRAND, NULL AS INNOTYPE, NULL AS RECDATE? Was it in the SELECT statement OR in the WHERE clause?"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467228574, "post_id": 38105625, "comment_id": 63650668, "body": "ohhh access.  That actually makes it a little easier.  No REVERSE needed.  InStr is same as CHARINDEX, but switch value order and put a 1 in first area.  InStrRev will search from the back of the string forward.  I don&#39;t work with access very often so another thing you can do is take one of your attempts and a sample data and open another question and more people will look at it and help you out. cheers"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467229649, "post_id": 38105625, "comment_id": 63651203, "body": "I know the Instr n InstrRev and I can strip them from the 1st column. What I did was while looping thru the fields and checking using Instr for the word innovations, i stored the name of the 1st column in a variable, which now I am using in the query. But my question is where do I put the substrings? In the WHERE clause or the SELECT statement?"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467230515, "post_id": 38105625, "comment_id": 63651642, "body": "Assuming you want all of the records you would put them in the SELECT statement e.g. LEFT(INSTR) AS BRAND, MID(...) AS INNOTYPE etc. and then make sure you take out BRAND = , INNOTYPE =  etc. from your where clause. Paste your updated code or better yet a print out of the SQL string and I can better assist"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467240618, "post_id": 38105625, "comment_id": 63656146, "body": "hi @Matt, i have updated the code and the debug.print of the sql. it seems InstrRev is recognizing the &quot;-&quot; in the date in 1st field somehow and so the splits are not happening correctly. Also if there is no &quot;-&quot; in some values in the 1st column then that row shows #Func! in the cells. Also the date columns show #Num! somehow. Is it because some of their values contain &quot;NA&quot;? The screenshot is here: [<a href=\"https://1drv.ms/i/s!Am1wNPJDit1whyKpgb6vP5G-vtlu]\" rel=\"nofollow noreferrer\">1drv.ms/i/s!Am1wNPJDit1whyKpgb6vP5G-vtlu]</a>"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467240837, "post_id": 38105625, "comment_id": 63656222, "body": "Start a new question.  Post the query text you just showed in this one, add some sample data, and think of what the true delimiter can be.  If there are more than 2 hyphens the method we showed won&#39;t work but I have no way of knowing how to suggest to cut up a string without seeing some sample data"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467241334, "post_id": 38105625, "comment_id": 63656410, "body": "how do i add sample data? Do you mean i share a sample workbook? i just posted a link to a screenshot on how the output appears.  1drv.ms/i/s!Am1wNPJDit1whyKpgb6vP5G-vtlu"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467241588, "post_id": 38105625, "comment_id": 63656494, "body": "the data in the 1st column is like this:  Total INNOVATIONS / MMD  7 UP - TEMPORARY OFFERING - 2012/07/30 7 UP - TEMPORARY OFFERING - 2013/02/07 7 UP - TEMPORARY OFFERING - 2013/02/07 7 UP - TEMPORARY OFFERING - 2015/06/18 7 UP - TEMPORARY OFFERING - 2015/06/18 7 UP DIET - MINOR/NO CHANGE OFFERING - 2014/05/29 7 UP DIET - MINOR/NO CHANGE OFFERING - 2014/05/29 7 UP FREE - LINE EXTENSION - 2014/07/23 7 UP FREE - LINE EXTENSION - 2014/07/23 7 UP FREE - LINE EXTENSION - 2014/12/24 7 UP FREE - LINE EXTENSION - 2014/12/24 7 UP FREE - LINE EXTENSION - 2015/10/01"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467241738, "post_id": 38105625, "comment_id": 63656536, "body": "i think the &#39;/&#39; in the dates is being understood by InstrRev as a &#39;-&#39;."}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467242883, "post_id": 38105625, "comment_id": 63656915, "body": "@sifar please open a new question we are trying to fix something that more than likely isn&#39;t even the right way to get what you want.  If you post that image directly in the question and preferably some actual text or test records, then post what you want it to look like based on the sample of data you provide. Also tag ms-access so the access experts can assist you better"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467242901, "post_id": 38105625, "comment_id": 63656926, "body": "Here is the Shared editable link to the sample data. i dont have time to start a new question as its early dawn now and i am tired. i hope you understand.  <a href=\"https://1drv.ms/x/s!Am1wNPJDit1whyRzTcKRVH0SPM4o\" rel=\"nofollow noreferrer\">1drv.ms/x/s!Am1wNPJDit1whyRzTcKRVH0SPM4o</a>"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467243001, "post_id": 38105625, "comment_id": 63656955, "body": "Sorry I have to say that I am no longer willing to assist on this subject.  I understand you are tired but this has been much longer than a normal answer and you have continued and continued to add questions.  I wish you luck."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467243291, "post_id": 38105625, "comment_id": 63657037, "body": "I understand. I appreciate all your help. Thanks @Matt. :)"}], "tags": [], "owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1467228448, "last_edit_date": 1467228448, "creation_date": 1467218776, "answer_id": 38105625, "question_id": 38105454, "link": "https://stackoverflow.com/questions/38105454/introduce-new-fields-in-select-query-based-on-splitting-values-from-1st-column/38105625#38105625", "title": "Introduce new fields in Select query based on splitting values from 1st column", "body": "<p>Lots of things going on with your dynamic string being built.</p>\n\n<p>First, you start with <code>SELECT</code> and then later try to test to see if the first part of the string has a <code>\",\"</code> comma because you are inserting the comma automatically during your loop.  Fix by not adding select till after testing for the first comma.</p>\n\n<p>Second. you are repeating 3 columns twice. <code>BRAND, INNOTYPE, RECDATE</code> if both Innovations and Fact are in the fieldset.</p>\n\n<p>Next when identifying your new column you are simply using a name <code>BRAND, INNOTYPE, RECDATE</code>  but then SQL thinks that is a column name and will give you an error.  Fix by changing to <code>NULL AS BRAND, NULL AS INNOTYPE,</code> etc..  But then you probably also want to tell it a data type so <code>CAST(NULL AS VARCHAR(100)) AS BRAND, CAST(NULL AS VARCHAR(100)) AS INNOTYPE,</code> etc...  If you really just want a empty string value do something like <code>CAST('' AS VARCHAR(100)) AS BRAND</code></p>\n\n<p>Print out your SQL statements when debugging and test and errors will become more evident.</p>\n\n<p>search for how to get a substring from a string. And do some tests on the data.  But it will likely be a combination of \n<code>LEFT(Innovations,CHARINDEX('-',Innovations) - 1)</code> will be first field\n<code>SUBSTRING(Innovations,CHARINDEX('-',Innovations),CHARINDEX('-',REVERSE(Innovations)))</code> for second\n<code>RIGHT(Innovations,CHARINDEX('-',REVERSE(Innovations)) - 1)</code> for 3rd.</p>\n\n<p>This assumes you will always have 2 '-' hyphens and no spaces in it.  If have spaces wrap the resulting <code>substring</code> in <code>LTRIM(RTRIM())</code> to get rid of them.</p>\n\n<p>MS Access versions of substrings</p>\n\n<pre><code>Left(Innovations,InStr(1,Innovations,'-') - 1)\n\nMID(Innovations,InStr(1,Innovations,'-'),InStrRev(Innovations,'-'))\n\nRIGHT(Innovations,InStrRev(Innovations,'-') - 1)\n</code></pre>\n\n<p>And if you have spaces just put those inside <code>TRIM()</code></p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1467240083, "creation_date": 1467218199, "last_edit_date": 1467240083, "question_id": 38105454, "link": "https://stackoverflow.com/questions/38105454/introduce-new-fields-in-select-query-based-on-splitting-values-from-1st-column", "title": "Introduce new fields in Select query based on splitting values from 1st column", "body": "<p>i have a select query that looks like this:</p>\n\n<pre><code>SELECT \nLEFT([Total INNOVATIONS / MMD],INSTR(1,[Total INNOVATIONS / MMD],'-')-2) AS BRAND, MID([Total INNOVATIONS / MMD],INSTR(1,[Total INNOVATIONS / MMD],'-')+2 , INSTRREV([Total INNOVATIONS / MMD],'-')-2) AS INNOTYPE, RIGHT([Total INNOVATIONS / MMD], INSTRREV([Total INNOVATIONS / MMD],'-')+2) AS RECDATE, [Fact], \n[Week Ending 05/01/14], [Week Ending 12/01/14], [Week Ending 19/01/14], [Week Ending 26/01/14], [Week Ending 02/02/14], [Week Ending 09/02/14], [Week Ending 16/02/14], [Week Ending 23/02/14], [Week Ending 02/03/14], [Week Ending 09/03/14], [Week Ending 16/03/14], [Week Ending 23/03/14], [Week Ending 30/03/14], [Week Ending 06/04/14], [Week Ending 13/04/14], [Week Ending 20/04/14], [Week Ending 27/04/14], [Week Ending 04/05/14], [Week Ending 11/05/14], [Week Ending 18/05/14], [Week Ending 25/05/14], [Week Ending 01/06/14], [Week Ending 08/06/14], [Week Ending 15/06/14], [Week Ending 22/06/14], [Week Ending 29/06/14], [Week Ending 06/07/14], [Week Ending 13/07/14], [Week Ending 20/07/14], [Week Ending 27/07/14], [Week Ending 03/08/14], [Week Ending 10/08/14], [Week Ending 17/08/14], [Week Ending 24/08/14], [Week Ending 31/08/14], [Week Ending 07/09/14], [Week Ending 14/09/14], [Week Ending 21/09/14], [Week Ending 28/09/14], [Week Ending 05/10/14], [Week Ending 12/10/14], [Week Ending 19/10/14], [Week Ending 26/10/14], [Week Ending 02/11/14], [Week Ending 09/11/14], [Week Ending 16/11/14], [Week Ending 23/11/14], [Week Ending 30/11/14], [Week Ending 07/12/14], [Week Ending 14/12/14], [Week Ending 21/12/14], [Week Ending 28/12/14] FROM [Sheet1$] WHERE Fact=\"ACV Dist\" \n</code></pre>\n\n<p>I have introduced 3 new Fields namely,</p>\n\n<blockquote>\n  <p>\"BRAND\", \n  \"INNOTYPE\", \n  \"RECDATE\" </p>\n</blockquote>\n\n<p>into an sql query to form a recordset. The values for these New columns are to be picked up by splitting the 1st Field on the \" - \" delimiter.\ne.g. </p>\n\n<pre><code>    strConString = _\n\"Provider=Microsoft.ACE.OLEDB.12.0; \" _\n&amp; \"Data Source='\" &amp; varPathAndFile &amp; \"'; \" _\n&amp; \"Extended Properties=\"\"Excel 12.0 XML;HDR=YES;IMEX=1\"\";\"\n\n\nstrSQL = \"SELECT TOP 1 * FROM [Sheet1$]\"\nSet objCON = CreateObject(\"ADODB.Connection\")\nobjCON.Open strConString\n\nSet objRS = CreateObject(\"ADODB.Recordset\")\nWith objRS\n    .locktype = ADOLockType.adLockOptimistic\n    .CursorType = ADOCursorType.adOpenStatic\n    .cursorlocation = ADOCursorLocation.adUseClient\n    .Source = strSQL\n    .activeconnection = objCON\n    .Open\n    .movelast\n    .movefirst\n\n  Stop\n    strSQL = \"SELECT \"\n    For Each fld In .Fields\n        If InStr(1, fld.Name, \"INNOVATIONS\") &gt; 0 Then\n\n            strFieldValue = fld.Name\n\n            --strSQL = strSQL &amp; \"[\" &amp; fld.Name &amp; \"], \"\n            strSQL = strSQL &amp; \" LEFT([\" &amp; strFieldValue &amp; \"],INSTR(1,[\" &amp; strFieldValue &amp; \"],'-')-2) AS BRAND,\"\n            strSQL = strSQL &amp; \" MID([\" &amp; strFieldValue &amp; \"],INSTR(1,[\" &amp; strFieldValue &amp; \"],'-')+2 , INSTRREV([\" &amp; strFieldValue &amp; \"],'-')-2) AS INNOTYPE,\"\n            strSQL = strSQL &amp; \" RIGHT([\" &amp; strFieldValue &amp; \"], INSTRREV([\" &amp; strFieldValue &amp; \"],'-')+2) AS RECDATE,\"\n        End If\n\n        If fld.Name = \"Fact\" Then\n            strSQL = strSQL &amp; \" [\" &amp; fld.Name &amp; \"], \"\n        End If\n\n        If InStr(1, fld.Name, \"Week Ending\") &gt; 0 And Right(fld.Name, 2) = Right(lngYear, 2) Then\n            strSQL = strSQL &amp; \"[\" &amp; fld.Name &amp; \"], \"\n        End If\n    Next fld\n\nStop\n\n    If Right(Trim(strSQL), 1) = \",\" Then strSQL = Left(Trim(strSQL), Len(Trim(strSQL)) - 1)\n    strSQL = strSQL &amp; \" FROM [Sheet1$] WHERE Fact=\"\"ACV Dist\"\" \"\n\n    Debug.Print strSQL\n    .Close\n    .Source = strSQL\nStop\n    .Open\n\nStop\n</code></pre>\n\n<blockquote>\n  <p>How do i populate values into these 3 Field columns from the 1st Field\n  column (splitting its values)?</p>\n</blockquote>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1467218118, "post_id": 38105351, "comment_id": 63644404, "body": "This would require stored procedure not a function and would then require dynamic SQL inside of the stored procedure.  It might be better to build the dynamic sql pointing to the correct table in your macro and then execute it there.  Please be sure are validating user input so you are not susceptible to a sql injection attack."}, {"owner": {"reputation": 1, "user_id": 6526271, "user_type": "registered", "profile_image": "https://graph.facebook.com/1712883612262564/picture?type=large", "display_name": "Allan Chan", "link": "https://stackoverflow.com/users/6526271/allan-chan"}, "edited": false, "score": 0, "creation_date": 1467220527, "post_id": 38105351, "comment_id": 63645851, "body": "Yes, So I have two tables, and they will both have an identical field called SR number. I only want to update values on the master table where there are matching records according to that identical SR number field.  The rest with unmatched SR will be discarded."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "is_accepted": false, "score": 0, "last_activity_date": 1467224318, "creation_date": 1467224318, "answer_id": 38107283, "question_id": 38105351, "link": "https://stackoverflow.com/questions/38105351/referencing-variable-for-functions/38107283#38107283", "title": "Referencing Variable for Functions", "body": "<p>I've done something similar to this and used an Update Query and Insert Query.\nIt sounds like you're trying to just update any existing records that may need updating and then adding new records into the table. </p>\n\n<p>For an update, I'd try creating a query in SQL view and type something like:</p>\n\n<p><code>UPDATE MasterSPI SET MasterSPI.SRnumber = [newtablename]![SRnumber]</code> etc.</p>\n\n<p>and do that for each field in your table.</p>\n\n<p>For inserting you could do something like:</p>\n\n<p><code>INSERT INTO MasterSPI SELECT * FROM newtablename</code></p>\n\n<p>That may help you get started.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6526271, "user_type": "registered", "profile_image": "https://graph.facebook.com/1712883612262564/picture?type=large", "display_name": "Allan Chan", "link": "https://stackoverflow.com/users/6526271/allan-chan"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226133, "creation_date": 1467226133, "answer_id": 38107824, "question_id": 38105351, "link": "https://stackoverflow.com/questions/38105351/referencing-variable-for-functions/38107824#38107824", "title": "Referencing Variable for Functions", "body": "<p>I know many of you are advanced users but I found an answer that fit my quick needs. As a notice and disclaimer for other people, it will be in no way secure, it is more for personal use such that I do not need to spend an hour doing append and updates to several master tables repetitively.</p>\n\n<p>To do this, I made a global string variable called name, then I made another variable called strung that translated it into a readable string for referencing. I then made an SQL string that references that strung variable. This allows the user to submit an input for the global variable, which translates into a readable string for the RunSQL method.</p>\n\n<p>Here's a snippet of the parts that were most relevant, I hope it helps whoever comes next with the same scenario.</p>\n\n<pre><code>** \nPublic name As String 'global variable declared so that the new field to be created can be used elsewhere\n\nname = InputBox(\"Name of Month\", \"InputBox\") 'variable that takes user input and it will be name for new fields to be added\n\nDim SQLa As String 'creates a string variable such that it will be read as an SQL line by the RunSQL method\n\nstrung = \"[\" &amp; name &amp; \"]\" 'sets strung as global varible name, which is user input on the specific table being used to update\n\n'the following lines runs a query such that it updates the master table with new data and does the grouping by SR number\n\nSQLa = \"UPDATE \" &amp; strung &amp; \" \" &amp; _\n\"RIGHT JOIN MasterSPI \" &amp; _\n\"ON \" &amp; strung &amp; \".\" &amp; \"[SR#] = MasterSPI.[SR#] \" &amp; _\n\"SET MasterSPI.\" &amp; strung &amp; \" = \" &amp; strung &amp; \".\" &amp; \"[SPI]; \" _\nDoCmd.RunSQL SQLa 'executes the SQL code in VBA **\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6526271, "user_type": "registered", "profile_image": "https://graph.facebook.com/1712883612262564/picture?type=large", "display_name": "Allan Chan", "link": "https://stackoverflow.com/users/6526271/allan-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594641861, "creation_date": 1467217899, "last_edit_date": 1594641861, "question_id": 38105351, "link": "https://stackoverflow.com/questions/38105351/referencing-variable-for-functions", "title": "Referencing Variable for Functions", "body": "<p>Every two weeks there will be a new table with new data coming in to me, I need to update that onto a master table. I want to automate this process. </p>\n\n<p>I would like to declare a variable that a user can input the date the data is from, and based on that date update to the appropriate field on the master table. I have no clue how to make SQL functions use variables to locate tables with the syntax, not even sure if this can be done. Any help would be appreciated. </p>\n\n<p><strong>As I am inexperienced, I am making a VBA Macro and embedding the SQL code from the access query I made.</strong></p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Sub UpdateFieldX()\n\n    Dim SQL As String\n\n    SQL = \"UPDATE [15-Jun-16] \" &amp; _\n    \"RIGHT JOIN MasterSPI \" &amp; _\n    \"ON [15-Jun-16].[SR#] = MasterSPI.[SR#] \" &amp; _\n    \"SET MasterSPI.[30-Jun-16] = [15-Jun-16].[SPI]; \" _\n\n    DoCmd.RunSQL SQL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467217974, "post_id": 38105313, "comment_id": 63644323, "body": "That&#39;s what happens in a <code>FIND</code> when it cannot find what you are looking for. I would suggest creating a loop that goes from the last row to the top, looks for &quot;TRUE&quot; in the appropriate column and then delete the row like that."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467218317, "post_id": 38105313, "comment_id": 63644524, "body": "Also, it&#39;s highly suggested to <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1467220228, "post_id": 38105606, "comment_id": 63645660, "body": "Thank you very much @Scott Holtzman. I opted for your second idea and it worked beautifully! What a neat idea!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1467218724, "creation_date": 1467218724, "answer_id": 38105606, "question_id": 38105313, "link": "https://stackoverflow.com/questions/38105313/deleting-rows-of-data-not-needed/38105606#38105606", "title": "Deleting Rows of Data not Needed", "body": "<p>As the comments suggest, get rid of <code>.Select</code>. </p>\n\n<p>This code should be all that's needed.</p>\n\n<pre><code>Do \n\n   Dim sAdd as String\n   sAdd = vbNullString\n\n   Dim rFound as Range\n   Set rFound = Range(\"B:B\").Find(What:=\"TRUE\", After:=Cells(Rows.Count,Columns.Count), LookIn:=xlValues, LookAt _\n    :=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n    False)\n\n   If Not rFound is Nothing Then\n      sAdd = rFound.Address         \n      rFound.EntireRow.Delete Shift:=xlUp\n   End If\n\nLoop Until sAdd = vbNullString\n</code></pre>\n\n<p>This will also work and may be faster if the rowset isn't extremely large.</p>\n\n<pre><code>Dim lRow as Long\nlRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nWith Range(\"B1:B\" &amp; lRow)\n    .AutoFilter 1, TRUE\n    .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .AutoFilter\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467219095, "creation_date": 1467219095, "answer_id": 38105728, "question_id": 38105313, "link": "https://stackoverflow.com/questions/38105313/deleting-rows-of-data-not-needed/38105728#38105728", "title": "Deleting Rows of Data not Needed", "body": "<pre><code>Application.ScreenUpdating = False\nDim rFound As Range\nDim mRange As Range\n\nSet mRange = Range(\"B:B\")\n\nDo\n\n    Set rFound = mRange.Find(What:=\"TRUE\", After:=ActiveCell, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n    If Not rFound Is Nothing Then rFound.EntireRow.Delete\n\nLoop Until rFound Is Nothing\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 38105606, "answer_count": 2, "score": 1, "last_activity_date": 1467227055, "creation_date": 1467217757, "last_edit_date": 1467227055, "question_id": 38105313, "link": "https://stackoverflow.com/questions/38105313/deleting-rows-of-data-not-needed", "title": "Deleting Rows of Data not Needed", "body": "<pre><code>Dim mRange As Range\n\nColumns(\"B:B\").Select\n\ni = 0\nSet mRange = Range(\"B:B\")\nmRange.Find(What:=\"TRUE\", After:=ActiveCell, LookIn:=xlValues, LookAt _\n    :=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n    False).Activate\nRows(ActiveCell.Row).Select\nSelection.Delete Shift:=xlUp\n\nFor i = 0 To 1\nColumns(\"B:B\").Select\nSet mRange = Range(\"B:B\")\nmRange.Find(What:=\"TRUE\", After:=ActiveCell, LookIn:=xlValues, LookAt _\n    :=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n    False).Activate\nRows(ActiveCell.Row).Select\nSelection.Delete Shift:=xlUp\n\nDo While Not mRange Is Nothing\nSet mRange = Range(\"B:B\")\nmRange.Select\n\nmRange.Find(What:=\"TRUE\", After:=ActiveCell, LookIn:=xlValues, LookAt _\n    :=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n    False).Activate\nRows(ActiveCell.Row).Select\nSelection.Delete Shift:=xlUp\n\nLoop\n\nNext i\n</code></pre>\n\n<p>The above code correctly deletes out the rows where a cell has the word \"TRUE\" in it, but receives this error when it can no longer find \"TRUE\". It does not jump out of the loop, but hangs at the final <code>mRange.Find</code> method. What have I done wrong? Thx.</p>\n\n<p>\"Run-time error 91, Object variable or With block variable not set\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467217849, "post_id": 38104920, "comment_id": 63644238, "body": "I believe naming rules for worksheets and ranges are different, and that you&#39;ll run into problems if a sheet/tab has spaces in its name, for example."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1467216831, "last_edit_date": 1495540728, "creation_date": 1467216831, "answer_id": 38105025, "question_id": 38104920, "link": "https://stackoverflow.com/questions/38104920/excel-macro-to-name-ranges-according-to-the-name-of-the-worksheet-tab-name/38105025#38105025", "title": "Excel Macro to name ranges according to the name of the worksheet Tab name", "body": "<p>Just a bit of refactoring to get what you need. Biggest this to work directly with objects and eliminate the <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>Active...</code></a> stuff.</p>\n\n<p>Also <code>ActiveWorksheets</code> is not proper syntax in any way.</p>\n\n<pre><code>Sub nameRanges()\n\n    Dim wbook As Workbook\n    Set wbook = ThisWorkbook\n\n    Dim sht As Worksheet\n\n    For Each sht In wbook.Worksheets\n\n        Dim RangeName As String, CellName As String\n\n        RangeName = \"RoomCode_\" + sht.Name\n        CellName = \"A:B\"\n\n        Dim cell As Range\n\n        Set cell = sht.Range(CellName)\n\n        sht.Names.Add Name:=RangeName, RefersTo:=cell\n\n\n    Next sht\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1467217904, "creation_date": 1467217904, "answer_id": 38105354, "question_id": 38104920, "link": "https://stackoverflow.com/questions/38104920/excel-macro-to-name-ranges-according-to-the-name-of-the-worksheet-tab-name/38105354#38105354", "title": "Excel Macro to name ranges according to the name of the worksheet Tab name", "body": "<p>Here's another way:</p>\n\n<pre><code>Option Explicit\n\nSub nameRanges()\n\nDim sht As Worksheet\nDim RangeName As String\nDim cell As String\n\nFor Each sht In ActiveWorkbook.Worksheets\n    RangeName = \"RoomCode_\" + sht.Name\n    cell = \"=\" &amp; sht.Name &amp; \"!\" &amp; \"A:B\"\n    Names.Add Name:=RangeName, RefersTo:=cell\nNext sht\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467218022, "creation_date": 1467218022, "answer_id": 38105398, "question_id": 38104920, "link": "https://stackoverflow.com/questions/38104920/excel-macro-to-name-ranges-according-to-the-name-of-the-worksheet-tab-name/38105398#38105398", "title": "Excel Macro to name ranges according to the name of the worksheet Tab name", "body": "<p>I think that you would want to add the names to the workbook names collection. The way it is now you'll still have to reference the individual worksheet before you can access the name.<br></p>\n\n<blockquote>\n  <p>WorkSheets(\"RoomCode\").Range(\"RoomCode_XYZ\")</p>\n</blockquote>\n\n<p>By adding the names to the workbook you'll be able to access no matter the ActiveSheet.</p>\n\n<blockquote>\n  <p>Range(\"RoomCode_XYZ\")</p>\n</blockquote>\n\n<pre><code>Sub nameRanges()\n\n    Dim wbook As Workbook\n    Set wbook = ThisWorkbook\n\n    Dim sht As Worksheet\n\n    For Each sht In wbook.Worksheets\n\n        Dim RangeName As String, CellName As String\n\n        RangeName = \"RoomCode_\" + sht.Name\n        CellName = \"A:B\"\n\n        Dim cell As Range\n\n        Set cell = sht.Range(CellName)\n\n        ThisWorkBook.Names.Add Name:=RangeName, RefersTo:=cell\n\n\n    Next sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 38105025, "answer_count": 3, "score": 0, "last_activity_date": 1467218022, "creation_date": 1467216511, "question_id": 38104920, "link": "https://stackoverflow.com/questions/38104920/excel-macro-to-name-ranges-according-to-the-name-of-the-worksheet-tab-name", "title": "Excel Macro to name ranges according to the name of the worksheet Tab name", "body": "<p>I have the following code which I am trying to get to name the entire A and B columns range according to the worksheet tab name. I want each A:B range of cells in each worksheet to be named RoomCode_ + the name of the excel sheet tab.</p>\n\n<p>So for example if I had 3 sheets called XYZ, ABC and DEF, then my cell range names for those 3 sheets respectively should be:</p>\n\n<pre><code>RoomCode_XYZ\nRoomCode_ABC\nRoomCode_DEF\n</code></pre>\n\n<p>I would typically do this manually by highlighting the cell range and just typing the range name I wanted, however I have over 150 tabs and would like to be able to do them all automatically through this process. </p>\n\n<pre><code>Sub nameRanges()\n\nSet wbook = ActiveWorkbook\n\nFor Each sht In wbook.Worksheets\n    sht.Activate\n\nRangeName = \"RoomCode_\" + ActiveSheet.Name\n  CellName = \"A:B\"\n\n  Set cell = ActiveWorksheets.Range(CellName)\n  ActiveWorksheets.Names.Add Name:=RangeName, RefersTo:=cell\n\n  Next sht\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467215722, "post_id": 38104584, "comment_id": 63642827, "body": "are the dates sorted?"}, {"owner": {"reputation": 45, "user_id": 3641694, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d13ab68866de2e200f7434b536fa762?s=128&d=identicon&r=PG&f=1", "display_name": "user3641694", "link": "https://stackoverflow.com/users/3641694/user3641694"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467215995, "post_id": 38104584, "comment_id": 63643019, "body": "Hi Scott, They are.  But I&#39;m not sure if that will always be the case."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467217679, "post_id": 38104584, "comment_id": 63644142, "body": "Use Application.Match() to find the first row then iterate from there till it no longer is equal.  You will want to test if the match finds anything before looping."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3641694, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d13ab68866de2e200f7434b536fa762?s=128&d=identicon&r=PG&f=1", "display_name": "user3641694", "link": "https://stackoverflow.com/users/3641694/user3641694"}, "edited": false, "score": 0, "creation_date": 1467216485, "post_id": 38104750, "comment_id": 63643327, "body": "Thanks Newguy. But I will not know what the date will be, And I won&#39;t know how many rows a date will take,  The only thing I know it will always be in Column &quot;B&quot;."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 45, "user_id": 3641694, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d13ab68866de2e200f7434b536fa762?s=128&d=identicon&r=PG&f=1", "display_name": "user3641694", "link": "https://stackoverflow.com/users/3641694/user3641694"}, "edited": false, "score": 0, "creation_date": 1467216614, "post_id": 38104750, "comment_id": 63643433, "body": "@user3641694 if you do not know the date how will you find the last occurrence of said date?"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467216626, "post_id": 38104750, "comment_id": 63643447, "body": "Where are you getting the date from cell , textbox or something else ?"}, {"owner": {"reputation": 45, "user_id": 3641694, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d13ab68866de2e200f7434b536fa762?s=128&d=identicon&r=PG&f=1", "display_name": "user3641694", "link": "https://stackoverflow.com/users/3641694/user3641694"}, "edited": false, "score": 0, "creation_date": 1467216949, "post_id": 38104750, "comment_id": 63643678, "body": "The date is coming from a cell. Scott - That is my problem.  How can I read a value from a particular cell. If I can  write something like, FIRSTDATE = READ VALUE of B-1, then loop through the B cells until the value changes, say at row 10.  The I know row 1 to 9 has the same date, and that would be my ALLROWS for that particular value.  I&#39;m doing this because I need to find duplicate values, but only where the date is the same. Thanks!"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467217143, "post_id": 38104750, "comment_id": 63643806, "body": "to assign value to variable from a cell use <code>=</code> like if <code>dt = Cells( row , column )</code> so for B1 row is 1 and col = 2 hence <code>dt = Cells( 1, 2).Value2</code>"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 0, "last_activity_date": 1467217252, "last_edit_date": 1467217252, "creation_date": 1467216091, "answer_id": 38104750, "question_id": 38104584, "link": "https://stackoverflow.com/questions/38104584/get-last-row-of-same-value-in-a-column/38104750#38104750", "title": "Get last row of same value in a column", "body": "<p>You can start finding it from last row</p>\n\n<pre><code>Sub FindLastRow()\n\nDim dt as Date, i as Long, wk As worksheet\n\nSet wk = sheet1\n\ndt = wk.Range(\"B1\").value2\n\nFor i= wk.Range(\"B\" &amp; Rows.Count).End(xlUp).Row to 2 Step -1\n      if wk.Range(\"B\" &amp; i).Value2 = dt then\n         msgbox \"Last Row with Date :\" &amp; dt &amp; \" is \" &amp; i\n         Exit Sub\n      End if\nNext i\n\nMsgbox \"Date Not Found\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3641694, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d13ab68866de2e200f7434b536fa762?s=128&d=identicon&r=PG&f=1", "display_name": "user3641694", "link": "https://stackoverflow.com/users/3641694/user3641694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1061, "favorite_count": 0, "accepted_answer_id": 38104750, "answer_count": 1, "score": -1, "last_activity_date": 1467217252, "creation_date": 1467215674, "last_edit_date": 1531164843, "question_id": 38104584, "link": "https://stackoverflow.com/questions/38104584/get-last-row-of-same-value-in-a-column", "title": "Get last row of same value in a column", "body": "<p>If I have a column with a date of 5-10-2016, and its from row 3 to 23.  What is the best way get the last row number of the same value (5-10-2016).  The date will always change, and the number of rows will also be different.  Thanks!\nJim</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1467257155, "post_id": 38104423, "comment_id": 63660209, "body": "If you need to append more than one child, many siblings/parants, grouping by nodes, with complex related logic, consider XSLT, the transformation xml language. And yes, Excel VBA can run XSLT."}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1467280555, "post_id": 38104650, "comment_id": 63671426, "body": "Thanks for your answer! It actually creates the node, but the method &quot;appendChild&quot; fails when I try to append it. It seems to work only into the XMLFile object. Any idea?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1467287586, "post_id": 38104650, "comment_id": 63676152, "body": "Finally, it was just a matter of using the correct object type. I&#39;ve modified your answer, hence I&#39;ve accepted it. Thanks a lot!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1467287553, "last_edit_date": 1467287553, "creation_date": 1467215872, "answer_id": 38104650, "question_id": 38104423, "link": "https://stackoverflow.com/questions/38104423/create-brand-new-xml-node-to-append-as-child-to-other-node/38104650#38104650", "title": "Create brand new XML node to append as child to other node", "body": "<p>This should work:</p>\n\n<pre><code>Set newNode= XMLFile.CreateElement(\"price\");\nnewNode.InnerText = \"19.95\"\ntrade.appendChild(newNode)\n</code></pre>\n\n<p>Please note that both variables <code>trade</code> and <code>newNode</code> should be declared as <code>IXMLDOMNode</code> (type defined in the library <code>msxml6.dll</code>).</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3379, "favorite_count": 0, "accepted_answer_id": 38104650, "answer_count": 1, "score": 1, "last_activity_date": 1599490694, "creation_date": 1467215197, "last_edit_date": 1531164843, "question_id": 38104423, "link": "https://stackoverflow.com/questions/38104423/create-brand-new-xml-node-to-append-as-child-to-other-node", "title": "Create brand new XML node to append as child to other node", "body": "<p>I would like to create a new XML node to append to an existing one in my XML file. \nSpecifically, the structure of the file is: </p>\n\n<pre><code>&lt;contract&gt;\n    &lt;trade&gt;&lt;/trade&gt;\n    &lt;trade&gt;&lt;/trade&gt;\n&lt;/contract&gt; \n</code></pre>\n\n<p>My idea is to get each <code>&lt;trade&gt;</code> node and append a <em>new</em> child to it. \nThis child should look like this: </p>\n\n<pre><code>&lt;tradeSource&gt;&lt;/tradeSource&gt;\n</code></pre>\n\n<p>My question is, how do I define this new child to append? It doesn't seem I can find the right object to create on VBA (although the library MSXML v3.0 has been referenced in the project) and I don't manage to find such a sample of brand-new node anywhere on the web. My pseudo-code: </p>\n\n<pre><code>XMLFile.Load(myFileFullName)\nSet tradeNodes = XMLFile.getElementsByTagName(\"trade\")\nFor Each trade In tradeNodes \n    Set newNode = ???? '&lt;-- how to fill this?\n    trade.appendChild(newNode)\nNext trade\n</code></pre>\n"}, {"tags": ["excel", "addressing", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467215397, "post_id": 38104400, "comment_id": 63642589, "body": "do you just want to return the column letter (or number) of the first time a certain string appears in a cell in a worksheet?"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467215619, "post_id": 38104400, "comment_id": 63642765, "body": "Hi @ScottHoltzman ---The column letter.  Thanks for your help."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467215671, "post_id": 38104400, "comment_id": 63642792, "body": "Does your code not work? Do you get errors (if so, what error and where)?"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467216068, "post_id": 38104400, "comment_id": 63643062, "body": "Thank you. @ScottHoltzman"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 4, "last_activity_date": 1467215691, "creation_date": 1467215691, "answer_id": 38104594, "question_id": 38104400, "link": "https://stackoverflow.com/questions/38104400/getting-column-address-of-cell-representing-the-first-instance-of-a-string-vba/38104594#38104594", "title": "Getting Column Address of Cell Representing the First Instance of a String (VBA)", "body": "<p>There are many built-in objects and methods that can make the code much simpler:</p>\n\n<pre><code>Dim ws as Worksheet\nSet ws = Worksheets(\"mySheet\")\n\nDim rngFound as Range\nSet rngFound = ws.Cells.Find(StringInQuestion, lookat:=xlPart) 'assumes can be part of cell, change to xlAll if need exact match\n\nIf not rngFound is Nothing Then \n    Dim sCol as String\n    sCol = Split(rngFound.Address,\"$\")(1) 'letter\n    'sCol = rngFound.Column 'to get number\nElse\n    Msgbox StringInQuestion &amp; \" not found in \" &amp; ws.Name &amp; \".\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4199, "favorite_count": 1, "accepted_answer_id": 38104594, "answer_count": 1, "score": -1, "last_activity_date": 1467216188, "creation_date": 1467215129, "last_edit_date": 1531161705, "question_id": 38104400, "link": "https://stackoverflow.com/questions/38104400/getting-column-address-of-cell-representing-the-first-instance-of-a-string-vba", "title": "Getting Column Address of Cell Representing the First Instance of a String (VBA)", "body": "<p>I want to get the column address of the first cell in a particular worksheet that contains a certain string.</p>\n\n<p>Here is code I have written to do so:</p>\n\n<pre><code>Dim StringInQuestion As String\nDim ColumnRange1 As Range\nNamedSheet.Select\nRange(\"A1\").Select\nOn Error Resume Next\nSet FinalCell = Cells(1, 1).SpecialCells(xlLastCell)\nFinalCellAddress = Cells(FinalCell.Row, FinalCell.Column).Address\nRange(ColumnRange1).Select\nSelection.Copy\nSet ColumnRange1 = NamedSheet.Cells\nDim ColumnRange2 As Range\nColumnRange2 = ColumnRange1.Find(StringInQuestion)\nDim ColumnComposite As Variant\nColumnComposite = ColumnRange1.Address(ColumnAbsolute:=True)\nDim Column As Variant\n\n'Format column address procured for further use (remove any numbers)\n\nDim intColumn As Integer\nColumnComposite = Trim(ColumnComposite)\nFor intColumn = 1 To Len(ColumnComposite)\n    If Not IsNumeric(Mid(ColumnComposite, intColumn, 1)) Then\n        Column = Column &amp; Mid(ColumnComposite, intColumn, 1)\n    End If\nNext intColumn\n'Column = Column\n</code></pre>\n\n<p>Although this code compiles without errors, the 'Column' variable remains undefined.  Any ideas? Please share. Thanks!</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Thank you @ScottHoltzman for your help.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467215393, "post_id": 38104398, "comment_id": 63642586, "body": "<code>CInt</code> or <code>Cdbl</code> can help you convert text to numbers"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1467215798, "last_edit_date": 1467215798, "creation_date": 1467215485, "answer_id": 38104521, "question_id": 38104398, "link": "https://stackoverflow.com/questions/38104398/vba-in-powerpoint-text-box-value/38104521#38104521", "title": "VBA in Powerpoint : Text Box Value", "body": "<p>Try converting the values to numbers first, for example using <code>CLng</code> (convert to long) or <code>CDbl</code> (convert to double) if you expect non-integers.</p>\n\n<pre><code>If CDbl(ActivePresentation.Slides(4).Shapes(\"Rectangle 84\").TextFrame.TextRange.Text.Value) &gt;= CDbl(ActivePresentation.Slides(4).Shapes(\"Rectangle 95\").TextFrame.TextRange.Text.Value) Then XXXX\n</code></pre>\n\n<p>The string <code>\"11\"</code> is \"smaller\" than <code>\"6\"</code> because they get sorted alphabetically.</p>\n\n<p>You could also check if the text is valid using <code>IsNumeric</code> before converting to prevent type mismatches</p>\n"}], "owner": {"reputation": 1, "user_id": 6529300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38be1a01aefc4d978ffff07d0e17b15c?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6529300/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4844, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467215798, "creation_date": 1467215127, "question_id": 38104398, "link": "https://stackoverflow.com/questions/38104398/vba-in-powerpoint-text-box-value", "title": "VBA in Powerpoint : Text Box Value", "body": "<p>I would like to compare the value of 2 text boxes in powerpoint, and highlight the one with the highest numerical value.</p>\n\n<p>Here's my code :</p>\n\n<pre><code>If ActivePresentation.Slides(4).Shapes(\"Rectangle 84\").TextFrame.TextRange.Text.Value &gt;= ActivePresentation.Slides(4).Shapes(\"Rectangle 95\").TextFrame.TextRange.Text.Value Then XXXX\n</code></pre>\n\n<p>Unfortunately if Rectangle 84 has a value of \"11\" and Rectangle 95 a value of 6, then currently the 6 is highlighted.\nIs there any way to convert the text to a numerical value so I get the right result please?</p>\n\n<p>Thanks\nJames</p>\n"}, {"tags": ["c++", "vba", "ms-word", "c++builder", "ole"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467215315, "post_id": 38104339, "comment_id": 63642528, "body": "This isn&#39;t Embarcadero-specific --- it&#39;s almost as much of a pain in VBA!  See <a href=\"http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm\" rel=\"nofollow noreferrer\">this MVP article</a>.  (PS - welcome to the site!)"}, {"owner": {"reputation": 21, "user_id": 6529181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a48c7af0e3c6fbb821dfd0c0622b685?s=128&d=identicon&r=PG&f=1", "display_name": "DMG", "link": "https://stackoverflow.com/users/6529181/dmg"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467339988, "post_id": 38104339, "comment_id": 63703065, "body": "Many thanks CXWfor the answer and welcome.  I have that article and I appreciate its going to be a bit of a journey. I guess my real question atm is - How do I pass a WdStoryType Index parameter as part of the WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item() call from C++ in Embarcadero.  It is unhappy with an OleVariant.  I am clearly not fully getting how to pass parameters in OLE calls."}, {"owner": {"reputation": 21, "user_id": 6529181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a48c7af0e3c6fbb821dfd0c0622b685?s=128&d=identicon&r=PG&f=1", "display_name": "DMG", "link": "https://stackoverflow.com/users/6529181/dmg"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467342603, "post_id": 38104339, "comment_id": 63703657, "body": "This is early binding and WdStoryType is an enum declared in Word_2K.h.  For now, I just want to pass the value wdFootnotesStory = 2.  I have tried a number of variations using an OleVariant wrapper but can&#39;t get it to work.  I am clearly not getting how to pass enum parameters in OLE calls. Cheers."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467376615, "post_id": 38104339, "comment_id": 63720729, "body": "Would you please <a href=\"http://stackoverflow.com/posts/38104339/edit\">edit your question</a> to include the code you&#39;ve tried, and what errors you got (compile or run-time)?  I don&#39;t know the answer off-hand, but maybe seeing what <i>doesn&#39;t</i> work will give me (or another reader) some ideas.  Also, posting the key bits of what you have so far is considered good etiquette on SO. See the <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> page.  Thanks! --- One other thought - per <a href=\"https://msdn.microsoft.com/en-us/library/cc237562.aspx\" rel=\"nofollow noreferrer\">this</a>, maybe a <code>VARIANT</code> <code>VT_I4</code>?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467376785, "post_id": 38104339, "comment_id": 63720831, "body": "Or <a href=\"http://docs.embarcadero.com/products/rad_studio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/devwin32/casmarshalingdata_xml.html\" rel=\"nofollow noreferrer\">this</a>, which says use pull in the type library and use <code>Integer</code>.  (From Google results for <code>ole automation enum type embarcadero</code>.)"}, {"owner": {"reputation": 21, "user_id": 6529181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a48c7af0e3c6fbb821dfd0c0622b685?s=128&d=identicon&r=PG&f=1", "display_name": "DMG", "link": "https://stackoverflow.com/users/6529181/dmg"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467387563, "post_id": 38104339, "comment_id": 63728138, "body": "Thanks CXW for all your help with this one.  I had a good look at the links you sent through.  Any other comments would be appreciated.  I have a lot to learn."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467388057, "post_id": 38104339, "comment_id": 63728410, "body": "Happy to help!  Please move the solution from the bottom of your question to a new answer.  Then, in a few days when the system will let you, hit the checkmark to accept that answer.  That way the question will be cleared off  the Unanswered lists, and it will be easier for others to benefit from what you&#39;ve learned."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6529181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a48c7af0e3c6fbb821dfd0c0622b685?s=128&d=identicon&r=PG&f=1", "display_name": "DMG", "link": "https://stackoverflow.com/users/6529181/dmg"}, "is_accepted": true, "score": 0, "last_activity_date": 1467416153, "creation_date": 1467416153, "answer_id": 38155044, "question_id": 38104339, "link": "https://stackoverflow.com/questions/38104339/retrieve-and-loop-through-story-ranges-from-word-ole-using-embarcadero-c-buil/38155044#38155044", "title": "Retrieve and loop through Story Ranges from Word OLE using Embarcadero C++ (Builder)", "body": "<p>Solution: In the course of adding the code, I think I stumbled across the solution - WdStoryType::wdFootnotesStory. It appears all I was missing was the class qualifier reference.</p>\n"}], "owner": {"reputation": 21, "user_id": 6529181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a48c7af0e3c6fbb821dfd0c0622b685?s=128&d=identicon&r=PG&f=1", "display_name": "DMG", "link": "https://stackoverflow.com/users/6529181/dmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 1, "accepted_answer_id": 38155044, "answer_count": 1, "score": 1, "last_activity_date": 1467416153, "creation_date": 1467214991, "last_edit_date": 1467387978, "question_id": 38104339, "link": "https://stackoverflow.com/questions/38104339/retrieve-and-loop-through-story-ranges-from-word-ole-using-embarcadero-c-buil", "title": "Retrieve and loop through Story Ranges from Word OLE using Embarcadero C++ (Builder)", "body": "<p>I have a code snippet which loops through a list of hyperlink (file link) objects (members <code>anchor</code> and <code>destination</code>) and inserts them into a selected Word document.  I can search the Word document and insert the hyperlink when it finds the target (anchor) string. I would now like to loop through all the <code>StoryRanges</code> in the Word document to ensure that no sections is missed. I can get the number of story ranges, e.g., using <code>WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Count</code>.  However, I can't pass the parameter in the correct form to actually retrieve the story range I want to search next, e.g. <code>WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item</code>.  I have a numeric count but <code>Item</code> expects as a parameter a VBA constant with the correct type.  What am I missing? </p>\n\n<p><strong>Edit</strong> Here is  the code.  The line causing the problem is</p>\n\n<pre><code>wdFootnotesStoryID = WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item(??????)-&gt;get_ID();\n</code></pre>\n\n<p>I previously tried to typing parameters as int, OleVariant.  The error message for OleVariant was did not match the parameter expected. I used wdFootnotesStory in an attempt to reference the enum but that came up as not defined. I tried Int values as well. </p>\n\n<p>Here is the OLESafe enum - defined in Word_2k.h</p>\n\n<pre><code>enum class WdStoryType\n{\n  wdMainTextStory = 1, \n  wdFootnotesStory = 2, \n  wdEndnotesStory = 3, \n  wdCommentsStory = 4, \n  wdTextFrameStory = 5, \n  wdEvenPagesHeaderStory = 6, \n  wdPrimaryHeaderStory = 7, \n  wdEvenPagesFooterStory = 8, \n  wdPrimaryFooterStory = 9, \n  wdFirstPageHeaderStory = 10, \n  wdFirstPageFooterStory = 11\n};\n</code></pre>\n\n<p>Here is the main code.<br>\n    //---------------------------------------------------------------------------</p>\n\n<pre><code>#include &lt;vcl.h&gt;\n#pragma hdrstop\n\n#include \"Main.h\"\n\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma link \"Word_2K_SRVR\"\n#pragma resource \"*.dfm\"\n\nstruct THyperLink\n{\n    String Anchor;\n    String FilePath;\n};\n\nTList* linkList = new TList;\n\nTForm1 *Form1;\n\n\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner)\n{\n    THyperLink* link = new THyperLink;\n    link-&gt;Anchor = \"ABC.0001.0002.0003\";\n    link-&gt;FilePath = \"S:\\\\Development\\\\WordLinking\\\\Test\\\\ABC.0001.0002.0003.pdf\";\n    linkList-&gt;Add(link);\n\n    THyperLink* link2 = new THyperLink;\n    link2-&gt;Anchor = \"ABC.0001.0002.0004\";\n    link2-&gt;FilePath = \"S:\\\\Development\\\\WordLinking\\\\Test\\\\ABC.0001.0002.0004.pdf\";\n    linkList-&gt;Add(link2);\n}\n\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n    OleVariant Template = EmptyParam();\n    OleVariant NewTemplate = False;\n    OleVariant ItemIndex = 1;\n    OleVariant strToInsert = \"Insert String\";\n    OleVariant endOfLine = \"TEST\";\n    OleVariant wdStory = 6;\n    //OleVariant wdMove = 0;\n    OleVariant rng;\n\n    OleVariant strSearch;// = \"ABC.0001.0002.0003\";\n    OleVariant strLink; // = \"S:Development\\\\WordLinking\\\\Test\\\\ABC.0001.0002.0003.pdf\";\n    OleVariant lnkDoc = \"S:\\\\Development\\\\WordLinking\\\\Test\\\\ZZZ.0001.0002.0003.docx\";\n\n    OleVariant wdCharacter = \"wdCharacter\";\n    OleVariant cChars = 18;\n    OleVariant wdMove = \"wdMove\";\n    OleVariant wdTrue = true;\n\n    OleVariant wrdStoryRangeCount;\n    OleVariant wdFootnotesStoryID;\n    OleVariant rangeStory;\n    OleVariant wrdDoc;\n\n    WdStoryType wdFootnotesStory = 2;\n\n\n    try\n    {\n        WordApplication1-&gt;Connect();\n\n    }\n    catch (...)\n    {\n        ShowMessage(\"Microsoft word is not installed\");\n    }\n\n\n\n    //Make application visible\n    WordApplication1-&gt;GetDefaultInterface()-&gt;Visible = True;\n\n    //Open document to be linked\n    WordApplication1-&gt;Documents-&gt;Open(lnkDoc);\n\n    //Open new document - add to document collection in application\n    //WordApplication1-&gt;Documents-&gt;Add(Template, NewTemplate);\n\n    //go to top of the document\n    WordApplication1-&gt;Selection-&gt;HomeKey(wdStory);\n\n    for (int index = 0; index &lt;= linkList-&gt;Count-1; index++)\n    {\n        //Retrieve hyperlink object\n        THyperLink* link = reinterpret_cast&lt;THyperLink*&gt;(linkList-&gt;Items[index]);\n        strSearch = (OleVariant)link-&gt;Anchor;\n        strLink = (OleVariant)link-&gt;FilePath;\n\n        //\n        wrdStoryRangeCount = WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Count;\n\n        //WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item(1);\n\n        wdFootnotesStoryID = WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item(??????)-&gt;get_ID();\n        ShowMessage (\"wdFootnotesStory ID: \" + wdFootnotesStoryID);\n\n        //WordApplication1-&gt;ActiveDocument-&gt;get_\n\n        while (WordApplication1-&gt;Selection-&gt;Find-&gt;Execute(strSearch,Template,Template,Template,Template,Template,wdTrue))\n        //while (WordApplication1-&gt;ActiveDocument-&gt;StoryRanges-&gt;Item(wdFootnotesStory)-&gt;Find-&gt;Execute(strSearch,Template,Template,Template,Template,Template,wdTrue))\n        {\n            WordApplication1-&gt;Selection-&gt;Hyperlinks-&gt;Add(WordApplication1-&gt;Selection-&gt;Range,strLink,Template,Template,strSearch,Template);\n        }\n\n        //go back to top of Word document\n        WordApplication1-&gt;Selection-&gt;HomeKey(wdStory);\n    }\n\n    //Disconnect from word\n    WordApplication1-&gt;Disconnect();\n\n}\n//---------------------------------------------------------------------------\n</code></pre>\n\n<p><strong>Solution</strong>: In the course of adding the code, I think I stumbled across the solution - <code>WdStoryType::wdFootnotesStory</code>.  It appears all I was missing was the class qualifier reference.</p>\n"}, {"tags": ["vba", "reporting-services", "sql-server-2012-datatools"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1467213879, "post_id": 38103688, "comment_id": 63641486, "body": "Is it in excel ? if yes then this can be done by conditional formatting."}, {"owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1467213924, "post_id": 38103688, "comment_id": 63641521, "body": "You can use conditional formatting to achieve this. Select the column, Home-&gt;ConditionalFormatting -&gt; Highlight Cell Rules -&gt; A Date Occurring"}, {"owner": {"reputation": 35, "user_id": 5025601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d869d85fc6f66cee3241f6aaa0017da3?s=128&d=identicon&r=PG&f=1", "display_name": "choloboy", "link": "https://stackoverflow.com/users/5025601/choloboy"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467214384, "post_id": 38103688, "comment_id": 63641857, "body": "@newguy using VS - Data Tools!"}], "answers": [{"tags": [], "owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "is_accepted": false, "score": 2, "last_activity_date": 1467215090, "creation_date": 1467215090, "answer_id": 38104384, "question_id": 38103688, "link": "https://stackoverflow.com/questions/38103688/vb-fill-cell-background-based-on-date-comparing-today-to-cell-value/38104384#38104384", "title": "VB - Fill cell background based on date comparing today to cell value", "body": "<p>Of course the problem is comparing the date without the timestamp. You can use the <code>DateValue</code> function for this like so:</p>\n\n<pre><code>=IIf(DateValue(Fields!Last_Upload.value) = Today, \"Green\", \"Red\")\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5025601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d869d85fc6f66cee3241f6aaa0017da3?s=128&d=identicon&r=PG&f=1", "display_name": "choloboy", "link": "https://stackoverflow.com/users/5025601/choloboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467215090, "creation_date": 1467213314, "last_edit_date": 1467214199, "question_id": 38103688, "link": "https://stackoverflow.com/questions/38103688/vb-fill-cell-background-based-on-date-comparing-today-to-cell-value", "title": "VB - Fill cell background based on date comparing today to cell value", "body": "<p>I have a column that returns dates in this form:</p>\n\n<blockquote>\n  <p>\"2016-06-01 23:29:34.283\"</p>\n</blockquote>\n\n<p>I am wondering how I can fill the cell background green if the day matches today, and red if its not today (hour and minute doesn't matter).</p>\n\n<p>I tried this but no luck: </p>\n\n<pre><code>=Switch(Fields!Last_Upload.value = Today(), \"Green\", Fields!Last_Upload.value != Today(), \"Red\").\n</code></pre>\n\n<p>Edit: This is using VS Data Tools</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467214230, "post_id": 38103595, "comment_id": 63641753, "body": "@newguy I looked at the thread and i still could not get it to work"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467214182, "post_id": 38103778, "comment_id": 63641719, "body": "I tried this but value still does not show up on sheet12"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467215172, "post_id": 38103778, "comment_id": 63642398, "body": "@Leofig123 did you place the code inside the sheet module for sheet10? I tested the code and it works perfectly"}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467215933, "post_id": 38103778, "comment_id": 63642977, "body": "i inserted the code into sheet module sheet 10 and nothing. I inserted the code in the module and the systems keeps looping. The cell (&quot;G6&quot;) where user inputs a value changed to $F$3 and is doing some funky things and cell &quot;F3&quot; where the change happens is changed to 0 and cell Q3 is blank. I updated my question hopefully"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 1, "creation_date": 1467216533, "post_id": 38103778, "comment_id": 63643364, "body": "@Leofig123 - okay. that&#39;s a different story than what you originally wrote. see my modified code. you may need to do a calc after the undo if you have calcs set to manual, but otherwise, it should work. It will place the old <code>F3</code> before the change in <code>G6</code> into <code>Q3</code> in <code>Sheet12</code>."}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467217198, "post_id": 38103778, "comment_id": 63643850, "body": "Unfortunately nothing is showing on sheet 12"}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467217519, "post_id": 38103778, "comment_id": 63644044, "body": "So here is what cell F3 contains... F3 links to another cell in another worksheet(3) which sum up values from different areas in worksheet(3) dependent on userinput in sheet10 cell G6. So i would like to copy the summed value to Q3 before the value changes again"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467218269, "post_id": 38103778, "comment_id": 63644493, "body": "Is your sheet actually named <code>Sheet12</code>? If so, place a break on the <code>If Target.Address ... </code> line, make a change to <code>G6</code> on Sheet10 and step through the code line-by-line, making note of variable values and such, and then you can find what the issue is. Impossible for me to test without your actual file."}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 0, "creation_date": 1467226027, "post_id": 38103778, "comment_id": 63649194, "body": "So i got it to work all in one page . how would i do this for multiple cells. is the below correct? &#39;    sOldValue = Range(&quot;F3:N3&quot;).Value         Target.Value = sNewValue        Range(&quot;V8:AD&quot;) = sOldValue         Application.EnableEvents = True&#39;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 1, "creation_date": 1467227093, "post_id": 38103778, "comment_id": 63649869, "body": "@Leofig123 - you are really asking a new question. Next time be more specific with your needs so it&#39;s all upfront. This time I have made an edit to assist you in your additional question that is out-of-scope from the first question, but in the future, please keep questions pointed and specific. It&#39;s more useful to others that way."}, {"owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "edited": false, "score": 1, "creation_date": 1467250674, "post_id": 38103778, "comment_id": 63658726, "body": "Thank you i appreciate all your help"}, {"owner": {"reputation": 201, "user_id": 2452696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef80433909cfdc26b585b95148d5f480?s=128&d=identicon&r=PG", "display_name": "ProfessorFluffy", "link": "https://stackoverflow.com/users/2452696/professorfluffy"}, "edited": false, "score": 0, "creation_date": 1501787998, "post_id": 38103778, "comment_id": 77947035, "body": "Too lazy to do a search but then writes full response..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 201, "user_id": 2452696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef80433909cfdc26b585b95148d5f480?s=128&d=identicon&r=PG", "display_name": "ProfessorFluffy", "link": "https://stackoverflow.com/users/2452696/professorfluffy"}, "edited": false, "score": 0, "creation_date": 1501795836, "post_id": 38103778, "comment_id": 77951243, "body": "@ProfessorFluffy - Too lazy to search = I had that code <i>right at my fingertips</i>, so it was much easier to answer than dig for other answers."}, {"owner": {"reputation": 201, "user_id": 2452696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef80433909cfdc26b585b95148d5f480?s=128&d=identicon&r=PG", "display_name": "ProfessorFluffy", "link": "https://stackoverflow.com/users/2452696/professorfluffy"}, "edited": false, "score": 1, "creation_date": 1501796365, "post_id": 38103778, "comment_id": 77951455, "body": "I know. I just thought it was funny."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1467227019, "last_edit_date": 1467227019, "creation_date": 1467213566, "answer_id": 38103778, "question_id": 38103595, "link": "https://stackoverflow.com/questions/38103595/vba-copy-cell-value-before-change-event-into-different-worksheet/38103778#38103778", "title": "VBA Copy Cell value before Change event into different worksheet", "body": "<p>This question has been asked on SO before, but I am too lazy at the moment to search for it ... </p>\n\n<p>Since the <code>Worksheet_Change</code> events fires <strong>after</strong> a cell changes, the <code>Target.Value</code> will reflect the new value. However, the <code>Undo</code> command can be used to get the old value by storing the new value into a variable, running the undo, then updating the target with the new value and storing the old value in the desired place.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = Range(\"G6\").Address Then\n\n        Application.EnableEvents = False\n\n        Dim sOldValue As String, sNewValue As String\n        sNewValue = Target.Value\n\n        Application.Undo\n        sOldValue = Range(\"F3\").Value\n\n        Target.Value = sNewValue\n\n        Worksheets(\"Sheet12\").Range(\"Q3\") = sOldValue\n\n        Application.EnableEvents = True\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>For multiple cells do this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = Range(\"G6\").Address Then\n\n        Application.EnableEvents = False\n\n        Dim sOldValue As String, sNewValue As String\n        sNewValue = Target.Value\n\n        Application.Undo\n\n        Dim rOld as Range\n        Set rOld = Range(\"F3:V3\").Value\n\n        Target.Value = sNewValue\n\n        Range(\"V8:AD8\").Value = rOld.Value\n\n        Application.EnableEvents = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5838017, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8499156c5947a399e195eee9c483b18b?s=128&d=identicon&r=PG&f=1", "display_name": "Leocodetwist", "link": "https://stackoverflow.com/users/5838017/leocodetwist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4333, "favorite_count": 0, "closed_date": 1467227180, "accepted_answer_id": 38103778, "answer_count": 1, "score": 0, "last_activity_date": 1467227019, "creation_date": 1467213074, "last_edit_date": 1467215529, "question_id": 38103595, "link": "https://stackoverflow.com/questions/38103595/vba-copy-cell-value-before-change-event-into-different-worksheet", "closed_reason": "Duplicate", "title": "VBA Copy Cell value before Change event into different worksheet", "body": "<p>I have \"Sheet10\" where cell \"F3\" does some calculation and value changes depending on user input. User Input is on \"Sheet10\" cell \"G6\".  I would like to copy the final calculated value of \"F3\" before the new value in changed into \"Sheet12\" Cell \"Q3\"  Below is my code but I'm not sure where i went wrong. \nThanks in advance! </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = Range(\"F3\").Address Then\n\n        Worksheets(\"Sheet12\").Range(\"Q3\") = Target.Value\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1467214046, "post_id": 38103552, "comment_id": 63641618, "body": "You could try <code>WorksheetFunction.Vlookup</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1467218572, "post_id": 38103552, "comment_id": 63644655, "body": "Can you sort data in the &quot;big&quot; sheet? (BTW: 100+ rows is no big row number at all!)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467214062, "post_id": 38103852, "comment_id": 63641628, "body": "Was just looking into this, updated my question. I think you misunderstood it. Just clarified it a little"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467214148, "post_id": 38103852, "comment_id": 63641697, "body": "OK. Yes, I would concatenate last and first names, more or less as I stated in my answer and you stated in your updated question, then use the find function I mention, thereby only needing one loop, not two."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467214324, "post_id": 38103852, "comment_id": 63641816, "body": "Oh, I see, you don&#39;t want to concatenate in the spreadsheet. Then why not concatenate in your code and store the result in an array?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467214453, "post_id": 38103852, "comment_id": 63641909, "body": "Or stick the concatenated column in a separate worksheets so it won&#39;t affect what you have in the original worksheet?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467215364, "post_id": 38103852, "comment_id": 63642564, "body": "I just modified my code. Now I have a find on the last name and then a check to see if one column over has the first name. I believe that should do it for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467220469, "post_id": 38103852, "comment_id": 63645817, "body": "Actually, I noticed that this will only work if there are no duplicate <code>last names</code>. If the <code>last name</code> matches but the <code>first name</code> doesn&#39;t, how can I make it keep searching until it finds it. I know for a fact it will find it, so it has to find it."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467221310, "post_id": 38103852, "comment_id": 63646330, "body": "I believe the do loop I added addresses this. Let me know if it doesn&#39;t."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467223123, "post_id": 38103852, "comment_id": 63647409, "body": "I added what I had come up with. I almost have it. Your implementation worked, but didn&#39;t when I added another filter to match. <b>EDIT:</b> I updated my answer with what I have."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1467223301, "post_id": 38103852, "comment_id": 63647539, "body": "Did you add the do-loop I added? How many filters do you have? Maybe simplest is to copy the filter code I gave you for each one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467225071, "post_id": 38103852, "comment_id": 63648626, "body": "I found an answer, I&#39;ll update my question so others can learn from my mistake. If you can improve upon it, be my guest"}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 1, "last_activity_date": 1467216577, "last_edit_date": 1467216577, "creation_date": 1467213745, "answer_id": 38103852, "question_id": 38103552, "link": "https://stackoverflow.com/questions/38103552/finding-if-a-column-cell-equals-another-in-a-different-sheet/38103852#38103852", "title": "Finding if a column cell equals another in a different sheet", "body": "<p>Instead of using two loops, you can use just the first one and utilize the <code>find</code> function. I believe it'll be faster for you.</p>\n\n<pre><code>For i = 2 To managerRows 'Looping through the Managers Table\n    empFirst = managerSheet.Cells(i, 1)\n    empLast = managerSheet.Cells(i, 2)\n    empName = (empLast &amp; \", \" &amp; empFirst)\n    managerLast = managerSheet.Cells(i, 3)\n    managerFirst = managerSheet.Cells(i, 4)\n    managerName = (managerLast &amp; \", \" &amp; managerFirst)\n\n    MsgBox (empName &amp; \", \" &amp; managerName)\n\n    Set myRng = assignSheet.Range(assignSheet.Cells(3, 4), assignSheet.Cells(assignRows, 4) \n    Set c = myRng.Find(empName, lookin:=xlValues)\n    if Not c is Nothing Then 'you found last name, no look to see if first is a match \n      if assignSheet.cells(c.row, 5) = empFirst then 'if it is, do something\n          'do whatever you need to do here\n      else\n          firstAddress = c.Address\n          Do\n              Set c = myRng.FindNext(c)\n\n              if Not c is Nothing Then 'you found last name, no look to see if first is a match \n                  if assignSheet.cells(c.row, 5) = empFirst then 'if it is, do something\n                      'do whatever you need to do here\n                  end if\n              end if\n          Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress \n      end if\n    end if\nNext i\n</code></pre>\n\n<p>For more information on <code>find</code>, look <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">here</a>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467215061, "post_id": 38104262, "comment_id": 63642300, "body": "Yeah this works for just finding if they exist, but I need the row number that they exist in also. Find is better for my problem because I can find the row number."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1467215790, "post_id": 38104262, "comment_id": 63642870, "body": "please check my edit... it should run pretty fast ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "edited": false, "score": 0, "creation_date": 1467218988, "post_id": 38104262, "comment_id": 63644900, "body": "This worked also after some tweaking. I wish I could choose two correct answers. Thanks"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1467216076, "last_edit_date": 1467216076, "creation_date": 1467214802, "answer_id": 38104262, "question_id": 38103552, "link": "https://stackoverflow.com/questions/38103552/finding-if-a-column-cell-equals-another-in-a-different-sheet/38104262#38104262", "title": "Finding if a column cell equals another in a different sheet", "body": "<p>you only need to know if it is there... then use <a href=\"https://support.office.com/en-us/article/COUNTIFS-function-dda3dc6e-f74e-4aee-88bc-aa8c2a866842\" rel=\"nofollow\">COUNTIFS</a> like:</p>\n\n<pre><code>=COUNTIFS(A:A,\"Name\",B:B,\"Lastname\"....)\n</code></pre>\n\n<p>and if it is not 0 then there is a match.</p>\n\n<p>For VBA it is</p>\n\n<pre><code>Application.Countifs(Range(\"A:A\"),\"Name\",Range(\"B:B\"),\"Lastname\"....)\n</code></pre>\n\n<p>If you have any questions left, just ask ;)</p>\n\n<p><strong>EDIT</strong></p>\n\n<blockquote>\n  <p>... I need the row number that they exist in ...</p>\n</blockquote>\n\n<p>You never said that! *angry face*... still, it is possible to do in a more or less fast way:</p>\n\n<pre><code>Sub test()\n  Dim val As Variant, rowNum As Variant\n  With Sheets(\"Sheet1\")\n    val = Evaluate(Intersect(.Columns(1), .UsedRange).Address &amp; \"&amp;\"\" --- \"\"&amp;\" &amp; Intersect(.Columns(2), .UsedRange).Address)\n    rowNum = Application.Match(\"name\" &amp; \" --- \" &amp; \"firstname\", val, 0)\n    If IsNumeric(rowNum) Then Debug.Print \"Found at Row: \" &amp; rowNum Else Debug.Print \"Nothing was found\"\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467215239, "creation_date": 1467215239, "answer_id": 38104441, "question_id": 38103552, "link": "https://stackoverflow.com/questions/38103552/finding-if-a-column-cell-equals-another-in-a-different-sheet/38104441#38104441", "title": "Finding if a column cell equals another in a different sheet", "body": "<p>I usually use a dictionary or collection when looking for duplicates.  In this way I only have to loop through each list one time.</p>\n\n<pre><code>Sub FindDuplicates()\n    Dim empFirst As String, empLast As String, empName As String\n    Dim assignSheet As Worksheet, managerSheet As Worksheet\n    Dim i As Long, lastRow As Long\n    Dim d\n    Set assignSheet = Sheet2\n    Set managerSheet = Sheet1\n\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    With managerSheet\n        lastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To lastRow    'Looping through the Managers Table\n            empFirst = .Cells(i, 1)\n            empLast = .Cells(i, 2)\n            empName = (empLast &amp; \", \" &amp; empFirst)\n            If Not d.exists(empName) Then d.Add empName, i\n        Next\n    End With\n\n\n    With assignSheet\n        lastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To lastRow    'Looping through the Managers Table\n            empFirst = .Cells(i, 4)\n            empLast = .Cells(i, 5)\n            empName = (empLast &amp; \", \" &amp; empFirst)\n            If d.exists(empName) Then\n\n                Debug.Print \"Match Found\", empName, \"assignSheet Row:\" &amp; i, \"managerSheet Row:\" &amp; d(empName)\n\n            End If\n\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/L0b1V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L0b1V.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3325783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 38103852, "answer_count": 3, "score": 1, "last_activity_date": 1467225273, "creation_date": 1467212972, "last_edit_date": 1467225273, "question_id": 38103552, "link": "https://stackoverflow.com/questions/38103552/finding-if-a-column-cell-equals-another-in-a-different-sheet", "title": "Finding if a column cell equals another in a different sheet", "body": "<p>I want to find out if a particular group of cells match another group of cells in a different sheet using VBA. In my case, I need to find out if the <code>lastName, firstName</code> cells match. In my solution that I came up with, I'm looping through the first table, getting the employee name. Then looping through the second table, getting the employee name. Then seeing if the two match up. This method is too costly and takes too long. Is there any better way to do this? </p>\n\n<p>My first table contains 6 rows, my second table can contain 100+ rows. Too much time is wasted. </p>\n\n<p>I was thinking about just searching down the entire column to see if the last name matches first, if it does, then go and see if the first name matches... but then again, there could be some people with the same last name..</p>\n\n<p>Here is what I have so far.</p>\n\n<pre><code>For i = 2 To managerRows 'Looping through the Managers Table\n        empFirst = managerSheet.Cells(i, 1)\n        empLast = managerSheet.Cells(i, 2)\n        empName = (empLast &amp; \", \" &amp; empFirst)\n\n        For j = 3 To assignRows 'Looping through the Assignments table\n           empLastAssign = assignSheet.Cells(i, 4)\n           empFirstAssign = assignSheet.Cells(i, 5)\n           empNameAssign = (empLastAssign &amp; \", \" &amp; empFirstAssign)\n           'MsgBox (empNameAssign)\n           ...\n           Conditional statement comparing names\n           ...\n        Next j\n    Next i\n</code></pre>\n\n<p>I know I have no conditional statement, I didn't bother writing it because I knew this approach is not the best one.</p>\n\n<p>I cannot add another column to concatenate the second sheets names because they are read from a database and kept in separate columns and last name and first name. Anyways, is there a way that I can concatenate the names <strong>without adding another column</strong> to the second sheet and try to find them that way? Does that make sense? </p>\n\n<p><code>Find</code> will only look in one column if I'm not mistaken. Can it look in two?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'm able to get the first occurrence of the last name, but not the others. I've added another field to match. So there are three fields to match now. <code>Last Name</code>, <code>First Name</code>, and <code>Project Name</code>. So far, my code will only find the first occurrence and stay there. I think my order of the looping is wrong.</p>\n\n<p>Here is what I have so far.</p>\n\n<pre><code>  For i = 2 To managerRows 'Looping through the Managers Table\n        empLast = managerSheet.Cells(i, 1)\n        empFirst = managerSheet.Cells(i, 2)\n        empName = (empLast &amp; \", \" &amp; empFirst)\n        projectName = managerSheet.Cells(i, 3)\n        managerLast = managerSheet.Cells(i, 4)\n        managerFirst = managerSheet.Cells(i, 5)\n        managerName = (managerLast &amp; \", \" &amp; managerFirst)\n\n        Set findRow = assignSheet.Range(assignSheet.Cells(3, 4), assignSheet.Cells(assignRows, 4)) 'Set a range to look for Last Name\n        Set c = findRow.Find(empLast, LookIn:=xlValues) 'Find matching Last Name if it exists\n        If Not c Is Nothing Then 'Last Name found\n            Do Until c Is Nothing 'Is this in the wrong place?\n                If Cells(c.Row, 5) = empFirst Then 'If first name matches\n                    If Cells(c.Row, 10) = projectName Then 'If project name matches. We found them\n                        MsgBox (\"Found: \" &amp; empLast &amp; \", \" &amp; empFirst &amp; \": Project: \" &amp; projectName &amp; \" : in: \" &amp; c.Row)\n                    End If\n                End If\n                Set c = findRow.FindNext(c) 'Is this is the wrong place?\n            Loop\n        End If\n        Set c = Nothing 'Is this in the wrong place?\n    Next i\n</code></pre>\n\n<p>Take a look at <code>'Is this in the wrong place?</code> for my new loop.</p>\n\n<p><strong>UPDATE 2: Solved</strong></p>\n\n<p>I have successfully filtered on three columns using <code>find</code> and <code>findNext</code>. With the help of some good answers. I will post the completed version. I had to add extra else statement into my filters in order to go to the next ling found. Hopefully others can learn from this, as there is no clear answer for filtering on three columns using <code>find</code>.</p>\n\n<pre><code>For i = 2 To managerRows 'Looping through the Managers Table\n        empLast = managerSheet.Cells(i, 1)\n        empFirst = managerSheet.Cells(i, 2)\n        empName = (empLast &amp; \", \" &amp; empFirst)\n        projectName = managerSheet.Cells(i, 3)\n        managerLast = managerSheet.Cells(i, 4)\n        managerFirst = managerSheet.Cells(i, 5)\n        managerName = (managerLast &amp; \", \" &amp; managerFirst)\n        'Focus Below this\n        Set findRow = assignSheet.Range(assignSheet.Cells(3, 4), assignSheet.Cells(assignRows, 4)) 'Set a range to look for Last Name\n        Set c = findRow.Find(empLast, LookIn:=xlValues) 'Find matching Last Name if it exists\n        If Not c Is Nothing Then 'Last Name found\n            Do Until c Is Nothing\n                If Cells(c.Row, 5) = empFirst Then 'If first name matches\n                    If Cells(c.Row, 10) = projectName Then 'If project name matches. We found them\n                        MsgBox (\"Found: \" &amp; empLast &amp; \", \" &amp; empFirst &amp; \": Project: \" &amp; projectName &amp; \" : in: \" &amp; c.Row)\n                        Set c = Nothing\n                    Else\n                        Set c = findRow.FindNext(c)\n                    End If\n                Else\n                    Set c = findRow.FindNext(c)\n                End If\n            Loop\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "range", "copy-paste"], "comments": [{"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 1, "creation_date": 1467213501, "post_id": 38103484, "comment_id": 63641195, "body": "Please define what &quot;I am having trouble&quot; means exactly.   Are you getting an error?   If no error but unexpected results, then add an example of the results you are getting, and the results you are trying to get instead."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1467214431, "post_id": 38103484, "comment_id": 63641892, "body": "Only problem I see is your <code>PasteSpecial</code> line.  After <code>PasteSpecial</code> there should be a space, then <code>xlPasteValues</code>, not a period."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467216258, "post_id": 38103484, "comment_id": 63643175, "body": "For some reason, The macro is going across and copying the rest of the columns. It only copies and pastes the first set of 4. Also, thanks for that Darell"}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467216641, "post_id": 38103484, "comment_id": 63643457, "body": "Uploaded images of the source and destination sheets respectively."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467230040, "post_id": 38108569, "comment_id": 63651398, "body": "Hey Chris, attached an image to your comment. I tried your code and for some reason it pasted the info on the blank sheet in row 111. I tried it many times, and initially it pasted in row 65 or something and everytime I would delete and try again it would paste 20-30 rows further down..Also it isn&#39;t copying the rest of the data in the other columns. stays stuck at the first 4"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467231581, "post_id": 38108569, "comment_id": 63652210, "body": "I&#39;ve just tried it again with my data and it worked perfectly. It starts pasting in at row 2 and adds the rest of the data below the data it&#39;s already pasted in."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467233265, "post_id": 38108569, "comment_id": 63653027, "body": "That is really odd. Is the data 4 blank columns apart? Also is the loop working (is the data copying the four columns and pasting it in a new sheet then moving to the next four columns and copying it then pasting it under the previously pasted data?)"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467233721, "post_id": 38108569, "comment_id": 63653274, "body": "My data starts in with a heading in cell B3, and then B4:E23, next header at J3, data in J4:M15, and so on. That&#39;s why I changed the step in your loop to 8 rather than 7."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467236370, "post_id": 38108569, "comment_id": 63654498, "body": "that sounds about right for me too, very weird why it isn&#39;t working for me. What do you think it might be?"}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467291178, "post_id": 38108569, "comment_id": 63678738, "body": "It is now working! But for some reason, I get my start as row 184 when I first debug NextRow= .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row + 1."}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467304642, "post_id": 38108569, "comment_id": 63688907, "body": "I&#39;m not sure. Is your destination sheet (&quot;Sheet2&quot;) empty? Did you change the PasteSpecial line as indicated above?"}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467308220, "post_id": 38108569, "comment_id": 63690868, "body": "yes I did change it and destination sheet is empty!"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467313361, "post_id": 38108569, "comment_id": 63693755, "body": "Do you have &#39;Option Explicit&#39; at the top of the module your code is in? I&#39;m wondering if there&#39;s an obscure spelling mistake stopping your code from working."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467317178, "post_id": 38108569, "comment_id": 63695820, "body": "yes sir I have that added, so I have no idea what is going on! Did you see the photo above to see what my data looks like? Thanks again"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467397722, "post_id": 38108569, "comment_id": 63733213, "body": "Yes, I looked at the photo and I have no idea what that&#39;s happening."}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467399919, "post_id": 38108569, "comment_id": 63734184, "body": "I&#39;ve updated this to avoid copy/paste. I don&#39;t know if it will work for you."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467633488, "post_id": 38108569, "comment_id": 63794074, "body": "unfortunately that isn&#39;t working for me. The old code was better in that it was performing everything with some errors. Do you mind reposting it so I can play around with it some more? Thanks again"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467647175, "post_id": 38108569, "comment_id": 63802371, "body": "Rolled back. I&#39;m still at a loss as to why it&#39;s not working."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467652802, "post_id": 38108569, "comment_id": 63804869, "body": "It is now working! I deleted the sheet and re-added and it now works!"}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467652840, "post_id": 38108569, "comment_id": 63804883, "body": "I want the data to be pasted with a one row break in between each group of data, any idea on how to achieve that?"}, {"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467654459, "post_id": 38108569, "comment_id": 63805452, "body": "Use <code>NextRow = NextRow + Rngsource.Rows.Count + 1</code>"}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467807078, "post_id": 38108569, "comment_id": 63869299, "body": "Thanks!  Much appreciated"}], "tags": [], "owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "is_accepted": true, "score": 0, "last_activity_date": 1477675428, "last_edit_date": 1477675428, "creation_date": 1467228793, "answer_id": 38108569, "question_id": 38103484, "link": "https://stackoverflow.com/questions/38103484/copy-pasting-range-of-varying-length-from-one-worksheet-to-another-worksheet-usi/38108569#38108569", "title": "Copy Pasting Range of varying length from one worksheet to another worksheet using Excel VBA", "body": "<p><a href=\"https://i.stack.imgur.com/qFjid.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qFjid.png\" alt=\"enter image description here\"></a></p>\n\n<p>This seems to work for me.</p>\n\n<pre><code>Sub CopyPasteDex()\n\n  Dim wksDest             As Worksheet\n  Dim wksSource           As Worksheet\n  Dim Rngsource           As Range\n  Dim NextRow             As Long\n  Dim LastRow             As Long\n  Dim LastCol             As Long\n  Dim c                   As Long\n\nApplication.ScreenUpdating = False\n\nSet wksSource = Worksheets(\"Sheet1\")\nSet wksDest = Worksheets(\"Sheet2\")\n\nWith wksDest\n    NextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\nEnd With\n\nWith wksSource\n    LastCol = .Cells(3, .Columns.Count).End(xlToLeft).Column\n    For c = 2 To LastCol Step 8    ' make sure that the step is changed to 8 here.\n        LastRow = .Cells(.Rows.Count, c).End(xlUp).Row\n        Set Rngsource = .Range(.Cells(3, c), .Cells(LastRow, c + 3))\n        Rngsource.copy\n        wksDest.Cells(NextRow, 1).PasteSpecial xlPasteValues    ' Note that I've changed .range to .cells and changed the destination row to NextRow\n        NextRow = NextRow + Rngsource.Rows.Count\n    Next c\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 0, "accepted_answer_id": 38108569, "answer_count": 1, "score": 0, "last_activity_date": 1549400788, "creation_date": 1467212792, "last_edit_date": 1549400788, "question_id": 38103484, "link": "https://stackoverflow.com/questions/38103484/copy-pasting-range-of-varying-length-from-one-worksheet-to-another-worksheet-usi", "title": "Copy Pasting Range of varying length from one worksheet to another worksheet using Excel VBA", "body": "<p>I have data that is set up to output as follows:</p>\n\n<ul>\n<li>4 columns of data</li>\n<li>then the data is separated by 4 blank columns and then there are another 4 columns of data etc.  </li>\n<li>The rows differ in length </li>\n<li>The data is pulled in from Bloomberg and so the rows may change every time the data is refreshed. </li>\n<li>The data starts at row 3 and column 2.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/fB12j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fB12j.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to create a loop that </p>\n\n<ul>\n<li>selects the entire 4 columns, copies and pastes them in another worksheet</li>\n<li>then moves across the 4 blank columns, copies the data and pastes it in the other worksheet right below the previously pasted data </li>\n<li>until the last column with data is reached. </li>\n<li>I'm trying to create a blank row in between each, and am also trying to keep the 4 columns next to each other when I pasted them into the new worksheet</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/Xp4kM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xp4kM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code I am having trouble with....</p>\n\n<pre><code>Sub CopyPasteDex()\n\n  Dim wksDest             As Worksheet\n  Dim wksSource           As Worksheet\n  Dim Rngsource           As Range\n  Dim NextRow             As Long\n  Dim LastRow             As Long\n  Dim LastCol             As Long\n  Dim c                   As Long\n\nApplication.ScreenUpdating = False\n\nSet wksSource = Worksheets(\"Sheet1\")\nSet wksDest = Worksheets(\"Sheet2\")\n\nWith wksDest\n    NextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\nEnd With\n\nWith wksSource\n    LastCol = .Cells(3, .Columns.Count).End(xlToLeft).Column\n    For c = 2 To LastCol Step 7\n        LastRow = .Cells(.Rows.Count, c).End(xlUp).Row\n        Set Rngsource = .Range(.Cells(3, c), .Cells(LastRow, c + 3))\n        Rngsource.Copy\n        wksDest.Range(\"A:A\").PasteSpecial.xlPasteValues\n        NextRow = NextRow + Rngsource.Rows.Count\n    Next c\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467213209, "creation_date": 1467213209, "answer_id": 38103646, "question_id": 38103226, "link": "https://stackoverflow.com/questions/38103226/filter-copy-and-past-the-row-without-header-in-vba/38103646#38103646", "title": "filter, copy and past the row without header in vba", "body": "<p>This will copy the visible cells without a header row.</p>\n\n<pre><code>Dim rSource As Range\nSet rSource = Range(\"A1\").CurrentRegion.Offset(1)\n\nrSource.Resize(rSource.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5872797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf83319cc8d89c11e5b71fce6909ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Mohd", "link": "https://stackoverflow.com/users/5872797/gaus-mohd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4756, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1467217292, "creation_date": 1467212150, "last_edit_date": 1467217292, "question_id": 38103226, "link": "https://stackoverflow.com/questions/38103226/filter-copy-and-past-the-row-without-header-in-vba", "title": "filter, copy and past the row without header in vba", "body": "<p>I want to copy the filtered data and paste it in difference excel file. I am able to filter , copy and paste the rows. The only problem I am facing is that it is also copying and pasting the header every time. Please advise as to how to avoid header to be pasted.</p>\n\n<pre><code>If Not ws1.AutoFilterMode Then\n    ws1.Range(\"D1\").AutoFilter field:=4, Criteria1:=\"=Gaus\", Criteria2:=\"=Shaikh\", Operator:=xlFilterValues\n    RowCount = ws1.Application.WorksheetFunction.Subtotal(2, Range(\"A2:A1048576\"))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 2, "creation_date": 1467210975, "post_id": 38102763, "comment_id": 63639303, "body": "Split it using <code>VbCrlf</code> and access the <code>1</code> st element of the array. Like if you do <code>cet = Split(cells(1,1).value, vbcrlf)</code> then <code>Msgbox cet(1)</code> will give you the second line."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1467211332, "post_id": 38102763, "comment_id": 63639589, "body": "<code>vbCrlf</code> might not work. In this case you can try <code>Chr(10)</code>: <code>Debug.Print Split(ThisWorkbook.Worksheets(1).Range(&quot;A1&quot;).Value2, Chr(10))(1)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1467219514, "post_id": 38103283, "comment_id": 63645221, "body": "@Mat&#39;sMug  It <b>might</b> work...............but it you are pasting material into a worksheet, the breaks might be <i>ASCII10</i> or <i>ASCII13</i> or even both.........the VBA should work either way."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1467212311, "creation_date": 1467212311, "answer_id": 38103283, "question_id": 38102763, "link": "https://stackoverflow.com/questions/38102763/vba-how-to-get-around-carriage-returns/38103283#38103283", "title": "VBA - How to get around carriage returns", "body": "<p>With data in <strong>A1</strong>, in another cell enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,CHAR(10),REPT(\" \",999)),2*999-998,999))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ouIhw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ouIhw.png\" alt=\"enter image description here\"></a></p>\n\n<p>If this does not work, use <code>CHAR(13)</code>.</p>\n\n<p>To do this in VBA:</p>\n\n<pre><code>Public Function SecondLine(s As String) As String\n    s = Replace(s, Chr(13), Chr(10))\n    s = Replace(s, Chr(10) &amp; Chr(10), Chr(10))\n    SecondLine = Split(s, Chr(10))(1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6449087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c1595aa893e7e26e12f30201e1a2a?s=128&d=identicon&r=PG&f=1", "display_name": "J. Taylor", "link": "https://stackoverflow.com/users/6449087/j-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467212311, "creation_date": 1467210905, "last_edit_date": 1467211097, "question_id": 38102763, "link": "https://stackoverflow.com/questions/38102763/vba-how-to-get-around-carriage-returns", "title": "VBA - How to get around carriage returns", "body": "<p>I think this should be fairly easy to do but I am struggling:- I have a cell with data which is separated by multiple carriage returns. I always want the second line of data but I am unsure how to pull just this out? Data example is like below:</p>\n\n<pre><code>Line 1: This line can be any length\nLine 2: Same with this one\nLine 3: so on\nLine 4: and so forth\nLine 5: etc\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>James</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1467209849, "post_id": 38102315, "comment_id": 63638466, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a>"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1467209900, "post_id": 38102315, "comment_id": 63638502, "body": "File size doesn&#39;t matter if you just want to find the file in the folder."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467210934, "post_id": 38102315, "comment_id": 63639279, "body": "Is the text in question part of the file name or is it something that occurs in the file itself? If the latter, are these files text files? xlsx files? Also -- I am adding a VBScript tag to your question since I suspect that the optimal answer involves File System Objects, and any VBScript solution is easily run from VBA."}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1467211057, "post_id": 38102315, "comment_id": 63639370, "body": "The <code>Dir()</code> solution did not work as it says &quot;Bad file name or number&quot; (Error 52). I am referencing the network path as <code>\\\\thisisthefolder\\anotherfolder</code>"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1467211205, "post_id": 38102315, "comment_id": 63639473, "body": "Just add \\ to the end of the folder string so it should be \\thisisthefolder\\anotherfolder\\"}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 1, "creation_date": 1467211304, "post_id": 38102315, "comment_id": 63639567, "body": "I got it! I had to add \\ by the end of the string"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467211165, "creation_date": 1467209708, "last_edit_date": 1531164843, "question_id": 38102315, "link": "https://stackoverflow.com/questions/38102315/find-file-with-specific-text-in-folder", "title": "Find file with specific text in folder", "body": "<p>I am trying to loop through all the files in a folder and get the path of one that contains a specific part of text. The text is not always in the same position and the folder is a network folder.\nWhat would be the fastest way to do this in a network folder that contains hundreds of files with more than 30Mb each?</p>\n\n<p>The <code>Dir()</code> solution did not work as it says \"Bad file name or number\" (Error 52). I am referencing the network path as <code>\\\\thisisthefolder\\anotherfolder\\</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1467209233, "post_id": 38101700, "comment_id": 63637951, "body": "Try Shell &quot;Camera.exe&quot;, vbMaximisedFocus"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467210680, "post_id": 38101700, "comment_id": 63639097, "body": "Unfortunately that gives error 53 file not found"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467211052, "post_id": 38101700, "comment_id": 63639364, "body": "You usually don&#39;t have to specify the path for a Windows application but try Shell &quot;C:\\Windows\\Camera\\Camera.exe&quot;, vbMaximisedFocus"}], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467210738, "post_id": 38102226, "comment_id": 63639145, "body": "Thanks for the help Rodger, but I still have the same problem, it delays slightly and moves on with no error message and no camera"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467211465, "post_id": 38102226, "comment_id": 63639706, "body": "Have you called other programs successfully? What if you change it to C:\\Windows\\system32\\notepad.exe?"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467211652, "post_id": 38102226, "comment_id": 63639870, "body": "OK, and oddly enough... what if you change vbMaximizedFocus to 3. It is supposed to work either way but notepad doesn&#39;t open with the text but does with the 3... o.O"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467276551, "post_id": 38102226, "comment_id": 63668655, "body": "Unfortunately still the same  Edit, and yes, notepad works absolutely fine, I&#39;m wondering if the problem is more application specific"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1467291404, "post_id": 38102226, "comment_id": 63678902, "body": "Yeah, that&#39;s why I asked. :("}], "tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": false, "score": 2, "last_activity_date": 1467209495, "creation_date": 1467209495, "answer_id": 38102226, "question_id": 38101700, "link": "https://stackoverflow.com/questions/38101700/shell-camera-exe-from-vba-excel/38102226#38102226", "title": "Shell Camera.exe from VBA Excel", "body": "<p>You need to call it. Try this.</p>\n\n<pre><code>Sub Main()\n    Call Shell(\"C:\\Windows\\Camera\\Camera.exe\", vbMaximisedFocus)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1467209495, "creation_date": 1467208380, "question_id": 38101700, "link": "https://stackoverflow.com/questions/38101700/shell-camera-exe-from-vba-excel", "title": "Shell Camera.exe from VBA Excel", "body": "<p>Using the <code>Shell</code> command i'd like to open camera.  However, when i try the below command, i get a pause of 3 seconds or so and the function ends (no error message) whithout opening the Microsoft Camera application.  Why is this and how can i avoid the problem?</p>\n\n<pre><code>sub Main\n    Shell(\"C:\\Windows\\Camera\\Camera.exe\", vbMaximisedFocus)\nend sub\n</code></pre>\n\n<p>Had a look at the msdn page, but i couldn't get the diagnostics.process object to registed.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/xe736fyk(v=vs.90).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/xe736fyk(v=vs.90).aspx</a></p>\n\n<p>Using Excel 13, I've tried multiple options for the second argument to no avail.  Help appreciated.</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1467208706, "post_id": 38101692, "comment_id": 63637450, "body": "The best here would be to have only one databse. I tou can&#39;t, your database will never be able to share the primary key (if is is an auto incremented one), so that might be a problem."}, {"owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1467208920, "post_id": 38101692, "comment_id": 63637673, "body": "Due to multiple office locations, the database needs to be stored on two different drives - one for each location"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1467208962, "post_id": 38101692, "comment_id": 63637712, "body": "Then you should do away with the auto incremented primary key."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467213041, "post_id": 38101692, "comment_id": 63640870, "body": "It just sounds like you&#39;re asking about merging one table from two different databases. Is the file path field defined with a unique index? You should be able to prebuild append queries with all the fields except the autonumber field."}, {"owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "edited": false, "score": 0, "creation_date": 1467213569, "post_id": 38101692, "comment_id": 63641248, "body": "Trying to merge all tables but the more important one is my products table. Each record is defined with a unique auto number ID field. The file path field does not have a unique index because some file paths are used more than once for different product numbers."}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467209864, "creation_date": 1467209864, "answer_id": 38102364, "question_id": 38101692, "link": "https://stackoverflow.com/questions/38101692/merging-two-access-databases-stored-in-different-locations/38102364#38102364", "title": "Merging Two Access Databases Stored in Different Locations", "body": "<p>You could have a macro that overwrites one of the databases, effectively having a master database and a backup?</p>\n\n<pre><code>Save = Application.GetSaveAsFilename _\n(FileFilter:=\"Excel Macro-Enabled Workbook (*.xlsm), *.xlsm\")\n</code></pre>\n\n<p>Use this code in a macro and then assign that macro to a button.</p>\n\n<p>Im not 100% sure of how to choose specifically where the save menu goes first (i.e. a default search location), as I have only been looking at VBA for just over a week. But as long as you have access to both locations then this should be easily done!</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1467210401, "creation_date": 1467210401, "answer_id": 38102571, "question_id": 38101692, "link": "https://stackoverflow.com/questions/38101692/merging-two-access-databases-stored-in-different-locations/38102571#38102571", "title": "Merging Two Access Databases Stored in Different Locations", "body": "<p>When appending records you append all fields except the primary key.<br></p>\n\n<p>The easiest way is to append the records would be to create a linked table n one of the databases.</p>\n\n<pre>\n[Table 1]\n\nID | FilePath | DateCreated |\n\n[Linked Table 1]\n\nID | FilePath | DateCreated |\n\n</pre>\n\n<p>In this example we select only filepaths from [Linked Table 1] which are not already in Table1 and append them to Table1.</p>\n\n<pre><code>INSERT INTO Table1 ( FilePath, DateCreated )\nSELECT [Linked Table 1].FilePath, [Linked Table 1].DateCreated\nFROM [Linked Table 1]\nWHERE ((([Linked Table 1].FilePath) Not In (Select FilePath FROM Table1)));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1467219940, "creation_date": 1467219940, "answer_id": 38105997, "question_id": 38101692, "link": "https://stackoverflow.com/questions/38101692/merging-two-access-databases-stored-in-different-locations/38105997#38105997", "title": "Merging Two Access Databases Stored in Different Locations", "body": "<p>An extremely simple method is to have a third database for the purpose.</p>\n\n<p>In this, link the the two tables from the two databases.</p>\n\n<p>Then create a query to retrieve the data:</p>\n\n<pre><code>Select TableA.* From TableA\nUnion\nSelect TableB.* From TableB\n</code></pre>\n\n<p>This will return the unique records combined from the two tables.</p>\n"}], "owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1593958331, "creation_date": 1467208362, "last_edit_date": 1593958331, "question_id": 38101692, "link": "https://stackoverflow.com/questions/38101692/merging-two-access-databases-stored-in-different-locations", "title": "Merging Two Access Databases Stored in Different Locations", "body": "<p>I've searched around for several weeks and I can't find the true answer that I'm looking for. I have two identical Access databases that store file paths. The two databases are stored on two different drives (different locations). I've been trying to find a way to merge the tables without duplicating records. I've incorporated code from the following link: </p>\n\n<p><a href=\"https://superuser.com/questions/292272/how-do-i-synchronize-multiple-access-databases-together\">https://superuser.com/questions/292272/how-do-i-synchronize-multiple-access-databases-together</a>.</p>\n\n<p>The problem occurs when both databases have had added records. The records are added as long as the primary key IDs are not already used. If they are already used it doesn't bother adding the records. Is there a way around this? I can't believe MS Access doesn't have a feature to merge databases. Any help appreciated - thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1467208372, "post_id": 38101625, "comment_id": 63637156, "body": "What exactly do you mean by <code>section</code> ?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1467208441, "post_id": 38101625, "comment_id": 63637219, "body": "<code>lastRow = worksheets(&quot;Sheet1&quot;).cells(worksheets(&quot;Sheet1&quot;).rows.count, 1).end(xlup).row</code>"}, {"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467208595, "post_id": 38101625, "comment_id": 63637352, "body": "@newguy sections of rows that are different from one another with different headings e.g. Education, Travel etc."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467208636, "post_id": 38101625, "comment_id": 63637388, "body": "You mean for different columns ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467208794, "post_id": 38101625, "comment_id": 63637544, "body": "Also, see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this SO thread</a>"}, {"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467208876, "post_id": 38101625, "comment_id": 63637626, "body": "Its basically finding the last row in the sheet, however I want it to select just the last row for that particular section."}, {"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467208920, "post_id": 38101625, "comment_id": 63637675, "body": "For each section, there will be a button to do this - the section is passed in for each section"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467209039, "post_id": 38101939, "comment_id": 63637783, "body": "Brilliant I try that - tables makes sense. Thanks!"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467211167, "post_id": 38101939, "comment_id": 63639439, "body": "@user3565164 No problem! If it worked for you would you check this as an acceptable answer?"}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1467209397, "last_edit_date": 1467209397, "creation_date": 1467208884, "answer_id": 38101939, "question_id": 38101625, "link": "https://stackoverflow.com/questions/38101625/how-to-find-the-last-row-in-a-dynamic-sized-section-of-rows-in-vba/38101939#38101939", "title": "How to find the last row in a dynamic sized section of rows in VBA?", "body": "<p>If they are tables you could do this:</p>\n\n<pre><code>Dim r as Long\nWith ActiveSheet.ListObjects(\"Table1\")\n    r = .ListRows(.ListRows.Count).Range.Row\nEnd With\n</code></pre>\n\n<p>But if you simply want to add another row at the end:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListRows.Add\n</code></pre>\n\n<p>Or add before a particular row:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListRows(3).Add\n'You can change the '3' to a variable, of course\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1467211380, "creation_date": 1467211380, "answer_id": 38102935, "question_id": 38101625, "link": "https://stackoverflow.com/questions/38101625/how-to-find-the-last-row-in-a-dynamic-sized-section-of-rows-in-vba/38102935#38102935", "title": "How to find the last row in a dynamic sized section of rows in VBA?", "body": "<p>Try this</p>\n\n<pre><code>Function FindSectionLastRow(rng As Range, header As String)\n    Dim f As Found\n\n    Set f = rng.Find(what:=header, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n    If Not f Is Nothing Then FindSectionLastRow = f.End(xlDown).Row\nEnd Function\n</code></pre>\n\n<p>You could use in your main Sub as follows:</p>\n\n<pre><code>Sub AddNewAllocToSpendLine(sectionHeading As String, Optional sSheetName As String = c_Alloc2SpendSheetName)\n\n    Dim sectionLastRow As Long \n\n    ' your code\n\n    SectionLastRow  = FindSectionLastRow(Worksheets(sSheetName).Columns(1), sectionHeading)\n\n\n    ' more code to use 'SectionLastRow'\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467211380, "creation_date": 1467208225, "question_id": 38101625, "link": "https://stackoverflow.com/questions/38101625/how-to-find-the-last-row-in-a-dynamic-sized-section-of-rows-in-vba", "title": "How to find the last row in a dynamic sized section of rows in VBA?", "body": "<p>I have a spreadsheet that has a number of sections with a random number of rows for each one.</p>\n\n<p>How can you find the last row for one of the section?</p>\n\n<p>Example:</p>\n\n<pre><code>-------------------------------------------------------\nROW 1\n-------------------------------------------------------\nROW 2\n-------------------------------------------------------\nROW 3\n-------------------------------------------------------\nROW 4\n-------------------------------------------------------\nLAST ROW &lt;-- Select last row\n</code></pre>\n\n<p>However this can different for each section where the number of rows is different:</p>\n\n<pre><code>-------------------------------------------------------\nROW 1\n-------------------------------------------------------\nROW 2\n-------------------------------------------------------\nLAST ROW &lt;-- Select last row\n</code></pre>\n\n<p>This is the code I have already:</p>\n\n<pre><code>Sub AddNewAllocToSpendLine(sectionHeading As String, Optional sSheetName As String = c_Alloc2SpendSheetName)\n\n    Worksheets(sSheetName).Activate\n\n    'get the section heading position\n    Set c = Worksheets(sSheetName).Range(\"A:A\").Find(sectionHeading, LookIn:=xlValues, LookAt:=xlWhole)\n\n    Debug.Print c\n\n    Dim addrow As String\n    Dim lRow As Long\n\n    addrow = c.Row + 1\n\n    If addrow &lt;&gt; \"\" And IsNumeric(addrow) = True Then\n\n        Rows(addrow).Insert shift:=xlDown\n\n    Else\n        MsgBox (\"enter only row number\")\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "edited": false, "score": 1, "creation_date": 1467206798, "post_id": 38100975, "comment_id": 63635782, "body": "there should be a j=j+1 counter in the code"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467206989, "post_id": 38100975, "comment_id": 63635930, "body": "Google Bubblesort. You need to rearrange the array."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 1, "creation_date": 1467207280, "post_id": 38100975, "comment_id": 63636188, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/152319/vba-array-sort-function\">VBA array sort function?</a>"}, {"owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "edited": false, "score": 0, "creation_date": 1467208674, "post_id": 38100975, "comment_id": 63637411, "body": "re-arranging the array would be difficult for this application because I do not want it to move the array values in front of the value when the if statement is true. I hope that makes sense"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467211262, "post_id": 38100975, "comment_id": 63639525, "body": "Do you have code that works as you describe it? As @aggieman says, you&#39;re not incrementing your j counter - and where does variable c get defined?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467211533, "post_id": 38100975, "comment_id": 63639762, "body": "I think you need to add some sample data - both for array and the worksheet - showing before and after scenarios. It looks like you&#39;re also changing contents of the cells"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1467274936, "post_id": 38100975, "comment_id": 63667610, "body": "remove from array and rearrange array are not the same. Remove means delete, and for this purpose i would use dictionnary or collection. In Arrays to change the index of a value, you will need a second array created from the fiirst one, and put this in a function, the second array being the result of the function."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "edited": false, "score": 0, "creation_date": 1467214746, "post_id": 38102453, "comment_id": 63642089, "body": "its saying there is a byref argument mismatch with the j when i call the sub. How do I fix this?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "edited": false, "score": 1, "creation_date": 1467215245, "post_id": 38102453, "comment_id": 63642472, "body": "Probably &#39;j&#39; is declared as of &quot;integer&quot; type in your code while ReArrangeArray() accepts a &quot;Long&quot; type: either you change your Sub declaration of &#39;j&#39; as being of &quot;Long&quot; type or change the &#39;ReArrangeArray&#39; last  parameter type to an &quot;Integer&quot; type"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1467275200, "post_id": 38102453, "comment_id": 63667781, "body": "side note, why would anyone use <code>integer</code> when there are <code>Long</code>&#39;s ? it&#39;s like i&#39;d use chr() when there is <code>String</code>..."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1467275506, "post_id": 38102453, "comment_id": 63667974, "body": "I wouldn&#39;t say. Maybe &quot;Integer&quot; lasts from old languages. Or maybe books should stop frightening people with accurate choice of variable types not to waste memory as if we were still in the Commodore64 age..."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1467210110, "creation_date": 1467210110, "answer_id": 38102453, "question_id": 38100975, "link": "https://stackoverflow.com/questions/38100975/vba-array-element-removal/38102453#38102453", "title": "vba array element removal", "body": "<p>You could use a helper Sub like this one:</p>\n\n<pre><code>Sub ReArrangeArray(inputArray as Variant, indexToSwap as long)\n    Dim I As Long\n    Dim tempVal As Variant\n\n    If indexToSwap &gt;= LBound(inputArray) And indexToSwap &lt; UBound(inputArray)  Then\n        tempVal = inputArray(indexToSwap)\n        For I = indexToSwap To UBound(inputArray) - 1\n            inputArray(i) = inputArray(i + 1)\n        Next I\n        InputArray(UBound(inputArray))  = tempVal \n    End If\nEnd Sub\n</code></pre>\n\n<p>To be called by your main Sub as follows:</p>\n\n<pre><code>ReArrangeArray arrayTime, j\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 38102453, "answer_count": 1, "score": 1, "last_activity_date": 1467214843, "creation_date": 1467206753, "last_edit_date": 1467214843, "question_id": 38100975, "link": "https://stackoverflow.com/questions/38100975/vba-array-element-removal", "title": "vba array element removal", "body": "<pre><code>j = LBound(arrayTime)\nDo Until j = UBound(arrayTime)\n    j = j + 1\n    b = b + 1\n    cnc = b + r\n    MsgBox cnc\n        If cnc &gt; 7 Then\n            b = 0\n            r = 0\n            cnc = b + r\n        End If\n    numMins = Sheet5.Cells(cnc + 3, 2) - arrayTime(j)\n    If numMins &lt; 0 Then\n        g = g + 1\n        ReArrangeArray arrayTime, j\n        'ReDim Preserve arrayTime(numrows - 1 + g)\n        'arrayTime(numrows - 1 + g) = arrayTime(j)\n        'MsgBox (arrayTime(numrows - 1 + g))\n    Else\n        Sheet5.Cells(cnc + 3, 2) = numMins\n    End If\nLoop\n</code></pre>\n\n<p>If the if statement is true I want to be able to put the array value at the end of the array and remove that value from its current spot. As the code is, it just adds it to the end and increases the size of the array from 12 to 13. How can I get the array to remain size 12 and still place the value at the end of the array and then remove it from its original position? I do not want to touch the array values in front. Just want to take that value and move it to the end.\nFor instance\narray(1,2,3,4,5)\nIf statement\nj on third loop.\narray(j)=3\nend array should be\narray(1,2,4,5,3)</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 1, "creation_date": 1467206111, "post_id": 38100653, "comment_id": 63635289, "body": "<code>If Intersect(Target, Range(&quot;F:F&quot;))</code> do what you have and then add <code>Else If Intersect(Target, Range(&quot;G:G&quot;))</code> and repeat in red."}, {"owner": {"reputation": 43, "user_id": 6189793, "user_type": "registered", "profile_image": "https://graph.facebook.com/1195968723748056/picture?type=large", "display_name": "Darragh Lynch", "link": "https://stackoverflow.com/users/6189793/darragh-lynch"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1467287571, "post_id": 38100653, "comment_id": 63676143, "body": "Updated my code above and it still doesnt seem to be working can you see where I might be going wrong?"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1467287945, "post_id": 38100653, "comment_id": 63676390, "body": "<code>If Intersect(Target, Range(&quot;F:F&quot;)) Is Nothing Then Exit Sub</code> - you need to stay in the sub so you can process &quot;G&quot;. Though I would recommend something like user3598756&#39;s answer."}, {"owner": {"reputation": 43, "user_id": 6189793, "user_type": "registered", "profile_image": "https://graph.facebook.com/1195968723748056/picture?type=large", "display_name": "Darragh Lynch", "link": "https://stackoverflow.com/users/6189793/darragh-lynch"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1467288460, "post_id": 38100653, "comment_id": 63676754, "body": "The issue is I do not understand user3598756&#39;s answer as I do not do alot of programming and I never did any VB until yesterday. When you say I need to stay in the sub what would I need to write instead of \t If Intersect(Target, Range(&quot;F:F&quot;)) Is Nothing Then Exit Sub  I really appreciate all of your assistance!"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1467288580, "post_id": 38100653, "comment_id": 63676844, "body": "Not sure of the valid VBA syntax but something like <code>If Intersect(Target, Range(&quot;F:F&quot;)) Is Not Nothing Then [make green] ElseIf Intersect(Target, Range(&quot;G:G&quot;)) Is Not Nothing Then [make red] End If</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467218295, "post_id": 38101723, "comment_id": 63644507, "body": "@TimWilliams thanks. Wrong Copy/Paste and PC away. ..Edited and fixed"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1467218200, "last_edit_date": 1467218200, "creation_date": 1467208423, "answer_id": 38101723, "question_id": 38100653, "link": "https://stackoverflow.com/questions/38100653/coloring-cells-on-microsoft-excel-on-tap-touch/38101723#38101723", "title": "Coloring Cells on Microsoft Excel on Tap/Touch", "body": "<p>I'd go like follows to let your code handle future enhancements more easily:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Count = 1 Then HandleCellColor Target '&lt;--| go on only if one cell is selected \nEnd Sub\n\nSub HandleCellColor(rng As Range)\n    Select Case rng.Column '&lt;--| check what column you're dealing with and act accordingly\n        Case 6 ' column \"F\"\n              SetCellColor rng, RGB(50, 200, 50) \n        Case 7 ' column \"G\"\n              SetCellColor rng, vbRed '&lt;--| it's easier to reference vba colors enumeration,  if they suit you\n     End Select\nEnd Sub \n\n\nSub SetCellColor(rng As Range, rgbColor As Long)\n    With rng.Interior\n        If .Color = vbWhite Then '&lt;--| vbWhite is equivalent to RFB(255, 255, 255)\n            .Color = rgbColor \n        ElseIf .Color = rgbColor Then\n            .Color = vbWhite\n            .Pattern = xlNone\n            .TintAndShade = 0\n            .PatternTintAndShade =  0\n         End If\n    End With \nEnd Sub \n</code></pre>\n\n<p>Where I also added a line to color back to white the background of a cell that is selected or doubleclicked being already colored with the passed color  </p>\n"}], "owner": {"reputation": 43, "user_id": 6189793, "user_type": "registered", "profile_image": "https://graph.facebook.com/1195968723748056/picture?type=large", "display_name": "Darragh Lynch", "link": "https://stackoverflow.com/users/6189793/darragh-lynch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 701, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467287535, "creation_date": 1467205917, "last_edit_date": 1467287535, "question_id": 38100653, "link": "https://stackoverflow.com/questions/38100653/coloring-cells-on-microsoft-excel-on-tap-touch", "title": "Coloring Cells on Microsoft Excel on Tap/Touch", "body": "<p>I am trying to create VBA script that will allow me to click or tap on a cell in Microsoft Excel 2013 on a tablet/desktop and that cell (in column F) will change color to green.</p>\n\n<p>Then I want the same functionality on the cell next to it (in column G) so that It can change to Red.</p>\n\n<p>The idea is that the cells in column F are 'Yes' Answers to questions that when tapped light up green and the cells in Column G are 'No' Answers to questions that when tapped light up red instead.</p>\n\n<p>So far I have the code written to allow me to light up the cells in column F green but I am unsure how to go about this with column G as I have not written much VBA script before.</p>\n\n<p>Here's my Code</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nCancel = True\nWorksheet_SelectionChange Target\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</p>\n\n<pre><code>If Intersect(Target, Range(\"F:F\")) Is Nothing Then Exit Sub\n\n    'if cell fill is Blank, change to Green\n    If Selection.Interior.Color = RGB(255, 255, 255) Then\n        Selection.Interior.Color = RGB(50, 200, 50)\n        GoTo Passem\n\n\n    'if cell fill is Green, remove fill color\n    ElseIf Selection.Interior.Color = RGB(50, 200, 50) Then\n            With Selection.Interior\n            .Pattern = x1None\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n\n\n\nElseIf Intersect(Target, Range(\"G:G\")) Is Nothing Then Exit Sub\n\n    'if cell fill is Blank, change to Red\n    If Selection.Interior.Color = RGB(255, 255, 255) Then\n        Selection.Interior.Color = RGB(250, 20, 20)\n        GoTo Passem\n\n    'if cell fill is Red, remove fill colour\n    ElseIf Selection.InteriorColor = RGB(250, 20, 20) Then\n        With Selection.Interior\n            .Pattern = x1None\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n    End If\nEnd If\n</code></pre>\n\n<p>Passem:</p>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1467212540, "post_id": 38100437, "comment_id": 63640548, "body": "What are you trying to reference with your properties <code>wb2.Worksheets.Item(1)</code> and <code>ThisWorkbook.Sheets.Item(2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467272684, "post_id": 38102796, "comment_id": 63666265, "body": "Could you be more specific? Did I understood well what you are trying to achieve? Was it an error while you run the code or the result is not what you are expecting? Do you understand what I tried to do?"}, {"owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467274473, "post_id": 38102796, "comment_id": 63667326, "body": "Yes I understand your code, it&#39;s really what I want to achieve but I still got the same result (not what I&#39;m expecting)"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467275787, "post_id": 38102796, "comment_id": 63668133, "body": "Ok. Could you edit your question and add some pictures of your excel showing the initial data and the expected result so we can visualize better?"}, {"owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467321455, "post_id": 38102796, "comment_id": 63697967, "body": "It&#39;s a bit difficult to post the data here so I posted it in a thread in the excelforum. If you have an account there could you help me plz: <a href=\"http://www.excelforum.com/excel-programming-vba-macros/1145990-vba-copy-row-to-another-workbook-based-on-condition.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467362481, "post_id": 38102796, "comment_id": 63711647, "body": "I just tried again and it works. I opened your wb1, insert a new module, paste the code above, run it and in the sheet Differences Ly is just next to 50000 (i had to first delete the decimals of the amounts in that sheet because it was with comas instead of points) What was the result for you?"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467366075, "post_id": 38102796, "comment_id": 63713926, "body": "In your sheet Differences, did you check the amount ? as i told you for me it was 50000,00 in format General so it could not match with the amount in the other workbook."}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467367181, "post_id": 38102796, "comment_id": 63714664, "body": "Check your question in excelforum. i attached back your file. If it doesn&#39;t work from that, I do not know what i can do to help you."}, {"owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467708946, "post_id": 38102796, "comment_id": 63822533, "body": "Thank you,it finally work! It&#39;s just a range problem because I indicated the wrong column"}, {"owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467709115, "post_id": 38102796, "comment_id": 63822652, "body": "Hi there, I got the error 91: Object variable or with block variable not set in the line: &quot;For Each sCell In Wb2Ws1.Range(Wb2Ws1.Cells(3, 12), Wb2Ws1.Cells(Wb2Ws1.Rows.Count, 12).End(xlUp))&quot; Where is the problem?"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1467709242, "post_id": 38102796, "comment_id": 63822739, "body": "I forgot to declare <code>sCell</code>, sorry. Just add <code>Dim sCell As Range</code>. I just edited my answer as well. Tell me if it works fine now"}], "tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": true, "score": 0, "last_activity_date": 1467709278, "last_edit_date": 1467709278, "creation_date": 1467211014, "answer_id": 38102796, "question_id": 38100437, "link": "https://stackoverflow.com/questions/38100437/vba-copy-row-to-another-workbook-based-on-condition/38102796#38102796", "title": "Vba copy row to another workbook based on condition", "body": "<p><strong>EDIT:</strong></p>\n\n<p>To see what your excel files look like wasn't an option for what you are trying to do. Especially because in you have many empty rows. Anyway, this works for me:</p>\n\n<pre><code>Sub CopyConditions()\n\n    Dim Wb1 As Workbook\n    Dim Wb2 As Workbook\n    Dim Wb1Ws2 As Worksheet\n    Dim Wb2Ws1 As Worksheet\n\n    Set Wb1 = ThisWorkbook\n    Set Wb1Ws2 = ThisWorkbook.Sheets(\"Differences\")\n\n    'open the wb2\n    Dim FullFilePathAndName As Variant\n    Dim StrOpenFileTypesDrpBx As String\n    Let StrOpenFileTypesDrpBx = \"xls (*.xls),*.xls,CSV (*.CSV),*.CSV,Excel (*.xlsx),*.xlsx,OpenOffice (*.ods),*.ods,All Files (*.*),*.*,ExcelMacros (*.xlsm),.xlsm\"\n    Let FullFilePathAndName = Application.GetOpenFilename(StrOpenFileTypesDrpBx, 1, \"Compare this workbook \"\"(\" &amp; Wb1.Name &amp; \")\"\" to...?\", , False) 'All optional Arguments\n\n        If FullFilePathAndName = False Then\n            MsgBox \"You did't select a file!\", vbExclamation, \"Canceled\"\n            Exit Sub\n        Else\n            Set Wb2 = Workbooks.Open(FullFilePathAndName)\n            Set Wb2Ws1 = Wb2.Sheets(\"Sheet1\")\n        End If\n\n\n    Dim rCell As Range\n    Dim sCell As Range\n\n    'loop through each cell in column F until row30 because with the empty cells in the column we can't use Rows.count\n    For Each rCell In Wb1Ws2.Range(Wb1Ws2.Cells(1, 6), Wb1Ws2.Cells(30, 6)) 'Wb1Ws2.Cells(Wb1Ws2.Rows.Count, 6).End(xlUp))\n\n        'if the cell column F is equal to a cell in wb2 sheet1 column L\n        For Each sCell In Wb2Ws1.Range(Wb2Ws1.Cells(3, 12), Wb2Ws1.Cells(Wb2Ws1.Rows.Count, 12).End(xlUp))\n\n            If sCell = rCell Then\n                rCell.Offset(0, 1) = sCell.Offset(0, 1)\n            End If\n\n        Next sCell\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>How does it go for you?</p>\n"}], "owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 38102796, "answer_count": 1, "score": -1, "last_activity_date": 1467709278, "creation_date": 1467205455, "last_edit_date": 1531164843, "question_id": 38100437, "link": "https://stackoverflow.com/questions/38100437/vba-copy-row-to-another-workbook-based-on-condition", "title": "Vba copy row to another workbook based on condition", "body": "<p>I have 2 wb and need to copy value to another wb based on condition: \nIf the value in the column F of wb2 appears in column F of wb1, then I need to copy value in the column G of wb2 to column G of wb1. The code is below:</p>\n\n<pre><code>   Dim LtRow As Long\n   Dim m As Long, n As Long\n\n   With wb2.Worksheets.Item(1)\n      LtRow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n   End With\n\n    With ThisWorkbook.Sheets.Item(2)\n      n = .Cells(.Rows.Count, \"G\").End(xlUp).Row + 1\n   End With\n\n   For m = 1 To LtRow\n       With wb2.Worksheets.Item(1)\n           If .Cells(m, 6).Value = ThisWorkbook.Sheets.Item(2).Cells(m, 6).Value Then\n              .Rows(m).Copy Destination:=ThisWorkbook.Sheets.Item(2).Range(\"G\" &amp; n)\n               n = n + 1\n           End If\n       End With\n   Next m\n</code></pre>\n\n<p>I don't know why the code didn't work at all! Where is the problem in my code?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1467207615, "post_id": 38101255, "comment_id": 63636492, "body": "for the Which argument, could you use wdGoToAbsolute to take you to the actual line?"}, {"owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "edited": false, "score": 0, "creation_date": 1467207620, "post_id": 38101255, "comment_id": 63636497, "body": "correct: characters, not words...let me see if it will go this (your solution)."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1467208470, "post_id": 38101255, "comment_id": 63637246, "body": "@sous2817 I think it won&#39;t make a difference, since both <code>wdGoToAbsolute</code> and <code>wdGoToFirst</code> have the same value (1). To be honest, I thought it was specifying the location inside the object specified by <code>What</code> when I wrote it..."}, {"owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "edited": false, "score": 0, "creation_date": 1467209493, "post_id": 38101255, "comment_id": 63638171, "body": "@arcadeprecinct , thanks! this is what I was looking for. It is working (for my case)."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 1, "last_activity_date": 1467207376, "creation_date": 1467207376, "answer_id": 38101255, "question_id": 38100370, "link": "https://stackoverflow.com/questions/38100370/find-start-from-absolute-line-number/38101255#38101255", "title": "find start from absolute line number", "body": "<p>You could use <code>GoTo</code> to find the <code>Start</code> of a line:</p>\n\n<pre><code>ThisDocument.GoTo(what:=wdGoToLine, Which:=wdGoToFirst, Count:=152).Start\n</code></pre>\n\n<p>That's counting characters not words though.</p>\n\n<p>edit: If you want to count words, use it as the end of a range</p>\n\n<pre><code>ThisDocument.Range(Start:=0, End:=ThisDocument.GoTo(what:=wdGoToLine, Which:=wdGoToFirst, Count:=152).Start).Words.Count\n</code></pre>\n\n<p>There might be a nicer way to do that though.</p>\n"}], "owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 38101255, "answer_count": 1, "score": 0, "last_activity_date": 1467215358, "creation_date": 1467205268, "last_edit_date": 1467215358, "question_id": 38100370, "link": "https://stackoverflow.com/questions/38100370/find-start-from-absolute-line-number", "title": "find start from absolute line number", "body": "<p>I like to select inside of a document an range via:</p>\n\n<pre><code>Set rng = ThisDocument.Range(Start:=0, End:=0)\n</code></pre>\n\n<p>so my question is: how can I find <code>Start:</code> if I know Absolute line number?</p>\n\n<p>example: for absolute line number 152 (from the beginning of the word) how to count words till that line?</p>\n"}, {"tags": ["json", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "edited": false, "score": 0, "creation_date": 1467219044, "post_id": 38100415, "comment_id": 63644943, "body": "I unerstood that idea of the code in the site by this link is to write data from Excel table into strings and these strings write into text file with extention .json. I started think about this idea and your link will help me to realise it, if it will be possible in my case."}], "tags": [], "owner": {"reputation": 358, "user_id": 2498905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ONW9M.jpg?s=128&g=1", "display_name": "adomas.m", "link": "https://stackoverflow.com/users/2498905/adomas-m"}, "is_accepted": true, "score": 6, "last_activity_date": 1467282985, "last_edit_date": 1467282985, "creation_date": 1467205398, "answer_id": 38100415, "question_id": 38100193, "link": "https://stackoverflow.com/questions/38100193/is-it-possible-in-vba-convert-excel-table-to-json/38100415#38100415", "title": "Is it possible in VBA convert Excel table to json", "body": "<p>I'd go with modified version of this one:\n<a href=\"http://www.excelvbamacros.in/2015/01/export-range-in-jason-format.html\" rel=\"noreferrer\">http://www.excelvbamacros.in/2015/01/export-range-in-jason-format.html</a></p>\n\n<p>if you want to write it to file there's a code:</p>\n\n<pre><code>Dim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nDim Fileout As Object\nSet Fileout = fso.CreateTextFile(\"C:\\some_dir\\mydata.json\", True, True)\nFileout.Write jsonStringFromConvertFunction\nFileout.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 6, "last_activity_date": 1481731544, "last_edit_date": 1481731544, "creation_date": 1468256199, "answer_id": 38312309, "question_id": 38100193, "link": "https://stackoverflow.com/questions/38100193/is-it-possible-in-vba-convert-excel-table-to-json/38312309#38312309", "title": "Is it possible in VBA convert Excel table to json", "body": "<p>So I would pass in the range to a JavaScript function and let it iterate over the Excel object model and build the array in JavaScript.  Then call a JavaScript library to convert array into a string (hat tip Douglas Crockford) and simply return the string to VBA.  So no string operations in VBA.</p>\n\n<p>The JavaScript function is given below but depends upon Douglas Crockford's library at <a href=\"https://raw.githubusercontent.com/douglascrockford/JSON-js/master/json2.js\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/douglascrockford/JSON-js/master/json2.js</a>.  Save this in a file and then amend VBA code with the correct file path so the JavaScript is loaded into the Microsoft Script Control.</p>\n\n<pre><code>function ExcelTableToJSON(rngTable) {\n    try {\n        if (rngTable &amp;&amp; rngTable['Rows'] &amp;&amp; rngTable['Columns']) {\n            var rowCount = rngTable.Rows.Count;\n            var columnCount = rngTable.Columns.Count;\n            var arr = new Array();\n\n            for (rowLoop = 1; rowLoop &lt;= rowCount; rowLoop++) {\n                arr[rowLoop - 1] = new Array();\n                for (columnLoop = 1; columnLoop &lt;= columnCount; columnLoop++) {\n                    var rngCell = rngTable.Cells(rowLoop, columnLoop);\n                    var cellValue = rngCell.Value2;\n                    arr[rowLoop - 1][columnLoop - 1] = cellValue;\n                }\n            }\n            return JSON.stringify(arr);\n        }\n        else {\n            return { error: '#Either rngTable is null or does not support Rows or Columns property!' };\n        }\n    }\n    catch(err) {\n        return {error: err.message};\n    }\n}\n</code></pre>\n\n<p>The Excel VBA code is thus</p>\n\n<pre><code>Option Explicit\n\n'In response to\n'http://stackoverflow.com/questions/38100193/is-it-possible-in-vba-convert-excel-table-to-json?rq=1\n'Is it possible in VBA convert Excel table to json\n\n'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub Test()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = \"JScript\"\n\n    oScriptEngine.AddCode GetJavaScriptLibraryFromWeb(\"https://raw.githubusercontent.com/douglascrockford/JSON-js/master/json2.js\")\n\n    Dim sJavascriptCode As String\n    sJavascriptCode = CreateObject(\"Scripting.FileSystemObject\").GetFile(\"&lt;&lt;&lt;Your file path to javascript file&gt;&gt;&gt;\\ExcelTableToJSON.js\").OpenAsTextStream.ReadAll\n\n    oScriptEngine.AddCode sJavascriptCode\n\n    Dim rngTable As Excel.Range\n    Set rngTable = ThisWorkbook.Worksheets.Item(\"Sheet2\").Range(\"A1:B2\")\n\n    rngTable.Cells(1, 1) = 1.2\n    rngTable.Cells(1, 2) = \"red\"\n    rngTable.Cells(2, 1) = True\n    rngTable.Cells(2, 2) = \"=2+2\"\n\n\n    Dim sStringified As String\n    sStringified = oScriptEngine.Run(\"ExcelTableToJSON\", rngTable)\n    Debug.Assert sStringified = \"[[1.2,\"\"red\"\"],[true,4]]\"\n\n    Stop\n\nEnd Sub\n\nPublic Function GetJavaScriptLibraryFromWeb(ByVal sURL As String) As String\n\n    Dim xHTTPRequest As Object 'MSXML2.XMLHTTP60\n    Set xHTTPRequest = VBA.CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    xHTTPRequest.Open \"GET\", sURL, False\n    xHTTPRequest.send\n    GetJavaScriptLibraryFromWeb = xHTTPRequest.responseText\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21365, "favorite_count": 5, "accepted_answer_id": 38100415, "answer_count": 2, "score": 3, "last_activity_date": 1481731544, "creation_date": 1467204821, "last_edit_date": 1531164843, "question_id": 38100193, "link": "https://stackoverflow.com/questions/38100193/is-it-possible-in-vba-convert-excel-table-to-json", "title": "Is it possible in VBA convert Excel table to json", "body": "<p>I need convert data from excel table with about twenty columns and a lot of rows into json. I don't found a short example of code for this purpose in vba. I found this one <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow\">https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas</a> , but it is very large. May be it is a shorter example? </p>\n"}, {"tags": ["vba", "ms-access", "ado", "excel-2003"], "answers": [{"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1467218965, "creation_date": 1467218965, "answer_id": 38105676, "question_id": 38099947, "link": "https://stackoverflow.com/questions/38099947/update-record-adodb-excel/38105676#38105676", "title": "Update record ADODB Excel", "body": "<p>You need to call the Update method on your recordset for the changes to take effect.</p>\n\n<pre><code>rst.Fields(j - 1) = ActiveSheet.Cells(1 + i, j)\nrst.Update\nrst.MoveNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6289133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47552054af390c3464e5cf79b3215a23?s=128&d=identicon&r=PG&f=1", "display_name": "Ghabon", "link": "https://stackoverflow.com/users/6289133/ghabon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2816, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467219005, "creation_date": 1467204253, "last_edit_date": 1467219005, "question_id": 38099947, "link": "https://stackoverflow.com/questions/38099947/update-record-adodb-excel", "title": "Update record ADODB Excel", "body": "<p>I need to update single record in .mdb by using ADODB I can read but can't update...</p>\n\n<pre><code>Dim cnn As ADODB.Connection\nDim rst As ADODB.Recordset\nDim cmd As ADODB.Command\nDim OknoPodmiany\nDim i, j As Integer\nDim sciezka As String\nsciezka = \"c:\\baza_danych.mdb\"\nSet cnn = New Connection\ncnn.ConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0\"\ncnn.Open sciezka\nSet rst = New ADODB.Recordset\nSet rst.ActiveConnection = cnn\nrst.Source = \"SELECT * FROM TBKlienci ORDER BY Nazwaklienta\"\nrst.Open , , adOpenKeyset, adLockOptimistic\ni = 1\nWhile Not rst.EOF\nFor j = 1 To rst.Fields.Count\n  'ActiveSheet.Cells(1 + i, j) = rst.Fields(j - 1)   \n    If Not ActiveSheet.Cells(1 + i, j) = rst.Fields(j - 1) Then\n    Select Case MsgBox(\"Czy chesz zmieni\u0107:\" &amp; Chr(10) &amp; rst.Fields(j - 1) &amp; Chr(10) &amp; \"na:\" &amp; Chr(10) &amp; ActiveSheet.Cells(1 + i, j), vbYesNoCancel)\n        Case vbYes\n           MsgBox \"podmieniam\"\n           rst!Update.Fields(j - 1) = ActiveSheet.Cells(1 + i, j)\n        Case vbNo\n           MsgBox \"niepodmieniam\"\n           ActiveSheet.Cells(1 + i, j) = rst.Fields(j - 1)\n        Case vbCancel\n            MsgBox \"anulowano\"\n    End Select\n    End If\nNext j\nrst.MoveNext\ni = i + 1\nWend\n</code></pre>\n\n<p>Problem is <code>rst!Update.Fields(j - 1) = ActiveSheet.Cells(1 + i, j)</code> how may I pass it ?</p>\n"}, {"tags": ["regex", "ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1467204349, "post_id": 38099894, "comment_id": 63633971, "body": "<a href=\"http://stackoverflow.com/a/12570564/77335\">Public Function OnlyDigits(ByVal pInput As String) As String</a>"}, {"owner": {"reputation": 15231, "user_id": 1901857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a3cf4ee8e3796fd96adfd26314556?s=128&d=identicon&r=PG", "display_name": "Rhumborl", "link": "https://stackoverflow.com/users/1901857/rhumborl"}, "edited": false, "score": 0, "creation_date": 1467204370, "post_id": 38099894, "comment_id": 63633988, "body": "Can you <a href=\"https://stackoverflow.com/posts/38099894/edit\">edit</a> to paste the code snippet you are running to perform the regex. You may need to run the regex mutliple times rather than just changing the pattern"}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1467205584, "post_id": 38099894, "comment_id": 63634885, "body": "@HansUp, &quot;^\\d&quot; matches only the beginning of the string."}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 15231, "user_id": 1901857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a3cf4ee8e3796fd96adfd26314556?s=128&d=identicon&r=PG", "display_name": "Rhumborl", "link": "https://stackoverflow.com/users/1901857/rhumborl"}, "edited": false, "score": 0, "creation_date": 1467205749, "post_id": 38099894, "comment_id": 63635010, "body": "@Rhumborl, I&#39;ve added my code, but I really do not want to run multiple time. I&#39;m sure there must be a regex to extract all numbers from a string."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1467206046, "post_id": 38099894, "comment_id": 63635228, "body": "<code>OnlyDigits(&quot;111Qs 233322&quot;)</code> returns the string &quot;111233322&quot;.  If that is not what you want, please clarify what you want instead."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1467210221, "post_id": 38099894, "comment_id": 63638754, "body": "BTW, you can use <code>&quot;\\d+&quot;</code> instead of <code>&quot;[0-9]+&quot;</code>.  Both match one or more consecutive digits."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1467208196, "last_edit_date": 1495541767, "creation_date": 1467208196, "answer_id": 38101612, "question_id": 38099894, "link": "https://stackoverflow.com/questions/38099894/how-to-extract-all-numbers-from-a-string-using-regex/38101612#38101612", "title": "How to extract all numbers from a string using regex?", "body": "<blockquote>\n  <p>... but I only get the first group of numbers in each row.</p>\n</blockquote>\n\n<p>First issue is that <code>.Global = False</code> means find only the first match.  If you want to find <em>all</em> matches, you need <code>.Global = True</code></p>\n\n<p>Second issue is that your function returns only the first match (<code>colMatches(0)</code>) from the <code>MatchCollection</code>.  So even after you change <code>.Global</code> to <code>True</code>, the function will still return only the first match.  If you want to return a string which contains <em>all</em> matches, you can concatenate the values of all the matches in <code>colMatches</code>.</p>\n\n<p>The following version of the function does what I think you want. </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function myRegex(ByRef myString As String, ByVal Pattern As String) As String\n    Dim rgx As New RegExp\n    Dim colMatches As MatchCollection\n    Dim i As Long\n    Dim strOutput As String\n    With rgx\n        .Pattern = Pattern\n        .IgnoreCase = True\n        '.Global = False\n        .Global = True\n        .Multiline = False\n        Set colMatches = .Execute(myString)\n    End With\n    If colMatches.Count &gt; 0 Then\n        'myRegex = colMatches(0).Value\n        For i = 0 To (colMatches.Count - 1)\n            strOutput = strOutput &amp; colMatches(i).Value\n        Next\n    'Else\n        'myRegex = \"\"\n    End If\n    myRegex = strOutput\nEnd Function\n</code></pre>\n\n<p>However I think <a href=\"https://stackoverflow.com/a/12570564/77335\">OnlyDigits()</a> is a simpler approach.  The strategy there is to discard any character which is not a digit.  Compare that function with yours.  </p>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 0, "accepted_answer_id": 38101612, "answer_count": 1, "score": 1, "last_activity_date": 1467208232, "creation_date": 1467204113, "last_edit_date": 1467208232, "question_id": 38099894, "link": "https://stackoverflow.com/questions/38099894/how-to-extract-all-numbers-from-a-string-using-regex", "title": "How to extract all numbers from a string using regex?", "body": "<p>I have a table <strong>table1</strong> with a field <strong>phone</strong>. This is a string field that is full of other characters besides the number. I want to extract all the numbers from the string.</p>\n\n<p><a href=\"https://i.stack.imgur.com/q2atp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q2atp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I tried \"[0-9]+\" but I only get the first group of numbers in each row.\nI tried searching online but the regexes I tried were incompatible with access.\nPlease explain the regex as well. Thanks.</p>\n\n<p>This is the VBA regex function I'm using:</p>\n\n<pre><code>Function myRegex(ByRef myString As String, ByVal pattern As String) As String\n   Dim rgx As New RegExp\n    Dim colMatches As MatchCollection\n    With rgx\n        .pattern = pattern\n        .ignoreCase = True\n        .Global = False\n        .Multiline = False\n        Set colMatches = .Execute(myString)\n    End With\n    If colMatches.Count &gt; 0 Then\n        myRegex = colMatches(0).Value\n    Else\n        myRegex = \"\"\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1467203511, "post_id": 38099607, "comment_id": 63633355, "body": "Yes, there is. But can you be more specific about what you are trying to do?"}, {"owner": {"reputation": 13, "user_id": 5359284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c9c14c37ae6dcd8b0e2985dc9567afd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5359284/peter"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1467204764, "post_id": 38099607, "comment_id": 63634294, "body": "I have 15 columns and around 1,200 rows. It need to summate all values inside a column and this summation should be stored in, for instance B3. Now I have 15 parts of the 2 I showed above, but I would be easier if I could implement a loop."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5359284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c9c14c37ae6dcd8b0e2985dc9567afd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5359284/peter"}, "edited": false, "score": 0, "creation_date": 1467204977, "post_id": 38099701, "comment_id": 63634457, "body": "I need to store the sum of column C[34] in a different cell than the sum of column C[35]"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 13, "user_id": 5359284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c9c14c37ae6dcd8b0e2985dc9567afd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5359284/peter"}, "edited": false, "score": 0, "creation_date": 1467210153, "post_id": 38099701, "comment_id": 63638704, "body": "@Peter added the full loop for your case and also a loop-less way to do it for all cells in one step"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 2, "last_activity_date": 1467210096, "last_edit_date": 1467210096, "creation_date": 1467203660, "answer_id": 38099701, "question_id": 38099607, "link": "https://stackoverflow.com/questions/38099607/using-variable-columns-in-vba-excel/38099701#38099701", "title": "Using variable columns in VBA Excel", "body": "<p>ok... you need to combine a variable and a string... it is like: </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=SUM(CreateResultsDebit!C[\" &amp; i &amp; \"])-DebitAnalysis!RC[-1]\"\n</code></pre>\n\n<p>to be a bit more specific: (in your code, you set the formula first and then select another cell... I assume that you want the <code>C[34]</code> in B2 and <code>C[35]</code> in B3......)</p>\n\n<pre><code>Dim i As Long\nFor i = 2 to 3\n  Range(\"B\" &amp; i).FormulaR1C1 = \"=SUM(CreateResultsDebit!C[\" &amp; 32 + i &amp; \"])-DebitAnalysis!RC[-1]\"\nNext\n</code></pre>\n\n<p>In the first cycle (i = 2) it will go for cell B2 and use <code>C[34]</code> (32 + i). In the second cycle, those two values are 1 higher (if you go for <code>i</code> from 2 to 30, then it will go for cell B30 in last cycle and use <code>C[62]</code> in your formula)</p>\n\n<p><strong>EDIT</strong><br>\nAnother easy way is the use of R1C1 to set multiple cells. For this you would need to change your formula a bit and the code would look like this:</p>\n\n<pre><code>Range(\"B2:B9\").FormulaR1C1 = \"=SUM(INDEX(CreateResultsDebit!C[33]:C[51],,ROW()))-CreateResultsDebit!RC[-1]\"\n</code></pre>\n\n<p>This would do the same without any loops ;)</p>\n"}, {"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 13, "user_id": 5359284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c9c14c37ae6dcd8b0e2985dc9567afd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5359284/peter"}, "edited": false, "score": 0, "creation_date": 1468614994, "post_id": 38100526, "comment_id": 64217805, "body": "If you would, could you please mark this as an accepted answer if you successfully used it? Thanks!"}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1467205674, "creation_date": 1467205674, "answer_id": 38100526, "question_id": 38099607, "link": "https://stackoverflow.com/questions/38099607/using-variable-columns-in-vba-excel/38100526#38100526", "title": "Using variable columns in VBA Excel", "body": "<p>Maybe this will be of help to you, if I understand you correctly. It will sum the columns from left to right and place them in one row consecutively.</p>\n\n<pre><code>Dim i as Integer\nDim iLastColumn as Long\nDim startRange as Range\n\nSet startRange = Range(\"B3\")\niLastColumn = Cells(1,Columns.Count).End(xlToLeft).Column\nFor i = 1 To iLastColumn\n    startRange.Offset(1,i).FormulaR1C1 = \"=SUM(CreateResultsDebit!C[\" &amp; i &amp; \"])-DebitAnalysis!RC[-1]\"\nNext i        \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5359284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c9c14c37ae6dcd8b0e2985dc9567afd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5359284/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1467212416, "creation_date": 1467203442, "last_edit_date": 1467212416, "question_id": 38099607, "link": "https://stackoverflow.com/questions/38099607/using-variable-columns-in-vba-excel", "title": "Using variable columns in VBA Excel", "body": "<p>While working on a macro in VBA I can't figure out the following issue:</p>\n\n<p>This is a part of the code</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=SUM(CreateResultsDebit!C[34])-DebitAnalysis!RC[-1]\"\nRange(\"B3\").Select\nActiveCell.FormulaR1C1 = _\n    \"=SUM(CreateResultsDebit!C[35])-DebitAnalysis!RC[-1]\"\nRange(\"B4\").Select\n</code></pre>\n\n<p>Now, I have hardcoded the column reference C[34] and C[35]. Is there a way to use, for instance, an iterator as a variable between the brackets? If I try this myself it doesn't yield any result. </p>\n\n<p>Thank you. Peter.</p>\n"}, {"tags": ["vba", "ms-access", "bulkinsert", "pass-through"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467203998, "post_id": 38099375, "comment_id": 63633693, "body": "On a side note: You can write that first piece of code as: <code>sSQL = &quot;BULK INSERT tbl_Name &amp; _</code> line break <code>more code here</code>. Or see <a href=\"https://msdn.microsoft.com/en-us/library/ba9sxbw4.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ba9sxbw4.aspx</a>"}, {"owner": {"reputation": 321, "user_id": 4681802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d9c5fa76217ee830a60e2a639b909917?s=128&d=identicon&r=PG&f=1", "display_name": "NLMDEJ", "link": "https://stackoverflow.com/users/4681802/nlmdej"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467204711, "post_id": 38099375, "comment_id": 63634246, "body": "@Tom -- Thanks! I will definitely try this."}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 4681802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d9c5fa76217ee830a60e2a639b909917?s=128&d=identicon&r=PG&f=1", "display_name": "NLMDEJ", "link": "https://stackoverflow.com/users/4681802/nlmdej"}, "is_accepted": true, "score": 0, "last_activity_date": 1467204658, "creation_date": 1467204658, "answer_id": 38100132, "question_id": 38099375, "link": "https://stackoverflow.com/questions/38099375/error-3146-odbc-call-failed-with-pass-through-bulk-insert/38100132#38100132", "title": "Error 3146: ODBC--Call Failed with pass-through bulk insert", "body": "<p>I have figured out the answer to this problem. Apparently there is a time out setting for ODBC connections. By adding the code <code>qdf.ODBCTimeout = 900 '15 Min</code> the bulk insert was able to complete.</p>\n\n<p>Thanks for everyone's time in this!</p>\n"}], "owner": {"reputation": 321, "user_id": 4681802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d9c5fa76217ee830a60e2a639b909917?s=128&d=identicon&r=PG&f=1", "display_name": "NLMDEJ", "link": "https://stackoverflow.com/users/4681802/nlmdej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "accepted_answer_id": 38100132, "answer_count": 1, "score": 0, "last_activity_date": 1593958341, "creation_date": 1467202873, "last_edit_date": 1593958341, "question_id": 38099375, "link": "https://stackoverflow.com/questions/38099375/error-3146-odbc-call-failed-with-pass-through-bulk-insert", "title": "Error 3146: ODBC--Call Failed with pass-through bulk insert", "body": "<p>I am trying to do a Bulk Insert statement using a pass-through query. I have the following code:</p>\n\n<pre><code>sSQL = \"BULK INSERT tbl_Name \"\nsSQL = sSQL &amp; \"FROM 'C:\\Users\\UserName\\Desktop\\File.txt' \"\nsSQL = sSQL &amp; \"WITH \"\nsSQL = sSQL &amp; \"(\"\nsSQL = sSQL &amp; \"FIELDTERMINATOR = ',',  \"\nsSQL = sSQL &amp; \"ROWTERMINATOR='\\n'\"\nsSQL = sSQL &amp; \");\"\n\nSet db = CurrentDb\n\n    Set qdf = db.CreateQueryDef(\"\")\n\n        qdf.Connect = db.TableDefs(\"dbo_tbl_Name\").Connect\n        qdf.ReturnRecords = False\n        qdf.SQL = sSQL\n        qdf.Execute dbFailOnError\n\n    Set qdf = Nothing\n\nSet db = Nothing\n</code></pre>\n\n<p>The error I get is: <code>3146</code> with a description of <code>ODBC--call failed.</code></p>\n\n<p>If I change the sSQL statement to a INSERT STATEMENT or a SELECT statement, the query executes just fine. </p>\n\n<p>Why does my BULK INSERT not work in the PASS through query? I print out my sSQL string to make sure it is correct, and it seems to be:</p>\n\n<pre><code>BULK INSERT tbl_Name FROM 'C:\\Users\\UserName\\Desktop\\File.txt' WITH (FIELDTERMINATOR=',', ROWTERMINATOR='\\n');\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access", "crosstab"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1467202806, "post_id": 38099188, "comment_id": 63632882, "body": "Use a where clause in the SQL, <code>where year(dtInspectDate)=2014</code>"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467205732, "post_id": 38099188, "comment_id": 63634996, "body": "the columns are having week ending dates for 2014, 2015,2016 also. if i want to just limit the columns to only some particular year, then how do i do it using an sql query? i tried doing your suggestion but not getting any results.  IF you have a table like this, can you give me an example of how the sql query should look to pull only certain year columns?  p.s: I dont know what the dates may be."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467206454, "post_id": 38099188, "comment_id": 63635510, "body": "select * from data where year(data.dtDate)=2014"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467206893, "post_id": 38099188, "comment_id": 63635854, "body": "so i tried as you said like this but get parameter textbox :  SELECT *  FROM Data WHERE YEAR (REPLACE(Data.[&quot;Week Ending &quot; &amp; &quot;*&quot; ],&quot;Week Ending &quot;,&quot;&quot;,1))=2014  what could be wrong?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467207035, "post_id": 38099188, "comment_id": 63635959, "body": "year([Week Ending])=2014 is Week Ending the name of your field in the table?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467207507, "post_id": 38099188, "comment_id": 63636404, "body": "If you see, each of the columns are having Text &quot;Week Ending &quot; as well as a Date in them e.g.  &quot;Week Ending 10/02/13&quot;. Another thing to note is the date is actually in British dd/mm/yy format and not American mm/dd/yy format."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467208486, "post_id": 38099188, "comment_id": 63637261, "body": "So are you trying to select from a date column i.e. select [Week ending 01-10-2014] from table or where the data is the date."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467208797, "post_id": 38099188, "comment_id": 63637550, "body": "I want to select data from all such date columns I.e. &quot;Select [Week Ending ??/??/??] From Table Where the year contained in them is 2014.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467212414, "post_id": 38102867, "comment_id": 63640432, "body": "This is cool. But isn&#39;t there an SQL query that can be written on this crosstab to grab limited date columns? Unwinding the crosstab is not an alternative as there are 1008 rows and there are 165 such date columns i.e. after unpivoting, the rows become 165 * 1008 = 166320 rows. Also i had to change this to as it was not detecting the year :      If InStr(1, fld.Name, &quot;Week Ending&quot;) &gt; 0 And Right(fld.Name, 2) = Right(intYear, 2) Then....."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467212573, "post_id": 38102867, "comment_id": 63640566, "body": "you would add your pivot lines onto the SQL, that I&#39;ve created.  So select x,y,z then you can do the pivot bit, you need to do some yourself :)"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1467214032, "post_id": 38102867, "comment_id": 63641599, "body": "The initial idea is to limit the table data to contain only the few date columns for a particular year. Then Transform this recordset again on ACV values showing as Column headings now, counting the 1st occurrence of each ACV value (NA, 0, 1,2,3, etc., found under these date columns) in a row, for each unique item in 1st column. i am stuck with this quandary for quite some time. IF you can help me with this, i will be most grateful. If not, i still like to thank you for all your help. :)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1467211206, "creation_date": 1467211206, "answer_id": 38102867, "question_id": 38099188, "link": "https://stackoverflow.com/questions/38099188/write-an-sql-query-selecting-data-from-filtered-date-columns/38102867#38102867", "title": "Write an SQL query selecting data from filtered Date columns", "body": "<p>something like this, there may be a simpler method though</p>\n\n<pre><code>Sub Akward_Query()\n\nDim strSQL As String\nDim strSQL2 As String\nDim rst As ADODB.Recordset\nDim fld As ADODB.Field\nDim intYear As Integer\n\nintYear = 2014\n\nstrSQL = \"Select top 1 * from tbl_Test\"\n\nSet rst = New ADODB.Recordset\n\nrst.Open strSQL, CurrentProject.Connection, 1\n\nstrSQL2 = \"Select \"\n\nFor Each fld In rst.Fields\n\n    If InStr(1, fld.Name, \"Week Ending\") &gt; 0 And InStr(1, fld.Name, intYear)&gt;0 Then\n\n        strSQL2 = strSQL2 &amp; \"[\" &amp; fld.Name &amp; \"],\"\n\n    End If\n\nNext fld\n\nIf Right(strSQL2, 1) = \",\" Then strSQL2 = Left(strSQL2, Len(strSQL2) - 1)\n\nstrSQL2 = strSQL2 &amp; \" from tbl_Test\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1593958335, "creation_date": 1467202390, "last_edit_date": 1593958335, "question_id": 38099188, "link": "https://stackoverflow.com/questions/38099188/write-an-sql-query-selecting-data-from-filtered-date-columns", "title": "Write an SQL query selecting data from filtered Date columns", "body": "<p>i am trying to query a crosstab table/recordset in Access (tried ADO on excel sheet), where the columns are having dates in them e.g.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zpw1g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zpw1g.png\" alt=\"Columns appearing as Dates\"></a></p>\n\n<p>if i want to pull a limited data having columns only for the Year 2014, how do i write such a query? Please note, these columns may vary.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1467202491, "post_id": 38098956, "comment_id": 63632678, "body": "Is there any code related to Excel instance in the portion of code which you have not included in this post. Such as related to closing of Excel instance. Can you post the code of AlternativeKKS()"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1467202920, "post_id": 38098956, "comment_id": 63632962, "body": "Look for <i>anywhere</i> in your app where you use any Excel objects or methods in conjunction with a WITH-block of code.  It is a commonly known issue that Unless your code explicitly declares and clears automation-based object variables used as the object of a with-block (With...End With syntax), those objects can get stuck in memory as &quot;orphaned&quot; com objects. This will then prevent the release of their automation server classes (since a constituent object still has a non-zero COM reference count). This will present as the symptom you are observing: Excel won&#39;t close despite the call to .Quit."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1467203180, "post_id": 38098956, "comment_id": 63633158, "body": "Automation-based  object instances should ALL be used like this:  Dim objTemp as (Object/Excel.range/whatever)  set objTemp = (whatever) With ObjTemp   &#39;do stuff here End With set objTemp = Nothing  what you should NOT be doing is this:  With objExclApp.worksheets(1).range(&quot;myNamedrange&quot;)   &#39;do stuff End With : THIS is the sort of thing that can leave phantom references for a range object  <a href=\"https://social.msdn.microsoft.com/Forums/en-US/908ba72a-3293-4eb9-b80e-fd2e6e78e185/vba-close-excel-problem?forum=accessdev\" rel=\"nofollow noreferrer\">LINK</a>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1467203880, "post_id": 38098956, "comment_id": 63633593, "body": "It is appreciated that you have already referred the link which I have mentioned in my comments. Somehow it escaped my attention."}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 0, "creation_date": 1467204104, "post_id": 38098956, "comment_id": 63633784, "body": "I deleted my answer as i miss-understood the issue. Sorry about that... Thanks @J Doe"}, {"owner": {"reputation": 53, "user_id": 6525094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ee8aa0ad399a68fecd22362ab5ec6b?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/6525094/j-doe"}, "edited": false, "score": 0, "creation_date": 1467204123, "post_id": 38098956, "comment_id": 63633810, "body": "I can post the whole code but I would prefer to be able to filter what is relevant before posting a few hundred lines therefore my question"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467204372, "post_id": 38098956, "comment_id": 63633993, "body": "problem is: the error is probably in that piece of code. Try to narrow it down somehow and look for <code>With</code>-statements."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467204626, "post_id": 38098956, "comment_id": 63634184, "body": "Alternatively you could just kill the process via shell: <a href=\"http://stackoverflow.com/questions/32101010/run-a-powershell-command-not-script-from-excel-vba\" title=\"run a powershell command not script from excel vba\">stackoverflow.com/questions/32101010/&hellip;</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1467206764, "post_id": 38098956, "comment_id": 63635746, "body": "For variables like <code>wsSource</code> or <code>wsDestination</code>: have you removed their <code>Dim</code> statements? Or are they global variables? Or don&#39;t the modules have <code>Option Explicit</code>? (yeeks!)"}, {"owner": {"reputation": 53, "user_id": 6525094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ee8aa0ad399a68fecd22362ab5ec6b?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/6525094/j-doe"}, "edited": false, "score": 0, "creation_date": 1467209532, "post_id": 38098956, "comment_id": 63638208, "body": "They are globals, forgot to mention that, ill edit it"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1467212262, "post_id": 38098956, "comment_id": 63640314, "body": "Then you <b>must</b> do <code>Set wsSource = Nothing</code> etc. once they are no longer used, or they will hold their reference indefinitely. Local variables (that are passed as parameters to other functions where necessary) are safer in this regard."}, {"owner": {"reputation": 53, "user_id": 6525094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ee8aa0ad399a68fecd22362ab5ec6b?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/6525094/j-doe"}, "edited": false, "score": 0, "creation_date": 1467220947, "post_id": 38098956, "comment_id": 63646116, "body": "Ill try this tomorrow and let you know if it solved the problem :)"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1467261074, "post_id": 38098956, "comment_id": 63661201, "body": "Try this: <a href=\"http://stackoverflow.com/questions/26303173/how-can-i-kill-task-manager-processes-through-vba-code\" title=\"how can i kill task manager processes through vba code\">stackoverflow.com/questions/26303173/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6525094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ee8aa0ad399a68fecd22362ab5ec6b?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/6525094/j-doe"}, "is_accepted": false, "score": 1, "last_activity_date": 1467269117, "last_edit_date": 1467269117, "creation_date": 1467268533, "answer_id": 38115576, "question_id": 38098956, "link": "https://stackoverflow.com/questions/38098956/excel-exe-wont-close/38115576#38115576", "title": "EXCEL.EXE won&#39;t close", "body": "<p>Since there seems to be no function that lets me mark Andre's comment as answer:</p>\n\n<blockquote>\n  <p>Then you must do Set wsSource = Nothing etc. once they are no longer used, or they will hold their reference indefinitely. Local variables (that are passed as parameters to other functions where necessary) are safer in this regard</p>\n</blockquote>\n\n<p>Both of your suggested solutions worked! Set wsSource = Nothing when it was global as well as rewriting the code so that wsSource and wsDestination were local variables made the EXCEL.EXE close properly.</p>\n\n<p>Thank you!</p>\n\n<p>@Andre\nFeel free to post your comment as answer and I'll mark it as solution</p>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1467271631, "creation_date": 1467271631, "answer_id": 38116516, "question_id": 38098956, "link": "https://stackoverflow.com/questions/38098956/excel-exe-wont-close/38116516#38116516", "title": "EXCEL.EXE won&#39;t close", "body": "<p>Global variables (<code>Dim</code>ed on module level) keep their values indefinitely, object variables keep their references. So a global variable like </p>\n\n<pre><code>Dim wsSource As Worksheet\n</code></pre>\n\n<p>will keep its reference to the Excel object, and thus prevent EXCEL.EXE from shutting down.</p>\n\n<p>Solutions:</p>\n\n<ol>\n<li><p><code>Set wsSource = Nothing</code> once it is no longer used. This can be tricky - you must handle every possible path through your program logic.</p></li>\n<li><p>Use <strong>local variables</strong> instead (<code>Dim</code>ed on function level). Pass them as parameters to other functions where necessary. This is a safer way.</p></li>\n</ol>\n"}], "owner": {"reputation": 53, "user_id": 6525094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ee8aa0ad399a68fecd22362ab5ec6b?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/6525094/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 38116516, "answer_count": 2, "score": 4, "last_activity_date": 1467271631, "creation_date": 1467201734, "last_edit_date": 1592644375, "question_id": 38098956, "link": "https://stackoverflow.com/questions/38098956/excel-exe-wont-close", "title": "EXCEL.EXE won&#39;t close", "body": "<p>Yes I know the problem is anything but new and I researched already A LOT but nothing helped me so far. Also this is my first stackoverflow post so if I do something wrong, please tell me.\nWhat I want to do is import multiple Excel sheets one at a time in access via VBA code. My code is working so far but I have the problem that there always remains an EXCEL.EXE instance in the task manager, causing problems when I want to import more than 1 file.\nI already tried the solutions proposed in following threads:</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/31962697/closing-excel-exe-process\">Closing Excel.exe process</a></p>\n<p><a href=\"https://stackoverflow.com/questions/9435898/vb-net-excel-program-leaves-excel-exe-floating-after-completion?rq=1\">VB.NET Excel Program Leaves EXCEL.EXE floating after completion</a></p>\n<p><a href=\"https://social.msdn.microsoft.com/Forums/en-US/908ba72a-3293-4eb9-b80e-fd2e6e78e185/vba-close-excel-problem?forum=accessdev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/908ba72a-3293-4eb9-b80e-fd2e6e78e185/vba-close-excel-problem?forum=accessdev</a></p>\n<p><a href=\"https://stackoverflow.com/questions/22512868/remove-excel-task-from-task-manager-after-running-from-access-using-vba\">Remove Excel task from Task manager after running from Access using VBA</a></p>\n</blockquote>\n<p>Here is my import code, I've only been using VBA for a few weeks, so please don't look too closely at it.</p>\n<pre><code>Public Function importExcelFiles()\n\n\nDim tablename As String\nDim spreadsheetType As String\nDim xlAppl As Excel.Application\nDim xlWB As Excel.Workbook\n' **** function imports the excel file and copies data into target table  *********\n\n' choose the file to import\npath = OpenFile(&quot;Select file for import&quot;, &quot;Excel-Files&quot; &amp; Chr$(0) &amp; &quot;*.xls; *.xlsx; *.xlsm&quot;, &quot;Excel-Files&quot;, CurrentProject.path)\n\nIf Not IsNull(path) And Not path = &quot;&quot; And Not path = &quot; &quot; Then\n\n    Set xlAppl = CreateObject(&quot;excel.application&quot;)\n    Set xlWB = xlAppl.Workbooks.Open(path)\n    \n   \n    spreadsheetType = acSpreadsheetTypeExcel9\n    \n    Call AlternateKKS(&quot;KKS_DB&quot;, xlAppl, xlWB)\n    tablename = &quot;KKS_DB&quot;\n    DoCmd.TransferSpreadsheet acImport, spreadsheetType, tablename, path, false, &quot;merged!&quot; 'import to excel'\n            \n\n    \n    DoCmd.SetWarnings False\n    xlAppl.DisplayAlerts = False\n    xlWB.Close acSaveNo\n    xlAppl.Quit\n    \n    Set xlWB = Nothing\n    Set xlAppl = Nothing\n\n    \nEnd If\n\n\nEnd Function \n</code></pre>\n<p>I noticed that it works when I uncomment the Call AlternateKKS so probably there is something in there that keeps the Excel.exe from closing.\nThere is quite some code in the function so before I post all of this I would like to know what I should be looking for that could cause the problem. What it does is basically read the sheet into an array, do some modification to the data and write it back on the sheet &quot;merged&quot;.\nI already made sure that there is a xlWB. or xlAppl. whenever I refer to a sheet and I do not use the with statement as mentioned on the msdn forum (link in spoiler).</p>\n<p>PS: On another note, the sheet I want to import is called &quot;merged&quot; but for some reason it only works if I put the ! at the end (a colleague told me to do it) but we have no idea why.</p>\n<p>EDIT: Here is all the code that refers directly to the application or a sheet</p>\n<pre><code>Dim wsSource As Worksheet\nDim wsDestination As Worksheet\n\nPublic Function ReadIntoArray(name As String, ByRef xlWB As Excel.Workbook) As Variant\n\n\n'    Dim ret As String\ng_arrayrange = GetLastCell(name, xlWB)\n\nSet wsSource = xlWB.Sheets(name)\n\nCall Sort(wsSource, xlWB)\n\nReadIntoArray = wsSource.range(&quot;A1:&quot; &amp; g_arrayrange).Value\n\n\nEnd Function\n\nSub WriteBackArray(data() As Variant, destination As String, ByRef xlWB As Excel.Workbook)\n\n\nSet wsDestination = xlWB.Sheets(destination)\n\nwsDestination.UsedRange.ClearContents\n\nwsDestination.range(&quot;A1&quot;).resize(UBound(data, 1), UBound(data, 2)) = data\n\n\nEnd Sub\n\nFunction GetLastCell(name As String, ByRef xlWB As Excel.Workbook) As String 'return coordinates of last cell with data'\n\nDim lrw As Long\nDim lcol As Long\nDim lastCell As String\nDim rng As range\nDim sheet As Worksheet\nDim col As String\n\nSet sheet = xlWB.Sheets(name)\nSet rng = xlWB.Sheets(name).Cells\n'get last row '\n\nlrw = rng.Find(What:=&quot;*&quot;, _\n                After:=rng.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).row\n\n\n'get last column'\nlcol = rng.Find(What:=&quot;*&quot;, _\n                After:=rng.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Column\n\ng_lrw = lrw\n\n'change to string for further use as range'\nlastCell = GetCellAsString(lcol, lrw)\n\nGetLastCell = lastCell\n\n\nEnd Function\n</code></pre>\n<p>And in another function</p>\n<pre><code>source = xlAppl.Transpose(source)\n</code></pre>\n<p>Rest of the code only manipulates arrays</p>\n"}, {"tags": ["database", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467202522, "post_id": 38098405, "comment_id": 63632705, "body": "You&#39;ll first diagram implies that their are 5 tables and in your description you say there are &quot;5 -&gt;10 column?&quot;.  Are their 5 different Tables, with different column counts, and a single <b>Key Column</b> in each table or is there a single table with multiple <b>Key Columns</b>?"}, {"owner": {"reputation": 21, "user_id": 6528024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28fd283d89252c520e4ccc922900f05?s=128&d=identicon&r=PG&f=1", "display_name": "Antti Niskala", "link": "https://stackoverflow.com/users/6528024/antti-niskala"}, "edited": false, "score": 0, "creation_date": 1467203414, "post_id": 38098405, "comment_id": 63633289, "body": "Hi. There is 1 table / spreadsheet which contains multiple columns. I&#39;ll change the picture."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467203883, "post_id": 38098405, "comment_id": 63633596, "body": "How many columns are there and which ones are key columns and which ones are holds the values.  You picture shows 5 columns, key, key, key, value, value.  Is this right?"}, {"owner": {"reputation": 21, "user_id": 6528024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28fd283d89252c520e4ccc922900f05?s=128&d=identicon&r=PG&f=1", "display_name": "Antti Niskala", "link": "https://stackoverflow.com/users/6528024/antti-niskala"}, "edited": false, "score": 0, "creation_date": 1467204191, "post_id": 38098405, "comment_id": 63633866, "body": "That&#39;s right for now.. If I just get the point of your code / hint, I can modify it later on."}], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 0, "last_activity_date": 1467204359, "creation_date": 1467204359, "answer_id": 38099991, "question_id": 38098405, "link": "https://stackoverflow.com/questions/38098405/excel-vba-ms-query-to-create-every-possible-combination-of-a-range/38099991#38099991", "title": "Excel/VBA/MS Query to create every possible combination of a Range", "body": "<p>From what i see in your pictures, the only item which can change combination is the one in column 4:\n(1 ; A ; a ; item4 ; #\u00a4), (2 ; B ; b ; item4 ; &amp;#\u00a4) and (3 ; C ; c ; item4 ; \u00a4%&amp;)</p>\n\n<p>If this is indeed what your are trying to do the following code should work:</p>\n\n<pre><code>Sub Combination()\n\nDim i As Integer, j As Integer, k As Integer\n\n    For k = 0 To 2 'loop through (1 A a #\u00a4), (2 B b &amp;#\u00a4) and (3 C c \u00a4%&amp;)\n\n        j = 3 'column 4 items\n\n        For i = 0 To 6 Step (3) 'loop 3 by 3 (output starts in row 10)\n\n                Cells(10 + k + i, 1) = Cells(3 + k, 1)\n                Cells(10 + k + i, 2) = Cells(3 + k, 2)\n                Cells(10 + k + i, 3) = Cells(3 + k, 3)\n                Cells(10 + k + i, 5) = Cells(3 + k, 5)\n\n                Cells(10 + k + i, 4) = Cells(j, 4)\n\n        j = j + 1\n\n        Next i\n\n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467205274, "post_id": 38100003, "comment_id": 63634662, "body": "You didn&#39;t mention which library to reference.  I tried the latest ActiveX Dataobjects library and got the an error.  Too few parameters."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1467205832, "post_id": 38100003, "comment_id": 63635063, "body": "@ThomasInzina: right:  I used Microsoft ActiveX Data Objects 6.1 Library."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467207035, "post_id": 38100003, "comment_id": 63635958, "body": "Okay I got it. Awesome answer but you left out all the details.  You should explain that test1 and test3 refer to column names and change your query to <b>select distinct a.* , b.test3 from [Sheet1$] as a , [Sheet1$] as b</b>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467207359, "post_id": 38100003, "comment_id": 63636255, "body": "Damn, you don&#39;t even have to save the workbook.  That&#39;s tight. I&#39;m adding this to my arsenal!"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1467207428, "post_id": 38100003, "comment_id": 63636324, "body": "@ThomasInzina: with this trick you can even join different sheets and make update queries 8-)"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1467208370, "last_edit_date": 1467208370, "creation_date": 1467204385, "answer_id": 38100003, "question_id": 38098405, "link": "https://stackoverflow.com/questions/38098405/excel-vba-ms-query-to-create-every-possible-combination-of-a-range/38100003#38100003", "title": "Excel/VBA/MS Query to create every possible combination of a Range", "body": "<p>You can do that using SQL with an cross join. Below is a small example I made and tested. You will have to adapt it to your needs. In my example, test1 and test3 are the column names, in the first row of <code>sheet1</code>.</p>\n\n<pre><code>Sub SQLCombineExample()\n    Dim con\n    Dim rs\n    Set con = CreateObject(\"ADODB.Connection\")\n    con.Open \"Driver={Microsoft Excel Driver (*.xls)};\" &amp; _\n           \"DriverId=790;\" &amp; _\n           \"Dbq=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n           \"DefaultDir=\" &amp; ThisWorkbook.FullName &amp; \";ReadOnly=False;\"\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    Set rs = con.Execute(\"select distinct a.[test1], b.[test3] from [Sheet1$] as a , [Sheet1$] as b \")\n    Range(\"f1\").CopyFromRecordset rs\n    Set rs = Nothing\n    Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/U1rt6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U1rt6.png\" alt=\"Result\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467206385, "creation_date": 1467206385, "answer_id": 38100818, "question_id": 38098405, "link": "https://stackoverflow.com/questions/38098405/excel-vba-ms-query-to-create-every-possible-combination-of-a-range/38100818#38100818", "title": "Excel/VBA/MS Query to create every possible combination of a Range", "body": "<pre><code>Sub CopyAllCombinationsToRange()\n\n    Dim arSource\n    Dim arResult\n\n    Dim i As Long, j As Long, combinationCount As Long, counter As Long\n\n    arSource = Range(Cells(2, 1), Cells(Rows.Count, 5).End(xlUp)).Value\n\n    combinationCount = UBound(arSource, 2) * UBound(arSource, 2)\n    ReDim arResult(4, combinationCount - 1)\n\n    For i = 1 To UBound(arSource, 1)\n        For j = 1 To UBound(arSource, 1)\n\n            arResult(0, counter) = arSource(i, 1)\n            arResult(1, counter) = arSource(i, 2)\n            arResult(2, counter) = arSource(i, 3)\n            arResult(3, counter) = arSource(i, 4)\n            arResult(4, counter) = arSource(j, 5)\n            counter = counter + 1\n        Next\n    Next\n\n    Sheet2.Range(\"A1\").Resize(UBound(arResult, 2), 5) = WorksheetFunction.Transpose(arResult)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/B67pX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B67pX.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 6528024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28fd283d89252c520e4ccc922900f05?s=128&d=identicon&r=PG&f=1", "display_name": "Antti Niskala", "link": "https://stackoverflow.com/users/6528024/antti-niskala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1467208370, "creation_date": 1467200135, "last_edit_date": 1495542160, "question_id": 38098405, "link": "https://stackoverflow.com/questions/38098405/excel-vba-ms-query-to-create-every-possible-combination-of-a-range", "title": "Excel/VBA/MS Query to create every possible combination of a Range", "body": "<p>I have a problem for which I haven't been able to find a solution.</p>\n\n<p>I have a spreadsheet with 5 -> 10? columns of data. All of them different, but some columns are related to each other (If A3=1, then B3=A and C3=a). Each column contains 3 -> 6 variations of a parameters and I need to create all the possible combinations of them.. </p>\n\n<p>Initial data in columns:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Gbl9H.png\" alt=\"enter image description here\"></p>\n\n<p>Expected result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/5CZ3V.png\" alt=\"Expected result\"></p>\n\n<p>Kelvin had almost similar <a href=\"https://stackoverflow.com/questions/10692653/excel-vba-to-create-every-possible-combination-of-a-range\">problem</a> previously, but that didn't work for me..</p>\n"}, {"tags": ["excel", "email", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4684950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76adc091c68fc155d765c6977d06073f?s=128&d=identicon&r=PG&f=1", "display_name": "TheShyButterfly", "link": "https://stackoverflow.com/users/4684950/theshybutterfly"}, "edited": false, "score": 0, "creation_date": 1467235901, "post_id": 38098655, "comment_id": 63654284, "body": "Thank you for your quick response. I added the Function to a Module and replaced the To and CC to EmailTo &amp; EmailCC in the sub, but I cant get it to work. I get error &quot;variable not defined&quot;.  I tried to define it by Dim EmailTo as String (etc) but did not work. I am a little confused how to do it. Please advise. Cheers"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467259273, "last_edit_date": 1592644375, "creation_date": 1467200907, "answer_id": 38098655, "question_id": 38098232, "link": "https://stackoverflow.com/questions/38098232/excel-2013-vba-setting-up-a-list-of-email-reciepients-to-and-cc-populating-o/38098655#38098655", "title": "Excel 2013 VBA - setting up a list of email reciepients (TO and CC) populating Oulook email", "body": "<p>This will give you create the Recipient lists for you.</p>\n<blockquote>\n<p>EmailTo = getRecipients(1)</p>\n<p>EmailCC = getRecipients(2)</p>\n</blockquote>\n<pre><code>Function getRecipients(vColumn As Variant) As String\n    Dim rListColumn As Range\n    Dim c As Range\n    Dim s As String\n    With Worksheets(&quot;Email Recipient List&quot;)\n\n        Set rListColumn = .Range(.Cells(2, vColumn), .Cells(Rows.Count, vColumn).End(xlUp))\n        \n        For Each c In rListColumn\n            s = s &amp; c.Text &amp; &quot;;&quot;\n        Next\n\n        getRecipients = Left(s, Len(s) - 1)\n    End With\n    \nEnd Function\n</code></pre>\n<p>I didn't see where you would get a variable not defined error.  If getRecipients was in a private module you'd get a sub or function not defined error.<br></p>\n<p>I refactored our code.  Please this in a code module by itself and run ComposeEmail.</p>\n<pre>\n    Option Explicit\n    Public Sub ComposeEmail()\n\n        ToggleEvents False\n\n        Dim EmailTo As String, CC As String, BCC As String, Subject As String, HTMLBody As String, ShowEmail As Boolean\n        Dim rng As Range\n        \n        ToggleEvents False\n\n        Set rng = Sheets(\"Email Form\").Range(\"A1:AB119\")\n\n        EmailTo = getRecipients(1)\n        CC = getRecipients(2)\n        'BCC = getRecipients(2)\n        Subject = Range(\"H6\").Value & \" - \" & \"SAC\" & Range(\"G12\").Value & \" - \" & Range(\"G14\").Value & \" - \" & Range(\"H8\").Value\n        HTMLBody = RangetoHTML2(rng)\n        ShowEmail = True\n        \n        SendMail EmailTo, CC, BCC, Subject, HTMLBody, ShowEmail\n\n        ' ThisWorkbook.Close True 'This Line save and Closes the workbook\n\n        ToggleEvents True\n\n    End Sub\n\n    Function getRecipients(vColumn As Variant) As String\n        Dim rListColumn As Range\n        Dim c As Range\n        Dim s As String\n        With Worksheets(\"Email Recipient List\")\n                        \n            Set rListColumn = .Range(.Cells(2, vColumn), .Cells(Rows.Count, vColumn).End(xlUp))\n\n            For Each c In rListColumn\n                s = s & c.Text & \";\"\n            Next\n\n            getRecipients = Left(s, Len(s) - 1)\n        End With\n\n    End Function\n\n    Public Sub SendMail(EmailTo As String, CC As String, BCC As String, Subject As String, HTMLBody As String, ShowEmail As Boolean)\n        Dim OutApp As Object\n        Dim OutMail As Object\n        Set OutApp = CreateObject(\"Outlook.Application\")\n        Set OutMail = OutApp.CreateItem(0)\n        With OutMail\n            .to = EmailTo\n            .CC = CC\n            .BCC = BCC\n            .Subject = Subject\n            .HTMLBody = HTMLBody\n            \n            If ShowEmail Then\n                .Display\n            Else\n                .Send\n            End If\n\n        End With\n\n        Set OutMail = Nothing\n        Set OutApp = Nothing\n        Exit Sub\n    EmailCouldNotBeCreated:\n        MsgBox \"Email could not be created\", vbCritical, \"Error in Sub SendMail\"\n    End Sub\n\n    Sub ToggleEvents(bEnableEvents As Boolean)\n        With Application\n            .EnableEvents = bEnableEvents\n            .ScreenUpdating = bEnableEvents\n        End With\n    End Sub\n\n\n    ' https://msdn.microsoft.com/en-us/library/ff519602%28v=office.11%29.aspx?f=255&MSPPError=-2147217396\n\n    Function RangetoHTML2(rng As Range)\n    ' Works in Excel 2000, Excel 2002, Excel 2003, Excel 2007, Excel 2010, Outlook 2000, Outlook 2002, Outlook 2003, Outlook 2007, and Outlook 2010.\n        Dim fso As Object\n        Dim ts As Object\n        Dim TempFile As String\n        Dim TempWB As Workbook\n\n        TempFile = Environ$(\"temp\") & \"/\" & Format(Now, \"dd-mm-yy h-mm-ss\") & \".htm\"\n     \n        ' Copy the range and create a workbook to receive the data.\n        rng.Copy\n        Set TempWB = Workbooks.Add(1)\n        With TempWB.Sheets(1)\n            .Cells(1).PasteSpecial Paste:=8\n            .Cells(1).PasteSpecial xlPasteValues, , False, False\n            .Cells(1).PasteSpecial xlPasteFormats, , False, False\n            .Cells(1).Select\n            Application.CutCopyMode = False\n            On Error Resume Next\n            .DrawingObjects.Visible = True\n            .DrawingObjects.Delete\n            On Error GoTo 0\n        End With\n     \n        ' Publish the sheet to an .htm file.\n        With TempWB.PublishObjects.Add( _\n             SourceType:=xlSourceRange, _\n             Filename:=TempFile, _\n             Sheet:=TempWB.Sheets(1).Name, _\n             Source:=TempWB.Sheets(1).UsedRange.Address, _\n             HtmlType:=xlHtmlStatic)\n            .Publish (True)\n        End With\n     \n        ' Read all data from the .htm file into the RangetoHTML subroutine.\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n        RangetoHTML = ts.ReadAll\n        ts.Close\n        RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                              \"align=left x:publishsource=\")\n     \n        ' Close TempWB.\n        TempWB.Close savechanges:=False\n     \n        ' Delete the htm file.\n        Kill TempFile\n     \n        Set ts = Nothing\n        Set fso = Nothing\n        Set TempWB = Nothing\n    End Function\n\n</pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 4684950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76adc091c68fc155d765c6977d06073f?s=128&d=identicon&r=PG&f=1", "display_name": "TheShyButterfly", "link": "https://stackoverflow.com/users/4684950/theshybutterfly"}, "edited": false, "score": 0, "creation_date": 1467237145, "post_id": 38103968, "comment_id": 63654822, "body": "Hi Dmitry, thank you for your response. Sorry, but this confuses me a bit. Just how would this be set out as per my existing code above? Is this based on using @ThomasInzina function? Doesn&#39;t there need to be a definition of the variable? (I&#39;m still trying to grasp VBA - its a slow process for me)."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 99, "user_id": 4684950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76adc091c68fc155d765c6977d06073f?s=128&d=identicon&r=PG&f=1", "display_name": "TheShyButterfly", "link": "https://stackoverflow.com/users/4684950/theshybutterfly"}, "edited": false, "score": 0, "creation_date": 1467240890, "post_id": 38103968, "comment_id": 63656240, "body": "Yes, you will need to loop through the values in the range and call Recipients.Add for each value. Or build a string of addresses separated by &quot;;&quot;."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1467214056, "creation_date": 1467214056, "answer_id": 38103968, "question_id": 38098232, "link": "https://stackoverflow.com/questions/38098232/excel-2013-vba-setting-up-a-list-of-email-reciepients-to-and-cc-populating-o/38103968#38103968", "title": "Excel 2013 VBA - setting up a list of email reciepients (TO and CC) populating Oulook email", "body": "<p>Either call <code>MailItem.Recipients.Add</code> for each recipient (it returns Recipient object, sets its <code>Recipient.Type</code> property to olTo/olCC/olBCC appropriately) to set the To/CC/BCC properties to a \";\" separated list of addresses. </p>\n"}], "owner": {"reputation": 99, "user_id": 4684950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76adc091c68fc155d765c6977d06073f?s=128&d=identicon&r=PG&f=1", "display_name": "TheShyButterfly", "link": "https://stackoverflow.com/users/4684950/theshybutterfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1465, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467259273, "creation_date": 1467199705, "last_edit_date": 1531164843, "question_id": 38098232, "link": "https://stackoverflow.com/questions/38098232/excel-2013-vba-setting-up-a-list-of-email-reciepients-to-and-cc-populating-o", "title": "Excel 2013 VBA - setting up a list of email reciepients (TO and CC) populating Oulook email", "body": "<p>I have set up a Userform which saves data to the Incident Details data sheet and also saves data temporarily to a worksheet called 'Email Form' and laid out like a form so that the 'email form' is copied into the body of a MS Outlook email. </p>\n\n<p>This works perfectly, and with the current coding I was provided sends one email <strong>To</strong> 1 recipient and <strong>CC'd</strong> to another, but I need to send same email to multiple recipients.\nI have created another sheet called \u2018Email Recipient List (same workbook) because I want it to be easy to update the lists as required (none of the users would be able to edit the hardcode in VBA).\nColumn A has a list of TO recipients and Column B has a list of CC recipients. </p>\n\n<p>I have searched and view several videos and sites, but I have been unable to workout how to extract the respective lists from the \u2018Email Recipient List\u2019 sheet  and populate the Outlook email without it affecting the existing actions. I don't want a macro button for users to click because the code opens up the Outlook email.</p>\n\n<p>This is my existing code:</p>\n\n<pre><code>Sub log_send_reset()\n'THIS OPENS OUTLOOK WITH DETAILS OF FORM\n\n'WORKS with \"Email Form\"\nDim SecIncNo As String\n\n'This bit emails the current worksheet in the body of an email as HTML\n'#If 0 Then\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\n\nSet rng = Nothing\nOn Error Resume Next\n\nSet rng = Sheets(\"Email Form\").Range(\"A1:AB119\")\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = True 'ShyButterfly set this to TRUE (it was false)\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n\n'This bit tells it where to send the email to, what the subject line is  etc\n\n .to = \"246abc@company.com\"\n\n .CC = \"rep3@company2.com\"\n .BCC = \"\"\n .Subject = Range(\"H6\").value &amp; \" - \" &amp; \"SAC\" &amp; Range(\"G12\").value &amp; \" - \" &amp; Range(\"G14\").value &amp; \" - \" &amp; Range(\"H8\").value\n    .HTMLBody = RangetoHTML(rng)\n    'Shybutterfly changed from.Send to .Display to see what it does\n    .Display\n'or use .Display if you want to edit / add text before sending\n\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\n\nThisWorkbook.Save\n\n'ThisWorkbook.Close\n\n'Application.Quit\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3fgoM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3fgoM.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I'd appreciate any assistance.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467199159, "post_id": 38097810, "comment_id": 63630280, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31821984/formatting-table-in-powerpoint-macro\">Formatting table in powerpoint macro</a>"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1467200585, "post_id": 38097810, "comment_id": 63631312, "body": "This is the correct way to change properties in the .Font object within a table. I use this method a lot and never found it to take a long time but that may be a relative perception e.g. 0.1s is long compared to 1ns so how many cells are there, how long is it taking and what target time are you looking for?"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "is_accepted": false, "score": -1, "last_activity_date": 1467284014, "creation_date": 1467284014, "answer_id": 38121018, "question_id": 38097810, "link": "https://stackoverflow.com/questions/38097810/powerpoint-change-table-formation-in-vba/38121018#38121018", "title": "Powerpoint change table formation in VBA", "body": "<p>Maybe this code can help you. It will change format in each table of active presentation. You just have to update Font Name and Font Size.</p>\n\n<p>Sub format()</p>\n\n<p>Dim s As Slide\nDim oSh As Shape\nDim oTbl As Table\nDim lRow As Long\nDim lCol As Long</p>\n\n<p>For Each s In ActivePresentation.Slides</p>\n\n<pre><code>For Each oSh In s.Shapes\n    If oSh.HasTable Then\n        Set oTbl = oSh.Table\n        For lRow = 1 To oTbl.Rows.Count\n            For lCol = 1 To oTbl.Columns.Count\n                With oTbl.Cell(lRow, lCol).Shape.TextFrame.TextRange\n                    .Font.Name = \"Batang\"\n                    .Font.Size = 16\n                End With\n            Next\n        Next\n    End If\nNext\n</code></pre>\n\n<p>Next s</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 71, "user_id": 3960143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6af0d527be91b53d693b0a45877cba77?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay Agarwal", "link": "https://stackoverflow.com/users/3960143/vijay-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467284014, "creation_date": 1467198461, "last_edit_date": 1467202361, "question_id": 38097810, "link": "https://stackoverflow.com/questions/38097810/powerpoint-change-table-formation-in-vba", "title": "Powerpoint change table formation in VBA", "body": "<p>I am trying to edit a table in a slide, and I am using this code but it takes a lot of time to complete. </p>\n\n<pre><code>For lRow = 1 To oTbl.Rows.Count\nFor lCol = 1 To oTbl.Columns.Count\nWith oTbl.Cell(lRow, lCol).Shape.TextFrame.TextRange\n.Font.Name = \"Arial\"\n.Font.Size = 30\nEnd With\nNext\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467197175, "post_id": 38097260, "comment_id": 63629013, "body": "How is the data changed? Is it a formula that is being recalculated or a value being set by another macro?"}, {"owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467197404, "post_id": 38097260, "comment_id": 63629166, "body": "I have sheet 2 where the data is imported from a database, where it is then put up nicely in sheet1, and from this data i have Row1: 5 &lt;-- caused by these Row2: 3 &lt;-- caused by these Row3: 4 &lt;-- caused by these Average: =(5+3+4)/3 &lt;-- When this changes - run macro"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1467197724, "post_id": 38097260, "comment_id": 63629366, "body": "Can you clarify or elaborate the line in your question ~which works if i manually change the data of the cell, however i dont manually change the data.`"}, {"owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "edited": false, "score": 0, "creation_date": 1467201389, "post_id": 38097260, "comment_id": 63631931, "body": "I tried to rephrase it, do you understand my question now?"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1467197459, "creation_date": 1467197459, "answer_id": 38097452, "question_id": 38097260, "link": "https://stackoverflow.com/questions/38097260/have-to-click-formula-bar-and-hit-enter-before-it-recalculates/38097452#38097452", "title": "Have to click formula bar and hit enter before it recalculates", "body": "<pre><code>Private Sub Worksheet_Calculate()\n\nEnd Sub\n</code></pre>\n\n<p>or you could check the changes to the vals in the formula's the way you're checking the result maybe</p>\n"}], "owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467229193, "creation_date": 1467196980, "last_edit_date": 1467229193, "question_id": 38097260, "link": "https://stackoverflow.com/questions/38097260/have-to-click-formula-bar-and-hit-enter-before-it-recalculates", "title": "Have to click formula bar and hit enter before it recalculates", "body": "<p>I have 2 worksheets.</p>\n\n<p>Worksheet 1: Nicely put up data with rows like this</p>\n\n<ul>\n<li>Row1: 5 &lt;-- This data comes from sheet 2</li>\n<li>Row2: 4 &lt;-- This data comes from sheet 2</li>\n<li>Row3: 2 &lt;-- This data comes from sheet 2</li>\n<li>Row4: =(Row1+Row2+Row3)/3 &lt;-- Simple calculation from above cells.</li>\n</ul>\n\n<p>I have this macro</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If IsError(Cells(139, 8).Value) Then\n    Call Sheet1.HideCharts\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This works perfectly, and runs when an error occured, so if i put =5/0 (which gives an error) in row 1, the HideCharts macro runs.</p>\n\n<p>However.\nThe data comes from worksheet 2, and this data comes from cubes (database) and when that data changes to i.e. nothing, it will give #REF! on worksheet 1. which i understand is an error, however then the macro won't run. What am i doing wrong? I hope you understand my question.</p>\n\n<ul>\n<li>Edit: I found out that the macro actually semi-runs. It goes through however i have to double-click the cell and just press enter, and then it activates.</li>\n</ul>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1467196771, "post_id": 38097134, "comment_id": 63628754, "body": "just loop table/shape colection colection and check if any table/shape has desired name."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1467196975, "post_id": 38097134, "comment_id": 63628895, "body": "How do I do that? How do I loop a ListObject?"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1467212426, "post_id": 38097134, "comment_id": 63640448, "body": "Why is this question voted down with &quot;-2&quot; ?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467270182, "post_id": 38097134, "comment_id": 63664815, "body": "@Jeevan its common practice on SO to downvote questions that dont abide by the community guidelines for asking questions -<a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>.  In your case, the lack of attempted code has resulted in some people downvoting your question.  I still chose to answer because the solution was quite short, but that is the cause of the downvotes"}], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467197410, "post_id": 38097309, "comment_id": 63629168, "body": "For very large data sets, this method will be much faster than looping through every shape on the sheet and will return exactly the same result"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1467197541, "post_id": 38097309, "comment_id": 63629251, "body": "Getting run-time error for this. Its caused because i dont have shape Table123 on sheet, only table. So you need to change it to <code>ListObjects</code> and also when table isnt on sheet, you will get error. Not false"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467197632, "post_id": 38097309, "comment_id": 63629306, "body": "It is erroring out in this line &quot;If Not ActiveSheet.Shapes.Range(Array(&quot;Table123&quot;)) Is Nothing Then&quot; saying &quot;The item with the specified name wasn&#39;t found&quot;"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467197686, "post_id": 38097309, "comment_id": 63629341, "body": "It should not error out for me also that time that table was present."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1467197694, "post_id": 38097309, "comment_id": 63629347, "body": "error is Run-time error 1004 The item with the specified name wasnt found. (and i updated my previous coment)"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467198233, "post_id": 38097309, "comment_id": 63629698, "body": "@Jeevan see the editted code. this should work as desired"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467209422, "post_id": 38097309, "comment_id": 63638113, "body": "RGA: again in the IF statement, I get &quot;Run-time error &#39;9&#39; Subscript out of range&quot;"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467210222, "post_id": 38097309, "comment_id": 63638760, "body": "@Jeevan I have no idea why you got an error, as the errorhandler should avoid that, so I&#39;ve adjusted the errorhandler.  I&#39;ve tested it in a variety of ways on my machine and it works perfectly, so if you are still having issues with this then it is the result of something else"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467211109, "post_id": 38097309, "comment_id": 63639400, "body": "@RGA: Actually I tried the code in empty sheet to check if it returns false. I will test and let you know. So far it did not work for me. Thanks."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467211663, "post_id": 38097309, "comment_id": 63639876, "body": "@RGA: The code works fine, unless there are 0 ListObjects. If there is some object in the worksheet then it works fine. I added another If statement to check if there are any List Objects using &quot;If ActiveSheet.ListObjects.Count &gt; 3 Then&quot;. Then it worked fine. Thanks a lot."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467269988, "post_id": 38097309, "comment_id": 63664704, "body": "@Jeevan glad it worked, though I&#39;m not sure why it didn&#39;t work if there were 0 objects.  I tested it on a completely blank sheet that was freshly opened and had no issues.  Will do a little research to figure out what that cause would be"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1467345283, "post_id": 38097309, "comment_id": 63704277, "body": "@RGA: Thank you :)"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 7, "last_activity_date": 1467210142, "last_edit_date": 1467210142, "creation_date": 1467197101, "answer_id": 38097309, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/38097309#38097309", "title": "VBA Excel check if a particular table exist using table name", "body": "<pre><code>TableExists = False\nOn Error GoTo Skip\nIf ActiveSheet.ListObjects(\"Table123\").Name = \"Table123\" Then TableExists = True\nSkip:\n    On Error GoTo 0\n</code></pre>\n\n<p>This code will work and avoid loops and errors</p>\n"}, {"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 4, "last_activity_date": 1531845539, "last_edit_date": 1531845539, "creation_date": 1467197257, "answer_id": 38097367, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/38097367#38097367", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>You can list shape collection and compare names like this</p>\n\n<pre><code>Sub callTableExists()\n\n    MsgBox tableExists(\"Table1\", \"Shapes\")\n\nEnd Sub\n\nFunction TableExists(tableName As String, sheetName As String) As Boolean\n\n    Dim targetSheet As Worksheet\n    Set targetSheet = Worksheets(sheetName)\n\n    Dim tbl As ListObject\n\n    With targetSheet\n        For Each tbl In .ListObjects\n            If tbl.Name = tableName Then TableExists = True\n        Next tbl\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 3, "last_activity_date": 1467198724, "creation_date": 1467198724, "answer_id": 38097898, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/38097898#38097898", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>Here is an alternative function:</p>\n\n<pre><code>Function TableExistsOnSheet(ws As Worksheet, sTableName As String) As Boolean\n    TableExistsOnSheet = ws.Evaluate(\"ISREF(\" &amp; sTableName &amp; \")\")\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1531845333, "creation_date": 1531845333, "answer_id": 51386375, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/51386375#51386375", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>Another option, using a bit lazy approach with error catching:</p>\n\n<pre><code>Public Sub TestMe()\n\n    If TableExists(\"Table1243\", ActiveSheet) Then\n        MsgBox \"Table Exists\"\n    Else\n        MsgBox \"Nope!\"\n    End If\n\nEnd Sub    \n\nPublic Function TableExists(tableName As String, ws As Worksheet) As Boolean\n\n    On Error GoTo TableExists_Error\n    If ws.ListObjects(tableName).Name = vbNullString Then\n    End If\n    TableExists = True\n\n    On Error GoTo 0\n    Exit Function\n\nTableExists_Error:    \n    TableExists = False    \n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 9115100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887a35cea844fa31cb5d2767ed239b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Binghang Li", "link": "https://stackoverflow.com/users/9115100/binghang-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1578783284, "creation_date": 1578783284, "answer_id": 59699376, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/59699376#59699376", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>Try this, use err to get data table status information\nalso, consider testing the data table on an inactive sheet.</p>\n\n<pre><code>Sub Test_TableNameExists()\n    TableNm = \"Table00\"\n    MsgOutput = TableNm &amp; vbTab &amp; TableNameExists(TableNm)\nEnd Sub\n\n\nPrivate Function TableNameExists(nname) As Boolean '#Table #Exist\n'Returns TRUE if the data table name exists\n'Can test table on inactive sheet\nDim x As Object\nOn Error Resume Next\n'use Range(nname).Parent to get data table sheet name. \n'So the function can test data table on inactive sheet.\n\nSet x = Range(nname).Parent.ListObjects(nname)\nIf Err = 0 Then TableNameExists = True _\n    Else TableNameExists = False\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 633, "user_id": 2504346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U58Iy.jpg?s=128&g=1", "display_name": "Farway", "link": "https://stackoverflow.com/users/2504346/farway"}, "is_accepted": false, "score": 0, "last_activity_date": 1611773243, "creation_date": 1611773243, "answer_id": 65925479, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name/65925479#65925479", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>Without the use of <code>GoTo</code>, which is a lot more powerfull than appropriate.</p>\n<pre><code>Set TableExists = False\n\nOn Error Resume Next\nIf ActiveSheet.ListObjects(&quot;Table123&quot;).Name = &quot;Table123&quot; Then Set TableExists = True\n</code></pre>\n<p>Be aware that this applies to a single line, thus requiring the line continuation symbol <code>_</code> to keep larger statements readable.</p>\n"}], "owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15267, "favorite_count": 1, "accepted_answer_id": 38097309, "answer_count": 6, "score": 4, "last_activity_date": 1611773243, "creation_date": 1467196632, "question_id": 38097134, "link": "https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name", "title": "VBA Excel check if a particular table exist using table name", "body": "<p>I have several tables in an excel sheet. Each having unique table Name. I want to know if a table which has a name \"Table123\" exist or not in the current sheet. </p>\n\n<p>Could some one help me on this? </p>\n\n<p>Thanks\nJeevan </p>\n"}, {"tags": ["vba", "performance", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1467196658, "post_id": 38096883, "comment_id": 63628676, "body": "Have you investigated using SQL on the Excel sheet you&#39;re opening?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467197199, "post_id": 38096883, "comment_id": 63629029, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff837414.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff837414.aspx</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467197211, "post_id": 38096883, "comment_id": 63629038, "body": "<a href=\"http://www.connectionstrings.com/excel/\" rel=\"nofollow noreferrer\">connectionstrings.com/excel</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467197271, "post_id": 38096883, "comment_id": 63629072, "body": "<a href=\"https://support.microsoft.com/en-us/kb/816562\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/816562</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1467198196, "creation_date": 1467198196, "answer_id": 38097726, "question_id": 38096883, "link": "https://stackoverflow.com/questions/38096883/excel-vba-speed-optimization-for-importing-data-from-excel-to-excel-table/38097726#38097726", "title": "Excel vba speed optimization for importing data from excel to excel table", "body": "<p>something like this, sorry about the variable names, did it quickly whilst on a call, you'll need to adjust</p>\n\n<pre><code>Sub test()\n\nDim q As QueryTable\nDim r As New ADODB.Recordset\nDim c As New ADODB.Connection\nDim s As String\n\ns = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=c:\\test\\test_conn.xlsx;\" &amp; _\n            \"Extended Properties='Excel 12.0 Xml;HDR=YES';\"\nc.ConnectionString = s\nc.Open\n\nr.Open \"Select * from [Sheet1$];\", c, 1\n\nWith ActiveSheet.QueryTables.Add( _\n        Connection:=r, _\n        Destination:=Range(\"Z1\"))\n    .Name = \"Contact List\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = True\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .Refresh BackgroundQuery:=False\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6527892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa4d1f4198a89daf1cf488ba2958c9a?s=128&d=identicon&r=PG&f=1", "display_name": "ggwp", "link": "https://stackoverflow.com/users/6527892/ggwp"}, "edited": false, "score": 0, "creation_date": 1467204442, "post_id": 38098004, "comment_id": 63634052, "body": "This looks great, Ill try this. But I also neet to change numberformat based on each column number. I also need to do some find and replace to fix things like spaces in numbers, incorrect decimal characters and so on. Where in the script flow should I perform these functions. I guess it would work to do these for each column."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467198990, "creation_date": 1467198990, "answer_id": 38098004, "question_id": 38096883, "link": "https://stackoverflow.com/questions/38096883/excel-vba-speed-optimization-for-importing-data-from-excel-to-excel-table/38098004#38098004", "title": "Excel vba speed optimization for importing data from excel to excel table", "body": "<p>This will do it.  </p>\n\n<blockquote>\n  <p>AppendRangeToTable targetTb,  importRg </p>\n</blockquote>\n\n<pre><code>Sub AppendRangeToTable(TargetTable As ListObject, SourceRange As Range)\n    Dim ar\n    Dim r As Range\n    ar = SourceRange.Value\n    Set r = TargetTable.ListRows.Add(AlwaysInsert:=True).Range\n    r.Resize(UBound(ar, 1), UBound(ar, 2)) = ar\nEnd Sub\n</code></pre>\n\n<p>I prefer CurrentRegion over UsedRange.</p>\n\n<blockquote>\n  <p>Set importRg = importWb.Worksheets(1).Range(\"A1\").CurrentRegion</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6527892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa4d1f4198a89daf1cf488ba2958c9a?s=128&d=identicon&r=PG&f=1", "display_name": "ggwp", "link": "https://stackoverflow.com/users/6527892/ggwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 736, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467198990, "creation_date": 1467195957, "question_id": 38096883, "link": "https://stackoverflow.com/questions/38096883/excel-vba-speed-optimization-for-importing-data-from-excel-to-excel-table", "title": "Excel vba speed optimization for importing data from excel to excel table", "body": "<p>Having trouble with speed of a vba script for importing data into an excel table. Hoping someone here can help. As the comments in my code state this script takes about 8 seconds to import 100 rows of data. I would love to bring it down to fractions of a second.</p>\n\n<pre><code>Sub ImportMyData()\n    Dim filter, caption, importFileName As String\n    Dim importWb As Workbook\n    Dim targetSh, validationSh As Worksheet\n    Dim targetTb As ListObject\n    Dim importRg, targetRg, validationRg As Range\n    Dim i, j, k, targetStartRow As Integer\n\n    ' Set speed related application settings (this will be restored on exit)\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .DisplayStatusBar = False\n        .EnableEvents = False\n    End With\n\n    ' Set definitions\n    Set targetSh = ThisWorkbook.Sheets(\"myTargetSheet\")\n    Set targetTb = targetSh.ListObjects(\"myTargetTable\")\n    Set targetRg = targetTb.DataBodyRange\n    Set validationSh = ThisWorkbook.Sheets(\"myValidationSheet\")\n    Set validationRg = validationSh.Range(\"myValidationRange\")\n\n    ' Set filter for the file choose dialog\n    filter = \"Text files (*.xlsx),*.xlsx\"\n\n    ' Set UI text for file choose dialog\n    caption = \"Chose xlsx file to import \"\n\n    ' Set filename from UI dialog\n    importFileName = Application.GetOpenFilename(Filter, , Caption)\n\n\n    ' Show Form to get user input for extra field (will return variable 'myChoice')\n    ImportFormPicker.Show\n\n    ' Open the import file workbook\n    Set importWb = Application.Workbooks.Open(importFileName)\n    importWb.Windows(1).Visible = False\n    targetSh.Activate\n\n    ' Set definitions\n    Set importRg = importWb.Worksheets(1).UsedRange\n\n    ' Unprotects target sheet\n    targetSh.Unprotect\n\n    ' Get starting row of imported target range for future reference\n    targetStartRow = targetTb.ListRows.Count + 1\n\n    ' Iterate all rows in import range\n    For i = 1 To importRg.Rows.Count\n        ' Only import row if first cell in row is a date\n        If IsDate(importRg.Cells(i, 1).Value) Then\n            ' Count imported rows\n            k = k + 1\n            ' Insert row at end of target table\n            targetTb.ListRows.Add AlwaysInsert:=True\n            ' Iterate all columns in import range\n            For j = 1 To importRg.Columns.Count\n                With targetRg.Cells(targetTb.ListRows.Count, j)\n                    ' Import value\n                    .Value = importRg.Cells(i, j).Value\n                    ' Set format according to validation range\n                    .NumberFormat = validationRg.Cells(2, j).NumberFormat\n                End With\n            Next j\n            With targetRg.Cells(targetTb.ListRows.Count, j)\n                ' Add custom value which was determined by user form\n                .Value = Butik\n                ' Set Format according to validation range\n                .NumberFormat = validationRg.Cells(2, j).NumberFormat\n            End With\n            ' --- Speed troubleshooting = 100 rows imported/~8seconds.\n            If i Mod 100 = 0 Then\n                ThisWorkbook.Activate\n            End If\n            ' --- End Speed troubleshooting\n        End If\n    Next i\n\n    ' Close the import file workbook without saving\n    importWb.Close savechanges:=False\n\n    ' Protect target sheet\n    With targetSh\n        ' Protect the target sheet\n        .Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n        ' Show the target sheet\n        .Visible = True\n        ' Activate the target sheet\n        .Activate\n    End With\n\n    ' Select imported range\n    targetRg.Range(Cells(targetStartRow, 1), Cells(targetTb.ListRows.Count, j)).Select\n\n    ' Show user how many rows were imported\n    MsgBox (\"Imported \" &amp; k &amp; \" rows.\")\n\n    ' Restore speed related settings\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .DisplayStatusBar = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1467198848, "post_id": 38096584, "comment_id": 63630079, "body": "See previous question here: <a href=\"http://stackoverflow.com/questions/32882661/excel-vba-autofilter-contains-with-multiple-criteria\" title=\"excel vba autofilter contains with multiple criteria\">stackoverflow.com/questions/32882661/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3029217, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e5c3ea1d5574e580eb3e8becef6e70d?s=128&d=identicon&r=PG&f=1", "display_name": "user3029217", "link": "https://stackoverflow.com/users/3029217/user3029217"}, "edited": false, "score": 0, "creation_date": 1467195784, "post_id": 38096636, "comment_id": 63628115, "body": "But I have to use the operator or between the criteria. Criteria1 or Criteria2 ... or CriteriaN"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 45, "user_id": 3029217, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e5c3ea1d5574e580eb3e8becef6e70d?s=128&d=identicon&r=PG&f=1", "display_name": "user3029217", "link": "https://stackoverflow.com/users/3029217/user3029217"}, "edited": false, "score": 0, "creation_date": 1467196060, "post_id": 38096636, "comment_id": 63628314, "body": "that gives, 2 or 3 or 5"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1467195249, "creation_date": 1467195249, "answer_id": 38096636, "question_id": 38096584, "link": "https://stackoverflow.com/questions/38096584/is-it-possible-to-filter-a-cell-in-excel-using-several-criteria-vba/38096636#38096636", "title": "Is it possible to filter a cell in Excel using several criteria VBA", "body": "<p>Using an array, for example, <code>Criteria1:=Array(\"2\",\"3\", \"5\")</code></p>\n"}], "owner": {"reputation": 45, "user_id": 3029217, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e5c3ea1d5574e580eb3e8becef6e70d?s=128&d=identicon&r=PG&f=1", "display_name": "user3029217", "link": "https://stackoverflow.com/users/3029217/user3029217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467196075, "creation_date": 1467195104, "last_edit_date": 1467196075, "question_id": 38096584, "link": "https://stackoverflow.com/questions/38096584/is-it-possible-to-filter-a-cell-in-excel-using-several-criteria-vba", "title": "Is it possible to filter a cell in Excel using several criteria VBA", "body": "<p>I was wondering if it is possible to filter on a cell in VBA using more than 2 criteria?</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$R$\" &amp; NumberOfLines).AutoFilter Field:=1, Criteria1:=\"=*PSO*\", Operator:=xlOr, Criteria2:=\"=*NSM*\"...\n</code></pre>\n\n<p>If it's not possible, is there a way to filter a cell using several criteria?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "edited": false, "score": 0, "creation_date": 1467195654, "post_id": 38098267, "comment_id": 63630735, "body": "Your error is probably because <code>c</code> is an <code>Integer</code>, which has a size limit of 65,535. Make it a <code>Long</code> instead."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "edited": false, "score": 0, "creation_date": 1467195793, "post_id": 38098267, "comment_id": 63630736, "body": "Zak ?!?!?!?  &quot;c&quot; is the column number, and it is fix."}, {"owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "edited": false, "score": 0, "creation_date": 1467198650, "post_id": 38098267, "comment_id": 63630737, "body": "My bad. an error on 65536 is *almost* always because you declared an <code>Int</code> somewhere that got overflown. I scanned the code, saw an <code>Int</code>, and assumed it was probably that."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1467200977, "post_id": 38098267, "comment_id": 63631619, "body": "Why don&#39;t you put the range into an array first before working with it? So use two arrays. You&#39;ll have to break it up first because of the 32 bit limitation Gareth mentioned. Do the first 30,000 and then the rest of it. Just a thought."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "is_accepted": false, "score": 1, "last_activity_date": 1467195635, "creation_date": 1467195635, "answer_id": 38098268, "question_id": 38098267, "link": "https://stackoverflow.com/questions/38098267/paste-one-array-single-dimension-with-100k-item-into-a-excel-range/38098268#38098268", "title": "Paste one array (single dimension) with &gt;100K item into a excel range", "body": "<p>You have come across the <a href=\"https://social.technet.microsoft.com/Forums/office/en-US/548a528c-5f5f-49ac-a225-8cfb1bf9859c/problem-with-worksheetfunctiontranspose?forum=excel\" rel=\"nofollow\">32 bit limitation</a> of the function Transpose which truncates your array to 65536. </p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 6526282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71ad5b81e47f908632c3afe2bdfefae3?s=128&d=identicon&r=PG&f=1", "display_name": "user85489", "link": "https://stackoverflow.com/users/6526282/user85489"}, "is_accepted": false, "score": -2, "last_activity_date": 1467204520, "creation_date": 1467204520, "answer_id": 38100056, "question_id": 38098267, "link": "https://stackoverflow.com/questions/38098267/paste-one-array-single-dimension-with-100k-item-into-a-excel-range/38100056#38100056", "title": "Paste one array (single dimension) with &gt;100K item into a excel range", "body": "<p>You can use loop statement to populate the cells, else if you want to do it directly then define your array ArrVal like:</p>\n\n<p>Redim ArrVal(1,Lrw) as variant</p>\n\n<p>Flood the array with values and then, Offload it like</p>\n\n<p>Range(Cells(2, c), Cells(lrw, c)) = ArrVal</p>\n\n<p>Hopefully you get rid of the same value errors.</p>\n"}, {"comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1467277456, "post_id": 38113121, "comment_id": 63669202, "body": "You have enclosed all in one post, thank you. With your code I learned a new way to manipolate large data sets, I love it 390K records are formatted on 3 seconds"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1467254571, "creation_date": 1467254571, "answer_id": 38113121, "question_id": 38098267, "link": "https://stackoverflow.com/questions/38098267/paste-one-array-single-dimension-with-100k-item-into-a-excel-range/38113121#38113121", "title": "Paste one array (single dimension) with &gt;100K item into a excel range", "body": "<p>Ok, to summarise all the answers and comments:</p>\n\n<ol>\n<li>As you have indicated in your question and as user85489 alludes, reading the values into an array, manipulating that same array, and writing it back to the sheet is vastly quicker than lopping cell by cell.</li>\n<li>If you have an array whose 'row' dimension is not going to change. Then it might be fair to say that you're better off declaring a 2 dimensional array of size (1 to rows, 1 to columns). This way you can avoid having to transpose a 1 dimensional array at all.</li>\n<li>Because as Gareth points out, <code>Transpose()</code> is limited to 65536 elements in a dimension.</li>\n</ol>\n\n<p>Putting it all together, then, skeleton code for your post could be this:</p>\n\n<pre><code>Sub ConvertDates(colIndex As Long)\n    Dim v As Variant\n    Dim firstCell As Range\n    Dim lastCell As Range\n    Dim fullRange As Range\n    Dim i As Long\n    Dim dd As Integer\n    Dim mm As Integer\n    Dim yy As Integer\n    Dim dat As Date\n\n    'Define the range\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set firstCell = .Cells(2, colIndex)\n        Set lastCell = .Cells(.Rows.Count, colIndex).End(xlUp)\n        Set fullRange = .Range(firstCell, lastCell)\n    End With\n\n    'Read the values into an array\n    v = fullRange.Value\n\n    'Convert the text values to dates\n    For i = 1 To UBound(v, 1)\n        If Not IsDate(v(i, 1)) Then\n            If Len(v(i, 1)) = 6 Then v(i, 1) = \"20\" &amp; v(i, 1)\n            yy = CInt(Left(v(i, 1), 4))\n            mm = CInt(Mid(v(i, 1), 5, 2))\n            dd = CInt(Right(v(i, 1), 2))\n            dat = DateSerial(yy, mm, dd)\n            v(i, 1) = dat\n        End If\n    Next\n\n    'Write the revised array and format range\n    With fullRange\n        .NumberFormat = \"DD/MM/YYYY;@\"\n        .Value = v\n        .EntireColumn.AutoFit\n    End With\n\nEnd Sub\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1467199786, "question_id": 133371}, "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 38113121, "answer_count": 3, "score": 0, "last_activity_date": 1467254571, "creation_date": 1467194967, "last_edit_date": 1495535333, "question_id": 38098267, "link": "https://stackoverflow.com/questions/38098267/paste-one-array-single-dimension-with-100k-item-into-a-excel-range", "title": "Paste one array (single dimension) with &gt;100K item into a excel range", "body": "<p>I posted the same question on StackOverflow <a href=\"https://stackoverflow.com/questions/38077581/error-on-loop-cell-to-convert-txt-to-date-and-put-in-array-after-paste-in-range\">thread</a>\nbut I think here is the correct place to ask (if is not right, admin please to remove it).Every day I need to format date imported from AS400 (data, time,..).\nUsualy (for some thousands of record) I use this code.</p>\n\n<pre><code>Public Sub Cfn_FormatDate(control As IRibbonControl)\nApplication.ScreenUpdating = False\n    Dim UR As Long, X As Long\n    Dim MyCol As Integer\n    MyCol = ActiveCell.Column\n    UR = Cells(Rows.Count, MyCol).End(xlUp).Row\n    For X = 2 To UR\n        If Not IsDate(Cells(X, MyCol)) Then\n            Select Case Len(Cells(X, MyCol))\n            Case 8\n                Cells(X, MyCol) = DateSerial(Left(Cells(X, MyCol), 4), Mid(Cells(X, MyCol), 5, 2), Right(Cells(X, MyCol), 2))\n            Case 6\n                Cells(X, MyCol) = DateSerial(Left(Cells(X, MyCol), 2), Mid(Cells(X, MyCol), 3, 2), Right(Cells(X, MyCol), 2))\n            End Select\n        End If\n    Next X\nColumns(MyCol).NumberFormat = \"DD/MM/YYYY;@\"\nColumns(MyCol).EntireColumn.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>but if the records are  are many more, the code posted code is not performing.\n(ex 70K records were formatted / pasted in 18 seconds)\nso I thought to using variables in an array and I wrote this code:</p>\n\n<pre><code>Sub ConvDate(c As Integer)\nApplication.ScreenUpdating = False\nDim lrw As Long, i As Long\nDim ArrVal As Variant\nlrw = ActiveSheet().Range(Cells(1, c)).End(xlDown).Row\nReDim ArrVal(2 To lrw)\nFor i = 2 To lrw\n    If IsDate(Cells(i, c)) Then\n        ArrVal(i) = Cells(i, c)\n    Else\n        Select Case Len(Cells(i, c)) ' to check YYYYMMDD or YYMMDD\n            Case 8\n                ArrVal(i) = DateSerial(Left(Cells(i, c), 4), Mid(Cells(i, c), 5, 2), Right(Cells(i, c), 2))\n            Case 6\n                ArrVal(i) = DateSerial(Left(Cells(i, c), 2), Mid(Cells(i, c), 3, 2), Right(Cells(i, c), 2))\n        End Select\n    End If\nNextX:\n    Next i\nRange(Cells(2, c), Cells(lrw, c)) = ArrVal\nColumns(c).NumberFormat = \"DD/MM/YYYY;@\"\nColumns(c).EntireColumn.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It not work, all the cells (in  the range) have the same result (Cells(2, c)).\na guy suggested me to change the code like:</p>\n\n<pre><code>ActiveSheet.Range(Cells(2, c), Cells(lrw, c)).Value = WorksheetFunction.Transpose(ArrVal)\n</code></pre>\n\n<p>this change is limiting , over 65536 records I get an error (runtime 13, type mismatch)</p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467195030, "post_id": 38096454, "comment_id": 63627606, "body": "use an array so arr() = range_rng.value2, then join this back up, to return a string out."}, {"owner": {"reputation": 146, "user_id": 5463912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fd76ef5a335149eb63bfc412a7609a?s=128&d=identicon&r=PG&f=1", "display_name": "CFW", "link": "https://stackoverflow.com/users/5463912/cfw"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467196626, "post_id": 38096454, "comment_id": 63628661, "body": "Using range_rng.value2 returns the output for range_rng (e.g. 12.5 above). I would like to return the calculation (e.g. =5/2+10 above). Many thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1467199858, "last_edit_date": 1467199858, "creation_date": 1467198556, "answer_id": 38097844, "question_id": 38096454, "link": "https://stackoverflow.com/questions/38096454/how-to-display-calculations-values-and-variables-in-excel/38097844#38097844", "title": "How to display calculations, values and variables in Excel?", "body": "<p>You can try this brute force approach.<br>\nI can't say that this is optimized, but it can satisfy your two conditions above.</p>\n\n<pre><code>Function DisplayFormula2(r As Range, Optional o As Variant) As String\n    Dim a, b, z, x, y, w\n    Dim f As String, tf As String\n    Dim c As Range\n    Dim i As Integer\n\n    If IsMissing(o) Then o = 0\n\n    a = Array(\"+\", \"-\", \"/\", \"*\", \"%\", \"&amp;\", \"^\", \"=\", _\n        \"&lt;\", \"&gt;\", \"&lt;=\", \"&gt;=\", \"&lt;&gt;\", \"(\", \")\")\n\n    f = r.FormulaArray: tf = f\n    For Each b In a\n        With Application.WorksheetFunction\n            tf = .Substitute(tf, b, \"|\")\n        End With\n    Next\n\n    z = VBA.Split(tf, \"|\")\n\n    For Each w In z\n        Debug.Print w\n        On Error Resume Next\n        Set c = Range(w)\n        On Error GoTo 0\n        If Not c Is Nothing Then\n            If IsArray(x) Then\n                ReDim Preserve x(UBound(x) + 1): x(UBound(x)) = w\n                ReDim Preserve y(UBound(y) + 1): y(UBound(y)) = c.Offset(0, o).Value2\n            Else\n                x = Array(w)\n                y = Array(c.Offset(0, o).Value2)\n            End If\n        End If\n        Set c = Nothing\n    Next\n\n    If IsArray(x) Then\n        For i = LBound(x) To UBound(x)\n            With Application.WorksheetFunction\n                f = .Substitute(f, x(i), y(i))\n            End With\n        Next\n    End If\n    DisplayFormula2 = IIf(r.HasArray, \"&lt;-- {\" &amp; f &amp; \"}\", \"&lt;-- \" &amp; f)\nEnd Function\n</code></pre>\n\n<p>By the way, I don't think you need to use <code>.Volatile</code> so I removed it.<bR>\nIt will recalculate as long as you set Calculation mode to Automatic.</p>\n\n<p><strong>Actual Formula in C3:C5:</strong><br>\nC3: <code>=DisplayFormula(B3)</code><br>\nC4: <code>=DisplayFormula2(B4)</code><br>\nC5: <code>=DisplayFormula2(B5,-1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467198827, "creation_date": 1467198827, "answer_id": 38097938, "question_id": 38096454, "link": "https://stackoverflow.com/questions/38096454/how-to-display-calculations-values-and-variables-in-excel/38097938#38097938", "title": "How to display calculations, values and variables in Excel?", "body": "<p>You can achieve that by changing the target cell to TEXT format. Try this:  </p>\n\n<pre><code>Function DisplayFormula(range_rng As Range) As String\n    Application.Volatile\n    ActiveCell.NumberFormat = \"@\"\n\n    If range_rng.HasArray Then\n        DisplayFormula = \"&lt;-- \" &amp; \" {\" &amp; range_rng.FormulaArray &amp; \"}\"\n    Else\n        DisplayFormula = \"&lt;-- \" &amp; \" \" &amp; range_rng.FormulaArray\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 5463912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fd76ef5a335149eb63bfc412a7609a?s=128&d=identicon&r=PG&f=1", "display_name": "CFW", "link": "https://stackoverflow.com/users/5463912/cfw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 1, "accepted_answer_id": 38097844, "answer_count": 2, "score": 2, "last_activity_date": 1467199858, "creation_date": 1467194780, "last_edit_date": 1467197080, "question_id": 38096454, "link": "https://stackoverflow.com/questions/38096454/how-to-display-calculations-values-and-variables-in-excel", "title": "How to display calculations, values and variables in Excel?", "body": "<p>For didactic purposes I like to perform and display calculations in Excel. To display calculations I use the following VBA worksheet-function:</p>\n\n<pre><code>Function DisplayFormula(range_rng As Range) As String\n   Application.Volatile\n\n   If range_rng.HasArray Then\n        DisplayFormula = \"&lt;-- \" &amp; \" {\" &amp; range_rng.FormulaArray &amp; \"}\"    \n   Else\n        DisplayFormula = \"&lt;-- \" &amp; \" \" &amp; range_rng.FormulaArray\n   End If\nEnd Function\n</code></pre>\n\n<p>This works, however, I'm stuck with the implementation of two modifications:</p>\n\n<ol>\n<li>I would like to display the actual values that are called in range_rng.</li>\n<li>I would like to display variables instead of the ranges. The variables would be assigned in a separate cell, next to the cell where they are called from (see graphic below).</li>\n</ol>\n\n<p>Column \"C\" shows the (desired) output formats for DisplayFormula(B3):</p>\n\n<p><img src=\"https://i.stack.imgur.com/7rfqW.jpg\" alt=\"This is how the output should look like.\"></p>\n"}, {"tags": ["java", "excel", "vba", "scheduled-tasks", "jacob"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1467195425, "post_id": 38096424, "comment_id": 63627870, "body": "Reconfigure the task to run under your user account, its currently running under another account that cannot access your user directory. (Or use a path that is available to anyone)"}, {"owner": {"reputation": 542, "user_id": 3859828, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ef2420c652121e723f76c05181cb638c?s=128&d=identicon&r=PG&f=1", "display_name": "Alann", "link": "https://stackoverflow.com/users/3859828/alann"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1467195627, "post_id": 38096424, "comment_id": 63628005, "body": "@AlexK. It&#39;s already configure to do it this way, if not the jar wouldn&#39;t start"}], "owner": {"reputation": 542, "user_id": 3859828, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ef2420c652121e723f76c05181cb638c?s=128&d=identicon&r=PG&f=1", "display_name": "Alann", "link": "https://stackoverflow.com/users/3859828/alann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467195086, "creation_date": 1467194704, "last_edit_date": 1467195086, "question_id": 38096424, "link": "https://stackoverflow.com/questions/38096424/error-on-opening-excelfile-in-a-scheduled-task", "title": "Error on opening ExcelFile in a scheduled task", "body": "<p>I've create a Jar file which have to throw a VBA Excel macro.\nTo do so I've use the jacob API\nmy code for the call is : </p>\n\n<pre><code>final ActiveXComponent excel = new ActiveXComponent(\"Excel.Application\");\n    try {\n\n        final Dispatch workbooks = excel.getProperty(\"Workbooks\").toDispatch();\n\n        final Dispatch workBook = Dispatch.call(workbooks, \"Open\", file.getAbsolutePath()).toDispatch();\n\n        final Variant result = Dispatch.call(excel, \"Run\", new Variant(\"\\'\" + file.getName() + \"\\'\" + macro));\n        com.jacob.com.Variant f = new com.jacob.com.Variant(true);\n        Dispatch.call(workBook, \"Close\", f);\n\n    } catch (Exception e) {\n\n        ReadExcel.errorLog(e.getMessage());\n\n    } finally {\n\n        excel.invoke(\"Quit\", new Variant[0]);\n        ComThread.Release();\n    }\n</code></pre>\n\n<p>this code work fine when I launch my jar manually, but on a scheduled task I've got this error :</p>\n\n<blockquote>\n  <p>ERROR - Invoke of: Open Source: Microsoft Office Excel Description:\n  Microsoft Office Excel cannot access the file\n  \u00ab\u00a0C:\\Users\\Me\\Desktop\\Project\\ExcelWithMacro.xlsm\u00a0\u00bb. There are several\n  possible reasons:</p>\n  \n  <ul>\n  <li>The file name or path does not exist.</li>\n  <li>The file is being used by another program.</li>\n  <li>The workbook you are trying to save has the same name as a currently open workbook.</li>\n  </ul>\n</blockquote>\n\n<p>But the file exist, is not use by an other program and is not open ...</p>\n\n<p>the error is throw on the line:</p>\n\n<pre><code>final Dispatch workBook = Dispatch.call(workbooks, \"Open\", file.getAbsolutePath()).toDispatch();\n</code></pre>\n"}, {"tags": ["vba", "loops", "formula", "offset"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1467194374, "post_id": 38096094, "comment_id": 63627180, "body": "your search range is set to be 12 rows"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467194644, "post_id": 38096094, "comment_id": 63627362, "body": "I have just solved this by using &quot;Range(Selection.Offset(-1, 0), Selection).FillDown&quot;. thanks for the reply"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467194926, "post_id": 38096094, "comment_id": 63627545, "body": "You should be using <code>Range(&quot;C2:C&quot; &amp; lastRow</code> I think"}], "owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467193872, "creation_date": 1467193872, "question_id": 38096094, "link": "https://stackoverflow.com/questions/38096094/vba-to-increase-the-year-after-it-finds-a-d", "title": "VBA to increase the year after it finds a D", "body": "<p>I have data from j14(January 14) until d14 which is in column C2:c13. I want the date to increase by 1 each time its ran so it goes from d14 to j15 f15 etc\nSheet 5 contains J-D in column a1:12 and 14 in b1:b12\nI would like the range from c2:c13 to drop down one each run also</p>\n\n<p>below is what i currently have but it only works for Jan15</p>\n\n<pre><code>Sub test()\n\nDim SrchRng As Range, cel As Range\nDim lastRow As String\n\nlastRow = ActiveSheet.Cells(Rows.Count, \"C\").End(xlUp).Row + 1\n\nSet SrchRng = Range(\"C2:C13\")\n\nFor Each cel In SrchRng\nIf InStr(1, cel.Value, \"D\") &gt; 0 Then\n    cel.Offset(1, 50).Value = Range(\"C\" &amp; lastRow).Select\nActiveCell.Formula = \"=Sheet5!A1&amp;Sheet5!B1+1\"\nEnd If\nNext cel\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 2, "creation_date": 1467195128, "post_id": 38095972, "comment_id": 63627667, "body": "Vityata gave the answer but I&#39;d like to add that you shouldn&#39;t use <code>.Text</code>.  <code>.Text</code> is the string that is actually displayed on screen. So if your column get&#39;s to narrow, it becomes <code>&quot;####&quot;</code> and it will delete everything. Use <code>.Value</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1467193810, "creation_date": 1467193810, "answer_id": 38096064, "question_id": 38095972, "link": "https://stackoverflow.com/questions/38095972/program-code-is-deleting-the-data-which-i-want-to-keep/38096064#38096064", "title": "Program code is deleting the data which I want to keep", "body": "<p>Change to:</p>\n\n<pre><code>If c.Text &lt;&gt; \"&lt;&lt;&lt;Keep Row\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6513335, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0a85d5beb673d253709d30285a02acd3?s=128&d=identicon&r=PG&f=1", "display_name": "TerrorJapones", "link": "https://stackoverflow.com/users/6513335/terrorjapones"}, "edited": false, "score": 0, "creation_date": 1467206726, "post_id": 38098782, "comment_id": 63635713, "body": "Hi, thank you, but like this, it&#180;s deleting on the sheet 2, if I change to sheet 1, where I wanna clear. I put before the Set c= and the c.clear, to look at the sheet1 to do the cleanning, but won&#180;t work."}], "tags": [], "owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1467201277, "creation_date": 1467201277, "answer_id": 38098782, "question_id": 38095972, "link": "https://stackoverflow.com/questions/38095972/program-code-is-deleting-the-data-which-i-want-to-keep/38098782#38098782", "title": "Program code is deleting the data which I want to keep", "body": "<p>@Vityata's answer gets right to the heart of the issue -- using <code>&lt;&gt;</code> instead of <code>=</code> is the chief issue here.</p>\n\n<p>(Using @arcadeprecinct's recommendation of <code>c.Value</code> instead of <code>c.Text</code> is also a great idea.)</p>\n\n<p>If you were to tackle this by hand in Excel, you probably wouldn't go line-by-line though -- right? You would use Excel's built-in filtering... and with VBA, you can get the same wonderful results in a hurry by using the <code>Range</code> object's built in <code>AutoFilter</code> method.</p>\n\n<pre><code>Option Explicit\nSub DeleteOthersWithAutoFilter()\n    Dim r1 As Range, c As Range\n\n    'Grab the full data range, not just column H\n    With Sheets(\"Sheet2\")\n        Set r1 = .Range(.Cells(1, 1), .Cells(Rows.Count, \"N\").End(xlUp))\n    End With\n\n    With r1\n\n        'Apply the Autofilter method to column H in the range\n        'identifying any cells NOT containing \"&lt;&lt;&lt;Keep Row\"\n        .AutoFilter Field:=8, _\n                    Criteria1:=\"&lt;&gt;&lt;&lt;&lt;Keep Row\"\n\n        'Clear the remaining, visible rows while keeping the headers\n        Set c = .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        c.ClearContents\n\n    End With\n\n    'Clear the filter\n    Sheets(\"Sheet2\").AutoFilterMode = False\n\nEnd Sub\n</code></pre>\n\n<p><strong>Using <code>Range.AutoFilter</code> instead of looping through individual rows can be very fast, especially as your data sets get larger.</strong></p>\n\n<p>You can learn more about the differences between the two strategies, looping through rows and <code>Range.AutoFilter</code>, here:</p>\n\n<p><a href=\"https://danwagner.co/how-to-delete-rows-with-range-autofilter/\" rel=\"nofollow\">https://danwagner.co/how-to-delete-rows-with-range-autofilter/</a></p>\n\n<p>Which includes a YouTube video benchmarking each in action.</p>\n"}], "owner": {"reputation": 1, "user_id": 6513335, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0a85d5beb673d253709d30285a02acd3?s=128&d=identicon&r=PG&f=1", "display_name": "TerrorJapones", "link": "https://stackoverflow.com/users/6513335/terrorjapones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467201277, "creation_date": 1467193586, "last_edit_date": 1467199680, "question_id": 38095972, "link": "https://stackoverflow.com/questions/38095972/program-code-is-deleting-the-data-which-i-want-to-keep", "title": "Program code is deleting the data which I want to keep", "body": "<p>I have a macro that consolidate the values on another sheet, and based on these values, it\u00b4s has to go back on the first sheet and delete. But the macro is deleting what I want to keep.</p>\n\n<p><a href=\"https://drive.google.com/open?id=0B0toMHEjNi_fc09PRzZLa2xGODA\" rel=\"nofollow\">The sheet</a>.</p>\n\n<pre><code>The Macro:\nSub DeleteOthers()\n    Dim r1 As Range, c As Range\n    Dim t As String\n\n    With Sheets(\"Sheet2\")\n        Set r1 = .Range(.Cells(2, \"H\"), .Cells(Rows.Count, \"H\").End(xlUp))\n    End With\n\n    For Each c In r1\n        If c.Text = \"&lt;&lt;&lt;Keep Row\" Then\n            Sheets(\"Sheet1\").Select\n            t = c.Offset(0, -1)\n            Rows(t).ClearContents\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access", "input"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467195157, "post_id": 38095961, "comment_id": 63627681, "body": "docmd.RunCommand acCmdSaveRecord"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "is_accepted": false, "score": 0, "last_activity_date": 1467366695, "last_edit_date": 1467366695, "creation_date": 1467297295, "answer_id": 38126291, "question_id": 38095961, "link": "https://stackoverflow.com/questions/38095961/error-message-in-access-form-with-both-manual-and-calculated-data-entries/38126291#38126291", "title": "Error message in Access form with both manual and calculated data entries", "body": "<p>docmd.RunCommand acCmdSaveRecord unfortunately does not work at all, as my problemativ fields are unbound. It's the mix of related bound and unbound fields which Access does not handle as one could expect. Disabling error messages or record lock, or even Me.Undo or Me.MyField1.Undo do not work at all either.</p>\n\n<p>However, I now found a work-around myself. Note that simply setting the focus on other field may sometimes push Access to save the values then avoiding the erroneous error message, but this often fails. Following code works not always either but is practicable for only few changes in the form:</p>\n\n<pre><code>Dim MyFieldVal1 As Variant, MyFieldVal2 As Variant    ', \u2026 [all unbound fields]\nPrivate Sub MyField1_Change()\n    \u2026\n    If Not IsNull(Me![MyField1]) Then MyFieldVal1 = Me![MyField1]\n    If Not IsNull(Me![MyField2]) Then MyFieldVal1 = Me![MyField2]\n    \u2026      ' same for all unbound fields on the form\n    Call SaveAllValues(Me.Name, Me.CurrentRecord)\n    \u2026\n    \u2026    ' here all code to change any field but WITHOUT Me.Refresh\n    \u2026\n    Me![MyField1] = MyFieldVal1\n    Me![MyField2] = MyFieldVal2\n    \u2026      ' same for all unbound fields on the form\n    Me.Refresh\nEnd Sub\n'===================================================\nSub SaveAllValues(ByVal FormName, ByVal CurRec)\n    DoCmd.GoToRecord acDataForm, FormName, acFirst\n    DoCmd.GoToRecord acDataForm, FormName, acGoTo, CurRec\nEnd Sub\n</code></pre>\n\n<p>The whole procedure is tedious as above code must be implemented for each unbound field: MyField2_Change() etc. etc.</p>\n\n<p>It worked correctly for quite a while, but after minor other changes at other places in the code, the errors appears reproducibly again ! Obviously the result depends on Access' last code compilation, sometimes leading to other erratic problems. Probably the module is corrupt (database repair does not correct anything). I have to live with the erroneous error or to begin designing a new form from scratch again\u2026</p>\n\n<p>Maybe it is just impossible to mix bound and unbound fields on the same form, one has no other way than to use subforms for the bound data ?</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "is_accepted": false, "score": 0, "last_activity_date": 1467366758, "last_edit_date": 1467366758, "creation_date": 1467366105, "answer_id": 38142106, "question_id": 38095961, "link": "https://stackoverflow.com/questions/38095961/error-message-in-access-form-with-both-manual-and-calculated-data-entries/38142106#38142106", "title": "Error message in Access form with both manual and calculated data entries", "body": "<p>FINAL REPORT :  It's just yet another MS Access bug !</p>\n\n<p>I redesigned my form to a main form with a number of database fields and a subform with 3 unbound fields. This changes of course the navigation sequence between fields. The same error as previously described occurs each time one switches from an unbound field to another unbound field on the subform, then to a database field on the main form.</p>\n\n<p>The problem is resolved by adding following lines at the end of each unbound field change procedure:</p>\n\n<pre><code>Private Sub MyUnboundField1_Change()\n    \u2026\n    Me.Refresh\n    Me.Parent.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593958318, "creation_date": 1467193561, "last_edit_date": 1593958318, "question_id": 38095961, "link": "https://stackoverflow.com/questions/38095961/error-message-in-access-form-with-both-manual-and-calculated-data-entries", "title": "Error message in Access form with both manual and calculated data entries", "body": "<p>my Access 2010 form is used to input data. Some fields manually (type in or choice from a dropdownlist), some other fields get precalculated values depending on the already input data. Additional code controls enabling or disabling input fields dependent from the input data (ensuring data consistency).</p>\n\n<p><strong>My problem</strong>: When I choose a value (from a dropdownlist) in a field then switch to the next field (any method: mouse/tab/code) and try to enter a value, I get an [erroneous] error message that \"another user\" (obviously my own VBA code) has modified this record and saved it before my own changes were saved. But everything is OK and the second trial to input data is successful.</p>\n\n<p>I tried Me.Recalc and Me.Refresh at different positions in the code without eliminating this nasty error. How can I tell Access 2010 to save my input data in a field before starting running the code [MyPreviousField_AfterUpdate()] ?</p>\n"}, {"tags": ["vba", "excel", "spreadsheet"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467193536, "post_id": 38095729, "comment_id": 63626581, "body": "You don&#39;t need the scrolls as you&#39;re setting by reference, also don&#39;t use select, so <code>range(&quot;R8&quot;).formulaR1C1=</code> for example.  You need to look at <code>range(&quot;R1000000&quot;).end(xlUp).Row</code> to define for your data"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467193809, "post_id": 38095729, "comment_id": 63626791, "body": "Do you want to copy the values (one time) or do you want to place references that update when the original cells are updated?"}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467195529, "post_id": 38095729, "comment_id": 63627943, "body": "Hi @arcadeprecinct I would like them to copy one time so I can use that data in the new sheet. Once I get the new data the following day I plan to simple run the macro again to update the data sheet."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1467200077, "post_id": 38097204, "comment_id": 63630923, "body": "Hi @arcadeprecinct Thank you for the above and for the &#39;info as to what it references, this helps my understand and knowledge a lot. I have tried to run the macro but get an error with the line below;     lastRow = .Cells(.Rows.Count, 7).End(xlUp) &#39;7 is the column number - it is highlighted in yellow."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 1, "creation_date": 1467200389, "post_id": 38097204, "comment_id": 63631164, "body": "@Bradley I forgot a <code>.Row</code> when calculating the <code>lastRow</code>, should work now. Without <code>.Row</code> it&#39;s the cell itself and not its row index"}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1467204778, "post_id": 38097204, "comment_id": 63634310, "body": "Thank you @arcadeprecinct works great. in order to populate columns Q and R in the same way I have copied and edited the last two lines and works great. appreciate the help!"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 1, "last_activity_date": 1467200325, "last_edit_date": 1467200325, "creation_date": 1467196845, "answer_id": 38097204, "question_id": 38095729, "link": "https://stackoverflow.com/questions/38095729/macro-loop-to-pull-data-from-sheet-to-sheet-stopping-when-no-data-resent-and-not/38097204#38097204", "title": "Macro loop to pull data from sheet to sheet stopping when no data resent and not entering 0", "body": "<p>Here is a way to copy all values from <code>G15</code> downwards to <code>M8</code> downwards</p>\n\n<pre><code>Dim sourceSht As Worksheet 'sheet you want to copy from \nDim targetSht As Worksheet 'sheet you want to copy too\nDim sourceRng As Range 'what you want to copy\nDim targetRng As Range 'where you want to copy to\nDim lastRow As Long 'the last row that holds data\n\nSet sourceSht = Sheets(\"Order Sheet\")\nSet targetSht = Sheets(\"Data\")\n\nWith sourceSht\n    lastRow = .Cells(.Rows.Count,7).End(xlUp).Row '7 is the column number\nEnd With\n\nSet sourceRng = sourceSht.Range(\"G15:G\" &amp; lastRow)\nSet targetRng = targetSht.Range(\"M8\").Resize(sourceRng.Rows.Count, 1) ' Range(\"M8:M\"&amp; lastRow - 7) would also be possible\ntargetRng.Value = sourceRng.Value\n</code></pre>\n\n<p>You might want to introduce variables to hold the column indices and row numbers (like 15 and 8). You could also have the ranges contain more than one column to copy more data at once.</p>\n"}], "owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 38097204, "answer_count": 1, "score": 0, "last_activity_date": 1467200325, "creation_date": 1467192956, "last_edit_date": 1467193719, "question_id": 38095729, "link": "https://stackoverflow.com/questions/38095729/macro-loop-to-pull-data-from-sheet-to-sheet-stopping-when-no-data-resent-and-not", "title": "Macro loop to pull data from sheet to sheet stopping when no data resent and not entering 0", "body": "<p>I am trying to get the data from rows G,H, and I from row 15 down (stopping when there is no data present)from \"order sheet\", to be pasted in a sheet called \u201cData\u201d in columns M,Q and R from row 8 down.</p>\n\n<p>I have tried recording a macro, however as this data changes from day to day, my recorded macro stays the same and I don\u2019t have the know how to place an IF formula in macro to stop it when there is no data in origin cell. One day the data will be from row 15 to 50 in the order sheet and the next 15 to 71 (always starts at 15). When I do the macro for say 200 rows so it does cover all rows no matter how many rows it may be, itll then places a zero in the data sheet when nothing present in order sheet cell. What I would like is for it to leave blank if there is no number in the order sheet cell.</p>\n\n<p>e.g. \n\u201cOrder sheet\u201d column paste to \u201cData sheet\u201d (starting from row 15 down on order sheet and row 8 down on data sheet)\nG   to  M /\nH   to  Q /\nI   to  R</p>\n\n<p>e.g.\nG15 to  M8 /\nH16     to  Q9 /\nI17 to  R10</p>\n\n<p>See the basic recorder macro as an idea.</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>ActiveWindow.SmallScroll Down:=-15\nRange(\"M8\").Select\nActiveCell.FormulaR1C1 = \"='Order Sheet'!R[7]C[-6]\"\nRange(\"M8\").Select\nSelection.AutoFill Destination:=Range(\"M8:M159\"), Type:=xlFillDefault\nRange(\"M8:M159\").Select\nActiveWindow.SmallScroll Down:=-135\nRange(\"Q8\").Select\nActiveCell.FormulaR1C1 = \"='Order Sheet'!R[7]C[-9]\"\nRange(\"Q8\").Select\nSelection.AutoFill Destination:=Range(\"Q8:Q159\"), Type:=xlFillDefault\nRange(\"Q8:Q159\").Select\nActiveWindow.SmallScroll Down:=-132\nRange(\"R8\").Select\nActiveCell.FormulaR1C1 = \"='Order Sheet'!R[7]C[-9]\"\nRange(\"R8\").Select\nSelection.AutoFill Destination:=Range(\"R8:R159\"), Type:=xlFillDefault\nRange(\"R8:R159\").Select\nActiveWindow.SmallScroll Down:=-123\nRange(\"I3\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467193190, "post_id": 38095708, "comment_id": 63626356, "body": "Can you clarify the exact data it is you are trying to access with the commands?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6522811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ea8aa8b04566c631f341ba776ab8df8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus", "link": "https://stackoverflow.com/users/6522811/maximus"}, "edited": false, "score": 0, "creation_date": 1467196115, "post_id": 38095893, "comment_id": 63628344, "body": "The data is coming from a match function and so I don&#39;t know where the data is coming from. It changes all the time. So I need the function to be dynamic?"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1467193395, "creation_date": 1467193395, "answer_id": 38095893, "question_id": 38095708, "link": "https://stackoverflow.com/questions/38095708/how-to-use-the-functions-cell-and-index-together-in-vba/38095893#38095893", "title": "How to use the functions CELL and INDEX together in vba", "body": "<p>If you are just trying to get the address of a certain value in a range, use the Find function. In this case, since you seem to know the location of the value, you can return the address by calling <code>Range(location).Address</code> where <code>location</code> is the \"ColumnRow\" call of the location</p>\n"}], "owner": {"reputation": 1, "user_id": 6522811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ea8aa8b04566c631f341ba776ab8df8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus", "link": "https://stackoverflow.com/users/6522811/maximus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467195032, "creation_date": 1467192879, "last_edit_date": 1531161705, "question_id": 38095708, "link": "https://stackoverflow.com/questions/38095708/how-to-use-the-functions-cell-and-index-together-in-vba", "title": "How to use the functions CELL and INDEX together in vba", "body": "<p>I want to use cell and index together to get an address of a certain value in excel vba.</p>\n\n<p>I write the following but it doesn't work as it doesn't know how to read the cell function.</p>\n\n<pre><code>PlaceF = Application.WorksheetFunction.CELL(\"address\", Application.WorksheetFunction.Index([G9:L44], [I3], [I4]))\n</code></pre>\n\n<p>Is there any alternative to this or a way to get this function to work?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1467198622, "post_id": 38094926, "comment_id": 63629943, "body": "So you&#39;re using the slide&#39;s Hidden property to determine if the progress bar should be added or not. So if there are slides you don&#39;t need, you will mark them as hidden? If not, you need a second custom property (tag perhaps) to indicate if the progress bar should be applied or not. I&#39;m not sure what you actually need. Do you just want the progress bar to not appear on the last slide?"}, {"owner": {"reputation": 1, "user_id": 6527479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d64d4c393efd020303f02f08b72fb70?s=128&d=identicon&r=PG&f=1", "display_name": "StevenNL", "link": "https://stackoverflow.com/users/6527479/stevennl"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1467301065, "post_id": 38094926, "comment_id": 63686634, "body": "No I don&#39;t want hidden slides since I might need them. So I just want the progress bar to be finished after 20 slides but then there will follow some additional slides. I hope you can help me!"}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1467405776, "creation_date": 1467405776, "answer_id": 38153628, "question_id": 38094926, "link": "https://stackoverflow.com/questions/38094926/how-can-i-add-a-progress-bar-in-powerpoint-that-excludes-the-last-slides/38153628#38153628", "title": "How can I add a progress bar in powerpoint that excludes the last slides", "body": "<p>Replace .Slides.Count with the index of the last slide you want the progress bar to appear on. You could make it dynamic by using InputBox to enter the value.</p>\n"}], "owner": {"reputation": 1, "user_id": 6527479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d64d4c393efd020303f02f08b72fb70?s=128&d=identicon&r=PG&f=1", "display_name": "StevenNL", "link": "https://stackoverflow.com/users/6527479/stevennl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 778, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593729510, "creation_date": 1467191002, "last_edit_date": 1593729510, "question_id": 38094926, "link": "https://stackoverflow.com/questions/38094926/how-can-i-add-a-progress-bar-in-powerpoint-that-excludes-the-last-slides", "title": "How can I add a progress bar in powerpoint that excludes the last slides", "body": "<p>Basically I want to add a progress bar to my powerpoint that does not cover the entire presentation. However I have some additional slides that I might not need when presenting and therefore want to exclude from the progress bar. </p>\n\n<pre><code>Sub AddProgressBar()\n    On Error Resume Next\n        With ActivePresentation\n              sHeight = .PageSetup.SlideHeight - 12\n              n = 0\n              j = 0\n              For i = 1 To .Slides.Count\n                If .Slides(i).SlideShowTransition.Hidden Then j = j + 1\n              Next i:\n              For i = 2 To .Slides.Count\n                .Slides(i).Shapes(\"progressBar\").Delete\n                If .Slides(i).SlideShowTransition.Hidden = msoFalse Then\n                  Set slider = .Slides(i).Shapes.AddShape(msoShapeRectangle, 0, sHeight, (i - n) * .PageSetup.SlideWidth / (.Slides.Count - j), 12)\n                  With slider\n                      .Fill.ForeColor.RGB = ActivePresentation.SlideMaster.ColorScheme.Colors(ppFill).RGB\n                      .Name = \"progressBar\"\n                  End With\n                Else\n                   n = n + 1\n                End If\n              Next i:\n        End With\nEnd Sub\n\nSub RemoveProgressBar()\n    On Error Resume Next\n        With ActivePresentation\n              For i = 22 To .Slides.Count\n              .Slides(i).Shapes(\"progressBar\").Delete\n              .Slides(i).Shapes(\"pageNumber\").Delete\n              Next i:\n        End With\nEnd Sub\n</code></pre>\n\n<p>This is what I did so far but it shows an unfinished progress bar ad the 'final' slide that includes the progress bar.</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1467190496, "post_id": 38094518, "comment_id": 63624476, "body": "use <code>ISERROR</code> function to check for any kind of error in a cell"}], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "edited": false, "score": 0, "creation_date": 1467191175, "post_id": 38094806, "comment_id": 63624902, "body": "Worked perfectly, thanks!  I created the else statement to show the row again, if data there will be data again, and then i created a macro to check.  Private Sub Worksheet_Change(ByVal Target As Range)     If Target.Address = &quot;$B$2&quot; Then Call Sheet1.HideCharts     End If"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 1, "last_activity_date": 1467190695, "creation_date": 1467190695, "answer_id": 38094806, "question_id": 38094518, "link": "https://stackoverflow.com/questions/38094518/if-ref-then-hide-certain-rows/38094806#38094806", "title": "If #REF! then hide certain rows", "body": "<p>Like this:</p>\n\n<p>Change <code>If Cells(RowCnt, ChkCol).Value = 0 Then</code> to <code>If Cells(RowCnt, ChkCol).Value = 0 or iserror(Cells(RowCnt, ChkCol).Value)</code></p>\n\n<pre><code>Sub HideCharts()\n\nBeginRow = 132\nEndRow = 138\nChkCol = 8\n\nFor RowCnt = BeginRow To EndRow\n    If Cells(RowCnt, ChkCol).Value = 0 or iserror(Cells(RowCnt, ChkCol).Value) Then\n        Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n    Else  \n        'You don't need this if all the rows are visible at start  \n        Cells(RowCnt, ChkCol).EntireRow.Hidden = False\n    End If\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 2, "last_activity_date": 1467190780, "creation_date": 1467190780, "answer_id": 38094834, "question_id": 38094518, "link": "https://stackoverflow.com/questions/38094518/if-ref-then-hide-certain-rows/38094834#38094834", "title": "If #REF! then hide certain rows", "body": "<p>Try to use \"IsError\" in your if statement it should work.</p>\n\n<pre><code>For RowCnt = BeginRow To EndRow\n    If IsError(Cells(RowCnt, ChkCol)) Then\n        Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n    End If\nNext RowCnt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1467191109, "creation_date": 1467191109, "answer_id": 38094970, "question_id": 38094518, "link": "https://stackoverflow.com/questions/38094518/if-ref-then-hide-certain-rows/38094970#38094970", "title": "If #REF! then hide certain rows", "body": "<p>You can catch cell value errors using the <code>IsError</code> function.</p>\n\n<p>If you only want specific cell value errors (for example because you don't want to hide errors that are not caused by missing data but by corrupt data), use the <code>CVErr</code> function. See <a href=\"https://msdn.microsoft.com/en-us/en-en/library/office/ff839168.aspx\" rel=\"nofollow\">this</a> for a list of possible error values. In your case it would be</p>\n\n<pre><code>If CVErr(Cells(...)) = xlErrRef Then\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 38094806, "answer_count": 3, "score": 1, "last_activity_date": 1467191109, "creation_date": 1467189883, "question_id": 38094518, "link": "https://stackoverflow.com/questions/38094518/if-ref-then-hide-certain-rows", "title": "If #REF! then hide certain rows", "body": "<p>I have created 2 sheets, Sheet no. 1 shows the data nicely and the other imports the data. Therefore sheet no. 1 gets data from sheet no. 2. However sometimes there are no data in sheet no 2. This gives the cells in sheet 1 \"#REF!\". When this happens i need to hide certain rows in sheet 1.</p>\n\n<p>So i imagine something like this</p>\n\n<pre><code>Sub HideCharts()\n\nBeginRow = 132\nEndRow = 138\nChkCol = 8\n\nFor RowCnt = BeginRow To EndRow\n    If Cells(RowCnt, ChkCol).Value = 0 Then\n        Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n    End If\nNext RowCnt\n\n        For RowCnt = BeginRow To EndRow\n            If Cells(RowCnt, ChkCol).Value &lt;&gt; 0 Then\n                Cells(RowCnt, ChkCol).EntireRow.Hidden = False\n            End If\n        Next RowCnt\nEnd Sub \n</code></pre>\n\n<p>However this only works if the data is 0 and i got no clue on how to catch the #REF! also this only hides the rows that contains the 0 value, but i need to catch certain rows like 130 to 140</p>\n\n<p>So i thought, who else to turn to than Stack Overflow?</p>\n"}, {"tags": ["excel", "vba", "macros", "formula"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467191853, "post_id": 38094487, "comment_id": 63625367, "body": "Did you try to put it in a loop? Is <code>f</code> the loop variable? Do you receive an error? If so, what is it? Change <code>.FormulaR1C1</code> to <code>.Formula</code> if you want to use <code>A1</code> reference style."}, {"owner": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467195514, "post_id": 38094487, "comment_id": 63627935, "body": "I am Looping on <code>i</code>. f is the variable <code>f = i + 2</code>- in which i is always growing. With changing to .Formula i still get Runtime Error 1004."}, {"owner": {"reputation": 5324, "user_id": 865982, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0899670c11455626e140c268bd05d5d6?s=128&d=identicon&r=PG", "display_name": "edeboursetty", "link": "https://stackoverflow.com/users/865982/edeboursetty"}, "edited": false, "score": 0, "creation_date": 1467196115, "post_id": 38094487, "comment_id": 63628345, "body": "Are you missing double quotes in your x,a,b,c variables? Instead of setting a formula, can you do <code>Debug.Print &quot;=WHEN...&quot;</code> to see if the formula is correctly written?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "edited": false, "score": 0, "creation_date": 1467265883, "post_id": 38097875, "comment_id": 63662835, "body": "Hello arcadeprecinct, I think we are almost at it. At least he does fill in the following formula into the right cell. <code>=WENN(ZEK!$F$3=X;6;WENN(ZEK!$G$3=X;8;1))</code> WENN is the IF function in german.  Though he wants me to open a file and does not Redirect to the Sheet &#39;ZEK&#39;. also the <code>&#39; .. &#39; </code> go missing.  Greetings TiroX"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "edited": false, "score": 0, "creation_date": 1467269188, "post_id": 38097875, "comment_id": 63664281, "body": "@TiRoX the <code>&#39;...&#39;</code> disappear because the sheet name doesn&#39;t contain spaces. Excel apparently can&#39;t find a sheet called &quot;ZEK&quot;. Are you sure it is there (it has to be the name that is displayed in the tabs in the main window). If ZEK is the identifier and not the name (<code>(Name)</code> property instead of <code>Name</code> property in the VBA editor), use the name or <code>&quot;...&quot; &amp; ZEK.Name &amp; &quot;...&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "edited": false, "score": 0, "creation_date": 1467273615, "post_id": 38097875, "comment_id": 63666836, "body": "Hello Arcadeprecinct, I think we are almost done :D I just Need to fix that instead of X it is &quot;X&quot; in the Formular. The current Output in german Excel: <code>=WENN(ZEK!$F$3=X;6;WENN(ZEK!$G$3=X;8;1))</code> The needed Output: <code>=WENN(ZEK!$F$3=&quot;X&quot;;6;WENN(ZEK!$G$3=&quot;X&quot;;8;1))</code> So I only Need to get behind, how i can Output &quot;&quot;.  Do you have any ideas?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "edited": false, "score": 0, "creation_date": 1467273750, "post_id": 38097875, "comment_id": 63666905, "body": "@TiRoX Use <i>double</i> double quotes to get double quotes inside a string: <code>&quot;&quot;X&quot;&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "edited": false, "score": 0, "creation_date": 1467273883, "post_id": 38097875, "comment_id": 63666969, "body": "I got it.  My final formula: <code>&quot;=IF(&quot; &amp; a &amp; &quot;&quot; &amp; f &amp; &quot;=&quot;&quot;X&quot;&quot;,&quot; &amp; edi &amp; &quot;,IF(&quot; &amp; b &amp; &quot;&quot; &amp; f &amp; &quot;=&quot;&quot;X&quot;&quot;,&quot; &amp; brofis &amp; &quot;,&quot; &amp; druck &amp; &quot;))&quot;</code>  Thank you a lot for the Support!!!"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1467199061, "last_edit_date": 1467199061, "creation_date": 1467198654, "answer_id": 38097875, "question_id": 38094487, "link": "https://stackoverflow.com/questions/38094487/excel-vba-inserting-when-formula-into-specific-range-of-cells-with-variable-cha/38097875#38097875", "title": "Excel VBA: inserting WHEN formula into specific range of cells with variable changing column", "body": "<p>I think it's a language problem... Try</p>\n\n<pre><code>\"=IF('ZEK'!$F$\" &amp; f &amp; \"=\" &amp; x &amp; \",\" &amp; a &amp; \",IF('ZEK'!$G$\" &amp; f &amp; \"=\" &amp; x &amp; \",\" &amp; b &amp; \",\" &amp; c &amp; \"))\"\n</code></pre>\n\n<p>Notice the use of <code>IF</code> and <code>,</code> as a delimiter instead of <code>;</code>. Is <code>WHEN</code> even a valid worksheet function? To be honest I don't know if the worksheet functions get translated or not when setting the formula via VBA. The delimiters are adapted though.</p>\n\n<p>edit: there is also the <code>.FormulaLocal</code> property that should work with <code>;</code> as delimiter! So change <code>.Formula</code> to <code>.FormulaLocal</code>. This will probably cause an error if you execute it on a machine that uses <code>,</code> as default delimiter so I'd try to stick with <code>.Formula</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 6527261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4664955dedae04b6e73bd352fb5f63b7?s=128&d=identicon&r=PG&f=1", "display_name": "TiRoX", "link": "https://stackoverflow.com/users/6527261/tirox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 38097875, "answer_count": 1, "score": 0, "last_activity_date": 1467199061, "creation_date": 1467189766, "last_edit_date": 1467195571, "question_id": 38094487, "link": "https://stackoverflow.com/questions/38094487/excel-vba-inserting-when-formula-into-specific-range-of-cells-with-variable-cha", "title": "Excel VBA: inserting WHEN formula into specific range of cells with variable changing column", "body": "<p>Hello dear StackOverflow users,</p>\n\n<p>My issue is regarding inserting a Formular via Macro into specific range of cells. Again, again and again.</p>\n\n<p>So the Basic function of the formula should be the following:</p>\n\n<p><code>=WHEN('ZEK '!F3=\"X\";\"6\";WHEN('ZEK '!G3=\"X\";\"8\";\"1\"))</code></p>\n\n<p>In my macro it has to Change the column for the next specific range.\nThis is Happening in a for Loop for <code>i</code> growing.</p>\n\n<p>meaning --> <code>=When('ZEK '!$F$\"&amp; i+2 &amp;\".......</code>\nor in any other Syntax that should work. My try fairly does not, thats why I need your help.</p>\n\n<p>This is my Initial try where i exchanged literally everything with strings:</p>\n\n<pre><code>Sub 123()\nDim a,b,c As String\na = 1\nb = 6\nc = 8\n\n....\n\n'used and declared variables k, x, f, a, b, c\n\nRange(Cells(k + 2, 5), Cells(k + 27, 5)).FormulaR1C1 = _\n\"=WHEN('ZEK'!$F$\" &amp; f &amp; \"=\" &amp; x &amp; \";\" &amp; a &amp; \";WHEN('ZEK'!$G$\" &amp; f &amp; \"=\" &amp; x &amp; \";\" &amp; b &amp; \";\" &amp; c &amp; \"))\"\n\nEnd Sub\n</code></pre>\n\n<p>With that i get Runtime Error 1004. (changed it to .Formula from .FormulaR1C1)</p>\n\n<p>I hope i gave enough Information, so that you could help me.\nThis really does not have to be performant, i just Need to get the formula into about 100.000 cells with <code>i</code> changing for each Range of cells</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467189859, "post_id": 38094325, "comment_id": 63624031, "body": "On which line is the error returned?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467189996, "post_id": 38094325, "comment_id": 63624132, "body": "My guess is the type mismatch is coming from the <code>Range(&quot;C7:C266&quot;) = &quot;Peter&quot;</code> call, but I&#39;m not fully familiar with the IF function documentation"}, {"owner": {"reputation": 21, "user_id": 5700717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/57e20f0a0951c851f263a3b53033c62e?s=128&d=identicon&r=PG&f=1", "display_name": "mobility", "link": "https://stackoverflow.com/users/5700717/mobility"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467190867, "post_id": 38094325, "comment_id": 63624712, "body": "error on &quot;myarray = WorksheetFunction.If(Range(&quot;C7:C266&quot;) = &quot;Peter&quot;, 1 / (WorksheetFunction.CountIfs(Range(&quot;C7:C266&quot;), &quot;Peter&quot;, Range(&quot;F7:F266&quot;), Range(&quot;F7:F266&quot;))), 0)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467193891, "post_id": 38094325, "comment_id": 63626849, "body": "Are you just interested in a count of distinct records or do you want to create an array of the distinct records?"}], "answers": [{"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1467191436, "creation_date": 1467191436, "answer_id": 38095097, "question_id": 38094325, "link": "https://stackoverflow.com/questions/38094325/error-on-vb-function-returning-array/38095097#38095097", "title": "Error on VB Function returning Array", "body": "<p>The error you are getting is a result of the way the <code>IF</code> function is called.  The first term must be a logical result, but you cannot call the <code>value</code> of a multi-cell Range (ie Range(\"C7:C266\")).  To solve this problem, I think you will need to loop through each of the cells and act on them accordingly, although there may be a more clever solution using something other than <code>IF</code> that I am not aware of</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5700717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/57e20f0a0951c851f263a3b53033c62e?s=128&d=identicon&r=PG&f=1", "display_name": "mobility", "link": "https://stackoverflow.com/users/5700717/mobility"}, "edited": false, "score": 0, "creation_date": 1467192639, "post_id": 38095350, "comment_id": 63625945, "body": "I tried this code. I get &quot;object required&quot; on Set ws = ActiveWorksheet"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 21, "user_id": 5700717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/57e20f0a0951c851f263a3b53033c62e?s=128&d=identicon&r=PG&f=1", "display_name": "mobility", "link": "https://stackoverflow.com/users/5700717/mobility"}, "edited": false, "score": 1, "creation_date": 1467193069, "post_id": 38095350, "comment_id": 63626261, "body": "@mobility change that to ActiveSheet and it will work"}, {"owner": {"reputation": 21, "user_id": 5700717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/57e20f0a0951c851f263a3b53033c62e?s=128&d=identicon&r=PG&f=1", "display_name": "mobility", "link": "https://stackoverflow.com/users/5700717/mobility"}, "edited": false, "score": 0, "creation_date": 1467247641, "post_id": 38095350, "comment_id": 63658097, "body": "however, this code cannot exclude duplicated records of Peter which must be checked in column F"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467274089, "post_id": 38095350, "comment_id": 63667096, "body": "Sorry, I don&#39;t get this, you want to find all occurences of &#39;Peter&#39; but not the duplicates? Could you edit your first post and show how your data actually looks like?"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1467193791, "last_edit_date": 1467193791, "creation_date": 1467192039, "answer_id": 38095350, "question_id": 38094325, "link": "https://stackoverflow.com/questions/38094325/error-on-vb-function-returning-array/38095350#38095350", "title": "Error on VB Function returning Array", "body": "<p>You can do it like this:</p>\n\n<pre><code>Sub findPeter()\n\nDim ws As Worksheet\nDim peterCount As Long\nSet ws = Worksheets(\"nameofyoursheet\")\n\nWith ws\n    For i = 7 To 266\n        If .Cells(i, 3) = \"Peter\" Then\n            peterCount = peterCount + 1\n        End If\n    Next\nEnd With\n\nIf CheckBox5.Value = True Then\n    TextBox6.Value = peterCount + 1\nEnd If\n\nIf CheckBox5.Value = False Then\n    TextBox6.Value = \"\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><code>peterCount</code> is the sum of all occurences of the value <code>Peter</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 5700717, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/57e20f0a0951c851f263a3b53033c62e?s=128&d=identicon&r=PG&f=1", "display_name": "mobility", "link": "https://stackoverflow.com/users/5700717/mobility"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467204960, "creation_date": 1467189328, "last_edit_date": 1531164843, "question_id": 38094325, "link": "https://stackoverflow.com/questions/38094325/error-on-vb-function-returning-array", "title": "Error on VB Function returning Array", "body": "<p>The following is my VB code. I want to count all the distinct records about \"Peter\" in a spreadsheet without duplication.\nWhen I run the code, \"Run-time error '13':Type Mismatch\" always appear. I fail to debug. What's wrong with my code?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub CheckBox5_Click()\r\n\r\nDim myarray As Variant\r\n\r\nmyarray = WorksheetFunction.If(Range(\"C7:C266\") = \"Peter\", 1 / (WorksheetFunction.CountIfs(Range(\"C7:C266\"), \"Peter\", Range(\"F7:F266\"), Range(\"F7:F266\"))), 0)\r\n\r\nIf CheckBox5.Value = True Then\r\nTextBox6.Value = WorksheetFunction.Sum(myarray) + 1\r\nEnd If\r\n\r\nIf CheckBox5.Value = False Then\r\nTextBox6.Value = \"\"\r\nEnd If\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467191439, "post_id": 38094351, "comment_id": 63625086, "body": "I&#39;ve edited my question as I forgot to mention that are several sections of rows displayed with the section headings passed into the &#39;add new line&#39; function"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467192646, "post_id": 38094351, "comment_id": 63625948, "body": "i am not able to get you. can you please edit some samples"}, {"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1467199747, "post_id": 38094351, "comment_id": 63630697, "body": "It&#39;s ok, I&#39;m just looking for a solution where I can count the amount of rows in the section. I&#39;m new to VBA as I&#39;m normally c# and unsure how to do it?"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1467189387, "creation_date": 1467189387, "answer_id": 38094351, "question_id": 38094188, "link": "https://stackoverflow.com/questions/38094188/adding-a-new-row-after-a-range-of-rows-in-vba/38094351#38094351", "title": "Adding a new row after a range of rows in VBA", "body": "<p>Try with below code</p>\n\n<pre><code>Sub addnewrow()\n    Dim addrow As String\n    addrow = InputBox(\"type the row number to insert\")\n    If addrow &lt;&gt; \"\" And IsNumeric(addrow) = True Then\n        Rows(addrow).Insert shift:=xlDown\n    Else\n        MsgBox (\"enter only row number\")\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467191015, "creation_date": 1467188860, "last_edit_date": 1467191015, "question_id": 38094188, "link": "https://stackoverflow.com/questions/38094188/adding-a-new-row-after-a-range-of-rows-in-vba", "title": "Adding a new row after a range of rows in VBA", "body": "<p>How do I add a new row to a range of existing rows that are <strong><em>dynamic</em></strong> and are displayed in their own sections in the spread sheet?</p>\n\n<p>E.g. When I click 'add new line' to add <strong><em>one row</em></strong> to a set of rows:</p>\n\n<pre><code>-------------------------------------------------------\nROW 1\n-------------------------------------------------------\nROW 2\n-------------------------------------------------------\nNEW LINE &lt;--- New row is added from the 'add new line'\n</code></pre>\n\n<p>However, this needs to be dynamic to add another line underneath where the number of rows can be different:</p>\n\n<pre><code>-------------------------------------------------------\nROW 1\n-------------------------------------------------------\nROW 2\n-------------------------------------------------------\nROW 3\n-------------------------------------------------------\nROW 4\n-------------------------------------------------------\nNEW LINE &lt;--- New row is added from the 'add new line'\n</code></pre>\n\n<p>The position of the section is passed in as a parameter 'sectionNumber'. Is there a way of using this parameter to find the position of the section of rows then count them and add the new line like above?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467190188, "post_id": 38094105, "comment_id": 63624278, "body": "Note that the check <code>Cells(TotalLoop, 10) = 0</code> will also return true if the cell is empty. If you don&#39;t want that, use <code>Cells(TotalLoop, 10) = 0 And Cells(TotalLoop, 10) &lt;&gt; &quot;&quot;</code> or <code>Cells(TotalLoop, 10) = &quot;0&quot;</code> (I would use the first)."}], "answers": [{"comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1467189688, "post_id": 38094440, "comment_id": 63623926, "body": "kindly mark it as answer if it works by pressing tick symbol"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1467189629, "creation_date": 1467189629, "answer_id": 38094440, "question_id": 38094105, "link": "https://stackoverflow.com/questions/38094105/excel-vba-delete-rows-where-column-data-is-zero/38094440#38094440", "title": "Excel VBA- Delete Rows where column data is ZERO", "body": "<p>Just remove the below line and execute your code. It will work</p>\n\n<pre><code>Cells(TotalLoop - 1, 10) = Fund\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1467189685, "creation_date": 1467189685, "answer_id": 38094464, "question_id": 38094105, "link": "https://stackoverflow.com/questions/38094105/excel-vba-delete-rows-where-column-data-is-zero/38094464#38094464", "title": "Excel VBA- Delete Rows where column data is ZERO", "body": "<p>In your code, you are changing the value of the next undeleted row to the value of fund, which is zero in order for the code to execute.  Remove the line <code>Cells(TotalLoop - 1, 10) = Fund</code> and your loop will function as desired</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6126570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15492414247e1bc8fc0e1aa713a8994?s=128&d=identicon&r=PG&f=1", "display_name": "Shingi Muvenge", "link": "https://stackoverflow.com/users/6126570/shingi-muvenge"}, "edited": false, "score": 0, "creation_date": 1467377158, "post_id": 38094725, "comment_id": 63721089, "body": "Thanks Guys. Deletion of that line helped"}], "tags": [], "owner": {"reputation": 1, "user_id": 6526771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b323ffe67f75b17d6601730459e2c?s=128&d=identicon&r=PG&f=1", "display_name": "Mosharof Hossain", "link": "https://stackoverflow.com/users/6526771/mosharof-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1467190464, "creation_date": 1467190464, "answer_id": 38094725, "question_id": 38094105, "link": "https://stackoverflow.com/questions/38094105/excel-vba-delete-rows-where-column-data-is-zero/38094725#38094725", "title": "Excel VBA- Delete Rows where column data is ZERO", "body": "<p>Sub Format()</p>\n\n<pre><code>Dim sh As Worksheet\nDim Fund As Long\nDim TotalLoop As Long\nSet sh = ThisWorkbook.Sheets(\"Sheet1\")\nRowCount = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n\n\nFor TotalLoop = RowCount To 2 Step -1\nFund = Cells(TotalLoop, 10)\nIf Fund = 0 Then\nRows(TotalLoop).Delete\nEnd If\nNext TotalLoop\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 11, "user_id": 6126570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15492414247e1bc8fc0e1aa713a8994?s=128&d=identicon&r=PG&f=1", "display_name": "Shingi Muvenge", "link": "https://stackoverflow.com/users/6126570/shingi-muvenge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2571, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1467190464, "creation_date": 1467188590, "question_id": 38094105, "link": "https://stackoverflow.com/questions/38094105/excel-vba-delete-rows-where-column-data-is-zero", "title": "Excel VBA- Delete Rows where column data is ZERO", "body": "<p>I am trying to clean up some spreadsheet data, as such I  had the below code to delete all rows for which column 10 has the number 0. The problem is when I run the code it deletes all the rows.</p>\n\n<p>Would anyone be able to highlight what exactly is wrong with my code?</p>\n\n<pre><code>Sub Format()\n\nDim Fund As Long \nDim TotalLoop As Long\n\nRowCount = Range(\"A65536\").End(xlUp).Row\nFor TotalLoop = RowCount To 2 Step -1\nFund = Cells(TotalLoop, 10)\nIf Fund = 0 Then\nRows(TotalLoop).Delete\nCells(TotalLoop - 1, 10) = Fund\nEnd If\nNext TotalLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "compare", "case-statement"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1467188664, "post_id": 38093869, "comment_id": 63623259, "body": "<code>Select Case</code> code will be Neater in VBA"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1467190365, "post_id": 38093869, "comment_id": 63624389, "body": "I&#39;d use select case, easier to read. See here: <a href=\"http://stackoverflow.com/questions/11640413/which-way-is-faster-if-elseif-or-select-case\" title=\"which way is faster if elseif or select case\">stackoverflow.com/questions/11640413/&hellip;</a>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467191368, "post_id": 38093869, "comment_id": 63625029, "body": "Select case is not always &quot;easier to read&quot;, neither is it &quot;neater&quot;. Depends on the actual code and what you are trying to achieve. The actual speed difference, if there is any at all, is insignificant between the two structures. Speed is determined by your program logic. Once you have the logic, chose the structure that makes it easier to write/read/understand the code."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467191454, "post_id": 38093869, "comment_id": 63625095, "body": "Anyway, if you add an example of what you are trying to do, it might be easier to discuss this - as there is no &quot;general answer&quot; to this question."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467191481, "post_id": 38093869, "comment_id": 63625108, "body": "Anyway, if you add an example of what you are trying to do, it might be easier to discuss this - as there is no &quot;general answer&quot; to this question."}, {"owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467193049, "post_id": 38093869, "comment_id": 63626253, "body": "@vacip, here is your example - hopefully this gives you a better idea!"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467196449, "post_id": 38093869, "comment_id": 63628541, "body": "Using <code>If</code> or <code>Select case</code> won&#39;t make an impact on the performance here.  Zero. Null. Read <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">this</a> to find out about finding the last row."}], "owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467193012, "creation_date": 1467187847, "last_edit_date": 1467193012, "question_id": 38093869, "link": "https://stackoverflow.com/questions/38093869/vba-what-is-faster-case-statements-or-if-statements", "title": "VBA - what is faster? Case statements or If Statements", "body": "<p>I am writing some code for a very large spreadsheet. Where certain things need to go in specific places, and I am wondering what sort of statement would be faster, and what are the pro's and con's of each statement.</p>\n\n<p>Here is my dilemma -</p>\n\n<p>There is a massive table, which could be ranging from column A to column CD, or some other column making it disgusting to look at in one go.</p>\n\n<p>I am trying to create a \"lastrow\" variable (Integer) to describe the bottom row of data.</p>\n\n<p>At the moment I have a very inefficient if loop, reading up from the bottom -\".Rows.Count)End.Up(xlUp).Row\", sort of thing<br>\n and it currently re-writes the lastrow variable if it is a larger number. I just want to find a quick and easy way to find the lowest row number.</p>\n\n<p>Is looping the way forward with this?</p>\n\n<p>Kind Regards,</p>\n\n<p>lewisthegruffalo</p>\n"}, {"tags": ["vba", "csv", "ms-access"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1467187642, "post_id": 38093709, "comment_id": 63622611, "body": "add <code>Debug.Print strSQL</code> before the <code>CurrentDB.Execute</code> and see if it is all right, has all the values etc."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467187675, "post_id": 38093709, "comment_id": 63622637, "body": "Have you missed a square bracket on DB name?"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467187812, "post_id": 38093709, "comment_id": 63622712, "body": "Debug.Print:  INSERT INTO Import ([Equipment],[Description],[User_status],[Functional_Locatio&zwnj;&#8203;n],[Functional_Locat&zwnj;&#8203;ion_Desc],[Cost_Cent&zwnj;&#8203;er],[Main_WorkCtr],[&zwnj;&#8203;Manufacturer],[Model&zwnj;&#8203;_Number],[Serial_Num&zwnj;&#8203;ber],[Plant_Section]&zwnj;&#8203;) SELECT Equipment,Description,User_status,Functional_Loc,Description&zwnj;&#8203;3,Cost_Center,Main_W&zwnj;&#8203;orkCtr,Manufacturer,&zwnj;&#8203;Model_number,ManufSe&zwnj;&#8203;rialNo,Plant_section FROM [Text;FMT=Delimited;HDR=YES;IMEX=2;CharacterSet=1252;DATABAS&zwnj;&#8203;E=G:\\GMH Emel\u0151g&#233;pek\\SAP script].[sap_adatok.csv]"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467188099, "post_id": 38093709, "comment_id": 63622899, "body": "Try adding single quotes around the filename. (I&#39;m just guessing here.): <code>&quot;;DATABASE=&#39;&quot; &amp; strFolder &amp; &quot;&#39;].[&quot;</code> so the result should be: &#39;DATABASE=G:\\GMH Emel\u0151g&#233;pek\\SAP script&#39;]"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467189138, "post_id": 38093709, "comment_id": 63623581, "body": "It doesn&#39;t really have problem locating the CSV file, if I have it open I&#39;d got a different error, saying that it needs read-write access. I tried it anyway got an error. (not a valid path)"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467189576, "post_id": 38093709, "comment_id": 63623872, "body": "I tried making a query to import the data also, but now I have a problem that access sets a few field to Number instead of Text (Serial Number) and I get !Num erorrs :\\.   SELECT vTbl.* FROM      (SELECT vCSV.*       FROM [Text;FMT=Delimited;HDR=YES;IMEX=2;CharacterSet=1252;DATABAS&zwnj;&#8203;E=G:\\GMH Emel\u0151g&#233;pek\\SAP script].[sap_adatok.csv] As vCSV) As vTbl"}], "answers": [{"comments": [{"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "edited": false, "score": 0, "creation_date": 1467293428, "post_id": 38097994, "comment_id": 63680370, "body": "In the end I exported from SAP to excel than imported that easily instead of csv. Even after I managed to import the data Access always messed up the serial numbers because it wanted to store it as numbers, instead of text.  Thanks for the help anyway!"}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1467198958, "creation_date": 1467198958, "answer_id": 38097994, "question_id": 38093709, "link": "https://stackoverflow.com/questions/38093709/too-few-parameters-expected-1-csv-import/38097994#38097994", "title": "Too few parameters. Expected 1 CSV Import", "body": "<p>I'm going to steal vacip's answer and expand on it.  I 100% agree with his suggestion:</p>\n\n<blockquote>\n  <p>add Debug.Print strSQL before the CurrentDB.Execute and see if it is\n  all right, has all the values etc.</p>\n</blockquote>\n\n<p>What I would suggest is then pasting the results of Debug.Print into an Access query wizard's SQL window.  Then try to run it.  Sometimes the errors are more obvious when Access runs them through a query builder.  Also, switch over to the Design view of this new query and see if there's anything out of whack.  Usually between those two views, I can figure out any issues my query is having.</p>\n"}], "owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467198958, "creation_date": 1467187365, "question_id": 38093709, "link": "https://stackoverflow.com/questions/38093709/too-few-parameters-expected-1-csv-import", "title": "Too few parameters. Expected 1 CSV Import", "body": "<p>I'm trying to import a CSV file to my Access database via VBA. And I'm getting this error: \"Run-time error: '3061': Too few parameters. Expected 1.\"</p>\n\n<p>I already tried adding single quotes, like the other threads suggested regarding this problem, but it didn't help. </p>\n\n<pre><code>    strSQL = \"INSERT INTO Import (\" &amp; _\n         \"[Equipment]\" &amp; _\n         \",[Description]\" &amp; _\n         \",[User_status]\" &amp; _\n         \",[Functional_Location]\" &amp; _\n         \",[Functional_Location_Desc]\" &amp; _\n         \",[Cost_Center]\" &amp; _\n         \",[Main_WorkCtr]\" &amp; _\n         \",[Manufacturer]\" &amp; _\n         \",[Model_Number]\" &amp; _\n         \",[Serial_Number]\" &amp; _\n         \",[Plant_Section])\" &amp; _\n         \" SELECT Equipment,Description,User_status\" &amp; _\n         \",Functional_Loc,Description3,Cost_Center,Main_WorkCtr\" &amp; _\n         \",Manufacturer,Model_number,ManufSerialNo,Plant_section\" &amp; _\n         \" FROM [Text\" &amp; _\n                \";FMT=Delimited\" &amp; _\n                \";HDR=YES\" &amp; _\n                \";IMEX=2\" &amp; _\n                \";CharacterSet=1252\" &amp; _\n                \";DATABASE=\" &amp; strFolder &amp; \"].[\" &amp; strFilename &amp; \"]\"\n\nCurrentDb.Execute strSQL\n</code></pre>\n\n<p>My CSV file's first line: Equipment,Description,User_status,Functional_Loc,Description3,Cost_Center,Main_WorkCtr,Manufacturer,Model_number,ManufSerialNo,Plant_section</p>\n\n<p><a href=\"http://i.stack.imgur.com/8vlYB.png\" rel=\"nofollow\">My Import Table</a></p>\n\n<p>Thanks for your help.</p>\n\n<p>Mark</p>\n"}, {"tags": ["vba", "sendkeys"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467187078, "post_id": 38093543, "comment_id": 63622246, "body": "Are you sure the appropriate <i>application</i> has the focus? Maybe you are sending the ENTER to Excel or the VBE. There must be a better way to &quot;hit&quot; a button."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467187748, "post_id": 38093543, "comment_id": 63622678, "body": "for IE integration, look at using HTML Library and internet Controls and use the correct actions, like .Click etc.  Also, rather than a timer, check the IE ready state and its busy property"}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467187999, "post_id": 38093543, "comment_id": 63622823, "body": "@vacip Yeah, In the debug mode the Focus is set on the desired field in the IE window..."}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467188071, "post_id": 38093543, "comment_id": 63622877, "body": "@Nathan_Sav : I&#39;ve included the readyState code before and after I  call the Sendkeys function.      <code>Do Until Not IE.Busy And IE.readyState = 4       DoEvents     Loop</code>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467188616, "post_id": 38093543, "comment_id": 63623227, "body": "I know the focus is set ont he proper field in the IE object, but is the IE object the program with focus in Windows? Sendkeys just presses enter."}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467188852, "post_id": 38093543, "comment_id": 63623376, "body": "@vacip: I am relatively new to Vba, can you please let me know how I can check that?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467190947, "post_id": 38093543, "comment_id": 63624757, "body": "You look at your monitor... :) Press enter on your keyboard. Which application &quot;gets&quot; it? For example: you have 2 applications running, one on the left side of the screen, the other on the right. Click on the left one, press enter - what happens in the right application? Exactly. Nothing.It is the same shit here. You run a macro from Excel, likely Excel is the active application, so it will get the enter. Use @Nathan_Sav&#39;s idea, it is safer and better. Sendkeys is not a good way to deal with things."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467190961, "post_id": 38093543, "comment_id": 63624761, "body": "Can you display the website?"}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1467275431, "post_id": 38093543, "comment_id": 63667926, "body": "@vacip : Okay,got it."}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467275503, "post_id": 38093543, "comment_id": 63667968, "body": "@Nathan_Sav : Yeah Nathan I am able to display the website.. I found a &#39;Filter&#39; button in the webpage and used the &#39;click&#39; function to get around this issue.."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467280487, "post_id": 38093543, "comment_id": 63671372, "body": "Howdy, I meant divulge the URL, if you&#39;re getting on ok though, all the best, and keep at it :)"}], "owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518872772, "creation_date": 1467186868, "question_id": 38093543, "link": "https://stackoverflow.com/questions/38093543/sendkeys-does-not-always-work-with-vba", "title": "Sendkeys does not always work with vba", "body": "<p>I have this problem where SendKeys works only at times. I am not able to figure when it works either. I tried using the following commands,</p>\n\n<pre><code>Application.SendKeys \"{ENTER}\", True\nApplication.SendKeys \"~\"\n</code></pre>\n\n<p>I have also tried adding a timer before as well as after the sendkey command. i tried changing True to False.. but nothing seems to work. </p>\n\n<pre><code>lbr = Sheet2.Range(\"a\" &amp; lb).Value\nIE.Document.getElementById(\"sample-1\").Value = lbr\nIE.Document.getElementById(\"sample-1\").Focus\n'Application.SendKeys \"~\"\n Application.SendKeys \"{ENTER}\", True\n'Application.SendKeys \"{ENTER}\"\n'Application.SendKeys \"{ENTER}\", False\n</code></pre>\n\n<p>Can someone please suggest a solution or an alternative. \nThank you.. </p>\n"}, {"tags": ["vba", "excel", "email"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1467187825, "creation_date": 1467187825, "answer_id": 38093868, "question_id": 38093394, "link": "https://stackoverflow.com/questions/38093394/vba-send-email-from-excel-depending-on-condition/38093868#38093868", "title": "VBA send email from excel (depending on condition)", "body": "<p>Since you are checking every row with the <code>Do...Loop</code> then you need to check the <code>if</code> inside that loop.  I've moved the increment to <code>s</code> outside the <code>If</code> so that it happens whether or not you create a mail item.  Otherwise you'd only change rows if there was a mail item to send, and that means you'd be stuck looping on a row where there was no \"x\".</p>\n\n<pre><code>Sub SendReminderMail() \n    Dim s As Long\n    Dim OutLookApp As Object\n    Dim OutLookMailItem As Object\n    Dim iCounter As Integer\n    Dim MailDest As String\n\n    If MsgBox(\"Are you sure?\", vbYesNo) = vbNo Then Exit Sub\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n\n    s = 12\n\n    Do Until Trim$(Cells(s, 1).Value) = \"\"\n      If Cells(s,6).Value = \"x\" Then\n          Set OutLookMailItem = OutLookApp.CreateItem(0)\n          With OutLookMailItem\n              .To = Cells(s, 5).Value\n              .Subject = \"Reminder: \" &amp; Cells(1, 7).Value\n              .Body = \"Text, \" &amp; vbCrLf &amp; vbCrLf &amp; \"Text'\" &amp; Cells(s, 2).Value \n              .Display\n          End With\n      End If\n      s = s + 1\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6527027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758d9f93a34fc878b6a7adba7b3927c4?s=128&d=identicon&r=PG&f=1", "display_name": "Miri", "link": "https://stackoverflow.com/users/6527027/miri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2605, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467194607, "creation_date": 1467186428, "last_edit_date": 1467187255, "question_id": 38093394, "link": "https://stackoverflow.com/questions/38093394/vba-send-email-from-excel-depending-on-condition", "title": "VBA send email from excel (depending on condition)", "body": "<p>I am an absolute beginner and try to facilitate a few tasks in my colleagues daily work. I want to create a code that sends reminder mails with information from an excel file. The idea is that Excel should check every relevant row from row 12 on and check if there is an \"x\" written in a column that marks for which row I would like to send a reminder.\nWith the code below I can generate all the emails, but I have difficulties where and how to include the check for if ('If Cells(s, 6).Value = \"x\" Then') so that that Excel continues through all the rows that are filled out.</p>\n\n<p>Many thanks for your help!</p>\n\n<pre> <code>\nSub SendReminderMail() \n  Dim s As Long\n  Dim OutLookApp As Object\n  Dim OutLookMailItem As Object\n  Dim iCounter As Integer\n  Dim MailDest As String\n\n  If MsgBox(\"Are you sure?\", vbYesNo) = vbNo Then Exit Sub\n\n  Set OutLookApp = CreateObject(\"Outlook.application\")\n  Set OutLookMailItem = OutLookApp.CreateItem(0)\n\n  s = 12\n\n  Do Until Trim$(Cells(s, 1).Value) = \"\"\n\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n    With OutLookMailItem\n      .To = Cells(s, 5).Value\n      .Subject = \"Reminder: \" & Cells(1, 7).Value\n      .Body = \"Text, \" & vbCrLf & vbCrLf & \"Text'\" & Cells(s, 2).Value \n      s = s + 1\n      .Display\n    End With\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button", "command"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1467186561, "post_id": 38093233, "comment_id": 63621955, "body": "Try <code>Columns(&quot;J:K&quot;).EntireColumn.Hidden = True</code>"}, {"owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1467186987, "post_id": 38093233, "comment_id": 63622192, "body": "@ShaiRado this works perfectly now i can believe that it was something so small and i cant believe i didn&#39;t see it myself . Thank you"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1467187480, "post_id": 38093233, "comment_id": 63622508, "body": "Since you are specifying entire columns with <code>J:K</code>, <code>Columns(&quot;J:K&quot;).Hidden = True</code> is sufficient"}], "owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467186310, "creation_date": 1467185965, "last_edit_date": 1531164843, "question_id": 38093233, "link": "https://stackoverflow.com/questions/38093233/hiding-coulms-using-a-command-button", "title": "Hiding coulms using a command button", "body": "<p>I am trying to hide 2 columns <strong>(\"J:K\")</strong> on the active <code>worksheet</code> using a command button. </p>\n\n<p>After the Columns are hidden the command button then saves the active worksheet <strong>(\"Network Services\")</strong> as a <code>PDF</code> to the desktop.</p>\n\n<p>Now the second part works fine but i can't seem the columns hide to work.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Private Sub CreatePDF_Click()\n\nColumns(\"J:K\").Select\nSelection.EntireColumn.Hidden = True\n\nDim oSHELL As Object, sDesktopPath As String\nSet oSHELL = CreateObject(\"WScript.Shell\")\nsDesktopPath = oSHELL.SpecialFolders(\"Desktop\")\nChDir sDesktopPath\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\nsDesktopPath &amp; \"\\\" &amp; Worksheets(\"Network Services\").Range(\"D5\").Value &amp;\n\"-\" &amp; Worksheets(\"Network Services\").Range(\"D7\").Value &amp; \".pdf\",Quality:=xlQualityStandard _ \nIncludeDocProperties:=True, \nIgnorePrintAreas:=False, OpenAfterPublish:= _\n True\nEnd Sub()\n</code></pre>\n\n<p>Any help how to get the columns to hide will be greatly appreciated.</p>\n"}, {"tags": ["vba", "formatting", "copy", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1467290864, "post_id": 38094405, "comment_id": 63678488, "body": "Thanks for your help! But I mean It&#39;s not paste as a picture. I want to write directly on the table on the slide after paste. But the shape was not paste on right position on the table. Please help!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1467189534, "creation_date": 1467189534, "answer_id": 38094405, "question_id": 38092686, "link": "https://stackoverflow.com/questions/38092686/copy-table-from-excel-sheet-to-powerpoint-vba-keeping-location-of-oval-shapes/38094405#38094405", "title": "Copy table from Excel sheet to PowerPoint VBA Keeping location of oval shapes", "body": "<p>Try replacing your lines :</p>\n\n<pre><code>iLastRowReport = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A1:J\" &amp; iLastRowReport).Copy\nDoEvents\nppapp.CommandBars.ExecuteMso (\"PasteExcelTableSourceFormatting\")\nWait 3\nWith ppapp.ActiveWindow.Selection.ShapeRange\n    .Width = 700\n    .Left = 10\n    .Top = 75\n    .ZOrder msoSendToBack\nEnd With\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>iLastRowReport = Range(\"B\" &amp; Rows.count).End(xlUp).row\nRange(\"A1:J\" &amp; iLastRowReport).Copy\n\nDim myTable                 As Object\n\n' change according to whatever slide numbe you need\nSet myTable = ppApp.ActivePresentation.Slides(1).Shapes.PasteSpecial(ppPasteMetafilePicture, msoFalse)\n' Set Shape / Table properties:\nmyTable.Width = 700\nmyTable.Left = 10\nmyTable.Top = 75\nmyTable.ZOrder msoSendToBack\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1479744309, "creation_date": 1467184230, "last_edit_date": 1479744309, "question_id": 38092686, "link": "https://stackoverflow.com/questions/38092686/copy-table-from-excel-sheet-to-powerpoint-vba-keeping-location-of-oval-shapes", "title": "Copy table from Excel sheet to PowerPoint VBA Keeping location of oval shapes", "body": "<p>I'm trying to copy and paste a table from an Excel Sheet into a PowerPoint slide using VBA keeping its source formatting and keeping the location of shapes. <img src=\"https://i.stack.imgur.com/LzsmX.png\" alt=\"Snapshot1\"> Everything seems to work fine except the oval shape placed on the table after paste was not in right location <img src=\"https://i.stack.imgur.com/LzsmX.png\" alt=\"Snapshot1\">. Please help</p>\n\n<pre><code>Sub CreatePP()\n    Dim ppapp As PowerPoint.Application\n    Dim ppPres As PowerPoint.Presentation\n    Dim ppSlide As PowerPoint.Slide\n    Dim ppTextBox As PowerPoint.Shape\n    Dim iLastRowReport As Integer\n    Dim sh As Object\n    Dim templatePath As String\n\n        On Error Resume Next\n        Set ppapp = GetObject(, \"PowerPoint.Application\")\n        On Error GoTo 0\n\n    'Let's create a new PowerPoint\n        If ppapp Is Nothing Then\n            Set ppapp = New PowerPoint.Application\n        End If\n    'Make a presentation in PowerPoint\n        If ppapp.Presentations.Count = 0 Then\n           Set ppPres = ppapp.Presentations.Add\n           ppPres.ApplyTemplate \"C:\\Users\\luunt1\\AppData\\Roaming\\Microsoft\\Templates\\Document Themes\\themevpb.thmx\"\n        End If\n\n    'Show the PowerPoint\n        ppapp.Visible = True\n\n         For Each sh In ThisWorkbook.Sheets\n         If sh.Name Like \"E_KRI\" Then\n            ppapp.ActivePresentation.Slides.Add ppapp.ActivePresentation.Slides.Count + 1, ppLayoutBlank\n            ppapp.ActiveWindow.View.GotoSlide ppapp.ActivePresentation.Slides.Count\n            Set ppSlide = ppapp.ActivePresentation.Slides(ppapp.ActivePresentation.Slides.Count)\n            ppSlide.Select\n\n\n            iLastRowReport = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            Range(\"A1:J\" &amp; iLastRowReport).Copy\n            DoEvents\n            ppapp.CommandBars.ExecuteMso (\"PasteExcelTableSourceFormatting\")\n            Wait 3\n            With ppapp.ActiveWindow.Selection.ShapeRange\n              .Width = 700\n              .Left = 10\n              .Top = 75\n              .ZOrder msoSendToBack\n            End With\n            Selection.Font.Size = 12\n          'On Error GoTo NoFileSelected\n            AppActivate (\"Microsoft PowerPoint\")\n            Set ppSlide = Nothing\n            Set ppapp = Nothing\n    End If\n    Next   \nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "find", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6526966, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210124416492646/picture?type=large", "display_name": "Herni", "link": "https://stackoverflow.com/users/6526966/herni"}, "edited": false, "score": 0, "creation_date": 1467357397, "post_id": 38096796, "comment_id": 63708795, "body": "Glad that I could help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467195686, "creation_date": 1467195686, "answer_id": 38096796, "question_id": 38092548, "link": "https://stackoverflow.com/questions/38092548/use-multiple-search-string-to-find-if-value-exists/38096796#38096796", "title": "use multiple search string to find if value exists?", "body": "<p>You could just apply the filter than clear it if it had no effect.</p>\n\n<pre><code>Sub ClearAutoFilterIfNoEffect()\n\n    Dim countVisibleRows1 As Long\n    Dim countVisibleRows2 As Long\n    Dim r As Range\n\n    countVisibleRows1 = WorksheetFunction.Subtotal(103, Range(\"$A$1:$N$\" &amp; i))\n\n    Range(\"$A$1:$N$\" &amp; i).AutoFilter Field:=14, Criteria1:=Array(\"String1\", \"string2\", \"string3\"), Operator:=xlFilterValues\n\n    countVisibleRows2 = WorksheetFunction.Subtotal(103, Range(\"$A$1:$N$\" &amp; i))\n\n    If countVisibleRows2 = countVisibleRows1 Then\n        If ActiveSheet.AutoFilterMode Then Cells.AutoFilter\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Otherwise you'll have to check each condition</p>\n\n<pre><code>Sub CheckAllConditionsBeforeApplyingFilter()\n\n    With Range(\"$A$1:$N$\" &amp; i)\n        If .Cells.Find(what:=\"string1\", LookIn:=xlFormulas, lookat:=xlWhole) Is Nothing Then\n            If .Cells.Find(what:=\"string2\", LookIn:=xlFormulas, lookat:=xlWhole) Is Nothing Then\n                If .Cells.Find(what:=\"string1\", LookIn:=xlFormulas, lookat:=xlWhole) Is Nothing Then\n                    'Clear the filter if it exists\n                    If ActiveSheet.AutoFilterMode Then Cells.AutoFilter\n                    Exit Sub\n                Else\n\n                    .AutoFilter Field:=14, Criteria1:=Array(\"String1\", \"string2\", \"string3\"), Operator:=xlFilterValues\n\n                End If\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6526966, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210124416492646/picture?type=large", "display_name": "Herni", "link": "https://stackoverflow.com/users/6526966/herni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467195686, "creation_date": 1467183804, "last_edit_date": 1531164843, "question_id": 38092548, "link": "https://stackoverflow.com/questions/38092548/use-multiple-search-string-to-find-if-value-exists", "title": "use multiple search string to find if value exists?", "body": "<p>I'm trying to go through my excel and find if one of the values found from column, but  can't figure out how it can be done. My goal is to find if any of the filter options exist and if not then do nothing, else go forward with my code. Please can anyone advice on this.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$N$\" &amp; i).AutoFilter Field:=14, Criteria1:=Array( _\n   \"String1\", \"string2\", \"string3\"), _\n   Operator:=xlFilterValues\n\n\nSet FoundRange = Range(\"$N$1:$N$\" &amp; i).Cells.Find(what:=\"string1\", LookIn:=xlFormulas, lookat:=xlWhole)\n\nIf FoundRange Is Nothing Then\n    Cells.AutoFilter\n    Exit Sub\n\nElse\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 1, "creation_date": 1467185309, "post_id": 38092286, "comment_id": 63621159, "body": "Hi Tharun, welcome to SO. It is difficult to understand what you&#39;re trying to do. Could you edit and be more accurate? Do you mean you want to group the records by same <code>version</code> column?"}, {"owner": {"reputation": 17, "user_id": 5916792, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-Un2KfJz04XE/AAAAAAAAAAI/AAAAAAAAAEA/Rrpoqf2rGcA/photo.jpg?sz=128", "display_name": "tharun thamaiah", "link": "https://stackoverflow.com/users/5916792/tharun-thamaiah"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1467185847, "post_id": 38092286, "comment_id": 63621510, "body": "I want to replace the type when count of version is more then 1 and description reads&quot;Upgrade kit&quot; i want to change the type value same as other example: first four lines have same version numbers but type has changed when upgrade kit is the description.same way version number &quot;165739&quot; has three lines but type has change when decription reads as &quot;upgrade kit&quot;, in that instance i want to consider the type from other lines"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1467186435, "post_id": 38092286, "comment_id": 63621871, "body": "Sorry, this must be me who cannot understand this logic. Are you able to write an algorithm down for this? If so, kindly edit your <b>original question*</b> with it."}], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": true, "score": 0, "last_activity_date": 1467194841, "creation_date": 1467194841, "answer_id": 38096476, "question_id": 38092286, "link": "https://stackoverflow.com/questions/38092286/update-type-in-excel/38096476#38096476", "title": "Update Type in excel", "body": "<p>If I understood well your problem, this should do the trick.</p>\n\n<p>I go through all 'description', when it finds \"Upgrade Kit\", it then looks for the same version number and change the type accordingly.</p>\n\n<pre><code>Sub ChangeVersion()\n\nDim rCell As Range\nDim i As Integer\n\nDim LastRow As Long\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nDim DescriptRng As Range\nSet DescriptRng = Range(Cells(2, 1), Cells(Rows.Count, 1).End(xlUp))\n\n    For Each rCell In DescriptRng\n\n        If rCell = \"1-Upgrade Kit\" Then\n            For i = 2 To LastRow\n                If Cells(i, 2) = Cells(rCell.Row, 2) And Cells(i, 1) &lt;&gt; \"1-Upgrade Kit\" Then\n                Cells(rCell.Row, 3) = Cells(i, 3)\n                End If\n            Next i\n        End If\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>Tell me if it's fine for you.</p>\n"}], "owner": {"reputation": 17, "user_id": 5916792, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-Un2KfJz04XE/AAAAAAAAAAI/AAAAAAAAAEA/Rrpoqf2rGcA/photo.jpg?sz=128", "display_name": "tharun thamaiah", "link": "https://stackoverflow.com/users/5916792/tharun-thamaiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 38096476, "answer_count": 1, "score": -1, "last_activity_date": 1467194841, "creation_date": 1467183001, "last_edit_date": 1467183198, "question_id": 38092286, "link": "https://stackoverflow.com/questions/38092286/update-type-in-excel", "title": "Update Type in excel", "body": "<p>Need assistance to on the below query in excel, This is the senarior </p>\n\n<pre><code>description             version   type    Expected output\n1-Upgrade Kit            165737    A                  B\n7668A CPU UPGRADE        165737    B                  B\nASSY,PCB,P2MB,VME,       165737    B                  B\nUPGRADE,EPROM            165737    B                  B\nKIT,7668A CPU UPGRADE     165738    B                 B\n1-Upgrade Kit             165738    A                 B\n1-Upgrade Kit            165739     A                 C\nKIT,7668A CPU UPGRADE     165739    C                 C\nKIT,7668A CPU UPGRADE    165739     C                 C\n</code></pre>\n\n<p>as you see the version number to be same for first four lines,but the type has change when the description has string \"upgrade kit\".can we fetch type from other lines when we have same version and description as \"upgrade kit\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1467181859, "post_id": 38091790, "comment_id": 63619164, "body": "You mean, you want to refer to the sheet? What about <code>Dim wsh As Worksheet: Set wsh = ThisWorkbook.Worksheets(1)</code> or <code>Set wsh = ThisWorkbook.Worksheets(&quot;Tabelle1&quot;)</code>?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1467182099, "post_id": 38091790, "comment_id": 63619271, "body": "I&#39;d suggest to read <a href=\"http://www.ozgrid.com/VBA/excel-vba-sheet-names.htm\" rel=\"nofollow noreferrer\">this article</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1467183906, "post_id": 38091790, "comment_id": 63620290, "body": "As much as I believe in <a href=\"http://meta.stackoverflow.com/questions/285551/why-may-i-not-upload-images-of-code-on-so-when-asking-a-question/285557#285557\">this</a> I perfectly understand that this is a situation when a visual representation is more informative than a narrative (e.g. <i>typed</i>) one. Plus one."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1467196838, "post_id": 38091790, "comment_id": 63628804, "body": "@Maciej Los: The article is interesting but the issue is that once I change the german phrase &quot;Tabelle1&quot; to &quot;Sheet1&quot; as suggested in the article I get the runtime error 424."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1467183462, "post_id": 38091989, "comment_id": 63620032, "body": "Good catch. Renaming to a non-standard should be more than sufficient. Not having a DE-DE version at my disposal, I still expect you are correct."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1467197291, "post_id": 38091989, "comment_id": 63629086, "body": "Hi Fratyx, thanks for your answer. I have found the property window but I could not find which property I have to change to solve my issue. Where can I rename it to a non-standard as jeeped suggested?"}, {"owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1467198015, "post_id": 38091989, "comment_id": 63629555, "body": "There is a <code>(Name)</code> property (with brackets) on the top of the list which represents the code name of the worksheet. The <code>Name</code> property without brackets is the user visible name."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1467199562, "post_id": 38091989, "comment_id": 63630557, "body": "Now I understand your solution. It is a nice idea. The only issue I can see is that if I have many end-users from different countries it might be difficult since I would have to change the property in every different language. Except Excel knows how to convert it in another language. I will have to test it."}], "tags": [], "owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "is_accepted": false, "score": 2, "last_activity_date": 1467182101, "creation_date": 1467182101, "answer_id": 38091989, "question_id": 38091790, "link": "https://stackoverflow.com/questions/38091790/international-internal-sheet-name/38091989#38091989", "title": "International internal sheet name", "body": "<p>You can change both the name displayed in Excel and the name used as code name in the property window (\"Eigenschaftenfenster\" in German). </p>\n\n<p>You can open this window via the View menu or (probably) pressing F4. </p>\n\n<p>There you can inspect and change the properties of the worksheet.</p>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1467193987, "creation_date": 1467181359, "last_edit_date": 1467193987, "question_id": 38091790, "link": "https://stackoverflow.com/questions/38091790/international-internal-sheet-name", "title": "International internal sheet name", "body": "<p>I have the following simple VBA code using a German Excel version:</p>\n\n<pre><code>Sub German()\nTabelle1.Range(\"A1\").Value = 1\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kfqyl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kfqyl.png\" alt=\"Screenshot of Excel showing Tabelle1, Tabelle2, and Tabelle3\"></a></p>\n\n<p>In this VBA code I am referring to the internal sheet name \"Tabelle1\" which you can also see in the red circle on the attached image.</p>\n\n<p>Now I want to internationalize my code so it can be used in every language.\nHow do I have to change my code to make the internal sheet name international?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1467180908, "post_id": 38091604, "comment_id": 63618707, "body": "fwiw, I&#39;ve found that using field codes on user defined vars in word works when the [excel-vba] crosses over to word and redefines those specific field code vars. It&#39;s like a home-built mail merge. If you have trouble getting that working I will look up the code to write to a word template."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1467182540, "post_id": 38092090, "comment_id": 63619511, "body": "Also, don&#39;t use <code>Select</code>.  <a href=\"http://stackoverflow.com/q/10714251/445425\">See this Q for help on this</a>"}, {"owner": {"reputation": 1, "user_id": 6447455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c3897c8b8697781e6b034ca217a47?s=128&d=identicon&r=PG&f=1", "display_name": "user6447455", "link": "https://stackoverflow.com/users/6447455/user6447455"}, "edited": false, "score": 0, "creation_date": 1467511186, "post_id": 38092090, "comment_id": 63759870, "body": "Thanks everyone for the feedback... Chris with you solution I got the code to work... Cheers"}, {"owner": {"reputation": 1, "user_id": 6447455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c3897c8b8697781e6b034ca217a47?s=128&d=identicon&r=PG&f=1", "display_name": "user6447455", "link": "https://stackoverflow.com/users/6447455/user6447455"}, "edited": false, "score": 0, "creation_date": 1468238780, "post_id": 38092090, "comment_id": 64029405, "body": "The solution above is working great. I have one more question that is related. I have a very similar sub that I want to run after the one with the titles, to paste the body of the tables into the same word template, which has already been open by the sub above... If I just use myDoc = ActiveDocument it works fine if I run the sub separately after the one above... BUT as soon as I link the two subs together I get a run time error &#39;462&#39;... how do I solve for this?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": -1, "last_activity_date": 1467182398, "creation_date": 1467182398, "answer_id": 38092090, "question_id": 38091604, "link": "https://stackoverflow.com/questions/38091604/loop-copy-pasting-data-in-namedcells-from-excel-into-word/38092090#38092090", "title": "Loop Copy/pasting data in NamedCells from excel into Word", "body": "<p><code>BookmarkArray</code> will be a <code>0</code> based array (0..2) - see Excel help on the <code>Array</code> function.</p>\n\n<p>I suggest you change</p>\n\n<pre><code>Dim Title(1 To 3) As Range\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim Title(0 To 2) As Range\n</code></pre>\n\n<p>and change the hard coded indexes accordingly.</p>\n"}], "owner": {"reputation": 1, "user_id": 6447455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c3897c8b8697781e6b034ca217a47?s=128&d=identicon&r=PG&f=1", "display_name": "user6447455", "link": "https://stackoverflow.com/users/6447455/user6447455"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467199306, "creation_date": 1467180610, "last_edit_date": 1467199306, "question_id": 38091604, "link": "https://stackoverflow.com/questions/38091604/loop-copy-pasting-data-in-namedcells-from-excel-into-word", "title": "Loop Copy/pasting data in NamedCells from excel into Word", "body": "<p>I am working on Macro that copies data from NamedCells in Excel and places them at specific Bookmarks in a Word template. I am getting a run time error 9 when the code gets to the pasting data at Bookmarks line. Further, some of the data is getting pasted into the template but \"Title1\" is getting pasted at BookmarkTitle2 location and Title2 is getting pasted at BookmarkTitle3... then the run time error comes up...</p>\n\n<p>Code is below....</p>\n\n<p>Can someone tell me what I am doing wrong?</p>\n\n<pre><code>Sub CopyExcelTitlesToWord()\n\n    Dim WordApp As Word.Application\n    Dim myDoc As Word.Document\n    Dim WordTable As Word.Table\n    Dim BookmarkArray As Variant\n    Dim Title(1 To 3) As Range\n    Dim x As Integer\n\n'List the tables/charts from excel you want to Word\n     Set Title(1) = ThisWorkbook.Worksheets(\"TopPage\").Range(\"Title1\")\n     Set Title(2) = ThisWorkbook.Worksheets(\"TopPage\").Range(\"Title2\")\n     Set Title(3) = ThisWorkbook.Worksheets(\"TopPage\").Range(\"Title3\")\n\n\n'List of corresponding Word Bookmarks to paste the tables/charts to in Word\n     BookmarkArray = Array(\"BookmarkTitle1\", \"BookmarkTitle2\", \"BookmarkTitle3\")\n\n'Optimize Code\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n'Open Word template\n     Set WordApp = CreateObject(\"Word.Application\")\n     WordApp.Visible = True\n\n'Open existing template in Word\n    Set myDoc = WordApp.Documents.Open(\"C:\\Users\\xxx\\Desktop\\TemplateTest1.docx\")\n\n'Loop Through and Copy/Paste Multiple Excel NamedCells\n    For x = LBound(Title) To UBound(Title)\n    Title(x).Select\n    Selection.Copy\n     'Paste Title into MS Word (using inserted Bookmarks -&gt; ctrl+shift+F5). 'Name the Bookmarks so they are in Series so they are easy to loop through.\n    myDoc.Bookmarks(BookmarkArray(x)).Range.PasteExcelTable False, False, True\n    Next x\n         'Optimize Code\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n'Clear The Clipboard\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "sorting", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1467316523, "post_id": 38090748, "comment_id": 63695428, "body": "Good Answer. Helps partially. Unfortunately the sorting does not work at all that way. Basically i want to sort the Table in a customized way by a connected field from another table without using anything else then tables. Anyone got an idea how to do that?"}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1467318983, "post_id": 38090748, "comment_id": 63696805, "body": "What is value of <code>fldSort</code>? I think its not a valid sort string."}, {"owner": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1467320317, "post_id": 38090748, "comment_id": 63697463, "body": "the value is a number (double). What i&#39;m trying to do at the moment is to instead add a field to the tables and fill it in the form with an update query and then to sort the table with the now entered value. i guess that will actually work. however, now i have some trouble with the update query."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1467320443, "post_id": 38090748, "comment_id": 63697526, "body": "It has to be the name of the field you want to sort."}, {"owner": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1467321601, "post_id": 38090748, "comment_id": 63698023, "body": "well. it finally works by inserting the field into the table and put it right in front. then it will sort find. a bit of a hammer-solution, but it works. thanks anyway."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "edited": false, "score": 0, "creation_date": 1497500096, "post_id": 38090748, "comment_id": 76106625, "body": "Not a good solution, look at my updated answer and create a query. I am not sure about the field ID. Is it the name of the control bound to UNummer? Then replace ID with UNummer in Code."}], "tags": [], "owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "is_accepted": false, "score": 2, "last_activity_date": 1497532046, "last_edit_date": 1497532046, "creation_date": 1467176420, "answer_id": 38090748, "question_id": 38089402, "link": "https://stackoverflow.com/questions/38089402/sorting-data-on-form-in-access-2010-by-vba/38090748#38090748", "title": "Sorting Data on Form in Access 2010 by VBA", "body": "<p>Why not ask the wide world watch \"Why Access asking me for Parameter\"? That would have brought you to the clue I think. <code>Debug.Print</code> or  <code>MsgBox</code> your <code>.OrderBy</code> and you see it's \"fldSort\", not a valid sort. Access is assuming you want to use a parameter called <code>fldSort</code>, but you want the string in the variable <code>fldSort</code>, but it's not recognized, because of the double quotes surrounding it. Everything between 2 double quotes is interpreted as a string, even it's a var name.</p>\n\n<p>Delete the quotes and everything will work fine (if your sort string is sufficent)!</p>\n\n<pre><code> Form_Monatsblatt.OrderBy = fldSort\n</code></pre>\n\n<p>[Update]\nLate, but now I see the clue. You added a calculated field to the form, but you can't sort or filter them.\nInstead of appending this field to the table, create a query and add it there, then you bind the form to the query and add the field to the form. Now you can filter and sort as you like!\nThe query looks like this:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *,\n    Dlookup(\"Sortierung\",\"Mitarbeiter\",\"UNummer = '\" &amp; [ID] &amp; \"'\") AS ldSort\nFROM Mo01;\n</code></pre>\n\n<p>Or with a join:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n  Mo01.*, \n  Mitarbeiter.Sortierung AS fldSort\nFROM \n  Mo01 \nLEFT JOIN \n  Mitarbeiter \nON \n  Mo01.ID = Mitarbeiter.UNummer;\n</code></pre>\n\n<p>Now you can use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Form_Monatsblatt.OrderBy = \"fldSort\"\nForm_Monatsblatt.OrderByOn = True\n</code></pre>\n\n<p>because you have a bound control called <code>fldSort</code>.</p>\n\n<p>[/Update]   </p>\n"}], "owner": {"reputation": 23, "user_id": 5938419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102263663159011/picture?type=large", "display_name": "Ren&#233; Blaser", "link": "https://stackoverflow.com/users/5938419/ren%c3%a9-blaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1608903690, "creation_date": 1467167675, "last_edit_date": 1608903690, "question_id": 38089402, "link": "https://stackoverflow.com/questions/38089402/sorting-data-on-form-in-access-2010-by-vba", "title": "Sorting Data on Form in Access 2010 by VBA", "body": "<p>I have the following setup:</p>\n<p>Table &quot;Mitarbeiter&quot; (Users) with fields: &quot;UNummer&quot; / &quot;Sortierung&quot; /....</p>\n<p>Table &quot;Mo01&quot; (a sheet for every month) with fields: &quot;UNummer&quot; / &quot;01&quot; / &quot;02&quot; / ....</p>\n<p>The Field UNummer in Table Mo01 is a combination field that gets Mitarbeiter.UNummer and saves it as text</p>\n<p>I call a Form &quot;Monatsblatt&quot; that is based on the table Mo01.</p>\n<p>In that Form I have a Field &quot;fldSort&quot; that is calling &quot;Sortierung&quot; from table &quot;Mitarbeiter&quot;. The Data in that field is based on &quot;=DomWert(&quot;Sortierung&quot;;&quot;Mitarbeiter&quot;;&quot;UNummer = '&quot; &amp; [ID] &amp; &quot;'&quot;)&quot;</p>\n<p>This works and looks like this:<br />\n<a href=\"https://i.stack.imgur.com/H8F6q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H8F6q.jpg\" alt=\"Image of the Form\" /></a></p>\n<p>I am trying to sort the form by that &quot;fldSort&quot; in Form &quot;Monatsblatt&quot; by using this code:</p>\n<pre><code>Form_Monatsblatt.OrderBy = &quot;fldSort&quot;\nForm_Monatsblatt.OrderByOn = True\n</code></pre>\n<p>When I start the form with that code running, Access asks for parameters:<br />\n<a href=\"https://i.stack.imgur.com/3MKp9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3MKp9.jpg\" alt=\"Access asking for Parameter \" /></a></p>\n<p>I tried a lot of different ways of writing the code, referencing to the field in different ways. I do NOT want to base the form on anything other then the table.</p>\n"}, {"tags": ["excel", "vba", "gal"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1467173521, "post_id": 38088841, "comment_id": 63616033, "body": "If you&#39;re having problem with existing code, it&#39;s best to post it, along with the exact error and the line it occurs on."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1467188292, "post_id": 38091623, "comment_id": 63623031, "body": "hi. thanks for the response. i can&#39;t see in the code where i can throw the textbox1.text (the search value for the alias) around.  do declare olmem = textbox1.text?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1467190872, "post_id": 38091623, "comment_id": 63624714, "body": "@wh3resmycar2 What I provided is a <code>function</code>. It is stand alone. Include it in the <code>UserForm</code> code and then call it in any of your events (e.g <code>CommandButton1_Click()</code> )"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1467181740, "last_edit_date": 1467181740, "creation_date": 1467180673, "answer_id": 38091623, "question_id": 38088841, "link": "https://stackoverflow.com/questions/38088841/excel-vba-return-gal-value/38091623#38091623", "title": "Excel VBA, return GAL value", "body": "<p>This will give you what you want.</p>\n\n<pre><code>Private Function GetFullName(inAlias As String) As String\n    Dim olApp As Outlook.Application\n    Dim olNS As Outlook.Namespace\n    Dim olAdd As Outlook.AddressEntries\n    Dim olMem As Outlook.AddressEntry\n    Dim olLst As Outlook.AddressList\n    Dim olAlias As String\n\n    On Error Resume Next\n    Set olApp = New Outlook.Application\n    On Error GoTo 0\n\n    If olApp Is Nothing Then\n        GetFullName = \"Source not available\"\n        Exit Function\n    End If\n\n    Set olNS = olApp.GetNamespace(\"MAPI\")\n    Set olLst = olNS.GetGlobalAddressList\n    Set olAdd = olLst.AddressEntries\n\n    For Each olMem In olAdd\n        On Error Resume Next\n        olAlias = olMem.GetExchangeUser.Alias\n        On Error GoTo 0\n        If olAlias = inAlias Then\n            GetFullName = olMem.GetExchangeUser.Name\n            Exit For\n        Else\n            GetFullName = \"Invalid Alias\"\n        End If\n    Next\n    Set olApp = Nothing: Set olNS = Nothing: Set olAdd = Nothing\nEnd Function\n</code></pre>\n\n<p>The draw back is this may take a while if your GAL is quite large.<br>\nI'll check if I can dump the list to an array first and then manipulate from there.<br>\nOr if there is another way to get to the name via alias using other method.<bR>\nBut for now, try learning from this first.</p>\n\n<p>This is a function, so to get it to your textbox, you can simply:</p>\n\n<pre><code>TextBox2 = GetFullname(TextBox1)\n</code></pre>\n\n<p><strong>Note:</strong><bR>\nI intentionally declared all the objects, you need to know what type of object you're working on. Also I used <em>On Error Resume Next</em> because there are <code>AddressEntry</code> without <code>Alias</code> and that gives error. That's the easiest work around I can think of for now.</p>\n\n<p><strong>Requirement:</strong><br>\nYou need to reference <code>Microsoft Outlook xx.x Object Library</code>.<br>\n<code>xx.x</code> vary depending on the Outlook version installed in your machine.</p>\n"}], "owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467181740, "creation_date": 1467163712, "question_id": 38088841, "link": "https://stackoverflow.com/questions/38088841/excel-vba-return-gal-value", "title": "Excel VBA, return GAL value", "body": "<p>i have a very simple small app in mind which will help me save time from alt tabbing from excel to outlook. i want to create a small userform that will have a textbox for a exchange user alias and return the exchange user's full name. now the issue i have here is that the guide in msdn is a little vague for a userform: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869721.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff869721.aspx</a> and i'm getting some error messages, some got fixed by activating some references. and the code is quite complicated.</p>\n\n<p><strong>so basically i have 2 textboxes and a button. textbox1 will accept the alias, textbox2 will return the username after clicking the button.</strong></p>\n\n<p>there are several examples but most of them will result in dumping the GAL to an excel file which i don't need.</p>\n\n<p>thanks in advanced</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1467167670, "post_id": 38088645, "comment_id": 63614693, "body": "What is the error? What is not working? Which part of the code do you have issue with? The <code>rs.FindFirst</code> / <code>rs.NoMatch</code> part?"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1467231100, "creation_date": 1467231100, "answer_id": 38109208, "question_id": 38088645, "link": "https://stackoverflow.com/questions/38088645/ms-access-vba-textbox-search-and-submit/38109208#38109208", "title": "MS Access VBA textbox search and submit", "body": "<p>Consider using <code>DLookUp</code> or <code>DCount</code> of the <a href=\"http://www.techonthenet.com/access/functions/domain/dlookup.php\" rel=\"nofollow\">Domain aggregate family of functions</a> to do the lookup. No need to open a recordset. Hence, change the <code>If</code> logic of conditional to use <code>DLookup</code>. Below <code>Nz()</code> is used in case a null answer is returned.</p>\n\n<pre><code>If Nz(DLookUp(\"ProductCode\", \"tblProducts\", \"ProductCode='\" &amp; Me![txtScan] &amp; \"'\")) = \"\" Then\n    MsgBox \"Sorry, no such record '\" &amp; txtScan &amp; \"' was found.\", _\n           vbOKOnly + vbInformation\nElse\n...\n</code></pre>\n\n<p>Alternatively, with <code>DCount</code>:</p>\n\n<pre><code>If Nz(DCount(\"*\", \"tblProducts\", \"ProductCode='\" &amp; Me![txtScan] &amp; \"'\")) = 0 Then\n    MsgBox \"Sorry, no such record '\" &amp; txtScan &amp; \"' was found.\", _\n           vbOKOnly + vbInformation\nElse\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6525983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b164b3b88e50992366787c04d9d734e7?s=128&d=identicon&r=PG&f=1", "display_name": "ncguy", "link": "https://stackoverflow.com/users/6525983/ncguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467231100, "creation_date": 1467162095, "question_id": 38088645, "link": "https://stackoverflow.com/questions/38088645/ms-access-vba-textbox-search-and-submit", "title": "MS Access VBA textbox search and submit", "body": "<p>I am working on a point of sale program. I have a form with tabs, the main tab is my register part. Right now I have a dependent dropdown box that searches for the product off another table that has all my products listed and after I click add product it automatically adds it to the subform for calculation. I am trying to add a barcode scanner option to this process. I have a textbox that that scanner will submit the product code on it and add it to the subform, just like the dropdowns I have. I having problems looking up the product code on the other table to add it to the subform for calculations. Below is my code</p>\n\n<pre><code>Private Sub txtscan_AfterUpdate()\nIf (txtScan &amp; vbNullString) = vbNullString Then Exit Sub\nDim rst As DAO.Recordset\nSet rst = CurrentDb.OpenRecordset(\"tblProducts\", dbOpenDynaset)\nrst.FindFirst \"[ProductCode]='\" &amp; Me![txtScan] &amp; \"'\"\nIf rst.NoMatch Then\n    MsgBox \"Sorry, no such record '\" &amp; txtScan &amp; \"' was found.\", _\n           vbOKOnly + vbInformation\nElse\nDoCmd.RunCommand acCmdSaveRecord\nMe.sfrmSalesDetail.Form.Requery\nSet rst = CurrentDb.OpenRecordset(\"tblSalesDetail\", dbOpenDynaset)\nForms!frmMain.sfrmSalesDetail.Form.txtProductName.SetFocus\nMe.cmdAddProduct.SetFocus\nWith rst\n    .AddNew\n    .Fields(\"SaleID\") = Me.txtSaleID\n    .Fields(\"ProdCategoryID\") = Me.cboProductCategory\n    .Fields(\"ProductID\") = Me.cboProductID\n    .Fields(\"ProductCode\") = Me.cboProductID.Column(1)\n    .Fields(\"ProductDesc\") = Me.cboProductID.Column(2)\n    .Fields(\"ProdColor\") = Me.cboProductID.Column(3)\n    .Fields(\"ProdSize\") = Me.cboProductID.Column(4)\n    .Fields(\"UPC\") = Me.cboProductID.Column(5)\n    .Fields(\"SalesPrice\") = Me.cboProductID.Column(6)\n    .Fields(\"QuantitySold\") = 1\n    .Fields(\"ItemExt\") = 1 * Me.cboProductID.Column(6)\n    .Fields(\"ItemTotal\") = 1 * Me.cboProductID.Column(6)\n    .Update\nEnd With\n\nMe.sfrmSalesDetail.Form.Requery\nrst.Close\nSet rst = Nothing\n\nMe.sfrmItemsSaleAmount_NonInsurance.Requery\ncmdCalculateOrderTotal_Click\nDoCmd.RunCommand acCmdSaveRecord\n</code></pre>\n\n<p>'        Me.Recordset.Bookmark = rs.Bookmark\n    End If\n    rst.Close\n    txtScan = Null\nEnd Sub</p>\n"}, {"tags": ["database", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1467167585, "creation_date": 1467167585, "answer_id": 38089389, "question_id": 38088579, "link": "https://stackoverflow.com/questions/38088579/vba-from-excel-to-access/38089389#38089389", "title": "Vba from excel to access", "body": "<p>Just create a query with those 4 fields and export the query.  :)</p>\n\n<p>As for the dupes, just turn on the Macro recorder and click the Data tab then click 'Remove Duplicates'.  That will give you the VBA code that you need.  Or, if you want to handle the dupes, you can do that in Access before you do the export.  In Access click Create > Query Wizard > Find Duplicates Query Wizard.  Find the duplicates and eliminate them.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467167679, "creation_date": 1467167679, "answer_id": 38089403, "question_id": 38088579, "link": "https://stackoverflow.com/questions/38088579/vba-from-excel-to-access/38089403#38089403", "title": "Vba from excel to access", "body": "<p>You can accomplish this with MS Access without the VBA.<br>\nIn Access you'll need to <a href=\"https://www.youtube.com/watch?v=pezedEvncn0\" rel=\"nofollow\">Link an Access table to your Excel datasource</a>. Next you'll need to create an <a href=\"https://www.youtube.com/watch?v=34DRYYxEbkA\" rel=\"nofollow\">Append Query</a> to append the records in the Linked Excel table to the target Access table.  You should set the criteria of the append query to select the records of the Linked Excel table that are not in the target table.<br>\nIf you can't manage to setup the criteria then append all the records and <a href=\"https://www.youtube.com/watch?v=amRbEhQWH78\" rel=\"nofollow\">Delete the Duplicate records</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1467167679, "creation_date": 1467161601, "question_id": 38088579, "link": "https://stackoverflow.com/questions/38088579/vba-from-excel-to-access", "title": "Vba from excel to access", "body": "<p>I am quite new to coding and I was given this project that is beyond my scope, but I do not have the option to turn it down. I am desperate and would appreciate any help I can get. I did some preliminary searching but either haven't found anything similar or I just don't comprehend the code. Thank you in advance! </p>\n\n<p>So I have a set of data on a spreadsheet with 26 columns. Each one has a category but I am only interested in 5 being: the 23 column(Name, 2 column(Years), 3 column( date), column 8( value) and column 11 (value). I just need to have a button where it would write that information into the Access database, so that everyday I would be able to record that information. The code would also be able to loop and make sure that there will be no duplicates of information. Please assist with the coding! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1467160839, "post_id": 38088389, "comment_id": 63613112, "body": "You can&#39;t copy/paste to a file without opening the file. Common sense should tell you that; how would you <b>paste</b> without the file being open?"}, {"owner": {"reputation": 230, "user_id": 6315250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112f4f5e97d29472976c863f1c8a7ac0?s=128&d=identicon&r=PG&f=1", "display_name": "timthebomb", "link": "https://stackoverflow.com/users/6315250/timthebomb"}, "edited": false, "score": 0, "creation_date": 1467161088, "post_id": 38088389, "comment_id": 63613169, "body": "Assuming you know which part of the workbooks to copy to, and it&#39;s exactly the same place, it&#39;s conceivable that you could open in a different program, copy and save. Of course, you could just write a loop that opens each workbook, pastes the required code, and closes - 3500 times, or for each workbook in a folder."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1467171979, "post_id": 38088389, "comment_id": 63615666, "body": "<code>Is there a way to write a macro (or any other piece of code really) that can copy that piece and paste it to the other workbooks without having them open?</code> It depends on the set up of your data. If it is arranged database like (with fields and rows) I think it is possible. In short, yes."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5622818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/moa3e.jpg?s=128&g=1", "display_name": "Mystic Tomato", "link": "https://stackoverflow.com/users/5622818/mystic-tomato"}, "edited": false, "score": 0, "creation_date": 1467208102, "post_id": 38090696, "comment_id": 63636929, "body": "This worked! However, some of the cells of the source Workbook were merged or had a different alignment. Could this be copied to the others as well? Thanks"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 45, "user_id": 5622818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/moa3e.jpg?s=128&g=1", "display_name": "Mystic Tomato", "link": "https://stackoverflow.com/users/5622818/mystic-tomato"}, "edited": false, "score": 0, "creation_date": 1467211727, "post_id": 38090696, "comment_id": 63639924, "body": "@Mystic Tomato, I&#39;ve supplemented my answer in response to your comment. Should you have any trouble, just ask."}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": true, "score": 0, "last_activity_date": 1467211623, "last_edit_date": 1467211623, "creation_date": 1467176089, "answer_id": 38090696, "question_id": 38088389, "link": "https://stackoverflow.com/questions/38088389/copy-paste-part-of-excel-workbook-to-workbooks-that-are-not-currently-open/38090696#38090696", "title": "Copy/Paste part of Excel workbook to workbooks that are not currently open", "body": "<p>Tomato,\nUnfortunately, as @Ken White and @L42 have both pointed out, in order to edit a file you must, at least on some level, open it (i.e. load it into memory). What's worse is that unless you're willing to manipulate the xml or binary data directly (not advised), you're going to have to use Excel to open the .xlsx file for you, which takes time.</p>\n\n<p>This does not, of course, mean that you have to do in manually. For instance:</p>\n\n<pre><code>Sub DataToOtherWorkbooks()\n    Dim StrFile As String\n    Dim SourceRange As Range\n    Rng = \"A1:A2\"\n    Set SourceRange = Range(Rng)\n\n    StrFile = Dir(\"C:\\ExcelWorkBooks\\*.xlsx\")\n    Do While Len(StrFile) &gt; 0\n        Debug.Print StrFile\n        Application.ScreenUpdating = False\n        Set TargetWb = Workbooks.Open(\"C:\\ExcelWorkBooks\\\" &amp; StrFile)\n        TargetWb.Worksheets(\"Sheet1\").Range(Rng).Value(11) = SourceRange.Value(11)\n        TargetWb.Save\n        TargetWb.Close SaveChanges:=False\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>The above code will loop through all files in the folder ExcelWorkBooks with a .xlsx extension and populate them with the data located in the designated range of your source workbook.</p>\n\n<p>As mentioned earlier, however, this will take some time. When I ran it on 100 workbooks (from my laptop) it took an average of 0.54 seconds per workbook. So, in your case, with 3,500 workbooks you're looking at about 31 minutes. Not exactly light speed, but certainly better than doing it by hand. Hope this is of use to you. Please ask if you have further questions.</p>\n\n<p><strong>SUPPLEMENT</strong></p>\n\n<p>Tomato, in response to your comment, to transfer the format, including the merged or unmerged nature of the cells in your range you would use:</p>\n\n<pre><code>TargetWb.Worksheets(\"Sheet1\").Range(Rng).Value(11) = SourceRange.Value(11)\n</code></pre>\n\n<p>I've updated the original code to reflect the change. This should take care of it for you, but let me know.</p>\n"}], "owner": {"reputation": 45, "user_id": 5622818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/moa3e.jpg?s=128&g=1", "display_name": "Mystic Tomato", "link": "https://stackoverflow.com/users/5622818/mystic-tomato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "accepted_answer_id": 38090696, "answer_count": 1, "score": 3, "last_activity_date": 1552723319, "creation_date": 1467160052, "last_edit_date": 1552723319, "question_id": 38088389, "link": "https://stackoverflow.com/questions/38088389/copy-paste-part-of-excel-workbook-to-workbooks-that-are-not-currently-open", "title": "Copy/Paste part of Excel workbook to workbooks that are not currently open", "body": "<p>I need to copy a section of an Excel workbook to ~3500 other workbooks. Because of the number of workbooks, running a macro on each isn't feasible.</p>\n\n<p>Is there a way to copy that piece and paste it to the other workbooks without having them open?</p>\n"}, {"tags": ["oracle", "vba", "database-connection", "connection-string", "oracle12c"], "comments": [{"owner": {"reputation": 211530, "user_id": 10397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a116491222bf3f94c85381528593fd7?s=128&d=identicon&r=PG", "display_name": "Justin Cave", "link": "https://stackoverflow.com/users/10397/justin-cave"}, "edited": false, "score": 0, "creation_date": 1467159437, "post_id": 38088063, "comment_id": 63612733, "body": "I&#39;d wager that the username and/or password is different.  Either that or you&#39;re trying to connect to a different database from the two applications."}, {"owner": {"reputation": 715, "user_id": 6393524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54040f367d9a215baf4dc960df2119b9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter M.", "link": "https://stackoverflow.com/users/6393524/peter-m"}, "edited": false, "score": 0, "creation_date": 1467161402, "post_id": 38088063, "comment_id": 63613241, "body": "I submitted an edit to tag VBA in the question so it will reach people who can answer. I had a quick look and the syntax for the call looks right. You could try it with the Oracle service name in strDBDesc instead of the entire connection description. Use TNSPING from cmd prompt to check that your client has the Oracle service name resolving correctly. If that doesn&#39;t work, try a different type of Provider connectivity."}, {"owner": {"reputation": 773, "user_id": 3988268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/57670b29800d9a2e021f28a1a131e2d6?s=128&d=identicon&r=PG&f=1", "display_name": "RData", "link": "https://stackoverflow.com/users/3988268/rdata"}, "edited": false, "score": 1, "creation_date": 1467163656, "post_id": 38088063, "comment_id": 63613738, "body": "Justin - I checked my credentials atleast 25 times and they seem right !!"}, {"owner": {"reputation": 33648, "user_id": 25714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22daa66fbac8321bb4462a6d6befb38d?s=128&d=identicon&r=PG", "display_name": "Gary Myers", "link": "https://stackoverflow.com/users/25714/gary-myers"}, "edited": false, "score": 0, "creation_date": 1467171924, "post_id": 38088063, "comment_id": 63615653, "body": "Does the host / port / service point to the same database (eg are trying to connect to a db on &quot;localhost&quot; from different machines ) ? Since you are forming a string from the parameters, does the password contain any of those punctuation separators ?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1467379188, "post_id": 38088063, "comment_id": 63722505, "body": "or try different provider ? <code>&quot;Provider=msdaora;Data Source=&quot;</code> <a href=\"http://www.vbaexpress.com/forum/showthread.php?40986-Solved-Connect-to-Oracle-Database-using-Excel-VBA\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 3988268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/57670b29800d9a2e021f28a1a131e2d6?s=128&d=identicon&r=PG&f=1", "display_name": "RData", "link": "https://stackoverflow.com/users/3988268/rdata"}, "edited": false, "score": 0, "creation_date": 1467217833, "post_id": 38105303, "comment_id": 63644228, "body": "Password has a &#39;_&#39; and no other special characters but it has a mix of both upper an lower cases . I have put a connection string and I have verified the script but connecting to other instances and have no issues . The sake password and username has been issued for other instances and there is no issue while connecting using the same script ."}, {"owner": {"reputation": 133, "user_id": 1826862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJPm5.jpg?s=128&g=1", "display_name": "Sud", "link": "https://stackoverflow.com/users/1826862/sud"}, "reply_to_user": {"reputation": 773, "user_id": 3988268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/57670b29800d9a2e021f28a1a131e2d6?s=128&d=identicon&r=PG&f=1", "display_name": "RData", "link": "https://stackoverflow.com/users/3988268/rdata"}, "edited": false, "score": 0, "creation_date": 1467218395, "post_id": 38105303, "comment_id": 63644565, "body": "check the connect permission for the user. Cause I don&#39;t see any issue with the code. So it should be on this instance or user which fails to connect. Check the connect permission."}], "tags": [], "owner": {"reputation": 133, "user_id": 1826862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJPm5.jpg?s=128&g=1", "display_name": "Sud", "link": "https://stackoverflow.com/users/1826862/sud"}, "is_accepted": false, "score": 0, "last_activity_date": 1467217729, "creation_date": 1467217729, "answer_id": 38105303, "question_id": 38088063, "link": "https://stackoverflow.com/questions/38088063/oracle-can-connect-from-client-but-not-from-script-invalid-user-password/38105303#38105303", "title": "Oracle Can connect from client but not from script - invalid user/password", "body": "<ol>\n<li><p>Is the password simple or with special character? use an escape sequence or quotes if with special characters.</p></li>\n<li><p>Based on below use \"ADODBConnection.ConnectionString = strConnection\" in the above snippet and then open the connection. </p></li>\n<li><p>Place break point and see what is being passed as a connection string to the driver. </p></li>\n</ol>\n\n<p>Refer: <a href=\"https://docs.oracle.com/cd/E47955_01/win.121/e18594/using.htm\" rel=\"nofollow\">https://docs.oracle.com/cd/E47955_01/win.121/e18594/using.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 773, "user_id": 3988268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/57670b29800d9a2e021f28a1a131e2d6?s=128&d=identicon&r=PG&f=1", "display_name": "RData", "link": "https://stackoverflow.com/users/3988268/rdata"}, "is_accepted": false, "score": 0, "last_activity_date": 1467378629, "creation_date": 1467378629, "answer_id": 38146324, "question_id": 38088063, "link": "https://stackoverflow.com/questions/38088063/oracle-can-connect-from-client-but-not-from-script-invalid-user-password/38146324#38146324", "title": "Oracle Can connect from client but not from script - invalid user/password", "body": "<p>All,</p>\n\n<p>i was able to connect successfully after i have download and installed the latest copy of Oracle ODAC from their website.</p>\n\n<p>here are additional details - hope this helps others having a similar issue\n<a href=\"https://blogs.msdn.microsoft.com/dbrowne/2013/10/02/creating-a-linked-server-for-oracle-in-64bit-sql-server/\" rel=\"nofollow\">https://blogs.msdn.microsoft.com/dbrowne/2013/10/02/creating-a-linked-server-for-oracle-in-64bit-sql-server/</a></p>\n"}], "owner": {"reputation": 773, "user_id": 3988268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/57670b29800d9a2e021f28a1a131e2d6?s=128&d=identicon&r=PG&f=1", "display_name": "RData", "link": "https://stackoverflow.com/users/3988268/rdata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 751, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467378629, "creation_date": 1467157716, "last_edit_date": 1467169342, "question_id": 38088063, "link": "https://stackoverflow.com/questions/38088063/oracle-can-connect-from-client-but-not-from-script-invalid-user-password", "title": "Oracle Can connect from client but not from script - invalid user/password", "body": "<p>I'm trying to connect to a Oracle DB and i believe the version is 12c, I'm able to connect to the same DB using a client (SQL Developer), but having issues while trying to connect using VBscript which I would like to use as part of my application.</p>\n\n<p>Here is the error message --</p>\n\n<pre><code>      **Exception: OraOLEDB - ORA-01017: invalid username/password; logon denied**\n</code></pre>\n\n<p>Here is my script that I'm using to connect --</p>\n\n<pre><code>Option Explicit\nOn Error Resume Next\n'Dim strSQLQuery: strSQLQuery = \"SELECT sysdate FROM dual\"\nDim strDBDesc: strDBDesc = \"(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)    (HOST = XXX)(PORT = XXX))(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME =     XXXX)))\"\nDim strUserID: strUserID = \"user\"\nDim strPassword: strPassword = \"pass\"\nDim ADODBConnection: Set ADODBConnection =                               CreateObject(\"ADODB.Connection\")\nDim strConnection\nstrConnection = \"Provider=OraOLEDB.Oracle;Data Source=\" &amp; strDBDesc &amp; _\n            \";User ID=\" &amp; strUserID &amp; \";Password=\" &amp; strPassword &amp; \";\"\n\nADODBConnection.Open strConnection\n\nIf Err &lt;&gt; 0 Then\n    WScript.Echo \"An error occurred in Opening Connection: \" &amp; Err.Number &amp; \" \" &amp; Err.Description &amp; \" \" &amp; Err.Source\nEnd If\nSet ADODBConnection = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1467155083, "post_id": 38087510, "comment_id": 63611634, "body": "the macro will input the end date <i>where</i>?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1467172215, "post_id": 38087510, "comment_id": 63615715, "body": "I also think a formula is more suitable. <code>=EOMONTH(TODAY(),0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1467155503, "creation_date": 1467155503, "answer_id": 38087727, "question_id": 38087510, "link": "https://stackoverflow.com/questions/38087510/i-need-to-make-a-vba-that-will-set-the-enddate-to-the-last-day-of-the-month/38087727#38087727", "title": "I need to make a vba that will set the endDate to the last day of the month", "body": "<p>In your endDate cell, you can use this formula:</p>\n\n<pre><code>=DATE(YEAR(startDate),MONTH(startDate)+1,0)\n</code></pre>\n\n<p>Where <code>startDate</code> is a named reference to your startDate cell.</p>\n"}, {"comments": [{"owner": {"reputation": 769, "user_id": 4067588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81ea12f9a566214a93474ce048ddd4fe?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose36", "link": "https://stackoverflow.com/users/4067588/mongoose36"}, "edited": false, "score": 0, "creation_date": 1467162722, "post_id": 38087995, "comment_id": 63613540, "body": "Second on the EOMONTH!"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1467157224, "creation_date": 1467157224, "answer_id": 38087995, "question_id": 38087510, "link": "https://stackoverflow.com/questions/38087510/i-need-to-make-a-vba-that-will-set-the-enddate-to-the-last-day-of-the-month/38087995#38087995", "title": "I need to make a vba that will set the endDate to the last day of the month", "body": "<p>If you are really keen on using your own VBA function then you can create a function such as this which basically gets the first day of the next month and subtracts 1 day from it to get the last day of the month.   I think Thunderframe's answer is best though as it is simple and uses the native functions of excel.</p>\n\n<pre><code>Public Function dhLastDayInMonth(Optional endDate As Date = 0) As Date\n    Dim dt As Date\n    'check if we have a date\n    If endDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dt = DateTime.Now\n    Else\n        dt = endDate\n    End If\n    'check for December\n    If DatePart(\"m\", dt) = 12 Then\n        'add one to the year and month\n        dt = DateSerial(DatePart(\"yyyy\", DateAdd(\"yyyy\", 1, dt)), DatePart(\"m\", DateAdd(\"m\", 1, dt)), 1)\n    Else\n        'add 1 to the month\n        dt = DateSerial(DatePart(\"yyyy\", dt), DatePart(\"m\", DateAdd(\"m\", 1, dt)), 1)\n    End If\n    'subtract 1 day from the date to get the last date of the month\n    dt = DateAdd(\"d\", -1, dt)\n    'return the end of the month\n    dhLastDayInMonth = dt\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 12440990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406f651b5add38f046c69169a8104de9?s=128&d=identicon&r=PG&f=1", "display_name": "Chefvad", "link": "https://stackoverflow.com/users/12440990/chefvad"}, "is_accepted": false, "score": 0, "last_activity_date": 1588214724, "creation_date": 1588214724, "answer_id": 61515062, "question_id": 38087510, "link": "https://stackoverflow.com/questions/38087510/i-need-to-make-a-vba-that-will-set-the-enddate-to-the-last-day-of-the-month/61515062#61515062", "title": "I need to make a vba that will set the endDate to the last day of the month", "body": "<pre><code> EndDate = DateSerial(Year(Date), Month(Date) + 1, 0) \n</code></pre>\n\n<p>This vba function will also return the last day of the month for the present month. Change the <code>Date</code>  if a different month is needed. </p>\n"}], "owner": {"reputation": 27, "user_id": 6451989, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/1194554033890217/picture?type=large", "display_name": "Nick Norwood", "link": "https://stackoverflow.com/users/6451989/nick-norwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1588214724, "creation_date": 1467154268, "question_id": 38087510, "link": "https://stackoverflow.com/questions/38087510/i-need-to-make-a-vba-that-will-set-the-enddate-to-the-last-day-of-the-month", "title": "I need to make a vba that will set the endDate to the last day of the month", "body": "<p>I have 2 cells that one is starting date assigned as startDate and another cell assigned endDate. Everytime I click on the cell a calendar pops out and I enter the date. I want the macro to change the endDate to the last day of the month automatically. So when the user goes in and enters a start date the macro will input the end date which is the last day of that month. Here is the code I have right now: </p>\n\n<pre><code>Function dhLastDayInMonth(Optional endDate As Date = 0) As Date\n    ' Return the last day in the specified month.\n    If endDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\n    End If\n    dhLastDayInMonth = DateSerial(Year(endDate), _\n     Month(dtmDate) + 1, 0)\nEnd Function\n</code></pre>\n\n<p>also Here is the code for the calendar:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n     'check cells for desired format to trigger the calendarfrm.show routine\n     'otherwise exit the sub\n    Dim DateFormats, DF\n    DateFormats = Array(\"m/d/yy;@\", \"mmmm d yyyy\")\n    For Each DF In DateFormats\n        If DF = Target.NumberFormat Then\n            If CalendarFrm.HelpLabel.Caption &lt;&gt; \"\" Then\n                CalendarFrm.Height = 191 + CalendarFrm.HelpLabel.Height\n            Else: CalendarFrm.Height = 191\n                CalendarFrm.Show\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467152781, "post_id": 38087242, "comment_id": 63610839, "body": "This is why people need to stop posting <a href=\"http://stackoverflow.com/questions/38085484/macro-to-activate-cell-whose-address-is-referenced-elsewhere#38085484\">answers</a> to new users."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467156505, "post_id": 38087242, "comment_id": 63612005, "body": "@findwindow Keeping em honest but they have to start somewhere ;)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1467215953, "post_id": 38087242, "comment_id": 63642990, "body": "@MatthewD you&#39;re alive ^_^"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1467158086, "last_edit_date": 1467158086, "creation_date": 1467157723, "answer_id": 38088065, "question_id": 38087242, "link": "https://stackoverflow.com/questions/38087242/macro-to-copy-whatever-is-currently-in-a-cell-not-a-hard-coded-reference/38088065#38088065", "title": "Macro to copy whatever is currently in a cell, not a hard-coded reference", "body": "<p>If <strong>D52</strong> contains a cell address then:</p>\n\n<pre><code>Sub ytrewq()\n    Range(Range(\"D52\").Text).Select\nEnd Sub\n</code></pre>\n\n<p>will go there.</p>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/esp67.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/esp67.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If <strong>D52</strong> contains something like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yiROL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yiROL.png\" alt=\"enter image description here\"></a></p>\n\n<p>This this will first get to the proper worksheet and then to the proper cell:</p>\n\n<pre><code>Sub ytrewq()\n    Dim s As String\n\n    s = Range(\"D52\").Text\n    Range(s).Parent.Activate\n    Range(s).Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1467179681, "creation_date": 1467179681, "answer_id": 38091395, "question_id": 38087242, "link": "https://stackoverflow.com/questions/38087242/macro-to-copy-whatever-is-currently-in-a-cell-not-a-hard-coded-reference/38091395#38091395", "title": "Macro to copy whatever is currently in a cell, not a hard-coded reference", "body": "<p>Please try as below</p>\n\n<pre><code>Application.Goto Reference:=Range(Range(\"D52\").Value)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6525215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a047b02fdf3e4bda6e6a69e0d4bd287?s=128&d=identicon&r=PG&f=1", "display_name": "John Omstead", "link": "https://stackoverflow.com/users/6525215/john-omstead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467179681, "creation_date": 1467152493, "last_edit_date": 1467159224, "question_id": 38087242, "link": "https://stackoverflow.com/questions/38087242/macro-to-copy-whatever-is-currently-in-a-cell-not-a-hard-coded-reference", "title": "Macro to copy whatever is currently in a cell, not a hard-coded reference", "body": "<p>I would like the macro to copy the cell address listed in a designated cell and copy it into a \"go to\" box to activate that cell.</p>\n\n<p>I tried recording this macro but instead of copying and pasting whatever is in the designated cell it hard-codes the cell address. This cell address will change periodically so I need it to be more dynamic.</p>\n\n<p>Here is the code: </p>\n\n<pre><code>Range(\"D52\").Select\nSelection.Copy\nApplication.Goto Reference:=\"R3C33\"\n</code></pre>\n\n<p>Instead of the hard-coded reference (R3C33) I want whatever is currently in D52. Further, if D52 is located in a separate sheet that is not currently activated how would I need to let the macro know to pull it from D52 from a different tab?</p>\n"}, {"tags": ["arrays", "vba", "row", "z-index"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1467154026, "creation_date": 1467154026, "answer_id": 38087480, "question_id": 38087048, "link": "https://stackoverflow.com/questions/38087048/how-to-get-a-row-array-from-a-table-knowing-the-row-index-using-vba/38087480#38087480", "title": "How to get a row array from a table knowing the row index using vba?", "body": "<p>You should use</p>\n\n<pre><code>Dim MyArray As Variant \nmyArray = Worksheets(\"Sheet1\").ListObjects(\"TableName\").ListRows(index).Range.Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5754368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66087f5991722c19067f8341905704f6?s=128&d=identicon&r=PG&f=1", "display_name": "MonaK", "link": "https://stackoverflow.com/users/5754368/monak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467154026, "creation_date": 1467151505, "question_id": 38087048, "link": "https://stackoverflow.com/questions/38087048/how-to-get-a-row-array-from-a-table-knowing-the-row-index-using-vba", "title": "How to get a row array from a table knowing the row index using vba?", "body": "<p>I was trying to get a row array from table using that : Worksheets(\"Sheet1\").Range(\"Table Name\").Rows(index).value but I was getting the  error 91</p>\n"}]