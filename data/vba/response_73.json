[{"tags": ["vba", "excel", "loops"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1464825795, "creation_date": 1464825795, "answer_id": 37580669, "question_id": 37580540, "link": "https://stackoverflow.com/questions/37580540/excel-vba-nested-loop-to-format-excel-table-columns/37580669#37580669", "title": "Excel VBA - Nested loop to format excel table columns", "body": "<p>You don't need to nest a second <code>for</code> loop.  If you want to set the 3rd and 4th columns to a percentage, you only need to set that when the iteration of the loop (<code>h</code>) is 2 or 3 (remembering that arrays index from 0).  You also shouldn't cross arrays for the main loop, and since <code>LBound</code> is in most cases 0 you might as well just use that anyway.  Try this:</p>\n\n<pre><code>With lst\n    For h = 0 To UBound(r1c1s)\n        .ListColumns.Add\n        .ListColumns(.ListColumns.Count).Name = colNames(h)\n        .ListColumns(.ListColumns.Count).DataBodyRange.FormulaR1C1 = r1c1s(h)\n        If h = 2 or h = 3 Then        \n                .ListColumns(.ListColumns.Count).NumberFormat = \"0%\"\n        End if\n    Next h\nEnd With\n</code></pre>\n\n<p>To answer the other point in your question, <code>UBound(array)</code> just gives the index of the largest element (the Upper BOUNDary) in the given array.  So where you have 50 elements in such an array, <code>UBound(array)</code> will return 49 (zero based as mentioned before).  <code>LBound</code> just gives the other end of the array (the Lower BOUNDary), which is generally zero.</p>\n"}], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 37580669, "answer_count": 1, "score": 0, "last_activity_date": 1464825795, "creation_date": 1464824770, "question_id": 37580540, "link": "https://stackoverflow.com/questions/37580540/excel-vba-nested-loop-to-format-excel-table-columns", "title": "Excel VBA - Nested loop to format excel table columns", "body": "<p>I have a macro that so far, adds 4 new table columns to an existing table (\"Table1\"). Now, I would like the macro to format the 3rd and 4th row as percentage. I would like to include this in the loop already listed in my code. I have tried several different ways to do this. I don't think I quite understand how the UBound function works, but hopefully you can understand what I am trying to do. </p>\n\n<p>I also am unsure if I am allowed to continue to utilize the WITH statement in my nested For loop in regards to me 'lst' variable. </p>\n\n<p>@Jeeped - I'm looking at you for this one again...thanks for basically walking me through this whole project lol    </p>\n\n<pre><code>Sub attStatPivInsertTableColumns_2()\n\nDim lst As ListObject\nDim currentSht As Worksheet\nDim colNames As Variant, r1c1s As Variant \nDim h As Integer, i As Integer\n\nSet currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\nSet lst = ActiveSheet.ListObjects(\"Table1\")\n\ncolNames = Array(\"AHT\", \"Target AHT\", \"Transfers\", \"Target Transfers\")\nr1c1s = Array(\"=([@[Inbound Talk Time (Seconds)]]+[@[Inbound Hold Time (Seconds)]]+[@[Inbound Wrap Time (Seconds)]])/[@[Calls Handled]]\", \"=350\", \"=[@[Call Transfers and/or Conferences]]/[@[Calls Handled]]\", \"=0.15\")\n\nWith lst\nFor h = LBound(colNames) To UBound(r1c1s)\n    .ListColumns.Add\n    .ListColumns(.ListColumns.Count).Name = colNames(h)\n    .ListColumns(.ListColumns.Count).DataBodyRange.FormulaR1C1 = r1c1s(h)\n  If UBound(colNames(h)) = 2 or UBound(colNames(h)) = 3 Then        \n        For i = UBound(colNames(h), 2) To UBound(colNames(h), 3)\n            .ListColumns(.ListColumns.Count).NumberFormat = \"0%\"\n  End if\n        Next i\nNext h\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "internet-explorer", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1464864475, "last_edit_date": 1464864475, "creation_date": 1464863681, "answer_id": 37589380, "question_id": 37580474, "link": "https://stackoverflow.com/questions/37580474/excel-vba-macro-to-click-to-the-next-page-in-ie/37589380#37589380", "title": "excel VBA - Macro to click to the next page in IE", "body": "<p>This should work for you:</p>\n\n<pre><code>Sub dates()\n    Dim IE As New InternetExplorer\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n    IE.Navigate \"http://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&amp;CIK=0000898293&amp;type=&amp;dateb=&amp;owner=exclude&amp;count=100\"\n\n    Do\n        DoEvents\n    Loop Until IE.ReadyState = READYSTATE_COMPLETE\n\n    With IE.document\n        Set elems = .getElementsByTagName(\"input\")\n        For Each e In elems\n            If e.Type = \"button\" And e.Value = \"Next 100\" Then\n                e.Click\n                Exit For\n            End If\n        Next e\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you are using following link : </p>\n\n<pre><code>http://www.sec.gov/cgi-bin/browse-edgar?CIK=JBL&amp;owner=exclude&amp;action=getcompany\n</code></pre>\n\n<p>you'll have to check for</p>\n\n<pre><code>If objCollection(i).Type = \"button\" And objCollection(i).Value = \"Next 40\" Then\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5471571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75b07441617dffdb54a2ff7594b66c8?s=128&d=identicon&r=PG&f=1", "display_name": "Default001", "link": "https://stackoverflow.com/users/5471571/default001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 37589380, "answer_count": 1, "score": 0, "last_activity_date": 1464864475, "creation_date": 1464824390, "last_edit_date": 1531161705, "question_id": 37580474, "link": "https://stackoverflow.com/questions/37580474/excel-vba-macro-to-click-to-the-next-page-in-ie", "title": "excel VBA - Macro to click to the next page in IE", "body": "<p>I cannot figure out how to click the \"Next 100\" button on this page:</p>\n\n<p><a href=\"http://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&amp;CIK=0000898293&amp;type=&amp;dateb=&amp;owner=exclude&amp;count=100\" rel=\"nofollow\">http://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&amp;CIK=0000898293&amp;type=&amp;dateb=&amp;owner=exclude&amp;count=100</a></p>\n\n<p>specifically this section: </p>\n\n<pre><code>&lt;form&gt;\n     &lt;table border=\"0\" width=\"100%\"&gt;\n        &lt;tbody&gt;&lt;tr&gt;\n           &lt;td&gt;Items 1 - 100&amp;nbsp;&amp;nbsp;&lt;a href=\"/cgi-bin/browse-edgar?action=getcompany&amp;amp;CIK=0000898293&amp;amp;type=&amp;amp;dateb=&amp;amp;owner=exclude&amp;amp;start=0&amp;amp;count=100&amp;amp;output=atom\"&gt;&lt;img src=\"/images/rss-feed-icon-14x14.png\" alt=\"0000898293 Filings\" border=\"0\" align=\"top\"&gt; RSS Feed&lt;/a&gt;&lt;/td&gt;\n           &lt;td style=\"text-align: right;\"&gt; &lt;input type=\"button\" value=\"Next 100\" onclick=\"parent.location='/cgi-bin/browse-edgar?action=getcompany&amp;amp;CIK=0000898293&amp;amp;type=&amp;amp;dateb=&amp;amp;owner=exclude&amp;amp;start=100&amp;amp;count=100'\"&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n     &lt;/tbody&gt;&lt;/table&gt;\n  &lt;/form&gt;\n</code></pre>\n\n<p>Below is what I have tired in excel VBA, I don't have a strong understanding of this and know how to click a button if I can see the element id. </p>\n\n<pre><code>Sub dates()Dim IE As New InternetExplorer\nIE.Visible = True\n\nIE.navigate \"http://www.sec.gov/cgi-bin/browse-edgar?CIK=JBL&amp;owner=exclude&amp;action=getcompany\"\nDo\n DoEvents\nLoop Until IE.readyState = READYSTATE_COMPLETE\nDim Doc As HTMLDocument\nSet Doc = IE.document\n\n\nDoc.getElementById(\"count\").Value = 100\nDoc.forms.Item(0).submit\n\n\nDim objTag As Object\nFor Each objTag In Doc.getElementsByTagName(strTagName)\nIf InStr(objTag.outerHTML, \"Next 100\") &gt; 0 Then\n\n    objTag.Click\n    objTag.FireEvent (\"onclick\")\n\n    Exit For\n\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 0, "creation_date": 1464848660, "post_id": 37582691, "comment_id": 62654250, "body": "Thanks for that, would it be possible to get the vb.net version?  The idea behind adding resources to the milestone is to export the milestone to outlook and have the resources come through in the notes in outlook. Would it be better to copy the resources to the notes section in the task?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 0, "creation_date": 1464900360, "post_id": 37582691, "comment_id": 62688391, "body": "@ballsy26 I added the vb.net version and added the resources to the milestone task. From a msproject-perspective it doesn&#39;t add anything, but it doesn&#39;t hurt either."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1464900291, "last_edit_date": 1464900291, "creation_date": 1464841779, "answer_id": 37582691, "question_id": 37580332, "link": "https://stackoverflow.com/questions/37580332/improving-ms-project-vb-vba-task-creation/37582691#37582691", "title": "improving MS Project VB/VBA task creation", "body": "<p>The problem with the extra task can be solved by storing a collection (or list in .net) of selected tasks and then looping through those. I'm posting the solution in VBA since that is likely to be the most relevant to other viewers; I can post a vb.net version if needed.</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim proj As Project\nSet proj = Application.ActiveProject\n\nDim myTask As Task\nDim colTasks As New Collection\nFor Each myTask In Application.ActiveSelection.Tasks\n    colTasks.Add myTask, CStr(myTask.UniqueID)\nNext myTask\n\nDim i As Object\nFor Each i In colTasks\n    Set myTask = ActiveProject.Tasks.UniqueID(i)\n    Dim newTask As Task\n    Set newTask = ActiveProject.Tasks.Add(myTask.Name &amp; \" - Milestone\", myTask.ID + 1)\n    newTask.Duration = 0\n    newTask.Predecessors = myTask.ID &amp; \"FF\"\n    newTask.Text3 = \"Milestone\"\n    newTask.ResourceNames = myTask.ResourceNames\n    Application.SelectRow newTask.ID, False\n    Application.GanttBarFormat GanttStyle:=3, StartShape:=13, StartType:=0, StartColor:=255, MiddleShape:=0, MiddlePattern:=0, MiddleColor:=255, EndShape:=0, EndColor:=255, EndType:=0\nNext\n\nApplication.SelectRow colTasks(1), False\nApplication.SelectTaskField Row:=0, Column:=\"Name\"\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I changed a few things: 1) rather than hard-coding the start field, use a task relationship to keep it with it's task when the task moves; 2) since zero-duration tasks have no work, it is not necessary to add resources.</p>\n\n<p><strong>UPDATE</strong> </p>\n\n<p>Here's the vb.net version:</p>\n\n<pre><code>        Dim ProjApp As MSProject.Application = Globals.ThisAddIn.Application\n        ProjApp.ScreenUpdating = False\n\n        Dim proj As MSProject.Project = ProjApp.ActiveProject\n\n        Dim selTasks As New List(Of MSProject.Task)\n        For Each myTask As MSProject.Task In ProjApp.ActiveSelection.Tasks\n            selTasks.Add(myTask)\n        Next myTask\n\n        For Each myTask In selTasks\n            Dim newTask As MSProject.Task = proj.Tasks.Add(myTask.Name &amp; \" - Milestone\", myTask.ID + 1)\n            newTask.Duration = 0\n            newTask.Predecessors = myTask.ID &amp; \"FF\"\n            newTask.Text3 = \"Milestone\"\n            newTask.ResourceNames = myTask.ResourceNames\n            ProjApp.SelectRow(newTask.ID, False)\n            ProjApp.GanttBarFormat(GanttStyle:=3, StartShape:=13, StartType:=0, StartColor:=255, MiddleShape:=0, MiddlePattern:=0, MiddleColor:=255, EndShape:=0, EndColor:=255, EndType:=0)\n        Next\n\n        ProjApp.SelectRow(selTasks(0).ID, False)\n        ProjApp.SelectTaskField(Row:=0, Column:=\"Name\")\n        ProjApp.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1663, "favorite_count": 0, "accepted_answer_id": 37582691, "answer_count": 1, "score": 0, "last_activity_date": 1464900291, "creation_date": 1464823270, "question_id": 37580332, "link": "https://stackoverflow.com/questions/37580332/improving-ms-project-vb-vba-task-creation", "title": "improving MS Project VB/VBA task creation", "body": "<p>At the moment I have some code that creates new tasks, but it's really buggy and inconsistent.</p>\n\n<pre><code>Public Sub Create_milestones()\n    proj = Globals.ThisAddIn.Application.ActiveProject\n\n    Dim myTask As MSProject.Task\n\n    Application.ScreenUpdating = False\n\n    For Each myTask In Application.ActiveSelection.Tasks\n        Application.SelectTaskField(Row:=1, Column:=\"Name\")\n        Application.InsertTask()\n        Application.SetTaskField(Field:=\"Duration\", Value:=\"0\")\n        Application.SetTaskField(Field:=\"Start\", Value:=myTask.Finish)\n        Application.SetTaskField(Field:=\"Name\", Value:=myTask.Name &amp; \" - Milestone\")\n        Application.SetTaskField(Field:=\"Resource Names\", Value:=myTask.ResourceNames)\n        Application.SetTaskField(Field:=\"Text3\", Value:=\"Milestone\")\n        Application.GanttBarFormat(GanttStyle:=3, StartShape:=13, StartType:=0, StartColor:=255, MiddleShape:=0, MiddlePattern:=0, MiddleColor:=255, EndShape:=0, EndColor:=255, EndType:=0)\n        Application.SelectTaskField(Row:=1, Column:=\"Name\")\n    Next\n    Application.SelectTaskField(Row:=-1, Column:=\"Name\")\n    Application.SelectRow(Row:=0)\n    Application.RowDelete()\n\n    Application.ScreenUpdating = True\n\n    MsgBox(\"Done\")\nEnd Sub\n</code></pre>\n\n<p>It seems to go too far when looping through the selected tasks and creates 1 task too many, I worked around this by going back and deleting the extra task but it doesn't seem like the best solution to me. </p>\n\n<p>I realise this bit of code is in VB.net but I can work with VBA too.</p>\n\n<p>Is there a better way to create and assign values to new tasks?</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1464844897, "post_id": 37580171, "comment_id": 62652724, "body": "I would check <code>ele.title</code> and <code>ele.href</code>?"}, {"owner": {"reputation": 11, "user_id": 6411944, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oyfmUafupfE/AAAAAAAAAAI/AAAAAAAAA34/6P0SC8VyNxc/photo.jpg?sz=128", "display_name": "Anirudh Sheth", "link": "https://stackoverflow.com/users/6411944/anirudh-sheth"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1464857227, "post_id": 37580171, "comment_id": 62659233, "body": "Thanks Axel. Yes, that sounds logical, but I already tried that and it didn&#39;t work :("}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1464865209, "post_id": 37580171, "comment_id": 62664747, "body": "Sorry, I had not viewed properly. The <code>ele</code> is the <code>H1</code> element. So the <code>A</code> element is it&#39;s first child. So <code>ele.firstChild.title</code> and <code>ele.firstChild.href</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530710409, "creation_date": 1530710409, "answer_id": 51174720, "question_id": 37580171, "link": "https://stackoverflow.com/questions/37580171/web-scraping-using-excel-vba/51174720#51174720", "title": "Web scraping using excel VBA", "body": "<p>Select the element by its styling.</p>\n\n<pre><code>.document.querySelector(\"a[href=http://somelink.com]\").innerText\n</code></pre>\n\n<p><code>a[href=http://somelink.com]</code> is a CSS selector of first element with an <code>a</code> tag having <code>href</code> = <code>'http://somelink.com'</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7MsL0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7MsL0.png\" alt=\"CSS query\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6411944, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oyfmUafupfE/AAAAAAAAAAI/AAAAAAAAA34/6P0SC8VyNxc/photo.jpg?sz=128", "display_name": "Anirudh Sheth", "link": "https://stackoverflow.com/users/6411944/anirudh-sheth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530710409, "creation_date": 1464822243, "last_edit_date": 1464822596, "question_id": 37580171, "link": "https://stackoverflow.com/questions/37580171/web-scraping-using-excel-vba", "title": "Web scraping using excel VBA", "body": "<p>I am looking at an HTML code link below:</p>\n\n<pre><code>&lt;h1 class=\"wer wer\"&gt;\n&lt;a href=\"http://somelink.com\" rel=\"bookmark\" title=\"Permanent Link to Title of this page that covers some random topic\"&gt;\nShort title of this page...&lt;/a&gt;\n&lt;/h1&gt;\n</code></pre>\n\n<p>I am currently using the below code to pull out innertext (\"Short title of this page...\")</p>\n\n<pre><code>For Each ele In .document.all\n        Select Case ele.classname\n            Case \"wer wer\"\n            RowCount = RowCount + 1\n            sht.Range(\"A\" &amp; RowCount) = ele.innertext\n        End Select\nNext ele\n</code></pre>\n\n<p>How can I modify this code to pull out title (\"Permanent Link to Title of this page that covers some random topic\") and href (\"<a href=\"http://somelink.com\" rel=\"nofollow\">http://somelink.com</a>\")?</p>\n\n<p>Any help would be much appreciated. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4316, "user_id": 6005451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5d2854ebcf1678d4fab4f7bedd6b9f?s=128&d=identicon&r=PG&f=1", "display_name": "EoinS", "link": "https://stackoverflow.com/users/6005451/eoins"}, "is_accepted": false, "score": 3, "last_activity_date": 1464823687, "last_edit_date": 1464823687, "creation_date": 1464822074, "answer_id": 37580147, "question_id": 37580130, "link": "https://stackoverflow.com/questions/37580130/find-first-completely-empty-row-on-a-sheet/37580147#37580147", "title": "find first completely empty row on a sheet", "body": "<p>Using EntireRow (which is so useful let me tell you) and counting row by row starting in A1 is one very basic way of doing this.</p>\n\n<p>This will tell you in the immediate window:</p>\n\n<pre><code>Sub findemptyrow()                       '''Psuedo Code\nApplication.ScreenUpdating = False       'turns off annoying blinky\nRange(\"a1\").Activate                     'start at beginning   \nWhile a &lt;&gt; 1                             'keep going\n  If Application.CountA(ActiveCell.EntireRow) = 0 Then  'is it blank?\n  Debug.Print \"Row \" &amp; (ActiveCell.Row) &amp; \" is blank.\"   'it is\n  a = 1                                   'stop going  \n  End If\n  ActiveCell.Offset(1).Activate           'next cell\nWend                                      'do it all over again  \nApplication.ScreenUpdating = True         'back to normal settings\nEnd Sub\n</code></pre>\n\n<p>Making <code>ScreenUpdating</code> False will make this faster, even with 10k's of rows.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 3980275, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005016543560/picture?type=large", "display_name": "Don Bourgeois", "link": "https://stackoverflow.com/users/3980275/don-bourgeois"}, "edited": false, "score": 0, "creation_date": 1464912906, "post_id": 37580633, "comment_id": 62692735, "body": "What am I missing?  The What parameter of the find function is the character &#39;*&#39;  - chr(42)  when we are searching for an empty cell."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 63, "user_id": 3980275, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005016543560/picture?type=large", "display_name": "Don Bourgeois", "link": "https://stackoverflow.com/users/3980275/don-bourgeois"}, "edited": false, "score": 0, "creation_date": 1464914217, "post_id": 37580633, "comment_id": 62692999, "body": "If you start at the bottom and work upwards row-by-row for the first populated cell you add 1 to the row number to get the first blank row. This is not necessarily the same as working from the top to find the first blank row as there could be a completely blank row with populated cells underneath it. The title implies the latter but the OP&#39;s code was looking for the former."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1464825556, "creation_date": 1464825556, "answer_id": 37580633, "question_id": 37580130, "link": "https://stackoverflow.com/questions/37580130/find-first-completely-empty-row-on-a-sheet/37580633#37580633", "title": "find first completely empty row on a sheet", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> is likely the most expedient method. Look for a wildcard (<code>What:=Chr(42)</code>), start in A1 (<code>After:=.Cells(1, 1)</code>, search backwards  (<code>SearchDirection:=xlPrevious</code>), search row-by-row (<code>SearchOrder:=xlByRows).Row</code>), look at the formulas (<code>LookIn:=xlFormulas</code>) since that will find the first value or formula; looking at <code>xlValues</code> may not be correct if a formula is returning an empty string (<code>\"\"</code>).</p>\n\n<pre><code>Option Explicit\nPublic Donations As Worksheet\n\nSub test()\n    Set Donations = Worksheets(\"Sheet2\")\n    Debug.Print getNextEmptyRow(Donations)\nEnd Sub\n\nFunction getNextEmptyRow(ws As Worksheet)\n    With ws.Cells\n        getNextEmptyRow = .Find(What:=Chr(42), After:=.Cells(1, 1), LookIn:=xlFormulas, _\n                                SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row + 1\n    End With\nEnd Function\n</code></pre>\n\n<p>You cannot set <code>Donations</code> in the declarations area of a module code sheet. Declare the public variable in the declarations area (top) of the code sheet but Set the variable in a sub or function.</p>\n\n<p>Don't forget to add 1 to the row returned if you want the <em>'next empty row'</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1464868113, "creation_date": 1464868113, "answer_id": 37591011, "question_id": 37580130, "link": "https://stackoverflow.com/questions/37580130/find-first-completely-empty-row-on-a-sheet/37591011#37591011", "title": "find first completely empty row on a sheet", "body": "<p>Just another alternative using the <code>SpecialCells</code> method of a `Range:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Debug.Print \"Last row on Sheet1 is: \" &amp; FirstCompletelyEmptyRow(Sheet1)\nEnd Sub\n\nFunction FirstCompletelyEmptyRow(ByRef wsTarget As Worksheet) As Long\n    FirstCompletelyEmptyRow = wsTarget.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row + 1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3980275, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005016543560/picture?type=large", "display_name": "Don Bourgeois", "link": "https://stackoverflow.com/users/3980275/don-bourgeois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1464868113, "creation_date": 1464821995, "last_edit_date": 1531164843, "question_id": 37580130, "link": "https://stackoverflow.com/questions/37580130/find-first-completely-empty-row-on-a-sheet", "title": "find first completely empty row on a sheet", "body": "<p>need a function that returns the first completely empty row (no values, no formulas, no blanks) from a sheet with sparely populated cells.  No one single column is required to be filled.</p>\n\n<p>I tried this, but i can even get it to compile:</p>\n\n<pre><code>Public Donations As Worksheet\nSet Donations = Sheets(\"Sheet2\")\n\nFunction getEmptyRow() As Long\n   Dim lastCol As Long, lastRow As Long, maxRow As Long\n   Dim col As Long\n   Dim r As Variant\n\n   lastCol = Donations.Cells(1, Columns.Count).End(xlToLeft).Column\n   For col = 1 To lastCol Step 1\n      lastRow = Donations.Cells(Rows.Count, col).End(xlUp).row\n      maxRow = Application.WorksheetFunction.max(maxRow, lastRow)\n   Next col\n   getEmptyRow = maxRow + 1\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464857613, "creation_date": 1464857613, "answer_id": 37587041, "question_id": 37580098, "link": "https://stackoverflow.com/questions/37580098/access-fill-in-value-for-empty-cell-from-same-row-different-record/37587041#37587041", "title": "Access: Fill In value for empty Cell from same row different record", "body": "<p>Just loop through the recordset in VBA recording <em>Value</em> for each record.</p>\n\n<p>If an empty <em>Value</em> is met, edit the record and update <em>Value</em> to the recorded value. </p>\n\n<p>Continue until no more records.</p>\n"}], "owner": {"reputation": 1, "user_id": 6411978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfd7b42a42fb953028fbf69997945581?s=128&d=identicon&r=PG&f=1", "display_name": "RoyalDuck", "link": "https://stackoverflow.com/users/6411978/royalduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464857613, "creation_date": 1464821830, "last_edit_date": 1464826386, "question_id": 37580098, "link": "https://stackoverflow.com/questions/37580098/access-fill-in-value-for-empty-cell-from-same-row-different-record", "title": "Access: Fill In value for empty Cell from same row different record", "body": "<pre><code>Year|   Comp   |Value|\n----------------------\n2014|   XYZ    | 12  |          \n2015|   XYZ    | 15  |      \n2016|   XYZ    |Empty|      \n2017|   XYZ    | 30  |     \n2016|   ABC    |Empty|     \n2017|   ABC    |Empty|  \n2018|   ABC    | 12  |     \n</code></pre>\n\n<p>I want to fill in the value of Company XYZ Year(Now) from Year+1 or whatever \nis available next +1 or +2 \nResults should fill in like below : </p>\n\n<pre><code>Year: |2016| Comp|XYZ| Value|30|\n\nYear: |2016| Comp|ABC| Value|12| \n</code></pre>\n\n<p>I have tried a using IFF, however some show up with Error , Please help.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6378854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a7051cce34e2ecc278d01836be45846?s=128&d=identicon&r=PG&f=1", "display_name": "th65", "link": "https://stackoverflow.com/users/6378854/th65"}, "edited": false, "score": 0, "creation_date": 1464823770, "post_id": 37580365, "comment_id": 62647646, "body": "Thank you this works! Is there a way to have the user select the range as opposed to typing it? I know this code looks similar to:     area = Application.InputBox(Prompt:= _         &quot;Please Select a Range&quot;, _         Title:=&quot;InputBox Method&quot;, Type:=8) But how would I implement that in the function?"}, {"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "reply_to_user": {"reputation": 31, "user_id": 6378854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a7051cce34e2ecc278d01836be45846?s=128&d=identicon&r=PG&f=1", "display_name": "th65", "link": "https://stackoverflow.com/users/6378854/th65"}, "edited": false, "score": 0, "creation_date": 1465040567, "post_id": 37580365, "comment_id": 62741337, "body": "If you want to do that, then you will probably want to forget about using the  second Textbox altogether. Instead, create a macro and assign a button to the toolbar that pops up an InputBox to get the name to search for, then takes the selected Range and passes them both to the function in my code. That way, the user highlights a Range and then clicks a button. That would be a better way of doing it I think."}], "tags": [], "owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1464823483, "creation_date": 1464823483, "answer_id": 37580365, "question_id": 37580067, "link": "https://stackoverflow.com/questions/37580067/vba-i-need-to-write-both-a-function-and-a-calling-sub-to-do-the-following/37580365#37580365", "title": "VBA: I need to write both a function and a calling sub to do the following", "body": "<p>You need to actually call the Function that checks if it exists and pass the name and area variables that you've had the user input. Here is a somewhat crude example:</p>\n\n<pre><code>    Sub Main()\n\n    Dim nm As String\n    Dim ar As String\n\n    nm = InputBox(\"Enter a Name\")\n    ar = InputBox(\"Enter a Range\")\n\n    If NameExists(nm, ar) = True Then\n\n        MsgBox nm &amp; \" Has Been Found\"\n\n    Else\n\n        MsgBox nm &amp; \" Has Not Been Found\"\n\n    End If\n\n    End Sub\n\n    Private Function NameExists(name As String, area As String) As Boolean\n\n    Dim myRange As Range\n    Set myRange = Range(area)\n\n    For Each myCell In myRange\n\n        If myCell.Value = name Then\n\n            NameExists = True\n\n            Exit For\n\n        End If\n\n    Next\n\n    Set myRange = Nothing\n\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6378854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a7051cce34e2ecc278d01836be45846?s=128&d=identicon&r=PG&f=1", "display_name": "th65", "link": "https://stackoverflow.com/users/6378854/th65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 37580365, "answer_count": 1, "score": 0, "last_activity_date": 1464823483, "creation_date": 1464821594, "question_id": 37580067, "link": "https://stackoverflow.com/questions/37580067/vba-i-need-to-write-both-a-function-and-a-calling-sub-to-do-the-following", "title": "VBA: I need to write both a function and a calling sub to do the following", "body": "<p>In the main subroutine, I have to get two user inputs ((1) range address (e.g., A1:C50), (2) Name String (e.g., James)), and call the function subroutine (by passing the inputs as arguments), and printout the result through Message Box as to whether the name exists or doesn't exist in the range.</p>\n\n<p>Both the search range and the name should be input from the users. How do I write the Function subRoutine and the calling sub? This is what I have so far.</p>\n\n<pre><code>Function NameExists(name As String, area As Range) As Boolean\n\n\n\nIf name = area.Value Then\n    NameExists = True\n\nElse\n    NameExists = False\n\nEnd If\n\n\nEnd Function\n\n\n\nSub Main()\nDim NameExists As Boolean\nDim name As String\n\nname = InputBox(\"Enter a Name\")\narea = InputBox(\"Enter a Range\")\n\n\nIf NameExists = True Then\nMsgBox name &amp; \" Has Been Found\"\nElse\n MsgBox name &amp; \" Has Not Been Found\"\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1464827256, "post_id": 37579864, "comment_id": 62648568, "body": "Where in the script do you create worksheets? Were they not there originally?"}], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1464832121, "creation_date": 1464832121, "answer_id": 37581401, "question_id": 37579864, "link": "https://stackoverflow.com/questions/37579864/combine-copied-data-into-a-single-worksheet/37581401#37581401", "title": "Combine copied data into a single worksheet", "body": "<p>This line might causing you the trouble.</p>\n\n<pre><code>'Sheets(\"Sheet1\").Select\nWorkbooks(\"ZMasterFile.xlsx\").Worksheets(counter).Activate\n</code></pre>\n\n<p>On the secound line, you are activating worksheet(counter)</p>\n\n<p>I think you should put Worksheet(\"Sheet1\") if you want all the datas to be in same sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1464895333, "creation_date": 1464895333, "answer_id": 37600458, "question_id": 37579864, "link": "https://stackoverflow.com/questions/37579864/combine-copied-data-into-a-single-worksheet/37600458#37600458", "title": "Combine copied data into a single worksheet", "body": "<p>Of course.  Probably your best bet is to install the AddIn you find from the link below.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n\n<p>That tool is very useful!  Try it and you'll see!</p>\n\n<p>Also, see the link below.  You will see all the code exposed there, so it's a great learning example.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win008.htm</a></p>\n"}], "owner": {"reputation": 53, "user_id": 4902230, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/480d3ce52ae83ad621f46d4a3907e6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Anthropy", "link": "https://stackoverflow.com/users/4902230/anthropy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464895333, "creation_date": 1464820382, "question_id": 37579864, "link": "https://stackoverflow.com/questions/37579864/combine-copied-data-into-a-single-worksheet", "title": "Combine copied data into a single worksheet", "body": "<p>I am currently use a VBA script to combine data from multiple sheets and workbooks into a a new workbook. Currently the script does this but creates multiple sheets in the destination workbook. Is it possible to just has destination be a single sheet? </p>\n\n<pre><code>Sub copydata()\nDim FolderPath As String, FilePath As String, FileName As String\nFolderPath = \"C:\\attach\\\"\nFilePath = FolderPath &amp; \"*.xlsx\"\nFileName = Dir(FilePath)\n\n Dim erow As Long, lastrow As Long, lastcolumn As Long\n\n 'loops through directory as long as it is not blank and defines files as workbooks.\nDo While FileName &lt;&gt; \"\"\nDim wb As Workbook\nSet wb = Workbooks.Open(FolderPath &amp; FileName)\n'nested loop for sheets in workbooks\nFor counter = 3 To 9\n'Sheets(\u201cSheet1\u201d).Select\nwb.Worksheets(counter).Activate\nlastrow = ActiveSheet.Cells(Rows.count, 1).End(xlUp).Row\nlastcolumn = ActiveSheet.Cells(1, Columns.count).End(xlToLeft).Column\nRange(Cells(2, 1), Cells(lastrow, lastcolumn)).Copy\n\n'Sheets(\"Sheet1\").Select\nWorkbooks(\"ZMasterFile.xlsx\").Worksheets(counter).Activate\nerow = ActiveSheet.Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\nCells(erow, 1).Select\nActiveSheet.Paste\nNext\nwb.Close savechanges:=False\n\n FileName = Dir\n\nLoop\n\nerow = ActiveSheet.Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\nCells(erow, 1).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1464820208, "post_id": 37579728, "comment_id": 62646521, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "edited": false, "score": 0, "creation_date": 1464873702, "post_id": 37579869, "comment_id": 62670968, "body": "If I have the userform in a different workbook can it be called? I do have in a different Workbook a Userform to register the new patients. Now you may be asking yourself well if said workbook exist why you want to call it in the billing workbook, in case someone just walks in really quick for an emergency and don have time to fill it. Ideally in such situations what it would happen is I would open the billing system select new the patient registration form would appear and save the information in the patient registration form and then I can go back to the billing and select the patient."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1464820402, "creation_date": 1464820402, "answer_id": 37579869, "question_id": 37579728, "link": "https://stackoverflow.com/questions/37579728/can-a-cell-value-trigger-a-userform/37579869#37579869", "title": "Can a cell value trigger a userform?", "body": "<p>Eg: put this in the worksheet module and adjust references as appropriate</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const NEW_PAT As String = \"New Patient\"\n    Const RNG_NEW_PAT As String = \"B3\"\n    Dim c As Range\n    Set c = Target.Cells(1) 'in case multiple cells changed...\n\n    If c.Address = Me.Range(RNG_NEW_PAT).Address Then\n        If c.Value = NEW_PAT Then\n            'show userform\n        End If\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 37579869, "answer_count": 1, "score": 0, "last_activity_date": 1464820402, "creation_date": 1464819700, "last_edit_date": 1531161705, "question_id": 37579728, "link": "https://stackoverflow.com/questions/37579728/can-a-cell-value-trigger-a-userform", "title": "Can a cell value trigger a userform?", "body": "<p>I'm creating a small billing system in Excel for a Dental Office (Just mentioning it in case someone has any tips/tricks/suggestions on cool ideas not really related to the issue i'm facing). I have a small template for creating invoices in one of the cells I have a data validation for selecting the patient, I was wondering if in the list the name selected is \"New Patient\" a UserForm can pop up to input the new patient information?</p>\n"}, {"tags": ["vba", "excel", "for-loop", "listobject"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464820650, "post_id": 37579773, "comment_id": 62646681, "body": "So, correct me if I am wrong. I still have not tried this yet...does this negate the need for my first i loop, coded in my question? From what I am reading, it seems like it would with the &#39;.ListColumns.Add&#39; included the WITH statement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464821439, "post_id": 37579773, "comment_id": 62646948, "body": "In your original (as above) there would be another line directly after <code>oLC.Name = colNames(i)</code> with something like <code>oLC.DataBodyRange.FormulaR1C1 = r1c1s(i)</code>."}, {"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464821741, "post_id": 37579773, "comment_id": 62647049, "body": "Okay I&#39;m with you, thanks. You&#39;re way is much more efficient. I never saw the LBound and UBound function before today. Worked great too."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1464819905, "creation_date": 1464819905, "answer_id": 37579773, "question_id": 37579608, "link": "https://stackoverflow.com/questions/37579608/need-a-loop-to-enter-formulas-data-in-excel-table-columns/37579773#37579773", "title": "Need a loop to enter formulas/data in excel table columns", "body": "<p>Construct one more variant array containing the formulas/values you want to populate the new table columns with.</p>\n\n<pre><code>Sub insertTableColumn()\n    Dim lst As ListObject\n    Dim currentSht As Worksheet\n    Dim h As Long, hdrs As Variant, r1c1s As Variant\n\n    hdrs = Array(\"AHT\", \"Target AHT\", \"Transfers\", \"Target Transfers\")\n    r1c1s = Array(\"=([@[Inbound Talk Time (Seconds)]]+[@[Inbound Hold Time (Seconds)]]+[@[Inbound Wrap Time (Seconds)]])/[@[Calls Handled]]\", _\n                    350, _\n                    \"=[@[Call Transfers and/or Conferences]]/[@[Calls Handled]]\", _\n                    0.15)\n\n    Set currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set lst = ActiveSheet.ListObjects(\"Table1\")\n\n    With lst 'ActiveSheet.ListObjects(\"Table1\")\n        For h = LBound(hdrs) To UBound(hdrs)\n            .ListColumns.Add\n            .ListColumns(.ListColumns.Count).Name = hdrs(h)\n            .ListColumns(.ListColumns.Count).DataBodyRange.FormulaR1C1 = r1c1s(h)\n        Next h\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've also used pairs in a single array with <code>h = LBound(hdrs) To UBound(hdrs) Step 2</code> and <code>hdrs(h+1)</code> for the formulas/values.</p>\n"}], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 37579773, "answer_count": 1, "score": 1, "last_activity_date": 1464820111, "creation_date": 1464819041, "last_edit_date": 1464820111, "question_id": 37579608, "link": "https://stackoverflow.com/questions/37579608/need-a-loop-to-enter-formulas-data-in-excel-table-columns", "title": "Need a loop to enter formulas/data in excel table columns", "body": "<p>I am in need of a nested loop to add formulas to 4 particular columns in my table (\"Table1\"). I would like my For loop to mimic the previous For loop regarding the naming of these same 4 additional columns (\"colNames\").</p>\n\n<p>The bottom portion of this code works just fine, but I would like to know how to work it into a loop. </p>\n\n<pre><code>Sub attStatPivInsertTableColumns_2()\nDim lst As ListObject\nDim currentSht As Worksheet\nDim colNames As Variant, formNames As Variant '&lt;~~ NOTE: As Varient, this is your go to when working with arrays\nDim oLC As ListColumn, oLData As Variant\nDim i As Integer, d As Integer\n\nSet currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\nSet lst = ActiveSheet.ListObjects(\"Table1\")\n\ncolNames = Array(\"AHT\", \"Target AHT\", \"Transfers\", \"Target Transfers\")\n\n    For i = 0 To UBound(colNames) \n        Set oLC = lst.ListColumns.Add\n        oLC.Name = colNames(i)\n    Next i\n          ***Below is the code that needs to be looped***                                \n'lst.ListColumns(\"Target AHT\").DataBodyRange.FormulaR1C1 = \"=350\"\n'lst.ListColumns(\"Target Transfers\").DataBodyRange.FormulaR1C1 = \"=0.15\"\n'lst.ListColumns(\"AHT\").DataBodyRange.FormulaR1C1 = \"=([@[Inbound Talk Time (Seconds)]]+[@[Inbound Hold Time (Seconds)]]+[@[Inbound Wrap Time (Seconds)]])/[@[Calls Handled]]\"\n'lst.ListColumns(\"Transfers\").DataBodyRange.FormulaR1C1 = \"=[@[Call Transfers and/or Conferences]]/[@[Calls Handled]]\"\n\nEnd Sub\n</code></pre>\n\n<p>Here is what I am going for so far, but I am running into errors, for what are probably obvious reasons:</p>\n\n<pre><code>formNames = Array(\"=([@[Inbound Talk Time (Seconds)]]+[@[Inbound Hold Time (Seconds)]]+[@[Inbound Wrap Time (Seconds)]])/[@[Calls Handled]]\", \"=350\", \"=[@[Call Transfers and/or Conferences]]/[@[Calls Handled]]\", \"=0.15\")\nFor d = 0 To UBound(formNames)\n    For i = 0 To UBound(colNames)\n        Set oLData = lst.ListColumns(i).DataBodyRange.FormulaR1C1 = \"d\"\n    Next i\nNext d\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1464817169, "creation_date": 1464817169, "answer_id": 37579247, "question_id": 37579041, "link": "https://stackoverflow.com/questions/37579041/vba-range-find-nested-in-another-range-find/37579247#37579247", "title": "VBA: Range.Find nested in another Range.Find", "body": "<p>When you set one Range to another Range both objects point to the exact same thing. This is different from everything else we use in VBA, where the second object becomes an independant copy of the first.</p>\n\n<p>In order to create a second Range based on another, but independent of it you need the<code>Duplicate</code> property. So:</p>\n\n<pre><code>Set inR = R.Duplicate\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6411696, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-flzDD8e0-Vg/AAAAAAAAAAI/AAAAAAAAACU/xSrL1CDrcuE/photo.jpg?sz=128", "display_name": "Jake Webber", "link": "https://stackoverflow.com/users/6411696/jake-webber"}, "edited": false, "score": 0, "creation_date": 1464820023, "post_id": 37579464, "comment_id": 62646463, "body": "Good find, I used <code>Set inR = R.Duplicate</code>, but that did not fix my problem. inR still covers the entire range of R after <code>.execute</code>. I&#39;m thinking the problem is coming from using and saving <code>.execute</code> properly."}], "tags": [], "owner": {"reputation": 21, "user_id": 6386512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hWQVMph3yac/AAAAAAAAAAI/AAAAAAAABXQ/hNRQ1msAdq8/photo.jpg?sz=128", "display_name": "Israel Ramirez", "link": "https://stackoverflow.com/users/6386512/israel-ramirez"}, "is_accepted": false, "score": 0, "last_activity_date": 1464818225, "creation_date": 1464818225, "answer_id": 37579464, "question_id": 37579041, "link": "https://stackoverflow.com/questions/37579041/vba-range-find-nested-in-another-range-find/37579464#37579464", "title": "VBA: Range.Find nested in another Range.Find", "body": "<p>If you set Set inR = R and then execute the find command on inR, R will also change. This is unlike Excel. If you know the C language, it helps to think of a range variable as being a pointer. Using Set inR = R means that both variables point to the same thing; altering one, alters the other. </p>\n\n<p>One way to work around that is to store R.Start and R.End as integers before searching and then, after you complete your inner search, you can recreate R from activedocument.Range(r.Start,r.End).</p>\n"}], "owner": {"reputation": 23, "user_id": 6411696, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-flzDD8e0-Vg/AAAAAAAAAAI/AAAAAAAAACU/xSrL1CDrcuE/photo.jpg?sz=128", "display_name": "Jake Webber", "link": "https://stackoverflow.com/users/6411696/jake-webber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 37579247, "answer_count": 2, "score": 0, "last_activity_date": 1464981360, "creation_date": 1464816317, "last_edit_date": 1464981360, "question_id": 37579041, "link": "https://stackoverflow.com/questions/37579041/vba-range-find-nested-in-another-range-find", "title": "VBA: Range.Find nested in another Range.Find", "body": "<p>In my code, I'm splitting a word document into many using  <code>Range.Find</code> to select a body of text (startoftext*endoftext) and then saving it. Within this selected body of text, I'm trying to use a nested 'Range.Find' call to search the selected body of text for the bolded header and use it as the SaveAs[FileName]. </p>\n\n<p>With the current code, everything works except the nested <code>Range.Text</code> returns all text within the initial set range.</p>\n\n<pre><code>Sub DocSplitter()\n\nDim R As Range\nDim inR As Range\nSet R = ActiveDocument.Range.Duplicate\nDim name As String\nApplication.ScreenUpdating = False\n\nWith R.Find\n    .Text = \"^m*^l^t^l\" ' &lt;- Copies all text from ^m to \"^l^t^l\"\n    .MatchWildcards = True\n    While .Execute\n        Set inR = R.Duplicate '&lt;- Setting Range equal to selected text range\n        With inR.Find\n            .Format = True\n            .Font.Bold = True\n            .Text = \"^13([0-9]).([0-9])*^13^13\" '&lt;- Selecting header within\n            .MatchWildcards = True\n            .Execute\n        End With\n        CopyAndSave R, inR\n    Wend\nEnd With\nR.Collapse wdCollapseEnd\nR.End = R.Parent.Range.End\nCopyAndSave R, inR\n\nEnd Sub\n\n\n\n\nStatic Sub CopyAndSave(R As Range, inR As Range)\nDim D As Document\nDim Count As Long\nCount = Count + 1\nR.Copy\nSet D = Documents.Add\nD.Range.PasteAndFormat wdFormatOriginalFormatting\nD.SaveAs R.Parent.Path &amp; Application.PathSeparator &amp; _\ninR.Text, wdFormatFilteredHTML '&lt;-- File Name ERROR: Too long\nD.Close\n\nEnd Sub\n</code></pre>\n\n<p>so inR.Text returns the entire text selected by R.Find.Execute.\nAny Ideas?</p>\n\n<p>Edit: I updated <code>Set inR = R.Duplicate</code>, thanks for that catch. My problem turned out to be a formatting issue with the headers.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 6242520, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f069a68a5d3601ecf61ec9baa129d3a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ariel", "link": "https://stackoverflow.com/users/6242520/ariel"}, "edited": false, "score": 0, "creation_date": 1464817542, "post_id": 37579222, "comment_id": 62645539, "body": "thank you, however &quot;.FullSeriesCollection(1).XValues &quot; caused an error in my sub"}], "tags": [], "owner": {"reputation": 21, "user_id": 6386512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hWQVMph3yac/AAAAAAAAAAI/AAAAAAAABXQ/hNRQ1msAdq8/photo.jpg?sz=128", "display_name": "Israel Ramirez", "link": "https://stackoverflow.com/users/6386512/israel-ramirez"}, "is_accepted": false, "score": 0, "last_activity_date": 1464817122, "last_edit_date": 1464817122, "creation_date": 1464817033, "answer_id": 37579222, "question_id": 37579023, "link": "https://stackoverflow.com/questions/37579023/vba-create-chart-and-remove-a-series/37579222#37579222", "title": "VBA create chart and remove a series", "body": "<p>There is a FullSeriesCollection property you can use to define the header:</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart.Select\nWith ActiveChart\n    .SetSourceData Source:=Range(\"B180:H182\")\n    .FullSeriesCollection(1).XValues = \"='eod summary'!$B$178:$H$178\"\n  .ChartType = xlAreaStacked\n  .Axes(xlCategory).CategoryType = xlCategoryScale\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1464817173, "creation_date": 1464817173, "answer_id": 37579249, "question_id": 37579023, "link": "https://stackoverflow.com/questions/37579023/vba-create-chart-and-remove-a-series/37579249#37579249", "title": "VBA create chart and remove a series", "body": "<p>Your range references are hard-coded; if this is always true then build a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"nofollow\">Union</a> reference to be used for the SetSourceData .</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart.Select\nWith ActiveChart\n  'shorthand method\n  .SetSourceData Source:=Range(\"'eod summary'!$B$178:$H$178,'eod summary'!$B$180:$H$182\")\n  'Union(..., ...) method; more verbose but also more explanatory\n  '.SetSourceData Source:=Union(Range(\"'eod summary'!$B$178:$H$178\"), _\n                                Range(\"'eod summary'!$B$180:$H$182\"))\n  .ChartType = xlAreaStacked\n  .Axes(xlCategory).CategoryType = xlCategoryScale\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 788, "user_id": 6242520, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f069a68a5d3601ecf61ec9baa129d3a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ariel", "link": "https://stackoverflow.com/users/6242520/ariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 37579249, "answer_count": 2, "score": 2, "last_activity_date": 1464868066, "creation_date": 1464816228, "last_edit_date": 1464868066, "question_id": 37579023, "link": "https://stackoverflow.com/questions/37579023/vba-create-chart-and-remove-a-series", "title": "VBA create chart and remove a series", "body": "<p>I am able to create a chart for a set of data. I do not want to include the data from row 179 in the chart, however I need to keep it within the sheet. </p>\n\n<p>How would I modify my chart to take row 178 (header) and row 180:182 as data series by modifying the below code?</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart.Select\nWith ActiveChart\n  .SetSourceData Source:=Range(\"'eod summary'!$B$178:$H$182\")\n  .ChartType = xlAreaStacked\n  .Axes(xlCategory).CategoryType = xlCategoryScale\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1464813435, "post_id": 37578213, "comment_id": 62643483, "body": "You are prefacing <code>.Cells(...</code> and <code>.Rows...</code> with a period (e.g. <code>.</code> or <i>full stop</i>). This manner of cell referencing is intended to be used within a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a>. Start by remving the period or adding a With ... End With."}, {"owner": {"reputation": 33, "user_id": 5956421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95e64199fbfce288642b7a1f39ce972b?s=128&d=identicon&r=PG", "display_name": "trevor_bye", "link": "https://stackoverflow.com/users/5956421/trevor-bye"}, "edited": false, "score": 0, "creation_date": 1464813887, "post_id": 37578213, "comment_id": 62643739, "body": "@Jeeped thanks, that got it to run without any errors. However, it gave some obscure results. It pasted the values in column B, but nothing in column A (on the Summary Sheet). Additionally, it skipped some random rows here and there; any suggestions? FWIW, there are over 300 sheets in this ridiculous report."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5956421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95e64199fbfce288642b7a1f39ce972b?s=128&d=identicon&r=PG", "display_name": "trevor_bye", "link": "https://stackoverflow.com/users/5956421/trevor-bye"}, "edited": false, "score": 0, "creation_date": 1464814350, "post_id": 37578472, "comment_id": 62644012, "body": "thanks for your help, your explanation makes perfect sense. I was trying to figure out the purpose of the With..EndWith.. and that makes sense that attaches that parent reference to the children. I was able to get it working by adding ws.Select above the first block of the loop, but I&#39;ll work on refactoring it to get it to run faster and look more professional. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1464813968, "last_edit_date": 1495535338, "creation_date": 1464813968, "answer_id": 37578472, "question_id": 37578213, "link": "https://stackoverflow.com/questions/37578213/simple-vba-script-error/37578472#37578472", "title": "Simple VBA Script Error", "body": "<p>You can avoid using .Select\u00b9 by constructing a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> that passes the parent worksheet reference along to the cells and range references. Direct value transfer is more expedient and more efficient than copying and pasting. Additionally, it avoids involving the clipboard altogether.</p>\n\n<pre><code>Sub Macro7()\n    Dim ws As Worksheet\n    Dim lastRow As Long\n    Dim summaryRow As Long\n\n    summaryRow = 1\n\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n            If LCase(.Name) &lt;&gt; \"summary\" Then\n                Worksheets(\"Summary\").Range(\"A\" &amp; summaryRow).Resize(1, 2) = _\n                    Array(.Range(\"A2\").Value, .Cells(Rows.Count, \"L\").End(xlUp).Value)\n                summaryRow = summaryRow + 1\n            End If\n        End With\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 1, "last_activity_date": 1464814406, "creation_date": 1464814406, "answer_id": 37578577, "question_id": 37578213, "link": "https://stackoverflow.com/questions/37578213/simple-vba-script-error/37578577#37578577", "title": "Simple VBA Script Error", "body": "<p>Your code looks fine apart from the '.' reference Jeeped pointed out.</p>\n\n<p>I have just neatened up your code here as using .select is a little messy and long-winded (if you are building big macros it can add unnecessary work and slow it down a lot).</p>\n\n<p>You can just do the commands straight from a range reference as shown below:</p>\n\n<pre><code>     Sub Macro7()\n\n        Dim ws As Worksheet\n        Dim lastRow As Integer\n        Dim summaryRow As Integer\n\n            summaryRow = 1\n\n        For Each ws In ActiveWorkbook.Worksheets\n\n        'Copy item number and paste on Summary Page'\n\n            Range(\"A2\").Copy\n            Sheets(\"Summary\").Range(\"A\" &amp; summaryRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n\n        'Copy corresponding BOM item # and paste on Summary Page'\n\n            lastRow = ws.Cells(Rows.Count, \"L\").End(xlUp).Row\n            Application.CutCopyMode = False\n            ws.Range(\"L\" &amp; lastRow).copy\n            Sheets(\"Summary\").Range(\"B\" &amp; summaryRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n\n            summaryRow = summaryRow + 1\n\n                Next ws\n        End Sub\n</code></pre>\n\n<p>I typically code out worksheets(\"\").Range(\"\").action everytime unless I am doing a lot of work on 1 sheet so that I can see easily what is going on when I glance over, but you'll find your own preference to working (don't forget you can step through your code with F8 to look at what it is doing every step of the way)</p>\n\n<p>I hope this helps you start your VBA journey!</p>\n"}], "owner": {"reputation": 33, "user_id": 5956421, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/95e64199fbfce288642b7a1f39ce972b?s=128&d=identicon&r=PG", "display_name": "trevor_bye", "link": "https://stackoverflow.com/users/5956421/trevor-bye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "closed_date": 1464845234, "answer_count": 2, "score": -1, "last_activity_date": 1464814406, "creation_date": 1464813024, "question_id": 37578213, "link": "https://stackoverflow.com/questions/37578213/simple-vba-script-error", "closed_reason": "Needs more focus", "title": "Simple VBA Script Error", "body": "<p>I'm still pretty new with VBA (learning for work, coming from a JS background) and I need a little help with this. My goal is: loop through each worksheet (except the \"Summary\" sheet, although I'm not sure how to exclude this from the loop) in the workbook and copy A2 in each sheet, as well as the last cell containing a value in column L of each sheet, and paste those next to each other in columns A and B on the \"Summary Sheet\", respectively. I'm not an expert with VBA syntax by any means, so if anyone has any way to refactor this (I know I don't need all the .select methods), I would appreciate it. Right now I'm getting an \"invalid or unqualified reference\" error on line 28. My goal is to learn, so if you have any input I would appreciate a short explanation of the logic. Thanks.</p>\n\n<pre><code>            Sub Macro7()\n            '\n            ' Macro7 Macro\n            '\n            ' Keyboard Shortcut: Ctrl+c\n\n\n            Dim ws As Worksheet\n            Dim lastRow As Integer\n            Dim summaryRow As Integer\n\n                summaryRow = 1\n\n            For Each ws In ActiveWorkbook.Worksheets\n\n            'Copy item number and paste on Summary Page'\n\n                Range(\"A2\").Select\n                Selection.Copy\n                Sheets(\"Summary\").Select\n                Range(\"A\" &amp; summaryRow).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n            'Copy corresponding BOM item # and paste on Summary Page'\n\n                ws.Select\n                lastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row\n                Range(\"L\" &amp; lastRow).Select\n                Application.CutCopyMode = False\n                Selection.Copy\n                Sheets(\"Summary\").Select\n                Range(\"B\" &amp; summaryRow).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n                summaryRow = summaryRow + 1\n\n                    Next ws\n            End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 112, "user_id": 4930333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/373773996165145/picture?type=large", "display_name": "Kzhel Farmer", "link": "https://stackoverflow.com/users/4930333/kzhel-farmer"}, "edited": false, "score": 0, "creation_date": 1464813169, "post_id": 37578184, "comment_id": 62643353, "body": "I am not expert but i think your condition or something to do in IF code"}, {"owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "edited": false, "score": 0, "creation_date": 1464813180, "post_id": 37578184, "comment_id": 62643359, "body": "I see two <code>with</code> but only one <code>end with</code> statements"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1464813474, "post_id": 37578184, "comment_id": 62643509, "body": "Your code is specifically set to NOT update if the cell next to the target cell is blank: <code>If cF.Offset(0, 1) &lt;&gt; vbNullString Then</code> so you&#39;ll either need to add an <code>Else</code> statement, or remove that condition."}, {"owner": {"reputation": 25, "user_id": 6389613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a829a57596531e4fd10b696f59ef7496?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Lost", "link": "https://stackoverflow.com/users/6389613/stack-lost"}, "reply_to_user": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "edited": false, "score": 1, "creation_date": 1464813527, "post_id": 37578184, "comment_id": 62643539, "body": "@G&#244;T&#244; that is not missing in real code only error here but its updated"}, {"owner": {"reputation": 25, "user_id": 6389613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a829a57596531e4fd10b696f59ef7496?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Lost", "link": "https://stackoverflow.com/users/6389613/stack-lost"}, "edited": false, "score": 0, "creation_date": 1464815001, "post_id": 37578184, "comment_id": 62644346, "body": "I know i am doing some basic mistake"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1464815394, "post_id": 37578184, "comment_id": 62644544, "body": "That final If statement... <code>If Not cF is Nothing Then</code>.  In the <code>Else</code>, where <code>cF</code> is Nothing, you are referring to <code>cF.Row</code>?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464817724, "post_id": 37578184, "comment_id": 62645603, "body": "<i>&quot;with else its updating value in Column AB not in AA&quot;</i> : are you sure? It looks to me that AB column is grabbed by &quot;Set cF = cF.End(xlToRight).Offset(0, 25)&quot;. But I can&#39;t grasp your goal: maybe you want to edit question adding examples of what you are trying to achieve"}], "answers": [{"tags": [], "owner": {"reputation": 112, "user_id": 4930333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/373773996165145/picture?type=large", "display_name": "Kzhel Farmer", "link": "https://stackoverflow.com/users/4930333/kzhel-farmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1464816433, "creation_date": 1464816433, "answer_id": 37579065, "question_id": 37578184, "link": "https://stackoverflow.com/questions/37578184/excel-vba-user-form-update-button/37579065#37579065", "title": "Excel VBA user-form update button", "body": "<p>I did that just on basis of hit n trial and it works</p>\n\n<pre><code>   `Private Sub CommandButton3_Click()\n    Dim irow As Long, _\n    wS As Worksheet, _\n    NextRow As Long, _\n   cF As Range\n   Set wS = Worksheets(\"stock\")\n   With wS\n   With .Range(\"A:A\")\n\n    Set cF = .Find(What:=Me.ComboBox2.value, _\n            After:=.Cells(1, 1), _\n            LookIn:=xlValues, _\n            LookAt:=xlWhole, _\n            SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, _\n            MatchCase:=False, _\n            SearchFormat:=False)\n\n .Cells(cF.row, \"AA\").value = Me.TextBox2.value + .Cells(cF.row,   \"AA\").value\n End With\n End Sub`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 6565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hiWts.jpg?s=128&g=1", "display_name": "kadrleyn", "link": "https://stackoverflow.com/users/6565786/kadrleyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1577386661, "creation_date": 1577386661, "answer_id": 59492368, "question_id": 37578184, "link": "https://stackoverflow.com/questions/37578184/excel-vba-user-form-update-button/59492368#59492368", "title": "Excel VBA user-form update button", "body": "<p>You can adapt the following codes :</p>\n\n<pre><code>Private Sub CommandButton2_Click() 'Change Button\nDim sonsat As Long\n\nIf ListBox1.ListIndex = -1 Then\nMsgBox \"Choose an item\", vbExclamation, \"\"\nExit Sub\nEnd If\nlastrow = Sheets(\"Data\").Cells(Rows.count, 1).End(xlUp).Row\nSheets(\"Data\").Range(\"A2:A\" &amp; lastrow).Find(What:=ListBox1.Text, LookIn:=xlValues, LookAt:=xlWhole).Activate\nsonsat = ActiveCell.Row\nCells(sonsat, 1) = TextBox1.Text\nCells(sonsat, 2) = TextBox2.Text\nCells(sonsat, 3) = TextBox3.Text\nCells(sonsat, 4) = TextBox4.Text\nCells(sonsat, 5) = TextBox5.Text\nCells(sonsat, 6) = TextBox6.Text\nCells(sonsat, 7) = TextBox7.Text\nCells(sonsat, 8) = TextBox8.Text\nCells(sonsat, 9) = TextBox9.Text\nCells(sonsat, 10) = TextBox10.Text\nCells(sonsat, 11) = TextBox11.Text\nCells(sonsat, 12) = TextBox12.Text\nCells(sonsat, 13) = TextBox16\nCells(sonsat, 14) = TextBox17\nCells(sonsat, 15) = TextBox18\n\nCall Main 'Progress Bar\nMsgBox \"Item has been updated\", vbApplicationModal, \"\"\nListBox1.List = Sheets(\"Data\").Range(\"A2:O\" &amp; Sheets(\"Data\").Cells(Rows.count, 1).End(xlUp).Row).Value\nEnd Sub\n</code></pre>\n\n<p>Userform codes (data insert, delete, update, search by column data, listbox with 15 columns, data copy, progressbar) ,you can review from this <a href=\"https://www.technologicaltipstools.online/2016/11/new-updated-userform-15-column-more.html\" rel=\"nofollow noreferrer\">source</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 6389613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a829a57596531e4fd10b696f59ef7496?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Lost", "link": "https://stackoverflow.com/users/6389613/stack-lost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 37579065, "answer_count": 2, "score": 1, "last_activity_date": 1577386661, "creation_date": 1464812902, "last_edit_date": 1464815419, "question_id": 37578184, "link": "https://stackoverflow.com/questions/37578184/excel-vba-user-form-update-button", "title": "Excel VBA user-form update button", "body": "<p>Update button works if there is value in cells beside the target cell\ncan not find the problem in this code.</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim irow As Long, _\nwS As Worksheet, _\nNextRow As Long, _\ncF As Range\nSet wS = Worksheets(\"stock\")\nWith wS\n    With .Range(\"A:A\")\n\n        Set cF = .Find(What:=Me.ComboBox2.value, _\n                After:=.Cells(1, 1), _\n                LookIn:=xlValues, _\n                LookAt:=xlWhole, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False, _\n                SearchFormat:=False)\n    End With\n\n If Not cF Is Nothing Then\n    If cF.Offset(0, 1) &lt;&gt; vbNullString Then\n        Set cF = cF.End(xlToRight).Offset(0, 25)\n        cF.value = Me.TextBox2.value + .Cells(cF.row, \"AA\").value\n    End If\n Else\n   .Cells(cF.row, \"AA\").value = Me.TextBox2.value + .Cells(cF.row,   \"AA\").value\n End If\n</code></pre>\n\n<p>End With\n End Sub</p>\n\n<p>if Target cell is AA2 then there should be value in  Z2 or B2 otherwise nothing happens.</p>\n\n<p>Just added ELSE statement but with else its updating value in Column AB not in AA</p>\n\n<p><a href=\"https://i.stack.imgur.com/kA4K2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kA4K2.jpg\" alt=\"form\"></a> </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1464812271, "post_id": 37577570, "comment_id": 62642903, "body": "Why do you need to be re-linking the back end all the time? Unless you have multiple back ends or you are changing the structure of the tables, once linked once they should stay linked. If they do not, you have some other issue. Also if you have concurrent users, having a user manually re-link the back end will break everybody else who is using the same front end file. There is a way to do what you want but you should focus on fixing your issue instead of band-aiding it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user820304"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1464813119, "post_id": 37577570, "comment_id": 62643320, "body": "There are certain business reasons that causes a need for the back-end to be moved semi-frequently. On top of that, there are business reasons that creates a need for Joe Schmoe to be able to link to the new back-end location with minimal effort."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1464813479, "post_id": 37577570, "comment_id": 62643513, "body": "Look into <code>DoCmd.TransferDatabase acLink</code> for linking a table with VBA <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196455.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196455.aspx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user820304"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1464875170, "post_id": 37577570, "comment_id": 62672174, "body": "@SunKnight0 Exactly what I was looking for. Want to post that as an answer?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1464882615, "post_id": 37577570, "comment_id": 62678174, "body": "Sure, I just did, thanks. Let me know if you need mode detail. I don&#39;t really use that for Access to Access but I have SQL server to Access examples."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1464882529, "creation_date": 1464882529, "answer_id": 37596569, "question_id": 37577570, "link": "https://stackoverflow.com/questions/37577570/fix-database-link-error-3044/37596569#37596569", "title": "Fix database link - Error 3044?", "body": "<p>Look into DoCmd.TransferDatabase acLink for linking a table with VBA msdn.microsoft.com/en-us/library/office/ff196455.aspx</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user820304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 37596569, "answer_count": 1, "score": 0, "last_activity_date": 1464882529, "creation_date": 1464810597, "last_edit_date": 1464875205, "question_id": 37577570, "link": "https://stackoverflow.com/questions/37577570/fix-database-link-error-3044", "title": "Fix database link - Error 3044?", "body": "<p>I have an Access database originally developed in Access 2003 or 2007 that I have inherited. This database is split as a Front-End and Back-End, and I have come across a need to programmatically re-link the back-end due to the technical competence of the people that will be handling this database.</p>\n\n<p>Problem is I get an error 3044 (not a valid path) when attempting to re-link two tables, the rest re-link just fine. The error message displays the original, defunct back-end file in a directory that does not exist. I was able to gleam the cause of the issue from <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-access/access-2010-linked-table-manager-will-not-accept/fcd4afd7-9432-4fc6-b281-5a2b83041a3f?page=1&amp;auth=1\" rel=\"nofollow\">this thread</a>:</p>\n\n<blockquote>\n  <p>\"After looking through the issue, it appears the reason you are seeing a problem with these 8 specific tables is because they each have at least one memo field within them that has version history turned on (append only property set to yes).  When this property is set to \u201cyes\u201d, it stores additional information about these linked tables within one of the system tables and for whatever reason after the table is initially linked it seems to retain this original link information about these tables.\"\n  sounds like a MS Access bug, but there you go.  i set those to \"no\", and so far all is just fine! </p>\n</blockquote>\n\n<p>This appears to match the behavior, and the solution does indeed work in a defunct version. However we would prefer to keep the option \"Append Only\" for our tables.</p>\n\n<p>I can delete the linked tables from my front-end and add them back in, and it appears to work fine (ie not breaking anything, yet) for my personal test. Now I want to do this programmatically.</p>\n\n<p>How can I programmatically handle error 3044 and delete/re-add the tables?</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464814216, "post_id": 37577907, "comment_id": 62643944, "body": "Thanks for the bit about the zero-based index. I certainly would have questioned the 0."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1464811861, "creation_date": 1464811861, "answer_id": 37577907, "question_id": 37577495, "link": "https://stackoverflow.com/questions/37577495/excel-vba-add-new-table-columns-with-specific-header-names/37577907#37577907", "title": "Excel VBA - Add new table columns with specific header names", "body": "<p>A variant array is a good place to store the variables in a looped sequence.</p>\n\n<pre><code>Sub insertTableColumn()\n    Dim lst As ListObject\n    Dim currentSht As Worksheet\n    Dim h As Long, hdrs As Variant\n\n    hdrs = Array(\"AHT\", \"Target AHT\", \"Transfers\", \"Target Transfers\")\n\n    Set currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set lst = ActiveSheet.ListObjects(\"Table1\")\n\n    With lst 'ActiveSheet.ListObjects(\"Table1\")\n        For h = 0 To 3\n            .ListColumns.Add\n            .ListColumns(.ListColumns.Count).Name = hdrs(h)\n        Next h\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>When creating an array of strings in this manner, remember that the variant array's index is zero-based by default.</p>\n"}, {"comments": [{"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464814125, "post_id": 37577979, "comment_id": 62643874, "body": "Thank you very much for that introduction to the UBound Function. I had not run into that before.  Just a quick general question - If I wanted to declare your &quot;ColumnNames&quot; variable, how would I do so? I tried to declare it as a string and my code generated an error. What is best practice for declaring variables you are going to use as an array? Thanks again!"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1464814604, "post_id": 37577979, "comment_id": 62644156, "body": "You can just use <code>Dim ColumnNames As Variant</code> (I should have added that line to be honest), but if you don&#39;t specify what a variable type is, VBA will automatically define it as Variant, which will accept pretty much any type really, so you could get away with simply <code>Dim ColumnNames</code> :)"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1464812146, "creation_date": 1464812146, "answer_id": 37577979, "question_id": 37577495, "link": "https://stackoverflow.com/questions/37577495/excel-vba-add-new-table-columns-with-specific-header-names/37577979#37577979", "title": "Excel VBA - Add new table columns with specific header names", "body": "<p>The following code creates an array of the column names you want to add, then loops as many times as there are headers to add and sets the name at the same time.</p>\n\n<pre><code>Sub insertTableColumn()\nDim lst As ListObject\nDim currentSht As Worksheet\n\nSet currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\nSet lst = ActiveSheet.ListObjects(\"Table1\")\nColumnNames = Array(\"AHT\", \"Target AHT\", \"Transfers\", \"Target Transfers\")\n\n' below is the code that I would like to have looped\nFor iLoop = 0 to UBound(ColumnNames)\n    Set oLC = lst.ListColumns.Add\n    oLC.Name = ColumnNames(iLoop)\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12735, "favorite_count": 1, "accepted_answer_id": 37577907, "answer_count": 2, "score": 1, "last_activity_date": 1464812146, "creation_date": 1464810344, "last_edit_date": 1464811444, "question_id": 37577495, "link": "https://stackoverflow.com/questions/37577495/excel-vba-add-new-table-columns-with-specific-header-names", "title": "Excel VBA - Add new table columns with specific header names", "body": "<p>I have a simple vba question. I want a macro that will add exactly 4 new columns in my table object, (\"Table1\"). I would also like these to be named in order, from left to right: </p>\n\n<p>AHT, Target AHT, Transfers, Target Transfers</p>\n\n<p>The code I have below adds the columns just fine, but I am not sure how to name one individually. Also, could someone please show me how to loop that section of code. Thanks! </p>\n\n<pre><code>Sub insertTableColumn()\nDim lst As ListObject\nDim currentSht As Worksheet\n\nSet currentSht = ActiveWorkbook.Sheets(\"Sheet1\")\nSet lst = ActiveSheet.ListObjects(\"Table1\")\n\n'below is the code that I would like to have looped\n    lst.ListColumns.Add\n    lst.ListColumns.Add\n    lst.ListColumns.Add\n    lst.ListColumns.Add\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1464809486, "post_id": 37577187, "comment_id": 62641407, "body": "Check to see if the named range that you are setting is scoped to a different worksheet. For example, if a named range (<code>Area1</code>) is set to <code>Sheet1!A1:10</code>, you can&#39;t type <code>Sheets(&quot;Sheet2&quot;).PageSetup.PrintArea = &quot;Area1&quot;</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1464809771, "post_id": 37577187, "comment_id": 62641566, "body": "It&#39;s not. This was all working perfectly before."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464810001, "post_id": 37577187, "comment_id": 62641690, "body": "Perfectly before what?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 4, "creation_date": 1464810069, "post_id": 37577187, "comment_id": 62641722, "body": "In the first 2 <code>Case</code>s you have a literal string. In the 3rd and 4th <code>Case</code>s you have <code>.Name = literal</code>. Was that intentional?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464810104, "post_id": 37577187, "comment_id": 62641745, "body": "@TimWilliams <a href=\"http://codereview.stackexchange.com/questions/129856/print-worksheets-depending-on-checkbox-slower-than-before#129859\">looooong story</a>. Doubt anyone would care to follow XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464810619, "post_id": 37577187, "comment_id": 62642007, "body": "lol why the downvote?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1467239702, "post_id": 37577187, "comment_id": 63655835, "body": "Yep. Alive and well. Busy...  Contract work, job, family, had to refocus.. I&#39;ll be around/back."}], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 3, "last_activity_date": 1464810360, "creation_date": 1464810360, "answer_id": 37577498, "question_id": 37577187, "link": "https://stackoverflow.com/questions/37577187/reference-must-be-on-the-active-sheet-error/37577498#37577498", "title": "Reference must be on the active sheet error", "body": "<p>In the first 2 <code>Case</code> statements you have a literal string. In the 3rd and 4th <code>Case</code> statements you have <code>.Name = literal</code></p>\n"}, {"tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": 1, "last_activity_date": 1464811012, "creation_date": 1464811012, "answer_id": 37577686, "question_id": 37577187, "link": "https://stackoverflow.com/questions/37577187/reference-must-be-on-the-active-sheet-error/37577686#37577686", "title": "Reference must be on the active sheet error", "body": "<p>Obviously too late but I came up with a generic repeatable example to recreate the error.</p>\n\n<p>Basically looking at global vs local scope named ranges.  Recreated the error if the named range referred to the wrong sheet or if the sheet specific named range was local to the wrong sheet.</p>\n\n<p>Obviously not the issue but thought I would share anyway.</p>\n\n<pre><code>Sub test1()\n\n'Everything declared for sheet2 works fine\nActiveWorkbook.Names.Add Name:=\"Print_Scope_Global\", RefersTo:=\"=Sheet2!$A$1:$D$1\"\nActiveWorkbook.Sheets(\"sheet2\").Names.Add Name:=\"Print_Scope_Sheet\", RefersTo:=\"=Sheet2!$A$1:$D$1\"\n\npArea = \"Print_Scope_Sheet\"\nSheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\nSheets(\"Sheet1\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\n\npArea = \"Print_Scope_Global\"\nSheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\nSheets(\"Sheet1\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\n\n\nEnd Sub\n\nSub test2()\n\n'Named range refers to wrong sheet\nActiveWorkbook.Names.Add Name:=\"Print_Scope_Global\", RefersTo:=\"=Sheet1!$A$1:$D$1\"\nActiveWorkbook.Sheets(2).Names.Add Name:=\"Print_Scope_Sheet\", RefersTo:=\"=Sheet1!$A$1:$D$1\"\n\npArea = \"Print_Scope_Sheet\"\nSheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\nSheets(\"Sheet1\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\n\npArea = \"Print_Scope_Global\"\nSheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\nSheets(\"Sheet1\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\n\n\nEnd Sub\n\nSub test3()\n\n'Name range is local to the wrong sheet\nActiveWorkbook.Sheets(\"sheet1\").Names.Add Name:=\"Print_Scope_Sheet\", RefersTo:=\"=Sheet2!$A$1:$D$1\"\n\npArea = \"Print_Scope_Sheet\"\nSheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\nSheets(\"Sheet1\").Activate\nWith Sheets(\"Sheet2\")\n    With .PageSetup\n        .PrintArea = pArea\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "accepted_answer_id": 37577498, "answer_count": 2, "score": -2, "last_activity_date": 1464811012, "creation_date": 1464809096, "last_edit_date": 1531161705, "question_id": 37577187, "link": "https://stackoverflow.com/questions/37577187/reference-must-be-on-the-active-sheet-error", "title": "Reference must be on the active sheet error", "body": "<p>I am getting a <code>reference must be on the active sheet error</code> on the last line.</p>\n\n<pre><code>For Each ws In tabArr()\n\nWith ws\n\n    Select Case .Name\n        Case \"Summary\"\n            area = \"PRNSUMMARY\"\n            title = \"$1:$9\"\n        Case \"Monthly CC Sum\"\n            area = \"PRNMONTHLYCCSUM\"\n            title = \"$2:$16\"\n        Case .Name = \"Div Sal Sum\"\n            area = \"PRNDIVSALSUM\"\n            title = \"\"\n        Case .Name = \"CC Sal Sum\"\n            area = \"PRNCCSALSUM\"\n            title = \"$2:$16\"\n    End Select\n\n    With .PageSetup\n        .PrintArea = area '&lt;----error here\n</code></pre>\n\n<p>I have tried by creating a <code>worksheet</code> object.</p>\n\n<pre><code>Dim ws As Worksheet\nFor Each e In tabArr()\n\nSet ws = e\nDebug.Print ws.Name\nWith ws\n...\n</code></pre>\n\n<p>but still failed :/ The really odd thing is, it prints the first worksheet. Only fails on second. </p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464858323, "creation_date": 1464858323, "answer_id": 37587301, "question_id": 37577093, "link": "https://stackoverflow.com/questions/37577093/inconsistencies-in-looping-through-and-creating-reports/37587301#37587301", "title": "Inconsistencies in looping through and creating reports", "body": "<p>You both open the report for preview and for output to PDF.</p>\n\n<p>If only PDF is needed, skip the preview.</p>\n"}], "owner": {"reputation": 17, "user_id": 3853116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12ed799745a948af8c77792b5fe3eb78?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/3853116/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023237, "creation_date": 1464808789, "last_edit_date": 1594023237, "question_id": 37577093, "link": "https://stackoverflow.com/questions/37577093/inconsistencies-in-looping-through-and-creating-reports", "title": "Inconsistencies in looping through and creating reports", "body": "<p>I have a database with 5 tables, 3 queries, 3 reports (the queries are the recordsets) and three reports each showing the several fields on the recordsets. The problem is, even though they have the same code, one of the sub routines has inconsistent results. It is like it is cycling through each supervisor and creating a report and then doing it again, it's caught in a loop and I can't see where the issue is. Hoping someone can help.</p>\n\n<pre><code>Private Sub cmdFedInvest_Click()\nDim x           As String\nDim y           As String\nDim StrSQL      As String\nDim stWhereStr  As String 'Where Condition'\nDim stSection   As String 'Selection from drop down list\nDim stfile      As String\nDim stDocName   As String\nDim StrEmail    As String\n\nStrSQL = \"SELECT DISTINCTROW [qryActT8_Sup].[Sup], [qryActT8_Sup].Sup_email \" &amp; _\n\"FROM [qryActT8_Sup];\"\n    y = Year(Date)\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nSet db = CurrentDb\nDim qdTemp As DAO.QueryDef\nSet qdTemp = db.CreateQueryDef(\"\", StrSQL)\nSet rst = qdTemp.OpenRecordset()\n\nIf rst.EOF And rst.BOF Then\n    MsgBox \"No data available for the Ledger Process routine.\"\nElse\n    Debug.Print rst.Fields.Count\n    rst.MoveFirst\n    Do While Not rst.EOF\n        x = rst![Sup]\n        StrEmail = rst![Sup_email]\n        stDocName = \"FedInvest - ISSR - T8 Recertification Report\"\n        stWhereStr = \"[qryActT8_Sup].[SUP]= '\" &amp; x &amp; \"'\"\n        stfile = Me.txtLocationSaveFI &amp; \"\\\" &amp; x &amp; \" - \" &amp; y &amp; \" FedInvest Recertification.pdf\"\n        DoCmd.OpenReport stDocName, acPreview, , stWhereStr\n        'DoCmd.SendObject acSendReport, stDocName, acFormatPDF, StrEmail, , , \"2016 FedInvest Recertification\", \"\"\n        DoCmd.OutputTo acOutputReport, stDocName, acFormatPDF, stfile\n        DoCmd.Close acReport, stDocName\n        rst.MoveNext\n   Loop\nEnd If\nrst.Close\nSet rst = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 977133, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d85a857fa345390c38344f47724412d9?s=128&d=identicon&r=PG", "display_name": "JasonR", "link": "https://stackoverflow.com/users/977133/jasonr"}, "edited": false, "score": 1, "creation_date": 1464901969, "post_id": 37580645, "comment_id": 62689170, "body": "Awesome, thank you so much that is exactly what I was trying to figure out. I might use the BeforeUpdate method you mentioned.  Thanks again!"}, {"owner": {"reputation": 281, "user_id": 977133, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d85a857fa345390c38344f47724412d9?s=128&d=identicon&r=PG", "display_name": "JasonR", "link": "https://stackoverflow.com/users/977133/jasonr"}, "edited": false, "score": 0, "creation_date": 1465313054, "post_id": 37580645, "comment_id": 62843821, "body": "If I were to use the BeforeUpdate Flag what would be the best method to use that event to then add new data to the DB?"}, {"owner": {"reputation": 2443, "user_id": 136079, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/50accc8e05475f31954019c86ef0c9df?s=128&d=identicon&r=PG", "display_name": "Billious", "link": "https://stackoverflow.com/users/136079/billious"}, "reply_to_user": {"reputation": 281, "user_id": 977133, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d85a857fa345390c38344f47724412d9?s=128&d=identicon&r=PG", "display_name": "JasonR", "link": "https://stackoverflow.com/users/977133/jasonr"}, "edited": false, "score": 0, "creation_date": 1465431704, "post_id": 37580645, "comment_id": 62903613, "body": "I&#39;ve added a sample of a BeforeUpdate event procedure that might help. You can use the same code for a BeforeInsert event procedure, which would ask the user before adding a new record. In both cases, if the user selects &quot;No&quot;, they won&#39;t be able to move off the record until they undo their changes using hte ESC key.  The other thing you might consider for adding new records is to temporarily change the DataEntry property of the form to true, using a command button. Doing it right is a little more complicated though."}, {"owner": {"reputation": 281, "user_id": 977133, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d85a857fa345390c38344f47724412d9?s=128&d=identicon&r=PG", "display_name": "JasonR", "link": "https://stackoverflow.com/users/977133/jasonr"}, "edited": false, "score": 1, "creation_date": 1465579249, "post_id": 37580645, "comment_id": 62977296, "body": "Awesome thanks, that pretty much exactly what my code looks like. I added in the &#39;Undo&#39; property on the No condition which basically cancels commiting the query.  Thanks again."}], "tags": [], "owner": {"reputation": 2443, "user_id": 136079, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/50accc8e05475f31954019c86ef0c9df?s=128&d=identicon&r=PG", "display_name": "Billious", "link": "https://stackoverflow.com/users/136079/billious"}, "is_accepted": true, "score": 6, "last_activity_date": 1465431629, "last_edit_date": 1465431629, "creation_date": 1464825638, "answer_id": 37580645, "question_id": 37576871, "link": "https://stackoverflow.com/questions/37576871/ms-access-data-entered-in-a-form-automatically-saves-when-i-close-the-form/37580645#37580645", "title": "MS Access - Data Entered in a Form Automatically saves when i close the form", "body": "<p>Microsoft Access binds forms to data by default, and will automatically save data as soon as you either move between records or close the form you're working on. For the average user, this is actually a good thing because it makes it very difficult to lose data, even if you accidentally close the form after making an edit.</p>\n\n<p>If this functionality isn't what you're looking for, I'd suggest removing the binding from the form, that is, set the Record Source property to blank, then manipulate all the data in code using unbound controls. It's a lot more fiddly, but it gives you a lot more control.</p>\n\n<p>The other option would be to use the form's BeforeUpdate event to ask the user if they want to save their changes before allowing them to go through.</p>\n\n<p>If your main concern is accidentally adding new records, set the Allow Additions property to false, and create new records programmatically.</p>\n\n<p>A sample of a BeforeUpdate event procedure (the same code would work for the BeforeInsert event):</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n\n  Dim intAns As Integer\n\n  intAns = MsgBox(\"Are you sure you want to save this record?\", vbQuestion + vbYesNo, \"Save Record\")\n  If intAns = vbNo Then Cancel = 1\n\nEnd Sub\n</code></pre>\n\n<p>If you were to use the above method, and the user clicked \"No\", they would have to then click the ESC key to undo the changes they had entered. Otherwise it would keep showing the dialogue when they moved off the record.</p>\n"}], "owner": {"reputation": 281, "user_id": 977133, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d85a857fa345390c38344f47724412d9?s=128&d=identicon&r=PG", "display_name": "JasonR", "link": "https://stackoverflow.com/users/977133/jasonr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5546, "favorite_count": 0, "accepted_answer_id": 37580645, "answer_count": 1, "score": 2, "last_activity_date": 1594641975, "creation_date": 1464808006, "last_edit_date": 1594641975, "question_id": 37576871, "link": "https://stackoverflow.com/questions/37576871/ms-access-data-entered-in-a-form-automatically-saves-when-i-close-the-form", "title": "MS Access - Data Entered in a Form Automatically saves when i close the form", "body": "<p>I've been tasked with making updates to an MS Access Database and its forms.\nEach form seems to be linked to a query. If I enter data into a text box on the form and then close the form without pressing the Save Record button a new record is still added to the Database which makes no sense to.</p>\n\n<p>Any insight would be great, I'm a programmer but have little experience working with Access Forms and Databases.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "combobox", "null"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "edited": false, "score": 0, "creation_date": 1464879126, "post_id": 37578114, "comment_id": 62675497, "body": "The bound column is set to ContactInfoID, which is correct.  I tried the existing code with <code>Me.</code>, and also tried <code>stupid = Me.SelectConsultantCombo</code> and <code>stupid = Me.SelectConsultantCombo.Value</code> (tried both with and without <code>Me.</code>) and still got Error 94: Invalid use of Null pulling up that line in the debugger :\\"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "edited": false, "score": 0, "creation_date": 1464882893, "post_id": 37578114, "comment_id": 62678383, "body": "You are setting it to Null here&quot; <code>Me!SelectConsultantCombo = Null</code>. You should wait until you actually use it&#39;s value for your query before you reset it to null, so move that line to the SaveConsultantbtn_Click sub or save that value somewhere else. The way your code is, every time a selection is made the combo box is reset to null."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1464812607, "creation_date": 1464812607, "answer_id": 37578114, "question_id": 37576852, "link": "https://stackoverflow.com/questions/37576852/combobox-column-property-returns-invalid-use-of-null-in-vba/37578114#37578114", "title": "combobox.column property returns invalid use of null in vba", "body": "<p>First try <code>stupid = Me.SelectConsultantCombo.Column(0)</code> (you are missing the <code>Me.</code> part).</p>\n\n<p>But what you should really do is make sure your bound column on the combo box is set correctly and just use <code>stupid = Me.SelectConsultantCombo</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "is_accepted": false, "score": 0, "last_activity_date": 1464880786, "creation_date": 1464880786, "answer_id": 37595913, "question_id": 37576852, "link": "https://stackoverflow.com/questions/37576852/combobox-column-property-returns-invalid-use-of-null-in-vba/37595913#37595913", "title": "combobox.column property returns invalid use of null in vba", "body": "<p>I took <code>Me!SelectConsultantCombo = Null</code> out of the combo's afterupdate and it works perfectly now! Of course if I have the combo set to null somewhere in the code it's going to pull up null somewhere else, d'oh!</p>\n"}], "owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 749, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464880786, "creation_date": 1464807929, "question_id": 37576852, "link": "https://stackoverflow.com/questions/37576852/combobox-column-property-returns-invalid-use-of-null-in-vba", "title": "combobox.column property returns invalid use of null in vba", "body": "<p>I am a database//Access noob, so bear with me. I have a database set up to keep track of Consultants and their Vendors for a tech consulting company. Some consultants are their own vendors, and some have third-party vendors that handle their contracting. In the case where a consultant is also their own vendor, the contact information is the same for both. Contact Info is stored in a separate table, with primary key ContactID and foreign key fields for ConsultantID (primary key in ConsultantT) and VendorID (primary key in VendorT).</p>\n\n<p>In the case that the relevant Contact Info has already been entered on one of the forms, I want to be able to select the already existing Contact Info record and tell the database to add the other foreign key ID field to the existing record based on the record on the main form. So, for example, if I have already entered Contact Info for Consultant A via the Consultant form, when I open the Vendor form to add Consultant A's vendor I want the option to select \"Consultant A\" from a combo box and have their info populate VendorsF's Contact Info form while adding the VendorID to the already existing Contact Info record for Consultant A.</p>\n\n<p>I think I've almost worked it out, but am stuck on one last thing. Right now I have a popup form (ChooseConsultantInfoF) for selecting an existing ContactInfo record. On that form I have a search combobox (SelectConsultantCombo) to select the existing record, and a command button (SaveConsultantbtn) which I've tried to code to Update the ContactInfoT and add the VendorID from the current record on the VendorsF to the existing record in ContactInfoT. Here is the all of the code for the popup form:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub SaveConsultantbtn_Click()\nDim stupid As Long\nstupid = SelectConsultantCombo.Column(0)\nDoCmd.RunSQL \"UPDATE ContactInfoT SET VendorID = (Forms!VendorsF!VendorID) Where ContactInfoID = \" &amp; stupid &amp; \";\"\nEnd Sub\n\nPrivate Sub SelectConsultantCombo_AfterUpdate()\nDim rst As DAO.Recordset\nSet rst = Me.RecordsetClone\nrst.FindFirst \"ContactInfoID = \" &amp; Me!SelectConsultantCombo\nMe.Bookmark = rst.Bookmark\nleave:\nMe!SelectConsultantCombo = Null\nIf Not rst Is Nothing Then Set rst = Nothing\nExit Sub\n\nEnd Sub\n</code></pre>\n\n<p>When I try to put it into action, I get Error 94: Invalid use of Null and it pulls up</p>\n\n<pre><code>stupid = SelectConsultantCombo.Column(0)\n</code></pre>\n\n<p>I know the code block works apart from that--I tried the Click event once with a numeric value instead of the variable:</p>\n\n<pre><code> Private Sub SaveConsultantbtn_Click()\n    DoCmd.RunSQL \"UPDATE ContactInfoT SET VendorID = (Forms!VendorsF!VendorID) Where ContactInfoID = 1 ;\"\n    End Sub\n</code></pre>\n\n<p>without any trouble, so the issue must be in calling the combobox's column. </p>\n\n<p>I also tried defining the variable with Nz to allow Null:</p>\n\n<pre><code>stupid = Nz(Me.SelectConsultantCombo.Column(0), 0)\n</code></pre>\n\n<p>and that gets the code working also, but still doesn't save my VendorID to the record in ContactInfoT.  None of the columns in the combobox contain Null values (none that I can find, anyway). Dunno if this is useful, but the Row Source of the combobox is:</p>\n\n<pre><code>SELECT ContactInfoT.ContactInfoID, ConsultantT.ConsultantID, ConsultantT.FirstName, ConsultantT.LastName FROM ConsultantT INNER JOIN ContactInfoT ON ConsultantT.ConsultantID = ContactInfoT.ConsultantID ORDER BY ConsultantT.[LastName], ConsultantT.[FirstName];\n</code></pre>\n\n<p>Does anyone know why Access doesn't recognize my combobox.column property? Or is there another way to write this up in VBA to avoid this error?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464808217, "post_id": 37576834, "comment_id": 62640771, "body": "Which sheet do you expect <code>Cells(i,10)</code> to be on? Same with <code>Cells(i,3)</code>?  I believe that&#39;s the issue that&#39;s not working. You are using the wildcard correctly, but as you have multiple sheets being referenced, you have to add the specific sheet to your <code>Cells()</code> use as well."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464808259, "post_id": 37576834, "comment_id": 62640795, "body": "try putting <code>wb1.Sheets(&quot;A&quot;).</code> in front of both <code>Cells(...</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464808747, "post_id": 37576834, "comment_id": 62641023, "body": "<a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/385\" rel=\"nofollow noreferrer\">Implicit reference to ActiveSheet</a> strikes again!"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1464809647, "post_id": 37576965, "comment_id": 62641495, "body": "I understand that, but if I search the name &quot;Basic Term Life&quot; in cell C21 of Sheet A in the table on Sheet B  and Sheet B&#39;s names are not exact &quot;Basic Life Insurance&quot; my macro does not count the names that arent exact.  How can I update the wildcard references to count all similar names?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1464810124, "post_id": 37576965, "comment_id": 62641754, "body": "@t.mo - Maybe add some if statements, where if it doesn&#39;t find with <code>*Basic Term*</code>, then search for something more specific?  How many ways can your data given?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 4, "last_activity_date": 1464808953, "last_edit_date": 1464808953, "creation_date": 1464808368, "answer_id": 37576965, "question_id": 37576834, "link": "https://stackoverflow.com/questions/37576834/using-a-wildcard-with-a-cell-reference-what-am-i-missing/37576965#37576965", "title": "Using a wildcard with a cell reference. What am I missing?", "body": "<p>I believe the issue is the unqualified references when you use just <code>Cells()</code>.  VBA needs to know what sheet you expect that to be on, when using multiple sheets.  I'm assuming that the <code>Cells(i,10)</code> and <code>Cells(i,3)</code> are to be on Sheet \"A\". If not, just change the sheet name: </p>\n\n<p><code>wb1.Sheets(\"A\").Cells(i, 10) = Application.CountIfs(wb1.Sheets(\"B\").Range(\"B:B\"), \"*\" &amp; wb1.Sheets(\"A\").Cells(i, 3) &amp; \"*\")</code></p>\n\n<p>As you can see, that's kind of long and a little tricky to read. An alternative way of doing that, is use <code>With</code>:</p>\n\n<pre><code>With wb1.Sheets(\"A\")\n   .Cells(i,10) = Application.CountIfs(wb1.Sheets(\"B\").Range(\"B:B\"), \"*\" &amp; .Cells(i,3) &amp; \"*\")\nEnd With\n</code></pre>\n\n<p>So, wherever you see a simple <code>.Cells()</code> without anything before the <code>.</code>, it's going to use what follows <code>With</code>.  So it's the equivalent of the formula above...does that make sense?</p>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 1, "accepted_answer_id": 37576965, "answer_count": 1, "score": 0, "last_activity_date": 1464808953, "creation_date": 1464807872, "last_edit_date": 1464807975, "question_id": 37576834, "link": "https://stackoverflow.com/questions/37576834/using-a-wildcard-with-a-cell-reference-what-am-i-missing", "title": "Using a wildcard with a cell reference. What am I missing?", "body": "<p>In Sheet A are a list of names.  I am attempting to count the different names on Sheet A in a table on Sheet B, Column B.  The names are not exact and I will be referring to the cell and not writing in the name.  The sub below almost works but I think I am not using the wildcqard correctly.  Please help if you can.  thanks in advance.</p>\n\n<pre><code>Sub Countif_Crr_Cnt_Until_LastRow()\n\n    Dim LastRow As Long\n    Dim wb1 As Workbook\n\n\n    Set wb1 = Workbooks(\"macro all client v.01.xlsm\")\n\n    LastRow = wb1.Sheets(\"A\").Range(\"A:A\").Find(\"Overall - Total\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    For i = 21 To LastRow\n\nCells(i, 10) = Application.CountIfs(wb1.Sheets(\"B\").Range(\"B:B\"), \"*\" &amp; Cells(i, 3) &amp; \"*\")\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1464885141, "creation_date": 1464885141, "answer_id": 37597414, "question_id": 37576613, "link": "https://stackoverflow.com/questions/37576613/vba-code-to-search-for-an-email-and-copy-the-body-into-excel/37597414#37597414", "title": "VBA code to search for an email and copy the body into excel", "body": "<p>This will copy the body to Excel and a whole lot more.</p>\n\n<pre><code>Option Explicit\n'This Code is Downloaded from OfficeTricks.com\n'Visit this site for more such Free Code\nSub Export_Outlook_Emails_To_Excel()\n    'Add Tools-&gt;References-&gt;\"Microsoft Outlook nn.n Object Library\"\n    'nn.n varies as per our Outlook Installation\n    Dim Folder As Outlook.MAPIFolder\n    Dim sFolders As Outlook.MAPIFolder\n    Dim iRow As Integer, oRow As Integer\n    Dim MailBoxName As String, Pst_Folder_Name  As String\n\n    'Mailbox or PST Main Folder Name (As how it is displayed in your Outlook Session)\n    MailBoxName = \"MailBox Name\"\n\n    'Mailbox Folder or PST Folder Name (As how it is displayed in your Outlook Session)\n    Pst_Folder_Name = \"Folder Name\" 'Sample \"Inbox\" or \"Sent Items\"\n\n    'To directly a Folder at a high level\n    'Set Folder = Outlook.Session.Folders(MailBoxName).Folders(Pst_Folder_Name)\n\n    'To access a main folder or a subfolder (level-1)\n    For Each Folder In Outlook.Session.Folders(MailBoxName).Folders\n        If VBA.UCase(Folder.Name) = VBA.UCase(Pst_Folder_Name) Then GoTo Label_Folder_Found\n        For Each sFolders In Folder.Folders\n            If VBA.UCase(sFolders.Name) = VBA.UCase(Pst_Folder_Name) Then\n                Set Folder = sFolders\n                GoTo Label_Folder_Found\n            End If\n        Next sFolders\n    Next Folder\n\nLabel_Folder_Found:\n     If Folder.Name = \"\" Then\n        MsgBox \"Invalid Data in Input\"\n        GoTo End_Lbl1:\n    End If\n\n    'Read Through each Mail and export the details to Excel for Email Archival\n    ThisWorkbook.Sheets(1).Activate\n    Folder.Items.Sort \"Received\"\n\n    'Insert Column Headers\n    ThisWorkbook.Sheets(1).Cells(1, 1) = \"Sender\"\n    ThisWorkbook.Sheets(1).Cells(1, 2) = \"Subject\"\n    ThisWorkbook.Sheets(1).Cells(1, 3) = \"Date\"\n    ThisWorkbook.Sheets(1).Cells(1, 4) = \"Size\"\n    ThisWorkbook.Sheets(1).Cells(1, 5) = \"EmailID\"\n    'ThisWorkbook.Sheets(1).Cells(1, 6) = \"Body\"\n\n    'Export eMail Data from PST Folder\n    oRow = 1\n    For iRow = 1 To Folder.Items.Count\n        'If condition to import mails received in last 60 days\n        'To import all emails, comment or remove this IF condition\n        If VBA.DateValue(VBA.Now) - VBA.DateValue(Folder.Items.Item(iRow).ReceivedTime) &lt;= 60 Then\n           oRow = oRow + 1\n           ThisWorkbook.Sheets(1).Cells(oRow, 1).Select\n           ThisWorkbook.Sheets(1).Cells(oRow, 1) = Folder.Items.Item(iRow).SenderName\n           ThisWorkbook.Sheets(1).Cells(oRow, 2) = Folder.Items.Item(iRow).Subject\n           ThisWorkbook.Sheets(1).Cells(oRow, 3) = Folder.Items.Item(iRow).ReceivedTime\n           ThisWorkbook.Sheets(1).Cells(oRow, 4) = Folder.Items.Item(iRow).Size\n           ThisWorkbook.Sheets(1).Cells(oRow, 5) = Folder.Items.Item(iRow).SenderEmailAddress\n           'ThisWorkbook.Sheets(1).Cells(oRow, 6) = Folder.Items.Item(iRow).Body\n        End If\n    Next iRow\n    MsgBox \"Outlook Mails Extracted to Excel\"\n    Set Folder = Nothing\n    Set sFolders = Nothing\n\nEnd_Lbl1:\nEnd Sub\n</code></pre>\n\n<p>See the link below for more info.</p>\n\n<p><a href=\"http://officetricks.com/outlook-email-download-to-excel/\" rel=\"nofollow\">http://officetricks.com/outlook-email-download-to-excel/</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6406797, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154360065417223/picture?type=large", "display_name": "Lana Ilicheva", "link": "https://stackoverflow.com/users/6406797/lana-ilicheva"}, "is_accepted": false, "score": 0, "last_activity_date": 1466437555, "creation_date": 1466437555, "answer_id": 37926645, "question_id": 37576613, "link": "https://stackoverflow.com/questions/37576613/vba-code-to-search-for-an-email-and-copy-the-body-into-excel/37926645#37926645", "title": "VBA code to search for an email and copy the body into excel", "body": "<p>Figured it out. The script below finds a specific email in the specific outlook mailbox and copies the contents (a table) from the body of the email into excel.</p>\n\n<pre><code>Sub Copyemailbody_refresh()\n\nDim Folder As Outlook.MAPIFolder\nDim sFolders As Outlook.MAPIFolder\nDim MailBoxName As String, Pst_Folder_Name  As String\nDim oMail As Outlook.MailItem\nDim y As Long, x As Long\nDim olInsp As Outlook.Inspector\nDim wdDoc As Word.Document\nDim tb As Word.Table\nDim Myemail As String\nDim Atmt As Attachment\nDim irow As Integer\nirow = 1\n'set email date\nDim Emaildate As String\nEmaildate = Sheets(\"Refresh\").Range(\"G12\").Value\n'set email subject\nMyemail = \"Today's receipts \" &amp; Emaildate\u201d\n'Mailbox or PST Main Folder Name to set the name of the inbox - I have several mailboxes, needed to specify\n MailBoxName = \"Mymailbox1\"  \n\n'Mailbox Folder or PST Folder Name (As how it is displayed in your Outlook Session)\n Pst_Folder_Name = \"Inbox\" 'Sample \"Inbox\" or \"Sent Items\"\n\n'To direct to a Folder at a high level\n Set Folder = Outlook.Session.Folders(MailBoxName).Folders(Pst_Folder_Name)\n\n'copying the email contents into the refresh file\nFor Each oMail In Folder.Items\n If oMail.Subject = Myemail Then\n  With oMail\n  Set olInsp = .GetInspector\n  Set wdDoc = olInsp.WordEditor\n\n  For Each tb In wdDoc.Tables 'assumes only 1 table in the body of the email\n\nFor y = 1 To tb.Rows.Count\nFor x = 1 To tb.Columns.Count\n\n Sheets(\"Refresh\").Select \n Range(\"A1\").Select \n Selection.Offset(y, x).Value = tb.Cell(y, x).Range\n\n    Next\n\n  Next\n\n Next\n\n    End With\n\nEnd If\n\nNext\n\n 'since the table was pasted as a word object, needed to convert text to numbers to perform calc on the table\u2013 not sure of a quicker way to do this than Text to columns\n\nSheets(\"Refresh\").Select\nColumns(\"B:B\").Select\nSelection.TextToColumns Destination:=Range(\"B1\"), DataType:=xlDelimited\nColumns(\"C:C\").Select\nSelection.TextToColumns Destination:=Range(\"C1\"), DataType:=xlDelimited\nColumns(\"D:D\").Select\nSelection.TextToColumns Destination:=Range(\"D1\"), DataType:=xlDelimited\nColumns(\"E:E\").Select\nSelection.TextToColumns Destination:=Range(\"E1\"), DataType:=xlDelimited\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6406797, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154360065417223/picture?type=large", "display_name": "Lana Ilicheva", "link": "https://stackoverflow.com/users/6406797/lana-ilicheva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2342, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593307318, "creation_date": 1464807096, "last_edit_date": 1593307318, "question_id": 37576613, "link": "https://stackoverflow.com/questions/37576613/vba-code-to-search-for-an-email-and-copy-the-body-into-excel", "title": "VBA code to search for an email and copy the body into excel", "body": "<p>I am trying to write code that would sort one of the inboxes from my outlook for an email with specific subject and copy the body of the email (its a table) into excel. This is what I have so far. Can't get the code to work though and not sure how to specify which inbox I want to search. Appreciate any help!</p>\n\n<pre><code>Sub CopyEmail()\n\n    Dim olApp As Outlook.Application\n    Dim olNs As Outlook.Namespace\n    Dim olFldr As Outlook.MAPIFolder\n    Dim olItms As Outlook.Items\n    Dim olMail As Variant\n\n    Set olApp = New Outlook.Application\n    Set olNs = olApp.GetNamespace(\u201dMAPI\u201d) 'get a runtime error here\n    Set olFldr = olNs.GetDefaultFolder(olFolderInbox)\n    Set olItms = olFldr.Items\n\n    Dim NLXemail As String\n    NLXemail = \"Patient Receipts\"\n\n    olItms.Sort NLXemail\n\n         If InStr(1, olMail.Subject, NLXemail, vbTextCompare) &gt; 0 Then\n            ThisWorkbook.Sheets(\"Sheet1\").Cells(3, 1).Value = outMail.Body\n\n        End If\n\n    Set olFldr = Nothing\n    Set olNs = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visual-studio", "ms-office", "powerpoint", "office-addins"], "answers": [{"comments": [{"owner": {"reputation": 5216, "user_id": 282855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/I4dgE.jpg?s=128&g=1", "display_name": "talha06", "link": "https://stackoverflow.com/users/282855/talha06"}, "edited": false, "score": 0, "creation_date": 1464808146, "post_id": 37576774, "comment_id": 62640733, "body": "No, I just want to share a file (i.e. a <code>.msi</code> file, etc) to let others to use my addin. What is that file? How can I build this file?"}, {"owner": {"reputation": 66, "user_id": 2147746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6A1f2.jpg?s=128&g=1", "display_name": "virth", "link": "https://stackoverflow.com/users/2147746/virth"}, "reply_to_user": {"reputation": 5216, "user_id": 282855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/I4dgE.jpg?s=128&g=1", "display_name": "talha06", "link": "https://stackoverflow.com/users/282855/talha06"}, "edited": false, "score": 0, "creation_date": 1464808433, "post_id": 37576774, "comment_id": 62640874, "body": "a .msi file is basically an &quot;installer&quot; a.k.a. &quot;setup&quot; or &quot;installer setup&quot;. You can create such installers with a Visual Studio Extension from Visual Studio Galler called &quot;Visual Studio Installer Projects&quot;    <a href=\"https://visualstudiogallery.msdn.microsoft.com/f1cc3f3e-c300-40a7-8797-c509fb8933b9\" rel=\"nofollow noreferrer\">https://visualstudiogallery.msdn.microsoft.com/f1cc3f3e-c300&zwnj;&#8203;-40a7-8797-c509fb893&zwnj;&#8203;3b9</a>"}], "tags": [], "owner": {"reputation": 66, "user_id": 2147746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6A1f2.jpg?s=128&g=1", "display_name": "virth", "link": "https://stackoverflow.com/users/2147746/virth"}, "is_accepted": false, "score": 1, "last_activity_date": 1464807673, "creation_date": 1464807673, "answer_id": 37576774, "question_id": 37576440, "link": "https://stackoverflow.com/questions/37576440/how-to-distribute-microsoft-office-addin/37576774#37576774", "title": "How to distribute Microsoft Office addin?", "body": "<p>If you need to share de source code with others, so they can edit the code, you should use Team Foundation Server or Github. </p>\n\n<p>If you just want to distribute the addin, so others can reference and use it in their code the best way would be to create a nuget package</p>\n\n<p>If you want distribut the builded package to install it on different computers you could use dropbox </p>\n"}, {"comments": [{"owner": {"reputation": 9457, "user_id": 882875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDjem.jpg?s=128&g=1", "display_name": "Bogdan Mitrache", "link": "https://stackoverflow.com/users/882875/bogdan-mitrache"}, "edited": false, "score": 0, "creation_date": 1464858950, "post_id": 37586740, "comment_id": 62660390, "body": "Predefined project templates for Office Add-ins <a href=\"http://www.advancedinstaller.com/user-guide/addins-tab.html\" rel=\"nofollow noreferrer\">advancedinstaller.com/user-guide/addins-tab.html</a>"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 2, "last_activity_date": 1464856795, "creation_date": 1464856795, "answer_id": 37586740, "question_id": 37576440, "link": "https://stackoverflow.com/questions/37576440/how-to-distribute-microsoft-office-addin/37586740#37586740", "title": "How to distribute Microsoft Office addin?", "body": "<p>Use the Advanced Installer product to create your MSI installer:</p>\n\n<p><a href=\"http://www.advancedinstaller.com/\" rel=\"nofollow\">http://www.advancedinstaller.com/</a></p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 2204063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnXge.jpg?s=128&g=1", "display_name": "Sanjay Karia", "link": "https://stackoverflow.com/users/2204063/sanjay-karia"}, "is_accepted": false, "score": 0, "last_activity_date": 1464860626, "creation_date": 1464860626, "answer_id": 37588182, "question_id": 37576440, "link": "https://stackoverflow.com/questions/37576440/how-to-distribute-microsoft-office-addin/37588182#37588182", "title": "How to distribute Microsoft Office addin?", "body": "<p>Try ClickOnce or MSI installer - \n<a href=\"https://msdn.microsoft.com/en-us/library/bb386179.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb386179.aspx</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms973805.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms973805.aspx</a></p>\n"}], "owner": {"reputation": 5216, "user_id": 282855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/I4dgE.jpg?s=128&g=1", "display_name": "talha06", "link": "https://stackoverflow.com/users/282855/talha06"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1593762926, "creation_date": 1464806493, "last_edit_date": 1593762926, "question_id": 37576440, "link": "https://stackoverflow.com/questions/37576440/how-to-distribute-microsoft-office-addin", "title": "How to distribute Microsoft Office addin?", "body": "<p>I have developed a <code>PowerPoint addin</code> using <strong>Visual Studio</strong>. I need to share it with others. How can I share this addin to let others to use it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464804685, "post_id": 37575791, "comment_id": 62638966, "body": "I think ActiveCell maybe referring to a sheet other than the one you think.  Try <code>Sheets(&quot;Error&quot;).Activate</code>, or whatever the sheet you think it should refer to.  Using assertions can be useful to test your assumptions, so you might try adding <code>Debug.Assert  ActiveSheet.name=&quot;Errors&quot;</code> in the code which could help"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464805526, "post_id": 37575791, "comment_id": 62639389, "body": "Also, you should always explicitly tell what Sheet to use when using <code>Range()</code> (which you did), but also <code>Rows</code>,<code>Columns</code>...so your <code>lastRow = Sheets(&quot;Data&quot;).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row</code> should be <code>lastRow = Sheets(&quot;Data&quot;).Range(&quot;B&quot; &amp; Sheets(&quot;Data&quot;).Rows.Count).End(xlUp).Row</code>  Not doing so can cause unexpected results."}, {"owner": {"reputation": 1, "user_id": 6356456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0b06c78f128eb0a04dd105f22e2ed?s=128&d=identicon&r=PG&f=1", "display_name": "RTorres82", "link": "https://stackoverflow.com/users/6356456/rtorres82"}, "edited": false, "score": 0, "creation_date": 1464947161, "post_id": 37575791, "comment_id": 62705394, "body": "Thanks this helped"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6356456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0b06c78f128eb0a04dd105f22e2ed?s=128&d=identicon&r=PG&f=1", "display_name": "RTorres82", "link": "https://stackoverflow.com/users/6356456/rtorres82"}, "edited": false, "score": 0, "creation_date": 1464947213, "post_id": 37576222, "comment_id": 62705419, "body": "Ah yes, I copied and pasted the conditions from before, meant to change to column 7 and &gt;"}, {"owner": {"reputation": 1, "user_id": 6356456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0b06c78f128eb0a04dd105f22e2ed?s=128&d=identicon&r=PG&f=1", "display_name": "RTorres82", "link": "https://stackoverflow.com/users/6356456/rtorres82"}, "edited": false, "score": 0, "creation_date": 1464947829, "post_id": 37576222, "comment_id": 62705779, "body": "Thanks @gualdhar  Almost there, one last thing, it&#39;s leaving varied amounts of blank rows inbetween the results in the error sheets, it seems the same amount of rows as the errors in the actual data sheet.  Any ideas how this could be corrected?"}], "tags": [], "owner": {"reputation": 3, "user_id": 6300645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6266ff4e72f3a46d4f4454e567f48ce1?s=128&d=identicon&r=PG&f=1", "display_name": "gualdhar", "link": "https://stackoverflow.com/users/6300645/gualdhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1464805694, "creation_date": 1464805694, "answer_id": 37576222, "question_id": 37575791, "link": "https://stackoverflow.com/questions/37575791/create-macro-to-validate-cells-and-write-error-report-to-a-new-sheet/37576222#37576222", "title": "Create macro to validate cells and write error report to a new sheet", "body": "<p>First, I personally don't like referring to active cells in the middle of vba code. I've had problems where I accidentally click on a sheet while a macro is running and it throws an error. Since you're already referring to <code>.Cells(iRow, #)</code> in your conditionals, why not use <code>.Cells(iRow, #).Row</code> instead?</p>\n\n<p>Second, it seems like, from what your conditionals want to do, you're only recording one type of error, even if there's more than one for a given row. Is that your intent? If so, you may want to consider using Else If statements instead, so it only records the first error the macro comes across for row in the data sheet.</p>\n\n<p>Third, your lastARow parameter isn't changing because you didn't tell the macro to change it. It's set before the for loop, then isn't touched. You likely want to increment lastARow each time it finds an error, after the error is written down. Use <code>lastARow = lastARow + 1</code></p>\n\n<p>Finally, you might notice an error in the last If conditional. I doubt you want to check if your project end date is before 2017 there.</p>\n"}], "owner": {"reputation": 1, "user_id": 6356456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0b06c78f128eb0a04dd105f22e2ed?s=128&d=identicon&r=PG&f=1", "display_name": "RTorres82", "link": "https://stackoverflow.com/users/6356456/rtorres82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 697, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464809747, "creation_date": 1464804149, "last_edit_date": 1464809747, "question_id": 37575791, "link": "https://stackoverflow.com/questions/37575791/create-macro-to-validate-cells-and-write-error-report-to-a-new-sheet", "title": "Create macro to validate cells and write error report to a new sheet", "body": "<p>I'm trying to create a macro that runs a loads of validations (there'll be a lot more than is currently in my code) on a data sheet/template we receive. </p>\n\n<p>When it finds an issue the macro formats the fill of the cell to red and then it needs to write the issue to an error report in a new sheet.  The error report needs to write the row of the error in Col A and a brief description of the error in Col B.</p>\n\n<p>I have got the below macro to half work in that it fills all the incorrect cells in red, but I can not get it to write to the error report correctly.</p>\n\n<p>1) When I use Activecell.row it returns the row of active cell I was in before I ran the macro and not the row in the loop (iRow)</p>\n\n<p>2) I cannot get it to write the errors underneath each other, it keeps overwriting even though I've tried using a lastARow parameter when I step through, it is not changing.  Not sure if there is something I'm missing or if I need another loop within a loop (I've tried this too)</p>\n\n<pre><code>Sub CheckValidations()\n\nDim iRow As Long, lastRow As Long, firstRow As Long, ARow As Long, firstARow As Long, lastARow As Long\n\n\n\nApplication.Calculation = xlManual\nApplication.DisplayStatusBar = False\nApplication.ScreenUpdating = False\n\n\n\n    lastRow = Sheets(\"Data\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    firstRow = 14\n\n    lastARow = Sheets(\"Errors\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n\n        'For each row check validations in specific columns\n    For iRow = lastRow To firstRow Step -1\n\n\n        'Check SubFunction Exists, if not highlight cell and write issue to\n error report\n            If Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"CRO &amp; Admin\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Operational Risk\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Global Risk Analytics\" _\n            And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Risk Strategy\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Security &amp; Fraud Risk\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Wholesale &amp; Market Risk\" _\n            And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"RBWM Risk\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Indirects\" And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Run Risk Like a Business\" _\n            And Sheets(\"Data\").Cells(iRow, 2) &lt;&gt; \"Location Optimisation\" Then\n                Sheets(\"Data\").Cells(iRow, 2).Interior.Color = RGB(255, 0, 0) 'Red\n                Sheets(\"Errors\").Cells(lastARow, 1).Value = ActiveCell.Row 'Activecell.row returns cell from before macro was initiated, not iRow\n                Sheets(\"Errors\").Cells(lastARow, 2).Value = \"Value not in dropdown/allowed\"\n            End If\n\n            'Check Proj Start date not before 01/07/2015, if it is wirte isue to error report\n            If Sheets(\"Data\").Cells(iRow, 6) &lt; DateSerial(2015, 7, 1) Then\n                Sheets(\"Data\").Cells(iRow, 6).Interior.Color = RGB(255, 0, 0)\n                Sheets(\"Errors\").Cells(lastARow, 1).Value = ActiveCell.Row 'Activecell.row returns cell from before macro was initiated, not iRow\n                Sheets(\"Errors\").Cells(lastARow, 2).Value = \"Start date before 01/07/2015\"\n            End If\n\n            'Check Proj End date not after 31/12/2017, if it is wirte isue to error report\n            If Sheets(\"Data\").Cells(iRow, 6) &lt; DateSerial(2017, 12, 31) Then\n                Sheets(\"Data\").Cells(iRow, 6).Interior.Color = RGB(255, 0, 0)\n                Sheets(\"Errors\").Cells(lastARow, 1).Value = ActiveCell.Row 'Activecell.row returns cell from before macro was initiated, not iRow\n                Sheets(\"Errors\").Cells(lastARow, 2).Value = \"Start date before 01/07/2015\"\n            End If\n\n    Next iRow\n\n\nApplication.Calculation = x1Automatic\nApplication.DisplayStatusBar = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated, thanks in advance.</p>\n"}, {"tags": ["windows", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "edited": false, "score": 0, "creation_date": 1464809359, "post_id": 37575907, "comment_id": 62641348, "body": "On my computer the drive is X:(\\\\ServerName\\Folder\\File) so do I just put X:\\some folder?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "edited": false, "score": 0, "creation_date": 1464875264, "post_id": 37575907, "comment_id": 62672243, "body": "If you mapped the drive, both will work. eg <code>X:\\folder\\file</code> or <code>\\\\servername\\folder\\file</code> The trick is that you can map a drive letter to a folder on a remote PC, so the path on the remote server might be <code>C:\\folder\\mapped folder\\subfolder\\file</code> but the mapped network drive (let&#39;s say you used drive letter M) on the local computer would be <code>M:\\subfolder\\file</code>. Assuming you have permissions on the remote server, <code>\\\\server\\c\\folder\\mapped folder\\subfolder\\file</code> would take you to the same place."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 3, "last_activity_date": 1464804561, "creation_date": 1464804561, "answer_id": 37575907, "question_id": 37575747, "link": "https://stackoverflow.com/questions/37575747/vba-accessing-files-from-a-remote-directory-error-76-path-not-found/37575907#37575907", "title": "VBA accessing files from a remote directory (error 76 - path not found)", "body": "<p>First, use backslashes for Windows paths. Second, don't use double backslashes when referring to a mapped drive. (Labelling the drive is meaningless to VBA.) eg: </p>\n\n<pre><code>X:\\some folder\\some file\n</code></pre>\n\n<p>If you didn't actually create a mapped drive, you will need to use the UNC or IP (and then you do use the double backslash) . EG:</p>\n\n<pre><code>\\\\remotehost\\path\\to\\somefolder\\somefile.txt\n</code></pre>\n\n<p>or </p>\n\n<pre><code>\\\\127.0.0.1\\path\\to\\some folder\\some file.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 6392895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AK2dP.jpg?s=128&g=1", "display_name": "ruirodrigues1971", "link": "https://stackoverflow.com/users/6392895/ruirodrigues1971"}, "is_accepted": false, "score": 0, "last_activity_date": 1464819937, "creation_date": 1464819937, "answer_id": 37579778, "question_id": 37575747, "link": "https://stackoverflow.com/questions/37575747/vba-accessing-files-from-a-remote-directory-error-76-path-not-found/37579778#37579778", "title": "VBA accessing files from a remote directory (error 76 - path not found)", "body": "<p>I think Tim is correct.</p>\n\n<blockquote>\n  <p>How can I debug in Excel if I'm even allowed to enter the drive?</p>\n</blockquote>\n\n<p>If you RECORD macro opening a file in your X drive. You will see all the code that you need to put your original code working ;) . Every VBA coder do that kind of tricks. </p>\n"}], "owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3068, "favorite_count": 0, "accepted_answer_id": 37575907, "answer_count": 2, "score": 0, "last_activity_date": 1464819937, "creation_date": 1464803963, "last_edit_date": 1531164843, "question_id": 37575747, "link": "https://stackoverflow.com/questions/37575747/vba-accessing-files-from-a-remote-directory-error-76-path-not-found", "title": "VBA accessing files from a remote directory (error 76 - path not found)", "body": "<p>I have a remote server I have read permission (in Windows I labeled it as my X: drive)</p>\n\n<p>The correct path to a file I need to access is:</p>\n\n<blockquote>\n  <p>\"X://some dir/some file\"</p>\n</blockquote>\n\n<p>The file that holds the Macro that is running exists in the C: drive. The code below checks to see if the path exists </p>\n\n<pre><code>If dir(\"X://some folder/some file\", vbDirectory) = \"\" Then\n Debug.Print \"dir does not exist\"\nEnd If\n</code></pre>\n\n<p>Running that above enters the branch telling me the file does not exist. My questions are:</p>\n\n<ol>\n<li><p>Do I have to put the name of the drive shorcut? (eg X: or can I put //: instead?)</p></li>\n<li><p>How can I debug in Excel if I'm even allowed to enter the drive?</p></li>\n</ol>\n"}, {"tags": ["excel", "dictionary", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 310510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a583bd0eb94be9da2d382ae73c470c?s=128&d=identicon&r=PG", "display_name": "Agathron", "link": "https://stackoverflow.com/users/310510/agathron"}, "edited": false, "score": 0, "creation_date": 1464806502, "post_id": 37575436, "comment_id": 62639953, "body": "That&#39;s perfect!  the <code>Set dict.Item(k) = c</code> did the trick!  Why is it always something so obvious.  For #2, I&#39;m using the <code>FormulaR1C1</code> specifically to avoid duplicate entries for &quot;like&quot; formulas.  For the analysis I&#39;m doing, if you&#39;re referencing B2 from C2 or F44 from G44 they&#39;re the &quot;same.&quot;  I&#39;m only interested if all of a sudden you&#39;re referencing A6 from C6 instead of B6.  As you mentioned, it&#39;s helping to identify instances where an different formula is added to the mix.  Thank you for the help!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1464802845, "creation_date": 1464802845, "answer_id": 37575436, "question_id": 37574725, "link": "https://stackoverflow.com/questions/37574725/dictionary-of-cells/37575436#37575436", "title": "Dictionary of Cells", "body": "<p>A couple of points:</p>\n\n<ol>\n<li><p>If you want to add a <code>Range</code> object to the dictionary item, you have to use the <code>Set</code> keyword when you're adding it to the dictionary, not when you're retrieving it.</p></li>\n<li><p>The <code>FormulaR1C1</code> of the cell may <em>not</em> be the best key to use. The reason is that, presuming you have the same formula in a series of cells, the key will only be added once. This may be the behavior you desire, and if so, ignore this point. If not, you may need to consider a different key. </p></li>\n</ol>\n\n<p>See the below code. To demonstrate that I'm retrieving a cell from the dictionary, I just colored the cell. Obviously, change that to suit your needs.</p>\n\n<pre><code>Sub AddRangesTdictionary()\n    Dim dict As Object\n    Dim c As Range\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    For Each c In Range(\"B1:B4\")\n        If Not dict.Exists(c.FormulaR1C1) Then\n            Set dict.Item(c.FormulaR1C1) = c\n        End If\n    Next c\n\n    For Each k In dict.Keys\n        dict.Item(k).Interior.ColorIndex = 36\n    Next k\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 310510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a583bd0eb94be9da2d382ae73c470c?s=128&d=identicon&r=PG", "display_name": "Agathron", "link": "https://stackoverflow.com/users/310510/agathron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 1, "accepted_answer_id": 37575436, "answer_count": 1, "score": 0, "last_activity_date": 1464802845, "creation_date": 1464800384, "last_edit_date": 1531164843, "question_id": 37574725, "link": "https://stackoverflow.com/questions/37574725/dictionary-of-cells", "title": "Dictionary of Cells", "body": "<p>I'm trying to create a dictionary where the R1C1 Formula is the key and the cell is the item but am having trouble casting the item when it is retrieved from the dictionary.  So far I have the following code that appears to create the dictionary just fine:</p>\n\n<pre><code>Dim dict As Scripting.Dictionary\nDim c As Range\n\nSet dict = New Scripting.Dictionary\n\nFor Each c In ActiveSheet.UsedRange.Cells\n  If Not dict.Exists(c.FormulaR1C1) Then dict.Item(c.FormulaR1C1) = c\nNext c\n</code></pre>\n\n<p>The problem I'm having is when trying to access the items in the dictionary, I can't seem to figure out how to cast the Item as a Range/Cell.  I tried the following but get a Runtime Error '424': Object Required</p>\n\n<pre><code>Dim r As Range\nDim k As Variant\n\nFor Each k In dict.Keys\n  Set r = dict.Item(k)\nNext k\n</code></pre>\n\n<p>Also tried just treating the item as a range and calling things .Formula property:</p>\n\n<pre><code>Range(\"A1\").value = \"'\" &amp; dict.Item(k).Formula\n</code></pre>\n\n<p>Tried setting it to the \"object\" as follows:</p>\n\n<pre><code>Set r = dict.Item(k).Object\n</code></pre>\n\n<p>None of of which works.  What is the right way to use a dictionary where the item is an object rather than just a string (or is that not possible)?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 83501, "user_id": 166712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f970g.png?s=128&g=1", "display_name": "Anthony Forloney", "link": "https://stackoverflow.com/users/166712/anthony-forloney"}, "edited": false, "score": 0, "creation_date": 1464800189, "post_id": 37574611, "comment_id": 62636461, "body": "Are all tables within the same RDBMS? Which one?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1464800583, "post_id": 37574611, "comment_id": 62636679, "body": "<i>So I&#39;m trying to create the following table</i>...and where is your trial, albeit trial and error? SO is not a code-writing or tutorial service. Please attempt an earnest effort."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 1, "creation_date": 1464801265, "post_id": 37574611, "comment_id": 62637074, "body": "Appears you just need to join from A to B, from A&amp;B to C twice.  once for Name_ID and once form NameID2 alias the tables since your joining twice."}], "answers": [{"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1464813767, "post_id": 37574792, "comment_id": 62643671, "body": "That will not work in Access, Access needs parenthesis in its JOIN statements. The easiest way to do it is to use the query UI to join the tables and then copy/paste the SQL it generates and clean it up (but do not remove the parenthesis from the FROM section)."}], "tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": false, "score": 2, "last_activity_date": 1464819312, "last_edit_date": 1464819312, "creation_date": 1464800590, "answer_id": 37574792, "question_id": 37574611, "link": "https://stackoverflow.com/questions/37574611/how-can-i-join-three-tables-in-sql/37574792#37574792", "title": "How can I join three tables in SQL?", "body": "<p>Try to include the following joins in your solution:</p>\n\n<pre><code>FROM (TableA INNER JOIN TableB ON TableA.Name = TableB.Name) \nINNER JOIN TableC ON (TableA.Name_Att = TableC.Name_Att) AND\n    (TableB.Name_id = TableC.Name_id) \n</code></pre>\n\n<p>You can do the same thing to get <code>Name_Id2</code> and <code>C_id2</code>; make sure to alias your table names correctly.</p>\n"}], "owner": {"reputation": 13, "user_id": 4756908, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbf9ed9705a9610dc316785538a0edfe?s=128&d=identicon&r=PG&f=1", "display_name": "pozza", "link": "https://stackoverflow.com/users/4756908/pozza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464819312, "creation_date": 1464800041, "last_edit_date": 1464809796, "question_id": 37574611, "link": "https://stackoverflow.com/questions/37574611/how-can-i-join-three-tables-in-sql", "title": "How can I join three tables in SQL?", "body": "<p>I'm faced with following problem, I'm not sure how to tackle it. I have a rough idea, but I'm not sure how I would execute it. </p>\n\n<p>Here is the issue </p>\n\n<p>Table <strong>A exist</strong> in the following format:</p>\n\n<pre><code>Name    | Name_Att| Name2 | Name_Att2 \n--------+---------+-------+-------\nryan    |  red    | xyz   |  green\n</code></pre>\n\n<p>Likewise <strong>Table B</strong> exist in this format:</p>\n\n<pre><code>Name    | Name_id |  \n--------+---------+\nryan    | 123     |\nxyz     | 129     |\n</code></pre>\n\n<p>Likewise <strong>Table C</strong> exist in this format:</p>\n\n<pre><code>Name_Att| C_id    | Name_id  \n--------+---------+---------\nred     | 4591    | 123\ngreen   | 4592    | 123\nblue    | 4593    | 123\ngreen   | 4594    | 129\nblue    | 4595    | 129\n</code></pre>\n\n<p><strong>So I'm trying to create the following table:</strong> </p>\n\n<pre><code>Name_id |  C_id   |Name_id2 | C_id2  \n--------+---------+---------+----------\n123     | 4591    | 129     | 4594\n</code></pre>\n\n<p>Is there any way I should go about this? I was thinking about writing code to do this. I'm sure there is SQL way to accomplish this. However I'm not sure. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1464802740, "post_id": 37574598, "comment_id": 62637934, "body": "Sample data would be helpful."}, {"owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 0, "creation_date": 1464803077, "post_id": 37574598, "comment_id": 62638158, "body": "Maybe a UDF would be a better design than a macro..."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "edited": false, "score": 0, "creation_date": 1464842594, "post_id": 37575634, "comment_id": 62651960, "body": "Thank you, your statement was exactly correct. I will use LIKE for wildcards, I never knew it was needed for searching strings. The code looks great and makes logical sense. It works perfectly now."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 2, "last_activity_date": 1464804097, "last_edit_date": 1464804097, "creation_date": 1464803578, "answer_id": 37575634, "question_id": 37574598, "link": "https://stackoverflow.com/questions/37574598/excel-vba-if-some-cell-has-a-0-enter-tbd-in-another-cell/37575634#37575634", "title": "Excel VBA. If Some Cell has a 0, Enter &quot;TBD&quot; in another Cell", "body": "<p>So if I understand your code and your desired result, you are looking at Column A and if any part of the string in A(n) contains \"ANT\", the value to determine Pass/Fail is 9.54. If any part of A(n) contains the string \"<em>SPT</em>-<em>STP</em>\", then the pass/fail value is 25 (btw, using wildcards in a search requires <code>LIKE</code> and evaluates to a boolean.) However, if Column H contains a 0, then L(n) should be \"TBD\" regardless of the value in A(n), correct? If that's the case, you need two IF statements, with the one evaluating column H after the one evaluating Column A:</p>\n\n<pre><code>With ActiveWorkbook.Sheets(8)\n    For x = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n        If InStr(.Cells(x, 1).Value, \"ANT\") &gt; 0 Then\n            .Cells(x, 12).Value = IIf(.Cells(x, 8).Value &lt; 9.54, \"Fail\", \"Pass\")\n        ElseIf .Cells(x, 1).Value Like \"*SPT*-*STP*\" Then\n            .Cells(x, 12).Value = IIf(.Cells(x, 8).Value &lt; 25, \"Fail\", \"Pass\")\n        End If\n\n        If .Cells(x, 8).Value = 0 Then \n        '    .Cells(x, 12).Value = \"TBD\"\n        End If\n    Next x\nEnd With\n</code></pre>\n\n<p>Addendum: It should be noted that if A(n) does not contain either \"ANT\" or some form of \"<em>SPT</em>-<em>STP</em>\", L(n) will be left blank. So if you see cells in column L that are blank, look at column A and determine what you want to do in those cases.</p>\n"}, {"comments": [{"owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "edited": false, "score": 0, "creation_date": 1464842700, "post_id": 37575923, "comment_id": 62651997, "body": "This change you implemented/suggested makes the original code run perfectly. This is also a suggested approach as it uses formulas and speads up the processing of large amounts of data since it populates one function to all cells in the range which is quicker than doing it one cell at a time. Thanks!"}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1464804642, "creation_date": 1464804642, "answer_id": 37575923, "question_id": 37574598, "link": "https://stackoverflow.com/questions/37574598/excel-vba-if-some-cell-has-a-0-enter-tbd-in-another-cell/37575923#37575923", "title": "Excel VBA. If Some Cell has a 0, Enter &quot;TBD&quot; in another Cell", "body": "<p>You have enclosed the second part of the formula in quotes. As it's additional to the formula, the <code>=</code> sign and the extra quotes are not needed</p>\n\n<pre><code>.Formula = \"=IF(H1=0,\"\"TBD\"\",\"\"=IF(H1&lt;IF(ISNUMBER(SEARCH(\"\"\"\"ANT\"\"\"\",A1)),9.54,25),\"\"\"\"Fail\"\"\"\",\"\"\"\"Pass\"\"\"\")\"\")\"\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>.Formula = \"=IF(H1=0,\"\"TBD\"\",IF(H1&lt;IF(ISNUMBER(SEARCH(\"\"ANT\"\",A1)),9.54,25),\"\"Fail\"\",\"\"Pass\"\"))\"\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 455748, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/b82ce6d54924a8bfdc89fd606f6eb157?s=128&d=identicon&r=PG", "display_name": "James Hayek", "link": "https://stackoverflow.com/users/455748/james-hayek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 37575634, "answer_count": 2, "score": 0, "last_activity_date": 1464804642, "creation_date": 1464799994, "question_id": 37574598, "link": "https://stackoverflow.com/questions/37574598/excel-vba-if-some-cell-has-a-0-enter-tbd-in-another-cell", "title": "Excel VBA. If Some Cell has a 0, Enter &quot;TBD&quot; in another Cell", "body": "<p>I am looking to auto populate a cell with one of three strings, PASS, FAIL and TBD</p>\n\n<p>The code I have below works for the PASS and FAIL senerios, but not for TBD</p>\n\n<p>In one column (column A) I have the name of a bunch of files. If the filename contains the string \"ANT\" I have a tripping value, to populate a FAIL, of any value less than 9.54</p>\n\n<p>Else, set the tripping value to 25.</p>\n\n<p>What I would actually like is the following:</p>\n\n<p>If the value contains <em>SPT</em>-<em>-SPT</em> (where the astrics are any values before or after SPT) I have the tripping value set to 25</p>\n\n<p>Else, if I see a 0 in column H enter \"TBD\" in column L</p>\n\n<p>The latest code used a formula and is as follows:</p>\n\n<pre><code>Sub PassFail()\n\n  'Specify which sheet (name) of the active workbook we want to work on\n  With Sheets(\"(5) Coax Cable Sweeps Table\")\n\n    'Determine the range we want to put values into\n    With .Range(\"L1:L\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row)\n\n      'Put the standard worksheet formula into all cells at once by specifying the formula for the 1st cell only\n      'Note that any quote marks in the actual formula need to be doubled up at this point\n\n      'This line does not consider any zeros for DTF measurments taken without a load\n      .Formula = \"=IF(H1&lt;IF(ISNUMBER(SEARCH(\"\"ANT\"\",A1)),9.54,25),\"\"Fail\"\",\"\"Pass\"\")\"\n\n\n      'The below formula DOES NOT WORK as intended.\n      '.Formula = \"=IF(H1=0,\"\"TBD\"\",\"\"=IF(H1&lt;IF(ISNUMBER(SEARCH(\"\"\"\"ANT\"\"\"\",A1)),9.54,25),\"\"\"\"Fail\"\"\"\",\"\"\"\"Pass\"\"\"\")\"\")\"\n\n      .Value = .Value\n     End With\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>I then tried to use If, elseIf logic and came up with the following:</p>\n\n<pre><code>Sub PassFail_v1()\n\n\n\n\n    Dim x   As Long\n\n\n    Application.ScreenUpdating = False\n\n    With ActiveWorkbook.Sheets(8)\n        For x = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n            If InStr(.Cells(x, 1).Value, \"ANT\") &gt; 0 Then\n                .Cells(x, 12).Value = IIf(.Cells(x, 8).Value &lt; 9.54, \"Fail\", \"Pass\")\n\n            ElseIf InStr(.Cells(x, 1).Value, \"*SPT*-*STP*\") &gt; 0 Then\n                .Cells(x, 12).Value = IIf(.Cells(x, 8).Value &lt; 25, \"Fail\", \"Pass\")\n\n           ' Else\n            '    .Cells(x, 12).Value = IIf(.Cells(x, 8).Value = 0, \"TBD\", \" \")\n\n            End If\n        Next x\n    End With\n\n\n\n\n    Application.ScreenUpdating = True\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Which still doesn't work.. \nSome cells in column L are left blank, others with a 0 in column H show TBD in column L (which is nice), and others show FAILS at a 0 when they shouldn't.</p>\n\n<p>Any advice?</p>\n"}, {"tags": ["vba", "reference", "cell"], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1464800004, "creation_date": 1464800004, "answer_id": 37574602, "question_id": 37574528, "link": "https://stackoverflow.com/questions/37574528/vba-cell-referencing-in-other-worksheet/37574602#37574602", "title": "VBA Cell Referencing in other Worksheet", "body": "<p>For your first problem, try simply</p>\n\n<pre><code>Worksheets(\"Data9\").Cells(187, 2) = Worksheets(\"9-Benefits\").Cells(75, 8)\n</code></pre>\n\n<p>And the second issue should be able to be accomplished with</p>\n\n<pre><code>Worksheets(\"Data9\").Cells(235, 1).ClearContents\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6386512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hWQVMph3yac/AAAAAAAAAAI/AAAAAAAABXQ/hNRQ1msAdq8/photo.jpg?sz=128", "display_name": "Israel Ramirez", "link": "https://stackoverflow.com/users/6386512/israel-ramirez"}, "is_accepted": false, "score": 0, "last_activity_date": 1464819714, "creation_date": 1464819714, "answer_id": 37579733, "question_id": 37574528, "link": "https://stackoverflow.com/questions/37574528/vba-cell-referencing-in-other-worksheet/37579733#37579733", "title": "VBA Cell Referencing in other Worksheet", "body": "<p>The previous answer provided by Matt Cremeens is correct but I can't be sure what you mean by saying you want \"cell B187 on sheet titled Data9 to reference sheet 9-Benefits cell H75\"</p>\n\n<p>If you want the value in cell B187 to show whatever is on 9-Benefits H75 even after it changes, then you want:\nWorksheets(\"Data9\").Range(\"B187\").Formula = \"='9-Benefits'!$H$75\"\nMatt's formula copies the value. My formula creates a link. I am not sure which you want.</p>\n"}], "owner": {"reputation": 1, "user_id": 6410791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210105436057957/picture?type=large", "display_name": "Maddie Stupinski", "link": "https://stackoverflow.com/users/6410791/maddie-stupinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1464819714, "creation_date": 1464799778, "question_id": 37574528, "link": "https://stackoverflow.com/questions/37574528/vba-cell-referencing-in-other-worksheet", "title": "VBA Cell Referencing in other Worksheet", "body": "<p>On the current file I'm trying to write a macro for, I want the cell B187 on sheet titled Data9 to reference sheet 9-Benefits cell H75. How do I write this in VBA?</p>\n\n<p>Also I'm trying to clear contents in cell A235 on the Data9 sheet. How do I write this?</p>\n\n<p>I think this is fairly easy code but I'm a bit stuck.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "list", "search", "add", "names"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "edited": false, "score": 0, "creation_date": 1464804255, "post_id": 37574445, "comment_id": 62638772, "body": "Hi Newguy Thank you for your response. Unfortunately this is not working as Expected although perhaps a little closer than I had. Now if I enter a name on the user form in txtName that is in the list in AA then it clears all of the names out. If I enter a name that is not in the list AA then it replaces all of the names with the 1 I just entered plus 1 row (Which is the only 1 I wanted to add to). I am not sure if it is my fault for not explaining well. I only want to a the name from the user form to the bottom of the list in column AA if it is not already there if it is then do nothing else."}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": false, "score": 0, "last_activity_date": 1464801466, "last_edit_date": 1464801466, "creation_date": 1464799525, "answer_id": 37574445, "question_id": 37574156, "link": "https://stackoverflow.com/questions/37574156/add-new-name-from-user-form-if-not-in-list-excel-vba/37574445#37574445", "title": "Add new name from user form if not in list. Excel VBA", "body": "<p>Maybe this is what you're looking for ?</p>\n\n<p>Used a flag to check if found or not</p>\n\n<pre><code>Private Sub txtName_AfterUpdate()\n  Dim intMyVal As String\n  Dim lngLastRow As Long\n  Dim strRowNoList As String\n  Dim flg As Boolean\n\n  intMyVal = txtName.Value 'Value to search for, change as required.\n    lngLastRow = Cells(Rows.Count, \"AA\").End(xlUp).Row 'Search Column AA, change as required.\n    flg=False\n\n    For Each cell In Range(\"AA4:AA\" &amp; lngLastRow) 'Starting cell is AA4, change as required.\n\n      If cell.Value = intMyVal Then\n\n        If strRowNoList = \"\" Then\n             strRowNoList = strRowNoList &amp; cell.Row\n             flg=True\n          Else\n             strRowNoList = strRowNoList &amp; \", \" &amp; cell.Row\n              flg=True      \n        End If\n\n      End If\n\n\n    Next cell\n   if flg=False then Range(\"AA4:AA\" &amp; lngLastRow + 1) = txtName.value\n\nEnd Sub \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "edited": false, "score": 0, "creation_date": 1464808005, "post_id": 37576208, "comment_id": 62640669, "body": "I see now where My explanation has gone wrong.This is the after update in the txtName field from the user form. From here I am trying to work out if the name exists in the list that is held in AA. If it dose then carry on if it dose not then add it after the last row in AA. I then run the bulk of the routine again When More data is added to update the other fields. At that point the name exists and I find the row and add the other fields to it. My fault sorry. I will get back to you with the results once tested the above. Thank you fro your time and assistance."}, {"owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "edited": false, "score": 0, "creation_date": 1464877874, "post_id": 37576208, "comment_id": 62674435, "body": "I had an idea to approach this from another angle. The after update on the last field txtDirection does all the updates adding a record to 1 row starting at column A (this 1 is kept) and updating the row where the name occurs in the list starting at column AA, which is over written each time. This is directed by a case statement. All works if the name is there. So I added another Case for NEW and added an add name to the bottom of the list in AA.I need to change the code so it works because the name is not in AA not because I type NEW. If any one could help that would be appreciated. Thank you"}, {"owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "edited": false, "score": 0, "creation_date": 1464877994, "post_id": 37576208, "comment_id": 62674538, "body": "I cannot add the code as it is to long is there a way to attach a text file?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1464805662, "creation_date": 1464805662, "answer_id": 37576208, "question_id": 37574156, "link": "https://stackoverflow.com/questions/37574156/add-new-name-from-user-form-if-not-in-list-excel-vba/37576208#37576208", "title": "Add new name from user form if not in list. Excel VBA", "body": "<p>Really hard to understand your needs </p>\n\n<p>Maybe they are these ones</p>\n\n<pre><code>Private Sub txtName_AfterUpdate()\n  Dim myVal As String, strRowNoList As String\n  Dim srchRng as Range \n\n  myVal = txtName.Value 'Value to search for, change as required.\n  With Worksheets(\"MySheet\") '&lt;~~ change it as per your actual sheet name\n    Set srchRng = .Range(\"AA4:AA\" &amp; .Cells(.Rows.Count, \"AA\").End(xlUp).Row) \n    For Each cell In srchRng \n      If cell.Value = myVal Then strRowNoList = strRowNoList &amp; cell.Row &amp; \",\"\n    Next cell\n\n    If strRowNoList &lt;&gt; \"\" Then \n        strRowNoList = Left(strRowNoList, Len(strRowNoList) - 1)\n    Else \n        strRowNoList = CStr(srchRng.Rows(srchRng.Rows.Count).Row + 1)\n    End If \n  End With \nEnd Sub \n</code></pre>\n\n<p>But then I guess you have to pass <code>strRowNoList</code> to some routine that does the writing/overwriting.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "is_accepted": false, "score": 0, "last_activity_date": 1465216709, "creation_date": 1465216709, "answer_id": 37657713, "question_id": 37574156, "link": "https://stackoverflow.com/questions/37574156/add-new-name-from-user-form-if-not-in-list-excel-vba/37657713#37657713", "title": "Add new name from user form if not in list. Excel VBA", "body": "<p>Thank you to everyone for their help and input. I worked out a way to do this using an error handler and although I do not think the solution is concise or pretty I have been able to make it work. I am sure some of the experts on here would be able to do the same in much less code if I could have explained my requirements clearer.</p>\n\n<pre><code>Private Sub txtDirection_AfterUpdate()\nOn Error GoTo MyerrorHandler:\nDim intMyVal As String\nDim lngLastRow As Long\nDim strRowNoList As String\n\nintMyVal = txtName.Value 'Value to search for, change as required.\nlngLastRow = Cells(Rows.Count, \"AA\").End(xlUp).Row 'Search Column A, change as required.\n\nFor Each cell In Range(\"AA4:AA\" &amp; lngLastRow) 'Starting cell is F2, change as required.\n\n    If cell.Value = intMyVal Then\n        If strRowNoList = \"\" Then\n            strRowNoList = strRowNoList &amp; cell.Row\n        Else\n            strRowNoList = strRowNoList &amp; \", \" &amp; cell.Row\n        End If\n    End If\nNext cell\n\nIf txtDirection.Value &lt;&gt; \"\" Then\nUreg.txtDirection.SetFocus\nSelect Case txtDirection.Value 'If the user scans in\n    Case \"IN\"\n        Range(\"A2\").Select\nActiveCell.End(xlDown).Select\nLastRow = ActiveCell.Row\nCells(LastRow + 1, 1).Value = txtDate.Text\nCells(LastRow + 1, 2).Value = Time\nCells(LastRow + 1, 3).Value = txtName.Text\nCells(LastRow + 1, 4).Value = txtLocation.Text\nCells(LastRow + 1, 5).Value = Range(\"F1\").Value\nCells(LastRow + 1, 6).Value = txtName.Text &amp; txtLocation.Text\nCells(strRowNoList, 28).Value = txtDirection.Text\nCells(strRowNoList, 29).Value = txtDate.Text\nCells(strRowNoList, 30).Value = Time\nCells(strRowNoList, 31).Value = txtLocation.Text\nRange(\"A2\").Select\ntxtDate.Value = Date\ntxtName.Text = \"\"\ntxtLocation.Text = \"\"\ntxtDirection.Text = \"\"\nUreg.txtName.SetFocus\n\n        Case \"OUT\" 'If the user scans OUT\n\n Range(\"A2\").Select\nActiveCell.End(xlDown).Select\nLastRow = ActiveCell.Row\nCells(LastRow + 1, 1).Value = txtDate.Text\nCells(LastRow + 1, 2).Value = Time\nCells(LastRow + 1, 3).Value = txtName.Text\nCells(LastRow + 1, 4).Value = txtLocation.Text\nCells(LastRow + 1, 5).Value = Range(\"F1\").Value\nCells(strRowNoList, 28).Value = txtDirection.Text\nCells(strRowNoList, 29).Value = txtDate.Text\nCells(strRowNoList, 30).Value = Time\nCells(strRowNoList, 31).Value = txtLocation.Text\nCells(LastRow + 1, 6).Value = txtName.Text &amp; txtLocation.Text\nRange(\"H2\").Select\ntxtDate.Value = Date\ntxtName.Text = \"\"\ntxtLocation.Text = \"\"\ntxtDirection.Text = \"\"\nUreg.txtName.SetFocus\n\n        Case \"NEW\"  'Extra code if the user is set up as a NEW person No longer needed if the erro handler works.\n Range(\"A2\").Select\nActiveCell.End(xlDown).Select\nLastRow = ActiveCell.Row\nCells(LastRow + 1, 1).Value = txtDate.Text\nCells(LastRow + 1, 2).Value = Time\nCells(LastRow + 1, 3).Value = txtName.Text\nCells(LastRow + 1, 4).Value = txtLocation.Text\nCells(LastRow + 1, 5).Value = Range(\"F1\").Value\nCells(lngLastRow + 1, 31).Value = txtName.Text\nCells(lngLastRow + 1, 32).Value = \"IN\"\nCells(lngLastRow + 1, 33).Value = txtDate.Text\nCells(lngLastRow + 1, 34).Value = Time\nCells(lngLastRow + 1, 35).Value = txtLocation.Text\nCells(LastRow + 1, 6).Value = txtName.Text &amp; txtLocation.Text\nRange(\"H2\").Select\ntxtDate.Value = Date\ntxtName.Text = \"\"\ntxtLocation.Text = \"\"\ntxtDirection.Text = \"\"\nUreg.txtName.SetFocus\n\n        Case Else 'Message if the user scannes something other than in , out or new.\n            'MsgBox \"Please enter either IN or OUT\"\n                Dim AckTime As Integer, InfoBox As Object\n    Set InfoBox = CreateObject(\"WScript.Shell\")\n    'Set the message box to close after 10 seconds\n    AckTime = 5\n    Select Case InfoBox.Popup(\"Please enter either IN or OUT. Please try again.                                                         (This window will close automatically                                                                  after 5 seconds).\", _\n    AckTime, \"Inccorect Destination Scanned\", 0)\n        Case 1, -1\n            Exit Sub\n    End Select\n    End Select\n    End If\n    With ActiveWorkbook\n   .SaveCopyAs .Path &amp; \"\\\" &amp; Format(Date, \"yyyymmdd\") &amp; \"-\" &amp; [A1] &amp; \".xlsm\" 'This will save the sheet evertime a user scan is complete.\n\n    'MsgBox strRowNoList\n    End With\n'End Sub\n\nMyerrorHandler: 'This adds the name of the uses to the list in AA if they are not there already and then finishes the same code as above for a booking in. No new user should be scanning out.\nIf Err.Number = 13 Then\nCells(lngLastRow + 1, 27).Value = txtName.Text\nCells(lngLastRow + 1, 28).Value = \"IN\"\nCells(lngLastRow + 1, 29).Value = txtDate.Text\nCells(lngLastRow + 1, 30).Value = Time\nCells(lngLastRow + 1, 31).Value = txtLocation.Text\nRange(\"H2\").Select\ntxtDate.Value = Date\ntxtName.Text = \"\"\ntxtLocation.Text = \"\"\ntxtDirection.Text = \"\"\nUreg.txtName.SetFocus\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks once again to all, </p>\n"}], "owner": {"reputation": 1, "user_id": 6410650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb813622f6e78a05e6183ab3aba6075f?s=128&d=identicon&r=PG&f=1", "display_name": "Mick Peters", "link": "https://stackoverflow.com/users/6410650/mick-peters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1575, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1465216709, "creation_date": 1464798558, "last_edit_date": 1464801059, "question_id": 37574156, "link": "https://stackoverflow.com/questions/37574156/add-new-name-from-user-form-if-not-in-list-excel-vba", "title": "Add new name from user form if not in list. Excel VBA", "body": "<p>Hi I am relatively new to VBA but have managed to adapt some code and write a bit myself.</p>\n\n<p>I now however have a problem. I have the below code that I found and adapted. I present a user form and the user inputs a name and other information.</p>\n\n<p>The code searches the list of names and adds the other information alongside the name. Over writing what is already there. If I have a new user I have to add the name at the bottom and all continues to work well. </p>\n\n<p>I was wondering if anyone here could see in the code where I need to add some lines so if the code dose not find the name in the list then if addes it at the bottom please?</p>\n\n<pre><code>Private Sub txtName_AfterUpdate()\n  Dim intMyVal As String\n  Dim lngLastRow As Long\n  Dim strRowNoList As String\n\n intMyVal = txtName.Value 'Value to search for, change as required.\n    lngLastRow = Cells(Rows.Count, \"AA\").End(xlUp).Row 'Search Column AA, change as required.\n\n    For Each cell In Range(\"AA4:AA\" &amp; lngLastRow) 'Starting cell is AA4, change as required.\n\n      If cell.Value = intMyVal Then\n\n        If strRowNoList = \"\" Then\n             strRowNoList = strRowNoList &amp; cell.Row\n          Else\n           strRowNoList = strRowNoList &amp; \", \" &amp; cell.Row      \n        End If\n\n      End If\n\n    Next cell\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 1, "creation_date": 1464798913, "post_id": 37574020, "comment_id": 62635707, "body": "Make your life easier and remove the MS Access part. The direct call to SQL is going to take .0001 seconds."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1464805146, "post_id": 37574020, "comment_id": 62639197, "body": "It sounds like you are trying to make things too hard on yourself. Linked tables to SQL Server work well. Because the links hold the connection string, your code and queries don&#39;t have to reference it. You can also link queries to SQL Server, which is a handy way to call functions and stored procedures."}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "reply_to_user": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1464854137, "post_id": 37574020, "comment_id": 62657245, "body": "@Chuck The MS Access part for is the eventual users to enter their data so that I can quickly set up an environment with buttons, data validation, errorcatching etc"}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1464854580, "post_id": 37574020, "comment_id": 62657534, "body": "@kismert So standard practice would be to link the tables and use forms etc to populate the tables in access &#39;in bulk&#39; rather than allow the user direct access? Effectively removing the need for the connection string by duplicating the data on an access table that can be directly referenced, is this correct? Is this typically much slower? how about size restrictions?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1464862533, "post_id": 37574020, "comment_id": 62663007, "body": "I&#39;ve had a lot of success with MS Access ADP (Access data projects) though for some unknown reason they are possibly becoming discontinued. An ADP is basically native access to SQL Server from within MS Access - try it out"}], "answers": [{"comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1464877206, "post_id": 37588634, "comment_id": 62673875, "body": "It seems to me that you are only moving the problem around. True, you avoid linked tables, but instead you use linked pass-through queries, which is essentially the same thing. You could avoid all static links by dynamically linking in code, but you would have to do all of your SQL work in code only, and you couldn&#39;t use any stand-alone tables or queries at all."}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1464879017, "post_id": 37588634, "comment_id": 62675402, "body": "@kismert The benefit of this for me is that it isn&#39;t two way. Linked tables means change in access table = change in sql server table, whereas this is just going to be a read only version of what may be a full or portion of a table. Most of the smaller queries that I didn&#39;t want to have to keep putting the connection string into will be handled through code anyway because they&#39;ll contain variables based on user selections in forms"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464887443, "post_id": 37588634, "comment_id": 62681251, "body": "If you don&#39;t want to allow your Access users to modify data in a linked SQL Server table, either manage their permissions in SQL Server (revoke <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> privileges) or link the table with a separate SQL Server read-only account."}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464943973, "post_id": 37588634, "comment_id": 62703440, "body": "@Hansup the link is set up through a generic account, this account does have those privileges because I do want to be able to perform these actions from this account through the access db. However I want to be able to do them through forms/vba without having a version of the table on the access front end that users can directly perform those actions against. I.e. I don&#39;t want users to be able to circumvent any front end data validation and affect the table directly themselves. Thanks for your help via the post quoted above by the way"}], "tags": [], "owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "is_accepted": false, "score": 1, "last_activity_date": 1464862643, "last_edit_date": 1495542708, "creation_date": 1464861669, "answer_id": 37588634, "question_id": 37574020, "link": "https://stackoverflow.com/questions/37574020/way-to-reference-access-and-sql-server-tables-without-directly-referring-to-conn/37588634#37588634", "title": "Way to reference access and sql server tables without directly referring to connection string within query", "body": "<p><a href=\"https://stackoverflow.com/questions/10215212/append-records-from-passthrough-query-to-local-table\">This Post</a>, answered by HansUp (Sorry not enough rep for an upvote) \nspecifically this:</p>\n\n<pre><code>INSERT INTO MyNewTable (fld1, fld2)\nSELECT first_field, second_field FROM YourPassThruQuery;\n</code></pre>\n\n<p>provides a possible solution without linked tables</p>\n\n<p>Rather than the approach I was trying to take of inserting to an access table from a sqlserver table I can insert to an access table from an access pass through query</p>\n\n<p>By having the connection string in a couple of pass through queries that relate to all the data I need from the server I can then reference these in the multitude of sub queries relating to user input without having the connection string in each one</p>\n\n<p>The question of whether this is method that <strong>should</strong> be used for this problem stands, but this seems like a viable solution, or at least compromise to limit the number of connection references</p>\n\n<p><strong>Edit:</strong> By combining the above with <a href=\"https://support.microsoft.com/en-us/kb/112108\" rel=\"nofollow noreferrer\">this</a> and hardcoding the connection string I should be able to only reference the connection once, provided the SQL server tables are all on the same database</p>\n"}, {"comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1464908400, "post_id": 37594869, "comment_id": 62691525, "body": "I believe ADP&#39;s are meant to be replaced by some kind of sharepoint implementation but <b>they are so useful</b>"}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1464944591, "post_id": 37594869, "comment_id": 62703817, "body": "@kismert. Still can&#39;t upvote but I have accepted this as the answer, whilst it may not be the approach I will use (and only because I am more comfortable hiding connections from users in code rather than just hiding tables I don&#39;t want them messing with), it does seem to be the standard solution and does avoid any coded connection strings repetition. Thanks for your time helping with this"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 0, "last_activity_date": 1464878064, "creation_date": 1464878064, "answer_id": 37594869, "question_id": 37574020, "link": "https://stackoverflow.com/questions/37574020/way-to-reference-access-and-sql-server-tables-without-directly-referring-to-conn/37594869#37594869", "title": "Way to reference access and sql server tables without directly referring to connection string within query", "body": "<p>Sadly (for some) ADPs are out. ADO is out too. </p>\n\n<p>The current recommendation for Access/SQL Server desktop applications is linked tables and queries over DAO using the SQL Server Native Client, version 11.0 or later. Starting with Access 2013, Microsoft has done a lot of work to make this arrangement perform well with SQL Server and Azure. </p>\n\n<p>As for your question in the comments, whether you need to synchronize local Access tables with remote SQL ones depends on what the application is supposed to do: </p>\n\n<ul>\n<li>If the user expects to be able to work while disconnected from the\nnetwork/internet/cloud, then you need to synchronize local tables</li>\n<li>But, if you are doing a standard application, where persistent links\nto the SQL data are assumed, then just do all of your reads and\nwrites against linked SQL tables. Use pass-through queries to call stored procedures and functions.</li>\n</ul>\n"}], "owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 37594869, "answer_count": 2, "score": 0, "last_activity_date": 1464878064, "creation_date": 1464798104, "question_id": 37574020, "link": "https://stackoverflow.com/questions/37574020/way-to-reference-access-and-sql-server-tables-without-directly-referring-to-conn", "title": "Way to reference access and sql server tables without directly referring to connection string within query", "body": "<p>I am working on a project that will use MS Access as front end and SQL Server for data storage. I don't want to link the tables directly because I don't want to take the speed hit to the front end from the 'live' updates. I can't reference the Access DB through JET etc because it is not based in a fixed location so I can't pass through and run directly from server end</p>\n\n<p>I've got as far as this (vba in access):</p>\n\n<pre><code>Sub inserttoaccess()\n   strSQL = \"insert into AccessTable SELECT * FROM [myserverconnectionstring;].servertable\"\n   CurrentDb.Execute (strSQL), dbFailOnError\nEnd Sub    \n\nSub inserttoserver()\n    strSQL = \"insert into [myserverconnectionstring;].servertable SELECT * FROM AccessTable\"\n    CurrentDb.Execute (strSQL), dbFailOnError\nEnd Sub\n</code></pre>\n\n<p>Which works, and hopefully demonstrates what I need to do, but I'm looking for a way to do it which doesn't require me to keep referring back to the connection in every query. Maybe a way to link to the server without linking specific tables or a function that I could hardcode the connection string but pass the query, but not sure how that would work...</p>\n\n<p>This is the first time I've been looking at using MS Access and SQL Server together so looking for some input as to how those more experienced approach this please</p>\n"}, {"tags": ["excel", "vba", "batch-file", "jenkins"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464808344, "post_id": 37573921, "comment_id": 62640828, "body": "Is your Office install 32-bit or 64-bit ?"}, {"owner": {"reputation": 1693, "user_id": 4243316, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/592e34b66d2d46db26df8d238d5f2294?s=128&d=identicon&r=PG&f=1", "display_name": "salsinga", "link": "https://stackoverflow.com/users/4243316/salsinga"}, "edited": false, "score": 0, "creation_date": 1517562040, "post_id": 37573921, "comment_id": 84154284, "body": "I am facing the similar issue,I ran cscript &lt;script-name&gt;.vbs but got the following error:                                                                                  Caused: java.io.IOException: Cannot run program &quot;/bin/sh&quot; (in directory &quot;C:\\Jenkins\\workspace\\generateParams&quot;): CreateProcess error=2, The system cannot find the file specified.                                                                   My vbs script open an excel file --&gt;runs a macro--&gt;closes it.The excel file  and vbs script is at the same location,but is different from jenkins workspace.Is this the cause of issue?"}, {"owner": {"reputation": 166, "user_id": 1541782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bdde21a273ff5e6c1a3d453ec23b4ce4?s=128&d=identicon&r=PG", "display_name": "Ben1980", "link": "https://stackoverflow.com/users/1541782/ben1980"}, "edited": false, "score": 0, "creation_date": 1523891893, "post_id": 37573921, "comment_id": 86740525, "body": "Late but there is a similar question [Jenkins QC plugin Can&#39;t create TDConnection Object ](<a href=\"https://stackoverflow.com/questions/18319573/jenkins-qc-plugin-cant-create-tdconnection-object\" title=\"jenkins qc plugin cant create tdconnection object\">stackoverflow.com/questions/18319573/&hellip;</a>) which points to a <a href=\"http://www.sqaforums.com/showflat.php?Number=479531\" rel=\"nofollow noreferrer\">workaround</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1464803430, "creation_date": 1464803430, "answer_id": 37575586, "question_id": 37573921, "link": "https://stackoverflow.com/questions/37573921/running-excel-macros-from-jenkins/37575586#37575586", "title": "Running Excel macros from Jenkins", "body": "<p>Try using</p>\n\n<p><code>Set xlApp = GetObject(\"Excel.Application\")</code></p>\n\n<p>On closer reading of your question, it seems like you may have trouble with executables.  Hmmm, can you actually give a full command line, soo instead of run/double click <code>foo.vbs</code> something like <code>script.exe foo.vba</code>.  I made up script.exe but you should get the point, why not specify the executable?</p>\n\n<p>I have seldom heard of Jenkins, care to provide any documentation links you think maybe relevant to this issue.  It's all useful  for future stackoverflower meeting the same problem.</p>\n"}], "owner": {"reputation": 36, "user_id": 5669763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f251fe7772351e1dd66eafa2836f0d77?s=128&d=identicon&r=PG&f=1", "display_name": "kakronst", "link": "https://stackoverflow.com/users/5669763/kakronst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2070, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523891893, "creation_date": 1464797811, "last_edit_date": 1498687039, "question_id": 37573921, "link": "https://stackoverflow.com/questions/37573921/running-excel-macros-from-jenkins", "title": "Running Excel macros from Jenkins", "body": "<p>I am trying to run Excel macros from a Jenkins Windows service on Windows 7 64-bit VM. I have a batch file that specifies VBS files. Then in the VBS files, the Excel macros are listed. The batch files run fine locally, but when I run it from Jenkins, I get the following error:</p>\n\n<blockquote>\n  <p>Microsoft VBScript runtime error: ActiveX component can't create object: 'Excel.Application'</p>\n</blockquote>\n\n<p>The error seems to occur on each instance of the following in the VBS files:</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\n</code></pre>\n\n<p>Just searching around, I see that lots of other people have had problems with the version of <code>cscript</code> being used to execute the VBS files. On 64-bit computers, it seems that the 32-bit version of <code>cscript</code> must be used. But no matter how I try to force that version of <code>cscript</code> to be used, Jenkins seems to ignore it and display the same error, which makes me think that the <code>cscript</code> version is not the cause of my error.</p>\n\n<p>I do have macros enabled in Excel and checked the ActiveX settings too. Like I said, double-clicking the batch file, everything works fine. There's gotta be something weird Jenkins is doing to cause the problem.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "checkbox", "userform", "subroutine"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1464797824, "post_id": 37573803, "comment_id": 62635009, "body": "Range(&quot;a1&quot;).value=check box.value if I get what you need :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6410572"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1464798627, "post_id": 37573803, "comment_id": 62635520, "body": "@newguy That&#39;s if the checkbox was on the worksheet. I get that you can do that. I haven&#39;t been able to find a way when the checkbox value is coming form a userform. I have several checkboxes on a userform and I&#39;d like to pass that value to a subroutine."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1464798888, "post_id": 37573803, "comment_id": 62635697, "body": "@ChasEsau then I think Nathan has already  answered that. Like this <code>var = checkbox1.value</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464804724, "post_id": 37573803, "comment_id": 62638984, "body": "What&#39;s not clear is what kind of action/event would trigger this? It&#39;s a question of how to interact with the controls on the UserForm - we don&#39;t have enough context... You can almost certainly do what you propose, but in order to describe <i>how</i> we need more background."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6410572"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464808187, "post_id": 37573803, "comment_id": 62640754, "body": "@CindyMeister The user fills out a userform, that has several checkboxes. All the code works, I just have several repeating if statements and the only thing that changes in them is the name of the checkbox. I was hoping to tidy up a bit and just call to a subroutine."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6410572"}, "edited": false, "score": 0, "creation_date": 1464896405, "post_id": 37600050, "comment_id": 62686304, "body": "Thank you, exactly what I was looking for."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1464893882, "creation_date": 1464893882, "answer_id": 37600050, "question_id": 37573803, "link": "https://stackoverflow.com/questions/37573803/reference-checkbox-name-value-in-a-subroutine/37600050#37600050", "title": "Reference checkbox name/value in a subroutine", "body": "<p>The following code example demonstrates how to pass a Checkbox control on a UserForm to another procedure, get the checkbox's value and caption, and do something with them.</p>\n\n<p>Note that I choose to pass the checkbox, rather than the value and caption as two parameters, as this will reduce the amount of code you need to type.</p>\n\n<pre><code>Private Sub btnOK_Click()\n    Dim chk As MSForms.CheckBox\n    Set chk = Me.CheckBox1\n    ProcessCheckBox chk\n    ProcessCheckBox Me.CheckBox2\nEnd Sub\n\nSub ProcessCheckBox(chk As MSForms.CheckBox)\n    Dim chkVal As Boolean\n    Dim chkCap As String\n\n    chkVal = chk.value\n    chkCap = chk.Caption\n    If chkVal = True Then\n        Debug.Print chkCap &amp; \" is true\"\n    Else\n        Debug.Print chkCap &amp; \" is false\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6410572"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1650, "favorite_count": 0, "accepted_answer_id": 37600050, "answer_count": 1, "score": 0, "last_activity_date": 1464893882, "creation_date": 1464797398, "last_edit_date": 1464800828, "question_id": 37573803, "link": "https://stackoverflow.com/questions/37573803/reference-checkbox-name-value-in-a-subroutine", "title": "Reference checkbox name/value in a subroutine", "body": "<p>Is there a way to pass a checkbox value from a userform? I've seen it done when the checkbox is on the worksheet but I haven't been able to get it to work when it comes from my userform.</p>\n\n<p>I have several repeating if statements and the only difference between them is the name of the checkbox. I'm sure there's a simple fix that I just haven't found yet. Any help is appreciated.</p>\n\n<p>Edit: included code</p>\n\n<pre><code>If LockboxCheckBox.Value = True Then\n    If IsEmpty(wsInput.Cells(emptyRow, productCol)) Then\n        wsInput.Cells(emptyRow, productCol).Value = LockboxCheckBox.Caption\n    Else: wsInput.Cells(emptyRow, productCol).Value = wsInput.Cells(emptyRow, productCol).Value &amp; \", \" &amp; LockboxCheckBox.Caption\n    End If\nEnd If\n</code></pre>\n\n<p>I want to make this a small subroutine and need to pass the checkbox.value as well as the checkbox.caption to it when I call it.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6366207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb9608984e5897b9037c764a7006173?s=128&d=identicon&r=PG&f=1", "display_name": "user6366207", "link": "https://stackoverflow.com/users/6366207/user6366207"}, "edited": false, "score": 0, "creation_date": 1464801798, "post_id": 37573615, "comment_id": 62637393, "body": "However if I open another Excel file in the same time, it doesn&#39;t work"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 6366207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb9608984e5897b9037c764a7006173?s=128&d=identicon&r=PG&f=1", "display_name": "user6366207", "link": "https://stackoverflow.com/users/6366207/user6366207"}, "edited": false, "score": 0, "creation_date": 1464801908, "post_id": 37573615, "comment_id": 62637455, "body": "@user6366207 it should as long as you put the <code>.</code> in front of every <code>Sheets(&quot;...</code> that is tied to the workbook stated in the <code>With Worbook(&quot;...</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1464796832, "creation_date": 1464796832, "answer_id": 37573615, "question_id": 37573507, "link": "https://stackoverflow.com/questions/37573507/vba-automatization/37573615#37573615", "title": "VBA automatization", "body": "<p>First I would use a with block to stop repetitive typing.  Then use Match() to see if the value exist in the range or not:</p>\n\n<pre><code>With Workbooks(\"A.xlsm\")\nIf .Sheets(\"1\").Cells(i, 14).Value &gt; 100000 _\n    And IsError(Application.Match(.Sheets(\"1\").Cells(i, 6), .Sheets(\"B\").Range(.Sheets(\"B\").Cells(2, 5), .Sheets(\"B\").Cells(10, 5)), 0)) Then\n\n    'the rest of your code\n\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6366207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb9608984e5897b9037c764a7006173?s=128&d=identicon&r=PG&f=1", "display_name": "user6366207", "link": "https://stackoverflow.com/users/6366207/user6366207"}, "edited": false, "score": 0, "creation_date": 1464800919, "post_id": 37574259, "comment_id": 62636866, "body": "You&#39;re right, I should have used &quot;Or&quot; instead. Thanks for your comment !"}], "tags": [], "owner": {"reputation": 46, "user_id": 6372633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535ccc6bc3a7bc6a2b105e0567fb2613?s=128&d=identicon&r=PG&f=1", "display_name": "Hathawulf", "link": "https://stackoverflow.com/users/6372633/hathawulf"}, "is_accepted": true, "score": 0, "last_activity_date": 1464798901, "creation_date": 1464798901, "answer_id": 37574259, "question_id": 37573507, "link": "https://stackoverflow.com/questions/37573507/vba-automatization/37574259#37574259", "title": "VBA automatization", "body": "<p>You may have an error in your code sample.\nIf you don't, then you are creating a bunch of And statements that look at multiple row,5 cells looking for a match.</p>\n\n<p>In this case, each of those multiple row,5 cells would have to be equal and match the single (i, 6) value you are comparing.</p>\n\n<p>If this code is correct, then you only have to do one check as if it passes or fails, so will all the other \"And\" lines.</p>\n"}], "owner": {"reputation": 15, "user_id": 6366207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb9608984e5897b9037c764a7006173?s=128&d=identicon&r=PG&f=1", "display_name": "user6366207", "link": "https://stackoverflow.com/users/6366207/user6366207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37574259, "answer_count": 2, "score": 0, "last_activity_date": 1464798901, "creation_date": 1464796504, "last_edit_date": 1531164843, "question_id": 37573507, "link": "https://stackoverflow.com/questions/37573507/vba-automatization", "title": "VBA automatization", "body": "<p>I have some troubles with this part of my code and I'm sure there is a very simple way to sum up this action in one line</p>\n\n<pre><code>If Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 14).Value &gt; 100000 _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(2, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(3, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(4, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(5, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(6, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(7, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(8, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(9, 5) _\nAnd Workbooks(\"A.xlsm\").Sheets(\"1\").Cells(i, 6) &lt;&gt; Workbooks(\"A.xlsm\").Sheets(\"B\").Cells(10, 5) _\nThen ...\n</code></pre>\n\n<p>The only variable that  changes is the row number at the end on each line\nThanks in advance for your help, I'm sure there is an easy way to automate that</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464808546, "post_id": 37573182, "comment_id": 62640926, "body": "If the order of the products is not important then you can loop backwards over the array and output the running product on each iteration."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1464796478, "last_edit_date": 1464796478, "creation_date": 1464795954, "answer_id": 37573310, "question_id": 37573182, "link": "https://stackoverflow.com/questions/37573182/vba-multiply-elements-of-subset-of-array/37573310#37573310", "title": "VBA Multiply elements of subset of array", "body": "<p>You need two loops:</p>\n\n<pre><code>Sub foo()\nDim myArray\nmyArray = Array(3, 5, 2, 9, 3)\nDim i&amp;, j&amp;\nDim output As Double\n\nFor i = LBound(myArray) To UBound(myArray)\n    output = 1\n    For j = i To UBound(myArray)\n        output = output * myArray(j)\n    Next j\n    Debug.Print output\nNext i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/GCmPA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GCmPA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 307, "user_id": 2468413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ky57o.jpg?s=128&g=1", "display_name": "vincentqu", "link": "https://stackoverflow.com/users/2468413/vincentqu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 37573310, "answer_count": 1, "score": 0, "last_activity_date": 1464796478, "creation_date": 1464795632, "question_id": 37573182, "link": "https://stackoverflow.com/questions/37573182/vba-multiply-elements-of-subset-of-array", "title": "VBA Multiply elements of subset of array", "body": "<p>I have an array containing 5 integers. For example: </p>\n\n<pre><code>myArray = Array(3, 5, 2, 9, 3)\n</code></pre>\n\n<p>I want to write a loop that loops through the elements of the array, and on each iteration returns the product of the current element and all elements to the <em>right</em> of it. </p>\n\n<p>In the example above: </p>\n\n<pre><code>3 * 5 * 2 * 9 * 3\n    5 * 2 * 9 * 3\n        2 * 9 * 3\n            9 * 3\n                3\n</code></pre>\n\n<p>My non-VBA thinking was along the lines of: </p>\n\n<pre><code>for i in myArray\n    product(myArray[i:])\n</code></pre>\n\n<p>But I don't know how to write this in VBA, especially since it doesn't support array subsetting. Any help is welcome. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1464795787, "post_id": 37573168, "comment_id": 62633744, "body": "Please, post the code you have tried so far."}, {"owner": {"reputation": 1, "user_id": 6368838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d497d6932c8dc8a27b33fcb4e1aabca7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6368838/david"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1464796208, "post_id": 37573168, "comment_id": 62634020, "body": "I have no code. I have no idea how to do it and I am unable to find the answer in the VBA book that I have."}], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1464796967, "creation_date": 1464796967, "answer_id": 37573666, "question_id": 37573168, "link": "https://stackoverflow.com/questions/37573168/vba-place-selection-from-combo-box-into-a-specific-cell-in-a-spreadsheet/37573666#37573666", "title": "VBA: place selection from combo box into a specific cell in a spreadsheet", "body": "<p>You need a reference that points to the combo box and retrieves its value, then sets the cell range in Excel to that value.  This will differ whether the combo box is on a form or on a worksheet:</p>\n\n<p>In the form's or worksheet's code, you can add a Change event for the combobox and code it to insert the data into your worksheet cell reference (example will set A1 on Sheet1 to the value of the combobox whenever the combobox value is changed).</p>\n\n<pre><code>Public Sub ComboBox1_Change()\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = Me.ComboBox1.Value\nEnd Sub\n</code></pre>\n\n<p>Also, I think you might need a better VBA book :)</p>\n"}, {"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": true, "score": 1, "last_activity_date": 1464797011, "creation_date": 1464797011, "answer_id": 37573675, "question_id": 37573168, "link": "https://stackoverflow.com/questions/37573168/vba-place-selection-from-combo-box-into-a-specific-cell-in-a-spreadsheet/37573675#37573675", "title": "VBA: place selection from combo box into a specific cell in a spreadsheet", "body": "<p>below will change the value of the combobox</p>\n\n<pre><code>ComboBox1.value = 100\n</code></pre>\n\n<p>below will get the value to the cell</p>\n\n<pre><code>range(\"A1\") = ComboBox1.Value\n</code></pre>\n\n<p>You can also set combobox linked cell by </p>\n\n<ol>\n<li><p>Turn on design mode. </p></li>\n<li><p>Right click on combo box and select properties</p></li>\n<li><p>find the row that says LinkedCell</p></li>\n<li><p>type in the range you want to change automatically whenever combobox is changed</p></li>\n</ol>\n\n<p>When you type in the LinkedCell, just type A1. \nNot Range(\"A1\") or \"A1\"</p>\n"}, {"tags": [], "owner": {"reputation": 323, "user_id": 5476844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c521cb21c869f244e44aae5257cc007?s=128&d=identicon&r=PG&f=1", "display_name": "michwalk", "link": "https://stackoverflow.com/users/5476844/michwalk"}, "is_accepted": false, "score": 1, "last_activity_date": 1464797076, "creation_date": 1464797076, "answer_id": 37573698, "question_id": 37573168, "link": "https://stackoverflow.com/questions/37573168/vba-place-selection-from-combo-box-into-a-specific-cell-in-a-spreadsheet/37573698#37573698", "title": "VBA: place selection from combo box into a specific cell in a spreadsheet", "body": "<p>This code creates a list of fruits for a combobox and places the value in cell A1. You'll need to create a Userform with a combobox.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Range(\"A1\").Value = ComboBox1.Value\nEnd Sub\n\nSub Userform_Initialize()\n\n    With Me.ComboBox1\n        .AddItem \"Apple\"\n        .AddItem \"Banana\"\n        .AddItem \"Orange\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6368838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d497d6932c8dc8a27b33fcb4e1aabca7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6368838/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6154, "favorite_count": 0, "accepted_answer_id": 37573675, "answer_count": 3, "score": 0, "last_activity_date": 1464797076, "creation_date": 1464795602, "question_id": 37573168, "link": "https://stackoverflow.com/questions/37573168/vba-place-selection-from-combo-box-into-a-specific-cell-in-a-spreadsheet", "title": "VBA: place selection from combo box into a specific cell in a spreadsheet", "body": "<p>I would like to know what commands are needed to be able to select a value from a combo box and have it inserted into a specific cell in excel using VBA. I would also need it to overwrite what is in that cell if another selection is made from that combo box. Thank you in advance.</p>\n"}, {"tags": ["vba", "outlook", "macros"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1464795249, "post_id": 37572962, "comment_id": 62633391, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx\" rel=\"nofollow noreferrer\">Outlook: Items.ItemAdd event</a>"}], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 4616064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba9709fa67a9307732703269e215a4d?s=128&d=identicon&r=PG&f=1", "display_name": "SeanS", "link": "https://stackoverflow.com/users/4616064/seans"}, "edited": false, "score": 0, "creation_date": 1464874508, "post_id": 37574045, "comment_id": 62671616, "body": "Thank you very much.  Was able to get it working by copying/pasting my existing macro into the body of ItemAdd.  Out of curiosity - could I have called the macro, which was located in Module1, from inside ItemAdd, instead of moving it to ThisOutlookSession?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 62, "user_id": 4616064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba9709fa67a9307732703269e215a4d?s=128&d=identicon&r=PG&f=1", "display_name": "SeanS", "link": "https://stackoverflow.com/users/4616064/seans"}, "edited": false, "score": 0, "creation_date": 1464874948, "post_id": 37574045, "comment_id": 62671998, "body": "Yes you could - as long as it&#39;s defined as <code>Public</code> rather than <code>Private</code>.  In my example you would just replace the <code>MsgBox</code> line with something like <code>NameOfYourMacro Item</code> or <code>Call NameOfYourMacro(Item)</code>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1464798194, "creation_date": 1464798194, "answer_id": 37574045, "question_id": 37572962, "link": "https://stackoverflow.com/questions/37572962/is-it-possible-to-run-an-outlook-macro-when-a-new-contact-is-created-saved/37574045#37574045", "title": "Is it possible to run an Outlook macro when a new Contact is created/saved?", "body": "<p>Add this code to the <code>ThisOutlookSession</code> module:</p>\n\n<pre><code>Private WithEvents objNewContact As Items\n\nPrivate Sub Application_Startup()\n    Set objNewContact = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderContacts).Items\nEnd Sub\n\nPrivate Sub objNewContact_ItemAdd(ByVal Item As Object)\n    MsgBox Item.CompanyAndFullName &amp; \" added\"\nEnd Sub\n\nPrivate Sub objNewContact_ItemChange(ByVal Item As Object)\n    MsgBox Item.CompanyAndFullName &amp; \" changed\"\nEnd Sub\n</code></pre>\n\n<p><code>Application_StartUp</code> will set objNewContact to watch the contacts folder when you start Outlook.<br>\n<code>ItemAdd</code> will fire when you save the contact.<br>\n<code>ItemChange</code> will fire when you save an existing contact after changing it.  </p>\n\n<p>As the link provided by @Maciej states - <strong>The sample code must be placed in a class module</strong> and ThisOutlookSession is a class module.</p>\n"}], "owner": {"reputation": 62, "user_id": 4616064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba9709fa67a9307732703269e215a4d?s=128&d=identicon&r=PG&f=1", "display_name": "SeanS", "link": "https://stackoverflow.com/users/4616064/seans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 37574045, "answer_count": 1, "score": 0, "last_activity_date": 1592949888, "creation_date": 1464794941, "last_edit_date": 1592949888, "question_id": 37572962, "link": "https://stackoverflow.com/questions/37572962/is-it-possible-to-run-an-outlook-macro-when-a-new-contact-is-created-saved", "title": "Is it possible to run an Outlook macro when a new Contact is created/saved?", "body": "<p>I have an Outlook macro that edits certain fields in all of my Contacts.  Is it possible to auto-trigger this macro to run whenever a new Contact is created/saved?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464855922, "post_id": 37574022, "comment_id": 62658361, "body": "Hello @MutjayLee and thank you for your answer , i tried what you told me but what it does is showing the PNR in columns P i want to show the sum of them for that functionality"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464863344, "post_id": 37574022, "comment_id": 62663574, "body": "Did you add code &quot;Sheets(1).Cells(verif.Row,16).Value = Sheets(1).Cells(verif.Row,16).Value + PNR after&quot; after else?"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464873851, "post_id": 37574022, "comment_id": 62671098, "body": "I&#39;ve updated my answer. I found out that Once PNR&#39;s format changed, it becomes string not number, and that cannot be added. I created separate variable called PNR_VAL and that will be able to add, and become sum when code is done."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464876391, "post_id": 37574022, "comment_id": 62673154, "body": "Thanks so much MutjayLee it works perfect , i have just one question is it possible to show just the first five communities for each functionality"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464877286, "post_id": 37574022, "comment_id": 62673946, "body": "Thanks for marking &quot;answered&quot;. And Yes, it is possible, but you will need separate counter."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464877503, "post_id": 37574022, "comment_id": 62674138, "body": "can you please help me in this last one i understand what you said but i don&#39;t know how aplly it in the code ,"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464877688, "post_id": 37574022, "comment_id": 62674274, "body": "Your code basically writes on column &quot;P&quot; when it&#39;s the first one, and second one found, it will grab corresponding column &quot;P&quot; value, then increase it with additional percentage.  If you do same thing on let&#39;s say column &quot;Q&quot; and just have line check  **if Cells(verif.Row,17) &lt;=5 then ** write values. If this makes sense :)"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464877999, "post_id": 37574022, "comment_id": 62674541, "body": "Ok i really appreciate your help"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464878196, "post_id": 37574022, "comment_id": 62674694, "body": "I&#39;ve updated the answer. See how it works, and if that&#39;s what you want. Let me know if you have further questions"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464879189, "post_id": 37574022, "comment_id": 62675545, "body": "Oh, by the way, The code &quot;x = Sheets(1).Range(&quot;C4:C&quot; &amp; Sheets(1).Range(&quot;C:C&quot;).End(xlDown).Row).Count&quot; can be written as &quot;x=Sheets(1).range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Row&quot;. The difference is if there is blank within the data, xlDown will get the row number before the blank. and Rows.Count xlUp will find the very last one including blank datas."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464879989, "post_id": 37574022, "comment_id": 62676156, "body": "Yes i agree with you this is much better but when i used the new version of code that you provided me , i had some problems it does show just the 5 communities but the total percentage is not on percentage format it&#39;s like this 0.8921  what could be the problem while the firs time it worked perfectly"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464880439, "post_id": 37574022, "comment_id": 62676514, "body": "You can either right click the Colum &quot;P&quot; &gt; &quot;Format Cells&quot; &gt; change to percentage format, or in the beginning of the code (not inside of loop) you can type Sheets(1).Columns(&quot;P&quot;).Numberformat = &quot;0.00%&quot;"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464880995, "post_id": 37574022, "comment_id": 62676961, "body": "it worked thanks , MutjayLee for the senario of showing just the first five communities the others the code do not take them in consideration ??"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464881065, "post_id": 37574022, "comment_id": 62677021, "body": "I don&#39;t understand what you mean by taking them in consideration."}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464881136, "post_id": 37574022, "comment_id": 62677077, "body": "The way it works is when column &quot;P&quot; has 5 datas, then even it finds the next one, it will not write it. but you are still going through the loop and check them. You are just not displaying them. So for example, if you change <b>5</b> in Elseif line to <b>10</b>, it will display 10. if this answers your question..."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464881445, "post_id": 37574022, "comment_id": 62677358, "body": "ah so it will calculate the percentage for all communities that uses this functionality but it will not show them ? it will show just the first 5"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464883628, "post_id": 37574022, "comment_id": 62678889, "body": "Yes, the percentage it self is being calculated. But calculated percentage will be written over by next percentage calculation without displaying it or adding it to the sum."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464939687, "post_id": 37574022, "comment_id": 62701014, "body": "aah what if we want to add it to the sum is it doable ??"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464940318, "post_id": 37574022, "comment_id": 62701350, "body": "I mean even if the other communities do not show in the results can we calculate their poucentage and add it to the sum"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1464951325, "post_id": 37574022, "comment_id": 62707894, "body": "I&#39;ve updated the answer again. This should just display first 5 communities, but it will calculate all percentages"}], "tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": true, "score": 0, "last_activity_date": 1464951280, "last_edit_date": 1464951280, "creation_date": 1464798117, "answer_id": 37574022, "question_id": 37572788, "link": "https://stackoverflow.com/questions/37572788/add-result-in-new-column-depending-on-old-one/37574022#37574022", "title": "Add result in new column depending on old one", "body": "<p>After the line </p>\n\n<pre><code>PNR = 1 - (PNRt - Sheets(1).Cells(j, 10).Value) / PNRt\n</code></pre>\n\n<p>add</p>\n\n<pre><code>PNR_VAL = PNR\n</code></pre>\n\n<hr>\n\n<pre><code>If verif Is Nothing Then\n    Sheets(1).Cells(a, 14).Value = Sheets(1).Cells(j, 9).Value\n    texte = Sheets(1).Cells(j, 7).Value &amp; Sheets(1).Cells(j, 8).Value &amp; \", pourcentage PNR : \" &amp; PNR\n    Sheets(1).Cells(a, 15).Value = texte\n    Sheets(1).Cells(a,16).value = PNR_VAL\n    Sheets(1).Cells(a,17).value = 1\nElse\n    if Sheets(1).Cells(verif.Row,17) &lt; 5 then\n        texte = Sheets(1).Cells(verif.Row, 15).Value\n        texte = texte &amp; \"; \" &amp; Sheets(1).Cells(j, 7).Value &amp; Sheets(1).Cells(j, 8).Value &amp; \", pourcentage PNR : \" &amp; PNR\n        Sheets(1).Cells(verif.Row, 15).Value = texte\n    end if\n    Sheets(1).Cells(verif.Row,16).Value = Sheets(1).Cells(verif.Row,16).Value + PNR_VAL\n    Sheets(1).Cells(verif.Row,17).Value = Sheets(1).Cells(verif.Row,17).Value+1\nEnd If\n</code></pre>\n\n<p>This should work</p>\n"}], "owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37574022, "answer_count": 1, "score": 0, "last_activity_date": 1464951280, "creation_date": 1464794491, "last_edit_date": 1464811192, "question_id": 37572788, "link": "https://stackoverflow.com/questions/37572788/add-result-in-new-column-depending-on-old-one", "title": "Add result in new column depending on old one", "body": "<p><a href=\"https://i.stack.imgur.com/rKeKQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rKeKQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am comparing the tow release and sort the results as in the picture. The new functionalities in the release 2 with communities that uses these functionalities and the percentage of their PNR. I need to add in the column P the sum of the percentage like for the functionality plus percentage of their PNRS. Then we will have : \"total percentage:37.97 % \"</p>\n\n<p>This is the code i am using if someone can help me :</p>\n\n<pre><code>Sub essai()\n    Dim verif As Range, m As Range, dico As New Dictionary\n    x = Sheets(1).Range(\"C4:C\" &amp; Sheets(1).Range(\"C:C\").End(xlDown).Row).Count\n    y = Sheets(1).Range(\"I4:I\" &amp; Sheets(1).Range(\"I:I\").End(xlDown).Row).Count\n\n    For j = 3 To y + 3\n    If Not dico.Exists(Sheets(1).Cells(j, 10).Value) Then\n        dico.Add Sheets(1).Cells(j, 10).Value, Sheets(1).Cells(j, 10).Value\n        PNRt = PNRt + Sheets(1).Cells(j, 10).Value\n    End If\n    Next j\n\n    For j = 3 To y + 3\n\n    a = Sheets(1).Range(\"O1:O\" &amp; Sheets(1).Range(\"O:O\").End(xlDown).Row).Count + 1\n\n    Set m = Sheets(1).Range(Sheets(1).Cells(3, 3), Sheets(1).Cells(x + 3, 3)).Find(Sheets(1).Cells(j, 9).Value)\n\n    If m Is Nothing Then\n    PNR = 1 - (PNRt - Sheets(1).Cells(j, 10).Value) / PNRt\n\n    PNR = Format(PNR, \"0.00%\")\n    Set verif = Sheets(1).Range(\"N:N\").Find(Sheets(1).Cells(j, 9).Value)\n\n   If verif Is Nothing Then\n        Sheets(1).Cells(a, 14).Value = Sheets(1).Cells(j, 9).Value\n        texte = Sheets(1).Cells(j, 7).Value &amp; Sheets(1).Cells(j, 8).Value &amp; \", pourcentage PNR : \" &amp; PNR\n        Sheets(1).Cells(a, 15).Value = texte\n\n    Else\n        texte = Sheets(1).Cells(verif.Row, 15).Value\n        texte = texte &amp; \"; \" &amp; Sheets(1).Cells(j, 7).Value &amp; Sheets(1).Cells(j, 8).Value &amp; \", pourcentage PNR : \" &amp; PNR\n        Sheets(1).Cells(verif.Row, 15).Value = texte\n\n    End If\n\n    End If\n    Next j\n    Exit Sub\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464824106, "post_id": 37572688, "comment_id": 62647732, "body": "As far as I know that&#39;s not possible. Yet, it would be possible to have a text box adjacent to the ComboBox and as you type into that text box the ComboBox (or any item next to it) will automatically select / adjust the value or (at least) narrow down the available selections. If you are open to such a solution then I could draft an answer."}, {"owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464827041, "post_id": 37572688, "comment_id": 62648508, "body": "@Ralph I was thinking the same thing. You will use regular expressions?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464865088, "post_id": 37572688, "comment_id": 62664673, "body": "No, I try to avoid regular expressions whenever possible for two reasons: (1) RegEx is not native to VBA. As such you are dependent on an external library. As I had to develop for large enterprises in the past I try to include as few as possible libraries. The more libraries you depend on the higher the risk that your solution does not work on any computer in any of the 200+ countries. (2) RegEx makes you lazy. With them it is very easy to dissect text. It is harder if you do it yourself / manually. That&#39;s good training for your brain. :)"}, {"owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464964706, "post_id": 37572688, "comment_id": 62716913, "body": "@Ralph Check out my solution which is rather elementary but so far does the job. I need to refine it a bit though so it is less awkward as described in my post."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464967037, "post_id": 37617220, "comment_id": 62718570, "body": "I&#39;m sorry. But I don&#39;t understand your solution. Also, what is <code>SectorDropDown1_1</code> and where is the value coming from? Maybe it becomes clearer if you were to include a screenshot or (possibly even) a GIF into your solution to show what your code does. Here is a sample GIF to show you what I mean: <a href=\"http://stackoverflow.com/questions/37239107/sort-range-without-sorting-it-in-a-spreadsheet/37239386#37239386\" title=\"sort range without sorting it in a spreadsheet\">stackoverflow.com/questions/37239107/&hellip;</a>"}, {"owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464967270, "post_id": 37617220, "comment_id": 62718741, "body": "@Ralph post edited to explain, will update more as I have more time today."}, {"owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464971220, "post_id": 37617220, "comment_id": 62721110, "body": "@Ralph is it clearer now? Will post GIF later tonight."}], "tags": [], "owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "is_accepted": true, "score": 0, "last_activity_date": 1464971183, "last_edit_date": 1464971183, "creation_date": 1464964669, "answer_id": 37617220, "question_id": 37572688, "link": "https://stackoverflow.com/questions/37572688/auto-complete-with-only-text-and-not-numbers-combobox-excel-vba/37617220#37617220", "title": "Auto-Complete with only text and not numbers ComboBox Excel VBA", "body": "<p>So first to give some context to this answer. SectorDropDown1_1 (which is part of a form) is a drop down list that is populated with the concatenated strings of a number value and a string value coming from a column J. In this context the _change() method responds to the user typing in values.  I have 2 columns \"R\", and \"S\", in a spreadsheet \"SectorSearch\" that have separated the number and the text. So now if the user enters either the number or the text, then the appropriate value in the Drop Down list is selected. But here is the problem, my code sort of awkwardly jumps to the exact value and so I want to \"smooth things out\" so to speak so that after the user types more than 2 characters that match the appropriate value that this value is now selected and the drop down list shows the nearby values. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SectorDropDown1_1_Change()\n\nDim i As Long\nDim StringRange1 As String\nDim StringRange2 As String\nDim Stringrange3 As String\nDim LengthOfValue As Integer\nDim TotalSectorCodes As Integer\n\nIf SectorDropDown1_1.Value &lt;&gt; \"\" And Len(SectorDropDown1_1.Value) &gt; 2 Then\n    TotalSectorCodes = Worksheets(\"SectorSearch\").Range(\"J:J\").Cells.SpecialCells(xlCellTypeFormulas).Count\n    LengthOfValue = Len(SectorDropDown1_1.Value)\n    For i = 2 To TotalSectorCodes\n        StringRange1 = \"R\" &amp; CStr(i)\n        StringRange2 = \"S\" &amp; CStr(i)\n        Stringrange3 = \"J\" &amp; CStr(i)\n        Select Case SectorDropDown1_1.Value\n            Case Left(Worksheets(\"SectorSearch\").Range(StringRange1).Value, LengthOfValue)\n                SectorDropDown1_1.Value = Worksheets(\"SectorSearch\").Range(Stringrange3).Value\n                Exit For\n            Case Left(Worksheets(\"SectorSearch\").Range(StringRange2).Value, LengthOfValue)\n                SectorDropDown1_1.Value = Worksheets(\"SectorSearch\").Range(Stringrange3).Value\n                Exit For\n            Case Else\n                '...\n        End Select\n    Next i\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1464974480, "creation_date": 1464974480, "answer_id": 37620203, "question_id": 37572688, "link": "https://stackoverflow.com/questions/37572688/auto-complete-with-only-text-and-not-numbers-combobox-excel-vba/37620203#37620203", "title": "Auto-Complete with only text and not numbers ComboBox Excel VBA", "body": "<p>Since you are using a form and form controls I'd like to throw in another solution (which I'd personally prefer). In this case I am not using a ComboBox but rather a ListBox:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HuOCX.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HuOCX.gif\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code to populate the ListBox on the form and to show the form:</p>\n\n<pre><code>Sub Button3_Click()\n\nDim i As Long\nDim lngLastRow As Long\n\nLoad frmSearchForChoices\nWith ThisWorkbook.Worksheets(1)\n    lngLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    For i = 2 To lngLastRow\n        frmSearchForChoices.lstAvailableOptions.AddItem\n        frmSearchForChoices.lstAvailableOptions.List(frmSearchForChoices.lstAvailableOptions.ListCount - 1, 0) = .Cells(i, 1).Value2\n        frmSearchForChoices.lstAvailableOptions.List(frmSearchForChoices.lstAvailableOptions.ListCount - 1, 1) = .Cells(i, 2).Value2\n        frmSearchForChoices.lstAvailableOptions.List(frmSearchForChoices.lstAvailableOptions.ListCount - 1, 2) = .Cells(i, 3).Value2\n    Next i\n    frmSearchForChoices.Show\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The following code resides on the form itself:</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nPrivate Sub btnCancel_Click()\n\nfrmSearchForChoices.Hide\nUnload frmSearchForChoices\n\nEnd Sub\n\nPrivate Sub btnOK_Click()\n\nDim lngMatch As Long\n\nIf frmSearchForChoices.lstAvailableOptions.ListCount &gt; 0 Then\n    If frmSearchForChoices.lstAvailableOptions.ListIndex &gt;= 0 Then\n        For lngMatch = 0 To frmSearchForChoices.lstAvailableOptions.ListCount - 1\n            If frmSearchForChoices.lstAvailableOptions.Selected(lngMatch) = True Then\n                MsgBox \"You selected\" &amp; Chr(10) &amp; _\n                    frmSearchForChoices.lstAvailableOptions.List(lngMatch, 1) &amp; \" (\" &amp; _\n                    frmSearchForChoices.lstAvailableOptions.List(lngMatch, 0) &amp; \")\" &amp; _\n                    IIf(Len(frmSearchForChoices.lstAvailableOptions.List(lngMatch, 2)) &gt; 0, _\n                        \" from \" &amp; frmSearchForChoices.lstAvailableOptions.List(lngMatch, 2), \"\")\n                frmSearchForChoices.Hide\n                Unload frmSearchForChoices\n            End If\n        Next lngMatch\n    End If\nEnd If\n\nEnd Sub\n\nPrivate Sub txtSearchTerm_Change()\n\nDim i As Long\nDim lngMatch As Long\nDim varArray As Variant\n\nIf Len(Trim(frmSearchForChoices.txtSearchTerm.Value)) = 0 Then Exit Sub\n\nFor lngMatch = 0 To frmSearchForChoices.lstAvailableOptions.ListCount - 1\n    frmSearchForChoices.lstAvailableOptions.Selected(lngMatch) = False\n    frmSearchForChoices.lstAvailableOptions.List(lngMatch, 3) = 0\nNext lngMatch\n\n\nvarArray = Split(Trim(frmSearchForChoices.txtSearchTerm.Value), \" \")\nFor i = LBound(varArray) To UBound(varArray)\n    For lngMatch = 0 To frmSearchForChoices.lstAvailableOptions.ListCount - 1\n        If InStr(1, frmSearchForChoices.lstAvailableOptions.List(lngMatch, 1), varArray(i)) Or _\n            InStr(1, frmSearchForChoices.lstAvailableOptions.List(lngMatch, 2), varArray(i)) Then\n                frmSearchForChoices.lstAvailableOptions.List(lngMatch, 3) = Val(frmSearchForChoices.lstAvailableOptions.List(lngMatch, 3)) + 1\n        End If\n    Next lngMatch\nNext i\n\nFor lngMatch = 0 To frmSearchForChoices.lstAvailableOptions.ListCount - 1\n    If frmSearchForChoices.chkMatchBoth.Value Then\n        If Val(frmSearchForChoices.lstAvailableOptions.List(lngMatch, 3)) &gt;= UBound(varArray) - LBound(varArray) + 1 Then\n            frmSearchForChoices.lstAvailableOptions.Selected(lngMatch) = True\n        End If\n    Else\n        If Val(frmSearchForChoices.lstAvailableOptions.List(lngMatch, 3)) &gt;= 1 Then\n            frmSearchForChoices.lstAvailableOptions.Selected(lngMatch) = True\n        End If\n    End If\nNext lngMatch\n\nEnd Sub\n</code></pre>\n\n<p>I sure hope that most variables and controls can be identified within the code due to the followed naming convention (starting with <code>frm</code> for forms, <code>lbl</code> for labels on forms, \u00b4lst` for ListBox on form, etc). Yet, do not hesitate to let me know if you have any questions regarding this solution.</p>\n"}], "owner": {"reputation": 586, "user_id": 6159217, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf02c33ce95856d3094552a5ce7f7fba?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrateThis", "link": "https://stackoverflow.com/users/6159217/integratethis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 1, "accepted_answer_id": 37617220, "answer_count": 2, "score": 2, "last_activity_date": 1464974480, "creation_date": 1464794225, "last_edit_date": 1531164843, "question_id": 37572688, "link": "https://stackoverflow.com/questions/37572688/auto-complete-with-only-text-and-not-numbers-combobox-excel-vba", "title": "Auto-Complete with only text and not numbers ComboBox Excel VBA", "body": "<p>Suppose I have a ComboBox in Excel VBA with the following sorts of info:</p>\n\n<pre><code>1234 apples\n2345 pears\n2367 oranges\n</code></pre>\n\n<p>I want the user to be able to type 'a' or 'ap' or 'app' etc. So that auto-complete will suggest 1234 apples. As of right now the combo-box will only auto-complete if the user types the beginning part of the entry , i.e. in my case the numbers. Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1464794242, "post_id": 37572632, "comment_id": 62632638, "body": "you only add one space per cell, and since they only have 5 characters in them, you&#39;re effectively turning them into 6-char cells. shouldn&#39;t you be adding 13 spaces, not just one?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464794254, "post_id": 37572632, "comment_id": 62632652, "body": "Well, for one, you&#39;re changing variables. <code>rCell</code> then <code>xCell</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464794331, "post_id": 37572632, "comment_id": 62632717, "body": "Do you want the spaces in front?  Note: that even making them all the same length will not necessarily make them line up.  this is because each character has its own width and not all are the same."}, {"owner": {"reputation": 133, "user_id": 4777400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a867c7a80d92351767dff4eeca33460b?s=128&d=identicon&r=PG&f=1", "display_name": "F0l0w", "link": "https://stackoverflow.com/users/4777400/f0l0w"}, "edited": false, "score": 0, "creation_date": 1464794341, "post_id": 37572632, "comment_id": 62632725, "body": "Sorry I forgot to add that not all the values have the same length. So I need to add to those values, the remaining blank spaces to make it a length of 18"}, {"owner": {"reputation": 133, "user_id": 4777400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a867c7a80d92351767dff4eeca33460b?s=128&d=identicon&r=PG&f=1", "display_name": "F0l0w", "link": "https://stackoverflow.com/users/4777400/f0l0w"}, "edited": false, "score": 0, "creation_date": 1464794355, "post_id": 37572632, "comment_id": 62632734, "body": "The spaces would be after the text"}, {"owner": {"reputation": 133, "user_id": 4777400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a867c7a80d92351767dff4eeca33460b?s=128&d=identicon&r=PG&f=1", "display_name": "F0l0w", "link": "https://stackoverflow.com/users/4777400/f0l0w"}, "edited": false, "score": 0, "creation_date": 1464794375, "post_id": 37572632, "comment_id": 62632750, "body": "I was thinking of a loop until it reaches a length of 18"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464794416, "post_id": 37572632, "comment_id": 62632782, "body": "Or just subtract and do <code>rept</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464794523, "post_id": 37572770, "comment_id": 62632863, "body": "Why not use <code>Left$(&quot;foo&quot; &amp; String$(17,&quot; &quot;) ,17)</code>  You are looping needlessly."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464794579, "post_id": 37572770, "comment_id": 62632908, "body": "I don&#39;t know maybe I just use the logic he was trying to implement :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464794765, "post_id": 37572770, "comment_id": 62633056, "body": "The problem is the numbers, adding spaces to number gets truncated back to the numbers and it goes into an eternal loop."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464794898, "post_id": 37572770, "comment_id": 62633160, "body": "@ScottCraner Yes got it."}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": false, "score": 2, "last_activity_date": 1464796764, "last_edit_date": 1464796764, "creation_date": 1464794428, "answer_id": 37572770, "question_id": 37572632, "link": "https://stackoverflow.com/questions/37572632/excel-vba-adding-spaces-to-a-cell-to-reach-a-certain-length/37572770#37572770", "title": "Excel vba adding spaces to a cell to reach a certain length", "body": "<p>Try this :</p>\n\n<pre><code>Sub PMAP_BAC_Code()\n\nDim str As String\nDim wk As Worksheet\nSet wk = Sheet1\n\nFor i = 1 To 6\n    str = wk.Range(\"A\" &amp; i).Value\n\n    Do While Len(str) &lt; 18\n    str = str &amp; \" \"\n    Loop\n\n    wk.Range(\"A\" &amp; i) = str\n    str = \"\"\n\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>If the col A has only numbers like 1 then above code will convert the string \"1           \" to \"1\" again so instead I use to concatenate with NBSP which is chr(160) which will take care of it</p>\n\n<pre><code>Sub PMAP_BAC_Code()\n\nDim str As String\nDim wk As Worksheet\nSet wk = Sheet1\n\nFor i = 1 To 6\n    str = wk.Range(\"A\" &amp; i).Value\n\n    Do While Len(str) &lt; 18\n        str = str &amp; Chr(160)\n    Loop\n\n    wk.Range(\"A\" &amp; i) = CStr(str)\n    Debug.Print Len(wk.Range(\"A\" &amp; i))\n    Debug.Print Len(str)\n    str = \"\"\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 133, "user_id": 4777400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a867c7a80d92351767dff4eeca33460b?s=128&d=identicon&r=PG&f=1", "display_name": "F0l0w", "link": "https://stackoverflow.com/users/4777400/f0l0w"}, "edited": false, "score": 0, "creation_date": 1464794743, "post_id": 37572809, "comment_id": 62633034, "body": "String$(n,char) give n instances of the character.  Try this in debug window <code>?String$(5,&quot;*&quot;)</code>.  Left$ truncates a string to the desired length."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464794847, "post_id": 37572809, "comment_id": 62633121, "body": "Brilliant. Even better than <code>rept</code>^^"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464794876, "post_id": 37572809, "comment_id": 62633138, "body": "When I tried it in the loop the numbers get truncated back to numbers.  so the spaces are removed."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464795307, "post_id": 37572809, "comment_id": 62633438, "body": "@ScottCraner oh. I would just use formula on sheet? Edit: or does that have same effect? Edit2: tangent - you should check out code review. A whole different level XD Edit3: ignore me."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464795402, "post_id": 37572809, "comment_id": 62633499, "body": "@findwindow but OP wants the change in place not in another cell."}, {"owner": {"reputation": 529, "user_id": 1541985, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81c09003998f942f07d76c7f5f8c3dfc?s=128&d=identicon&r=PG", "display_name": "nsg", "link": "https://stackoverflow.com/users/1541985/nsg"}, "edited": false, "score": 0, "creation_date": 1464810554, "post_id": 37572809, "comment_id": 62641983, "body": "There is a special function for x spaces, called <code>space()</code>: <code>=Left$(&quot;foo&quot; &amp; Space$(17) ,17)</code>"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 4, "last_activity_date": 1464795474, "last_edit_date": 1464795474, "creation_date": 1464794553, "answer_id": 37572809, "question_id": 37572632, "link": "https://stackoverflow.com/questions/37572632/excel-vba-adding-spaces-to-a-cell-to-reach-a-certain-length/37572809#37572809", "title": "Excel vba adding spaces to a cell to reach a certain length", "body": "<p>Why not use <code>Left$(\"foo\" &amp; String$(17,\" \") ,17)</code>?</p>\n\n<pre><code>Sub PMAP_BAC_Code()\n\n    Dim rCell As Range\n    Dim rRng As Range\n    Set rRng = Sheet1.Range(\"A1:A6\")\n\n    For Each rCell In rRng.Cells\n    Const lMY_LENGTH As Long = 18\n    If Len(rCell) &lt;&gt; lMY_LENGTH Then\n        rCell.Value2 = IIf(IsNumeric(rCell.Value2), \"'\", \"\") &amp; Left$(rCell.Value2 &amp; String$(lMY_LENGTH, \" \"), lMY_LENGTH)\n    End If\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>Folding in feedback from comment about numbers, I have added a single quote for numerics.   Other comments about not lining up the end of the text are still true though.</p>\n"}, {"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1464795916, "post_id": 37573002, "comment_id": 62633833, "body": "My format function is just an example and give the right result, up the the user to force the format of the cell to text with .NumberFormat = &quot;@&quot; if needed."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464796365, "post_id": 37573002, "comment_id": 62634122, "body": "Nice, probably better than mine but we need to know why OP wants to add spaces.  I&#39;m moving off this question now."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1464796143, "last_edit_date": 1464796143, "creation_date": 1464795072, "answer_id": 37573002, "question_id": 37572632, "link": "https://stackoverflow.com/questions/37572632/excel-vba-adding-spaces-to-a-cell-to-reach-a-certain-length/37573002#37573002", "title": "Excel vba adding spaces to a cell to reach a certain length", "body": "<p>Do not forget that <a href=\"https://msdn.microsoft.com/fr-fr/library/office/gg251755.aspx\" rel=\"nofollow\">Format</a> can also be used to format Strings:</p>\n\n<pre><code>Public Function myFormat(str As String) As String\n    myFormat = Format(str, \"!\" &amp; String(18, \"@\"))\nEnd Function\n</code></pre>\n\n<p>Edit: My function applied to the current problem:</p>\n\n<pre><code>Sub PMAP_BAC_Code()\n\n    Dim rCell As Range\n    Dim rRng As Range\n    Set rRng = Sheet1.Range(\"A1:A6\")\n\n    For Each rCell In rRng.Cells\n        rCell.NumberFormat = \"@\"\n        rCell.Value = myFormat(rCell.Value)\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4777400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a867c7a80d92351767dff4eeca33460b?s=128&d=identicon&r=PG&f=1", "display_name": "F0l0w", "link": "https://stackoverflow.com/users/4777400/f0l0w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5946, "favorite_count": 0, "accepted_answer_id": 37572809, "answer_count": 3, "score": 1, "last_activity_date": 1464796764, "creation_date": 1464794097, "last_edit_date": 1464794285, "question_id": 37572632, "link": "https://stackoverflow.com/questions/37572632/excel-vba-adding-spaces-to-a-cell-to-reach-a-certain-length", "title": "Excel vba adding spaces to a cell to reach a certain length", "body": "<p>I am trying to have the cells in the range A1 to A6 to reach the length of 18. </p>\n\n<p>The current values in it:</p>\n\n<pre><code>A233333\nA0399\n30000\n3993833\n11111\n22222\n</code></pre>\n\n<p>Note that not all the values in the cells have the same length.</p>\n\n<p>I want to fill the remaining length with blank spaces (\" \"). So I wrote the following code but it does not seem to work:</p>\n\n<pre><code>Sub PMAP_BAC_Code()\n\nDim rCell As Range\nDim rRng As Range\nSet rRng = Sheet1.Range(\"A1:A6\")\n\nFor Each rCell In rRng.Cells\nIf Len(xCell) &lt;&gt; 18 Then\n    xCell.FormulaR1C1 = \" \"\nEnd If\nNext rCell\n\nEnd Sub\n</code></pre>\n\n<p>Can someone help me please?</p>\n"}, {"tags": ["vba", "format", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1464855493, "post_id": 37575406, "comment_id": 62658106, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1464802770, "creation_date": 1464802770, "answer_id": 37575406, "question_id": 37572450, "link": "https://stackoverflow.com/questions/37572450/how-to-detect-column-number-of-selected-text-in-a-msword-array/37575406#37575406", "title": "How to detect column number of selected text in a MSWord array?", "body": "<p>If <code>Selection.Find</code> is successful it should leave the found text selected. Then this should give you the index of the column:</p>\n\n<pre><code>Selection.Information(wdEndOfRangeColumnNumber)\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37575406, "answer_count": 1, "score": 0, "last_activity_date": 1464802770, "creation_date": 1464793590, "last_edit_date": 1495540366, "question_id": 37572450, "link": "https://stackoverflow.com/questions/37572450/how-to-detect-column-number-of-selected-text-in-a-msword-array", "title": "How to detect column number of selected text in a MSWord array?", "body": "<p>I have to sum up a report based on the color of the text. If I find blue text, I write it to another document. I would like to highlight some of this text found based on its position in the Word array I found it.</p>\n\n<p>On my page I have a simple table like below, with 2 or 3 columns. I'm already able to find and copy all the blue text in another document (see <a href=\"https://stackoverflow.com/questions/37540753/how-do-i-generate-a-list-of-the-text-formatted-with-given-color-in-ms-word\">Find all text formatted with given color</a>). \n<a href=\"https://i.stack.imgur.com/IKOIm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IKOIm.png\" alt=\"enter image description here\"></a></p>\n\n<p>I use below <code>vba</code> to find the next item:</p>\n\n<pre><code>  With Selection.Find\n    .ClearFormatting\n    .Font.Color = wdColorBlue\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = True\n    .Execute\n  End With\n</code></pre>\n\n<p>and result of the search is available in <code>Selection.Text</code>. </p>\n\n<p>Now what I need to know is once the text is selected, <strong>is it possible to know the column number it is in?</strong></p>\n"}, {"tags": ["html", "vba", "dom"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464808745, "post_id": 37572312, "comment_id": 62641022, "body": "readyState loop should be the first thing in your code, before you try selecting any elements"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6410082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a957be8cc12105074a206d8450a0c83d?s=128&d=identicon&r=PG&f=1", "display_name": "Ishyishy", "link": "https://stackoverflow.com/users/6410082/ishyishy"}, "is_accepted": true, "score": 0, "last_activity_date": 1465228909, "creation_date": 1465228909, "answer_id": 37661961, "question_id": 37572312, "link": "https://stackoverflow.com/questions/37572312/using-visual-basic-for-applications-to-click-button-in-table/37661961#37661961", "title": "using Visual Basic for Applications to Click Button in Table", "body": "<p>I found the solution.</p>\n\n<p>The table was inside of an Iframe that was referencing an outside URL, so I would not have likely been able to use it. The application permitted a paramterized URL system that took me directly to the page needed, at which point the code worked properly.</p>\n"}], "owner": {"reputation": 1, "user_id": 6410082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a957be8cc12105074a206d8450a0c83d?s=128&d=identicon&r=PG&f=1", "display_name": "Ishyishy", "link": "https://stackoverflow.com/users/6410082/ishyishy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 37661961, "answer_count": 1, "score": 0, "last_activity_date": 1465228909, "creation_date": 1464793162, "last_edit_date": 1464874399, "question_id": 37572312, "link": "https://stackoverflow.com/questions/37572312/using-visual-basic-for-applications-to-click-button-in-table", "title": "using Visual Basic for Applications to Click Button in Table", "body": "<p>I am attempting to click a button that is present in a table.</p>\n\n<pre><code>&lt;td class=\"b item enabled hasIcon\" id=\"flowTile_2\" \n   onmouseover=\"javascrpt:startHoverTimer(this);\"\n   onmouseout=\"javascript:startTimerToMaybeEndHoverMode(this);\"\n   onclick=\"javascript:runE1App('P4101','W4101E','DMS0001')\" appId=\"P4101\"\n   formId=\"W4101E\" version=\"DMS0001\" tileText=\"Part Master\" haveBox=\"true\"&gt;\n</code></pre>\n\n<p>I've tried the following attempt:</p>\n\n<p>I declare my variables properly as other clicking operations work properly elsewhere on the page.</p>\n\n<pre><code>            Set htmlDoc = .document\n            Do While htmlDoc.readyState &lt;&gt; \"complete\": DoEvents: Loop\n            Set htmlColl = htmlDoc.GetElementbyId(\"flowTile_2\")\n\n                For Each htmlInput In htmlColl\n                    Counter = Counter + 1\n                        htmlInput.Click\n\n\n\n                Next htmlInput\n                MsgBox Counter\n</code></pre>\n\n<p>But I seem to get an object required error.</p>\n"}, {"tags": ["vba", "ms-word", "public"], "comments": [{"owner": {"reputation": 3613, "user_id": 2751997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/91c6c9935a7e8d61f9e64c96c1ccd7d3?s=128&d=identicon&r=PG&f=1", "display_name": "John Chrysostom", "link": "https://stackoverflow.com/users/2751997/john-chrysostom"}, "edited": false, "score": 0, "creation_date": 1464792700, "post_id": 37572066, "comment_id": 62631537, "body": "Can you show the code you&#39;re using to open the new doc and read the variables? Makes things much easier to troubleshoot..."}, {"owner": {"reputation": 13, "user_id": 6410239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65cf6e052078f2a2bb3160e1473c51f?s=128&d=identicon&r=PG&f=1", "display_name": "jkramer", "link": "https://stackoverflow.com/users/6410239/jkramer"}, "reply_to_user": {"reputation": 3613, "user_id": 2751997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/91c6c9935a7e8d61f9e64c96c1ccd7d3?s=128&d=identicon&r=PG&f=1", "display_name": "John Chrysostom", "link": "https://stackoverflow.com/users/2751997/john-chrysostom"}, "edited": false, "score": 0, "creation_date": 1464793389, "post_id": 37572066, "comment_id": 62632033, "body": "Thanks, John. Added some code in the post."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1464793974, "post_id": 37572066, "comment_id": 62632463, "body": "Do you close the previous document after opening the new one ?"}, {"owner": {"reputation": 13, "user_id": 6410239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65cf6e052078f2a2bb3160e1473c51f?s=128&d=identicon&r=PG&f=1", "display_name": "jkramer", "link": "https://stackoverflow.com/users/6410239/jkramer"}, "edited": false, "score": 0, "creation_date": 1464794008, "post_id": 37572066, "comment_id": 62632484, "body": "Nope, the original document is open the whole time."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6410239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65cf6e052078f2a2bb3160e1473c51f?s=128&d=identicon&r=PG&f=1", "display_name": "jkramer", "link": "https://stackoverflow.com/users/6410239/jkramer"}, "edited": false, "score": 0, "creation_date": 1464795360, "post_id": 37572923, "comment_id": 62633481, "body": "Thank you so much! This did the trick! (I knew I had to be missing something basic)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1464794828, "creation_date": 1464794828, "answer_id": 37572923, "question_id": 37572066, "link": "https://stackoverflow.com/questions/37572066/word-vba-sharing-variables-between-documents/37572923#37572923", "title": "Word VBA: Sharing variables between documents", "body": "<p>To make a public variable of doc01 (\"source doc\") available to doc02 (\"target doc\") document, go like follows:</p>\n\n<ul>\n<li><p>open the \"source doc\"</p></li>\n<li><p>open the \"target doc\"</p></li>\n<li><p>click Tools-> References</p></li>\n<li><p>from Available References listbox of the References dialog box click the \"Project\" of the \"source doc\"</p>\n\n<p>You can recognize it from the path appearing near the dialog box bottom</p>\n\n<p>Otherwise</p>\n\n<ul>\n<li>close Reference dialog box</li>\n<li>go to \"source doc\" and rename its project (Tools->project properties, edit \"project name\" textbox and click \"OK\") with a meaningful name (say \"MainProject\")</li>\n<li>go back to \"target doc\" project</li>\n<li>open References dialog box and now from Available References listbox click the \"MainProject\" reference</li>\n</ul></li>\n<li><p>Save and close target doc</p></li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 6410239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65cf6e052078f2a2bb3160e1473c51f?s=128&d=identicon&r=PG&f=1", "display_name": "jkramer", "link": "https://stackoverflow.com/users/6410239/jkramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 37572923, "answer_count": 1, "score": 1, "last_activity_date": 1464794828, "creation_date": 1464792600, "last_edit_date": 1464793372, "question_id": 37572066, "link": "https://stackoverflow.com/questions/37572066/word-vba-sharing-variables-between-documents", "title": "Word VBA: Sharing variables between documents", "body": "<p>I feel like this should be obvious, I'm just not finding the answer anywhere. </p>\n\n<p>I have a Word document with several Public variables declared and defined in a variety of procedures. One procedure opens another Word document, which has a form that loads on open. For the life of me I cannot get that form in the second document to use values from the original document's variables. Am I misunderstanding the nature of Public variables? Everything I've found seems to indicate that those values should be visible to the newly opened document. </p>\n\n<p>So to open the second document, I'm using the code below (some of it is declared and set elsewhere, but I think this is the relevant stuff:</p>\n\n<pre><code>Public iMarker as boolean\n\nSub OpenDoc()\n   If check_ExA.Value = True Then 'a checkbox on a userform\n   docName = docsPath &amp; \"/\" &amp; \"seconddocumentpath.docm\"\n   iMarker = True\n   formAddDocs.Hide\n   Set addDoc = Documents.Open(docName)\nEnd Sub\n</code></pre>\n\n<p>from there, the new document has a form that shows on Open, and in the initialization, I want it to be able to see if the iMarker variable is true, among some other strings, etc. </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nIf iMarker = True Then\n  'do some other stuff\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I tried changing that Initialize sub to public and that did nothing. It won't see that iMarker is true when the second document opens. Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1464793116, "post_id": 37571961, "comment_id": 62631827, "body": "please post the code in the question (indent 4 spaces)"}], "owner": {"reputation": 11, "user_id": 6410209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e253e0f1301183f1d8c08f3c860877?s=128&d=identicon&r=PG&f=1", "display_name": "SomthinsFishy", "link": "https://stackoverflow.com/users/6410209/somthinsfishy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464797199, "creation_date": 1464792354, "last_edit_date": 1464797199, "question_id": 37571961, "link": "https://stackoverflow.com/questions/37571961/find-a-cell-using-input-box-then-another-input-box-to-subtract-from-cell-to-the", "title": "Find a cell using input box then another input box to subtract from cell to the right in vba", "body": "<p>I am creating a simple spread sheet to manage inventory. By using input boxes to find a part number in column A (this is a part number) then another input box to subtract the number entered in the second input box from the cell to the right of the found cell. (this is the inventory quantity). I am new to vba so be patient. This is what I have so far. I can find the part number but am stuck on how to subtract the quantity.</p>\n\n<pre><code>Sub Find_First()\n    Dim FindString As String\n    Dim Bog As Range\n    FindString = InputBox(\"Scan Barcode Or Enter Part Number\")\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With Sheets(\"Inventory\").Range(\"A:A\")\n            Set Rng = .Find(What:=FindString, _\n                After:=.Cells(.Cells.Count), _\n                LookIn:=xlValues, _\n                LookAt:=xlWhole, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False)\n            If Not Rng Is Nothing Then\n                Application.Goto Rng, True\n            Else\n                MsgBox \"Part number not found\"\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LEqks.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LEqks.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 3437, "user_id": 240385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZEcfq.jpg?s=128&g=1", "display_name": "jason", "link": "https://stackoverflow.com/users/240385/jason"}, "edited": false, "score": 0, "creation_date": 1464800689, "post_id": 37572402, "comment_id": 62636727, "body": "Great, thanks!  This seems to allow for flexibility!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1464793448, "creation_date": 1464793448, "answer_id": 37572402, "question_id": 37571779, "link": "https://stackoverflow.com/questions/37571779/exporting-access-table-to-excel-but-change-column-titles/37572402#37572402", "title": "Exporting Access Table to Excel but change column titles", "body": "<p>I use a fairly long winded way of exporting to Excel - at the moment it only exports a query or recordset object, but a simple <code>SELECT * FROM Table1</code> will turn your table into a query - or the code can be updated to accept a table reference.</p>\n\n<p>It does, however, allow you to specify the header text, the sheet name and the first cell to import to.</p>\n\n<p>This is the code that performs the export:</p>\n\n<pre><code>'----------------------------------------------------------------------------------\n' Procedure : QueryExportToXL\n' Author    : Darren Bartrup-Cook\n' Date      : 26/08/2014\n' Purpose   : Exports a named query or recordset to Excel.\n'-----------------------------------------------------------------------------------\nPublic Function QueryExportToXL(wrkSht As Object, Optional sQueryName As String, _\n                                                  Optional rst As DAO.Recordset, _\n                                                  Optional SheetName As String, _\n                                                  Optional rStartCell As Object, _\n                                                  Optional AutoFitCols As Boolean = True, _\n                                                  Optional colHeadings As Collection) As Boolean\n\n    Dim db As DAO.Database\n    Dim prm As DAO.Parameter\n    Dim qdf As DAO.QueryDef\n    Dim fld As DAO.Field\n    Dim oXLCell As Object\n    Dim vHeading As Variant\n\n    On Error GoTo ERROR_HANDLER\n\n    If sQueryName &lt;&gt; \"\" And rst Is Nothing Then\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'Open the query recordset.                               '\n        'Any parameters in the query need to be evaluated first. '\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Set db = CurrentDb\n        Set qdf = db.QueryDefs(sQueryName)\n        For Each prm In qdf.Parameters\n            prm.Value = Eval(prm.Name)\n        Next prm\n        Set rst = qdf.OpenRecordset\n    End If\n\n    If rStartCell Is Nothing Then\n        Set rStartCell = wrkSht.cells(1, 1)\n    Else\n        If rStartCell.Parent.Name &lt;&gt; wrkSht.Name Then\n            Err.Raise 4000, , \"Incorrect Start Cell parent.\"\n        End If\n    End If\n\n\n    If Not rst.BOF And Not rst.EOF Then\n        With wrkSht\n            Set oXLCell = rStartCell\n\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            'Paste the field names from the query into row 1 of the sheet. '\n            'TO DO: Facility to use an alternative name.                   '\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            If colHeadings Is Nothing Then\n                For Each fld In rst.Fields\n                    oXLCell.Value = fld.Name\n                    Set oXLCell = oXLCell.Offset(, 1)\n                Next fld\n            Else\n                For Each vHeading In colHeadings\n                    oXLCell.Value = vHeading\n                    Set oXLCell = oXLCell.Offset(, 1)\n                Next vHeading\n            End If\n\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            'Paste the records from the query into row 2 of the sheet. '\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            Set oXLCell = rStartCell.Offset(1, 0)\n            oXLCell.copyfromrecordset rst\n            If AutoFitCols Then\n                .Columns.Autofit\n            End If\n\n            If SheetName &lt;&gt; \"\" Then\n                .Name = SheetName\n            End If\n\n            '''''''''''''''''''''''''''''''''''''''''''\n            'TO DO: Has recordset imported correctly? '\n            '''''''''''''''''''''''''''''''''''''''''''\n            QueryExportToXL = True\n\n        End With\n    Else\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'There are no records to export, so the export has failed. '\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        QueryExportToXL = False\n    End If\n\n    Set db = Nothing\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure QueryExportToXL.\"\n            Err.Clear\n            Resume\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>This code is required to create a new Excel workbook in my example (although you can just pass a reference to an existing workbook/sheet):</p>\n\n<pre><code>Public Function CreateXL(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpXL As Object\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Defer error trapping in case Excel is not running. '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    Set oTmpXL = GetObject(, \"Excel.Application\")\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'If an error occurs then create an instance of Excel. '\n    'Reinstate error handling.                            '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpXL = CreateObject(\"Excel.Application\")\n    End If\n\n    oTmpXL.Visible = bVisible\n    Set CreateXL = oTmpXL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreateXL.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>This code gets the whole thing going (based on a query with two fields) - note I've passed a named query rather than a recordset:</p>\n\n<pre><code>Public Sub ExportToExcel()\n\n    Dim oXL As Object\n    Dim wrkBk As Object\n    Dim colHeadings As Collection\n\n    Set oXL = CreateXL\n    Set wrkBk = oXL.workbooks.Add\n\n    Set colHeadings = New Collection\n\n    colHeadings.Add \"First Field Name\"\n    colHeadings.Add \"Second Field Name\"\n\n    With wrkBk\n        QueryExportToXL wrkBk.worksheets(1), _\n                        \"Query1\", _\n                        , _\n                        \"An Alternative Sheet Name\", _\n                        wrkBk.worksheets(1).range(\"B5\"), _\n                        True, _\n                        colHeadings\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464811848, "post_id": 37572955, "comment_id": 62642680, "body": "This is the method I use. And proud to have given you your 10K reputation. Cheers! ;)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 3, "last_activity_date": 1464794926, "creation_date": 1464794926, "answer_id": 37572955, "question_id": 37571779, "link": "https://stackoverflow.com/questions/37571779/exporting-access-table-to-excel-but-change-column-titles/37572955#37572955", "title": "Exporting Access Table to Excel but change column titles", "body": "<p>Create a straight select query where you specify the friendly names:</p>\n\n<pre><code>Select\n    SomeField As [New Sales],\n    AnotherField As [Sales District],\n    SomeOtherField As [Sales Volume]\nFrom\n    myTableName\n</code></pre>\n\n<p>Save this and the use the name of your query when exporting:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, 10, \"SavedQueryName\", exportPath, True\n</code></pre>\n"}], "owner": {"reputation": 3437, "user_id": 240385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZEcfq.jpg?s=128&g=1", "display_name": "jason", "link": "https://stackoverflow.com/users/240385/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 1, "accepted_answer_id": 37572402, "answer_count": 2, "score": 0, "last_activity_date": 1464794926, "creation_date": 1464791861, "question_id": 37571779, "link": "https://stackoverflow.com/questions/37571779/exporting-access-table-to-excel-but-change-column-titles", "title": "Exporting Access Table to Excel but change column titles", "body": "<p>I am trying to export a table to Excel.  I use this code:</p>\n\n<pre><code>fileName = \"My_Export_\" &amp; DateDiff(\"s\", #1/1/1970#, Now()) &amp; \".xlsx\"\nexportPath = CurrentProject.Path &amp; \"\\SomeFolder\\\" &amp; fileName    \nDoCmd.TransferSpreadsheet acExport, 10, \"myTtableName\", exportPath, True\n</code></pre>\n\n<p>This works fine but, when it export the columns, the title for each column is usually not reader friendly (it uses typical field naming conventions).  Is there a way to change the column titles to something more user friendly?</p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "bloomberg"], "comments": [{"owner": {"reputation": 21261, "user_id": 1016343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/DABth.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1016343/matt"}, "edited": false, "score": 0, "creation_date": 1464792323, "post_id": 37571745, "comment_id": 62631250, "body": "Welcome to Stack Overflow. Your description is very detailed - and what exactly is your question? Please be very specific on what you&#39;re asking."}, {"owner": {"reputation": 13, "user_id": 6410114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a308a0a82a085bd6db20b9595ba7fddd?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomie", "link": "https://stackoverflow.com/users/6410114/bloomie"}, "reply_to_user": {"reputation": 21261, "user_id": 1016343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/DABth.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1016343/matt"}, "edited": false, "score": 0, "creation_date": 1464792565, "post_id": 37571745, "comment_id": 62631435, "body": "Sorry for the lack of clarity -- how do I format by BLPSubscribe request to return the Security Description from Bloomberg successfully?"}, {"owner": {"reputation": 21261, "user_id": 1016343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/DABth.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1016343/matt"}, "edited": false, "score": 0, "creation_date": 1464795638, "post_id": 37571745, "comment_id": 62633645, "body": "I added your question to the text above."}, {"owner": {"reputation": 13, "user_id": 6410114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a308a0a82a085bd6db20b9595ba7fddd?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomie", "link": "https://stackoverflow.com/users/6410114/bloomie"}, "reply_to_user": {"reputation": 21261, "user_id": 1016343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/DABth.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1016343/matt"}, "edited": false, "score": 0, "creation_date": 1464796026, "post_id": 37571745, "comment_id": 62633911, "body": "Thanks for the help Matt :)"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1464854563, "post_id": 37571745, "comment_id": 62657516, "body": "<code>SECURITY_DES</code> is not a real time field - you need to run a reference data request. There are examples in the docs."}, {"owner": {"reputation": 13, "user_id": 6410114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a308a0a82a085bd6db20b9595ba7fddd?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomie", "link": "https://stackoverflow.com/users/6410114/bloomie"}, "edited": false, "score": 0, "creation_date": 1464872298, "post_id": 37571745, "comment_id": 62669862, "body": "Thanks assylias -- you are of course correct and my working model did submit a reference data request.  I&#39;m not sure where the &quot;docs&quot; are (I tried &lt;WAPI&gt; &lt;GO&gt; but found the page quite disorganized) but I would love to have a nice chunk of reference material to read up on."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6410114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a308a0a82a085bd6db20b9595ba7fddd?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomie", "link": "https://stackoverflow.com/users/6410114/bloomie"}, "edited": false, "score": 0, "creation_date": 1464871462, "post_id": 37590689, "comment_id": 62669151, "body": "Thank you! I updated the reference I was using from &quot;Bloomberg Data Type Library&quot; to &quot;Bloomberg API COM 3.5 Type Library&quot;.  I then referenced a pre-written Bloomberg Class Module made to optimize Bloomberg calls which I found at this URL (thanks Mikael Katajam&#228;ki): <a href=\"http://mikejuniperhill.blogspot.com/2013/06/bloomberg-v3com-api-wrapper-update-for.html\" rel=\"nofollow noreferrer\">mikejuniperhill.blogspot.com/2013/06/&hellip;</a>  I was getting an empty variant back using the refactored code until I reformatted my security name as &quot;/cusip/xxxxxxxxx&quot;.  Will post new code in an edit to the original question."}], "tags": [], "owner": {"reputation": 116, "user_id": 4719807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6d46da699ddfa2ca47a2bafc94c6d?s=128&d=identicon&r=PG&f=1", "display_name": "amkingTRP", "link": "https://stackoverflow.com/users/4719807/amkingtrp"}, "is_accepted": true, "score": 0, "last_activity_date": 1464867299, "creation_date": 1464867299, "answer_id": 37590689, "question_id": 37571745, "link": "https://stackoverflow.com/questions/37571745/bloomberg-vba-blpsubscribe-method-returning-n-a-sec-for-cusip-input/37590689#37590689", "title": "Bloomberg VBA - BLPSubscribe method returning &quot;#N/A Sec&quot; for CUSIP input", "body": "<p>You'd format it by placing \"Cusip\" after the CUSIP number.\nSo BloombergReturnData = BloombergModule.BLPSubscribe(\"xxxxxxx Cusip\", BloombergFields) would return the required fields.\nI tested using your Cusip list and it does populate the variant with the correct field data.</p>\n\n<p>Please note that the ActiveX control you're using is no longer supported by Bloomberg.  There is a COM Data Control using the \"v3\" interface.</p>\n"}], "owner": {"reputation": 13, "user_id": 6410114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a308a0a82a085bd6db20b9595ba7fddd?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomie", "link": "https://stackoverflow.com/users/6410114/bloomie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 1, "accepted_answer_id": 37590689, "answer_count": 1, "score": 1, "last_activity_date": 1464872188, "creation_date": 1464791796, "last_edit_date": 1464872188, "question_id": 37571745, "link": "https://stackoverflow.com/questions/37571745/bloomberg-vba-blpsubscribe-method-returning-n-a-sec-for-cusip-input", "title": "Bloomberg VBA - BLPSubscribe method returning &quot;#N/A Sec&quot; for CUSIP input", "body": "<p>I am attempting to pull down the SECURITY_DES field value for a known CUSIP of unknown Fixed Income type (could be a corporate, treasury, mortgage- or asset-backed, etc.).  I am using a declared variant to return the Bloomberg response, which has been showing \"#N/A Sec\" no matter how I structure my request.</p>\n\n<p>I am running this within Excel and have the \"Bloomberg Data Type Library\" Reference added.  I will paste the code below; I have tried formatting the CUSIP as /CUSIP/xxxxxxxxx, xxxxxxxxx CUSIP, IDxxxxxxxxx, all without luck.  I tried Googling for formatting assistance but was having trouble finding matching discussions which worked out for me.</p>\n\n<pre><code>        Dim BloombergModule As BlpData\n        Set BloombergModule = New BlpData\n        Dim BloombergReturnData As Variant\n        Dim BloombergFields(0) As String\n        ' Prepare request for the SECURITY_DES field, \"Security Description\"...\n        BloombergFields(0) = \"SECURITY_DES\"\n        BloombergReturnData = BloombergModule.BLPSubscribe([CUSIP], BloombergFields)\n</code></pre>\n\n<p>I placed a breakpoint just after the last line pasted above; when I watch the BloombergReturnData variable, I see \"#N/A Sec\" in the BloombergReturnData(0,0) expression, which is what I expect -- only with the security's actual description returned instead of \"#N/A Sec\".</p>\n\n<p>If you haven't caught on yet, I'm not a programmer by trade but have been using Bloomberg and VBA lately to fill some gaps around the office.  Based on what I've read, I suspect that I have to pass in the fixed income type (Corp, Govt, Mtge, etc.) however I don't know that within my current data set and would have to track that down somehow.</p>\n\n<p>Using Bloomberg's GUI, I can type in \"IDxxxxxxxxx\" (x's representing a CUSIP) to arrive at the main menu for a security.</p>\n\n<p>Here are a few sample CUSIPs:\n428236BR3,\n500255AV6,\n912828UE8,\n49126PET3,\n912828SC5,\n912828MS6,\n02225AFW7</p>\n\n<p><strong>How do I format my BLPSubscribe request to return the Security Description from Bloomberg successfully?</strong></p>\n\n<hr>\n\n<hr>\n\n<p>EDIT: This has been answered.  I was using an old reference and structure which Bloomberg no longer supports.  Using information from a blog post written by Mikael Katajam\u00e4ki, I restructured my call using the updated reference (\"Bloomberg API COM 3.5 Type Library\") and the security name format \"/cusip/xxxxxxxxx\".  The updated code is below (keep in mind that you will need the class module from Mikael Katajam\u00e4ki's blog post if you intend on copy this structure):</p>\n\n<pre><code>        ' BCOM_wrapper is from Mikael Katajam\u00e4ki's Bloomberg Class Module\n        Dim BloombergModule As BCOM_wrapper\n        Set BloombergModule = New BCOM_wrapper\n        Dim BloombergReturnData As Variant\n        Dim BloombergFields(0) As Variant\n        Dim BloombergSecurities(0) As Variant\n        Dim SecurityDescription As String\n        ' Prepare request for the SECURITY_DES field, \"Security Description\"...\n        BloombergFields(0) = \"SECURITY_DES\"\n        BloombergSecurities(0) = (\"/cusip/\" &amp; CStr(SQLResults![CUSIP]))\n        ' getData() is from Mikael Katajam\u00e4ki's Bloomberg Class Module\n        BloombergReturnData = BloombergModule.getData(REFERENCE_DATA, BloombergSecurities, BloombergFields)\n\n        ' I used an absolute reference to the (0,0) slot since the nature of my use here is always just a single security\n        SecurityDescription = BloombergReturnData(0, 0)\n\n        Range(\"D\" &amp; CStr(Right(Target.Address, 2))).Value = SecurityDescription\n</code></pre>\n\n<p>Mikael Katajam\u00e4ki's Blog Post: <a href=\"http://mikejuniperhill.blogspot.com/2013/06/bloomberg-v3com-api-wrapper-update-for.html\" rel=\"nofollow\">http://mikejuniperhill.blogspot.com/2013/06/bloomberg-v3com-api-wrapper-update-for.html</a></p>\n\n<p>Archive of Mikael Katajam\u00e4ki's class module (please notify me if this is against the rules and I will delete):</p>\n\n<pre><code>Option Explicit\n'\n' public enumerator for request type\nPublic Enum ENUM_REQUEST_TYPE\n    REFERENCE_DATA = 1\n    HISTORICAL_DATA = 2\n    BULK_REFERENCE_DATA = 3\nEnd Enum\n'\n' constants\nPrivate Const CONST_SERVICE_TYPE As String = \"//blp/refdata\"\nPrivate Const CONST_REQUEST_TYPE_REFERENCE As String = \"ReferenceDataRequest\"\nPrivate Const CONST_REQUEST_TYPE_BULK_REFERENCE As String = \"ReferenceDataRequest\"\nPrivate Const CONST_REQUEST_TYPE_HISTORICAL As String = \"HistoricalDataRequest\"\n'\n' private data structures\nPrivate bInputSecurityArray() As Variant\nPrivate bInputFieldArray() As Variant\nPrivate bOutputArray() As Variant\n'\n' BCOM objects\nPrivate bSession As blpapicomLib2.Session\nPrivate bService As blpapicomLib2.Service\nPrivate bRequest As blpapicomLib2.REQUEST\nPrivate bSecurityArray As blpapicomLib2.Element\nPrivate bFieldArray As blpapicomLib2.Element\nPrivate bEvent As blpapicomLib2.Event\nPrivate bIterator As blpapicomLib2.MessageIterator\nPrivate bIteratorData As blpapicomLib2.Message\nPrivate bSecurities As blpapicomLib2.Element\nPrivate bSecurity As blpapicomLib2.Element\nPrivate bSecurityName As blpapicomLib2.Element\nPrivate bSecurityField As blpapicomLib2.Element\nPrivate bFieldValue As blpapicomLib2.Element\nPrivate bSequenceNumber As blpapicomLib2.Element\nPrivate bFields As blpapicomLib2.Element\nPrivate bField As blpapicomLib2.Element\nPrivate bDataPoint As blpapicomLib2.Element\n'\n' class non-object data members\nPrivate bRequestType As ENUM_REQUEST_TYPE\nPrivate bNumberOfDataPoints As Long\nPrivate bCalendarType As String\nPrivate bFrequency As String\nPrivate bMaxDataPoints As Long\nPrivate bStartDate As String\nPrivate bEndDate As String\nPrivate nSecurities As Long\nPrivate nSecurity As Long\n'\nPublic Function getData(ByVal requestType As ENUM_REQUEST_TYPE, _\nByRef securities() As Variant, ByRef fields() As Variant, _\nOptional ByVal calendarType As String, Optional ByVal dataFrequency As String, _\nOptional ByVal startDate As Date, Optional ByVal endDate As Date) As Variant()\n    '\n    bRequestType = requestType\n    bInputSecurityArray = securities\n    bInputFieldArray = fields\n    '\n    If (bRequestType = ENUM_REQUEST_TYPE.HISTORICAL_DATA) Then\n        '\n        bCalendarType = calendarType\n        bFrequency = dataFrequency\n        '\n        If ((startDate = CDate(0)) Or (endDate = CDate(0))) Then _\n            Err.Raise vbObjectError, \"Bloomberg API\", \"Input parameters missing for historical data query\"\n        bStartDate = convertDateToBloombergString(startDate)\n        bEndDate = convertDateToBloombergString(endDate)\n    End If\n    '\n    openSession\n    sendRequest\n    catchServerEvent\n    releaseObjects\n    getData = bOutputArray\nEnd Function\n'\nPrivate Function openSession()\n    '\n    Set bSession = New blpapicomLib2.Session\n    bSession.Start\n    bSession.OpenService CONST_SERVICE_TYPE\n    Set bService = bSession.GetService(CONST_SERVICE_TYPE)\nEnd Function\n'\nPrivate Function sendRequest()\n    '\n    Select Case bRequestType\n        Case ENUM_REQUEST_TYPE.HISTORICAL_DATA\n            ReDim bOutputArray(0 To UBound(bInputSecurityArray, 1), 0 To 0)\n            Set bRequest = bService.CreateRequest(CONST_REQUEST_TYPE_HISTORICAL)\n            bRequest.Set \"periodicityAdjustment\", bCalendarType\n            bRequest.Set \"periodicitySelection\", bFrequency\n            bRequest.Set \"startDate\", bStartDate\n            bRequest.Set \"endDate\", bEndDate\n            '\n        Case ENUM_REQUEST_TYPE.REFERENCE_DATA\n            Dim nSecurities As Long: nSecurities = UBound(bInputSecurityArray)\n            Dim nFields As Long: nFields = UBound(bInputFieldArray)\n            ReDim bOutputArray(0 To nSecurities, 0 To nFields)\n            '\n            Set bRequest = bService.CreateRequest(CONST_REQUEST_TYPE_REFERENCE)\n            '\n        Case ENUM_REQUEST_TYPE.BULK_REFERENCE_DATA\n            ReDim bOutputArray(0 To UBound(bInputSecurityArray, 1), 0 To 0)\n            Set bRequest = bService.CreateRequest(CONST_REQUEST_TYPE_BULK_REFERENCE)\n            '\n    End Select\n    '\n    Set bSecurityArray = bRequest.GetElement(\"securities\")\n    Set bFieldArray = bRequest.GetElement(\"fields\")\n    appendRequestItems\n    bSession.sendRequest bRequest\nEnd Function\n'\nPrivate Function appendRequestItems()\n    '\n    Dim nSecurities As Long: nSecurities = UBound(bInputSecurityArray)\n    Dim nFields As Long: nFields = UBound(bInputFieldArray)\n    Dim i As Long\n    Dim nItems As Integer: nItems = getMax(nSecurities, nFields)\n    For i = 0 To nItems\n        If (i &lt;= nSecurities) Then bSecurityArray.AppendValue CStr(bInputSecurityArray(i))\n        If (i &lt;= nFields) Then bFieldArray.AppendValue CStr(bInputFieldArray(i))\n    Next i\nEnd Function\n'\nPrivate Function catchServerEvent()\n    '\n    Dim bExit As Boolean\n    Do While (bExit = False)\n        Set bEvent = bSession.NextEvent\n        If (bEvent.EventType = PARTIAL_RESPONSE Or bEvent.EventType = RESPONSE) Then\n            '\n            Select Case bRequestType\n                Case ENUM_REQUEST_TYPE.REFERENCE_DATA: getServerData_reference\n                Case ENUM_REQUEST_TYPE.HISTORICAL_DATA: getServerData_historical\n                Case ENUM_REQUEST_TYPE.BULK_REFERENCE_DATA: getServerData_bulkReference\n            End Select\n            '\n            If (bEvent.EventType = RESPONSE) Then bExit = True\n        End If\n    Loop\nEnd Function\n'\nPrivate Function getServerData_reference()\n    '\n    Set bIterator = bEvent.CreateMessageIterator\n    Do While (bIterator.Next)\n        Set bIteratorData = bIterator.Message\n        Set bSecurities = bIteratorData.GetElement(\"securityData\")\n        Dim offsetNumber As Long, i As Long, j As Long\n        nSecurities = bSecurities.Count\n        '\n        For i = 0 To (nSecurities - 1)\n            Set bSecurity = bSecurities.GetValue(i)\n            Set bSecurityName = bSecurity.GetElement(\"security\")\n            Set bSecurityField = bSecurity.GetElement(\"fieldData\")\n            Set bSequenceNumber = bSecurity.GetElement(\"sequenceNumber\")\n            offsetNumber = CInt(bSequenceNumber.Value)\n            '\n            For j = 0 To UBound(bInputFieldArray)\n                If (bSecurityField.HasElement(bInputFieldArray(j))) Then\n                    Set bFieldValue = bSecurityField.GetElement(bInputFieldArray(j))\n                    '\n                    If (bFieldValue.DataType = BLPAPI_INT32) Then\n                        bOutputArray(offsetNumber, j) = VBA.CLng(bFieldValue.Value)\n                    Else\n                        bOutputArray(offsetNumber, j) = bFieldValue.Value\n                    End If\n                End If\n            Next j\n        Next i\n    Loop\nEnd Function\n'\nPrivate Function getServerData_bulkReference()\n    '\n    Set bIterator = bEvent.CreateMessageIterator\n    nSecurity = nSecurity + 1\n    '\n    Do While (bIterator.Next)\n        Set bIteratorData = bIterator.Message\n        Set bSecurities = bIteratorData.GetElement(\"securityData\")\n        Dim offsetNumber As Long, i As Long, j As Long\n        Dim nSecurities As Long: nSecurities = bSecurities.Count\n        '\n        Set bSecurity = bSecurities.GetValue(0)\n        Set bSecurityField = bSecurity.GetElement(\"fieldData\")\n        '\n        If (bSecurityField.HasElement(bInputFieldArray(0))) Then\n            Set bFieldValue = bSecurityField.GetElement(bInputFieldArray(0))\n            '\n            If ((bFieldValue.NumValues - 1) &gt; UBound(bOutputArray, 2)) Then _\n                ReDim Preserve bOutputArray(0 To UBound(bOutputArray, 1), 0 To bFieldValue.NumValues - 1)\n            '\n            For i = 0 To bFieldValue.NumValues - 1\n                Set bDataPoint = bFieldValue.GetValue(i)\n                bOutputArray(nSecurity - 1, i) = bDataPoint.GetElement(0).Value\n            Next i\n        End If\n    Loop\nEnd Function\n'\nPrivate Function getServerData_historical()\n    '\n    Set bIterator = bEvent.CreateMessageIterator\n    Do While (bIterator.Next)\n        Set bIteratorData = bIterator.Message\n        Set bSecurities = bIteratorData.GetElement(\"securityData\")\n        Dim nSecurities As Long: nSecurities = bSecurityArray.Count\n        Set bSecurityField = bSecurities.GetElement(\"fieldData\")\n        Dim nItems As Long, offsetNumber As Long, nFields As Long, i As Long, j As Long\n        nItems = bSecurityField.NumValues\n        If (nItems = 0) Then Exit Function\n        If ((nItems &gt; UBound(bOutputArray, 2))) Then _\n            ReDim Preserve bOutputArray(0 To nSecurities - 1, 0 To nItems - 1)\n        '\n        Set bSequenceNumber = bSecurities.GetElement(\"sequenceNumber\")\n        offsetNumber = CInt(bSequenceNumber.Value)\n        '\n        If (bSecurityField.Count &gt; 0) Then\n            For i = 0 To (nItems - 1)\n                '\n                If (bSecurityField.Count &gt; i) Then\n                    Set bFields = bSecurityField.GetValue(i)\n                    If (bFields.HasElement(bFieldArray(0))) Then\n                        '\n                        Dim d(0 To 1) As Variant\n                        d(0) = bFields.GetElement(0).GetValue(0)\n                        d(1) = bFields.GetElement(1).GetValue(0)\n                        bOutputArray(offsetNumber, i) = d\n                    End If\n                End If\n            Next i\n        End If\n    Loop\nEnd Function\n'\nPrivate Function releaseObjects()\n    '\n    Set bFieldValue = Nothing\n    Set bSequenceNumber = Nothing\n    Set bSecurityField = Nothing\n    Set bSecurityName = Nothing\n    Set bSecurity = Nothing\n    Set bSecurities = Nothing\n    Set bIteratorData = Nothing\n    Set bIterator = Nothing\n    Set bEvent = Nothing\n    Set bFieldArray = Nothing\n    Set bSecurityArray = Nothing\n    Set bRequest = Nothing\n    Set bService = Nothing\n    bSession.Stop\n    Set bSession = Nothing\nEnd Function\n'\nPrivate Function convertDateToBloombergString(ByVal d As Date) As String\n    '\n    ' convert date data type into string format YYYYMMDD\n    Dim dayString As String: dayString = VBA.CStr(VBA.Day(d)): If (VBA.Day(d) &lt; 10) Then dayString = \"0\" + dayString\n    Dim MonthString As String: MonthString = VBA.CStr(VBA.Month(d)): If (VBA.Month(d) &lt; 10) Then MonthString = \"0\" + MonthString\n    Dim yearString As String: yearString = VBA.Year(d)\n    convertDateToBloombergString = yearString + MonthString + dayString\nEnd Function\n'\nPrivate Function getMax(ByVal a As Long, ByVal b As Long) As Long\n    '\n    getMax = a: If (b &gt; a) Then getMax = b\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1464792046, "post_id": 37571731, "comment_id": 62631043, "body": "I&#39;m a little confused as to what is so big the local table or the sharepoint linked tables.  Which is it you want to update?"}, {"owner": {"reputation": 153, "user_id": 6062021, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e310bd60cab362e45df423b8b1523cbe?s=128&d=identicon&r=PG&f=1", "display_name": "M_kul", "link": "https://stackoverflow.com/users/6062021/m-kul"}, "reply_to_user": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1464793880, "post_id": 37571731, "comment_id": 62632390, "body": "they are both the same list. I want to check for differences between the sharepoint list and the local table and apply them to the local table"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464812853, "post_id": 37571731, "comment_id": 62643196, "body": "How long could be deleting local data and inserting sharepoint data at startup? 30 sec. is a reasonable period for <b><i>INITIALIZING SYSTEM</i></b> actions."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464813270, "post_id": 37571731, "comment_id": 62643406, "body": "Just for the note: it takes me no longer than 2 sec. to synchronize or replace table data with data from files in a LAN drive, some 25K-40K records."}, {"owner": {"reputation": 153, "user_id": 6062021, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e310bd60cab362e45df423b8b1523cbe?s=128&d=identicon&r=PG&f=1", "display_name": "M_kul", "link": "https://stackoverflow.com/users/6062021/m-kul"}, "edited": false, "score": 0, "creation_date": 1464905744, "post_id": 37571731, "comment_id": 62690700, "body": "The problem is it takes roughly 30 secs to load up that one list every time. I don&#39;t know what your speed is. Data is in a sharepoint linked list, internet speed is roughly 10-15mbps I don&#39;t know if retrieving from sharepoint is so inefficient or what else could be the issue."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 6062021, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e310bd60cab362e45df423b8b1523cbe?s=128&d=identicon&r=PG&f=1", "display_name": "M_kul", "link": "https://stackoverflow.com/users/6062021/m-kul"}, "edited": false, "score": 0, "creation_date": 1464905828, "post_id": 37579139, "comment_id": 62690726, "body": "I know I can do that the problem is this will do exactly what I am trying to avoid which is to cache the entire sharepoint list first."}, {"owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "reply_to_user": {"reputation": 153, "user_id": 6062021, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e310bd60cab362e45df423b8b1523cbe?s=128&d=identicon&r=PG&f=1", "display_name": "M_kul", "link": "https://stackoverflow.com/users/6062021/m-kul"}, "edited": false, "score": 0, "creation_date": 1464993364, "post_id": 37579139, "comment_id": 62731229, "body": "Is there a reason as to why you don&#39;t want to cache the Entire list?"}], "tags": [], "owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "is_accepted": false, "score": 0, "last_activity_date": 1464821374, "last_edit_date": 1464821374, "creation_date": 1464816733, "answer_id": 37579139, "question_id": 37571731, "link": "https://stackoverflow.com/questions/37571731/using-ms-access-to-update-a-local-table-without-importing-the-whole-list-from-sh/37579139#37579139", "title": "using ms access to update a local table without importing the whole list from sharepoint", "body": "<p>If you just need to update the local table with the fresh data from the SharePoint table, you could create a query that simply overwrites the old table from the SharePoint Table.</p>\n\n<p>For example:\nAfter you link SharepointTableA, create a query</p>\n\n<pre><code>SELECT SharePointTableA.* INTO LocalTableB  FROM SharePointTableA \n</code></pre>\n\n<p>This will overwrite all the contents of the local table with the data from the SharePoint Table.</p>\n\n<p>unless there's a specific reason why you don't want to overwrite records...</p>\n"}], "owner": {"reputation": 153, "user_id": 6062021, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e310bd60cab362e45df423b8b1523cbe?s=128&d=identicon&r=PG&f=1", "display_name": "M_kul", "link": "https://stackoverflow.com/users/6062021/m-kul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464821374, "creation_date": 1464791763, "question_id": 37571731, "link": "https://stackoverflow.com/questions/37571731/using-ms-access-to-update-a-local-table-without-importing-the-whole-list-from-sh", "title": "using ms access to update a local table without importing the whole list from sharepoint", "body": "<p>I have a bit of a dilema concerning a large database. I have a database where all the data is kept on a sharepoint server. The cache is cleared everytime database is closed. </p>\n\n<p>My problem is that the parts number list is quite large (12200 records)  and needs to be cached fully every time access is open. This list however is fairly static so I want to make it static and simply run an update to apply changes that occured when the access app is opened. </p>\n\n<p>I do not know how to do that, I know I can link the sharepoint list and simply update the local list with sql. This however defeats the purpose since access will have to first download the whole data from sharepoint to begin with. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464790066, "post_id": 37571073, "comment_id": 62629448, "body": "To clarify the logic would go something like this:  - go down b2 -&gt; b until blank cell  - for cells that contain &quot;DATE&quot; or &quot;DT&quot;   - go down that row -&gt; go until blank cell  - change the format of all cells to mm:dd:yyyy h:mm"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "reply_to_user": {"reputation": 2553, "user_id": 936420, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZGCTM.jpg?s=128&g=1", "display_name": "epo3", "link": "https://stackoverflow.com/users/936420/epo3"}, "edited": false, "score": 0, "creation_date": 1464791234, "post_id": 37571073, "comment_id": 62630419, "body": "As of now I only have this that works for column A:  Sub Macro()      Dim iLastRow As Integer     Dim i As Integer     iLastRow = ActiveSheet.Range(&quot;a10000&quot;).End(xlUp).Row      For i = 3 To iLastRow     ActiveSheet.Range(&quot;A&quot; &amp; i).Select     Selection.NumberFormat = &quot;m/d/yyyy h:mm&quot; Next i End Sub  I&#39;m having trouble making that a variable"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464792285, "post_id": 37571073, "comment_id": 62631229, "body": "why not directly <code>ActiveSheet.Range(&quot;A:A&quot;).NumberFormat = &quot;m&#47;d&#47;yyyy h:mm&quot;</code>?"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464792476, "post_id": 37571073, "comment_id": 62631364, "body": "My hope is to dynamically format based on headers, if possible"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464800356, "post_id": 37572368, "comment_id": 62636552, "body": "Thank you for this! Not sure what you mean though by changing the For Each. Sorry I&#39;m very new to VBA."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464800455, "post_id": 37572368, "comment_id": 62636611, "body": "It looks for the first row to find your headers... but if they are in the second one, you need to change the first parameter in <code>Cells</code> from 1 to 2."}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464801061, "post_id": 37572368, "comment_id": 62636953, "body": "Thank you so much! This is super helpful. If I was trying to get this to run through all the Worksheets would I also use a For Each?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464801123, "post_id": 37572368, "comment_id": 62636994, "body": "You can, yes... it follows the same logic"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464896699, "post_id": 37572368, "comment_id": 62686454, "body": "Hi, you have any tips on this?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1464898152, "post_id": 37572368, "comment_id": 62687250, "body": "I changed the sub to fit your needs."}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1464898110, "last_edit_date": 1464898110, "creation_date": 1464793344, "answer_id": 37572368, "question_id": 37571073, "link": "https://stackoverflow.com/questions/37571073/looking-to-be-able-to-look-through-header-columns-and-reformat-cells-in-those-co/37572368#37572368", "title": "Looking to be able to look through header columns and reformat cells in those columns in VBA", "body": "<p>This should do what you want:</p>\n\n<pre><code>Sub Macro()\n  Dim x As Variant, y As Variant\n  For Each y In ThisWorkbook.Worksheets\n    With y\n      For Each x In .Range(.Cells(1, 1), .Cells(1, .Columns.Count).End(xlToLeft)).Cells\n        If InStr(1, Replace(x.Value, \"DATE\", \"DT\", , , vbTextCompare), \"DT\", vbTextCompare) Then\n          Intersect(.UsedRange, .UsedRange.Offset(2), x.EntireColumn).NumberFormat = \"m/d/yyyy h:mm\"\n        End If\n      Next\n    End With\n  Next\nEnd Sub\n</code></pre>\n\n<p>Just change the <code>For Each</code> line to fit your needs ;)</p>\n"}], "owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37572368, "answer_count": 1, "score": 0, "last_activity_date": 1464898110, "creation_date": 1464790026, "last_edit_date": 1464791977, "question_id": 37571073, "link": "https://stackoverflow.com/questions/37571073/looking-to-be-able-to-look-through-header-columns-and-reformat-cells-in-those-co", "title": "Looking to be able to look through header columns and reformat cells in those columns in VBA", "body": "<p>my hope is to look through the headers of an Excel sheet and find those headers that include the word \"DATE\" or \"DT\" and reformat all of the data in that column to \"mm/dd/yyyy hh:mm\" Any help would be appreciated. Thanks.</p>\n\n<p>Existing code (lifted from comment)</p>\n\n<pre><code>Sub Macro() \n    Dim iLastRow As Integer \n    Dim i As Integer \n    iLastRow = ActiveSheet.Range(\"a10000\").End(xlUp).Row \n    For i = 3 To iLastRow \n        ActiveSheet.Range(\"A\" &amp; i).Select \n        Selection.NumberFormat = \"m/d/yyyy h:mm\" \n    Next i \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "file-location"], "comments": [{"owner": {"reputation": 23, "user_id": 4135810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b6601213ceba9e4aa49fadc5b9bd6df?s=128&d=identicon&r=PG&f=1", "display_name": "theMagicOne", "link": "https://stackoverflow.com/users/4135810/themagicone"}, "edited": false, "score": 0, "creation_date": 1464790201, "post_id": 37570948, "comment_id": 62629560, "body": "I should mention that I tried putting the macro file into the Documents folder, and this works for the Worksheet.Activate macro. Unfortunately, this then returns a similar error for every other macro in the worksheet."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1464791778, "post_id": 37570948, "comment_id": 62630843, "body": "Probably cause by your relative path/ no path to the xlsb. Try using <code>Application.Run Environ(&quot;appdata&quot;) &amp; &quot;\\Microsoft\\Excel\\XLSTART\\Master_Macros.xlsb!&#39;C_Tool_Paste_W&zwnj;&#8203;indow.CTool_LineFix&#39;&zwnj;&#8203;&quot;</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1464791976, "post_id": 37570948, "comment_id": 62630987, "body": "<code>application.StartupPath</code> will return the XLStart folder."}, {"owner": {"reputation": 23, "user_id": 4135810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b6601213ceba9e4aa49fadc5b9bd6df?s=128&d=identicon&r=PG&f=1", "display_name": "theMagicOne", "link": "https://stackoverflow.com/users/4135810/themagicone"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1464795470, "post_id": 37570948, "comment_id": 62633538, "body": "@LocEngineer So I tested this on my machine, and changing this path actually return the same error as the user&#39;s computer with the issue. Which makes zero sense considering the path is correct and the file is there. When I change it back to <code>Application.Run      (&quot;Master_Macros.xlsb!&#39;C_Tool_Paste_Window.CTool_LineFix&#39;&quot;)</code> it works normally on my machine."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4135810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b6601213ceba9e4aa49fadc5b9bd6df?s=128&d=identicon&r=PG&f=1", "display_name": "theMagicOne", "link": "https://stackoverflow.com/users/4135810/themagicone"}, "edited": false, "score": 0, "creation_date": 1464797019, "post_id": 37571727, "comment_id": 62634530, "body": "I&#39;ll look into it and get back to you!"}], "tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1464791755, "creation_date": 1464791755, "answer_id": 37571727, "question_id": 37570948, "link": "https://stackoverflow.com/questions/37570948/excel-cannot-find-my-macro/37571727#37571727", "title": "Excel cannot find my Macro", "body": "<p>I had similar problem when I installed Service Pack.  </p>\n\n<p>If the users are accessing files from different computers, </p>\n\n<p>make sure they all have same service pack installed</p>\n"}], "owner": {"reputation": 23, "user_id": 4135810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b6601213ceba9e4aa49fadc5b9bd6df?s=128&d=identicon&r=PG&f=1", "display_name": "theMagicOne", "link": "https://stackoverflow.com/users/4135810/themagicone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464791755, "creation_date": 1464789701, "question_id": 37570948, "link": "https://stackoverflow.com/questions/37570948/excel-cannot-find-my-macro", "title": "Excel cannot find my Macro", "body": "<p>I have a Worksheet.Activate macro for pasting information that has been working for over a year now. I have multiple users using the macro with no problems. Recently one user is having this error whenever they paste into this worksheet that activates the macro: </p>\n\n<p><strong>Run-time error '1004': 'C:\\Users\\xxxx\\Documents\\Master_Macros.xlsb' could not be found. Check the spelling of the file name, and verify that the file location is correct.</strong></p>\n\n<p>They have never had this issue before and as far as I know he hasn't done anything abnormal. The macro is located in the typical XLSTART folder, not the Documents folder. The macro file also includes other macros that are executing perfectly fine for this user. Excel is <em>suddenly</em> looking for the macro file in the Documents folder for this one Worksheet.Activate macro.  I have spent some time googling, and I don't know if it is my keyword choice or what, I cannot find a solution. </p>\n\n<p>The macro is run using this line:</p>\n\n<pre><code> Application.Run (\"Master_Macros.xlsb!'C_Tool_Paste_Window.CTool_LineFix'\")\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "outlook", "ribbon"], "comments": [{"owner": {"reputation": 171, "user_id": 1832238, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/645bc009b2c36aaaedf5ef326fe03f99?s=128&d=identicon&r=PG", "display_name": "Regenbui", "link": "https://stackoverflow.com/users/1832238/regenbui"}, "edited": false, "score": 1, "creation_date": 1464861293, "post_id": 37570847, "comment_id": 62662117, "body": "Point 1 solved: A Module name can&#39;t contain a Macro of the same name."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1465285392, "post_id": 37570847, "comment_id": 62824164, "body": "If you place a breakpoint on <code>Sub InsertText</code> and then press the button on the ribbon, does the code get run? and if it does run? what happens? does it go to the error handle? Does it not believe the active window and an Inspector? Does it not believe you use Word as the editor? There are a lot of variables here, the more information you could add the quicker we&#39;ll get the answer."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1465544162, "post_id": 37570847, "comment_id": 62955165, "body": "@Regenbui : Have you tried what was proposed by Gary? Does it work properly?"}], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1465286261, "last_edit_date": 1465286261, "creation_date": 1465285731, "answer_id": 37673476, "question_id": 37570847, "link": "https://stackoverflow.com/questions/37570847/outlook-vba-insert-line-of-text/37673476#37673476", "title": "Outlook VBA insert line of text", "body": "<p>When you are adding it to the ribbon, are you adding it to the mail item ribbon or outlook ribbon? This gets confusing so I'm going to use mostly pictures to describe it. </p>\n\n<p>This is it added to the mail item ribbon and it worked fine: -\n<a href=\"https://i.stack.imgur.com/PsX1p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PsX1p.png\" alt=\"Mail Item &#39;InsertText&#39;\"></a></p>\n\n<p>If I place the button on the Outlook bar pushing the button does not work: -\n<a href=\"https://i.stack.imgur.com/CtDVI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CtDVI.png\" alt=\"Outlook &#39;InsertText&#39;\"></a></p>\n\n<p>This is because as soon as I push the button on the Outlook ribbon, the mail item is no longer the active window.</p>\n\n<p>For confirmation, to add the button to to the mail item window, right click on the ribbon of a mail item and choose 'Customize the Ribbon...'\n<a href=\"https://i.stack.imgur.com/vmbOi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vmbOi.png\" alt=\"Customize the Ribbon...\"></a></p>\n\n<p>Press the 'New Tab' button in the lower right, change 'Choose commands from:' to 'Macros' and click on the macro in question from the list below it. Finally, click the 'Add > >' and then 'OK'.\n<a href=\"https://i.stack.imgur.com/kr0qe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kr0qe.png\" alt=\"Ribbon Customisation\"></a></p>\n"}], "owner": {"reputation": 171, "user_id": 1832238, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/645bc009b2c36aaaedf5ef326fe03f99?s=128&d=identicon&r=PG", "display_name": "Regenbui", "link": "https://stackoverflow.com/users/1832238/regenbui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1593329542, "creation_date": 1464789456, "last_edit_date": 1593329542, "question_id": 37570847, "link": "https://stackoverflow.com/questions/37570847/outlook-vba-insert-line-of-text", "title": "Outlook VBA insert line of text", "body": "<p>I'm trying to write a piece of code (vba) that inserts a single line in the email i'm composing (open e-mail item). The code below is a first step i took</p>\n\n<p><strong>What works</strong></p>\n\n<ol>\n<li>if I run the code directly from the module (development window), the text is inserted.</li>\n</ol>\n\n<p><strong>What doesn't work</strong></p>\n\n<ol>\n<li>If I add the a macro (vba) in my ribbon and try to run it, nothing happens. The code only seems to work directly form the module (Play button).</li>\n</ol>\n\n<p><strong>What I want</strong></p>\n\n<ol>\n<li><strike>Run macro (vba) from ribbon in active/open item;</strike>\nSolution = A Module name can't contain a Macro of the same name.</li>\n<li>Set font color to e.g. green;</li>\n<li>Nice to have: insert text at bottom of page.</li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub InsertText()\nDim sText As String\n\nsText = \"Text to insert\"\n\n\nOn Error GoTo ErrHandler\nIf TypeName(ActiveWindow) = \"Inspector\" Then\n    If ActiveInspector.IsWordMail And ActiveInspector.EditorType = olEditorWord Then\n        ActiveInspector.WordEditor.Application.Selection.TypeText sText\n    End If\nEnd If\nExit Sub\nErrHandler:\nBeep\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "save-as"], "comments": [{"owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "edited": false, "score": 0, "creation_date": 1464789031, "post_id": 37570620, "comment_id": 62628610, "body": "I really just want to remove the macro when I save."}, {"owner": {"reputation": 518, "user_id": 1967431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da64dcad52e5888a443fe384a59eae24?s=128&d=identicon&r=PG", "display_name": "some_weired_user", "link": "https://stackoverflow.com/users/1967431/some-weired-user"}, "edited": false, "score": 0, "creation_date": 1464789719, "post_id": 37570620, "comment_id": 62629160, "body": "This should normally work. Which version of Excel are you using? Do you get a notification from Excel that saving will remove the macros?"}, {"owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "reply_to_user": {"reputation": 518, "user_id": 1967431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da64dcad52e5888a443fe384a59eae24?s=128&d=identicon&r=PG", "display_name": "some_weired_user", "link": "https://stackoverflow.com/users/1967431/some-weired-user"}, "edited": false, "score": 0, "creation_date": 1464789774, "post_id": 37570620, "comment_id": 62629215, "body": "Yes I get that notification.  Ill show a picture of the unformatted file."}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "edited": false, "score": 1, "creation_date": 1464790967, "post_id": 37571268, "comment_id": 62630210, "body": "Thanks Simon!  It seems from this that FileFormat in SaveAs doesn&#39;t actually add an extension?  Is it simply recognizing the FileFormat?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1570439344, "post_id": 37571268, "comment_id": 102900347, "body": "Really useful link with numbers for extensions: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlfileformat\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.xlfileformat</a>"}], "tags": [], "owner": {"reputation": 518, "user_id": 1967431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da64dcad52e5888a443fe384a59eae24?s=128&d=identicon&r=PG", "display_name": "some_weired_user", "link": "https://stackoverflow.com/users/1967431/some-weired-user"}, "is_accepted": true, "score": 12, "last_activity_date": 1600850984, "last_edit_date": 1600850984, "creation_date": 1464790526, "answer_id": 37571268, "question_id": 37570620, "link": "https://stackoverflow.com/questions/37570620/how-to-save-as-xlsx-file/37571268#37571268", "title": "How to save as xlsx file?", "body": "<p>When saving the file you should save it with its extension:</p>\n<pre><code>Sub SaveFile()\n\n    savename = Application.GetSaveAsFilename(fileFilter:=&quot;Exel Files (*.xlsx), *.xlsx&quot;) \n    ActiveWorkbook.SaveAs Filename:=savename, FileFormat:=51 \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64329, "favorite_count": 3, "accepted_answer_id": 37571268, "answer_count": 1, "score": 7, "last_activity_date": 1600850984, "creation_date": 1464788861, "last_edit_date": 1581569000, "question_id": 37570620, "link": "https://stackoverflow.com/questions/37570620/how-to-save-as-xlsx-file", "title": "How to save as xlsx file?", "body": "<p>My SaveFile sub saves the file but when I try to open it again Excel doesn't recognize it as an Excel file.</p>\n\n<p>If I right click the file from my desktop and check the properties, the type of file is \"File\". I've read up on the formatting but can't get this file to save as an xlsx format. I was able to get a macro-enabled excel file to work properly but that's not what I want.</p>\n\n<pre><code>Sub SaveFile()\n\n    MsgBox (\"You will now be prompted to save your file\") 'Notifies User \n    savename = Application.GetSaveAsFilename()  'Gets directory/name\n    ActiveWorkbook.SaveAs Filename:=savename, FileFormat:=51 'Something is wrong \n\nEnd Sub\n</code></pre>\n\n<p>Here is the picture of the \"Formatless\" file<br>\n<a href=\"https://i.stack.imgur.com/8xv11.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8xv11.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "xls", "xlsx"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464788705, "post_id": 37570508, "comment_id": 62628323, "body": "you could try a pivot table and drop columns A,B into the row headers and D into the column header, and C as the main table field (forget what it is called)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464790011, "post_id": 37570508, "comment_id": 62629405, "body": "It&#39;s called <i>pivoting</i>, but AFAIK you can&#39;t achieve column D concatenation with a pivot. So if your &quot;desired result&quot; <i>has</i> to look <i>exactly</i> like that, your only hope is with VBA code that iterates the data and moves it around. But before you ask this community about a problem, you have to <i>encounter</i> a <b>specific</b> <i>programming</i> problem, and show us where you&#39;re stumped and what you&#39;ve tried. &quot;Here&#39;s what I need, can anyone code this for me?&quot; is off-topic here. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3438614, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100002131602818/picture?type=large", "display_name": "Damanjeet Singh", "link": "https://stackoverflow.com/users/3438614/damanjeet-singh"}, "edited": false, "score": 0, "creation_date": 1464855773, "post_id": 37571350, "comment_id": 62658267, "body": "Thank you very much, solution is perfect. You have saved my life :)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1464790776, "creation_date": 1464790776, "answer_id": 37571350, "question_id": 37570508, "link": "https://stackoverflow.com/questions/37570508/how-to-un-flatten-data-in-vba/37571350#37571350", "title": "How to un-flatten data in VBA", "body": "<p>You are lucky, because I am bored... this way I will throw you some lines of code which will do what you desire. But as a downside (like a small punishment for not showing code), I made it slow and hard to read :P</p>\n\n<pre><code>Sub test()\n  Dim a(2) As Range\n  Set a(0) = ActiveSheet.Range(\"A2:D2\")\n  While a(0)(1).Value &lt;&gt; \"\"\n    Set a(1) = a(0).Offset(1)\n    Set a(2) = Nothing\n    While a(1)(1).Value &lt;&gt; \"\"\n      If a(0)(1).Value = a(1)(1).Value And a(0)(2).Value = a(1)(2).Value Then\n        a(0)(3).Value = a(0)(3).Value + a(1)(3).Value\n        a(0)(4).Value = a(0)(4).Value &amp; \" \" &amp; a(1)(4).Value\n        If a(2) Is Nothing Then\n          Set a(2) = a(1)\n        Else\n          Set a(2) = Union(a(2), a(1))\n        End If\n      End If\n      Set a(1) = a(1).Offset(1)\n    Wend\n    If Not a(2) Is Nothing Then a(2).EntireRow.Delete xlUp\n    Set a(0) = a(0).Offset(1)\n  Wend\nEnd Sub\n</code></pre>\n\n<p>Still, feel free to ask if any questions pop up ;)</p>\n"}], "owner": {"reputation": 57, "user_id": 3438614, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100002131602818/picture?type=large", "display_name": "Damanjeet Singh", "link": "https://stackoverflow.com/users/3438614/damanjeet-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 37571350, "answer_count": 1, "score": 0, "last_activity_date": 1464790776, "creation_date": 1464788612, "last_edit_date": 1464789317, "question_id": 37570508, "link": "https://stackoverflow.com/questions/37570508/how-to-un-flatten-data-in-vba", "title": "How to un-flatten data in VBA", "body": "<p>I am new to VBA and tried to find help on Google without success, Moreover, I don't have knowledge what to search for below problem.</p>\n\n<p>Below is an example of my worksheet which is required to un-flatten and it contains more than 2500 rows</p>\n\n<pre><code>  A   |   B    | C |   D\nText1 | Dummy1 | 1 | Power1\nText1 | Dummy1 | 1 | Power2\nText1 | Dummy2 | 1 | Power1\nText3 | Dummy3 | 1 | Power1\nText3 | Dummy3 | 1 | Power2\n</code></pre>\n\n<p>I am looking for the solution in VBA to get the result in below format</p>\n\n<pre><code>  A   |   B    | C |       D\nText1 | Dummy1 | 2 | Power1 Power2\nText1 | Dummy2 | 1 | Power1\nText3 | Dummy3 | 2 | Power1 Power2\n</code></pre>\n\n<p>If (A1,B1) is equal to (A2,B2), then count 1+1 and replace contents of D1 cell with D1+D2 (POWER1 and POWER2 (new line in same cell))</p>\n\n<p>I am wondering if anyone knows how to do this or what it's called?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "ms-access", "teradata"], "comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464791653, "post_id": 37570421, "comment_id": 62630736, "body": "Access is a DB, understands SQL. In what environment was the above code written?"}], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 225, "user_id": 4762935, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/963dbe70fc4cbea9c997f09516da70d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvik Banerjee", "link": "https://stackoverflow.com/users/4762935/nirvik-banerjee"}, "edited": false, "score": 0, "creation_date": 1464870009, "post_id": 37572342, "comment_id": 62668083, "body": "@nirvikbanerjee ,  First, I Like Parfait&#39;s approach, just note my comment, fix that point, I think that should work."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 225, "user_id": 4762935, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/963dbe70fc4cbea9c997f09516da70d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvik Banerjee", "link": "https://stackoverflow.com/users/4762935/nirvik-banerjee"}, "edited": false, "score": 0, "creation_date": 1464870382, "post_id": 37572342, "comment_id": 62668357, "body": "@nirvikbanerjee , Second, I usually use linked tables and/or dao... I found <a href=\"http://stackoverflow.com/questions/19257599/how-to-insert-several-fields-into-a-table-using-ado-when-two-of-the-fields-conta\">this answer here</a>. I&#39;ll modify my answer."}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 1, "last_activity_date": 1464871756, "last_edit_date": 1464871756, "creation_date": 1464793258, "answer_id": 37572342, "question_id": 37570421, "link": "https://stackoverflow.com/questions/37570421/how-do-i-import-data-from-a-teradata-table-to-ms-access-in-an-automated-way/37572342#37572342", "title": "How do I import data from a Teradata table to MS access in an automated way?", "body": "<p>Insert the data in the recordset into the Access table, using new recordset,  Connection and Command objects.</p>\n\n<pre><code>Sub TBEN_PR_DSM_SEAS()\n\n    Dim cn As ADODB.Connection\n    Set cn = New ADODB.Connection\n\n    Dim rs As ADODB.Recordset\n    Set rs = New ADODB.Recordset\n\n    Dim cmdSQLData As ADODB.Command\n    Set cmdSQLData = New ADODB.Command\n\n    Dim query As String\n\n    cn.Open \"DRIVER={Teradata}; DBCNAME=ABC2; Persist Security Info=True; User ID= ******; Password=******; Session Mode=ANSI;\"\n\n    Set cmdSQLData.ActiveConnection = cn\n    query = \"SELECT * FROM PRODBBYCIADHOCWRK.TBEN_PR_DSM_SEAS;\"\n    cmdSQLData.CommandText = query\n    cmdSQLData.CommandType = adCmdText\n    cmdSQLData.CommandTimeout = 0\n    Set rs = cmdSQLData.Execute()\n'Up to here is your code. \n'Asuming you have a table in Access with identical number of fields, and field names:\n    dim dRst as dao.Recordset, fld as Variant\n    set dRst = CurrentDb.(\"AccessTable\")\n    Do While Not Rs.EOF\n        dRst.AddNew\n        For Each fld in dRst.Fields\n            dRst.Fields(fld.Name) = rs.Fields(fld.Name)\n        Next \n        'Update an entire record:\n        dRst.Update\n    Rs.MoveNext: Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464810458, "post_id": 37575161, "comment_id": 62641924, "body": "Last parameter in TransferDatabase should also be <code>&quot;TBEN_PR_DSM_SEAS&quot;</code> so that linked table name is <code>[TBEN_PR_DSM_SEAS]</code>, not <code>NewAccessTable</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464811579, "post_id": 37575161, "comment_id": 62642543, "body": "That was to guide the OP on setup."}, {"owner": {"reputation": 225, "user_id": 4762935, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/963dbe70fc4cbea9c997f09516da70d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvik Banerjee", "link": "https://stackoverflow.com/users/4762935/nirvik-banerjee"}, "edited": false, "score": 0, "creation_date": 1464849715, "post_id": 37575161, "comment_id": 62654796, "body": "@Parfait thanks a lot for your response. I tried the DoCmd.TransferDatabase . But it prompts me to select the ID variables through the GUI in MS Access. Is this selection a one time thing? Ideally I want a code where I don&#39;t need to select anything through the Access GUI every time the table in Teradata changes"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1464872959, "post_id": 37575161, "comment_id": 62670390, "body": "That&#39;s because you do not have a primary key or any unique index in the Teradata table. Set that in table, add autonumber if needed, and try relinking again"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1464801909, "creation_date": 1464801909, "answer_id": 37575161, "question_id": 37570421, "link": "https://stackoverflow.com/questions/37570421/how-do-i-import-data-from-a-teradata-table-to-ms-access-in-an-automated-way/37575161#37575161", "title": "How do I import data from a Teradata table to MS access in an automated way?", "body": "<p>MS Access is an interesting piece of software as it can serve as both a RDMS database and GUI console to a database. By default, it connects to the Jet/ACE SQL Engine (Windows .dll files) which would compare to SQLite another file-level RDMS. However, with MSAccess.exe Office program, this default can be switched or supplemented with any other ODBC/OLEDB compliant database including the server-level RDMS (Oracle, SQL Server, MySQL, Sybase, even Teradata) using linked tables. And in connecting to external backends it would compare to MySQL's phpmyadmin, SQL Server's Management Studio, PostgreSQL's pgAdmin, and other consoles.</p>\n\n<p>Therefore, consider creating a linked table to Teradata using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196455.aspx\" rel=\"nofollow\">DoCmd.TransferDatabase</a> where changes reflect on both ends without constant import and export of table data:</p>\n\n<pre><code>DoCmd.TransferDatabase acLink, \"ODBC Database\", _\n    \"ODBC;DRIVER={Teradata}; DBCNAME=ABC2; Persist Security Info=True; User ID= ******;\" _\n     &amp; \"Password=******; Session Mode=ANSI;\", acTable, \"TBEN_PR_DSM_SEAS\", \"NewAccessTable\"\n</code></pre>\n\n<p>And for a static, local copy (which would add redundancy to your application needs) you can run an append or make-table query in Query Window or VBA's <code>DoCmd.RunSQL</code> or <code>CurrentDb.Execute</code> to a local Access table using above linked table. </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO NewAccessTable SELECT * FROM [TBEN_PR_DSM_SEAS]\n\nSELECT * INTO NewAccessTable FROM [TBEN_PR_DSM_SEAS]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4394003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba398f6ed6924d777ce90d64ac26ac8?s=128&d=identicon&r=PG&f=1", "display_name": "TestPilot10", "link": "https://stackoverflow.com/users/4394003/testpilot10"}, "is_accepted": false, "score": 0, "last_activity_date": 1504211417, "last_edit_date": 1504211417, "creation_date": 1504210606, "answer_id": 45989431, "question_id": 37570421, "link": "https://stackoverflow.com/questions/37570421/how-do-i-import-data-from-a-teradata-table-to-ms-access-in-an-automated-way/45989431#45989431", "title": "How do I import data from a Teradata table to MS access in an automated way?", "body": "<p>Tables are Sheets and Queries select Ranges.\nFields are Columns and Records are Rows.</p>\n\n<pre><code>'Loop through Records\nDo Until rs.EOF\n'rs.Fields(0) is the first field returned from the Teradata query \n'executed in your initial question.\n    Debug.Print rs.Fields(0)\n    rs.MoveNext\nLoop\n\n'Append to Table\n'Have to create Table1 in Access database. \n'Table1 \n'Field Name: Column1 \n'Data Type: Text\n\nIf rs.BOF = False Then rs.MoveFirst   'BOF = Beginning of file\n\nDoCmd.SetWarnings False\nDo Until rs.EOF   'EOF = End of file\n    DoCmd.RunSQL (\"INSERT INTO Table1 (Column1)  SELECT '\" &amp; rs.Fields(0) &amp;   \"'\")\n    rs.MoveNext\nLoop\nDoCmd.SetWarnings True\n\ncn.Close\nSet cn = Nothing\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 4762935, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/963dbe70fc4cbea9c997f09516da70d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvik Banerjee", "link": "https://stackoverflow.com/users/4762935/nirvik-banerjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2391, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1504211417, "creation_date": 1464788380, "last_edit_date": 1464799147, "question_id": 37570421, "link": "https://stackoverflow.com/questions/37570421/how-do-i-import-data-from-a-teradata-table-to-ms-access-in-an-automated-way", "title": "How do I import data from a Teradata table to MS access in an automated way?", "body": "<p>I am new to MS Access. I have been trying to import data from a Teradata table to MS Access database. I could establish the connection between the two using VBA. However, I am not being able to write the contents to the access database. </p>\n\n<p>For Excel, we generally use objects like sheets and range to populate the values. What are Access counterparts of these objects?</p>\n\n<p>Given below is the code that I have been using:</p>\n\n<pre><code>Sub TBEN_PR_DSM_SEAS()\n\n    Dim cn As ADODB.Connection\n    Set cn = New ADODB.Connection\n\n    Dim rs As ADODB.Recordset\n    Set rs = New ADODB.Recordset\n\n    Dim cmdSQLData As ADODB.Command\n    Set cmdSQLData = New ADODB.Command\n\n    Dim query As String\n\n    cn.Open \"DRIVER={Teradata}; DBCNAME=ABC2; Persist Security Info=True; User ID= ******; Password=******; Session Mode=ANSI;\"\n\n    Set cmdSQLData.ActiveConnection = cn\n    query = \"SELECT * FROM PRODBBYCIADHOCWRK.TBEN_PR_DSM_SEAS;\"\n    cmdSQLData.CommandText = query\n    cmdSQLData.CommandType = adCmdText\n    cmdSQLData.CommandTimeout = 0\n    Set rs = cmdSQLData.Execute()\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone please help me out with the rest of the part? I am using Access 2007-2010.</p>\n\n<p>Thanks and regards,\nNirvik</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1464788752, "post_id": 37570249, "comment_id": 62628374, "body": "Dropdown.value=.  All I think you can call the change event as if it was a sub"}, {"owner": {"reputation": 363, "user_id": 3206357, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/ljvuX.jpg?s=128&g=1", "display_name": "user3206357", "link": "https://stackoverflow.com/users/3206357/user3206357"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1464788931, "post_id": 37570249, "comment_id": 62628530, "body": "The dropdown is created using data validation option list. So I dont know the name of the dropdown."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1464790041, "post_id": 37570249, "comment_id": 62629428, "body": "AFAIK data validation drop downs cannot have a change event.  Is the event in VBA?  Can you post the code?"}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 3206357, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/ljvuX.jpg?s=128&g=1", "display_name": "user3206357", "link": "https://stackoverflow.com/users/3206357/user3206357"}, "edited": false, "score": 0, "creation_date": 1464839580, "post_id": 37570835, "comment_id": 62651086, "body": "I have to trigger an event while putting data in cell."}], "tags": [], "owner": {"reputation": 81, "user_id": 6409888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be97c16002e9c079b56069dbf5d7715?s=128&d=identicon&r=PG&f=1", "display_name": "Drinkwater32", "link": "https://stackoverflow.com/users/6409888/drinkwater32"}, "is_accepted": false, "score": 0, "last_activity_date": 1464789425, "creation_date": 1464789425, "answer_id": 37570835, "question_id": 37570249, "link": "https://stackoverflow.com/questions/37570249/select-given-value-from-list-in-cell/37570835#37570835", "title": "Select given value from list in cell", "body": "<p>If I understand your question correctly, you're looking for a way to get your code to run when you change value in the drop down? If so, give this a go.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Cell As Range\n\n    Set Cell = Range(\"YOUR DROP DOWN CELL\") 'or an entire range of cells\n\n    If Not Application.Intersect(Cell, Range(Target.Address)) Is Nothing Then\n        ' Your Code Here\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 3206357, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/ljvuX.jpg?s=128&g=1", "display_name": "user3206357", "link": "https://stackoverflow.com/users/3206357/user3206357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464789425, "creation_date": 1464787971, "last_edit_date": 1531164843, "question_id": 37570249, "link": "https://stackoverflow.com/questions/37570249/select-given-value-from-list-in-cell", "title": "Select given value from list in cell", "body": "<p>I am getting value of a payroll name in a variable. I have to set this payroll name in a list drop down cell. If I am just putting this payroll in the cell using</p>\n\n<pre><code>Worksheets(sectionName).Range(\"B\" &amp; rowCntr).Value = payroll \n</code></pre>\n\n<p>above code.The drop-down change event does not trigger and because of this the other calculated cell does not get populated. \nPlease suggest a way so that I can select the value from dropdown and dropdown change event get triggered.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 4163, "user_id": 4606130, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/343d4fbd72bc47b7ca8db0947a45b122?s=128&d=identicon&r=PG&f=1", "display_name": "micstr", "link": "https://stackoverflow.com/users/4606130/micstr"}, "edited": false, "score": 2, "creation_date": 1464787292, "post_id": 37569848, "comment_id": 62627106, "body": "You cell match line is not in your loop but uses <code>i</code>?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464787843, "post_id": 37569848, "comment_id": 62627583, "body": "Also your match function is just comparing one cell to another, but it looks like it&#39;s supposed to be checking a column rather than a cell..."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464790936, "post_id": 37569848, "comment_id": 62630186, "body": "You may not get error if you change your corresponding line to this ~cellmatch = Application.Match(Cells(i, &quot;A&quot;).Value, Worksheets(&quot;Sheet1&quot;).Columns(3), 0)~. I think @Macro Man has also pointed to the same shortcoming in your coding."}, {"owner": {"reputation": 23, "user_id": 6409569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7a0d0c9ea8fe68077336122b4fce35?s=128&d=identicon&r=PG&f=1", "display_name": "Rumble1701a", "link": "https://stackoverflow.com/users/6409569/rumble1701a"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464882930, "post_id": 37569848, "comment_id": 62678409, "body": "@MacroMan yes, it is supposed to be checking one cell against a column. It should be asking if the there is a cell in the column that matchs the active cell. If not, then it states so. Otherwise, it will state it as a &#39;-&#39;."}, {"owner": {"reputation": 23, "user_id": 6409569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7a0d0c9ea8fe68077336122b4fce35?s=128&d=identicon&r=PG&f=1", "display_name": "Rumble1701a", "link": "https://stackoverflow.com/users/6409569/rumble1701a"}, "reply_to_user": {"reputation": 4163, "user_id": 4606130, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/343d4fbd72bc47b7ca8db0947a45b122?s=128&d=identicon&r=PG&f=1", "display_name": "micstr", "link": "https://stackoverflow.com/users/4606130/micstr"}, "edited": false, "score": 0, "creation_date": 1464882969, "post_id": 37569848, "comment_id": 62678434, "body": "@micstr Oh Duh! Thanks. Yeah, that should have been in my FOR loop. :P I&#39;ll make that correction."}, {"owner": {"reputation": 23, "user_id": 6409569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7a0d0c9ea8fe68077336122b4fce35?s=128&d=identicon&r=PG&f=1", "display_name": "Rumble1701a", "link": "https://stackoverflow.com/users/6409569/rumble1701a"}, "edited": false, "score": 0, "creation_date": 1464884276, "post_id": 37569848, "comment_id": 62679280, "body": "These suggestions worked! I put the cellmatch into the FOR loop (Should have done that the first time, oops!), changed the if statement a bit and it now works as it should. Thank you all for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1464788624, "creation_date": 1464788624, "answer_id": 37570517, "question_id": 37569848, "link": "https://stackoverflow.com/questions/37569848/application-defined-or-object-defined-error/37570517#37570517", "title": "Application-defined or object defined error", "body": "<p>I believe this is what you are looking for:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton3_Click()\n\nDim lngRow As Long\nDim rngFound As Range\nDim lngLastRow As Long\nDim shtCurrent As Worksheet\n\n'Set the sheet to work on\nSet shtCurrent = ThisWorkbook.Worksheets(\"Sheet1\")\n\nWith shtCurrent\n    'Find the last row\n    lngLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    'Exit if the last row is 2 or smaller\n    If lngLastRow &lt;= 2 Then\n        MsgBox \"Nothing to compare!\" &amp; Chr(10) &amp; \"Aborting...\"\n        Exit Sub\n    End If\n\n    'Compare Raw Data cell to Stock column and find a match\n    For lngRow = 2 To lngLastRow\n        'Only compare if there is something in column A to compare\n        If .Cells(lngRow, \"A\").Value2 &lt;&gt; vbNullString Then\n            'This is the actual MATCH / FIND\n            Set rngFound = .Range(\"C:C\").Find(What:=.Cells(lngRow, \"A\").Value2, LookIn:=xlValues, LookAt:=xlWhole)\n            'Evaluate the result of the FIND = rngFound\n            If rngFound Is Nothing Then\n                .Cells(lngRow, 2).Value2 = \"Not in Stock\"                           'not found\n            Else\n                .Cells(lngRow, 2).Value2 = \"In stock in row \" &amp; rngFound.Row        'found\n            End If\n        End If\n    Next lngRow\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if you have and problems / questions.</p>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 1, "last_activity_date": 1464797507, "last_edit_date": 1464797507, "creation_date": 1464794031, "answer_id": 37572608, "question_id": 37569848, "link": "https://stackoverflow.com/questions/37569848/application-defined-or-object-defined-error/37572608#37572608", "title": "Application-defined or object defined error", "body": "<p>Your code requires change of this code line.</p>\n\n<pre><code> cellmatch = Application.Match(Cells(i, \"A\").Value, Range(Cells(i, \"C\")).Value, 0)\n</code></pre>\n\n<p><strong>TO</strong></p>\n\n<pre><code> 'Adjust Sheetname as per your requirements instead of \"Sheet1\"\n     cellmatch = Application.Match(Cells(i, \"A\").Value, Worksheets(\"Sheet1\").Columns(3), 0)\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Main problem is coming in your program because of the following code fragment.</p>\n\n<pre><code>Range(Cells(i, \"C\")).Value\n</code></pre>\n\n<p>If we refer to MSDN Documenation\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells Property (Excel)</a></p>\n\n<p>It mentions exammples of correct syntax of usage.\nTypical example is</p>\n\n<pre><code>Set r = Range(\"myRange\") \nFor n = 1 To r.Rows.Count \n    If r.Cells(n, 1) = r.Cells(n + 1, 1) Then \n        MsgBox \"Duplicate data in \" &amp; r.Cells(n + 1, 1).Address \n    End If \nNext n\n</code></pre>\n\n<p>So it translates to <code>Range(\"myRange\").Cells(n,1)</code><br>\n    <strong>and not</strong>        </p>\n\n<pre><code>Range(Cells(i, \"C\"))\n</code></pre>\n\n<p>It will give correct results as shown in the snapshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PJrON.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PJrON.jpg\" alt=\"Snapshot showing results\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 6409569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7a0d0c9ea8fe68077336122b4fce35?s=128&d=identicon&r=PG&f=1", "display_name": "Rumble1701a", "link": "https://stackoverflow.com/users/6409569/rumble1701a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2195, "favorite_count": 0, "accepted_answer_id": 37572608, "answer_count": 2, "score": 1, "last_activity_date": 1464797507, "creation_date": 1464786978, "last_edit_date": 1531164843, "question_id": 37569848, "link": "https://stackoverflow.com/questions/37569848/application-defined-or-object-defined-error", "title": "Application-defined or object defined error", "body": "<p>All,</p>\n\n<p>I am receiving the error \"Application defined or object defined error\" for a private sub that I have written. The code is below:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim MyLastRow As Long\nDim i As Long\nDim cellmatch\n\n'Find the last row\nMyLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Define our comparison\ncellmatch = Application.Match(Cells(i, \"A\").Value, Range(Cells(i, \"C\")).Value, 0)\n\n'Compare Raw Data cell to Stock column and find a match\nFor i = 2 To MyLastRow\n    If IsError(cellmatch) Then\n        Cells(i, 2) = \"Not in Stock\"\n    Else\n        Cells(i, 2) = \"-\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have tried several things I found on the forums such us specifying the worksheet </p>\n\n<pre><code>Application.WorksheetFuncion.Match.....\n</code></pre>\n\n<p>I've also tried point to the cell or range such as:</p>\n\n<pre><code>Range(.Cells(i,\"C\"))....\n</code></pre>\n\n<p>or\n    .Match(.Cells(i,\"A\"))...</p>\n\n<p>But I keep getting the same error. All of this is happening on the same sheet and I'm not trying to do anything fancy like copying. I am simply asking if a match is NOT found, then label as such, else, label it with a dash (done like this for clarity). I am sure it's something very simple but I am new to coding in VBA. Any help is much appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1464787200, "post_id": 37569781, "comment_id": 62627023, "body": "<code>AppActivate &quot;Role manager&quot;</code>brings the window to the front and sets focus to it"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464787987, "post_id": 37569781, "comment_id": 62627701, "body": "If <code>AppActivate()</code> doesn&#39;t do the trick then you&#39;ll have to look at using WinAPI"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464788338, "post_id": 37569781, "comment_id": 62627985, "body": "@gizmeier, excellent! upvoting where possible."}, {"owner": {"reputation": 11, "user_id": 5169476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309a0fba85e528a2018a8d7e8730e699?s=128&d=identicon&r=PG&f=1", "display_name": "Sukesh", "link": "https://stackoverflow.com/users/5169476/sukesh"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1464790667, "post_id": 37569781, "comment_id": 62629967, "body": "@gizlmeier AppActivate is working fine. Thank you!! How can i mark this Question as answered??"}, {"owner": {"reputation": 11, "user_id": 5169476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309a0fba85e528a2018a8d7e8730e699?s=128&d=identicon&r=PG&f=1", "display_name": "Sukesh", "link": "https://stackoverflow.com/users/5169476/sukesh"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464790758, "post_id": 37569781, "comment_id": 62630040, "body": "@MacroMan Thanks for your suggestion."}], "owner": {"reputation": 11, "user_id": 5169476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309a0fba85e528a2018a8d7e8730e699?s=128&d=identicon&r=PG&f=1", "display_name": "Sukesh", "link": "https://stackoverflow.com/users/5169476/sukesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1183, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1464786820, "creation_date": 1464786820, "question_id": 37569781, "link": "https://stackoverflow.com/questions/37569781/how-to-bring-a-window-to-foreground-using-window-captionexcel-vba", "title": "How to bring a window to foreground using window caption(Excel VBA)?", "body": "<p>Am working on Automating a Web application using Excel. Everything was going fine, till the moment i got struck with a window being in the background. </p>\n\n<p>A window with caption \"Role manager\" is open. How can i bring the window to foreground? </p>\n\n<p>Thanks in Advance!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1464783665, "post_id": 37568125, "comment_id": 62624044, "body": "in this post @Jeeped has also given his approach for coding this situation by first making myFilename string and the saving taking this in the path. Have you tried this approach."}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1464783808, "post_id": 37568125, "comment_id": 62624144, "body": "@skkakkar I tried to get that to run but that caused an error message (which was non-sensical when I looked it up) for me. I am rather new to this so I may have messed something up."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1464787480, "post_id": 37568125, "comment_id": 62627275, "body": "Does your <code>fName</code> have an extension to its filename?"}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1464787735, "post_id": 37568125, "comment_id": 62627500, "body": "@PeterT I am not sure if I follow your question, but all the files I want to convert have the same extention."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1464788127, "post_id": 37568125, "comment_id": 62627815, "body": "Then all you have to do is to strip the extension from the original filename and append .xlsx to get your new filename. As an example, if your filename is &quot;abc0123.xxx&quot; : <code>baseFName = left(fName, len(fName)-4)</code>, then <code>NewName = baseFName &amp; &quot;.xlsx&quot;</code>. Now you can <code>Activeworkbook.SaveAs Filename:=NewName</code>"}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1464789115, "post_id": 37568125, "comment_id": 62628676, "body": "@PeterT Thank you, the most simplest solution seems to be the best. That works lovely - first had a little error by my own fault but that works like a charm. On to the next step in the coding adventure. Hopefully, I can solve that one on my own."}], "owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1464788156, "creation_date": 1464782633, "last_edit_date": 1495542157, "question_id": 37568125, "link": "https://stackoverflow.com/questions/37568125/trying-to-convert-files-while-keeping-the-old-name", "title": "Trying to convert files while keeping the old name", "body": "<p>Hello Stackoverflow users,</p>\n\n<p>I am trying to convert files from a non-microsoft file into an excel</p>\n\n<p>I have managed with the following code: </p>\n\n<pre><code>Sub FastaToExcel()\n'\n' Macro\n'\n\n'\nfName = Application.GetOpenFilename()\n\nWorkbooks.OpenText Filename:=fName, Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote _\n    , ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n    TrailingMinusNumbers:=True\n\n    ActiveWorkbook.SaveAs Filename:=\"NewName.xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    ActiveWorkbook.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>To get files converted and renamed. This works and a nice shiny NexName.xlsx rolls out.</p>\n\n<p>However, in order to make the naming dynamic I tried the following code based on a post here (<a href=\"https://stackoverflow.com/questions/29874807/vba-excel-file-to-csv-keeps-csv-filename-same-as-original-workbook\">VBA Excel file to CSV, keeps CSV filename same as original workbook</a>):</p>\n\n<pre><code>Sub Macro1()\n    NewName = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 5)\n    ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\Username\\Desktop\\\" &amp; NewName &amp; \".csv\", , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    ActiveWorkbook.Close SaveChanges:=True\n End Sub\n</code></pre>\n\n<p>However, this does not work as the \"ActiveWorkbook.Name\" pulls the name of .xlsm file that has the macro in it to convert the files, and unfortunately does not use the name of non-windows format file of whom I want to keep the name and have it used for the new .xlsx file.</p>\n\n<p>Can anyone help me to tackle this problem? Much appreciated.</p>\n\n<p>[edit] I also tried with the code suggested by @Jeeped (as asked by @skkakkar) in the same topic creating this, but this hangs at ActiveWorkbook.SaveAs line:</p>\n\n<pre><code>Sub FastaToExcel()\n'\n' Macro\n'\n\n'\nfName = Application.GetOpenFilename()\n\nDim myPath As String, myFileName As String\n\nmyPath = \"C:\\Users\\\" &amp; Environ(\"USERNAME\") &amp; \"\\Desktop\\\"\nIf Not CBool(Len(Dir(myPath, vbDirectory))) Then MkDir Path:=myPath\nmyFileName = Left(ActiveWorkbook.Name, InStr(1, ActiveWorkbook.Name, \".xl\", vbTextCompare) - 1) &amp; \".fasta\"\n\nDebug.Print myPath &amp; Chr(92) &amp; myFileName\n\nWorkbooks.OpenText Filename:=fName, Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote _\n    , ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n    TrailingMinusNumbers:=True\n\n    ActiveWorkbook.SaveAs Filename:=myPath &amp; Chr(92) &amp; myFileName, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    ActiveWorkbook.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1464780920, "post_id": 37567433, "comment_id": 62622090, "body": "Take a closer look on your line <code>Open fileName 1 For Output as file1</code> and under this, you have again <code>Open fileName1</code> so maybe this can cause issue?"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1464781882, "creation_date": 1464781882, "answer_id": 37567847, "question_id": 37567433, "link": "https://stackoverflow.com/questions/37567433/writing-to-the-files-simultaneously-in-excel-macro/37567847#37567847", "title": "Writing to the files simultaneously in Excel Macro", "body": "<p><code>FreeFile()</code> returns the next file number available for opening. When you call it twice in a row like you did, it returns the same value (probably 1) in both cases since you haven't yet used the file number, making it still available for opening.</p>\n\n<p>Instead, you need to use that file number before you invoke <code>FreeFile()</code> again.</p>\n\n<p>Change </p>\n\n<pre><code>file1 = FreeFile()\nfile2 = FreeFile()\n\nOpen fileName1 For Output As file1\nOpen fileName2 For Output As file2\n</code></pre>\n\n<p>to</p>\n\n<pre><code>file1 = FreeFile()\nOpen fileName1 For Output As file1\n\nfile2 = FreeFile()\nOpen fileName2 For Output As file2\n</code></pre>\n\n<p>and it will work as expected.</p>\n"}], "owner": {"reputation": 186, "user_id": 3013022, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1f590b2b863e66ce3f2841823f15ad95?s=128&d=identicon&r=PG&f=1", "display_name": "user3013022", "link": "https://stackoverflow.com/users/3013022/user3013022"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 37567847, "answer_count": 1, "score": 0, "last_activity_date": 1464781882, "creation_date": 1464780705, "last_edit_date": 1464781006, "question_id": 37567433, "link": "https://stackoverflow.com/questions/37567433/writing-to-the-files-simultaneously-in-excel-macro", "title": "Writing to the files simultaneously in Excel Macro", "body": "<p>I am preparing excel macro to read data from Input file and output it to two different file depending on condition.</p>\n\n<p>Code Snippet as below</p>\n\n<pre><code>   fileName1=\"test1.txt\"\n   fileName2=\"test2.txt\"\n   file1 = FreeFile()\n   file2 = FreeFile()\n\n   Open fileName1 For Output As file1\n   Open fileName2 For Output As file2\n\n   If Condition1=true Then\n       sWrite1=\"Write to file 1\"\n       print #file1,sWrite1\n   Else\n       sWrite2=\"Write to file 2\"\n       print #file2,sWrite2\n   End If\n\n   Close #file1\n   Close #file2\n</code></pre>\n\n<p>Expected output is \"Write to file 1\" should go to file1 \nand \"Write to file 2\" should be to file2.</p>\n\n<p>But after running the macro ,\nboth \"Write to file 1\" and \"Write to file 2\" were written to file2 \nand file1 is empty.</p>\n\n<p>Can anyone please help me on how to write simultaneously to two files.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1465438092, "post_id": 37567173, "comment_id": 62904898, "body": "Regarding your point that worksheet restores when interaction takes place with Minimize , Maximize options. I would strictly advise you not to temper with system settings, However latest edit includes related code which interacts with windows API level."}], "answers": [{"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1464780632, "post_id": 37567317, "comment_id": 62621899, "body": "Thanks for your encouraging words."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464781863, "post_id": 37567317, "comment_id": 62622699, "body": "How would you prevent the window from being remaximized when the user wants to minimize it? When I just tried it <code>Application.Windowstate</code> returned <code>xlNormal</code> when I minimized the window."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1464782357, "last_edit_date": 1464782357, "creation_date": 1464780360, "answer_id": 37567317, "question_id": 37567173, "link": "https://stackoverflow.com/questions/37567173/display-always-full-screen-in-excel-with-vba/37567317#37567317", "title": "Display always full screen in excel with vba", "body": "<p>There is an event that you can trap I'd try adding this to your ThisWorkbook module</p>\n\n<pre><code>Option Explicit\n\nPrivate mbToggle As Boolean\nPrivate mlPriorState(-1 To 0) As XlWindowState\n\n\nPrivate Sub Workbook_WindowResize(ByVal Wn As Window)\n\n    mlPriorState(mbToggle) = Wn.WindowState\n    mbToggle = Not mbToggle\n\n    If Wn.WindowState = xlNormal And mlPriorState(mbToggle) &lt;&gt; xlMaximized Then\n        ActiveWindow.WindowState = xlMaximized\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Though this may only work on windows that represent the worksheet/workbook.  I'd try this first; other solutions involving Windows API  are way more complicated.</p>\n\n<p>Folded in some feedback.  This code works for me.</p>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464780487, "post_id": 37567339, "comment_id": 62621786, "body": "Good one @skkakkar"}, {"owner": {"reputation": 11, "user_id": 6409293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d9bd76cc93d952e2a25aa285e9084b?s=128&d=identicon&r=PG&f=1", "display_name": "Make Standard", "link": "https://stackoverflow.com/users/6409293/make-standard"}, "edited": false, "score": 0, "creation_date": 1465431510, "post_id": 37567339, "comment_id": 62903561, "body": "The code works fine, but it works only with the workbook changes (minimize/maximize) it is not working with Excel application minimize/maximize. As the main porpoise is that the user does not have access to the toolbar Home/Insert/PageLayout/Formulas/Datas..... any other option to hide it?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 11, "user_id": 6409293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d9bd76cc93d952e2a25aa285e9084b?s=128&d=identicon&r=PG&f=1", "display_name": "Make Standard", "link": "https://stackoverflow.com/users/6409293/make-standard"}, "edited": false, "score": 0, "creation_date": 1465435943, "post_id": 37567339, "comment_id": 62904503, "body": "@Make Standard I do have access to such routines, but experts advise very strongly not to use any routine which tempers minimize or maximize button as you can permanently lose these buttons."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1465437744, "last_edit_date": 1465437744, "creation_date": 1464780425, "answer_id": 37567339, "question_id": 37567173, "link": "https://stackoverflow.com/questions/37567173/display-always-full-screen-in-excel-with-vba/37567339#37567339", "title": "Display always full screen in excel with vba", "body": "<p>Workbook_Activate will bring full screen mode while other will bring back normal mode.</p>\n\n<pre><code>Private Sub Workbook_Activate()\n    On Error Resume Next\n    With Application\n        .DisplayFullScreen = True\n        .CommandBars(\"Worksheet Menu Bar\").Enabled = False\n    End With\n\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n    On Error Resume Next\n    With Application\n        .DisplayFullScreen = False\n        .CommandBars(\"Worksheet Menu Bar\").Enabled = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nyou shouldn't 'modify' the way Windows works at a system level. However, if you really, really must; add the following to a new module and call the SetStyle procedure.</p>\n\n<p><strong>That code is offered <em>UNTESTED</em>'as is' - the API is a way to modify Windows at a system level and can be dangerous (sudden crashes, data file corruption...) if you do not know what you are doing.</strong>   </p>\n\n<p>VB:</p>\n\n<pre><code>Option Explicit \n\n 'Related Windows API functions\nPrivate Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long) As Long \nPrivate Declare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long \nPrivate Declare Function GetSystemMenu Lib \"user32\" (ByVal hWnd As Long, ByVal bRevert As Long) As Long \nPrivate Declare Function DeleteMenu Lib \"user32\" (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As Long) As Long \nPrivate Declare Function DrawMenuBar Lib \"user32\" (ByVal hWnd As Long) As Long \nPrivate Declare Function SetFocus Lib \"user32\" (ByVal hWnd As Long) As Long \nPrivate Declare Function LockWindowUpdate Lib \"user32\" (ByVal hWndLock As Long) As Long \n\n 'Window style constants\nPrivate Const GWL_STYLE As Long = (-16) '// The offset of a window's style\nPrivate Const GWL_EXSTYLE As Long = (-20) '// The offset of a window's extended style\nPrivate Const WS_CAPTION As Long = &amp;HC00000 '// Title bar bit\nPrivate Const WS_SYSMENU As Long = &amp;H80000 '// System menu bit\nPrivate Const WS_THICKFRAME As Long = &amp;H40000 '// Sizable frame bit\nPrivate Const WS_MINIMIZEBOX As Long = &amp;H20000 '// Minimize box bit\nPrivate Const WS_MAXIMIZEBOX As Long = &amp;H10000 '// Maximize box bit\nPrivate Const WS_EX_TOOLWINDOW As Long = &amp;H80 '// Tool Window: small titlebar bit\n\n 'Constant to identify the Close menu item\nPrivate Const SC_CLOSE As Long = &amp;HF060 \n\n\nPublic Sub SetStyle() \n\n    Dim lStyle As Long, hMenu As Long \n\n     'Get the basic window style\n    lStyle = GetWindowLong(Application.hWnd, GWL_STYLE) \n\n    If lStyle = 0 Then \n        MsgBox \"Unable to determine application window handle...\", vbExclamation, \"Error\" \n        Exit Sub \n    End If \n\n     '// Build up the basic window style flags for the form\n     '// Uncomment the features you want...\n     '// Set it True to enable, FALSE to disable\n     '// The first 2 are obvious, ThickFrame controls if the Window is sizable or not.\n\n     '// SetBit lStyle, WS_CAPTION, True\n     '// SetBit lStyle, WS_SYSMENU, False\n     '// SetBit lStyle, WS_THICKFRAME, False\n    SetBit lStyle, WS_MINIMIZEBOX, False \n    SetBit lStyle, WS_MAXIMIZEBOX, False \n\n     'Set the basic window styles\n    SetWindowLong Application.hWnd, GWL_STYLE, lStyle \n\n     'Get the extended window style\n    lStyle = GetWindowLong(Application.hWnd, GWL_EXSTYLE) \n\n\n     '// Handle the close button differently\n     '// If Close button is wanted\n     '// hMenu = GetSystemMenu(Application.hWnd, 1)\n\n     '// Not wanted - delete it from the control menu\n    hMenu = GetSystemMenu(Application.hWnd, 0) \n    DeleteMenu hMenu, SC_CLOSE, 0&amp; \n\n\n     'Update the window with the changes\n    DrawMenuBar Application.hWnd \n    SetFocus Application.hWnd \n\nEnd Sub \n\n\n '// Set or clear a bit from a style flag\nPrivate Sub SetBit(ByRef lStyle As Long, ByVal lBit As Long, ByVal bOn As Boolean) \n\n    If bOn Then \n        lStyle = lStyle Or lBit \n    Else \n        lStyle = lStyle And Not lBit \n    End If \n\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6488745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16714bdca3651204f151559788597ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic Sherry", "link": "https://stackoverflow.com/users/6488745/dominic-sherry"}, "is_accepted": false, "score": 1, "last_activity_date": 1470335165, "creation_date": 1470335165, "answer_id": 38774796, "question_id": 37567173, "link": "https://stackoverflow.com/questions/37567173/display-always-full-screen-in-excel-with-vba/38774796#38774796", "title": "Display always full screen in excel with vba", "body": "<p>Paste this into the workbook module. It will maximize the windows whenever it gets resized:</p>\n\n<pre><code>Private Sub Workbook_WindowResize(ByVal Wn As Window)\n    ActiveWindow.WindowState = xlMaximized\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6409293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d9bd76cc93d952e2a25aa285e9084b?s=128&d=identicon&r=PG&f=1", "display_name": "Make Standard", "link": "https://stackoverflow.com/users/6409293/make-standard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10698, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1470335165, "creation_date": 1464779943, "question_id": 37567173, "link": "https://stackoverflow.com/questions/37567173/display-always-full-screen-in-excel-with-vba", "title": "Display always full screen in excel with vba", "body": "<p>I want that my excel xml always display in full screen view.</p>\n\n<p>For this I code the next:</p>\n\n<pre><code>    Private Sub Workbook_Open()\n          Application.WindowState = xlMaximized\n          ActiveWindow.WindowState = xlMaximized\n          Application.DisplayFullScreen = True\n    End Sub\n</code></pre>\n\n<p>It is working fine until I minimize excel, once I maximize again It shows in normal view mode, how to proceed? Any suggestion? The main idea is to remove the tool bars as I don't want user to interact with them.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464780151, "post_id": 37567027, "comment_id": 62621572, "body": "@R.Michael - I am getting result properly, check the format of your cell range."}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464780815, "post_id": 37567027, "comment_id": 62622018, "body": "i did new sheet, add still not working. What do you mean by cell range exactly"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464781025, "post_id": 37567027, "comment_id": 62622149, "body": "@R.Michael - By saying cell range I mean the range where your data is being copied."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464781103, "post_id": 37567027, "comment_id": 62622195, "body": "@R.Michael - Will you be able to share your sheet so that I can look into it."}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464781431, "post_id": 37567027, "comment_id": 62622407, "body": "its same like yours Mrig :/"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464781868, "post_id": 37567027, "comment_id": 62622702, "body": "@R.Michael - Not the code, I would like to see the sheet for formatting."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464781911, "post_id": 37567027, "comment_id": 62622739, "body": "@R.Michael - One more thing, do not post anything as answer unless it really is an answer."}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464782170, "post_id": 37567027, "comment_id": 62622923, "body": "Yeah but i cannot post code because here is characters limit :/"}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464782444, "post_id": 37567027, "comment_id": 62623126, "body": "Ok how i can show u that? because i dont realy know what u asking for xd?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464782597, "post_id": 37567027, "comment_id": 62623251, "body": "@R.Michael - You can share your file online and put the link here."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464783746, "post_id": 37567027, "comment_id": 62624103, "body": "@R.Michael - Okay!"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464785335, "post_id": 37567027, "comment_id": 62625400, "body": "@R.Michael - Not sure why it&#39;s not working at your end. Let me see if I can get it to work using some other method."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464785790, "post_id": 37567027, "comment_id": 62625806, "body": "@R.Michael - Your shared file working fine for me. Anyhow, Great that you solved your problem."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464785850, "post_id": 37567027, "comment_id": 62625861, "body": "@R.Michael - Delete the other code that you posted as an answer. (the one that&#39;s not working)"}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464787299, "post_id": 37567027, "comment_id": 62627117, "body": "I just make bigger delay ( i think it&#39;s delay:  Application.Wait Now + TimeSerial(0, 0, 5) ) and working ^^. Probably bad connection."}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464798344, "post_id": 37567027, "comment_id": 62635322, "body": "i tried with other page and not working aswell could u make some descriptions under each line i have to edit ? :P"}, {"owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464854541, "post_id": 37567027, "comment_id": 62657505, "body": "i think, it&#39;s scrap to fast. :p because sometimes when connection is good i receive full data."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464854674, "post_id": 37567027, "comment_id": 62657592, "body": "@R.Michael - Then it&#39;s better to increase the time here <code>Application.Wait Now + TimeSerial(0, 0, 2)</code>"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "edited": false, "score": 0, "creation_date": 1464855024, "post_id": 37567027, "comment_id": 62657822, "body": "@R.Michael - If my answer solved your issue here kindly mark it as an answer."}, {"owner": {"reputation": 61, "user_id": 12450313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W7FGE.png?s=128&g=1", "display_name": "TCritical", "link": "https://stackoverflow.com/users/12450313/tcritical"}, "edited": false, "score": 0, "creation_date": 1598622012, "post_id": 37567027, "comment_id": 112527097, "body": "@Mrig, Thank you soo much Mrig, your code was perfect and helped me a lot. Thanks once again. I gave up vote to this awesome code."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 1, "last_activity_date": 1464851734, "last_edit_date": 1464851734, "creation_date": 1464779564, "answer_id": 37567027, "question_id": 37566827, "link": "https://stackoverflow.com/questions/37566827/how-to-scrape-table-data-in-excel-vba/37567027#37567027", "title": "How to scrape table data in Excel/VBA?", "body": "<p>Why not use the same method as in your last question:</p>\n\n<pre><code>Sub Tester()\n\n    Dim IE As Object\n    Dim tbl, trs, tr, tds, td, r, c\n\n    Set IE = CreateObject(\"internetexplorer.application\")\n\n    IE.Navigate \"https://exchange.btcc.com/\"\n\n    Do While IE.Busy = True Or IE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    Set tbl = IE.Document.getElementsByTagName(\"table\")(5)\n    Set trs = tbl.getElementsByTagName(\"tr\")\n\n    For r = 0 To trs.Length - 1\n        Set tds = trs(r).getElementsByTagName(\"td\")\n        If tds.Length = 0 Then Set tds = trs(r).getElementsByTagName(\"th\")\n\n        For c = 0 To tds.Length - 1\n            ActiveSheet.Range(\"A1\").Offset(r, c).Value = tds(c).innerText\n        Next c\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>This will give you result as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CjEHc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CjEHc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 6403008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/92a534ea252a016fda1bce768cbe03c1?s=128&d=identicon&r=PG&f=1", "display_name": "R. Michael", "link": "https://stackoverflow.com/users/6403008/r-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547008637, "creation_date": 1464778993, "last_edit_date": 1547008637, "question_id": 37566827, "link": "https://stackoverflow.com/questions/37566827/how-to-scrape-table-data-in-excel-vba", "title": "How to scrape table data in Excel/VBA?", "body": "<p>The page is coded in <code>html5</code> and my code cannot scrape with this method:</p>\n\n<pre><code>Sub Macro1()\n With ActiveSheet.QueryTables.Add(Connection:= _\n \u201cURL;https://exchange.btcc.com/\u201d, Destination:=Range(\u201c$A$1\u2033))\n .Name = \u201cmarket_trend\u201d\n .FieldNames = True\n .RowNumbers = False\n .FillAdjacentFormulas = False\n .PreserveFormatting = True\n .RefreshOnFileOpen = False\n .BackgroundQuery = True\n .RefreshStyle = xlInsertDeleteCells\n .SavePassword = False\n .SaveData = True\n .AdjustColumnWidth = True\n .RefreshPeriod = 0\n .WebSelectionType = xlSpecifiedTables\n .WebFormatting = xlWebFormattingNone\n .WebTables = \u201c4\u2033\n .WebPreFormattedTextToColumns = True\n .WebConsecutiveDelimitersAsOne = True\n .WebSingleBlockTextImport = False\n .WebDisableDateRecognition = False\n .WebDisableRedirections = False\n .Refresh BackgroundQuery:=False\n End With`\n End Sub\n</code></pre>\n\n<p>Any idea how to scrape Price Ticker table from this site ? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464779327, "post_id": 37566655, "comment_id": 62620969, "body": "So the destination is different, right?  Looks like in the code the destination is computed as <code>lastRow</code>, right?  Can you try using a debug print on the value, so <code>Debug.Print lastRow</code>?  Also do you need to use ActiveSheet, I&#39;d pin that sucker down with a name so <code>ThisWorkbook.Worksheets(&quot;foo&quot;)</code>."}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464779782, "post_id": 37566655, "comment_id": 62621289, "body": "Yes the destination is different. Yes, its is computed as the lastRow, as I want the imported data to appear at the last row within the column range and not at the top rows in the column range. So, I presume the run/sub user button in the vba editor, even though it does what I want the code is still wrong if the macro button does something different? I will make the changes you suggested and see what happens."}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464781138, "post_id": 37566655, "comment_id": 62622233, "body": "Unfortunately, I am still getting the same results."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1464781813, "post_id": 37566655, "comment_id": 62622662, "body": "Swap thisWS for ActiveSheet."}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1464782654, "post_id": 37566655, "comment_id": 62623298, "body": "@S Meaden, Thank you! It works now. So, it was a small tweak that did it. But one needs the experience to know where to look. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1464781854, "creation_date": 1464781854, "answer_id": 37567834, "question_id": 37566655, "link": "https://stackoverflow.com/questions/37566655/command-button-and-run-sub-user-form-button-not-in-sync/37567834#37567834", "title": "Command button and run/sub user form button not in sync", "body": "<p>Did you try changing <strong>thisworkbook</strong> to <strong>workbooks(\"workbook name\")</strong>?</p>\n"}], "owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464781854, "creation_date": 1464778491, "question_id": 37566655, "link": "https://stackoverflow.com/questions/37566655/command-button-and-run-sub-user-form-button-not-in-sync", "title": "Command button and run/sub user form button not in sync", "body": "<p>on my excel sheet, I have a command button (GrabMyData) which grabs, copies data onto a workbook (thisWB). Now when I press this command button, the data appears on the 'top rows' of the column. However, on the excel VBA editor, when I press the run/sub userform play button, the data comes to the 'last rows' of data on the column, which is what I want. So, why is my command button not doing what the run/sub play button is doing? I thought they both do the same function. Please note, I have correctly assigned the macro command button to the relevant work book. Please advise.</p>\n\n<pre><code>Sub GrabMyData()\n  Dim myWB As Workbook\n  Dim thisWB As Workbook\n  Dim thisWS As Worksheet\n  Dim lastRow As String\n\n  Application.ScreenUpdating = False\n\n  Set myWB =  Workbooks.Open(\"C:\\Users\\jjordan\\Local\\Microsoft\\Windows\\Temporary Internet Files\\Content.Outlook\\GTER232\\TEST.csv\")\n\n  myWB.Sheets(\"Sheet 1\").Range(\"A8:F17\").Copy\n\n  Set thisWB = ThisWorkbook\n  Set thisWS = ThisWorkbook.Sheets(\"Sheet 5\")\n\n  thisWB.Activate\n\n  lastRow = ActiveSheet.Cells(Rows.Count, \"H\").End(xlUp).Row\n\n  thisWS.Range(\"H\" &amp; lastRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nWith Application\n    .CutCopyMode = False\n    .ScreenUpdating = True\n  End With\n\n myWB.Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 1322, "user_id": 2693146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KTITg.jpg?s=128&g=1", "display_name": "Isiah Meadows", "link": "https://stackoverflow.com/users/2693146/isiah-meadows"}, "edited": false, "score": 0, "creation_date": 1464781799, "post_id": 37566443, "comment_id": 62622647, "body": "What have you tried? None of us can help you unless I have something to work with, in particular a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example (MCVE)</a>. A great way to explain this is to include the code you&#39;ve written so far, example input (if there is any), the expected output, and the output you actually get (console output, tracebacks, etc.). The more detail you provide, the more answers you are likely to receive. Also, do check out the <a href=\"http://meta.stackexchange.com/q/7931\">FAQ</a> and <a href=\"https://stackoverflow.com/help/asking\">ask</a>."}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464786511, "post_id": 37566443, "comment_id": 62626418, "body": "It says that FilterMenu isnt available"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464787293, "post_id": 37566443, "comment_id": 62627109, "body": "That&#39;s actually the field within the report where i wanted the Filter to appear. I got this working in my form but no mather what i do it won&#39;t work in reports"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464788207, "post_id": 37566443, "comment_id": 62627890, "body": "When i click on to the field it jumps into the DateFilter. The Date get&#39;s selected and the Filter Appears"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464788492, "post_id": 37566443, "comment_id": 62628133, "body": "yes it should be ... as i said it works exactly this way in my form but not in the report"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464788744, "post_id": 37566443, "comment_id": 62628361, "body": "Your report includes a control named <code>Bezeichnungsfeld26</code> and when the user clicks in that control, you want to bring up the filter menu for that control.  Is that correct?"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464788834, "post_id": 37566443, "comment_id": 62628439, "body": "yes that&#39;s what it should do"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464781107, "post_id": 37567331, "comment_id": 62622198, "body": "Do i write this in code for example in the onclick for a field?  Or is this in the propertys of the field?"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464784155, "post_id": 37567331, "comment_id": 62624383, "body": "ok well this didnt worked either ... do you know how to work with shortcut menus? maybe i can try this i would create a new question because i tried already something but still having issues with that"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464788671, "post_id": 37567331, "comment_id": 62628299, "body": "The code will work, so your implementation is probably fuzzy. Shortcut menus don&#39;t work in the runtime environment, if I recall correctly."}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464789068, "post_id": 37567331, "comment_id": 62628641, "body": "i tried to check for a specific data for example because thats the only thing i need to filter for example with today, tomorrow, yesterday and also select dates like the form filter provides ....   so i added this to my reports onopen <code>DoCmd.OpenReport &quot;Tagesbericht&quot;, acViewPreview, , &quot;[DateFilter] = &quot; &amp; 01.06.2016&amp; &quot;&quot;</code>   this wasnt working? and istn this opening the report in preview mode with the filter? i wouldn&#39;t need it that way because i&#39;m having a navigationform with tabs that include my form and 3 reports"}, {"owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "edited": false, "score": 0, "creation_date": 1464789713, "post_id": 37567331, "comment_id": 62629154, "body": "i got it working with a shortcutmenu it works even in runtime"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464793564, "last_edit_date": 1464793564, "creation_date": 1464780399, "answer_id": 37567331, "question_id": 37566443, "link": "https://stackoverflow.com/questions/37566443/ms-access-filter-reports-in-runtime-mode/37567331#37567331", "title": "Ms Access filter reports in runtime mode", "body": "<p>You can use the <em>Filter</em> property:</p>\n\n<pre><code>Me.Filter = \"[YourField] = \" &amp; somevalue &amp; \"\"\nMe.FilterOn = True\n</code></pre>\n\n<p>or, to expand on your current method:</p>\n\n<pre><code>DoCmd.OpenReport \"Tagesbericht\", acViewPreview, , \"[YourField] = \" &amp; somevalue &amp; \"\"\n</code></pre>\n\n<p>If you filter for a date you must pass a properly formatted string expression for the date:</p>\n\n<pre><code>Dim FilterDate As Date\n\nFilterDate = Date\n\nDoCmd.OpenReport \"Tagesbericht\", acViewPreview, , \"[DateFilter] = #\" &amp; Format(FilterDate, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1464789078, "creation_date": 1464789078, "answer_id": 37570710, "question_id": 37566443, "link": "https://stackoverflow.com/questions/37566443/ms-access-filter-reports-in-runtime-mode/37570710#37570710", "title": "Ms Access filter reports in runtime mode", "body": "<p>You confirmed your report includes a control named <code>Bezeichnungsfeld26</code> and when the user clicks in that control, you want to bring up the filter menu for that control.</p>\n\n<p>When the user clicks in that control, it has the focus, so there is no need for <code>GoToControl</code>.  And you don't want to go to a different control if you want the user to filter on <code>Bezeichnungsfeld26</code>.</p>\n\n<p>Disable the <code>GoToControl</code> line ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Bezeichnungsfeld26_Click()\n'DoCmd.GoToControl \"DateFilter\"\nDoCmd.RunCommand acCmdFilterMenu\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4527647, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/827726500619406/picture?type=large", "display_name": "idunnowhatimdoin", "link": "https://stackoverflow.com/users/4527647/idunnowhatimdoin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 37570710, "answer_count": 2, "score": 1, "last_activity_date": 1464793564, "creation_date": 1464777914, "last_edit_date": 1464789388, "question_id": 37566443, "link": "https://stackoverflow.com/questions/37566443/ms-access-filter-reports-in-runtime-mode", "title": "Ms Access filter reports in runtime mode", "body": "<p>Does anyone knows how to filter reports the right way within Access runtime mode? \nThe usual code with <code>DoCmd</code> doesn't work. </p>\n\n<p>This is what I tried for the report:</p>\n\n<pre><code>Private Sub Befehl217_Click()\nDoCmd.OpenReport \"Tagesbericht\", acViewPreview\nEnd Sub\n\nPrivate Sub Bezeichnungsfeld26_Click()\nDoCmd.GoToControl \"DateFilter\"\nDoCmd.RunCommand acCmdFilterMenu\nEnd Sub\n</code></pre>\n\n<p>This didn't work. Access complained that <em>\"FilterMenu isn't available\"</em>.</p>\n\n<p>I tried to create a context menu but this only displayed me cut, copy and paste.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "is_accepted": true, "score": 0, "last_activity_date": 1465195432, "creation_date": 1465195432, "answer_id": 37651041, "question_id": 37566343, "link": "https://stackoverflow.com/questions/37566343/delete-table-row-from-filtered-listobject/37651041#37651041", "title": "Delete table row from filtered ListObject", "body": "<p>I figured it out.</p>\n\n<p>You have to call the row this way</p>\n\n<pre><code>ActiveCell.ListObject.Range.EntireRow(ActiveCell.Row - ActiveCell.ListObject.HeaderRowRange.Row + 1).Delete\n</code></pre>\n\n<p>Even if filtered, the right row will be deleted. (Same thing for <code>.Select</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 1, "last_activity_date": 1536159358, "creation_date": 1536159358, "answer_id": 52188178, "question_id": 37566343, "link": "https://stackoverflow.com/questions/37566343/delete-table-row-from-filtered-listobject/52188178#52188178", "title": "Delete table row from filtered ListObject", "body": "<p>If it is already filtered, you can try this:</p>\n\n<p><code>ActiveSheet.ListObjects([Table_Name]).DataBodyRange.EntireRow.Delete</code></p>\n"}], "owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "accepted_answer_id": 37651041, "answer_count": 2, "score": 0, "last_activity_date": 1585679818, "creation_date": 1464777677, "last_edit_date": 1585679818, "question_id": 37566343, "link": "https://stackoverflow.com/questions/37566343/delete-table-row-from-filtered-listobject", "title": "Delete table row from filtered ListObject", "body": "<p>I am trying to delete an entire row from a Table (ListObject), but I have issues adressing the Row.\nFollowing code works prefect when the table is not filtered:</p>\n\n<pre><code>Sub loeschen()\n\nIf errorhandling Then On Error GoTo fehlerbehandlung\n\n    ActiveCell.ListObject.ListRows(ActiveCell.Row - ActiveCell.ListObject.HeaderRowRange.Row).Delete\n\nExit Sub\nfehlerbehandlung:\nfehlermeldung\n\nEnd Sub\n</code></pre>\n\n<p>Filtering is done by user in Excel, not VBA. Is there a direct way to delete a row or do I have to unfilter it? And if that's the case, how do I filter it again the same way (the user shouldn't notice anything, I'll apply <code>Application.ScreenUpdating</code>if necessary.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464779074, "post_id": 37565979, "comment_id": 62620778, "body": "&quot;Not working&quot; is not sufficiently descriptive, please tell what error is thrown."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 2, "creation_date": 1464779483, "post_id": 37565979, "comment_id": 62621073, "body": "Remove <code>On Error Resume Next</code> and see what it does. This tells it to just keep going if there&#39;s an error instead of pausing and notifying you."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464779524, "post_id": 37565979, "comment_id": 62621098, "body": "@arcadeprecinct: ah!  yes, good idea!"}, {"owner": {"reputation": 17, "user_id": 6350375, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-99v43Cm_CEI/AAAAAAAAAAI/AAAAAAAAJd4/7ozyLu_2gZ0/photo.jpg?sz=128", "display_name": "Shaun Allan", "link": "https://stackoverflow.com/users/6350375/shaun-allan"}, "edited": false, "score": 0, "creation_date": 1464849484, "post_id": 37565979, "comment_id": 62654664, "body": "Hi S Meaden.  There&#39;s no error.  It just doesn&#39;t paste anything as it&#39;s meant to.  Using PasteAppendTable twice, as I&#39;d prefer to, makes both PasteAppendTable commands not work (as in not paste anything) too, which is why I use Paste once and PasteAppendTable once.  But now Paste doesn&#39;t do anything."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1465423456, "creation_date": 1465423456, "answer_id": 37713738, "question_id": 37565979, "link": "https://stackoverflow.com/questions/37565979/paste-not-working-between-excel-and-word-through-vba/37713738#37713738", "title": "Paste not working between Excel and Word through VBA", "body": "<p>I think DocVariables are easier to use that Bookmarks.  Do a quick Google search on Word DocVariables.  Get things setup correct in Word, and then run the script below.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"FirstName\").Value = Range(\"FirstName\").Value\nobjWord.ActiveDocument.variables(\"LastName\").Value = Range(\"LastName\").Value\nobjWord.ActiveDocument.variables(\"AnotherVariable\").Value = Range(\"AnotherVariable\").Value\n\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6350375, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-99v43Cm_CEI/AAAAAAAAAAI/AAAAAAAAJd4/7ozyLu_2gZ0/photo.jpg?sz=128", "display_name": "Shaun Allan", "link": "https://stackoverflow.com/users/6350375/shaun-allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465423456, "creation_date": 1464776691, "question_id": 37565979, "link": "https://stackoverflow.com/questions/37565979/paste-not-working-between-excel-and-word-through-vba", "title": "Paste not working between Excel and Word through VBA", "body": "<p>I have a workbook which creates Word reports based on a Word template and tables in the workbook.</p>\n\n<p>Depending on the equipment type, it copies a range from the spreadsheet and pastes it to two bookmark locations in the word document (bmInternal and bmExternal). I tried using PasteAppendTable, but this only works once. If I try to use it twice, for each bookmark, it copies nothing both times. As such I used Paste for one and PasteAppendTable for the second (PasteAppendTable is much neater as the formatting is better).</p>\n\n<p>This worked fine, but I made changes to the code, not related to this, and now the Paste (which goes to bmInternal) isn't working. I can't see why when I've not changed anything regarding that part:</p>\n\n<pre><code>Sub Data2Word()\n\nApplication.GoTo Reference:=ActiveSheet.Range(\"A2\")\n\nGoAgain:\nOn Error Resume Next\nDim vItem As String\n'Dim vImagePath As String\n\nDim vCurrentRow As Integer\n\nDim vDesc As String\nDim vN2 As String\nDim vGuide As String\nDim vUnit As String\nDim vBlock As String\n\nDim wrdPic As Word.InlineShape\nDim rng As Excel.Range                    'our source range\nDim rngText As Variant\nDim rngText2 As Variant\n\nDim wdApp As New Word.Application   'a new instance of Word\nDim wdDoc As Word.Document          'our new Word template\nDim myWordFile As String            'path to Word template\nDim wsExcel As Worksheet\nDim tmpAut\n\n'Find Item and type\nvItem = ActiveCell.Value\nvDesc = ActiveCell.Offset(0, 2)\nvN2 = ActiveCell.Offset(0, 1)\nvGuide = ActiveCell.Offset(0, 3)\nvBlock = ActiveCell.Offset(0, 4)\nvUnit = Left(vItem, 3)\n\nIf ActiveSheet.Range(\"rngREPORTED\") = \"Yes\" Then\n    MsgBox vItem &amp; \" already has a report.\"\n    Exit Sub\nEnd If\n'initialize the Word template path\n'here, it's set to be in the same directory as our source workbook\nmyWordFile = \"W:\\Entity\\Inspect\\WORD\\INSPECTION TEMPLATES\\Inspection Template - 20160511.dotx\"\n\n'open a new word document from the template\nSet wdDoc = wdApp.Documents.Add(myWordFile)\n\nIf vGuide = \"IGE01\" Then\n\n    rngText = \"rngEXCH\"\n    rngText2 = \"rngEXCHE\"\n\nElseIf ActiveCell.Offset(, 4) = \"Mono\" Then\n\n    'Do Mono\n    rngText = \"rngMONO\"\n\nElse\n\n        ActiveWorkbook.Names.Add Name:=\"rngItemSub\", RefersTo:=Worksheets(\"SubEquipment\").Range(\"B\" &amp; ActiveCell.Offset(0, 6) &amp; \":C\" &amp; ActiveCell.Offset(0, 7) + ActiveCell.Offset(0, 6))\n\nCarryOn:\n        rngText = \"rngItemSub\"\n\nEnd If\n\n'Insert Tables\n'get the range of the data\n\nSet rng = Range(rngText)\nrng.Copy                            'copy the range\n\nwdDoc.Bookmarks(\"bmInternal\").Range.Paste 'AppendTable\n\nIf vGuide = \"IGE01\" Then\n    Set rng = Range(rngText2)\n    rng.Copy\nEnd If\n\nwdDoc.Bookmarks(\"bmExternal\").Range.PasteAppendTable\n\nwdDoc.Bookmarks(\"bmItem\").Range.InsertAfter vItem\nwdDoc.Bookmarks(\"bmDesc\").Range.InsertAfter vDesc\nwdDoc.Bookmarks(\"bmN2\").Range.InsertAfter vN2\nwdDoc.Bookmarks(\"bmGuide\").Range.InsertAfter vGuide\nwdDoc.Bookmarks(\"bmBlock\").Range.InsertAfter vBlock\n\nwdDoc.Variables(\"wvItem\").Value = vItem\nActiveDocument.Fields.Update\n\nWith wdDoc\n        Set wrdPic = .Bookmarks(\"bmImage\").Range.InlineShapes.AddOLEObject(ClassType:=\"AcroExch.Document.7\", Filename:=\"W:\\Entity\\Inspect\\T&amp;I\\2016\\Various Items\\Photos\\Sorted\\\" &amp; vItem &amp; \".pdf\", LinkToFile:=False, DisplayAsIcon:=False)\n        wrdPic.ScaleHeight = 55\n        wrdPic.ScaleWidth = 55\nEnd With\n\nwdApp.Visible = True\n\nwdApp.Activate\n\nwdDoc.SaveAs \"W:\\Entity\\Inspect\\WSDATA\\REPORTS\\2016\\\" &amp; vUnit &amp; \"\\\" &amp; vItem &amp; \" \" &amp; vN2 &amp; \" THO.docx\" 'Mid(ActiveDocument.Name, 1, Len(ActiveDocument.Name) - 4)\n\nMoveHere:\n\nActiveWorkbook.Sheets(\"AllItems\").Range(\"G\" &amp; ActiveCell.Offset(0, 8)).Value = \"Yes\"\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1464778063, "post_id": 37565937, "comment_id": 62620009, "body": "Will the number of products also vary?"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1464778443, "creation_date": 1464778443, "answer_id": 37566629, "question_id": 37565937, "link": "https://stackoverflow.com/questions/37565937/dynamic-maximum-y-axis-scale-using-vba-excel/37566629#37566629", "title": "Dynamic Maximum Y Axis Scale using VBA Excel?", "body": "<p>Write the following lines at the beginning of your code:</p>\n\n<pre><code>Range(\"A2\").Select\nDim lastColumn As Long, lastRow As Long, max As Long\n\nlastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = ActiveSheet.Cells(2, Columns.Count).End(xlToLeft).Column\nmax = WorksheetFunction.max(Range(Cells(3, lastColumn), Cells(lastRow, lastColumn)))\n</code></pre>\n\n<p>This will give you <code>max</code> of totals, then you can write:</p>\n\n<pre><code>ActiveChart.Axes(xlValue).MaximumScale = max + 1\n</code></pre>\n"}], "owner": {"reputation": 1787, "user_id": 5260732, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8e8af64633954605cb7ec80abdd68cc4?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/5260732/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 0, "accepted_answer_id": 37566629, "answer_count": 1, "score": 0, "last_activity_date": 1464778443, "creation_date": 1464776574, "last_edit_date": 1464776945, "question_id": 37565937, "link": "https://stackoverflow.com/questions/37565937/dynamic-maximum-y-axis-scale-using-vba-excel", "title": "Dynamic Maximum Y Axis Scale using VBA Excel?", "body": "<p>I am not sure how to set the Y-Axis maximum in VBA for a bar chart created using the following data table:\n<a href=\"https://i.stack.imgur.com/ztCnG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ztCnG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The data table will be dynamically changing (more Features or fewer features), so I would like the Y-Axis maximum to be set to a value that is 1 greater than the max of the <code>Total</code>.  Also, the <code>Total</code> column may be changing in it's location as well, so I can't set it to the max of the <code>Total</code> column.</p>\n\n<p>My current code for the bar chart is as follows:</p>\n\n<pre><code>Sub Create_BarChart()\n\n    Range(\"A2\").Select\n    Dim lastColumn As Long\n    lastColumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Range(ActiveCell, Cells(ActiveCell.End(xlDown).Row, ActiveCell.End(xlToRight).Column)).Select\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlColumnStacked\n    ActiveChart.PlotBy = xlColumns\n    ActiveChart.SetElement (msoElementDataLabelCenter)\n' Format the data labels of the Total\n    ActiveChart.SeriesCollection(\"Total\").Format.Fill.Visible = msoFalse\n    ActiveChart.SeriesCollection(\"Total\").DataLabels.Font.Bold = True\n    ActiveChart.SeriesCollection(\"Total\").DataLabels.Select\n    ActiveChart.Legend.LegendEntries(1).Font.Bold = True\n    Selection.Position = xlLabelPositionInsideBase\n\n' Set the maximum and minimum values of the y-axis\n    ' ActiveChart.Axes(xlValue).MaximumScale = Application.WorksheetFunction.(Columns(lastColumn))\n    ActiveChart.Axes(xlValue).MinimumScale = 0\n    ActiveChart.Axes(xlValue).MaximumScale = ?????????????????\n\n' Change the size of the Chart\n    Dim Chart As ChartObject\n\nFor Each Chart In ActiveSheet.ChartObjects\n\nWith Chart.Parent\n\n' change the numbers in the below brackets (5) to change the size of the chart. Here we are using inches to set the chart size.\nChart.Height = Application.InchesToPoints(2.5)\nChart.Width = Application.InchesToPoints(5)\n\nEnd With\n\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/u3P75.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u3P75.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "focus", "startup"], "comments": [{"owner": {"reputation": 183, "user_id": 1924393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/znvn8.jpg?s=128&g=1", "display_name": "Peter M Taylor", "link": "https://stackoverflow.com/users/1924393/peter-m-taylor"}, "edited": false, "score": 0, "creation_date": 1464777950, "post_id": 37565827, "comment_id": 62619945, "body": "Alt-F11 is the short cut key for swtiching to VBA regardless of Word/Excel/Powerpoint and this would be the focus."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464779482, "post_id": 37565827, "comment_id": 62621071, "body": "Why is this a problem?  What is the undesirable behaviour please?"}, {"owner": {"reputation": 151, "user_id": 3690557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff289674406b83050d87bf70df6bf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/3690557/markus"}, "edited": false, "score": 0, "creation_date": 1465209783, "post_id": 37565827, "comment_id": 62789766, "body": "When you launch an application you expect it to be in focus, i.e. ready to input data without a prior click on its window. Update: - Repairing Excel installation did not solve the problem - Disabling the Solver add-in solved the problem - when re-enabling the Solver add-in, the problem is back again."}], "owner": {"reputation": 151, "user_id": 3690557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff289674406b83050d87bf70df6bf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/3690557/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1464776250, "creation_date": 1464776250, "question_id": 37565827, "link": "https://stackoverflow.com/questions/37565827/focus-on-invisible-vba-after-excel-start", "title": "Focus on invisible VBA after Excel start", "body": "<p>When launching Excel 2010 via the Start menu, the Excel window opens and shows an empty workbook, but the window does <strong>not</strong> have the focus. Thanks to a tool called WindowsFocusLogger I was able to verify that the Excel <strong>task</strong> does have the focus.</p>\n\n<p>More or less by chance I then found that by typing <strong>ALT-F11</strong>, the focus moves to the visible Excel window. So the focus was on the invisible VBA window right after launching Excel. Since some time, this happens with every Excel startup.</p>\n\n<p>My Normal.dotm template does not contain any code. Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1464775531, "post_id": 37565301, "comment_id": 62618230, "body": "Are you aware of the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278584%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">VBA function</a> <code>IsDate</code>?"}, {"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464777130, "post_id": 37565301, "comment_id": 62619336, "body": "Yes, Im aware of it."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1464793569, "post_id": 37565301, "comment_id": 62632163, "body": "a user may input 05/01/2016 which he/she meant 5-Jan-2016 but your userform will interpret as 1-May-2016. Avoid all the anomaly, let user input in any format they like but always change entered date into &#39;dd-mmm-yyyy` format. Excel can recognize the localized format and change them to your preferred format accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464776281, "post_id": 37565711, "comment_id": 62618729, "body": "The OP mentioned the use of a form. Are you sure that <code>.NumberFormat</code> is available on which ever control the OP is using in his/her form?"}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1464775922, "creation_date": 1464775922, "answer_id": 37565711, "question_id": 37565301, "link": "https://stackoverflow.com/questions/37565301/validating-date-format/37565711#37565711", "title": "Validating date format", "body": "<p>The <code>CDate(dateValue)</code> part of your function will simply return 'dateValue' as a <code>Date</code>. Use the <code>.Numberformat</code> property to get the format:</p>\n\n<pre><code>Function dateCheck(dateValue As Date) As Boolean\n    If dateValue.NumberFormat &lt;&gt; \"mm/dd/yyyy\" Then\n        MsgBox \"Please use the mm/dd/yyyy  date format!\"\n        dateCheck = True\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "edited": false, "score": 0, "creation_date": 1464779590, "post_id": 37566706, "comment_id": 62621155, "body": "Yes, this works if the user inputs a valid date. But if not, it returns error. Can we just try to use On error Resume Next Statement to handle the error? But I don&#39;t know how to imply it. It&#39;s just my idea."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "edited": false, "score": 0, "creation_date": 1464780127, "post_id": 37566706, "comment_id": 62621553, "body": "The function should always return <code>True</code> or <code>False</code> and not an error. At least this is what I get here. Yet, I am aware that the above is a very simplistic (as mentioned before) approach and does not cover many cases. Creating a sophisticated date-validation function including many different international date formats and other conveniences (such as the following dates <code>05&#47;19</code> auto-completes to <code>05&#47;19&#47;2016</code> and <code>-7</code> will automatically revert to the date one week ago) will require a lot more VBA coding."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464794183, "post_id": 37566706, "comment_id": 62632602, "body": "To make it a bit more internationally compatible you can use <code>&quot;mm\\&#47;dd\\&#47;yyyy&quot;</code> instead of <code>&quot;mm&#47;dd&#47;yyyy&quot;</code> as argument for <code>Format</code>. It then forces the <code>&#47;</code>s. On my system <code>Format</code> replaces <code>&#47;</code> with <code>.</code> if I use <code>&quot;mm&#47;dd&#47;yyyy&quot;</code>(which is a bad thing to do imo)."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1464778651, "creation_date": 1464778651, "answer_id": 37566706, "question_id": 37565301, "link": "https://stackoverflow.com/questions/37565301/validating-date-format/37566706#37566706", "title": "Validating date format", "body": "<p>The problem is that your question is compounded. There are actually two steps involved to your question:</p>\n\n<ol>\n<li>Is <code>txtStartDate</code> actually a valid date?</li>\n<li>If it is a date, is it formatted correctly?</li>\n</ol>\n\n<p>The naming of <code>txtStartDate</code> implies that you are getting a date as a text (in a form). Yet, you are passing it to your function with the assumption that <code>txtStartDate</code> is actually a date. This becomes obvious because the function <code>dateCheck</code> expects a date: <code>Function dateCheck(dateValue As Date) As Boolean</code>. </p>\n\n<p>So, here is a solution proposal to solve both at once:</p>\n\n<pre><code>Sub tmpTest()\n\nDim txtStartDate As String\n\ntxtStartDate = \"11/20/2015\"\n\nDebug.Print dateCheck(txtStartDate)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Function dateCheck(dateValue As String) As Boolean\n\nIf IIf(IsDate(txtStartDate), Format(CDate(txtStartDate), \"mm/dd/yyyy\"), \"\") = dateValue Then dateCheck = True\n\nEnd Function\n</code></pre>\n\n<p>Keep in mind that this is a very simplistic approach which will not work for international date formats. In fact, you might have to adjust it a bit as I do not have your date format. If you need something more sophisticated then you will have to write a bit more VBA code (including an extensive validation function). </p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464812639, "post_id": 37572050, "comment_id": 62643070, "body": "@kruk22: did you try this?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1465286490, "post_id": 37572050, "comment_id": 62824868, "body": "@kruk22: it&#39;d be nice from you to give feedback on attempts at helping you"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540810954, "post_id": 37572050, "comment_id": 92987430, "body": "This certainly is the closest answer. The only issue I have with it is that a valid mm/dd/yyyy date should be able to contain a 3-digit year, you should check length of the year parameter instead. E.g. in your function, 12/1/0900 is invalid, and 12/1.5/002002.8 is valid."}, {"owner": {"reputation": 395, "user_id": 2877774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddb93752b0652f724dbc0641b8846f07?s=128&d=identicon&r=PG&f=1", "display_name": "shubhraj", "link": "https://stackoverflow.com/users/2877774/shubhraj"}, "edited": false, "score": 0, "creation_date": 1556735138, "post_id": 37572050, "comment_id": 98534963, "body": "@user3598756 Added another if condition to set the start year  to 1950 when working on my code."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1464792533, "creation_date": 1464792533, "answer_id": 37572050, "question_id": 37565301, "link": "https://stackoverflow.com/questions/37565301/validating-date-format/37572050#37572050", "title": "Validating date format", "body": "<pre><code>Function dateCheck(dateStrng As String) As Boolean\nDim dateArr as Variant \n\nIf IsDate(dateStrng) Then ' &lt;~~ if it IS a date\n   dateArr = Split(dateStrng,\"/\")\n   If UBound(dateArr) = 2 Then '&lt;~~ if it has three substrings separate by two \"slashes\"\n      If CInt(dateArr(0)) &lt; 13 Then  '&lt;~~ if the 1st number is lower or equals the maximum possible month number\n         If CInt(dateArr(0)) &gt; 0 Then  '&lt;~~ if the 1st number is higher or equals the mimimum possible month number\n            If CInt(dateArr(1)) &lt; 31 Then  '&lt;~~ if the 2nd number is lower or equals the maximum possible day number\n               If CInt(dateArr(1)) &gt; 0 Then  '&lt;~~ if the 2nd number is higher or equals the mimimum possible day number\n                  If CInt(dateArr(2)) &lt; 10000 Then dateCheck = CInt(dateArr(2)) &gt; 999  '&lt;~~ if the 3rd number is a 4 digit integer \"year\" number, then check returns True\n               End If\n            End If\n         End If\n      End If\n   End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33225, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1516597171, "creation_date": 1464774883, "last_edit_date": 1531164843, "question_id": 37565301, "link": "https://stackoverflow.com/questions/37565301/validating-date-format", "title": "Validating date format", "body": "<p>Anybody knows how to validate date format in the format of <code>mm/dd/yyyy</code>.\nI have tried this code but is not working.</p>\n\n<p>In the userform:</p>\n\n<pre><code>dateCheck (txtStartDate)\n</code></pre>\n\n<p>In module:</p>\n\n<pre><code>Function dateCheck(dateValue As Date) As Boolean\n    If CDate(dateValue) &lt;&gt; \"mm/dd/yyyy\" Then\n        MsgBox \"Please use the mm/dd/yyyy  date format!\"\n        dateCheck = True\n    End If\nEnd Function\n</code></pre>\n\n<p>Am I on the right track? Thanks!</p>\n"}, {"tags": ["excel", "vba", "if-statement", "udf"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1464774515, "post_id": 37564915, "comment_id": 62617509, "body": "If your If is a one liner(If, Then, Else in one line) you don&#39;t need an End If"}, {"owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 0, "creation_date": 1464774591, "post_id": 37564915, "comment_id": 62617565, "body": "Copy the actual code so we can see it better. You can do 1 line if statements. If it&#39;s on a single line, it doesn&#39;t need end if - but the for cycle is not part of the if. In short, the for cycle will run either way. If it&#39;s multiple lines, then it needs a end if."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1464775629, "post_id": 37564915, "comment_id": 62618296, "body": "All this is fully described in the VBA Help.  Have you read it?"}], "answers": [{"comments": [{"owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "edited": false, "score": 0, "creation_date": 1531700427, "post_id": 37565518, "comment_id": 89678962, "body": "This answer is incorrect and should be deleted. MutjayLee has the correct answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 6403232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0a91978fda675c4b628935f9024303?s=128&d=identicon&r=PG&f=1", "display_name": "Duncan", "link": "https://stackoverflow.com/users/6403232/duncan"}, "is_accepted": false, "score": -1, "last_activity_date": 1464776334, "last_edit_date": 1464776334, "creation_date": 1464775395, "answer_id": 37565518, "question_id": 37564915, "link": "https://stackoverflow.com/questions/37564915/if-then-else-excel-vba-end-if-needed/37565518#37565518", "title": "If then Else Excel VBA - &quot;End If&quot; needed?", "body": "<p>Yes, you need the End If statement or you will get an error.</p>\n\n<p>It is only when your If statement is a one-liner that you don't need it, like:</p>\n\n<pre><code>If 1 = 1# Then result = \"true\"\n</code></pre>\n\n<p>but:</p>\n\n<pre><code>If 1 = 1# Then\n    result = \"true\"\n</code></pre>\n\n<p>doesn't work unless it is closed out with End If like this:</p>\n\n<pre><code>If 1 = 1# Then\n    result = \"true\"\nEnd If\n</code></pre>\n\n<p>Can't see exactly how you structured your function, but if it works without End If, then I guess it is a valid one-liner If statement or you have On Error Resume Next somewhere in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": true, "score": 4, "last_activity_date": 1464777040, "last_edit_date": 1464777040, "creation_date": 1464776720, "answer_id": 37565990, "question_id": 37564915, "link": "https://stackoverflow.com/questions/37564915/if-then-else-excel-vba-end-if-needed/37565990#37565990", "title": "If then Else Excel VBA - &quot;End If&quot; needed?", "body": "<p>If you put IF THEN ELSE in one line, then the if condition ends on that line and next line will be executed no matter what.</p>\n\n<p>For example,</p>\n\n<pre><code>If true then x =1 else x = 2\ny = 1\n</code></pre>\n\n<p>this case </p>\n\n<p>if true, x will be 1 and y will be 1</p>\n\n<p>if false, x will be 2 and y will be 1</p>\n\n<hr>\n\n<pre><code>if true then\n    x = 1\nelse\n    x = 2\n    y = 1\nend if\n</code></pre>\n\n<p>this case, </p>\n\n<p>if true, x will be 1 and y will be empty</p>\n\n<p>if false, x will be 2 and y will be 1</p>\n\n<hr>\n\n<p>In addition, if you do</p>\n\n<pre><code>If true then x = 1 else \nx = 2\n</code></pre>\n\n<p>x will always be 2 no matter true or false</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 5737966, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207297520308823/picture?type=large", "display_name": "Na Nonthasen", "link": "https://stackoverflow.com/users/5737966/na-nonthasen"}, "is_accepted": false, "score": 0, "last_activity_date": 1539357935, "creation_date": 1539357935, "answer_id": 52782651, "question_id": 37564915, "link": "https://stackoverflow.com/questions/37564915/if-then-else-excel-vba-end-if-needed/52782651#52782651", "title": "If then Else Excel VBA - &quot;End If&quot; needed?", "body": "<p>If you don't want END IF, but still want IF, ELSE IF, ELSE, just write all in single line.<br>\nUse \":\" for multiple actions.</p>\n\n<pre><code>Sub test(Optional x As Long)\n\n    If x &lt; 0 Then MsgBox \"x&lt;0\" Else If x = 0 Then MsgBox \"x=0\": MsgBox \"I told ya x=0\" Else MsgBox \"x&gt;0\": MsgBox \"I told ya x&gt;0\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6361425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020f7ff21bc7474e3a5553b066a6fbb0?s=128&d=identicon&r=PG&f=1", "display_name": "LaH", "link": "https://stackoverflow.com/users/6361425/lah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25079, "favorite_count": 3, "accepted_answer_id": 37565990, "answer_count": 3, "score": -1, "last_activity_date": 1539357935, "creation_date": 1464773945, "last_edit_date": 1464774822, "question_id": 37564915, "link": "https://stackoverflow.com/questions/37564915/if-then-else-excel-vba-end-if-needed", "title": "If then Else Excel VBA - &quot;End If&quot; needed?", "body": "<p>so I m writing a UDF in Excel vba of the kind:</p>\n\n<p><code>function ...\nif ... then ... else \nfor i... to ...\nequations\n...\nnext i\n*\nend function</code></p>\n\n<p>Now I noticed, that the function seems to work just fine, however I was wondering whether I shouldnt be using an \"end if\" at the position of (*) in the code? If I do, I receive an error msg stating there was no if corresponding IF to that \"end if\" block, though!? So in general, isn't there a Need for an \"end if\" in if then else constructions ? Thanks in advance! </p>\n\n<p>/edit: 'if ... then ... else' is a one liner. However the else block does contain multiple lines and in particular a loop...</p>\n"}, {"tags": ["excel", "jenkins", "vba"], "comments": [{"owner": {"reputation": 10072, "user_id": 390177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/35c4fca93ae71eb4429af2efb2b00e56?s=128&d=identicon&r=PG", "display_name": "CSchulz", "link": "https://stackoverflow.com/users/390177/cschulz"}, "edited": false, "score": 1, "creation_date": 1464777966, "post_id": 37564187, "comment_id": 62619958, "body": "How do you call the macro? Edit your question and add it."}, {"owner": {"reputation": 11285, "user_id": 1744774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e3xZV.png?s=128&g=1", "display_name": "Gerold Broser", "link": "https://stackoverflow.com/users/1744774/gerold-broser"}, "edited": false, "score": 0, "creation_date": 1464779227, "post_id": 37564187, "comment_id": 62620896, "body": "Please add the relevant parts of the Jenkins build console log, as well."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1465423571, "creation_date": 1465423571, "answer_id": 37713761, "question_id": 37564187, "link": "https://stackoverflow.com/questions/37564187/scheduling-excel-macro-using-jenkins/37713761#37713761", "title": "Scheduling Excel macro using Jenkins", "body": "<p>This sounds like a permissioning issue.  I have no idea what 'Jenkins' is, but I think you should make sure it has Administrator rights.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6323561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e1fc239b3f7c712c5e356a02e745c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Banerjee", "link": "https://stackoverflow.com/users/6323561/abhinav-banerjee"}, "is_accepted": true, "score": 0, "last_activity_date": 1465523310, "last_edit_date": 1465523310, "creation_date": 1465522653, "answer_id": 37738678, "question_id": 37564187, "link": "https://stackoverflow.com/questions/37564187/scheduling-excel-macro-using-jenkins/37738678#37738678", "title": "Scheduling Excel macro using Jenkins", "body": "<p>Found the solution . </p>\n\n<p>write a powershell file with contents -:</p>\n\n<p>**</p>\n\n<pre><code>$macroBook = \".\\Excel.xlsm\"\n$procedureName = \"Macro\"\n$macroBookFullPath = (ls $macroBook).FullName\n$macroProcName = (ls $macroBook).Name + \"!\" + $procedureName\n\n$excelApp = New-Object -com \"Excel.Application\"\n\ntry {\n\n    $excelApp.DisplayAlerts = $false\n    $excelApp.Workbooks.Open($macroBookFullPath)\n    $excelApp.Run($macroProcName)\n} finally {\n\n    $excelApp.DisplayAlerts = $false\n    $excelApp.Quit()\n}\n</code></pre>\n\n<p>**</p>\n\n<p>You would need powershell plugin for Jenkins . Follow the steps \n1. Add build step \"Windows Powershell\"\n2. Write this command - \"mkdir C:\\Windows\\system32\\config\\systemprofile\\Desktop\"\n3. Execute the powershell file (.ps1) by using \"./\" as a powershell step (\"./Powershell_Test.ps1\")\nThen go your merry way. </p>\n"}], "owner": {"reputation": 3, "user_id": 6323561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e1fc239b3f7c712c5e356a02e745c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Banerjee", "link": "https://stackoverflow.com/users/6323561/abhinav-banerjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3024, "favorite_count": 0, "accepted_answer_id": 37738678, "answer_count": 2, "score": -3, "last_activity_date": 1488951345, "creation_date": 1464772115, "last_edit_date": 1531164843, "question_id": 37564187, "link": "https://stackoverflow.com/questions/37564187/scheduling-excel-macro-using-jenkins", "title": "Scheduling Excel macro using Jenkins", "body": "<p>A <code>vbs</code> file has been written that calls an Excel macro. However, when this <code>vbs</code> file is scheduled using Jenkins, the macro is not executed, though the console shows a success message.</p>\n\n<p>Please suggest if there is some other way for scheduling Excel macro using Jenkins. vbs file code is this:</p>\n\n<pre><code>Option Explicit\n\nOn Error Resume Next\n\nExcelMacroExample\n\nSub ExcelMacroExample() \n\n  Dim xlApp \n  Dim xlBook \n\n  Set xlApp = CreateObject(\"Excel.Application\") \n  Set xlBook = xlApp.Workbooks.Open(\"C:\\Demo\\Migration\\Compare_Tool_For_Demo.xlsm\", 0, True) \n  xlApp.Application.Run \"Compare_Tool_For_Demo.xlsm!OpenSupport2Tool\"\n  xlApp.Quit \n\n  Set xlBook = Nothing \n  Set xlApp = Nothing \n\nEnd Sub \n</code></pre>\n\n<p><strong>Jenkins build command :-</strong>\n<code>call \"C:\\Demo\\Migration\\Start_Report_Tool_For_Demo.bat</code></p>\n\n<p>Macro operations are executed perfectly when the <code>vbs</code> file is executed manually. However whenever executed from Jenkins, it does not work.(Console shows \"SUCCESS\" however)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464783214, "post_id": 37563981, "comment_id": 62623725, "body": "the column E formula checks current string in B and picks the one in D which does match and shows it. This way it will be aligned by column B (which is obvious and makes sense). how to know that &quot;beta&quot; needs to be in row 5 instead of row 4?"}, {"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464872805, "post_id": 37563981, "comment_id": 62670265, "body": "mmm..I do not know, I was wondering what solution could be adopted"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464875200, "post_id": 37563981, "comment_id": 62672199, "body": "if you can not give a reason for that, how to code it? also, the <code>#VALUE</code> is due to the fact that column B is empty at row 6... there is nothing to find ^^;"}, {"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464875643, "post_id": 37563981, "comment_id": 62672521, "body": "I know this Dirk, but I try to find a script solution that fix this <code>#VALUE</code> problem correcting position of strings in column E. Formula it is not enough. Have you got any idea? I&#39;m not a programmer so..my ideas end here..sorry. I try to find a simple solution with excel, but I see that it is not possible. What do you think?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464878434, "post_id": 37563981, "comment_id": 62674915, "body": "and again... how to know WHERE the text needs to be? the is no code which looks at your sheet and pushes the data around like you think it will look better... you need strict reasons for each action"}, {"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464879285, "post_id": 37563981, "comment_id": 62675624, "body": "alignment must following same <code>LINK</code> and It should value the same function as a loop. Loop because function must look at the alignment with the neighboring column, in our case is the D until <code>http:&#47;&#47;beta.com</code> link is on the same row level. They could take more steps, but eventually you have to get to an array. P.S: each link of start column (B) is unique"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "edited": false, "score": 0, "creation_date": 1464898525, "post_id": 37596336, "comment_id": 62687433, "body": "you are very near to solution, but your formula reorder position only. Is possible to replace on column E prefix of column D with prefixes of column B? e.g <code>&lt;title&gt;http:&#47;&#47;alfa.com</code> where <code>&lt;title&gt;</code> is prefix of column D but in column E I want see <code>jackhttp:&#47;&#47;alfa.com</code> Alignment is perfect but not prefixes before <code>http:&#47;&#47;</code> If you want I can close this answer and open new with a new question"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "edited": false, "score": 0, "creation_date": 1464898609, "post_id": 37596336, "comment_id": 62687478, "body": "So you want the values from column B matched to the vales of column D... simply the opposite of your original formula"}, {"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "edited": false, "score": 0, "creation_date": 1464911182, "post_id": 37596336, "comment_id": 62692328, "body": "something you missing in your <code>EDIT</code> formula. It return me <code>#VALUE!</code> like strings but position is correct."}, {"owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "edited": false, "score": 0, "creation_date": 1464911499, "post_id": 37596336, "comment_id": 62692402, "body": "you are a master. Answer Solved, Thanks. Nice to meet you."}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1464911297, "last_edit_date": 1464911297, "creation_date": 1464881858, "answer_id": 37596336, "question_id": 37563981, "link": "https://stackoverflow.com/questions/37563981/value-align-cell-position-missing-excel/37596336#37596336", "title": "#VALUE! align cell position missing (excel)", "body": "<p>Simply put in E3:</p>\n\n<pre><code>=IF(D3&lt;&gt;\"\",INDEX(D:D,MATCH(\"*\"&amp;MID(INDEX($B$3:$B$6,COUNTIF($D$3:$D3,\"&lt;&gt;\")),SEARCH(\"http://\",INDEX($B$3:$B$6,COUNTIF($D$3:$D3,\"&lt;&gt;\"))),999),D:D,0)),\"\")\n</code></pre>\n\n<p>and copy down. this is NOT an array formula.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If I got you right, then all you want is to flip over the original formula...</p>\n\n<pre><code>=IF(D3=\"\",\"\",INDEX(B:B,MATCH(\"*\" &amp; MID(D3,SEARCH(\"http://\",D3),999),B:B,0)))\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3520363, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34951814127fd5ec8548c3314899cbad?s=128&d=identicon&r=PG&f=1", "display_name": "user3520363", "link": "https://stackoverflow.com/users/3520363/user3520363"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37596336, "answer_count": 1, "score": 0, "last_activity_date": 1464911297, "creation_date": 1464771502, "last_edit_date": 1531161705, "question_id": 37563981, "link": "https://stackoverflow.com/questions/37563981/value-align-cell-position-missing-excel", "title": "#VALUE! align cell position missing (excel)", "body": "<p>I use this formula to align cells like here </p>\n\n<p><a href=\"https://i.stack.imgur.com/E7BiX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E7BiX.png\" alt=\"enter image description here\"></a>\n<br>I put this formula in <strong>E3</strong> and then I press CTRL+SHIFT+ENTER</p>\n\n<pre><code>=INDEX($D$3:$D$6,MATCH(\"*\" &amp; MID(B3,SEARCH(\"http\",B3),99),$D$3:$D$6,0))\n</code></pre>\n\n<p>The formula stops at the first step, but does not consider that the function that values do not align correctly, that is what I seek. \nif I change position of cells of column D formula return me this error:</p>\n\n<pre><code>#VALUE! \n</code></pre>\n\n<p>Look this pic, please: </p>\n\n<p><a href=\"https://i.stack.imgur.com/bdK5k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bdK5k.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there any solution to correct position of cells of <strong>column E</strong> with column D <strong>after</strong> first formula alignment between B-D?</p>\n\n<p><strong>Note</strong>: alignment must following same LINK and It should value the same function as a loop. Loop because function must look at the alignment with the neighboring column, in our case is the D until e.g <code>http://beta.com</code> link is on the same row level. They could take more steps, but eventually you have to get to an array. P.S: each link of start column (B) is unique</p>\n"}, {"tags": ["vba", "excel", "gradient", "linear-gradients"], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1464772556, "post_id": 37564180, "comment_id": 62616061, "body": "I think this might not even be a code issue.  I just closed and reopened the document after having changed the code you suggested and formatted a test area, and the colors changed from when I formatted it (going from white to dark red) to when I reopened the file (now going from desired red to blue).  Any ideas?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1464773070, "post_id": 37564180, "comment_id": 62616470, "body": "Tried to add image links but couldn&#39;t, so here they are:   <a href=\"http://i.imgur.com/rwQcqvT.png\" rel=\"nofollow noreferrer\">After formatting</a>  <a href=\"http://i.imgur.com/8tLgT0m.png\" rel=\"nofollow noreferrer\">After reopening</a>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1464773543, "post_id": 37564180, "comment_id": 62616789, "body": "Sorry, can&#39;t reproduce your problem using Excel 2007. It works as expected even after closing and reopening."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1464772586, "last_edit_date": 1464772586, "creation_date": 1464772096, "answer_id": 37564180, "question_id": 37563899, "link": "https://stackoverflow.com/questions/37563899/gradient-colors-changing-unexpectedly/37564180#37564180", "title": "Gradient Colors changing unexpectedly", "body": "<p>You are adding the <code>ColorStop</code> 0 two times. Second time with default color.</p>\n\n<p>Should be</p>\n\n<pre><code>...\n    .Interior.Pattern = xlPatternLinearGradient\n    .Interior.Gradient.ColorStops.Clear\n    With .Interior.Gradient.ColorStops.Add(0)\n     .Color = RGB(255, 0, 0)\n     .TintAndShade = 0\n    End With\n    .Interior.Gradient.ColorStops.Add(1).Color = RGB(130, 0, 0)\n...\n</code></pre>\n\n<p>Using the <code>RGB</code> function will make it more flexible for usage with different colors.</p>\n"}], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 37564180, "answer_count": 1, "score": 0, "last_activity_date": 1464772586, "creation_date": 1464771322, "last_edit_date": 1464772117, "question_id": 37563899, "link": "https://stackoverflow.com/questions/37563899/gradient-colors-changing-unexpectedly", "title": "Gradient Colors changing unexpectedly", "body": "<p>I have been working on a formatting Macro that takes in selections and formats them according to chosen values in a userform.  One of these options creates a large merged cell with a color gradient from a light to dark red.  </p>\n\n<p>When I run the macro, the cells are all formatted appropriately, but when I navigate around the sheet, I've noticed a strange issue where the color of the gradient will change to blue instead of red colors.  Interestingly, the original color will randomly return, sometimes even giving a gradient from blue to red or red to blue.  </p>\n\n<p>If I use the format painter to pull the miscolored cell and test it elsewhere, the new broken/changing color scheme moves with it.  I've included the code that formats the merged Cell below.  Is there an issue, perhaps, with how I am designating the interior color?</p>\n\n<pre><code>With Range(WorkingRange(1, 2), WorkingRange(1, WorkingRange.Count - 1))\n    .Merge\n    .HorizontalAlignment = xlLeft\n    .WrapText = True\n    .Interior.Pattern = xlPatternLinearGradient\n    .Interior.Gradient.ColorStops.Add(0).Color = 255\n    .Interior.Gradient.ColorStops.Add(0).TintAndShade = 0\n    .Interior.Gradient.ColorStops.Add(1).Color = 130\n    .Font.Bold = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464772576, "post_id": 37563708, "comment_id": 62616081, "body": "Do you have a question or are you just showing us your code?"}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464776736, "post_id": 37563708, "comment_id": 62619041, "body": "Just showing my code, in case someone else needs it. Couldn&#39;t find any good examples on stackoverflow so I thought I should post it here. Posted the question with the answer to it. Feel free to improve it or edit it @arcadeprecinct"}], "tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 1, "last_activity_date": 1464770785, "creation_date": 1464770785, "answer_id": 37563708, "question_id": 37563707, "link": "https://stackoverflow.com/questions/37563707/how-to-see-if-a-string-matches-an-item-in-combobox-list/37563708#37563708", "title": "How to see if a string matches an item in combobox list", "body": "<pre><code>Public Sub comboBoxCheck(listMy As ComboBox, textToSearch As String, msgBoxText As String)\nDim i As Integer\nIf textToSearch = \"\" Then textToSearch = \"NA\" 'Empty string is equilaent to NOT AVAILABLE in my case\ntextToSearch = UCase(textToSearch)\nFor i = 0 To listMy.ListCount - 1\n    If listMy.List(i) = textToSearch Then\n        listMy.ListIndex = i\n        Exit Sub\n    End If\nNext\n'could add the text but In this case prompt the user what the text was, typically spelling mistake etc..\nMsgBox (\"You have some invalid entry for \" &amp; msgBoxText &amp; \"which has the value: \" &amp; textToSearch &amp; \"Please select correct value in the combobox and then press OK!\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1464770785, "creation_date": 1464770785, "last_edit_date": 1531164843, "question_id": 37563707, "link": "https://stackoverflow.com/questions/37563707/how-to-see-if-a-string-matches-an-item-in-combobox-list", "title": "How to see if a string matches an item in combobox list", "body": "<p>Below is my code that compares the given textToSearch with items in a combobox, If its not there then it prompt the user about it, otherwise it select it. </p>\n"}, {"tags": ["vba", "email", "export-to-excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1464771938, "post_id": 37563376, "comment_id": 62615637, "body": "My answer is about  your <i>original</i> question and I just edited it to eliminate the <code>If Not a Is Nothing</code> check since <code>myitem1.Attachments</code> would still be set to a valid object even if the item has no attachments. so  it suffices to start the loop since it&#39;d immediately stop should the <code>.Count</code> property be zero. and use <code>j</code> variable instead of <code>i</code>...  as for your edited question please note that <code>olkMsg.Attachment.Filename</code> is incorrect. you must iterate through <code>olkMsg.Attachments</code> collection and then write something like <code>excWks.Cells(intRow, 1) = olkMsg.Attachments.Item(j).Filename</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1464773194, "last_edit_date": 1464773194, "creation_date": 1464769857, "answer_id": 37563376, "question_id": 37563275, "link": "https://stackoverflow.com/questions/37563275/get-attachments-file-names-from-emails-vba/37563376#37563376", "title": "Get attachments file names from emails vba", "body": "<p><strong>edited</strong></p>\n\n<pre><code>Set a = myitem1.Attachments\nMsgBox a.Count\n\nFor j = 1 To myitem1.Attachments.Count\n   MsgBox myitem1.Attachments.Item(j).DisplayName ' or .Filename\nNext j\n</code></pre>\n\n<p>as about your edited question, replace the following snippet</p>\n\n<pre><code>            Dim a As Attachments\n            Set a = olkMsg.Attachments\n            If Not a Is Nothing Then\n\n\n            excWks.Cells(intRow, 1) = olkMsg.Attachment.Filename\n            'excWks.Cells(intRow, 2) = olkMsg.SenderEmailAddress\n            End If\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>        Dim a As Attachment\n        For Each a In olkMsg.Attachments\n            excWks.Cells(intRow, 1) = a.FileName\n            'excWks.Cells(intRow, 2) = a.SenderEmailAddress\n        Next a\n</code></pre>\n\n<p>which you must treat appropriately as for the <code>intRow</code> index. </p>\n\n<p>if you are interested in only the first attachment then you could substitute the entire last code with this:</p>\n\n<pre><code>excWks.Cells(intRow, 1) = olkMsg.Attachments.Item(1).FileName\n</code></pre>\n\n<p>while if you are interested in all attachments then you'll have to rethink about your sheet report structure</p>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8396, "favorite_count": 0, "accepted_answer_id": 37563376, "answer_count": 1, "score": 0, "last_activity_date": 1464773194, "creation_date": 1464769577, "last_edit_date": 1495541754, "question_id": 37563275, "link": "https://stackoverflow.com/questions/37563275/get-attachments-file-names-from-emails-vba", "title": "Get attachments file names from emails vba", "body": "<p>I have a folder that has emails with attachments and without attachments. i have the code for extracting the attachments names but if an email doesn't have attachments the code will stop. Any help is welcomed, thank you.</p>\n\n<p>by <a href=\"https://stackoverflow.com/users/190829/jimmypena\">jimmypena</a></p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim a As Attachments\nDim myitem As Folder\nDim myitem1 As MailItem\nDim j As Long\nDim i As Integer\n\nSet myitem = Session.GetDefaultFolder(olFolderDrafts)\n\nFor i = 1 To myitem.Items.Count\n  If myitem.Items(i) = test1 Then\n    Set myitem1 = myitem.Items(i)\n    Set a = myitem1.Attachments\n\n    MsgBox a.Count\n\n    ' added this code\n    For j = 1 To myitem1.Attachments.Count\n      MsgBox myitem1.Attachments.Item(i).DisplayName ' or .Filename\n    Next j\n\n  End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Sub EXPORT()\n\n    Const FOLDER_PATH = \"\\\\Mailbox\\Inbox\\emails from them\"\n    Dim olkMsg As Object, _\n        olkFld As Object, _\n        excApp As Object, _\n        excWkb As Object, _\n        excWks As Object, _\n        intRow As Integer, _\n        intCnt As Integer, _\n        strFileName As String, _\n        arrCells As Variant\n        strFileName = \"C:\\EXPORT\"\n        If strFileName &lt;&gt; \"\" Then\n        Set excApp = CreateObject(\"Excel.Application\")\n        Set excWkb = excApp.Workbooks.Add()\n        Set excWks = excWkb.ActiveSheet\n        excApp.DisplayAlerts = False\n        With excWks\n\n            .Cells(1, 1) = \"ATTACH NAMES\"\n            .Cells(1, 2) = \"SENDER\"\n            .Cells(1, 3) = \"NR SUBJECT\"\n            .Cells(1, 4) = \"CATEGORIES\"\n\n        End With\n        intRow = 2\n        Set olkFld = OpenOutlookFolder(FOLDER_PATH)\n        For Each olkMsg In olkFld.Items\n            If olkMsg.Class = olMail Then\n                arrCells = Split(GetCells(olkMsg.HTMLBody), Chr(255))\n\n\n                    Dim Reg1 As RegExp\n                    Dim M1 As MatchCollection\n                    Dim M As match\n                    Set Reg1 = New RegExp\n                        With Reg1\n                        .Pattern = \"\\s*[-]+\\s*(\\w*)\\s*(\\w*)\"\n                        .Global = True\n                        End With\n                           Set M1 = Reg1.Execute(olkMsg.Subject)\n                           For Each M In M1\n                excWks.Cells(intRow, 3) = M\n                           Next\n\n                Dim a As Attachments\n                Set a = olkMsg.Attachments\n                If Not a Is Nothing Then\n\n\n                excWks.Cells(intRow, 1) = olkMsg.Attachment.Filename\n                'excWks.Cells(intRow, 2) = olkMsg.SenderEmailAddress\n                End If\n\n                excWks.Cells(intRow, 2) = olkMsg.sender.GetExchangeUser.PrimarySmtpAddress\n                excWks.Cells(intRow, 4) = olkMsg.Categories\n\n                intRow = intRow + 1\n                intCnt = intCnt + 1\n            End If\n        Next\n        Set olkMsg = Nothing\n        excWkb.SaveAs strFileName, 52\n        excWkb.Close\n    End If\n    Set olkFld = Nothing\n    Set excWks = Nothing\n    Set excWkb = Nothing\n    Set excApp = Nothing\n    MsgBox \"Ta dam! \"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 5, "last_activity_date": 1557405433, "last_edit_date": 1557405433, "creation_date": 1464769367, "answer_id": 37563190, "question_id": 37563043, "link": "https://stackoverflow.com/questions/37563043/get-value-of-the-adjacent-cell-if-current-cell-is-empty-in-vba/37563190#37563190", "title": "Get value of the adjacent cell if current cell is empty in VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub Demo()\n    Dim rng As Range\n    Dim lastRow As Long\n    Dim cell as Range\n\n    lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"A1:A\" &amp; lastrow)\n    For Each cell In rng\n        If cell.Value = \"\" Then\n            cell.Value = cell.Offset(0, 1).Value\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 2, "last_activity_date": 1464769488, "creation_date": 1464769488, "answer_id": 37563236, "question_id": 37563043, "link": "https://stackoverflow.com/questions/37563043/get-value-of-the-adjacent-cell-if-current-cell-is-empty-in-vba/37563236#37563236", "title": "Get value of the adjacent cell if current cell is empty in VBA", "body": "<pre><code>Sub movecells()\n\nDim usedrows As Integer\nDim tmpval As String\nDim i As Integer\n\nusedrows = UsedRange.Rows.Count\n\nFor i = 1 To usedrows Step 1\n\n    If Cells(i, 1).Value = \"\" And Cells(i, 2).Value &lt;&gt; \"\" Then\n\n        Cells(i, 1).Value = Cells(i, 2).Value\n        Cells(i, 2).Value = \"\"\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "edited": false, "score": 0, "creation_date": 1464776130, "post_id": 37563766, "comment_id": 62618616, "body": "This is great too! Thanksss"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 3, "last_activity_date": 1464770934, "creation_date": 1464770934, "answer_id": 37563766, "question_id": 37563043, "link": "https://stackoverflow.com/questions/37563043/get-value-of-the-adjacent-cell-if-current-cell-is-empty-in-vba/37563766#37563766", "title": "Get value of the adjacent cell if current cell is empty in VBA", "body": "<p>you could try this</p>\n\n<pre><code>Sub main()    \n    With ActiveSheet.UsedRange.Columns(\"A\")\n        If WorksheetFunction.CountBlank(.Cells) &gt; 0 Then\n            .SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=RC[1]\"\n            .Value = .Value\n        End If\n    End With    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2350, "favorite_count": 1, "accepted_answer_id": 37563190, "answer_count": 3, "score": 2, "last_activity_date": 1557405433, "creation_date": 1464768810, "last_edit_date": 1554977746, "question_id": 37563043, "link": "https://stackoverflow.com/questions/37563043/get-value-of-the-adjacent-cell-if-current-cell-is-empty-in-vba", "title": "Get value of the adjacent cell if current cell is empty in VBA", "body": "<p>Is there a way to copy the value of the adjacent cell if the current cell is empty using <strong>VBA</strong>?</p>\n\n<p>Example here: </p>\n\n<p>If I loop through the cells of column A and a cell is empty, copy the value of adjacent cell of column B to that empty cell in column A.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hvCRe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hvCRe.png\" alt=\"enter image description here\"></a></p>\n\n<p>This should be the report I generate: </p>\n\n<p><a href=\"https://i.stack.imgur.com/1Zy3o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Zy3o.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1464770233, "post_id": 37562454, "comment_id": 62614545, "body": "Experts here may be able to suggest you proper course to be adopted, if you can edit your question to show around 4 representative data values incorporating worst case scenarios of data variation."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "edited": false, "score": 0, "creation_date": 1464770862, "post_id": 37563113, "comment_id": 62614928, "body": "I have code for trimming text and I gave a range of certain cells with the code its working, but i do not want to give a specific range instead to do  &quot; until empty cell&quot;.                                                    For Each C In Range(&quot;B1:Z1&quot;)                                                             If InStr(C.Value, &quot;<i>&quot;) &gt; 0 Then                                                    C.Value = Left(C.Value, InStr(C.Value, &quot;</i>&quot;) - 1)                               End If Next C"}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "edited": false, "score": 0, "creation_date": 1464775700, "post_id": 37563113, "comment_id": 62618356, "body": "Check this out now."}, {"owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "edited": false, "score": 0, "creation_date": 1464832911, "post_id": 37563113, "comment_id": 62649692, "body": "Second one worked but it should be Cells(col).Value  not simply col, coz col declared as integer and i need to read the value of cell..So its Cells(col).Value..Anyway Thank you so much its solved now."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 0, "last_activity_date": 1464775618, "last_edit_date": 1464775618, "creation_date": 1464769045, "answer_id": 37563113, "question_id": 37562454, "link": "https://stackoverflow.com/questions/37562454/trim-text-in-vba/37563113#37563113", "title": "Trim text in VBA", "body": "<pre><code>Sub mac1()\nDim LastCol As Integer\nSheets(\"MySheet\").Select\nLastCol = Cells(1, 1).End(xlToRight).Column\nFor Each C In Range(Cells(1, 1), Cells(1, LastCol))\n    C.Value = Left(C.Value, InStr(C.Value, \"\") - 1)\nNext C\nEnd Sub\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Sub mac2()\nDim Col As Integer\nCol = 1\nDo While Cells(1, Col).Value &lt;&gt; \"\"\n    Cells(1, Col).Value = Left(Cells(1, Col).Value, InStr(Cells(1, Col).Value, \"\") - 1)\n    Col = Col + 1\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464775618, "creation_date": 1464767130, "last_edit_date": 1531164843, "question_id": 37562454, "link": "https://stackoverflow.com/questions/37562454/trim-text-in-vba", "title": "Trim text in VBA", "body": "<p>I have data in excel sheet, with headings in 1st Row, I want to trim them as shown below</p>\n\n<p>For example </p>\n\n<p>CT_CD_FILTER_AMT*_Integer</p>\n\n<pre><code>Change to \n</code></pre>\n\n<p>CT_CD_FILTER_AMT</p>\n\n<p>Each column heading is different..and number of columns also different from each file</p>\n\n<p>So I want select the value of each column  and trim it until it reaches the blank cell in ( row1 only)</p>\n\n<p>Pls help with code.</p>\n\n<p>TIA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "edited": false, "score": 2, "creation_date": 1464767463, "post_id": 37562434, "comment_id": 62612784, "body": "It has been answered before, please check the following link: <a href=\"http://stackoverflow.com/a/7549732/2854647\">stackoverflow.com/a/7549732/2854647</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "is_accepted": true, "score": 2, "last_activity_date": 1464767715, "creation_date": 1464767715, "answer_id": 37562685, "question_id": 37562434, "link": "https://stackoverflow.com/questions/37562434/call-a-macro-2-sec-after-a-cell-is-changed/37562685#37562685", "title": "Call a macro 2 sec after a cell is changed", "body": "<p>This is how you should modify your code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"B2\")) Is Nothing Then\n        Application.Wait(Now + TimeValue(\"0:00:02\"))\n        Call Macro\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6267393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fcc1267b133644e7c2d17ffbdfbbece7?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/6267393/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 37562685, "answer_count": 1, "score": 1, "last_activity_date": 1464768285, "creation_date": 1464767082, "last_edit_date": 1464768285, "question_id": 37562434, "link": "https://stackoverflow.com/questions/37562434/call-a-macro-2-sec-after-a-cell-is-changed", "title": "Call a macro 2 sec after a cell is changed", "body": "<p>I would like to have macro called 2 seconds after a cell changes. </p>\n\n<p>I am stuck with this code. </p>\n\n<p>Any help would be appreciated. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"B2\")) Is Nothing Then\n    Application.OnTime Now + TimeValue(\"00:00:02\"), Macro \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1464767948, "post_id": 37562639, "comment_id": 62613088, "body": "Notes: this works only if (1) the &quot;red&quot; you are using is the one that H.hisoka used to color his/her cells. Of course, the same applies to the &quot;yellow&quot; he/she is using. (2) If H.hisoka uses conditional formatting to color the cells then your solution will not work either."}, {"owner": {"reputation": 368, "user_id": 3320352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7cd954492982a52a4da677d9ee8b41c4?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/3320352/sumit-jain"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464768722, "post_id": 37562639, "comment_id": 62613556, "body": "This code can work to any color, provided the RGB selection is checked and formatted in the above code accordingly"}, {"owner": {"reputation": 61, "user_id": 6235750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6015be7ffa3e546507bf2eb5735a8b73?s=128&d=identicon&r=PG&f=1", "display_name": "H.hisoka", "link": "https://stackoverflow.com/users/6235750/h-hisoka"}, "edited": false, "score": 0, "creation_date": 1464771708, "post_id": 37562639, "comment_id": 62615483, "body": "thank you for your response, but that&#39;s not what I meant. , I have a complex code and the example that I poster was a simplification, the code can copy like you said, what I want is to tell it that before executing the copying part of code he have to be sure that there is at least one yellow cell in TAB"}, {"owner": {"reputation": 61, "user_id": 6235750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6015be7ffa3e546507bf2eb5735a8b73?s=128&d=identicon&r=PG&f=1", "display_name": "H.hisoka", "link": "https://stackoverflow.com/users/6235750/h-hisoka"}, "edited": false, "score": 0, "creation_date": 1464771947, "post_id": 37562639, "comment_id": 62615643, "body": "if there is at least one yellow cell the second part of the code can be executed and if there is not the code have to say that there is not yellow cell in the tab ,  exit from the code with out executing the second part of the code"}, {"owner": {"reputation": 368, "user_id": 3320352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7cd954492982a52a4da677d9ee8b41c4?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/3320352/sumit-jain"}, "edited": false, "score": 0, "creation_date": 1464779188, "post_id": 37562639, "comment_id": 62620864, "body": "I have added another answer, as per your requirement"}], "tags": [], "owner": {"reputation": 368, "user_id": 3320352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7cd954492982a52a4da677d9ee8b41c4?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/3320352/sumit-jain"}, "is_accepted": true, "score": 2, "last_activity_date": 1464779137, "last_edit_date": 1464779137, "creation_date": 1464767585, "answer_id": 37562639, "question_id": 37562147, "link": "https://stackoverflow.com/questions/37562147/verify-that-there-is-at-least-one-yellow-cell/37562639#37562639", "title": "verify that there is at least one yellow cell", "body": "<p>Use the below code and change the destination cell to paste values</p>\n\n<pre><code>Sub color()\nDim cll As Range\nFor Each cll In Selection\n    If cll.Interior.color = RGB(255, 0, 0) Then\n        cll.Copy\n        Sheets(2).Range(\"Destinationcell\").PasteSpecial xlPasteValues\n    Else\n        If cll.Interior.color = RGB(255, 255, 0) Then\n            cll.Copy\n            Sheets(2).Range(\"Destinationcell\").PasteSpecial xlPasteValues\n        Else\n            MsgBox (\"No Colored Cell\")\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>You can use the following code as well</p>\n\n<pre><code>Sub color()\n    Dim cll As Range, i as integer, j as integer\n    For Each cll In Selection\n        If cll.Interior.color = RGB(255, 0, 0) Then i=i+1\n        Else\n          If cll.Interior.color = RGB(255, 255, 0) Then j= j +1\n          Else\n             MsgBox (\"No Colored Cell\")\n          End If\n        End IF\n        if i&gt;=1 Then\n          cll.Copy\n          Sheets(2).Range(\"Destinationcell\").PasteSpecial xlPasteValues\n        End if\n        if j&gt;=1 then\n          cll.copy\n          Sheets(2).Range(\"Destinationcell\").PasteSpecial xlPasteValues\n        End if\n\n    Next\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 1, "last_activity_date": 1464978427, "last_edit_date": 1464978427, "creation_date": 1464891784, "answer_id": 37599455, "question_id": 37562147, "link": "https://stackoverflow.com/questions/37562147/verify-that-there-is-at-least-one-yellow-cell/37599455#37599455", "title": "verify that there is at least one yellow cell", "body": "<p>You can use the following powerful FindAll function below to search for formatted cells and then process the results...</p>\n\n<p>For eg.</p>\n\n<pre><code>Sub FindColours()\n\n    Dim FoundRange As Range\n\n    Application.FindFormat.Clear\n    Application.FindFormat.Interior.Color = RGB(255, 0, 0)\n    Set FoundRange = FindAll(\"\", SearchFormat:=True)\n    If Not FoundRange Is Nothing Then\n        ' Do Red Cell Stuff\n        MsgBox FoundRange.Address\n    End If\n\n    Application.FindFormat.Clear\n    Application.FindFormat.Interior.Color = RGB(255, 255, 0)\n    Set FoundRange = FindAll(\"\", SearchFormat:=True)\n    If Not FoundRange Is Nothing Then\n        ' Do Yellow Cell Stuff\n        MsgBox FoundRange.Address\n    End If\nEnd Sub\n\nFunction FindAll(What, _\n    Optional SearchWhat As Variant, _\n    Optional LookIn, _\n    Optional LookAt, _\n    Optional SearchOrder, _\n    Optional SearchDirection As XlSearchDirection = xlNext, _\n    Optional MatchCase As Boolean = False, _\n    Optional MatchByte, _\n    Optional SearchFormat) As Range\n\n    'LookIn can be xlValues or xlFormulas, _\n     LookAt can be xlWhole or xlPart, _\n     SearchOrder can be xlByRows or xlByColumns, _\n     SearchDirection can be xlNext, xlPrevious, _\n     MatchCase, MatchByte, and SearchFormat can be True or False. _\n     Before using SearchFormat = True, specify the appropriate settings for the Application.FindFormat _\n     object; e.g. Application.FindFormat.NumberFormat = \"General;-General;\"\"-\"\"\"\n\n    Dim SrcRange As Range\n    If IsMissing(SearchWhat) Then\n        Set SrcRange = ActiveSheet.UsedRange\n    ElseIf TypeOf SearchWhat Is Range Then\n        Set SrcRange = IIf(SearchWhat.Cells.Count = 1, SearchWhat.Parent.UsedRange, SearchWhat)\n    ElseIf TypeOf SearchWhat Is Worksheet Then\n        Set SrcRange = SearchWhat.UsedRange\n    Else: SrcRange = ActiveSheet.UsedRange\n    End If\n    If SrcRange Is Nothing Then Exit Function\n\n    'get the first matching cell in the range first\n    With SrcRange.Areas(SrcRange.Areas.Count)\n        Dim FirstCell As Range: Set FirstCell = .Cells(.Cells.Count)\n    End With\n\n    Dim CurrRange As Range: Set CurrRange = SrcRange.Find(What:=What, After:=FirstCell, LookIn:=LookIn, LookAt:=LookAt, _\n        SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n\n    If Not CurrRange Is Nothing Then\n        Set FindAll = CurrRange\n        Do\n            Set CurrRange = SrcRange.Find(What:=What, After:=CurrRange, LookIn:=LookIn, LookAt:=LookAt, _\n            SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n            If CurrRange Is Nothing Then Exit Do\n            If Application.Intersect(FindAll, CurrRange) Is Nothing Then\n                Set FindAll = Application.Union(FindAll, CurrRange)\n            Else: Exit Do\n            End If\n        Loop\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6235750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6015be7ffa3e546507bf2eb5735a8b73?s=128&d=identicon&r=PG&f=1", "display_name": "H.hisoka", "link": "https://stackoverflow.com/users/6235750/h-hisoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37562639, "answer_count": 2, "score": -1, "last_activity_date": 1464978427, "creation_date": 1464766147, "last_edit_date": 1464766407, "question_id": 37562147, "link": "https://stackoverflow.com/questions/37562147/verify-that-there-is-at-least-one-yellow-cell", "title": "verify that there is at least one yellow cell", "body": "<p>I have a code that copies the colored cells from dynamic Table to another Table.<br>\nWhat I want to do is verify that there is at least one red or yellow colored cell before copying cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZEW57.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZEW57.png\" alt=\"verify in this tab \"></a></p>\n\n<p>If there is at least one red cell then copy the red cell in tab 1 else don't copy any cell and go to check for yellow cells.</p>\n\n<p>If there is at least one yellow cell then copy yellow cell in Tab 2 else exit sub and display message \"no colored cells\" </p>\n\n<p><a href=\"https://i.stack.imgur.com/kSmDq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kSmDq.png\" alt=\"tab 1 and tab 2 after copying \"></a></p>\n"}, {"tags": ["vba", "email", "outlook", "selection"], "answers": [{"tags": [], "owner": {"reputation": 854, "user_id": 5591761, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0ceb7eac4952c496919aab0c6c7deead?s=128&d=identicon&r=PG&f=1", "display_name": "M. Ozn", "link": "https://stackoverflow.com/users/5591761/m-ozn"}, "is_accepted": true, "score": 0, "last_activity_date": 1464792789, "creation_date": 1464792789, "answer_id": 37572159, "question_id": 37562090, "link": "https://stackoverflow.com/questions/37562090/select-current-line-in-outlook-vba/37572159#37572159", "title": "Select current line in outlook vba", "body": "<p>Ok i found how to do this :</p>\n\n<pre><code>    Dim objOL As Outlook.Application\n        Dim objNS As Outlook.NameSpace\n        Dim objDoc As Word.Document\n        Dim objSel As Word.Selection\n\n    Set objOL = Application\n        If objOL.ActiveInspector.EditorType = olEditorWord Then\n            Set objDoc = objOL.ActiveInspector.WordEditor\n            Set objNS = objOL.Session\n\n            Set objSel = objDoc.Windows(1).Selection\n            objSel.MoveEnd Unit:=wdLine, Count:=1\n\n        End If\n    Set objOL = Nothing\n    Set objNS = Nothing\n</code></pre>\n\n<p>Thanks for your attention !</p>\n"}], "owner": {"reputation": 854, "user_id": 5591761, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0ceb7eac4952c496919aab0c6c7deead?s=128&d=identicon&r=PG&f=1", "display_name": "M. Ozn", "link": "https://stackoverflow.com/users/5591761/m-ozn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 37572159, "answer_count": 1, "score": 0, "last_activity_date": 1464792789, "creation_date": 1464765997, "question_id": 37562090, "link": "https://stackoverflow.com/questions/37562090/select-current-line-in-outlook-vba", "title": "Select current line in outlook vba", "body": "<p>I wrote a function in outlook vba. When i click on a mail and use my function, it automatically create my reply mail with all i used to put on my replies mails.</p>\n\n<p>My reply mail looks like this :</p>\n\n<p><strong>Hi Mister</strong></p>\n\n<p><strong>It's done !</strong></p>\n\n<p><strong>Regards,</strong></p>\n\n<p>Because i'm the bdd admin, i receive a lot of task from mail, so i used to send mail only with \"it's done\" on it.</p>\n\n<p>But sometimes, i use my automatic reply to reply to a normal mail, which not contains any kind of task to do. So i have to manually delete the \"it's done\" from my reply mail before write my reply.</p>\n\n<p>With the \"SendKeys\" function, my cursor is automatically put at the line of the \"It's done\", but now i'm trying to automatically select this line. Because if this line is already selected, i'll just have to write something to replace the \"It's done\", or i could send the mail like it if i just want to send \"It's done\".</p>\n\n<p>But i looked for \"Select text in vba outlook\" or \"Select row\" or even \"select sentence\" and \"select line\", i found nothing clear to solve my problem. How can i do the trick ?</p>\n\n<p>Regards.</p>\n"}, {"tags": ["excel", "combobox", "range", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464767690, "post_id": 37562039, "comment_id": 62612934, "body": "The error should occur on the line <code>Set wb = Workbooks.Open(Path, False, True)</code> because there is no <code>path</code> set to open any file. The error you are getting on that line is probably due to the fact that you closed the file before reading / grabbing data from that file. You might want to consider moving that line to the end of the sub."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6405149, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153680681066586/picture?type=large", "display_name": "Alinas", "link": "https://stackoverflow.com/users/6405149/alinas"}, "edited": false, "score": 0, "creation_date": 1464940961, "post_id": 37563893, "comment_id": 62701719, "body": "Thanks guys! it worked. Had no idea I couldn&#39;t have a Range object referring to a range in a closed workbook."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1464771314, "creation_date": 1464771314, "answer_id": 37563893, "question_id": 37562039, "link": "https://stackoverflow.com/questions/37562039/vba-error-424-object-in-range-object/37563893#37563893", "title": "VBA error 424 object in range object", "body": "<p>As soon as you close the source workbook, your <code>col</code> variable is nothing. That's what causes your error - you can't have a <code>Range</code> object referring to a range in a closed workbook. Just close it after you've populated the control, or load the data into an array first.</p>\n"}], "owner": {"reputation": 3, "user_id": 6405149, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153680681066586/picture?type=large", "display_name": "Alinas", "link": "https://stackoverflow.com/users/6405149/alinas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 37563893, "answer_count": 1, "score": 0, "last_activity_date": 1464771314, "creation_date": 1464765859, "last_edit_date": 1531164843, "question_id": 37562039, "link": "https://stackoverflow.com/questions/37562039/vba-error-424-object-in-range-object", "title": "VBA error 424 object in range object", "body": "<p>I'm getting the 424 error in the code below and I can't figure out what's wrong. Basically I'm trying to populate a combobox with data from a column in a table in a different workbook. I was thinking to do this with ranges and automate as much as I can, i.e. I even wanted to pass the combobox object as a variable... But I'm stuck here...</p>\n\n<p>Thanks for your help!</p>\n\n<pre><code>Sub PopListBoxTbl(tbl As String)\nDim popv As Range, col As Range\nDim cmb As ComboBox\nDim wb As Workbook\nDim sheet As Worksheet\nSet cmb = UserForm1.ComboBox2\nSet wb = Workbooks.Open(path, False, True)\nSet sheet = wb.Worksheets(tbl)\nSet col = sheet.Range(tbl)\nwb.Close\ncmb.Clear\nFor Each popv In col.Cells 'here's the error line\nWith cmb\n    .AddItem popv.Value\nEnd With\nNext popv\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "rdlc"], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1464764896, "creation_date": 1464764896, "answer_id": 37561707, "question_id": 37561576, "link": "https://stackoverflow.com/questions/37561576/usage-datetime-on-rdlc-report/37561707#37561707", "title": "Usage datetime on rdlc report", "body": "<pre><code>Format(DateAdd(\"m\", 6, Now), \"dd.MM.yyyy\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1464764943, "creation_date": 1464764943, "answer_id": 37561723, "question_id": 37561576, "link": "https://stackoverflow.com/questions/37561576/usage-datetime-on-rdlc-report/37561723#37561723", "title": "Usage datetime on rdlc report", "body": "<p><code>DateAdd</code> <a href=\"https://msdn.microsoft.com/fr-fr/library/office/gg251759.aspx\" rel=\"nofollow\">is the function you need</a>:</p>\n\n<pre><code>=Format(DateAdd(\"m\", 6, Now), \"dd.MM.yyyy\") \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5907164, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10153907517184105/picture?type=large", "display_name": "Osman Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/5907164/osman-yal%c3%a7%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37561723, "answer_count": 2, "score": 0, "last_activity_date": 1464768518, "creation_date": 1464764451, "last_edit_date": 1464768518, "question_id": 37561576, "link": "https://stackoverflow.com/questions/37561576/usage-datetime-on-rdlc-report", "title": "Usage datetime on rdlc report", "body": "<pre><code>=Format(DateTime.Now(), \"dd.MM.yyyy\")  \n</code></pre>\n\n<p>---> This result gives me ---> \"01.06.2016\"</p>\n\n<p>I want to get a date of 6 months from now. I mean \"01.12.2016\"  How can I do this?</p>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 5323570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59739ebfba096a81b9472cc2a9ec6519?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Ramirez", "link": "https://stackoverflow.com/users/5323570/luis-ramirez"}, "is_accepted": true, "score": 13, "last_activity_date": 1464762446, "last_edit_date": 1495540725, "creation_date": 1464762446, "answer_id": 37560973, "question_id": 37560346, "link": "https://stackoverflow.com/questions/37560346/is-there-any-way-i-can-call-excel-vba-function-through-python/37560973#37560973", "title": "Is there any way I can call Excel VBA function through Python?", "body": "<p>In order to do this you will need to use pywin32, and use the excel com interface. </p>\n\n<p>Please review the documentation for the <a href=\"https://msdn.microsoft.com/en-us/library/wss56bz7.aspx\" rel=\"noreferrer\">Excel Com Interface</a>: </p>\n\n<p>Please note this has been asked before <a href=\"https://stackoverflow.com/questions/19616205/running-an-excel-macro-via-python\">Running an Excel Macro via Python</a> </p>\n\n<p>The code below is a slight modification of the original. </p>\n\n<pre><code>import os\nimport win32com.client\n\n#Launch Excel and Open Wrkbook\nxl=win32com.client.Dispatch(\"Excel.Application\")  \nxl.Workbooks.Open(Filename=\"C:\\Full Location\\To\\excelsheet.xlsm\") #opens workbook in readonly mode. \n\n#Run Macro\nxl.Application.Run(\"excelsheet.xlsm!modulename.macroname\") \n\n#Save Document and Quit.\nxl.Application.Save()\nxl.Application.Quit() \n\n#Cleanup the com reference. \ndel xl\n</code></pre>\n\n<p>Good Luck. </p>\n"}], "owner": {"reputation": 101, "user_id": 5243638, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5fa04dc71f38af9460be97d74a17935a?s=128&d=identicon&r=PG&f=1", "display_name": "maximus", "link": "https://stackoverflow.com/users/5243638/maximus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11713, "favorite_count": 5, "closed_date": 1464763155, "accepted_answer_id": 37560973, "answer_count": 1, "score": 6, "last_activity_date": 1464762446, "creation_date": 1464759878, "last_edit_date": 1531164843, "question_id": 37560346, "link": "https://stackoverflow.com/questions/37560346/is-there-any-way-i-can-call-excel-vba-function-through-python", "closed_reason": "Duplicate", "title": "Is there any way I can call Excel VBA function through Python?", "body": "<p>Do anybody know a method to call  Excel VBA function in Python.</p>\n\n<p>In my case, I would like my program which is programmed in Python produce an output in Excel by calling a function which is created in Visual Basic.</p>\n\n<p>Is there any method on doing that?</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1464759455, "post_id": 37560187, "comment_id": 62608769, "body": "Do you have only one button? Can you post the code you have so far? If you want to load the Textboxes when opening the Form, use the <code>UserForm_Activate()</code> Sub"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464761624, "post_id": 37560187, "comment_id": 62609676, "body": "The &quot;load&quot; code is the opposite of the &quot;save&quot; code..."}], "answers": [{"comments": [{"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464764003, "post_id": 37561356, "comment_id": 62610847, "body": "yes, but HOW do i call this? If the form is opened via <code>userform.show</code> then it will automatically load the code in sub userform_initialize.... How can I load the empty form and populate the content?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464764288, "post_id": 37561356, "comment_id": 62611007, "body": "I wouldn&#39;t use userform_initialize to load data, use userform_activate instead."}, {"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464764872, "post_id": 37561356, "comment_id": 62611321, "body": "let me be clear. When I use <code>userform.show</code> the code stored in sub userform_initialize is executed automatically. HOW do I call the userform in order to trigger the userform_activate sub? would that be <code>userform.activate</code> ?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464764942, "post_id": 37561356, "comment_id": 62611354, "body": "for me the userform_activate sub gets triggered when i open the form with userform.show"}, {"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464765674, "post_id": 37561356, "comment_id": 62611754, "body": "then how does the userform_initialize get triggered? Respectively, how can I tell VBA to load an empty form when the NEW ENTRY button is clicked, but load a populated form when the &quot;EDIT&quot; button in the active rows is clicked?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464766492, "post_id": 37561356, "comment_id": 62612245, "body": "You can define a global variable inside the form codemodule, set different values when pressing the buttons and check the value in userform_initialize"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1464763758, "creation_date": 1464763758, "answer_id": 37561356, "question_id": 37560187, "link": "https://stackoverflow.com/questions/37560187/populate-userform-with-records-from-current-row/37561356#37561356", "title": "Populate userform with records from current row", "body": "<p>If you have one Button on your sheet to call the form, then just use something like this:</p>\n\n<pre><code>me.TextBox1.value = Cells(ActiveCell.Row, 2).Value 'ActiveCell.Row returns the row number of the current cell\n</code></pre>\n\n<p>So the only command the button has is <code>UserForm1.Show</code></p>\n"}, {"comments": [{"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464767082, "post_id": 37562073, "comment_id": 62612572, "body": "sorry, you completely lost me. where do I put what and which sub do I call when the button in the row is clicked?"}, {"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464767481, "post_id": 37562073, "comment_id": 62612795, "body": "to clarify, I have 2 buttons on the sheet. One to create a &quot;NEW ENTRY&quot;, which means I need the form to be loaded without any values as I have defined it in the userform_initialize sub, and then another button for &quot;EDIT ENTRY&quot; where I want the form to load with values from the active row. How do I do this and what subs should I use?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1464767937, "post_id": 37562073, "comment_id": 62613082, "body": "@Armitage2k I edited my post for more clarity (hopefully)"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 0, "last_activity_date": 1464768530, "last_edit_date": 1464768530, "creation_date": 1464765956, "answer_id": 37562073, "question_id": 37560187, "link": "https://stackoverflow.com/questions/37560187/populate-userform-with-records-from-current-row/37562073#37562073", "title": "Populate userform with records from current row", "body": "<p>You can write a sub like <code>loadDataIntoForm(rowNum As Long)</code> that fills the fields of the form to your liking and put it into the code of the userform.\ne.g.</p>\n\n<pre><code>Public Sub loadDataIntoForm(rowNum As Long)\n    me.somecontrol.Value = Sheets(\"Data\").cells(rowNum,1).Value\n    '...\nEnd Sub\n</code></pre>\n\n<p>Then if the edit button is clicked execute</p>\n\n<pre><code>Details.loadDataIntoForm(rowNum) 'where rowNum is something like ActiveCell.Row. This calls UserForm_Initialize and THEN loadDataIntoForm\nDetails.Show 'UserForm_Initialize won't get executed again\n</code></pre>\n\n<p><code>UserForm_Initialize</code> is executed before <code>loadDataIntoForm</code> is so the fields get cleared first by the <code>UserForm_Initialize</code> function and then re-populated by <code>loadDataIntoForm</code>. To be sure you could also load the form first</p>\n\n<pre><code>Load Details\nDetails.loadDataIntoForm(ActiveCell.Row)\nDetails.Show\n</code></pre>\n\n<p>So you can be sure <code>UserForm_Initialize</code> is not called after <code>loadDataIntoForm</code>.</p>\n\n<p>To get a sense of what is called when you can go through the code line by line using F8. </p>\n\n<hr>\n\n<p>edit: A nicer way would probably be to write two subs, one for initializing the form for an edit (populate the fields) and one for initializing the form for a new record (clear the fields)</p>\n\n<p>It could look something like</p>\n\n<pre><code>Public Sub ShowNew()\n    'clear all the controls\n    me.Show\nEnd Sub\n\nPublic Sub ShowEdit(rowNum As Long)\n    'populate the controls\n    me.Show\nEnd Sub\n</code></pre>\n\n<p>Then instead of using <code>Details.Show</code> use <code>Details.ShowNew</code> and <code>Details.ShowNew(rowNum)</code></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1464769500, "creation_date": 1464769500, "answer_id": 37563240, "question_id": 37560187, "link": "https://stackoverflow.com/questions/37560187/populate-userform-with-records-from-current-row/37563240#37563240", "title": "Populate userform with records from current row", "body": "<p>I'd go like follows:</p>\n\n<ul>\n<li><p>use <code>Tag</code> property of the <code>UserForm</code> object to store a \"calling parameter\" that will tell UserForm whether to run an <code>InitializeValues()</code> Sub or a <code>FillValues()</code> one</p></li>\n<li><p>use <code>UserForm_Activate</code> event handler to have UserForm decide which action is to be taken</p></li>\n</ul>\n\n<p>so, assuming you attach an <code>Edit()</code> sub to your sheet \"edit\" buttons, the former would be</p>\n\n<pre><code>Sub Edit()\n    With UserForm3\n        .Tag = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row '&lt;~~ tell the UserForm there's something to bring in so that it'll fill controls from the sheet instead of initializing them\n        .Show\n        .Tag = \"\" '&lt;~~ bring Tag property back to its \"null\" value\n    End With\n    Unload UserForm3\nEnd Sub\n</code></pre>\n\n<p>then in you UserForm code pane place this</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    If Me.Tag = \"\" Then '&lt;~~ if there's no info from Tag property...\n        InitializeValues '&lt;~~ ... then Initialize controls values\n    Else\n        FillValues '&lt;~~ ...otherwise fill controls with sheet values\n    End If\nEnd Sub\n\nPrivate Sub InitializeValues()\n    With Me\n        .ComboBox1.RowSource = \"initRange\"\n        .serial.Value = \"actText1\"\n        .created_on.Value = \"actText2\"\n        .created_by.Value = \"actText3\"\n        ' and so on...\n    End With\nEnd Sub\n\nPrivate Sub FillValues()\n    With Me\n        .serial.Value = Cells(.Tag, 2).Value\n        .created_on.Value = Cells(.Tag, 4).Value\n        .created_by.Value = Cells(.Tag, 5).Value\n        '.. and so on\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5691, "favorite_count": 0, "accepted_answer_id": 37563240, "answer_count": 3, "score": 1, "last_activity_date": 1464770146, "creation_date": 1464759215, "last_edit_date": 1464770146, "question_id": 37560187, "link": "https://stackoverflow.com/questions/37560187/populate-userform-with-records-from-current-row", "title": "Populate userform with records from current row", "body": "<p>I have a userform with several textboxes, radio buttons, dropdowns, etc. When a user creates a new entry, the data is saved on the Data sheet, with one record occupying one row. Now I want to be able to click an \"edit\" button in column A which allows to load the userform preloaded with the data from this row.</p>\n\n<p>The issue is that when the form is loaded, the initialization macro resets all form fields to \"\", and I havent figured out how to tell VBA to load the calling row's data.</p>\n\n<p>Any suggestions on how to go about this?</p>\n\n<hr>\n\n<p>Here the code I have so far:\ncall the userform when the NEW ENTRY button is clicked</p>\n\n<pre><code>Sub call_userform()\n\nDetails.Show\n\nEnd Sub\n</code></pre>\n\n<p>when the userform is initialized:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nIC_logo.BackColor = RGB(81, 81, 73) ' ash grey\n\n'Empty all fields\nstatus.Value = \"Open\"\nserial = Evaluate(\"randbetween(10000,30000)\")\npriority.Value = \"\"\ncreated_on.Value = Format(Date, \"dd/mm/yyyy\")\ncreated_by.Value = \"\"\ndepartment.Value = \"\"\nfloor.Value = \"\"\narea.Value = \"\"\nsubarea.Value = \"\"\ndetails.Value = \"\"\nfu_name.Value = \"\"\nfu_department = \"\"\n\nMe.status.RowSource = \"lst_status\"              'Fill Status\nMe.priority.RowSource = \"lst_priority\"          'Fill Priorities\ncreated_by = Sheets(\"Settings\").Range(\"B24\")    'Fill Created By with Logon Username\ndepartment = Sheets(\"Settings\").Range(\"B25\")    'Fill Created By with Logon Department\nMe.floor.RowSource = \"lst_floor\"                'Fill Floor\nMe.area.RowSource = \"lst_area\"                  'Fill Area\nMe.subarea.RowSource = \"lst_subarea\"            'Fill Subarea\n\n'Set follow up to construction company as per default\n'fu_2.Value = True\n\n'Set Focus on NameTextBox\npriority.SetFocus\n\nEnd Sub\n</code></pre>\n\n<p>when the SAVE button is clicked</p>\n\n<pre><code>Private Sub btn_save_Click()\nDim emptyRow As Long\n\n'Activate Data sheet\nSheets(\"Data\").Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"B:B\")) + 1\n\n'Transfer information\nCells(emptyRow, 2).Value = serial.Value\nCells(emptyRow, 4).Value = created_on.Value\nCells(emptyRow, 5).Value = created_by.Value\nCells(emptyRow, 6).Value = priority.Value\nCells(emptyRow, 7).Value = floor.Value\nCells(emptyRow, 8).Value = area.Value\nCells(emptyRow, 9).Value = subarea.Value\nCells(emptyRow, 10).Value = details.Value\n\nIf fu_1.Value = True Then\n    Cells(emptyRow, 11).Value = fu_1.Caption\nEnd If\nIf fu_2.Value = True Then\n    Cells(emptyRow, 11).Value = fu_2.Caption\nEnd If\nIf fu_3.Value = True Then\n    Cells(emptyRow, 11).Value = fu_3.Caption\nEnd If\nIf fu_4.Value = True Then\n    Cells(emptyRow, 11).Value = fu_4.Caption\nEnd If\n\nIf fu_name.Value &gt; 0 Or fu_department.Value &gt; 0 Then\n    Cells(emptyRow, 12).Value = fu_name.Value &amp; \" \" &amp; fu_department.Value\nEnd If\n\nCells(emptyRow, 13).Value = status.Value\n\nEnd Sub\n</code></pre>\n\n<p>As mentioned, the problem now is how do I load the userform with the data of the current row? Would that still be via <code>details.show</code> ?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 21, "user_id": 6407570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_90FJ9uVYnY/AAAAAAAAAAI/AAAAAAAAAZQ/5kNAtATwWl8/photo.jpg?sz=128", "display_name": "user6407570", "link": "https://stackoverflow.com/users/6407570/user6407570"}, "edited": false, "score": 0, "creation_date": 1464755108, "post_id": 37559370, "comment_id": 62607173, "body": "Also, to follow the excel coding marcos stated in the article &quot;How do I track who uses my Excel spreadsheet?&#39; the automatically send email function when excel file is open &gt; can i set something in the coding, that making it stop sending email WHEN I am the one opening it? thanksssss"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1464761839, "post_id": 37559370, "comment_id": 62609778, "body": "First I would like to note that there is no need to comment on your own post. You can <code>edit</code> your post and change it to amend the above comment. Afterwards, you can delete the above comment using the small <code>x</code> next to it. In respect to your above post I&#39;d like to advise you not to attempt that in Excel. There is no (limited and can be easily overcome) security in Excel. If you want / have to track their doings then I&#39;d recommend connecting the Excel file(s) to an SQL Server and do the tracking there. Whatever you are doing in Excel cannot be hidden effectively."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1464883091, "creation_date": 1464883091, "answer_id": 37596782, "question_id": 37559370, "link": "https://stackoverflow.com/questions/37559370/tracking-share-drive-users-name-and-opening-time-in-excel/37596782#37596782", "title": "Tracking Share-drive Users name and opening time in Excel?", "body": "<p>In Excel, under the Review tab, you have 'Track Changes'.  This should do everything you want.</p>\n\n<p>If you want a VBA script to do this, try one of the following code samples.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nSet t = Target\nSet a = Range(\"A:A\")\nIf Intersect(t, a) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\nt.Offset(0, 7).Value = Environ(\"username\")\nApplication.EnableEvents = True\nEnd Sub\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim V As Long\nApplication.EnableEvents = False\n\nSet rng1 = Application.Union(Range(\"a1:g1\"), Range(\"H:iv\"))\nSet rng = Application.Intersect(Target, rng1)\nIf Not rng Is Nothing Then Exit Sub\n\nV = Target.Offset(0, 12).Value\nIf Target.Offset(0, 12) = \"\" Then\n    With Range(\"H\" &amp; Target.Row)\n       .Value = Target.Address &amp; \": first entry by \" &amp; Application.UserName &amp; \" at \" &amp; Now()\n       .ColumnWidth = 60\n       .Interior.ColorIndex = 33\n    End With\n    Target.Offset(0, 12).Value = Target.Value\n    Application.EnableEvents = True\n    Exit Sub\nEnd If\nTarget.Offset(0, 12).Value = Target.Value\nWith Range(\"H\" &amp; Target.Row)\n  .Value = Target.Address &amp; \" changed from \" &amp; V &amp; \" to \" &amp; Target.Value &amp; \" by \" &amp; Application.UserName &amp; \" at \" &amp; Now()\n   .ColumnWidth = 60\n  .Interior.Color = vbYellow\nEnd With\nApplication.EnableEvents = True\nEnd Sub\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n        With Target\n            If .Count &gt; 1 Then Exit Sub\n            If Not Intersect(Range(\"A2:A10\"), .Cells) Is Nothing Then\n                Application.EnableEvents = False\n                Sheets(\"Sheet2\").Select\n                If IsEmpty(.Value) Then\n                    .Offset(0, 1).ClearContents\n                Else\n                    With .Offset(0, 1)\n                        .NumberFormat = \"dd mmm yyyy hh:mm:ss\"\n                        .Value = Now\n                    End With\n                End If\n                Sheets(\"Sheet1\").Select\n                Application.EnableEvents = True\n            End If\n        End With\nEnd Sub\n</code></pre>\n\n<p>All of these 'Worksheet_Change' scripts are worksheet events.  You need to right-click your sheet and click 'View Code' then paste the script into the window that opens.  Try one at a time, not all three together.</p>\n"}], "owner": {"reputation": 21, "user_id": 6407570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_90FJ9uVYnY/AAAAAAAAAAI/AAAAAAAAAZQ/5kNAtATwWl8/photo.jpg?sz=128", "display_name": "user6407570", "link": "https://stackoverflow.com/users/6407570/user6407570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1464883091, "creation_date": 1464754868, "last_edit_date": 1495541342, "question_id": 37559370, "link": "https://stackoverflow.com/questions/37559370/tracking-share-drive-users-name-and-opening-time-in-excel", "title": "Tracking Share-drive Users name and opening time in Excel?", "body": "<p>I have found a similar article about my question, as stated below;</p>\n\n<p><a href=\"https://stackoverflow.com/questions/18319162/how-do-i-track-who-uses-my-excel-spreadsheet/18320244#18320244?newreg=2315406bbb484d41b95ace77f114e199\">How do I track who uses my Excel spreadsheet?</a></p>\n\n<p>However, I do like the last coloumn of comment >>\n\"You could also put a time stamp in the next column to show when the spreadsheet was used\"</p>\n\n<p>My question is>  can anyone guide me the possible step or let me copy the code for doing this please? and how to hide the worksheet without anyone noticing?\nMy key is, very importantly, everything must done silently which no one else (other users in sharedrive) could find out i m tracking it. The reason is , i have done lot of research worksheets, and i don't have time/impossible to make every single excel worksheet perfect, i need to prioritize them inorder to be efficient with my time by knowing which one is more important to people. </p>\n\n<p>many thanks~!!   </p>\n"}, {"tags": ["arrays", "vba", "class"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 2926017, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/lLulL.png?s=128&g=1", "display_name": "lukeb28", "link": "https://stackoverflow.com/users/2926017/lukeb28"}, "edited": false, "score": 1, "creation_date": 1464753025, "post_id": 37559040, "comment_id": 62606596, "body": "That was exactly it! Thanks for the help!"}], "tags": [], "owner": {"reputation": 382, "user_id": 5623147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da068ffce1337828392e929ed1e3921c?s=128&d=identicon&r=PG&f=1", "display_name": "Matriac", "link": "https://stackoverflow.com/users/5623147/matriac"}, "is_accepted": true, "score": 1, "last_activity_date": 1464752564, "creation_date": 1464752564, "answer_id": 37559040, "question_id": 37558894, "link": "https://stackoverflow.com/questions/37558894/null-reference-exception-when-writing-to-custom-class/37559040#37559040", "title": "Null Reference Exception when writing to custom class", "body": "<p>When using class in Vb.net, it use the concept of pointer. This mean that each variable point to an object. So when you instantiate your array</p>\n\n<pre><code> Dim mypt(7) As Point\n</code></pre>\n\n<p>it create an array of 8 pointer that each contains the value Nothing. You have to call the constructor of your class Point with</p>\n\n<pre><code>New Point(2,2,3)\n</code></pre>\n\n<p>and make the pointer in your array point to that object.</p>\n\n<pre><code>mypt(1) = New Point(2,2,3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1464765102, "creation_date": 1464765102, "answer_id": 37561779, "question_id": 37558894, "link": "https://stackoverflow.com/questions/37558894/null-reference-exception-when-writing-to-custom-class/37561779#37561779", "title": "Null Reference Exception when writing to custom class", "body": "<p><em>(Posted on behalf of the OP).</em></p>\n\n<p>Got it working thanks to user Matriac! Only change I had to make was this:</p>\n\n<pre><code>    mypt(PtSelect).mC(0) = CDec(IX.Text) 'Error here!\n    mypt(PtSelect).mC(1) = CDec(IY.Text)\n    mypt(PtSelect).mC(2) = CDec(IZ.Text)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>mypt(PtSelect) = New Point(CDec(IX.Text), CInt(IY.Text), CDec(IZ.Text))\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 2926017, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/lLulL.png?s=128&g=1", "display_name": "lukeb28", "link": "https://stackoverflow.com/users/2926017/lukeb28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 37559040, "answer_count": 2, "score": 0, "last_activity_date": 1464765112, "creation_date": 1464751534, "last_edit_date": 1464765112, "question_id": 37558894, "link": "https://stackoverflow.com/questions/37558894/null-reference-exception-when-writing-to-custom-class", "title": "Null Reference Exception when writing to custom class", "body": "<p>So I'm just starting to get into custom classes in VB and running into this error when I attempt to write. I tried to follow the teacher's example, but also wanted to get into some of the more advanced aspects of VB and tried to use an array within my classes, and well, things don't quite work.</p>\n\n<p>Form1 class:</p>\n\n<pre><code>Dim mypt(7) As Point\n\nPrivate Sub Create_Click(sender As Object, e As EventArgs) Handles Create.Click\n    PtSelect = Input()  'Returns an int\n    mypt(PtSelect).mC(0) = CDec(IX.Text) 'Error here!\n    mypt(PtSelect).mC(1) = CDec(IY.Text)\n    mypt(PtSelect).mC(2) = CDec(IZ.Text)\nEnd Sub\n</code></pre>\n\n<p>Point Class:</p>\n\n<pre><code>Public Class Point\nPrivate c(2) As Decimal\n\nPublic Sub New(ByVal X As Decimal, ByVal Y As Decimal, ByVal Z As Decimal)\n    c(0) = X\n    c(1) = Y\n    c(2) = Z\nEnd Sub\n\nPublic Property mC(Val As Integer) As Decimal\n    Get\n        Return c(Val)\n    End Get\n    Set(value As Decimal)\n        c(Val) = value\n    End Set\nEnd Property\nEnd Class\n</code></pre>\n\n<p>Really just unsure what to do past this point, I've fiddled with everything that I could think may be it, but am unsure. My teacher did say that is was possible to use arrays within classes before I ran into the error and I'd like to make it work.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "union"], "comments": [{"owner": {"reputation": 996, "user_id": 1666691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JXMr0.jpg?s=128&g=1", "display_name": "Munsterlander", "link": "https://stackoverflow.com/users/1666691/munsterlander"}, "edited": false, "score": 0, "creation_date": 1540910045, "post_id": 37558385, "comment_id": 93031683, "body": "Wow!  You really edited a question that is over 2.5 years old??"}], "answers": [{"tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": true, "score": 1, "last_activity_date": 1464750545, "last_edit_date": 1464750545, "creation_date": 1464749851, "answer_id": 37558664, "question_id": 37558385, "link": "https://stackoverflow.com/questions/37558385/how-do-i-return-query-results-even-if-the-join-result-is-null-in-ms-access/37558664#37558664", "title": "How do I return query results even if the join result is null in MS Access?", "body": "<p>Turning it into a subquery might give you what you need:</p>\n\n<pre><code>SELECT PRIORITIES.PROFILE_FID, tblAssignments.NM,\n PRIORITIES.PRIORITY\nFROM tblAssignments LEFT JOIN \n(SELECT ASSGNMNT_FID, PROFILE_FID, PRIORITY\n FROM tblProfileForAssignments \n WHERE PROFILE_FID = [Forms]![frmProfileAssignments]![cmboProfile]) PRIORITIES\nON tblAssignments.ID = PRIORITIES.ASSGNMNT_FID \n</code></pre>\n\n<p>This should return all assignment names along with any assignments for the specified profile.  The query in your example would not display records if assignments for any profile existed and the current profile had no assignments made.</p>\n"}], "owner": {"reputation": 996, "user_id": 1666691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JXMr0.jpg?s=128&g=1", "display_name": "Munsterlander", "link": "https://stackoverflow.com/users/1666691/munsterlander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 37558664, "answer_count": 1, "score": 2, "last_activity_date": 1540828834, "creation_date": 1464747416, "last_edit_date": 1540828834, "question_id": 37558385, "link": "https://stackoverflow.com/questions/37558385/how-do-i-return-query-results-even-if-the-join-result-is-null-in-ms-access", "title": "How do I return query results even if the join result is null in MS Access?", "body": "<p>I have 3 tables.  </p>\n\n<p>One contains Profiles as described below:</p>\n\n<pre><code>ID  NM\n==============\n1   Profile A\n2   Profile B\n</code></pre>\n\n<p>The second contains assignments:</p>\n\n<pre><code>ID  NM\n==============\n1   Assignment A\n2   Assignment B\n</code></pre>\n\n<p>My third contains FID's for both and allows you to prioritize them like so:</p>\n\n<pre><code>ID  P_FID  A_FID  PRIORITY\n========================\n1   1       2      1\n2   1       1      2\n</code></pre>\n\n<p>My problem is populating the third table via a continuous form so the end user has the ability to input priorities.  Basically, there is a combo box that lets the user select the appropriate profile.  If there are no entries in the third table, it should show you all of the assignments so you can input priorities.  If there are already records in that table it should retrieve those values so you can update the priorities.</p>\n\n<p>The following query works great as long as the third table is empty.  Once the user inputs priorities and tries to switch to a different profile, it doesn't return any records unless it is the selected profile.</p>\n\n<pre><code>SELECT tblProfileForAssignments.PROFILE_FID,\n       tblAssignments.NM,\n       tblProfileForAssignments.PRIORITY\nFROM tblAssignments\nLEFT JOIN tblProfileForAssignments ON tblAssignments.ID = tblProfileForAssignments.ASSGNMNT_FID\nWHERE (tblProfileForAssignments.PROFILE_FID = Forms!frmProfileAssignments!cmboProfile)\n  OR (tblProfileForAssignments.PROFILE_FID IS NULL);\n</code></pre>\n\n<p>Can this be done in a single query utilizing a union, I would think, or should I just revert to VBA to figure this out?  Like I said, it works great as long as the third table is empty or they only work on the first profile they select, beyond that it fails.  Does this make sense?</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464744088, "post_id": 37557795, "comment_id": 62604474, "body": "Does your code work as intended, or there&#39;s something that needs to change in <i>what</i> it&#39;s doing? If it <i>does</i> work as it should, and you&#39;re looking for feedback on any/all aspects of your code and/or change <i>how</i> it does what it does, then you could <a href=\"http://meta.codereview.stackexchange.com/q/5777/23788\">consider posting on Code Review</a>."}, {"owner": {"reputation": 47, "user_id": 6407077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/793c7f3dd6eea37e69fd59b8099ca0d0?s=128&d=identicon&r=PG&f=1", "display_name": "ABowering", "link": "https://stackoverflow.com/users/6407077/abowering"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464832602, "post_id": 37557795, "comment_id": 62649627, "body": "Hi Matt, trying to get part of the HTML code by a certain string rather than by tag id or by line number. Code doesn&#39;t work currently and I think the problem lies within the Set V = ie.document.getelementbyid(&quot;src&quot;) line."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530710658, "post_id": 37557795, "comment_id": 89332296, "body": "You cut your HTML off at the point where you say you actually want information."}], "owner": {"reputation": 47, "user_id": 6407077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/793c7f3dd6eea37e69fd59b8099ca0d0?s=128&d=identicon&r=PG&f=1", "display_name": "ABowering", "link": "https://stackoverflow.com/users/6407077/abowering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464742242, "creation_date": 1464742191, "last_edit_date": 1464742242, "question_id": 37557795, "link": "https://stackoverflow.com/questions/37557795/vba-html-javascript-scraping-by-line-number-or-string", "title": "VBA html/javascript scraping by line number or string", "body": "<p>ers,\nI am trying to create a vba based html web scraper to gather some data. The data I am trying to scrape is from javascript that looks similar to this: \n      </p>\n\n<pre><code>  &lt;script src=\"https://d1fkb6ohkxde1z.cloudfront.net/assets/common-bundle-     a24f15b690f23a668028e412a6d5243a1b0eeac497627def104363c0941da290.js\"&gt;&lt;/script&gt;\n &lt;script src=\"https://d1fkb6ohkxde1z.cloudfront.net/assets/private-57441f796e1722a6986c300e765cb19ea439a663b341a68647ebdb60252a0682.js\"&gt;&lt;/script&gt;\n\n  &lt;script&gt;\n  $('#onboardingModal').modal('show')  \n  var silo = $profarmer.currentSilo;\n\n  silo.service_url = 'https://prices.profarmergrain.com.au/';\n  silo.clear_service_url = 'https://www.cleargrain.com.au';\n  silo.bhc_site_name = 'Port Adelaide Zone';\n  silo.bhc_site_type = 'PortZone';\n  silo.port_name = 'Port Adelaide';\n  silo.bhc_site_type = 'PortZone';\n  silo.bulk_handler_code = 'Zone';\n  silo.bulk_handler_name = 'Port Prices';\n  silo.grain_type = 'Wheat';\n  silo.grain_season = '2015';\n  silo.initBinGradeSelector(true, 'APW1',  [{\"code\":\"APW1\",\"description\":\"Australian Premium White Wheat No 1\",\"seasons\":[\"2015\",\"2016\",\"2014\"]},{\"code\":\"H1\",\"description\":\"Hard Wheat No 1\",\"seasons\":[\"2015\",\"2016\",\"2014\"]},{\"code\":\"H2\",\"description\":\"Hard Wheat No 2\",\"seasons\":[\"2015\",\"2016\",\"2014\"]},{\"code\":\"HPS1\",\"description\":\"Wheat - High Protein Screenings No1\",\"seasons\":[\"2015\"]},{\"code\":\"AUH2\",\"description\":\"Australian Hard Varieties Wheat (Utility Grade)\",\"seasons\":[\"2015\",\"2014\"]},{\"code\":\"APW1 FMG\",\"description\":\"APW1 Floating Spread Multi-Grade\",\"seasons\":[\"2015\",\"2016\"]},{\"code\":\"APW1 MG\",\"description\":\"Multigrade APW1\",\"seasons\":[\"2015\",\"2016\",\"2017\"]},{\"code\":\"ASW1\",\"description\":\"Australian Standard White Varieties Wheat\",\"seasons\":[\"2016\",\"2015\",\"2014\"]},{\"code\":\"AGP1\",\"description\":\"Australian General Purpose No.1\",\"seasons\":[\"2015\",\"2016\",\"2014\"]},{\"code\":\"AUW1\",\"description\":\"Utility Wheat\",\"seasons\":[\"2015\",\"2014\"]},{\"code\":\"FED1\",\"description\":\"Feed Wheat\",\"seasons\":[\"2015\",\"2016\"]},{\"code\":\"SFW1\",\"description\":\"Stock Feed Winter Wheat\",\"seasons\":[\"2015\"]},{\"code\":\"DR1\",\"description\":\"Durum Wheat No.1 Grade - Protein 13.2%\",\"seasons\":[\"2015\"]},{\"code\":\"DR1 MG\",\"description\":\"Multigrade Durum No.1\",\"seasons\":[\"2016\"]},{\"code\":\"DR2\",\"description\":\"Durum Wheat No.2 Grade - Protein Target 12.0%\",\"seasons\":[\"2015\"]},{\"code\":\"DR3\",\"description\":\"Durum Wheat No.3 Protein No Min\",\"seasons\":[\"2015\"]},{\"code\":\"SFE1\",\"description\":\"Soft Wheat No.1 Grade\",\"seasons\":[\"2015\"]}]);\n silo.pricing_label = 'Port Zone Bid';\n silo.port_equivalent = false;\n silo.tradable  = false;\n silo.freight_rate = 0.0;\n\n React.mount({\n \"price-chart\": $profarmer.components.PriceChart,\n \"price-search\": $profarmer.components.PriceSearch,\n \"merchant-prices\": $profarmer.components.MerchantPrices,\n \"clear-grain-prices\": $profarmer.components.ClearGrainPrices,\n \"market-commentary\": $profarmer.components.MarketCommentary,\n }, {\n props: {\n snapshot: {\"bhc_site_name\":\"Port Adelaide Zone\",\"port_name\":\"Port Adelaide\",\"grain_type_name\":\"Wheat\",\"grain_season_start_year\":2015,\"bulk_handler_code\":\"Zone\",\"bulk_handler_name\":\"Port Prices\",\"market_prices\":{\"APW1\":{\"2015\":{\"port_price\":\"266.0\",\"price\":\"266.0\",\"price_high_movement\":\"-4.0\",\"prices_last_updated_at\":\"2016-05-31T06:10:05.000Z\"},\"2016\":{\"port_price\":\"255.0\",\"price\":\"255.0\",\"price_high_movement\":\"-6.0\",\"prices_last_\n</code></pre>\n\n<p>And continues with a few hundred more prices in a similar format. Ideally I would scrap everything from the line \"props:\" onwards. I have a simple code to rearrange the text once in excel, but my vba code to scrape the html/java is having some troubles.</p>\n\n<pre><code>   Sub ie_open()\n   Dim wb As Workbook\n   Dim ws As Worksheet\n   Dim TxtRng As Range\n   Dim ie As Object\n\n   Set ie = CreateObject(\"INTERNETEXPLORER.APPLICATION\")\n   ie.NAVIGATE \"https://www.profarmergrain.com.au/prices/port-adelaide-zone/Zone/wheat\"\n   ie.Visible = True\n\n   While ie.ReadyState &lt;&gt; 4\n    DoEvents\n   Wend\n\n   Dim V As Variant\n   Set V = ie.document.getelementbyid(\"src\") ' - need better code here\n\n   Set wb = ActiveWorkbook\n   Set ws = wb.Sheets(\"Sheet7\")\n   Set TxtRng = ws.Range(\"A1\")\n   TxtRng = V.innertext\n\n   End Sub\n</code></pre>\n\n<p>I am not sure if there is a better way to scrape an element. Instead of by id or tag, is there a way to scrape by either line number or by  or by a string number?</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1464762578, "last_edit_date": 1495541292, "creation_date": 1464762578, "answer_id": 37561018, "question_id": 37557482, "link": "https://stackoverflow.com/questions/37557482/create-hyperlink-to-sheet-in-cell-vba/37561018#37561018", "title": "Create Hyperlink to sheet in cell VBA", "body": "<p>The reason the links aren't working might be because you use the worksheet object <code>sh</code> without declaring it, and specifically, without declaring it as the new sheet.</p>\n\n<p>In my solution I've only tested it using the <code>.Add</code> method that I included out-commented.</p>\n\n<pre><code>Sub test()\n    Dim sh As Worksheet, nsh As Worksheet ' sh = YYY, nsh = codename\n    Dim nrng As Range\n    Dim codename As String\n    Dim lastrow As Long\n    Dim cont As Worksheet\n\n    codename = InputBox(\"What is the codename?\")\n\n    Set sh = Sheets(\"YYY\")\n\n    Sheets(\"XXX\").Visible = True\n    Sheets(\"XXX\").Copy After:=Worksheets(\"YYY\")\n    ActiveWindow.ActiveSheet.Name = codename\n    Sheets(\"XXX\").Visible = False\n    'Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = codename ' if needed\n\n    sh.Activate\n    lastrow = sh.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    sh.Hyperlinks.Add _\n        Anchor:=sh.Range(\"B\" &amp; lastrow), _\n        Address:=\"\", _\n        SubAddress:=\"'\" &amp; codename &amp; \"'!A1\", _\n        TextToDisplay:=codename\nEnd Sub\n</code></pre>\n\n<p>Shamelessly stolen from <a href=\"https://stackoverflow.com/a/36932431/4604845\">myself</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1464763047, "creation_date": 1464763047, "answer_id": 37561166, "question_id": 37557482, "link": "https://stackoverflow.com/questions/37557482/create-hyperlink-to-sheet-in-cell-vba/37561166#37561166", "title": "Create Hyperlink to sheet in cell VBA", "body": "<pre><code>Sub Tester()\n\n    DoHyperlink Sheets(\"Sheet1\").Range(\"F10\"), _\n           Sheets(\"Sheet 2\").Range(\"E12\"), _\n           \"Click Me\"\n\nEnd Sub\n\n'assumes rngFrom and rngTo are in the same workbook...\nSub DoHyperlink(rngFrom As Range, rngTo As Range, LinkText As String)\n\n    rngFrom.Parent.Hyperlinks.Add Anchor:=rngFrom, Address:=\"\", _\n            SubAddress:=\"'\" &amp; rngTo.Parent.Name &amp; \"'!\" &amp; rngTo.Address(), _\n            TextToDisplay:=LinkText\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1464764278, "creation_date": 1464764278, "answer_id": 37561521, "question_id": 37557482, "link": "https://stackoverflow.com/questions/37557482/create-hyperlink-to-sheet-in-cell-vba/37561521#37561521", "title": "Create Hyperlink to sheet in cell VBA", "body": "<p>If I get you right, you are trying to do this... But don't understand why it's \"YYY\" (not dynamic).</p>\n\n<pre><code>Option Explicit\n\nSub AddSheetAndLinkIt()\n    Dim codename As String\n    Dim oWS As Worksheet, oRng As Range\n\n    codename = InputBox(\"What is the codename?\")\n    ' Check if codename already exists\n    On Error Resume Next\n    Set oWS = ThisWorkbook.Worksheets(codename)\n    If Not oWS Is Nothing Then\n        MsgBox \"The worksheet for \"\"\" &amp; codename &amp; \"\"\" already exists! You cannot create it again.\", vbExclamation + vbOKOnly\n        Exit Sub\n    End If\n    ' Copy worksheet \"XXX\" and add hyperlink to \"YYY\"\n    Set oWS = ThisWorkbook.Worksheets(\"YYY\")\n    Set oRng = oWS.Range(\"B\" &amp; Rows.Count).End(xlUp)\n    ThisWorkbook.Worksheets(\"XXX\").Copy After:=oWS\n    With ThisWorkbook.Worksheets(\"XXX (2)\")\n        .Name = codename\n        .Visible = True\n        .Activate\n    End With\n    oWS.Hyperlinks.Add oRng, \"\", \"'\" &amp; codename &amp; \"'!A1\", \"Go to \" &amp; codename, codename\n    Set oRng = Nothing\n    Set oWS = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6407004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88aa6c449845d59167e62c373ba98305?s=128&d=identicon&r=PG&f=1", "display_name": "KinggPush", "link": "https://stackoverflow.com/users/6407004/kinggpush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8394, "favorite_count": 0, "accepted_answer_id": 37561018, "answer_count": 3, "score": 2, "last_activity_date": 1464764278, "creation_date": 1464739467, "question_id": 37557482, "link": "https://stackoverflow.com/questions/37557482/create-hyperlink-to-sheet-in-cell-vba", "title": "Create Hyperlink to sheet in cell VBA", "body": "<p>I have looked at many posts and cannot seem to get this right.  I have a userform that take a codename and then creates a sheet with that name, then adds a link to the new sheet as the last cell in Column B on another sheet.  I have used 3 different methods to insert the hyperlink, but all of them just return a blank cell, while if I change the value to any string, it works.</p>\n\n<pre><code>    Dim sh As Worksheet\n    Dim codename As String\n    Dim lastrow As Long\n    Dim cont As Worksheet\n\n    On Error Resume Next\n\n    Application.ScreenUpdating = False\n\n\n    codename = InputBox(\"What is the codename?\")\n\n\n    Sheets(\"XXX\").Visible = True\n    Sheets(\"XXX\").Copy After:=Worksheets(\"YYY\")\n    ActiveWindow.ActiveSheet.name = codename\n    Sheets(\"XXX\").Visible = False\n\n    Worksheets(YYY).Activate\n    lastrow = Sheets(\"YYY).Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    ActiveSheet.Range(\"B\" &amp; lastrow).End(xlUp).Offset(1).Hyperlinks.Add Anchor:=ActiveCell, Address:=\"\", SubAddress:=sh &amp; \"!A1\", TextToDisplay:=codename\n    ActiveSheet.Range(\"B\" &amp; lastrow).End(xlUp).Offset(2).Activate\n    ActiveCell.Hyperlinks.Add Anchor:=ActiveCell, Address:=\"\", SubAddress:=sh.name &amp; \"!A1\", TextToDisplay:=codename\n    ActiveSheet.Range(\"B\" &amp; lastrow).End(xlUp).Offset(3) = codename\n    ActiveSheet.Range(\"B\" &amp; lastrow).End(xlUp).Offset(4).Hyperlinks.Add Anchor:=Sheets(codename).Cells(1, 1), _\n                  Address:=\"\", SubAddress:=sh, TextToDisplay:=codename\n\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>I know I have 4 iterations of essentially the same thing.  The point is is that no matter if I use 1 of them, or all 4, I get 3 blank cells and (codename) as plaintext, showing that I am obviously missing something easy that I for the life of me cannot figure out.  Thanks to all responses.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464734481, "post_id": 37555842, "comment_id": 62602216, "body": "Ok makes sense. How would I direct the AutoFilter results to the proper cells in the PO&#39;s tab? Thanks for the help."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464791248, "post_id": 37555842, "comment_id": 62630430, "body": "Looking at your explanation above, you appear to be looking for &#39;00&#39; first then &#39;01&#39; and so forth. You want these to be arranged as such i would guess?   Perhaps use a loop counter starting as 00 and increasing by 1 each time. Something like Dim Counter as Long, Counter = 0, in the loop have an if counter equal to or more than 10 then Criteria1:= &quot;=&quot; &amp; Counter Else Criteria1 = &quot;=0&quot; &amp; Counter... Then use the last row formula you already have to find the destination cell. Cant hit next line with any known keyboard shorcuts in this comment field so sorry about the format here."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464802701, "post_id": 37555842, "comment_id": 62637908, "body": "Just to clarify (hopefully), the VBA would recognize the Category selected from the drop down in Column G and copy the total quantity in column S and extended cost in Column Z to the last row available in the POs tab is the column for the correct month which can be found on the New Po&#39;s tab in cell T12. When the category changes for example from 00 to 01, it should drop to the next row on the PO&#39;s tab and change category as well. I have categories from 00-99 as possible options."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464806961, "post_id": 37555842, "comment_id": 62640183, "body": "Okay, I think I have got it but Imgur is blocked at work so i can&#39;t take a look at your sample data. I will solve this tonight once I get home. I have built the loop that I think is the answer but I need to see your sample data so that I know exactly what it is you want."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464810231, "post_id": 37555842, "comment_id": 62641807, "body": "Appreciate the help. I&#39;m happy to send the document to you as well if needed. I&#39;m quite stuck at this point."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464881882, "post_id": 37555842, "comment_id": 62677683, "body": "Wow, there&#39;s a lot going on this spreadsheet. A little more description of what&#39;s going on will help me out here. I have built a mock of the screenshots you provided. My understanding would be: All of the category 00&#39;s totaled from NEW PO to a single PO on the POs tab. Then cat 01&#39;s and so forth. I am guessing that then the target month from T12 will be the destination for the total cost? So with the example data, 3 PO&#39;s would be made each for 1 quantity but different costs?"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464885987, "post_id": 37555842, "comment_id": 62680324, "body": "Yes that is all correct. On the New PO&#39;s tab and order for products would be written but could contain category 00 and 01 lets say for an order. It could be 20 total items with 10 being category 00 and 10 being category 01. It would be slick if the VBA would capture the total of 00 and 01 and put it in the correct month on the PO&#39;s tab. I&#39;m basically trying to make the PO&#39;s tab the final destination for all orders. That way the New PO tab can be cleared and start over. Currently these are two separate documents and requires double the work."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464965111, "post_id": 37555842, "comment_id": 62717224, "body": "Your script looks great. I have applied it to the document and get no error messages, but it does not seem to be copying anything. I did update a couple of cells/ranges that looked off. I&#39;ll keep looking at the code to see where its off.  Here is a link to the two tabs I am working with, maybe you&#39;ll see something: <a href=\"https://www.dropbox.com/s/lmzr30auj8tzg5a/test.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/lmzr30auj8tzg5a/test.xlsx?dl=0</a>"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1464972054, "post_id": 37555842, "comment_id": 62721546, "body": "Ok everything is working except for the transfer of the extended cost to the correct month. No extended cost is transferring. I put the corrected VBA in my first post. There is something not working with the recognition of the date in T12 and the month in the POs tab. Any thoughts?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465069589, "post_id": 37555842, "comment_id": 62750488, "body": "Okay, i&#39;ll take a look tomorrow. Was out of the office yesterday and am out for a drink today. I have assumed that T12 is in the format of MMM the same as the momths it is checking. What is the actual output value in T12?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465069832, "post_id": 37555842, "comment_id": 62750561, "body": "Anticipated receipt date fields appear in that drop box as &#39;-&#39; but these need to match exactly the output value in T12 for the code to work as it is."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465129662, "post_id": 37555842, "comment_id": 62763528, "body": "Ok that sounds like it will solve the issue. I had some cell formate issues when you first sent the code. I didn&#39;t bring the file from work and won&#39;t be able to check until Tuesday. Thanks for the help and I&#39;ll let you know."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465307513, "post_id": 37555842, "comment_id": 62839622, "body": "I&#39;ve verified all the cell formats and it seems to match what is required but I still have no Totals transferring to the POs tab. Here is a document which matches the two tabs I am working with: <a href=\"https://www.dropbox.com/s/z8oo4x7ebcdcg0c/test%20new.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/z8oo4x7ebcdcg0c/test%20new.xlsm?dl=0</a>  I appreciate your help, let me know if you see anything causing this to not work."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465308098, "post_id": 37555842, "comment_id": 62840022, "body": "I can&#39;t see cell T12, I have to load the dropbox on my phone so I can&#39;t play around to find it. What is the output in Cell T12 on the POs tab?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465308426, "post_id": 37555842, "comment_id": 62840274, "body": "could try change the if statement to if Month(cell.value) = Month(.Range(&quot;T12&quot;).Value) and see what that does?"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465309617, "post_id": 37555842, "comment_id": 62841147, "body": "Error is &quot;argument is not optional&quot; using the new if statement.   In V12 I put &quot;=T12&quot; and set the value to mmm on the New POs tab. In the PO tab the months in range L122:W122 are also set to mmm format"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465316972, "post_id": 37555842, "comment_id": 62846438, "body": "ignore the new if statement then. Try changing the range L122:W122 to Jan Feb Mar etc rather that a date with custom format, I believe that&#39;s waht I would have done when i knocked up the original code. T12 can be a date in MMM format though as I did tweak this. Very busy today so not going to be able to rebuild it and try anything"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465317082, "post_id": 37555842, "comment_id": 62846489, "body": "the other if statement should work if both T12 and  range L122:W122 are actual dates that are formatted as MMM as it changes the date value into an integer from 1 to 12 based on the month."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 1, "creation_date": 1465319099, "post_id": 37555842, "comment_id": 62847715, "body": "Ok success sort of. I got it to copy totals but they are going in the wrong month based on the date in T12  For Each cell In MonthRng            If Month(cell.Value) = Month(.Range(&quot;T12&quot;).Value) Then                 Col = cell.Column                 .Cells(PORow, Col).Value = Total"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465329314, "post_id": 37555842, "comment_id": 62853481, "body": "Try changing L122:W122 to text &quot;Jan&quot; &quot;Feb&quot; Mar Apr etc. etc. then use that V12 MMM format you had and dim it as String (called it StrTarget here):    <code>For Each cell In MonthRng If cell.Value = StrTarget Then Col = cell.Column .Cells(PORow, Col).Value = Total</code>       Should work... If it answers the query please remember to mark my answer as helpful... i will update the code to reflect this change. Thanks"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465331362, "post_id": 37555842, "comment_id": 62854554, "body": "Yes that solved the issue! Thanks for all your help! I have updated my original post with the final code."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1465390239, "post_id": 37555842, "comment_id": 62880031, "body": "Glad I was of help here"}], "tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": true, "score": 0, "last_activity_date": 1464888157, "last_edit_date": 1464888157, "creation_date": 1464729662, "answer_id": 37555842, "question_id": 37555692, "link": "https://stackoverflow.com/questions/37555692/copy-and-paste-based-on-filter/37555842#37555842", "title": "Copy and paste based on filter", "body": "<p>Okay, this seems to fit what you want it to do, please let me know if it doesn't.</p>\n\n<p>It's a bit long as I just whacked this together between meetings but it does the job. You can use the row and column indexes to manipulate any other data you wish to pull across or amend which cost you want to be totaled up.</p>\n\n<pre><code>Sub Test()\n\nDim Count, Qty As Long\nDim CatRng, MonthRng As Range\nDim Total As Currency\nDim Row, PORow, Col As Integer\n\n\nSet CatRng = Sheets(\"NEW PO\").Range(\"G19:G43\")\nSet MonthRng = Sheets(\"POs\").Range(\"L122:W122\")\nCount = 0\n\n\n    For Count = 0 To 99\n\n    Total = 0\n    Qty = 0\n    'So that the values reset each time the cat changes\n\n            For Each Cell In CatRng\n            'To get the row number then total the required information\n                If Cell.Value = Count Then\n                Row = Cell.Row\n                Qty = Qty + Sheets(\"NEW PO\").Range(\"T\" &amp; Row).Value\n                Total = Total + Sheets(\"NEW PO\").Range(\"AA\" &amp; Row).Value\n                'I guessed ext cost only as it has been totaled at the bottom,\n                'this is easily changed though\n                End If\n            Next Cell\n\n\n        'Now put the totals into a PO only if there is a quantity of items\n        If Qty &gt; 0 Then\n        PORow = Sheets(\"POs\").Range(\"J1048576\").End(xlUp).Row + 1\n\n        'I'll let you sort the PO number and other fields out but the main 3 are done below\n        With Sheets(\"POs\")\n            .Range(\"I\" &amp; PORow).Value = Qty\n            .Range(\"J\" &amp; PORow).Value = Count\n            'My understanding here is that the target month in T12 is in the same format as\n            'the anticipated Receipt month, I hope this is what you were looking for\n\n        For Each Cell In MonthRng\n            If Cell.Value = .Range(\"T12\").Value Then\n                Col = Cell.Column\n                .Cells(PORow, Col).Value = Total\n                'Used .cells here as both column and row are now integers\n                '(only way i can ever get it to work)\n            End If\n        Next Cell\n\n        End With\n        End If\n\n\n    Next Count\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 1, "accepted_answer_id": 37555842, "answer_count": 1, "score": 0, "last_activity_date": 1554744621, "creation_date": 1464729098, "last_edit_date": 1554744621, "question_id": 37555692, "link": "https://stackoverflow.com/questions/37555692/copy-and-paste-based-on-filter", "title": "Copy and paste based on filter", "body": "<p>I want to execute a copy and paste function based upon certain criteria being selected.</p>\n\n<p>I have a macro to clear the data in the \"NEW PO\" tab once an \"order\" is written and the information is copied to the \"POs\" tab.</p>\n\n<p>A copy and paste script copies 3 cells from the \"NEW PO\" tab to the \"POs\" tab.</p>\n\n<pre><code>Sub Copy_Data()\n\nDim Count, Qty As Long\nDim CatRng, MonthRng, SDate, CxlDate, PoNumb, Vendor As Range\nDim Total As Currency\nDim StrTarget As String\nDim Row, PORow, Col As Integer\n\nSet CatRng = Sheets(\"NEW PO\").Range(\"G20:G43\")\nSet MonthRng = Sheets(\"POs\").Range(\"L122:W122\")\nStrTarget = Sheets(\"New PO\").Range(\"V12\")\nSet SDate = Sheets(\"New PO\").Range(\"T12\")\nSet CxlDate = Sheets(\"New PO\").Range(\"T13\")\nSet PoNumb = Sheets(\"New PO\").Range(\"N10\")\nSet Vendor = Sheets(\"New PO\").Range(\"D14\")\nCount = 0\n\nFor Count = 0 To 99\n\n    Total = 0\n    Qty = 0\n    'So that the values reset each time the cat changes\n\n    For Each cell In CatRng\n        'To get the row number then total the required information\n        If cell.Value = Count Then\n            Row = cell.Row\n            Qty = Qty + Sheets(\"NEW PO\").Range(\"S\" &amp; Row).Value\n            Total = Total + Sheets(\"NEW PO\").Range(\"Z\" &amp; Row).Value\n            'I guessed ext cost only as it has been totaled at the bottom,\n            'this is easily changed though\n        End If\n    Next cell\n\n    'Now put the totals into a PO only if there is a quantity of items\n    If Qty &gt; 0 Then\n        PORow = Sheets(\"POs\").Range(\"K1048576\").End(xlUp).Row + 1\n\n        'I'll let you sort the PO number and other fields out but the main 3     are done below\n        With Sheets(\"POs\")\n            .Range(\"I\" &amp; PORow).Value = Qty\n            .Range(\"K\" &amp; PORow).Value = Count\n            .Range(\"C\" &amp; PORow).Value = SDate\n            .Range(\"D\" &amp; PORow).Value = CxlDate\n            .Range(\"B\" &amp; PORow).Value = PoNumb\n            .Range(\"F\" &amp; PORow).Value = Vendor\n            'My understanding here is that the target month in T12 is in the same format as\n            'the anticipated Receipt month, I hope this is what you were looking for\n\n            For Each cell In MonthRng\n                If cell.Value = StrTarget Then\n                    Col = cell.Column\n                    .Cells(PORow, Col).Value = Total\n                    'Used .cells here as both column and row are now integers\n                    '(only way i can ever get it to work)\n                End If\n            Next cell\n\n        End With\n    End If\n\nNext Count\n\nEnd Sub\n</code></pre>\n\n<p>I want to filter/validate the quantity (column S) Column Z and extended cost from the \"NEW PO\" tab based on the <strong>category</strong> selected in Column G. I then want to paste that to the \"POs\" tab, under the correct month the order is being written, which is determined by the start date in cell T12 on the \"NEW PO\" tab.</p>\n\n<p>Additionally when the category changes, for example from 00 to 01, it should drop to the next row on the \"POs\" tab and change category as well.</p>\n\n<p>Screen shots of the two tabs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NFTmG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NFTmG.png\" alt=\"PO tab\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9OlSV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9OlSV.png\" alt=\"New PO Tab\"></a></p>\n"}, {"tags": ["excel", "import", "ms-word", "createoleobject", "vba"], "comments": [{"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1464733085, "post_id": 37555569, "comment_id": 62601767, "body": "Can you upload the Word document somewhere or add steps to recreate it with the content you would like to copy?"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1464765714, "post_id": 37555569, "comment_id": 62611784, "body": "how could it be in the clipboard if you never use a <code>.copy</code>? what in the world is <code>selection.verb</code> ??? shouldn&#39;t it be <code>selection.copy</code>? why using a <code>.select</code>if your objectif is a <code>.copy</code> ???"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1464784008, "post_id": 37555569, "comment_id": 62624285, "body": "When using a macro recorder for the entire process of inserting an object into excel, the output of the VBA code is essentially the last 4 lines of code starting at &quot;ActiveSheet...&quot; The macro recorder works, but the &quot;filename&quot; path is static, as in it will only open the filename of whatever file you opened while recording the macro."}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1464784191, "post_id": 37555569, "comment_id": 62624408, "body": "I can&#39;t upload the document as it is sensitive material, but creating a table in MS word with x rows and 1 column is essentially the format of the table I&#39;m importing into excel."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1465584014, "post_id": 37713643, "comment_id": 62979732, "body": "Unfortunately, and I should have mentioned this, but I need the imported information to keep the same formatting as it had in the word document i.e. Underline &amp; bold. Otherwise I would have created a text file out of the word document and imported it that way."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 1, "creation_date": 1465598629, "post_id": 37713643, "comment_id": 62985559, "body": "See this link: <a href=\"http://stackoverflow.com/questions/12245525/how-to-preserve-source-formatting-while-copying-data-from-word-table-to-excel-sh\" title=\"how to preserve source formatting while copying data from word table to excel sh\">stackoverflow.com/questions/12245525/&hellip;</a>  Also, I&#39;m sure you can apply formatting in Excel, once all the data is imported."}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1465833330, "post_id": 37713643, "comment_id": 63054553, "body": "Thank you! That link was perfect!"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1465422971, "creation_date": 1465422971, "answer_id": 37713643, "question_id": 37555569, "link": "https://stackoverflow.com/questions/37555569/copying-pasting-information-from-microsoft-word-oleobject-to-excel-file-via-vb/37713643#37713643", "title": "Copying &amp; Pasting information from Microsoft Word OLEObject to Excel file via VBA", "body": "<p>From Word to Excel, should be something like this.</p>\n\n<pre><code>Sub ImportFromWord()\n\n'Activate Word Object Library\n\n'Dim WordApp As Word.Application    \nDim WordDoc As Word.Document\n\nSet WordApp = CreateObject(\"word.application\") ' Open Word session\n\nWordApp.Visible = False 'keep word invisible\nSet WordDoc = WordApp.Documents.Open(\"C:\\Users\\your_path_here_\\WordFile.docx\") ' open Word file\n\n'copy third row of first Word table\nWordDoc.Tables(1).Rows(3).Range.Copy\n\n'paste in Excel\nRange(\"A1\").PasteSpecial xlPasteValues\n\nWordDoc.Close 'close Word doc\nWordApp.Quit ' close Word\n\nEnd Sub\n</code></pre>\n\n<p>Or this.</p>\n\n<pre><code>Sub GetTables() \n\nFName = Application _ \n.GetOpenFilename(\"Word Files (*.doc), *.doc\") \n\nSet WordObject = GetObject(FName) \n\nFirst = True \nRowCount = 2 \nFor Each Tble In WordObject.tables \nFor i = 1 To 22 \nIf First = True Then \nData = Tble.Rows(i).Cells(1).Range \n'Remove cell markers \nCells(1, i) = Left(Data, Len(Data) - 2) \nEnd If \nData = Tble.Rows(i).Cells(2).Range.Text \n'Remove cell markers \nCells(RowCount, i) = Left(Data, Len(Data) - 2) \nNext i \nRowCount = RowCount + 1 \nFirst = False \nNext Tble \nWordObject.Close savechanges = False \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "is_accepted": false, "score": 0, "last_activity_date": 1465845345, "last_edit_date": 1495541802, "creation_date": 1465845345, "answer_id": 37797490, "question_id": 37555569, "link": "https://stackoverflow.com/questions/37555569/copying-pasting-information-from-microsoft-word-oleobject-to-excel-file-via-vb/37797490#37797490", "title": "Copying &amp; Pasting information from Microsoft Word OLEObject to Excel file via VBA", "body": "<p>Using the code from the link <a href=\"https://stackoverflow.com/questions/12245525/how-to-preserve-source-formatting-while-copying-data-from-word-table-to-excel-sh\">How to preserve source formatting while copying data from word table to excel sheet using VB macro?</a> , I've only been able to get the code to work when the macro pastes my Word table in a whole new separate workbook. When clicking a command button that's within the excel workbook that I want to import the Word table to, the table never pastes into the sheet called \"Scraping Sheets\" I've messed around with the code, but the closest thing I could get was placing the entire table into one cell with all formatting lost. </p>\n\n<pre><code>Private Sub CommandButton22_Click()\nDim oWordApp As Object, oWordDoc As Object\nDim FlName As String\nDim tbl As Object\n\nFlName = Application.GetOpenFilename(\"Word files (*.Doc*),*.Doc*\", , _\n\nOn Error Resume Next\nSet oWordApp = GetObject(, \"Word.Applicaton\")\n\nIf Err.Number &lt;&gt; 0 Then\n    Set oWordApp = CreateObject(\"Word.Application\")\nEnd If\nErr.Clear\nOn Error GoTo 0\n\noWordApp.Visible = True\n\n\nSet oWordDoc = oWordApp.Documents.Open(FlName)\n\nSet tbl = oWordDoc.Tables(1)\n\nDim wb As Workbook, ws As Worksheet\n\nSet wb = Workbooks.Open(\"\"C:\\Users\\xxxx\\Desktop\\292 Int'l_Weekly_Win_Loss_YYYY MM DD TEMPLATE.xlsm\"\")\n\nSet ws = wb.Sheets(\"Scraping Sheet\")\n\ntbl.Range.Copy\n\nws.Range(\"A1\").Activate\n\nws.Paste\n\nMsgBox \"Successfully Added File!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465845345, "creation_date": 1464728634, "last_edit_date": 1531161705, "question_id": 37555569, "link": "https://stackoverflow.com/questions/37555569/copying-pasting-information-from-microsoft-word-oleobject-to-excel-file-via-vb", "title": "Copying &amp; Pasting information from Microsoft Word OLEObject to Excel file via VBA", "body": "<p>My issue is after I have imported a table from Microsoft Word into Excel by creating an OLEObject, it won't let me copy and paste the table into excel. It continually keeps pasting whatever was last copied on my clipboard into the first cell. Currently my code asks the user for the file name, opens that file as an OLEObject in the active excel sheet, and then pastes the incorrect information into cell A1. It's not copying and pasting what's inside the Word OLEObject.</p>\n\n<pre><code> Sub Macro1()\n    Dim FName As String, FD As FileDialog\n    Dim ExR As Range\n    Set FD = Application.FileDialog(msoFileDialogOpen)\n    FD.Show\n    If FD.SelectedItems.Count &lt;&gt; 0 Then\n        FName = FD.SelectedItems(1)\n    Else\n        Exit Sub\n    End If\n\n    ActiveSheet.OLEObjects.Add(fileName:=FName, Link:=False, DisplayAsIcon:=False).Select\n    Selection.Verb Verb:=xlPrimary\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5682536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/885122dd1fd38c9aeac49cf834e31791?s=128&d=identicon&r=PG&f=1", "display_name": "JOSE LEON", "link": "https://stackoverflow.com/users/5682536/jose-leon"}, "edited": false, "score": 0, "creation_date": 1464878363, "post_id": 37555903, "comment_id": 62674845, "body": "i tried it but it just not copying anything now. any suggestion?"}, {"owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "reply_to_user": {"reputation": 19, "user_id": 5682536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/885122dd1fd38c9aeac49cf834e31791?s=128&d=identicon&r=PG&f=1", "display_name": "JOSE LEON", "link": "https://stackoverflow.com/users/5682536/jose-leon"}, "edited": false, "score": 0, "creation_date": 1464879443, "post_id": 37555903, "comment_id": 62675752, "body": "@JOSELEON I think I see where the issue was, I was terminating the loop too soon with the check for FileExists.  Please see the updated code and let me know if it works for you."}], "tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": true, "score": 1, "last_activity_date": 1464879412, "last_edit_date": 1464879412, "creation_date": 1464729955, "answer_id": 37555903, "question_id": 37555542, "link": "https://stackoverflow.com/questions/37555542/access-2010-copy-file-from-workstation-to-server-without-override/37555903#37555903", "title": "Access 2010 Copy file from workstation to Server without override", "body": "<p>You could use the FileSystemObject first to make sure the file doesn't already exist:</p>\n\n<pre><code>Dim LSQL, SOurce, DestinaTion, fILE As String\nDim FSO\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSOurce = \"c:\\xfer\\\"\nDestinaTion = \"c:\\xfer2\\\"\nfILE = Dir$(SOurce &amp; \"*.adp\")\nDo While Len(fILE) &gt; 0\n    If FSO.FileExists(DestinaTion &amp; fILE) = False Then\n        FileCopy SOurce &amp; fILE, DestinaTion &amp; fILE\n    End If\n    fILE = Dir$()\nLoop\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5682536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/885122dd1fd38c9aeac49cf834e31791?s=128&d=identicon&r=PG&f=1", "display_name": "JOSE LEON", "link": "https://stackoverflow.com/users/5682536/jose-leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 37555903, "answer_count": 1, "score": 0, "last_activity_date": 1464879412, "creation_date": 1464728525, "question_id": 37555542, "link": "https://stackoverflow.com/questions/37555542/access-2010-copy-file-from-workstation-to-server-without-override", "title": "Access 2010 Copy file from workstation to Server without override", "body": "<p>I am using Filecopy option to copy pdf and One files from a workstation to the server and it working good, but because there is too many files i want to copy just the new ones and not the existing.</p>\n\n<p>This is my code:</p>\n\n<pre><code>   Dim LSQL, SOurce, DestinaTion, fILE As String\n\nSOurce = \"c:\\mapping\\\"\nDestinaTion = \"\\\\rvfile03\\Departments\\Water\\Common\\FieldTickets\\\"\nfILE = Dir$(SOurce &amp; \"*.one\")\nDo While Len(fILE) &gt; 0\n    FileCopy SOurce &amp; fILE, DestinaTion &amp; fILE\n    fILE = Dir$()\n    Loop\n</code></pre>\n\n<p>any help will be appreciated.</p>\n"}, {"tags": ["vba", "excel", "julia"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1464728266, "post_id": 37555379, "comment_id": 62599798, "body": "Perhaps use Shell() to launch a process.  Never heard of Julia.  Get the Julia script to write its result to the file.  In Excel check the process has completed and when so read the results file.  Look here for example <a href=\"http://stackoverflow.com/questions/8902022/wait-for-shell-to-finish-then-format-cells\" title=\"wait for shell to finish then format cells\">stackoverflow.com/questions/8902022/&hellip;</a>"}, {"owner": {"reputation": 775, "user_id": 5686920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNvXw.jpg?s=128&g=1", "display_name": "Philip Swannell", "link": "https://stackoverflow.com/users/5686920/philip-swannell"}, "edited": false, "score": 1, "creation_date": 1533717096, "post_id": 37555379, "comment_id": 90447365, "body": "I&#39;ve got good experience using <a href=\"https://bert-toolkit.com/\" rel=\"nofollow noreferrer\">BERT</a> to call R from both Excel formulas and from VBA. It also allows Excel to be automated from R code. Although I&#39;ve yet to try it, BERT now enables similar two-way communication between Julia and Excel. See <a href=\"https://bert-toolkit.com/using-julia-with-bert\" rel=\"nofollow noreferrer\">https://bert-toolkit.com/using-julia-with-bert</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2325, "user_id": 3029108, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d131f80f764cda67171268ecc400609?s=128&d=identicon&r=PG&f=1", "display_name": "ilovecp3", "link": "https://stackoverflow.com/users/3029108/ilovecp3"}, "edited": false, "score": 0, "creation_date": 1464802938, "post_id": 37557466, "comment_id": 62638063, "body": "Thanks. I am running a Python script first to test but it says path not found. I am using mac, is there any difference?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 2325, "user_id": 3029108, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d131f80f764cda67171268ecc400609?s=128&d=identicon&r=PG&f=1", "display_name": "ilovecp3", "link": "https://stackoverflow.com/users/3029108/ilovecp3"}, "edited": false, "score": 0, "creation_date": 1464807863, "post_id": 37557466, "comment_id": 62640606, "body": "Unix systems like Mac and Linux use forward slashes without drive letters. Did you use entire path of both executable and script: <code>&quot;&#47;path&#47;to&#47;python &#47;path&#47;to&#47;python.py&quot;</code>? Again, try running same string in terminal or Bash. And don&#39;t use <i>.exe</i> (if I remember)."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 2325, "user_id": 3029108, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d131f80f764cda67171268ecc400609?s=128&d=identicon&r=PG&f=1", "display_name": "ilovecp3", "link": "https://stackoverflow.com/users/3029108/ilovecp3"}, "edited": false, "score": 0, "creation_date": 1464873307, "post_id": 37557466, "comment_id": 62670665, "body": "Curious, did you get it to work?"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1464739355, "last_edit_date": 1490004260, "creation_date": 1464739355, "answer_id": 37557466, "question_id": 37555379, "link": "https://stackoverflow.com/questions/37555379/call-julia-script-from-excel-vba/37557466#37557466", "title": "Call Julia script from Excel VBA", "body": "<p>You can certainly call any interpreting language script from VBA using a command line call with <code>Shell()</code>. While not familiar with Julia, below are examples of VBA calling Python, PHP, and R scripts. </p>\n\n<pre><code>Shell \"C:\\Path\\To\\Python.exe C:\\Path\\To\\PythonScript.py\", vbNormalFocus    \nShell \"C:\\Path\\To\\PHP.exe C:\\Path\\To\\PHPScript.php\", vbNormalFocus    \nShell \"C:\\Path\\To\\RScript.exe C:\\Path\\To\\RScript.R\", vbNormalFocus\n</code></pre>\n\n<p>Plus, should you have above executable paths saved as <a href=\"https://superuser.com/questions/284342/what-are-path-and-other-environment-variables-and-how-can-i-set-or-use-them\">environmental path variables</a>, you can shorten the line:</p>\n\n<pre><code>Shell \"python C:\\Path\\To\\PythonScript.py\", vbNormalFocus    \nShell \"php C:\\Path\\To\\PHPScript.php\", vbNormalFocus    \nShell \"RScript C:\\Path\\To\\RScript.R\", vbNormalFocus\n</code></pre>\n\n<p>If my guess is correct, simply locate the Julia executable and specific script, making sure to add quotes if spaces are in either paths as shown below:</p>\n\n<pre><code>Shell \"C:\\Path\\To\\Julia.exe C:\\Path\\To\\Julia\\Script.jl\", vbNormalFocus\nShell \"Julia \"\"C:\\Path To\\Julia\\Script.jl\"\"\", vbNormalFocus\n</code></pre>\n\n<p>For a more child thread processing where you have more control, return codes, and even ability to pass arguments use VBA's <code>Shell</code> object. Below passes two variable arguments:</p>\n\n<pre><code>Dim shell As Object\nDim waitTillComplete As Boolean: waitTillComplete = True\nDim style As Integer: style = 1\nDim path As String\nDim errorCode As Integer\nDim var1, var2 As Double\n\nvar1 = Range(\"A1\").Value\nvar2 = Range(\"A2\").Value\n\nSet shell = VBA.CreateObject(\"WScript.Shell\")\n\n' BUILD COMMAND LINE STRING W/ WORKBOOK LOCATION AND ARGS \npath = \"Julia \" &amp; ActiveWorkbook.Path &amp; \"\\JuliaScript.jl\" &amp; \" \" &amp; var1 &amp; \" \" &amp; var2\n' RUN COMMAND LINE\nretVal = shell.Run(path, style, waitTillComplete)\n\nSet shell = Nothing\n</code></pre>\n\n<p>Should you ever need to troubleshoot/debug, always know whatever string command line you build it should work in Command Prompt, PowerShell, or any other command line interpreters.</p>\n"}], "owner": {"reputation": 2325, "user_id": 3029108, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d131f80f764cda67171268ecc400609?s=128&d=identicon&r=PG&f=1", "display_name": "ilovecp3", "link": "https://stackoverflow.com/users/3029108/ilovecp3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 1, "closed_date": 1533722155, "answer_count": 1, "score": 0, "last_activity_date": 1533717096, "creation_date": 1464727834, "question_id": 37555379, "link": "https://stackoverflow.com/questions/37555379/call-julia-script-from-excel-vba", "closed_reason": "Needs more focus", "title": "Call Julia script from Excel VBA", "body": "<p>Assume we have a Julia script 'test.jl' in the same folder of an excel file. Is it possible to call this Julia script from Excel by using VBA? If yes, what the VBA code should it be? If no, any other methods? Thanks.</p>\n"}, {"tags": ["vba", "excel", "outlook", "taskscheduler"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1464738205, "post_id": 37555107, "comment_id": 62603173, "body": "Try commenting out <code>On Error Resume Next</code>. Maybe you&#39;ll get a clue as to what error is occurring."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6406066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zb91ZsttmGs/AAAAAAAAAAI/AAAAAAAAAt8/23NXYFL9Rbk/photo.jpg?sz=128", "display_name": "Saige Paget", "link": "https://stackoverflow.com/users/6406066/saige-paget"}, "is_accepted": true, "score": 1, "last_activity_date": 1464740339, "creation_date": 1464740339, "answer_id": 37557589, "question_id": 37555107, "link": "https://stackoverflow.com/questions/37555107/task-scheduler-does-not-run-excel-vba-code-to-send-pdf-as-email-attachment/37557589#37557589", "title": "Task Scheduler does not run Excel VBA Code to send PDF as Email Attachment", "body": "<p>We realized that the server limited my permissions in the task scheduler. When I went my IT Director switched my permissions to Admin, it ran the task scheduler perfectly! </p>\n\n<p>Sorry for the false alarm... I wouldn't have posted the question originally, but I spent all last week working on it. Thanks everybody for looking!</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1465421813, "creation_date": 1465421813, "answer_id": 37713354, "question_id": 37555107, "link": "https://stackoverflow.com/questions/37555107/task-scheduler-does-not-run-excel-vba-code-to-send-pdf-as-email-attachment/37713354#37713354", "title": "Task Scheduler does not run Excel VBA Code to send PDF as Email Attachment", "body": "<p>That was my guess.  You have to mkae sure your password is entered correctly.  If you fat-finger a key and enter your password incorrectly, the Task Scheduler will accept it even though it shouldn't.  In my opionion, it should prompt the user and notify him/her of the error.  Maybe Microsoft will change this sometime in the near future.</p>\n"}], "owner": {"reputation": 31, "user_id": 6406066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zb91ZsttmGs/AAAAAAAAAAI/AAAAAAAAAt8/23NXYFL9Rbk/photo.jpg?sz=128", "display_name": "Saige Paget", "link": "https://stackoverflow.com/users/6406066/saige-paget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 37557589, "answer_count": 2, "score": 2, "last_activity_date": 1465421813, "creation_date": 1464726648, "last_edit_date": 1531164843, "question_id": 37555107, "link": "https://stackoverflow.com/questions/37555107/task-scheduler-does-not-run-excel-vba-code-to-send-pdf-as-email-attachment", "title": "Task Scheduler does not run Excel VBA Code to send PDF as Email Attachment", "body": "<p>Here is the software/systems I am using:\n<br>Microsoft Office 2010;\n<br>Task Scheduler; \n<br>Windows Server 2008 R2 Standard\n<br></p>\n\n<p>I am running some VBA code within an Excel file that does the following:</p>\n\n<p><br>1. Retrieves Data from our Database via SQL/ODBC connections\n<br>2. Uploads data to a raw data table within the workbook and time stamps the workbook in a cell with the now function\n<br>3. Refreshes and formats each pivot table in the workbook\n<br>4. Exports and saves specified sheets as a PDF document and saves the document name with the time stamp from step 2\n<br>5. Saves the workbook\n<br>6. Emails that specific PDF document just created as an email attachment in Excel.\n<br>7. Closes the Excel Application</p>\n\n<p>I run this whole series in a private sub called Workbook_Open which checks to see if current time matches the specified runtime. If it does, it runs steps 1-7, if it is an hour later, it closes the workbook (that way I can work on it other than that two hour window).</p>\n\n<p>Here is the code being used:\n*Note, this code below is run in the \"ThisWorkbook\" Excel Object.</p>\n\n<pre><code>'This Macro will use check to see if you opened the workbook at a certain time, if you did, then it will run the Report Automation Macros below.\n\nPrivate Sub Workbook_Open()\n\nHourRightNow = Hour(Now())\n\nIf HourRightNow = 13 Then\n\nCall RefreshDataTables\nCall RefreshPivotTables\nCall SaveWorkbook\nCall ExportToPDFFile\nCall EmailPDFAsAttachment\nCall CloseWorkbook\n\nElseIf HourRightNow = 14 Then\n\nCall CloseWorkbook\n\nEnd If\n\nEnd Sub\n\n\nSub RefreshDataTables()\n'\n' RefreshDataTables Macro\n' This Macro is used to refresh the data from the Dentrix Tables.\n'\n'This selects the table and refreshes it.\n\nSheets(\"raw\").Select\nRange(\"D4\").Select\nSelection.ListObject.QueryTable.Refresh BackgroundQuery:=False\nWorksheets(\"NomenclatureVBA\").Range(\"A2\").Formula = \"=now()\"\n\nEnd Sub\n\n\nSub RefreshPivotTables()\n'\n' RefreshPivotTables Macro\n' This Macro refreshes each Pivot Table in the document.\n'\n\n'This goes through each sheet and refreshes each pivot table.\n    Sheets(\"D0150 VS D0330 BY BIZLINE\").PivotTables(\"D0150 vs D0330 by BIZLINE\").PivotCache.Refresh\n\n   Columns(\"B:DD\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n\n    Sheets(\"D0150 VS D0330\").PivotTables(\"D0150 COMP EXAM vs D0330 PANO\").PivotCache.Refresh\n\n    Columns(\"B:DD\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n'Formnats to the specific date format below.\n\n\n\n\n\n\nEnd Sub\n\n'--------------------------------------------------------------------------------------------------------------\n\nSub SaveWorkbook()\n\n' Saves Active (Open) Workbook\n\n    ActiveWorkbook.Save\n\nEnd Sub\n\n\n'**********************READY************************\n'More simplified and tested version of the Export To PDF format\n'Make sure to update the filePaths, worksheets,\n\nSub ExportToPDFFile()\nDim strFilename As String\n\n\n'Considering Sheet1 to be where you need to pick file name\nstrFilename = Worksheets(\"NomenclatureVBA\").Range(\"C2\")\n\n\nSheets(Array(\"D0150 VS D0330\", \"D0150 VS D0330 BY BIZLINE\")).Select\nSheets(\"D0150 VS D0330\").Activate\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"\\\\****(ServerNameGoesHere)****\\UserFolders\\_Common\\DentrixEntrpriseCustomReports\\Public\\Owner Reports\\DataAnalystAutomatedReports\\Reports\\D0150 COMP EXAM vs D0330 PANO\\\" &amp; strFilename &amp; \".pdf\" _\n    , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=False\n\nSheets(\"NomenclatureVBA\").Select\n\n'This is where the exporting ends, now we will proceed to email the file.\n'-----------------------------------------------------------------------------\n\n'The emailing begins here\n'This says that if there is a file name stored in the strFileName variable, then....\nEnd Sub\n\n\n\n'This Macro Closes the workbook... Note that it closes the very specific workbook you choose.\n\nSub CloseWorkbook()\n\n'Workbooks(\"Automated D0150 COMP EXAM vs D0330 PANO.xlsm\").Close SaveChanges:=False\nApplication.DisplayAlerts = False\nApplication.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Then I also have the macro that emails the PDF file in the Modules section of VBA. It looks like this:</p>\n\n<pre><code>Sub EmailPDFAsAttachment()\n' Works in Excel 2000, Excel 2002, Excel 2003, Excel 2007, Excel 2010, Outlook 2000, Outlook 2002, Outlook 2003, Outlook 2007, Outlook 2010.\n' This example sends the last saved version of the Activeworkbook object .\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim FilePath As String\n\n    'This part is setting the strings and objects to be things. (e.g. FilePath is setting itself equal to the text where we plan to set up each report)\n\n    FilePath = \"\\\\***(ServerGoesHere)***\\UserFolders\\_Common\\DentrixEntrpriseCustomReports\\Public\\Owner Reports\\DataAnalystAutomatedReports\\Reports\\D0150 COMP EXAM vs D0330 PANO\\\" _\n    &amp; Worksheets(\"NomenclatureVBA\").Range(\"C2\") &amp; \".pdf\"\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n   ' Change the mail address and subject in the macro before you run it.\n   '\n\n    With OutMail\n        .To = \"email@example.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = Worksheets(\"NomenclatureVBA\").Range(\"C2\")\n\n        .HTMLBody = \"Hello all!\" &amp; \"&lt;br&gt;\" &amp; _\n        \"Here is this week's report for the Comp Exam vs. Pano.\" &amp; \"&lt;br&gt;\" &amp; _\n         \"Let me know what you think or any comments or questions you have!\" &amp; \"&lt;br&gt;\" &amp; _\n         vbNewLine &amp; Signature &amp; .HTMLBody\n\n        .Attachments.Add FilePath\n        ' In place of the following statement, you can use \".Display\" to\n        ' display the mail.\n        .Send\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>So this all runs fine when I open up the workbook at the 13th hour (1pm), however, when I try to run this in Task Scheduler during the 13th hour, it runs everything up until the EmailPDFAsAttachment macro/sub and it gets hung up somewhere in the macro and stops running. </p>\n\n<p>I should also state that I have the Trust Center Settings to the following in both Outlook and Excel:\n<a href=\"http://i.stack.imgur.com/zI9CA.png\" rel=\"nofollow\">TrustCenterSettings</a></p>\n\n<p>Anyone know whats causing the macro to run perfectly when I personally open the file and then when I try and open the file via Task Scheduler it stalls in the same spot? \n<b>And anyone know how to make it run correctly via Task Scheduler?</b></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1464727131, "post_id": 37554951, "comment_id": 62599224, "body": "You mean you want to set the range in one sheet to equal the values in a range in another sheet?"}, {"owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1464730199, "post_id": 37554951, "comment_id": 62600704, "body": "Yes. There are a total of 3 columns, within each sheet, that I would like define in my range."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1464742701, "creation_date": 1464742701, "answer_id": 37557859, "question_id": 37554951, "link": "https://stackoverflow.com/questions/37554951/extract-a-column-range-from-excel-worksheets/37557859#37557859", "title": "Extract a column range from excel worksheets", "body": "<p>If you move your link creation to a separate sub your code will be more concise, and you can have the sub automatically adjust the type of formula (regular for single cells, or array formula for blocks of cells)</p>\n\n<pre><code>Sub tester()\n\n    Dim rng As Range\n\n    Set rng = ActiveSheet.Range(\"A2\")\n\n    LinkToFile \"C:\\_Stuff\\test\", \"temp report.xlsx\", \"Sheet1\", \"A1:D20\", rng\n\n    Set rng = ActiveSheet.Range(\"F2\")\n\n    LinkToFile \"C:\\_Stuff\\test\", \"temp report.xlsx\", \"Sheet1\", \"A1\", rng\n\nEnd Sub\n\n\n\n\nSub LinkToFile(fPath As String, fName As String, shtName As String, _\n               addr As String, rngInsert As Range)\n\n    Dim rngTmp As Range, f As String\n\n    If Right(fPath, 1) &lt;&gt; \"\\\" Then fPath = fPath &amp; \"\\\" 'win only!\n\n    f = \"='\" &amp; fPath &amp; \"[\" &amp; fName &amp; \"]\" &amp; shtName &amp; \"'!\" &amp; addr\n\n    'linking to a range, or a single cell ?\n    If InStr(addr, \":\") &gt; 0 Then\n        Set rngTmp = rngInsert.Parent.Range(addr) 'to get num rows/cols\n        rngInsert.Resize(rngTmp.Rows.Count, rngTmp.Columns.Count).FormulaArray = f\n    Else\n        rngInsert.Formula = f\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464742701, "creation_date": 1464726044, "last_edit_date": 1464740710, "question_id": 37554951, "link": "https://stackoverflow.com/questions/37554951/extract-a-column-range-from-excel-worksheets", "title": "Extract a column range from excel worksheets", "body": "<p>I am currently working on parsing data from multiple worksheets within multiple workbooks into a summary worksheet. I have been able to select certain cells from all sheets and workbooks but would like to extract a range of columns if possible. How can I add this option to my loop condition?\nfor example If I have a worksheet called \"Monday\" and I would like to extract the cell range A2 through C57 and add it to my newly created worksheet.</p>\n\n<pre><code>Option Explicit\nSub GetMyData()\nDim myDir As String, fn As String, SheetName As String, SheetName2 As String, SheetName3 As String, n As Long, NR As Long\n'***** Change Folder Path *****\nmyDir = \"C:\\attach\"\n\n'***** Change Sheetname(s) *****\nSheetName = \"Title\"\nSheetName2 = \"Total\"\nSheetName3 = \"Monday\"\n\n'***Loops through specified directory and parces data from each worksheet within each workbook by selecting specified .\nfn = Dir(myDir &amp; \"\\*.xlsx\")\nDo While fn &lt;&gt; \"\"\n    If fn &lt;&gt; ThisWorkbook.Name Then\n        With ThisWorkbook.Sheets(\"ImportTable\")\n            NR = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n            'Pick cells from worksheet \"Title\"\n            With .Range(\"A\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!A1\"\n                .Value = .Value\n            End With\n            With .Range(\"B\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!A2\"\n                .Value = .Value\n            End With\n            With .Range(\"C\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!B4\"\n                .Value = .Value\n            End With\n            With .Range(\"D\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!B5\"\n                .Value = .Value\n            End With\n            With .Range(\"E\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!B6\"\n                .Value = .Value\n            End With\n            With .Range(\"F\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName &amp; \"'!B7\"\n                .Value = .Value\n            End With\n            With .Range(\"G\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName2 &amp; \"'!B26\"\n                .Value = .Value\n            End With\n            With .Range(\"H\" &amp; NR)\n                .Formula = \"='\" &amp; myDir &amp; \"\\[\" &amp; fn &amp; \"]\" &amp; SheetName2 &amp; \"'!A1\"\n                .Value = .Value\n            End With\n        End With\n    End If\n    fn = Dir\n Loop\n ThisWorkbook.Sheets(\"ImportTable\").Columns.AutoFit\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6322234, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9903c3715fe425ec4ffc9d1a8b2af221?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/6322234/dennis"}, "edited": false, "score": 0, "creation_date": 1464728242, "post_id": 37555139, "comment_id": 62599781, "body": "You are right about the clipboard taking up time and resources. This code actually wants to copy data from other sheets in a workbook correct? My code is pulling from multiple files. I&#39;ll edit my posting with the full code."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 111, "user_id": 6322234, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9903c3715fe425ec4ffc9d1a8b2af221?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/6322234/dennis"}, "edited": false, "score": 0, "creation_date": 1464728765, "post_id": 37555139, "comment_id": 62600036, "body": "In the meanwhile please see it works alright in one workbook. Ii is late in night here and tomorrow I shall be able to look into it."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1464727563, "last_edit_date": 1464727563, "creation_date": 1464726819, "answer_id": 37555139, "question_id": 37554855, "link": "https://stackoverflow.com/questions/37554855/how-to-import-excel-data-into-new-workbook/37555139#37555139", "title": "How to import excel data into new workbook?", "body": "<p>Please try this after changing range to your requirements. It will paste from A2. Using the clipboard takes time and resources so the best way would be to avoid a copy and paste and just set the values equal to what you want.Though you have mentioned that data transfer is required between separate workbooks but mentioned code for only basic problem, so this code fragment conveys the basic concept for transfer in a situation where there is a named table involved.</p>\n\n<pre><code>Sub Normalize()\n    Dim CopyFrom As Range\n\n    Set CopyFrom = Sheets(\"Sheet2\").Range(\"A2\", [H30])\n    Sheets(\"Sheet1\").Range(\"A1\").Resize(CopyFrom.Rows.Count).Value = CopyFrom.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6322234, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9903c3715fe425ec4ffc9d1a8b2af221?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/6322234/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464728401, "creation_date": 1464725686, "last_edit_date": 1464728401, "question_id": 37554855, "link": "https://stackoverflow.com/questions/37554855/how-to-import-excel-data-into-new-workbook", "title": "How to import excel data into new workbook?", "body": "<p>I am trying to combine multiple excel files into one file. I am able to do that correctly, but the location I want to place the data is running into a small problem.</p>\n\n<p>I want my data to start (paste) at cell A2 under the header row, but since my sheet is formatted as a table with a named range, my data is pasted just below the last line of that blank table. This is the code I'm using to paste the data. </p>\n\n<pre><code>Sub CombineFiles()\n\nDim path As String, ThisWB As String, lngFilecounter As Long\nDim wbDest As Workbook, shtDest As Worksheet, ws As Worksheet\nDim Filename As String, Wkb As Workbook\nDim CopyRng As Range, Dest As Range\nDim RowofCopySheet As Integer\n\nThisWB = ActiveWorkbook.Name\n\npath = \"C:\\MyFolder\"\n\nRowofCopySheet = 2\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nSet shtDest = ActiveWorkbook.Sheets(\"Import\")\nRange(\"A2\").Select\nFilename = Dir(path &amp; \"\\*.xl??\", vbNormal)\nIf Len(Filename) = 0 Then Exit Sub\nDo Until Filename = vbNullString\n    If Not Filename = ThisWB Then\n        Set Wkb = Workbooks.Open(Filename:=path &amp; \"\\\" &amp; Filename)\n        Set CopyRng = Wkb.Sheets(1).Range(Cells(RowofCopySheet, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, Cells(1, Columns.Count).End(xlToLeft).Column))\n        Set Dest = shtDest.Range(\"A\" &amp; shtDest.Cells(Rows.Count, 1).End(xlUp).Row + 1)\n        CopyRng.Copy\n        Dest.PasteSpecial xlPasteFormats\n        Dest.PasteSpecial xlPasteValuesAndNumberFormats\n        Application.CutCopyMode = False 'Clear Clipboard\n        Wkb.Close False\n    End If\n\n    Filename = Dir()\nLoop\nSheets(\"Import\").Select\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Is there any change I can make to the code or the contents of the cells in the table to allow this to work correctly? Thanks for the help!</p>\n"}, {"tags": ["excel", "loops", "charts", "userform", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 5418716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kGhKr.jpg?s=128&g=1", "display_name": "HumanoidTyphoon", "link": "https://stackoverflow.com/users/5418716/humanoidtyphoon"}, "is_accepted": true, "score": 0, "last_activity_date": 1464889066, "creation_date": 1464889066, "answer_id": 37598645, "question_id": 37554571, "link": "https://stackoverflow.com/questions/37554571/loop-updating-chart-image-on-userform/37598645#37598645", "title": "Loop Updating Chart Image on Userform", "body": "<p>The below code solved my problem.  </p>\n\n<pre><code>'create .gif file of current PerfMap chart\n    Set PerfMap = Charts(\"PerfMap\")\n    Fname = ThisWorkbook.Path &amp; \"\\temp1.bmp\"\n    PerfMap.Export Filename:=Fname, FilterName:=\"BMP\"\n\n    'set live data chart image to most recent image\n    UserForm3.Image1.Picture = LoadPicture(Fname)\n</code></pre>\n\n<p>According to this MSDN <a href=\"https://support.microsoft.com/en-us/kb/175918\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/175918</a> one must use BMP to get the picture to work properly.</p>\n\n<p>Now my new problem is that the above code slows my loop to a crawl and over time I end up using 99% of my system memory until I exit excel and re-open it.</p>\n"}], "owner": {"reputation": 13, "user_id": 5418716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kGhKr.jpg?s=128&g=1", "display_name": "HumanoidTyphoon", "link": "https://stackoverflow.com/users/5418716/humanoidtyphoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 37598645, "answer_count": 1, "score": 0, "last_activity_date": 1464889066, "creation_date": 1464724568, "last_edit_date": 1531161705, "question_id": 37554571, "link": "https://stackoverflow.com/questions/37554571/loop-updating-chart-image-on-userform", "title": "Loop Updating Chart Image on Userform", "body": "<p>Okay,</p>\n\n<p>So I am trying to integrate the following code:</p>\n\n<pre><code>`Private Sub UserForm_Initialize()\n    Dim Fname As String\n\n    Call SaveChart\n    Fname = ThisWorkbook.Path &amp; \"\\temp1.gif\"\n    Me.Image1.Picture = LoadPicture(Fname)\nEnd Sub\n\nPrivate Sub SaveChart()\n    Dim MyChart As Chart\n    Dim Fname As String\n\n    Set MyChart = Sheets(\"Data\").ChartObjects(1).Chart\n    Fname = ThisWorkbook.Path &amp; \"\\temp1.gif\"\n    MyChart.Export Filename:=Fname, FilterName:=\"GIF\"\nEnd Sub`\n</code></pre>\n\n<p>from this post: <a href=\"https://stackoverflow.com/questions/31598704/displaying-live-chart-data-in-excel-userform/31600919#3160091\">Displaying &quot;live&quot; chart data in Excel Userform</a> into an existing loop so that the above section of code iterates with the loop and the image is updated every time the loop executes.  I would have posted this as a comment on the above mentioned question, but I do not have enough rep.</p>\n\n<pre><code>'\n' Get last logged data\n'\nPrivate Sub GetLastLoggedData()\n    Dim rangeToWrite\n    Dim lStartFileSize As Long\n    Dim lNextFileSize As Long\n    Dim dtStartTime As Date\n    Dim lElapsedTime As Long\n    Dim bDone As Boolean\n    Dim sLastHeader As String\n    Dim sLastData As String\n    Dim iCol As Integer\n    Dim sNextValue As String\n    Dim iLoop As Integer\n    Dim Fname As String\n    Dim MyChart As Chart\n\n    On Error GoTo ErrorHandler\n\n   ' Initialize global_bHasScanCount flag\n   global_bHasScanCount = False\n\n   ' Get the file size of the log file\n    lStartFileSize = FileLen(global_sLogFile)\n\n    ' Initialize timer\n    dtStartTime = Now\n\n    ' Wait for filesize to change\n    UpdateLogStatus Now &amp; \" : Data Monitor: waiting for file size to change...\"\n    bDone = False\n    Do\n        ' Get the file size of the log file and see if it's changed\n        lNextFileSize = FileLen(global_sLogFile)\n        If lNextFileSize &lt;&gt; lStartFileSize And lNextFileSize &lt;&gt; 0 Then\n            bDone = True\n        Else\n            lElapsedTime = DateDiff(\"s\", dtStartTime, Now)\n            If (lElapsedTime &gt;= global_lTimeout) Or (lElapsedTime &lt; 0) Then\n                bDone = True\n            End If\n        End If\n\n        DoEvents\n\n    Loop Until bDone = True\n\n    ' Backup the file\n    UpdateLogStatus Now &amp; \" : Data Monitor: backing up data file...\"\n    'FileCopy global_sLogFile, global_sLogFileBackup\n\n    ' Read the log file\n    UpdateLogStatus Now &amp; \" : Data Monitor: reading data file...\"\n    sLastData = \"\"\n    sLastHeader = \"\"\n\n    If ReadLogFile(global_sLogFile, sLastData, sLastHeader) = False Then\n        ' Delete the backup log file\n        'Kill global_sLogFileBackup\n\n        Exit Sub\n    End If\n\n    ' Delete the backup log file\n    'Kill global_sLogFileBackup\n\n    UpdateLogStatus Now &amp; \" : Data Monitor: updating worksheet...\"\n\n\n    ' Clear previous Results in Excel Spreadsheet\n    ThisWorkbook.Worksheets(\"ACQUIRE DATA\").Range(\"A2:IV2\").ClearContents\n\n    ' Parse comma delimeted header and place data into worksheet cells.  If we have the scan count then\n    ' start writing in column1, else starting writing in column2.\n\n    If global_bHasScanCount = True Then\n        iCol = 1\n    Else\n        iCol = 2\n    End If\n\n    If sLastHeader &lt;&gt; \"\" Then\n        ' Clear previous Results in Excel Spreadsheet\n        ThisWorkbook.Worksheets(\"ACQUIRE DATA\").Range(\"A1:IV1\").ClearContents\n\n        Do\n            sNextValue = GetToken(sLastHeader, \",\")\n\n            ' Copy Results to Excel worksheet\n            ThisWorkbook.Worksheets(\"ACQUIRE DATA\").Cells(1, iCol).Value = sNextValue\n            iCol = iCol + 1\n\n        Loop Until sLastHeader = \"\"\n    End If\n\n    ' Parse comma delimeted results and place data into worksheet cells.  If we have the scan count then\n    ' start writing in column1, else starting writing in column2.\n\n    If global_bHasScanCount = True Then\n        iCol = 1\n    Else\n        iCol = 2\n    End If\n    Do\n        sNextValue = GetToken(sLastData, \",\")\n\n        ' Copy Results to Excel worksheet\n        ThisWorkbook.Worksheets(\"ACQUIRE DATA\").Cells(2, iCol).Value = sNextValue\n        iCol = iCol + 1\n        'Copy Current Data to Control Panel\n        UserForm2.TextBox2.Text = Sheets(\"ACQUIRE DATA\").Range(\"B12\")\n        'Copy Time to Control Panel \n        UserForm2.TextBox3 = Format(Sheets(\"ACQUIRE DATA\").Range(\"B13\"), \"hh:mm:ss\")\n        'Copy Speed to Control Panel \n        UserForm2.TextBox4.Text = Sheets(\"ACQUIRE DATA\").Range(\"B14\")\n\n   'create .gif file of current PerfMap chart\n    Set MyChart = Sheets(\"PerfMap\").ChartObjects(1).Chart\n    Fname = ThisWorkbook.Path &amp; \"\\temp1.gif\"\n    MyChart.Export Filename:=Fname, FilterName:=\"GIF\"\n    Fname = ThisWorkbook.Path &amp; \"\\temp1.gif\"\n    'set live data chart image to most recent image\n    UserForm3.Image1.Picture = LoadPicture(Fname)\n\n\n    Loop Until sLastData = \"\"\n    UpdateLogStatus \"\"\n\n\n\n    Exit Sub\n\nErrorHandler:\n    BuildErrorMessage \"GetLastLoggedData\", \"Failed to get last logged data.\"\n    UpdateLogStatus \"\"\n\n\n\nEnd Sub'\n</code></pre>\n\n<p>However whenever I do this I get a Runtime Error 1004 that is built by the error handler.  Any help on why this is not working is much appreciated.</p>\n\n<p><strong>EDIT</strong>: After walking away for 24 hours, I realized that the sheet in question is a chart sheet, and not an embedded chart, therefore the method I was attempting to use above was not working.</p>\n\n<p>The chart is on a chart sheet called PerfMap, but the chart name is Chart 7.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1464723753, "post_id": 37554267, "comment_id": 62597335, "body": "Something like a <a href=\"https://support.office.com/en-us/article/Use-mail-merge-to-send-personalized-email-messages-to-your-email-address-list-c49e5cfc-53f9-4ec8-9bd9-1f8f3648f1b7?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">mail merge</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "edited": false, "score": 0, "creation_date": 1464797051, "post_id": 37554413, "comment_id": 62634559, "body": "Yes, thsi works great! Thank you very much for the help and the advice! I&#39;m a beginner, so these tips are great before I actually form the bad habits. Thank you for being so efficient!"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "edited": false, "score": 0, "creation_date": 1465763187, "post_id": 37554413, "comment_id": 63025164, "body": "not sure what the downvote was for as it seems to have solved the OP&#39;s problem despite it not being accepted."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": -1, "last_activity_date": 1464724027, "creation_date": 1464724027, "answer_id": 37554413, "question_id": 37554267, "link": "https://stackoverflow.com/questions/37554267/excel-macro-to-send-specific-info-in-multiple-separate-emails/37554413#37554413", "title": "Excel Macro To Send Specific Info In Multiple Separate Emails", "body": "<p>If you want to use this macro instead of a mail merge the problem you are having is here:</p>\n\n<pre><code>strbody = strbody &amp; \"Dear \" &amp; Cells(r, \"AR\").Text &amp; \", &lt;br&gt;&lt;br&gt;\" &amp; _\n\"I will be working with you on \" &amp; Cells(r, \"B\") &amp; \", client number \" &amp;       Cells(r, \"A\") &amp; \", which is effective \" &amp; Cells(r, \"C\") &amp; \".&lt;br&gt;&lt;br&gt;\" &amp; _\n\"For this year's contract, we are requesting the following information: &lt;br&gt;\" &amp; _\n\"&lt;li&gt;\" &amp; Cells(r, \"AH\") &amp; \"&lt;/li&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"The application form may be downloaded from:&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #1&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"Link#1\" &amp; \"\"\"&gt;\" &amp;    \"Link#1\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #2&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"link#2\" &amp; \"\"\"&gt;\" &amp; \"link#2\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"Once we receive the requested information, you will receive your contract within 5 business days. Should you have any questions, please don't hesitate to contact me at this email address or phone number &lt;br&gt;&lt;br&gt;\" &amp; _\n\"As always, we would like to thank you for your business. &lt;br&gt;&lt;br&gt;\" &amp; _\n\"Regards, &lt;br&gt;\"\n</code></pre>\n\n<p>This takes the variable strbody and <strong>adds</strong> the rest of the string to it.</p>\n\n<p>Update it to:</p>\n\n<pre><code>strbody = \"Dear \" &amp; Cells(r, \"AR\").Text &amp; \", &lt;br&gt;&lt;br&gt;\" &amp; _\n\"I will be working with you on \" &amp; Cells(r, \"B\") &amp; \", client number \" &amp;       Cells(r, \"A\") &amp; \", which is effective \" &amp; Cells(r, \"C\") &amp; \".&lt;br&gt;&lt;br&gt;\" &amp; _\n\"For this year's contract, we are requesting the following information: &lt;br&gt;\" &amp; _\n\"&lt;li&gt;\" &amp; Cells(r, \"AH\") &amp; \"&lt;/li&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"The application form may be downloaded from:&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #1&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"Link#1\" &amp; \"\"\"&gt;\" &amp;    \"Link#1\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #2&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"link#2\" &amp; \"\"\"&gt;\" &amp; \"link#2\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"Once we receive the requested information, you will receive your contract within 5 business days. Should you have any questions, please don't hesitate to contact me at this email address or phone number &lt;br&gt;&lt;br&gt;\" &amp; _\n\"As always, we would like to thank you for your business. &lt;br&gt;&lt;br&gt;\" &amp; _\n\"Regards, &lt;br&gt;\"\n</code></pre>\n\n<p>And it will overwrite it each time which is what I think you want.</p>\n\n<p>Also you don't need to select the sheet each time (or at all really).  Selecting sheets, cells, etc is generally bad coding practice that can significantly slow down your code.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1464882244, "creation_date": 1464882244, "answer_id": 37596473, "question_id": 37554267, "link": "https://stackoverflow.com/questions/37554267/excel-macro-to-send-specific-info-in-multiple-separate-emails/37596473#37596473", "title": "Excel Macro To Send Specific Info In Multiple Separate Emails", "body": "<p>Please take a look at this example. </p>\n\n<p>In column A : Names of the people\nIn column B : E-mail addresses\nIn column C:Z : Filenames like this C:\\Data\\Book2.xls (don't have to be Excel files)</p>\n\n<p>The Macro will loop through each row in \"Sheet1\" and if there is a E-mail address in column B\nand file name(s) in column C:Z it will create a mail with this information and send it.</p>\n\n<pre><code>Sub Send_Files()\n'Working in Excel 2000-2016\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim sh As Worksheet\n    Dim cell As Range\n    Dim FileCell As Range\n    Dim rng As Range\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set sh = Sheets(\"Sheet1\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    For Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n\n        'Enter the path/file names in the C:Z column in each row\n        Set rng = sh.Cells(cell.Row, 1).Range(\"C1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n           Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            Set OutMail = OutApp.CreateItem(0)\n\n            With OutMail\n                .to = cell.Value\n                .Subject = \"Testfile\"\n                .Body = \"Hi \" &amp; cell.Offset(0, -1).Value\n\n                For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                    If Trim(FileCell) &lt;&gt; \"\" Then\n                        If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                            .Attachments.Add FileCell.Value\n                        End If\n                    End If\n                Next FileCell\n\n                .Send  'Or use .Display\n            End With\n\n            Set OutMail = Nothing\n        End If\n    Next cell\n\n    Set OutApp = Nothing\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>You can learn more about it from the link below.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s1/outlook/amail6.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s1/outlook/amail6.htm</a></p>\n"}], "owner": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4404, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516779643, "creation_date": 1464723490, "question_id": 37554267, "link": "https://stackoverflow.com/questions/37554267/excel-macro-to-send-specific-info-in-multiple-separate-emails", "title": "Excel Macro To Send Specific Info In Multiple Separate Emails", "body": "<p>So I'm in need of some help. I'm trying to update my company's Excel tool that they use to manage clients. I currently need help with updating the Send Email function of the tool. So employees will have a list of clients they need to send an email to, and each client will have specific information like name, client number, etc., and the employees should be able to click the \"Send Email\" macro button that's built in, and different emails will populate in Outlook with the specific info for each client built into the Email recipient, Title and Body. </p>\n\n<p>I am currently stuck. For example, I will choose 3 clients to send an email to, click the \"Send Email\" button, and I will get 3 emails to populate (as I should). The first email will have all of the correct info in the right place for Client #1. However, Email #2 will have the correct Email Recipient &amp; Email Title, but then the Email Body will have the correct info for Client #2, and below that also in the Email Body will be all of the email body info for Client #1. And same for Email #3, it will have the correct recipient and title, but the Body will have body info for Client #3, then Client #2, then Client #1. </p>\n\n<p>So I know that I need to fix it through some sort of loop for the email body, but I have been working on this for so long I just can't see it anymore. I've removed any sensitive information and put in placeholders, but I think you should get the idea.</p>\n\n<p>Please let me know if you have any questions. </p>\n\n<pre><code>Sub SendEMail()\nDim Email As String\nDim Subj As String\nDim Msg As String\nDim URL As String\nDim r As Integer\nDim x As Double\nDim OApp As Object\nDim OMail As Variant\nDim Signature As String\nDim strbody As String\n\n\n\nstrbody = \"&lt;html&gt;&lt;body&gt;\"\n\nWith Sheets(\"Email\").Select\nlastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\nFor r = 2 To lastrow\n\n\nSet OApp = CreateObject(\"Outlook.Application\")\nSet OMail = OApp.CreateItem(0)\n\n'       Get the email address\nSheets(\"Email\").Select\nEmail = Cells(r, \"F\")\n'       Message subject\nSheets(\"Email\").Select\nSubj = \"Renewal for \" &amp; Cells(r, \"B\").Text &amp; \" Contract \" &amp; Cells(r, \"A\").Text &amp; \" Effective \" &amp; Cells(r, \"C\").Text\n\n'       Message body\nSheets(\"Email\").Select\nstrbody = strbody &amp; \"Dear \" &amp; Cells(r, \"AR\").Text &amp; \", &lt;br&gt;&lt;br&gt;\" &amp; _\n\"I will be working with you on \" &amp; Cells(r, \"B\") &amp; \", client number \" &amp;       Cells(r, \"A\") &amp; \", which is effective \" &amp; Cells(r, \"C\") &amp; \".&lt;br&gt;&lt;br&gt;\" &amp; _\n\"For this year's contract, we are requesting the following information: &lt;br&gt;\" &amp; _\n\"&lt;li&gt;\" &amp; Cells(r, \"AH\") &amp; \"&lt;/li&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"The application form may be downloaded from:&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #1&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"Link#1\" &amp; \"\"\"&gt;\" &amp;    \"Link#1\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n\"&lt;li&gt;Option #2&lt;/li&gt;: \" &amp; \"&lt;a href=\"\"\" &amp; \"link#2\" &amp; \"\"\"&gt;\" &amp; \"link#2\" &amp; \"&lt;/a&gt;\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n\"Once we receive the requested information, you will receive your contract within 5 business days. Should you have any questions, please don't hesitate to contact me at this email address or phone number &lt;br&gt;&lt;br&gt;\" &amp; _\n\"As always, we would like to thank you for your business. &lt;br&gt;&lt;br&gt;\" &amp; _\n\"Regards, &lt;br&gt;\"\n\nOn Error Resume Next\n\nSheets(\"Email\").Select\nWith OMail\n.Display\n.To = Email\n.Subject = Subj\n.HTMLBody = strbody &amp; vbNewLine &amp; .HTMLBody\nEnd With\nNext r\n\nOn Error GoTo 0\n\nSet OMail = Nothing\nSet OApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464724268, "post_id": 37554204, "comment_id": 62597644, "body": "Consider renaming <code>Macro_SortX</code> procedures to meaningful names that start with a verb (e.g. <code>SortByFooBarBaz</code>), and dropping the obsolete and utterly useless <code>Call</code> statements."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1464723649, "creation_date": 1464723649, "answer_id": 37554321, "question_id": 37554204, "link": "https://stackoverflow.com/questions/37554204/vba-target-address-to-two-cells/37554321#37554321", "title": "VBA Target.Address to Two Cells", "body": "<p>A couple of things; </p>\n\n<p>The address will be \"B1:B2\"</p>\n\n<p>And to do multiple test with Select Case we want to search for True and format it something like a IF/ElseIF:</p>\n\n<pre><code>If target.Address(0, 0) = \"B1:B2\" Then\n    Select Case True\n         Case Range(\"B1\") = \"Last\" And Range(\"B2\") = \"First\"\n            Call Macro_Sort1\n         Case Range(\"B1\") = \"Last\" And Range(\"B2\") = \"Company\"\n            Call Macro_Sort2\n         Case Range(\"B1\") = \"First\" And Range(\"B2\") = \"Last\"\n            Call Macro_Sort3\n         Case Range(\"B1\") = \"First\" And Range(\"B2\") = \"Company\"\n            Call Macro_Sort4\n         Case Range(\"B1\") = \"Company\" And Range(\"B2\") = \"Last\"\n            Call Macro_Sort5\n         Case Range(\"B1\") = \"Company\" And Range(\"B2\") = \"First\"\n            Call Macro_Sort6\n   End Select\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1464724126, "last_edit_date": 1495542150, "creation_date": 1464724126, "answer_id": 37554436, "question_id": 37554204, "link": "https://stackoverflow.com/questions/37554204/vba-target-address-to-two-cells/37554436#37554436", "title": "VBA Target.Address to Two Cells", "body": "<blockquote>\n<pre><code>If Target.Address = \"$B$1\" And \"$B$2\" Then\n</code></pre>\n</blockquote>\n\n<p>This is a syntax error, because <code>If {boolean-expression} Then</code> requires, well, a <em>Boolean expression</em> - and you've confused VBA with the <code>And {string-literal}</code> part of that expression.</p>\n\n<p>You could construct a <em>Boolean expression</em> with the <code>And</code> keyword, like this: </p>\n\n<pre><code>{boolean-expression} And {boolean-expression}\n</code></pre>\n\n<p>In other words, you could have done:</p>\n\n<pre><code>If Target.Address = \"$B$1\" And Target.Address = \"$B$2\" Then\n</code></pre>\n\n<p>But as you would suspect, that logic is bound to always return <code>False</code>, because if <code>Target.Address</code> is equal to <code>\"$B$1\"</code> then it can't <em>also</em> be equal to <code>\"$B$2\"</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/a/37554321/1188513\">Scott's answer</a> has the rest of the solution.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464788203, "post_id": 37555016, "comment_id": 62627884, "body": "May I ask why would you dim A1 as the range and never use it again?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464788912, "post_id": 37555016, "comment_id": 62628515, "body": "@JosephLin My apologies there. That was a line of code I used to perform a test unrelated to your procedure. I will edit my code above to remove the lines so it&#39;s not confusing for future users."}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464791504, "post_id": 37555016, "comment_id": 62630609, "body": "That&#39;s very nice of you, thanks! And actually because I have other data validation lists in this specific worksheet, so the first part of the your code is built after <code>Elseif</code>, and I append the second part right after the sub change. However it was not working, there is no error or any message box pop up? Do you think there could be any thing wrong?"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464791853, "post_id": 37555016, "comment_id": 62630901, "body": "And as FYI, I do have another 3 macros that are assigned to the three items in B1 data validations list. Could this be the cause?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464794724, "post_id": 37555016, "comment_id": 62633013, "body": "It&#39;s hard to say without seeing the entirety of the code and/or testing it. You can do some debugging to see if your base code actually calls the function. One quick and easy debugging method is to include a <code>MsgBox</code> inside of the <code>Private Sub SortUsing...</code> method call. (Something like <code>MsgBox &quot;CheckPoint&quot;</code> in a new line after <code>Dim oDict...</code>).  If the message box displays, then we know that the method is being called and we can further debug. Also, it may help if you edit your Original Post and include any of the code you think may help us debug."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464802373, "post_id": 37555016, "comment_id": 62637726, "body": "Looked at the update, and the problem may be with the <code>ElseIf</code> block. It seems that the <code>If</code> part will fire and the <code>ElseIf</code> does not get called. (After all, they both seem to be testing for the same thing, so the <code>ElseIf</code> runs only if the <code>If</code> fails, which it shouldn&#39;t). Did you try debugging with a MsgBox?"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464802585, "post_id": 37555016, "comment_id": 62637852, "body": "I have tried debugging it, but nothing came up. And I have also tried deleting the if part only using your code, hoping it will achieve the same results as my code when leaving the second sort blank. it also didn&#39;t work."}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1464803331, "post_id": 37555016, "comment_id": 62638306, "body": "is there any way that could incorporate these two together. I noticed since you have assign the second key in the dictionary UsingSortDataValidation,  leaving the second blank won&#39;t trigger the sort."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1464788938, "last_edit_date": 1464788938, "creation_date": 1464726281, "answer_id": 37555016, "question_id": 37554204, "link": "https://stackoverflow.com/questions/37554204/vba-target-address-to-two-cells/37555016#37555016", "title": "VBA Target.Address to Two Cells", "body": "<p>I'm going to add in another approach because it's generally not a good idea to have 6 different macros to do essentially the same thing. It will work, but it's more code to maintain, making future changes more difficult.</p>\n\n<p>In the code below, the values of the validation boxes are passed into a function that (1) links each value to a corresponding range, (2) sorts based on the corresponding ranges.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address(0, 0) = \"B1\" Or Target.Address(0, 0) = \"B2\" Then\n        SortUsingDataValidation Range(\"B1\").Value, Range(\"B2\").Value\n    End If\nEnd Sub\n\nPrivate Sub SortUsingDataValidation(sFirst As String, sSecond As String)\n        Dim oDict As Object\n\n        'Create a dictionary (or any collection) to hold references from a data validation\n        'String to its corresponding cell reference\n        Set oDict = CreateObject(\"Scripting.Dictionary\")\n        With ThisWorkbook.Sheets(\"Reports\")\n            Set oDict(\"First\") = .Range(\"I1\")\n            Set oDict(\"Last\") = .Range(\"J1\")\n            Set oDict(\"Company\") = .Range(\"K1\")\n            If oDict.exists(sFirst) And oDict.exists(sSecond) Then\n                .Range(\"F1:CT10000\").Sort Key1:=oDict(sFirst), Order1:=xlAscending, Key2:=oDict(sSecond), Order1:=xlAscending, Header:=xlYes\n            End If\n        End With\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464730923, "post_id": 37555098, "comment_id": 62600995, "body": "Your <code>instr</code> is backwards? Otherwise I like it!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464754869, "post_id": 37555098, "comment_id": 62607110, "body": "If you mean &quot;InstrRev&quot; then no, it isn&#39;t. If you mean I go back 1 position in &quot;strng&quot; then consider I could actually have placed the number at the end of every substring (&quot;LasFirst1, LastCompany2,...&quot;) and go onwards in &quot;strng&quot; using&quot; Mid(strng,pos+Len(Join(target,&quot;&quot;)),1)&quot;. But I found it too verbose."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464796243, "post_id": 37555098, "comment_id": 62634041, "body": "Stealing my correct answer, this means war, Just Kidding, this deserves it, good job."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464797130, "post_id": 37555098, "comment_id": 62634595, "body": "@ScottCraner sorry I actually wanted to put in a shorter alternative to Select Case block"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464797338, "post_id": 37555098, "comment_id": 62634712, "body": "Don&#39;t apologize for a better solution.  It deserves the correct answer and anyone who would truly get upset losing to a better answer is petty and does not understand why this forum exists.  It is good for everyone when a better method is found."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464798041, "post_id": 37555098, "comment_id": 62635136, "body": "@ScottCraner well, thank you. And your words should be carved just below the SO logo!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 4, "last_activity_date": 1464763047, "last_edit_date": 1464763047, "creation_date": 1464726634, "answer_id": 37555098, "question_id": 37554204, "link": "https://stackoverflow.com/questions/37554204/vba-target-address-to-two-cells/37555098#37555098", "title": "VBA Target.Address to Two Cells", "body": "<p>Edited:</p>\n\n<ul>\n<li><p>added <code>Application.Transpose()</code> method to <code>Target</code> range since <code>B1:B2</code> is a one-column \"vertical\" range while <code>Join()</code> expects an array which corresponds to a one-row \"horizontal\" range</p></li>\n<li><p>added some code \"flavours\" to deal with different environments </p></li>\n</ul>\n\n<p>Changing approach</p>\n\n<pre><code>If Target.Address = \"$B$1:$B$2\" Then\n    Dim strng As String\n    Dim pos as Long\n\n    strng = \"1LastFirst,2LastCompany,3FirstLast,4FirstCompany,5CompanyLast,6CompanyLast\"\n    pos = Instr(strng,Join (Application.Transpose(Target),\"\"))\n    If pos &gt; 0 then Application.Run \"Macro_Sort\" &amp; Mid(strng,pos-1,1)\nEnd If\n</code></pre>\n\n<p>Finally some environment advices:</p>\n\n<p>In case you're running this code inside a Worksheet event handler then</p>\n\n<ul>\n<li><p><code>If Target.Address = \"$B$1:$B$2\"</code> could be <code>True</code> only in a <code>Worksheet_SelectionChange</code> handler, while other relevant handlers dealing with a <code>Target</code> range parameter would detect only a one-cell Range</p>\n\n<p>For instance should you need to run it inside a <code>Worksheet_Change</code> event handler then you'd need to change the check into some:</p>\n\n<p><code>If Not Intersect(Target, Range (\"B1:B2\")) Is Nothing Then</code></p>\n\n<p>Which could also do in many other different cases</p></li>\n<li><p>Subs to be called by <code>Application.Run</code> method must be placed in any module but not in a Worksheet one</p></li>\n</ul>\n"}], "owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11889, "favorite_count": 0, "accepted_answer_id": 37555098, "answer_count": 4, "score": 0, "last_activity_date": 1612873905, "creation_date": 1464723280, "last_edit_date": 1464795508, "question_id": 37554204, "link": "https://stackoverflow.com/questions/37554204/vba-target-address-to-two-cells", "title": "VBA Target.Address to Two Cells", "body": "<p>I have to build a nested filter structure in Excel using VBA. The approach is to build two data validation lists that contain sorting indexes. I have three possible soring indexes, which is lastName, FirstName and Company. Since in the sort function doesn't allow indexes to be referred outside of the sorting range. I build those 6 possible combinations of the indexes, such as below.</p>\n\n<pre><code>Sub Macro_Sort1()\nSheets(\"Reports\").Range(\"F1:CT10000\").Sort Key1:=Sheets(\"Reports\").Range(\"I1\"), Order1:=xlAscending, Key2:=Sheets(\"Reports\").Range(\"J1\"), Order1:=xlAscending, Header:=xlYes\nEnd Sub    \n</code></pre>\n\n<p>And now I need to assign this macro to those two data validation list, like</p>\n\n<pre><code>If Target.Address = \"$B$1\" and \"$B$2\" Then\n    Select Case Target.Value2\n         Case \"Last\" and \"First\"\n            Call Macro_Sort1\n         Case \"Last\" and \"Company\"\n            Call Macro_Sort2\n         Case \"First\" and \"Last\"\n            Call Macro_Sort3\n         Case \"First\" and \"Company\"\n            Call Macro_Sort4\n         Case \"Company\" and \"Last\"\n            Call Macro_Sort5\n         Case \"Company\" and \"First\"\n            Call Macro_Sort6\n   End Select\nEnd if\nEnd Sub\n</code></pre>\n\n<p>However, obviously it tells me there is an error with the Target.Address Sentence in regards to THEN. </p>\n\n<p>Please help me figure out if there is other approach to achieve this.</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>Update:</strong></p>\n\n<p>As I mentioned, I have two filters, and the first one can be used independently, it has macro assigned to it like below:</p>\n\n<pre><code>Sub Macro_Sort1()\nSheets(\"Reports\").Range(\"F1:CT10000\").Sort Key1:=Sheets(\"Reports\").Range(\"I1\"), Header:=xlYes, Order1:=xlAscending\nEnd Sub\n</code></pre>\n\n<p>So before the code for both filters there would be code like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$B$17\" Then\n    Select Case Target.Value2\n         Case \"Last\"\n            Call Macro_Sort1\n         Case \"First\"\n            Call Macro_Sort2\n         Case \"Company\"\n            Call Macro_Sort3\n    End Select\n</code></pre>\n\n<p>Based on some advice, I appended this part after the previous one.</p>\n\n<pre><code>ElseIf Target.Address(0, 0) = \"$B$17\" Or Target.Address(0, 0) = \"$B$18\" Then\n       SortUsingDataValidation Range(\"B17\").Value, Range(\"B18\").Value\nEnd If\nEnd Sub\n\nPrivate Sub SortUsingDataValidation(sFirst As String, sSecond As String)\nDim oDict As Object\n\nSet oDict = CreateObject(\"Scripting.Dictionary\")\nWith ThisWorknook.shhets(\"Reports\")\nSet oDict(\"Last\") = .Range(\"I1\")\nSet oDict(\"First\") = .Range(\"J1\")\nSet oDict(\"Company\") = .Range(\"K1\")\nIf oDict.exists(sFirst) And oDict.exists(sSecond) Then\n   .Range(\"F1:CT10000\").Sort Key1:=oDict(sFirst), Order1:=xlAscending, key2:=oDict(sSecond), Order1:=xlAscending, Header:=xlYes\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Although it is really nice approach, it fails to run. There is no error or any message boxes pop up. So please check if it is code of first filter affecting the double filter code.</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 2, "creation_date": 1464723274, "post_id": 37554164, "comment_id": 62597089, "body": "Without fully parsing that formula (so I&#39;m not totally sure) I suspect you&#39;d be better off with a lookup table for some of the logic.  VLookup has a &quot;fuzzy match&quot; feature where one enters the fourth parameter as True and you get a &quot;band&quot; match instead of an exact match."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1464723766, "post_id": 37554164, "comment_id": 62597341, "body": "some computer science might help here <a href=\"https://www.youtube.com/watch?v=8ijOIueCJkI\" rel=\"nofollow noreferrer\">youtube.com/watch?v=8ijOIueCJkI</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": 3, "last_activity_date": 1464724688, "creation_date": 1464724688, "answer_id": 37554613, "question_id": 37554164, "link": "https://stackoverflow.com/questions/37554164/vba-function-for-multiple-ifs-for-multiple-outcomes/37554613#37554613", "title": "VBA function for multiple Ifs for multiple outcomes", "body": "<p>Brief comments instead of a full rewrite</p>\n\n<p>In VBA</p>\n\n<ul>\n<li>Use <strong>and</strong> between your if terms</li>\n<li>VBA doesn't recognize a % in the number so compare to the actual value in the cell</li>\n<li>You don't assign your results to anything just saying \"T\" doesn't do anything</li>\n</ul>\n\n<blockquote>\n<pre><code>IF G34&gt;0.8499 and J34&gt;0.7999 and K34=\"Yes\" and M34 &gt;0.8999 and N34 = 100 and O34&gt;.8999 Then \n  variable = \"T\" \nelseif ...\n  variable = \"T-\"\nelseif ...\n  variable = \"P\"\nelse\n  variable = \"no case\"\nend if\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6406304, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ljieDp3AdeI/AAAAAAAAAAI/AAAAAAAAAE4/EevaUuEc1wk/photo.jpg?sz=128", "display_name": "Ciara ", "link": "https://stackoverflow.com/users/6406304/ciara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464724688, "creation_date": 1464723128, "last_edit_date": 1464723270, "question_id": 37554164, "link": "https://stackoverflow.com/questions/37554164/vba-function-for-multiple-ifs-for-multiple-outcomes", "title": "VBA function for multiple Ifs for multiple outcomes", "body": "<p>I'm very new to the VBA functions/anything above basic user level computers.  I'm trying to create a function in excel that returns a value (there are five values that the ratings can equate to) based on its rating in six different areas(or cells).  Trying to auto populate the rating of a company based on the 6 different criteria. </p>\n\n<p>Example If G34 > 84.99%, J34 >79.99%, K34 =\"Yes\" Then \"T\" but If G34 &lt; 84.99%, J34 >79.99%, and K34 =\"No\" Then \"T-\".   I've been trying an ElseIf statement but keep running into issues.  Help is very appreciated!!!  </p>\n\n<p>Below is the very elementary full function that I'm trying to get:</p>\n\n<pre><code>IF(G34&gt;84.99%, J34&gt;79.99%, K34=\"Yes\", M34 &gt;89.99%, N34 = 100%, O34&gt;89.99%, Then \"T\", \nIF(G34&gt;74.99%, G34&lt;84.99%, J34&gt;79.99%, K34 = \"Yes\", M34 &gt;79.99%, M34 &lt;89.99%, N34 = 100%, O34 &lt;89.99%, O34&gt;79.99%, Then \"T-\", \nIF(G34&gt;64.99%, G34&lt;74.99%, J34&lt;79.99%, G34 &gt; 74.99%, K34 = \"NO\", M34 &gt;64.99%, M34 &lt;79.99%, N34 = 100%, O34 &lt;89.99%, O34&gt;79.99%, Then \"P\", \nIF(G34&gt;59.99%, G34&lt;64.99%, J34&lt;74.99%, J34 &gt; 59.99%, K34 = \"NO\", M34 &gt;49.99%, M34 &lt;64.99%, N34 &lt; 100%, O34 &lt; 79.99%, Then \"P-\", \nIF(G34&lt;59.99%, J34&lt;59.99%, K34 = \"NO\", M34 &lt;49.99%, N34 &lt; 100%, O34 &lt; 79.99%, Then \"U\")))))   \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "edited": false, "score": 0, "creation_date": 1464723425, "post_id": 37554069, "comment_id": 62597162, "body": "This is what I was thinking and I think my question is worded wrongly. the Pivot field has years from 2008-2020. Is there a way to set yr to the current year so that I don&#39;t need to update the macro next year when its 2017?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "edited": false, "score": 0, "creation_date": 1464723461, "post_id": 37554069, "comment_id": 62597178, "body": "@sorenthomsen well you know how to declare a variable, don&#39;t you? Doug&#39;s answer has 3 examples of <i>object variables</i>. Values are exactly the same, except you&#39;ll do <code>Dim value As Integer</code> and assign it without the <code>Set</code> keyword."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "edited": false, "score": 0, "creation_date": 1464724030, "post_id": 37554069, "comment_id": 62597498, "body": "No. I said <b>without</b> the <code>Set</code> keyword, so <code>Dim yr As Integer : yr = Year(Date)</code>, which would assign <code>yr</code> the value of the current calendar year. The <code>Set</code> keyword is only necessary when assigning <b>object references</b>."}, {"owner": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "edited": false, "score": 0, "creation_date": 1464725282, "post_id": 37554069, "comment_id": 62598213, "body": "I only want to deselect year values that are less than the current years. does this look correct?         Set pf = pt.PivotFields(&quot;Year &quot;)         yr = Year(Now)           For Each pi In pf.PivotItems             If pf.Value &lt; &quot;yr&quot; Then pi.Visible = False         Next pi"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "edited": false, "score": 0, "creation_date": 1464725359, "post_id": 37554069, "comment_id": 62598253, "body": "Don&#39;t put the <code>yr</code> variable in quotes in the <code>pf.Value &lt; &quot;yr&quot;</code> expression; the quotes make it evaluate as a <i>string literal</i>, which will not give you the results you&#39;re expecting. Otherwise, well you could boil it down to <code>pi.Visible = pf.Value &gt;= yr</code>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1464722741, "creation_date": 1464722741, "answer_id": 37554069, "question_id": 37553805, "link": "https://stackoverflow.com/questions/37553805/how-can-i-simplify-this-this-code-vba/37554069#37554069", "title": "How can I simplify this this code [VBA]", "body": "<p>Learn to use <code>For</code> loops.</p>\n\n<pre><code>With PT.PivotFields(\"Year\")\n    For yr = 2011 To 2015\n        .PivotItems(CStr(yr)).Visible = False\n    Next\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1464722904, "post_id": 37554081, "comment_id": 62596884, "body": "<code>For Each</code> loops are even nicer.... but you&#39;re reading OP&#39;s mind here, the question didn&#39;t mention anything about &quot;hide all but the current year&quot; ...or I misread it. Anyway, well done."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464722959, "post_id": 37554081, "comment_id": 62596909, "body": "Ooooh oops O_o I guess i was taking it further than necessary"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464723013, "post_id": 37554081, "comment_id": 62596934, "body": "I also didnt realize this was for Access and not Excel.... But easily changed to account for that"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464723040, "post_id": 37554081, "comment_id": 62596948, "body": "That makes two of us =)"}, {"owner": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464723543, "post_id": 37554081, "comment_id": 62597228, "body": "Thanks this for each loop is really helpful but again I have the same question I asked @Mat&#39;s"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1464722804, "creation_date": 1464722804, "answer_id": 37554081, "question_id": 37553805, "link": "https://stackoverflow.com/questions/37553805/how-can-i-simplify-this-this-code-vba/37554081#37554081", "title": "How can I simplify this this code [VBA]", "body": "<p>see if this works</p>\n\n<pre><code>Dim pt As PivotTable\nDim pf As PivotField\nDim pi As PivotItem\n\n\nSet pt = ActiveSheet.PivotTables(1)\n' change field as needed\nSet pf = pt.PivotFields(\"Year\")\n\nFor Each pi In pf.PivotItems\n    If pf.Value &lt;&gt; \"2016\" Then pi.Visible = False\nNext pi\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6371418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f1599dbce94b9558a6193e672f3afe?s=128&d=identicon&r=PG&f=1", "display_name": "soren thomsen", "link": "https://stackoverflow.com/users/6371418/soren-thomsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 37554081, "answer_count": 2, "score": 0, "last_activity_date": 1594655484, "creation_date": 1464721824, "last_edit_date": 1594655484, "question_id": 37553805, "link": "https://stackoverflow.com/questions/37553805/how-can-i-simplify-this-this-code-vba", "title": "How can I simplify this this code [VBA]", "body": "<p>My current code</p>\n\n<pre><code>    With PT.PivotFields(\"Year\")\n         .PivotItems(\"2012\").Visible = False\n         .PivotItems(\"2013\").Visible = False\n         .PivotItems(\"2014\").Visible = False\n         .PivotItems(\"2011\").Visible = False\n         .PivotItems(\"2015\").Visible = False\n    End With\n</code></pre>\n\n<p>is there a way to set a variable = to the current year so that I can use an If/Then statement to format this pivot table instead? </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1464722922, "post_id": 37553731, "comment_id": 62596892, "body": "Where are these values located within the sheets?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464723226, "post_id": 37553731, "comment_id": 62597063, "body": "While there are a few methods to get the list of sheets, it is faster and easier to hand type them.  Once the the list is created it is just a matter of using the INDIRECT() function.  <code>INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!D1&quot;)</code> where A1 is the cell in which the first sheet name is and D1 is the cell on the respective sheet with the date desired.  Then it can be dragged down."}, {"owner": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "edited": false, "score": 0, "creation_date": 1464724085, "post_id": 37553731, "comment_id": 62597539, "body": "The value for Begin Date is in D5 and for End Date is in F5, these values are consistent accross all Sheets"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464724367, "post_id": 37553731, "comment_id": 62597700, "body": "Then if your list starts in A1 then your two formulas would be <code>=INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!D5&quot;)</code> and <code>=INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!F5&quot;)</code> then drag these formulas down to the end of the list of sheets."}, {"owner": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "edited": false, "score": 0, "creation_date": 1464725409, "post_id": 37553731, "comment_id": 62598288, "body": "That Worked OK (=INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!D5&quot;) and =INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!F5&quot;)) - Now was thinking how to create a link that moves the user to the correct sheet, do you know how can I do this using this table?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464728385, "post_id": 37553731, "comment_id": 62599853, "body": "look into hyperlinks. See <a href=\"http://www.tech-recipes.com/rx/49296/microsoft-excel-create-a-hyperlink-to-another-worksheet-or-excel-sheet/\" rel=\"nofollow noreferrer\">HERE</a>"}, {"owner": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "edited": false, "score": 0, "creation_date": 1464729117, "post_id": 37553731, "comment_id": 62600196, "body": "Thank you. I know How to create links, But I wanted to automatically generate links base on the name of the sheet"}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "is_accepted": false, "score": 1, "last_activity_date": 1464722826, "creation_date": 1464722826, "answer_id": 37554088, "question_id": 37553731, "link": "https://stackoverflow.com/questions/37553731/excel-list-sheet-names-values/37554088#37554088", "title": "Excel List Sheet Names + Values", "body": "<p>You could just put a reference, like \"=Sheet1!B2\"  where B2 would be the cell in Sheet 1 that has the date you want.   </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "edited": false, "score": 0, "creation_date": 1464724140, "post_id": 37554122, "comment_id": 62597569, "body": "Where do I place this code and How do I use it insi the Table?"}, {"owner": {"reputation": 1, "user_id": 6397754, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jByDlqJyCCw/AAAAAAAAAAI/AAAAAAAABRo/fScgyMnTMh4/photo.jpg?sz=128", "display_name": "VARUN BATRA", "link": "https://stackoverflow.com/users/6397754/varun-batra"}, "reply_to_user": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "edited": false, "score": 0, "creation_date": 1464807135, "post_id": 37554122, "comment_id": 62640282, "body": "Hi, Sorry for the late reply . you do not need to place this table .instead you need to save this code in macro /vba part of excel."}], "tags": [], "owner": {"reputation": 1, "user_id": 6397754, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jByDlqJyCCw/AAAAAAAAAAI/AAAAAAAABRo/fScgyMnTMh4/photo.jpg?sz=128", "display_name": "VARUN BATRA", "link": "https://stackoverflow.com/users/6397754/varun-batra"}, "is_accepted": false, "score": 0, "last_activity_date": 1464722978, "creation_date": 1464722978, "answer_id": 37554122, "question_id": 37553731, "link": "https://stackoverflow.com/questions/37553731/excel-list-sheet-names-values/37554122#37554122", "title": "Excel List Sheet Names + Values", "body": "<p>use below code . and i am assuming that u have begin date and end date at cell b2 and c2 respectively of every sheet.</p>\n\n<pre><code>Sub SheetNames()\nColumns(1).Insert\nFor i = 1 To Sheets.Count\nCells(i, 1) = Sheets(i).Name\nCells(i, 2) = Sheets(i)!B2\nCells(i, 3) = Sheets(i)!C2\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1464725667, "post_id": 37554140, "comment_id": 62598433, "body": "You mean <code>n As String</code> and NOT <code>sn As String</code>...?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1464726729, "last_edit_date": 1464726729, "creation_date": 1464723010, "answer_id": 37554140, "question_id": 37553731, "link": "https://stackoverflow.com/questions/37553731/excel-list-sheet-names-values/37554140#37554140", "title": "Excel List Sheet Names + Values", "body": "<p>If the dates are in cells <strong>A1</strong> and <strong>B1</strong> of each sheet, then:</p>\n\n<pre><code>Sub IndexMaker()\n    Dim sh As Worksheet, n As String\n\n    With ThisWorkbook\n            .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"index\"\n            Set sh = ActiveSheet\n    End With\n\n    For i = 1 To Sheets.Count\n        n = Sheets(i).Name\n        v1 = Sheets(i).Range(\"A1\").Value\n        v2 = Sheets(i).Range(\"B1\").Value\n        If n &lt;&gt; \"index\" Then\n            sh.Cells(i, \"A\").Value = n\n            sh.Cells(i, \"B\").Value = v1\n            sh.Cells(i, \"C\").Value = v2\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6185175, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdd1f80b9b85bc8ed3337a3823065ee6?s=128&d=identicon&r=PG&f=1", "display_name": "JPKI", "link": "https://stackoverflow.com/users/6185175/jpki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1464726729, "creation_date": 1464721583, "last_edit_date": 1531161705, "question_id": 37553731, "link": "https://stackoverflow.com/questions/37553731/excel-list-sheet-names-values", "title": "Excel List Sheet Names + Values", "body": "<p>I have an Excel Workbook with Several sheets. Whithin each sheet I have 2 cell values with dates (Begin Date and End Date).</p>\n\n<p>My Goal is to create a new Sheet (Index Sheet) that has a table that lists all existing sheets in the workbook, and, for each Sheet I would have the correspondent cell values for Begin Date and End Date.</p>\n\n<p>Something like this:</p>\n\n<p>Name          Begin Date     End Date</p>\n\n<p>Sheet01       01/01/2016     01/02/2016</p>\n\n<p>Sheet02       12/02/2016     23/03/2016</p>\n\n<p>Sheet03       22/03/2016     30/04/2016</p>\n\n<p>Sheet04       22/12/2016     01/12/2016</p>\n\n<p>How can I do this (If possible avoid VBA, I`m not a developer :))</p>\n\n<p>Thank you</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xdco1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xdco1.png\" alt=\"enter image description here\"></a></p>\n"}]