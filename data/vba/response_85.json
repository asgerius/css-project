[{"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 5, "creation_date": 1472082359, "post_id": 39134462, "comment_id": 65614534, "body": "We generally try to help people learn to fish. If you just want a fish to be handed to you, look towards the job link and find someone that you would be willing to pay. They will appreciate it. OR, post your macro code where you have tried to accomplish this along with a description of errors or where you are getting hung up and we will be happy to help you get past those errors and issues."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1472128522, "post_id": 39134462, "comment_id": 65634801, "body": "You could start by recording a macro while you <code>unpivot</code> your basic column (using <code>Power Pivot</code> or <code>Data</code> \u25ba <code>Get and Transform</code>); add in your index column and the other modifications you need, and save as <code>csv</code>.  Then edit your macro to clean it up."}], "answers": [{"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1472142446, "post_id": 39134736, "comment_id": 65644148, "body": "Some feedback on the down vote would be useful!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1472168933, "post_id": 39134736, "comment_id": 65656268, "body": "Not my downvote, but at a glance that code declares a truckload of implicit <code>Variant</code> locals, scrolls forever and smells like it needs some serious refactoring, be it only to remove these <code>GoTo</code> jumps from 1980 and split responsibilities a bit."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472171705, "post_id": 39134736, "comment_id": 65656920, "body": "In my defense, I&#39;m an accountant, and the code works : )  Appreciate the feedback though.  I start with <code>Option Explicit</code> so aren&#39;t all the variables explicit?  What&#39;s the reason to avoid using <code>GoTo</code> jumps?  This runs quick even with fairly large data sets.  Can you point me to any resources about better alternatives?  Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1472173082, "post_id": 39134736, "comment_id": 65657249, "body": "<code>Option Explicit</code> ensures all variables are <i>declared</i>, but not specifying an explicit type (e.g. <code>Dim foo As String</code>) makes a variable a <code>Variant</code> that can be assigned and reassigned to just about anything; <code>GoTo</code> is frowned upon because it makes code harder to follow... and can spawn <a href=\"https://xkcd.com/292/\" rel=\"nofollow noreferrer\">deadly raptors</a> - I can&#39;t fit much more in a comment, but feel free to put your code up for peer review on <a href=\"https://codereview.stackexchange.com\">Code Review</a>; VBA reviewers will enjoy such a meaty piece! See <a href=\"http://meta.codereview.stackexchange.com/q/2436/23788\">how to get the best value out of CR</a> to make a <i>great</i> post!"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472173474, "post_id": 39134736, "comment_id": 65657338, "body": "Raptor...hehe. Thanks!"}], "tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 1, "last_activity_date": 1472083187, "creation_date": 1472083187, "answer_id": 39134736, "question_id": 39134462, "link": "https://stackoverflow.com/questions/39134462/excel-vba-macros-for-data-set/39134736#39134736", "title": "Excel VBA macros for data set", "body": "<p>Here's a macro that will get you most of the way.  It takes the data in your first table and organizes it so that your date in like columns (person1 and person2) is separated into separate rows:</p>\n\n<p>This script assumes that your fixed column(s) are on the left and the columns to be combined (and split out into multiple rows) follow on the right. I hope this helps!</p>\n\n<pre><code>Option Explicit\n\nSub MatrixConverter2_3()\n\n' Macro created 11/16/2005 by Peter T Oboyski (updated 8/24/2006)\n'\n' *** Substantial changes made by Chris Brackett (updated 8/3/2016) ***\n'\n' You are welcome to redistribute this macro, but if you make substantial\n' changes to it, please indicate so in this section along with your name.\n' This Macro converts matrix-type spreadsheets (eg. plot x species data) into column data\n' The new (converted) spreadsheet name is \"DB of 'name of active spreadsheet'\"\n' The conversion allows for multiple header rows and columns.\n\n'--------------------------------------------------\n' This section declares variables for use in the script\n\nDim book, head, cels, mtrx, dbase, v, UserReady, columnsToCombine, RowName, DefaultRowName, DefaultColName1, DefaultColName2, ColName As String\nDim defaultHeaderRows, defaultHeaderColumns, c, r, selectionCols, ro, col, newro, newcol, rotot, coltot, all, rowz, colz, tot As Long\nDim headers(100) As Variant\nDim dun As Boolean\n\n\n'--------------------------------------------------\n' This section sets the script defaults\n\ndefaultHeaderRows = 1\ndefaultHeaderColumns = 2\n\nDefaultRowName = \"Activity\"\n\n'--------------------------------------------------\n' This section asks about data types, row headers, and column headers\n\nUserReady = MsgBox(\"Have you selected the entire data set (not the column headers) to be converted?\", vbYesNoCancel)\nIf UserReady = vbNo Or UserReady = vbCancel Then GoTo EndMatrixMacro\n\nall = MsgBox(\"Exclude zeros and empty cells?\", vbYesNoCancel)\nIf all = vbCancel Then GoTo EndMatrixMacro\n\n\n' UN-COMMENT THIS SECTION TO ALLOW FOR MULTIPLE HEADER ROWS\nrowz = 1\n' rowz = InputBox(\"How many HEADER ROWS?\" &amp; vbNewLine &amp; vbNewLine &amp; \"(Usually 1)\", \"Header Rows &amp; Columns\", defaultHeaderRows)\n' If rowz = vbNullString Then GoTo EndMatrixMacro\n\ncolz = InputBox(\"How many HEADER COLUMNS?\" &amp; vbNewLine &amp; vbNewLine &amp; \"(These are the columns on the left side of your data set to preserve as is.)\", \"Header Rows &amp; Columns\", defaultHeaderColumns)\nIf colz = vbNullString Then GoTo EndMatrixMacro\n\n\n'--------------------------------------------------\n' This section allows the user to provide field (column) names for the new spreadsheet\n\nselectionCols = Selection.Columns.Count ' get the number of columns in the selection\nFor r = 1 To selectionCols\n    headers(r) = Selection.Cells(1, r).Offset(rowOffset:=-1, columnOffset:=0).Value ' save the column headers to use as defaults for user provided names\nNext r\n\ncolz = colz * 1\ncolumnsToCombine = \"'\" &amp; Selection.Cells(1, colz + 1).Offset(rowOffset:=-1, columnOffset:=0).Value &amp; \"' to '\" &amp; Selection.Cells(1, selectionCols).Offset(rowOffset:=-1, columnOffset:=0).Value &amp; \"'\"\n\nDim Arr(20) As Variant\nnewcol = 1\nFor r = 1 To rowz\n    If r = 1 Then RowName = DefaultRowName\n    Arr(newcol) = InputBox(\"Field name for the fields/columns to be combined\" &amp; vbNewLine &amp; vbNewLine &amp; columnsToCombine, , RowName)\n    If Arr(newcol) = vbNullString Then GoTo EndMatrixMacro\n    newcol = newcol + 1\nNext\nFor c = 1 To colz\n    ColName = headers(c)\n    Arr(newcol) = InputBox(\"Field name for column \" &amp; c, , ColName)\n    If Arr(newcol) = vbNullString Then GoTo EndMatrixMacro\n    newcol = newcol + 1\nNext\nArr(newcol) = \"Data\"\nv = newcol\n\n'--------------------------------------------------\n' This section creates the new spreadsheet, names it, and color codes the new worksheet tab\n\nmtrx = ActiveSheet.Name\nSheets.Add After:=ActiveSheet\ndbase = \"DB of \" &amp; mtrx\n\n'--------------------------------------------------\n' If the proposed worksheet name is longer than 28 characters, truncate it to 29 characters.\n    If Len(dbase) &gt; 28 Then dbase = Left(dbase, 28)\n\n\n'--------------------------------------------------\n' This section checks if the proposed worksheet name\n'  already exists and appends adds a sequential number\n'  to the name\n    Dim sheetExists As Variant\n    Dim Sheet As Worksheet\n    Dim iName As Integer\n\n    Dim dbaseOld As String\n    dbaseOld = dbase    ' save the original proposed name of the new worksheet\n\n    iName = 0\n\n    sheetExists = False\nCheckWorksheetNames:\n\n    For Each Sheet In Worksheets    ' loop through every worksheet in the workbook\n        If dbase = Sheet.Name Then\n            sheetExists = True\n            iName = iName + 1\n            dbase = Left(dbase, Len(dbase) - 1) &amp; \" \" &amp; iName\n            GoTo CheckWorksheetNames\n            ' Exit For\n        End If\n    Next Sheet\n\n\n'--------------------------------------------------\n' This section notify the user if the proposed\n' worksheet name is already being used and the new\n' worksheet was given an alternate name\n\n    If sheetExists = True Then\n        MsgBox \"The worksheet '\" &amp; dbaseOld &amp; \"' already exists.  Renaming to '\" &amp; dbase &amp; \"'.\"\n    End If\n\n\n'--------------------------------------------------\n' This section creates and names a new worksheet\n    On Error Resume Next    'Ignore errors\n        If Sheets(\"\" &amp; Range(dbase) &amp; \"\") Is Nothing Then   ' If the worksheet name doesn't exist\n            ActiveSheet.Name = dbase    ' Rename newly created worksheet\n        Else\n            MsgBox \"Cannot name the worksheet '\" &amp; dbase &amp; \"'.  A worksheet with that name already exists.\"\n            GoTo EndMatrixMacro\n        End If\n    On Error GoTo 0         ' Resume normal error handling\n\n    Sheets(dbase).Tab.ColorIndex = 41 ' color the worksheet tab\n\n\n'--------------------------------------------------\n' This section turns off screen and calculation updates so that the script\n' can run faster.  Updates are turned back on at the end of the script.\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n\n'--------------------------------------------------\n'This section determines how many rows and columns the matrix has\n\ndun = False\nrotot = rowz + 1\nDo\n    If (Sheets(mtrx).Cells(rotot, 1) &gt; 0) Then\n        rotot = rotot + 1\n    Else\n        dun = True\n    End If\nLoop Until dun\nrotot = rotot - 1\n\ndun = False\ncoltot = colz + 1\nDo\n    If (Sheets(mtrx).Cells(1, coltot) &gt; 0) Then\n        coltot = coltot + 1\n    Else\n        dun = True\n    End If\nLoop Until dun\ncoltot = coltot - 1\n\n\n'--------------------------------------------------\n'This section writes the new field names to the new spreadsheet\n\nFor newcol = 1 To v\n    Sheets(dbase).Cells(1, newcol) = Arr(newcol)\nNext\n\n\n'--------------------------------------------------\n'This section actually does the conversion\n\ntot = 0\nnewro = 2\nFor col = (colz + 1) To coltot\n    For ro = (rowz + 1) To rotot 'the next line determines if data are nonzero\n        If ((Sheets(mtrx).Cells(ro, col) &lt;&gt; 0) Or (all &lt;&gt; 6)) Then   'DCB modified \"&gt;0\" to be \"&lt;&gt;0\" to exclude blank and zero cells\n            tot = tot + 1\n            newcol = 1\n            For r = 1 To rowz            'the next line copies the row headers\n                Sheets(dbase).Cells(newro, newcol) = Sheets(mtrx).Cells(r, col)\n                newcol = newcol + 1\n            Next\n            For c = 1 To colz         'the next line copies the column headers\n                Sheets(dbase).Cells(newro, newcol) = Sheets(mtrx).Cells(ro, c)\n                newcol = newcol + 1\n            Next                                'the next line copies the data\n            Sheets(dbase).Cells(newro, newcol) = Sheets(mtrx).Cells(ro, col)\n            newro = newro + 1\n        End If\n    Next\nNext\n\n\n'--------------------------------------------------\n'This section displays a message box with information about the conversion\n\nbook = \"Original matrix = \" &amp; ActiveWorkbook.Name &amp; \": \" &amp; mtrx &amp; Chr(10)\nhead = \"Matrix with \" &amp; rowz &amp; \" row headers and \" &amp; colz &amp; \" column headers\" &amp; Chr(10)\ncels = tot &amp; \" cells of \" &amp; ((rotot - rowz) * (coltot - colz)) &amp; \" with data\"\n\n\n'--------------------------------------------------\n' This section turns screen and calculation updates back ON.\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\n\nMsgBox (book &amp; head &amp; cels)\n\n\n'--------------------------------------------------\n' This is an end point for the macro\n\nEndMatrixMacro:\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6754656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d142a707268367351c4c36ac3de78f?s=128&d=identicon&r=PG&f=1", "display_name": "Denik Gorbunov", "link": "https://stackoverflow.com/users/6754656/denik-gorbunov"}, "is_accepted": false, "score": 0, "last_activity_date": 1473093837, "creation_date": 1473093837, "answer_id": 39334750, "question_id": 39134462, "link": "https://stackoverflow.com/questions/39134462/excel-vba-macros-for-data-set/39334750#39334750", "title": "Excel VBA macros for data set", "body": "<p>Thanks @ChrisB for your answer. Actually I decided to do it my own way and here are the main steps I did:</p>\n\n<ol>\n<li>I created an Excel file with several buttons to which I assigned below Subroutines. Also I have added some parameters, which user can modify (OrderId, Delivery Date and WH id).</li>\n<li>I created a Subroutine ReadData(), which clears the Sheet \"DATA\" in original file and after reads column by column in the data file and generates a linear data set with all required fields on \"DATA\" Sheet.</li>\n<li>After that I simply writes \"DATA\" sheet to external csv file.</li>\n</ol>\n\n<p>the final code looks like this:</p>\n\n<pre><code>Global Const DAODBEngine = \"DAO.DBEngine.36\"\nGlobal intColBeg As Integer                 'Column Index with Data set to analyze\nGlobal intRowBeg As Integer                 'Row Index with Data set to analyze\n\n\nSub FileOpen()\n    Dim filePath As String\n    filePath = Application.GetOpenFilename()\n    If filePath = \"False\" Then Exit Sub\n    ThisWorkbook.Sheets(\"BASE\").Cells(4, 3) = filePath\nEnd Sub\n\nSub ClearData()\n    ' Check if DATA Sheet exists\n    If Evaluate(\"ISREF('\" &amp; \"DATA\" &amp; \"'!A1)\") Then\n        Application.DisplayAlerts = False\n        ThisWorkbook.Sheets(\"DATA\").Delete\n        Application.DisplayAlerts = True\n    End If\n\n    Dim sheet As Worksheet\n    ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = \"DATA\"\n\nEnd Sub\n\n\n' This function reads data and adds it to DATA Sheet\n\nSub ReadData()\n    Dim i As Integer, l As Integer\n    Dim intColumn As Integer, intRow As Integer\n    Dim intAddRow As Integer\n    Dim wbCopyFrom As Workbook\n    Dim wbCopyTo As Workbook\n    Dim wsCopyFrom As Worksheet\n    Dim wsCopyTo As Worksheet\n    Dim dataLoc As String, wbLoc As String\n    Dim mandant As String\n    Dim orderId As String\n    Dim orderNum As Integer\n    Dim shipDate As Date\n\n    dataLoc = Trim(ThisWorkbook.Sheets(\"BASE\").Cells(4, 3).Text)\n\n    Set wbCopyFrom = Workbooks.Open(dataLoc)\n    Set wsCopyFrom = wbCopyFrom.Worksheets(1)\n\n    ThisWorkbook.Activate\n\n    Call ClearData              ' Clears all the data on DATA Sheet\n\n    Set wbCopyTo = ThisWorkbook\n    Set wsCopyTo = wbCopyTo.Sheets(\"DATA\")\n\n    wbCopyTo.Activate\n\n    mandant = wbCopyTo.Sheets(\"BASE\").Cells(11, 3).Text\n    orderId = wbCopyTo.Sheets(\"BASE\").Cells(7, 3).Text\n    shipDate = wbCopyTo.Sheets(\"BASE\").Cells(9, 3).Text\n\n\n    ' Initial upper left row/column where matrix data begins\n\n    intColBeg = 4\n    intRowBeg = 4\n\n    intColumn = intColBeg\n    intRow = intRowBeg\n    intAddRow = 1               ' We will add data from this row\n\n    orderNum = 1\n\n    While Trim(wsCopyFrom.Cells(intRowBeg - 1, intColumn).Text) &lt;&gt; \"\"\n\n        ' Header of an Order\n\n        wsCopyTo.Cells(intAddRow, 1) = \"H;OUT;\" &amp; mandant &amp; \";\" &amp; orderId &amp; \"/\" &amp; orderNum &amp; \";\" &amp; _\n                \";;\" &amp; Mid(shipDate, 7, 4) &amp; Mid(shipDate, 4, 2) &amp; Mid(shipDate, 1, 2) &amp; \";\" &amp; _\n                Trim(wsCopyFrom.Cells(3, intColumn).Text) &amp; \";\" &amp; Trim(wsCopyFrom.Cells(2, intColumn).Text) &amp; _\n                \";;;;;;;999;;\"\n\n        Dim r As Integer\n\n        r = 1\n\n        intAddRow = intAddRow + 1\n\n        While Trim(wsCopyFrom.Cells(intRow, intColBeg - 1).Text) &lt;&gt; \"\"\n            If (Trim(wsCopyFrom.Cells(intRow, intColumn).Text) &lt;&gt; \"\") Then\n                If Round(CDbl(Trim(wsCopyFrom.Cells(intRow, intColumn).Value)), 0) &gt; 0 Then\n\n                    ' Rows of an Order\n\n                    wsCopyTo.Cells(intAddRow, 1) = \"I;\" &amp; orderId &amp; \"/\" &amp; orderNum &amp; \";\" &amp; r &amp; \";\" &amp; _\n                    Trim(wsCopyFrom.Cells(intRow, 1).Text) &amp; \";\" &amp; Trim(wsCopyFrom.Cells(intRow, intColumn).Value) &amp; _\n                    \";PCE;;;;;;;;;;;;;;;\"\n\n                    r = r + 1\n\n                    intAddRow = intAddRow + 1\n                End If\n            End If\n\n            intRow = intRow + 1\n        Wend\n\n        intRow = intRowBeg\n\n        intColumn = intColumn + 1\n\n        orderNum = orderNum + 1\n\n    Wend\n\n    wbCopyFrom.Close\n    wbCopyTo.Sheets(\"BASE\").Activate\n\nEnd Sub\n\nSub Export()\nDim MyPath As String\nDim MyFileName As String\n\nMyFileName = \"Orders_\" &amp; Sheets(\"BASE\").Cells(7, 3).Text &amp; \"_\" &amp; Format(Date, \"ddmmyyyy\")\n\nIf Not Right(MyFileName, 4) = \".csv\" Then MyFileName = MyFileName &amp; \".csv\"\n\nSheets(\"DATA\").Copy\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = \"\" '&lt;~~ The start folder path for the file picker.\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    MyPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nNextCode:\n\nIf MyPath &lt;&gt; \"\" Then\n    Application.DisplayAlerts = False\n    With ActiveWorkbook\n        .SaveAs fileName:=MyPath &amp; MyFileName, AccessMode:=xlExclusive, FileFormat:=xlCSV, CreateBackup:=False, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n        .Close False\n    End With\n    Application.DisplayAlerts = True\nElse\n    On Error Resume Next\n    ActiveWorkbook.Close SaveChanges:=False\n    If Err.Number = 1004 Then\n        On Error GoTo 0\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I believe that this code isn't optimal as I don't have any experience in VBA and it was a method of trying/changing/trying again in debugging mode and googling in case of issues.</p>\n\n<p>If you can provide any suggestion how to optimise it - that would be great!</p>\n"}], "owner": {"reputation": 13, "user_id": 6754656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d142a707268367351c4c36ac3de78f?s=128&d=identicon&r=PG&f=1", "display_name": "Denik Gorbunov", "link": "https://stackoverflow.com/users/6754656/denik-gorbunov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3287, "favorite_count": 1, "closed_date": 1473430505, "answer_count": 2, "score": 0, "last_activity_date": 1473093837, "creation_date": 1472081072, "last_edit_date": 1472105485, "question_id": 39134462, "link": "https://stackoverflow.com/questions/39134462/excel-vba-macros-for-data-set", "closed_reason": "Needs more focus", "title": "Excel VBA macros for data set", "body": "<p>I need to create a csv file from data set matrix, in which I have materials as a rows, people as a columns and quantity of products on intersection. Here is an example of this data set (Order id #1000):</p>\n\n<pre><code>Materials  Person1  Person2  \n563718       20       40\n837563       15       35\n</code></pre>\n\n<p>As a first action I have to transform this data set to a linear structure in this way on additional sheet:</p>\n\n<pre><code>Orderid   Material   Person    Qty\n1000      563718     Person1   20\n1000      837563     Person1   15\n1000      563718     Person2   40\n1000      837563     Person2   35\n</code></pre>\n\n<p>And from this linear structure I have to generate a csv file with Orders for another system based on unique Persons from the list above. Each Order should have one header line and details based on the number of materials he/she ordered. General structure is the following:</p>\n\n<pre><code>H,1000-1,OUT,20160830,Person1\nl,1000-1,1,563718,20,EA\nl,1000-1,2,837563,15,EA\nH,1000-2,OUT,20160830,Person2\nl,1000-2,1,563718,40,EA\nl,1000-2,2,837563,15,EA\n</code></pre>\n\n<p>where \"H\" - means Header row, \"1000-1\" - first Sub-Order of a Global order 1000, \"20160830\" requested delivery date, \"l\" - line row, \"1\" - line number, \"EA\" - unit of measure.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472089929, "post_id": 39134335, "comment_id": 65616075, "body": "Does it throw any Errors?"}, {"owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472090013, "post_id": 39134335, "comment_id": 65616100, "body": "Nope - executes without problem, I can see the change int the <code>item.subject</code> object but its not displayed on screen."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1472090679, "post_id": 39134335, "comment_id": 65616268, "body": "Did you call .Display, before or after the change? I don&#39;t see it in the code above."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472090882, "post_id": 39134335, "comment_id": 65616313, "body": "So your trying to change subject from <code>Confidential and Legally Privileged</code> to <code>Confidential and Legally Privileged Confidential and Legally Privileged</code> ?"}, {"owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472091346, "post_id": 39134335, "comment_id": 65616394, "body": "@Om3r no, there is a <code>replace</code> method that removes already existing &quot;Confidential....&quot; text :<code>strSubject = Replace(strSubject, &quot;Confidential and Legally Privileged &quot;, &quot;&quot;)</code>"}, {"owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472092169, "post_id": 39134335, "comment_id": 65616561, "body": "@RyanWildry THATS IT! I had to use the <code>Item.Display</code> to force object from explorer pane (first condition of the <code>IF</code> statement) to separate window and then once again assign <code>oInspector</code> and <code>Item</code> as if in case of second case of <code>IF</code> statement!"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472092271, "post_id": 39134335, "comment_id": 65616581, "body": "Cool, glad we got it."}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "is_accepted": false, "score": 3, "last_activity_date": 1472092391, "creation_date": 1472092391, "answer_id": 39135816, "question_id": 39134335, "link": "https://stackoverflow.com/questions/39134335/updating-email-subject-in-outlook-vba/39135816#39135816", "title": "Updating email subject in Outlook VBA", "body": "<p>Answered thanks to @Ryan Wildry: if the email is edited in the explorer pane, use the <code>.Display</code> method to force a pop-up and then work with it:</p>\n\n<pre><code>Dim Item As Outlook.MailItem\nDim oInspector As Inspector\nSet oInspector = Application.ActiveInspector\n\nIf oInspector Is Nothing Then\n    Set Item = Application.ActiveExplorer.Selection.Item(1)\n    Item.Display   'Force the po-up\n    Set oInspector = Application.ActiveInspector  'Reassign oInpsector and Item again\n    Set Item = oInspector.CurrentItem\nElse\n   Set Item = oInspector.CurrentItem\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "edited": false, "score": 0, "creation_date": 1472093357, "post_id": 39135901, "comment_id": 65616804, "body": "Not really - that is where I had the issue originally: this solution closes the window (so user has to click &quot;reply&quot; again) and it doesn&#39;t update the subject in the message list - If the original subject was &quot;Test&quot;, after clicking the button in the message list it will remain as &quot;Test&quot; but indeed clicking reply (for the SECOND TIME - not very user friendly) will display changed subject: <a href=\"https://s3.postimg.org/8d6wj7k7n/outlook.png\" rel=\"nofollow noreferrer\">s3.postimg.org/8d6wj7k7n/outlook.png</a>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1472093053, "creation_date": 1472093053, "answer_id": 39135901, "question_id": 39134335, "link": "https://stackoverflow.com/questions/39134335/updating-email-subject-in-outlook-vba/39135901#39135901", "title": "Updating email subject in Outlook VBA", "body": "<p>Is this what your trying to do?</p>\n\n<pre><code>Option Explicit\nPublic Sub Confidential()\n    Dim Item As Outlook.MailItem\n    Dim oInspector As Inspector\n    Dim strSubject As String\n    Dim strPrefixSubject As String\n\n    Set oInspector = Application.ActiveInspector\n\n    If oInspector Is Nothing Then\n        Set Item = Application.ActiveExplorer.Selection.Item(1)\n    Else\n       Set Item = oInspector.CurrentItem\n    End If\n\n    strSubject = \"Confidential and Legally Privileged \"\n\n    Debug.Print Item.Subject\n\n    ' Remove previous Confidential and Legally Privileged\n    Item.Subject = Replace(Item.Subject, strSubject, \"\", vbTextCompare)\n    Item.Save\n\n    ' Prefix subject with Confidential and Legally Privileged\n    strPrefixSubject = \"Confidential and Legally Privileged \" &amp; Item.Subject\n\n    ' Set the message subject\n    Item.Subject = strPrefixSubject\n    Item.Save\n\n\n    Set Item = Nothing\n    Set oInspector = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 781, "user_id": 1341244, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/54b8a34d1acde96dec996749e32ebf5b?s=128&d=identicon&r=PG", "display_name": "Yasskier", "link": "https://stackoverflow.com/users/1341244/yasskier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8354, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1592943520, "creation_date": 1472080059, "last_edit_date": 1592943520, "question_id": 39134335, "link": "https://stackoverflow.com/questions/39134335/updating-email-subject-in-outlook-vba", "title": "Updating email subject in Outlook VBA", "body": "<p>I am trying to create a button-controlled macro that would change the topic of an email message. Following <a href=\"https://stackoverflow.com/questions/15476986/working-with-current-open-email\">this thread</a> I've managed to came up with this:</p>\n\n<pre><code>Public Sub Confidential()\n\nDim Item As Outlook.MailItem\nDim oInspector As Inspector\nDim strSubject As String\n\nSet oInspector = Application.ActiveInspector\nIf oInspector Is Nothing Then\n    Set Item = Application.ActiveExplorer.Selection.Item(1)\nElse\n   Set Item = oInspector.CurrentItem\nEnd If\n\nstrSubject = Item.Subject\n\n' Remove previous Confidential and Legally Privileged\nstrSubject = Replace(strSubject, \"Confidential and Legally Privileged \", \"\")\n\n' Prefix subject with Confidential and Legally Privileged\nstrSubject = \"Confidential and Legally Privileged \" &amp; strSubject\n\n' Set the message subject\nItem.Subject = strSubject\n\n\nSet Item = Nothing\nSet oInspector = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>The IF statement is my attempt to cover the bases: user can either edit the email in the pop-up window, when the ActiveInpector is set or user can edit it in the <a href=\"https://www.webucator.com/tutorial/learn-microsoft-outlook/the-outlook-2013-interface/overview-of-the-outlook-interface-reading.cfm\" rel=\"nofollow noreferrer\">reading pane</a> - when the ActiveExplorer.Selection is set.</p>\n\n<p>Problem is in the fact that while in the first case the macro works as expected, in the second the subject is not changed (even while I can see it changing while debugging the code). What is even more interesting if the message is selected but not edited (i.e. user hasn't clicked \"reply\" button) the macro works fine changing the topic in the message list.</p>\n\n<p>Now, I've found <a href=\"https://stackoverflow.com/questions/1785508/in-outlook-vba-how-can-i-change-the-subject-so-it-changes-the-subject-in-the-ex\">this thread</a> but a) it s over 6 years old and b) points to forum that doesn't exist anymore. As suggested in it, I've tried <code>Item.Save</code> method, but it doesn't seem to do anything except closing the edited message with original subject.</p>\n"}, {"tags": ["excel", "vba", "timezone"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1472081804, "post_id": 39134156, "comment_id": 65614394, "body": "do you care about the days?  for example 2300 MST is 100 EST the next day."}, {"owner": {"reputation": 29, "user_id": 6741727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62d951d6a271f47de74650c255514b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Maya Cat", "link": "https://stackoverflow.com/users/6741727/maya-cat"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472082038, "post_id": 39134156, "comment_id": 65614456, "body": "No in this case the date change doesn&#39;t matter"}, {"owner": {"reputation": 29, "user_id": 6741727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62d951d6a271f47de74650c255514b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Maya Cat", "link": "https://stackoverflow.com/users/6741727/maya-cat"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472082339, "post_id": 39134156, "comment_id": 65614530, "body": "I just need all the data in EST so I can remove the data that happens in during a certain time EST"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472082376, "post_id": 39134156, "comment_id": 65614539, "body": "Are the times actual times or just numbers?  The difference is how excel is storing them, an actual time is a decimal that has a mask to look like a time, while a number is just a number."}, {"owner": {"reputation": 29, "user_id": 6741727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62d951d6a271f47de74650c255514b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Maya Cat", "link": "https://stackoverflow.com/users/6741727/maya-cat"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472082422, "post_id": 39134156, "comment_id": 65614546, "body": "They&#39;re just as numbers"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6741727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62d951d6a271f47de74650c255514b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Maya Cat", "link": "https://stackoverflow.com/users/6741727/maya-cat"}, "edited": false, "score": 0, "creation_date": 1472085141, "post_id": 39134653, "comment_id": 65615149, "body": "Thank for you help, one quick question, I have two columns of time, (start time and end time) I need to find the data that either starts or ends during a certain time window, how can I scan both columns for that information without repeating rows?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1472082638, "creation_date": 1472082638, "answer_id": 39134653, "question_id": 39134156, "link": "https://stackoverflow.com/questions/39134156/excel-time-zone-conversion/39134653#39134653", "title": "Excel Time Zone Conversion", "body": "<p>Create a table with the conversions:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UP2Wb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UP2Wb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then use a Vlookup in an If to deal with the over 2400 hrs.</p>\n\n<pre><code>=IF(A1+VLOOKUP(B1,F:G,2,0)&gt;2359,A1+VLOOKUP(B1,F:G,2,0)-2400,A1+VLOOKUP(B1,F:G,2,0))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/n4Qcr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4Qcr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1472083058, "creation_date": 1472083058, "answer_id": 39134707, "question_id": 39134156, "link": "https://stackoverflow.com/questions/39134156/excel-time-zone-conversion/39134707#39134707", "title": "Excel Time Zone Conversion", "body": "<p>For now here are a few suggestions:</p>\n\n<ol>\n<li><p>The basic formula I would recommend using would be this one:</p>\n\n<p>=IF((G10+300)>2400,(G10+300)-2400,(G10+300))</p></li>\n</ol>\n\n<p>Where G10 is your original cell and 300 is the number of hours you are adding ( all hours will be multiples of 100). To ensure you don't get times like 29:00 you need to test the result then subtract 2400 if it went over. The same test will need to be done for a negative time like -200</p>\n\n<pre><code>=IF((G12-300)&lt;0,(G12-300)+2400,(G12+300))\n</code></pre>\n\n<p>Now you have to replace 300 with the actual time zone difference you want to calculate. To do that you'll need to use the <code>Vlookup</code> function and create yourself a table like this:</p>\n\n<pre><code>Amount    Time Zone \n300    \u2026\n200    \u2026\n100    AST\n0    EST\n-100    CST\n-200    MST\n-300    PST\n</code></pre>\n\n<p>The <code>VlookUp</code> will return the value of column 1 when it finds the value \"CST\" or whatever zone you tell it to look up. Change the order of the values in this \"Master Table\" around depending on where you are starting from.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 29, "user_id": 6741727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62d951d6a271f47de74650c255514b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Maya Cat", "link": "https://stackoverflow.com/users/6741727/maya-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 39134653, "answer_count": 2, "score": 0, "last_activity_date": 1472083058, "creation_date": 1472078986, "question_id": 39134156, "link": "https://stackoverflow.com/questions/39134156/excel-time-zone-conversion", "title": "Excel Time Zone Conversion", "body": "<p>I have a whole bunch of data that's in military time format\ni.e.</p>\n\n<p>2300<br>\n800<br>\netc.</p>\n\n<p>Some of it is in CST and the other US time zones, except EST but I need to make everything into the EST format in excel, and the time zone info (CST etc) is in a separate column. And the data needs to remain in its current format. (like not turning it in 8:00pm etc)<br>\nAny help with which formula and how to format it would be much appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 4, "last_activity_date": 1472079254, "creation_date": 1472079254, "answer_id": 39134205, "question_id": 39134114, "link": "https://stackoverflow.com/questions/39134114/search-and-replace-multiple-words/39134205#39134205", "title": "Search and Replace Multiple Words", "body": "<pre><code>Sub change_words(ByVal findWord, byVal replaceWord)\n\n   With Selection.Find\n        .Text = findWord\n        .Replacement.Text = replaceWord\n        .Forward = True\n        .Wrap = wdFindContinue\n        .MatchWholeWord = True\n   End With\n   Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub \n</code></pre>\n\n<p>If you change your function to accept parameters as shown, you can call it in a loop, and (for example) pass in the values you want like so:</p>\n\n<pre><code>Dim myDict : Set myDict = CreateObject(\"Scripting.Dictionary\")\nmyDict(\"optimize\") = \"optimise\"\nmyDict(\"utilized\") = \"utilised\"\nFor myLoop = 0 to myDict.Count - 1\n    change_words myDict.Keys()(myLoop), myDict.Items()(myLoop)\nNext\n</code></pre>\n\n<p>That should allow you to reuse the code without repeating it.</p>\n"}], "owner": {"reputation": 21, "user_id": 5544332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca08daa2a68639e54c281bb86b7ab72?s=128&d=identicon&r=PG&f=1", "display_name": "tonys", "link": "https://stackoverflow.com/users/5544332/tonys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3382, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472079254, "creation_date": 1472078694, "last_edit_date": 1472079079, "question_id": 39134114, "link": "https://stackoverflow.com/questions/39134114/search-and-replace-multiple-words", "title": "Search and Replace Multiple Words", "body": "<p>I already have the code to do a search and replace in Microsoft Word using a VBA macro, but at the moment, my code is copying and pasting the same function multiple times. </p>\n\n<p>What I would like to do is have an dictionary of words that need to be replaced, so for example:</p>\n\n<p>old_word: new_word</p>\n\n<p>Then I have the VBA script to loop through and make the necessary changes in the document. </p>\n\n<p>My code for now is and repeats for each new word pair. </p>\n\n<pre><code>Sub change_words()\n\n   With Selection.Find\n        .Text = \"optimize\"\n        .Replacement.Text = \"optimise\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .MatchWholeWord = True\n   End With\n\n   Selection.Find.Execute Replace:=wdReplaceAll\n\n   With Selection.Find\n        .Text = \"utilized\"\n        .Replacement.Text = \"utilised\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .MatchWholeWord = True\n   End With\n\n   Selection.Find.Execute Replace:=wdReplaceAll\n\nEnd Sub \n</code></pre>\n\n<p>Many thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472075825, "post_id": 39133594, "comment_id": 65612667, "body": "Looks like you&#39;re mixing your strings and variables. VBA methods won&#39;t magically execute in the middle of strings - you need to execute them separately and concatenate back in. There&#39;s also no &quot;and&quot; like that in Excel - you either mean for it to be executed in VBA, or you need to use it like a function <code>And(condition1, condition2)</code>"}, {"owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472076022, "post_id": 39133594, "comment_id": 65612739, "body": "Thanks. I didn&#39;t remember the and() function correctly. I just cannot find out how to correctly concatenate strings and variables."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472076083, "post_id": 39133594, "comment_id": 65612755, "body": "In columns(i) is <code>i</code> a variable or are you want column I"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1472076924, "post_id": 39133594, "comment_id": 65613013, "body": "Work on getting the formula correct in the sheet first: when that&#39;s working edit your question to include it so we can see what you&#39;re trying to achieve."}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "edited": false, "score": 0, "creation_date": 1472142213, "post_id": 39133861, "comment_id": 65643999, "body": "It works perfectly! Thanks. As you point our, it is a bit too slow. I&#39;m wondering what you mean by &quot;change all the full column references to the extents of the dataset&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "edited": false, "score": 0, "creation_date": 1472142384, "post_id": 39133861, "comment_id": 65644119, "body": "See @ThomasInzina answer.  He shows one method.  You need to find the extents of the data in columns A and the Column that is referenced by the variable i and set it to that.  like A2:A100 and so forth.  Or at least set the range to range just large enough to ensure a capture of all the data like A2:A1000."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1472077637, "last_edit_date": 1472077637, "creation_date": 1472077140, "answer_id": 39133861, "question_id": 39133594, "link": "https://stackoverflow.com/questions/39133594/cross-worksheet-formulas-in-evaluate-in-vba/39133861#39133861", "title": "Cross-worksheet formulas in evaluate() in VBA", "body": "<p>You need to remove the vba parts from the string and concatenated with <code>&amp;</code>.</p>\n\n<p>And array formulas do not work well with And instead use the * to compare the two boolean values.</p>\n\n<pre><code>Worksheets(\"Result\").Cells(r,4)=Worksheets(\"Result\").Evaluate(\"=STDEV(IF((Data!A:A&gt;=Result!\" &amp; Cells(r,1).Address &amp; \")*(Data!A:A&lt;Result!\" &amp; Cells(r,2).Address &amp; \"),Data!\" &amp; columns(i).Address &amp; \"))\")\n</code></pre>\n\n<p><strong><em>WARNING:</em></strong>  You are using full column references in an Array formula.  If you have too many loops this will be slow.  It is better to change all the full column references to the extents of the dataset.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472129143, "post_id": 39137073, "comment_id": 65635224, "body": "@ScottCraner I made DataA a string and assigned it the range&#39;s address; so that I  could shorten the concatenation: <code>Intersect(.Columns(&quot;A&quot;), .UsedRange).Address</code>.   I think that I got it right.  Can you can double check the sample output string that I provided?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472130234, "post_id": 39137073, "comment_id": 65636004, "body": "Sorry missed that, I was on my phone."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472130572, "post_id": 39137073, "comment_id": 65636244, "body": "@ScottCraner no worries.  It was a little sneaky."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1472101695, "creation_date": 1472101695, "answer_id": 39137073, "question_id": 39133594, "link": "https://stackoverflow.com/questions/39133594/cross-worksheet-formulas-in-evaluate-in-vba/39137073#39137073", "title": "Cross-worksheet formulas in evaluate() in VBA", "body": "<p>Taking Scott Craner's advice, I use Intersect to trim the column ranges down to fit the actual data. </p>\n\n<p>Here is the sample output where <code>r = 10: i = 5</code> and <code>Worksheets(\"Data\")</code> has 19 rows of data:</p>\n\n<p><code>=STDEV(IF((Data!$A$1:$A$19&gt;=Result!$A$10)*Data!$A$1:$A$19&lt;Result!$B$10),Data!@$E$1:$E$19))</code></p>\n\n<p>Declare the new variables:</p>\n\n<pre><code>Dim DataA As String, DataI As String, sFormula As String\n</code></pre>\n\n<p>The code to insert into the <code>i</code> and <code>r</code> loops:</p>\n\n<pre><code>With Worksheets(\"Data\")\n    DataA = Intersect(.Columns(\"A\"), .UsedRange).Address\n    DataI = Intersect(.Columns(i), .UsedRange).Address\n    sFormula = \"=STDEV(IF((Data!\" &amp; DataA &amp; \"&gt;=Result!$A$\" &amp; r &amp; \")*(Data!\" &amp; DataA &amp; \"&lt;Result!$B$\" &amp; r &amp; \"),Data!@\" &amp; DataI &amp; \"))\"\nEnd With\n\nWith Worksheets(\"Result\")\n    .Cells(r, 4) = .Evaluate(sFormula)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 39133861, "answer_count": 2, "score": 0, "last_activity_date": 1472101695, "creation_date": 1472075523, "question_id": 39133594, "link": "https://stackoverflow.com/questions/39133594/cross-worksheet-formulas-in-evaluate-in-vba", "title": "Cross-worksheet formulas in evaluate() in VBA", "body": "<p>I want to calculate conditional max of the ith column in a sheet called \"Data\" when the corresponding value in column A of sheet \"Data\" falls in a range from another sheet \"Result\". I tried to use the code below but it's wrong:</p>\n\n<pre><code>Worksheets(\"Result\").Cells(r , 4)=Evaluate(\"=STDEV(IF(Data!A:A&gt;=Result!range(r,1) and Data!A:A&lt;Result!range(r,2),Data!columns(i)))\")\n</code></pre>\n\n<p>What's the correct way to write the formula?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472074545, "post_id": 39133272, "comment_id": 65612165, "body": "If you are, then take a look at our VBA docs - reading a file (<a href=\"http://stackoverflow.com/documentation/vba/990/scripting-filesystemobject/3221/reading-a-text-file-using-a-filesystemobject#t=201608242132490774474\">stackoverflow.com/documentation/vba/990/&hellip;</a>) and writing a file (<a href=\"http://stackoverflow.com/documentation/vba/990/scripting-filesystemobject/3223/writing-to-an-existing-file-with-filesystemobject#t=201608242132490774474\">stackoverflow.com/documentation/vba/990/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1472075842, "creation_date": 1472075842, "answer_id": 39133657, "question_id": 39133272, "link": "https://stackoverflow.com/questions/39133272/vba-edit-3rd-line-of-a-text-file/39133657#39133657", "title": "VBA Edit 3rd line of a Text File", "body": "<p>Your pseudocode is pretty much what you need to do.  I'd personally split on a newline and write individual lines back:</p>\n\n<pre><code>Private Sub KillLineThree(filepath As String)\n    With CreateObject(\"Scripting.FileSystemObject\")\n        Dim lines() As String\n        With .OpenTextFile(filepath)\n            lines = Split(.ReadAll, vbCrLf)\n            .Close\n        End With\n\n        Dim i As Long\n        With .CreateTextFile(filepath)\n            For i = LBound(lines) To UBound(lines)\n                If i &lt;&gt; 2 Then .WriteLine lines(i)\n            Next\n            .Close\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "edited": false, "score": 0, "creation_date": 1472140160, "post_id": 39133787, "comment_id": 65642701, "body": "Creative solution! I like it!"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1472076658, "creation_date": 1472076658, "answer_id": 39133787, "question_id": 39133272, "link": "https://stackoverflow.com/questions/39133272/vba-edit-3rd-line-of-a-text-file/39133787#39133787", "title": "VBA Edit 3rd line of a Text File", "body": "<p>as a shorter a bit overkill version you can use Excel</p>\n\n<pre><code>Workbooks.Open \"c:\\temp\\temp.txt\"\nRows(3).Delete\nDisplayAlerts = False\nActiveWorkbook.Close True\nDisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 1, "accepted_answer_id": 39133657, "answer_count": 2, "score": 0, "last_activity_date": 1472076658, "creation_date": 1472073944, "question_id": 39133272, "link": "https://stackoverflow.com/questions/39133272/vba-edit-3rd-line-of-a-text-file", "title": "VBA Edit 3rd line of a Text File", "body": "<p>I currently have a text file (c:\\temp\\temp.txt) and I want to be able to use VBA to edit the file and and wipe out the 3rd row of string data (it's variable so I don't know what it will say) but keep the rest of the rows of text intact.</p>\n\n<p>I've been trying to figure it out, it seems like I have to open the file, save the entire file as a string, then close and reopen the file and edit the string and save?</p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1472072776, "post_id": 39132792, "comment_id": 65611337, "body": "It&#39;s relatively straightforward to expand the loop you have and open each workbook found. The decisions you have to make are a) where are the column headers in that workbook - only one sheet, multiple sheets, all sheets?; b) what row are the headers located on each of these sheets - row 1 or other rows? It&#39;s certainly possible... search around for these ideas and put together some code, then come back and ask some questions about what you&#39;ve done."}, {"owner": {"reputation": 395, "user_id": 2711474, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d47bbc300d59f549a3e680869a6616b?s=128&d=identicon&r=PG", "display_name": "TesseractE", "link": "https://stackoverflow.com/users/2711474/tesseracte"}, "edited": false, "score": 0, "creation_date": 1472072816, "post_id": 39132792, "comment_id": 65611363, "body": "It kinda sounds like you might be better off turning this into an Access DB.  This isn&#39;t the type of thing Excel&#39;s really built for.  That said, finding out why you have to go through all that to retrieve those specific headers might help us you find a better solution.  For example: If the columns are not the same from file to file, is there a pattern that could be found from the folder location?  Can the columns be standardized and left blank in some files?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472073344, "post_id": 39132792, "comment_id": 65611604, "body": "With Excel 2010 or above you can use <code>Power Query</code> to query the column headers of excel files in folders without opening them"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472077640, "post_id": 39132792, "comment_id": 65613245, "body": "@slai - You can do the same thing in any version of Excel via ADO: <code>Recordset.Fields(foo).Name</code>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472083454, "post_id": 39132792, "comment_id": 65614777, "body": "@Comintern You&#39;ll get only the field names if you issue a <code>Select</code>. And what is the <code>Select</code> you want to use? Maybe something like <code>Select * From [SheetWhichHopefullyExists$]</code> ? And what about any other sheet in the Excel file? I am unaware of any <code>Select</code> which allows you to inquire about all the <i>tables</i> or <i>sheets</i> in an Excel file (something like <code>sys.tables</code> on SQL Server). But I&#39;d be happy to learn that I am mistaken."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472086607, "post_id": 39132792, "comment_id": 65615439, "body": "@Ralph - If you don&#39;t know the sheet names, you can get them with <code>ADODB.Connection.OpenSchema</code> (column names too)."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1472158247, "post_id": 39132792, "comment_id": 65652518, "body": "@Comintern I definitely learned something new and very useful today. Thanks for posting a complete answer with code. I&#39;ll certainly bookmark this one! <i>(+1)</i> from my side! Awesome stuff."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 6, "last_activity_date": 1472088505, "creation_date": 1472088505, "answer_id": 39135358, "question_id": 39132792, "link": "https://stackoverflow.com/questions/39132792/using-vba-to-retrieve-column-headers-from-excel-files/39135358#39135358", "title": "Using VBA to retrieve Column Headers from Excel files", "body": "<p>You can query them with ADO (adjust the connection string as needed):</p>\n\n<pre><code>'Requires reference to Microsoft ActiveX Data Objects #.# Library\nPrivate Function GetHeaders(filepath As String) As String()\n    Dim output() As String\n    Dim ado As New ADODB.Connection\n    output = Split(vbNullString)\n\n    With ado\n        .Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; filepath &amp; \"';\" &amp; _\n              \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;IMEX=1;\"\";\"\n        With .OpenSchema(adSchemaTables)\n            Dim table As String\n            Dim columns As ADODB.Recordset\n            Do While Not .EOF\n                table = .Fields(\"TABLE_NAME\")\n                Set columns = ado.OpenSchema(adSchemaColumns, Array(Empty, Empty, table))\n                With columns\n                    Do While Not .EOF\n                        ReDim Preserve output(UBound(output) + 1)\n                        output(UBound(output)) = table &amp; .Fields(\"COLUMN_NAME\")\n                        .MoveNext\n                    Loop\n                End With\n                .MoveNext\n            Loop\n        End With\n    End With\n    GetHeaders = output\nEnd Function\n</code></pre>\n\n<p>Then call it like this for each file that you find:</p>\n\n<pre><code>Sub Example()\n    Dim headers() As String\n    Dim i As Long\n    headers = GetHeaders(\"C:\\Foo\\Bar.xlsx\")\n    For i = LBound(headers) To UBound(headers)\n        Debug.Print headers(i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note that this assumes you don't know the sheet names and need to get headers for <strong><em>all</em></strong> of them.  The strings in the output array will be in the form of <code>Sheet$Field</code>, but that can be adjusted according to need.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8097723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zAfqvrwkt-s/AAAAAAAAAAI/AAAAAAAADS8/ggsyyeAuTv8/photo.jpg?sz=128", "display_name": "Dinesh  ", "link": "https://stackoverflow.com/users/8097723/dinesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1606500605, "creation_date": 1606500605, "answer_id": 65041982, "question_id": 39132792, "link": "https://stackoverflow.com/questions/39132792/using-vba-to-retrieve-column-headers-from-excel-files/65041982#65041982", "title": "Using VBA to retrieve Column Headers from Excel files", "body": "<p>Cell in col header is limited to 255 chars only due to limitation in ADODB.</p>\n"}], "owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3565, "favorite_count": 3, "accepted_answer_id": 39135358, "answer_count": 2, "score": 1, "last_activity_date": 1606500605, "creation_date": 1472071742, "last_edit_date": 1472071772, "question_id": 39132792, "link": "https://stackoverflow.com/questions/39132792/using-vba-to-retrieve-column-headers-from-excel-files", "title": "Using VBA to retrieve Column Headers from Excel files", "body": "<p>I'm working with someone who has  to identify certain variables within excel files. Currently, the man I'm working with has a great deal of folders and sub-folders that have Excel documents in them. He's using a VBA code that looks within a folder for a sub-folder, and then returns the pathway, then creating a hyperlink to the sub-folder (this isn't part of the VBA code below) and looking at all excel files within, no matter the level of sub-folders within the main folder.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>    Sub GetFolders()\nDim path As String\nDim folder As String\nDim row As Integer\n\n\npath = \"your directory here\"\nfolder = Dir(path, vbDirectory)\nrow = 1\n\nDo While folder &lt;&gt; \"\"\nIf (GetAttr(path &amp; folder) And vbDirectory) = vbDirectory Then\n    Cells(row, 1) = path &amp; folder\n    row = row + 1\nEnd If\nfolder = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>This is great, but I know there has to be a better way. How can I manipulate this code to return COLUMN HEADERS of any excel files found A) within a folder or B) within a subfolder contained within a folder. I want these to be returned to an excel spreadsheet so that 100's of excel documents don't need to be opened, but rather just this one, and then we can identify any excel spreadsheets that need further investigation and ignore the rest.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472073777, "post_id": 39132929, "comment_id": 65611802, "body": "It helps.. Thanks a ton"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472074532, "post_id": 39132929, "comment_id": 65612162, "body": "@skroutela please mark as correct by clicking on the check mark by the answer.  It is something only you can do."}, {"owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472074633, "post_id": 39132929, "comment_id": 65612191, "body": "I have a data of 20000 users, Array formula is taking too much time to output the result and also slowing down the excel... Is there any other solution?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472074909, "post_id": 39132929, "comment_id": 65612289, "body": "only other option is vba @skroutela"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472074994, "post_id": 39132929, "comment_id": 65612320, "body": "Or you can sort your data on the Login Count and use a normal formula then copy and paste the values back.  The sort it back the way you want."}, {"owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472646636, "post_id": 39132929, "comment_id": 65835085, "body": "Thanks for valuable answers Scott"}, {"owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "edited": false, "score": 0, "creation_date": 1472646786, "post_id": 39132929, "comment_id": 65835205, "body": "Again i have a small concern that i have four filed in sheet, 1. unique id, 2. Name, 3. submission 4. Rank and data under these columns are called through formula also have the drop down option in filed so that if I change the value in drop down then data of all four column gets changed.. also filter is not working here... do you have any solution for this... plz share"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1472072378, "creation_date": 1472072378, "answer_id": 39132929, "question_id": 39132642, "link": "https://stackoverflow.com/questions/39132642/ranking-formula/39132929#39132929", "title": "Ranking Formula", "body": "<p>This array formula will rank them in order without skipping numbers</p>\n\n<pre><code>=SUM(IF(B2&lt;$B$2:$B$10,1/COUNTIF($B$2:$B$10,$B$2:$B$10)))+1\n</code></pre>\n\n<p>Being an Array formula it needs to be confirmed with Ctrl-Shift-Enter when exiting edit mode instead of Enter.  If done correctly then Excel will put <code>{}</code> around the formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AK7Y9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AK7Y9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 39132929, "answer_count": 1, "score": 0, "last_activity_date": 1472072378, "creation_date": 1472071054, "last_edit_date": 1531161705, "question_id": 39132642, "link": "https://stackoverflow.com/questions/39132642/ranking-formula", "title": "Ranking Formula", "body": "<p><a href=\"https://i.stack.imgur.com/JXVL8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JXVL8.png\" alt=\"CLICK HERE TO SEE IMAGE\"></a></p>\n\n<p>I want to do a user ranking basis on logged In count, higher is best.</p>\n\n<p>I used rank formula for this. I got the ranking but if more than one user has same logged In count then same raking no.reflecting. Which is ok. </p>\n\n<p>I want like this only but Next rank is not in continuation. </p>\n\n<p>I want formula for this..e.g. in image 3 users are in 1 rank but next rank started at 4. It should show 2 next. </p>\n\n<p>Kindly provide the resolution for this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472069750, "post_id": 39132126, "comment_id": 65609913, "body": "The first call to <code>AverageIfs</code> is malformed, while the second is not. <code>AverageIfs</code> expects a range to average, then a range to check, then a criteria for that check, then a range, then a criteria... etc. The first time you try it, you go (Range, Criteria, Range, Criteria, Range) instead of (Range, Range, Criteria, Range, Criteria)."}, {"owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472069978, "post_id": 39132126, "comment_id": 65610021, "body": "Sorry for the typo. I just corrected it. When corrected there is also the error message."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472070817, "post_id": 39132126, "comment_id": 65610425, "body": "Still has the same issue in the first call. Not sure what&#39;s going wrong with the third call."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1472071028, "post_id": 39132126, "comment_id": 65610543, "body": "Third one works fine for me"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472071193, "post_id": 39132126, "comment_id": 65610626, "body": "...as does the (corrected) first one"}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472071217, "post_id": 39132126, "comment_id": 65610640, "body": "Works for me too, Tim. @CofeinnieBonda Are you positive the third call is giving the <i>exact same</i> error? <code>AverageIfs</code> can give errors when no items match your criteria, and it will even be the same error number (1004)."}, {"owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "edited": false, "score": 0, "creation_date": 1472071759, "post_id": 39132126, "comment_id": 65610867, "body": "Thanks for both of your help. I think I find where the error happens. That&#39;s because there is no value within the range given."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472072700, "post_id": 39132126, "comment_id": 65611301, "body": "@CofeinnieBonda regarding your edit: the function doesn&#39;t <i>return</i> an error, it <i>raises</i> an error. So <code>IfError</code> won&#39;t work. Consider either validating the data/criteria before calling <code>AverageIfs</code>, or adding an Error Handler (<a href=\"http://stackoverflow.com/documentation/vba/3211/error-handling#t=201608242103393690837\">stackoverflow.com/documentation/vba/3211/&hellip;</a>) to properly deal with the error when it comes up."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1472081191, "post_id": 39132126, "comment_id": 65614228, "body": "if you drop the <code>WorksheetFunction</code> and just use <code>Application.AverageIfs()</code> then you can check the return value for an error without raising a run-time error."}, {"owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472138622, "post_id": 39132126, "comment_id": 65641728, "body": "@Tim Williams Thanks. This is very helpful."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1472071815, "creation_date": 1472071815, "answer_id": 39132810, "question_id": 39132126, "link": "https://stackoverflow.com/questions/39132126/error-using-averageifs-in-vba/39132810#39132810", "title": "Error using averageifs in VBA", "body": "<p>The error comes up when </p>\n\n<ul>\n<li>there is no data in any one of the referenced ranges</li>\n<li>none of the data in column B matches the criteria</li>\n</ul>\n"}], "owner": {"reputation": 279, "user_id": 6535843, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/123618b58d141fcb4995ac51e6d08f4e?s=128&d=identicon&r=PG&f=1", "display_name": "Cofeinnie Bonda", "link": "https://stackoverflow.com/users/6535843/cofeinnie-bonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 685, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472072498, "creation_date": 1472068969, "last_edit_date": 1472072498, "question_id": 39132126, "link": "https://stackoverflow.com/questions/39132126/error-using-averageifs-in-vba", "title": "Error using averageifs in VBA", "body": "<p>My VBA code is like this:</p>\n\n<pre><code>Sheets(\"Result\").Range(\"E\" &amp; i) = Application.WorksheetFunction.AverageIfs( _\n        Sheets(\"Data\").Range(\"B:B\"), _\n        Sheets(\"Data\").Range(\"B:B\"), _\n        \"&gt;=\" &amp; Sheets(\"Result\").Range(\"A\" &amp; i), _\n        Sheets(\"Data\").Range(\"B:B\"), _\n        \"&lt;\" &amp; Sheets(\"Result\").Range(\"B\" &amp; i), _\n        Sheets(\"Data\").Range(\"B:B\"))\n</code></pre>\n\n<p>However, an error message showed \"Unable to get the averageif property of the worksheetfunction class\".</p>\n\n<p>When I change the critiria value to be a constant, however, it can run correctly:</p>\n\n<pre><code>Sheets(\"Result\").Range(\"E\" &amp; i) = Application.WorksheetFunction.AverageIfs( _\n         Sheets(\"data\").Range(\"b:b\"), _\n         Sheets(\"data\").Range(\"b:b\"), _\n         \"&gt;=\" &amp; 0.06, _\n         Sheets(\"data\").Range(\"b:b\"), _\n         \"&lt;\" &amp; 0.07)\n</code></pre>\n\n<p>What's the problem here? And how can I correct it?</p>\n\n<p>-I found the problem was that there is no value within the specified range. But when I tried to debug using the iferror(\uff09 function, it still shows the same error message.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472067689, "post_id": 39131771, "comment_id": 65608890, "body": "look into <code>Range.FormulaR1C1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1472070500, "creation_date": 1472070500, "answer_id": 39132501, "question_id": 39131771, "link": "https://stackoverflow.com/questions/39131771/excel-formula-to-vba-code-conversion/39132501#39132501", "title": "Excel Formula to VBA code Conversion", "body": "<p>You can use</p>\n\n<pre><code>Range(\"RangeToCopyFormulaTo\").Formula = Range(\"CellToCopyFormulaFrom\").Formula\n</code></pre>\n\n<p>Excel will take care of updating the cell references, same as when you copy/paste</p>\n"}], "owner": {"reputation": 1, "user_id": 6754163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045420cbddbf1e9a93719ad7b609aa49?s=128&d=identicon&r=PG&f=1", "display_name": "Jill", "link": "https://stackoverflow.com/users/6754163/jill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472070500, "creation_date": 1472067569, "last_edit_date": 1472069282, "question_id": 39131771, "link": "https://stackoverflow.com/questions/39131771/excel-formula-to-vba-code-conversion", "title": "Excel Formula to VBA code Conversion", "body": "<p>I am trying to create a macro that allows me to scan columns and rows of data and insert a formula into the blank cells.  I am able to complete this task with the following excel formula:</p>\n\n<pre><code>=IF(ISBLANK(W4),((IFERROR(DATEDIF(MAX($P4,DATE(2016,5,1)),MIN($Q4,DATE(2016,8,1)),\"d\"),0)/(DATEDIF(P4,Q4,\"d\")))*$T4),W4)\n</code></pre>\n\n<p>My question is, is there a way I can put this into vba code so that I can run a macro that will automatically apply this formula in a column of my excel sheet across 30 rows? Therefore, the next row would read:</p>\n\n<pre><code>=IF(ISBLANK(W5),((IFERROR(DATEDIF(MAX($P5,DATE(2016,5,1)),MIN($Q5,DATE(2016,8,1)),\"d\"),0)/(DATEDIF(P5,Q5,\"d\")))*$T5),W5)\n</code></pre>\n\n<p>Thanks in advance for the help!</p>\n"}, {"tags": [".net", "excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472068304, "post_id": 39131270, "comment_id": 65609204, "body": "Can&#39;t you just set the hyperlink to point to the cell you want to link to?  E.g. in VBA the code might look like `    Worksheets(&quot;Sheet1&quot;).Hyperlinks.Add Anchor:=Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;), Address:=&quot;&quot;, SubAddress:=&quot;Sheet2!H1&quot;, TextToDisplay:=&quot;Follow this link&quot; `.  It should be something similar in .Net."}, {"owner": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472068391, "post_id": 39131270, "comment_id": 65609238, "body": "Of course we can set the hyperlink to the cell we want to link to.  But the problem is, that cell ends up in the lower left corner of the window. We want it in the upper left corner."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472068633, "post_id": 39131270, "comment_id": 65609375, "body": "Ahh - so it is nothing to do with the hyperlink - your question is &quot;how can I display a sheet such that cell x is in the top left corner&quot;.  (I was reading it as the hyperlink was taking you to a cell at the bottom left corner of the sheet.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472071356, "post_id": 39131270, "comment_id": 65610690, "body": "<code>with the position of the cell in the lower left corner</code> - I have tried all sorts of things and can&#39;t replicate this behaviour in a general situation.  The GoTo will force the cell to the top-left corner, so I assume you were experiencing it before adding the GoTo.  But the only way I can end up with the cell in the lower-left is if it was already in that exact position when the hyperlink was clicked.  Weird."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472070037, "post_id": 39132334, "comment_id": 65610037, "body": "I&#39;m not sure why your question says that the cell was opening in the bottom-left corner.  Mine was always opening in the top-left corner.  I might have a play and see if I can replicate how you are getting your behaviour - it might require another tweak to the code."}, {"owner": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "edited": false, "score": 0, "creation_date": 1472072800, "post_id": 39132334, "comment_id": 65611351, "body": "Thank you for the code!  However, my real question is... WHAT DO I DO WITH THIS CODE??  I have no idea where it goes inside Excel.  As I said in the OP,  I am really hoping for idiot proof steps on where to put this code, and how to save it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "edited": false, "score": 0, "creation_date": 1472073145, "post_id": 39132334, "comment_id": 65611509, "body": "Open your template file, go to the Macro editor (different method on different versions of Excel, but try Alt-F11), in the Project window on the left-hand-side double-click the sheet that contains the hyperlinks, paste the code into the main &quot;code&quot; window (possibly empty at the moment?), close the macro editor, save the template file."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "edited": false, "score": 0, "creation_date": 1472073471, "post_id": 39132334, "comment_id": 65611653, "body": "Here&#39;s the link to the SO documentation on how to open the VBE - <a href=\"http://stackoverflow.com/documentation/excel-vba/777/introduction-to-excel-vba/2801/opening-the-visual-basic-editor#t=201608242116238997309\">stackoverflow.com/documentation/excel-vba/777/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "edited": false, "score": 0, "creation_date": 1472075745, "post_id": 39132334, "comment_id": 65612637, "body": "@CaseyCrookston - sorry, the second link showed how to add code to a non-worksheet code module.  (I&#39;ve deleted that comment now.)  You will need to follow the instruction in my earlier comment instead (<code>in the Project window on the left-hand-side double-click the sheet that contains the hyperlinks, paste the code into the main &quot;code&quot; window (possibly empty at the moment?</code>)."}, {"owner": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "edited": false, "score": 0, "creation_date": 1472130877, "post_id": 39132334, "comment_id": 65636472, "body": "thanks!  I will give this a try today and report back."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1472071497, "last_edit_date": 1472071497, "creation_date": 1472069734, "answer_id": 39132334, "question_id": 39131270, "link": "https://stackoverflow.com/questions/39131270/link-to-excel-worksheet-with-linked-cell-in-upper-left/39132334#39132334", "title": "Link to Excel Worksheet with Linked Cell in Upper Left", "body": "<p>The following code will first go to the cell which is one column to the right of the target, placing it in the top left corner.  It then shifts the window one page to the left, and then selects the original target again without scrolling.</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    Application.Goto ActiveCell.Offset(0, 1), True\n    ActiveWindow.LargeScroll ToLeft:=1\n    Application.Goto ActiveCell.Offset(0, -1), False\nEnd Sub\n</code></pre>\n\n<p>I'm not sure what will happen if your target is, for instance, cell B100 - the window shift to the left may or may not work.</p>\n\n<p>P.S.  This code should be placed into the code module for the worksheet containing the hyperlinks.</p>\n"}], "owner": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472071497, "creation_date": 1472065720, "last_edit_date": 1531161705, "question_id": 39131270, "link": "https://stackoverflow.com/questions/39131270/link-to-excel-worksheet-with-linked-cell-in-upper-left", "title": "Link to Excel Worksheet with Linked Cell in Upper Left", "body": "<p>I am generating an Excell spreadsheet in a .NET application.  The file has two sheets.  The first is a cover sheet with deep links into the data, which is in the second sheet. When a link is clicked, the second sheet opens to that cell, with the position of the cell in the lower left corner.  I need it to open with the cell in the upper right corner.</p>\n\n<p>I'm pretty sure there is no way to make this happen in the .NET code that is generating the file.  (But if I'm wrong, please tell me.)  However, I did find some other discussions about this, and the solution seems to be to add a little but of VB code to the Excel file itself.  Meaning, to the template file that is used to seed the data and produce the final file.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    Application.Goto ActiveCell, True\nEnd Sub\n</code></pre>\n\n<p>Thing is, I really don't know what to do with this code.  I could benefit from some step-by-step instructions... like, assume I'm a total and complete idiot newbie when it comes to Excel (which actually, I am.)</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1472065345, "post_id": 39131092, "comment_id": 65607690, "body": "Are you using an older version of excel?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1472065440, "post_id": 39131092, "comment_id": 65607729, "body": "I&#39;m using 2013. It had been working but all of a sudden today its throwing an error on this line."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1472065493, "post_id": 39131092, "comment_id": 65607758, "body": "What cells and worksheet make up the <code>rng</code> object?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1472065537, "post_id": 39131092, "comment_id": 65607782, "body": "And what is <code>iEnd</code>? Maybe it would help to see more of your code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472065615, "post_id": 39131092, "comment_id": 65607820, "body": "Does some of the data over which you are iterating have errors?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1472065842, "post_id": 39131092, "comment_id": 65607924, "body": "The data does not have errors and ive uploaded the function that has the issue"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1472065939, "post_id": 39131092, "comment_id": 65607966, "body": "<code>iEnd</code> doesn&#39;t have an initial value."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1472067358, "post_id": 39131092, "comment_id": 65608726, "body": "As @MattCremeens stated iEnd must be assigned a starting value of 1 <code>iEnd = 1</code> before the loop."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1472068574, "post_id": 39131092, "comment_id": 65609343, "body": "Does rng contain a formula instead of a constant value?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1472070920, "post_id": 39131092, "comment_id": 65610490, "body": "I added the full code and when I try iEnd having an initial value it crashes"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472093619, "post_id": 39131092, "comment_id": 65616863, "body": "I can&#39;t replicate with test data.  What&#39;s in ItalicSourceSheet!C1:C5?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1472236771, "post_id": 39131092, "comment_id": 65687752, "body": "randomly started working again thanks for the responses"}], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1472114604, "creation_date": 1472114604, "answer_id": 39140570, "question_id": 39131092, "link": "https://stackoverflow.com/questions/39131092/unable-to-get-the-characters-run-time-error-vba/39140570#39140570", "title": "Unable to get the characters run time error vba", "body": "<p>I guess that ItalicSourceSheet!C1:C5 contains formulas (calculated values) and the Characters property is not available therefore. In this case you should check if the whole cell is italic (parts of it cannot be) or skip these cells (depending on the business logic).</p>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472114604, "creation_date": 1472065101, "last_edit_date": 1531164843, "question_id": 39131092, "link": "https://stackoverflow.com/questions/39131092/unable-to-get-the-characters-run-time-error-vba", "title": "Unable to get the characters run time error vba", "body": "<p>This code had been working but I'm unsure why vba can't seem to get past this line anymore. I get the Run-time error '1004': Unable to get the characters property of the Range class. Any help is appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub proj()\n    Dim dataRng As range, cl As range\n    Dim arr As Variant\n\n    Set dataRng = Worksheets(\"ItalicSourceSheet\").range(\"C1:C5\") '&lt;--| change \"ItalicSourceSheet\" with your actual source sheet name\n    With Worksheets(\"ItalicOutputSheet\") '&lt;--|change \"ItalicOutputSheet\" with your actual output sheet name\n        For Each cl In dataRng\n            arr = GetItalics(cl) '&lt;--| get array with italic words\n            If IsArray(arr) Then .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(UBound(arr) + 1) = Application.Transpose(arr) '&lt;--| if array is filled then write it down to output sheet first blank cell in column \"A\"\n        Next\n    End With\nEnd Sub\n\nFunction GetItalics(rng As range) As Variant\n    Dim strng As String\n    Dim iEnd As Long, iIni As Long, strngLen As Long\n\n    strngLen = Len(rng.Value2)\n    iIni = 1\n    Do While iEnd &lt;= strngLen\n        Do While rng.Characters(iEnd, 1).Font.Italic And rng.Characters(iEnd, 1).Font.Underline\n            If iEnd = strngLen Then Exit Do\n            iEnd = iEnd + 1\n        Loop\n        If iEnd &gt; iIni Then strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\n        iEnd = iEnd + 1\n        iIni = iEnd\n    Loop\n    If strng &lt;&gt; \"\" Then GetItalics = Split(Left(strng, Len(strng) - 1), \"|\")\nEnd Function\u200b\n</code></pre>\n"}, {"tags": ["excel", "loops", "userform", "inputbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1472065558, "creation_date": 1472065558, "answer_id": 39131228, "question_id": 39130947, "link": "https://stackoverflow.com/questions/39130947/loop-through-data-query-based-on-values-entered-in-an-inputbox-and-userform/39131228#39131228", "title": "Loop through data query based on values entered in an Inputbox and UserForm", "body": "<pre><code>dim rCell as range\n\nfor each rCell in Environment.Cells\n\n'... code that checks for NextRelease variable\n\nnext rCell\n</code></pre>\n\n<p>Let me know if this helps out at all</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472067120, "post_id": 39131374, "comment_id": 65608605, "body": "I&#39;ve declared NextRelease as a Public variable, although I&#39;m not sure how this helps? However when trying to declare <code>myEnvironment = ComboEnv.Value</code> I keep getting a 424 Object required error."}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472067925, "post_id": 39131374, "comment_id": 65608988, "body": "That&#39;s good to know, thank you! My understanding of VBA is still rather basic and I have never worked on UserForms before hence the challenge. I am placing myEnvironment after <code>frmEnv.show</code> - Please see above which is not in a module."}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472068221, "post_id": 39131374, "comment_id": 65609154, "body": "You won&#39;t be able to access the combobox from there. Do you have a button on your userform for the user to press once they\u2019ve submitted their value(s)? If so, place your <code>myEnvironment = ComboEnv.Value</code> in the code which executes once the button is pressed (double click the button in design mode to locate this sub). Edit: In fact, also declare myEnvironment as a public variable beside your NextRelease declaration."}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472069273, "post_id": 39131374, "comment_id": 65609691, "body": "I&#39;m going about this the wrong way. I&#39;ve edited my answer, let me know if it doesn&#39;t make sense."}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472069295, "post_id": 39131374, "comment_id": 65609707, "body": "I have now added the myEnvironment assignment to the submit button however after <code>Unload frmEnv</code> I have added a <code>msgbox</code> to This Workbook to see whether the variable is being recorded however it&#39;s blank. The 424 error is no longer present."}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472070117, "post_id": 39131374, "comment_id": 65610081, "body": "You will need to declare myEnvironment as a public variable in your workbook code."}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472070501, "post_id": 39131374, "comment_id": 65610257, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/121783/discussion-between-rory-and-paul\">continue this discussion in chat</a>."}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472070844, "post_id": 39131374, "comment_id": 65610440, "body": "Despite adding <code>Public myEnvironment as String</code> i&#39;m still getting a blank field. I have tried adding this to the <code>UserForm</code> and <code>ThisWorkbook</code> I don&#39;t understand how <code>NextRelease</code> works but <code>MyEnvironment</code> doesn&#39;t, sorry to be a pain."}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472071067, "post_id": 39131374, "comment_id": 65610564, "body": "I&#39;m being prompted to &quot;Please avoid extended discussions in comments.&quot; This conversation has been automatically moved to a chat, happy to continue there (see above link)."}], "tags": [], "owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1472069194, "last_edit_date": 1472069194, "creation_date": 1472066076, "answer_id": 39131374, "question_id": 39130947, "link": "https://stackoverflow.com/questions/39130947/loop-through-data-query-based-on-values-entered-in-an-inputbox-and-userform/39131374#39131374", "title": "Loop through data query based on values entered in an Inputbox and UserForm", "body": "<p>Store your 'Environment' as a variable after the combobox value has been selected, using <code>myEnvironment = ComboEnv.Value</code> in your userform code. Declare this as a public variable using <code>Public myEnvironment As String</code> in your workbook code.</p>\n\n<p>Once the userform is closed, the code below your <code>FrmEnv.Show</code> should execute. You'll be able to use the NextRelease and myEnvironment variables from here to loop through your data.</p>\n"}], "owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472069194, "creation_date": 1472064571, "last_edit_date": 1531161705, "question_id": 39130947, "link": "https://stackoverflow.com/questions/39130947/loop-through-data-query-based-on-values-entered-in-an-inputbox-and-userform", "title": "Loop through data query based on values entered in an Inputbox and UserForm", "body": "<p>I'm working on a script which will eventually loop through a data range currently on worksheet \"Data.\" The criteria will be gained through an <code>Inputbox</code> (Date) and a <code>UserForm</code> (Environment) and with these results it will look for the date and environment in the query and paste any matching results to another worksheet (Applications)</p>\n\n<p>This is what I have developed so far:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim NextRelease As Long\nSet trelinfo = Sheets(\"TRELINFO\")\n\nIf MsgBox(\"Would you like to promote the next release in batch?\", vbQuestion _\n+ vbYesNo, \"Promote the next release?\") = vbYes Then\n\nNextRelease = CLng(CDate(InputBox(\"Please enter the date of the next _\nrelease\", \"Next Release\", \"DD/MM/YYYY\")))\n\nWorksheets(\"Active or Review\").Range(\"F4\").Value = NextRelease\n\ncheckblank = WorksheetFunction.CountIf(trelinfo.Range(\"A2:A4\"), _\nNextRelease)\n\nIf checkblank &lt;&gt; 0 Then\n    ReleaseDate = Application.WorksheetFunction.VLookup(NextRelease, _\ntrelinfo.Range(\"A2:A4\"), 1, False)\nEnd If\n\nIf NextRelease = ReleaseDate Then\nElse\nIf MsgBox(\"Not a valid Release Date\", vbCritical + vbOKOnly, \"No Release\") _\n= vbOK Then Exit Sub\nEnd If\n\nIf MsgBox(\"The Daily Release Process will now pull in all iForms equal to _\n\" &amp; (CDate(NextRelease)), vbOKOnly, \"Move\") = vbOK Then\n\nLoad FrmEnv\nFrmEnv.Show\nEnd If\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>My problem is that I have hit a road block, I am a complete novice with <code>InputBox</code> and <code>UserForms</code> and have no idea how I can use these values to loop through a range of data.</p>\n\n<p>The <code>UserForm</code> has a <code>Combobox</code> which currently looks at a defined range</p>\n\n<pre><code>ComboEnv.List = Application.WorksheetFunction.Transpose(ThisWorkbook.Names(\"Environment\").RefersToRange)\n</code></pre>\n\n<p>I do not expect this script to be completed - as great as that would be, instead I would appreciate a tip on how I can use the values entered in the <code>UserForm</code> and <code>InputBox</code>to look through a range of data.\nThank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 6301014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nx0QBGL0WTI/AAAAAAAAAAI/AAAAAAAAAGA/mtSKFZ6euxg/photo.jpg?sz=128", "display_name": "Jerod Johnson", "link": "https://stackoverflow.com/users/6301014/jerod-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1472065751, "creation_date": 1472065751, "answer_id": 39131280, "question_id": 39130786, "link": "https://stackoverflow.com/questions/39130786/pull-items-from-sheet1-and-use-in-sql-query/39131280#39131280", "title": "Pull items from sheet1 and use in sql query", "body": "<p>You should simply need to explicitly state which Sheet you're pulling the <code>RANGE(\"A2\")</code> from:</p>\n\n<pre><code>ITEMNUMBERSLIST = ActiveWorkbook.Sheets(\"Sheet1\").RANGE(\"A2\")\n</code></pre>\n\n<p>For the sake of read-ability, you may want to state the result sheet as well:</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Sheet2\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6753883, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WS4NqJvldDM/AAAAAAAAAAI/AAAAAAAAAXQ/eGfDLEo8drg/photo.jpg?sz=128", "display_name": "Nichole", "link": "https://stackoverflow.com/users/6753883/nichole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472065751, "creation_date": 1472064006, "last_edit_date": 1531164843, "question_id": 39130786, "link": "https://stackoverflow.com/questions/39130786/pull-items-from-sheet1-and-use-in-sql-query", "title": "Pull items from sheet1 and use in sql query", "body": "<p>I am using Excel 2016 VBA and I am trying to use sheet 1 were the manager puts their list of part number they want sales on. and my VBA SQL will pull the information from sheet 1 and put that part number in the query runs the query and displays the results on a new page and goes though the list of part numbers till there is nothing left on the list. Each part number could have 6 results. </p>\n\n<p>I was using this code and it worked fine if everthing was on one page. </p>\n\n<pre><code>enter code here\nITEMNUMBERSLIST = RANGE(\"A2\")\n\nsql =\"SELECT * FROM db WHERE iTEM IN(\" &amp; ITEMNUMBERSLIST &amp; \") \"\n\nSet rstRecordset = New ADODB.Recordset\nrstRecordset.Open _\nSource:=\" \" &amp; sql &amp; \" \", _\n  ActiveConnection:=cnnConnect\n  Range(\"B1\").Select\nFor Each rstRecordsetField In rstRecordset.Fields\nActiveCell.EntireColumn.Insert\nActiveCell.Value = rstRecordsetField.Name\nActiveCell.Offset(0, 1).Select\nNext rstRecordsetField\nRange(\"B2\").Select\nActiveCell.CopyFromRecordset rstRecordset\nActiveCell.Offset(1, 0).Select\n\nDo Until ActiveCell.Row = LR\n\nITEMNUMBERSLIST = RANGE(\"A2\")\n\nsql =\"SELECT * FROM db WHERE item IN(\" &amp; ITEMNUMBERSLIST &amp; \") \"\n\nSet rstRecordset = New ADODB.Recordset\n\nrstRecordset.Open _\nSource:=\" \" &amp; sql &amp; \" \", _\n   ActiveConnection:=cnnConnect\n   ActiveCell.CopyFromRecordset rstRecordset\nActiveCell.Offset(1, 0).Select\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472064734, "post_id": 39130764, "comment_id": 65607371, "body": "maybe you mean <code>If Sheets(&quot;Sheet5&quot;).Range(&quot;B1&quot;) = &quot;Headcount&quot; Then</code> ? are you comparing it to the cell content ? or a variable named <code>Headcount</code> ?"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472064951, "post_id": 39130764, "comment_id": 65607482, "body": "@ShaiRado sorry about that - that was a typo when I changed the value. The quotes are there. Good point, though!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472065024, "post_id": 39130764, "comment_id": 65607522, "body": "Please edit your post with your correct code,"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472065167, "post_id": 39130764, "comment_id": 65607598, "body": "Anyway, your code works nicely on my charts, how is &quot;B1&quot; getting the value from your slicers?"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472067114, "post_id": 39130764, "comment_id": 65608599, "body": "Strange....your charts are changing automatically when you change slicers? &quot;B1&quot; is a filter cell on a pivot table that is connected to my slicer."}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 528, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1472065170, "creation_date": 1472063951, "last_edit_date": 1472065170, "question_id": 39130764, "link": "https://stackoverflow.com/questions/39130764/excel-bring-chart-to-front-based-on-cell-value", "title": "Excel: Bring Chart to Front Based on Cell Value", "body": "<p>I've created a dashboard of sorts for displaying financial data for a customer. The issue is this: one of the charts is a total by year chart like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/noXhW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/noXhW.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, that's not always appropriate for all slicers. For example, if I had a personnel count slicer, a cumulative total graph would be useless, but an average personnel count graph would be valuable. I am trying to figure out how to have the appropriate chart display depending on a cell value (which is dictated by the slicers). For example, if the personnel count slicer is selected, then bring the average chart to the front. Else, bring the total chart to the front.</p>\n\n<p>I've tried placing the below in ThisWorkbook with no success:</p>\n\n<pre><code>Private Sub ChartDisplay()\n\nIf Sheets(\"Sheet5\").Range(\"B1\") = \"Headcount\" Then\n ActiveSheet.Shapes(\"chrtYearTotal\").ZOrder msoBringToFront\n Else: ActiveSheet.Shapes(\"chrtYearAvg\").ZOrder msoBringToFront\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 2, "creation_date": 1472068688, "post_id": 39130713, "comment_id": 65609408, "body": "im just wondring if the <code>frm</code> on   <code>frm.Dirty = False</code> was referenced to the subform. If not then try, <code>frm![theSubform].Form.Dirty = False</code>"}, {"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "reply_to_user": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1472069646, "post_id": 39130713, "comment_id": 65609874, "body": "No actually not. So you&#39;re suggesting that the subform is the culprit in trying to update versus the unbound edit form.  I&#39;ll have to take a closer look at that. Thanks!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1472111201, "post_id": 39130713, "comment_id": 65623354, "body": "Totally unrelated, but use <code>site &amp;&amp; location</code> in your label to get <code>site &amp; location</code> in form view."}, {"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1472564193, "post_id": 39130713, "comment_id": 65795092, "body": "@Andre thanks for your comment. Will check that."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "edited": false, "score": 0, "creation_date": 1472493379, "post_id": 39137981, "comment_id": 65763376, "body": "Thanks @Tieme, good thing to check. Checked the subform and all values except &quot;Allow Deletions&quot; were <code>No</code> or <code>No Locks</code>. While <code>Allow Deletions</code> was left for allowing the <code>delete</code> (x) button to delete a record I went ahead &amp; set that also to <code>No</code> in the subform and retried the <code>Save</code> button of the main form. Unfortunately the same <code>Write Conflict</code> error results."}], "tags": [], "owner": {"reputation": 67, "user_id": 6742312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VTwjM.jpg?s=128&g=1", "display_name": "Tieme Woldman", "link": "https://stackoverflow.com/users/6742312/tieme-woldman"}, "is_accepted": false, "score": 1, "last_activity_date": 1472105862, "creation_date": 1472105862, "answer_id": 39137981, "question_id": 39130713, "link": "https://stackoverflow.com/questions/39130713/how-to-resolve-write-conflict-w-unbound-access-form/39137981#39137981", "title": "How to Resolve Write Conflict w/ Unbound Access Form", "body": "<p>For the subform the properties <code>Allow Additions, Allow Deletions, Allow Edits</code>\nshould be set to No and <code>Record Locks</code> to No Locks. This way the subform should not be able to interfere anymore.</p>\n"}], "owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2136, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472565102, "creation_date": 1472063790, "last_edit_date": 1472565102, "question_id": 39130713, "link": "https://stackoverflow.com/questions/39130713/how-to-resolve-write-conflict-w-unbound-access-form", "title": "How to Resolve Write Conflict w/ Unbound Access Form", "body": "<p>Have searched around and not yet found a solution that seems to fit. Perhaps someone here can offer some ideas.</p>\n\n<p><strong>Background</strong></p>\n\n<p>Application built in MS Access 2010 with tables linked to Access 2010 database, may eventually link.</p>\n\n<p>Form contains an 'edit' section (unbound) and a 'list' section (bound sub-form).</p>\n\n<p>Many forms of this type are used throughout the application.</p>\n\n<p>All forms use a common <code>UpsertRecord()</code> method to insert/update records based on their respective fields.</p>\n\n<p><strong>Issue</strong></p>\n\n<p>When the 'Save' button is clicked, the Write Conflict error is displayed.</p>\n\n<blockquote>\n  <p>Write Conflict</p>\n  \n  <p>This record has been changed by another user since you started editing it. If you save the record, you will overwrite the changes the other user made.\n  Copying the changes to the clipboard will let you look at the values the other user entered, and then paste your changes back in if you decide to make changes.</p>\n</blockquote>\n\n<p>The line triggering the error is where the form recordsource is set to a SQL string.</p>\n\n<pre><code>.RecordSource = strSQL\n</code></pre>\n\n<p><strong>My Interpretation</strong></p>\n\n<p>Although the form <em>could</em> directly update the bottom subform list without clicking 'Save', this is not desirable to avoid users inadvertently changing data.</p>\n\n<p>So, I'm attempting to force the 'Save' through the click event which in turn calls the common public <code>UpsertRecord()</code> method for saving the data. That method works fine, however triggers the Write Conflict since the form believes it is also changing the data by itself (w/o the 'Save' click).</p>\n\n<p><strong>Solutions Attempted</strong></p>\n\n<p>I've attempted to set a private variable <code>m_SaveOK</code> to prevent saves w/o the button click event by using the <code>Form_BeforeUpdate()</code> event with the code below however that also triggers the Write Conflict.</p>\n\n<pre><code>If Not m_SaveOK Then\n    Cancel = True\nEnd If\n</code></pre>\n\n<p>Also tried to save the form data prior to doing the qry.SQL direct save, however this too failed. That code was basically a check for dirty and forcing a form save using <code>frm.Dirty = False</code> prior to the direct save.</p>\n\n<pre><code>If frm.Dirty Then\n    frm.Dirty = False\nEnd If\n</code></pre>\n\n<p><strong>Form Image</strong></p>\n\n<p>This is what the form looks like. Clicking the pencil (edit) button of a record in the subform populates the top controls.</p>\n\n<p>When the 'Save' button is clicked, the record is saved to the database and the form is requeried to refresh the subform list.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qDBtF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qDBtF.jpg\" alt=\"Unbound edit form with bound subform list\"></a></p>\n\n<p>Anyway, I'd appreciate some ideas on how to prevent the form from attempting to save the record vs. the <code>Save</code> button click event.</p>\n\n<p>Thanks in advance for your help!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Subform properties are set to not allow additions and edits (delete is okay since that's what the 'X' button is for in the list), and no locks is set.</p>\n\n<p>After adding some <code>debug.print</code> statements evaluating <code>frm.Dirty</code> and <code>frm.subform.Form.Dirty</code> I've narrowed it down to the main form versus the subform being <code>Dirty</code> and causing the conflict.</p>\n\n<p>Underlying tables are properly updated using the 'Save' button, however the form remains <code>Dirty</code>. So although I'm not currently triggering the <code>Write Conflict</code> error, the <code>Dirty</code> state causes other errors &amp; undesirable behavior on form exit -- <code>You can't save this record at this time...</code> and <code>2101 The setting you entered isn't valid for this property.</code> when I add a <code>frm.Dirty = False</code> after the button triggered save.</p>\n\n<p>So I'm still working through the issue and would appreciate any other ideas.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6014517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NQ9U-DOBN3o/AAAAAAAAAAI/AAAAAAAAAEA/K4KGSeYGL3s/photo.jpg?sz=128", "display_name": "Daniel Mohabir", "link": "https://stackoverflow.com/users/6014517/daniel-mohabir"}, "edited": false, "score": 0, "creation_date": 1472135124, "post_id": 39132422, "comment_id": 65639433, "body": "thanks. SAge is supposed to be the variable that passes the value of the text box to the query."}, {"owner": {"reputation": 3, "user_id": 6014517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NQ9U-DOBN3o/AAAAAAAAAAI/AAAAAAAAAEA/K4KGSeYGL3s/photo.jpg?sz=128", "display_name": "Daniel Mohabir", "link": "https://stackoverflow.com/users/6014517/daniel-mohabir"}, "edited": false, "score": 0, "creation_date": 1473102606, "post_id": 39132422, "comment_id": 66004112, "body": "is there a better criteria that I can use instead of &#39;*&quot; . maybe one that can search for text according to the first letter typed to match the first letter in the field and not anywhere within the field."}, {"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "reply_to_user": {"reputation": 3, "user_id": 6014517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NQ9U-DOBN3o/AAAAAAAAAAI/AAAAAAAAAEA/K4KGSeYGL3s/photo.jpg?sz=128", "display_name": "Daniel Mohabir", "link": "https://stackoverflow.com/users/6014517/daniel-mohabir"}, "edited": false, "score": 0, "creation_date": 1473136088, "post_id": 39132422, "comment_id": 66012170, "body": "if you want first letter then do like <code>Like &#39;t*&#39;</code> so the results will be like all text starting from t."}], "tags": [], "owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "is_accepted": false, "score": 1, "last_activity_date": 1472070154, "creation_date": 1472070154, "answer_id": 39132422, "question_id": 39130686, "link": "https://stackoverflow.com/questions/39130686/need-the-correct-number-criteria-for-a-search-query/39132422#39132422", "title": "Need the correct number criteria for a search query", "body": "<p>Are you trying to filter/search for records where some strings can be found? Then use.</p>\n\n<pre><code>Like '*\" &amp; [forms]![SearchTab]![schAge] &amp; \"*'\" \n</code></pre>\n\n<p>Otherwise,</p>\n\n<pre><code>= \" &amp; [forms]![SearchTab]![schAge] &amp; \"\n</code></pre>\n\n<p>Also, since you are using <code>Change</code>event, use <code>schAge.Text</code>to get the last text input.  <code>schAge.Value</code> will only return the last value beforeUpdate of the textbox. <em>Note: I didn't see any relation of this code from above. Where are you using SAge?</em></p>\n\n<pre><code>Private Sub schAge_Change() \n  Dim SAge as Variant \n  SAge = schAge.Text\n  Me.lstResults.Requery \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6014517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NQ9U-DOBN3o/AAAAAAAAAAI/AAAAAAAAAEA/K4KGSeYGL3s/photo.jpg?sz=128", "display_name": "Daniel Mohabir", "link": "https://stackoverflow.com/users/6014517/daniel-mohabir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472080542, "creation_date": 1472063709, "last_edit_date": 1472080542, "question_id": 39130686, "link": "https://stackoverflow.com/questions/39130686/need-the-correct-number-criteria-for-a-search-query", "title": "Need the correct number criteria for a search query", "body": "<p>I've been working for a few days on a small project that searches a table for criteria entered in four TextBoxes, using a ListBox linked to a query that finds the results. My problem is that I can search the text datatype fields just fine, but there is a field called 'Age', and I cannot find the correct criteria syntax to put in the query.</p>\n\n<p>The criteria I used is this: <code>Like \"*\" &amp; [forms]![SearchTab]![schAge] &amp; \"*\"</code></p>\n\n<p>It works fine for text fields, but not for the one number field.\nThere isn't much VBA code, just for the OnChange of the TextBox to Requery the list box like this:</p>\n\n<pre><code>Private Sub schAge_Change()\n    Dim SAge as Variant\n    SAge = schAge.Value\n    Me.lstResults.Requery\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1472063471, "post_id": 39130588, "comment_id": 65606642, "body": "++ do you ever need to write VBA. :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1472063598, "post_id": 39130588, "comment_id": 65606710, "body": "@cyboashu why reinvent the wheel?"}, {"owner": {"reputation": 33, "user_id": 6388316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/325fb187d328d139f0b03fb3fa779a8e?s=128&d=identicon&r=PG&f=1", "display_name": "Robo_Hobo", "link": "https://stackoverflow.com/users/6388316/robo-hobo"}, "edited": false, "score": 0, "creation_date": 1472064817, "post_id": 39130588, "comment_id": 65607422, "body": "Awesome, worked perfectly. I tried a similar formula before turning to VBA but for some reason wasn&#39;t working right. Cheers!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1472064165, "last_edit_date": 1472064165, "creation_date": 1472063315, "answer_id": 39130588, "question_id": 39130514, "link": "https://stackoverflow.com/questions/39130514/add-unique-id-to-list-of-numbers-vba/39130588#39130588", "title": "Add unique Id to list of numbers - VBA", "body": "<p>I know you asked for vba, but a simple formula will give you the desired output.</p>\n\n<p>In B1 put:</p>\n\n<pre><code>=A1&amp; \"-\" &amp;TEXT(COUNTIF($A$1:A1,A1),\"000\")\n</code></pre>\n\n<p>And copy down the extent of the data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PKOKB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PKOKB.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>If you want it in vba; I would do something like this:</p>\n\n<pre><code>Sub test2()\n    Dim rng As Range\n    Dim rngcnt As Range\n    Dim firstrow As Long\n    Dim lastrow As Long\n    Dim columnNumber As Long\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"Sheet15\") 'change to your sheet\n    firstrow = 1 'change to your first row of data\n    columnNumber = 1 'change to the column number\n\n    With ws\n        lastrow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n        For i = firstrow To lastrow\n            .Cells(i, columnNumber + 1) = .Cells(i, columnNumber) &amp; \"-\" &amp; Format(Application.WorksheetFunction.CountIf(.Range(.Cells(firstrow, columnNumber), .Cells(i, columnNumber)), .Cells(i, columnNumber)), \"000\")\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Which effectively does the same as the above formula.</p>\n"}], "owner": {"reputation": 33, "user_id": 6388316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/325fb187d328d139f0b03fb3fa779a8e?s=128&d=identicon&r=PG&f=1", "display_name": "Robo_Hobo", "link": "https://stackoverflow.com/users/6388316/robo-hobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 39130588, "answer_count": 1, "score": 1, "last_activity_date": 1472067320, "creation_date": 1472063046, "last_edit_date": 1531164843, "question_id": 39130514, "link": "https://stackoverflow.com/questions/39130514/add-unique-id-to-list-of-numbers-vba", "title": "Add unique Id to list of numbers - VBA", "body": "<p>I have a list of numbers (50,000+) and I need to add a Id to the end of each unique group. The Id is in a format of \"-###\".</p>\n\n<pre><code>151022\n151022\n151020\n150922\n150715\n150911\n151014\n151021\n151020\n151019\n151019\n151019\n151020\n</code></pre>\n\n<p>I need it to print like this</p>\n\n<pre><code>151022-001\n151022-002\n151020-001\n150922-001\n150715-001\n150911-001\n151014-001\n151021-001\n151020-002\n151019-001\n151019-002\n151019-003\n151020-002\n</code></pre>\n\n<p>I currently have this code that I found and modified slightly. If I could get it to start counting unique values at -002 then I believe that would solve it.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim uniqueCounter As New Scripting.Dictionary\n    Dim counter As Long\n    Dim rowCount As Long\n    Dim identifer As String\n\n\n    rowCount = ActiveCell.CurrentRegion.Rows.Count 'Whatever code you want to put in to calculate the last row\n\n    For counter = 1 To rowCount\n        identifer = Sheet1.Cells(counter, 1) 'Put whatever number of combination of cells which the row unique here (maybe it's just the one)\n        If uniqueCounter.Exists(identifer) Then\n            uniqueCounter(identifer) = CLng(uniqueCounter(CStr(Sheet1.Cells(counter, 1)))) + 1\n            Sheet1.Cells(counter, 2) = identifer &amp; \"-00\" &amp; uniqueCounter(CStr(Sheet1.Cells(counter, 1)))\n        Else\n            uniqueCounter.Add identifer, \"0\"\n            Sheet1.Cells(counter, 2) = identifer\n        End If\n    Next counter\n\nEnd Sub\n</code></pre>\n\n<p>This what it currently displays:</p>\n\n<pre><code>151022  151022\n151022  151022-001\n151020  151020\n150922  150922\n150715  150715\n150911  150911\n151014  151014\n151021  151021\n151020  151020-001\n151019  151019\n151019  151019-001\n151019  151019-002\n151020  151020-002\n</code></pre>\n\n<p>Thanks All!</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 21, "user_id": 6753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50514429368eb013428e37f9126e3b16?s=128&d=identicon&r=PG&f=1", "display_name": "Dashly ", "link": "https://stackoverflow.com/users/6753747/dashly"}, "reply_to_user": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1472073741, "post_id": 39130470, "comment_id": 65611790, "body": "Sorry, ignore my other comment, I didn&#39;t realize hitting Enter would post. I actually think I&#39;ve solved it. Messing around with Access&#39;s query wizard, I discovered that some of the fields weren&#39;t actually NULL but empty strings so I needed: [table].field IS NULL OR  [table].field = &quot;&quot;  ... I don&#39;t know why it would save that way (Maybe because I put in values and then erased them later from the field for those records...?), but it seems to have fixed my problem."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50514429368eb013428e37f9126e3b16?s=128&d=identicon&r=PG&f=1", "display_name": "Dashly ", "link": "https://stackoverflow.com/users/6753747/dashly"}, "edited": false, "score": 0, "creation_date": 1472074462, "post_id": 39132955, "comment_id": 65612121, "body": "I have an if-then statement checking the value of a combobox on the form. If the combobox has a value, that gets saved to the variable, if it has no value than &quot;IS NULL&quot; is saved. I actually ended up rewriting the string saved to the variables entirely to account for the parentheses problem you mentioned in your second bullet point. The actual problem ended up being that some of the fields were NULL and some just empty strings. SQL injection shouldn&#39;t be a problem, this database will only be used in office by non programmers. Thank you for your well thought out response."}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "reply_to_user": {"reputation": 21, "user_id": 6753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50514429368eb013428e37f9126e3b16?s=128&d=identicon&r=PG&f=1", "display_name": "Dashly ", "link": "https://stackoverflow.com/users/6753747/dashly"}, "edited": false, "score": 0, "creation_date": 1472124803, "post_id": 39132955, "comment_id": 65632256, "body": "@Dashly Hi, I&#39;m glad, that you found your solution! Once you&#39;ve crossed the <i>15-reputation-points-border</i> yourself, you might come back to vote me up. Happy Coding!"}], "tags": [], "owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "is_accepted": false, "score": 1, "last_activity_date": 1472072490, "last_edit_date": 1592644375, "creation_date": 1472072490, "answer_id": 39132955, "question_id": 39130470, "link": "https://stackoverflow.com/questions/39130470/access-2010-issues-with-is-null-in-select-statement/39132955#39132955", "title": "Access 2010 Issues with &quot;IS NULL&quot; in Select statement", "body": "<p>In your code there are some weak points (and do what sstan suggested: Check the generated code before the execution!)</p>\n<ul>\n<li><p>What is in your variables, if the value is not null? If I understand this correctly, you store the text <em>&quot;IS NULL&quot;</em> in your variables. If there is a value, your variables should contain something like <em>&quot;='SomeValue'&quot;</em> (Attention with strings, which must be in quotes, and formats like <code>.</code> or <code>,</code> in decimals or with datetime literals)</p>\n</li>\n<li><p>The paranthesis should include the full expression <code>AND (FileUnit.Subseries_4_Number=123)</code>. You might let them away entirely as there are only <code>AND</code>s.</p>\n</li>\n<li><p>And check for the blanks:</p>\n<p>AND(File_Unit.Subseries_1_Number) &quot; &amp; cmbSubseries_1 &amp; &quot;\nAND(File_Unit.Subseries_2_Number) &quot; &amp; cmbSubseries_2 &amp; &quot;</p>\n</li>\n</ul>\n<p>...might result in</p>\n<pre><code>AND(File_Unit.Subseries_1_Number) ISNULLAND(File_Unit.Subseries_2_Number) 123\n</code></pre>\n<p>(Look at the paranthesis, the missing blank before the <code>AND</code> and the missing <code>=</code> if your variable carries the value only.</p>\n<h2>UPDATE Beware of sql injection!</h2>\n<p>Anyway SQL statements with values should not be created by concatenating strings but should use parameters...</p>\n"}, {"comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1472140417, "post_id": 39133418, "comment_id": 65642869, "body": "You might accept your own answer to close this question."}], "tags": [], "owner": {"reputation": 21, "user_id": 6753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50514429368eb013428e37f9126e3b16?s=128&d=identicon&r=PG&f=1", "display_name": "Dashly ", "link": "https://stackoverflow.com/users/6753747/dashly"}, "is_accepted": true, "score": 1, "last_activity_date": 1472074669, "creation_date": 1472074669, "answer_id": 39133418, "question_id": 39130470, "link": "https://stackoverflow.com/questions/39130470/access-2010-issues-with-is-null-in-select-statement/39133418#39133418", "title": "Access 2010 Issues with &quot;IS NULL&quot; in Select statement", "body": "<p>Sorry to waste anyone's time! I sorted out the answer on my own. It turned out that some of the fields were not NULL but empty strings. I changed the string that was being saved to the variable when there was no value to:</p>\n\n<blockquote>\n  <p>[table].field IS NULL or [table].field = \"\"</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 6753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50514429368eb013428e37f9126e3b16?s=128&d=identicon&r=PG&f=1", "display_name": "Dashly ", "link": "https://stackoverflow.com/users/6753747/dashly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "closed_date": 1472096723, "accepted_answer_id": 39133418, "answer_count": 2, "score": 1, "last_activity_date": 1594641503, "creation_date": 1472062878, "last_edit_date": 1594641503, "question_id": 39130470, "link": "https://stackoverflow.com/questions/39130470/access-2010-issues-with-is-null-in-select-statement", "closed_reason": "Not suitable for this site", "title": "Access 2010 Issues with &quot;IS NULL&quot; in Select statement", "body": "<p>I am a novice programmer attempting to build a database for work in Access 2010 in an effort to better manage our data. Our filing system involves documents nested under one another in various branching subjects. The branches are all varying lengths, in my database each record always has a collection number, series number, and file unit number but there are several sub-series numbers that they may or may not have depending on how many subjects branch off of the previous subject. All of this information collects in a File Unit table.</p>\n\n<p>I'm working on setting up a search form with a combobox for collection number, series number, each possible sub-series number, and then file unit number, so that from the first combobox the user chooses their collection number which then triggers a query that fills the series combobox with all series numbers available for that collection number, and so on and so forth down the line. My problem is with the file unit number combobox. </p>\n\n<p>I need the file unit number combobox to fill with options after the series number is selected and update with each subsequent selection of sub-series number to only display file unit numbers from the file unit table that match the selected values and have null values for sub-series comboboxes that have nothing selected.</p>\n\n<p>I've written a sub procedure that calls after the user exits each combobox when certain conditions are met. In the sub procedure, if then statements check each combobox, if there's a value it's stored in a corresponding string variable and if not the variable is set to IS NULL.</p>\n\n<p>This is the code I'm using to fill the file unit number combobox: </p>\n\n<pre><code>File_Unit_Number.RowSourceType = \"Table/Query\"\n\nFile_Unit_Number.RowSource = \"SELECT File_Unit.File_Unit_Number,\nFile_Unit.File_Unit_Name FROM File_Unit WHERE\n(((File_Unit.Collection_Number) \" &amp; cmbCollection &amp; \" AND\n(File_Unit.Series_Number) \" &amp; cmbSeries &amp; \"\nAND(File_Unit.Subseries_1_Number) \" &amp; cmbSubseries_1 &amp; \"\nAND(File_Unit.Subseries_2_Number) \" &amp; cmbSubseries_2 &amp; \"\nAND(File_Unit.Subseries_3_Number) \" &amp; cmbSubseries_3 &amp; \"\nAND(File_Unit.Subseries_4_Number) \" &amp; Subseries_4 &amp; \"\nAND(File_Unit.Subseries_5_Number) \" &amp; cmbSubseries_5 &amp; \"));\"\n</code></pre>\n\n<p>I've run tests to make sure that my if-then statements are triggering correctly and that the SQL string is printing correctly. When I remove the fields that have null values (ie. delete everything except series_number) from the WHERE part of the statement and test then items populate my file unit combobox. Problem is these numbers are all of the file unit numbers regardless of value in all of the sub-series columns.</p>\n\n<p>What am I doing wrong? And is there an easier way to get the results I need?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5672718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-fi4Hnqcyi9E/AAAAAAAAAAI/AAAAAAAAAB0/hFo8JZLIb8w/photo.jpg?sz=128", "display_name": "Srinivas Mantri", "link": "https://stackoverflow.com/users/5672718/srinivas-mantri"}, "edited": false, "score": 0, "creation_date": 1472103140, "post_id": 39134813, "comment_id": 65619228, "body": "thank you, but still its not added the new table in page 2. Can you suggest"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1472085055, "last_edit_date": 1472085055, "creation_date": 1472083858, "answer_id": 39134813, "question_id": 39130424, "link": "https://stackoverflow.com/questions/39130424/vba-word-add-table-after-copying-table-from-excel/39134813#39134813", "title": "Vba Word add table after copying table from Excel", "body": "<p>Another way to get the end of the document is <code>objDoc.Range(objDoc.Range.End - 1)</code></p>\n\n<pre><code>objDoc.Range.PasteExcelTable 0, 0, 0\n\nobjDoc.Range(objDoc.Range.End - 1).InsertBreak \n\nobjDoc.Tables.Add objDoc.Range(objDoc.Range.End - 1), 2, 2\n</code></pre>\n\n<p>If you record the macro in Word, you get something like this</p>\n\n<pre><code>Selection.PasteExcelTable False, False, True\nSelection.InsertBreak Type:=wdPageBreak\nActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:=1,  _\n    DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitFixed\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5672718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-fi4Hnqcyi9E/AAAAAAAAAAI/AAAAAAAAAB0/hFo8JZLIb8w/photo.jpg?sz=128", "display_name": "Srinivas Mantri", "link": "https://stackoverflow.com/users/5672718/srinivas-mantri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472085055, "creation_date": 1472062716, "last_edit_date": 1531164843, "question_id": 39130424, "link": "https://stackoverflow.com/questions/39130424/vba-word-add-table-after-copying-table-from-excel", "title": "Vba Word add table after copying table from Excel", "body": "<p>The macro is written in Excel. I have copied the table to word first page from excel and then I would like to insert table into page 2 in word.But from below the set \"MyRange\" returning empty and table with 1 row is not creating.  </p>\n\n<pre><code>   Set objWord = CreateObject(\"Word.Application\")\n   Set objDoc = objWord.Documents.Open(str_path_folder &amp; \"\\\" &amp; AdID &amp; \".dotm\")\n    objWord.Visible = True\n    objDoc.Activate\n    AppActivate AdID &amp; \".dotm\"\n    Sheets(\"Meta\").Select\n    Range(\"B1:E\" &amp; LastRow).Select\n    Selection.Copy\n    objWord.Selection.PasteExcelTable False, False, False\n    objDoc.Tables(1).AutoFitBehavior wdAutoFitContent\n   objWord.Selection.InsertBreak.Type = wdPageBreak\n   Set MyRange = ActiveDocument.Content\n   MyRange.collapse Direction:=wdCollapseEnd\n   ActiveDocument.Tables.Add Range:=MyRange, NumRows:=1, _\n   NumColumns:=1, DefaultTableBehavior:=wdWord9TableBehavior,       AutoFitBehavior:=wdAutoFitFixed\n</code></pre>\n\n<p>Also if i use below it is replacing the already copied table in page 1:</p>\n\n<pre><code>objDoc.Tables.Add Range:=objDoc.Range, NumRows:=3, NumColumns:=2, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitFixed\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "rs"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1472060596, "post_id": 39129647, "comment_id": 65605052, "body": "From <a href=\"https://msdn.microsoft.com/en-us/library/ee275540(v=bts.10).aspx\" rel=\"nofollow noreferrer\">the docs</a> referring to multiple conditions in a filter: &quot;One restriction on these combinations is that OR clauses can only be used at the highest (major) level of the logical operation.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6753697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154066633258401/picture?type=large", "display_name": "Israel Dac", "link": "https://stackoverflow.com/users/6753697/israel-dac"}, "is_accepted": false, "score": 0, "last_activity_date": 1472110802, "creation_date": 1472110802, "answer_id": 39139375, "question_id": 39129647, "link": "https://stackoverflow.com/questions/39129647/excel-vba-adodb-error-3001-using-rs-filter/39139375#39139375", "title": "Excel VBA adodb error 3001 using rs.filter", "body": "<p>It appears that rs.filter is a weak function !</p>\n\n<p>Using the same syntax with select - did the job !</p>\n"}], "owner": {"reputation": 1, "user_id": 6753697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154066633258401/picture?type=large", "display_name": "Israel Dac", "link": "https://stackoverflow.com/users/6753697/israel-dac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472110802, "creation_date": 1472059971, "last_edit_date": 1472067903, "question_id": 39129647, "link": "https://stackoverflow.com/questions/39129647/excel-vba-adodb-error-3001-using-rs-filter", "title": "Excel VBA adodb error 3001 using rs.filter", "body": "<p>Using Excel 2013 with Access 2013</p>\n\n<p>Using Provider = Microsoft.ACE.OLEDB.12.0;</p>\n\n<p>After rs.open Table, I wrote an rs.filter with </p>\n\n<p>This is my code</p>\n\n<pre><code>myFilter = \"sd_am = 'abcd' and sd_h = '' and (sd_k = 'option1' or _ \n     sd_k = 'option2' or sd_k = 'option3') and sd_l = 'kuku'\"\nrs.filter = myFilter\n</code></pre>\n\n<p>I get error 3001 !\nI tried to change the filter with different syntax - doesn't work ! </p>\n"}, {"tags": ["vba", "excel", "duplicates", "listboxitem"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5862684, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f328deba55961889605be144ae60a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rosario", "link": "https://stackoverflow.com/users/5862684/rosario"}, "edited": false, "score": 0, "creation_date": 1472065531, "post_id": 39129778, "comment_id": 65607776, "body": "I did Way 1, just because I want to use that data for other statements. and it says &quot;invalid property array index&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 37, "user_id": 5862684, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f328deba55961889605be144ae60a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rosario", "link": "https://stackoverflow.com/users/5862684/rosario"}, "edited": false, "score": 0, "creation_date": 1472099088, "post_id": 39129778, "comment_id": 65618143, "body": "I added two changes. Please try it now."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1472099073, "last_edit_date": 1472099073, "creation_date": 1472060418, "answer_id": 39129778, "question_id": 39129572, "link": "https://stackoverflow.com/questions/39129572/vba-removing-listbox-duplicates/39129778#39129778", "title": "VBA Removing ListBox Duplicates", "body": "<p><strong>Way 1</strong></p>\n\n<p>Use this to remove the duplicates</p>\n\n<pre><code>Sub Sample()\n    RemovelstDuplicates ctrlListNames\nEnd Sub\n\nPublic Sub RemovelstDuplicates(lst As msforms.ListBox)\n    Dim i As Long, j As Long\n    With lst\n        For i = 0 To .ListCount - 1\n            For j = .ListCount - 1 To (i + 1) Step -1\n                If .List(j) = .List(i) Then\n                    .RemoveItem j\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Way 2</strong></p>\n\n<p>Create a unique collection and then add it to the listbox</p>\n\n<pre><code>Dim Col As New Collection, itm As Variant\n\nFor Each rngCell In rngData.Columns(2).Cells\n    On Error Resume Next\n    Col.Add rngCell.Value, CStr(rngCell.Value)\n    On Error GoTo 0\nNext rngCell\n\nFor Each itm In Col\n    ctrlListNames.AddItem itm\nNext itm\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 5862684, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f328deba55961889605be144ae60a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rosario", "link": "https://stackoverflow.com/users/5862684/rosario"}, "is_accepted": false, "score": 1, "last_activity_date": 1472065713, "creation_date": 1472065713, "answer_id": 39131267, "question_id": 39129572, "link": "https://stackoverflow.com/questions/39129572/vba-removing-listbox-duplicates/39131267#39131267", "title": "VBA Removing ListBox Duplicates", "body": "<pre><code>Private Sub Workbook_Open()\nDim ctrlListNames As MSForms.ListBox\nDim i As Long\nDim j As Long\n\nctrlListNames.List = Application.ThisWorkbook.Worksheets(\"Names\").Range(\"Salesperson\").Value\n\n\nWith ctrlListNames\nFor i = 0 To .ListCount - 1\n    For j = .ListCount To (i + 1) Step -1\n        If .List(j) = .List(i) Then\n            .RemoveItem j\n        End If\n    Next\nNext\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>And it says invalid property array index.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14035071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d45e05a4821db84e825633ecdb7193f?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/14035071/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1598973149, "creation_date": 1598973149, "answer_id": 63690498, "question_id": 39129572, "link": "https://stackoverflow.com/questions/39129572/vba-removing-listbox-duplicates/63690498#63690498", "title": "VBA Removing ListBox Duplicates", "body": "<p>It says invalid property array index because the list gets shortened after the removal of entries. if we use FOR, the end value is static, therefore, we need to use DO while loop. Use the following code to remove duplicates.</p>\n<pre><code>Count = ListBox1.ListCount - 1\n\ni = 0\nj = 0\n\nDo While i &lt;= Count\nj = i + 1\nDo While j &lt;= Count\nIf ListBox1.List(i) = ListBox1.List(j) Then\nListBox1.RemoveItem (j)\nCount = ListBox1.ListCount - 1  'Need to update list count after each removal. \nEnd If\nj = j + 1\nLoop\ni = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5862684, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f328deba55961889605be144ae60a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rosario", "link": "https://stackoverflow.com/users/5862684/rosario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5833, "favorite_count": 0, "accepted_answer_id": 39129778, "answer_count": 3, "score": 1, "last_activity_date": 1598973149, "creation_date": 1472059665, "last_edit_date": 1531164843, "question_id": 39129572, "link": "https://stackoverflow.com/questions/39129572/vba-removing-listbox-duplicates", "title": "VBA Removing ListBox Duplicates", "body": "<p>I'm trying to add a list of names from another worksheet that has duplicates. On the listbox, I want to have unique names, instead of duplicates. The following code is not sorting them for duplicates, it errors out. Any help is appreciated.</p>\n\n<pre><code>Dim intCount As Integer\nDim rngData As Range\nDim strID As String\nDim rngCell As Range\ndim ctrlListNames as MSForms.ListBox\nSet rngData = Application.ThisWorkbook.Worksheets(\"Names\").Range(\"A\").CurrentRegion\n\n'declare header of strID and sort it\nstrID = \"Salesperson\"\nrngData.Sort key1:=strID, Header:=xlYes\n'Loop to add the salesperson name and to make sure no duplicates are added\nFor Each rngCell In rngData.Columns(2).Cells\n    If rngCell.Value &lt;&gt; strID Then\n        ctrlListNames.AddItem rngCell.Value\n        strID = rngCell.Value\n    End If\nNext rngCell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472059278, "post_id": 39129358, "comment_id": 65604331, "body": "I believe your trouble is coming from this line: <code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _ DataSheet &amp; &quot;!R1C1:R&quot; &amp; FinalRow &amp; &quot;C8&quot;, Version:=xlPivotTableVersion15). _ CreatePivotTable TableDestination:=DataSheet &amp; &quot;!R1C9&quot;, TableName:= _ &quot;PivotTable4&quot;, DefaultVersion:=xlPivotTableVersion15 Sheets(DataSheet).Select</code> - Why are you trying to select it? I think the format of the TableDestination is off."}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472060224, "post_id": 39129358, "comment_id": 65604867, "body": "I am trying to select the an ambiguous data set each time. Each worksheet has a different row length. So I thought the stated above would in some sense select all data on the active workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472060446, "post_id": 39129358, "comment_id": 65604984, "body": "I mean, that line creates a pivot table, but in the destination, you&#39;re trying to <code>.Select</code> something? Does that line work for you at all, I&#39;d think it&#39;d throw an error.  I recommend instead, first creating a <code>Range</code> variable to store the destination, then just use that in the <code>TableDestination:=</code> part (i.e. <code>TableDestination := myDest</code>)"}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472062516, "post_id": 39129358, "comment_id": 65606101, "body": "I see what you are saying. You are right, that is the line that I am having an issue with. I expected that it would be an error with the TableDestination:= I am working on adding a range right now to see if that resolves my issue."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472063051, "post_id": 39129358, "comment_id": 65606406, "body": "(Also, not sure if it happened when pasting to SO, but you have some errant spaces in there as well (<code>...PivotFields(&quot;Document Type&quot;) .Orientation</code> has a space, for instance)."}, {"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472064077, "post_id": 39129358, "comment_id": 65606980, "body": "I think it was formatting when pasting to SO. I am not having any issues with those lines."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472064439, "post_id": 39129358, "comment_id": 65607189, "body": "@Cjamros try the code in my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1472064798, "post_id": 39130898, "comment_id": 65607407, "body": "Bruce - it worked once I was able to add the Range in. Shai that definitely worked once I plugged it in. It does exactly what I need and look clean to boot. Thanks for all of the help!! not to add the loop... You guys have been a big help."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "edited": false, "score": 0, "creation_date": 1472064836, "post_id": 39130898, "comment_id": 65607429, "body": "You&#39;re welcome, don&#39;t forget to vote and mark as answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1472064413, "creation_date": 1472064413, "answer_id": 39130898, "question_id": 39129358, "link": "https://stackoverflow.com/questions/39129358/vba-place-pivot-table-in-same-worksheet/39130898#39130898", "title": "VBA -Place Pivot Table in Same worksheet", "body": "<p>Try the code below, it's with a little different approach, defining <code>Range</code>, <code>PivotTable</code>, <code>PivotCache</code>, and you can modify them easily according to your needs:</p>\n\n<pre><code>Sub Macro4()\n\nDim FinalRow            As Long\nDim DataSheet           As String\nDim PvtCache            As PivotCache\nDim PvtTbl              As PivotTable\nDim DataRng             As Range\nDim TableDest           As Range\n\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\nDataSheet = ActiveSheet.Name\n\n' set data range for Pivot Table\nSet DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, 8))  ' conversion of R1C1:R &amp; FinalRow &amp; C8\n\n' set range for Pivot table placement\nSet TableDest = Sheets(DataSheet).Cells(1, 9)  ' conversion of R1C9\n\nSet PvtCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, DataRng)\n\n' this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables(\"PivotTable4\") ' check if \"PivotTable4\" Pivot Table already created (in past runs of this Macro)\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then ' \"PivotTable4\" doesn't exist &gt;&gt; create it\n\n    ' create a new Pivot Table in \"PivotTable4\" sheet\n    Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables.Add(PivotCache:=PvtCache, TableDestination:=TableDest, TableName:=\"PivotTable4\")\n\n    With PvtTbl.PivotFields(\"Document Type\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    With PvtTbl.PivotFields(\"Accounting Event\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n\n    With PvtTbl.PivotFields(\"Document Number\")\n        .Orientation = xlRowField\n        .Position = 3\n    End With\n\n    PvtTbl.AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable4\").PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\nElse\n    ' just refresh the Pivot cache with the updated Range\n    PvtTbl.ChangePivotCache PvtCache\n    PvtTbl.RefreshTable\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6753010, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7af4584d25395e0ee73de1a786dde20d?s=128&d=identicon&r=PG&f=1", "display_name": "Cjamros", "link": "https://stackoverflow.com/users/6753010/cjamros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2334, "favorite_count": 0, "accepted_answer_id": 39130898, "answer_count": 1, "score": 2, "last_activity_date": 1472066571, "creation_date": 1472058881, "last_edit_date": 1472066571, "question_id": 39129358, "link": "https://stackoverflow.com/questions/39129358/vba-place-pivot-table-in-same-worksheet", "title": "VBA -Place Pivot Table in Same worksheet", "body": "<p>New to VBA and I am having difficulty with my Macro creating a pivot table on the same worksheet with my data (for example, starting the pivot table in the \"I1\" column). I have been able to run the macro to select all of the data within the sheet and then create this data on another worksheet. Since I will need to loop through a number of worksheets on the same workbook to create multiple pivot tables, having separate sheets isn't feasible.</p>\n\n<p>Each worksheet has the same number of columns with a varying number of rows. My goal is to have this macro look at each worksheet and output a pivot table next to it.</p>\n\n<p>I feel like the macro I have below is not referencing the correct pivot Table destination. Any assistance would be appreciated.</p>\n\n<pre><code>Sub Macro4()  \n'  \n'Macro4 Macro  \n'\n\n'  \nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row  \nDataSheet = ActiveSheet.Name\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\nDataSheet &amp; \"!R1C1:R\" &amp; FinalRow &amp; \"C8\", Version:=xlPivotTableVersion15). _\nCreatePivotTable TableDestination:=DataSheet &amp; \"!R1C9\", TableName:= _\n\"PivotTable4\", DefaultVersion:=xlPivotTableVersion15\n\nSheets(DataSheet).Select  \nCells(1, 9).Select  \nWith ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Document Type\") \n    .Orientation = xlRowField.Position = 1  \nEnd With  \nWith ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Accounting Event\")    \n    .Orientation = xlRowField.Position = 2  \nEnd With  \nWith ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Document Number\")\n    .Orientation = xlRowField.Position = 3  \nEnd With  \nActiveSheet.PivotTables(\"PivotTable4\").AddDataField ActiveSheet.PivotTables\n( _\"PivotTable4\").PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\nEnd Sub  \n</code></pre>\n"}, {"tags": ["vba", "conditional"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1472057837, "post_id": 39129010, "comment_id": 65603562, "body": "You code is missing an <code>End With</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1472058110, "post_id": 39129010, "comment_id": 65603698, "body": "@litelite <i>and</i> proper indentation, just as importantly (I approved that edit ;-)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472058420, "post_id": 39129010, "comment_id": 65603876, "body": "you&#39;d better post some relevant examples of involved sheets. you&#39;re writing about running <i>&quot;through a list in column A&quot;</i> of which I cannot see a sign of. Furthermore you&#39;re referring to <code>X</code> before you define it by the end of the loop"}, {"owner": {"reputation": 3, "user_id": 6753571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa019017087e3ba98f1edadab68df6d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike89", "link": "https://stackoverflow.com/users/6753571/mike89"}, "edited": false, "score": 0, "creation_date": 1472059049, "post_id": 39129010, "comment_id": 65604216, "body": "Added &quot;End with&quot; before &quot;End Sub&quot; but still not working. What do you guys mean by proper indentation? Tried posting a picture of the referenced cells, but I don&#39;t see that functionality."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1472059792, "post_id": 39129010, "comment_id": 65604617, "body": "Basic troublelshooting help requirements - identify error message or symptoms of &quot;it&#39;s not working&quot; and the line causing any error"}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "edited": false, "score": 0, "creation_date": 1472059921, "post_id": 39129010, "comment_id": 65604693, "body": "@Mike89 I don&#39;t see that you <i>&quot;Added &#39;End with&#39; before &#39;End Sub&#39;&quot;</i>. Do it in your post too."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472062049, "post_id": 39129010, "comment_id": 65605841, "body": "This just seems to save the same sheet &quot;Att A&quot; (under different filenames) multiple times to one of two folders ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472062754, "post_id": 39129010, "comment_id": 65606223, "body": "@Mike89 - Proper indentation refers to the <i>code</i>.  See <a href=\"http://stackoverflow.com/revisions/39129010/3\">this edit</a> that fixed it."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6753571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa019017087e3ba98f1edadab68df6d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike89", "link": "https://stackoverflow.com/users/6753571/mike89"}, "edited": false, "score": 0, "creation_date": 1472133254, "post_id": 39130392, "comment_id": 65638155, "body": "Thank you. Perhaps I did something wrong, but it is giving me a run-time error saying &quot;Method range of object_worksheet&quot; failed ant it highlights &quot;shtAtt.Range(&quot;DLR_NUM&quot;) = &quot;&#39;&quot; &amp; X&quot; within the code when I try to debug."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 6753571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa019017087e3ba98f1edadab68df6d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike89", "link": "https://stackoverflow.com/users/6753571/mike89"}, "edited": false, "score": 0, "creation_date": 1472135953, "post_id": 39130392, "comment_id": 65640009, "body": "Is there a range with that name on the sheet &quot;Att A&quot;?"}, {"owner": {"reputation": 3, "user_id": 6753571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa019017087e3ba98f1edadab68df6d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike89", "link": "https://stackoverflow.com/users/6753571/mike89"}, "edited": false, "score": 0, "creation_date": 1472137047, "post_id": 39130392, "comment_id": 65640745, "body": "I created a list of values in another tab and used data validation to call the drop-down list &quot;DLR_NUM&quot;). This is in the &quot;Table&quot; tab and not the &quot;Att A&quot; tab."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1472139383, "last_edit_date": 1472139383, "creation_date": 1472062596, "answer_id": 39130392, "question_id": 39129010, "link": "https://stackoverflow.com/questions/39129010/conditional-statement-within-loop/39130392#39130392", "title": "Conditional Statement within Loop", "body": "<pre><code>Sub Generate_PDF_Files()\n\n    Dim c As Range, X, fName As String, shtAtt As Worksheet\n\n    Set shtAtt = Sheets(\"Att A\")\n\n    For Each c In Sheets(\"Table\").Range(\"CH7:CH185\").Cells\n\n        X = c.EntireRow.Cells(1).Value\n        If X = \"STOP\" Then Exit For\n\n        c.Parent.Range(\"DLR_NUM\") = \"'\" &amp; X\n\n        fName = \"L:\\Mike89\\\" &amp; IIf(c.Value = 0, \"No Violations\\\", \"Violations\\\") &amp; X &amp; \".pdf\"\n\n        shtAtt.ExportAsFixedFormat Type:=xlTypePDF, Filename:=fName, _\n                      Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                      IgnorePrintAreas:=False, OpenAfterPublish:=False\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6753571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa019017087e3ba98f1edadab68df6d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike89", "link": "https://stackoverflow.com/users/6753571/mike89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472139383, "creation_date": 1472057518, "last_edit_date": 1472060222, "question_id": 39129010, "link": "https://stackoverflow.com/questions/39129010/conditional-statement-within-loop", "title": "Conditional Statement within Loop", "body": "<p>What am i doing wrong? I want to create pdf files of a tab that runs through a list in column A from a different tab. Meanwhile, I want it to refer to the value in column CH to see if it is greater than 0 and if it is so save in a specific folder. If not, save in another folder. </p>\n\n<p>Help is greatly appreciated as I can't find a solution and have been stuck for hours. Thanks!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Generate_PDF_Files()\nApplication.ScreenUpdating = False\nSheets(\"Table\").Activate\nRange(\"A7\").Activate\n\nSet r = Range(\"CH7:CH185\")\nWith ActiveSheet\n    For Each erange In .Range(\"CH7:CH185\")\n        If erange.Value &gt; 0 Then\n            Sheets(\"Att A\").Select\n            ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n                \"L:\\Mike89\\Violations\\\" &amp; X &amp; \".pdf\", Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n         End If\n\n         If erange.Value = 0 Then \n             Sheets(\"Att A\").Select\n             ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n                 \"L:\\Mike89\\No Violations\\\" &amp; X &amp; \".pdf\", Quality:=xlQualityStandard, _\n                 IncludeDocProperties:=True, IgnorePrintAreas:=False,OpenAfterPublish:=False\n         End If\n\n     Next\n\n     Do Until ActiveCell.Value = \"STOP\"\n         X = ActiveCell.Value\n         Range(\"DLR_NUM\") = \"'\" &amp; X\n\n         Sheets(\"Table\").Activate\n         ActiveCell.Offset(1, 0).Activate\n     Loop\n\nEnd with\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1472056179, "post_id": 39128530, "comment_id": 65602659, "body": "You would need the array <code>As Variant</code>, thats the only type supported for loading into an array.  As its only a single column you can easily loop the cells and add to an array of doubles manually"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1472056842, "post_id": 39128530, "comment_id": 65603027, "body": "OT: Please remember to give feedback -this is becuase I just saw <a href=\"http://stackoverflow.com/questions/39124058/vba-error-9-when-using-for-each-on-an-array\">this topic</a>- on each of your questions, mark answers and stuff, else, another user with the potential same issue won&#39;t know what helped."}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1472056213, "creation_date": 1472056213, "answer_id": 39128619, "question_id": 39128530, "link": "https://stackoverflow.com/questions/39128530/define-array-to-obtain-data-from-range-as-double-var-type/39128619#39128619", "title": "Define array to obtain data from range as &quot;double&quot; var type", "body": "<pre><code>Set ThisWS = Excel.ActiveWorkbook.Worksheets(\"Hoja1\")\nDim CurRow As Long\nDim LRow As Long             'Define length of array\n    LRow = ThisWS.Range(\"C\" &amp; Rows.count).End(xlUp).Row\nDim InputValues(1 to LRow - 1) As Double 'Define Array\n\nFor CurRow = 2 to LRow\n    InputValues(CurRow - 1) = ThisWS.Range(\"C\" &amp; CurRow).Value\nNext CurRow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1472057999, "creation_date": 1472057999, "answer_id": 39129126, "question_id": 39128530, "link": "https://stackoverflow.com/questions/39128530/define-array-to-obtain-data-from-range-as-double-var-type/39129126#39129126", "title": "Define array to obtain data from range as &quot;double&quot; var type", "body": "<p>you can simply go like follows</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim InputValues As Variant 'Define Array\n\n    With Excel.ActiveWorkbook.Worksheets(\"Hoja1\") ' refer to wanted worksheet\n        InputValues = .Range(\"C2\", .Cells(.Rows.Count, 3).End(xlUp)).value 'fill array with values in column \"C\" cells from row 2 down to last non emtpy one\n    End With\nEnd Sub\n</code></pre>\n\n<p>should you ever need to handle array values as of <code>Double</code> type, then you can use <code>CDbl()</code> function</p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472061118, "post_id": 39129198, "comment_id": 65605332, "body": "I like example 2 more. If you wouldn&#39;t have posted that, I would have :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472062369, "post_id": 39129198, "comment_id": 65606008, "body": "@SiddharthRout Thanks.  I figured the first example&#39; pattern would be more familiar to most readers."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472108495, "post_id": 39129198, "comment_id": 65621596, "body": "I left that <code>Excel</code> because from OP narrative couldn&#39;t be excluded that excel was being called from a client application.  Too bad it seems we&#39;re not likely to get feedback from Lauratoyos whatsoever...."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472108563, "post_id": 39129198, "comment_id": 65621649, "body": "@SiddharthRout, I agree with you about Thomas 2nd solution, may be because it&#39;s quite the same as mine!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472109520, "post_id": 39129198, "comment_id": 65622271, "body": "@user3598756 not quite the same as yours.  One of the OP&#39;s requirements were &quot;I am also going to need each of the elements in the array to be taken as doubles&quot;.  But again, that&#39;s just me being picky."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472109912, "post_id": 39129198, "comment_id": 65622513, "body": "OP&#39;s requirement furtherly specified <i>&quot;I need the array to preserve the decimal points&quot;</i> so that a <code>Variant</code> array approach would do. And anway  I dealt with any possible strictly <code>Double</code> part of the question reminding the user of the <code>CDbl()</code> function. This to say that I think the <i>core</i> of both our answers is the use of a <code>Variant</code> array"}, {"owner": {"reputation": 31, "user_id": 6752651, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WkyCKebLbOQ/AAAAAAAAAAI/AAAAAAAAAoU/PIbM3iYfviY/photo.jpg?sz=128", "display_name": "Lauratoyos", "link": "https://stackoverflow.com/users/6752651/lauratoyos"}, "edited": false, "score": 0, "creation_date": 1472142994, "post_id": 39129198, "comment_id": 65644532, "body": "Hi, I&#39;ve applied example 2 but i;m getting an array InputValues that is filled with zeros -- where am I going wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472143380, "post_id": 39129198, "comment_id": 65644743, "body": "Empty cells will show up as zeros.  Do you need to skip empty cells?"}, {"owner": {"reputation": 31, "user_id": 6752651, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WkyCKebLbOQ/AAAAAAAAAAI/AAAAAAAAAoU/PIbM3iYfviY/photo.jpg?sz=128", "display_name": "Lauratoyos", "link": "https://stackoverflow.com/users/6752651/lauratoyos"}, "edited": false, "score": 0, "creation_date": 1472147672, "post_id": 39129198, "comment_id": 65647099, "body": "Yeah, it&#39;s just that the code seems to be working, but it is not returning any results for some reason"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472148776, "post_id": 39129198, "comment_id": 65647733, "body": "<code>MsgBox WorksheetFunction.Sum(InputValues)</code> Insert this line after the <code>Next</code> to test it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1472061607, "last_edit_date": 1472061607, "creation_date": 1472058238, "answer_id": 39129198, "question_id": 39128530, "link": "https://stackoverflow.com/questions/39128530/define-array-to-obtain-data-from-range-as-double-var-type/39129198#39129198", "title": "Define array to obtain data from range as &quot;double&quot; var type", "body": "<p><code>Excel.ActiveWorkbook.</code> isn't needed in Excel, it is implied.  I didn't need to type cast the cell value <code>CDbl(.Cells(x, \"C\"))</code>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/UpE2S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UpE2S.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Example()\n    Dim InputValues() As Double\n    Dim lastRow As Long, x As Long\n\n    With Worksheets(\"Hoja1\")\n        lastRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n\n        ReDim InputValues(lastRow - 2)\n\n        For x = 2 To .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n            InputValues(x - 2) = CDbl(.Cells(x, \"C\"))\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This example is more efficient but won't make a noticeable difference unless you are working with a very large amount of data.</p>\n\n<pre><code>Sub Example2()\n    Dim InputValues() As Double, vInputValues As Variant\n    Dim x As Long\n\n    With Worksheets(\"Hoja1\")\n        vInputValues = .Range(\"C2\", .Range(\"C\" &amp; .Rows.Count).End(xlUp)).Value2\n\n        ReDim InputValues(UBound(vInputValues) - 1)\n\n        For x = 1 To UBound(vInputValues)\n            InputValues(x - 1) = CDbl(vInputValues(x, 1))\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1472061476, "last_edit_date": 1472061476, "creation_date": 1472060892, "answer_id": 39129906, "question_id": 39128530, "link": "https://stackoverflow.com/questions/39128530/define-array-to-obtain-data-from-range-as-double-var-type/39129906#39129906", "title": "Define array to obtain data from range as &quot;double&quot; var type", "body": "<p>In VBA you can assign <code>.Value</code> and <code>.Value2</code> arrays only to a <code>Variant</code>  </p>\n\n<p>As a side note if the range is formated as table, you can just do something like </p>\n\n<pre><code>Dim InputValues() ' As Variant by default\nInputValues = [transpose(Hoja1!Table1[Column3])] ' Variant(1 to number of rows in Table1)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6752651, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WkyCKebLbOQ/AAAAAAAAAAI/AAAAAAAAAoU/PIbM3iYfviY/photo.jpg?sz=128", "display_name": "Lauratoyos", "link": "https://stackoverflow.com/users/6752651/lauratoyos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1472061607, "creation_date": 1472055892, "last_edit_date": 1472056335, "question_id": 39128530, "link": "https://stackoverflow.com/questions/39128530/define-array-to-obtain-data-from-range-as-double-var-type", "title": "Define array to obtain data from range as &quot;double&quot; var type", "body": "<p>I'm fairly new to VBA, so please bear with me.\nI want to tell VBA to get an array from a range of cells. The user will paste a column of data into cell C2 so cells below C2 will be populated. The number of cells populated is up to the user.</p>\n\n<p>I am also going to need each of the elements in the array to be taken as doubles as I'm going to make operations with them. </p>\n\n<p>Therefore if the list is</p>\n\n<pre><code>1.2222\n2.4444\n3.5555\n</code></pre>\n\n<p>Then I need the array to preserve the decimal points.\nHow do I do this?\nThis is what I've got this fur, with no luck:</p>\n\n<pre><code>Set ThisWS = Excel.ActiveWorkbook.Worksheets(\"Hoja1\")\nDim InputValues() As Double 'Define Array\nDim LRow As Long             'Define length of array\nWith Sheets(\"Hoja1\")\n    LRow = .Range(\"C\" &amp; .Rows.count).End(xlUp).Row\nEnd With\nInputValues = ThisWS.Range(\"C2:C\" &amp; LRow).Value 'Error 13: data type doesn't match\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "barcode", "barcode-scanner"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1472054751, "post_id": 39128000, "comment_id": 65601807, "body": "You can always keep excel on top using APIS but AFAIK, You can&#39;t have 2 windows active at the same time in windows. The moment, you start browsing, excel will deactivate even while staying on top."}, {"owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "edited": false, "score": 2, "creation_date": 1472054854, "post_id": 39128000, "comment_id": 65601859, "body": "A helper program for redirecting the input from a specific usb-device might help, maybe combined with a virtual desktop solution so the window stays on top and the browser can stay on top on a second &quot;desktop&quot; too"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1472054944, "post_id": 39128000, "comment_id": 65601917, "body": "You can always keep a PC or a Tablet dedicated for the barcode application? Do you really need to browse at the same time?"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 2, "creation_date": 1472055326, "post_id": 39128000, "comment_id": 65602149, "body": "This <a href=\"http://stackoverflow.com/a/15686544/6608395\">link</a> might be of some help"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472056725, "post_id": 39128000, "comment_id": 65602959, "body": "Here&#39;s another solution: <a href=\"https://www.extendoffice.com/documents/excel/2030-keep-excel-window-on-top.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>. This will keep the window on top, but not necessarily active."}, {"owner": {"reputation": 23, "user_id": 6745402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/642800ee915f56e1446610873eb42b76?s=128&d=identicon&r=PG&f=1", "display_name": "Seanm", "link": "https://stackoverflow.com/users/6745402/seanm"}, "edited": false, "score": 0, "creation_date": 1472063164, "post_id": 39128000, "comment_id": 65606468, "body": "Siddharth, I may end having to get a dedicated PC or tablet, ultimately I am not sure which processor I would need (i5, i6, i7) and how many GbH (maybe above 3?), or GB (Maybe 12)? I would have up to 6 scanners scanning into a USB hub, at most all of the scans (6) might happen once every 30 seconds, mainly different allotments of 5 minute spans. Each is independent of the other, but I want the system to be able to handle up to 6 scans in less than one second from 6 scanners."}, {"owner": {"reputation": 23, "user_id": 6745402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/642800ee915f56e1446610873eb42b76?s=128&d=identicon&r=PG&f=1", "display_name": "Seanm", "link": "https://stackoverflow.com/users/6745402/seanm"}, "edited": false, "score": 0, "creation_date": 1472063525, "post_id": 39128000, "comment_id": 65606668, "body": "Michael, that is a great link! I am assuming I can look into C# and download a source and build a hook for say this  `  and have the barcode register as a ` and alert the excel window?   Ryan, thank you for the input!"}], "owner": {"reputation": 23, "user_id": 6745402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/642800ee915f56e1446610873eb42b76?s=128&d=identicon&r=PG&f=1", "display_name": "Seanm", "link": "https://stackoverflow.com/users/6745402/seanm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1472054322, "creation_date": 1472054322, "last_edit_date": 1531164843, "question_id": 39128000, "link": "https://stackoverflow.com/questions/39128000/possible-to-keep-excel-file-as-active-window-even-if-i-am-scrolling-through-the", "title": "Possible to keep excel file as active window even if I am scrolling through the internet - VBA", "body": "<p>I have recently completed a wonderful barcode system which uses wired scanners. They scan into an ActiveX textbox in excel and use the barcode value to look at a series of cases to perform functions before blanking out the textbox for the next entry.</p>\n\n<p>I must have the excel window selected at all times in order for the barcode scan to work. If I am not in the excel window and active the scan will not register. I must purchase another computer if i cant get this done! Not a big deal, but money is money.</p>\n\n<p>I have no python, or other experience. It seems like this thread might be of some help.\n<a href=\"https://stackoverflow.com/questions/17823874/can-i-keep-the-terminal-as-the-active-window-even-if-its-in-the-background\">Python and keeping excel barcode active link</a></p>\n\n<p>I know SAS, VBA, and some SQL. That's about it</p>\n\n<p>Any help or insight would be magnificent!</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10668, "user_id": 3000179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8c01224502223a420219f7f3531505d?s=128&d=identicon&r=PG", "display_name": "\u02b0\u1d48\u02d1", "link": "https://stackoverflow.com/users/3000179/%ca%b0%e1%b5%88%cb%91"}, "edited": false, "score": 0, "creation_date": 1472054616, "post_id": 39127996, "comment_id": 65601723, "body": "Ok - what have you attempted?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472056822, "post_id": 39127996, "comment_id": 65603020, "body": "Conditional Formatting?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1472062072, "post_id": 39127996, "comment_id": 65605851, "body": "you need 2 levels of conditionnal formatting. One to check if the value is the same as the previous value, and one to check what kind of conditionnal formatting has been used last. your question,s formulation is very hard to understand, as you can see both answers don&#39;t really address the 2 sides of the question. You should add a screenshot of what you want to happen."}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1472069013, "post_id": 39128894, "comment_id": 65609568, "body": "After seeing Tim Williams answer, I reread the question and realized my answer may not fully answer the question. Tim&#39;s does exactly what the question asks, I think..."}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1472057638, "last_edit_date": 1472057638, "creation_date": 1472057132, "answer_id": 39128894, "question_id": 39127996, "link": "https://stackoverflow.com/questions/39127996/change-cell-color-when-not-equal-previous-cell/39128894#39128894", "title": "Change cell color when not equal previous cell", "body": "<p>I believe the answer to your question can be found with Conditional Formatting. </p>\n\n<p>Select the range you want to apply the Conditional Formatting to.\nOn the Home tab, click on Conditional Formatting > New Rule. \nOn the New Formatting Rule pop-up, select the rule type \"Format only cells that contain\"\nEdit the rule to have the following:</p>\n\n<p>Cell Value > Not Equal To > =INDIRECT(ADDRESS(ROW()-1,COLUMN()))</p>\n\n<p>Change your format to whichever you desire.\n<a href=\"http://i.stack.imgur.com/KcFs5.png\" rel=\"nofollow\">Here is a picture of what you should be looking at</a></p>\n\n<p>To make the cells automatically color themselves if they equal the above, make another rule for the column following the same steps, using the same equation, but instead set the modifer to Equal To.</p>\n\n<p>Your rules in the Conditional Formatting Rules page would look <a href=\"http://i.stack.imgur.com/Gvs68.png\" rel=\"nofollow\">like this.</a></p>\n\n<p>Cheers!</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1472083045, "last_edit_date": 1472083045, "creation_date": 1472061352, "answer_id": 39130030, "question_id": 39127996, "link": "https://stackoverflow.com/questions/39127996/change-cell-color-when-not-equal-previous-cell/39130030#39130030", "title": "Change cell color when not equal previous cell", "body": "<ol>\n<li>Select the cells to be formatted (here it's A2:A15)</li>\n<li><p>Add a formula-based Conditional Formatting rule using the formula:</p>\n\n<p><code>=MOD(SUM((A$2:A2&lt;&gt;A$1:A1)*1),2)=0</code>  </p></li>\n</ol>\n\n<p>Adjust the formula to suit your actual range, and make sure the top cell is the \"active\" one (select the range from the top down, not from the bottom up) when applying the format: that way the formula will adjust correctly for the rest of the cells getting the format.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XeKgk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XeKgk.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 4414266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e11ea462534cc3b01ff892a7f05584?s=128&d=identicon&r=PG&f=1", "display_name": "Ferg", "link": "https://stackoverflow.com/users/4414266/ferg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4240, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472083045, "creation_date": 1472054308, "question_id": 39127996, "link": "https://stackoverflow.com/questions/39127996/change-cell-color-when-not-equal-previous-cell", "title": "Change cell color when not equal previous cell", "body": "<p>Looking for a way to change cell color and font when the cell value differs from the value in the previous cell.  Sounds easy, but there is a twist.\nIf the value in A2 is not equal to the value in A1, I want to change the cell/font colors in cell A2, for example, fill the cell with blue and change font to white, bold.   Then, as the formula/macro progresses through the rows, and eventually finds that another cell has a value that is not equal to the preceding cell, say A12 is not equal to A11, I want to change the fill/font colors for A12.  I want to essentially flip-flop the fill/font colors when the not equal condition occurs.  Say I set the fill/font on A1 as Blue/white-bold.\nWhen the first not equal condition occurs, I change the fill/font in A? to light-red/black-bold.  Then, on the next not equal condition, change the fill/font for that cell back to the original values, Blue/white-bold. </p>\n"}, {"tags": ["vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6753394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7334076d536c2eff94e254ff638a33?s=128&d=identicon&r=PG&f=1", "display_name": "P.Kechichian", "link": "https://stackoverflow.com/users/6753394/p-kechichian"}, "edited": false, "score": 0, "creation_date": 1472128956, "post_id": 39128867, "comment_id": 65635093, "body": "Thanks for the edit but it still returns the same result. Instead of applying the rows.count to the entire column &quot;D&quot;, would it be possible to apply it only on a range (in this case &quot;D4:D34&quot;). The sheet is composed of 4 tables, of which the 2 first are empty (where I need to enter the values) and the 2 last are filled with formulas, and I think this is the problem. I can also create a new sheet where I would use your formula and then transfer to this sheet, but I&#39;m sure a better way exists :) I will make sure to improve my posting skills, sorry for that ! Thanks again !"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 15, "user_id": 6753394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7334076d536c2eff94e254ff638a33?s=128&d=identicon&r=PG&f=1", "display_name": "P.Kechichian", "link": "https://stackoverflow.com/users/6753394/p-kechichian"}, "edited": false, "score": 0, "creation_date": 1472131221, "post_id": 39128867, "comment_id": 65636695, "body": "What&#39;s &quot;the same result&quot;? Be detailed in describing both starting data and corresponding results."}, {"owner": {"reputation": 15, "user_id": 6753394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7334076d536c2eff94e254ff638a33?s=128&d=identicon&r=PG&f=1", "display_name": "P.Kechichian", "link": "https://stackoverflow.com/users/6753394/p-kechichian"}, "edited": false, "score": 0, "creation_date": 1472134704, "post_id": 39128867, "comment_id": 65639135, "body": "Data is still inserted in &quot;D143&quot; instead of &quot;D4&quot;"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1472109299, "last_edit_date": 1472109299, "creation_date": 1472057038, "answer_id": 39128867, "question_id": 39127972, "link": "https://stackoverflow.com/questions/39127972/vba-how-to-insert-vlookup-value-in-the-first-empty-cell-row/39128867#39128867", "title": "VBA: How to insert Vlookup value in the first empty cell/row", "body": "<p><strong>edited</strong> after OP clarifications</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim book2namepath As String\n    Dim searchrange As Range\n\n    book2namepath = \"C:\\Users\\pkechichian\\Documents\\Revamp\\Micros_export.xlsm\"\n    Set searchrange = Workbooks.Open(book2namepath).Sheets(\"Accpac\").Range(\"E:H\") '&lt;-- set range directly at workbook opening\n    With ThisWorkbook.Sheets(\"Actual\") '&lt;--| refer to \"destination\" sheet\n        .Cells(.Rows.Count, \"D\").End(xlUp).Offset(1).value = Application.VLookup(.Cells(2, 4).value, searchrange, 3, False) '&lt;--| write lookup value in first empty cell below in column \"D\"\n    End With\n    ActiveWorkbook.Close False '&lt;--| close opened workbook without saving changes\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472109531, "post_id": 39130642, "comment_id": 65622278, "body": "given your data structure the code can be simpler: see edited answer and please mark it as accepted if it fulfills your question. BTW to reply to any answer you should add comments right below it while for enhancing your question (e.g.: to add a screenshot or else) you should edit your question itself. In any case never post a new answer unless you&#39;re posting an <i>actual</i> answer to your question!"}], "tags": [], "owner": {"reputation": 15, "user_id": 6753394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7334076d536c2eff94e254ff638a33?s=128&d=identicon&r=PG&f=1", "display_name": "P.Kechichian", "link": "https://stackoverflow.com/users/6753394/p-kechichian"}, "is_accepted": false, "score": 0, "last_activity_date": 1472063518, "creation_date": 1472063518, "answer_id": 39130642, "question_id": 39127972, "link": "https://stackoverflow.com/questions/39127972/vba-how-to-insert-vlookup-value-in-the-first-empty-cell-row/39130642#39130642", "title": "VBA: How to insert Vlookup value in the first empty cell/row", "body": "<p>Thanks for the quick answer! It works fine except that the value is not inserted at the right place. I've added some images to give you a better idea.</p>\n\n<p><a href=\"http://i.stack.imgur.com/OUuh5.png\" rel=\"nofollow\">The value should be inserted in \"D4\"</a>\n<a href=\"http://i.stack.imgur.com/rMnMn.png\" rel=\"nofollow\">This is where the value is inserted</a></p>\n"}], "owner": {"reputation": 15, "user_id": 6753394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7334076d536c2eff94e254ff638a33?s=128&d=identicon&r=PG&f=1", "display_name": "P.Kechichian", "link": "https://stackoverflow.com/users/6753394/p-kechichian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 39128867, "answer_count": 2, "score": 0, "last_activity_date": 1472109299, "creation_date": 1472054244, "last_edit_date": 1472054387, "question_id": 39127972, "link": "https://stackoverflow.com/questions/39127972/vba-how-to-insert-vlookup-value-in-the-first-empty-cell-row", "title": "VBA: How to insert Vlookup value in the first empty cell/row", "body": "<p>I'm trying to insert a Vlookup value in the first empty cell/row. \nHere's my code</p>\n\n<pre><code>Dim lookfor As Range\nDim searchrange As Range\nDim book1 As Workbook\nDim book2 As Workbook\nDim book2name As String\n\nbook2name = \"Micros_export.xlsm\"\n\nDim book2namepath As String\n\nbook2namepath = \"C:\\Users\\pkechichian\\Documents\\Revamp\\Micros_export.xlsm\"\n\nSet book1 = ThisWorkbook\nSet book2 = Workbooks.Open(book2namepath)\nSet lookfor = book1.Sheets(\"Actual\").Cells(2, 4)\nSet searchrange = book2.Sheets(\"Accpac\").Range(\"E:H\")\n\nlookfor.Offset(2, 0).End(xlDown).Value = Application.VLookup(lookfor, searchrange, 3, False)\n</code></pre>\n\n<p>Thanks for the help and sorry for the formatting !</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 1, "creation_date": 1472055358, "post_id": 39127825, "comment_id": 65602167, "body": "If it takes the program 1 hour to run, it means it produces 150 new records per second. Considering these are expensive operations, it&#39;s not surprising that the program takes a long time to finish. I doubt there&#39;s much you can do about it, except perhaps only to query fewer records, rather than all records, in the first <code>SQLStr</code> statement. That is, if it&#39;s desirable to do so."}, {"owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1472055525, "post_id": 39127825, "comment_id": 65602280, "body": "Thank you for you answer. Actually, I will be moving this code to VB.NET later on, and I was wondering if it will run faster."}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 1, "creation_date": 1472056220, "post_id": 39127825, "comment_id": 65602680, "body": "You can try adding the records in one giant statement, not sure if it&#39;ll be faster though.  IE:  <code>INSERT INTO MyTable (Name, ID) VALUES (&#39;First&#39;,1), (&#39;Second&#39;,2), (&#39;Third&#39;,3), (&#39;Fourth&#39;,4)</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1472056336, "post_id": 39127825, "comment_id": 65602743, "body": "If I found out my mortgage provider wasn&#39;t <a href=\"http://stackoverflow.com/documentation/vba/3578/working-with-ado/12354/creating-parametrized-commands#t=201608241631374408866\">using parameterized queries</a>, I&#39;d refinance with another vendor."}, {"owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "edited": false, "score": 1, "creation_date": 1472056691, "post_id": 39127825, "comment_id": 65602941, "body": "I have replaced the 540k INSERTs with only 3k INSERT by concatenating the for loop string (One single INSERT for every for loop), and it&#39;s already running faster (13 minutes), I wonder if I can go further."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472060458, "post_id": 39127825, "comment_id": 65604991, "body": "If only we can see those calculations. If they involve basic operations (Division, Multiplication, Add, Subtract), you can have SQL Server do it all without looping! Unfortunately, you leave those formulas <i>startingBalance</i>, <i>principal</i>, <i>interestPaymentBT</i>, etc. out."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472060930, "post_id": 39127825, "comment_id": 65605229, "body": "Another thought is perhaps wrapping all the Inserts into a transaction. That way you are writing the data all at one time. More info: <a href=\"https://msdn.microsoft.com/en-us/library/aa227162(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa227162(v=vs.60).aspx</a>"}, {"owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "edited": false, "score": 0, "creation_date": 1472143316, "post_id": 39127825, "comment_id": 65644712, "body": "To sum up : parameterized queries is slow for 500K queries, so is using addNew intead of INSERTs or transactions. Concatenating every 100 or 200 records into one INSERT was the fastest I could achieve."}, {"owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472199628, "post_id": 39127825, "comment_id": 65666308, "body": "@Parfait can you check this other question please ? <a href=\"http://stackoverflow.com/questions/39161564/sql-query-to-generate-multiple-records-from-every-record-of-a-table\" title=\"sql query to generate multiple records from every record of a table\">stackoverflow.com/questions/39161564/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "edited": false, "score": 0, "creation_date": 1472117032, "post_id": 39128488, "comment_id": 65627096, "body": "The code ran 30% faster after doing this. Thank you for you answer."}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": true, "score": 1, "last_activity_date": 1472055774, "creation_date": 1472055774, "answer_id": 39128488, "question_id": 39127825, "link": "https://stackoverflow.com/questions/39127825/excel-vba-to-access-sql-server-tables-for-selecting-and-inserting-is-too-slow/39128488#39128488", "title": "Excel-VBA to access sql server tables for selecting and inserting is too slow", "body": "<p>I'm speaking a bit out of my comfort range here, but what I see is that the cn.execute statement creates a recordset that you never actually use (rs2).  According to the MSDN reference on the ADO Execute Method, you can use an option (adExecuteNoRecords ) to stop the creation of the recordset when you do the insert.  Maybe that would speed it up a bit?</p>\n"}], "owner": {"reputation": 616, "user_id": 3557757, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wVg8M.jpg?s=128&g=1", "display_name": "Naucle", "link": "https://stackoverflow.com/users/3557757/naucle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 39128488, "answer_count": 1, "score": 0, "last_activity_date": 1472060237, "creation_date": 1472053744, "last_edit_date": 1531164843, "question_id": 39127825, "link": "https://stackoverflow.com/questions/39127825/excel-vba-to-access-sql-server-tables-for-selecting-and-inserting-is-too-slow", "title": "Excel-VBA to access sql server tables for selecting and inserting is too slow", "body": "<p>I have written an Excel-VBA code to access a SQL Server database (which is in the network, not my computer), which has a table with 10 columns and around 3000 records (basically mortgages). </p>\n\n<p>The code loops through these records, and for each one : does some basic calculations to produce around 180 records (an amortization table for each mortgage), and then inserts them in a new table (Around 540000 records in total).</p>\n\n<p>It goes like this (I used comments for readability and avoiding a big code here):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub amortizationScheduleToSQLServer()\n\n        'Some calculation variables go here\n\n        Dim cn As ADODB.Connection\n        Dim rs As ADODB.Recordset\n        Dim rs2 As ADODB.Recordset\n\n        Set cn = New ADODB.Connection\n        Set rs = New ADODB.Recordset\n        Set rs2 = New ADODB.Recordset\n\n        Server_Name = \"...\"\n        Database_Name = \"...\"\n        cn.Open \"PROVIDER=SQLOLEDB;DATA SOURCE=\" &amp; Server_Name &amp; \";INITIAL CATALOG=\" &amp; Database_Name &amp; \";Integrated Security=SSPI;\"\n        SQLStr = \"SELECT * FROM TABLE_PRETS\"\n        Set rs = cn.Execute(SQLStr)\n\n        If Not (rs.EOF And rs.BOF) Then\n            rs.MoveFirst\n            Do Until rs.EOF = True\n\n                'Assigning data from table to variables here\n\n                'Basic multiplications here, nothing heavy\n\n                For i = 1 To paymentsNumber\n\n                    'More basic calculations and assigning here\n\n                    SQLStr = \"INSERT INTO TABLE_AMORTISSEMENT (N_CONTRAT,MOIS,DATE_ECHEANCE,MENSUALITE,SOLDE_DEPART,CAPITAL_AMORTI,\" _\n                        &amp; \"INTERET_HT,TVA,ASSURANCE,CAPITAL_RESTANT)\" _\n                        &amp; \"VALUES (\" &amp; loanID &amp; \", \" &amp; i &amp; \", '\" &amp; DateAdd(\"m\", i, startDate) &amp; \"', \" &amp; Replace(monthlyPayment, \",\", \".\") &amp; \", \" _\n                        &amp; Replace(startingBalance, \",\", \".\") &amp; \", \" &amp; Replace(principal, \",\", \".\") &amp; \", \" &amp; Replace(interestPaymentBT, \",\", \".\") _\n                        &amp; \", \" &amp; Replace(taxOnInterest, \",\", \".\") &amp; \", \" &amp; Replace(insurancePayment, \",\", \".\") &amp; \", \" _\n                        &amp; Replace(remainingBalance, \",\", \".\") &amp; \");\"\n                    Set rs2 = cn.Execute(SQLStr)\n                Next i\n\n                rs.MoveNext\n            Loop\n        Else\n            MsgBox \"There are no records in the recordset.\"\n        End If\n\n        MsgBox \"Finished looping through records. \"\n\n        If rs.State = 1 Then\n            rs.Close\n            Set rs = Nothing\n        End If\n\n        If rs2.State = 1 Then\n            rs2.Close\n            Set rs2 = Nothing\n        End If\n\n        If cn.State = 1 Then\n            cn.Close\n            Set cn = Nothing\n        End If\n\n    End Sub\n</code></pre>\n\n<p>I timed this code after omitting the INSERT by deleting this line : </p>\n\n<blockquote>\n  <p>Set rs2 = cn.Execute(SQLStr)</p>\n</blockquote>\n\n<p>The code basically loops through 3000 records and makes unused Strings, <strong>it runs for around 9 seconds</strong>. (I don't know if this is acceptable for Excel-VBA/SQL Server).</p>\n\n<p>But putting back the INSERT execution line makes the code run for +1 hour to make the 540000 records table. Is this normal ? How can I optimize this code ?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472058517, "post_id": 39127550, "comment_id": 65603930, "body": "try FileCopy source, destination"}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472059451, "post_id": 39127550, "comment_id": 65604428, "body": "The documentation says that doesn&#39;t work with a file open at all, shared or exclusive, but will give it a try."}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472060604, "post_id": 39127550, "comment_id": 65605057, "body": "Documentation appears to be right; FileCopy doesn&#39;t work with any open file."}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472060980, "post_id": 39127550, "comment_id": 65605256, "body": "try the methods with windows api calls described here <a href=\"https://support.microsoft.com/en-us/kb/172711\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/172711</a> down the page. there is 2 methods, you can try both, one is using windows api and the other one uses MS-DOS"}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472061560, "post_id": 39127550, "comment_id": 65605580, "body": "Thanks, Sol.  I&#39;d seen that article, and thought its CopyFile method was the same as mine; these are different beasts?  I was going to hold off a bit for another answer before I tried the DOS method, as I haven&#39;t used the shell function yet, but guess I&#39;ll try that now."}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 1, "creation_date": 1472061898, "post_id": 39127550, "comment_id": 65605759, "body": "the CopyFile method that is being described in that article is a windows api call, Declare Function apiCopyFile Lib &quot;kernel32&quot; Alias &quot;CopyFileA&quot; _       (ByVal lpExistingFileName As String, _       ByVal lpNewFileName As String, _       ByVal bFailIfExists As Long) As Long i think it uses a different approach then what your code does, i am not 100% sure on that, but its worth a try."}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472062377, "post_id": 39127550, "comment_id": 65606013, "body": "The DOS method behaves exactly like CopyFile: works for a shared-mode .accdb file but not one opened in exclusive mode.  I haven&#39;t understood what API calls are about, so I guess it&#39;s time."}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472063627, "post_id": 39127550, "comment_id": 65606727, "body": "With that link&#39;s API call, keep getting &quot;invalid outside procedure&quot; error, but considering that&#39;s an archived 1995 article, probably unsurprising."}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472064499, "post_id": 39127550, "comment_id": 65607227, "body": "whats your pc spec? 64bit?"}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 1, "creation_date": 1472065278, "post_id": 39127550, "comment_id": 65607661, "body": "i have tested it on a Windows10 machine using access2007 with a Northwind sample database open and it worked, here is my code i used."}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472065313, "post_id": 39127550, "comment_id": 65607673, "body": "Option Explicit        Declare Function apiCopyFile Lib &quot;kernel32&quot; Alias &quot;CopyFileA&quot; _       (ByVal lpExistingFileName As String, _       ByVal lpNewFileName As String, _       ByVal bFailIfExists As Long) As Long"}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472065339, "post_id": 39127550, "comment_id": 65607686, "body": "and then          Sub CopyFile(SourceFile As String, DestFile As String)        &#39;-----------------------------------------------------------&zwnj;&#8203;----         Dim Result As Long          If Dir(SourceFile) = &quot;&quot; Then             MsgBox Chr(34) &amp; SourceFile &amp; Chr(34) &amp; _                &quot; is not valid file name.&quot;          Else             Result = apiCopyFile(SourceFile, DestFile, False)          End If       End Sub"}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472065365, "post_id": 39127550, "comment_id": 65607698, "body": "Public Sub test()  CopyFile &quot;C:\\Users*****\\Documents\\Northwind.accdb&quot;, &quot;C:\\Test\\Northwind.accdb&quot; MsgBox &quot;done&quot;  End Sub"}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472067803, "post_id": 39127550, "comment_id": 65608934, "body": "Yes, 64 bit, cool, I&#39;ll try that out.  But you know, I&#39;ve been reading how it&#39;s not a great idea to copy an open file.  I&#39;ve done it a bunch with no problems, but it&#39;s probably best I switch gears and write a batch file that copies the file while closed, then opens the database in exclusive mode.  It&#39;s still curious to me that this CopyFile behavior is not documented anywhere that I can find; seems a major thing many would like to know who are writing backup utilities."}, {"owner": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472145085, "post_id": 39127550, "comment_id": 65645679, "body": "any update on what helped?"}, {"owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "reply_to_user": {"reputation": 626, "user_id": 2457865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6f08bd4cb3d66d307846a706da2ae43?s=128&d=identicon&r=PG", "display_name": "Sol Stein", "link": "https://stackoverflow.com/users/2457865/sol-stein"}, "edited": false, "score": 0, "creation_date": 1472249920, "post_id": 39127550, "comment_id": 65692937, "body": "What helped?  Giving up!  I admit I didn&#39;t keep working on that API call.  Maybe it&#39;s a sour grapes thing, but I switched to an external batch file copying a closed file.  Although this may end up being problematic, as my company is about to take away administrator rights from everyone on their own PC, and can&#39;t tell me if that will affect batch files.  For that reason I&#39;d still like to have the answer to this in my back pocket in case I need it.  If that comes I&#39;ll keep debugging the API call.  Thanks so much for brainstorming with me, Sol, it really helps."}], "owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1472053391, "creation_date": 1472052899, "last_edit_date": 1472053391, "question_id": 39127550, "link": "https://stackoverflow.com/questions/39127550/copyfile-of-current-project-that-works-in-shared-mode-gives-permission-denied", "title": "Copyfile of current project that works in shared mode gives &quot;Permission denied&quot; in exclusive mode", "body": "<p>The following is a greatly stripped-down version of some Access 2013 code which simply makes a copy of the current project under a new name.</p>\n\n<p>It works only if the file is open in shared mode.  If open in exclusive mode, this generates a \"Permission denied\" error.</p>\n\n<pre><code>Private Sub TestCopy()\n\n    Dim sSourceFile, sSourcePath, sTargetFile, sTargetPath As String\n    Dim AccessObj As Object\n\n    sSourceFile = CurrentProject.Name\n    sSourcePath = CurrentProject.Path\n    sTargetFile = \"TestCopy.accdb\"\n    sTargetPath = CurrentProject.Path\n\n    Set AccessObj = CreateObject(\"Scripting.FileSystemObject\")\n    AccessObj.CopyFile sSourcePath &amp; \"\\\" &amp; sSourceFile, sTargetPath &amp; \"\\\" &amp; sTargetFile, True\n    Set AccessObj = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I'm surprised my research doesn't explain this.  Is there another file copying method I can use within a database open in exclusive mode?  Or do I need a method that runs outside the database?</p>\n"}, {"tags": ["vba", "excel", "highlight", "string-comparison"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 2, "creation_date": 1472052839, "post_id": 39127287, "comment_id": 65600556, "body": "How many records do you have? More than 10000 and your method of finding the last row will fail (meaning you never enter the loops). Prefer something like <code>Cells(Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1472061170, "post_id": 39127287, "comment_id": 65605365, "body": "The Sht1LastRow and Sht2LastRow both get the proper values, the row number with the last entry of the sheet. the Internal report has 70k records and Sht2LastRow, when hovered over in debug mode, displays the correct number of the last row."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472056649, "post_id": 39128450, "comment_id": 65602924, "body": "Nice breakdown +1.  I liked how you used variables make the <code>If</code>statement  more readable.  You missed <code>Rows(&quot;iDeposits:iDeposits&quot;)</code>.   The <code>Instr() &lt;&gt; 0</code> is common practice.  I sure that it wouldn&#39;t any difference here but I read somewhere that <code>&lt;&gt;</code> evaluates faster then using <code>&gt;</code>."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1472060851, "post_id": 39128450, "comment_id": 65605182, "body": "I like descriptive variable names. It makes reading my spaghetti code so much easier 5 months from now. :) Interesting note about <code>&gt;</code> vs <code>&lt;&gt;</code>. I tried to test it by looping through a 50 million element array of random characters, but <code>Now</code> doesn&#39;t offer enough granularity and 5 billion crashed my PC. Not that nanoscale efficiency is a primary feature sought by VBA developers... I meant to mention the concatenation issues after the If...Then, but my boss thinks I should do real work sometimes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472062195, "post_id": 39128450, "comment_id": 65605930, "body": "Lol..bosses really get in the way.  I wish I knew where I read about <code>&lt;&gt;</code> versus <code>&gt;</code>.  You can use <code>Timer</code> to measure millisecond.  The basic pattern is <code>Dim Start : Start = Timer : &#39;Do Something : Debug.Print &quot;Execution Time:&quot;; Timer - Start</code>"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1472055702, "creation_date": 1472055702, "answer_id": 39128450, "question_id": 39127287, "link": "https://stackoverflow.com/questions/39127287/compare-values-across-two-sheets-highlight-similarities-runs-but-doesnt-work/39128450#39128450", "title": "Compare values across two sheets, highlight similarities, Runs but doesnt work", "body": "<p>If you substitute variables for the long sheet.cell.value references, you'll find your error (and see that you are making extraneous comparisons)</p>\n\n<pre><code>Dim TransDate As String\nDim TransAmt As Long\nDim PBINSDate As String\nDim PBINSAmt As Long\n\nTransDate = Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value\nPBINSDate = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value\nTransAmt = Sheets(\"Deposits And Credits\").Cells(iDeposits, 3).Value\n\n    If TransDate = PBINSDate _\n    And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &gt; 0 _\n    And TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 2) _\n    Or TransDate = PBINSDate _\n    And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &gt; 0 _\n    And TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 15) _\n    Then\n        Sheets(\"Deposits And Credits\").Cells(iDeposits, 12).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Address(1, 1, 1, 1) And Sheets(\"Deposits And Credits\").Rows(\"iDeposits:iDeposits\").Select\n            With Selection.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 5296274\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n    End If\n</code></pre>\n\n<p>We really don't need to search the same string for the same value twice: <code>InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &gt; 0</code> We also don't need to check if the dates match more than once: `TransDate = PBINSDate' Let's get rid of the extras and see what it looks like.</p>\n\n<pre><code>    If TransDate = PBINSDate _ \n    And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &gt; 0 _\n    And TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 2) _\n    And TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 15) _\n    Then\n</code></pre>\n\n<p>Going back to your criteria and fixing the <code>AND</code>s and <code>OR</code>s:</p>\n\n<pre><code>    'The Dates must match\n    If TransDate = PBINSDate _\n    'The descriptor must be found in the statement line item\n    And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &gt; 0 _\n    'The statement amount should match either column 2 OR column 15\n    And (TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 2) _\n         Or _\n         TransAmt = Sheets(\"June PB INS\").Cells(iPBINS, 15) _\n    ) _\n    Then\n</code></pre>\n\n<p>Another issues I'll point out: </p>\n\n<p>InStr returns the starting position of the needle in the haystack or 0 if its not found. Thus, <code>Instr(\"abcde\",\"c\",1)</code> retruns <code>3</code>. When using this as a logical operator, you only need to check if the value is greater than 0.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "edited": false, "score": 0, "creation_date": 1472064203, "post_id": 39128527, "comment_id": 65607051, "body": "Thanks a lot. I used this as a template and then used Tim&#39;s If statement."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1472056750, "last_edit_date": 1472056750, "creation_date": 1472055874, "answer_id": 39128527, "question_id": 39127287, "link": "https://stackoverflow.com/questions/39127287/compare-values-across-two-sheets-highlight-similarities-runs-but-doesnt-work/39128527#39128527", "title": "Compare values across two sheets, highlight similarities, Runs but doesnt work", "body": "<p>Adding parenthesis will make your <code>If</code> statement work.</p>\n\n<pre><code>If (Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 And Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 2)) Or (Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 And Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 15)) Then\n\nEnd If\n</code></pre>\n\n<p>There is no need to repeat the conditions the <code>If</code> statement just group the <code>Or</code> conditions together and enclose them in parenthesis.</p>\n\n<pre><code>If Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 And (Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 2) Or Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 15)) Then\n\nEnd If\n</code></pre>\n\n<p>I would prefer to break the <code>If</code> statement into two statements to make it more readable.</p>\n\n<pre><code>If Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 Then\n    If Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 2) Or Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 15) Then\n\n    End If\nEnd If\n</code></pre>\n\n<p>You shouldn't concatenate lines of code like this:</p>\n\n<p><code>Sheets(\"Deposits And Credits\").Cells(iDeposits, 12).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Address(1, 1, 1, 1) And Sheets(\"Deposits And Credits\").Rows(\"iDeposits:iDeposits\").Select</code></p>\n\n<p>Incorrect: </p>\n\n<p><code>Sheets(\"Deposits And Credits\").Rows(\"iDeposits:iDeposits\").Select</code></p>\n\n<p>Correct: </p>\n\n<p><code>Sheets(\"Deposits And Credits\").Rows(iDeposits &amp; \":\" &amp; iDeposits\").Select</code></p>\n\n<hr>\n\n<p>I would prefer to shorten the variable names.  Like this:</p>\n\n<pre><code>Sub HighlightMatches()\n    Dim wsPB As Worksheet\n\n    Dim lastrow As Long\n    Dim x2 As Long, x2count As Long, x1 As Long, x1count As Long\n\n    Set wsPB = Sheets(\"June PB INS\")\n    With Sheets(\"Deposits And Credits\")\n\n        For x1 = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n\n            For x2 = 2 To wsPB.Cells(Rows.Count, 1).End(xlUp).Row\n                If .Cells(x1, 1).Value = wsPB.Cells(x2, 1).Value And InStr(1, wsPB.Cells(x2, 3).Value, .Cells(x1, 7).Value, vbTextCompare) &lt;&gt; 0 Then\n\n                    If .Cells(x1, 3) = wsPB.Cells(x2, 2) Or .Cells(x1, 3) = wsPB.Cells(x2, 15) Then\n\n                        .Cells(x1, 12).Value = wsPB.Cells(x2, 1).Address(True, True, xlA1, True)\n                        With .Rows(x1).Interior\n                            .Pattern = xlSolid\n                            .PatternColorIndex = xlAutomatic\n                            .Color = 5296274\n                            .TintAndShade = 0\n                            .PatternTintAndShade = 0\n                        End With\n\n                    End If\n                End If\n            Next x2\n        Next x1\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "is_accepted": false, "score": 1, "last_activity_date": 1472064281, "creation_date": 1472064281, "answer_id": 39130867, "question_id": 39127287, "link": "https://stackoverflow.com/questions/39127287/compare-values-across-two-sheets-highlight-similarities-runs-but-doesnt-work/39130867#39130867", "title": "Compare values across two sheets, highlight similarities, Runs but doesnt work", "body": "<p>Here is the Code I ended up with, Decided to ditch the match string portion</p>\n\n<pre><code>Sub StackCombined()\n\nDim TransDate As String\nDim TransAmt As Long\nDim PBINSDate As String\nDim PBINSAmt As Long\n\nDim wsPB As Worksheet\nDim Sht1LastRow As Long, Sht2LastRow As Long\nDim x2 As Long, x2count As Long, x1 As Long, x1count As Long\n' Sht1LastRow finds the last row of Deposits and Credits with a value\nSht1LastRow = Sheets(\"Deposits And Credits\").Cells(10000, 1).End(xlUp).Row\n' Sht2LastRow finds the last row of June PB INS with a value\nSht2LastRow = Sheets(\"June PB INS\").Cells(100000, 1).End(xlUp).Row\n\n' Call worksheet June PB INS just wsPB\nSet wsPB = Sheets(\"June PB INS\")\nWith Sheets(\"Deposits And Credits\")\n\n    For x1 = 2 To Sht1LastRow\n\n        For x2 = 2 To Sht2LastRow\n            'TransDate is the transaction date recorded from the bank\n            TransDate = Sheets(\"Deposits And Credits\").Cells(x1, 1).Value\n            'PBINSDate is the transaction date recorded internally through EPIC\n            PBINSDate = Sheets(\"June PB INS\").Cells(x2, 1).Value\n            'TransAmt is the bank statements amount of the transaction\n            TransAmt = Sheets(\"Deposits And Credits\").Cells(x1, 3).Value\n\n                'The Dates must match\n                'The amount must either column 2, single record, OR column 15, daily record\n                'if these two conditions are met, highlight the bank statement and record where the match was found\n                If TransDate = PBINSDate _\n                And (TransAmt = Sheets(\"June PB INS\").Cells(x2, 2) _\n                    Or _\n                    TransAmt = Sheets(\"June PB INS\").Cells(x2, 15) _\n                ) _\n                Then\n                    .Cells(x1, 12).Value = wsPB.Cells(x2, 1).Address(True, True, xlA1, True) And Sheets(\"Deposits And Credits\").Rows(x1 &amp; \":\" &amp; x1).Select\n                       With Selection.Interior\n                          .Pattern = xlSolid\n                          .PatternColorIndex = xlAutomatic\n                          .Color = 5296274\n                          .TintAndShade = 0\n                          .PatternTintAndShade = 0\n                      End With\n               End If\n        Next x2\n    Next x1\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39128527, "answer_count": 3, "score": 1, "last_activity_date": 1472064281, "creation_date": 1472052078, "last_edit_date": 1472052377, "question_id": 39127287, "link": "https://stackoverflow.com/questions/39127287/compare-values-across-two-sheets-highlight-similarities-runs-but-doesnt-work", "title": "Compare values across two sheets, highlight similarities, Runs but doesnt work", "body": "<p>OK so I am doing a bank rec, I have one worksheet (\"Deposits and Credits\"), the bank statement, which I am comparing to an internally created report (\"June PB INS\"). </p>\n\n<p>For each item in the bank statement, I am searching in the internal report for a row that has matching date (column 1), contains the company descriptor (string1), and matches the amount (column 3 in the bank statement, column 2 OR column 15 in the internal report). </p>\n\n<p>If there is a match I want to highlight the row in the bank statement worksheet and I want to mark in column 7 the address of the internal report row that matches. </p>\n\n<p>the Code seemingly has no flaws but doesn't make any of the changes.</p>\n\n<pre><code>Option Compare Text\n\nSub HighlightMatches()\nDim Sht1LastRow As Long, Sht2LastRow As Long\nDim lastrow As Long\nDim iPBINS As Long, iPBINScount As Long, iDeposits As Long, iDepositscount As Long\nDim string1 As Variant\n\nSht1LastRow = Sheets(\"Deposits And Credits\").Cells(10000, 1).End(xlUp).Row\nSht2LastRow = Sheets(\"June PB INS\").Cells(100000, 1).End(xlUp).Row\niPBINS = 2\niDeposits = 2\n\nFor iDeposits = 2 To Sht1LastRow\nstring1 = Sheets(\"Deposits And Credits\").Cells(iDeposits, 7).Value\n    For iPBINS = 2 To Sht2LastRow\n        If Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 And Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 2) Or Sheets(\"Deposits And Credits\").Cells(iDeposits, 1).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Value And InStr(1, Sheets(\"June PB INS\").Cells(iPBINS, 3).Value, string1, 1) &lt;&gt; 0 And Sheets(\"Deposits And Credits\").Cells(iDeposits, 3) = Sheets(\"June PB INS\").Cells(iPBINS, 15) Then\n            Sheets(\"Deposits And Credits\").Cells(iDeposits, 12).Value = Sheets(\"June PB INS\").Cells(iPBINS, 1).Address(1, 1, 1, 1) And Sheets(\"Deposits And Credits\").Rows(\"iDeposits:iDeposits\").Select\n                With Selection.Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .Color = 5296274\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\n        End If\n    Next iPBINS\nNext iDeposits\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1472054652, "post_id": 39127026, "comment_id": 65601742, "body": "I think the problem might be because <code>.Range(&quot;C:C&quot;)</code> creates new range. You can try setting that to a range <code>Set rngC = .Range(&quot;C:C&quot;)</code> and then call the finds on it <code>rngC.Find</code> and <code>rngC.FindNext</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1472055379, "post_id": 39127026, "comment_id": 65602185, "body": "Actually, as far as I know both of the <code>.FindNext</code> will look for the same value that was passed to the last call to <code>.Find</code> before <code>.FindNext</code>, so you will have to use something like <code>.Find(k, After:=region)</code> instead of <code>.FindNext(region)</code>"}, {"owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472059498, "post_id": 39127026, "comment_id": 65604450, "body": "@Slai, I believe you are correct. Changed line to Set region = rng.Find(region, after:=region) and it all seems to work !!"}], "owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1472053181, "creation_date": 1472051258, "last_edit_date": 1472053181, "question_id": 39127026, "link": "https://stackoverflow.com/questions/39127026/error-using-two-findnext", "title": "Error Using Two FindNext", "body": "<p>This code has two range.find/findnext to search for values and related values in a list of parent/child values. </p>\n\n<p>A dictionary is created of unique values for the parent value, then the range find is used in two loops using the dictionary as parent.  </p>\n\n<pre><code>Sub tablaplana()\n  Call SET_VAR\n  '# FIND UNIQUE REGION CENTERS\n  ' Dim region As Range\n  ' Dim district As Range\n  Set dict = CreateObject(\"Scripting.Dictionary\")\n  With ws(3)\n      r = 2\n    x = 2\n    Do Until x &gt;= .Range(\"A1\").End(xlDown).Row\n        jnum = .Cells(x, 3)\n        jtype = .Cells(x, 4)\n        jname = .Cells(x, 6)\n        If jtype = \"R\" And InStr(1, jname, \"REGION ADMIN\") Then\n            If Not dict.Exists(jnum) Then\n                dict.Add jnum, jname\n                Debug.Print x\n            End If\n        End If\n        x = x + 1\n    Loop\n    '# FIND ALL SUB-SUB-VALUES VALUES OF PARENT UNIQUE VALUES\n    For Each k In dict.Keys\n        s = 0\n        Set region = .Range(\"C:C\").Find(k, LookAt:=xlWhole)\n        If Not region Is Nothing Then\n            regionfirst = region.Address\n            Do\n                Set district = .Range(\"C:C\").Find(.Cells(region.Row, 1), LookAt:=xlWhole)\n                If Not district Is Nothing Then\n                    districtfirst = district.Address\n                    Do\n                        '# ADD VALUES TO REPORT SHEET\n                        ws(1).Cells(r, 1) = .Cells(district.Row, 1) 'sub-sub number\n                        ws(1).Cells(r, 2) = .Cells(region.Row, 6) 'parent name\n                        ws(1).Cells(r, 3) = .Cells(region.Row, 3) 'parent number\n                        ws(1).Cells(r, 4) = .Cells(district.Row, 6) 'sub name\n                        ws(1).Cells(r, 5) = .Cells(district.Row, 3) 'sub number\n                        ws(1).Cells(r, 6) = .Cells(district.Row, 5) 'sub-sub name\n                        Set district = .Range(\"C:C\").FindNext(district)\n                        r = r + 1\n                    Loop While Not district Is Nothing And district.Address &lt;&gt; districtfirst\n                End If\n                Set region = .Range(\"C:C\").FindNext(region)\n            Loop While Not region Is Nothing And region.Address &lt;&gt; regionfirst\n        End If\n      Next k\n  End With\nEnd Sub\n</code></pre>\n\n<p>Using two Range.Find and FindNext is causing error. Upon reaching the second FindNext(region) the returned value is equal to the first FindNext(district) even though it is looking for Region. </p>\n\n<p>Also dim as region creates error message at same lime. </p>\n"}, {"tags": ["vba", "excel", "base64"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1472051070, "post_id": 39126617, "comment_id": 65599317, "body": "Here&#39;s a Base64 lib. See: <a href=\"http://www.source-code.biz/snippets/vbasic/12.htm\" rel=\"nofollow noreferrer\">source-code.biz/snippets/vbasic/12.htm</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472051102, "post_id": 39126617, "comment_id": 65599345, "body": "I wrote a <a href=\"http://www.vbforums.com/showthread.php?379072-VB-Fast-Base64-Encoding-and-Decoding\" rel=\"nofollow noreferrer\">VB6/VBA Base64 class</a> <b><i>way</i></b> back in the day.  Note that it has some issues with some Unicode encodings due to the string conversion.  That might be a good start."}, {"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472219635, "post_id": 39126617, "comment_id": 65678267, "body": "@RyanWildry I had a go with that and It isn&#39;t very clear as to what I should do, the first issue I ran into was that my variable wasn&#39;t a multiple of 4 so I removed the part: <code>data:image&#47;png;base64,</code> and then once it appeared to decode I couldn&#39;t insert because it wasn&#39;t a picture being sent to the picture insert."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1472541951, "post_id": 39126617, "comment_id": 65780345, "body": "Does <code>iVBORw0KGgoAAAANSUhEUgAAAZoAAABfCAY</code>actually encode an image?"}, {"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1472552115, "post_id": 39126617, "comment_id": 65786939, "body": "@RobinMackenzie Nope, this wasn&#39;t a real image because the actual image was 80 odd lines which would have been extremely messy."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1472552234, "post_id": 39126617, "comment_id": 65787011, "body": "@Ryflex - those base64 image strings can get big pretty quick!"}, {"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1472601748, "post_id": 39126617, "comment_id": 65814777, "body": "Yeah, is there a better way of adding them?, the max line length is a nuisance. I had to make a little macro on my keyboard&#39;s macro key&#39;s to format it."}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 7, "last_activity_date": 1472547487, "last_edit_date": 1495542770, "creation_date": 1472544510, "answer_id": 39222080, "question_id": 39126617, "link": "https://stackoverflow.com/questions/39126617/inserting-an-image-into-a-sheet-using-base64-in-vba/39222080#39222080", "title": "Inserting an Image into a sheet using Base64 in VBA?", "body": "<p>There's a base64 encoding in the MSXML library which can be used in VBA. There are a bunch of examples knocking around the web where the core function keeps popping up:</p>\n\n<ul>\n<li><a href=\"https://www.experts-exchange.com/questions/27862447/how-to-convert-xml-base64-string-gif-jpg-png-image-file-using-vba.html\" rel=\"nofollow noreferrer\">Experts Exchange</a> which references the next item</li>\n<li><a href=\"http://web.archive.org/web/20060527094535/http://www.nonhostile.com/howto-encode-decode-base64-vb6.asp\" rel=\"nofollow noreferrer\">Something by a Tim Hastings according to Wayback machine</a> (2005!)</li>\n<li><a href=\"https://stackoverflow.com/questions/169907/how-do-i-base64-encode-a-string-efficiently-using-excel-vba\">Stack Overflow</a></li>\n<li><a href=\"http://thydzik.com/vb6vba-functions-to-convert-binary-string-to-base64-string/\" rel=\"nofollow noreferrer\">Travis Hydzik's blog</a></li>\n</ul>\n\n<p>I've basically lifted the same code which takes a string and returns a base64 byte array then used the OP's temporary file approach to load the image back into the sheet. I've tidied a bit, used late binding plus put in some tests. The tests work well for me on Excel 2010:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZT28N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZT28N.png\" alt=\"enter image description here\"></a></p>\n\n<p>Testing the base64 string in the question doesn't seem to work:</p>\n\n<blockquote>\n  <p>iVBORw0KGgoAAAANSUhEUgAAAZoAAABfCAY</p>\n</blockquote>\n\n<p>Gives:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kCtcA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCtcA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim strTempPath As String\n    Dim arrTest(1 To 3) As String\n    Dim intCounter As Integer\n\n    'base 64 image examples\n    'red dot\n    arrTest(1) = \"iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"\n    'little face logo\n    arrTest(2) = \"R0lGODlhDwAPAKECAAAAzMzM/////wAAACwAAAAADwAPAAACIISPeQHsrZ5ModrLlN48CXF8m2iQ3YmmKqVlRtW4MLwWACH+H09wdGltaXplZCBieSBVbGVhZCBTbWFydFNhdmVyIQAAOw==\"\n    'Stack Overflow logo\n    arrTest(3) = GetSOLogoBase64\n\n    'use workbook path as temp path\n    strTempPath = Application.ActiveWorkbook.Path &amp; \"\\temp.png\"\n\n    For intCounter = 1 To 3\n\n        'save byte array to temp file\n        Open strTempPath For Binary As #1\n           Put #1, 1, DecodeBase64(arrTest(intCounter))\n        Close #1\n\n        'insert image from temp file\n        Sheets(\"Sheet1\").Cells(intCounter * 4, 1).Select\n        Sheets(\"Sheet1\").Pictures.Insert strTempPath\n\n        'kill temp file\n        Kill strTempPath\n\n    Next intCounter\n\nEnd Sub\n\nPrivate Function DecodeBase64(ByVal strData As String) As Byte()\n\n    Dim objXML As Object 'MSXML2.DOMDocument\n    Dim objNode As Object 'MSXML2.IXMLDOMElement\n\n    'get dom document\n    Set objXML = CreateObject(\"MSXML2.DOMDocument\")\n\n    'create node with type of base 64 and decode\n    Set objNode = objXML.createElement(\"b64\")\n    objNode.DataType = \"bin.base64\"\n    objNode.Text = strData\n    DecodeBase64 = objNode.nodeTypedValue\n\n    'clean up\n    Set objNode = Nothing\n    Set objXML = Nothing\n\nEnd Function\n\nFunction GetSOLogoBase64() As String\n\n    GetSOLogoBase64 = \"\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"iVBORw0KGgoAAAANSUhEUgAAANAAAAA4CAMAAAC7bYapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvq\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"GQAAADJUExURSIkJi8wMi8xMzw+QD0/QUpMTktNTlhaW1lbXGZnaWdoanR1dnV2d4KDhIOEhZCRkpGSk56en56foKusraytrrm6u7q7u7y7u8\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"TDw8fIyMjHx8jJyczLy83MzNXV1tnY2N3d3ePj4+bl5e7u7vHx8fLy8vSAJPSHMPSIMfWPPvWQP/aXTPaYTfafWvegW/enZ/eoaPivdfiwdvm\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"3g/m4hPm/kfrAkvrHnvrIn/vPrPvQrfzXuvzYu/zfyP3gyf3n1f7v4//38f///4l4PkAAAATsSURBVGje7Zh5e5tGEIeXS4CQDArGKlVEQ7pF\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"cn0kjq8qqiqJ7/+hOjO7LAgdsRWnjXjYPyxgl2HeOX67j1nesMFaoBaoBWqBWqAW6GcGWs+bBbS8zuZNAlpfZtl01aQMzbIsu25UD90B0X1Dg\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"Nb05wqI5o0AmmczkoXJSbXRfqDlNMse8OL5pNqIHZSD7DOW3Se4eGxAyWGtZdcrod3ZogGisEI9mC4BDX/XDZDtNRYbSgO20e2rbQfBdzrHz4\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"MgzOPgNYb2AC3l7z0SPRzZRuw7T76JyRizc5+9xtCepZfTp3VVGqiNlvVVYZD+SKAOezMgxJg+rSrSsMwms61lNot/IFAKIJYfvgkQnndgfFm\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"V0jBf5v8xUAwgaP9NSm5xI5EWUhqudq16NVA6Gu1p/1H6IqDRiB+rckuZpdsFSsOkmp8LkJ3zlIDejdDFNOg6Z6qfLs6c7jteAvEgSOjiHJtc\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"73EqJo/aHi4GxUTAhfd2hLc9jkAdp18CJV1sKgcgDZihJqbX89yF5+k3ZXslka6/5rNFTXvwiwjEmBahWRpn5D61MtOjAggekPN5Ty7rcHRAx\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"0d9cqQygd7r4i6K2aYoJHKChfI9AjFxCmasF+1DjxNC+rOSH65rIcQ4NEIE8nwIvqXBNQ81jBa4b0c89vED5IfiiVgxHAoBZs1Eh/HGsA2RNZ\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"8pr2tAXFcG0oQW5JwJO3jbPwA0//LXPwoJ9TqrHLYjkeRqD/FEznTQIVfccAEE+QxLEY5y7pEPGnkg/DJF/XkUdfTeSvkg3Ooh5PY4xcXD9z3\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"xCO0MZHz2AdFuevvwVeRldpndVSZ98GqPKOB3Oyyt3kOZhOqOWDm1jUe1gq5ypOJqwi+7oQbkyXUuZk28j62Dv1D62iFRuMqKcfv0NyRnttrQ\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"HocfAFK1TPfAY1Y0y8cLA38TimkH44zhDXDQgoqk1YDAayMvbjFPCYRAs9BOoTH7gB5vJlk5pp+fa1oN2tML4gpQfObggA/FEL0KkM4sQVEBs\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"ukXsPopFaHqmm8D2QoIGQZA5UI4+jHZ2QX0fjz+Qyrc/P5GIX3K84/j8W/qwEMNjImSQD2m2Ti2gVjINVndNSBwxBxQpRwHBNXmQt2FEBSzX9\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"15N4CGw+Hv1a1odkfVB6fSD8Ph+42NMLKg4AVQzCxelBzfBArRcycvthxfSqwvzjW66uhqix4AMssVoAe6jk1lkR33RUDizPB8t9wGyikXtvx\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"gXPaQxnjtpGBJWSS9FiSh8K/UXGGAHwQq9h6HMpXS666IB1PKsxNo8VQbq11ACZh1N4BS/K4ne6Y8KSRMT4vdPEguOtIvklxDqoQOFtKu3Fh3\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"AcViH+tcJIHMtCU5BBk/BPSY1caiCtRzUrnvo8Z2ybVucUQA+xr1Z9rpqaNPXxRdojqF9kBoLnluCdUEEO0AimV7WcUyDd0fFBz42MqPBuJQK\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"t0g6OloBLzXHawe0wkcXSv2P9MhPVZnOW3TcVeE01M7jld46u3MkNhu/JxLIi0p4kOdMygCc2SGQOTQqkU2EtcAA7wPVaN5qSwx/D4ejNRpO2\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"I6MaQerLPC0t9CQCJy2Y139xD4LJQxDwHJ8OS+a8jOScqt+EWiIMZ2D53EP0laoBMA+nW8c/xyskD7Rwv0EwB9ODQ+NuBfwac4WqAWqAVqgVq\"\n    GetSOLogoBase64 = GetSOLogoBase64 &amp; \"gFuj/HP8CZQ0/RA2L6ggAAAAASUVORK5CYII=\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10151, "favorite_count": 3, "accepted_answer_id": 39222080, "answer_count": 1, "score": 6, "last_activity_date": 1611797489, "creation_date": 1472050195, "last_edit_date": 1472498078, "question_id": 39126617, "link": "https://stackoverflow.com/questions/39126617/inserting-an-image-into-a-sheet-using-base64-in-vba", "title": "Inserting an Image into a sheet using Base64 in VBA?", "body": "<p>I'm trying to insert an image into a sheet with VBA using Base64 but I can't find any examples of how to do it correctly anywhere.</p>\n\n<p>I have a string setup for the image, something like:</p>\n\n<p><code>vLogo = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAABfCAY\"</code></p>\n\n<p>I just want to do the following, but instead of looking for an image file store the image in the VBA.</p>\n\n<p><code>Sheets(\"Sheet1\").Pictures.Insert (Application.ActiveWorkbook.Path &amp; \"\\vLogo.png\")</code></p>\n\n<p>I've even looked at doing something like:</p>\n\n<pre><code>' Write the image to file\nDim myFile As String\nmyFile = Application.ActiveWorkbook.Path &amp; \"\\temp.png\"\nOpen myFile For Output As #1\nWrite #1, vLogo\nClose #1\n\n' Insert the image\nSheets(\"Sheet1\").Pictures.Insert (Application.ActiveWorkbook.Path &amp; \"\\temp.png\")\n\n' Delete the temp file\nKill Application.ActiveWorkbook.Path &amp; \"\\temp.png\"\n</code></pre>\n\n<p>But I can't figure out how to write the base64 encoded image to file.</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 2, "creation_date": 1472048855, "post_id": 39126025, "comment_id": 65597637, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1472049312, "post_id": 39126025, "comment_id": 65597973, "body": "By &quot;randomly crashes&quot;, I suppose you mean &quot;randomly times out&quot;? Do you have an index on <code>[Field2]</code>?"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 1, "creation_date": 1472049488, "post_id": 39126025, "comment_id": 65598093, "body": "When you say it &quot;crashes&quot;, do you mean it is not responding for a while? It is not the same. If your code works but takes a long time to run (Not Responding), it is not the same that if it does not and crashes. If there is not real problem to fix but you are looking for efficiency improvment, ask your question in <a href=\"http://codereview.stackexchange.com/questions\">CodeReview</a>"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472050787, "post_id": 39126025, "comment_id": 65599062, "body": "How much is &#39;N&#39; ? You seem to make a lot of queries with results overlapping each other (except for te first row)"}, {"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472050951, "post_id": 39126025, "comment_id": 65599219, "body": "N is 202, by crashes I mean it stops responding for over an hour and I have to reset it. It works for 10 or so cases"}, {"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472051016, "post_id": 39126025, "comment_id": 65599269, "body": "@Mat&#39;sMug Yes, I&#39;ve just called it [Field2] for a test run"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472051126, "post_id": 39126025, "comment_id": 65599365, "body": "It would certainly work more efficiently if you build a proper <code>WHERE</code> close using <code>IN (list of N values)</code> that would scan the table only once."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472051280, "post_id": 39126025, "comment_id": 65599476, "body": "@iDevlop with 202 values I&#39;d consider inserting them in an actual table and returning an inner join, given OP is looking for <i>exact</i> content and not a <code>LIKE</code> search. But yeah for a handful of values an <code>IN</code> clause would be good."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472071846, "post_id": 39126025, "comment_id": 65610909, "body": "@Mat&#39;sMug The question is about scanning a 1 million records table ONCE or 200 times. I&#39;d bet my suggestion (and pcw&#39;s answer) is 200 times faster"}], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1472050548, "creation_date": 1472050548, "answer_id": 39126764, "question_id": 39126025, "link": "https://stackoverflow.com/questions/39126025/extracting-data-from-over-a-million-records/39126764#39126764", "title": "Extracting data from over a million records", "body": "<p>Making sure there is a key on the lookup field will help. I would suggest making a copy of the workbook and test external data from Access or MS Query to see if that gives a performance gain over VBA.</p>\n\n<p>When using MS Query or data from Access, you can modify the command text in the connection properties and use ? in the where clause to specify the parameter in the worksheet (so you don't lose that functionality).</p>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472051893, "post_id": 39126927, "comment_id": 65599924, "body": "So have you turned lookup into an array?"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472052011, "post_id": 39126927, "comment_id": 65600000, "body": "No, not an array but a string."}, {"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472052161, "post_id": 39126927, "comment_id": 65600097, "body": "The problem here is when I try to paste it back to excel, I need it to paste the records according to the name - I don&#39;t see how this code is doing that (i.e. the worksheets.range(&quot;B&quot; &amp; i) part)"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472052414, "post_id": 39126927, "comment_id": 65600291, "body": "Add the name in your SQL statement, something like  <code>&quot;SELECT [Field2], NAME1,NAME2 FROM DATA WHERE [Field2] IN (&quot; &amp; lookup &amp; &quot;);&quot; </code>."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1472050970, "creation_date": 1472050970, "answer_id": 39126927, "question_id": 39126025, "link": "https://stackoverflow.com/questions/39126025/extracting-data-from-over-a-million-records/39126927#39126927", "title": "Extracting data from over a million records", "body": "<p>I modified your SQL statement.  Replace the <code>Where [Field2] = \"xxx\"</code> by <code>Where [Field2] IN (\"xxx\", \"yyy\", \"zzz\")</code>.</p>\n\n<pre><code>N = Cells(Rows.Count, \"A\").End(xlUp).Row\nApplication.DisplayAlerts = False\nstrDB = ThisWorkbook.Path &amp; \"file.accdb\"\nSet objConnection = New ADODB.Connection\nobjConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strDB\n\nFor i = 2 To N\n    lookup = lookup &amp; \"'\" &amp; Range(\"A\" &amp; i).Value &amp; \"', \"\nNext i\nlookup = left(lookup, len(lookup) - 2)\n\nDim rstTable As ADODB.Recordset\nSet rstTable = New ADODB.Recordset\n\nstrSQL = \"SELECT NAME1,NAME2 FROM DATA WHERE [Field2] IN (\" &amp; lookup &amp; \");\"\n'Store query output\nrstTable.Open Source:=strSQL, ActiveConnection:=objConnection\n'Paste results to Transactions sheet\nWorksheets(\"Sheet1\").Range(\"B\" &amp; i).CopyFromRecordset rstTable\n\n'Close the record set &amp; connection\nrstTable.Close\nobjConnection.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 0, "last_activity_date": 1472051301, "creation_date": 1472051301, "answer_id": 39127041, "question_id": 39126025, "link": "https://stackoverflow.com/questions/39126025/extracting-data-from-over-a-million-records/39127041#39127041", "title": "Extracting data from over a million records", "body": "<p>You close the connection after the first iteration, so your next iteration -- which does not have code to open the connection -- would fail. So you should move the <code>objConnection.Close</code> out of the loop.</p>\n\n<p>But, even then, to execute the same kind of query over and over again, just with a different argument, can be done in one go, using the <code>IN (...)</code> syntax:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Declare all your variables\nDim N As Long\nDim strDB As String\nDim objConnection As ADODB.Connection\nDim rstTable As ADODB.Recordset\nDim strSQL As String\n\nN = Cells(Rows.Count, \"A\").End(xlUp).Row\nApplication.DisplayAlerts = False\nstrDB = ThisWorkbook.Path &amp; \"file.accdb\"\nSet objConnection = New ADODB.Connection\nobjConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strDB\n\n' collect the values in comma-separated string\nlookup = \"\"\nFor i = 2 To N\n    lookup = lookup &amp; \",\"\"\" &amp; Range(\"A\" &amp; i).Value &amp; \"\"\"\"\nNext i\n' Chop off the first comma\nlookup = Mid(lookup, 2)\n\n' Perform a single query, but also select the Field2 value\nSet rstTable = New ADODB.Recordset\nstrSQL = \"SELECT Field2, NAME1,NAME2 FROM DATA WHERE [Field2] IN (\" &amp; lookup &amp; \");\"\n' query output \nrstTable.Open Source:=strSQL, ActiveConnection:=objConnection\n\n' Retrieve values \nWhile Not rstTable.EOF\n    lookup = rstTable.Fields(0).Value\n    ' Locate in which row to put the result\n    For i = 2 To N\n        If lookup = Range(\"A\" &amp; i).Value Then\n            Range(\"B\" &amp; i).Value = rstTable.Fields(1).Value\n            Range(\"C\" &amp; i).Value = rstTable.Fields(2).Value\n        End If\n    Next i\n    rstTable.MoveNext\nLoop    \n\n' Close the record set &amp; connection\nrstTable.Close\nobjConnection.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1472071282, "creation_date": 1472071282, "answer_id": 39132695, "question_id": 39126025, "link": "https://stackoverflow.com/questions/39126025/extracting-data-from-over-a-million-records/39132695#39132695", "title": "Extracting data from over a million records", "body": "<p>You can do what you described, but I think it's far more efficient to do this in Access itself.  Just create a table with your names and do an Inner Join to the table you want to find 2 fields.  Should take less than a minute, and probably less than 30 seconds.</p>\n"}], "owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1472071282, "creation_date": 1472048706, "last_edit_date": 1472051648, "question_id": 39126025, "link": "https://stackoverflow.com/questions/39126025/extracting-data-from-over-a-million-records", "title": "Extracting data from over a million records", "body": "<p>I have an Excel file in which I have set up a connection with an Access database. In the Excel file I have a list of names in column A, and I want to search these names in the Access database and return back two fields from that database. I need to do this for around 200-300 names.</p>\n\n<p>Here is my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>N = Cells(Rows.Count, \"A\").End(xlUp).Row\nApplication.DisplayAlerts = False\nstrDB = ThisWorkbook.Path &amp; \"file.accdb\"\nSet objConnection = New ADODB.Connection\nobjConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strDB\n\nFor i = 2 To N\n\n    Dim rstTable As ADODB.Recordset\n    Set rstTable = New ADODB.Recordset\n    lookup = Range(\"A\" &amp; i).Value\n\n\n    strSQL = \"SELECT NAME1,NAME2 FROM DATA WHERE [Field2]= \"\"\" &amp; lookup &amp; \"\"\";\"\n    'Store query output\n    rstTable.Open Source:=strSQL, ActiveConnection:=objConnection\n    'Paste results to Transactions sheet\n    Worksheets(\"Sheet1\").Range(\"B\" &amp; i).CopyFromRecordset rstTable\n\n    'Close the record set &amp; connection\n    rstTable.Close\n    objConnection.Close\nNext i\n</code></pre>\n\n<p>This works (kindof) but it takes an extremely long time and randomly crashes. Any ideas how to improve this?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1472047847, "post_id": 39125639, "comment_id": 65596937, "body": "Just call <code>Filter</code> from <code>Click_Me</code> when you want it to run."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1472049238, "post_id": 39125860, "comment_id": 65597913, "body": "@ Arun Thomas. Thank you for taking the time to respond but it didn&#39;t work. It compiled but nothing happened."}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1472051787, "post_id": 39125860, "comment_id": 65599848, "body": "@PhilipConnell Did you put <code>()</code> after the <code>Call Filter</code>? I know sometimes VBA is finicky when calling another sub, so that might be it. <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251432.aspx\" rel=\"nofollow noreferrer\">Microsoft</a> has more information."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1472052050, "post_id": 39125860, "comment_id": 65600025, "body": "@PartyHatPanda: that was the first thing i did. But when i try to type () after <code>Call Filter</code> they just disappear"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 1, "creation_date": 1472052202, "post_id": 39125860, "comment_id": 65600127, "body": "@PhilipConnell Thanks for the update! If they disappear then they are not necessary. Have you walked through it with the debugger to see what is happening?"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1472052529, "post_id": 39125860, "comment_id": 65600359, "body": "@PartyHatPanda: Its not actually bugging its just not doing anything. The file gets selected then nothing. If i open the file manually then nothing has happened either. Some code is needed to fire that 2nd macro then keep that sheet open. But what that is. is beyond me :-("}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1472053008, "post_id": 39125860, "comment_id": 65600660, "body": "@PhilipConnell You don&#39;t need to have a buggy program to use the debugger! :) I am suggesting that something is not going as you expect. Thus, walk through it one step at a time. Most likely a variable is not what you expected it to be. @ArunThomas &#39;s answer should do it for you, and without the exact files you are working with I cannot fully check what is happening. I can say that running your <code>Click_Me()</code> sub and choosing a file does get me into the <code>Filter()</code> sub using Arun&#39;s code."}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 3, "last_activity_date": 1472048239, "creation_date": 1472048239, "answer_id": 39125860, "question_id": 39125639, "link": "https://stackoverflow.com/questions/39125639/joining-two-macros/39125860#39125860", "title": "Joining Two Macros", "body": "<pre><code>If FileChosen &lt;&gt; -1 Then\n    MsgBox \"No file selected - aborted\"\nElse\n    Call Filter\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472048239, "creation_date": 1472047697, "question_id": 39125639, "link": "https://stackoverflow.com/questions/39125639/joining-two-macros", "title": "Joining Two Macros", "body": "<p>I hope you are well and can help. I have two pieces of code that I am trying to join into one Macro. </p>\n\n<p>The first piece of code I have allows a user to click on a command button that opens up a txt box and allows a user to select a file. \nOnce that file is selected, I then want the 2nd piece of code to do its thing which is go through column F and find a country and then create a new sheet copy and paste the data for that country into the new sheet and name that sheet for the country then return to column F and repeat for other countries. </p>\n\n<p>I added a pic as i think it might make it easier. see the end </p>\n\n<p>Both piece of code work fine independently i just need to join them. </p>\n\n<p>1ST piece of code **Select file and msb box **</p>\n\n<pre><code>Sub Click_Me()\n\n    Application.ScreenUpdating = False 'Turns off switching to exported excel file once it gets opened\n    Application.DisplayAlerts = False 'Turns off automatic alert messages\n    Application.EnableEvents = False '\n    Application.AskToUpdateLinks = False 'Turns off the \"update links\" prompt\n\n    'User prompt, choose HCP file\n    MsgBox \"Choose TOV file missing consent information\"\n\n        'Alternative way to open the file\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    fd.AllowMultiSelect = False\n\n     'Assign a number for the selected file\n    Dim FileChosen As Integer\n    FileChosen = fd.Show\n    If FileChosen &lt;&gt; -1 Then\n    'Didn't choose anything (clicked on CANCEL)\n        MsgBox \"No file selected - aborted\"\n        End 'Ends file fetch and whole sub\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>2ND piece of code **Separate Column F into other sheets copy and paste and name **</p>\n\n<pre><code>Option Explicit\n\nSub Filter()\n    Dim rCountry As Range, helpCol As Range\n\n    With Worksheets(\"CountryList\") '&lt;--| refer to data worksheet\n        With .UsedRange\n            Set helpCol = .Resize(1, 1).Offset(, .Columns.Count) '&lt;--| get a \"helper\" column just at the right of used range, it'll be used to store unique country names in\n        End With\n\n        With .Range(\"A1:Q\" &amp; .Cells(.Rows.Count, 1).Row) '&lt;--| refer to its columns \"A:Q\" from row 1 to last non empty row of column \"A\"\n            .Columns(6).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=helpCol, Unique:=True '&lt;-- call AdvancedFilter on 6th column of the referenced range and store its unique values in \"helper\" column\n            Set helpCol = Range(helpCol.Offset(1), helpCol.End(xlDown)) '&lt;--| set range with unique names in (skip header row)\n            For Each rCountry In helpCol '&lt;--| iterate over unique country names range (skip header row)\n                .AutoFilter 6, rCountry.Value2 '&lt;--| filter data on country field (6th column) with current unique country name\n                If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then '&lt;--| if any cell other than header ones has been filtered...\n                    Worksheets.Add Worksheets(Worksheets.Count) '&lt;--... add new sheet\n                    ActiveSheet.name = rCountry.Value2  '&lt;--... rename it\n                    .SpecialCells(xlCellTypeVisible).Copy ActiveSheet.Range(\"A1\") 'copy data for country under header\n                End If\n            Next\n        End With\n        .AutoFilterMode = False '&lt;--| remove autofilter and show all rows back\n    End With\n    helpCol.Offset(-1).End(xlDown).Clear '&lt;--| clear helper column (header included)        \nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6PXHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6PXHz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": true, "score": 0, "last_activity_date": 1472049746, "creation_date": 1472049746, "answer_id": 39126440, "question_id": 39125616, "link": "https://stackoverflow.com/questions/39125616/get-user-value-from-overwrite-dialog-box/39126440#39126440", "title": "Get user value from Overwrite Dialog Box", "body": "<p>I think this solves it:</p>\n\n<pre><code>Sub SaveFile(fName As String)\n\ncancelSave = False\nRetry:\nsaveAsFileName = Application.GetSaveAsFilename(InitialFileName:=fName, FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\nIf saveAsFileName &lt;&gt; False Then\n    If Not Dir(saveAsFileName) &lt;&gt; vbNullString Then\n        ActiveWorkbook.SaveAs fileName:=saveAsFileName\n    Else\n        On Error Resume Next\n        ActiveWorkbook.SaveAs fileName:=saveAsFileName, FileFormat:=xlWorkbook, ConflictResolution:=xlLocalSessionChanges\n        If Err.Number = 1004 Then\n            On Error GoTo 0\n            GoTo Retry\n        Else\n            On Error GoTo 0\n        End If\n    End If\nElse\n    cancelSave = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 39126440, "answer_count": 1, "score": 0, "last_activity_date": 1472049746, "creation_date": 1472047649, "last_edit_date": 1531161705, "question_id": 39125616, "link": "https://stackoverflow.com/questions/39125616/get-user-value-from-overwrite-dialog-box", "title": "Get user value from Overwrite Dialog Box", "body": "<p>I incorporated some code I found on SO (specifically, the <code>Dir()</code> part on line 8). Once the 'Do you want to overwrite the file` part shows how do I get the value the user pressed (yes, no, or cancel) to apply further logic? Here is my code:</p>\n\n<pre><code>Sub SaveFile(fName As String)\n\ncancelSave = False\nRetry:\nsaveAsFileName = Application.GetSaveAsFilename(InitialFileName:=fName, FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\nOn Error Resume Next\nIf saveAsFileName &lt;&gt; False Then\n    If Not Dir(saveAsFileName) &lt;&gt; vbNullString Then\n        ActiveWorkbook.SaveAs fileName:=saveAsFileName\n    Else\n        If Err.Number = 1004 Then\n        -----HERE, I want to find out if the user pressed yes, no, or cancel.-----\n        Else\n            ActiveWorkbook.SaveAs fileName:=saveAsFileName, FileFormat:=xlWorkbook, ConflictResolution:=xlLocalSessionChanges\n        End If\n    End If\nElse\n    cancelSave = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "xml", "vba", "ms-word"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 1, "creation_date": 1472049207, "post_id": 39125601, "comment_id": 65597891, "body": "You can access zipped files directly via a Shell object (<a href=\"http://www.rondebruin.nl/win/s7/win002.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s7/win002.htm</a>), but then you&#39;re going to be stuck parsing XML (<a href=\"http://stackoverflow.com/questions/11305/how-to-parse-xml-using-vba\" title=\"how to parse xml using vba\">stackoverflow.com/questions/11305/how-to-parse-xml-using-vb&zwnj;&#8203;a</a>) and Word has a horrible underlying xml to work with. Good luck."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1472049379, "post_id": 39125601, "comment_id": 65598026, "body": "Take a look at <a href=\"http://stackoverflow.com/a/20856265/4717755\">VBA macro to search a folder for a keyword</a>. By using the <code>FindFiles</code> function as described (use the second version), you will leverage the Windows index of all the words in your documents."}, {"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 0, "creation_date": 1472051001, "post_id": 39125601, "comment_id": 65599253, "body": "Thanks to you both, I&#39;ll have a look at the links and try to make something."}, {"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 0, "creation_date": 1472216595, "post_id": 39125601, "comment_id": 65676208, "body": "Ok so far I&#39;ve concluded that what I wanted to do (which is editing the .docx without changing the extension) cannot be done in VBA. I am currently writing a DLL in C# that might solve the matter similar to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff478255.aspx\" rel=\"nofollow noreferrer\">code found on the MSDN</a> I hope to post something shortly about it."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1473083087, "post_id": 39330893, "comment_id": 65995352, "body": "Yes indeed I forgot to add that. Now the query takes approximately 10 seconds to execute for all files, but it is restricted to anlayzing <code>.doc</code> files"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1473113975, "post_id": 39330893, "comment_id": 66007804, "body": "Great! Consider posting a C# question and have the gurus show how you can integrate <i>.docx</i> files."}, {"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1478861633, "post_id": 39330893, "comment_id": 68331273, "body": "Damn it, I just came back to see that I mentioned <code>.doc</code> when in fact this answer applies only to <code>.docx</code> files, because <code>.doc</code> files have a different way of storing the data. Apologies,"}], "tags": [], "owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "is_accepted": true, "score": 2, "last_activity_date": 1570011462, "last_edit_date": 1570011462, "creation_date": 1473079387, "answer_id": 39330893, "question_id": 39125601, "link": "https://stackoverflow.com/questions/39125601/read-the-content-of-a-word-document-via-its-xml/39330893#39330893", "title": "Read the content of a Word document via its XML", "body": "<p><em>Do note that this is not an easy answer to the above problem and the sole VBA code in my initial question will do perfectly the job as long as you do not have a load of documents to browse, else go for another tool (there is a <a href=\"https://github.com/python-openxml/python-docx\" rel=\"nofollow noreferrer\">Python Dynamic Link Library (DLL)</a> that does that very well).</em></p>\n\n<p>Ok, I'll try to make my answer as explanatory as possible.</p>\n\n<p>First of all this question lead me to the infinite journey of XML in C# and in XPath which I chose not to pursue at some point.</p>\n\n<p>It reduced the time of analyzing the files from roughly 2 hours to 10 seconds.</p>\n\n<h1>Context</h1>\n\n<p>The backbone of reading XML documents, and therefore inner word XML documents, is the OpenXML library from Microsoft.\nKeep in mind what I said above, that the method I was trying to implement cannot be done solely in VBA and thus must be done in another way.\nThis is probably due to the fact that VBA is implemented for Office and thus limited in accessing the core structure of Office documents, but I have no information relating to this limitation (any information is welcomed).</p>\n\n<p>The answer I will give here is writing a C# DLL for VBA.\nFor writing DLL in C# and referencing to it in VBA I redirect you toward the following link which will resume in a better way this specific process: <a href=\"http://www.geeksengine.com/article/create-dll.html\" rel=\"nofollow noreferrer\">Tutorial for creating DLL in C#</a></p>\n\n<h1>Let's start</h1>\n\n<p>First of all you will need to reference the WindowsBase library and the DocumentFormat.OpenXML in your project to make the solution work as explained in this MSDN article <a href=\"https://msdn.microsoft.com/en-us/library/aa982683(v=office.12).aspx\" rel=\"nofollow noreferrer\">Manipulate Office Open XML Formats Documents</a> and that one <a href=\"https://msdn.microsoft.com/en-us/library/office/ff478255.aspx\" rel=\"nofollow noreferrer\">Open and add text to a word processing document (Open XML SDK)</a>\nThese articles explain broadly how works the OpenXML library for manipulating word documents.</p>\n\n<h1>The C# code</h1>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.IO;\nusing System.Xml;\nusing System.IO.Packaging;\n\nnamespace BrowserClass\n{\n\n    public class SpecificDirectory\n    {\n\n        public string[,] LookUpWord(string nameKeyword, string nameStopword, string nameDirectory)\n        {\n            string sKeyWord = nameKeyword;\n            string sStopWord = nameStopword;\n            string sDirectory = nameDirectory;\n\n            sStopWord = sStopWord.ToLower();\n            sKeyWord = sKeyWord.ToLower();\n\n            string sDocPath = Path.GetDirectoryName(sDirectory);\n            // Looking for all the documents with the .docx extension\n            string[] sDocName = Directory.GetFiles(sDocPath, \"*.docx\", SearchOption.AllDirectories);\n            string[] sDocumentList = new string[1];\n            string[] sDocumentText = new string[1];\n\n            // Cycling the documents retrieved in the folder\n            for (int i = 0; i &lt; sDocName.Count(); i++)\n            {\n                string docWord = sDocName[i];\n\n                // Opening the documents as read only, no need to edit them\n                Package officePackage = Package.Open(docWord, FileMode.Open, FileAccess.Read);\n\n                const String officeDocRelType = @\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\";\n\n                PackagePart corePart = null;\n                Uri documentUri = null;\n\n                // We are extracting the part with the document content within the files\n                foreach (PackageRelationship relationship in officePackage.GetRelationshipsByType(officeDocRelType))\n                {\n                    documentUri = PackUriHelper.ResolvePartUri(new Uri(\"/\", UriKind.Relative), relationship.TargetUri);\n                    corePart = officePackage.GetPart(documentUri);\n                    break;\n                }\n\n                // Here enter the proper code\n                if (corePart != null)\n                {\n                    string cpPropertiesSchema = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n                    string dcPropertiesSchema = \"http://purl.org/dc/elements/1.1/\";\n                    string dcTermsPropertiesSchema = \"http://purl.org/dc/terms/\";\n\n                    // Construction of a namespace manager to handle the different parts of the xml files\n                    NameTable nt = new NameTable();\n                    XmlNamespaceManager nsmgr = new XmlNamespaceManager(nt);\n                    nsmgr.AddNamespace(\"dc\", dcPropertiesSchema);\n                    nsmgr.AddNamespace(\"cp\", cpPropertiesSchema);\n                    nsmgr.AddNamespace(\"dcterms\", dcTermsPropertiesSchema);\n\n                    // Loading the xml document's text\n                    XmlDocument doc = new XmlDocument(nt);\n                    doc.Load(corePart.GetStream());\n\n                    // I chose to directly load the inner text because I could not parse the way I wanted the document, but it works so far\n                    string docInnerText = doc.DocumentElement.InnerText;\n                    docInnerText = docInnerText.Replace(\"\\\\* MERGEFORMAT\", \".\");\n                    docInnerText = docInnerText.Replace(\"DOCPROPERTY \", \"\");\n                    docInnerText = docInnerText.Replace(\"Glossary.\", \"\");\n\n                    try\n                    {\n                        Int32 iPosKeyword = docInnerText.ToLower().IndexOf(sKeyWord);\n                        Int32 iPosStopWord = docInnerText.ToLower().IndexOf(sStopWord);\n\n                        if (iPosStopWord == -1)\n                        {\n                            iPosStopWord = docInnerText.Length;\n                        }\n\n                        if (iPosKeyword != -1 &amp;&amp; iPosKeyword &lt;= iPosStopWord)\n                        {\n                            // Redimensions the array if there was already a document loaded\n                            if (sDocumentList[0] != null)\n                            {\n                                Array.Resize(ref sDocumentList, sDocumentList.Length + 1);\n                                Array.Resize(ref sDocumentText, sDocumentText.Length + 1);\n                            }\n                            sDocumentList[sDocumentList.Length - 1] = docWord.Substring(sDocPath.Length, docWord.Length - sDocPath.Length);\n                            // Taking the small context around the keyword\n                            sDocumentText[sDocumentText.Length - 1] = (\"(...) \" + docInnerText.Substring(iPosKeyword, sKeyWord.Length + 60) + \" (...)\");\n                        }\n\n                    }\n                    catch (ArgumentOutOfRangeException)\n                    {\n                        Console.WriteLine(\"Error reading inner text.\");\n                    }\n                }\n                // Closing the package to enable opening a document right after\n                officePackage.Close();\n            }\n\n            if (sDocumentList[0] != null)\n            {\n                // Preparing the array for output\n                string[,] sFinalArray = new string[sDocumentList.Length, 2];\n\n                for (int i = 0; i &lt; sDocumentList.Length; i++)\n                {\n                    sFinalArray[i, 0] = sDocumentList[i].Replace(\"\\\\\", \"\");\n                    sFinalArray[i, 1] = sDocumentText[i];\n                }\n                return sFinalArray;\n            }\n            else \n            {\n                // Preparing the array for output\n                string[,] sFinalArray = new string[1, 1];\n                sFinalArray[0, 0] = \"NO MATCH\";\n                return sFinalArray;\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<h1>The VBA code associated</h1>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nConst sLibname As String = \"C:\\pathToYourDocuments\\\"\n\nSub tester()\n\nDim aFiles As Variant\nDim LookUpDir As BrowserClass.SpecificDirectory\nSet LookUpDir = New BrowserClass.SpecificDirectory\n\n' The array will contain all the files which contain the \"searchedPhrase\" '\naFiles = LookUpDir.LookUpWord(\"searchedPhrase\", \"stopWord\", sLibname)\n\n' Add here any necessary processing if needed '\n\nEnd Sub\n</code></pre>\n\n<p>So in the end you get a tool that can scan .docx documents much faster than in a classic open-read-close approach in VBA at the cost of more code writing.</p>\n\n<p>Above all you get a simple solution for your users that just want to perform simple search, especially when there is a huge number of word documents.</p>\n\n<h1>Note</h1>\n\n<p>Parsing Word .XML files can be nightmarish in VBA as pointed out by @Mikegrann .\nThankfully OpenXML has an XML parser <a href=\"https://stackoverflow.com/questions/3810340/c-sharp-xml-parsing-get-data-between-tags\">C# , xml parsing. get data between tags</a> that will do the work for you in  C# and take the <code>&lt;w:t&gt;&lt;/w:t&gt;</code> tags that are refering to the text of the docment. Though I found these answers so far but couldn't make them work:\n<a href=\"https://stackoverflow.com/questions/7799276/parsing-a-ms-word-generated-xml-file-in-c-sharp\">Parsing a MS Word generated XML file in C#</a> , <a href=\"https://stackoverflow.com/questions/14110212/reading-specific-xml-elements-from-xml-file\">Reading specific XML elements from XML file</a>  </p>\n\n<p>So I went for the <code>.InnerText</code> solution I provided with my code above, to access the internal text, at the cost of having some formatting text input (like <code>\\\\MERGEFORMAT</code>).</p>\n"}], "owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5157, "favorite_count": 0, "accepted_answer_id": 39330893, "answer_count": 1, "score": 3, "last_activity_date": 1594068326, "creation_date": 1472047621, "last_edit_date": 1594068326, "question_id": 39125601, "link": "https://stackoverflow.com/questions/39125601/read-the-content-of-a-word-document-via-its-xml", "title": "Read the content of a Word document via its XML", "body": "<p><strong>Context</strong></p>\n\n<p>I am trying to build a Word document browser in Excel to sift trough a large amount of documents (around 1000).</p>\n\n<p>The process of opening a word document proves to be rather slow (around 4 seconds per documents, so in this case it takes 2 hour to look through all the items, which is far too slow for a single query), even by disabling all things that could slow down the opening, hence I open:</p>\n\n<ul>\n<li>As read only</li>\n<li>Without the open and repair mode (which can happen on some documents)</li>\n<li>Disabling the display of the document</li>\n</ul>\n\n<p><strong>My attempt so far</strong></p>\n\n<p>These documents are tricky to look through because some keywords do appear every single time but not in the same context (not the core of the problem here since I can handle that when the text is loaded in arrays). Hence the often used <code>Windows explorer</code> solution (like in this <a href=\"http://answers.microsoft.com/en-us/windows/forum/windows_7-files/in-windows-7-i-want-to-search-for-all-files/aadfe1f1-4a33-406b-8e72-bb920efa4f30\" rel=\"nofollow\">link</a> ) cannot be used in my case.</p>\n\n<p>For the moment, I managed to have a working macro that analyze the content of the word documents by opening them.</p>\n\n<p><strong>Code</strong></p>\n\n<p>Here is a sample of the code.\nNote that I used the <code>Microsoft Word 14.0 Object Library</code> reference</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Analyzing all the word document within the same folder '\nSub extractFile()\n\nDim i As Long, j As Long\nDim sAnalyzedDoc As String, sLibName As String\nDim aOut()\nDim oWordApp As Word.Application\nDim oDoc As Word.Document\n\nSet oWordApp = CreateObject(\"Word.Application\")\n\nsLibName = ThisWorkbook.Path &amp; \"\\\"\nsAnalyzedDoc = Dir(sLibName)\nsKeyword = \"example of a word\"\n\nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n\nReDim aOut(2, 2)\naOut(1, 1) = \"Document name\"\naOut(2, 1) = \"Text\"\n\n\nWhile (sAnalyzedDoc &lt;&gt; \"\")\n    ' Analyzing documents only with the .doc and .docx extension '\n    If Not InStr(sAnalyzedDoc, \".doc\") = 0 Then\n        ' Opening the document as mentionned above, in read only mode, without repair and invisible '\n        Set oDoc = Word.Documents.Open(sLibName &amp; \"\\\" &amp; sAnalyzedDoc, ReadOnly:=True, OpenAndRepair:=False, Visible:=False)\n        With oDoc\n            For i = 1 To .Sentences.Count\n                ' Searching for the keyword within the document '\n                If Not InStr(LCase(.Sentences.Item(i)), LCase(sKeyword)) = 0 Then\n                    If Not IsEmpty(aOut(1, 2)) Then\n                        ReDim Preserve aOut(2, UBound(aOut, 2) + 1)\n                    End If\n                    aOut(1, UBound(aOut, 2)) = sAnalyzedDoc\n                    aOut(2, UBound(aOut, 2)) = .Sentences.Item(i)\n                    GoTo closingDoc ' A dubious programming choice but that works for the moment '\n                End If\n            Next i\nclosingDoc:\n            ' Intending to make the closing faster by not saving the document '\n            .Close SaveChanges:=False\n        End With\n    End If\n    'Moving on to the next document '\n    sAnalyzedDoc = Dir\nWend\n\nexitSub:\nWith Output\n    .Range(.Cells(1, 1), .Cells(UBound(aOut, 1), UBound(aOut, 2))) = aOut\nEnd With\n\nWith Application\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>My question</strong></p>\n\n<p>The idea I thought was to go <em>via</em> the <strong>XML</strong> content within the document to access directly to its content (which you can access when renaming any document in newer versions of Word, with a <code>.zip</code> extension and going for <code>nameOfDocument.zip\\word\\document.xml</code>).</p>\n\n<p>It would be a lot faster than loading all the images, charts and tables of the word document which are of no use in a text search.</p>\n\n<p>Thus, I wanted to ask if there was a way in VBA to open a word document like a zip file and access that <strong>XML</strong> document to then process it like a normal string of characters in VBA, since I already have the path and the name of the file given the above code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1472047356, "post_id": 39125365, "comment_id": 65596538, "body": "<code>rng.Cells.SpecialCells(xlCellTypeFormulas).ClearContents</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 0, "creation_date": 1472048309, "post_id": 39125522, "comment_id": 65597250, "body": "That should be solution but I need &#39;     rng.Cells.SpecialCells(<b>Not</b>  xlCellTypeFormulas).Clear&#39; I have to clear every cell which does not contain a formula?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1472048557, "last_edit_date": 1472048557, "creation_date": 1472047415, "answer_id": 39125522, "question_id": 39125365, "link": "https://stackoverflow.com/questions/39125365/clean-all-cells-containing-no-formula-in-a-worksheet-using-vba/39125522#39125522", "title": "clean all cells containing no formula in a worksheet using vba?", "body": "<p>Consider:</p>\n\n<pre><code>Sub DoNotContainClearCells()    \n    Dim rng As Range\n    Set rng = Worksheets(\"Datenbasis\").Range(\"A5:Z100\")\n    rng.Cells.SpecialCells(xlCellTypeFormulas).Clear\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If you wish to clear cells <strong>not</strong> containing formulas then:</p>\n\n<pre><code> Sub DoNotContainClearCells()    \n        Dim rng As Range\n        Set rng = Worksheets(\"Datenbasis\").Range(\"A5:Z100\")\n        rng.Cells.SpecialCells(xlCellTypeConstants).Clear\n    End Sub\n</code></pre>\n\n<p>will leave the formula cells alone!.</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1472047542, "creation_date": 1472047542, "answer_id": 39125572, "question_id": 39125365, "link": "https://stackoverflow.com/questions/39125365/clean-all-cells-containing-no-formula-in-a-worksheet-using-vba/39125572#39125572", "title": "clean all cells containing no formula in a worksheet using vba?", "body": "<p>Try with below</p>\n\n<pre><code>Sub DoNotContainClearCells()\n    Dim rng As Range\n    Dim cell As Range\n    'What range ?\n    Set rng = Worksheets(\"Datenbasis\").Range(\"A5:Z100\")\n    For Each cell In rng.Cells\n      If Not cell.HasFormula Then cell.Clear\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 39125522, "answer_count": 2, "score": 0, "last_activity_date": 1472048557, "creation_date": 1472047054, "last_edit_date": 1472048384, "question_id": 39125365, "link": "https://stackoverflow.com/questions/39125365/clean-all-cells-containing-no-formula-in-a-worksheet-using-vba", "title": "clean all cells containing no formula in a worksheet using vba?", "body": "<p>I am using the following code to clean all cells <em>dose not</em> containing a <strong>formula</strong>.</p>\n\n<pre><code>Sub DoNotContainClearCells()\n\n\nDim rng As Range\nDim cell As Range\nDim ContainWord As String\n\n'What range ?\n  Set rng = Worksheets(\"Datenbasis\").Range(\"A5:Z100\")\n\n'What I am looking for?\n  ContainWord = \"=\"\n\n\n  For Each cell In rng.Cells\n    If cell.Find(ContainWord) Is Nothing Then cell.Clear\n  Next cell\n\nEnd Sub\n</code></pre>\n\n<p>But I get the run time error 1004 and just the first column is removed. How can I treat this error? Is there any better way to delete cells from a sheet which dose not contain a formula?</p>\n"}, {"tags": ["excel", "excel-2010", "userform", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472047525, "post_id": 39125309, "comment_id": 65596685, "body": "Are you hiding UserForm2 or unloading it?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472052065, "post_id": 39125309, "comment_id": 65600039, "body": "both userforms 1 and 2 are set to <code>unload me</code>. but the issue is occurring when the userform <code>DatePickerForm</code> is closing, not userform1 or userform2."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472053709, "post_id": 39125309, "comment_id": 65601106, "body": "I&#39;m not sure how to add a file as example. Let me know if it would really help to understand what I&#39;m running into."}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1472742862, "post_id": 39275235, "comment_id": 65885121, "body": "Also, if you&#39;re trying to edit these values on a userform that&#39;s been unloaded, there won&#39;t be anything to reference. Using <code>.Hide</code> would be better form all around until you&#39;re completely done using the userforms."}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1472742714, "creation_date": 1472742714, "answer_id": 39275235, "question_id": 39125309, "link": "https://stackoverflow.com/questions/39125309/set-value-for-other-userform-controls-on-userform-close/39275235#39275235", "title": "set value for other userform controls on userform close", "body": "<p>Right out the gate, the first problem I see with your code is you're trying to change the value of a text box with the <code>.Text</code> property. I've personally never had luck with using <code>.Text</code> to set value as it consitently throws <code>Err:91</code>. Instead I've found it's better to use <code>.Value</code>.</p>\n\n<pre><code>Sub CloseDatePicker(save As Boolean)\n\n    If UserForm1.MultiPage1.Value = 0 Then\n        UserForm1.tbDate.Value = Calendar1.Value\n        UserForm1.cbMember.SetFocus\n        ElseIf UserForm1.MultiPage1.Value = 1 Then\n        UserForm1.tbDate2.Value = Calendar1.Value\n        UserForm1.cbMember2.SetFocus\n    End If\n\n' On Error GoTo dpexit 'disabled this for you to test your code\n\n    If UserForm2.ActiveControl.Name = \"TextBox1\" Then\n        UserForm2.TextBox1.Value = Calendar1.Value\n    End If\n    If UserForm2.ActiveControl.Name = \"TextBox2\" Then\n        UserForm2.TextBox2.Value = Calendar1.Value\n    ElseIf UserForm2.ActiveControl.Name = \"TextBox3\" Then\n        UserForm2.TextBox3.Value = Calendar1.Value\n    End If\n\ndpexit:\n    Me.Hide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472742714, "creation_date": 1472046930, "last_edit_date": 1531164843, "question_id": 39125309, "link": "https://stackoverflow.com/questions/39125309/set-value-for-other-userform-controls-on-userform-close", "title": "set value for other userform controls on userform close", "body": "<p>really struggling with this one, found a solution for the time being but it's not really a satisfactory one.\nI have a workbook with two user forms, one to input data and one to search for previously entered data and a third user form designed as a date picker form which is set to activate on entry of a designated date text box. </p>\n\n<p>Individually I have no problem, the user clicks the text box and the date picker form appears, they make their selection which closes the date picker form and adds the date to the text box. On the \"input data\" form I have a multi page with a single date selection text box on each of the two pages, on the \"find data\" form I have an option to search a single date or a range, 3 date selection text boxes in total.</p>\n\n<p>now I am noticing that userform1 (input data) is prompting a run time error 91 - object variable or With block variable not set and is flagging the first line for userform2 in the code whenever I select a date from the date picker form.</p>\n\n<p>what I did notice however was that the correct date was still being entered into the textbox so as a fix I added an 'On error goto' line above the highlighted line which is allowing the action to take place without interruption. What I did notice was that now if I enter a date anywhere on userform2 (find data) and then close the form and decide I want to enter data instead, the text box on userform1 will contain whatever the previous selection was on userform2. What is especially puzzlng about this to me is that the initialize event for UF1 enters the current date in the date text box.</p>\n\n<p>see code below, is there a much better way to write this? I hope I explained well enough, please let me know if I can provide additional details to help.</p>\n\n<pre><code>Sub CloseDatePicker(save As Boolean)\n\n  If UserForm1.MultiPage1.Value = 0 Then\n  UserForm1.tbDate.Text = Calendar1.Value\n  UserForm1.cbMember.SetFocus\n  ElseIf UserForm1.MultiPage1.Value = 1 Then\n  UserForm1.tbDate2.Text = Calendar1.Value\n  UserForm1.cbMember2.SetFocus\n End If\n\n On Error GoTo dpexit\n\nIf UserForm2.ActiveControl.Name = \"TextBox1\" Then\nUserForm2.TextBox1.Text = Calendar1.Value\nEnd If\n If UserForm2.ActiveControl.Name = \"TextBox2\" Then\n UserForm2.TextBox2.Text = Calendar1.Value\n ElseIf UserForm2.ActiveControl.Name = \"TextBox3\" Then\n UserForm2.TextBox3.Text = Calendar1.Value\n End If\n\ndpexit:\n    Me.Hide\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "save", "before-save"], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1472048068, "post_id": 39124931, "comment_id": 65597077, "body": "Still, whenever i click browse, to check for a place to save the file, the macro runs, even with your code instead of         Cancel = true"}, {"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1472051566, "post_id": 39124931, "comment_id": 65599681, "body": "Ufortunately not. should i paste this code instead of  Cancel = True  ? It was the only change i&#39;ve made in my code. It breaks at &quot;return&quot;."}], "tags": [], "owner": {"reputation": 6378, "user_id": 1240844, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ca8b6b5e4d3b56dedafb833999f3b57f?s=128&d=identicon&r=PG", "display_name": "Hein Andre Gr&#248;nnestad", "link": "https://stackoverflow.com/users/1240844/hein-andre-gr%c3%b8nnestad"}, "is_accepted": false, "score": 2, "last_activity_date": 1472051121, "last_edit_date": 1472051121, "creation_date": 1472045956, "answer_id": 39124931, "question_id": 39124904, "link": "https://stackoverflow.com/questions/39124904/before-save-does-not-work-with-save-as/39124931#39124931", "title": "Before save does not work with save as", "body": "<p>Because of <code>Cancel = True</code> I guess.</p>\n\n<p>You should probably use the <code>ByVal SaveAsUI As Boolean</code> flag to see if the user clicked \"Save as\". </p>\n\n<p>If you don't want the macro to run at all on \"Save as\", you could put this in the start of the method:</p>\n\n<pre><code>If SaveAsUI Then\n    Return\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472051121, "creation_date": 1472045850, "question_id": 39124904, "link": "https://stackoverflow.com/questions/39124904/before-save-does-not-work-with-save-as", "title": "Before save does not work with save as", "body": "<p>I have made a macro that protects the sheet and changes sheet to sheet \"A\", then saves the file and after that comes back to the sheet I have started in.   </p>\n\n<p>Unfortunately, the Save as option does not work when my macro is in the workbook. Whenever I click save as and want to search for a place to save my file in, the macro starts running, and disables the action I tried to take.</p>\n\n<p>This is the code I am writing about:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)  \n    Cancel = True  \n    Application.EnableCancelKey = XlEnableCancelKey.xlDisabled  \n    Application.ScreenUpdating = False  \n    Application.EnableEvents = False  \n    Dim aktywny As Worksheet    \n    Set aktywny = ActiveSheet   \nFor Each Sh In ThisWorkbook.Sheets  \n    If InStr(Sh.Name, \".\") &lt;&gt; 0 Then  \n        If Sh.ProtectContents = False Then  \n            Sh.Protect Password:=\"XXX\", DrawingObjects:=True,   Contents:=True, Scenarios:=True _  \n            , AllowFormattingCells:=True, AllowFormattingColumns:=True  \n        End If  \n    End If   \nNext  \nThisWorkbook.Sheets(\"A\").Activate  \nMe.Save  \naktywny.Activate  \nThisWorkbook.Saved = True  \nCancel = True  \nApplication.EnableEvents = True  \nApplication.ScreenUpdating = True  \nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 37, "user_id": 6384998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/197acd689802eff3100d5215b1b0f5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Valentin Ivan", "link": "https://stackoverflow.com/users/6384998/valentin-ivan"}, "edited": false, "score": 0, "creation_date": 1472052836, "post_id": 39125144, "comment_id": 65600553, "body": "@ValentinIvan Please mark as correct by clicking the check mark by the answer.  It is something only you can do."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1472046500, "creation_date": 1472046500, "answer_id": 39125144, "question_id": 39124864, "link": "https://stackoverflow.com/questions/39124864/input-box-value-insert-in-the-next-empty-cell-in-row-to-the-right/39125144#39125144", "title": "Input box value insert in the next empty cell in row to the right", "body": "<p>The End(xlToRight is only going to the end of the populated cells not the next open one.  You need to move one more column over after finding the last populated cell.  Use Cells() and I prefere staring at the furthest column and coming back.   </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    If Range(\"E1\").Value = \"\" Then Range(\"E1\").Value = UserForm2.TextBox1.Value Else\n    Cells(1, Cells(1, Columns.Count).End(xlToLeft).Column + 1).Value = UserForm2.TextBox1.Value\n    If Range(\"E2\").Value = \"\" Then Range(\"E2\").Value = UserForm2.TextBox2.Value Else\n    Cells(2, Cells(2, Columns.Count).End(xlToLeft).Column + 1).Value = UserForm2.TextBox2.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6384998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/197acd689802eff3100d5215b1b0f5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Valentin Ivan", "link": "https://stackoverflow.com/users/6384998/valentin-ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 39125144, "answer_count": 1, "score": 1, "last_activity_date": 1472046500, "creation_date": 1472045743, "last_edit_date": 1472046198, "question_id": 39124864, "link": "https://stackoverflow.com/questions/39124864/input-box-value-insert-in-the-next-empty-cell-in-row-to-the-right", "title": "Input box value insert in the next empty cell in row to the right", "body": "<p>I am trying to add to the next empty cells to the right, the data from the user form text box, if data already exists. Meaning if \"E1\" is has date, add to \"F1\" and so on, but only is the range \"E1:S1\".</p>\n\n<p>Here is a screenshot of the report:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yNTuM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yNTuM.png\" alt=\"enter image description here\"></a> </p>\n\n<p>And here is what I've got so far (but it stops as E1):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    If Range(\"E1\") = \"\" Then Range(\"E1\") = UserForm2.TextBox1.Value Else\n    Range(\"E1\").End(xlToRight) = UserForm2.TextBox1.Value\n    If Range(\"E2\") = \"\" Then Range(\"E2\") = UserForm2.TextBox2.Value Else\n    Range(\"E2\").End(xlToRight) = UserForm2.TextBox2.Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472042982, "post_id": 39123736, "comment_id": 65593075, "body": "You&#39;ll need to post more of the code.  It&#39;s impossible to tell where the error is coming from with only one line."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1472042994, "creation_date": 1472042994, "answer_id": 39123814, "question_id": 39123736, "link": "https://stackoverflow.com/questions/39123736/vba-copy-range-of-rows/39123814#39123814", "title": "VBA copy range of rows", "body": "<p>Yes, change your line</p>\n\n<pre><code>.Rows(i_cls_frst_row, i_cls_last_row).Copy\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>.Rows(i_cls_frst_row &amp; \":\" &amp; i_cls_last_row).Copy\n</code></pre>\n\n<p>Then later on you can paste it where you need</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472043163, "post_id": 39123833, "comment_id": 65593210, "body": "first time ever typing faster than you :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472043214, "post_id": 39123833, "comment_id": 65593249, "body": "True... But I was covering both scenarios ;)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1472043201, "last_edit_date": 1472043201, "creation_date": 1472043038, "answer_id": 39123833, "question_id": 39123736, "link": "https://stackoverflow.com/questions/39123736/vba-copy-range-of-rows/39123833#39123833", "title": "VBA copy range of rows", "body": "<p>Is this what you are trying?</p>\n\n<p>If you have non contiguous rows like <code>i_cls_frst_row=1</code> and <code>i_cls_last_row=3</code> and you are trying to copy two rows then try this</p>\n\n<pre><code>Range(i_cls_frst_row &amp; \":\" &amp; i_cls_frst_row &amp; \",\" &amp; _\n      i_cls_last_row &amp; \":\" &amp; i_cls_last_row).Copy\n</code></pre>\n\n<p>If you are trying to copy from <code>i_cls_frst_row</code> to <code>i_cls_last_row</code> then try this</p>\n\n<pre><code>Rows(i_cls_frst_row &amp; \":\" &amp; i_cls_last_row).Copy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 5887081, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5621635a054d8f914bee3beac8d23f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Eswemenasja", "link": "https://stackoverflow.com/users/5887081/eswemenasja"}, "edited": false, "score": 0, "creation_date": 1531981748, "post_id": 39123872, "comment_id": 89802605, "body": "That is so old that I dont remember if I&#39;ve tested your solution and for some reason it didn&#39;t work. siddhart provided proper answer and let&#39;s stick to that."}], "tags": [], "owner": {"reputation": 188, "user_id": 6637965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf4abad9b6d8b3695bcc49bd57a45559?s=128&d=identicon&r=PG&f=1", "display_name": "Sumeet Gupta", "link": "https://stackoverflow.com/users/6637965/sumeet-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1472043134, "creation_date": 1472043134, "answer_id": 39123872, "question_id": 39123736, "link": "https://stackoverflow.com/questions/39123736/vba-copy-range-of-rows/39123872#39123872", "title": "VBA copy range of rows", "body": "<p>You can define a Range object and select all the required rows/row as a Range</p>\n\n<pre><code>Dim example As Range\nSet example = Range(\"A1:E1\")\nexample.Select\nSelection.Copy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "is_accepted": false, "score": 1, "last_activity_date": 1531882738, "last_edit_date": 1531882738, "creation_date": 1531882220, "answer_id": 51392875, "question_id": 39123736, "link": "https://stackoverflow.com/questions/39123736/vba-copy-range-of-rows/51392875#51392875", "title": "VBA copy range of rows", "body": "<p>Use a range of rows:</p>\n\n<pre><code>Range(Rows(i_cls_frst_row), Rows(i_cls_last_row)).Copy\n</code></pre>\n\n<p>Or a Range's EntireRow property:</p>\n\n<pre><code>Range(Cells(i_cls_frst_row, 1), Cells(i_cls_last_row, 1)).EntireRow.Copy\n</code></pre>\n\n<p>You can also use a Range Resize, if you know the number or rows you wish to copy:</p>\n\n<pre><code>Rows(i_cls_frst_row).Resize(2).copy\n(this copies 2 rows)\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5887081, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5621635a054d8f914bee3beac8d23f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Eswemenasja", "link": "https://stackoverflow.com/users/5887081/eswemenasja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4913, "favorite_count": 2, "accepted_answer_id": 39123833, "answer_count": 4, "score": 1, "last_activity_date": 1531882738, "creation_date": 1472042716, "last_edit_date": 1531164843, "question_id": 39123736, "link": "https://stackoverflow.com/questions/39123736/vba-copy-range-of-rows", "title": "VBA copy range of rows", "body": "<p>Is it possible to copy range of rows and paste those into other sheet?\nI've tried this but i get 1004 error:</p>\n\n<pre><code>.Rows(i_cls_frst_row, i_cls_last_row).Copy\n</code></pre>\n\n<p>Regards\nMicha\u0142</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 6752291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908fd1f7f8d1e8f99f973244f2966198?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/6752291/joe"}, "edited": false, "score": 0, "creation_date": 1472039139, "post_id": 39122423, "comment_id": 65590249, "body": "Here are the images: Image 1: <a href=\"http://i.stack.imgur.com/mFnaf.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/mFnaf.png</a> Image 2: <a href=\"http://i.stack.imgur.com/wvfXS.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/wvfXS.png</a>"}, {"owner": {"reputation": 2663, "user_id": 4618125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c579fbed5fe82f61263accf124e5a2f?s=128&d=identicon&r=PG", "display_name": "Rohan Sanap", "link": "https://stackoverflow.com/users/4618125/rohan-sanap"}, "edited": false, "score": 0, "creation_date": 1472039589, "post_id": 39122423, "comment_id": 65590572, "body": "Edit your question to include images in it."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472039922, "post_id": 39122423, "comment_id": 65590809, "body": "Sound like a typical case for <code>Unpivot</code>. You might want to google that. Here are two examples which should work for you: <a href=\"http://superuser.com/questions/78439/is-it-possible-to-unpivot-or-reverse-pivot-in-excel\" title=\"is it possible to unpivot or reverse pivot in excel\">superuser.com/questions/78439/&hellip;</a> OR here (with a YouTube video): <a href=\"https://www.youtube.com/watch?v=pUXJLzqlEPk\" rel=\"nofollow noreferrer\">youtube.com/watch?v=pUXJLzqlEPk</a>"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1472041800, "post_id": 39122423, "comment_id": 65592182, "body": "For each cell in Sheet1-columnA, loop 1 to 11 in Sheet2 copying Sheet1-ColumnA value and the concatenation of Category &amp; loop number."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6752291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908fd1f7f8d1e8f99f973244f2966198?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/6752291/joe"}, "edited": false, "score": 0, "creation_date": 1472039918, "post_id": 39122572, "comment_id": 65590807, "body": "I need a way of repeating the function differently otherwise I would have to write it out 272 times"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 1, "user_id": 6752291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908fd1f7f8d1e8f99f973244f2966198?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/6752291/joe"}, "edited": false, "score": 1, "creation_date": 1472041358, "post_id": 39122572, "comment_id": 65591902, "body": "@joe <code>for i=1 to 272</code>?"}, {"owner": {"reputation": 1, "user_id": 6752291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908fd1f7f8d1e8f99f973244f2966198?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/6752291/joe"}, "edited": false, "score": 0, "creation_date": 1472044681, "post_id": 39122572, "comment_id": 65594414, "body": "I would need to change the row index number for each formula"}], "tags": [], "owner": {"reputation": 188, "user_id": 6637965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf4abad9b6d8b3695bcc49bd57a45559?s=128&d=identicon&r=PG&f=1", "display_name": "Sumeet Gupta", "link": "https://stackoverflow.com/users/6637965/sumeet-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1472039539, "creation_date": 1472039539, "answer_id": 39122572, "question_id": 39122423, "link": "https://stackoverflow.com/questions/39122423/how-to-hlookup-from-one-worksheet-to-another-and-repeat-for-multiple-rows/39122572#39122572", "title": "How to hlookup from one worksheet to another and repeat for multiple rows", "body": "<p>If you know the formula you are supposed to be using on screen, the same forumla can be used through VBA macro code by using Application.WorksheetFunction</p>\n\n<pre><code>=VLOOKUP(XXXX)\n</code></pre>\n\n<p>can be written in Macro as </p>\n\n<pre><code>Application.WorksheetFunction.VLookup(XXXX)\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1472052331, "post_id": 39123519, "comment_id": 65600234, "body": "This code is clear and compact. Just needs the limits to encompass all data, and setting the sheet names (on the left of equal sign <code>Worksheets(&quot;Sheet1&quot;).Cells(blah, blah)</code> whereas on the right <code>Worksheets(&quot;Sheet2&quot;).Cells(blah, blah)</code>). +1 for simplicity."}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1472042483, "last_edit_date": 1472042483, "creation_date": 1472042161, "answer_id": 39123519, "question_id": 39122423, "link": "https://stackoverflow.com/questions/39122423/how-to-hlookup-from-one-worksheet-to-another-and-repeat-for-multiple-rows/39123519#39123519", "title": "How to hlookup from one worksheet to another and repeat for multiple rows", "body": "<p>based on the screenshots attached, this will do the job which will add the values respectively in the Columns A, B and C</p>\n\n<pre><code>Count = 4\n\nFor i = 4 To 18\n    For j = 5 To 15\n        Cells(Count, 1).Value = Cells(i, 4).Value\n        Cells(Count, 2).Value = Cells(i, j).Value\n        Cells(Count, 3).Value = Cells(3, j).Value\n        Count = Count + 1\n    Next j\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1472045349, "creation_date": 1472045349, "answer_id": 39124725, "question_id": 39122423, "link": "https://stackoverflow.com/questions/39122423/how-to-hlookup-from-one-worksheet-to-another-and-repeat-for-multiple-rows/39124725#39124725", "title": "How to hlookup from one worksheet to another and repeat for multiple rows", "body": "<p>Try with below. Kindly alter </p>\n\n<pre><code>Sub test()\n    Dim r As Range\n    Dim incre As Long\n    Dim distr As String\n    Set r = Range(\"D4:K6\")\n    incre = 4\n    incre2 = 4\n    For Each cell In r\n        If cell Like \"District*\" Then\n            distr = cell.Value\n        Else\n            Range(\"B\" &amp; incre).Value = cell.Value\n            Range(\"A\" &amp; incre).Value = distr\n            incre = incre + 1\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vGtjU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vGtjU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1472046504, "creation_date": 1472046504, "answer_id": 39125148, "question_id": 39122423, "link": "https://stackoverflow.com/questions/39122423/how-to-hlookup-from-one-worksheet-to-another-and-repeat-for-multiple-rows/39125148#39125148", "title": "How to hlookup from one worksheet to another and repeat for multiple rows", "body": "<p>Well, there are number of ways of achieving what you are trying to accomplish.</p>\n\n<p><strong><em>1. Using formula</em></strong></p>\n\n<p>In Cell <code>A4</code> of <code>Sheet2</code> enter the following formula and drag/copy down as required</p>\n\n<pre><code>=OFFSET(Sheet1!$D$4,FLOOR((ROW(Sheet1!D4)-ROW(Sheet1!$D$4))/11,1),0)\n</code></pre>\n\n<p>In Cell <code>C4</code> of <code>Sheet2</code>  enter the following formula and drag/copy down as required</p>\n\n<pre><code>=OFFSET(Sheet1!$E$4,FLOOR((ROW(Sheet1!E4)-ROW(Sheet1!$E$4))/11,1),MOD(ROW(Sheet1!D4)-ROW(Sheet1!$D$4),11))\n</code></pre>\n\n<p><strong><em>2. Using VBA</em></strong></p>\n\n<p><strong>Method I -</strong> Calculate values from <code>Sheet1</code> and update the range in <code>Sheet2</code></p>\n\n<pre><code>Sub Demo1()\n    Dim srcWB As Workbook\n    Dim srcWS As Worksheet, destWS As Worksheet\n    Dim lastRow As Long, lastCol As Long, i As Long, CategoryCnt As Long, temp\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Set srcWB = ThisWorkbook\n    Set srcWS = srcWB.Sheets(\"Sheet1\")\n    Set destWS = srcWB.Sheets(\"Sheet2\")\n    CategoryCnt = 11    '-&gt;enter number of categories\n    lastRow = srcWS.Cells(Rows.Count, \"D\").End(xlUp).Row    '-&gt;last row with data\n    lastCol = srcWS.Cells(3, Columns.Count).End(xlToLeft).Column    '-&gt;last column with data\n\n    For i = 4 To (lastRow - 4) * CategoryCnt\n        destWS.Cells(i, 1) = srcWS.Cells(Int((i - 4) / CategoryCnt) + 4, 4)\n        destWS.Cells(i, 3) = srcWS.Cells(Int((i - 4) / CategoryCnt) + 4, ((i - 4) Mod CategoryCnt) + 5)\n    Next i\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p><strong>Method II -</strong> Enter formula in <code>Sheet2</code> range</p>\n\n<pre><code>Sub Demo2()\n    Dim srcWB As Workbook\n    Dim srcWS As Worksheet, destWS As Worksheet\n    Dim lastRow As Long, lastCol As Long, i As Long, CategoryCnt As Long, temp\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Set srcWB = ThisWorkbook\n    Set srcWS = srcWB.Sheets(\"Sheet1\")\n    Set destWS = srcWB.Sheets(\"Sheet2\")\n    CategoryCnt = 11\n    lastRow = srcWS.Cells(Rows.Count, \"D\").End(xlUp).Row\n    lastCol = srcWS.Cells(3, Columns.Count).End(xlToLeft).Column\n\n    destWS.Range(\"A4\").Formula = \"=OFFSET(Sheet1!$D$4,FLOOR((ROW(Sheet1!D4)-ROW(Sheet1!$D$4))/11,1),0)\"\n    destWS.Range(\"C4\") = \"=OFFSET(Sheet1!$E$4,FLOOR((ROW(Sheet1!E4)-ROW(Sheet1!$E$4))/11,1),MOD(ROW(Sheet1!D4)-ROW(Sheet1!$D$4),11))\"\n    Range(\"A4:C4\").Select\n    Selection.AutoFill Destination:=destWS.Range(\"A4:C\" &amp; (lastRow - 4) * 11), Type:=xlFillDefault\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Let me know if anything is not clear.</p>\n\n<p>See image for reference:</p>\n\n<p><strong>Sheet1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/YkQOi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YkQOi.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LwekB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LwekB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6752291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908fd1f7f8d1e8f99f973244f2966198?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/6752291/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1472046504, "creation_date": 1472039063, "last_edit_date": 1472039705, "question_id": 39122423, "link": "https://stackoverflow.com/questions/39122423/how-to-hlookup-from-one-worksheet-to-another-and-repeat-for-multiple-rows", "title": "How to hlookup from one worksheet to another and repeat for multiple rows", "body": "<p>I have a worksheet (sheet 1) with 272 districts (column D4:D275) and each row has 11 categories (category names E3:O3) (See image 1):</p>\n\n<p><a href=\"http://i.stack.imgur.com/mFnaf.png\" rel=\"nofollow\">http://i.stack.imgur.com/mFnaf.png</a></p>\n\n<p>I need to rearrange this data (in sheet 2) so that each category has its own row (ie 272*11 rows altogether). (See image 2):</p>\n\n<p><a href=\"http://i.stack.imgur.com/wvfXS.png\" rel=\"nofollow\">http://i.stack.imgur.com/wvfXS.png</a></p>\n\n<p>I know this requires hlookup but I don't know how to write the VBA code for it. Please can somebody tell me what the code I require is and explain what each step does as I will have to do this on a number of different documents so will need to know how to adjust the code.</p>\n\n<p>Let me know if more info is needed</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472038633, "post_id": 39122217, "comment_id": 65589956, "body": "<a href=\"https://www.google.co.uk/search?q=get+range+value+vba&amp;sourceid=ie7&amp;rls=com.microsoft:en-GB:IE-Address&amp;ie=&amp;oe=&amp;safe=active&amp;gfe_rd=cr&amp;ei=3Ia9V8XpKZDCaPvoj6gC&amp;gws_rd=ssl\" rel=\"nofollow noreferrer\">google.co.uk/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1763007, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1908c575931f4885255b52664ebe07b9?s=128&d=identicon&r=PG", "display_name": "Sinros", "link": "https://stackoverflow.com/users/1763007/sinros"}, "edited": false, "score": 0, "creation_date": 1472039699, "post_id": 39122314, "comment_id": 65590646, "body": "Thank you for not giving me a link to a google search :) This is exactly what I was looking for! I simply replaced the 50 with ActiveSheet.ListObjects(&quot;TableNameHere&quot;).ListRows.Count and it loops on the whole table now."}, {"owner": {"reputation": 5023, "user_id": 4025874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JcYk0.jpg?s=128&g=1", "display_name": "Daniel Lee", "link": "https://stackoverflow.com/users/4025874/daniel-lee"}, "reply_to_user": {"reputation": 159, "user_id": 1763007, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1908c575931f4885255b52664ebe07b9?s=128&d=identicon&r=PG", "display_name": "Sinros", "link": "https://stackoverflow.com/users/1763007/sinros"}, "edited": false, "score": 0, "creation_date": 1472042602, "post_id": 39122314, "comment_id": 65592778, "body": "Updated answer with <code>ActiveSheet.ListObjects(&quot;TableNameHere&quot;).ListRows.Count</code>"}], "tags": [], "owner": {"reputation": 5023, "user_id": 4025874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JcYk0.jpg?s=128&g=1", "display_name": "Daniel Lee", "link": "https://stackoverflow.com/users/4025874/daniel-lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1472042582, "last_edit_date": 1472042582, "creation_date": 1472038763, "answer_id": 39122314, "question_id": 39122217, "link": "https://stackoverflow.com/questions/39122217/excel-vba-find-all-rows-with-a-specific-value-and-get-their-row-number/39122314#39122314", "title": "Excel VBA - Find all rows with a specific value and get their row number", "body": "<p>Look here: <a href=\"http://www.excel-easy.com/vba/range-object.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/range-object.html</a>    </p>\n\n<pre><code>For i = 1 To ActiveSheet.ListObjects(\"TableNameHere\").ListRows.Count\n    If Cells(i,5).Value = \"potato\" Then\n        Cells(i,2).Value = \"New value\"\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5556941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb640b0db3a149d77a54724f204db17?s=128&d=identicon&r=PG&f=1", "display_name": "PairrieNerd403", "link": "https://stackoverflow.com/users/5556941/pairrienerd403"}, "is_accepted": false, "score": 0, "last_activity_date": 1542146663, "creation_date": 1542146663, "answer_id": 53290200, "question_id": 39122217, "link": "https://stackoverflow.com/questions/39122217/excel-vba-find-all-rows-with-a-specific-value-and-get-their-row-number/53290200#53290200", "title": "Excel VBA - Find all rows with a specific value and get their row number", "body": "<p>Alternatively, just add \"<code>.DataBodyRange.Rows</code>\" to the end of the first line in your line \"For... Each\" structure.  You're asking VBA to iterate through each <code>Row</code> in a <code>ListObject</code>, rather each <code>Row</code> in the collection of <code>Rows</code> contained <em>within</em> the <code>ListObject</code>.</p>\n\n<p>That allows sticking with the more elegant, readable, and reliable 'For...Each' structure rather than fetching range bounds and traversing it using counters.  Using the <code>DataBodyRange</code> property of the list allows you to automatically handle any Header rows that may be present and not include them in your row inspection loop.  You can reference the <code>ListObject.Rows</code> collection instead if you want Headers included.</p>\n\n<p>Final code would look something like:</p>\n\n<pre><code>For Each row In ActiveSheet.ListObjects(\"SheetPotatoData\").DataBodyRows.Rows\n    if row.Cells(1,5) = \"potato\"\n        'Do something\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 1763007, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1908c575931f4885255b52664ebe07b9?s=128&d=identicon&r=PG", "display_name": "Sinros", "link": "https://stackoverflow.com/users/1763007/sinros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15831, "favorite_count": 0, "accepted_answer_id": 39122314, "answer_count": 2, "score": 0, "last_activity_date": 1542146663, "creation_date": 1472038472, "question_id": 39122217, "link": "https://stackoverflow.com/questions/39122217/excel-vba-find-all-rows-with-a-specific-value-and-get-their-row-number", "title": "Excel VBA - Find all rows with a specific value and get their row number", "body": "<p>I have close to zero knowledge in excel and vba.\nWhat I'm trying to do the the following:</p>\n\n<pre><code>for each row in ActiveSheet.ListObjects(\"SheetPotatoData\")\n    if cell (column 5):(row) value equals \"potato\"\n        do something with (column 2):(row)\n</code></pre>\n\n<p>I would really appreciate it if you could enlighten me on the proper syntax to do this.</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["vba", "excel", "filter", "copy"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4273049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-r9a0-9GZhBk/AAAAAAAAAAI/AAAAAAAARPo/aTa4rFVBB7U/photo.jpg?sz=128", "display_name": "Ananya Pandey", "link": "https://stackoverflow.com/users/4273049/ananya-pandey"}, "edited": false, "score": 0, "creation_date": 1472040778, "post_id": 39122216, "comment_id": 65591479, "body": "Can you write an example (complete lne of code)so that i can apply it on my sheet."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 127, "user_id": 4273049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-r9a0-9GZhBk/AAAAAAAAAAI/AAAAAAAARPo/aTa4rFVBB7U/photo.jpg?sz=128", "display_name": "Ananya Pandey", "link": "https://stackoverflow.com/users/4273049/ananya-pandey"}, "edited": false, "score": 0, "creation_date": 1523110973, "post_id": 39122216, "comment_id": 86430038, "body": "@AnanyaPandey  This isn&#39;t a &quot;free code writing service&quot;.  Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 127, "user_id": 4273049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-r9a0-9GZhBk/AAAAAAAAAAI/AAAAAAAARPo/aTa4rFVBB7U/photo.jpg?sz=128", "display_name": "Ananya Pandey", "link": "https://stackoverflow.com/users/4273049/ananya-pandey"}, "edited": false, "score": 1, "creation_date": 1528797276, "post_id": 39122216, "comment_id": 88633449, "body": "With all due respect Mister, I am not asking for free service, I tried i failed and seeking help here i am learning, Thank you for your valuable comment."}], "tags": [], "owner": {"reputation": 11, "user_id": 5168904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b917f8e7c5462aaf0ce56be0b147064?s=128&d=identicon&r=PG&f=1", "display_name": "Marek", "link": "https://stackoverflow.com/users/5168904/marek"}, "is_accepted": false, "score": 0, "last_activity_date": 1472118024, "last_edit_date": 1472118024, "creation_date": 1472038468, "answer_id": 39122216, "question_id": 39121960, "link": "https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba/39122216#39122216", "title": "Copy filtered data to another sheet using VBA", "body": "<p>When i need to copy data from filtered table i use range.SpecialCells(xlCellTypeVisible).copy. Where the range is range of all data (without a filter).</p>\n\n<p>Example:</p>\n\n<pre><code>Sub copy()\n     'source worksheet\n     dim ws as Worksheet\n     set ws = Application.Worksheets(\"Data\")' set you source worksheet here\n     dim data_end_row_number as Integer\n     data_end_row_number = ws.Range(\"B3\").End(XlDown).Row.Number\n    'enable filter\n    ws.Range(\"B2:F2\").AutoFilter Field:=2, Criteria1:=\"hockey\", VisibleDropDown:=True\n    ws.Range(\"B3:F\" &amp; data_end_row_number).SpecialCells(xlCellTypeVisible).Copy\n    Application.Worksheets(\"Hoky\").Range(\"B3\").Paste\n    'You have to add headers to Hoky worksheet\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 4273049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-r9a0-9GZhBk/AAAAAAAAAAI/AAAAAAAARPo/aTa4rFVBB7U/photo.jpg?sz=128", "display_name": "Ananya Pandey", "link": "https://stackoverflow.com/users/4273049/ananya-pandey"}, "edited": false, "score": 0, "creation_date": 1472107457, "post_id": 39126147, "comment_id": 65620965, "body": "It worked fine. Thanks. and i got the idea although i have to know more about the offset function."}, {"owner": {"reputation": 1821, "user_id": 7353562, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1358578430859865/picture?type=large", "display_name": "Arpan Saini", "link": "https://stackoverflow.com/users/7353562/arpan-saini"}, "edited": false, "score": 0, "creation_date": 1503366766, "post_id": 39126147, "comment_id": 78573388, "body": "This is a very time consuming process and take lot of time to read each row and copy it to another sheet, Sheet will hang when you have data in thousands record"}], "tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 0, "last_activity_date": 1472049015, "creation_date": 1472049015, "answer_id": 39126147, "question_id": 39121960, "link": "https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba/39126147#39126147", "title": "Copy filtered data to another sheet using VBA", "body": "<p>I suggest you do it a different way. </p>\n\n<p>In the following code I set as a <code>Range</code> the column with the sports name F and <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\">loop through each cell</a> of it, check if it is \"hockey\" and if yes I insert the values in the other sheet one by one, by using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow\">Offset</a>.</p>\n\n<p>I do not think it is very complicated and even if you are just learning VBA, you should probably be able to understand every step. Please let me know if you need some clarification</p>\n\n<pre><code>Sub TestThat()\n\n'Declare the variables\nDim DataSh As Worksheet\nDim HokySh As Worksheet\nDim SportsRange As Range\nDim rCell As Range\nDim i As Long\n\n'Set the variables\nSet DataSh = ThisWorkbook.Sheets(\"Data\")\nSet HokySh = ThisWorkbook.Sheets(\"Hoky\")\n\nSet SportsRange = DataSh.Range(DataSh.Cells(3, 6), DataSh.Cells(Rows.Count, 6).End(xlUp))\n    'I went from the cell row3/column6 (or F3) and go down until the last non empty cell\n\n    i = 2\n\n    For Each rCell In SportsRange 'loop through each cell in the range\n\n        If rCell = \"hockey\" Then 'check if the cell is equal to \"hockey\"\n\n            i = i + 1                                'Row number (+1 everytime I found another \"hockey\")\n            HokySh.Cells(i, 2) = i - 2               'S No.\n            HokySh.Cells(i, 3) = rCell.Offset(0, -1) 'School\n            HokySh.Cells(i, 4) = rCell.Offset(0, -2) 'Background\n            HokySh.Cells(i, 5) = rCell.Offset(0, -3) 'Age\n\n        End If\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 11910627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8d11d528cfff3ce78c5ac7702276f5?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Gee", "link": "https://stackoverflow.com/users/11910627/florian-gee"}, "edited": false, "score": 0, "creation_date": 1605688173, "post_id": 45807755, "comment_id": 114724783, "body": "SpecialCells(xlCellTypeVisible) was exactly what I was looking for. Thanks!"}], "tags": [], "owner": {"reputation": 1821, "user_id": 7353562, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1358578430859865/picture?type=large", "display_name": "Arpan Saini", "link": "https://stackoverflow.com/users/7353562/arpan-saini"}, "is_accepted": true, "score": 11, "last_activity_date": 1503366880, "last_edit_date": 1503366880, "creation_date": 1503366386, "answer_id": 45807755, "question_id": 39121960, "link": "https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba/45807755#45807755", "title": "Copy filtered data to another sheet using VBA", "body": "<p><strong>Best way of doing it</strong></p>\n\n<p>Below code is to copy the visible data in DBExtract sheet, and paste it into duplicateRecords sheet, with only filtered values. Range selected by me is the maximum range that can be occupied by my data. You can change it as per your need. </p>\n\n<pre><code>  Sub selectVisibleRange()\n\n    Dim DbExtract, DuplicateRecords As Worksheet\n    Set DbExtract = ThisWorkbook.Sheets(\"Export Worksheet\")\n    Set DuplicateRecords = ThisWorkbook.Sheets(\"DuplicateRecords\")\n\n    DbExtract.Range(\"A1:BF9999\").SpecialCells(xlCellTypeVisible).Copy\n    DuplicateRecords.Cells(1, 1).PasteSpecial\n\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14402799, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/629306410bb3b204701208edd73f4a8f?s=128&d=identicon&r=PG", "display_name": "Chunsah", "link": "https://stackoverflow.com/users/14402799/chunsah"}, "is_accepted": false, "score": 0, "last_activity_date": 1602007742, "creation_date": 1602007742, "answer_id": 64231499, "question_id": 39121960, "link": "https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba/64231499#64231499", "title": "Copy filtered data to another sheet using VBA", "body": "<p>it needs to be .Row.count not Row.Number?</p>\n<p>That's what I used and it works fine\nSub TransfersToCleared()\nDim ws As Worksheet\nDim LastRow As Long\nSet ws = Application.Worksheets(&quot;Export (2)&quot;) 'Data Source\nLastRow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\nws.Range(&quot;A2:AB&quot; &amp; LastRow).SpecialCells(xlCellTypeVisible).Copy</p>\n"}], "owner": {"reputation": 127, "user_id": 4273049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-r9a0-9GZhBk/AAAAAAAAAAI/AAAAAAAARPo/aTa4rFVBB7U/photo.jpg?sz=128", "display_name": "Ananya Pandey", "link": "https://stackoverflow.com/users/4273049/ananya-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104352, "favorite_count": 1, "accepted_answer_id": 45807755, "answer_count": 4, "score": 5, "last_activity_date": 1602007742, "creation_date": 1472037690, "last_edit_date": 1523110914, "question_id": 39121960, "link": "https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba", "title": "Copy filtered data to another sheet using VBA", "body": "<p>I have two sheets. One has the complete data and the other is based on the filter applied on the first sheet. </p>\n\n<p>Name of the data sheet : <code>Data</code><br>\nName of the filtered Sheet : <code>Hoky</code></p>\n\n<p>I am just taking a small portion of data for simplicity.  MY objective is to copy the data from Data Sheet, based on the filter.  I have a macro which somehow works but its hard-coded and is a recorded macro. </p>\n\n<p>My problems are:</p>\n\n<ol>\n<li>The number of rows is different everytime. (manual effort)  </li>\n<li>Columns are not in order. </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/lXflM.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/lXflM.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/fS8EY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fS8EY.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TESTTHIS()\n'\n' TESTTHIS Macro\n'\n'FILTER\nRange(\"F2\").Select\nSelection.AutoFilter\nActiveSheet.Range(\"$B$2:$F$12\").AutoFilter Field:=5, Criteria1:=\"hockey\"\n\n'Data Selection and Copy\nRange(\"C3\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets(\"Hockey\").Select\nRange(\"E3\").Select\nActiveSheet.Paste\n\nSheets(\"Data\").Select\nRange(\"D3\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Hockey\").Select\nRange(\"D3\").Select\nActiveSheet.Paste\n\nSheets(\"Data\").Select\nRange(\"E3\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Hockey\").Select\nRange(\"C3\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1472042646, "post_id": 39121469, "comment_id": 65592806, "body": "You should write Option Explicit at the top of your code, in every module/userform. I&#39;m not sure what you mean by initialize, but when if you want to check the value of a public variable in another module, say <code>Public strValue as String</code> written in Module1, and you want to access that in your userForm, you can specify <code>Module1.strValue</code> so it knows where to find it."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472038210, "post_id": 39121601, "comment_id": 65589666, "body": "not working, and how it supposed to work any way? There is no link between subs. And I can not put another sub in one sub, it will divide it. I can pass the variable with call subname but there are 3 different clicks refer to same variable so call does not give me any solution."}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 1, "creation_date": 1472038414, "post_id": 39121601, "comment_id": 65589804, "body": "the variable &#39;Name&#39; is defined as a global variable. when you run button_click, you enter the name and it is stored to the variable. and when you run Foo() the previously entered name will be alerted as &#39;Name&#39; is defined global to be accessed by every Subs. And this is perfectly working for me"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472038836, "post_id": 39121601, "comment_id": 65590050, "body": "make sure you define the variable <code>name</code> as global outside all the subs <code>Public Name As String</code> and you will be able to access it in all the Subs"}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472039094, "post_id": 39121601, "comment_id": 65590215, "body": "I am trying but it gives error when I try to define it since it is not in between any subs. If it works perfectly for you, i will try more, maybe i miss something.   Can I ask another question? lets say I have  private sub button1_click() name=john end sub  private sub button2_click() name=james end sub  private sub button3_click() name=david end sub   So the user has 3 marking options, when it clicks one of them it will go to one of the button clicks. Can I read only the name chosen with your method?"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472040506, "post_id": 39121601, "comment_id": 65591290, "body": "variable will hold the name from last clicked button. and when you are manually assigning the name like <code>name=&quot;john&quot;</code> then make sure you are not missing <code>&quot;</code>"}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472041007, "post_id": 39121601, "comment_id": 65591655, "body": "your code is working on a empty module thats correct but I don&#39;t get anything useful for my situation unfortunately :(   I define my variables public, but what happens next? How do I open the userform first than it will continue with the rest of the macro? Userform has a lot of subs so it is not what I expected.   Also I couldn&#39;t initialize my public variables :/"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472041390, "post_id": 39121601, "comment_id": 65591917, "body": "look at my edited answer, and if this isn&#39;t what you are looking for, then it looks like i need to see your full code and understand what you are trying to do"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472044435, "post_id": 39121601, "comment_id": 65594216, "body": "look at <code>David G</code> answer, when i try to get the value of <code>WeekCov11</code> through a button in the user form <code>ROL_Analysis</code> i get the value as 4"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1472041205, "last_edit_date": 1472041205, "creation_date": 1472036765, "answer_id": 39121601, "question_id": 39121469, "link": "https://stackoverflow.com/questions/39121469/how-to-use-the-results-of-user-form-in-another-macro/39121601#39121601", "title": "How to use the results of User Form in another macro?", "body": "<p>To access a variable in a different sub, you define it globally</p>\n\n<pre><code>Public Name As String\n\nPrivate Sub button_click()\n    Name = InputBox(\"Please enter your name:\")\nEnd Sub\n\nSub Foo()\n    MsgBox Name\nEnd Sub\n</code></pre>\n\n<p>and for your second question, if you are clicking on the buttons, then for the below code you will get a alert if you have clicked the button which corresponds to the name you typed in the InputBox</p>\n\n<pre><code>Public name As String\n\nSub button_click()\n    name = InputBox(\"Please enter your name:\")\nEnd Sub\n\nPrivate Sub button1_click()\n    If name = \"john\" Then\n        MsgBox name\n    End If\nEnd Sub\n\nPrivate Sub button2_click()\n    If name = \"james\" Then\n        MsgBox name\n    End If\nEnd Sub\n\nPrivate Sub button3_click()\n    If name = \"david\" Then\n        MsgBox name\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1472043527, "post_id": 39123891, "comment_id": 65593493, "body": "If you want to change the <code>name</code> variable with the userform, you can use <code>Module1.name =  &quot;something&quot;</code> at any time and it will last after the userform closes as well. For example, you could have a <code>public intCounter as integer</code> in Module1 and clicking a button will increment <code>Module1.intCounter</code>. At the end of Module1 if you ask a msgbox to show <code>intCounter</code> it will show it properly even though the form is closed."}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472054502, "post_id": 39123891, "comment_id": 65601649, "body": "First, thanks for all the effort. I initialize it because I used this macro before userform. So the variables has initial values if the user leave inputbox blank. We can say their default values. So I will put 3 option button, user can choose the country. When the user choose the canada option, the country variable should be canada now on. Think that there is one big macro with working canada variable before, now the same macro should open the user form, get the input and should continue with this input. If i used call, the answer will change depending on my call rather than choice."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472058141, "post_id": 39123891, "comment_id": 65603724, "body": "So if your public string, say &quot;strCountry&quot;, is declared in module1, and that is also where you have your macro. In the click event of the button on the userform, write <code>Module1.strCountry = &quot;Canada&quot;</code> So everytime someone clicks the &quot;Canada&quot; button, it will change the public string to &quot;Canada&quot;. If it&#39;s not a button but it&#39;s a list, and Canada is one of the values, in the click event, you would write something like &quot;Module1.strCountry = MyList.Value&quot;. If the value was &quot;Canada&quot; when the user clicked it, the strCountry is now worth &quot;Canada&quot;, if it was &quot;India&quot;, then strCountry is worth &quot;india&quot;, etc"}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472107625, "post_id": 39123891, "comment_id": 65621054, "body": "Private Sub ROLparameter_Click() Line1: RolLow = InputBox(&quot;Please enter the lower bound percentage for ROL calculation between 0 and 100 (initially &quot; &amp; RolLow &amp; &quot;%):&quot;)  If Not 0 &lt;= RolLow &lt;= 100 Then GoTo Line1   End Sub"}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472107794, "post_id": 39123891, "comment_id": 65621171, "body": "Could you look at the code above also? I don&#39;t know why but if function not working properly. (I can not change its view to code therefore i will add to main question also.) So when I enter the variable RolLow, it should check if it is in the defined range. But it is not checking. If i put &quot;if&quot; it is always asking, if i put &quot;if not&quot; it always takes it true. It also not accepting the end if saying that &quot;endif without if&quot;. Do you know why?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1472164967, "post_id": 39123891, "comment_id": 65655091, "body": "Did you manage to make your original question work with what I wrote in my answer? If yes, please mark it as accepted and make a new question for that one. Stack Overflow is less a help group, and more of a question/answer repository."}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1472043175, "creation_date": 1472043175, "answer_id": 39123891, "question_id": 39121469, "link": "https://stackoverflow.com/questions/39121469/how-to-use-the-results-of-user-form-in-another-macro/39123891#39123891", "title": "How to use the results of User Form in another macro?", "body": "<p>As was said, define a variable globally to access it in different subs and different modules. I have a very simple example here for you. I created a module called Module1. Here is all its code:</p>\n\n<pre><code>Option Explicit\nPublic name As String\n\nSub Test()\n    name = \"David\"\n    UserForm1.Show\n    MsgBox \"The userform has closed\"\nEnd Sub\n</code></pre>\n\n<p>I also created a userform called UserForm1. Here is all the code and a screenshot of it:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    MsgBox Module1.name\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/M0sCN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M0sCN.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>How it works:</strong></p>\n\n<p>If I launch Module1, the <code>public</code> variable <code>name</code> gets set to \"David\". In your case you could set it to whatever you want with your inputbox. After that, the userform is launched with <code>.Show</code> and the Module1 stops reading code until you're done with UserForm1.</p>\n\n<p>While Userform1 is active, clicking the button will open a MsgBox saying \"David\", because I access the public variable <code>Module1.name</code>. I always specify which module the public variable comes from. When I close the userform, Module1 gets activated again and I get a msgbox saying \"The userform has closed\". </p>\n\n<p>Does this answer all your questions?</p>\n\n<p>Clicking the button:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6dMlR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6dMlR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Closing the form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EzRok.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EzRok.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2016, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472107816, "creation_date": 1472036408, "last_edit_date": 1531164843, "question_id": 39121469, "link": "https://stackoverflow.com/questions/39121469/how-to-use-the-results-of-user-form-in-another-macro", "title": "How to use the results of User Form in another macro?", "body": "<p>I have a userform, lets say when I click the button name in the userform it will request me to enter a name and it is always stored in </p>\n\n<pre><code>private sub button_click()\n  name = inputbox(\"Please enter your name:\")\nend sub\n</code></pre>\n\n<p>The thing I want is, when I start the macro first user form will appear then after user enters the necessary information, the variables values' will last until the end of the main macro.</p>\n\n<p>I am searching for last two days couldn't find a solution but who knows maybe I couldn't find it. Therefore, i am writing here. Thanks in advance!</p>\n\n<p>`\nanother question related:</p>\n\n<p>lets say I have</p>\n\n<pre><code>    Public plant As Variant\nPublic checking As Variant\nPublic MeanCov1 As Variant\nPublic MeanCov2 As Variant\nPublic MeanCov3 As Variant\nPublic WeekCov1 As Variant\nPublic WeekCov2 As Variant\nPublic WeekCov3 As Variant\nPublic RolLow As Variant\nPublic RolHigh As Variant\nPublic ServiceLevel As Variant\nPublic TrendMultiplier As Variant\nPublic WeekCov11 As Variant\nPublic WeekCov22 As Variant\nPublic WeekCov33 As Variant\n\nSub initialize()\nMeanCov1 = 0.3\nMeanCov2 = 0.5\nMeanCov3 = 0.7\nWeekCov1 = 18\nWeekCov2 = 13\nWeekCov3 = 8\nWeekCov11 = -14 + WeekCov1\nWeekCov22 = -14 + WeekCov2\nWeekCov33 = -14 + WeekCov3\n\nRolLow = 0.3\nRolHigh = 0.7\n\nTrendMultiplier = 4\n\nROL_Analysis.Show\nApplication.Run (\"ROL_Analysis_Macro\")\n\nEnd Sub\n</code></pre>\n\n<p>I can not initialize the public variables, for example in user form it says show variable values but when I click it is completely empty</p>\n\n<pre><code>Private Sub ROLparameter_Click()\nLine1: RolLow = InputBox(\"Please enter the lower bound percentage for ROL calculation between 0 and 100 (initially \" &amp; RolLow &amp; \"%):\")\n\nIf Not 0 &lt;= RolLow &lt;= 100 Then GoTo Line1\n\nLine2: RolHigh = InputBox(\"Please enter the upper bound percentage for ROL calculation between 0 and 100 (initially \" &amp; RolHigh &amp; \"%):\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "adodb", "vba"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1472038712, "post_id": 39120827, "comment_id": 65589996, "body": "Please show us your code."}], "answers": [{"tags": [], "owner": {"reputation": 807, "user_id": 2940478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Wcj9.jpg?s=128&g=1", "display_name": "some1", "link": "https://stackoverflow.com/users/2940478/some1"}, "is_accepted": false, "score": 0, "last_activity_date": 1472104926, "creation_date": 1472104926, "answer_id": 39137731, "question_id": 39120827, "link": "https://stackoverflow.com/questions/39120827/how-can-read-chines-character-from-excel-adodb-connection/39137731#39137731", "title": "How can read chines character from excel (ADODB Connection)", "body": "<p>if you are using something like below, there should not be a problem to get the data in Chinese or other Unicode characters. There could be problem if you do a  WScript.Echo(unicodeString) to the console, or if you try to pass that data into some other databases or applications which do not support Unicode.</p>\n\n<pre><code>Set cn = CreateObject(\"ADODB.Connection\")\ncn.Provider = \"Microsoft.Jet.OLEDB.4.0\"\ncn.Properties(\"Extended Properties\").Value = \"Excel 8.0;\"\ncn.Open \"Excel.xls\"\nSet rs = cn.Execute(\"select * from [Sheet1]\")\n</code></pre>\n\n<p>please do post your code and highlight the section which produce unexpected output.</p>\n"}], "owner": {"reputation": 9, "user_id": 1892565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3452b16874ec8e9893b211094ff12c66?s=128&d=identicon&r=PG", "display_name": "user1892565", "link": "https://stackoverflow.com/users/1892565/user1892565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472104926, "creation_date": 1472034675, "last_edit_date": 1531164843, "question_id": 39120827, "link": "https://stackoverflow.com/questions/39120827/how-can-read-chines-character-from-excel-adodb-connection", "title": "How can read chines character from excel (ADODB Connection)", "body": "<p>I have a Excel file with English and Chines character when I try to read the file it gives me weird characters <em>(?? for Chinese character</em>)How can I make it give me the correct Chinese characters?</p>\n\n<p>I am using ADODB connection for reading data from excel.</p>\n\n<p>Thanks\nRavi K </p>\n"}, {"tags": ["vba", "http", "ms-word", "ms-office", "winhttprequest"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1472041619, "post_id": 39120740, "comment_id": 65592077, "body": "Are you using <code>Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;)</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 463, "user_id": 4470188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9ab9ce55bd91c50297c49f8d4d0f56dc?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkmeja101", "link": "https://stackoverflow.com/users/4470188/gurkmeja101"}, "is_accepted": true, "score": 0, "last_activity_date": 1472042432, "creation_date": 1472042432, "answer_id": 39123620, "question_id": 39120740, "link": "https://stackoverflow.com/questions/39120740/winhttprequest-send-is-working-on-office-2007-products-but-not-2013/39123620#39123620", "title": "WinHttpRequest &quot;send&quot; is working on office 2007 products but not 2013", "body": "<p>I found the issue.</p>\n\n<p>I was using a proxy server further up in the code that for some reason made the http object unable to connect to servers.</p>\n\n<p>By removing the proxy I fixed the issue and since the use of this program is only internal I think that not using a proxy will be okey.</p>\n"}], "owner": {"reputation": 463, "user_id": 4470188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9ab9ce55bd91c50297c49f8d4d0f56dc?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkmeja101", "link": "https://stackoverflow.com/users/4470188/gurkmeja101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 39123620, "answer_count": 1, "score": 0, "last_activity_date": 1472042432, "creation_date": 1472034426, "question_id": 39120740, "link": "https://stackoverflow.com/questions/39120740/winhttprequest-send-is-working-on-office-2007-products-but-not-2013", "title": "WinHttpRequest &quot;send&quot; is working on office 2007 products but not 2013", "body": "<p>I have written some code that retrieves text from our server and writes that text into a word document.</p>\n\n<p>We are in the process of upgrading our office suite from 2007 to 2013, but I'm having issues when testing my previously working code in Word 2013.</p>\n\n<p>I've narrowed it down to the <code>http.send</code> line, this doesn't seem to send anything. When I run the code on 2007 suite I get a small wait and then it jumps to the <code>http_OnResponseFinished()</code> Sub, but in 2013 suite it doesn't enter that sub. </p>\n\n<p>The URL is the correct one and it looks the same/returns the same data between 2007 and 2013 suites.</p>\n\n<pre><code>  Public Sub Download(Url As String, Optional Async As Boolean = True)\n\n    Debug.Print \"About to download text from url '\" &amp; Url &amp; \"'.\"\n\n    http.Open \"GET\", Url, True 'http must be opened before it can send the request\n\n    http.SetRequestHeader \"Content-type\", \"application/json\"\n\n    http.Send 'Sends the request\n\n'    If Wait Then\n'        http.WaitForResponse\n'    End If\nEnd Sub\nPrivate Sub http_OnResponseFinished()\n\n    Dim Response As String\n\n    Response = http.ResponseText\n\n    WriteTextToWord Response\n\n    Finished = True\n\n    Debug.Print \"Completed downloading and inserting text, icons and links.\"\n\n    If err &lt;&gt; 0 Then\n        Call writeToLog(err.Description)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 0, "creation_date": 1472035499, "post_id": 39120599, "comment_id": 65587876, "body": "Is there a problem?"}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 1, "creation_date": 1472035558, "post_id": 39120599, "comment_id": 65587919, "body": "can you explain a bit more about the issue?"}, {"owner": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "reply_to_user": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 0, "creation_date": 1472035658, "post_id": 39120599, "comment_id": 65587987, "body": "i have set of rows from datatable.in that date column is there..i export different sheets based on date.."}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 0, "creation_date": 1472035756, "post_id": 39120599, "comment_id": 65588051, "body": "OK... Are you having trouble with exporting to excel?"}, {"owner": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "reply_to_user": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 0, "creation_date": 1472035802, "post_id": 39120599, "comment_id": 65588083, "body": "I know how to do in single sheet"}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "edited": false, "score": 0, "creation_date": 1472035942, "post_id": 39120599, "comment_id": 65588171, "body": "Move everything from the &quot;else&quot; part and put it in the main if condition... is that what you want?"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472038013, "post_id": 39121335, "comment_id": 65589514, "body": "Are you getting an error? If yes what is the error? If not, what is the output?"}, {"owner": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472038150, "post_id": 39121335, "comment_id": 65589606, "body": "in first sheet itself all coming.second sheet only one row"}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472038304, "post_id": 39121335, "comment_id": 65589725, "body": "Put a break point and check the steps and values. Can you provide a screenshot of the output?"}, {"owner": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472038402, "post_id": 39121335, "comment_id": 65589794, "body": "can u provide mail id..i wil send file itself"}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472038492, "post_id": 39121335, "comment_id": 65589872, "body": "Edit the question and put a screenshot, can&#39;t provide email sorry:-("}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472044807, "post_id": 39121335, "comment_id": 65594495, "body": "ok that image does not correlate to the condition used in the &#39;if&#39;, can you provide the screenshot of the datatable?"}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472046068, "post_id": 39121335, "comment_id": 65595440, "body": "They all are the same date, I did not see any entry with a different date. Please check the data you are passing in."}, {"owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "reply_to_user": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "edited": false, "score": 0, "creation_date": 1472049654, "post_id": 39121335, "comment_id": 65598233, "body": "You need to do some debugging. Put breakpoints within code and find out what is going on."}], "tags": [], "owner": {"reputation": 329, "user_id": 4030232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23aada2b3c0fc60d95b1bdc23cc2603?s=128&d=identicon&r=PG&f=1", "display_name": "Leprechaun", "link": "https://stackoverflow.com/users/4030232/leprechaun"}, "is_accepted": false, "score": 0, "last_activity_date": 1472037448, "last_edit_date": 1472037448, "creation_date": 1472036038, "answer_id": 39121335, "question_id": 39120599, "link": "https://stackoverflow.com/questions/39120599/how-to-export-set-of-rows-depending-on-date-from-datatable-into-multiple-sheets/39121335#39121335", "title": "How to export set of rows depending on date from datatable into multiple sheets of excel", "body": "<pre><code>Dim strValue As String\n      For i = 0 To dt.Rows.Count - 2\n        If i = 0 Then\n\n            ' Sheet 1\n            oSheet = oBook.Worksheets(1)\n\n            oSheet.Cells(Irow, IcolFranchisee) = dt.Rows(i).Item(\"Intime\")\n            If dt.Rows(i).Item(\"latein\") &gt; 0 Then\n                oSheet.Cells(Irow, IcolFranchisee + 1) = dt.Rows(i).Item(\"latein\")\n            Else\n                oSheet.Cells(Irow, IcolFranchisee + 2) = dt.Rows(i).Item(\"latein\")\n            End If\n\n            Irow = Irow + 1\n\n        Else\n\n            If dt.Rows(i).Item(\"AttDate\") = strValue then\n             ' Sheet 1\n                oSheet = oBook.Worksheets(1)\n\n                oSheet.Cells(Irow, IcolFranchisee) = dt.Rows(i).Item(\"Intime\")\n                If dt.Rows(i).Item(\"latein\") &gt; 0 Then\n                   oSheet.Cells(Irow, IcolFranchisee + 1) = dt.Rows(i).Item(\"latein\")\n                Else\n                   oSheet.Cells(Irow, IcolFranchisee + 2) = dt.Rows(i).Item(\"latein\")\n                End If\n\n                Irow = Irow + 1\n\n            Else\n\n                ' Sheet 2\n                osheet1 = oBook.Worksheets(2)\n\n                osheet1.Cells(Irow, IcolFranchisee) = dt.Rows(i).Item(\"Intime\")\n                If dt.Rows(i).Item(\"latein\") &gt; 0 Then\n                    osheet1.Cells(Irow, IcolFranchisee + 1) = dt.Rows(i).Item(\"latein\")\n                Else\n                    osheet1.Cells(Irow, IcolFranchisee + 2) = dt.Rows(i).Item(\"latein\")\n                End If\n\n            End If\n\n            Irow = Irow + 1\n\n        End If\n\n        strValue = dt.Rows(i).Item(\"AttDate\")\n\n    Next\n</code></pre>\n\n<p>Hope this is what you are looking for.</p>\n"}], "owner": {"reputation": 1, "user_id": 5872580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba735b1ae2ce02c6456f57b6937e3ab6?s=128&d=identicon&r=PG&f=1", "display_name": "iswarya", "link": "https://stackoverflow.com/users/5872580/iswarya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472271804, "creation_date": 1472034050, "last_edit_date": 1531161705, "question_id": 39120599, "link": "https://stackoverflow.com/questions/39120599/how-to-export-set-of-rows-depending-on-date-from-datatable-into-multiple-sheets", "title": "How to export set of rows depending on date from datatable into multiple sheets of excel", "body": "<p>I want to export particular rows into multiple sheets of excel depends on date from datatable in vb.net</p>\n\n<p>My code</p>\n\n<p>I want 17/08/2016 in one sheet 18/08/2016 in nextsheet.\nMy table rows like this:</p>\n\n<pre><code>s.no date     \n 1    17/08/2016    \n 2    17/08/2016    \n 3    17/08/2016    \n 4    18/08/2016    \n 5    18/08/2016\n</code></pre>\n\n\n\n<pre><code>          For i = 0 To dt.Rows.Count - 2\n            If dt.Rows(i).Item(\"AttDate\") = dt.Rows(i + 1).Item(\"AttDate\") Then\n                oSheet = oBook.Worksheets(1)\n\n                oSheet.Cells(Irow, IcolFranchisee) = dt.Rows(i).Item(\"Intime\")\n                If dt.Rows(i).Item(\"latein\") &gt; 0 Then\n                    oSheet.Cells(Irow, IcolFranchisee + 1) = dt.Rows(i).Item(\"latein\")\n                Else\n                    oSheet.Cells(Irow, IcolFranchisee + 2) = dt.Rows(i).Item(\"latein\")\n                End If\n                Irow = Irow + 1\n            Else\n                osheet1 = oBook.Worksheets(2)\n\n                osheet1.Cells(Irow, IcolFranchisee) = dt.Rows(i).Item(\"Intime\")\n                If dt.Rows(i).Item(\"latein\") &gt; 0 Then\n                    osheet1.Cells(Irow, IcolFranchisee + 1) = dt.Rows(i).Item(\"latein\")\n                Else\n                    osheet1.Cells(Irow, IcolFranchisee + 2) = dt.Rows(i).Item(\"latein\")\n                End If\n                Irow = Irow + 1\n            End If\n        Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1472035057, "post_id": 39120464, "comment_id": 65587574, "body": "Have you considered DAO? It is faster. <a href=\"http://stackoverflow.com/questions/30973591/fast-update-of-access-data-with-excel-data-using-excel-vba\" title=\"fast update of access data with excel data using excel vba\">stackoverflow.com/questions/30973591/&hellip;</a>"}, {"owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1472035208, "post_id": 39120464, "comment_id": 65587684, "body": "Not yet no... but I wouldn&#39;t get past the <b>cn.Open strCon</b> call"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1472040655, "post_id": 39120464, "comment_id": 65591391, "body": "i&#39;m not good in this kind of problem but have you try using macro recording to record establishing the connection in excel 2007 to the access 2010 db? i&#39;m just hoping it would shed some light."}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "edited": false, "score": 0, "creation_date": 1472035226, "post_id": 39120861, "comment_id": 65587695, "body": "Hmm... I hope that is not the case"}], "tags": [], "owner": {"reputation": 136, "user_id": 6643202, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UthB4AoQijU/AAAAAAAAAAI/AAAAAAAAAbE/5kn5PXngnU0/photo.jpg?sz=128", "display_name": "Balasubramaniyan Ramadoss", "link": "https://stackoverflow.com/users/6643202/balasubramaniyan-ramadoss"}, "is_accepted": false, "score": 0, "last_activity_date": 1472034768, "creation_date": 1472034768, "answer_id": 39120861, "question_id": 39120464, "link": "https://stackoverflow.com/questions/39120464/excel-vba-2007-connection-to-access-2010-accdb-run-time-error-unrecognized-dat/39120861#39120861", "title": "Excel VBA 2007 connection to access 2010 accdb, run-time error &quot;Unrecognized database format&quot;", "body": "<p>I believe accdb 2010 is not supported by Excel 2007 (but Excel 2010 supports it)</p>\n\n<p>Save as the accdb 2010 to mdb format and try your connection. </p>\n"}], "owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472034768, "creation_date": 1472033686, "question_id": 39120464, "link": "https://stackoverflow.com/questions/39120464/excel-vba-2007-connection-to-access-2010-accdb-run-time-error-unrecognized-dat", "title": "Excel VBA 2007 connection to access 2010 accdb, run-time error &quot;Unrecognized database format&quot;", "body": "<p>When deploying a small Excel VBA code to access a .accdb 2010 database to my colleague, who is running Excel 2007. I get the following error </p>\n\n<p><strong>run-time error '-2147467259 (80004005)':</strong></p>\n\n<p><strong>Unrecognized database format '\\dbname.accdb'</strong></p>\n\n<p>I'm pretty stuck on this bug as it works in Excel 2010, but not in excel 2007? My DB connection code is below:</p>\n\n<pre><code>' Declarations\nDim conn As Object\nDim rs As Object\nDim strConnect As String\nDim strng As String\n\n' Open Database\nSet conn = CreateObject(\"ADODB.Connection\")\n' Define the connection String\nstrConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; _\n                Glo_Database_Path &amp; \";\"\n' Open Connection\nconn.Open strConnect\n</code></pre>\n\n<p>Any ideas how to connect to an accdb 2010 from Excel 2007 64bit? </p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474274596, "creation_date": 1472032995, "last_edit_date": 1495535652, "question_id": 39120212, "link": "https://stackoverflow.com/questions/39120212/copying-and-adding-a-row-to-the-end-of-the-sheet-with-an-autofilter-enabled-and", "title": "Copying and adding a row to the end of the sheet with an autofilter enabled and data in the &quot;to be copied row&quot;", "body": "<p><strong>UPDATE - Alternative solution</strong>\nUnfortunately no answers to my problem and I needed to get on with the project. I looked into some code I made earlier and decided to work with that. The solution I found is less elagant than the one suggested by user djbrett, but it works. I added an extra line from which the macro can keep counting. For those interested, see the code below. </p>\n\n<p>I hope that if my knowledge of VBA grows that I will find a solution for the question asked below. </p>\n\n<pre><code>Sub AddRowActiviteiten_NewAtEnd()\n'Add's a new row at the end of the sheet.\n\nDim wsActiviteiten As Worksheet\nSet wsActiviteiten = Sheets(\"Activiteiten\")\n\nDefType = \"Daily\"\nDefStatus = \"Open\"\nSheetEnd = \"Stop\"\nDefIssue = \"*****\"\nDefImpact = \"*****\"\nDefPrio = \"Laag\"\nMyDate = Date\n\n'Verify that there is always a value of zero in A3\n'wsActiviteiten.Range(\"A3\").Value = \"0\"\n\nIf wsActiviteiten.Range(\"A4\").Value = \"1\" Then\n\n' Replaces some values in the \"extra line\" with content I prefer. \nLastRow = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(-1, 0).Row\n\nCells(LastRow + 1, 2) = MyDate\nCells(LastRow + 1, 3) = DefType\nCells(LastRow + 1, 4) = DefStatus\nCells(LastRow + 1, 5) = DefIssue\nCells(LastRow + 1, 6) = DefImpact\nCells(LastRow + 1, 7) = DefPrio\n\n'Copy the One Row To Rule Them All\nwsActiviteiten.Range(\"A3:R3\").Copy\n\n'Paste the copied rule\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\n\n'Stop the \"copy-action\"\nApplication.CutCopyMode = False\n\n'Add up the trackingnumber with 1\nLastNumber = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Value\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = LastNumber + 1\nCells(LastRow + 2, 2) = SheetEnd\n\n'Step down 1 row from present location.\nActiveCell.Offset(1, 0).Select\n\nElse\n'If there are no current records \"rows\" in the sheet, the code below adds it including the extra line to keep on counting. \nwsActiviteiten.Range(\"A3:R3\").Copy\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(2, 0).PasteSpecial (xlPasteAll)\nApplication.CutCopyMode = False\n\nwsActiviteiten.Range(\"A4\").Value = \"1\"\n\nLastRow = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(-1, 0).Row\nCells(LastRow + 1, 2) = MyDate\nCells(LastRow + 1, 3) = DefType\nCells(LastRow + 1, 4) = DefStatus\nCells(LastRow + 1, 5) = DefIssue\nCells(LastRow + 1, 6) = DefImpact\nCells(LastRow + 1, 7) = DefPrio\n\n'Add extra row\nwsActiviteiten.Range(\"A3:R3\").Copy\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\nApplication.CutCopyMode = False\n\nLastNumber = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Value\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = LastNumber + 1\nCells(LastRow + 2, 2) = SheetEnd\n\nActiveCell.Offset(1, 4).Select\n\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>What do I want to do.</strong>\nThis question is a follow-up on a <a href=\"https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number\">previous question</a> I asked and that was answered. The objective is still the same, I want to be able to add rows by using a button. Now I am able to add rows, even when I use the Autofilter. However, there is a snag I run into. </p>\n\n<p>Since I don't really know what is happening, I have provided a link to an example sheet [URL-Removed]. </p>\n\n<p><strong>The code.</strong>\u00a0\nThe code for AddRowActiviteiten</p>\n\n<pre><code> Sub AddRowActiviteiten_NewAtEnd()\n'Add's a new row at the end of the sheet.\n\n\nDim wsActiviteiten As Worksheet\nSet wsActiviteiten = Sheets(\"Activiteiten\")\n\nDefType = \"Daily\"\nDefStatus = \"Open\"\nDefIssue = \"*****\"\nDefImpact = \"*****\"\nDefPrio = \"Laag\"\nMyDate = Date\n\n'Copy the One Row To Rule Them All\nwsActiviteiten.Range(\"A3:Q3\").Copy\n\n'Offset(y,x)\nwsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -16).PasteSpecial (xlPasteAll)\n\n'Stop the \"copy-action\"\nApplication.CutCopyMode = False\n\n'Het volgnummer verhogen met 1\nLastNumber = wsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(0, -16).Value\nwsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -16).Value = LastNumber + 1\n\n\n'Insert default values\nLastRow = wsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(-1, 0).Row\nCells(LastRow + 1, 2) = DefType\nCells(LastRow + 1, 3) = DefStatus\nCells(LastRow + 1, 4) = DefIssue\nCells(LastRow + 1, 5) = DefImpact\nCells(LastRow + 1, 6) = DefPrio\nCells(LastRow + 1, 8) = MyDate\n\n'Step down 1 row from present location.\nActiveCell.Offset(1, 0).Select\n\nEnd Sub\n</code></pre>\n\n<p>The code for AddRowRiskRegister</p>\n\n<pre><code>Sub AddRowRiskRegister_NewAtEnd()\n'Add's a new row at the end of the sheet.\n\nDim wsRiskRegister As Worksheet\nSet wsRiskRegister = Sheets(\"RiskRegister\")\n\n\nDefStatus = \"Analyse\"\nDefCategory = \"*****\"\nDefNabijheid = \"*****\"\nDefImpact = \"*****\"\nMyDate = Date\n\n\n'Copy the One Row To Rule Them All\nwsRiskRegister.Range(\"A3:N3\").Copy\nwsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -13).PasteSpecial (xlPasteAll)\n\n'Stop the \"copy-action\"\nApplication.CutCopyMode = False\n\nLastNumber = wsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(0, -13).Value\nwsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -13).Value = LastNumber + 1\n\n'Insert default values\n\nLastRow = wsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(-1, 0).Row\nCells(LastRow + 1, 2) = MyDate\nCells(LastRow + 1, 3) = DefStatus\nCells(LastRow + 1, 4) = DefCategory\nCells(LastRow + 1, 5) = DefNabijheid\nCells(LastRow + 1, 6) = DefPrio\nCells(LastRow + 1, 8) = MyDate\n\n\n'Step down 1 row from present location.\nActiveCell.Offset(1, 0).Select\n\nEnd Sub\n</code></pre>\n\n<p>As you can see they are basically the same.</p>\n\n<p><strong>The problem.</strong>\nIn Riskregister there is a entry/formula in the row that needs to be copied. This formula needs to be present in all the subsequent rows for every new entry. But the result is not what I except. \nThe row is copied, that works. But the \"follow-numbers\" are placed on a new row. See the image below for when it goes wrong:\n<a href=\"https://i.stack.imgur.com/MoBP2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MoBP2.png\" alt=\"RowGoneWrong\"></a>.</p>\n\n<p>See the image below for what I want to see (notice the hidden/autofiltered rows):</p>\n\n<p><a href=\"https://i.stack.imgur.com/gTKBo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gTKBo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried several solutions among changing the code for adding up the numbers to a different offset, but that did not work. When I use the Autofilter with a different offset, the code does not work. See an example below. </p>\n\n<pre><code>LastNumber = wsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(-1, -13).Value\nwsRiskRegister.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(0, -13).Value = LastNumber + 1\n</code></pre>\n\n<p><strong>To replicate.</strong>\u00a0\nSince I don't really know where things go wrong, I have provided a sample workbook to demontrate what is happening. I believe it has something to do with the contents of a cell in the \"to be copied row\", but how and why is a mysterie to me. When fiddling with this problem, I sometimes had a working sheet. But when I tried to replicate what I did, it was broken again.</p>\n\n<p><strong>The solution.</strong>\u00a0\nI want to be able to add a new row as requested in my previous question. It partly works if there is no formula or someting in the \"to be copied row\". The \"AddRowActiviteiten\" proves this solution can work. </p>\n\n<p>To test I always check if I am able to Autofilter the status. Add some rows and set the status of the latest added row to \"Ja\" or \"Nee\". Filter that and add some more rows. </p>\n\n<p>I wish I could be more specific to identify the direction where the problem lies. If things aren't clear, feel free to shoot me any question you might have. </p>\n\n<p>Kind regards,</p>\n\n<p>Simon</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1472032618, "post_id": 39119903, "comment_id": 65585963, "body": "Have you considered pushing the ranges into arrays then comparing the arrays directly rather than iterating across the cells?  Should be faster.  Also, consider trying <a href=\"https://codereview.stackexchange.com\">Code Review</a> for this question as that&#39;s the correct place for optimisation of code that already works..."}, {"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1472032800, "post_id": 39119903, "comment_id": 65586066, "body": "Apologies didn&#39;t know. I&#39;ll give the array method a shot."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472034880, "post_id": 39119903, "comment_id": 65587450, "body": "@james1395 try my code in my answer below, you can use the <code>Match</code> function and save the inner loop. Let me know if this helped you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472110344, "post_id": 39119903, "comment_id": 65622803, "body": "in a comment of yours you said <i>&quot;it&#39;s over a million names&quot;</i>: how have you succeeded in opening such a file in excel given its 1048576 maximum row number?"}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472041379, "post_id": 39120343, "comment_id": 65591909, "body": "Unforuntately it&#39;s over a million names, so it won&#39;t even open in excel fully (csv file). I&#39;m going to need a work around"}, {"owner": {"reputation": 1105, "user_id": 1038431, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3251b5cb381c3026b6ee36f7975c2d87?s=128&d=identicon&r=PG", "display_name": "mshthn", "link": "https://stackoverflow.com/users/1038431/mshthn"}, "reply_to_user": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "edited": false, "score": 0, "creation_date": 1472047668, "post_id": 39120343, "comment_id": 65596792, "body": "Oh, that&#39;s not cool. Can you explain why you need VBA? I&#39;d recommend to load them into a database with Talend, Pentaho or just pure SQL and then do the aggregation there. Much easier, I think."}], "tags": [], "owner": {"reputation": 1105, "user_id": 1038431, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3251b5cb381c3026b6ee36f7975c2d87?s=128&d=identicon&r=PG", "display_name": "mshthn", "link": "https://stackoverflow.com/users/1038431/mshthn"}, "is_accepted": false, "score": 2, "last_activity_date": 1472033333, "creation_date": 1472033333, "answer_id": 39120343, "question_id": 39119903, "link": "https://stackoverflow.com/questions/39119903/vba-double-for-loop-through-very-large-amounts-of-data/39120343#39120343", "title": "VBA: Double for loop through very large amounts of data", "body": "<p>Depends. If your RAM size and number of names in the second file allow it, 'Id recommend to have a single loop for the larger file, push name - date1 and name - date2 key-value pairs into two dictionaries (or in other languages, hash tables) and when it's done, a separate loop (not embedded into the other) process the other file and get the names from the two hashes.</p>\n\n<p>You'll have to have microsoft.scripting.runtime referenced in the project.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 6643202, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UthB4AoQijU/AAAAAAAAAAI/AAAAAAAAAbE/5kn5PXngnU0/photo.jpg?sz=128", "display_name": "Balasubramaniyan Ramadoss", "link": "https://stackoverflow.com/users/6643202/balasubramaniyan-ramadoss"}, "is_accepted": false, "score": 0, "last_activity_date": 1472034266, "creation_date": 1472034266, "answer_id": 39120676, "question_id": 39119903, "link": "https://stackoverflow.com/questions/39119903/vba-double-for-loop-through-very-large-amounts-of-data/39120676#39120676", "title": "VBA: Double for loop through very large amounts of data", "body": "<p>Convert the CSV file to MDB (Access database) and then connect this database and do the necessary things. It works faster than above method.\nNote: Everytime need to recreate the MDB from CSV if changes made to CSV file</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1472034819, "creation_date": 1472034819, "answer_id": 39120878, "question_id": 39119903, "link": "https://stackoverflow.com/questions/39119903/vba-double-for-loop-through-very-large-amounts-of-data/39120878#39120878", "title": "VBA: Double for loop through very large amounts of data", "body": "<p>You can use the <code>Match</code> function, it will save you the inner loop (and a lot of precious run-time), see code below (just the section you need to modify)</p>\n\n<pre><code>Dim MatchRow As Long\nDim SearchedRng As Range\n\n' set the range for \"Match\" all active rows and columns &gt;&gt; modify as needed\n' I assumed \"LRGendofrow\" is the last row\nSet SearchedRng = lrgwkbook.wrksheet.Range(\"A1:C\" &amp; LRGendofrow)\n\nFor i = 1 To SMLendofrow\n   ' For j = 1 To LRGendofrow\n    If Not IsError(Application.Match(Cells(i, \"A\").Value, SearchedRng, 0)) Then\n        MatchRow = Application.Match(Cells(i, \"A\").Value, SearchedRng, 0)\n        Cells(i, \"B\").Value = lrgwkbook.wrksheet.Cells(MatchRow, \"B\").Value\n        Cells(i, \"C\").Value = lrgwkbook.wrksheet.Cells(MatchRow, \"C\").Value\n    Else ' \"names\" record not found &gt;&gt; do something\n\n        ' in my example I put #NA in cells, to know it's not found\n        Cells(i, \"B\") = CVErr(xlErrNA)\n        Cells(i, \"C\") = CVErr(xlErrNA)\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1472036477, "creation_date": 1472036477, "answer_id": 39121498, "question_id": 39119903, "link": "https://stackoverflow.com/questions/39119903/vba-double-for-loop-through-very-large-amounts-of-data/39121498#39121498", "title": "VBA: Double for loop through very large amounts of data", "body": "<p>to avoid the inner (and bigger) loop, you could use this code:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim namesRng As Range\n    Dim f As Range, cell As Range\n\n    With Worksheets(\"Names\") '&lt;-- change \"Names\" with actual name of your sheet with the list of names\n        Set namesRng = .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)) '&lt;--| get the list of names form cell A1 down to last non empty row\n    End With\n\n    With Workbooks.Open(\"C:\\Users\\...\\data.csv\").Worksheets(1).UsedRange.Columns(1) '&lt;-- open your CSV file and refer to \"used\" cells in its column \"A\"\n        For Each cell In namesRng '&lt;-- loop through names list\n            Set f = .Find(what:=cell.value, LookIn:=xlValues, lookat:=xlWhole) '&lt;-- try finding current name in referenced range of csv file\n            If Not f Is Nothing Then cell.Offset(, 1).Resize(, 2).value = f.Offset(, 1).Resize(, 2).value '&lt;--| if found, then write its two adjacent cells values next to current name ones\n        Next cell\n    End With\n    ActiveWorkbook.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 6721010, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ab677c12b1c895eaf26e182695d33699?s=128&d=identicon&r=PG", "display_name": "james1395", "link": "https://stackoverflow.com/users/6721010/james1395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1472036477, "creation_date": 1472032232, "question_id": 39119903, "link": "https://stackoverflow.com/questions/39119903/vba-double-for-loop-through-very-large-amounts-of-data", "title": "VBA: Double for loop through very large amounts of data", "body": "<p>I have a large amount of data stored in a csv file (around 60mb) which has a list of names and two dates adjacent to the name i.e.</p>\n\n<pre><code>A1name1   B1date1   C1date2\nA2name2   B2date1   C2date2\n</code></pre>\n\n<p>I have another file which has a list of names:</p>\n\n<pre><code>names1\nnames2\nnames3\nnames4\n</code></pre>\n\n<p>I want to take names1 for example, search through the big database of names and return date1 and date 2 if names1 is found. I have done this using a double for loop. Pseudocode for it is as follows:</p>\n\n<pre><code>For i = 1 to SMLendofrow\n    for j = 1 to LRGendofrow\n       if cells(i,\"A\").value = lrgwkbook.wrksheet.cells(j,\"A\").value then\n               cells(i,\"B\").value =lrgwkbook.wrksheet.cells(j,\"B\").Value\n               cells(i,\"C\").value =lrgwkbook.wrksheet.cells(j,\"C\").Value\n           end if\n        next j\nnext i\n</code></pre>\n\n<p>Now this code works perfectly however it is simply just too long. As the large workbook which has all the names is very large it takes around 10 minutes to search through all of it. Is tehre a more efficient method? I have used python as an alternative and that gets it done in 2 minutes but I want something specifically with VBA.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1472031980, "post_id": 39119759, "comment_id": 65585497, "body": "Do you have any column in the table that identifies the record-ID (running number from 1 to n, being n the number of records)?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1472032003, "post_id": 39119759, "comment_id": 65585517, "body": "How do you differentiate between the first half and second half keeping in mind that the order of records has no meaning in a database?"}, {"owner": {"reputation": 11, "user_id": 6751822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b3ba6ffe2bc9acd2ab855e4441ab02?s=128&d=identicon&r=PG&f=1", "display_name": "KEOC", "link": "https://stackoverflow.com/users/6751822/keoc"}, "edited": false, "score": 0, "creation_date": 1472033217, "post_id": 39119759, "comment_id": 65586311, "body": "Hi! I have an IDNumber, but i need to use in queries another criteria. I think in Count records divide number of records on 2(generate an N integer) , in query select N top of records in the first query and create the second an unmatched query. The structure of table is: 1.Id-Autonumber 2.ProductName-Text 3.Price-number"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1472056663, "post_id": 39119759, "comment_id": 65602929, "body": "Why do you need to do this? What is special about each half? If it is a forms loading issue there are other ways around it."}], "answers": [{"comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472034341, "post_id": 39120087, "comment_id": 65587063, "body": "It may work indeed but you rarely have autonumber IDs not missing. That&#39;s the only possible approach in pure SQL though, but not reliable"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472035399, "post_id": 39120087, "comment_id": 65587815, "body": "Agreed, definitely not reliable."}, {"owner": {"reputation": 11, "user_id": 6751822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b3ba6ffe2bc9acd2ab855e4441ab02?s=128&d=identicon&r=PG&f=1", "display_name": "KEOC", "link": "https://stackoverflow.com/users/6751822/keoc"}, "edited": false, "score": 0, "creation_date": 1472036010, "post_id": 39120087, "comment_id": 65588214, "body": "@Darren Bartup-Cook Many thanks  Darren but I can&#180;t use the id-Autonumber, that&#39;s because in the query i use another criterion the &quot;Category&quot;. Table structure is as follows: ID -Auto Category-Number Product-Txt Price-Curr. When data is entered are inserted randomly Id Product \tCategory \t        Price 1. 1. \t\tApple \t\t$ 1.00 2. 2. \t\tRabbit \t\t$ 4.00 3. 3. \t\tCheese \t\t$ 8.00 4. 2. \t\tChicken \t$ 3.10 5. 1. \t\tCherry \t\t$ 2.50  If I choose Category &quot;1&quot; result: Id Product \tCategory \t        Price 1. 1. \t\tApple \t\t$ 1.00 5. 1. \t\tCherry \t\t$ 2.00 I have two rec but the max Id is 5.."}, {"owner": {"reputation": 11, "user_id": 6751822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b3ba6ffe2bc9acd2ab855e4441ab02?s=128&d=identicon&r=PG&f=1", "display_name": "KEOC", "link": "https://stackoverflow.com/users/6751822/keoc"}, "edited": false, "score": 0, "creation_date": 1472036047, "post_id": 39120087, "comment_id": 65588237, "body": "@Darren Bartup-Cook As I said in the previous comment wich was not full, I apologize for that is my first post, I thinking to create query1 based on my Category criteria, next countrecords of this query, divide the countrecords number at 2 result a number N , create another query (Query2) based on Query1 and select N top of records and ultimately to create Query3 to show me the unmatched records between query2 and Query1. But I don&#180;t have experience and I needed help to write QueryDef."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472036797, "post_id": 39120087, "comment_id": 65588734, "body": "Yes, using MAX ID is not reliable - I&#39;d go with @ThomasG solution, although you may need to add criteria to the DCOUNT function and SQL to pull out the required category."}, {"owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1472041590, "post_id": 39120087, "comment_id": 65592056, "body": "One solution would be to make a custom VBA function that return the median value of a specific field and then use it as a criteria in your query, instead of using <code>INT((SELECT MAX(ID) FROM Table1)&#47;2)</code>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1472032711, "creation_date": 1472032711, "answer_id": 39120087, "question_id": 39119759, "link": "https://stackoverflow.com/questions/39119759/access-how-can-i-split-the-table-records-in-two-queries/39120087#39120087", "title": "Access - How can i split the table records in two queries", "body": "<p>Using an AutoNumber primary key (or at least a field that has sequential numbering with no numbers missing) this may work - although I haven't really thought it through so may be a few pitfalls?</p>\n\n<p><strong>Return the first half of ID numbers:</strong></p>\n\n<pre><code>SELECT  ID\nFROM    Table1\nWHERE   ID&lt;=INT((SELECT MAX(ID) FROM Table1)/2)\n</code></pre>\n\n<p><strong>Return the second half of ID numbers:</strong></p>\n\n<pre><code>SELECT  ID\nFROM    Table1\nWHERE   ID&gt;INT((SELECT MAX(ID) FROM Table1)/2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6751822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b3ba6ffe2bc9acd2ab855e4441ab02?s=128&d=identicon&r=PG&f=1", "display_name": "KEOC", "link": "https://stackoverflow.com/users/6751822/keoc"}, "edited": false, "score": 0, "creation_date": 1472036208, "post_id": 39120484, "comment_id": 65588356, "body": "Many Thanks Thomas G"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1472036365, "last_edit_date": 1472036365, "creation_date": 1472033755, "answer_id": 39120484, "question_id": 39119759, "link": "https://stackoverflow.com/questions/39119759/access-how-can-i-split-the-table-records-in-two-queries/39120484#39120484", "title": "Access - How can i split the table records in two queries", "body": "<p>The issue is that you cant specify the result of a <code>COUNT(*)</code> subquery in the TOP instruction, so impossible to do this 100% reliably in pure SQL</p>\n\n<p>The reliable alternative is to pre-build your 2 queries with VBA :</p>\n\n<pre><code>Sub Half_Table()\n\n    Dim lngTotal As Long\n    Dim lngHalf1 As Long\n    Dim lngHalf2 As Long\n\n    Dim strTable As String\n    Dim strIDfield As String\n    Dim strSQL1 As String\n    Dim strSQL2 As String\n\n\n    strTable = \"table_Name\"\n    strIDfield = \"ID\"\n\n    lngTotal = DCount(\"*\", strTable)\n    lngHalf1 = Round(lngTotal / 2)\n    lngHalf2 = lngTotal - lngHalf1\n\n    strSQL1 = \"SELECT TOP \" &amp; lngHalf1 &amp; \" * FROM \" &amp; strTable &amp; \" ORDER BY \" &amp; strIDfield &amp; \" ASC\"\n    strSQL2 = \"SELECT TOP \" &amp; lngHalf2 &amp; \" * FROM \" &amp; strTable &amp; \" ORDER BY \" &amp; strIDfield &amp; \" DESC\"\n\n    Debug.Print strSQL1\n    Debug.Print strSQL2\n\n\nEnd Sub\n</code></pre>\n\n<p>Change <code>strTable</code> and <code>strIDfield</code>  names accordingly.</p>\n\n<p>This generates the 2 queries below with a table containing 1399 records :</p>\n\n<pre><code>SELECT TOP 700 * FROM table_Name ORDER BY ID ASC\nSELECT TOP 699 * FROM table_Name ORDER BY ID DESC\n</code></pre>\n\n<p>I have not shown how to use the generated SQL queries\n afterwards as I assume you know that </p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1472054933, "creation_date": 1472054933, "answer_id": 39128226, "question_id": 39119759, "link": "https://stackoverflow.com/questions/39119759/access-how-can-i-split-the-table-records-in-two-queries/39128226#39128226", "title": "Access - How can i split the table records in two queries", "body": "<p>Consider the pure SQL solution using the row number count aggregate subquery:</p>\n\n<p><strong>TOP HALF</strong></p>\n\n<pre><code>SELECT [ID], [Category], [Product], [Price]\nFROM Products\nINNER JOIN \n   (SELECT [ID], \n           (SELECT Count(*) FROM Products t2 \n            WHERE Products.[ID] &lt;= t2.[ID]) AS ProductOrder, \n           (SELECT Count(*) FROM Products t2) AS ProductCount\n    FROM Products) AS sub \nON Products.[ID] = sub.[ID]\nWHERE sub.ProductOrder &gt;= sub.ProductCount / 2\n</code></pre>\n\n<p><strong>BOTTOM HALF</strong></p>\n\n<pre><code>SELECT [ID], [Category], [Product], [Price]\nFROM Products\nINNER JOIN \n   (SELECT [ID], \n           (SELECT Count(*) FROM Products t2 \n            WHERE Products.[ID] &lt;= t2.[ID]) AS ProductOrder, \n           (SELECT Count(*) FROM Products t2) AS ProductCount\n    FROM Products) AS sub \nON Products.[ID] = sub.[ID]\nWHERE sub.ProductOrder &lt;= sub.ProductCount / 2\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6751822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31b3ba6ffe2bc9acd2ab855e4441ab02?s=128&d=identicon&r=PG&f=1", "display_name": "KEOC", "link": "https://stackoverflow.com/users/6751822/keoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1472054933, "creation_date": 1472031823, "question_id": 39119759, "link": "https://stackoverflow.com/questions/39119759/access-how-can-i-split-the-table-records-in-two-queries", "title": "Access - How can i split the table records in two queries", "body": "<p>I have a table \"Products\" with n records(more than 5000 and always change the number). How can i generate two queries based on table, one for the first half of records and the second with the other half?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 0, "creation_date": 1472028635, "post_id": 39118534, "comment_id": 65583382, "body": "You should use breakpoints to see where the execution goes, and if that doesn&#39;t show you the cause of the problem (unlikely) you should post the findings of that debugging."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472029582, "post_id": 39118534, "comment_id": 65583915, "body": "What line are you getting your error ?"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472029666, "post_id": 39118534, "comment_id": 65583976, "body": "I tried debugging but it does not detect any errors on the code itself. If I press the run button for each module there are no problems at all. I have a long list of modules and I need to call them. Can you please check in case I am missing something. The excel file has three columns of long text that will need to be shrinked on overflow"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472029943, "post_id": 39118534, "comment_id": 65584153, "body": "there is no need to use <code>Call Module1.CreateSlides</code>, you can use <code>Call CreateSlides</code>"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472030136, "post_id": 39118534, "comment_id": 65584282, "body": "Shai Rado I am calling from another module not from within"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472031694, "post_id": 39118534, "comment_id": 65585298, "body": "Both modules work fine when I call them separately. When I combine them or call them together.. the result is not the same. The slides are created and saved ....but on the saved png slides, the text overflows and is not shrinked. That does not happen when I call module2 without module1. Can you please help?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472033658, "post_id": 39119753, "comment_id": 65586596, "body": "Hi JamieG. Thank you for your reply. On the slide master I have formated text to shrink on overflow. I tried your modified sub but the text on the created slides overflows on top of each other. Just try to increase the font on slidemaster or make the text on excel very long. The code I had for module1 does not have that problem. The slides are created and saved when modules are run separately and the text does not overflow. But when I run them together, then the saved slides do not produce the same result, the text on each slide runs on top of each other and does not shrink as it should"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472042715, "post_id": 39119753, "comment_id": 65592862, "body": ".AutoSize = msoAutoSizeTextToFitShape"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472043202, "post_id": 39119753, "comment_id": 65593239, "body": "I replaced:   .AutoSize = msoAutoSizeShapeToFitText       with: .AutoSize = msoAutoSizeTextToFitShape.  When I run create module separately it shrinks... but when I call both modules to createslide and to saveslide I have the same problem. I tried to combine both subs on the same module and still receive the same result. Is there a code to run the second module auto...like you would manually with F5 or run button.. I have tried both &quot;call&quot; and &quot;application run&quot;"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1472031814, "creation_date": 1472031814, "answer_id": 39119753, "question_id": 39118534, "link": "https://stackoverflow.com/questions/39118534/powerpoint-vba-creating-and-saving-slides/39119753#39119753", "title": "powerpoint vba creating and saving slides", "body": "<p>You mentioned \"the text does not shrink on overflow on the saved slides\". What text are you referring to? There are no lines that are setting the following property in your code so any on-slide objects should be following the properties of those objects in your Slide Master (and associated Custom Layouts).</p>\n\n<pre><code>Sld.Shapes(x).TextFrame2.AutoSize = msoAutoSizeShapeToFitText\n</code></pre>\n\n<p>Try using the above line to explicitly set the fit option as required. Modified sub:</p>\n\n<pre><code>Option Explicit\n\nSub CreateSlides()\n\n'Open the Excel workbook. Change the filename here.\nDim OWB As New Excel.Workbook\nSet OWB = Excel.Application.Workbooks.Open(\"C:\\B\\Books\\TXT.xlsx\")\nDim i As Long\n\n'Grab the first Worksheet in the Workbook\nDim WS As Excel.Worksheet\nSet WS = OWB.Worksheets(1)\n\n'Loop through each used row in Column A\nFor i = 1 To WS.Range(\"A65536\").End(xlUp).Row\n  With ActivePresentation\n    'Copy the first slide and paste at the end of the presentation\n    .Slides(1).Copy\n    .Slides.Paste (.Slides.Count + 1)\n\n    'Change the text of the first text box on the slide.\n    With .Slides(.Slides.Count).Shapes(1).TextFrame2\n      .AutoSize = msoAutoSizeShapeToFitText\n      .WordWrap = msoTrue\n      .TextRange.Text = WS.Cells(i, 1).Value\n    End With\n    With .Slides(.Slides.Count).Shapes(2).TextFrame2\n      .AutoSize = msoAutoSizeShapeToFitText\n      .WordWrap = msoTrue\n      .TextRange.Text = WS.Cells(i, 2).Value\n    End With\n    With .Slides(.Slides.Count).Shapes(3).TextFrame2\n      .AutoSize = msoAutoSizeShapeToFitText\n      .WordWrap = msoTrue\n      .TextRange.Text = WS.Cells(i, 3).Value\n    End With\n  End With\n Next\n\n'Close Excel\nActiveWorkbook.Close\n\n'Delete presentation\nActivePresentation.Slides(1).Delete\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472059308, "post_id": 39126335, "comment_id": 65604347, "body": "Hi Steve Rindsberg I posted the changes as an answer because the code was to long to post here. Can you please check and let me know if I am doing something wrong, because I am getting the same result."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472070458, "post_id": 39126335, "comment_id": 65610233, "body": "You missed the part about &quot;So later, separately, you run code that...&quot;   You can&#39;t run the fixup routine as part of your main code.  You run it separately. After all your other code has run and you&#39;re back to looking at the results.  Stupid?  Yes.  Bug workarounds often are like that. ;-)"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472136417, "post_id": 39126335, "comment_id": 65640315, "body": "Thank you for your help I have followed your suggestion and figured out the way to workaround it. (posted the code as an answer)"}, {"owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "edited": false, "score": 0, "creation_date": 1472425623, "post_id": 39126335, "comment_id": 65733637, "body": "I have noticed that the &quot;tidy up&quot; sub only correct the top slides on the presentation, the last ones remain unchanged. Is there a way to correct this?"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1472049515, "creation_date": 1472049515, "answer_id": 39126335, "question_id": 39118534, "link": "https://stackoverflow.com/questions/39118534/powerpoint-vba-creating-and-saving-slides/39126335#39126335", "title": "powerpoint vba creating and saving slides", "body": "<p>This appears to be a bug in PowerPoint.  I've run into the same problem myself.</p>\n\n<p>If you can run the whole main batch of code, then separately run another small module to \"tidy up\" the text, you can fix this.</p>\n\n<p>Somewhere in the main code, tag each shape that holds text (or perhaps just the ones set to shrink on overflow).  For example, if you had a reference to the shape in oSh:</p>\n\n<pre><code>oSh.Tags.Add \"H\", cStr(oSh.Height)\noSh.Tags.Add \"W\", cStr(oSh.Width)\n</code></pre>\n\n<p>Now the shape is tagged with the size it SHOULD be.  When your main code pours text into it, the size will reset (incorrectly... there's the bug).</p>\n\n<p>So later, separately, you run code that </p>\n\n<pre><code>' Looks at each shape on each slide and\n' if it's tagged, reset the size to the\n' size indicated by the tags:\nIf Len(oSh.Tags(\"H\")) &gt; 0 Then\n   oSh.Height = cSng(oSh.Tags(\"H\")\n   oSh.Width = cSng(oSh.Tags(\"W\")\nEnd if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "is_accepted": true, "score": 0, "last_activity_date": 1472483804, "last_edit_date": 1472483804, "creation_date": 1472136029, "answer_id": 39148276, "question_id": 39118534, "link": "https://stackoverflow.com/questions/39118534/powerpoint-vba-creating-and-saving-slides/39148276#39148276", "title": "powerpoint vba creating and saving slides", "body": "<p>Fixup module to be applied separately</p>\n\n<pre><code>Sub FixUp()\n\nDim Obj1 As Object\nSet Obj1 = CreateObject(\"powerpoint.application\")\nObj1.Presentations.Open FileName:=\"C:\\B\\name.pptm\"\n\n    Dim pptSlide As Slide\n    Dim pptShape as Shape\n    'Set pptSlide = ActivePresentation.Slides(1)\n    For Each pptSlide in ActivePresentation.Slides\n      'With pptSlide.Shapes(1)\n       For Each pptShape in pptSlide.Shapes\n          With pptShape\n          If .TextFrame2.TextRange.Characters.Count &gt; 1 Then\n              .TextFrame2.AutoSize = msoAutoSizeTextToFitShape\n          End If\n          End With '  pptShape\n       Next  ' pptShape\n      End With\n    Next   ' Slide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6749997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ef7b0c3466483918199d86bac5a816?s=128&d=identicon&r=PG&f=1", "display_name": "InDesigner", "link": "https://stackoverflow.com/users/6749997/indesigner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 39148276, "answer_count": 3, "score": 0, "last_activity_date": 1472483804, "creation_date": 1472028343, "last_edit_date": 1531164843, "question_id": 39118534, "link": "https://stackoverflow.com/questions/39118534/powerpoint-vba-creating-and-saving-slides", "title": "powerpoint vba creating and saving slides", "body": "<p>When I call each module separately everything works fine... but when I call them from the <strong><em>MAIN</em></strong> module the text does not shrink on overflow on the saved slides. Can you please help to find a way to fix this</p>\n\n<pre><code>Sub MAIN()\n\nCall Module1.CreateSlides\nCall Module2.SaveSlides\n\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0 </p>\n\n<p>[<strong><em>Module1</em></strong>]</p>\n\n<pre><code>Sub CreateSlides()\n\n'Open the Excel workbook. Change the filename here.\nDim OWB As New Excel.Workbook\nSet OWB = Excel.Application.Workbooks.Open(\"C:\\B\\Books\\TXT.xlsx\")\n\n'Grab the first Worksheet in the Workbook\nDim WS As Excel.Worksheet\nSet WS = OWB.Worksheets(1)\n\n'Loop through each used row in Column A\nFor i = 1 To WS.Range(\"A65536\").End(xlUp).Row\n\n\u00a0 \u00a0 'Copy the first slide and paste at the end of the presentation\n\u00a0 \u00a0 ActivePresentation.Slides(1).Copy\n\u00a0 \u00a0 ActivePresentation.Slides.Paste (ActivePresentation.Slides.Count + 1)\n\n\u00a0 \u00a0 'Change the text of the first text box on the slide.\n\u00a0 \u00a0 ActivePresentation.Slides(ActivePresentation.Slides.Count).Shapes(1).TextFrame.TextRange.Text = WS.Cells(i, 1).Value\n\u00a0 \u00a0 ActivePresentation.Slides(ActivePresentation.Slides.Count).Shapes(2).TextFrame.TextRange.Text = WS.Cells(i, 2).Value\n\u00a0 \u00a0 ActivePresentation.Slides(ActivePresentation.Slides.Count).Shapes(3).TextFrame.TextRange.Text = WS.Cells(i, 3).Value\n\u00a0Next\n\n'Close Excel\nActiveWorkbook.Close\n\n'Delete presentation\nActivePresentation.Slides(1).Delete\n\nEnd Sub\n</code></pre>\n\n<p>[<strong>Module2</strong>]</p>\n\n<pre><code>Sub SaveSlides ()\n\n'Save slides as png\nDim sImagePath As String\nDim sImageName As String\nDim oSlide As Slide '* Slide Object\n\nOn Error GoTo Err_ImageSave\n\nsImagePath = \"C:\\\"\nFor Each oSlide In ActivePresentation.Slides\n    sImageName = oSlide.SlideNumber &amp; \".png\"\n    oSlide.Export sImagePath &amp; sImageName, \"PNG\"\nNext oSlide\n\nErr_ImageSave:\nIf Err &lt;&gt; 0 Then\n    MsgBox Err.Description\nEnd If\n\n'Delete all slides\nDim Pre As Presentation\nSet Pre = ActivePresentation\nDim x As Long\nFor x = Pre.Slides.Count To 1 Step -1\n\u00a0 \u00a0 Pre.Slides(x).Delete\nNext x\n\n'Add New slide\nSet pptLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1)\nSet Sld = ActivePresentation.Slides.AddSlide(1, pptLayout)\nSld.Design = ActivePresentation.Designs(1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "edited": false, "score": 0, "creation_date": 1472035616, "post_id": 39119875, "comment_id": 65587953, "body": "Thank you, this is at least the first half of what I am looking for. Maybe there is anyone who knows how to translate this x,y position to an actual cell?"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1472032152, "creation_date": 1472032152, "answer_id": 39119875, "question_id": 39118488, "link": "https://stackoverflow.com/questions/39118488/excel-vba-get-cell-at-center-of-shape/39119875#39119875", "title": "Excel VBA: Get cell at center of shape", "body": "<p>You could use this to find the centre point, I'm unsure how to select a cell based on the top/left position, is this adequate?</p>\n\n<pre><code>lngLeftCentre = shape.Left + (shape.Width / 2)\nlngTopCentre = shape.Top + (shape.Height / 2)\nDebug.Print \"Top: \" &amp; lngTopCentre\nDebug.Print \"Left: \" &amp; lngLeftCentre\n</code></pre>\n"}], "owner": {"reputation": 2028, "user_id": 5572543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f73140eedc8165647dc849dd8ae7cdb?s=128&d=identicon&r=PG", "display_name": "elzell", "link": "https://stackoverflow.com/users/5572543/elzell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1315, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472032152, "creation_date": 1472028202, "question_id": 39118488, "link": "https://stackoverflow.com/questions/39118488/excel-vba-get-cell-at-center-of-shape", "title": "Excel VBA: Get cell at center of shape", "body": "<p>I have a few shapes (or more specifically, dropdown lists) which are roughly aligned to individual cells and would like to know for each shape which cell lies underneath.</p>\n\n<p>I know there are the following members:</p>\n\n<pre><code>Dim dd As Shape\ndd.BottomRightCell\ndd.TopLeftCell\n</code></pre>\n\n<p>to get the bottom right or top left cell under the shape, but since the shapes are manually placed and not always properly aligned (sometimes the bottom right corner touches the row beneath, sometimes the top left corner the row above, ...) both values can not be trusted.</p>\n\n<p>I would like to know which cell I get when I look at the center of the shape. Is there a way to get this information?</p>\n"}, {"tags": ["excel", "vba", "listview", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "edited": false, "score": 0, "creation_date": 1472030307, "post_id": 39118495, "comment_id": 65584417, "body": "Checked the References and the specific control for listview version 6.0,  nothing missing :("}, {"owner": {"reputation": 131, "user_id": 4951336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b3606300fd0f11e20498351637c5f2?s=128&d=identicon&r=PG", "display_name": "Jacques Lalancette", "link": "https://stackoverflow.com/users/4951336/jacques-lalancette"}, "reply_to_user": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "edited": false, "score": 0, "creation_date": 1472039237, "post_id": 39118495, "comment_id": 65590316, "body": "I found someone mentioning a similar problem on a different site.  They removed and then relinked the reference for OLE Automation."}, {"owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "edited": false, "score": 0, "creation_date": 1472040599, "post_id": 39118495, "comment_id": 65591356, "body": "I&#39;m quite new to VBa... lets call it a casual user. Any Idea how to relink the reference using VBA code?"}, {"owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "edited": false, "score": 0, "creation_date": 1472056334, "post_id": 39118495, "comment_id": 65602741, "body": "Ok so tried... lstview As <b>MSComctlLib.</b> ListView infront of the ListView definition... No luck"}], "tags": [], "owner": {"reputation": 131, "user_id": 4951336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b3606300fd0f11e20498351637c5f2?s=128&d=identicon&r=PG", "display_name": "Jacques Lalancette", "link": "https://stackoverflow.com/users/4951336/jacques-lalancette"}, "is_accepted": false, "score": 0, "last_activity_date": 1472085066, "last_edit_date": 1472085066, "creation_date": 1472028212, "answer_id": 39118495, "question_id": 39118279, "link": "https://stackoverflow.com/questions/39118279/excel-vba-listview-object-feature-not-found-when-exporting-xlam-file-to-another/39118495#39118495", "title": "EXCEL VBA: Listview object feature not found when exporting XLAM file to another machine", "body": "<p>First, please navigate to Tools / References and look for a library with \"[Missing]\" next to it.  There is probably a different DLL version (for Microsoft Forms 2.0 Object Library) of this control between the two machines.</p>\n\n<p>Second, try relinking OLE automation, as mentioned <a href=\"http://www.mrexcel.com/forum/excel-questions/693594-compile-error-object-library-feature-not-supportted.html\" rel=\"nofollow noreferrer\">here</a>:\n<a href=\"https://i.stack.imgur.com/Rhsj8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rhsj8.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li>Navigate to Tools / References.</li>\n<li>Uncheck \"OLE Automation\".</li>\n<li>Click OK.</li>\n<li>Navigate to References again and check \"OLE Automation\".</li>\n<li>Click OK.</li>\n</ol>\n"}], "owner": {"reputation": 435, "user_id": 1100561, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b07f5c57aba88b06a59bb9f82807fbb7?s=128&d=identicon&r=PG", "display_name": "CromeX", "link": "https://stackoverflow.com/users/1100561/cromex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472085066, "creation_date": 1472027631, "question_id": 39118279, "link": "https://stackoverflow.com/questions/39118279/excel-vba-listview-object-feature-not-found-when-exporting-xlam-file-to-another", "title": "EXCEL VBA: Listview object feature not found when exporting XLAM file to another machine", "body": "<p>Writing a quick function to help my colleagues. Using the ListView object from the tools-> Additional Controls -> Microsoft Listview. </p>\n\n<p>When I export the file as an encrypted add-in i.e. .Xlam file. I get the following error</p>\n\n<pre><code>Compile error:\nObject Library feature not supported\n     Ok    HELP\n</code></pre>\n\n<p>As usual MS help is useless. I opened up the code and find that the <strong>Listview</strong> object is lost in the process. Same Office spec (2010), pretty much same PC install Image.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1472044082, "post_id": 39118247, "comment_id": 65593935, "body": "Range.Autofilter only has 2 criteria arguments, <code>Criteria1</code> and <code>Criteria2</code>. You can also only specify a <b><i>single</i></b> parameter for <code>Operator</code>.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow noreferrer\">See the documentation here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1472033995, "post_id": 39118302, "comment_id": 65586843, "body": "Hmm. That could be a workaround. But I tried having 3 conditions and VBA returned to me an &quot;Application or object defined error&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1472046419, "post_id": 39118302, "comment_id": 65595721, "body": "@Tanmoy - See <a href=\"http://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba\">filter out multiple criteria using excel vba</a>."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1472027714, "creation_date": 1472027714, "answer_id": 39118302, "question_id": 39118247, "link": "https://stackoverflow.com/questions/39118247/too-may-line-continuations/39118302#39118302", "title": "Too may line continuations", "body": "<p>For some bizarre reason, there's a limit to the number of line continuations you can have in VBA.</p>\n\n<p>From memory, it's 25.</p>\n\n<p>The obvious, but not particularly aesthetically pleasing, solution is to re-join some of the lines.</p>\n"}], "owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572624519, "creation_date": 1472027520, "last_edit_date": 1531164843, "question_id": 39118247, "link": "https://stackoverflow.com/questions/39118247/too-may-line-continuations", "title": "Too may line continuations", "body": "<p>I am trying to filter a table (columns - \"A1:BB\") based on a certain column (column #16) which contains several values. However, each cell in the column can contain any one particular value at any time. I am trying to check if the value in the cell matches certain values.</p>\n\n<pre><code>With Sheets(\"LifeTimeData\")\n.Range(\"A1:BB\" &amp; lastrow).AutoFilter field:=16, **SOME CRITERIA HERE**\n.Range(\"A1:BB\" &amp; lastrow).AutoFilter field:=22, Criteria1:=xlFilterLastMonth\n\nSet r = Intersect(.AutoFilter.Range, .Range(\"A:A\"))\nFiltred_Rows_Count = Application.WorksheetFunction.Subtotal(103, r) - 1\nWorksheets(\"LifeTimeData\").AutoFilterMode = False\nSheets(\"Overview\").Range(\"H\" &amp; x) = Filtred_Rows_Count\nEnd With\n</code></pre>\n\n<p>Criteria is as below:</p>\n\n<pre><code>Criteria1:=\"*\" &amp; Trim(\"Franchise Awarded\") &amp; \"*\", _\n         Operator:=xlOr, Criteria2:=\"*\" &amp; Trim(\"Deposit Received\") &amp; \"*\", _\n         Operator:=xlOr, Criteria3:=\"*\" &amp; Trim(\"Agent Awarded\") &amp; \"*\", _\n         Operator:=xlOr, Criteria4:=\"*\" &amp; Trim(\"Approved Operator\") &amp; \"*\", _\n         Operator:=xlOr, Criteria5:=\"*\" &amp; Trim(\"Archive non assign\u00c3\u00a9\") &amp; \"*\", _\n         Operator:=xlOr, Criteria6:=\"*\" &amp; Trim(\"Audit\") &amp; \"*\", _\n         Operator:=xlOr, Criteria7:=\"*\" &amp; Trim(\"Awarded Franchise - New\") &amp; \"*\", _\n         Operator:=xlOr, Criteria8:=\"*\" &amp; Trim(\"Awarded Franchise - Resale\") &amp; \"*\", _\n         Operator:=xlOr, Criteria9:=\"*\" &amp; Trim(\"Chocolate Photo Booth\") &amp; \"*\", _\n         Operator:=xlOr, Criteria10:=\"*\" &amp; Trim(\"Client\") &amp; \"*\", _\n         Operator:=xlOr, Criteria11:=\"*\" &amp; Trim(\"Closed\") &amp; \"*\", _\n         Operator:=xlOr, Criteria12:=\"*\" &amp; Trim(\"Closed Deal - Deposit Agreement\") &amp; \"*\", _\n         Operator:=xlOr, Criteria13:=\"*\" &amp; Trim(\"Closed Deal - Franchise Agreement\") &amp; \"*\", _\n         Operator:=xlOr, Criteria14:=\"*\" &amp; Trim(\"Closed Deal - Restaurant Development Agreement\") &amp; \"*\", _\n         Operator:=xlOr, Criteria15:=\"*\" &amp; Trim(\"Completed\") &amp; \"*\", _\n         Operator:=xlOr, Criteria16:=\"*\" &amp; Trim(\"Completed - Blueprint Only\") &amp; \"*\", _\n         Operator:=xlOr, Criteria17:=\"*\" &amp; Trim(\"Completed Licensee\") &amp; \"*\", _\n         Operator:=xlOr, Criteria18:=\"*\" &amp; Trim(\"CPB Qualification form answered\") &amp; \"*\", _\n         Operator:=xlOr, Criteria19:=\"*\" &amp; Trim(\"CPB Qualification form sent\") &amp; \"*\", _\n         Operator:=xlOr, Criteria20:=\"*\" &amp; Trim(\"Dealer Awarded\") &amp; \"*\", _\n         Operator:=xlOr, Criteria21:=\"*\" &amp; Trim(\"deposit rec\u00e2\u20ac\u2122d\") &amp; \"*\", _\n         Operator:=xlOr, Criteria22:=\"*\" &amp; Trim(\"Closed Sale\") &amp; \"*\", _\n         Operator:=xlOr, Criteria23:=\"*\" &amp; Trim(\"Disponibilit\u00c3\u00a9 territoire en attente\") &amp; \"*\"\n</code></pre>\n\n<p>However, this shows a warning \"Too may line continuations\".</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1472028490, "post_id": 39118234, "comment_id": 65583281, "body": "The code only blink the selected cell.  Once the cell is not selected, it stop blinking."}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1472028938, "post_id": 39118234, "comment_id": 65583542, "body": "Any solution to that?"}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1472031062, "post_id": 39118234, "comment_id": 65584874, "body": "You&#39;d have to amend it to keep an array of the cells you had selected previously and then identify anything selected again which was already in that array. I&#39;m not saying it would be easy though..."}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1472031250, "post_id": 39118234, "comment_id": 65584987, "body": "Sounds complicated... I&#39;ll try though.     Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "is_accepted": true, "score": 1, "last_activity_date": 1472036200, "last_edit_date": 1472036200, "creation_date": 1472035146, "answer_id": 39120999, "question_id": 39118234, "link": "https://stackoverflow.com/questions/39118234/blinking-cells-within-selection/39120999#39120999", "title": "Blinking cells within selection", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\nDim NextBlink As Double\nDim blinkingcells As Range\nSub StartBlink() 'call this make current cell start blinking\n    If blinkingcells Is Nothing Then\n        'start blinking\n        Set blinkingcells = Selection\n        Call Blinking\n    Else\n        'blinking already, just add more blinkingcells\n        Set blinkingcells = Union(blinkingcells, Selection)\n    End If\nEnd Sub\n\nSub Blinking()\n'make cells in global range \"blinkingcell\" blink\n    Dim cell As Range\n    For Each cell In blinkingcells\n        If cell.Interior.ColorIndex = 3 Then\n           cell.Interior.ColorIndex = 0\n        Else\n           cell.Interior.ColorIndex = 3\n        End If\n    Next\n    NextBlink = Now + TimeSerial(0, 0, 0.6)\n    Application.OnTime NextBlink, \"Blinking\", , True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 39120999, "answer_count": 1, "score": 1, "last_activity_date": 1472036200, "creation_date": 1472027475, "question_id": 39118234, "link": "https://stackoverflow.com/questions/39118234/blinking-cells-within-selection", "title": "Blinking cells within selection", "body": "<p>I'm using a code which makes certain cells blink. I've modified the code to make only selected cells blink. The problem is that macro doesn't \"stay\" with the cell after I change selection.\nFor example: If I select cell B6 and run macro - it starts blinking, then I select cell B7 and B6 stops blinking but B7 starts, without even running macro.\nHow could I fix that?</p>\n\n<p>Current code:</p>\n\n<pre><code>Option Explicit\n Dim NextBlink As Double\n\n Sub StartBlinking()\n\n    If Selection.Interior.ColorIndex = 3 Then\n        Selection.Interior.ColorIndex = 0\n    Else\n        Selection.Interior.ColorIndex = 3\n    End If\n    NextBlink = Now + TimeSerial(0, 0, 0.6)\n    Application.OnTime NextBlink, \"StartBlinking\", , True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1472028171, "post_id": 39118229, "comment_id": 65583081, "body": "What do you mean by &#39;similar&#39;? Can you give us some examples?"}, {"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "reply_to_user": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1472028611, "post_id": 39118229, "comment_id": 65583367, "body": "@nekomatic: I added the example into the question"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 0, "creation_date": 1472029307, "post_id": 39118699, "comment_id": 65583740, "body": "I cannot understand this statement <i>*Case MyCell.Value Like &quot;*OtherCase</i>&quot; ** because I want to say if xWs.Name finds a pattern in MyCell.Value. It dose not work"}], "tags": [], "owner": {"reputation": 131, "user_id": 4951336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b3606300fd0f11e20498351637c5f2?s=128&d=identicon&r=PG", "display_name": "Jacques Lalancette", "link": "https://stackoverflow.com/users/4951336/jacques-lalancette"}, "is_accepted": false, "score": 2, "last_activity_date": 1472028800, "creation_date": 1472028800, "answer_id": 39118699, "question_id": 39118229, "link": "https://stackoverflow.com/questions/39118229/combine-like-string-pattern-with-case-in-vba/39118699#39118699", "title": "combine Like (String Pattern) with Case in VBA", "body": "<p>To force this you would need to use a workaround like this:</p>\n\n<pre><code>Select Case True\n     Case MyCell.Value Like \"*Summary*\"\n           Debug.Print \"!\"\n           'DeleteSheetFlag = False\n           '...\n     Case MyCell.Value Like \"*OtherCase*\"\n           DeleteSheetFlag = False\n           '...\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1472028800, "creation_date": 1472027457, "last_edit_date": 1472028556, "question_id": 39118229, "link": "https://stackoverflow.com/questions/39118229/combine-like-string-pattern-with-case-in-vba", "title": "combine Like (String Pattern) with Case in VBA", "body": "<p>I want to combine <code>Like</code> with <code>Case</code> in a VBA code. My current code is able to remove all sheets whose name does not match the names in range A:</p>\n\n<pre><code>Dim MyCell As Range, MyRange As Range\nDim wbook As Workbook, xWs As Worksheet\nDim DeleteSheetFlag As Boolean\n\nSet MyRange = Sheets(\"Summary\").Range(\"A2\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet wbook = ActiveWorkbook\n\nFor Each xWs In wbook.Worksheets\n    DeleteSheetFlag = True\n\n    For Each MyCell In MyRange\n        Select Case xWs.Name\n\n            Case MyCell.Value, \"Summary\"\n                DeleteSheetFlag = False\n                Exit For\n\n        End Select\n\n    Next MyCell\n\n    If DeleteSheetFlag Then\n        xWs.Delete\n    End If\n\nNext xWs\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I want to change it in that way, that it removes all sheets whose name are not <strong>similar</strong> to the names in Range A. If I would be able to get something like </p>\n\n<pre><code> Case **Like** MyCell.Value, \"Summary\"\n                DeleteSheetFlag = False\n</code></pre>\n\n<p>the problem would be solved.\nI mean with similar the pattern match which we know from <a href=\"https://msdn.microsoft.com/en-us/library/te33kb6t.aspx\" rel=\"nofollow noreferrer\">Regular Expressions</a>. In my case I have for example two sheets with the names : <strong>Etat1</strong> and <strong>Etat1(2)</strong> and I want to put in <a href=\"https://i.stack.imgur.com/chspr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/chspr.png\" alt=\"Range A11\"></a> the string <strong>Eta</strong> in order to keep both.</p>\n"}, {"tags": ["excel", "select", "range", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1472027959, "creation_date": 1472027959, "answer_id": 39118386, "question_id": 39118225, "link": "https://stackoverflow.com/questions/39118225/select-range-in-excel-and-making-it-a-table-for-further-reference/39118386#39118386", "title": "Select range in excel and making it a table for further reference", "body": "<p>change your line of:</p>\n\n<pre><code>CrData.ListObjects.Add.Range(StartCell, CrData.Cells(LastRow, LastColumn)).Name = \"CrTbl\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>CrData.ListObjects.Add(xlSrcRange, Range(StartCell, CrData.Cells(LastRow, LastColumn))).Name = \"CrTbl\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6751510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd6d8ef29645eb3454290b7ddaac374?s=128&d=identicon&r=PG&f=1", "display_name": "Celeste", "link": "https://stackoverflow.com/users/6751510/celeste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 39118386, "answer_count": 1, "score": 2, "last_activity_date": 1473958317, "creation_date": 1472027441, "last_edit_date": 1531161705, "question_id": 39118225, "link": "https://stackoverflow.com/questions/39118225/select-range-in-excel-and-making-it-a-table-for-further-reference", "title": "Select range in excel and making it a table for further reference", "body": "<p>I'm fairly new to VBA coding. I am coding a piece for a specific dataset that is received once a quarter. I want the code to select the range and then make it a table after which columns will be added to the table etc.</p>\n\n<p>I wrote the below code, however, it seems to do everything it should, but still gives me an error of \"Type mismatch\" but the actions still performs as it should.</p>\n\n<p>Please advise on what causes the error (Error on line 20 - last step of selecting and creating table)</p>\n\n<pre><code>Sub QMRQOC()\n'CREDIT MACRO\n'Set Variables\n\nDim CrData As Worksheet\nSet CrData = Worksheets(\"Credit Data\")\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\nSet StartCell = Range(\"A1\")\nDim CrRng As Range\nDim CrTbl As ListObject\n\n\n'Find last row and column\nLastRow = CrData.Cells(CrData.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = CrData.Cells(StartCell.Row, CrData.Columns.Count).End(xlToLeft).Column\n\n'Select Range &amp; make it a table\nCrData.ListObjects.Add.Range(StartCell, CrData.Cells(LastRow, LastColumn)).Name = \"CrTbl\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "split"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1472026100, "post_id": 39117586, "comment_id": 65581719, "body": "Have you tried using <code>Mid</code>? Please include what you have already tried."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1472026112, "post_id": 39117586, "comment_id": 65581725, "body": "there is no inbuilt feature for such feat."}, {"owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "edited": false, "score": 0, "creation_date": 1472026689, "post_id": 39117586, "comment_id": 65582099, "body": "@  arcadeprecinct I tried some vba to divide the text for characters, but could not find how to spit the text for specify length text, and how to create the the array. mid is not a proper function  &#39;cuz can not count the length of the source text."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472029294, "post_id": 39117586, "comment_id": 65583728, "body": "@Adam if you can&#39;t count the length of the source text, you need to explain further because when dealing with strings you know the length."}, {"owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472030568, "post_id": 39117586, "comment_id": 65584585, "body": "@arcadeprecinct it&#39;s not that I don&#39;t know the length, but the mid function did not works for input entities withe the different length. Firs have to check the source data length to split to all possible array entries from 1st to the last that will be 5 character length."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472031594, "post_id": 39117586, "comment_id": 65585226, "body": "@Adam that&#39;s what loops are for. Check the length, divide by 5 to find out how long your array will be, redim the array, fill array with loop like in Jaques&#39; answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "edited": false, "score": 0, "creation_date": 1472030030, "post_id": 39117885, "comment_id": 65584213, "body": "I have the table with the 120k row and 22 columns, the source text cells are different length, so I have to check its length at first and then divid it into 5 characters length array entries. It also would be great to define the target array entries length."}], "tags": [], "owner": {"reputation": 131, "user_id": 4951336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b3606300fd0f11e20498351637c5f2?s=128&d=identicon&r=PG", "display_name": "Jacques Lalancette", "link": "https://stackoverflow.com/users/4951336/jacques-lalancette"}, "is_accepted": false, "score": 1, "last_activity_date": 1472026379, "creation_date": 1472026379, "answer_id": 39117885, "question_id": 39117586, "link": "https://stackoverflow.com/questions/39117586/split-cell-into-array-in-excel-for-specify-length/39117885#39117885", "title": "split cell into array in excel for specify length", "body": "<p>If I understand correctly, you have a cell which contains something like this:</p>\n\n<pre><code>A1: AAAAABBBBBCCCCCDDDDD\n</code></pre>\n\n<p>Using the MID() function might help you.  For example:</p>\n\n<pre><code>B1: =MID(A$1,1,5)\nC1: =MID(A$1,1*5+1,5)\nD1: =MID(A$1,2*5+1,5)\n..: =MID(A$1,...*5+1,5)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472029366, "post_id": 39118253, "comment_id": 65583771, "body": "Please edit your question rather than posting it as an answer."}, {"owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472030057, "post_id": 39118253, "comment_id": 65584235, "body": "@arcadeprecinct my apology, wring button."}], "tags": [], "owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "is_accepted": false, "score": -1, "last_activity_date": 1472027548, "creation_date": 1472027548, "answer_id": 39118253, "question_id": 39117586, "link": "https://stackoverflow.com/questions/39117586/split-cell-into-array-in-excel-for-specify-length/39118253#39118253", "title": "split cell into array in excel for specify length", "body": "<p>I have the table with the 120k row and 22 columns, the source text cells are different length, so I have to check its length at first and then divid it into 5 characters length array entries. It also would be great to define the target array entries length. </p>\n"}], "owner": {"reputation": 1, "user_id": 6260796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b4d1a57ee0d835b317a27728e3fe2b?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/6260796/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472031275, "creation_date": 1472025585, "last_edit_date": 1472031275, "question_id": 39117586, "link": "https://stackoverflow.com/questions/39117586/split-cell-into-array-in-excel-for-specify-length", "title": "split cell into array in excel for specify length", "body": "<p>I have some question that I can not handle. I have multiple cells with the long text strings (20 to 60 characters). I want to change each cell into array with the partial text, lets say 5 character length. \nI know that there is some function that enable to split/change into array by space or specific character, but here I need to split the text in smaller  portion, to use it to some search scripts.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472025642, "post_id": 39117409, "comment_id": 65581441, "body": "What about <code>nmsNameSpace.GetSharedDefaultFolder(objRecip, olFolderCalendar).Folders(&quot;Folder Name&quot;)</code> ?"}, {"owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472025785, "post_id": 39117409, "comment_id": 65581523, "body": "&#39;Folder name&#39; or &#39;sub_calendar_name&#39; are the same thing.."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472025883, "post_id": 39117409, "comment_id": 65581586, "body": "Yes, Have you tried updating it with sub-folder name?"}, {"owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1472026033, "post_id": 39117409, "comment_id": 65581683, "body": "My folder name is SharedCalendar and the sub_calendar_name is the same, it was just an example, in the .Folders(&quot;&quot;) it can be any name of folder.. it will not work at all"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1472026815, "post_id": 39117409, "comment_id": 65582207, "body": "Fix the following <code>Set objRecip = objDummy.Recipients.Add(&quot;shared calendar name&quot;)</code> To <code>Set objRecip = nmsNameSpace.CreateRecipient(&quot;Owner&#39;s Name or email address&quot;)</code> see if that helps"}, {"owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1472030122, "post_id": 39117409, "comment_id": 65584272, "body": "Can you put it as an answer? Just to be able to mark it as correct? Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "edited": false, "score": 0, "creation_date": 1472212727, "post_id": 39127185, "comment_id": 65673793, "body": "Thank you for your support fixing the access to subfolders, but right now, after I was able 2 days ago to access them, I am not able anymore, using the same code.. Do you know what could be the reason?"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1472051757, "creation_date": 1472051757, "answer_id": 39127185, "question_id": 39117409, "link": "https://stackoverflow.com/questions/39117409/access-get-subfolder-of-shared-folder/39127185#39127185", "title": "Access Get subfolder of shared folder", "body": "<p>Fix the following <code>Set objRecip = objDummy.Recipients.Add(\"shared calendar name\")</code> To <code>Set objRecip = nmsNameSpace.CreateRecipient(\"Owner's Name or email address\")</code> see if that helps</p>\n"}], "owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 39127185, "answer_count": 1, "score": 1, "last_activity_date": 1593415948, "creation_date": 1472025031, "last_edit_date": 1593415948, "question_id": 39117409, "link": "https://stackoverflow.com/questions/39117409/access-get-subfolder-of-shared-folder", "title": "Access Get subfolder of shared folder", "body": "<p>I am trying to get the meetings from an outlook shared sub folder, but I have no idea why the code below is not working..</p>\n\n<pre><code>Public Sub getCalendarData(calendar_name As String, sDate As Date, eDate As Date, Optional recurItem As Boolean = True)\n    On Error GoTo ErrorHandler\n\n    Dim oOL As Outlook.Application\n    Dim oNS As Outlook.Folder\n    Dim oAppointments As Outlook.AppointmentItem\n    Dim oAppointmentItem As Outlook.AppointmentItem\n    Dim strFilter As String\n    Dim ItemsCal As Outlook.Items\n    Dim olFolder As Outlook.Folder\n    Dim fldCalendar As Outlook.Folder\n    Dim iCalendar As Integer\n    Dim nmsNameSpace As Outlook.Namespace\n    Dim objDummy As Outlook.MailItem\n    Dim objRecip As Outlook.Recipient\n\n    'Set objects\n\n    Set oOL = CreateObject(\"Outlook.Application\")\n    Set nmsNameSpace = oOL.GetNamespace(\"MAPI\")\n\n    Set objDummy = oOL.CreateItem(olMailItem)\n\n    Set objRecip = objDummy.Recipients.Add(\"shared calendar name\")\n    objRecip.Resolve\n\n    'Set filter to grab items by date range\n    strFilter = \"[Start] &gt;= \" _\n    &amp; \"'\" &amp; sDate &amp; \"'\" _\n    &amp; \" AND [End] &lt;= \" _\n    &amp; \"'\" &amp; eDate &amp; \"'\"\n\n    With ItemsCal\n        .Sort \"[Start]\"\n        .IncludeRecurrences = recurItem\n    End With\n\n    If objRecip.Resolved Then\n        On Error Resume Next\n        Set fldCalendar = nmsNameSpace.GetSharedDefaultFolder(objRecip, olFolderCalendar).Folders(\"sub_calendar_name\")\n\n        If Not fldCalendar Is Nothing Then\n            Set ItemsCal = fldCalendar.Items\n            If Not ItemsCal Is Nothing Then\n                For Each oAppointmentItem In ItemsCal.Restrict(strFilter)\n                    Set objItem = oAppointmentItem\n                    With oAppointmentItem\n                        iCalendar = getSegmentIDByName(calendar_name)\n                        meeting_id = insertAppointment(iCalendar, .Start, .End, scrubData(.Subject), scrubData(.Location), Format(.Start, \"Long Time\"), .duration, .Body)\n                        Call GetAttendeeList(meeting_id, objItem, .Recipients)\n                    End With\n                Next\n            End If\n        End If\n    End If\n\n    'Garbage cleanup\n    Set oAppointmentItem = Nothing\n    Set oAppoinments = Nothing\n    Set oNS = Nothing\n    Set oOL = Nothing\n\nExit Sub\nErrorHandler:\n    'MsgBox \"Error: \" &amp; Err &amp; \" | \" &amp; Error(Err)\n    'Whenever error occurs, skip to next\n    Resume Next\nEnd Sub\n</code></pre>\n\n<p>If I only use <code>Set fldCalendar = nmsNameSpace.GetSharedDefaultFolder(objRecip, olFolderCalendar)</code> it will give me the shared calendar items, but not the subfolder calendar items</p>\n\n<p>Could someone point me trough?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "macros", "vba"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472026061, "post_id": 39117439, "comment_id": 65581702, "body": "Excellent it works. It copies the data perfectly, but the data in column B2 B4 B6 still remains there. I don&#39;t need that. Need to delete them. Please a solution to that I much appreciated."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472026139, "post_id": 39117439, "comment_id": 65581753, "body": "@Siraj Ok, but looking at your history you don&#39;t accept anyones answers. So this time you first accept then I give you the last line of code you are missing"}, {"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472026260, "post_id": 39117439, "comment_id": 65581843, "body": "I wish, please tell how to do that."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472026682, "post_id": 39117439, "comment_id": 65582095, "body": "There are three buttons on the left of each answer. One is for accept, one is to upvote and one is to downvote. <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472026916, "post_id": 39117439, "comment_id": 65582268, "body": "@Siraj edited my answer, thank you. In my opinion you should go back to your old questions and give the people that helped you in the past the credit they deserve."}, {"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 1, "creation_date": 1472026922, "post_id": 39117439, "comment_id": 65582273, "body": "Thanks Andrea. I did accepted your answer. Honestly those three button are not visible for me. I just moved the cursor over and got the alt text and accepted. Same for all history of my answers. I will go now and accept all answers. Thanks"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472027353, "post_id": 39117439, "comment_id": 65582563, "body": "Try changing your screensettings then. Like gamma or contrast. It&#39;s probably one of those that make gray items disapear."}, {"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472027660, "post_id": 39117439, "comment_id": 65582767, "body": "Hi Andreas, Can you please provide me the last line of code to delete."}, {"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1472027865, "post_id": 39117439, "comment_id": 65582891, "body": "Wonderful, it worked. Thanks a lot for solving my problem."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 1, "last_activity_date": 1472026845, "last_edit_date": 1472026845, "creation_date": 1472025112, "answer_id": 39117439, "question_id": 39117348, "link": "https://stackoverflow.com/questions/39117348/macro-to-move-alternate-row-data-in-column-b-to-column-c-alternaltely/39117439#39117439", "title": "Macro to move alternate row data in column B to column C alternaltely", "body": "<p>This should do it.</p>\n\n<pre><code>For i =2 to 500 step 2\n   Range(\"C\" &amp; i-1).value = Range(\"B\" &amp; i).value\n   Range(\"B\" &amp; i).value = \"\"\nNext i\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 39117439, "answer_count": 1, "score": -2, "last_activity_date": 1472026845, "creation_date": 1472024850, "last_edit_date": 1531161705, "question_id": 39117348, "link": "https://stackoverflow.com/questions/39117348/macro-to-move-alternate-row-data-in-column-b-to-column-c-alternaltely", "title": "Macro to move alternate row data in column B to column C alternaltely", "body": "<p>I am na\u00efve to macros. I have data in column B with 500 rows of data. I need to move alternate rows of data to columns C . </p>\n\n<pre><code>For example, move data from \nB2 to C1, \nB4 to C3, \nB6 to C5, and so on\n</code></pre>\n\n<p>I appreciate if anyone can provide macro for this.\nThanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "is_accepted": false, "score": 0, "last_activity_date": 1472024984, "creation_date": 1472024984, "answer_id": 39117385, "question_id": 39117325, "link": "https://stackoverflow.com/questions/39117325/click-button-on-one-sheet-for-data-on-another-sheet/39117385#39117385", "title": "Click Button on One Sheet for Data on another Sheet", "body": "<p>You could switch to <code>sheet2</code> and then execute any subsequent command without the need to explicitly mentioned <code>sheet2</code> like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Worksheets(\"sheet2\").Activate    'Switch to sheet2\n\n    Cells(1, 1).Value = 1    'this change will happen in sheet2\n    Celss(2,1).Value = 1     'this too\n    ...\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 4453321, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98df64a6bb0299cd3f919be122fc4202?s=128&d=identicon&r=PG&f=1", "display_name": "TheCharlatan", "link": "https://stackoverflow.com/users/4453321/thecharlatan"}, "edited": false, "score": 0, "creation_date": 1472025247, "post_id": 39117426, "comment_id": 65581159, "body": "Is there a difference in performance between <code>With Worksheets(&quot;sheet2&quot;)</code> and <code>Worksheets(&quot;sheet2&quot;).Activate</code> ?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 169, "user_id": 4453321, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98df64a6bb0299cd3f919be122fc4202?s=128&d=identicon&r=PG&f=1", "display_name": "TheCharlatan", "link": "https://stackoverflow.com/users/4453321/thecharlatan"}, "edited": false, "score": 0, "creation_date": 1472025367, "post_id": 39117426, "comment_id": 65581253, "body": "you have just 2-3 cells to change then not really, but for larger numbers, definitely yes."}, {"owner": {"reputation": 169, "user_id": 4453321, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98df64a6bb0299cd3f919be122fc4202?s=128&d=identicon&r=PG&f=1", "display_name": "TheCharlatan", "link": "https://stackoverflow.com/users/4453321/thecharlatan"}, "edited": false, "score": 0, "creation_date": 1472025485, "post_id": 39117426, "comment_id": 65581326, "body": "I have about 10000 rows of data in &quot;sheet2&quot;, and the sub contains a lot of code. Is <code>With</code> then the recommended option?"}, {"owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1472025589, "post_id": 39117426, "comment_id": 65581395, "body": "I doubt there is any difference in performance. The only difference is that code will be more readable."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1472025291, "last_edit_date": 1472025291, "creation_date": 1472025078, "answer_id": 39117426, "question_id": 39117325, "link": "https://stackoverflow.com/questions/39117325/click-button-on-one-sheet-for-data-on-another-sheet/39117426#39117426", "title": "Click Button on One Sheet for Data on another Sheet", "body": "<p>you should use <code>With</code> and <code>Activate</code> or <code>Select</code> will bring the sheet in focus.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   With  Worksheets(\"sheet2\")\n      .Cells(1, 1).Value = 1 \n      .Cells(2,1).Value = 1\n    ...\n\n    '/Activate the sheet\n     .Activate\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 4453321, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98df64a6bb0299cd3f919be122fc4202?s=128&d=identicon&r=PG&f=1", "display_name": "TheCharlatan", "link": "https://stackoverflow.com/users/4453321/thecharlatan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "accepted_answer_id": 39117426, "answer_count": 2, "score": 0, "last_activity_date": 1472025291, "creation_date": 1472024762, "last_edit_date": 1472025093, "question_id": 39117325, "link": "https://stackoverflow.com/questions/39117325/click-button-on-one-sheet-for-data-on-another-sheet", "title": "Click Button on One Sheet for Data on another Sheet", "body": "<p>I have a click button on \"sheet1\" and would like it to execute its code when clicked on \"sheet2\", where all the data is at. What is the recommended way to activate the other sheet?</p>\n\n<p>I am new to vba and have read some posts about this in the past few days, but have not found a satisfying answer so far on how to implement the sheet change as simple as possible. I have seen things like:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Worksheets(\"sheet2\").Cells(1, 1).Value = 1 \n    Worksheets(\"sheet2\").Cells(2,1).Value = 1\n    ...\nEnd Sub\n</code></pre>\n\n<p>, where I have to constantly redeclare the object's scope to \"sheet2\". </p>\n"}, {"tags": ["sql-server", "excel", "vba", "ssl"], "comments": [{"owner": {"reputation": 15036, "user_id": 2893376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rDwgj.jpg?s=128&g=1", "display_name": "gofr1", "link": "https://stackoverflow.com/users/2893376/gofr1"}, "edited": false, "score": 0, "creation_date": 1472025917, "post_id": 39117323, "comment_id": 65581604, "body": "There are at list two properties in connection string that are used for encrypted connection: <code>Encrypt=True;TrustServerCertificate=True;</code>, thats all I can say about this, hope it helps you a bit."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 1739653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CsVk8.png?s=128&g=1", "display_name": "DBNinja", "link": "https://stackoverflow.com/users/1739653/dbninja"}, "is_accepted": false, "score": 1, "last_activity_date": 1474434322, "creation_date": 1474434322, "answer_id": 39607949, "question_id": 39117323, "link": "https://stackoverflow.com/questions/39117323/can-vba-connect-to-sql-server-via-ssl-certificate/39607949#39607949", "title": "Can VBA connect to SQL server via SSL certificate?", "body": "<p>You need to remember there are a few different ways to setup encryption. One is server side or client side or both (which is not recommended). Assuming you have SSL enabled on the SQL Server side and have Enabled Force Encrypted Connection then all connections to the SQL Server would be forced to use SSL certificate. You can find more information on how to set this up in SQL Server here <a href=\"https://support.microsoft.com/en-au/kb/316898\" rel=\"nofollow\">https://support.microsoft.com/en-au/kb/316898</a></p>\n\n<p>Once you have the server ready to accept SSL you need to have the client machine running excel set up to trust the certificate's root authority. Once this is done your connection to the SQL Server would be SSL enabled. The following article goes through how to import the root certificate <a href=\"https://technet.microsoft.com/en-us/library/cc754841.aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/cc754841.aspx</a></p>\n\n<p>Hopefully this gives you a better understanding of how it works and what you need to do. You can find a lot of information if you google \"setting up SSL on the SQL Server\" and \"setting up trust for certificates root authority\".</p>\n"}], "owner": {"reputation": 51, "user_id": 6715785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fVgLC.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/6715785/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1574553897, "creation_date": 1472024758, "last_edit_date": 1574553897, "question_id": 39117323, "link": "https://stackoverflow.com/questions/39117323/can-vba-connect-to-sql-server-via-ssl-certificate", "title": "Can VBA connect to SQL server via SSL certificate?", "body": "<p>I'm using an Excel application with a SQL server database. I'd like to use SQL Server in a cloud and need to use a secure connection. </p>\n\n<p>Does anyone know how this can be done?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472024672, "post_id": 39116720, "comment_id": 65580829, "body": "Are you checking if any cell in that range has the search term <code>&quot;text&quot;</code>?"}, {"owner": {"reputation": 65, "user_id": 6680670, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9ae35ca7e996244a99eeda4c46a80cfb?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/6680670/marco"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472025181, "post_id": 39116720, "comment_id": 65581102, "body": "@SiddharthRout: I have 7 texts that needs to be checked in that certain range and each text has a specific function to call."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472025694, "post_id": 39116720, "comment_id": 65581477, "body": "See the answer that i posted"}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472023573, "post_id": 39116840, "comment_id": 65580199, "body": "Also possible via <code>For Each cCell in Sheets(1).[A1:A95]</code>. Just in case the OP like it that way :P"}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472023683, "post_id": 39116840, "comment_id": 65580260, "body": "Correct, just prefer showing the standard way when not sure how advanced the poster is."}, {"owner": {"reputation": 65, "user_id": 6680670, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9ae35ca7e996244a99eeda4c46a80cfb?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/6680670/marco"}, "edited": false, "score": 0, "creation_date": 1472025059, "post_id": 39116840, "comment_id": 65581038, "body": "@dinotom  This work thanks but I&#39;m having another issue. The if function doesn&#39;t seem to work. The regardless if the text is false, it still performs the function and I have up to 7 text that needs to be checked with 7 different functions for it."}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "reply_to_user": {"reputation": 65, "user_id": 6680670, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9ae35ca7e996244a99eeda4c46a80cfb?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/6680670/marco"}, "edited": false, "score": 0, "creation_date": 1472025308, "post_id": 39116840, "comment_id": 65581213, "body": "@Marco... Add Debug.Print cCell.Value before the If statement and step thru the code to ensure that the value coming from the cell is what you expect, otherwise the If statement should work as shown."}, {"owner": {"reputation": 65, "user_id": 6680670, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9ae35ca7e996244a99eeda4c46a80cfb?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/6680670/marco"}, "edited": false, "score": 0, "creation_date": 1472025679, "post_id": 39116840, "comment_id": 65581465, "body": "@Dinotom - Man you&#39;ve been a very great help today. The &#39;Debug.Print cCell.Value&#39; works, however it&#39;s not checking the other &#39;IF&#39; statements on my code. I have 7 &#39;IF&#39; statements for each specific text that needs to be checked."}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "edited": false, "score": 0, "creation_date": 1472025851, "post_id": 39116840, "comment_id": 65581562, "body": "That Debug line will only show the cell value in that specific For loop. The if statement should jump to whatever &quot;If&quot; value that debug line is showing you."}], "tags": [], "owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "is_accepted": true, "score": 2, "last_activity_date": 1472026167, "last_edit_date": 1472026167, "creation_date": 1472023259, "answer_id": 39116840, "question_id": 39116720, "link": "https://stackoverflow.com/questions/39116720/if-function-for-cell-contents/39116840#39116840", "title": "If function for cell contents", "body": "<p>If you are trying to check each cell in the range for whatever you are testing for then, try it this way.</p>\n\n<pre><code>Dim cCell As Range\n\nFor Each cCell in Sheets(1).Range(\"$A$1:$A$95\")\n    'To test to ensure cCell.Value is what you expect(can remove once working)\n    Debug.Print cCell.Value\n    If cCell.Value =\"whateveryouwanttotestfor\" Then\n        'Call your function here\n        Call myFunction\n    End If\n\nNext cCell\n</code></pre>\n\n<p>To test for multiple values of cCell use Select Case</p>\n\n<pre><code>For Each cCell in Sheets(1).Range(\"$A$1:$A$95\")\n    Select Case cCell.Value\n        Case \"text1\"\n           Call text1Function\n        Case \"text2\"\n           Call text2Function\n        'Do the rest that you need\n    End Select\nNext cCell\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6680670, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9ae35ca7e996244a99eeda4c46a80cfb?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/6680670/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 39116840, "answer_count": 1, "score": 0, "last_activity_date": 1472026167, "creation_date": 1472022928, "question_id": 39116720, "link": "https://stackoverflow.com/questions/39116720/if-function-for-cell-contents", "title": "If function for cell contents", "body": "<p>I'm trying to check that if the content for a certain range is true, it will perform a function. </p>\n\n<pre><code>    With Sheets(1).[A1:A95]\n        If .Cells.Value = \"text\" Then\n            'Perform function\n        End If\n    End With\n</code></pre>\n\n<p>But I'm getting a Type Mismatch error. Help please.</p>\n"}, {"tags": ["vba", "excel", "variables"], "comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 2, "creation_date": 1472022520, "post_id": 39116580, "comment_id": 65579587, "body": "why would you want to do that? XY problem?"}, {"owner": {"reputation": 861, "user_id": 3819737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/34e9dd9f6d205abadfbb012d2f43fad4?s=128&d=identicon&r=PG&f=1", "display_name": "alve89", "link": "https://stackoverflow.com/users/3819737/alve89"}, "reply_to_user": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1472022668, "post_id": 39116580, "comment_id": 65579684, "body": "I want some variables to be filled into cells specified by the names (of variables and cells)."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 3, "creation_date": 1472022845, "post_id": 39116580, "comment_id": 65579784, "body": "no there isn&#39;t. you must use either a <code>Dictionary</code> object or a <code>Class</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1472023748, "post_id": 39116580, "comment_id": 65580298, "body": "<code>myVariable</code> is the name of the variable <code>myVariable</code>. To assign it to a cell, simply do <code>[A1] = myVariable</code>"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472049268, "post_id": 39116580, "comment_id": 65597942, "body": "@alve89 could you rephrase this : &quot;<i>I want some variables to be filled into cells specified by the names (of variables and cells).</i>&quot; ? I don&#39;t understand what you are trying to do"}, {"owner": {"reputation": 1, "user_id": 14204059, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/219a54014f8921bc5f8f278a47d2aa5d?s=128&d=identicon&r=PG", "display_name": "user14204059", "link": "https://stackoverflow.com/users/14204059/user14204059"}, "edited": false, "score": 0, "creation_date": 1598979479, "post_id": 39116580, "comment_id": 112630506, "body": "Old thread, I know, but see and <a href=\"https://stackoverflow.com/questions/24173082/print-a-variables-name\" title=\"print a variables name\">stackoverflow.com/questions/24173082/print-a-variables-name</a> for a possible approach."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1472031385, "creation_date": 1472031385, "answer_id": 39119582, "question_id": 39116580, "link": "https://stackoverflow.com/questions/39116580/vba-get-name-of-variable/39119582#39119582", "title": "VBA: Get name of variable", "body": "<p>a possible Class approach would be the following (commented):</p>\n\n<ol>\n<li><p>Add Class Module</p>\n\n<p>in VBA IDE</p>\n\n<ul>\n<li><p>click Insert-> Class Module</p></li>\n<li><p>click View -> Property Window</p></li>\n<li><p>enter <code>(Name)</code> property textbox and type in \"Variable\" (or whatever you may prefer but be consistent with in following steps)</p></li>\n<li><p>enter the following code in the <code>Class</code> code pane</p>\n\n<pre><code>Option Explicit\n\n'declare the fields that will be attached to every instance of this class\nPublic name As String '&lt;--| this will store the name of the variable to which you'll set the object of this class\nPublic value As Variant '&lt;--| this will store the value associated with the variable to which you'll set the object of this class\n\n'declare a `method` to write the `value` of the object in the named range named after the `name` field \nSub WriteRange(Optional wb As Variant) '&lt;--| you can pass the reference of the workbook whose named ranges you want to exploit\n   If IsMissing(wb) Then Set wb = ActiveWorkbook '&lt;--| if no workbook reference is passed then the currently active workbook is assumed\n   If TypeName(wb) = \"Workbook\" Then '&lt;-- check for a proper workbook reference being passed)\n        On Error Resume Next '&lt;-- to prevent unassigned named range throw an error\n        wb.Names(name).RefersToRange.value = value '&lt;--| write the  value of the `value` filed of the current instance in the named range of the passed workbook named after the `name` filed of the current instance\n    End If\nEnd Sub \n</code></pre></li>\n</ul></li>\n<li><p>Exploit <code>Variable</code> Class in your code</p>\n\n<p>as an example of exploiting the <code>Variable</code> class for three variables with, say, a <code>String</code> value for the 1st, an <code>Integer</code> value for the 2nd and a <code>Double</code> value for the 3rd, in any module code pane enter the following code:</p>\n\n<pre><code>    Option Explicit\n\n    Sub main()\n        Dim myVariable1 As Variable, myVariable2 As Variable, myVariable3 As Variable '&lt;--| declare your variables of type \"Variable\": choose whatever name you may want\n\n        Set myVariable1 = CreateVariable(\"myVariable1\", \"this is a string value\") '&lt;-- set your 1st variable with its name (you must use the same name as the variable!) and value (myVariable1 will have a `String`type value)\n        Set myVariable2 = CreateVariable(\"myVariable2\", 10) '&lt;-- set your 2nd variable with its name (you must use the same name as the variable!) and value (myVariable2 will have a `Integer`type value)\n        Set myVariable3 = CreateVariable(\"myVariable3\", 0.3)'&lt;-- set your 3rd variable with its name (you must use the same name as the variable!) and value (myVariable3 will have a `Double` type value)\n\n        'exploit `WriteRange` method of your Class to write the object value into the corresponding named range: you must have set proper named ranges in your currently active workbook\n        myVariable1.WriteRange '&lt;--| this will write the string \"this is a string value\" in named range \"myVariable1\" of your currently active workbook\n        myVariable2.WriteRange '&lt;--| this will write the number '10' in named range \"myVariable2\" of your currently active workbook\n        myVariable3.WriteRange '&lt;--| this will write the number '0.3' in named range \"myVariable3\" of your currently active workbook \n    End Sub\n\n    ' helper Function to create an object of `Variable` class and initialize its `name` and `value` properties \n    Function CreateVariable(name As String, value As Variant) As Variable '&lt;--| the function returns an object of `Variable` class\n        Set CreateVariable = New Variable '&lt;--| this creates a new object of `Variable` class\n        With CreateVariable '&lt;--| refer to the newly created object and ...\n            .name = name '&lt;--| ... set its `name` property ...\n            .value = value '&lt;--| ... and its `value` property\n        End With\n    End Function\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14400171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a852c1153bceb8feb74cb8def8b4beab?s=128&d=identicon&r=PG", "display_name": "David Gonzales", "link": "https://stackoverflow.com/users/14400171/david-gonzales"}, "is_accepted": false, "score": 0, "last_activity_date": 1602005226, "last_edit_date": 1602005226, "creation_date": 1601980839, "answer_id": 64224145, "question_id": 39116580, "link": "https://stackoverflow.com/questions/39116580/vba-get-name-of-variable/64224145#64224145", "title": "VBA: Get name of variable", "body": "<p>If you only have a few variables then a class module is over kill.\nWhile it is true that a class module is a template that can be copied, I have explored a simplification which mimics a class module.</p>\n<p>Create a standard module with the name of your variable as the module name.\nInside this module create functions like <code>Name</code>, <code>Value</code>\ne.g.</p>\n<pre><code>Function Name()\n    Name = &quot;myNewName&quot;\nEnd Function\n\nFunction Value()\n    Value = 10\nEnd Function\n</code></pre>\n<p>in a cell, paste <code>=my_VBA_Project.myVariable.Name()</code></p>\n<p>The drawback is that the values are hard coded like a constant. To change the values, you need to edit the function values manually.</p>\n<p>I use this format in my VBA programming to simulate OOP.</p>\n"}], "owner": {"reputation": 861, "user_id": 3819737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/34e9dd9f6d205abadfbb012d2f43fad4?s=128&d=identicon&r=PG&f=1", "display_name": "alve89", "link": "https://stackoverflow.com/users/3819737/alve89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5314, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1602005226, "creation_date": 1472022427, "last_edit_date": 1531164843, "question_id": 39116580, "link": "https://stackoverflow.com/questions/39116580/vba-get-name-of-variable", "title": "VBA: Get name of variable", "body": "<p>is there a function or a property to get a variables name?</p>\n\n<p>Something like</p>\n\n<p><code>msgBox myVariable.name</code>\nor</p>\n\n<p><code>msgBox nameOfVariable(myVariable)</code></p>\n\n<p>that returns <code>\"myVariable\"</code> when I defined it with e.g. <code>myVariable = \"whatever\"</code>?\nGoogle just brings questions to variable referencing...</p>\n"}, {"tags": ["excel", "csv", "hierarchical-data", "vba"], "comments": [{"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472023548, "post_id": 39116436, "comment_id": 65580185, "body": "Are you trying to read the data from a CSV file and do a TextToColumns using VBA ?"}, {"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "reply_to_user": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472023711, "post_id": 39116436, "comment_id": 65580275, "body": "the problem with doing that is that i get phased out one cell. it looks like  <code>Components\t\t\t\t \tC\t\t\t \t\tC802 - C842\t\t \t\t\tC802 \t\t\t\t1 (1) \t\t\t\t2 (2)</code>"}, {"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "reply_to_user": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472023906, "post_id": 39116436, "comment_id": 65580410, "body": "i cant make it show the structure, but you can get it by doing that into excel and doing the text to columns"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "edited": false, "score": 1, "creation_date": 1472024324, "post_id": 39117103, "comment_id": 65580649, "body": "It does the same as       <code>Selection.TextToColumns Destination:=Range(&quot;A1&quot;), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1)), TrailingMinusNumbers:=True</code>  the problem is that when pivoted you cannot get the value of cell A1 for lets say a level 12 layer value."}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "edited": false, "score": 0, "creation_date": 1472024664, "post_id": 39117103, "comment_id": 65580825, "body": "can you show me the output you are looking for, because i am not able to understand what is that you want"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1472024102, "creation_date": 1472024102, "answer_id": 39117103, "question_id": 39116436, "link": "https://stackoverflow.com/questions/39116436/multilayer-csv-to-filtered-excel/39117103#39117103", "title": "Multilayer CSV to filtered excel", "body": "<p>to do a 'Text To Columns' in VBA</p>\n\n<pre><code>row_count = 13\n\nFor i = 1 To row_count\n    strArray = Split(Cells(i, 1).Value, \",\")\n    For Count = LBound(strArray) To UBound(strArray)\n        Cells(i, Count + 1).Value = strArray(Count)\n    Next\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472027860, "post_id": 39118149, "comment_id": 65582888, "body": "but, this doesn&#39;t have the incremented value like, the value below C802 - C842 should be C802 - C843. and thats what i am trying to do now"}, {"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "reply_to_user": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472028357, "post_id": 39118149, "comment_id": 65583198, "body": "it shouldn&#39;t increment any value. All data is imported from another place and is already there"}, {"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "reply_to_user": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472028504, "post_id": 39118149, "comment_id": 65583289, "body": "it is hierarchical data but in CSV file, that was my problem"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472028590, "post_id": 39118149, "comment_id": 65583354, "body": "glad to know that you found the required solution"}, {"owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "reply_to_user": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "edited": false, "score": 0, "creation_date": 1472028736, "post_id": 39118149, "comment_id": 65583433, "body": "without your part i wouldn&#39;t be able to get it, thanks!"}], "tags": [], "owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "is_accepted": false, "score": 0, "last_activity_date": 1472027223, "creation_date": 1472027223, "answer_id": 39118149, "question_id": 39116436, "link": "https://stackoverflow.com/questions/39116436/multilayer-csv-to-filtered-excel/39118149#39118149", "title": "Multilayer CSV to filtered excel", "body": "<p>Got it to work with the above solution but with slightly changes.\nIt takes a little time though.</p>\n\n<pre><code>    ActiveSheet.UsedRange.Select\n    row_count = Selection.Rows.Count\n    col_count = Selection.Columns.Count\n\n\nFor i = 1 To row_count\n    strArray = Split(Cells(i, 1).Value, \",\")\n    For Count = LBound(strArray) To UBound(strArray)\n    If strArray(Count) = \"\" Then\n        Cells(i, Count + 1).FormulaR1C1 = \"=R[-1]C\"\n    End If\n    If strArray(Count) &lt;&gt; \"\" Then\n        Cells(i, Count + 1).Value = strArray(Count)\n    End If\n    Next\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6751109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd174485fa5d86dc9250232a51366fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Cho Quejumbres", "link": "https://stackoverflow.com/users/6751109/cho-quejumbres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472027223, "creation_date": 1472021981, "last_edit_date": 1531164843, "question_id": 39116436, "link": "https://stackoverflow.com/questions/39116436/multilayer-csv-to-filtered-excel", "title": "Multilayer CSV to filtered excel", "body": "<p>[enter image description here][1]I have the following format CSV Hierarchy data (up to 12 layers) and am trying to fill it in excel so i can at the end create a pivot of data.</p>\n\n<p>Each file (over 1000) are different, i have been trying to code it with Macros but unable to remove all bugs.</p>\n\n<p>First aproach was to create the table and use the above cell on the blanks, but then because of the layers it was not correct by the end of the table</p>\n\n<p>Any idea on how to approach this only by using Macros?</p>\n\n<pre><code>Level 1,Level 2,Level 3,Level 4,Level 5,Level 6,Level 7,Level 8,Level 9,Level 10,Level 11,Level 12\nTest\n,,,,,Components\n,,,,,,DEFAULT LOGIC\n,,,,,,,z04 - z05\n,,,,,,,,z04 ()\n,,,,,,,,,%PWR_PG_U_BACKLIGHT% ()\nComponents\n,C\n,,C802 - C842\n,,,C802\n,,,,1 (1)\n,,,,2 (2)\n</code></pre>\n\n<p>[This is what i got|<a href=\"http://i.stack.imgur.com/BJ2Qg.png]\" rel=\"nofollow\">http://i.stack.imgur.com/BJ2Qg.png]</a></p>\n\n<p>[This is what i need for the pivot|<a href=\"http://i.stack.imgur.com/7Q6jq.png]\" rel=\"nofollow\">http://i.stack.imgur.com/7Q6jq.png]</a></p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1472021196, "post_id": 39115936, "comment_id": 65578878, "body": "Are both tables related?"}, {"owner": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "reply_to_user": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1472022018, "post_id": 39115936, "comment_id": 65579315, "body": "Based on what I think you mean, I would say yes. The ID of the first table is listed in another table to relate to the name of the person in the first table :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472026173, "post_id": 39115936, "comment_id": 65581782, "body": "you could do what you&#39;ve said, by joining the tables on ID_var, and then using a criteria on table 1 like &quot;Mrs.*&quot; for example, then use the results to update.  update table2 set gender =-1 inner join table1 as t1 on t1.id=foo where t1.Field like &quot;<i>Mrs.</i>&quot;   &lt;--- example(ish) :)"}], "answers": [{"comments": [{"owner": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "edited": false, "score": 0, "creation_date": 1472027110, "post_id": 39117920, "comment_id": 65582394, "body": "Works like a charm! Thanks a lot! Would you mind explaining a bit? I get the last two lines, but how does the first one work?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "reply_to_user": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "edited": false, "score": 0, "creation_date": 1472028274, "post_id": 39117920, "comment_id": 65583157, "body": "The INNER JOIN is a WHERE clause too. It says that the statement should only be run for a record that has a corresponding ID in both tables."}, {"owner": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "edited": false, "score": 0, "creation_date": 1472029595, "post_id": 39117920, "comment_id": 65583927, "body": "Oh ok, I see. Thanks again :)"}], "tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": true, "score": 1, "last_activity_date": 1472026497, "creation_date": 1472026497, "answer_id": 39117920, "question_id": 39115936, "link": "https://stackoverflow.com/questions/39115936/access-check-if-dataset-contains-string-via-vba-macro/39117920#39117920", "title": "Access Check If DataSet contains string via vba Macro", "body": "<p>Try this (SQL update query):</p>\n\n<pre><code>UPDATE 2nd_Table INNER JOIN 1st_Table ON 2nd_Table.ID = 1st_Table.ID\nSET 2nd_Table.gender = -1 \nWHERE 1st_Table.PersonName LIKE '*Mrs.*'\n</code></pre>\n\n<p>ID -> reference between both tables\nPersonName -> column in 1st table containing Mrs.</p>\n"}], "owner": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 39117920, "answer_count": 1, "score": -1, "last_activity_date": 1472026497, "creation_date": 1472020214, "last_edit_date": 1472025007, "question_id": 39115936, "link": "https://stackoverflow.com/questions/39115936/access-check-if-dataset-contains-string-via-vba-macro", "title": "Access Check If DataSet contains string via vba Macro", "body": "<p>Hello Stackoverflow community!</p>\n\n<p>I am currently confronted with writing somthing, that automatically cleans up a database after certain requirements. Here is what I have to do:\nIf a cell in one table contains a certain substr (lets say \"Mrs.\"), in another table a Togglebox is supposed to be checked (Yes if \"Mrs.\" is contained and No if not)\nI already worked out something that sets The Toggleboxes to -1 in that column, but I have to include a check, if it even has to be changed and in which row. For that I wanted to bring up an If-construction and a variable that would contain the ID of the first table's row to determine, which of the Rows in the second table have to be changed.</p>\n\n<p>So the thought is like this:</p>\n\n<pre><code>If 1st_Table contains \"Mrs.\" Then\n   CurrentDb.Execute \"UPDATE 2nd_Table SET gender = -1 WHERE foo = 1st_Table.ID_Var\"\n</code></pre>\n\n<p>1st_Table.ID_Var would contain the ID of the row of the first table\nNow the more or less obvious question: How do I accomplish that?\nThis is bascally the first time working with VBA/Access AND SQL so I have no closer thoughts on how to do that.</p>\n\n<p>Thanks in advance</p>\n\n<p>Greetings</p>\n\n<p>geisterfurz007</p>\n\n<p>P.S. The variable names will be changed in the final version; they are just to visualize. Just saw that they were colored by SO.</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1472019522, "post_id": 39115529, "comment_id": 65578027, "body": "#felipe31 are you sure of your code?!?!? you select cells(&quot;D:BF&quot;) and you clear those, then the LastRow will be D1 !!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1472019711, "post_id": 39115529, "comment_id": 65578114, "body": "@Fabrizio the OP is clearing the old data before he imports the new data."}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472019828, "post_id": 39115529, "comment_id": 65578173, "body": "@ThomasInzina is right"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472100493, "post_id": 39115529, "comment_id": 65618435, "body": "With Excel 2010 and above you can try importing with Power Query"}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1472019783, "creation_date": 1472019783, "answer_id": 39115808, "question_id": 39115529, "link": "https://stackoverflow.com/questions/39115529/excel-is-freezing-when-importing-large-csv/39115808#39115808", "title": "Excel is freezing when importing large CSV", "body": "<p>use <code>doevents</code>command after paste...I hope it works</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472020265, "post_id": 39115857, "comment_id": 65578379, "body": "I&#39;ll try this tomorrow and I tell you"}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472069136, "post_id": 39115857, "comment_id": 65609620, "body": "It doesnt work, the problem is on importing. I did a macro just to import and it keeps freezing and i need to press esc"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472071332, "post_id": 39115857, "comment_id": 65610675, "body": "If &quot;the problem is on importing&quot; then you should post this code:&quot;<i>Code to import csv file to D1</i>&quot;"}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472075875, "post_id": 39115857, "comment_id": 65612690, "body": "Posted the link up there"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472080185, "post_id": 39115857, "comment_id": 65613973, "body": "You code is just a standard text file import.  I don&#39;t know why it stopped working.  I would have posted the code and change the file path to <code>C:\\Users\\Data Files\\sample.xlsm</code>.  In an hour or so I will update my answer to read and import the csv file line by line.  It will be a little slow nut shouldn&#39;t freeze up."}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472080544, "post_id": 39115857, "comment_id": 65614074, "body": "Yea, I don&#39;t know either. The screen becomes white and shows Not Responding, and be there like for maaaany minutes, I never really went to the end. When I press &quot;Esc&quot; the data was imported but if the macro has more sentences, it will stop before the next sentence."}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472142498, "post_id": 39115857, "comment_id": 65644183, "body": "It worked! Its giving me 1 empty column between each column of data, you know why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472143940, "post_id": 39115857, "comment_id": 65645044, "body": "@felipe31 Sorry about that,  I reworked my code and had left an unneeded line in there <code>y = y +1</code>.  Remove that line.  I&#39;m updating my answer now."}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472148294, "post_id": 39115857, "comment_id": 65647480, "body": "Works perfectly! Thank you. Could you explain how the Importcsvfile works?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472149400, "post_id": 39115857, "comment_id": 65648068, "body": "<code>ReDim arData(PageSize, ColumnCount)</code> defines a 2 dimensional array with 10K rows and 100 columns.  <code>Importcsvfile</code> opens up the CSV (which is just a text file) and reads it line by line.  Each line is split, by the delimiter, into a 1 dimensional array (e.g. arLine).  The <code>For y</code> loop transfers the 1D array data into Row x of the 2D array, When the 2D array <code>arData</code> is filled or the end of the CSV file is the data is transferred to the WorkSheet and the variables are reset (arData is Redim to clear the data and x is reset to 0)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1472149965, "post_id": 39115857, "comment_id": 65648348, "body": "The trick is that variables <code>x</code> and <code>y</code> mark the last used row and column of the arData.  I use this values to resize the next empty cell&#39;s range to fit the actual used elements of arData.  The extra empty rows and columns are ignored."}, {"owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1481254018, "post_id": 39115857, "comment_id": 69312572, "body": "Hello again! It&#39;s been working very well, thank you. But now I&#39;ve got other issues. The csv file has some data in format: dd/mm/yyyy and Comma as decimal delimiter. So it imports 31800 instead of 31.8 and the day becomes month, month becomes day. Any solution?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "edited": false, "score": 0, "creation_date": 1481269354, "post_id": 39115857, "comment_id": 69317568, "body": "@felipe31 You&#39;ll need to preprocess the line before splitting it.  Post a line of raw data in a comment and write a function to correct the issue."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1472149450, "last_edit_date": 1472149450, "creation_date": 1472019951, "answer_id": 39115857, "question_id": 39115529, "link": "https://stackoverflow.com/questions/39115529/excel-is-freezing-when-importing-large-csv/39115857#39115857", "title": "Excel is freezing when importing large CSV", "body": "<p>Read the CSV file line by line into an array that is 10,000 rows by 100 columns.  When the array is full I write it into Excel, redim the array and continue until the end of file.</p>\n\n<p>I originally tried to use a dynamic array but it Excel would freeze up.  Using the static array is actually more efficient.</p>\n\n<p>You'll need to adjust the constant values.  From your image it looks like your file is semi-colon delimited.  It does matter if <code>ColumnCount</code> is exact as long as it is greater than or equal to the actual column count.</p>\n\n<pre><code>Const CSVFileName = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Sample Data File\\R58K x C60.csv\"\nConst Delimiter = \",\"\nConst PageSize = 10000\nConst ColumnCount = 100\n</code></pre>\n\n<p>It takes about 32 seconds to import 100,000 rows and 64 columns.  The CSV file is 69.5 MB on disk.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2sXoa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2sXoa.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub ProcessFile()\n    Const CSVFileName = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Sample Data File\\R58K x C60.csv\"\n    Const Delimiter = \",\"\n\n    ActiveSheet.DisplayPageBreaks = False\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Debug.Print Now\n    Dim Start: Start = Timer\n\n    Dim lastRow As Long\n    Dim arFormulas\n    arFormulas = Range(\"A1:C1\").Formula\n\n    Columns(\"A:BF\").ClearContents\n\n    ImportCSVFile CSVFileName, Delimiter\n\n    Debug.Print \"Time to import CSV file in seconds:\"; Timer - Start\n    Start = Timer\n\n    lastRow = Cells(Rows.Count, \"D\").End(xlUp).Row\n\n    Range(\"A1:C\" &amp; lastRow).Formula = arFormulas\n\n    Debug.Print \"Time to add formulas in seconds:\"; Timer - Start\n\n    Debug.Print \"Column Count:\"; Worksheets(\"Sheet1\").UsedRange.Columns.Count\n    Debug.Print \"Row Count:\"; Worksheets(\"Sheet1\").UsedRange.Rows.Count\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .AutoRecover.Enabled = True\n    End With\nEnd Sub\n\nSub ImportCSVFile(FilePath As String, Delimiter As String)\n    Const PageSize = 10000\n    Const ColumnCount = 100\n\n    Dim line As String\n    Dim arData, arLine\n    Dim x As Long, y As Long, z As Long\n    ReDim arData(PageSize, ColumnCount)\n    z = 1\n\n    Open FilePath For Input As #1                     ' Open file for input\n    Do While Not EOF(1)                               ' Loop until end of file\n        Line Input #1, line\n        arLine = Split(line, Delimiter)\n\n        y = 0\n        For y = 0 To UBound(arLine)\n            arData(x, y) = arLine(y)\n        Next\n        x = x + 1\n\n        If x = PageSize Or EOF(1) Then\n\n            Range(\"D\" &amp; z).Resize(x, y) = arData\n            z = z + x\n            ReDim arData(PageSize, ColumnCount)\n            x = 0\n        End If\n\n    Loop\n\n    Close #1\n\n    Erase arData\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5514650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2090fcff5484f604c2deb298fdb27b41?s=128&d=identicon&r=PG&f=1", "display_name": "felipe31", "link": "https://stackoverflow.com/users/5514650/felipe31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 39115857, "answer_count": 2, "score": -1, "last_activity_date": 1490237271, "creation_date": 1472018730, "last_edit_date": 1490237271, "question_id": 39115529, "link": "https://stackoverflow.com/questions/39115529/excel-is-freezing-when-importing-large-csv", "title": "Excel is freezing when importing large CSV", "body": "<p>I have a very large CSV file, with 60 columns and 50k rows. (I can't show you because it is in the intranet.)</p>\n\n<p>I wrote VBA code that does this:</p>\n\n<pre><code>Columns(\"D:BF\").Select\nSelection.ClearContents\n*Code to import csv file to D1*\nLastRow = Cells(Rows.Count, \"D\").End(xlUp).Row\nRange(\"A1:C1\").Select\nSelection.Copy\nRange(\"A2:C\" &amp; lastrow).Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>It was working, but has stopped working. When I run the macro Excel freezes. I need to press \"Esc\" and the macro stops, then the debugger says the PasteSpecial is wrong. \nBut it is not, if I run a macro only to import, and press \"Esc\", it imports very well, then I run the second macro to paste the formulas until the last row and it runs very well too.</p>\n\n<p>The workbook is in manual calculation</p>\n\n<p><a href=\"https://i.stack.imgur.com/HKzJE.jpg\" rel=\"nofollow noreferrer\">http://i.stack.imgur.com/HKzJE.jpg</a></p>\n"}, {"tags": ["vba", "excel", "variables"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472018456, "post_id": 39115400, "comment_id": 65577629, "body": "<code>DateRaised</code> is not a cell... this way it would be <code>Cells(emptyRow, 1).Value = DateRaised</code> without the <code>.Value</code>... same for the other lines"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472018761, "post_id": 39115400, "comment_id": 65577721, "body": "Also something like <code>Dim AllValues As Variant</code> with <code>AllValues = [A2:R2].Value2</code> is possible. Insert the values then with <code>Cells(emptyRow, 1).Resize(,17).Value = AllValues</code> ;)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472019320, "post_id": 39115400, "comment_id": 65577938, "body": "@DirkReichel: but there&#39;s a &quot;hole&quot; in values: they range form column &quot;A&quot; to &quot;D&quot; and then from &quot;F&quot; to &quot;R&quot;"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1472021286, "post_id": 39115400, "comment_id": 65578936, "body": "Oh yes... I missed that... sorry ;P (still, it could be done with 2 arrays then) :D"}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472093543, "post_id": 39115400, "comment_id": 65616846, "body": "Haha, whoops. That&#39;s just me forgetting the alphabet again."}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472094593, "post_id": 39115400, "comment_id": 65617075, "body": "It should just be A through to Q"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1472019521, "post_id": 39115617, "comment_id": 65578026, "body": "@Peter Peazy Littlefield: and one question: why copying all values in that opened workbook and then discard changes? Aren&#39;t you supposed to use <code>ActiveWorkbook.Close SaveChanges = True</code> instead?"}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472094658, "post_id": 39115617, "comment_id": 65617083, "body": "Yeah you&#39;re right. I tried your code but it doesn&#39;t leave anything in the target workbook regardless of if I put true or false."}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472095338, "post_id": 39115617, "comment_id": 65617226, "body": "Also, I removed the &#39;.value&#39; from the relevant line in my code and it works but it pastes into the source workbook instead of the target. Can you see why this would be happening?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472107977, "post_id": 39115617, "comment_id": 65621288, "body": "see edited code where:1) handled contiguous range from A to Q 2) added <code>.Value</code> after <code>curSht.Cells(2, 1).Resize(, 17)</code>"}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1472111425, "post_id": 39115617, "comment_id": 65623501, "body": "Thank you SO MUCH!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1472107911, "last_edit_date": 1472107911, "creation_date": 1472019113, "answer_id": 39115617, "question_id": 39115400, "link": "https://stackoverflow.com/questions/39115400/copy-cell-values-to-different-workbook/39115617#39115617", "title": "Copy cell values to different Workbook", "body": "<p>it's because you're attempting to treat <em>value</em> types (like <code>String</code> and <code>Long</code>) variables as if they were <code>reference</code> type (objects) ones calling their <code>Value</code> property:</p>\n\n<pre><code>Cells(emptyRow, 1).Value = DateRaised.Value\n</code></pre>\n\n<p>while you can't (unless you use User Defined Types): <em>value</em> type variables can be only accessed as they are:</p>\n\n<pre><code>Cells(emptyRow, 1).Value = DateRaised\n</code></pre>\n\n<p>but you can simply code like follows:</p>\n\n<pre><code>Option Explicit\n\nSub CommandButton1_Click()\n    Dim emptyRow As Long\n    Dim curSht As Worksheet\n\n    Set curSht = ActiveSheet\n    With Workbooks.Open(\"R:\\6024 Onsite\\COVER NOTE WORKFLOW\\Database\\Covernote Databse.xlsx\").Sheets(\"Covernote Database\")\n        emptyRow = WorksheetFunction.CountA(.Range(\"A:A\")) + 1\n        .Cells(emptyRow, 1).Resize(, 17).value = curSht.Cells(2, 1).Resize(, 17).value '&lt;-- paste values from originally opened sheet range A2:Q2\n    End With\n    ActiveWorkbook.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472113527, "creation_date": 1472018077, "last_edit_date": 1472018358, "question_id": 39115400, "link": "https://stackoverflow.com/questions/39115400/copy-cell-values-to-different-workbook", "title": "Copy cell values to different Workbook", "body": "<p>Firstly, let me apologise if this question has already been answered somewhere else. I had a good look but couldn't find anything that would help me.</p>\n\n<p>Secondly, I'm sure there is a far more simple way to do this but I'm very new the VBA and I'm just trying to teach myself as I go along.</p>\n\n<p>Ok, so I have a sheet at the end of my workbook that compiles information from the previous sheet and I want to copy those values that are all in row 2 to another workbook that we have a network drive.</p>\n\n<p>I've managed to get this to work on the same sheet but not to another workbook (without using a userform).</p>\n\n<p>It comes back with the error 'Invalid Qualifier' for the line\n<em>Cells(emptyRow, 1.Value - DateRaised.Value</em></p>\n\n<p>Here is my code below,</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim emptyRow As Long\nDim DateRaised As Long\nDim CustomerName As String\nDim SiteAddress As String\nDim CallReason As String\nDim CustomerOrderNo As Long\nDim InvoiceNo As Long\nDim CovernoteNo As Long\nDim Findings As String\nDim ProductType As String\nDim Supplier As String\nDim Attempts As Long\nDim Condition As String\nDim DateClosed As Long\nDim CreditGiven As String\nDim CreditValue As Long\nDim IssueDays As Long\nDim Comments As String\n\nDateRaised = Cells(2, \"A\").Value\nCustomerName = Cells(2, \"B\").Value\nSiteAddress = Cells(2, \"C\").Value\nCallReason = Cells(2, \"D\").Value\nCustomerOrderNo = Cells(2, \"F\").Value\nInvoiceNo = Cells(2, \"G\").Value\nCovernoteNo = Cells(2, \"H\").Value\nFindings = Cells(2, \"I\").Value\nProductType = Cells(2, \"J\").Value\nSupplier = Cells(2, \"K\").Value\nAttempts = Cells(2, \"L\").Value\nCondition = Cells(2, \"M\").Value\nDateClosed = Cells(2, \"N\").Value\nCreditGiven = Cells(2, \"O\").Value\nCreditValue = Cells(2, \"P\").Value\nIssueDays = Cells(2, \"Q\").Value\nComments = Cells(2, \"R\").Value\n\nDim WrkBk As Workbook\nDim WrkSht As Worksheet\n\nSet WrkBk = Workbooks.Open(\"R:\\6024 Onsite\\COVER NOTE WORKFLOW\\Database\\Covernote Databse.xlsx\")\nSet WrkSht = WrkBk.Sheets(\"Covernote Database\")\nWrkSht.Activate\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\nCells(emptyRow, 1).Value = DateRaised.Value\nCells(emptyRow, 2).Value = CustomerName.Value\nCells(emptyRow, 3).Value = SiteAddress.Value\nCells(emptyRow, 4).Value = CallReason.Value\nCells(emptyRow, 5).Value = CustomerOrderNo.Value\nCells(emptyRow, 6).Value = InvoiceNo.Value\nCells(emptyRow, 7).Value = CovernoteNo.Value\nCells(emptyRow, 8).Value = Findings.Value\nCells(emptyRow, 9).Value = ProductType.Value\nCells(emptyRow, 10).Value = Supplier.Value\nCells(emptyRow, 11).Value = Attemps.Value\nCells(emptyRow, 12).Value = Condition.Value\nCells(emptyRow, 13).Value = DateClosed.Value\nCells(emptyRow, 14).Value = CreditGiven.Value\nCells(emptyRow, 15).Value = CreditValue.Value\nCells(emptyRow, 16).Value = IssueDays.Value\nCells(emptyRow, 17).Value = Comments.Value\n\nWrkBk.Close (SaveChanges = False)\n\nEnd Sub\n</code></pre>\n\n<p>If anyone can point me in the right direction I'd be a very happy man.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472016754, "post_id": 39115085, "comment_id": 65576957, "body": "See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472016820, "post_id": 39115085, "comment_id": 65576988, "body": "Direclty work with objects. <code>Dim wb as workbook: Set wb = workbooks.open(FullFilePathWithName)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472016834, "post_id": 39115085, "comment_id": 65577001, "body": "You should use <code>Application.GetOpenFilename</code> to select the workbook to open.  Your current macro just opens the folder and continues to run: it&#39;s not waiting for you to select a file."}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1472017613, "post_id": 39115085, "comment_id": 65577317, "body": "@Joe penn welcome to stack overflow."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6750768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb267ef5780ee3e1d8f78b28195833d8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Penn", "link": "https://stackoverflow.com/users/6750768/joe-penn"}, "edited": false, "score": 0, "creation_date": 1472018103, "post_id": 39115282, "comment_id": 65577500, "body": "THanks for the help and quick response, it worked perfectly."}], "tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 2, "last_activity_date": 1472098156, "last_edit_date": 1472098156, "creation_date": 1472017562, "answer_id": 39115282, "question_id": 39115085, "link": "https://stackoverflow.com/questions/39115085/excel-set-active-workbook/39115282#39115282", "title": "Excel set active Workbook", "body": "<p>Try below...</p>\n\n<pre><code> filepath = application.getopenfilename()\n Dim Wb as workbook\n Set Wb = workbooks.open(filepath)\n</code></pre>\n\n<p>Use WB as workbook object</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6750768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb267ef5780ee3e1d8f78b28195833d8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Penn", "link": "https://stackoverflow.com/users/6750768/joe-penn"}, "edited": false, "score": 0, "creation_date": 1472091331, "post_id": 39116828, "comment_id": 65616391, "body": "Thank you, that is exactly what I wanted, it opens up to exactly where I want to be."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1472023231, "creation_date": 1472023231, "answer_id": 39116828, "question_id": 39115085, "link": "https://stackoverflow.com/questions/39115085/excel-set-active-workbook/39116828#39116828", "title": "Excel set active Workbook", "body": "<p>Because the OP specified a default path; I recommend using the <code>Application.FileDialog(msoFileDialogFilePicker)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/OxiMO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OxiMO.png\" alt=\"enter image description here\"></a></p>\n\n<h2>USAGE:</h2>\n\n<pre><code>Dim WeeklyWorkbook\n\nSet WeeklyWorkbook = getWeeklyWorkbook\n\nIf WeeklyWorkbook Is Nothing Then\n    MsgBox \"No file selected\", vbInformation, \"Action Cancelled\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<hr>\n\n<pre><code>Function getWeeklyWorkbook() As Workbook\n\n    Dim fDialog As FileDialog, result As Integer\n    Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n    'Optional: FileDialog properties\n    fDialog.AllowMultiSelect = False\n    fDialog.Title = \"Select a file\"\n    fDialog.InitialFileName = Environ(\"USERPROFILE\") &amp; \"\\Dropbox\\On the go ordering\"\n    'Optional: Add filters\n    fDialog.Filters.Clear\n    fDialog.Filters.Add \"Excel files\", \"*.xls, *.xlsx, *.xlsm\"\n    fDialog.Filters.Add \"All files\", \"*.*\"\n\n    'Show the dialog. -1 means success!\n    If fDialog.Show = -1 Then\n        Set getWeeklyWorkbook = Workbooks.Open(fDialog.SelectedItems(1))\n    End If\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Reference: <a href=\"http://analystcave.com/vba-application-filedialog-select-file/\" rel=\"nofollow noreferrer\">VBA FILEDIALOG \u2013 OPENING, SELECTING AND SAVING FILES AND FOLDERS</a></p>\n"}], "owner": {"reputation": 35, "user_id": 6750768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb267ef5780ee3e1d8f78b28195833d8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Penn", "link": "https://stackoverflow.com/users/6750768/joe-penn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3122, "favorite_count": 1, "accepted_answer_id": 39116828, "answer_count": 2, "score": 1, "last_activity_date": 1472098156, "creation_date": 1472016545, "last_edit_date": 1472022036, "question_id": 39115085, "link": "https://stackoverflow.com/questions/39115085/excel-set-active-workbook", "title": "Excel set active Workbook", "body": "<p>I searched the forum and couldn't find an answer that would fit my problem. I am pretty new to Excel VBA and am having trouble activating a workbook I just opened. Directly below is the part that is causing me trouble. </p>\n\n<p>So I press a button and it brings me to the file path, and I select a file to open. Every week this file has a different name and I am not really sure what it is until I open the file path and look at it. </p>\n\n<p>Once I open it, I would like my macro to manipulate the data in the file and copy and paste into the workbook running the code. However when I run this macro and open the file it will not activate the newly opened workbook and runs the rest of the macro trying to manipulate the data in the original file. </p>\n\n<p>I think I either need to open the file differently so that the workbook I just opened is the active one or figure out how to activate the newly opened workbook without knowing the file name. Thank you for your help.</p>\n\n<pre><code>Dim filepath As String\nfilepath = Environ(\"USERPROFILE\") &amp; \"\\Dropbox\\On the go ordering\"\nCall Shell(\"explorer.exe\" &amp; \" \" &amp; filepath, vbNormalFocus)\n\n\nRange(\"A6:E500\").Select\n</code></pre>\n\n<hr>\n\n<pre><code>Sub on_the_go_button()\n\n    Dim RANKER As Workbook\n\n    Set RANKER = ThisWorkbook\n\n    Dim filepath As String\n    filepath = Environ(\"USERPROFILE\") &amp; \"\\Dropbox\\On the go ordering\"\n    Call Shell(\"explorer.exe\" &amp; \" \" &amp; filepath, vbNormalFocus)\n\n\n    Range(\"A6:E500\").Select\n    Selection.Copy\n    Sheets.Add After:=Sheets(Sheets.Count)\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$E$495\").AutoFilter Field:=1, Criteria1:=RGB(213, _\n        223, 248), Operator:=xlFilterCellColor\n    Range(\"G1\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(RIGHT(RC[-6],8)=\"\"Subtotal\"\",VALUE(LEFT(RC[-6],6)),\"\"\"\")\"\n    Range(\"H1\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",\"\"\"\",RC[-4])\"\n    Range(\"I1\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",\"\"\"\",RC[-4])\"\n    Range(\"G1:I1\").Select\n        Selection.Copy\n    Range(\"G1:I500\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Selection.Copy\n    RANKER.Activate\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Range(\"P1:Q74\").Select\n    Selection.Copy\n    Sheets(\"Contest\").Select\n    Range(\"A3\").Select\n\n    ActiveCell.End(xlToRight).Select\n\n\n    ActiveCell.Offset(0, 1).Select\n\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "dynamic", "userform"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1472016434, "post_id": 39114803, "comment_id": 65576836, "body": "Have you seen <a href=\"http://stackoverflow.com/questions/12012206/formatting-mm-dd-yyyy-dates-in-textbox-in-vba\">This</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 3989996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea7fbd5a0dc7ad32ffc0d870ce11944?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/3989996/ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1520150792, "creation_date": 1520150792, "answer_id": 49093313, "question_id": 39114803, "link": "https://stackoverflow.com/questions/39114803/creating-dtpicker-control-dynamically/49093313#49093313", "title": "Creating DTPicker Control dynamically", "body": "<p>Try this:</p>\n\n<pre><code>Dim dtDatePicker As Object\nSet dtDatePicker = UserForm.Controls.Add(\"MSComCtl2.DTPicker\", \"dtp\", True)\n' Do whatever you want with dtDatePicker control here!\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6566074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44f333adccfc429bbf876b0c01aa3049?s=128&d=identicon&r=PG&f=1", "display_name": "Navya", "link": "https://stackoverflow.com/users/6566074/navya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1312, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1520150792, "creation_date": 1472015142, "last_edit_date": 1531164843, "question_id": 39114803, "link": "https://stackoverflow.com/questions/39114803/creating-dtpicker-control-dynamically", "title": "Creating DTPicker Control dynamically", "body": "<p>Can someone please guide me on how to create the Date Picker control dynamically in VBA?\nHere is what I am trying to do. I have a macro that adds TextBox and ComboBox controls dynamically to a VBA userform, based on whether the end user would like it to be visible or not. The visibility(and all the other control properties-width,height, etc) are controlled by the end user, by updating Yes/No, values against the control names provided in a \u2018Master\u2019 sheet in excel.</p>\n\n<p>This is what I did for the TextBox and ComboBox controls</p>\n\n<pre><code>`sub test()\n ---- some code\n\n Dim txtTextBox As MSForms.TextBox\n Dim cmbComboBox As MSForms.ComboBox\n\n If 'some cell in excel \u2018Master\u2019 worksheet' = \"ComboBox\" Then\n Set cmbComboBox = UserForm.Controls.Add(\"Forms.ComboBox.1\", 'some cell in excel \u2018Master\u2019 worksheet')\n cmbComboBox.top = 'some cell in excel \u2018Master\u2019 worksheet'\n cmbComboBox.left = 'some cell in excel \u2018Master\u2019 worksheet'\n cmbComboBox.Width = 'some cell in excel \u2018Master\u2019 worksheet'\n cmbComboBox.height = 'cell in excel \u2018Master\u2019 worksheet'\n\n  ----rest of my code\n  end sub`\n</code></pre>\n\n<p>My question is, how do I add the Date picker dynamically, like the way I am adding the TextBox and ComboBox. I using Controls.Add the right way to do it? If so how can I do that? Can someone help me out with this!\nHope my question makes sense. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1472014148, "post_id": 39114201, "comment_id": 65575964, "body": "You have parameter query issues. No luck with last one either? Check your values using debug.print. Add a dbFailonError to your Execute."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1472046952, "post_id": 39114201, "comment_id": 65596183, "body": "I bet it&#39;s the LongText parameters again."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1472044971, "creation_date": 1472044971, "answer_id": 39124583, "question_id": 39114201, "link": "https://stackoverflow.com/questions/39114201/ms-access-2013-saved-append-query-not-updating-all-fields/39124583#39124583", "title": "MS Access 2013 saved append query not updating all fields", "body": "<p>Add the new record via a <code>DAO.Recordset</code> instead of a <code>DAO.QueryDef</code>.</p>\n\n<p>First, include this declaration ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim rs As DAO.Recordset\n</code></pre>\n\n<p>Then use this after <code>Set db = CurrentDb</code> ....</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set rs = db.OpenRecordset(\"tblLogBook\")\nWith rs\n    If okToSave Then\n        .AddNew\n        !UserID = Me.cboUser.Value\n        !UnitID = Me.cboUnit.Value\n        !LogEntry = Me.txtLogEntry.Value\n        !FNotes = Nz(Me.txtFNotes.Value, \"\")\n        .Update\n    End If\n    .Close\nEnd With\n</code></pre>\n\n<p>Note <code>Nz(Me.txtFNotes.Value, \"\")</code> gives you the same thing as <code>IIf(IsNull(Me.txtFNotes.Value), \"\", Me.txtFNotes.Value)</code>, but more concisely.  </p>\n"}], "owner": {"reputation": 25, "user_id": 6748748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b315942ae8e1c7b6b4f609b698132b72?s=128&d=identicon&r=PG&f=1", "display_name": "Hotdog Jackson", "link": "https://stackoverflow.com/users/6748748/hotdog-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 39124583, "answer_count": 1, "score": 1, "last_activity_date": 1472045034, "creation_date": 1472011184, "last_edit_date": 1472045034, "question_id": 39114201, "link": "https://stackoverflow.com/questions/39114201/ms-access-2013-saved-append-query-not-updating-all-fields", "title": "MS Access 2013 saved append query not updating all fields", "body": "<p>I have a saved query, qryInsertLog which is as follows:</p>\n\n<pre><code>PARAMETERS UserIDPar Long, UnitIDPar Long, LogEntryPar LongText, FNotesPar LongText;\nINSERT INTO tblLogBook ( UserID, UnitID, LogEntry, FNotes )\nSELECT [UserIDPar] AS Expr1, [UnitIDPar] AS Expr2, [LogEntryPar] AS Expr3, [FNotesPar] AS Expr4;\n</code></pre>\n\n<p>I'm trying to run this query when a save button is clicked on an unbound form, where the parameters are gathered from the form controls. My VBA code for the save button is:</p>\n\n<pre><code>Private Sub cmdSave_Click()\n\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim okToSave As Boolean\n\nIf Me.cboUser.Value = 0 Or IsNull(Me.cboUser.Value) Then\n    MsgBox \"You must choose a user. Record not saved.\"\n    okToSave = False\nElseIf Me.cboUnit.Value = 0 Or IsNull(Me.cboUnit.Value) Then\n    MsgBox \"You must choose a unit. Record not saved.\"\n    okToSave = False\nElseIf Me.txtLogEntry.Value = \"\" Or IsNull(Me.txtLogEntry.Value) Then\n   MsgBox \"You must have somtehing to log. Record not saved.\"\n    okToSave = False\nElse\n    okToSave = True\nEnd If\n\nSet db = CurrentDb\nSet qdf = db.QueryDefs(\"qryInsertLog\")\n\nqdf.Parameters(\"UserIDPar\").Value = Me.cboUser.Value\nqdf.Parameters(\"UnitIDPar\").Value = Me.cboUnit.Value\nqdf.Parameters(\"LogEntryPar\").Value = Me.txtLogEntry.Value\nqdf.Parameters(\"FNotesPar\").Value = IIf(IsNull(Me.txtFNotes.Value), \"\", Me.txtFNotes.Value)\n\nIf okToSave Then\n     qdf.Execute\nEnd If\n\nqdf.Close\nSet qdf = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When this code is run, the FNotes field of the table isn't updated. The other three fields update as expected. FNotes is the only field which isn't required. I hardcoded a string for FNotes paramater like so:</p>\n\n<pre><code>qdf.Parameters(\"FNotesPar\").Value = \"why doesn't this work\"\n</code></pre>\n\n<p>rather than using the form control value, and got the same result: that field just doesn't update. When I run this query from the Access Objects window and supply parameter values from the prompts, it works just fine. When I create form that's bound to the table, it also seems to work just fine.</p>\n\n<p>I can't figure out why there's no trouble updating the LogEntry field but the FNotes field fails to update.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1472009675, "post_id": 39113913, "comment_id": 65574901, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/ms757849(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms757849(v=vs.85).aspx</a> - pay attention to the 3rd parameter."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1472009768, "post_id": 39113913, "comment_id": 65574918, "body": "And if the request is processed asynchronously the function <i>can&#39;t</i> return a string based on the response because the request is not completed."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1472010242, "post_id": 39113913, "comment_id": 65575042, "body": "Your <code>XMLHTTP</code> is going to go out of scope before the event would fire anyway. You should define <code>XMLHTTP</code> outside of the function, perhaps as <code>Public</code> in the module - or somewhere else."}, {"owner": {"reputation": 731, "user_id": 2031714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2923c2e12c1a51e874529056b7a8f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Yann", "link": "https://stackoverflow.com/users/2031714/yann"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1472013925, "post_id": 39113913, "comment_id": 65575905, "body": "@user2864740 I&#39;ve had a previous look at the onreadystatechange method, but this forces me to call a separate &quot;pseudo&quot; callback, hence jump out of the function, and loose the scope."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1472014509, "post_id": 39113913, "comment_id": 65576096, "body": "@Yann That&#39;s the core problem: code that must be treated async must be treated async. Otherwise it is synchronous (and blocking)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472014548, "post_id": 39113913, "comment_id": 65576106, "body": "You can&#39;t stay in the original function <i>and</i> run it asynch...   There has to be a separate handler.  VBA doesn&#39;t have function pointers, so you&#39;ll need to create a wrapper class for this."}], "answers": [{"tags": [], "owner": {"reputation": 731, "user_id": 2031714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2923c2e12c1a51e874529056b7a8f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Yann", "link": "https://stackoverflow.com/users/2031714/yann"}, "is_accepted": false, "score": 0, "last_activity_date": 1472015011, "creation_date": 1472015011, "answer_id": 39114786, "question_id": 39113913, "link": "https://stackoverflow.com/questions/39113913/vba-asynchronous-data-call-with-http/39114786#39114786", "title": "VBA Asynchronous data call with HTTP", "body": "<p>After further reading I realised that VBA simply does not support callback functions out of the box.</p>\n\n<p>Using XMLHTTP.onreadystatechange is a viable solution but it would require to work around 2 limitations:</p>\n\n<p>1) XMLHTTP would have to be declared publicly in order to keep the object's scope available for the \"callback\" (this is fine).</p>\n\n<p>2) the original function could not return a value so I would have to save the output in a procedure (instead of a \"scalar\" function that returns the output).</p>\n"}], "owner": {"reputation": 731, "user_id": 2031714, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2923c2e12c1a51e874529056b7a8f6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Yann", "link": "https://stackoverflow.com/users/2031714/yann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2671, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472015011, "creation_date": 1472009219, "question_id": 39113913, "link": "https://stackoverflow.com/questions/39113913/vba-asynchronous-data-call-with-http", "title": "VBA Asynchronous data call with HTTP", "body": "<p>I have made this handy VBA function that returns the HTTP status of a given URL using a <strong>MSXML2.serverXMLHTTP</strong> object. This function is executed synchronously and the rest of my code freezes until the request is resolved. How do turn this into an asynch call?</p>\n\n<p><strong>Current working function:</strong></p>\n\n<pre><code>Function page_http_status(url) As String\n\n            Dim XMLHTTP As Object\n\n            Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n            XMLHTTP.Open \"GET\", url, False\n            XMLHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n            XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n\n            XMLHTTP.send\n            page_http_status = XMLHTTP.Status\n\nEnd Function\n</code></pre>\n\n<p><strong>Onreadystatechange attempt</strong></p>\n\n<p>I know there is a <em>XMLHTTP.onreadystatechange</em> event that can trigger a named callback function, but how can I trigger this function to return the value for <em>page_http_status()</em>? </p>\n\n<pre><code>XMLHTTP.onreadystatechange = FunctionReadyStateChange\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>Function FunctionReadyStateChange ()\n\nMsgBox (\"Request received! \" &amp; XMLHTTP.Status)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6750274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26b3629fba2f2ea7a0b4061878bbf46?s=128&d=identicon&r=PG&f=1", "display_name": "Yanto", "link": "https://stackoverflow.com/users/6750274/yanto"}, "edited": false, "score": 0, "creation_date": 1472040969, "post_id": 39115344, "comment_id": 65591621, "body": "Hi, Thanks for responding. I did try that method earlier But it is still giving me error. Please do you mind to put the complete code sand test it for me. Thanks...Yanto"}], "tags": [], "owner": {"reputation": 164, "user_id": 6642555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577698e5f4d6349809bb9dd3c9af2ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Mak", "link": "https://stackoverflow.com/users/6642555/mak"}, "is_accepted": false, "score": 0, "last_activity_date": 1472017794, "creation_date": 1472017794, "answer_id": 39115344, "question_id": 39113221, "link": "https://stackoverflow.com/questions/39113221/excel-macro-how-to-merge-2-different-function-of-macros/39115344#39115344", "title": "Excel Macro - How to merge 2 Different Function of Macros", "body": "<p>Just call the sub macro name in your main macro like:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'''''''''''''''''some code''''''''''''''''''''\n    call Worksheet_Change1(Target)\n'''''''''''''''''some code''''''''''''''''''''\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6750274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26b3629fba2f2ea7a0b4061878bbf46?s=128&d=identicon&r=PG&f=1", "display_name": "Yanto", "link": "https://stackoverflow.com/users/6750274/yanto"}, "is_accepted": false, "score": 0, "last_activity_date": 1472042724, "creation_date": 1472042724, "answer_id": 39123740, "question_id": 39113221, "link": "https://stackoverflow.com/questions/39113221/excel-macro-how-to-merge-2-different-function-of-macros/39123740#39123740", "title": "Excel Macro - How to merge 2 Different Function of Macros", "body": "<p>Friend,\nPlease ignore my comment. I managed to get the codes merged with exec output as expected. Thanks again</p>\n\n<p>The codes:\n    Option Explicit</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nOn Error GoTo Whoa\n\nApplication.EnableEvents = False\n\nIf Not Target.Cells.CountLarge &gt; 1 Then\nIf Not Intersect(Target, Columns(1)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(2)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(3)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(4)) Is Nothing Then\nTarget.Offset(1, -3).Select\nEnd If\nEnd If\n\nCall Worksheet_Change1(Target)\n\nLetscontinue:\nApplication.EnableEvents = True\nExit Sub\nWhoa:\nMsgBox Err.Description\nResume Letscontinue\n\nEnd Sub\n\n\nPrivate Sub Worksheet_Change1(ByVal Target As Range)\nIf Intersect(Target, Range(\"D2:D3000\")) Is Nothing Then Exit Sub\nIf Target.Count &gt; 1 Then Exit Sub\nIf Target = \"\" Then Exit Sub\nDim lc As Long\nWith Application\n.EnableEvents = False\n.ScreenUpdating = False\nlc = Cells(Target.Row, Columns.Count).End(xlToLeft).Column\nIf lc = 1 Then\nCells(Target.Row, lc + 2) = Now()\nElseIf lc &gt; 1 Then\nCells(Target.Row, lc + 1) = Now()\nEnd If\n.EnableEvents = True\n.ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/ROuWy.png\" rel=\"nofollow\">The Image link:</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6750274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26b3629fba2f2ea7a0b4061878bbf46?s=128&d=identicon&r=PG&f=1", "display_name": "Yanto", "link": "https://stackoverflow.com/users/6750274/yanto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472042724, "creation_date": 1472003445, "last_edit_date": 1472016758, "question_id": 39113221, "link": "https://stackoverflow.com/questions/39113221/excel-macro-how-to-merge-2-different-function-of-macros", "title": "Excel Macro - How to merge 2 Different Function of Macros", "body": "<p>I am new to here and excel macro beginner. I need help for how to..join below macros into 1. \n- The function of 1st macro is to move the cell to next row once specific cell is entered\n- The function of second sub-macro is enter the timestamp when last specific cell of row is entered.</p>\n\n<p>Thank you...Yanto</p>\n\n<p>The macros:</p>\n\n<p>1st Macro(main)</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo Whoa\n\nApplication.EnableEvents = False\n\nIf Not Target.Cells.CountLarge &gt; 1 Then\nIf Not Intersect(Target, Columns(1)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(2)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(3)) Is Nothing Then\nTarget.Offset(, 1).Select\nElseIf Not Intersect(Target, Columns(4)) Is Nothing Then\nTarget.Offset(1, -3).Select\nEnd If\nEnd If\nLetscontinue:\nApplication.EnableEvents = True\nExit Sub\nWhoa:\nMsgBox Err.Description\nResume Letscontinue\nEnd Sub\n</code></pre>\n\n<p>2nd Macro(sub)</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Private Sub Worksheet_Change1(ByVal Target As Range)\n\nIf Intersect(Target, Range(\"D2:D3000\")) Is Nothing Then Exit Sub\nIf Target.Count &gt; 1 Then Exit Sub\nIf Target = \"\" Then Exit Sub\nDim lc As Long\n\nWith Application\n.EnableEvents = False\n.ScreenUpdating = False\nlc = Cells(Target.Row, Columns.Count).End(xlToLeft).Column\nIf lc = 1 Then\nCells(Target.Row, lc + 2) = Now()\nElseIf lc &gt; 1 Then\nCells(Target.Row, lc + 1) = Now()\nEnd If\n.EnableEvents = True\n.ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["oracle", "excel", "odbc", "siebel", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1472003102, "post_id": 39113158, "comment_id": 65573537, "body": "<code>Obviously all the files are x86.</code>  Obviously."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1472004772, "post_id": 39113158, "comment_id": 65573889, "body": "If you have a 64-bit ODBC connection, I would remove it.  Maybe rename it, but better to remove it.  32-bit Excel has to talk to 32-bit ODBC, and truth be told 64-bit doesn&#39;t buy you anything on the client side."}, {"owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472005074, "post_id": 39113158, "comment_id": 65573952, "body": "I have completely removed all 64-bit connections just to be safe, even deleted the registry values for it, still won&#39;t pickup the 32-bit ones"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1472019501, "post_id": 39113158, "comment_id": 65578018, "body": "Is your Excel 32 bit or 64 bit?"}, {"owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472085054, "post_id": 39113158, "comment_id": 65615130, "body": "It is 32 bit, I&#39;ve just done a fresh install of all components and still having the exact same issue"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472075566, "post_id": 39116247, "comment_id": 65612565, "body": "That&#39;s the thing, I am definitely using 32bit excel and 32bit drivers. Are you running a 64bit os?"}, {"owner": {"reputation": 1536, "user_id": 2145381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0330794bf663cce3e4f00cf96036950?s=128&d=identicon&r=PG", "display_name": "Ranjith R", "link": "https://stackoverflow.com/users/2145381/ranjith-r"}, "reply_to_user": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472105438, "post_id": 39116247, "comment_id": 65620097, "body": "Yes @daniel.henley, I am on Win7-64bit. But I got excel and oracle drivers 32 bit installed, because siebel.exe and tools.exe are all 32 bit. My macros  work fine."}, {"owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472163161, "post_id": 39116247, "comment_id": 65654491, "body": "I&#39;m definitely using the same software then. Are you using the Siebel Oracle80 driver for the dsn? My DSN is currently pointed to the fin2000\\bin\\seor815.dll, and its working fine for tools and siebel connections, just not in excel.   Have you connected to the siebel database by loading the cfg file? Documentation for it is here <a href=\"https://www.google.com.au/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=3&amp;ved=0ahUKEwi-3rG-nNvOAhWQq5QKHc3rC44QFggoMAI&amp;url=https%3A%2F%2Fdocs.oracle.com%2Fcd%2FE14004_01%2Fbooks%2FPDF%2FOIRef.pdf&amp;usg=AFQjCNE2G3AuItagZm6e1i7MFyI_eaRSbw&amp;sig2=BIodgnDBEpZ2BCtw3wBo3Q\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "edited": false, "score": 0, "creation_date": 1472705896, "post_id": 39116247, "comment_id": 65861356, "body": "Hi again Ranjith.  The excel file you attached allows direct modification of the database, but what we are currently using is the COM Data Server, documented here [link] (<a href=\"https://docs.oracle.com/cd/E05553_01/books/OIRef/OIRefProgramming22.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E05553_01/books/OIRef/&hellip;</a>). No matter what I do I still can&#39;t get it working.  The reason we use this is any modifications that we make are made as a front end Siebel user, which means all business rules and such are followed, and the SiebelDataServer.ApplicationObject gives a lot of functionality.  Any ideas?"}], "tags": [], "owner": {"reputation": 1536, "user_id": 2145381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0330794bf663cce3e4f00cf96036950?s=128&d=identicon&r=PG", "display_name": "Ranjith R", "link": "https://stackoverflow.com/users/2145381/ranjith-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1472106177, "last_edit_date": 1472106177, "creation_date": 1472021358, "answer_id": 39116247, "question_id": 39113158, "link": "https://stackoverflow.com/questions/39113158/forcing-excel-x86-vba-code-to-connect-to-odbc-x86-on-win7-x64/39116247#39116247", "title": "Forcing Excel (x86) VBA code to connect to ODBC (x86) on Win7 x64", "body": "<p>You will have to use 32bit version of Excel. And have 32bit drivers for the database. I am using a similiar vb macro in excel and this still works for me.</p>\n\n<p>Years ago, I based my custom excel sheet on this <a href=\"http://www.livecharts.co.uk/dukascopy/Sel2XL.xls\" rel=\"nofollow\">Sel2xl.xls</a> file , and modified on it. It connects to ODBC via DSNs, and it still works till date. Try and test this on your instance, you can see the macro code if it works.</p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntY75.jpg?s=128&g=1", "display_name": "Brian Hartung", "link": "https://stackoverflow.com/users/308951/brian-hartung"}, "is_accepted": false, "score": 0, "last_activity_date": 1483576060, "creation_date": 1483576060, "answer_id": 41475445, "question_id": 39113158, "link": "https://stackoverflow.com/questions/39113158/forcing-excel-x86-vba-code-to-connect-to-odbc-x86-on-win7-x64/41475445#41475445", "title": "Forcing Excel (x86) VBA code to connect to ODBC (x86) on Win7 x64", "body": "<p>I know I'm a few months late to the party, but based on a comment on an answer above it looks like you are trying to use the custom DataDirect Oracle driver that comes packaged with Siebel.  You can't use that outside of the Siebel software because it requires a license key that only the Siebel software can provide.  Try it with your own DSN using the plain old Oracle ODBC driver.</p>\n"}], "owner": {"reputation": 1, "user_id": 6750262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/605477f60b04a69a750c52a4c73912f4?s=128&d=identicon&r=PG&f=1", "display_name": "daniel.henley", "link": "https://stackoverflow.com/users/6750262/daniel-henley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 949, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483576060, "creation_date": 1472002902, "last_edit_date": 1531161705, "question_id": 39113158, "link": "https://stackoverflow.com/questions/39113158/forcing-excel-x86-vba-code-to-connect-to-odbc-x86-on-win7-x64", "title": "Forcing Excel (x86) VBA code to connect to ODBC (x86) on Win7 x64", "body": "<p>We run a VBA script through excel to update a Siebel database, works perfectly in x86 OS but not in x64. Obviously all the files are x86.</p>\n\n<p>The code is throwing an error:\n[4096] An Oracle database error has occurred. Possibly the database name is invalid.</p>\n\n<p>The correct connection is definitely referenced correctly (its loaded from a cfg file setup for the actual Siebel applcation, which works fine)</p>\n\n<p>The ODBC connection is shown in the odbcad32 applications (the x86 version not x64)</p>\n\n<p>Through Siebel we can force it to run x86 with a parameter, is there anyway we can force excel to connect to the x86 connection?</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1472006708, "post_id": 39113049, "comment_id": 65574303, "body": "HI... can you explain from which table u refering.."}, {"owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1472063231, "post_id": 39113049, "comment_id": 65606500, "body": "@HA560   I mean tr.rowBoard table I have a problem with trying to import any value from that table into excel cell..."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "edited": false, "score": 0, "creation_date": 1472040612, "post_id": 39114995, "comment_id": 65591366, "body": "Great hint! @ Siddharth Rout , I am having a hard time to import Code value from the web table (tr.rowBoard) into B1 cell in excel, I think Xpath is a problem but the xpath    //*[@id=&quot;wideContent&quot;]/div[5]/div[2]/div[1]/table/tbody/tr[3&zwnj;&#8203;]/td[3]/span   I got from inspect elements in Chrome"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1472016105, "last_edit_date": 1495542180, "creation_date": 1472016105, "answer_id": 39114995, "question_id": 39113049, "link": "https://stackoverflow.com/questions/39113049/web-scraping-create-object-for-ie/39114995#39114995", "title": "Web scraping - create object for IE", "body": "<p>You are using <code>SendKeys</code> which are highly unreliable :) Why not find the name of the textbox and the search button and directly interact with it as shown below?</p>\n\n<pre><code>Sub Get_Data()\n    Dim ie As Object, objInputs As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n    ie.Navigate \"http://www.scramble.nl/military-database/usaf\"\n\n    Do While ie.readystate &lt;&gt; 4: DoEvents: Loop\n\n    '~~&gt; Get the ID of the textbox where you want to output\n    ie.Document.getElementById(\"serial\").Value = \"03-3114\"\n\n    '~~&gt; Here we try to identify the search button and click it\n    Set objInputs = ie.Document.getElementsByTagName(\"input\")\n    For Each ele In objInputs\n        If ele.Name Like \"sbm\" Then\n            ele.Click\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: To understand how I got the names <code>serial</code> and <code>sbm</code>, refer to the explanation given just above the image below.</p>\n\n<blockquote>\n  <p>The code below searches for keyboard typed value 03-3114 and gets a data in the table. If I 'd like to search for value which is already in cell A1 and scrape values from table for \"Code, Type, CN, Unit\" in cell range (\"B1:E1\") what should I do?</p>\n</blockquote>\n\n<p>Directly put the value from <code>A1</code> in lieu of the hardcoded value</p>\n\n<pre><code>ie.Document.getElementById(\"serial\").Value = Sheets(\"Sheet1\").Range(\"A1\").Value\n</code></pre>\n\n<p>To get the values from the table, identify the elements of the table by right clicking on it in the browser and clicking on \"Inspect/Inspect Element(<em>In Chrome it is just <code>Inspect</code></em>)\" as shown below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/6GOX8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6GOX8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I can give you the code but I want you to do it yourself. If you are still stuck then update the question with the code that you tried and then we will take it from there.</p>\n\n<p><strong>Interesting read</strong>: <a href=\"https://stackoverflow.com/questions/8798260/html-parsing-of-cricinfo-scorecards\">html parsing of cricinfo scorecards</a></p>\n"}], "owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472062795, "creation_date": 1472001948, "last_edit_date": 1531164843, "question_id": 39113049, "link": "https://stackoverflow.com/questions/39113049/web-scraping-create-object-for-ie", "title": "Web scraping - create object for IE", "body": "<pre><code>Sub Get_Data()\n\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\nie.Navigate \"http://www.scramble.nl/military-database/usaf\"\nDo While ie.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\nSendKeys \"03-3114\"\nSendKeys \"{ENTER}\"\n\n\nEnd Sub\n</code></pre>\n\n<p>The code below searches for keyboard typed value <strong>03-3114</strong> and gets a data in the table. If I 'd like to search for value which is already in cell A1 and scrape values from table for \"Code, Type, CN, Unit\" in cell range (\"B1:E1\") what should I do?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1472002160, "post_id": 39112905, "comment_id": 65573298, "body": "an easier alternative is to format the range as Table (Home tab &gt; Format as Table) so that formulas are auto populated when you add a new row to the table"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1472002711, "post_id": 39112905, "comment_id": 65573431, "body": "Learning to format your code in a readable fashion will do wonders for your ability to actually read the code."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1472002860, "post_id": 39112905, "comment_id": 65573477, "body": "@Pieter Geerkens that would not be valid code in VBA so it will be harder for people to copy it"}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472004585, "post_id": 39112905, "comment_id": 65573843, "body": "@Slai Thanks for responding. That would be a possible solution if I didn&#39;t need to put the date of the Sunday of the current week (21/08/2016) against the new records."}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1472004661, "post_id": 39112905, "comment_id": 65573859, "body": "@PieterGeerkens I&#39;m afraid your response doesn&#39;t make a lot of sense to me, can you provide an example? For it&#39;s correct purpose, I think this line of code is quite elegant"}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472004843, "post_id": 39112905, "comment_id": 65573898, "body": "@ThomasInzina I think I stole this line of code from something you shared with me initially.  Any suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472100506, "post_id": 39113442, "comment_id": 65618441, "body": "Thanks, I was trying to get it all in one line of code, but between you and Slai, it seems that isn&#39;t achievable.  I won&#39;t have time to work on this again until next week but I will try out both options."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472101740, "post_id": 39113442, "comment_id": 65618767, "body": "@HelenRolls maybe something like <code>Range([&#39;Closed Loop&#39;!F28], [&#39;Closed Loop&#39;!F28].End(xlDown)).Offset(, 2).FormulaR1C1 = &quot;My Formula&quot;</code>"}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472620196, "post_id": 39113442, "comment_id": 65818936, "body": "Thanks for your input."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1472101078, "last_edit_date": 1472101078, "creation_date": 1472005349, "answer_id": 39113442, "question_id": 39112905, "link": "https://stackoverflow.com/questions/39112905/excel-vba-select-new-usedrange-portion-of-a-column/39113442#39113442", "title": "Excel VBA select new usedrange portion of a column", "body": "<p><code>.UsedRange</code> would also include formatted blank cells so it is not reliable for finding the last used row.</p>\n\n<pre><code>Set ws = Sheets(\"Closed Loop\")\nSet cell1 = ws.Range(varPastePos) ' F28\nSet cell2 = cell1.End(xlDown)     ' F32 ? the last cell with data below F28. Similar to clicking on F28 and pressing Ctrl + down\nSet rngF = ws.Range(cell1, cell2) ' F28:F32\nSet rngH = rngF.Offset(, 2)        ' H28:H32\nrngH.FormulaR1C1 = \"My Formula\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472100496, "post_id": 39113942, "comment_id": 65618437, "body": "Thanks, I was trying to get it all in one line of code, but between you and Slai, it seems that isn&#39;t achievable.  I won&#39;t have time to work on this again until next week but I will try out both options."}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472292822, "post_id": 39113942, "comment_id": 65701350, "body": "Thanks for that.  FillDown is reliant on content in the adjacent column isn&#39;t it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472293791, "post_id": 39113942, "comment_id": 65701628, "body": "FillDown works just like dragging the fill handle on a worksheet.  Then formula will change based on the relative reference <code>=$A1</code> will not change  <code>A1</code> will increment <code>=A2</code>,<code>=A3</code>,<code>=A4</code>...etc."}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472619996, "post_id": 39113942, "comment_id": 65818854, "body": "Thanks, I used Range(&quot;D2&quot;, Range(&quot;D&quot; &amp; Rows.Count).End(xlUp)).FillDown to copy down the formulas.  I don&#39;t like to specifying the formula but it&#39;s unlikely anyone will break it."}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472620049, "post_id": 39113942, "comment_id": 65818877, "body": "For entering the date I ended up going with:      varPastePos = Range(varPastePos).Offset(0, -4).Address     Sheets(&quot;Closed Loop&quot;).Range(&quot;F1048576&quot;).End(xlUp).Offset(0, -5).Select     Range(Selection, varPastePos).Formula = Format(Now, &quot;dd/mm/yyyy&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472620332, "post_id": 39113942, "comment_id": 65818984, "body": "Are both ranges on Sheets(&quot;Closed Loop&quot;)?"}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472701176, "post_id": 39113942, "comment_id": 65860330, "body": "Yes. My grammar two up is terrible. What I was trying to say is I like to always specify the exact formula as all my reports are saved on SharePoint for the team to view and there is always a possibility that someone comes through and does something without meaning to."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472702940, "post_id": 39113942, "comment_id": 65860725, "body": "The main thing is that it works.  But I would not select the range."}, {"owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 0, "creation_date": 1472769512, "post_id": 39113942, "comment_id": 65898172, "body": "How would you get around using select? The only way I can see is with a variable which seems a lot of effort for one use. I have been eliminating select as much as possible, on your advice, but in some instances like this, I don&#39;t know how to avoid it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "edited": false, "score": 1, "creation_date": 1472769757, "post_id": 39113942, "comment_id": 65898242, "body": "I would use the extra variable but this will also  work: <code>With Sheets(&quot;Closed Loop&quot;) .Range(.Range(&quot;F&quot; &amp; .Rows.Count).End(xlUp).Offset(0, -5), Range(varPastePos).Offset(0, -4)).Formula = Format(Now, &quot;dd&#47;mm&#47;yyyy&quot;)  End With </code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1472100640, "last_edit_date": 1472100640, "creation_date": 1472009427, "answer_id": 39113942, "question_id": 39112905, "link": "https://stackoverflow.com/questions/39112905/excel-vba-select-new-usedrange-portion-of-a-column/39113942#39113942", "title": "Excel VBA select new usedrange portion of a column", "body": "<p>Use <code>Range().FillDown</code> to extend a pre-existing formula. </p>\n\n<pre><code>Dim lastRow As Long\nlastRow = Range(\"F\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A2\", \"A\" &amp; lastRow).FillDown\n</code></pre>\n\n<p>You can <code>FillDown</code> multiple columns at once like this:</p>\n\n<pre><code> Range(\"A2\", \"D\" &amp; lastRow).FillDown\n</code></pre>\n\n<p>You can do it all in one line like this:</p>\n\n<p><code>Range(\"A2\", Range(\"F\" &amp; Rows.Count).End(xlUp)).FillDown</code></p>\n"}], "owner": {"reputation": 25, "user_id": 4592668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wZqmc.jpg?s=128&g=1", "display_name": "Helen Rolls", "link": "https://stackoverflow.com/users/4592668/helen-rolls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 39113942, "answer_count": 2, "score": 0, "last_activity_date": 1472101078, "creation_date": 1472000754, "last_edit_date": 1531164843, "question_id": 39112905, "link": "https://stackoverflow.com/questions/39112905/excel-vba-select-new-usedrange-portion-of-a-column", "title": "Excel VBA select new usedrange portion of a column", "body": "<p><a href=\"https://i.stack.imgur.com/7G5QT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7G5QT.png\" alt=\"Data Sample\"></a></p>\n\n<p>Hi All. </p>\n\n<p>I need your help please.  </p>\n\n<p>I want to apply a formula to the new rows that I've just added.  I have a line of code I use for a full set of data, but I'm not sure how to modify it, or if there is a better way to do it.  </p>\n\n<p>I'm a bit out of my league with this line of code, I understand what it's doing but I didn't write it.</p>\n\n<pre><code>Sheets(\"Closed Loop\").Range(varPastePos).Offset(0, 2).Resize(ActiveSheet.UsedRange.Rows.Count - 1, columnsize:=1).FormulaR1C1 = \"My Formula\"\n</code></pre>\n\n<p><code>varPastePos</code> is the position the new data was pasted, in this case <code>$F$28</code></p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["excel", "vba", "excel-2010", "conditional-formatting"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471998583, "post_id": 39112653, "comment_id": 65572474, "body": "is the cell color in O11 set by conditional formatting?"}, {"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471998955, "post_id": 39112653, "comment_id": 65572559, "body": "No i forgot to mention that. O11 will be set manually everytime"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1472001064, "post_id": 39112823, "comment_id": 65573056, "body": "Okay so now what if the cells O11 - O20 colour are to correspond to the cells M11 - M20. How would I tackle this?"}, {"owner": {"reputation": 26, "user_id": 6698041, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPCtmgURU58/AAAAAAAAAAI/AAAAAAAAAFw/X29zpMkxo7c/photo.jpg?sz=128", "display_name": "Marivaldo Sena", "link": "https://stackoverflow.com/users/6698041/marivaldo-sena"}, "reply_to_user": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1472001477, "post_id": 39112823, "comment_id": 65573152, "body": "You could use the following.<code>Sub Copy_Color()     Dim iColor As Long     Dim i as long      for i = 11 to 20         iColor = worksheets(&quot;Sheet name&quot;).range(&quot;M&quot; &amp; i).Interior.Color         worksheets(&quot;Sheet name&quot;).range(&quot;O&quot; &amp; i).Interior.Color = iColor     next End Sub</code>"}, {"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1472002120, "post_id": 39112823, "comment_id": 65573290, "body": "I implemented the code above but it gives me a runtime error saying &quot;Runtime error 424 ...Object required&quot;"}, {"owner": {"reputation": 26, "user_id": 6698041, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPCtmgURU58/AAAAAAAAAAI/AAAAAAAAAFw/X29zpMkxo7c/photo.jpg?sz=128", "display_name": "Marivaldo Sena", "link": "https://stackoverflow.com/users/6698041/marivaldo-sena"}, "reply_to_user": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1472002358, "post_id": 39112823, "comment_id": 65573350, "body": "Use the code below. I had a problem when posting the answer. I tried again the code and it didn&#39;t show the error you mentioned."}], "tags": [], "owner": {"reputation": 26, "user_id": 6698041, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPCtmgURU58/AAAAAAAAAAI/AAAAAAAAAFw/X29zpMkxo7c/photo.jpg?sz=128", "display_name": "Marivaldo Sena", "link": "https://stackoverflow.com/users/6698041/marivaldo-sena"}, "is_accepted": false, "score": 1, "last_activity_date": 1471999998, "creation_date": 1471999998, "answer_id": 39112823, "question_id": 39112653, "link": "https://stackoverflow.com/questions/39112653/automatically-copy-a-cells-colour-to-another-cell/39112823#39112823", "title": "Automatically copy a cells colour to another cell", "body": "<p>To solve your problem you need to create a variable to hold the cells color value and set that value back to another cell. Use the following example:`To solve your problem you need to create a variable to hold the cells color value and set that value back to another cell. Use the following example:</p>\n\n<p>To solve your problem you need to create a variable to hold the cells color value and set that value back to another cell. Use the following example:</p>\n\n<pre>\nSub Copy_Color()<br>\n    Dim iColor As Long\n    iColor = ActiveCell.Interior.Color\n    ActiveCell.Offset(0, 1).Interior.Color = iColor\nEnd Sub\n</pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1472003166, "post_id": 39112995, "comment_id": 65573555, "body": "Yes! This is what I wanted! One last thing...is there a way to run this automatically whenever I set the cell style to the cell? I don&#39;t want to click run everytime or use a shortcut key everytime I change the cell style."}], "tags": [], "owner": {"reputation": 26, "user_id": 6698041, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPCtmgURU58/AAAAAAAAAAI/AAAAAAAAAFw/X29zpMkxo7c/photo.jpg?sz=128", "display_name": "Marivaldo Sena", "link": "https://stackoverflow.com/users/6698041/marivaldo-sena"}, "is_accepted": true, "score": 0, "last_activity_date": 1472001546, "creation_date": 1472001546, "answer_id": 39112995, "question_id": 39112653, "link": "https://stackoverflow.com/questions/39112653/automatically-copy-a-cells-colour-to-another-cell/39112995#39112995", "title": "Automatically copy a cells colour to another cell", "body": "<p>To solve your problem you need to create a variable to hold the cells color value and set that value back to another cell. Use the following example:</p>\n\n<p>Sub Copy_Color()<br>\n    Dim iColor As Long<br>\n    Dim i as long</p>\n\n<pre><code>for i = 11 to 20\n    iColor = worksheets(\"Sheet name\").range(\"M\" &amp; i).Interior.Color\n    worksheets(\"Sheet name\").range(\"O\" &amp; i).Interior.Color = iColor\nnext\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2162, "favorite_count": 0, "accepted_answer_id": 39112995, "answer_count": 2, "score": 0, "last_activity_date": 1472001546, "creation_date": 1471998493, "last_edit_date": 1471999118, "question_id": 39112653, "link": "https://stackoverflow.com/questions/39112653/automatically-copy-a-cells-colour-to-another-cell", "title": "Automatically copy a cells colour to another cell", "body": "<p>This is a very simple problem that I can't seem to find the solution. Basically I use 3 different cell styles (good,neutral and bad). What I simply want to do is I want the cell adjacent to the one I colour coded to be the same colour. For example cell O11 I selected it to be good (green colour), hence cell M11 should automatically change its cell style according to cell O11.</p>\n\n<p>Any suggestions?</p>\n\n<p>P.S O11 will be set manually (no conditional formatting)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471998274, "post_id": 39112619, "comment_id": 65572385, "body": "Set <code>Application.Screenupdating = False</code> while running.  Are you defining all those destination ranges in some other code?"}, {"owner": {"reputation": 11, "user_id": 6750131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100527486774353/picture?type=large", "display_name": "Clayton", "link": "https://stackoverflow.com/users/6750131/clayton"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471999067, "post_id": 39112619, "comment_id": 65572585, "body": "Thanks for the idea.  I always wanted to know how to stop that, but it wasn&#39;t updating the screen from sheet to sheet, so that didn&#39;t help the processing time.  The destination ranges (i.e. NextSPGP) are defined ranges in the form: Set NextSPGP = LastGroutEntry.Offset(1, 0)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472004691, "post_id": 39112619, "comment_id": 65573870, "body": "If all of those <code>NextXxxxx</code> ranges are on the same row then you can more-efficiently populate the values using an array, which you can place on the sheet in a single operation."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1612575113, "last_edit_date": 1612575113, "creation_date": 1472002328, "answer_id": 39113099, "question_id": 39112619, "link": "https://stackoverflow.com/questions/39112619/data-input-on-excel-form-sheet-to-database-sheet/39113099#39113099", "title": "Data input on excel: form sheet to database sheet", "body": "<p>I usually start of my routines with something like this:</p>\n<pre><code>Dim bScreenUpdating As Boolean      'Screen Updating Flag\n    Dim bEnableEvents   As Boolean\n    Dim lCalculation    As Long\n\n    With Application\n        bScreenUpdating = .ScreenUpdating\n        bEnableEvents = .EnableEvents\n        lCalculation = .Calculation\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n</code></pre>\n<p>...and end them with something like this:</p>\n<pre><code>With Application\n         .ScreenUpdating = bScreenUpdating\n        .EnableEvents = bEnableEvents\n        .Calculation = lCalculation\n    End With\n</code></pre>\n<p>...so that you turn things off that might slow progress, and restore the users environment afterwards.</p>\n<p>Also, unless you have a reason to use .value, use .value2. See Excel MVP and Recalculation Guru Charles Williams' respone to the following thread:\n<a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">What is the difference between .text, .value, and .value2?</a></p>\n<p>Note that defining ranges in VBA code like you are doing is a recipe for disaster. As soon as someone inserts/deletes a row/column, all your VBA references are pointing at the wrong cells. I <em>always</em> give each of my  ranges of interest a named range, and then reference that name in the VBA.</p>\n<p>Also, you haven't given us much information about your workbook setup. How many values are we talking about here? Hundreds? Thousands? And is anything referencing the destination cells in the destination sheet? What else can you tell us about this workbook? i.e. is it a really big file with lots of formulas? What kinds of formulas? VLOOKUPS? OFFSET or other volatile functions? Are you writing these values into an Excel Table aka ListObject? These can really slow things down - particularly if you don't temporarily turn off calculation.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6750131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100527486774353/picture?type=large", "display_name": "Clayton", "link": "https://stackoverflow.com/users/6750131/clayton"}, "edited": false, "score": 0, "creation_date": 1472090620, "post_id": 39113400, "comment_id": 65616248, "body": "Tim, really appreciate your help.  I knew an array or a string function was the solution, but I couldn&#39;t find a solution anywhere online.  Processing time is down to &lt; 2 seconds.  You&#39;re the man!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1472004936, "creation_date": 1472004936, "answer_id": 39113400, "question_id": 39112619, "link": "https://stackoverflow.com/questions/39112619/data-input-on-excel-form-sheet-to-database-sheet/39113400#39113400", "title": "Data input on excel: form sheet to database sheet", "body": "<p>Instead of this</p>\n\n<pre><code>NextSPGP.Value = Range(\"B7\").Value\nNextDate.Value = Format(Range(\"M7\").Value, \"mm/dd/yyyy\")\nNextStart.Value = Format(Range(\"A12\").Value, \"hh:mm\")\nNextFinish.Value = Format(Range(\"B12\").Value, \"hh:mm\")\nNextMix = Range(\"C12\").Text\nNextBatch.Value = Range(\"D12\").Value\nNextGrouter.Value = Range(\"J7\").Value\n'etc...\n</code></pre>\n\n<p>You can do something like:</p>\n\n<pre><code>Dim Arr\nArr = Array(Range(\"B7\").Value, Format(Range(\"M7\").Value, \"mm/dd/yyyy\"), _\n            Format(Range(\"A12\").Value, \"hh:mm\"),Format(Range(\"B12\").Value, \"hh:mm\"), _\n            Range(\"C12\").Text, Range(\"D12\").Value, Range(\"J7\").Value)\n\n\nNextSPGP.Resize(1,UBound(Arr)+1).Value = Arr 'populate row in one shot\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6750131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100527486774353/picture?type=large", "display_name": "Clayton", "link": "https://stackoverflow.com/users/6750131/clayton"}, "is_accepted": false, "score": 0, "last_activity_date": 1472091135, "creation_date": 1472091135, "answer_id": 39135682, "question_id": 39112619, "link": "https://stackoverflow.com/questions/39112619/data-input-on-excel-form-sheet-to-database-sheet/39135682#39135682", "title": "Data input on excel: form sheet to database sheet", "body": "<p>Tim Williams' suggestion with some minor editing.  The database row had two cells needing data manipulation of a time (date) variable and pressure differential of initial to final pressures on our grout pumping operation.  Success below:</p>\n\n<pre><code>MsgBox \"Starting data input...\"\nenter log data into database\n\nDim NewData\nDim Duration As Date\nDim PressureDiff As Long\n\nDuration = Format((Range(\"B12\") - Range(\"A12\")), \"hh:mm\")\nPressureDiff = (Range(\"H12\") - Range(\"G12\"))\n\nNewData = Array(Range(\"B7\").Value, Format(Range(\"M7\").Value, \"mm/dd/yyyy\"), Format(Range(\"A12\").Value, \"hh:mm\"), _\nFormat(Range(\"B12\").Value, \"hh:mm\"), Duration, Range(\"C12\").Text, Range(\"D12\").Value, Range(\"J7\").Value, _\nRange(\"H7\").Value, Range(\"F7\").Value, Range(\"E12\").Value, Range(\"F12\").Value, Range(\"G12\").Value, _\nRange(\"H12\").Value, PressureDiff, Range(\"I12\").Value, Range(\"J12\").Value, Range(\"K12\").Value, Range(\"L12\").Value)\n\nNextSPGP.Resize(1, UBound(NewData) + 1).Value = NewData\nMsgBox \"Data input complete!\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6750131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100527486774353/picture?type=large", "display_name": "Clayton", "link": "https://stackoverflow.com/users/6750131/clayton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1612575113, "creation_date": 1471998132, "question_id": 39112619, "link": "https://stackoverflow.com/questions/39112619/data-input-on-excel-form-sheet-to-database-sheet", "title": "Data input on excel: form sheet to database sheet", "body": "<p>I'm using a dynamic button on one sheet to send data to a database/summary sheet within the same workbook in Excel.  </p>\n\n<p>I know I know.  Should've done this using Access and queries, but I used the trusty brute-force method in the code shown below.  </p>\n\n<p>It works, but it's painstakingly slow.  Please advise on how to perform this task with less demand on the processor.</p>\n\n<pre><code>'enter into database\nNextSPGP.Value = Range(\"B7\").Value\nNextDate.Value = Format(Range(\"M7\").Value, \"mm/dd/yyyy\")\nNextStart.Value = Format(Range(\"A12\").Value, \"hh:mm\")\nNextFinish.Value = Format(Range(\"B12\").Value, \"hh:mm\")\nNextMix = Range(\"C12\").Text\nNextBatch.Value = Range(\"D12\").Value\nNextGrouter.Value = Range(\"J7\").Value\nNextPump.Value = Range(\"H7\").Value\nNextPass.Value = Range(\"F7\").Value\nNextDepth.Value = Range(\"E12\").Value\nNextSleeve.Value = Range(\"F12\").Value\nNextInitPress.Value = Range(\"G12\").Value\nNextFinalPress.Value = Range(\"H12\").Value\nNextFlow.Value = Range(\"I12\").Value\nNextVol.Value = Range(\"J12\").Value\nNextMove.Value = Range(\"K12\").Value\nNextComment.Value = Range(\"L12\").Value  \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1471993351, "post_id": 39111907, "comment_id": 65571188, "body": "Set the breakpoint on <code>If pProposedValue Is Nothing Then</code> instead and then hover over <code>Target</code> to check its value. Or make the first line of the <code>Sub</code> something like <code>Debug.Print (Target Is Nothing)</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471994093, "post_id": 39111907, "comment_id": 65571366, "body": "Do you have any volatile functions on the sheet?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1471995956, "post_id": 39111907, "comment_id": 65571844, "body": "<code>Is</code> doesn&#39;t work for checking if one range variable refers to the same range as another range variable. <code>Target Is pNet</code> will be false even if they refer to the same range."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1471996005, "post_id": 39111907, "comment_id": 65571849, "body": "Hit F8 to execute at least the function header before checking to see if target is Nothing"}, {"owner": {"reputation": 455, "user_id": 5628396, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08f7ccebb610d0e2e1d21bededc21648?s=128&d=identicon&r=PG&f=1", "display_name": "David Bell", "link": "https://stackoverflow.com/users/5628396/david-bell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472048294, "post_id": 39111907, "comment_id": 65597231, "body": "@TimWilliams thanks for your info, I thought that is one way to test object reference equality? I thought that since Range returns a range object that I would be able to test the reference."}, {"owner": {"reputation": 455, "user_id": 5628396, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08f7ccebb610d0e2e1d21bededc21648?s=128&d=identicon&r=PG&f=1", "display_name": "David Bell", "link": "https://stackoverflow.com/users/5628396/david-bell"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1472048531, "post_id": 39111907, "comment_id": 65597410, "body": "@RobinMackenzie after fallowing your advice it seems as though Target is still Nothing according to intellesense even at the end of the sub"}, {"owner": {"reputation": 455, "user_id": 5628396, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08f7ccebb610d0e2e1d21bededc21648?s=128&d=identicon&r=PG&f=1", "display_name": "David Bell", "link": "https://stackoverflow.com/users/5628396/david-bell"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472048535, "post_id": 39111907, "comment_id": 65597411, "body": "@Comintern that is very possible but I dont think so. The only knew functions I have written sense the bug have been the two inside the picture. I had a previous version of this program working fine and the end user wanted me to add in this extra bit."}, {"owner": {"reputation": 455, "user_id": 5628396, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08f7ccebb610d0e2e1d21bededc21648?s=128&d=identicon&r=PG&f=1", "display_name": "David Bell", "link": "https://stackoverflow.com/users/5628396/david-bell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472049059, "post_id": 39111907, "comment_id": 65597792, "body": "@TimWilliams[SOLVED] I used your comment and changed the <code>Is</code> to a <code>Taget.address = pNet.address</code> and the whole thing works as expected now. strange but I cant complain! is there a way for me to mark your comment as the solution?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1472050888, "post_id": 39126745, "comment_id": 65599160, "body": "While this <a href=\"http://meta.stackexchange.com/q/66377/147640\">ultimately solves</a> the OP&#39;s problem, the question title and body are asking for a different answer, which is <a href=\"http://stackoverflow.com/questions/39111907/worksheet-changebyval-target-as-range-target-always-equals-nothing#comment65571849_39111907\">&quot;step into the procedure before hovering over <code>Target</code>&quot;</a>."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1472050489, "creation_date": 1472050489, "answer_id": 39126745, "question_id": 39111907, "link": "https://stackoverflow.com/questions/39111907/worksheet-changebyval-target-as-range-target-always-equals-nothing/39126745#39126745", "title": "Worksheet_Change(ByVal Target As Range), Target always equals Nothing", "body": "<p><code>Is</code> doesn't work for checking if one range variable refers to the same range as another range variable. </p>\n\n<p><code>Target Is pNet</code> will be false even if they refer to the same range.</p>\n"}], "owner": {"reputation": 455, "user_id": 5628396, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08f7ccebb610d0e2e1d21bededc21648?s=128&d=identicon&r=PG&f=1", "display_name": "David Bell", "link": "https://stackoverflow.com/users/5628396/david-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 39126745, "answer_count": 1, "score": 0, "last_activity_date": 1472050489, "creation_date": 1471992697, "last_edit_date": 1531164843, "question_id": 39111907, "link": "https://stackoverflow.com/questions/39111907/worksheet-changebyval-target-as-range-target-always-equals-nothing", "title": "Worksheet_Change(ByVal Target As Range), Target always equals Nothing", "body": "<p>thanks for all your help in advance!<br>\nI am using the <code>Worksheet_Change(ByVal Target As Range)</code> event <strong>NOT</strong> the <code>Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)</code> event. After some testing I realized that my event fires but the argument <code>Target</code> is always set to  <code>Nothing</code>.  Some code and a picture fallows.  </p>\n\n<pre><code>Private pNet As Range\nPrivate pProposedValue As Range\n\n'EVENT HANDLERS\n'--------------\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If pProposedValue Is Nothing Then\n\n    ElseIf pNet Is Nothing Then\n\n    ElseIf Target Is pNet Then\n        pProposedValue.Value2 = Target.Value2\n        Me.Calculate\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XCaM5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XCaM5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "validation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471995363, "post_id": 39111756, "comment_id": 65571705, "body": "I don&#39;t think you can use an array formula which returns multiple values in a conditional formatting rule and have it work the way you want.  CF is always per-cell and I don&#39;t think there&#39;s any mechanism to &quot;distribute&quot; a returned array of true/false across a specific range of cells."}, {"owner": {"reputation": 189, "user_id": 4015197, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/add64782bb41a198bc98902d64dd522b?s=128&d=identicon&r=PG&f=1", "display_name": "JavaNewbie", "link": "https://stackoverflow.com/users/4015197/javanewbie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472028235, "post_id": 39111756, "comment_id": 65583129, "body": "I try to rephrase my first question. If Excel you can type &#39;=AND(EXACT(A1:A10, B1))&#39; and press ctrl-shift-enter, which will cause the formula to be displayed as &#39;{=AND(EXACT(A1:A10,B1))}&#39; and work vectorially, i.e. EXACT will take the input range and return a corresponding range (or array?) of booleans. Then the ALL function will collapse this array and tell you if all the cells in the range are exactly identical to B1. Currently, to use my function for a range of values, I do &#39;=AllCharsValid(A1:A10,B1)&#39;. Can I do &#39;=AND(AllCharsValid(A1:A10,B1))&#39;, as for the &#39;EXACT&#39; function?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1472050745, "post_id": 39111756, "comment_id": 65599029, "body": "Yes you would return an array of booleans from your function, one element for each cell.  It&#39;s not clear why you&#39;d want to do that though, since it would mean every cell would have to be tested, instead of dropping out and returning False on the first instance of a non-allowed character."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472063035, "post_id": 39111756, "comment_id": 65606397, "body": "<code>AND()</code> in an Excel formula doesn&#39;t short-circuit, so all arguments will be evaluated."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 1, "last_activity_date": 1471997467, "last_edit_date": 1495541697, "creation_date": 1471997467, "answer_id": 39112530, "question_id": 39111756, "link": "https://stackoverflow.com/questions/39111756/vectorial-formula-for-cell-validation-in-excel-using-vba/39112530#39112530", "title": "Vectorial formula for cell validation in Excel using VBA", "body": "<p>The following code will return a range of boolean values offset one column from the initial input range. Simply create a new tab in Excel and run <code>testAllCharsValid</code> and show the Immediate window in the IDE to see how it works.</p>\n\n<pre><code>Sub testAllCharsValid()\n\n    Dim i As Integer\n    Dim cll As Range, rng As Range\n    Dim allowedChars As String\n\n    ' insert test values in sheet: for testing purposes only\n    With ActiveSheet ' change to Thisworkbook.Sheets(\"NameOfYourSheet\")\n        Set rng = .Range(\"A1:A10\")\n        For i = 1 To 10\n            .Cells(i, 1) = Chr(i + 92)\n        Next i\n    End With\n\n    ' fill allowedChars with letters a to z: for testing purposes only\n    For i = 97 To 122\n        allowedChars = allowedChars &amp; Chr(i)\n    Next i\n\n    ' get boolean range\n    Set rng = AllCharsValid(rng, allowedChars)\n\n    ' check if the returned range contains the expected boolean values\n    i = 0\n    For Each cll In rng\n        i = i + 1\n        Debug.Print i &amp; \" boolean value: \" &amp; cll.Value\n    Next cll\n\nEnd Sub\n\n' Check that all characters in InputCells are among\n' the characters in AllowedChars\nPublic Function AllCharsValid(InputCells As Range, allowedChars As String) As Range\n\n    Dim BoolTest As Boolean\n    Dim Char As String\n    Dim Index As Integer\n    Dim RangeTestChars As Range, RangeBooleans As Range, RangeTemp As Range\n    Dim TestChars As String\n    For Each RangeTestChars In InputCells\n        BoolTest = True\n        TestChars = RangeTestChars.Value\n        For Index = 1 To Len(TestChars)\n            Char = Mid(TestChars, Index, 1)\n            If InStr(allowedChars, Char) = 0 Then BoolTest = False\n        Next Index\n\n        Set RangeTemp = RangeTestChars.Offset(0, 1) ' change offset to what suits your purpose\n        RangeTemp.Value = BoolTest\n\n        If RangeBooleans Is Nothing Then\n            Set RangeBooleans = RangeTestChars\n        Else\n            Set RangeBooleans = Union(RangeBooleans, RangeTemp)\n        End If\n\n    Next RangeTestChars\n\n    Set AllCharsValid = RangeBooleans\n\nEnd Function\n</code></pre>\n\n<p>cf 2) If the length of the test string is zero, the function will return <code>True</code> for the cell in question, which may not be desirable.</p>\n\n<p>cf 3) There is a limit to how many characters an Excel cell can contain, read more <a href=\"http://excel.tips.net/T003163_Character_Limits_for_Cells.html\" rel=\"nofollow noreferrer\">here</a>. I suppose, if you concatenated some very long strings and sent them to the function, you could reach the integer limit of +32767, which would cause a run-time error due to the integer <code>Index</code> variable. However, since the character limit of Excel cells is exactly +32767, the function should work as is without any problems.</p>\n\n<p>cf 4) None that I know of.</p>\n\n<p>cf 5) This is not the easiest thing to achieve, but there is help to be found <a href=\"https://stackoverflow.com/questions/16903587/the-quest-for-the-excel-custom-function-tooltip\">here</a>.</p>\n"}], "owner": {"reputation": 189, "user_id": 4015197, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/add64782bb41a198bc98902d64dd522b?s=128&d=identicon&r=PG&f=1", "display_name": "JavaNewbie", "link": "https://stackoverflow.com/users/4015197/javanewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1471997467, "creation_date": 1471991885, "question_id": 39111756, "link": "https://stackoverflow.com/questions/39111756/vectorial-formula-for-cell-validation-in-excel-using-vba", "title": "Vectorial formula for cell validation in Excel using VBA", "body": "<p>I am writing a VBA formula to check that all characters in a cell \"TestChars\" are allowed, where allowed means that each character appears in a list defined by another cell \"AllowedChars\". To make things even harder, I would like this formula to work on ranges of cells rather than on a single cell.</p>\n\n<p>The current code seems to work:</p>\n\n<pre><code>Option Explicit\n\n\nPublic Function AllCharsValid(InputCells As Range, AllowedChars As String) As Boolean\n' Check that all characters in InputCells are among\n' the characters in AllowedChars\n\n    Dim Char As String\n    Dim Index As Integer\n    Dim RangeTestChars As Range\n    Dim TestChars As String\n    For Each RangeTestChars In InputCells\n        TestChars = RangeTestChars.Value\n        For Index = 1 To Len(TestChars)\n            Char = Mid(TestChars, Index, 1)\n            If InStr(AllowedChars, Char) = 0 Then\n                AllCharsValid = False\n                Exit Function\n            End If\n        Next Index\n    Next RangeTestChars\n    AllCharsValid = True\nEnd Function\n</code></pre>\n\n<p>I have the following questions:</p>\n\n<ol>\n<li>The formula takes a range and returns a single boolean. I would prefer a vectorized function, where, given an input range, you get a corresponding range of booleans. It seems like built-in formulas like 'EXACT' can do this (those formulas where you have to press ctrl-shift-enter to execute them and where you get curly-brackets). Is there a way to do that with user-defined functions?</li>\n<li>I am not new to programming, however I am completely new to VBA (I started literally today). Is there any obvious problem, weirdness with the above code?</li>\n<li>Are there special characters, extremely long texts or particular input values that would cause the formula to fail?</li>\n<li>Is there an easier way to achieve the same effect? Is the code slow?</li>\n<li>when you start typing built-in formulas in excel you get suggestions and auto-completion. This doesn't seem to work with my formula, am I asking for too much or is it possible to achieve this?</li>\n</ol>\n\n<p>I realize that this question contains several weakly related sub-questions, so I would be very happy also with sub-answers. </p>\n"}, {"tags": ["vba", "excel", "validation", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471994074, "post_id": 39112071, "comment_id": 65571357, "body": "that&#39;s fine (not the best way) but you can pass string too and its acceptable. Error 1004 is due the missing delete statement."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471994959, "post_id": 39112071, "comment_id": 65571596, "body": "@cyboashu I have not done any speed tests, but you can avoid the string construction coding by just passing the address to the argument."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471995099, "post_id": 39112071, "comment_id": 65571623, "body": "@cyboashu  Oh, and I agree with you about the significance of the missing <code>delete</code>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471995115, "post_id": 39112071, "comment_id": 65571626, "body": "Yes, totally agreed. but the actual issue here is deleting the existing validation before adding one, unless I am missing something :)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1471995442, "post_id": 39112071, "comment_id": 65571722, "body": "@cyboashu I agree, but he also wrote about an issue when trying to use a string reference to the range object.  He did not show what he used, and I responded to that part.  I will clarify my answer."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1471998730, "post_id": 39112071, "comment_id": 65572505, "body": "I fixed the delete part and I simplified the code to have <code>Formula1:=&quot;=PT_Puldown&quot;</code> and it seems to be working fine, so I don&#39;t think that was part of the problem.  Also, I would have needed to add a worksheet reference for it to work as the range is on another sheet."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1472000690, "post_id": 39112071, "comment_id": 65572964, "body": "@nateAtwork Glad you got it working.  Note that if your <code>Defined Name</code> is <code>Workbook</code> in <code>Scope</code>  (and this is usually the default, with the sheet name being included as part of the defined name), then there would be no need, within your Macro, to add a worksheet reference."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1472084651, "post_id": 39112071, "comment_id": 65615035, "body": "@RonRosenfeld I&#39;m not sure what you mean by a <code>Defined Name</code> being <code>Workbook</code> in <code>Scope</code>.  I typically add names using the box to the left of the formula bar on the worksheet, and when I use the <code>Range.Address</code> property I just get the cell&#39;s address without the worksheet.  Unless there is another way to define names that I&#39;m not aware of, I think you would need to use the worksheet property as well."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1472085402, "post_id": 39112071, "comment_id": 65615198, "body": "@nateAtwork When you define a name, look closely in the dialog box. You should be able to define it as being either of Workbook or Worksheet in scope.  If it is Workbook, you can access it from any worksheet.  If it is Worksheet, you will only only access it from the particular sheet. If it is Workbook scope, you will be able to access the range name no matter the activesheet.  If it is worksheet, then you can only access it from the worksheet on which it was defined.  In VBA, with a workbook scope name, you can return the worksheet name with <code>Range(&quot;MyRange&quot;).Worksheet.Name</code>"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1471995343, "last_edit_date": 1471995343, "creation_date": 1471993891, "answer_id": 39112071, "question_id": 39111677, "link": "https://stackoverflow.com/questions/39111677/data-validation-list-error/39112071#39112071", "title": "Data Validation List Error", "body": "<p>As pointed out by @cyboashu, your error is coming from the fact that you did not delete the validation before adding a new one.</p>\n\n<p>With regard to your other issue of trying to pass the range to Formula1 directly:</p>\n\n<p>Formula1 should refer to the range as a string.\neg:</p>\n\n<pre><code>Formula1:=\"=$G$2:$G$7\"\n</code></pre>\n\n<p>or, using your variables:</p>\n\n<pre><code>Formula1:=\"=\" &amp; ThisWorkbook.Names(\"PT_Puldown\").RefersToRange.Address\n</code></pre>\n\n<p>or, simpler:</p>\n\n<pre><code>Formula1:=\"=\" &amp; Range(\"PT_Puldown\").Address\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 4, "last_activity_date": 1471994035, "creation_date": 1471994035, "answer_id": 39112086, "question_id": 39111677, "link": "https://stackoverflow.com/questions/39111677/data-validation-list-error/39112086#39112086", "title": "Data Validation List Error", "body": "<p>All your code is working (certainly could be optimized), all you need to do is delete the validation if it already exists.</p>\n\n<p>If you try to add validation to a cell which already contains one, you will get error 1004.</p>\n\n<pre><code>Sub addPT_Validation()\n    Dim sValidationList As String\n    Dim cell As Range\n\n    For Each cell In ThisWorkbook.Names(\"PT_Puldown\").RefersToRange\n        sValidationList = sValidationList &amp; cell.Value &amp; \",\"\n    Next cell\n\n    sValidationList = Left(sValidationList, Len(sValidationList) - 1)\n\n    With ActiveSheet.Range(\"D1\").Validation\n        '/Delete first., in case of any any existing validation\n        .Delete\n\n        .Add Type:=xlValidateList, _\n                AlertStyle:=xlValidAlertStop, _\n                Operator:=xlEqual, _\n                Formula1:=sValidationList\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .ShowError = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471995308, "post_id": 39112168, "comment_id": 65571685, "body": "this is still going to fail and throw error 1004, code needs to delete any existing data validation for the cell before attempting add a new one."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471995931, "post_id": 39112168, "comment_id": 65571834, "body": "@cyboashu, so let him add it! Funny that nobody cares about sheet reference in Formula1 parameter which, though not certain, seems almost a much probable issue from OP&#39;s code where a workbook scoped name is used for the list and an ActiveSheet reference for the cell bound to host it..."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471996195, "post_id": 39112168, "comment_id": 65571891, "body": "Don&#39;t take my comment otherwise. Just wanted to point out for sake of completion. Didn&#39;t intend to start any argument or criticize :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471996943, "post_id": 39112168, "comment_id": 65572067, "body": "@cyboashu, neither did I."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1471998594, "post_id": 39112168, "comment_id": 65572475, "body": "That was what I did at first.  The reason I used a somewhat odd method was that it was the last thing I tried before giving up!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1471994578, "creation_date": 1471994578, "answer_id": 39112168, "question_id": 39111677, "link": "https://stackoverflow.com/questions/39111677/data-validation-list-error/39112168#39112168", "title": "Data Validation List Error", "body": "<p>I'd use the named range reference to build up the formula to put in <code>Formula1</code> parameter of <code>Validation</code> object <code>Add()</code> method, like follows</p>\n\n<pre><code>Sub addPT_Validation()\nDim formula As String\n\nWith ThisWorkbook.Names(\"PT_Puldown\").RefersToRange\n    formula = \"'\" &amp; .Parent.Name &amp; \"'!\" &amp; .Address(External:=False) \nEnd With\n\nWith ActiveSheet.Range(\"D14\").Validation\n    .Add Type:=xlValidateList, _\n            AlertStyle:=xlValidAlertStop, _\n            Operator:=xlEqual, _\n            Formula1:=formula\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .ShowError = True\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 39112086, "answer_count": 3, "score": 0, "last_activity_date": 1478819563, "creation_date": 1471991364, "question_id": 39111677, "link": "https://stackoverflow.com/questions/39111677/data-validation-list-error", "title": "Data Validation List Error", "body": "<p>I'm trying to add a data validation pulldown list, and I've been debugging it for a while to no avail.  I'm getting a Run-time error 1004, Application-defined or object defined error.  The error occurs in Formula1 setting part of the <code>Validation.Add</code> statement.  </p>\n\n<p>I've tried using a string reference to a named range, a string reference to a standard range, and, as shown below, a comma delimited list string generated from the list on the worksheet as shown in the code below.  I have checked the list string with <code>Debug.Print</code> and got the expected result.</p>\n\n<pre><code>Sub addPT_Validation()\nDim sValidationList As String\nDim cell As Range\n\nFor Each cell In ThisWorkbook.Names(\"PT_Puldown\").RefersToRange\n    sValidationList = sValidationList &amp; cell.Value &amp; \",\"\nNext cell\n\nsValidationList = Left(sValidationList, Len(sValidationList) - 1)\n\nWith ActiveSheet.Range(\"D14\").Validation\n    .Add Type:=xlValidateList, _\n            AlertStyle:=xlValidAlertStop, _\n            Operator:=xlEqual, _\n            Formula1:=sValidationList\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .ShowError = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for any guidance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471994199, "post_id": 39111555, "comment_id": 65571396, "body": "Why can&#39;t you just call the click event directly?"}, {"owner": {"reputation": 137, "user_id": 6744806, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8ccdc6b928c20e4137c0611662573291?s=128&d=identicon&r=PG&f=1", "display_name": "prateek k", "link": "https://stackoverflow.com/users/6744806/prateek-k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472028217, "post_id": 39111555, "comment_id": 65583114, "body": "i want to automate the process"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1471997529, "creation_date": 1471997529, "answer_id": 39112536, "question_id": 39111555, "link": "https://stackoverflow.com/questions/39111555/calling-an-activex-control-button-from-a-macro/39112536#39112536", "title": "Calling an ActiveX control Button from a macro", "body": "<p>In order to run the macro attached to an ActiveX control you can directly call the sub with the following command:</p>\n\n<pre><code>CallByName Worksheets(\"Sheet1\"), \"CommandButton21_Click\", VbMethod\n</code></pre>\n\n<p>Note, that (by default) Excel will create a <code>Private Sub</code> on the worksheet for the button. If you wish to call these subs from a module then you will have to remove the <code>Private</code> up-front. Also note, that the sub's name <strong>must</strong> be <code>NameOfTheButton_Click</code>.</p>\n\n<p>So, if the above code resides in a sub in a module and you want to make it work then the the code on the sheet could be (for example):</p>\n\n<pre><code>Sub CommandButton21_Click()\n\nMsgBox \"gotcha\"\n\nEnd Sub\n</code></pre>\n\n<p>If you wish to invoke all macros for all buttons on <code>Sheet1</code> then the following code will do:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub tmpSO()\n\nDim Obj As OLEObject\n\nFor Each Obj In Worksheets(\"Sheet1\").OLEObjects\n    If TypeName(Obj.Object) = \"CommandButton\" Then\n        CallByName Worksheets(\"Sheet1\"), Obj.Name &amp; \"_Click\", VbMethod\n    End If\nNext Obj\n\nEnd Sub\n</code></pre>\n\n<p>Once again, make sure that none of the subs on <code>Sheet1</code> are <code>Private</code>. Otherwise, these subs cannot be called from a module but merely from a sub which resides on <code>Sheet1</code> as well.</p>\n"}], "owner": {"reputation": 137, "user_id": 6744806, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8ccdc6b928c20e4137c0611662573291?s=128&d=identicon&r=PG&f=1", "display_name": "prateek k", "link": "https://stackoverflow.com/users/6744806/prateek-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1743, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1472007453, "creation_date": 1471990702, "last_edit_date": 1531164843, "question_id": 39111555, "link": "https://stackoverflow.com/questions/39111555/calling-an-activex-control-button-from-a-macro", "title": "Calling an ActiveX control Button from a macro", "body": "<p>I have written a VBA-Excel code which is excecuted by press of a ActiveX control button placed on the worksheet.</p>\n\n<p>I don't want to always press it for it to run and want to control its invocation based on one more macro (separate).</p>\n\n<p>Is it possible and if yes, share insights regarding it.</p>\n\n<p>This is how my worksheet looks like and i want to invoke that button from a separate macro:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JgfTU.png\" alt=\"This is how my worksheet looks like and i want to invoke that button from a separate macro\"></p>\n"}, {"tags": ["javascript", "html", "vba", "dom", "browser-automation"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1471990529, "post_id": 39111278, "comment_id": 65570390, "body": "If the value of a page element is changing based on a click event, I&#39;d bet that all the javascript events aren&#39;t null. The IE object might not be showing some events for some reason, but digging into that javascript is definitely going to be key to understanding what&#39;s going on. Investigate the scripts/events on the page yourself with e.g. the dev console of your favorite browser. I also highly suggest adding the javascript and/or dom tags to get some experts in here."}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1471991374, "post_id": 39111278, "comment_id": 65570670, "body": "Oh ok, thanks. I tired using Chrome Dev but I&#39;m having a hard time understanding what I&#39;m looking at... If I click on the Networks tab, in the Initiator column I see a script, then when I mouseover it, a whole list of different things show up. What am I supposed to do with this information?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472062374, "post_id": 39111278, "comment_id": 65606011, "body": "To set the value something like: <code>ie.Document.getElementById(&quot;GetProductQuantitiesForAccessibl&zwnj;&#8203;eBranches&quot;).getEleme&zwnj;&#8203;ntsbyName(&quot;ProductGu&zwnj;&#8203;id&quot;)(0).Value=Whatev&zwnj;&#8203;er</code> should work"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1472081703, "post_id": 39111278, "comment_id": 65614368, "body": "Changing the value is fine, it does that. Submitting is the issue. The post request simply does not go through."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472215459, "post_id": 39111278, "comment_id": 65675512, "body": "If you are trying to submit the form, try: <code>ie.Document.Forms(&quot;GetProductQuantitiesForAccessibleBranches&zwnj;&#8203;&quot;).Submit</code>"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1472221583, "post_id": 39111278, "comment_id": 65679566, "body": "Unfortunately that doesn&#39;t work either. The line runs fine, no errors, but the submit action does not go through."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472226723, "post_id": 39111278, "comment_id": 65682841, "body": "Two other thoughts, after submitting the form as shown above try firing the onSubmit event. Something like <code>ie.document.Forms(&quot;GetProductQuantitiesForAccessibleBranches&zwnj;&#8203;&quot;).fireEvent(&quot;onSubm&zwnj;&#8203;it&quot;)</code>. The other thought is creating a POST request, it looks like that might be what the form is doing when it is submitted. See this for a start <a href=\"http://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba\" title=\"how can i send an http post request to a server from excel using vba\">stackoverflow.com/questions/158633/&hellip;</a>"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472292393, "post_id": 39111278, "comment_id": 65701229, "body": "If you have a submit button on the form you can try this alternative: <code>ie.Document.getElementById(&quot;SubmitButtonID&quot;).Click</code>"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1472498071, "post_id": 39111278, "comment_id": 65765720, "body": "I already tried the <code>.Click</code> method."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1472661175, "post_id": 39111278, "comment_id": 65845244, "body": "@TheGuyOverThere find the node where the image resides. find the image within the node by tagName(&quot;img&quot;) perform a click on that image/Object -&gt; wait for ieObject to reload -&gt; this should work??"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1472683907, "post_id": 39111278, "comment_id": 65856343, "body": "Sadly it does not. That was my first approach"}, {"owner": {"reputation": 1138, "user_id": 1778005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/28fQV.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1778005/steve"}, "edited": false, "score": 1, "creation_date": 1472693889, "post_id": 39111278, "comment_id": 65858693, "body": "Could it be as simple as using submit() instead of Submit? Not 100% sure on how VBA sends javascript commands.."}], "answers": [{"comments": [{"owner": {"reputation": 6508, "user_id": 5962841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qD8gs.jpg?s=128&g=1", "display_name": "Mafii", "link": "https://stackoverflow.com/users/5962841/mafii"}, "edited": false, "score": 0, "creation_date": 1472719160, "post_id": 39261308, "comment_id": 65867945, "body": "I was about to answer something similar. I once had the same problem, and then had to loop through all the buttons and check for the one with a certain label, and then click it. This seems like a great answer to me. IE-automation with vba is a pain in the ass anyways. good job!"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 6508, "user_id": 5962841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qD8gs.jpg?s=128&g=1", "display_name": "Mafii", "link": "https://stackoverflow.com/users/5962841/mafii"}, "edited": false, "score": 0, "creation_date": 1472763524, "post_id": 39261308, "comment_id": 65895886, "body": "Thanks for the feedback!"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1472769392, "post_id": 39261308, "comment_id": 65898133, "body": "Thanks for trying, I know you&#39;ve spent quite a lot of effort trying to help me figure this out, but this also does not work. Code runs fine, but webpage does not update. I am literally completely out of ideas."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472778091, "post_id": 39261308, "comment_id": 65900199, "body": "There aren&#39;t any frames?"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1473168182, "post_id": 39261308, "comment_id": 66029900, "body": "None that I can see. I am able to interact and extract information from the page without any issues. There are over 50 <code>&lt;img&gt;</code> tags on each page and each is part of a row that I already extract data from"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 3, "last_activity_date": 1516914379, "last_edit_date": 1516914379, "creation_date": 1472692585, "answer_id": 39261308, "question_id": 39111278, "link": "https://stackoverflow.com/questions/39111278/form-submit-does-not-go-through-when-using-vba/39261308#39261308", "title": "Form.Submit does not go through when using VBA", "body": "<p>Give this a shot, I doubt this is going to be the 'perfect' answer without actually seeing the site. However, this should find the correct image tag, assuming you don't have any frames/iframes (please check there aren't any), and <em>should</em> click it.</p>\n\n<pre><code>Public Sub Click_IMG_Tag()\n    Dim Elements As Object\n    Dim Element  As Object\n\n    'Get a pointer to IE etc first, I'm assuming this is already done\n\n    Set Elements = IE.Document.getElementsByTagName(\"img\")\n\n    For Each Element In Elements\n        On Error Resume Next ' used to bypass elements that don't have .Title property\n                             ' later, you should error handle this exception\n        If Element.Title = \"View Quantities At Other Locations\" Then\n            Element.Focus\n            Element.Click\n            Element.FireEvent (\"OnClick\")\n            IELoad IE\n            Exit For\n        End If\n    Next\n\nEnd Sub\n\nPublic Sub IELoad(Browser As Object)\n    While Browser.busy Or Browser.Readystate &lt;&gt; 4\n        Application.Wait (Now() + TimeValue(\"00:00:01\"))\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1516914379, "creation_date": 1471989267, "last_edit_date": 1472222030, "question_id": 39111278, "link": "https://stackoverflow.com/questions/39111278/form-submit-does-not-go-through-when-using-vba", "title": "Form.Submit does not go through when using VBA", "body": "<p>I have a webpage that I am extracting data from. I can do everything fine with VBA apart from clicking on an image element which then submits a form and a popup with data is created.</p>\n\n<p>One of the attributes in the image element is called \"productguid\" and has a string value =</p>\n\n<p>\"a12-545\". </p>\n\n<p>The HTML code of the form looks like this BEFORE I click on the image element with my mouse.</p>\n\n<pre><code>&lt;form id=\"GetProductQuantitiesForAccessibleBranches\" action=\"GetProductQuantitiesForAccessibleBranches\" method=\"post\"&gt;\n  &lt;input type=\"hidden\" name=\"ProductGuid\" value=\"\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>This is the HTML code AFTER I manually click on it with the mouse:</p>\n\n<pre><code>&lt;form id=\"GetProductQuantitiesForAccessibleBranches\" action=\"GetProductQuantitiesForAccessibleBranches\" method=\"post\"&gt;\n  &lt;input type=\"hidden\" name=\"ProductGuid\" value=\"a12-545\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Based on this I assumed that the productguid value from the image element gets passed onto the form before it is submitted.\nHere is what my VBA code looks like this:</p>\n\n<pre><code>'Change the input element value\nie.Document.getElementById(\"GetProductQuantitiesForAccessibleBranches\").all.item(0).value = \"a12-545\"\n\n'Submit the form\nie.Document.getElementyId(\"GetProductQuantitiesForAccessibleBranches\").Submit\n</code></pre>\n\n<p>According to the Locals window, all the Javascript events are <code>Null</code>. Both lines of code run without any errors but the webpage does not update. Am I missing something here?</p>\n\n<p>I have also tried just clicking the image element with the <code>.Click</code> method, but that doesn't do anything either.</p>\n\n<p>The webpage is password protected so I cannot post the URL publicly.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Here is the HTML in the  tag that normally is clicked manually which then submits the form. Perhaps there is something in here that I can use?</p>\n\n<pre><code>&lt;img alt=\"View Quantities At Other Locations\" src=\"/WebOrder/Images/CheckQtys.gif\" \ntitle=\"View Quantities At Other Locations\" class=\"popup\" \npopupdirection=\"upperleft\" popupwidth=\"380\" \npopupcontent=\"#ProductQuantitiesForAccessibleBranches\" \nonbeforepopupcreate=\"onBeforePopupCreate_GetProductQuantitiesForAccessibleBranches(this)\" \npopupajaxformid=\"GetProductQuantitiesForAccessibleBranches\" \nonbeforepopupajaxpost=\"onBeforePopupAjaxPost_GetProductQuantitiesForAccessibleBranches(this)\" \noncompletepopupajaxpost=\"onCompletePopupAjaxPost_GetProductQuantitiesForAccessibleBranches(this)\" \nproductguid=\"a12-545\" \ndisplayitem=\"33902\" \nbrandguid=\"00000000-0000-0000-0000-000000000000\" \nbrandname=\"\" brandsku=\"\"&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471989995, "post_id": 39111177, "comment_id": 65570220, "body": "use pastespecial method..."}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471990798, "post_id": 39111177, "comment_id": 65570473, "body": "Tried that  with all of the datatype options listed here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197265.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff197265.aspx</a>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471994850, "post_id": 39111177, "comment_id": 65571575, "body": "<code>CopyPicture</code>--&gt; <code>Paste on ChartArea</code> --&gt; <code>Save the image from Chart as jpg</code>--&gt; <code>Attach Inline Image in mail body</code>. No blurs, no copy fail issues."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1472020482, "creation_date": 1472020482, "answer_id": 39116002, "question_id": 39111177, "link": "https://stackoverflow.com/questions/39111177/copy-range-as-image-and-paste-into-outlook-results-small-blurry/39116002#39116002", "title": "Copy range as image and paste into Outlook (results small/blurry)", "body": "<p>Try <strong><code>rngeData.Copy</code></strong> Then <strong><code>wordDoc.Range.PasteAndFormat wdPasteEnhancedMetafile</code></strong></p>\n\n<p>This should give you good quality <code>wdPasteDataType</code>, similar to <kbd> <strong>Ctrl+V</strong> </kbd></p>\n\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff197265.aspx\" rel=\"nofollow\">WdPasteDataType Enumeration (Word)</a></em></p>\n"}], "owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1125, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472020482, "creation_date": 1471988710, "last_edit_date": 1472015581, "question_id": 39111177, "link": "https://stackoverflow.com/questions/39111177/copy-range-as-image-and-paste-into-outlook-results-small-blurry", "title": "Copy range as image and paste into Outlook (results small/blurry)", "body": "<p>I'm trying to copy a range of cells as a picture, put that picture in an email, then send the email with an Excel macro. </p>\n\n<p>I'm able to do all of this, however the image comes out smaller/blurrier than the original. I've tried all sorts of copy/paste methods but the results are the same. </p>\n\n<p>When I copy the picture manually with copy as picture (as shown on screen) without a macro, then paste into outlook using just ctrl+v, the image looks fine. </p>\n\n<p>Any idea why this is happening?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub SendMail()\n\nDim aOutlook As Object\nDim aEmail As Object\nDim rngeAddresses As Range, rngeCell As Range, strRecipients As String\nDim rngeData As Range\n\nSet aOutlook = CreateObject(\"Outlook.Application\")\nSet aEmail = aOutlook.CreateItem(0)\nSet rngeData = Worksheets(\"Promo Sync\").Range(\"A5:Y86\")\n\n'Copy Range\nrngeData.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n\nDim wordDoc As Word.Document\nSet wordDoc = aEmail.GetInspector.WordEditor\n\n'Paste picture\naEmail.Display\nwordDoc.Range.Paste\n\nSet rngeAddresses = ActiveSheet.Range(\"AK2:AK23\")\n\nFor Each rngeCell In rngeAddresses.Cells\nstrRecipients = strRecipients &amp; \";\" &amp; rngeCell.Value\nNext\n\n'Set Subject\naEmail.Subject = \"Promo Sync \" &amp; Now()\n'Set Recipient\naEmail.To = strRecipients\n'Send Mail\naEmail.Send\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471988210, "post_id": 39110974, "comment_id": 65569583, "body": "<code>On Error GoTo 0</code> is masking your error."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1471988634, "post_id": 39110974, "comment_id": 65569744, "body": "<code>.Range(&quot;F4&quot;, &quot;M40&quot;, &quot;M45&quot;, &quot;M73&quot;)</code> is incorrect syntax. For a disjoint range you should use something like <code>.Range(&quot;F4,M40,M45,M73&quot;)</code> or <code>Union(.Range(&quot;F4&quot;), Union(.Range(&quot;M40&quot;), Union(.Range(&quot;M45&quot;), .Range(&quot;M73&quot;))))</code> (though obviously the former is better because it&#39;s clearer and simpler)."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471988883, "post_id": 39110974, "comment_id": 65569829, "body": "@Kyle that&#39;s not how error handling works in VBA. <code>On Error GoTo 0</code> resets the error handler to the default state, which is to pass it up the stack (and if unhandled at the top, to show an infuriating little popup). I think you&#39;re thinking of <code>On Error Resume Next</code>, which hides all errors and forces manual checking/resetting of the <code>Err</code> object."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1471989328, "post_id": 39110974, "comment_id": 65570000, "body": "Though obviously <i>something</i> is hiding the error. I&#39;m guessing that some error handler in the calling procedure is swallowing the error. @JS3 be aware that a call to <code>On Error ...</code> is localized within the procedure. If a sub sets <code>On Error Resume Next</code> then calls your <code>Copypaste</code> sub, your <code>On Error GoTo 0</code> isn&#39;t going to unset this error handler. The error will still bubble up to the calling sub, which will still resume next and completely ignore your error."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6749741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da7d7ddceafc9f4b154f60990bb8086?s=128&d=identicon&r=PG&f=1", "display_name": "JS3", "link": "https://stackoverflow.com/users/6749741/js3"}, "edited": false, "score": 0, "creation_date": 1472021983, "post_id": 39111733, "comment_id": 65579295, "body": "Hi, thanks very much for your help. This way, I can also copy to a disjoint range, by using the Areas property also on the rngTo! The only thing I now would like to add is copying into the next row down, i.e. not always row 5 but first row 5, then row 6, etc. Any idea how I can make rngTo dynamic in this way?"}, {"owner": {"reputation": 3, "user_id": 6749741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da7d7ddceafc9f4b154f60990bb8086?s=128&d=identicon&r=PG&f=1", "display_name": "JS3", "link": "https://stackoverflow.com/users/6749741/js3"}, "edited": false, "score": 0, "creation_date": 1472022583, "post_id": 39111733, "comment_id": 65579632, "body": "I figured it out myself by appending .Offset(k) to the rngto with k = 0 at the start and then incremented within the if loop."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1471991733, "creation_date": 1471991733, "answer_id": 39111733, "question_id": 39110974, "link": "https://stackoverflow.com/questions/39110974/excel-vba-paste-special-disjoint-range-from-one-workbook-to-another/39111733#39111733", "title": "Excel VBA paste special disjoint range from one workbook to another", "body": "<p>I don't think that you can copy disjointed ranges that are not in the same row or column. Try copying the range <code>F4,M40,M45,M73</code> in Excel to see if you get an error. My guess is that it will work for <code>M40,M45,M73</code> but not for <code>F4,M40</code></p>\n\n<p>If you are copying just those 4 cells than you can do something like </p>\n\n<pre><code>Set rngFrom = ActiveWorkbook.Worksheets(\"Copy worksheet\").Range(\"F4,M40,M45,M73\")\nSet rngTo = ActiveWorkbook.Worksheets(\"Sheet name\").Range(\"B5:B8\")\n\nFor i = 1 To 4\n    rngTo(i).Value = rngFrom.Areas(i).Value ' rngTo(i) is short for rngTo.Cells(i, 1)\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6749741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da7d7ddceafc9f4b154f60990bb8086?s=128&d=identicon&r=PG&f=1", "display_name": "JS3", "link": "https://stackoverflow.com/users/6749741/js3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 39111733, "answer_count": 1, "score": 0, "last_activity_date": 1471991733, "creation_date": 1471987755, "question_id": 39110974, "link": "https://stackoverflow.com/questions/39110974/excel-vba-paste-special-disjoint-range-from-one-workbook-to-another", "title": "Excel VBA paste special disjoint range from one workbook to another", "body": "<p>this is my first post to stack overflow which has already helped me <strong>so</strong> much - hopefully this time too. I am absolutely stuck on a simple copy paste macro. I am trying to loop through all xlsx files in a specific folder, open them one after the other and always copy the same 4 cell contents. These 4 values should be pasted to the original workbook from which the macro is running but transposed.</p>\n\n<p>From what I understood, I need to use the .copy .pastespecial commands because I want to transpose and can thus not work with ranges. I also understood that the pasting needs to happen before the workbook is closed because otherwise the clipboard will be emptied upon closing of the file.</p>\n\n<p>The macro correctly loops through all the files (open and closing them at the appropriate time) and also evaluates the if statement correctly. However, the .Copy does not actually seem to copy anything to the Clipboard, hence, nothing is pasted either. However, I also do not have any error messages pop up with the code below.</p>\n\n<pre><code>Sub Copypaste()\n\nDim i As Integer\nDim path As String\nDim fname As String\nDim ws1 As Worksheet: Set ws1 = ActiveWorkbook.Worksheets(\"Sheet name\")\n\n'Define path of active excel workbook \npath = ActiveWorkbook.path\n'Get list of all templates (xlsx)\ntemplates = GetFiles(path &amp; \"\\Output\", \"*.xlsx\")\n'Loop through all templates\nOn Error GoTo 0\nFor i = LBound(templates) To UBound(templates)\n'First filename from list of all files in Output folder taken and opened\nfname = CStr(templates(i))\nWorkbooks.Open Filename:=path &amp; \"\\Output\\\" &amp; fname\nIf ActiveWorkbook.Worksheets(\"Copy worksheet\").Range(\"M40\") &lt;&gt; 0 Or _  \nActiveWorkbook.Worksheets(\"Copy worksheet\").Range(\"M45\") &lt;&gt; 0 Or _ \nActiveWorkbook.Worksheets(\"Copy worksheet\").Range(\"M73\") &lt;&gt; 0 Then\n\nActiveWorkbook.Worksheets(\"Copy worksheet\").Range(\"F4\", \"M40\", \"M45\", \"M73\").Copy\nws1.Range(\"B5\").PasteSpecial Paste:=xlPasteValues, Transpose:=True\nEnd If\nWorkbooks(fname).Activate\nActiveWorkbook.Close savechanges:=False\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>From what I read so far, I can only paste the values as a continuous range, can I? In an ideal case, I would paste the first 3 cell values into 3 adjacent cells and then the last value (from \"M73\") to another cell.</p>\n\n<p>If I get this to work, I would like to expand the code such that new values which are pasted into the file do not overwrite previous values, i.e. not all pasting occurs in B5 but in the next empty row. No idea yet how to do that but that's the next problem I guess, once I get this problem sorted out with your help.</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["excel", "vba", "ms-access-2010", "export-to-excel"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471990536, "post_id": 39110929, "comment_id": 65570395, "body": "Are you sure table name is correct?..."}, {"owner": {"reputation": 109, "user_id": 4530526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kwtZsA0ZeEo/AAAAAAAAAAI/AAAAAAAAABI/e7pith4dX9s/photo.jpg?sz=128", "display_name": "Paul Courtney", "link": "https://stackoverflow.com/users/4530526/paul-courtney"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471990919, "post_id": 39110929, "comment_id": 65570518, "body": "Yes, the table name is correct - it&#39;s the same table name I use when I export to &quot;xls&quot; with a successful opening with Excel."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472007606, "post_id": 39110929, "comment_id": 65574470, "body": "Try exporting table to spreadsheet on a local CPU disk and not network."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1472042938, "post_id": 39110929, "comment_id": 65593037, "body": "If you want to create an XLSX format workbook, use  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196017.aspx\" rel=\"nofollow noreferrer\">acSpreadsheetTypeExcel12Xml</a> instead of acSpreadsheetTypeExcel12."}, {"owner": {"reputation": 109, "user_id": 4530526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kwtZsA0ZeEo/AAAAAAAAAAI/AAAAAAAAABI/e7pith4dX9s/photo.jpg?sz=128", "display_name": "Paul Courtney", "link": "https://stackoverflow.com/users/4530526/paul-courtney"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472043922, "post_id": 39110929, "comment_id": 65593806, "body": "@Parfait I had tried this but forgot to list it as one of my attempted solutions. Thanks for the reminder. @HansUp, I did mention trying out <code>acSpreadsheetTypeExcel12Xml</code> in my note, but that did not fix anything."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1472046281, "post_id": 39110929, "comment_id": 65595606, "body": "It <i>is</i> the correct version constant, though. Try that again on a local disk."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1472046827, "post_id": 39110929, "comment_id": 65596067, "body": "@PaulCourtney After I do this in Access 2010 -&gt; <code>exportFileName = &quot;C:\\Users\\hans\\Documents\\filename_.xlsx&quot;</code>, then <code>DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12, &quot;tblFoo&quot;, exportFileName, True</code> and attempt to open the workbook file, I get the same Excel error message you reported.  But after deleting the file, and re-running the <code>TransferSpreadsheet</code> with <code>acSpreadsheetTypeExcel12Xml</code> in place of <code>acSpreadsheetTypeExcel12</code>, the workbook file can be opened successfully in Excel.  I can&#39;t understand why it doesn&#39;t work for you."}, {"owner": {"reputation": 109, "user_id": 4530526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kwtZsA0ZeEo/AAAAAAAAAAI/AAAAAAAAABI/e7pith4dX9s/photo.jpg?sz=128", "display_name": "Paul Courtney", "link": "https://stackoverflow.com/users/4530526/paul-courtney"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1472052770, "post_id": 39110929, "comment_id": 65600513, "body": "@HansUp Well I did not delete the previous file when trying to use the method you mentioned. I assumed that the file would be overwritten. Apparently this is not really the case; I did as you mentioned and I deleted the previous <code>xlsx</code> file then re-ran the code using <code>acSpreadsheetTypeExcel12Xml</code> and the file opened without error. So thank you! Please post your comment as an answer and I&#39;ll mark this question &quot;Answered&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11998003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ddbe947d9d471c6000f6504bf973069?s=128&d=identicon&r=PG&f=1", "display_name": "SIIS", "link": "https://stackoverflow.com/users/11998003/siis"}, "is_accepted": false, "score": 1, "last_activity_date": 1567155788, "last_edit_date": 1567155788, "creation_date": 1567148485, "answer_id": 57721991, "question_id": 39110929, "link": "https://stackoverflow.com/questions/39110929/unable-to-open-xlsx-file-exported-from-access-2010-using-docmd-transferspreadsh/57721991#57721991", "title": "Unable to open .xlsx file exported from Access 2010 using DoCmd.TransferSpreadsheet", "body": "<p>I recently found another method that you can use to <strong>export the excel file</strong>.</p>\n\n<pre><code>DoCmd.OutputTo acOutputQuery, \"YourTableName\", acFormatXLSX, exportFileName\n</code></pre>\n\n<p>This should work as expected</p>\n"}], "owner": {"reputation": 109, "user_id": 4530526, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kwtZsA0ZeEo/AAAAAAAAAAI/AAAAAAAAABI/e7pith4dX9s/photo.jpg?sz=128", "display_name": "Paul Courtney", "link": "https://stackoverflow.com/users/4530526/paul-courtney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2466, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567155788, "creation_date": 1471987503, "last_edit_date": 1472043861, "question_id": 39110929, "link": "https://stackoverflow.com/questions/39110929/unable-to-open-xlsx-file-exported-from-access-2010-using-docmd-transferspreadsh", "title": "Unable to open .xlsx file exported from Access 2010 using DoCmd.TransferSpreadsheet", "body": "<p>I'm having problems VBA code that exports a table from MS Access 2010 to an Excel 2010 format using the <code>DoCmd.TransferSpreadsheet</code> command. The code runs without error in Access and the file is created. However, when I try to open the file in Excel 2010 I receive the following error message:\n    Excel cannot open the file 'XXXXX.xlsx' because the file format or file \n    extension is not valid. Verify that the file has not been corrupted and \n    that the file extension matches the format of the file.\nHere is the code I use to setup for and then execute the export:</p>\n\n<pre><code>exportFileName = \"\\\\network1\\share$\\filename_\" &amp; \".xlsx\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12, \"tablename\", exportFileName, True\n</code></pre>\n\n<p>I looked at a number of possible solutions before posting, so I have tried </p>\n\n<ul>\n<li>replacing <code>acSpreadsheetTypeExcel12</code> with <code>acSpreadsheetTypeExcel12Xml</code></li>\n<li>replacing <code>acSpreadsheetTypeExcel12</code> with the integer <code>10</code> or <code>9</code></li>\n<li>ensuring that I had full access/permissions to the directory where I was saving the file</li>\n<li>opening the file from the <code>File -&gt; Open</code> dialog rather than double-clicking the file </li>\n<li>saving the file to a local location, i.e. \"C:\\Users\\paul\\Documents\\\"</li>\n</ul>\n\n<p>None of these solved the problem.</p>\n\n<p>The one solution I found was as follows:</p>\n\n<pre><code>exportFileName = \"\\\\network1\\share$\\filename_\" &amp; \".xls\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"tablename\", exportFileName, True\n</code></pre>\n\n<p>where the extension is <code>.xls</code> and the spreadsheet type is <code>acSpreadsheetTypeExcel8</code>. I can work with this for now, but I would appreciate any other possible suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1471986881, "post_id": 39110683, "comment_id": 65568982, "body": "&quot;...is not working&quot; - how so? Does it give you an error (if so, what error and where?), does it run, just not accomplish what you&#39;re expecting, etc.?  Also, another idea is to load all the worksheet names into an array, then just loop through that array, instead of changing the actual sheet every time?"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471986945, "post_id": 39110683, "comment_id": 65569008, "body": "Hey Bruce! no, when i click run, no errors, just click and nothing happens, nothing changes"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471987026, "post_id": 39110683, "comment_id": 65569053, "body": "i should add, this is my first foray into VBA so i maybe doing something wrong. the code above is something i pulled off of another question. Logically, to me it seems to make sense, but when i replace sheet names and cell ranges with mine, it does not run, it seems."}, {"owner": {"reputation": 511, "user_id": 3359706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1260199006/picture?type=large", "display_name": "user3359706", "link": "https://stackoverflow.com/users/3359706/user3359706"}, "edited": false, "score": 0, "creation_date": 1471987484, "post_id": 39110683, "comment_id": 65569252, "body": "Try Worksheets(wkSht.Name).Range(&quot;F1&quot;) = Cell.Offset(0, 1)"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "reply_to_user": {"reputation": 511, "user_id": 3359706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1260199006/picture?type=large", "display_name": "user3359706", "link": "https://stackoverflow.com/users/3359706/user3359706"}, "edited": false, "score": 0, "creation_date": 1471991359, "post_id": 39110683, "comment_id": 65570662, "body": "@user3359706 thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1471987315, "post_id": 39110835, "comment_id": 65569181, "body": "Hey, thanks for this! i really appreciate it however it still does not return anything in the F2 cell of each sheet. let me clarify a little: Range A1:A6 on &quot;Notes&quot; sheet are the sheet names, excluding the &quot;notes&quot; sheet, B1:B6 is the range with the data to be entered in cell F2 in each sheet excluding the &quot;Notes.&quot; i apologize, Excel did not save my code on exit, so i had to copy/paste the code above from another thread that i got it from without replacing the red parts with my own."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1471988953, "post_id": 39110835, "comment_id": 65569858, "body": "this is just a test workbook to get a macro that works because in reality, i will need to use it on a workbook that has 700+ sheets to match to a column and return specific data for that sheet from the second column on the &quot;Notes&quot; sheet"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1471990668, "post_id": 39110835, "comment_id": 65570427, "body": "<code>Sub example() Dim wkSht   As Worksheet Dim cel As Range  For Each wkSht In ActiveWorkbook.Worksheets     For Each cel In Sheets(&quot;Notes&quot;).Range(&quot;A1:A6&quot;)         If cel.Value = wkSht.Name Then             wkSht.Range(&quot;F2&quot;).Copy Destination:=cel.Offset(0, 1)         End If     Next cel Next wkSht  End Sub</code>   is currently what i have, still no luck (replaced with ranges and sheet names from my own WB)"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472052406, "post_id": 39110835, "comment_id": 65600287, "body": "Hey Bruce! this one also gives the run time error 9. also, the code doesn&#39;t specify which cell to paste the data to on each subsequent sheet? in the error, it highlights this string &quot;Worksheets(curShtName).Cells(2, 6).Value = Worksheets(&quot;Notes&quot;).Cells(i, 2).Value&quot; when i hover over the &quot;Worksheets(curShtName)&quot; it says worksheets(curShtName) = &quot;GPU manufacturing&quot; so its doing something"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472052603, "post_id": 39110835, "comment_id": 65600407, "body": "@WilliamCrawford - you&#39;re <b><i>positive</i></b> the Workbook has worksheets for each cell in that &quot;workbook name range&quot; A1:A6?  You do have a sheet called &quot;GPU manufacturing&quot;, correct?"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472053876, "post_id": 39110835, "comment_id": 65601212, "body": "yes, that is correct. Could you kindly let me know if you set up a blank workbook like mine? So what i have is: 1st sheet titled &quot;Notes&quot; 2nd sheet titled &quot;GPU manufacturing,&quot; 3rd sheet titled &quot;Tesla GPUs,&quot; 4th sheet titled &quot;Tegra SoC,&quot;  5th sheet titled &quot;Quadro Division,&quot; 6th sheet titled &quot;ION GPUs,&quot; and 7th sheet titled &quot;GeForce GTX.&quot; in the sheet &quot;Notes&quot; i have A1:A6 with names of other sheets in order, i.e. <b>GPU Manufacturing, Tesla GPUs</b>, etc. B1:B6 has different notes for each sheet, so this can be anything really for testing purposes. F2 on each sheet must have the notes data from B"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472055607, "post_id": 39110835, "comment_id": 65602325, "body": "@WilliamCrawford - It works for me, unless I&#39;m missing something. See the edit.  A runtime error 9 means there&#39;s something wrong with the range chosen (either the sheet doesn&#39;t exist, the range doesn&#39;t exist, a named range doesn&#39;t exist, etc.)."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472059207, "post_id": 39110835, "comment_id": 65604294, "body": "i added an edit with a link to a picture to what im seeing. Any ideas? maybe im missing something in the set up? like i said im a very new to this, like started yesterday to get into it haha"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472059451, "post_id": 39110835, "comment_id": 65604427, "body": "@WilliamCrawford - If you can get back into the macro, when it fails, and debug, type this in the Immediate Window: <code>?Worksheets(&quot;GPU Manufacturing&quot;).Name</code> and see if it returns <code>GPU Manufacturing</code>. If you get a Subroutine Error 9, then that sheet doesn&#39;t exist in the workbook.  Also, <b>are there spaces</b> after the worksheet names? It kinda looks like the worksheets are actually called <code>GPU Manufacturing [with spaces here]</code> not <code>GPU Manufacturing</code>."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 1, "creation_date": 1472059592, "post_id": 39110835, "comment_id": 65604495, "body": "OMG THE SPACES!  thank you so much!! i think it works now. ill update if something breaks"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472059642, "post_id": 39110835, "comment_id": 65604531, "body": "@WilliamCrawford - Ahahahahaaha - that&#39;s your fix. Just remove the spaces from the worksheet names.  If you need those spaces, and know how many they are, then just add that to the end of the variable.  But I recommend removing them from the sheet name."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472059897, "post_id": 39110835, "comment_id": 65604680, "body": "@WilliamCrawford - I added a small bit of code to the second macro, that will go through all your worksheets and <code>Trim</code> the name (remove leading and trailing spaces). You can pull that out and make it its own Sub if you want to keep the spaces."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472061306, "post_id": 39110835, "comment_id": 65605438, "body": "Neato! ill definitely keep this in case there are spaces in the actual worksheet that i need to work in. Again, thank you so much!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472062435, "post_id": 39110835, "comment_id": 65606049, "body": "@WilliamCrawford - You&#39;re welcome, glad we figured it out!"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472177676, "post_id": 39110835, "comment_id": 65658278, "body": "you have been so much more than helpful, i really appreciate it! this code works flawlessly in my test sheet that is really clean, however the workbook that i need to work in is really messy, so i was wondering what kind of tweaks to this code can i make in order for it not to rely on sheet names and simply copy/paste stuff consecutively onto next sheet&#39;s specified cell from a range on the notes sheet. if you cant help, its OK ill try and keep tweaking this code here. again, huge help!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472178684, "post_id": 39110835, "comment_id": 65658518, "body": "@WilliamCrawford - what&#39;s the messy part, the names of sheets? There are a few other ways to tackle this probably. If you don&#39;t want to rely on sheet names, how do you know what info to put in F2 of each sheet? If you could explain a little more I don&#39;t mind taking a shot."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472179197, "post_id": 39110835, "comment_id": 65658625, "body": "ave been modifying your code but its not working.  oh god, im such a noob. basically, do the same thing you did (the part about taking the value from B1 in the notes sheet and putting it into a F2, BUT ON THE NEXT sheet after Notes and so on with B2, B3 all the way to B675, regardless of what its name is. so, consecutively). and yeah, data source from which excel sheet is DL from cuts off the sheet names so they dont match the col. A in the notes sheet."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472182220, "post_id": 39110835, "comment_id": 65659254, "body": "just like use Next function or something to automatically move to the next sheet and paste the very next value in the range from the notes sheet into F2. if that makes sense :P"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472220201, "post_id": 39110835, "comment_id": 65678667, "body": "@WilliamCrawford - See my edit, the code at the end. This is starting to creep away from your original question. Take a look at what the new code does, and see if it works. If you need to tweak it, look up like &quot;VBA loop through worksheets&quot;, or such.  Play around and if you have more questions, it may be worth creating a new Q here."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472222692, "post_id": 39110835, "comment_id": 65680334, "body": "thank you! yeah, i thought i might need a loop for that many worksheets. many thanks, ill try and see if it works"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472223614, "post_id": 39110835, "comment_id": 65680959, "body": "it totally works!!!!! thank you man! i wish there was like an equivalent of reddit gold on here so i can give it to you! one small question: what exactly does <code>myFacts</code> do?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472223826, "post_id": 39110835, "comment_id": 65681107, "body": "@WilliamCrawford - Haha, no worries! Glad to help out.  <code>myFacts</code> is an array. There are many ways I could&#39;ve tackled your question (an alternative would be to loop through your &quot;info&quot; range, one by one. I figured an Array would just work quicker).  Check out <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s site</a> for more info. (PS That website is a great resource for learning VBA. It&#39;s a lot of text, but it is well written and easy to follow).  This just dumps <i>all</i> of your &quot;facts&quot; into an array.  So <code>myFacts(1,1)</code> is the first &quot;fact&quot;, <code>myFacts(2,1)</code> is the second fact, etc"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472224308, "post_id": 39110835, "comment_id": 65681421, "body": "ah, ok that makes sense. ill definetely read through Chip&#39;s website. I&#39;m sure ill need more VBA help in the future, so ill use that instead of coming here all the time haha. again, thanks a ton, you are a life saver, sir!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1472220145, "last_edit_date": 1472220145, "creation_date": 1471987097, "answer_id": 39110835, "question_id": 39110683, "link": "https://stackoverflow.com/questions/39110683/how-to-match-sheet-tab-names-to-a-range-in-a-separate-sheet-and-return-specifi/39110835#39110835", "title": "How to match Sheet (tab) names to a range in a separate sheet and return specific text to each sheet", "body": "<pre><code>Sub example()\nDim wkSht   As Worksheet\nDim cel As Range\n\nFor Each wkSht In ActiveWorkbook.Worksheets\n    For Each cel In Sheets(\"Reporting\").Range(\"B2:B200\")\n        If cel.Value = wkSht.Name Then\n            wkSht.Range(\"D15\").Copy Destination:=cel.Offset(0, 1)\n        End If\n    Next cel\nNext wkSht\n\nEnd Sub\n</code></pre>\n\n<p>Mainly, I added <code>Acitveworkbook.Worksheets</code> instead of just <code>Sheets</code>. This should make sure the active book is the one being run on.  Also, make sure you have a sheet called \"Reporting\". If this doesn't work, let me know how so.</p>\n\n<p>Also realize, it's going to loop through 200 cells, on <em>each</em> worksheet. Is that the most efficient way to do this? Are you doing that big loop because the value is somewhere in that range? Or you actually need to check each one? (I'm thinking a <code>find</code> might be better)</p>\n\n<p>Edit: How's this one, I switched it after your comments:</p>\n\n<pre><code>Sub example2()\nDim wkSht   As Worksheet\nDim cel     As Range\nDim curShtName As String\n\nFor Each sht In ActiveWorkbook.Worksheets\n    sht.Name = Trim(sht.Name)\nNext sht\n\nFor i = 1 To 6               ' Since we go from A1/B1 to A6/B6\n    curShtName = Worksheets(\"Notes\").Cells(i, 1).Value\n    If curShtName &lt;&gt; \"Notes\" Then\n        Worksheets(curShtName).Cells(2, 6).Value = Worksheets(\"Notes\").Cells(i, 2).Value\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Edit: just realized this is basically what user3598756 did :P</p>\n\n<p>Edit 3: Okay, first, make <em>positive</em> that the second code bit I added above is in a workbook module in the workbook with your sheets.  This should work for you, it did for me:\n<a href=\"https://i.stack.imgur.com/ueVfL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ueVfL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then after running it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M37TK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M37TK.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/29Fe7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/29Fe7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>etc, etc.</p>\n\n<p>Per your most recent comments: </p>\n\n<pre><code>Sub copyInfo()\nDim lastRow As Long\nDim notesWS As Worksheet\n\nSet notesWS = ActiveWorkbook.Worksheets(\"Notes\") ' This is the worksheet with the info. you want to copy over to other sheets\nlastRow = notesWS.Cells(notesWS.Rows.Count, 2).End(xlUp).Row ' Assuming your Col. B has the most info\n\nDim myFacts() As Variant\nmyFacts = notesWS.Range(notesWS.Cells(1, 2), notesWS.Cells(lastRow, 2))\n\nDim i As Long\ni = 1\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Notes\" Then\n        ws.Cells(2, 6).Value = myFacts(i, 1) 'This loops through our Array that we created above.\n        i = i + 1\n    End If\nNext ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 1, "creation_date": 1471994355, "post_id": 39111958, "comment_id": 65571435, "body": "hi there, thank you for trying to help me. When i put your code in, i get a &quot;Runtime 9&quot; error and debugging it highlights the following line  <code>Worksheets(cell.Value).Range(&quot;F2&quot;) = cell.Offset(, 1)</code>  because F2 on all other sheets is where i need the value to go. Any ideas on the error? should i keep the 0 in the offset parenthesis?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 1, "creation_date": 1471994927, "post_id": 39111958, "comment_id": 65571589, "body": "It means that there&#39;s no such worksheet in currently active workbook named after the current cell value. When you hit the error click &quot;debug&quot; and type in the immediate window &quot;?cell.Value&quot; press return, see what it returns and finally check if the currently active workbook has any sheet named after that value"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472020644, "post_id": 39111958, "comment_id": 65578583, "body": "@WilliamCrawford, did you get through it?"}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472051703, "post_id": 39111958, "comment_id": 65599781, "body": "oh sorry, just got to work. no, when i get the error, i click debug, and it doesnt give me any additional windows, just highlights the line where the error occurs, i guess?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 1, "creation_date": 1472055304, "post_id": 39111958, "comment_id": 65602131, "body": "to pop Immediate Window out just press &quot;Ctrl-G&quot;. Then do what I told you in previous comment and let me know."}, {"owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472058852, "post_id": 39111958, "comment_id": 65604106, "body": "ah ok, its GPU manufacturing in the immediate window. Let me know what else i can tell ya!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "edited": false, "score": 0, "creation_date": 1472060640, "post_id": 39111958, "comment_id": 65605075, "body": "so everything&#39;s ok now?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472062484, "post_id": 39111958, "comment_id": 65606081, "body": "@user3598756 - The real issue was the sheet names had trailing spaces. Once that was fixed, it should be all good."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1472071943, "post_id": 39111958, "comment_id": 65610958, "body": "@BruceWayne, I see... Trailing spaces should be declared outlaw worldwide!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472072145, "post_id": 39111958, "comment_id": 65611050, "body": "@user3598756 oh man, if only. I can&#39;t count the times that I troubleshooted a formula for an hour or two, only to discover the issue was a stupid space."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1472072291, "post_id": 39111958, "comment_id": 65611115, "body": "@BruceWayne and if you had looked around you would have seen me there, too!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1471993470, "last_edit_date": 1471993470, "creation_date": 1471993081, "answer_id": 39111958, "question_id": 39110683, "link": "https://stackoverflow.com/questions/39110683/how-to-match-sheet-tab-names-to-a-range-in-a-separate-sheet-and-return-specifi/39111958#39111958", "title": "How to match Sheet (tab) names to a range in a separate sheet and return specific text to each sheet", "body": "<p>You first wrote:</p>\n\n<p><em>\"For example, if the 2nd sheet in the WB is titled \"Gpu manufacturing\" and the value in A1 of the \"Notes\" sheet is also \"Gpu manufacturing,\" then I want value in cell B1 of the \"Notes\" to be entered into cell F1 of the \"Gpu manufacturing\" sheet.\"</em></p>\n\n<p>From which it derives the following code:</p>\n\n<pre><code>Sub Main()\n    Dim cell As Range\n\n    For Each cell In Worksheets(\"Notes\").Range(\"A1:A6\")\n        Worksheets(cell.Value).Range(\"F1\") = cell.Offset(,1)\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Then you wrote in a comment to BruceWayne answer:</p>\n\n<p><em>\"however it still does not return anything in the F2 cell of each sheet\"</em> </p>\n\n<p>Which changes (from \"F1\" to \"F2\") the destination cell in sheets other than \"Notes\" where to paste its values from column \"B\"</p>\n\n<p>Should this latter be the real case then just substitute:</p>\n\n<pre><code>Worksheets(cell.Value).Range(\"F1\") = cell.Offset(,1)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Worksheets(cell.Value).Range(\"F2\") = cell.Offset(,1)\n</code></pre>\n\n<p>Finally you wrote in another comment to BruceWayne answer:</p>\n\n<p><em>\"this is just a test workbook to get a macro that works because in reality, i will need to use it on a workbook that has 700+ sheets to match to a column and return specific data for that sheet from the second column on the \"Notes\" sheet \u2013 William Crawford 1 hour ago\"</em></p>\n\n<p>Which is an entirely different thing</p>\n\n<p>My code here answers your original question</p>\n\n<p>Should your need have changed than post another question</p>\n"}], "owner": {"reputation": 3, "user_id": 6749718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QEyyMePqwXQ/AAAAAAAAAAI/AAAAAAAADI4/TA4xEpMAwuI/photo.jpg?sz=128", "display_name": "William Crawford", "link": "https://stackoverflow.com/users/6749718/william-crawford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 39111958, "answer_count": 2, "score": 0, "last_activity_date": 1474768039, "creation_date": 1471986445, "last_edit_date": 1474768039, "question_id": 39110683, "link": "https://stackoverflow.com/questions/39110683/how-to-match-sheet-tab-names-to-a-range-in-a-separate-sheet-and-return-specifi", "title": "How to match Sheet (tab) names to a range in a separate sheet and return specific text to each sheet", "body": "<p>I have a workbook with multiple sheets. One sheet has 2 columns of data. This sheet is titled \"Notes\" while the rest of them have a title that matches values entered in range A1:A6 of the \"Notes\" sheet. Column B contains notes that must go on each respective sheet from column A.</p>\n\n<p>For example, if the 2nd sheet in the workbook is titled \"Gpu manufacturing\" and the value in A1 of the \"Notes\" sheet is also \"Gpu manufacturing,\" then I want value in cell B1 of the \"Notes\" to be entered into cell F1 of the \"Gpu manufacturing\" sheet. </p>\n\n<p>Next, if the 3rd sheet in the workbook is titled \"Tesla GPUs\" and the value in A2 of the \"Notes\" sheet is also \"Tesla GPUs,\" then I want value in cell B2 of the \"Notes\" to be entered into cell F1 of the \"Tesla GPUs\" sheet. </p>\n\n<p>Rinse and repeat to keep pulling data from the \"Notes\" sheet into other sheets based on their name or title. </p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub example() \n\n    Dim wkSht As Worksheet\n\n    For Each wkSht In Sheets\n\n        For Each Cell In Sheets(\"Reporting\").Range(\"B2:B200\")\n\n            If Cell.Value = wkSht.Name Then\n\n                wkSht.Range(\"D15\").Copy Destination:=Cell.Offset(0,1)\n\n            End If\n\n        Next Cell\n\n    Next wkSht\n\nEnd Sub\n</code></pre>\n\n<p>Edit for BruceWayne:</p>\n\n<p>this is what my VBA app shows: </p>\n\n<p><img src=\"https://i.stack.imgur.com/F4VYz.png\" alt=\"VBA window\"></p>\n"}, {"tags": ["vba", "host", "cursor-position", "attachmate-reflection"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471986350, "post_id": 39110600, "comment_id": 65568739, "body": "Is the &quot;custom logic to wait or inlcude delay 1 sec or more&quot; doing any more processing?  Also, what backend are you connecting to?  If it&#39;s something like Easytrieve, it&#39;s usually easier to insert Tabs to advance through fields."}, {"owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471986812, "post_id": 39110600, "comment_id": 65568951, "body": "The delay is to catch up to the HOST (which is slow sometimes during peak load times), nothing more.  Also in the macro i am trying to read from an excel file and the HOST is connecting to the mainframe system. Not sure why the &#39;Session.CursorRow&#39; and &#39;Session.CursorColumn&#39; are still returning the new position values when host is still not ready in the new positions"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471987008, "post_id": 39110600, "comment_id": 65569044, "body": "Can you post the delay code?"}, {"owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471987135, "post_id": 39110600, "comment_id": 65569110, "body": "here is the delay function being used in the vba program- <code>code</code> Public Sub DelayScript(Seconds As Integer)     Dim PauseTime, START     PauseTime = Seconds     START = Timer   &#39; Set start time.     Do While Timer &lt; START + PauseTime         DoEvents    &#39; Yield to other processes.     Loop End Sub <code>code</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471987217, "post_id": 39110600, "comment_id": 65569144, "body": "Thought it was something like that. See below  ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "edited": false, "score": 0, "creation_date": 1471987724, "post_id": 39110861, "comment_id": 65569371, "body": "I think this might be the solution i am looking for, being a newbie to the IBM Reflection and going through all the documentation, i think i missed the wait functions.  Thank you for the suggestion @Comintern, will try and keep you posted"}, {"owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "edited": false, "score": 0, "creation_date": 1471999626, "post_id": 39110861, "comment_id": 65572709, "body": "Thank you @Comintern, that worked great. I am gonna have to run this during peak load times and see how the result would be. Thanks again for the quick response. Thumbs up :)"}, {"owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "edited": false, "score": 1, "creation_date": 1472080548, "post_id": 39110861, "comment_id": 65614075, "body": "I have completed multiple load tests and results look good. I was stumbling on this scenario for the last 2 days and finally you helped me fix it, that&#39;s awesome :)"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1471987220, "creation_date": 1471987220, "answer_id": 39110861, "question_id": 39110600, "link": "https://stackoverflow.com/questions/39110600/ibm-reflection-programming-movecursor-function-issue/39110861#39110861", "title": "IBM Reflection programming- MoveCursor function issue", "body": "<p>If I understand your issue correctly, latency in the underlying connection is interfering with your code's timing.  In general, instead of <code>DoEvents</code> or timing code, you should be using the <code>Wait*</code> methods and let Reflection take care of the timings <em>for you</em>.  My guess is that you need something more like this:</p>\n\n<pre><code>With Session\n    .MoveCursor targetRowPos, targetColPos \n    '10 second timeout.\n    .WaitForEvent rcEnterPos, \"10\", \"\", targetRowPos, targetColPos \n    'Verify that you didn't time out.\n    If targetRowPos = .CursorRow And targetColPos = .CursorColumn Then\n        Session.TransmitANSI \"xyz\" 'write xyz on HOST screen\n    End If\nEnd With\n</code></pre>\n\n<p>Alternately (assuming it's a field) you wait on <code>rcEnterField</code> instead of <code>rcEnterPos</code>.  See the <a href=\"http://docs.attachmate.com/reflection/14.x/prog-ref/ibm/hlpid_m_waitforevent.htm\" rel=\"nofollow\">documentation here</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 5147731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d54639597974d13c13820cb79bb9b65?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy Ch", "link": "https://stackoverflow.com/users/5147731/srikanth-reddy-ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1424, "favorite_count": 0, "accepted_answer_id": 39110861, "answer_count": 1, "score": 0, "last_activity_date": 1592987676, "creation_date": 1471986032, "last_edit_date": 1592987676, "question_id": 39110600, "link": "https://stackoverflow.com/questions/39110600/ibm-reflection-programming-movecursor-function-issue", "title": "IBM Reflection programming- MoveCursor function issue", "body": "<p>In IBM Reflection host, i am trying to run a VBA macro for traversing through different screens and fill required information (in a predefined template kind of a screen) to create orders in the system.</p>\n\n<p>In the process, i am trying to utilise the functions- \"Session.MoveCursor\" and \"Session.CursorRow\", \"Session.CursorColumn\" for moving the cursor to a desired position and then reading the cursor position information (to verify the position before writing data on HOST screen)</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Dim currRowPos as Integer\nDim currColPos as Integer\nSession.MoveCursor targetRowPos, targetColPos ' move cursor position\nDoEvents ' custom logic to wait or inlcude delay 1 sec or more, mentioned only single code statement here \ncurrRowPos = Session.CursorRow 'get cursor current row position\ncurrColPos = Session.CursorColumn 'get cursor current column position\n'check current cursor position and write data onto HOST screen\nIf targetRowPos = currRowPos And targetColPos = currColPos Then\n    Session.TransmitANSI \"xyz\" 'write xyz on HOST screen\nEnd If\n</code></pre>\n\n<p>I am trying to write some information on to Host at the desired cursor position and traverse to next screen. In the due process, i am going going back and forth to fill information for multiple items (one at a time).</p>\n\n<p>Sometimes I am facing an issue where the above logic (code) is executed and the cursor is still in old position (not in the desired new row, column position) and the program started writing data in the old position rather than the desired/ target position resulting in a programming error (i.e. 'Session.CursorRow' and 'Session.CursorColumn' are outputting new desired cursor position, when in real time the cursor in its old position on HOST screen).</p>\n\n<p>If anyone has encountered this issue before and/ or have any solution in mind, can you please share the same . Thank you.</p>\n\n<blockquote>\n  <p><strong>Pasted Code from comments below</strong></p>\n</blockquote>\n\n<p><strong>here is the delay function being used in the vba program- code</strong> </p>\n\n<pre><code>Public Sub DelayScript(Seconds As Integer) \n   Dim PauseTime, START \n   PauseTime = Seconds \n   START = Timer ' Set start time. \n   Do While Timer &lt; START + PauseTime \n      DoEvents ' Yield to other processes. \n   Loop \nEnd Sub\n</code></pre>\n\n<p><em>IBM HOST Programming Reference: <a href=\"http://docs.attachmate.com/reflection/14.x/prog-ref/ibm/\" rel=\"nofollow\">http://docs.attachmate.com/reflection/14.x/prog-ref/ibm/</a></em></p>\n"}, {"tags": ["excel", "date", "macros", "office-2016", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471986834, "post_id": 39110597, "comment_id": 65568961, "body": "try lowercase <code>&quot; &amp; Format(Now(), &quot;mm-dd-yyyy&quot;) &amp; &quot;</code> and post the code that gives the error"}, {"owner": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471987588, "post_id": 39110597, "comment_id": 65569300, "body": "It wouldn&#39;t let me post it so I had to add it to the end of my original post as an EDIT"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471987918, "post_id": 39110597, "comment_id": 65569465, "body": "ah I see .. then it has to be <code>&quot; &amp; VBA.Format(Now(), &quot;mm-dd-yyyy&quot;) &amp; &quot;</code>"}, {"owner": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471990821, "post_id": 39110597, "comment_id": 65570481, "body": "That worked beautifully! Thanks so much!!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "edited": false, "score": 0, "creation_date": 1471988324, "post_id": 39110968, "comment_id": 65569629, "body": "If I use this:    ActiveWorkbook.SaveAs Filename:= _         &quot;T:\\Accounting\\Aspen Pre-Payroll (Shared)_Payroll Emails\\098 Payroll Bundle&quot; &amp; Application.Text (=RC[-1], &quot;MM-DD-YYYY&quot;) &amp; &quot; CREW &amp; EXP.xlsx&quot; _         , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False it just gives me a syntax error &amp; turns that section of text red"}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "edited": false, "score": 0, "creation_date": 1471988543, "post_id": 39110968, "comment_id": 65569701, "body": "It won&#39;t be able to interpret =RC[-1]. is the range dynamic, or could you specify it as <code>sheetname.range(&quot;A1&quot;)</code>, for example?"}, {"owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "reply_to_user": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "edited": false, "score": 0, "creation_date": 1471988619, "post_id": 39110968, "comment_id": 65569734, "body": "or alternatively, store the date as a variable and refer to it as <code>Application.Text(yourDate, &quot;MM-DD-YYYY&quot;)</code>"}], "tags": [], "owner": {"reputation": 403, "user_id": 5424671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8f5fca08b5ef7f7bdce8a0087c505?s=128&d=identicon&r=PG&f=1", "display_name": "Rory", "link": "https://stackoverflow.com/users/5424671/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1471988053, "last_edit_date": 1471988053, "creation_date": 1471987717, "answer_id": 39110968, "question_id": 39110597, "link": "https://stackoverflow.com/questions/39110597/excel-macro-save-as-date/39110968#39110968", "title": "Excel Macro Save.As Date", "body": "<p>Try using <code>Application.Text</code> (replacing 'now()' with your date)</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n        \"T:\\Accounting\\Aspen Pre-Payroll (Shared)\\_Payroll Emails\\099 Payroll Bundle\" &amp; Application.Text(Now(), \"MM-DD-YYYY\") &amp; \" CREW &amp; EXP.xlsx\" _\n        , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6595932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc66c9d103f99cc9c2b9494635c003?s=128&d=identicon&r=PG&f=1", "display_name": "SWinchester", "link": "https://stackoverflow.com/users/6595932/swinchester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471988053, "creation_date": 1471986024, "last_edit_date": 1531161705, "question_id": 39110597, "link": "https://stackoverflow.com/questions/39110597/excel-macro-save-as-date", "title": "Excel Macro Save.As Date", "body": "<p>I have a <code>Macro</code> that takes my Master workbook &amp; saves a bunch of different copies with different labels.</p>\n\n<p>Example of section for one workbook:</p>\n\n<pre><code>Range(\"E1:G1\").Select\n    ActiveCell.FormulaR1C1 = \"099 Commercial\"\n    ChDir \"T:\\Accounting\\Aspen Pre-Payroll (Shared)\\_Payroll Emails\"\n    ActiveWindow.View = xlNormalView\n    ActiveWindow.Zoom = 50\n    ActiveWorkbook.SaveAs Filename:= _\n        \"T:\\Accounting\\Aspen Pre-Payroll (Shared)\\_Payroll Emails\\099 Payroll Bundle CREW &amp; EXP.xlsx\" _\n        , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n\n<p>So the label after the macro saves it looks like <code>099 Payroll Bundle CREW &amp; EXP</code>\nBut I would like it to look like <code>099 Payroll Bundle 08-23-2016 CREW &amp; EXP</code>\nwith the 08-23-2016 being the date located in the specific cell <code>=RC[-1]</code>\nHowever, the usuals <code>\" &amp; Format(Date, \"MM-DD-YYYY\") &amp; \" &amp; \" &amp; Format(Now(), \"MM-DD-YYYY\") &amp; \"</code> will not work &amp; gives me a compile error pop-up.</p>\n\n<p>My knowledge about macros is limited so any help would be appreciated!</p>\n\n<p>EDIT:\n<a href=\"http://i.stack.imgur.com/qQVmd.png\" rel=\"nofollow\">ERROR it gives when I try to run macro</a></p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1471986111, "post_id": 39110430, "comment_id": 65568624, "body": "So if I&#39;m understanding your XML schema, you just have one big text blob that has all the data in the worksheet in it?"}, {"owner": {"reputation": 371, "user_id": 2560035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9fd407883055e4052c8390bd32190330?s=128&d=identicon&r=PG", "display_name": "user2560035", "link": "https://stackoverflow.com/users/2560035/user2560035"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471987638, "post_id": 39110430, "comment_id": 65569334, "body": "@Comintern yes that is correct"}, {"owner": {"reputation": 371, "user_id": 2560035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9fd407883055e4052c8390bd32190330?s=128&d=identicon&r=PG", "display_name": "user2560035", "link": "https://stackoverflow.com/users/2560035/user2560035"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1471987736, "post_id": 39110430, "comment_id": 65569376, "body": "@Mat&#39;sMug I&#39;m writing this code to convert an excel file into an XML to be read by an existing software. This is the XML schema that the software uses. I can&#39;t help that it doesn&#39;t make sense to you, it is what it is."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471997487, "post_id": 39110430, "comment_id": 65572180, "body": "Maybe at least use a <code>CDATA</code> block?"}, {"owner": {"reputation": 371, "user_id": 2560035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9fd407883055e4052c8390bd32190330?s=128&d=identicon&r=PG", "display_name": "user2560035", "link": "https://stackoverflow.com/users/2560035/user2560035"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472149087, "post_id": 39110430, "comment_id": 65647893, "body": "@Mat&#39;sMug Actually I did make a mistake in my original post, there should be commas after every item but the last item. My apologies."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472152737, "post_id": 39110430, "comment_id": 65649704, "body": "@user2560035 FWIW please avoid overly broad questions in the future, SO isn&#39;t a &quot;hey I need to do xyz, can you code it for me?&quot; resource. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for all the details."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1472151377, "creation_date": 1472151377, "answer_id": 39152817, "question_id": 39110430, "link": "https://stackoverflow.com/questions/39110430/reading-data-from-excel-table-and-outputting-it-to-xml-using-vba-macro/39152817#39152817", "title": "Reading data from excel table and outputting it to xml using vba macro?", "body": "\n\n<p>This should get you started. Add a reference to MSXML2:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n    With New MSXML2.DOMDocument60\n\n        Dim root As IXMLDOMNode\n        Set root = .createElement(\"root\")\n\n        Dim tag1 As IXMLDOMNode\n        Set tag1 = .createElement(\"tag1\")\n\n        Dim tag2 As IXMLDOMNode\n        Set tag2 = .createElement(\"tag2\")\n\n        tag2.Text = ReadXmlContentFromWorksheet '\"a - 1,b - 2,c - 3\"\n\n        tag1.appendChild tag2\n        root.appendChild tag1\n\n        .appendChild .createProcessingInstruction(\"xml\", \"version=\"\"1.0\"\" encoding=\"\"utf-8\"\"\")\n        Set .DocumentElement = root\n        '.Save \"test.xml\"\n        Debug.Print .XML\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;root&gt;&lt;tag1&gt;&lt;tag2&gt;a - 1,b - 2,c - 3&lt;/tag2&gt;&lt;/tag1&gt;&lt;/root&gt;\n</code></pre>\n</blockquote>\n\n<p>Note that the vertical whitespace is irrelevant</p>\n\n<hr>\n\n<p>The <code>ReadXmlContentFromWorksheet</code> function would look something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function ReadXmlContentFromWorksheet() As String\n    Dim result As String\n\n    Dim lastRow As Long\n    lastRow = MyDataSheet.Range(\"A\" &amp; MyDataSheet.Rows.Count).End(xlUp).Row\n\n    Dim currentRow As Long\n    For currentRow = 1 To lastRow\n        result = result &amp; MyDataSheet.Cells(currentRow, 1).Value &amp; \" - \" _\n                        &amp; MyDataSheet.Cells(currentRow, 2).Value\n        result = IIf(currentRow = lastRow, vbNullString, \",\")\n    Next\n\n    ReadXmlContentFromWorksheet = result\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 2560035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9fd407883055e4052c8390bd32190330?s=128&d=identicon&r=PG", "display_name": "user2560035", "link": "https://stackoverflow.com/users/2560035/user2560035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1275, "favorite_count": 0, "accepted_answer_id": 39152817, "answer_count": 1, "score": 1, "last_activity_date": 1472151377, "creation_date": 1471985370, "last_edit_date": 1472149281, "question_id": 39110430, "link": "https://stackoverflow.com/questions/39110430/reading-data-from-excel-table-and-outputting-it-to-xml-using-vba-macro", "title": "Reading data from excel table and outputting it to xml using vba macro?", "body": "<p>I have some data in an excel table in a format similar to the one below.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    Colum1_Heading       Column2_Heading\n          a                   1\n          b                   2\n          c                   3\n</code></pre>\n\n<p>I am trying to convert the data in this table to XML, I will always have the same number of columns but an indeterminate number of rows. </p>\n\n<p>The XML format is something like this</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;root&gt; \n    &lt;tag1&gt;\n         &lt;tag2&gt;\n              a - 1,\n              b - 2,\n              c - 3\n         &lt;/tag2&gt;\n    &lt;/tag1&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>So I think it should be fairly simple. So far I've started writing some code that creates a writeable string which I would then write to a new XML file, but I'm pretty new to VBA so I'm still researching a bunch on the internet. I've inputted the header and the beginning and end tags since those will always be the same. My question is how to read the rows of the table and write them to the XML in a format shown above. Any help would be appreciated. Please let me know if you need any additional info. </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1471985403, "post_id": 39110394, "comment_id": 65568259, "body": "A formula in itself cannot delete lines or affect other cells in any way.  You will need vba for that.  You can with excel formulas put a TRUE/FALSE in another column that you then can filter."}, {"owner": {"reputation": 115, "user_id": 2256133, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/9LWo0.jpg?s=128&g=1", "display_name": "arun", "link": "https://stackoverflow.com/users/2256133/arun"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471985482, "post_id": 39110394, "comment_id": 65568291, "body": "Scott, is it possible to use number filters instead of writing a formula? Sorry, I&#39;m not much familiar with Excel. Excuse me if I mix up with terminologies."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471985489, "post_id": 39110394, "comment_id": 65568294, "body": "To follow up with Scott&#39;s comment - If you really need Formulas (no VBA), you can accomplish this but will need to use a new worksheet or helper columns. Let us know if VBA is okay or not (you tagged it in the tags, but it&#39;s not clear if you want VBA or not)."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1471991317, "post_id": 39110537, "comment_id": 65570644, "body": "Note that if you ever need to parameterize the divisor, <code>MOD</code> will be much easier to tweak."}], "tags": [], "owner": {"reputation": 136, "user_id": 6745013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a013283eb45a8f02f43b239d371b492f?s=128&d=identicon&r=PG&f=1", "display_name": "Eileen R", "link": "https://stackoverflow.com/users/6745013/eileen-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1471985795, "creation_date": 1471985795, "answer_id": 39110537, "question_id": 39110394, "link": "https://stackoverflow.com/questions/39110394/excel-formula-to-remove-intermediate-rows/39110537#39110537", "title": "Excel formula to remove intermediate rows", "body": "<p>In at third column, I'd enter the formula:\n=ROUND(A1,1)=A1 so it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dQl1V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dQl1V.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then sort on Column C, and delete the FALSE rows.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1471985870, "creation_date": 1471985870, "answer_id": 39110556, "question_id": 39110394, "link": "https://stackoverflow.com/questions/39110394/excel-formula-to-remove-intermediate-rows/39110556#39110556", "title": "Excel formula to remove intermediate rows", "body": "<p>The <code>MOD</code> function returns the <em>remainder</em> of a division. If that's zero, your value is divisible by the parameter value you gave it:</p>\n\n<pre><code>=MOD(A1,0.1)=0\n</code></pre>\n\n<p>Put that in a 3rd column, fill the formula down, and filter out or delete the <code>FALSE</code> rows.</p>\n"}], "owner": {"reputation": 115, "user_id": 2256133, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/9LWo0.jpg?s=128&g=1", "display_name": "arun", "link": "https://stackoverflow.com/users/2256133/arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 39110537, "answer_count": 2, "score": 1, "last_activity_date": 1471985870, "creation_date": 1471985252, "question_id": 39110394, "link": "https://stackoverflow.com/questions/39110394/excel-formula-to-remove-intermediate-rows", "title": "Excel formula to remove intermediate rows", "body": "<p>I've an excel sheet that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6uGj8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6uGj8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to remove all the values that isn't a multiple of 0.1., i.e., in the above example, I want to keep only the rows 1.2, 1.3, 1.4 and delete all the intermediate rows. How can I write formula for this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1471984350, "post_id": 39110147, "comment_id": 65567766, "body": "<code>(Cells(i, &quot;C&quot;).Value) Like &quot;*c*&quot;</code>"}, {"owner": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471984651, "post_id": 39110147, "comment_id": 65567900, "body": "Can i put something so it check b, c, d, e, f, g ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1471984701, "post_id": 39110147, "comment_id": 65567925, "body": "@dzunaa - Is the letter always lower case and at the end of the value?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1471984835, "post_id": 39110147, "comment_id": 65567992, "body": "<code>If (Cells(i, &quot;A&quot;).Value) = &quot;1&quot; And not isnumeric(Right(Cells(i, &quot;C&quot;).Value,1)) Then</code>"}, {"owner": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "edited": false, "score": 0, "creation_date": 1471984972, "post_id": 39110147, "comment_id": 65568055, "body": "yes always lower case"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "edited": false, "score": 0, "creation_date": 1471984789, "post_id": 39110201, "comment_id": 65567969, "body": "Can i put something so it check b, c, d, e, f, g ?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "edited": false, "score": 0, "creation_date": 1471985035, "post_id": 39110201, "comment_id": 65568084, "body": "Just updated the code to reflect your latest request. Hope that helps / solves it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1471985554, "post_id": 39110201, "comment_id": 65568327, "body": "If you <code>LCase</code> before the select, you aren&#39;t testing for case."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1506015143, "last_edit_date": 1506015143, "creation_date": 1471984424, "answer_id": 39110201, "question_id": 39110147, "link": "https://stackoverflow.com/questions/39110147/delete-row-based-on-one-letter/39110201#39110201", "title": "Delete row based on one letter", "body": "<p>Change</p>\n\n<pre><code>If (Cells(i, \"A\").Value) = \"1\" And (Cells(i, \"C\").Value) = \"*c*\" Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If (Cells(i, \"A\").Value) = \"1\" And (Cells(i, \"C\").Value) like \"*c*\" Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If (Cells(i, \"A\").Value) = \"1\" And InStr(1, Cells(i, \"C\").Value, \"c\", vbTextCompare) Then\n</code></pre>\n\n<p>May I also suggest that you make some more changes to your code and start coding explicitly like so:</p>\n\n<pre><code>Option Explicit\n\nSub xDeleteRowz()\n\nDim i As Long, Last As Long\n\nLast = Cells(Rows.Count, \"A\").End(xlUp).Row\nWith ThisWorkbook.Worksheets(1)\n    For i = Last To 1 Step -1\n        If .Cells(i, \"A\").Value = \"1\" And InStr(1, .Cells(i, \"C\").Value, \"c\", vbTextCompare) Then\n            .Rows(i).EntireRow.Delete\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<h2>Update:</h2>\n\n<p>Based on the latest comment a more suitable approach might be the following:</p>\n\n<pre><code>Option Explicit\n\nSub xDeleteRowz()\n\nDim i As Long, Last As Long\n\nLast = Cells(Rows.Count, \"A\").End(xlUp).Row\nWith ThisWorkbook.Worksheets(1)\n    For i = Last To 1 Step -1\n        If .Cells(i, \"A\").Value = \"1\" Then\n            Select Case LCase(Right(.Cells(i, \"C\").Value, 1))\n                Case \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"\n                    .Rows(i).EntireRow.Delete\n            End Select\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "edited": false, "score": 0, "creation_date": 1471985554, "post_id": 39110389, "comment_id": 65568328, "body": "This is what I need Thanks :D"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1471985246, "creation_date": 1471985246, "answer_id": 39110389, "question_id": 39110147, "link": "https://stackoverflow.com/questions/39110147/delete-row-based-on-one-letter/39110389#39110389", "title": "Delete row based on one letter", "body": "<p>This sounds like something more suited for a regular expression:</p>\n\n<pre><code>Sub xDeleteRowz()\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    With CreateObject(\"VBScript.RegExp\")\n        .Pattern = \"MG\\d{2}[a-z]\"\n        .IgnoreCase = False\n        For i = Last To 1 Step -1\n            If (Cells(i, \"A\").Value) = \"1\" And .Test(Cells(i, \"C\").Value) Then\n                Cells(i, \"A\").EntireRow.Delete\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that the expression requires the value to begin with MG##.  If the start of the value can be different, replace this line...</p>\n\n<pre><code>.Pattern = \"MG\\d{2}[a-z]\"\n</code></pre>\n\n<p>...with...</p>\n\n<pre><code>.Pattern = \".+[a-z]\"\n</code></pre>\n\n<p>... and it will match anything with a lowercase letter at the end. You can also limit to specific letters by changing the range inside the brackets.  I.e., if it's only 'a' through 'g', it would be:</p>\n\n<pre><code>.Pattern = \".+[a-g]\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4381636, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ba8c13f0265c95de0fba1b023da5263?s=128&d=identicon&r=PG&f=1", "display_name": "dzunaa", "link": "https://stackoverflow.com/users/4381636/dzunaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 39110389, "answer_count": 2, "score": 2, "last_activity_date": 1506015143, "creation_date": 1471984216, "last_edit_date": 1531164843, "question_id": 39110147, "link": "https://stackoverflow.com/questions/39110147/delete-row-based-on-one-letter", "title": "Delete row based on one letter", "body": "<p>Need help with my code.\nIn (Column C) I have values MG01, MG02a, MG02b, MG02c. And in (Column A) different values. Code needs to delete row if value in column A is \"1\" and\nin Column C if it finds letters at the end of text such as b, c, d, e, ....</p>\n\n<p>And with \"<em>c</em>\" code do not recognized MG02c help please.</p>\n\n<pre><code>Sub xDeleteRowz()\n\nLast = Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = Last To 1 Step -1\n    If (Cells(i, \"A\").Value) = \"1\" And (Cells(i, \"C\").Value) = \"*c*\" Then\n        Cells(i, \"A\").EntireRow.Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "macos", "ms-word"], "comments": [{"owner": {"reputation": 191, "user_id": 756988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21b9797cbadecff9144e947ec75ac8?s=128&d=identicon&r=PG", "display_name": "Arieleo", "link": "https://stackoverflow.com/users/756988/arieleo"}, "edited": false, "score": 0, "creation_date": 1490746801, "post_id": 39109886, "comment_id": 73247211, "body": "Mikael, thanks for posting this question. I am wondering if you ever managed to find a solution to this issue. Would you be able to update/share?"}, {"owner": {"reputation": 13, "user_id": 6748352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kueBtRbRmIg/AAAAAAAAAAI/AAAAAAAAAHo/cvjVHIhPBio/photo.jpg?sz=128", "display_name": "Mikael Sams&#248;e S&#248;rensen", "link": "https://stackoverflow.com/users/6748352/mikael-sams%c3%b8e-s%c3%b8rensen"}, "reply_to_user": {"reputation": 191, "user_id": 756988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21b9797cbadecff9144e947ec75ac8?s=128&d=identicon&r=PG", "display_name": "Arieleo", "link": "https://stackoverflow.com/users/756988/arieleo"}, "edited": false, "score": 0, "creation_date": 1490935110, "post_id": 39109886, "comment_id": 73342989, "body": "Yes. The error generated was misleading. When the dylib was updated and compiled for 64-bit the problem was resolved. The declare statement mentioned above is OK."}, {"owner": {"reputation": 191, "user_id": 756988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21b9797cbadecff9144e947ec75ac8?s=128&d=identicon&r=PG", "display_name": "Arieleo", "link": "https://stackoverflow.com/users/756988/arieleo"}, "edited": false, "score": 0, "creation_date": 1491390854, "post_id": 39109886, "comment_id": 73528878, "body": "I&#39;ll try that; thanks for the update!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6748352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kueBtRbRmIg/AAAAAAAAAAI/AAAAAAAAAHo/cvjVHIhPBio/photo.jpg?sz=128", "display_name": "Mikael Sams&#248;e S&#248;rensen", "link": "https://stackoverflow.com/users/6748352/mikael-sams%c3%b8e-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1472019096, "post_id": 39111697, "comment_id": 65577852, "body": "Thank you very much. This looks promising. I can choose any file under references, but It will not show up in references. It might work if the file is in the right location."}, {"owner": {"reputation": 13, "user_id": 6748352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kueBtRbRmIg/AAAAAAAAAAI/AAAAAAAAAHo/cvjVHIhPBio/photo.jpg?sz=128", "display_name": "Mikael Sams&#248;e S&#248;rensen", "link": "https://stackoverflow.com/users/6748352/mikael-sams%c3%b8e-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1472275625, "post_id": 39111697, "comment_id": 65697331, "body": "Ok I now tried both folder locations without any luck."}, {"owner": {"reputation": 13, "user_id": 6748352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kueBtRbRmIg/AAAAAAAAAAI/AAAAAAAAAHo/cvjVHIhPBio/photo.jpg?sz=128", "display_name": "Mikael Sams&#248;e S&#248;rensen", "link": "https://stackoverflow.com/users/6748352/mikael-sams%c3%b8e-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1472276039, "post_id": 39111697, "comment_id": 65697401, "body": "When I try to select the dylib I simply cannot select it- Its grayed out. The default file extension is a word file which can be changed to tlb or &#39;any file&#39;. Choosing &#39;any file&#39; does not help. I double checked the folder names numerous times letter by letter.  FYI If I go to a locations where I can choose a word file, and choose &#39;any file&#39; the word file will also gray-out. Running Yosemite 10.10.4."}], "tags": [], "owner": {"reputation": 36, "user_id": 6420414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788110802c483d8e903df9728f39b203?s=128&d=identicon&r=PG", "display_name": "Erik Schwiebert", "link": "https://stackoverflow.com/users/6420414/erik-schwiebert"}, "is_accepted": true, "score": 2, "last_activity_date": 1471991478, "creation_date": 1471991478, "answer_id": 39111697, "question_id": 39109886, "link": "https://stackoverflow.com/questions/39109886/word-2016-vba-add-in-for-mac/39111697#39111697", "title": "Word 2016 vba add-in for Mac", "body": "<p>Office 2016 is sandboxed, with limited entitlements to read files that live in specific places. I wrote this document on installing user content for Mac Office 2016 that you can start with: <a href=\"http://macadmins.software/docs/UserContentIn2016.pdf\" rel=\"nofollow\">http://macadmins.software/docs/UserContentIn2016.pdf</a></p>\n\n<p>Specifically, dylibs must be located in ~/Library/Group Containers/UBF8T346G9.Office/User Content.localized/Add-Ins.localized/ if they are installed for each specific user, or in /Library/Application Support/Microsoft/Office365/User Content.localized/Add-Ins.localized/ if they are installed once on the machine for all users to share.</p>\n\n<p>Office 2016 apps cannot read arbitrary file locations anymore. </p>\n\n<p>Separately, the inability to choose any non-typelib file when you try to add file references may be a bug. I'll have to take a look.</p>\n\n<p>Schwieb\n(Principal Software Engineer, Apple Platform Experiences Group, Microsoft Corporation)</p>\n"}], "owner": {"reputation": 13, "user_id": 6748352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kueBtRbRmIg/AAAAAAAAAAI/AAAAAAAAAHo/cvjVHIhPBio/photo.jpg?sz=128", "display_name": "Mikael Sams&#248;e S&#248;rensen", "link": "https://stackoverflow.com/users/6748352/mikael-sams%c3%b8e-s%c3%b8rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 39111697, "answer_count": 1, "score": 1, "last_activity_date": 1592988781, "creation_date": 1471983039, "last_edit_date": 1592988781, "question_id": 39109886, "link": "https://stackoverflow.com/questions/39109886/word-2016-vba-add-in-for-mac", "title": "Word 2016 vba add-in for Mac", "body": "<p>I have an created an add-in for Word which communicates with a third party cmd-program via an api I have written in c# using visual studio. The communication takes place using stdin and stdout.\nThe program works for word 2007, 2010, 2013, 2016 for Windows.</p>\n\n<p>I have also successfully ported it to Word 2011 for Mac. The api here is written in c using xcode, but still using stdin and stdout. The api on mac is a dylib, which I can reference in the visual basic editor.\nI'm having trouble replicating this on the 2016 version of Office for Mac.\nI'm suspecting it might not be possible, due to new security restrictions.\nWhen I try to reference a file I can only choose .tlb files (type libraries). I have only created tlb files using visual studio on Windows and have no idea how you might do that on a mac.</p>\n\n<p>Can anyone answer if what I'm trying to do is even possible on the 2016 version of Office for Mac, and where I might find documentation on how to create files that can be referenced?</p>\n\n<p>FYI: The add-in is called WordMat: www.eduap.com</p>\n\n<p><strong>Additional info following information from @erik below</strong>\nI'm having trouble declaring the functions in my lib. Here is my declare statement:\n<code>Declare PtrSafe Function VBstrlen Lib \"/Library/Application Support/Microsoft/Office365/User Content.localized/Add-Ins.localized/libMaximaConnection.dylib\" (ByVal s As String) As LongPtr</code></p>\n\n<p>The function is a simple test function which returns the length of a string. The declare function works as expected in Word 2011 using the above path.</p>\n\n<p>The error reported is <em>error 53 file cannot be located</em></p>\n\n<p>The dylib is 32-bit compiled, hence I would not expect it to work since the 64-bit upgrade of Office 2016, but I would expect an <em>error 453 DLL cannot be located</em> as Word 2011 would report.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471981651, "post_id": 39109503, "comment_id": 65566388, "body": "What is <code>xlObject</code> ?  Do you mean <code>xlApp.Workbooks()</code> ?"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471982563, "post_id": 39109503, "comment_id": 65566826, "body": "I made that change and it gives me a subscript out of range error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471983201, "post_id": 39109503, "comment_id": 65567167, "body": "Where does it give you that error?"}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471983311, "post_id": 39109503, "comment_id": 65567220, "body": "change <code>Xlobjet.object </code>to <code>xlApp</code>."}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1471983376, "post_id": 39109503, "comment_id": 65567254, "body": "This gives me the out of range error                                                         Set Wb = xlApp.Workbooks(&quot;Test.xlsx&quot;)"}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471983556, "post_id": 39109503, "comment_id": 65567362, "body": "Test.xlsx is opened...?"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1471983596, "post_id": 39109503, "comment_id": 65567385, "body": "Test.xlsx does not exist.  I need the macro to create a new workbook and name it that."}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471983668, "post_id": 39109503, "comment_id": 65567431, "body": "use add method to create that with name &quot;Test&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1476902290, "post_id": 39109503, "comment_id": 67548045, "body": "You posted a question about an &quot;object required&quot; error, you got an answer addressing the &quot;object required&quot; error (and more!) - editing your question a whole week later to ask a completely different question about how to go about copying the contents of an Outlook email <i>defeats the purpose of this site</i> - this isn&#39;t a discussion forum, it&#39;s Q&amp;A. If you have a new question, mark this one as accepted and then <i>ask a new question</i> - don&#39;t edit your post to make every previous answering effort moot."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1506033536, "last_edit_date": 1506033536, "creation_date": 1471983565, "answer_id": 39110014, "question_id": 39109503, "link": "https://stackoverflow.com/questions/39109503/copy-email-body-to-excel-using-outlook-vba/39110014#39110014", "title": "Copy email body to Excel using Outlook VBA", "body": "<p><code>xlObject</code> isn't declared or assigned anywhere. Specify <code>Option Explicit</code> at the top of the module - the VBE will likely be complaining about the undeclared identifier.</p>\n\n<p>Because <code>xlObject</code> isn't declared, it's implicitly <code>Variant</code>, and because it's never assigned, its type is actually <code>Variant/Empty</code>. And because <code>Empty</code> isn't an object type, using the <code>Set</code> keyword to assign an object reference causes that \"Object required\" error, because <code>Set</code> can only be used to assign an object reference.</p>\n\n<p>This code reproduces the issue - try it in the <em>immediate pane</em>:</p>\n\n<pre><code>Set foo = xyz.abc\n</code></pre>\n\n<p>In other words, <code>xlObject</code> doesn't exist, VBA doens't know what to do with it. As you've been told in comments, you need to use the properly declared and assigned <code>xlApp</code> reference instead.</p>\n\n<pre><code>Set Wb = xlApp.Workbooks(\"Test.xlsx\")\n</code></pre>\n\n<blockquote>\n  <p><em>This gives me the out of range error</em></p>\n</blockquote>\n\n<p>Of course it does. There's no workbook named <code>Test.xlsx</code> in that instance of Excel.</p>\n\n<p>The solution is to open it:</p>\n\n<pre><code>Set Wb = xlApp.Workbooks.Open(\"Test.xlsx\")\n</code></pre>\n\n<p>Now, you should be expecting another error if that file doesn't exist: <em>handle it</em>.</p>\n\n<blockquote>\n  <p><em>Test.xlsx does not exist. I need the macro to create a new workbook and name it that.</em></p>\n</blockquote>\n\n<p>The <code>Add</code> method will create a brand new workbook:</p>\n\n<pre><code>Set Wb = xlApp.Workbooks.Add\n</code></pre>\n\n<p>You can name the workbook when you save it, before you close it:</p>\n\n<pre><code>wb.SaveAs \"test.xlsx\"\nwb.Close False\n</code></pre>\n\n<p>The <code>Close</code> method has parameters to save changes, so you could also do it in one line:</p>\n\n<pre><code>wb.Close True, \"test.xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609029034, "creation_date": 1471981527, "last_edit_date": 1609029034, "question_id": 39109503, "link": "https://stackoverflow.com/questions/39109503/copy-email-body-to-excel-using-outlook-vba", "title": "Copy email body to Excel using Outlook VBA", "body": "<p>I am trying to copy the body of an email to a new Excel workbook.</p>\n<p>The code is generating an error</p>\n<blockquote>\n<p>&quot;Object Required&quot;</p>\n</blockquote>\n<p>on the <code>Set Wb</code> line.</p>\n<p>A majority of this code is copied from somewhere else, but it's been a while and I forget where.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub PasteToExcel()\n    Dim activeMailMessage As MailItem\n    Dim xlApp As Excel.Application\n    Dim Wb As Excel.Workbook\n    Dim Ws As Excel.Worksheet\n    \n    If TypeName(ActiveExplorer.Selection.Item(1)) = &quot;MailItem&quot; Then\n\n        'Get a handle on the email\n        Set activeMailMessage = ActiveExplorer.Selection.Item(1)\n\n        'Copy the formatted text:\n        activeMailMessage.GetInspector().WordEditor.Range.FormattedText.Copy\n    \n        'Ensure Excel Application is open\n        Set xlApp = CreateObject(&quot;Excel.Application&quot;)\n\n        'Make Excel Application visible\n        xlApp.Visible = True\n\n        'Name the Excel File\n        Set Wb = xlObject.Object.Workbooks(&quot;Test.xlsx&quot;)\n    \n        'Paste the email\n        Set Ws = xlObject.Object.Sheets(1)\n        Ws.Range(&quot;A1&quot;).Paste\n    \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1471981796, "post_id": 39109429, "comment_id": 65566444, "body": "Not sure what&#39;s causing the error, but you could extract the body of the loop into its own parameterized procedure <i>and handle runtime errors</i>, so that if the first iteration blows up, you&#39;re still iterating and trying with the remainder of the <code>ChartObjects</code> collection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1471981852, "post_id": 39109429, "comment_id": 65566470, "body": "What types of charts do you have on that <i>Summary</i> sheet? Do they all have a secondary value axis?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 1, "creation_date": 1471981854, "post_id": 39109429, "comment_id": 65566473, "body": "I can&#39;t tell just from the code, but try adding <code>debug.print objChart.name</code> inside the loop and step through the code with F8. See which charts get updated and which don&#39;t, maybe there is something different about those who don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6591664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d0211a5d28a6a348046a72e1650f080?s=128&d=identicon&r=PG&f=1", "display_name": "rocketman", "link": "https://stackoverflow.com/users/6591664/rocketman"}, "edited": false, "score": 1, "creation_date": 1471984158, "post_id": 39109786, "comment_id": 65567680, "body": "Beautiful. The problem is indeed those graphs without a secondary axis. This is a great way to diagnose problems in general as well. Will accept as answer once I&#39;m allowed to do so, many thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1471985171, "post_id": 39109786, "comment_id": 65568149, "body": "<code>If .Axes.Count &gt; 2 Then</code> --&gt; has a secondary y-axis (assuming there arte never secondary x-axes...)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1471982625, "last_edit_date": 1495535327, "creation_date": 1471982625, "answer_id": 39109786, "question_id": 39109429, "link": "https://stackoverflow.com/questions/39109429/vba-code-only-working-for-some-charts/39109786#39109786", "title": "VBA code only working for some charts", "body": "<p>If a <code>ChartObject</code> doesn't have a secondary axis, accessing it will raise an error. I couldn't figure out a way to reproduce your exact error, but as I said in <a href=\"https://stackoverflow.com/questions/39109429/vba-code-only-working-for-some-charts#comment65566444_39109429\">a comment</a>, extracting a procedure and handling runtime errors should at least help diagnosing the problem and making the loop iterate all charts:</p>\n\n<pre><code>Public Sub UpdateSummarySheetChartAxes()\n\n    Dim lower As Double\n    lower = Application.InputBox(prompt:=\"Enter lower bound\", Type:=1)\n\n    Dim upper As Double        \n    upper = Application.InputBox(prompt:=\"Enter upper bound\", Type:=1)\n\n    Dim objChart As ChartObject\n    For Each objChart In Sheets(\"Summary\").ChartObjects\n        UpdateChartAxes objChart, lower, upper\n    Next objChart\n\nEnd Sub\n\nPrivate Sub UpdateChartAxes(ByVal objChart As ChartObject, ByVal lower As Double, ByVal upper As Double)\n    On Error GoTo CleanFail\n    With objChart.Chart.Axes(xlValue, xlSecondary)\n        .MinimumScale = lower\n        .MaximumScale = upper\n    End With\nCleanExit:\n    Exit Sub\nCleanFail:\n    Debug.Print \"Failed updating axes for chart '\" &amp; objChart.Name &amp; \"'. Message: \" &amp; Err.Description\n    Resume CleanExit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6591664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d0211a5d28a6a348046a72e1650f080?s=128&d=identicon&r=PG&f=1", "display_name": "rocketman", "link": "https://stackoverflow.com/users/6591664/rocketman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 39109786, "answer_count": 1, "score": 0, "last_activity_date": 1471982625, "creation_date": 1471981222, "question_id": 39109429, "link": "https://stackoverflow.com/questions/39109429/vba-code-only-working-for-some-charts", "title": "VBA code only working for some charts", "body": "<p>My VBA code for updating the secondary axes range on all graphs of a worksheet only works for some of the graphs. After the macro is run, the message \"Method 'Axes' of object '_Chart' failed\" is displayed, with only some of the graphs on that worksheet being updated. What's the problem here?</p>\n\n<pre><code>Sub Macro1()\n\nDim objChart As ChartObject, lower As Double, upper As Double\n\nlower = Application.InputBox(prompt:=\"Enter lower bound\", Type:=1)\nupper = Application.InputBox(prompt:=\"Enter upper bound\", Type:=1)\n\nFor Each objChart In Sheets(\"Summary\").ChartObjects\n    With objChart.Chart.Axes(xlValue, xlSecondary)\n        .MinimumScale = lower\n        .MaximumScale = upper\n    End With\nNext objChart\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "flat-file"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1471981174, "post_id": 39109383, "comment_id": 65566142, "body": "Hi welcome to stack overflow....Have u written any code so far"}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": -1, "last_activity_date": 1471986357, "last_edit_date": 1471986357, "creation_date": 1471982388, "answer_id": 39109724, "question_id": 39109383, "link": "https://stackoverflow.com/questions/39109383/vba-replace-text-from-txt-for-each-line-and-save-as/39109724#39109724", "title": "VBA: Replace text from txt for each line and save as", "body": "<pre><code>Sub TextFile_FindReplace()\nDim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\n\nFilePath = Application.ActiveWorkbook.Path &amp; \"\\NEWTEST.txt\"\nTextFile = FreeFile\nOpen FilePath For Input As TextFile\nFileContent = Input(LOF(TextFile), TextFile)\n\n\nFileContent = Replace(FileContent, \"FOO\", \"BAR\")\n\n\nPrint #TextFile, FileContent\nClose TextFile\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1471997307, "creation_date": 1471997307, "answer_id": 39112503, "question_id": 39109383, "link": "https://stackoverflow.com/questions/39109383/vba-replace-text-from-txt-for-each-line-and-save-as/39112503#39112503", "title": "VBA: Replace text from txt for each line and save as", "body": "<p>I think something like this should work?</p>\n\n<pre><code>Sub test()\n\n  Dim text, textReplace, findMe As String\n\n  findMe = InputBox(\"What Text To Find?\")\n  Open \"C:\\Excel Scripts\\test.txt\" For Input As #1\n  Open \"C:\\Excel Scripts\\test2.txt\" For Input As #2\n  Open \"C:\\Excel Scripts\\output.txt\" For Output As #3\n\n  While Not EOF(1)\n    Line Input #1, text\n      While Not EOF(2)\n        Line Input #2, textReplace\n        Write #3, Replace(text, findMe, textReplace)\n      Wend\n  Wend\n\n  Close #1\n  Close #2\n  Close #3\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6749474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07dd534682dce01527cc20b566befb7?s=128&d=identicon&r=PG&f=1", "display_name": "Dkoonice", "link": "https://stackoverflow.com/users/6749474/dkoonice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1582, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1472014832, "creation_date": 1471981014, "last_edit_date": 1472014832, "question_id": 39109383, "link": "https://stackoverflow.com/questions/39109383/vba-replace-text-from-txt-for-each-line-and-save-as", "title": "VBA: Replace text from txt for each line and save as", "body": "<p>Could somebody help me with the following? I tried making it on my own, but all I could do is open a txt and replace a static word with static word.</p>\n\n<p>VBA script:</p>\n\n<p>Open and Read first line of ThisVbaPath.WordsToUse.txt</p>\n\n<p>Open and Find USER_INPUT in ThisVbaPath.BaseDoc.docx (or txt)</p>\n\n<p>Replace all occurrence of USER_INPUT with first line from WordsToUse.txt</p>\n\n<p>Save BaseDoc.docx as BaseDoc&amp;First_Line.docx</p>\n\n<p>Close all</p>\n\n<p>Go next line and do same, but don't ask for user input, use previous one</p>\n\n<p>If error go next</p>\n\n<p>When done show if there were any errors (unlikely I guess)</p>\n\n<p>I would use it about weekly for 150-ish lines.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "forms", "ms-access", "button"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1471985320, "post_id": 39109270, "comment_id": 65568216, "body": "I&#39;m pretty confused. Adding a record to a bound form should be as easy as clicking the new record nav button in the bottom pane of the form (right arrow with asterisk). Also, does your BeforeUpdate routine utilize the <code>.OldValue</code> property? That&#39;s the only way I know to uncommit a bound field, as the edits are saved to the table as soon as you exit a control. So without <code>.OldValue</code> you are triggering your routine too late, and would probably need to be added to the BeforeUpdate event of each control, not on the form. Post the code for your submit button and beforeupdate event to clarify."}], "answers": [{"comments": [{"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "reply_to_user": {"reputation": 97, "user_id": 6706424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ee171e625632c5430e8857bfa11a1249?s=128&d=identicon&r=PG&f=1", "display_name": "New2This", "link": "https://stackoverflow.com/users/6706424/new2this"}, "edited": false, "score": 0, "creation_date": 1472058795, "post_id": 39124798, "comment_id": 65604077, "body": "What do you mean &quot;better way&quot;. After all this Sub is really just 1 line of code"}, {"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "reply_to_user": {"reputation": 97, "user_id": 6706424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ee171e625632c5430e8857bfa11a1249?s=128&d=identicon&r=PG&f=1", "display_name": "New2This", "link": "https://stackoverflow.com/users/6706424/new2this"}, "edited": false, "score": 0, "creation_date": 1472060077, "post_id": 39124798, "comment_id": 65604777, "body": "Anytime! I&#39;ve tried using the bound forms at the beginning when learning Access and it was great, but as I wanted to have more control over the data and where it goes, I found that VBA was way more effective. If the answer helped feel free to accept or upvote ;)"}, {"owner": {"reputation": 97, "user_id": 6706424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ee171e625632c5430e8857bfa11a1249?s=128&d=identicon&r=PG&f=1", "display_name": "New2This", "link": "https://stackoverflow.com/users/6706424/new2this"}, "edited": false, "score": 0, "creation_date": 1472060499, "post_id": 39124798, "comment_id": 65605007, "body": "Done! I noticed that code also works on bound forms. I&#39;m learning VBA and access right now and am hoping to get even better as time goes on."}], "tags": [], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "is_accepted": true, "score": 7, "last_activity_date": 1598853914, "last_edit_date": 1598853914, "creation_date": 1472045548, "answer_id": 39124798, "question_id": 39109270, "link": "https://stackoverflow.com/questions/39109270/how-to-use-vba-to-add-new-record-in-ms-access/39124798#39124798", "title": "How to use VBA to add new record in MS Access?", "body": "<p>In order to submit a record using VBA, create an <code>On Click</code> event for the button, and in that <code>Sub</code> run the following command:</p>\n<pre><code>Private Sub submitButton_Click()\n\n    'All the code to validate user input. Prompt user to make sure they want to submit form, etc.\n\n    DoCmd.RunSQL &quot;INSERT INTO tblCustomers (CustomerID, CustomerName, CustomerAddressLine1, City, Zip) values (txtCustomerID.Value, txtCustomerName.Value, txtCustomerAddressLine1.Value, txtCity.Value, txtZip.Value)&quot;\n\nEnd Sub\n</code></pre>\n<p>In this Sub, you can add all the code you want to validate the values that the user entered and choose whether or not you want to submit the record. There's a lot of control using VBA to submit your forms, so you do not need a <code>BeforeUpdate</code> event.</p>\n<p>Also, do NOT use bound forms with this method. I don't know what the repercussions are but I wouldn't try it. Access is great for starting off, but as you want to do more complex things, it is easier to just use VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1520323091, "post_id": 46947704, "comment_id": 85256458, "body": "Please note that in your first <code>Dim</code> statement, you are declaring <code>sVIN, sMake, sModel, sColor</code> as <code>Variant</code>, although it seems you wanted to have them as <code>String</code>. You need to explicitly set the type for each variable you define, otherwise it will be initialized as <code>Variant</code>. (You can temporarily add a line <code>Debug.Print typename(sVIN)</code> to see what I mean.)"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1520323452, "post_id": 46947704, "comment_id": 85256620, "body": "Does it make a functional difference whether you execute <code>Field.SetFocus</code> before you read a field&#39;s value? I&#39;m a bit confused by that approach. Is it to have some additional events trigger that are not mentioned in your answer?"}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1521789876, "post_id": 46947704, "comment_id": 85890288, "body": "@Inarion the .SetFocus statements are probably not necessary actually. I got in the habit of doing that when working with form fields because sometimes Access doesn&#39;t let you do things (like setting the field&#39;s value) unless you set the focus on that object first."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1521798888, "post_id": 46947704, "comment_id": 85895191, "body": "Ah, that surely explains it. I&#39;ve run into the opposite problem: Access would not let me hide a control unless I would move the focus somewhere else. ;)"}], "tags": [], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "is_accepted": false, "score": 1, "last_activity_date": 1575976211, "last_edit_date": 1575976211, "creation_date": 1509001078, "answer_id": 46947704, "question_id": 39109270, "link": "https://stackoverflow.com/questions/39109270/how-to-use-vba-to-add-new-record-in-ms-access/46947704#46947704", "title": "How to use VBA to add new record in MS Access?", "body": "<p>It seems strange that you would create a before update event for your form to create a prompt before closing. Perhaps you should try the on close event instead.  If you want to use vba to add a new record from the form you can simplify your statement. I came across a similar situation when designing my own form for my Access DB.  This code is tested and working:</p>\n\n<pre><code>Dim sVIN As String\nDim sMake As String\nDim sModel As String\nDim sColor As String\nDim sType As String\nDim intYear As Integer\n\nsVIN = Me.txtVIN.Value\nsMake = Me.txtMake.Value\nsModel = Me.txtModel.Value\nsColor = Me.txtColor.Value\nsType = Me.comboType.SelText\nintYear = Me.txtVehicleYear.Value\n\nDoCmd.RunSQL \"INSERT INTO Vehicles (VIN, Make, Model, VehicleYear, Color, Type) VALUES ('\" &amp; sVIN &amp; \"', '\" &amp; sMake &amp; \"', '\" &amp; sModel &amp; \"', \" &amp; intYear &amp; \", '\" &amp; sColor &amp; \"', '\" &amp; sType &amp; \"')\"\n</code></pre>\n\n<p>If you are just using one DB in your project and you're connecting on start up you can sometimes run simple DoCmd.RunSQL statements like this. You can take the syntax here and adapt it to your own project.  I myself got the basic syntax from W3 schools. Good site for learning to write SQL queries. It should also be noted that validation testing is not included here. You should make sure it is included in the form validation rules or in vba code. One more thing... in your SQL it looks like you are attempting to assign a value to the ID column from a text box entry; if ID is an auto number column, don't do this.  ID columns are usually assigned a number automatically, so you don't need to (or want to) specify an insert value for that.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11893590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uGxvEPrKyYo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdHHnlf7dWjJiESkdJhc4Sq-_B7_w/mo/photo.jpg?sz=128", "display_name": "Krzychu C", "link": "https://stackoverflow.com/users/11893590/krzychu-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1565155121, "creation_date": 1565155121, "answer_id": 57387408, "question_id": 39109270, "link": "https://stackoverflow.com/questions/39109270/how-to-use-vba-to-add-new-record-in-ms-access/57387408#57387408", "title": "How to use VBA to add new record in MS Access?", "body": "<p>As a side note:\nI noticed that adding records via VBA functionality(as in your \"Add Record Button\" code) works ~400 times faster than using DoCmd.Run SQL \"INSERT INTO...\":\n~55k records/s compared to 140 records/s for a table with 5 columns(ID+4 short strings).</p>\n\n<p>This has no practical meaning in terms of a form, where data is entered manually but if the form is generating more records, this saves a lot of time.</p>\n"}], "owner": {"reputation": 97, "user_id": 6706424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ee171e625632c5430e8857bfa11a1249?s=128&d=identicon&r=PG&f=1", "display_name": "New2This", "link": "https://stackoverflow.com/users/6706424/new2this"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91934, "favorite_count": 2, "accepted_answer_id": 39124798, "answer_count": 3, "score": 8, "last_activity_date": 1598853914, "creation_date": 1471980557, "last_edit_date": 1594237677, "question_id": 39109270, "link": "https://stackoverflow.com/questions/39109270/how-to-use-vba-to-add-new-record-in-ms-access", "title": "How to use VBA to add new record in MS Access?", "body": "<p>I'm using bound forms for the user to update information on new or existing customers. Right now I'm using a Add New Record macro on the submit button (because I'm not sure how to add or save a new record through VBA). </p>\n\n<p>I added a before update event (using VBA) to have the user confirm they want to save changes before exiting the form. For some reason this is overriding the add record button and now users cannot add new record until exiting the forms.</p>\n\n<p>How can I use VBA to add new customer information to the correct table? Is this something that should be done with macros instead?</p>\n\n<p>Form BeforeUpdate Code:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer) \nDim strmsg As String \nstrmsg = \"Data has been changed.\" \nstrmsg = strmsg &amp; \" Save this record?\" \nIf MsgBox(strmsg, vbYesNo, \"\") = vbNo Then \n    DoCmd.RunCommand acCmdUndo \nElse \nEnd If \nEnd Sub\n</code></pre>\n\n<p>Add Record Button:</p>\n\n<pre><code>Private Sub btnAddRecord_Click() \nDim tblCustomers As DAO.Recordset \n\nSet tblCustomers = CurrentDb.OpenRecordset(\"SELECT * FROM [tblCustomers]\") \ntblCustomers.AddNew \ntblCustomers![Customer_ID] = Me.txtCustomerID.Value \ntblCustomers![CustomerName] = Me.txtCustomerName.Value \ntblCustomers![CustomerAddressLine1] = Me.txtCustomerAddressLine1.Value \ntblCustomers![City] = Me.txtCity.Value \ntblCustomers![Zip] = Me.txtZip.Value \ntblCustomers.Update \ntblCustomers.Close \nSet tblCustomers = Nothing \nDoCmd.Close \nEnd Sub\n</code></pre>\n"}]