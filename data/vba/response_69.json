[{"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462405200, "post_id": 37039855, "comment_id": 61629576, "body": "you could add a helper column and do a countif and then filter on that helper column"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462405450, "post_id": 37039855, "comment_id": 61629664, "body": "how did you get your table in?  did you cut and paste it from somewhere?  it came in nicely formatted."}, {"owner": {"reputation": 3, "user_id": 6238433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f36e9e3a063d096683d25d6ae56c24?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6238433/james"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462641828, "post_id": 37039855, "comment_id": 61726770, "body": "Thanks for the help. I used html to format the table."}], "answers": [{"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1462405327, "creation_date": 1462405327, "answer_id": 37039920, "question_id": 37039855, "link": "https://stackoverflow.com/questions/37039855/to-filter-multiple-columns-with-a-condition-on-the-results/37039920#37039920", "title": "To filter multiple columns with a condition on the results", "body": "<p>based on your sample data and assuming a header row in row 1 and the left column being column A.</p>\n\n<pre><code>=COUNTIF($A$2:A2,A2)\n</code></pre>\n\n<p>place that in F2 and copy down.  Then do a filter on the helper column =1</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6238433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f36e9e3a063d096683d25d6ae56c24?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6238433/james"}, "edited": false, "score": 0, "creation_date": 1462481386, "post_id": 37041244, "comment_id": 61667051, "body": "Thanks for the help. I am having difficulty trying to change the range in your formula. I don&#39;t know how long the sheet will be so I have:    Dim LastRow As Long,      LastRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row       - to get the length. I then try to edit your formula as:              =IFERROR(INDEX(R2C4:R&quot; &amp;LastRow&amp; &quot;C4,SMALL(IF((R2C5:R&quot; &amp;LastRow&amp; &quot;C5&gt;0)  etc.   but I keep getting an error message. Is this the right way to try this?"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "reply_to_user": {"reputation": 3, "user_id": 6238433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f36e9e3a063d096683d25d6ae56c24?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6238433/james"}, "edited": false, "score": 0, "creation_date": 1462483366, "post_id": 37041244, "comment_id": 61667930, "body": "You are mixing up a few things here, and some won&#39;t work this way. A better way would be to make a Named Range for the data (Formulas&gt;Name Manager) and use that name in the formula. The range can be changed there manually, or have it be dynamically calculated like <code>=OFFSET(A2:A200,0,0,COUNTA(A2:A200))</code> for the range of Accounts."}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1462415089, "last_edit_date": 1462415089, "creation_date": 1462414694, "answer_id": 37041244, "question_id": 37039855, "link": "https://stackoverflow.com/questions/37039855/to-filter-multiple-columns-with-a-condition-on-the-results/37041244#37041244", "title": "To filter multiple columns with a condition on the results", "body": "<p>There's a nice but complicated way to do it.</p>\n\n<p>With your original data:\n<a href=\"https://i.stack.imgur.com/J6mRV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J6mRV.png\" alt=\"Sheet view original data\"></a>\nWith changed data:\n<a href=\"https://i.stack.imgur.com/8P6G6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8P6G6.png\" alt=\"Sheet view edited data\"></a></p>\n\n<p>As you can see I've placed your data in <code>A1:E7</code>.\nI use two array formulas, one for the Dealer in <code>G2:G5</code> and one for the Accounts <code>H2:N5</code>. The Dealer formula is vertical, and the Accounts formula is horizontal.</p>\n\n<p>For the dealers put this <strong>array formula</strong> in <code>G2</code> (press <code>Ctrl+Shift+Enter</code> to enter it):</p>\n\n<pre><code>=IFERROR(INDEX($D$2:$D$7,SMALL(IF(($E$2:$E$7&gt;0)*(COUNTIF($G$1:$G1,$D$2:$D$7)=0),ROW($D$2:$D$7)-1),ROW($G$1:$G1))),\"\")\n</code></pre>\n\n<p>Now copy <code>G2</code> down to <code>G3:G5</code> to get the rest of the relevant dealers.</p>\n\n<p>For the accounts put this <strong>array formula</strong> in <code>H2</code>:</p>\n\n<pre><code>=IFERROR(SMALL(IF(($D$2:$D$7=$G2)*(COUNTIF($G2:G2,$A$2:$A$7)=0),$A$2:$A$7),1),\"\")\n</code></pre>\n\n<p>Now copy <code>H2</code> to the right, <code>I2:N2</code>, and down to <code>H3:N5</code>.</p>\n\n<p>To make the first accounts bold I simply make the <code>H</code> column formatted as <strong>Bold</strong>.</p>\n\n<p>You can copy these formulas farther as needed. Note that the locations are important. If you want to place the formulas elsewhere you'll need to change the references accordingly.</p>\n\n<h2>Formulas explained</h2>\n\n<p>What these formulas do is check for your conditions, and then get the smallest value that hasn't been retrieved yet, in the upper / left most cells.</p>\n\n<p>The two formulas are mostly the same, apart from the fact that in the account numbers we can use the actual numbers, and with the dealer we use the row number instead.</p>\n\n<p>The dealer formula from the inside out:</p>\n\n<ol>\n<li>The conditions are set in the <code>IF</code> part of the formula, with a multiplier <code>*</code> as a logical <code>AND</code> (<code>TRUE*TRUE=TRUE FALSE*TRUE=FALSE</code>).</li>\n<li>The first condition in <code>IF(($E$2:$E$7&gt;0)*(COUNTIF($G$1:$G1,$D$2:$D$7)=0),...</code> checks for the row's Total value to be greater than zero, the second condition checks that the dealer is not already present in the <code>G</code> column. The second condition is irrelevant in the first cell, but in the second cell <code>G3</code> it becomes <code>COUNTIF($G$1:$G2,...</code> which returns more than 0 if the dealer already exists, and evaluate to <code>FALSE</code>.</li>\n<li>If the conditions are met the <code>IF</code> returns the dealer's index by using its row minus 1 <code>ROW($D$2:$D$7)-1</code>, which returns 1 for the first etc. as the starting row is 2. Otherwise it returns <code>FALSE</code> which is ignored.</li>\n<li>The <code>SMALL</code> function returns the k-th smallest item. It ignores the <code>FALSE</code> items, and in our case returns the k-th smallest index that meets the conditions (Total>0 and not already present in the results). <code>SMALL(...,ROW($G$1:$G1)</code> in the first cell return the first item. <code>ROW($G$1:$G2)</code> in the second cell <code>G3</code> evaluates to 2 and returns the second smallest item, and so forth.</li>\n<li>The <code>INDEX</code> function simply returns the dealer from the data according to the index.</li>\n<li>And finally, the <code>IFERROR</code> is there only to hide the errors when the end of the results is reached.</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 6238433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f36e9e3a063d096683d25d6ae56c24?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6238433/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 37041244, "answer_count": 2, "score": 0, "last_activity_date": 1462415089, "creation_date": 1462404871, "last_edit_date": 1531161705, "question_id": 37039855, "link": "https://stackoverflow.com/questions/37039855/to-filter-multiple-columns-with-a-condition-on-the-results", "title": "To filter multiple columns with a condition on the results", "body": "<p>I am trying to find a way of highlighting a result with multiple conditions. I have no knowledge of pivot tables. I would rather use a formula or macros. The table is organised by Dealer. </p>\n\n<p>Acc &nbsp;&nbsp;&nbsp;&nbsp; NAME &nbsp; Add &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;Dealer &nbsp;Total<br/>\n68687 &nbsp;  Sara &nbsp;&nbsp; 11 Wood &nbsp; 111A &nbsp; 0<br/>\n68687  &nbsp; Sara &nbsp;&nbsp; 11 Wood &nbsp; 111A &nbsp;&nbsp;0<br/>\n32187  &nbsp; Sara &nbsp;&nbsp; 11 Wood &nbsp; 111A &nbsp; 0<br/>\n12345 &nbsp;  Tom &nbsp;  10 Main &nbsp;&nbsp; 7878C &nbsp;&nbsp;2<br/>\n12345 &nbsp;  Tom  &nbsp; 10 Main &nbsp;&nbsp; 7878C &nbsp;&nbsp;2<br/>\n54321 &nbsp;  Tom  &nbsp; 10 Main &nbsp;&nbsp; 7878C &nbsp;&nbsp;2<br/></p>\n\n<p>My table is similar to the one above. I want to select where the Total is greater than 0 &amp; for each Dealer each unique Account number with the lowest Account number highlighted somehow. </p>\n\n<p>So the results I want for the table above would be: Dealer 7878C, Accounts <strong>12345</strong>, 54321.</p>\n\n<p>12345 being the lower of the two, it is highlighted.</p>\n\n<p>I don't mind copying the results onto another sheet, as I don't want to remove any data from the sheet. I started by just filtering the Totals for >0 and I was thinking of trying to filter for unique values in Account but its the next step that I am stuck on. A countifs formula?</p>\n\n<p>The sheet is quite large and I'm just not sure which is the best way to try and do it.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 1, "creation_date": 1462420427, "post_id": 37039533, "comment_id": 61633177, "body": "@GaryMcParland - You can generate more information for yourself by inserting some <code>debug.print</code> lines. 1) Put an else condition for <code>If FullNameOfFile &lt;&gt; &quot;&quot; Then</code>. After the else put <code>Debug.print cell.address &amp; &quot; failed, appears to have no hyperlink&quot; </code> 2) Put an else condition for <code>If Dir(FullNameOfFile) &lt;&gt; &quot;&quot; Then</code>. After the else put <code>Debug.print cell.address &amp; &quot; failed, appears to have wrong filename&quot;</code> 3) Before <code>With WordApp</code>, put <code>Debug.print cell.address &amp; &quot; should print&quot;</code> The output will appear in the immediate window of the VB Editor. This should help pinpoint what your issues are."}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462426457, "post_id": 37039533, "comment_id": 61634977, "body": "I&#39;ll give this a try. I&#39;m new to this but I think I follow what you mean"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462426371, "post_id": 37042305, "comment_id": 61634934, "body": "No the word docs don&#39;t print okay, if I have 10 links for example only 2 might print... Not even the first 2. I might get 2 and 4 printing or sometimes I&#39;ll only get one printing in total"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "reply_to_user": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462427473, "post_id": 37042305, "comment_id": 61635391, "body": "OK. Are those links are actually correct? Did you try to open them manually? And let us know what is the outcome of the <code>Debug.Print</code> texts so we know why don&#39;t they print. Your code is correct so if the file data in the links are correct, then they should print. One reason that occured to me if the links have URL encoding such as <code>%20</code> instead of <code>&quot; &quot;</code>. This would be a reason for not being able to open the file."}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462430267, "post_id": 37042305, "comment_id": 61636605, "body": "The links are to local word documents located in the same folder as the excel workbook. I&#39;ve tried to put the debug lines in but I&#39;m clearly not doing it right I just keep getting errors... I&#39;m still in the learning phase with this. Any further help would be very much appreciated. I can upload the file with the macro in place some where if that would help"}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462430315, "post_id": 37042305, "comment_id": 61636633, "body": "One other thing I&#39;ve noticed is the word files need to be in .doc as it won&#39;t recognise .docx format"}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462440205, "post_id": 37042305, "comment_id": 61641753, "body": "I cant see it? The last edit I can see was by Om3r 6 hours ago?"}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462441441, "post_id": 37042305, "comment_id": 61642570, "body": "I&#39;ve added in the debug lines and its not giving errors any more. I had to delete the last two End If lines at the end to avoid a compile error. But, its now only printing the first link. After the first link it stops? what do i need to do to make it keep searching to the end of the document?"}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462484313, "post_id": 37042305, "comment_id": 61668353, "body": "Ok. I&#39;ve added in the code you edited with the debug lines. Thanks you I now understand what you meant. When I run the Macro I still get the same this it only prints one file not them all. I have discovered it only prints the file when I have the cell selected so that is why it was printing random files and not them all because I had say the second or third cell selected so it was sending that one to the printer. The code isn&#39;t cycling onto the next file then the next until it finds empty cells - Is there a way to incorporate this?"}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462484630, "post_id": 37042305, "comment_id": 61668512, "body": "I&#39;ve uploaded a sample sheet to dropbox with the Macro enabled. If you link a few word documents to the &#39;View Map&#39; text then select the &#39;Print All Maps&#39; button it will execute the macro and you may see what I mean. Thanks again for all your help on here so far! link below: <a href=\"https://www.dropbox.com/s/oht7hl8di07nwfh/Macro%20Test.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/oht7hl8di07nwfh/Macro%20Test.xlsm?dl=0</a>"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "reply_to_user": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462489285, "post_id": 37042305, "comment_id": 61670247, "body": "Alright. I see your macro and the document. Right now the way you have it is that it cycles through the selected cells. What is exactly that you want to achieve? This is where you set where the macro is looking and these are the cells it loops through: <code>Set rng = Selection</code> See my code, updated, this now has <code>Set rng = Range(&quot;A4:A200&quot;)</code> and this will loop through all the cells in this range, regardless of selection."}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462559291, "post_id": 37042305, "comment_id": 61703047, "body": "Getting somewhere!! So if the range is left at Selection and I highlight the A column it works perfectly. I&#39;d like it to work without having to select the A column... When I change rng = Range(&quot;A4:A200&quot;) I get an automation error: Run-time error &#39;-2147417848 (80010108)&#39;: Automation Error the object invoked has disconnected from its clients. When I select debug it highlights &#39;MyDoc.PrintOut&#39; which is just above the line &#39;.ActiveWindow.Close SaveChanges:=False&#39;"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "reply_to_user": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462560183, "post_id": 37042305, "comment_id": 61703531, "body": "Ok, let&#39;s see. First, let&#39;s delete some of this comments as it is hard to see where we are at. It seems that this error message relates to the actual file, not the rest of the code. You could change the <code>WordApp.Visible = False</code> to <code>True</code> for the time being and see what takes place when the error happens. You could change the line to <code>Set rng=Range(&quot;A:A&quot;)</code> though I don&#39;t think that is directly contributing to the error you just wrote."}, {"owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 1, "creation_date": 1462612600, "post_id": 37042305, "comment_id": 61717497, "body": "Ive set the range to A1:A100 and set wordapp.Visible = True and its working perfectly!! You my friend have been fantastic help, it was really bugging me!! The only thing is the word application stays open after printing although its minimised so its not a big issue. Thanks Again!!!"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "reply_to_user": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "edited": false, "score": 0, "creation_date": 1462662071, "post_id": 37042305, "comment_id": 61732798, "body": "Great. I am glad, don&#39;t forget to accept the answer and upvote it if it helped you. On Word staying open, the you can add this line before the <code>Set WordApp = Nothing</code> line to close Word: <code>WordApp.Quit SaveChanges:=wdDoNotSaveChanges</code> I also added this to the code above. Also you should comment out the <code>Debug</code> lines so they are not executed every time, they are for debug purposes only."}], "tags": [], "owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "is_accepted": false, "score": 0, "last_activity_date": 1462662142, "last_edit_date": 1462662142, "creation_date": 1462422142, "answer_id": 37042305, "question_id": 37039533, "link": "https://stackoverflow.com/questions/37039533/excel-macro-to-print-hyperlinked-word-documents/37042305#37042305", "title": "Excel Macro to print Hyperlinked word documents", "body": "<p>So as I understand from your post, the DOC files print okay.</p>\n\n<p>An approach you can use to print the ODS documents is to use the command line to get OpenOffice to print the document. As shown on this site:\n<a href=\"https://wiki.openoffice.org/wiki/Documentation/FAQ/General/Is_there_a_way_to_print_a_batch_of_files_without_opening_each_of_them_in_OOo%3F\" rel=\"nofollow\">https://wiki.openoffice.org/wiki/Documentation/FAQ/General/Is_there_a_way_to_print_a_batch_of_files_without_opening_each_of_them_in_OOo%3F</a></p>\n\n<pre><code>OfficeID = Shell \"openoffice -pt \"\"PRINTER-NAME\"\" FILENAME\"\n</code></pre>\n\n<p>If the application does not exit after it finishes, you can use the OfficeID to terminate the process. For example with <code>Shell \"TASKKILL /PID \" &amp; CStr(OfficeID)</code>.</p>\n\n<p>Note: I have not tried this myself, but should get you started.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here is the code that I tried to edit but some reviewers who did not read the post reverted it, this is why you did not see it, this is the correct way to add the <code>Debug</code> lines:</p>\n\n<pre><code>Sub ExportToWordAndPrint()\n\nConst Ttl As String = \"Word Print\"\nDim cell As Range, rng As Range\nDim FullNameOfFile As String\nDim WordApp As Object, MyDoc As Object\n\nOn Error Resume Next\n    Set WordApp = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then Set WordApp = CreateObject(\"Word.Application\")\nOn Error GoTo 0\n\nIf WordApp Is Nothing Then\n    MsgBox \"Microsoft Word is not installed on this computer - operation cancelled.\", vbCritical + vbOKOnly, Ttl\n    Exit Sub\nEnd If\n\nWordApp.Visible = False\nSet rng = Range(\"A4:A200\")\n\nFor Each cell In rng\n\n    On Error Resume Next\n        FullNameOfFile = \"\"\n        FullNameOfFile = cell.Hyperlinks(1).Address\n    On Error GoTo 0\n\n    If FullNameOfFile &lt;&gt; \"\" Then 'cell may not have contained a Hyperlink\n\n        If Dir(FullNameOfFile) &lt;&gt; \"\" Then 'cell may contain a Hyperlink, but the file itself may not exist\n\n            'Debug.print cell.address &amp; \" should print\"    'THIS ONE ADDED\n            With WordApp\n                Set MyDoc = .documents.Open(Filename:=FullNameOfFile)\n                MyDoc.PrintOut\n                .ActiveWindow.Close SaveChanges:=False\n            End With\n        Else         'THIS ONE ADDED\n            'Debug.print cell.address &amp; \" failed, appears to have wrong filename\" \n        End If\n    Else             'THIS ONE ADDED\n        'Debug.print cell.address &amp; \" failed, appears to have no hyperlink\"    \n    End If\n\nNext cell\n\nWordApp.Quit SaveChanges:=wdDoNotSaveChanges\nSet WordApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6293137, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208963202535860/picture?type=large", "display_name": "Gary McParland", "link": "https://stackoverflow.com/users/6293137/gary-mcparland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2408, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1462662142, "creation_date": 1462403007, "last_edit_date": 1462567124, "question_id": 37039533, "link": "https://stackoverflow.com/questions/37039533/excel-macro-to-print-hyperlinked-word-documents", "title": "Excel Macro to print Hyperlinked word documents", "body": "<p>I'm trying to create a macro to print all hyperlinked word documents on an active spreadsheet. </p>\n\n<p>Cells A1:A200 contain hyperlinks. I want to open a hidden Word application - check cell A1 for hyper link - if present open link - print document - close document - move to next cell A2 - Check for hyperlink in A2 etc... close hidden word application at the end. If the cell contains no hyperlink move to the next cell with out any error.</p>\n\n<p>I've toyed around and I'm not getting very far so I'm hoping someone will be able to help me out.</p>\n\n<p>Not all documents are word some are open office .ods files so if I could open the hyperlink and print with the native program then close that would be even better but I'm happy to convert all .ods to .doc to make it work if easier.</p>\n\n<p>Thanks!</p>\n\n<p>Edit: This code will only print random links not all.</p>\n\n<pre><code>Sub ExportToWordAndPrint()\n\nConst Ttl As String = \"Word Print\"\nDim cell As Range, rng As Range\nDim FullNameOfFile As String\nDim WordApp As Object, MyDoc As Object\n\nOn Error Resume Next\n    Set WordApp = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then Set WordApp = CreateObject(\"Word.Application\")\nOn Error GoTo 0\n\nIf WordApp Is Nothing Then\n    MsgBox \"Microsoft Word is not installed on this computer - operation cancelled.\", vbCritical + vbOKOnly, Ttl\n    Exit Sub\nEnd If\n\nWordApp.Visible = False\nSet rng = Selection\n\nFor Each cell In rng\n\n    On Error Resume Next\n        FullNameOfFile = \"\"\n        FullNameOfFile = cell.Hyperlinks(1).Address\n    On Error GoTo 0\n\n    If FullNameOfFile &lt;&gt; \"\" Then 'cell may not have contained a Hyperlink\n\n        If Dir(FullNameOfFile) &lt;&gt; \"\" Then 'cell may contain a Hyperlink, but the file itself may not exist\n\n            With WordApp\n                Set MyDoc = .documents.Open(Filename:=FullNameOfFile)\n                MyDoc.PrintOut\n                .ActiveWindow.Close SaveChanges:=False\n            End With\n\n        End If\n\n    End If\n\nNext cell\n\nSet WordApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Edit to Code to input debug line. The two End If lines have been deleted above Next Cell to avoid a compile error.</p>\n\n<pre><code>Sub ExportToWordAndPrint()\n\nConst Ttl As String = \"Word Print\"\nDim cell As Range, rng As Range\nDim FullNameOfFile As String\nDim WordApp As Object, MyDoc As Object\n\nOn Error Resume Next\n    Set WordApp = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then Set WordApp = CreateObject(\"Word.Application\")\nOn Error GoTo 0\n\nIf WordApp Is Nothing Then\n    MsgBox \"Microsoft Word is not installed on this computer - operation cancelled.\", vbCritical + vbOKOnly, Ttl\n    Exit Sub\nEnd If\n\nWordApp.Visible = False\nSet rng = Selection\n\nFor Each cell In rng\n\n    On Error Resume Next\n        FullNameOfFile = \"\"\n        FullNameOfFile = cell.Hyperlinks(1).Address\n    On Error GoTo 0\n\n    If FullNameOfFile &lt;&gt; \"\" Then Debug.Print cell.Address &amp; \" failed, appears to have no hyperlink\"\n\n        If Dir(FullNameOfFile) &lt;&gt; \"\" Then Debug.Print cell.Address &amp; \" failed, appears to have wrong filename\"\n\n                Debug.Print cell.Address &amp; \" should print\"\n\n            With WordApp\n                Set MyDoc = .documents.Open(Filename:=FullNameOfFile)\n                MyDoc.PrintOut\n                .ActiveWindow.Close SaveChanges:=False\n            End With\n\n    Next cell\n\nSet WordApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The first link is now printing only not the rest. Is the problem that I haven't selected a range? Not sure where to put this in?</p>\n\n<p>Thanks for the help everyone!</p>\n"}, {"tags": ["javascript", "excel", "vba"], "comments": [{"owner": {"reputation": 4094, "user_id": 112534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54ff84bd8649467f5377df2c1af1c433?s=128&d=identicon&r=PG", "display_name": "lauriys", "link": "https://stackoverflow.com/users/112534/lauriys"}, "edited": false, "score": 0, "creation_date": 1462402321, "post_id": 37039380, "comment_id": 61628686, "body": "Can you provide example code?"}], "answers": [{"tags": [], "owner": {"reputation": 1566, "user_id": 5398254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fDH4C.jpg?s=128&g=1", "display_name": "Rhys Bradbury", "link": "https://stackoverflow.com/users/5398254/rhys-bradbury"}, "is_accepted": false, "score": 1, "last_activity_date": 1462402528, "creation_date": 1462402528, "answer_id": 37039457, "question_id": 37039380, "link": "https://stackoverflow.com/questions/37039380/return-id-of-html-object/37039457#37039457", "title": "Return ID of HTML Object", "body": "<p>Use <code>.id</code>. \nJust like how you would use <code>.innerText</code></p>\n"}], "owner": {"reputation": 19, "user_id": 6282722, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/78e345dba7d9c4742ee54856ca143f40?s=128&d=identicon&r=PG&f=1", "display_name": "antd", "link": "https://stackoverflow.com/users/6282722/antd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462403820, "creation_date": 1462402146, "question_id": 37039380, "link": "https://stackoverflow.com/questions/37039380/return-id-of-html-object", "title": "Return ID of HTML Object", "body": "<p>Currently I am using VBA and excel to automate some webpage functionality. I am able to export all the values I want using the .innerText function, but I wanted to know if was possible to return the html ID name? I need to keep track of the ID so that I can call the ID with a click function later on once data has been validated. Is this possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1462400488, "post_id": 37039005, "comment_id": 61628102, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2656443/vba-excel-macro-use-range-to-act-on-a-different-worksheet\">VBA Excel macro: use Range to act on a different worksheet</a>"}, {"owner": {"reputation": 569, "user_id": 6114643, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HwrTq.png?s=128&g=1", "display_name": "T-T", "link": "https://stackoverflow.com/users/6114643/t-t"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1462400846, "post_id": 37039005, "comment_id": 61628223, "body": "Sorry, but how&#39;s my post duplicate to that one? I checked out that post but I don&#39;t see a solution to my question."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 5, "creation_date": 1462400971, "post_id": 37039005, "comment_id": 61628257, "body": "Maybe he meant the missing <code>ws.</code> at the start of the line <code>Cells.Replace What:=&quot;#NUM!&quot;, Replacement:=&quot;&quot;</code>?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 4, "creation_date": 1462401573, "post_id": 37039005, "comment_id": 61628466, "body": "As @Ralph says, you&#39;re missing the <code>ws.</code> before <code>Cells</code>. Voting to close the as being the result of a simple typographic error."}, {"owner": {"reputation": 569, "user_id": 6114643, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HwrTq.png?s=128&g=1", "display_name": "T-T", "link": "https://stackoverflow.com/users/6114643/t-t"}, "edited": false, "score": 0, "creation_date": 1462460731, "post_id": 37039005, "comment_id": 61655006, "body": "Ralph and Ken are right. Thanks for the help!"}], "owner": {"reputation": 569, "user_id": 6114643, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HwrTq.png?s=128&g=1", "display_name": "T-T", "link": "https://stackoverflow.com/users/6114643/t-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462477505, "creation_date": 1462400179, "last_edit_date": 1531164843, "question_id": 37039005, "link": "https://stackoverflow.com/questions/37039005/vba-cant-loop-through-all-worksheets", "title": "VBA Can&#39;t Loop Through All Worksheets", "body": "<p>I'm new to VBA, and I got stuck with a simple problem. I want to select all cells with data in the worksheet, paste them by value, then replace \"#NUM!\" with \"\"(nothing) and repeat all the above steps in all worksheets. The issue is that it wouldn't loop through all worksheets. Please help. </p>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Sheets\n\n'Select all, copy and paste-by-value\nws.Range(\"A1\").CurrentRegion.Value = ws.Range(\"A1\").CurrentRegion.Value\n\n'Find and Replace\nCells.Replace What:=\"#NUM!\", Replacement:=\"\"\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462403102, "post_id": 37039004, "comment_id": 61628934, "body": "Should this <code>yyyymmdd_hhnnss</code> be this <code>yyyymmdd_hhmmss</code>? Try defining a string that will contain the full filename and debug print the filename."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462403830, "post_id": 37039004, "comment_id": 61629146, "body": "I switched it but still no luck.. it&#39;s the weirdest thing, the script runs and excel does what it has to (I monitor in task manager) but it doesn&#39;t seem to complete the save and close the application. I&#39;ll do that now, thanks @OldUgly"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462404028, "post_id": 37039004, "comment_id": 61629203, "body": "What does SiteIdentifier evaluate to? Will it contribute to an invalid file name?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462404216, "post_id": 37039004, "comment_id": 61629260, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/zw949162(v=vs.90).aspx\" rel=\"nofollow noreferrer\">See this</a> - is the length of full filename (including path) longer than 218 characters?"}, {"owner": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 3, "creation_date": 1462429085, "post_id": 37039004, "comment_id": 61636018, "body": "Comment out the <code>On Error Resume Next</code> line for the time being and see if you are getting any error messages."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1462441182, "post_id": 37039004, "comment_id": 61642410, "body": "Remove the <code>Set</code> before &#39;SiteIdentifier&#39; so it reads <code>SiteIdentifier = objSheet.Cells(&quot;B4&quot;).Value</code>"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462453843, "post_id": 37039004, "comment_id": 61650266, "body": "@OldUgly SiteIdentifier is a 4 character string. The path length is well under 218 characters (98)."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 0, "creation_date": 1462457184, "post_id": 37039004, "comment_id": 61652657, "body": "@SearchAndResQ thank you! I got &quot;Variable is undefined: Format&quot; which lead me to believe that Format isn&#39;t a vbs function. I fixed the date/time stamp. But the reference to my cell isn&#39;t working"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1462457207, "post_id": 37039004, "comment_id": 61652675, "body": "@JordanBiddlecombe I removed the Set but that&#39;s just giving me an &quot;Invalid procedure&quot; error"}], "answers": [{"comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 3, "creation_date": 1462461167, "post_id": 37053624, "comment_id": 61655303, "body": "If you&#39;re looking for a why, its because the <code>Set</code> function is used for objects/ranges, not strings. When setting string values you just use an <code>=</code>; alternatively you could have done <code>Set SiteIdentifier = objSheet.Cells(4, 2)</code> and then used <code>SiteIdentifier.Value</code> in your <code>SaveAs</code> statement."}], "tags": [], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "is_accepted": false, "score": 0, "last_activity_date": 1462459646, "creation_date": 1462459646, "answer_id": 37053624, "question_id": 37039004, "link": "https://stackoverflow.com/questions/37039004/vbs-to-save-with-cell-reference-and-timestamp/37053624#37053624", "title": "VBS to save with cell reference and timestamp", "body": "<p>Thank you all for your advices, helped me see what my errors were. Posting the answer for closure. </p>\n\n<pre><code>Option Explicit\n\nExcelMacroExample\n\nSub ExcelMacroExample() \n\n  Dim objApp  \n  Dim objExcel  \n  Dim objWorkbook\n  Dim objSheet\n  Dim SiteIdentifier\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\midi\\Desktop\\EN\\SCORES.xlsm\")\nSet objSheet = objWorkbook.Worksheets(\"Cover Tab\") \n\nSiteIdentifier = objSheet.Cells(4, 2).Value\n\n objExcel.Run \"RefreshConns\"\n    WScript.Sleep 60000 \n\n objExcel.ActiveWorkbook.SaveAs \"C:\\Users\\midi\\Desktop\\EN\\SCORES_\" &amp; SiteIdentifier &amp; \"_\" &amp; Year(Now()) &amp; Month(Now()) &amp; Day(Now()) &amp; \"_\" &amp; Hour(Now()) &amp; Minute(Now()) &amp; Second(Now())&amp;\".xlsm\", 52\n\n objExcel.ActiveWorkbook.Close\n\n objExcel.Quit   \n\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462459646, "creation_date": 1462400172, "last_edit_date": 1531161705, "question_id": 37039004, "link": "https://stackoverflow.com/questions/37039004/vbs-to-save-with-cell-reference-and-timestamp", "title": "VBS to save with cell reference and timestamp", "body": "<p>I have a vb script which executes an excel macro and saves the file appending the name with a specific cell value and a timestamp as well. But it's not working and i'm totally lost as to the reason.</p>\n\n<p>If i take out the cell reference and timestamp pieces out, it executes and saves correctly. Any help or material i can review would be greatly appreciated. Thanks in advance.</p>\n\n<pre><code>Option Explicit\n\nOn Error Resume Next\n\nExcelMacroExample\n\nSub ExcelMacroExample() \n\nDim objApp  \nDim objExcel  \nDim objWorkbook\nDim objSheet\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\midi\\Desktop\\EN\\SCORES.xlsm\")\nSet objSheet = objWorkbook.Worksheets(\"Cover Tab\") \nSet SiteIdentifier = objSheet.Cells(\"B4\").Value  \n\nobjExcel.Run \"RefreshConns\"\nWScript.Sleep 30000 \n\nobjExcel.ActiveWorkbook.SaveAs \"C:\\Users\\midi\\Desktop\\EN\\SCORES_\" &amp; SiteIdentifier &amp; \"_\"&amp; Format(Now(), \"yyyymmdd_hhnnss\") &amp; \".xlsm\", 52\n\nobjExcel.ActiveWorkbook.Close\n\nobjExcel.Quit   \n\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462403827, "post_id": 37038865, "comment_id": 61629145, "body": "Not clear what you are looking for, but maybe this will point out something for you ... Record a macro: Step 1- use the drawing shapes to make a small diagram. Step 2- select all of the shapes and copy. Step3- PasteSpecial and select the as PNG option. Stop macro recording. Check out the macro code for pointers.  ... This is all contained in the worksheet."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1462425251, "post_id": 37038865, "comment_id": 61634545, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18232987/export-pictures-from-excel-file-into-jpg-using-vba\" title=\"export pictures from excel file into jpg using vba\">stackoverflow.com/questions/18232987/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/25333558/export-pictures-excel-vba\" title=\"export pictures excel vba\">stackoverflow.com/questions/25333558/export-pictures-excel-v&zwnj;&#8203;ba</a>"}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1462564609, "post_id": 37038865, "comment_id": 61705672, "body": "Thanks @Patrick, the link you provided gave me the Chart object as a picture surface that can be saved to an image file using the .Chart.Export function. Now I just need to find out how to draw (using vba) lines,polygons and text on it."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1462749994, "post_id": 37038865, "comment_id": 61753811, "body": "I suppose you can try with the Chart object, <code>.Shapes.AddTextbox</code> or something. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841018(v=office.14).aspx\" rel=\"nofollow noreferrer\">MSDN Shapes</a>"}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1469972470, "post_id": 37038865, "comment_id": 64748319, "body": "Hi, Patrick,  I&#39;ve been using the chart object as you suggested. It has been great ! I&#39;m even using .Chart.PrintOut to print directly to my sticker printer. I dynamically add textboxes/shapes and image to it and reshape to match the aspect ration of the stickers. The user can even fine tune the positioning before printing. So much easier than using a GDI drawing surface !"}], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1721, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462399428, "creation_date": 1462399428, "question_id": 37038865, "link": "https://stackoverflow.com/questions/37038865/excel-vba-drawing-text-lines-and-polygons-on-imageor-shape-object-then-saving-as", "title": "Excel vba drawing text,lines and polygons on imageor shape object then saving as bitmap or png file", "body": "<p>I'm in an excel vba program and I need to display and create a label for a printer.</p>\n\n<p>Now this printer (Zebra Z4M Plus 300 dpi) is extremely fussy and hard to use.\nI can now print to it if I create an image file (png or img) of dimensions 944x406 and put my desired label in an area of 797x396 in the upper left corner of that image file.</p>\n\n<p>My question is about creating said image.</p>\n\n<p>Some 10 years ago I remember that it was possible (in probably vb6) to use image primitives such as lines, polygons, circles and text to a picturebox control.</p>\n\n<p>In Excel I have created a form and created an image control however a look at the functions and properties of this object didn't reveal any function for drawing anything on it ! </p>\n\n<p>(P.S.  I have now found that this image object has a .picture property, this property has a .handle property and .render function, I must be close to something usable but I can't find it. It seems I could load a picture from a picture file using the LoadPicture function on this picture property) </p>\n\n<p>(Perhaps there are windows api function that will let me draw on this .picture using the .picture.handle ?)</p>\n\n<p>The excel Shape object also didn't have drawing primitives but it did have a .CopyPicture function that would allow me to put the contained image in the clipboard (and then I just need to find a way to save the clipboard content to an image file)</p>\n\n<p>If possible I would like to draw to an object which is contained in the worksheet rather than in a userform.</p>\n\n<p>I am looking for further search keywords, names of objects and function for drawing.</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 1, "creation_date": 1462398945, "post_id": 37038525, "comment_id": 61627486, "body": "First you should determine the splitting rule. Is it always before the last letter? Is it the 3rd space? Is it the 17th character? Is it just this one string you want to split or are there others that should be split as well - with what common rule? If you cannot define a rule it will be impossible to automate."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462399648, "post_id": 37038525, "comment_id": 61627789, "body": "It looks like a good rule would be everything after the number? Please confirm if that will work and then this can be easily accomplished."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462399686, "post_id": 37038525, "comment_id": 61627808, "body": "Also, why are there blank rows in your sample results?"}, {"owner": {"reputation": 5, "user_id": 6292910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820cba5ace705c768a281f9f2fe7a75f?s=128&d=identicon&r=PG&f=1", "display_name": "ShilpiT", "link": "https://stackoverflow.com/users/6292910/shilpit"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462453797, "post_id": 37038525, "comment_id": 61650229, "body": "@tigeravatar Yes that is exactly what I want. I apologise for my oversight. Please ignore the blank rows."}, {"owner": {"reputation": 5, "user_id": 6292910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820cba5ace705c768a281f9f2fe7a75f?s=128&d=identicon&r=PG&f=1", "display_name": "ShilpiT", "link": "https://stackoverflow.com/users/6292910/shilpit"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462454225, "post_id": 37038525, "comment_id": 61650539, "body": "@tigeravatar Yes I thought that splitting the text after the numbers would work. But I have been unsuccessful in doing so"}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1462399088, "creation_date": 1462399088, "answer_id": 37038804, "question_id": 37038525, "link": "https://stackoverflow.com/questions/37038525/split-column-text-to-adjacent-columns-using-excel-vba/37038804#37038804", "title": "Split column text to adjacent columns using Excel VBA", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow\">Instr</a>(cellValue,\" \")\nwill give you the position of your first space</p>\n\n<pre><code>firstPos = instr(cellValue,\" \")  ' first space\nsecondPos = instr(firstPos + 1, cellValue, \" \") ' second space\n</code></pre>\n\n<p>etc..</p>\n\n<p>or </p>\n\n<p>followed by <a href=\"https://msdn.microsoft.com/en-us/library/05e63829(v=vs.90).aspx\" rel=\"nofollow\">mid</a>, and <a href=\"https://msdn.microsoft.com/en-us/library/bt3szac5(v=vs.90).aspx\" rel=\"nofollow\">replace</a></p>\n\n<pre><code>secondColumnValue = mid(cellValue, thirdPos + 1)\nfirstColumnValue = replace(cellValue, secondColumnValue, \"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6292910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820cba5ace705c768a281f9f2fe7a75f?s=128&d=identicon&r=PG&f=1", "display_name": "ShilpiT", "link": "https://stackoverflow.com/users/6292910/shilpit"}, "edited": false, "score": 0, "creation_date": 1462463722, "post_id": 37053311, "comment_id": 61656998, "body": "Thanks @user3598756! This helps me so much. much appreciated"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1462458716, "creation_date": 1462458716, "answer_id": 37053311, "question_id": 37038525, "link": "https://stackoverflow.com/questions/37038525/split-column-text-to-adjacent-columns-using-excel-vba/37053311#37053311", "title": "Split column text to adjacent columns using Excel VBA", "body": "<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim cell As Range\nDim strng As Variant\nDim rightStrng As String\nDim i As Long\n\nWith Worksheets(\"multimanager\") '&lt;== change it as per your needs\n    For Each cell In .Columns(\"A\").SpecialCells(xlCellTypeConstants, xlTextValues) 'assuming that \"column containing texts\" is column \"A\"\n        strng = Split(cell)\n        rightStrng = \"\"\n        i = UBound(strng)\n        Do While Not IsNumeric(strng(i)) And i &gt; 0\n            rightStrng = strng(i) &amp; \" \" &amp; rightStrng\n            i = i - 1\n        Loop\n        If IsNumeric(strng(i)) Then\n            rightStrng = Application.WorksheetFunction.Trim(rightStrng)\n            cell.Offset(, 2) = rightStrng\n            cell.Offset(, 1) = Left(cell.Value, IIf(rightStrng &lt;&gt; \"\", InStrRev(cell.Value, rightStrng) - 2, Len(cell.Value)))\n        End If\n    Next cell\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6292910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820cba5ace705c768a281f9f2fe7a75f?s=128&d=identicon&r=PG&f=1", "display_name": "ShilpiT", "link": "https://stackoverflow.com/users/6292910/shilpit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 37053311, "answer_count": 2, "score": 0, "last_activity_date": 1462623624, "creation_date": 1462398017, "last_edit_date": 1462623624, "question_id": 37038525, "link": "https://stackoverflow.com/questions/37038525/split-column-text-to-adjacent-columns-using-excel-vba", "title": "Split column text to adjacent columns using Excel VBA", "body": "<p>I have an Excel sheet with a column containing texts like \"Hello there 2005 A\" I want to split this text in between two columns, one containing 'Hello there 2005' and the other saying 'A'.</p>\n\n<p>I have tried Split function in VBA, but I can't make it loop through the entire column or even come up with a delimeter which will split exactly before the letter 'A'.</p>\n\n<p>Results should look something like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ySxCm.jpg\" alt=\"Results\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1462396069, "post_id": 37038008, "comment_id": 61626156, "body": "Please show your code."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462463789, "post_id": 37038008, "comment_id": 61657039, "body": "Sorry about that. When I asked this question I was being pressured to make a meeting but wanted to see if anyone could understand what I was after. After looking into this I finally came up with a better way to accomplish this and will share it below  [ Range(&quot;H2&quot;).Select         ActiveCell.FormulaR1C1 = _         &quot;=VLOOKUP(RC[-2], &#39;V:\\Diecutter&#91;fundraisingdies.xlsx]Sheet1&#39;!R2C[-7]:R100C&zwnj;&#8203;[-6], 2, FALSE)&quot; ]"}], "answers": [{"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1462404932, "creation_date": 1462404932, "answer_id": 37039871, "question_id": 37038008, "link": "https://stackoverflow.com/questions/37038008/search-column-in-one-excel-workbook-to-paste-adjacent-cells-value-into-active-v/37039871#37039871", "title": "Search column in one Excel workbook to paste Adjacent Cell&#39;s Value into active VBA script", "body": "<pre><code>VALUE = WorksheetFunction.VLookup(theString, Workbooks(\"Workbook1\").Worksheets(\"Sheet1\").Range(\"A:B\"), 2)\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462464507, "creation_date": 1462395987, "last_edit_date": 1462464507, "question_id": 37038008, "link": "https://stackoverflow.com/questions/37038008/search-column-in-one-excel-workbook-to-paste-adjacent-cells-value-into-active-v", "title": "Search column in one Excel workbook to paste Adjacent Cell&#39;s Value into active VBA script", "body": "<p>I have Workbook1 and Workbook2 and need to search column A in Workbook1 for specific string value and then copy adjacent cell that is in column B of Workbook1 to the macro being run where I need to insert the value in the following formula in VBA script: =(ROUNDUP((F2+40)/[VALUE],0))*[VALUE]. The [VALUE] = the value taken from the adjacent cell in column B from Workbook1. Workbook2 is where the macro is running on.</p>\n\n<p>I am being rushed at the moment and if this is not clear enough. I will come back and clarify as needed.</p>\n"}, {"tags": ["vba", "excel", "csv", "export-to-csv"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 3, "creation_date": 1462396246, "post_id": 37037934, "comment_id": 61626248, "body": "I think you would need to create a workbook, copy your sheet over, save as csv and close the workbook."}, {"owner": {"reputation": 20003, "user_id": 10335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/af44f496fec83ffbb8283b4c7122b246?s=128&d=identicon&r=PG", "display_name": "neves", "link": "https://stackoverflow.com/users/10335/neves"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462396515, "post_id": 37037934, "comment_id": 61626351, "body": "@gtwebb: can you help me? My vba knowledge is really rudimentary."}, {"owner": {"reputation": 798, "user_id": 4005915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/631230112/picture?type=large", "display_name": "Nathan Clement", "link": "https://stackoverflow.com/users/4005915/nathan-clement"}, "edited": false, "score": 1, "creation_date": 1462396926, "post_id": 37037934, "comment_id": 61626554, "body": "Use the 2nd answer by &quot;SeanC&quot; in this question: <a href=\"http://stackoverflow.com/questions/26178913/saving-excel-worksheet-to-csv-with-file-name-from-a-cell-using-a-macro?rq=1\" title=\"saving excel worksheet to csv with file name from a cell using a macro\">stackoverflow.com/questions/26178913/&hellip;</a>"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462400308, "post_id": 37037934, "comment_id": 61628050, "body": "Don&#39;t use the workbook functionality. <a href=\"http://stackoverflow.com/questions/8419828/how-to-create-a-separate-csv-file-from-vba\">Create and write a text file</a> as per Tony Dallimore&#39;s answer."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1566920912, "post_id": 37037934, "comment_id": 101803436, "body": "Try this <a href=\"https://exceldevelopmentplatform.blogspot.com/2019/08/vba-export-worksheet-to-csv.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2019/08/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 738, "user_id": 1964474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w35vM.jpg?s=128&g=1", "display_name": "andQlimax", "link": "https://stackoverflow.com/users/1964474/andqlimax"}, "edited": false, "score": 0, "creation_date": 1595524720, "post_id": 37038399, "comment_id": 111512594, "body": "If I need CSV in UTF8 format, why some excel version doesn&#39;t support it? Ot seems strange and a big issue"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 34, "last_activity_date": 1462397465, "creation_date": 1462397465, "answer_id": 37038399, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/37038399#37038399", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>@NathanClement was a bit faster. Yet, here is the complete code (slightly more elaborate):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ExportWorksheetAndSaveAsCSV()\n\nDim wbkExport As Workbook\nDim shtToExport As Worksheet\n\nSet shtToExport = ThisWorkbook.Worksheets(\"Sheet1\")     'Sheet to export as CSV\nSet wbkExport = Application.Workbooks.Add\nshtToExport.Copy Before:=wbkExport.Worksheets(wbkExport.Worksheets.Count)\nApplication.DisplayAlerts = False                       'Possibly overwrite without asking\nwbkExport.SaveAs Filename:=\"C:\\tmp\\test.csv\", FileFormat:=xlCSV\nApplication.DisplayAlerts = True\nwbkExport.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 992, "user_id": 2452630, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6454bbba0b4c8585449bd01a4c164500?s=128&d=identicon&r=PG", "display_name": "KuN", "link": "https://stackoverflow.com/users/2452630/kun"}, "edited": false, "score": 2, "creation_date": 1486538262, "post_id": 37038840, "comment_id": 71382891, "body": "1. <code>TempWB.Close False</code> should be <code>TempWB.Close SaveChanges:=False</code>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838613.aspx\" rel=\"nofollow noreferrer\">docs</a>     3. Change the <code>5</code> in <code>Left(CurrentWB.Name, Len(CurrentWB.Name) - 5)</code> will make it work with .xls <a href=\"https://msdn.microsoft.com/en-us/library/y050k1wb(v=vs.90).aspx\" rel=\"nofollow noreferrer\">docs</a> Maybe we shall use regex to remove the file extension but seems too much work for a throw-away script"}, {"owner": {"reputation": 20003, "user_id": 10335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/af44f496fec83ffbb8283b4c7122b246?s=128&d=identicon&r=PG", "display_name": "neves", "link": "https://stackoverflow.com/users/10335/neves"}, "reply_to_user": {"reputation": 992, "user_id": 2452630, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6454bbba0b4c8585449bd01a4c164500?s=128&d=identicon&r=PG", "display_name": "KuN", "link": "https://stackoverflow.com/users/2452630/kun"}, "edited": false, "score": 0, "creation_date": 1486558816, "post_id": 37038840, "comment_id": 71396213, "body": "@KuN: What the change in TempWB.close does?"}, {"owner": {"reputation": 992, "user_id": 2452630, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6454bbba0b4c8585449bd01a4c164500?s=128&d=identicon&r=PG", "display_name": "KuN", "link": "https://stackoverflow.com/users/2452630/kun"}, "edited": false, "score": 0, "creation_date": 1486586753, "post_id": 37038840, "comment_id": 71414586, "body": "I think that&#39;s a &quot;lost-in-the-translation&quot; issue, if you look into the docs link i provided or in @Raplh&#39;s answer, you shall see that&#39;s the right way to call <code>Workbook.Close</code>"}, {"owner": {"reputation": 2462, "user_id": 1553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696d2c42f47b2782046a3624359d73ad?s=128&d=identicon&r=PG", "display_name": "Craig Lambie", "link": "https://stackoverflow.com/users/1553326/craig-lambie"}, "edited": false, "score": 0, "creation_date": 1513757295, "post_id": 37038840, "comment_id": 82769333, "body": "This is great, I just added one little thing, the pastespecial xlPasteFormats so my dates stay as dates :D  <code>With TempWB.Sheets(1).Range(&quot;A1&quot;)         .PasteSpecial xlPasteValues         .PasteSpecial xlPasteFormats     End With</code>"}, {"owner": {"reputation": 20003, "user_id": 10335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/af44f496fec83ffbb8283b4c7122b246?s=128&d=identicon&r=PG", "display_name": "neves", "link": "https://stackoverflow.com/users/10335/neves"}, "reply_to_user": {"reputation": 2462, "user_id": 1553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696d2c42f47b2782046a3624359d73ad?s=128&d=identicon&r=PG", "display_name": "Craig Lambie", "link": "https://stackoverflow.com/users/1553326/craig-lambie"}, "edited": false, "score": 0, "creation_date": 1513796833, "post_id": 37038840, "comment_id": 82793271, "body": "great tip @CraigLambie, just added it to the original code"}, {"owner": {"reputation": 738, "user_id": 1964474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w35vM.jpg?s=128&g=1", "display_name": "andQlimax", "link": "https://stackoverflow.com/users/1964474/andqlimax"}, "edited": false, "score": 0, "creation_date": 1595589161, "post_id": 37038840, "comment_id": 111534295, "body": "What about if I need CSV UTF8 format? Seems that only office 35 support it.. How is possible??"}, {"owner": {"reputation": 387, "user_id": 3817964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36130f1f2e986d5c6c71746bce5443b?s=128&d=identicon&r=PG&f=1", "display_name": "furnaceX", "link": "https://stackoverflow.com/users/3817964/furnacex"}, "edited": false, "score": 0, "creation_date": 1600982106, "post_id": 37038840, "comment_id": 113269675, "body": "I modified the &quot;Copy&quot; line so it would not include hidden rows and columns.  I often hide unnecessary stuff before creating a csv.  <code>ActiveWorkbook.ActiveSheet.UsedRange.SpecialCells(xlCellType&zwnj;&#8203;Visible).Copy</code>"}], "tags": [], "owner": {"reputation": 20003, "user_id": 10335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/af44f496fec83ffbb8283b4c7122b246?s=128&d=identicon&r=PG", "display_name": "neves", "link": "https://stackoverflow.com/users/10335/neves"}, "is_accepted": true, "score": 22, "last_activity_date": 1617223000, "last_edit_date": 1617223000, "creation_date": 1462399289, "answer_id": 37038840, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/37038840#37038840", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>Almost what I wanted @Ralph, but here is the <strong>best answer</strong>, because it solves some problems:</p>\n<ol>\n<li>it exports the current sheet, instead of just the hardcoded sheet named &quot;Sheet1&quot;;</li>\n<li>it exports to a file named as the current sheet</li>\n<li>it respects the locale separation char.</li>\n<li>You continue editing your xlsx file.</li>\n</ol>\n<p>To <em>solve these problems</em>, and meet all my requirements, I've adapted the <a href=\"http://thebiobucket.blogspot.com.br/2014/11/excel-vba-makro-to-export-data-from.html\" rel=\"nofollow noreferrer\">code from here</a>. I've cleaned it a little to make it more readable.</p>\n<pre><code>Option Explicit\nSub ExportAsCSV()\n \n    Dim MyFileName As String\n    Dim CurrentWB As Workbook, TempWB As Workbook\n     \n    Set CurrentWB = ActiveWorkbook\n    ActiveWorkbook.ActiveSheet.UsedRange.Copy\n \n    Set TempWB = Application.Workbooks.Add(1)\n    With TempWB.Sheets(1).Range(&quot;A1&quot;)\n      .PasteSpecial xlPasteValues\n      .PasteSpecial xlPasteFormats\n    End With        \n\n    Dim Change below to &quot;- 4&quot;  to become compatible with .xls files\n    MyFileName = CurrentWB.Path &amp; &quot;\\&quot; &amp; Left(CurrentWB.Name, Len(CurrentWB.Name) - 5) &amp; &quot;.csv&quot;\n     \n    Application.DisplayAlerts = False\n    TempWB.SaveAs Filename:=MyFileName, FileFormat:=xlCSV, CreateBackup:=False, Local:=True\n    TempWB.Close SaveChanges:=False\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n<p>There are still some small thing with the code above that you should notice:</p>\n<ol>\n<li><code>.Close</code> and <code>DisplayAlerts=True</code> should be in a finally clause, but I don't know how to do it in VBA</li>\n<li>It works just if the current filename has 4 letters, like .xlsm. Wouldn't work in .xls excel old files. For file extensions of 3 chars, you must change the <code>- 5</code> to <code>- 4</code> when setting MyFileName in the code above.</li>\n<li>As a collateral effect, your clipboard will be substituted with current sheet contents.</li>\n</ol>\n<p>Edit: put <code>Local:=True</code> to save with my locale CSV delimiter.</p>\n"}, {"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": -1, "last_activity_date": 1462401420, "last_edit_date": 1495535490, "creation_date": 1462401420, "answer_id": 37039229, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/37039229#37039229", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>As I commented, there are a few places on this site that write the contents of a worksheet out to a CSV. <a href=\"https://stackoverflow.com/questions/19275943/exporting-data-into-a-csv-excel-vba\">This one</a> and <a href=\"https://stackoverflow.com/questions/8419828/how-to-create-a-separate-csv-file-from-vba\">this one</a> to point out just two.</p>\n\n<p>Below is my version</p>\n\n<ul>\n<li>it explicitly looks out for \",\" inside a cell</li>\n<li>It also uses <code>UsedRange</code> - because you want to get all of the contents in the worksheet</li>\n<li>Uses an array for looping as this is faster than looping through worksheet cells</li>\n<li>I did not use FSO routines, but this is an option</li>\n</ul>\n\n<p>The code ...</p>\n\n<pre><code>Sub makeCSV(theSheet As Worksheet)\nDim iFile As Long, myPath As String\nDim myArr() As Variant, outStr As String\nDim iLoop As Long, jLoop As Long\n\nmyPath = Application.ActiveWorkbook.Path\niFile = FreeFile\nOpen myPath &amp; \"\\myCSV.csv\" For Output Lock Write As #iFile\n\nmyArr = theSheet.UsedRange\nFor iLoop = LBound(myArr, 1) To UBound(myArr, 1)\n    outStr = \"\"\n    For jLoop = LBound(myArr, 2) To UBound(myArr, 2) - 1\n        If InStr(1, myArr(iLoop, jLoop), \",\") Then\n            outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, jLoop) &amp; \"\"\"\" &amp; \",\"\n        Else\n            outStr = outStr &amp; myArr(iLoop, jLoop) &amp; \",\"\n        End If\n    Next jLoop\n    If InStr(1, myArr(iLoop, jLoop), \",\") Then\n        outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, UBound(myArr, 2)) &amp; \"\"\"\"\n    Else\n        outStr = outStr &amp; myArr(iLoop, UBound(myArr, 2))\n    End If\n    Print #iFile, outStr\nNext iLoop\n\nClose iFile\nErase myArr\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2462, "user_id": 1553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696d2c42f47b2782046a3624359d73ad?s=128&d=identicon&r=PG", "display_name": "Craig Lambie", "link": "https://stackoverflow.com/users/1553326/craig-lambie"}, "edited": false, "score": 0, "creation_date": 1513758412, "post_id": 47901489, "comment_id": 82769899, "body": "Would love this as an Add-in, anyone got time to make that happen?"}, {"owner": {"reputation": 4630, "user_id": 2994412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gnXJp.jpg?s=128&g=1", "display_name": "Horaciux", "link": "https://stackoverflow.com/users/2994412/horaciux"}, "edited": false, "score": 0, "creation_date": 1572652202, "post_id": 47901489, "comment_id": 103637026, "body": "I have to do this for mac, but I don&#39;t have one to test. Will it work? is it OS agnostic?"}, {"owner": {"reputation": 2462, "user_id": 1553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696d2c42f47b2782046a3624359d73ad?s=128&d=identicon&r=PG", "display_name": "Craig Lambie", "link": "https://stackoverflow.com/users/1553326/craig-lambie"}, "reply_to_user": {"reputation": 4630, "user_id": 2994412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gnXJp.jpg?s=128&g=1", "display_name": "Horaciux", "link": "https://stackoverflow.com/users/2994412/horaciux"}, "edited": false, "score": 1, "creation_date": 1572775298, "post_id": 47901489, "comment_id": 103658273, "body": "Sorry @horaciux I also don&#39;t have a mac. From memory there is very limited coding available on older versions of excel for mac... That might have changed, not sure tbh."}], "tags": [], "owner": {"reputation": 2462, "user_id": 1553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696d2c42f47b2782046a3624359d73ad?s=128&d=identicon&r=PG", "display_name": "Craig Lambie", "link": "https://stackoverflow.com/users/1553326/craig-lambie"}, "is_accepted": false, "score": 4, "last_activity_date": 1533128578, "last_edit_date": 1533128578, "creation_date": 1513757636, "answer_id": 47901489, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/47901489#47901489", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>As per my comment on @neves post, I slightly improved this by adding the xlPasteFormats as well as values part so dates go across as dates - I mostly save as CSV for bank statements, so needed dates.</p>\n\n<pre><code>Sub ExportAsCSV()\n\n    Dim MyFileName As String\n    Dim CurrentWB As Workbook, TempWB As Workbook\n\n    Set CurrentWB = ActiveWorkbook\n    ActiveWorkbook.ActiveSheet.UsedRange.Copy\n\n    Set TempWB = Application.Workbooks.Add(1)\n    With TempWB.Sheets(1).Range(\"A1\")\n        .PasteSpecial xlPasteValues\n        .PasteSpecial xlPasteFormats\n    End With\n\n    'Dim Change below to \"- 4\"  to become compatible with .xls files\n    MyFileName = CurrentWB.Path &amp; \"\\\" &amp; Left(CurrentWB.Name, Len(CurrentWB.Name) - 5) &amp; \".csv\"\n\n    Application.DisplayAlerts = False\n    TempWB.SaveAs Filename:=MyFileName, FileFormat:=xlCSV, CreateBackup:=False, Local:=True\n    TempWB.Close SaveChanges:=False\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 192, "user_id": 6232529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5181ac6a8bcfd08e576f45453e99c009?s=128&d=identicon&r=PG&f=1", "display_name": "Dodecaphone", "link": "https://stackoverflow.com/users/6232529/dodecaphone"}, "edited": false, "score": 0, "creation_date": 1578309728, "post_id": 58709315, "comment_id": 105385518, "body": "Thanks, Patrick. Can you please explain what a.Transpose(a.Transpose(r.Value)) achieves?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 192, "user_id": 6232529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5181ac6a8bcfd08e576f45453e99c009?s=128&d=identicon&r=PG&f=1", "display_name": "Dodecaphone", "link": "https://stackoverflow.com/users/6232529/dodecaphone"}, "edited": false, "score": 1, "creation_date": 1578326861, "post_id": 58709315, "comment_id": 105393760, "body": "@Dodecaphone the &#39;double transpose&#39; is used to transform a 2D array into a 1D array. It is necessary to have a 1D array for the <code>Join</code> to work."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1572949534, "creation_date": 1572949534, "answer_id": 58709315, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/58709315#58709315", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>For those situations where you need a bit more customisation of the output (separator or decimal symbol), or who have large dataset (over 65k rows), I wrote the following:  </p>\n\n<pre><code>Option Explicit\n\nSub rng2csv(rng As Range, fileName As String, Optional sep As String = \";\", Optional decimalSign As String)\n'export range data to a CSV file, allowing to chose the separator and decimal symbol\n'can export using rng number formatting!\n'by Patrick Honorez --- www.idevlop.com\n    Dim f As Integer, i As Long, c As Long, r\n    Dim ar, rowAr, sOut As String\n    Dim replaceDecimal As Boolean, oldDec As String\n\n    Dim a As Application:   Set a = Application\n\n    ar = rng\n    f = FreeFile()\n    Open fileName For Output As #f\n\n    oldDec = Format(0, \".\")     'current client's decimal symbol\n    replaceDecimal = (decimalSign &lt;&gt; \"\") And (decimalSign &lt;&gt; oldDec)\n\n    For Each r In rng.Rows\n        rowAr = a.Transpose(a.Transpose(r.Value))\n        If replaceDecimal Then\n            For c = 1 To UBound(rowAr)\n                'use isnumber() to avoid cells with numbers formatted as strings\n                If a.IsNumber(rowAr(c)) Then\n                    'uncomment the next 3 lines to export numbers using source number formatting\n'                    If r.cells(1, c).NumberFormat &lt;&gt; \"General\" Then\n'                        rowAr(c) = Format$(rowAr(c), r.cells(1, c).NumberFormat)\n'                    End If\n                    rowAr(c) = Replace(rowAr(c), oldDec, decimalSign, 1, 1)\n                End If\n            Next c\n        End If\n        sOut = Join(rowAr, sep)\n        Print #f, sOut\n    Next r\n    Close #f\n\nEnd Sub\n\nSub export()\n    Debug.Print Now, \"Start export\"\n    rng2csv shOutput.Range(\"a1\").CurrentRegion, RemoveExt(ThisWorkbook.FullName) &amp; \".csv\", \";\", \".\"\n    Debug.Print Now, \"Export done\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 1528522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f997bfa2a985f59df4125501d0bfea42?s=128&d=identicon&r=PG", "display_name": "nobilis", "link": "https://stackoverflow.com/users/1528522/nobilis"}, "is_accepted": false, "score": 2, "last_activity_date": 1588714554, "last_edit_date": 1588714554, "creation_date": 1588713608, "answer_id": 61623261, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/61623261#61623261", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>Here is a slight improvement on the this answer above taking care of both .xlsx and .xls files in the same routine, in case it helps someone!</p>\n\n<p>I also add a line to choose to save with the active sheet name instead of the workbook, which is most practical for me often:</p>\n\n<pre><code>Sub ExportAsCSV()\n\n    Dim MyFileName As String\n    Dim CurrentWB As Workbook, TempWB As Workbook\n\n    Set CurrentWB = ActiveWorkbook\n    ActiveWorkbook.ActiveSheet.UsedRange.Copy\n\n    Set TempWB = Application.Workbooks.Add(1)\n    With TempWB.Sheets(1).Range(\"A1\")\n        .PasteSpecial xlPasteValues\n        .PasteSpecial xlPasteFormats\n    End With\n\n    MyFileName = CurrentWB.Path &amp; \"\\\" &amp; Left(CurrentWB.Name, InStrRev(CurrentWB.Name, \".\") - 1) &amp; \".csv\"\n    'Optionally, comment previous line and uncomment next one to save as the current sheet name\n    'MyFileName = CurrentWB.Path &amp; \"\\\" &amp; CurrentWB.ActiveSheet.Name &amp; \".csv\"\n\n\n    Application.DisplayAlerts = False\n    TempWB.SaveAs Filename:=MyFileName, FileFormat:=xlCSV, CreateBackup:=False, Local:=True\n    TempWB.Close SaveChanges:=False\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 874, "user_id": 3817068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V5QSl.jpg?s=128&g=1", "display_name": "Nicholas Hunter", "link": "https://stackoverflow.com/users/3817068/nicholas-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1617203763, "last_edit_date": 1617203763, "creation_date": 1617203343, "answer_id": 66890480, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh/66890480#66890480", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<ol>\n<li>You can use <strong>Worksheet.Copy</strong> with no arguments to copy the worksheet to a new workbook. <strong>Worksheet.Move</strong> will copy the worksheet to a new workbook and remove it from the original workbook (you might say &quot;export&quot; it).</li>\n<li>Grab a reference to the newly created workbook and save as CSV.</li>\n<li>Set DisplayAlerts to false to suppress the warning messages. (Don't forget to turn it back on when you're done).</li>\n<li>You will want DisplayAlerts turned off when you save the workbook and also when you close it.</li>\n</ol>\n<pre><code>    wsToExport.Move\n\n    With Workbooks\n        Set wbCsv = .Item(.Count)\n    End With\n\n    Application.DisplayAlerts = False\n    wbCsv.SaveAs xlCSV\n    wbCsv.Close False\n    Application.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 20003, "user_id": 10335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/af44f496fec83ffbb8283b4c7122b246?s=128&d=identicon&r=PG", "display_name": "neves", "link": "https://stackoverflow.com/users/10335/neves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136827, "favorite_count": 11, "protected_date": 1553591663, "accepted_answer_id": 37038840, "answer_count": 7, "score": 38, "last_activity_date": 1617223000, "creation_date": 1462395667, "last_edit_date": 1576248237, "question_id": 37037934, "link": "https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh", "title": "Excel: macro to export worksheet as CSV file without leaving my current Excel sheet", "body": "<p>There are a lot of questions here to create a macro to save a worksheet as a CSV file. All the answers use the SaveAs, like <a href=\"https://superuser.com/questions/381861/export-to-csv-from-excel\">this one</a> from SuperUser. They basically say to create a VBA function like this:</p>\n\n<pre><code>Sub SaveAsCSV()\n    ActiveWorkbook.SaveAs FileFormat:=clCSV, CreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p>This is a great answer, but I want to do an <strong>export instead of Save As</strong>. When the SaveAs is executed it causes me two annoyances:</p>\n\n<ul>\n<li>My current working file becomes a CSV file. I'd like to continue working in my original .xlsm file, but to export the contents of the current worksheet to a CSV file with the same name.</li>\n<li>A dialog appears asking me confirm that I'd like to rewrite the CSV file.</li>\n</ul>\n\n<p>Is it possible to just export the current worksheet as a file, but to continue working in my original file?  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462396600, "post_id": 37037909, "comment_id": 61626394, "body": "Do the rows match up? Also, it&#39;s easier to use <code>cells</code> (for me anyways)."}, {"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462399772, "post_id": 37037909, "comment_id": 61627848, "body": "I tried the code and it works. Although you need an <code>Exit Sub</code> before the <code>Err_Execute:</code> so you do not get an error message even if everything executed just fine. And you should definetely change the variable declarations from <code>Integer</code> to <code>Long</code>. Integers can only hold numbers up to 32767. Bad idea to use those to traverse over 1048576 rows. So, since everything is working - what exactly is the problem?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462406363, "post_id": 37037909, "comment_id": 61629916, "body": "It&#39;s best to provide a sample of input, expected output, and what results you are not getting. I going to guess you need a nested loop - srch is the outer and myRow is the inner."}], "answers": [{"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 0, "last_activity_date": 1462415074, "creation_date": 1462415074, "answer_id": 37041288, "question_id": 37037909, "link": "https://stackoverflow.com/questions/37037909/excel-vb-macro-to-find-value-from-another-sheet-then-change-a-cell-value-in-curr/37041288#37041288", "title": "Excel VB Macro to find value from another sheet then change a cell value in current sheet", "body": "<p>Your code is comparing <code>A1</code> from <code>Sheet1</code> to <code>A1</code> in <code>Sheet2</code>. I think you want to compare <code>A1</code> in <code>Sheet1</code> to all of <code>ColumnA</code> in <code>Sheet2</code>. Therefore, you need an outer loop.</p>\n\n<p>The below is your code, modified to accomplish this. It also incorporates Leviathan's comment to change <code>Integer</code>'s to <code>Long</code>, and inserted the Exit Sub in the appropriate location.</p>\n\n<p>When Sheet2 looks like this ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/wFPRn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wFPRn.png\" alt=\"enter image description here\"></a></p>\n\n<p>I get this result on Sheet1 ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vy0Nh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vy0Nh.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code ...</p>\n\n<pre><code>Sub dataChange()\n    Dim myRow As Long, srch As Integer\n    On Error GoTo Err_Execute\n    myRow = 1\n    srch = 1\n    Do While Sheet1.Cells(srch, 1).VALUE &lt;&gt; \"\"\n        Do While Sheet2.Cells(myRow, 1).VALUE &lt;&gt; \"\"\n            If Sheet1.Cells(srch, 1).VALUE = Sheet2.Cells(myRow, 1).VALUE Then\n                Sheet1.Range(\"AP\" &amp; srch).VALUE = \"HOUSTON\"\n                Exit Do\n            End If\n            myRow = myRow + 1\n        Loop\n        myRow = 1\n        srch = srch + 1\n    Loop\n    Exit Sub\nErr_Execute:\n    MsgBox \"An error occurred.\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6292774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de02d44a12d577f2ca12b611a2fc44f?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6292774/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 37041288, "answer_count": 1, "score": 1, "last_activity_date": 1462415074, "creation_date": 1462395546, "last_edit_date": 1462401004, "question_id": 37037909, "link": "https://stackoverflow.com/questions/37037909/excel-vb-macro-to-find-value-from-another-sheet-then-change-a-cell-value-in-curr", "title": "Excel VB Macro to find value from another sheet then change a cell value in current sheet", "body": "<p>I have a file that has two worksheets. I need to run a macro that looks down column A on sheet2 until it's blank. It needs to look for the value from the cell in sheet2 column A on sheet1. If found then change the value of the column AP. If not found then skip to the next search for the next value. </p>\n\n<p>This is what I have so far. I have been able to fix it to where I no longer get errors but it doesn't have results either. It shows and seems to run but no changes are made to cell(\"AP\",\"row value found\") on sheet1.</p>\n\n<pre><code>Sub dataChange()\n    Dim myRow As Integer\n    Dim srch As Integer\n    On Error GoTo Err_Execute\n    myRow = 1\n    srch = 1\n    While Sheet2.Cells(myRow, 1).Value &lt;&gt; \"\"\n        If Sheet1.Range(\"A\" &amp; CStr(srch)).Value = Sheet2.Cells(myRow, 1).Value Then\n            Sheet1.Range(\"AP\" &amp; CStr(srch)).Value = \"HOUSTON\"\n        End If\n        srch = srch + 1\n        myRow = myRow + 1\n    Wend\nErr_Execute:\n    MsgBox \"An error occurred.\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "focus", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462394743, "post_id": 37037566, "comment_id": 61625465, "body": "select a cell/range/sheet in the new workbook?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6105312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb6327fe368349dcd317c22de890c66?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6105312/steve"}, "edited": false, "score": 0, "creation_date": 1462398504, "post_id": 37037806, "comment_id": 61627302, "body": "Namkce, thanks for the suggestion.  Unfortunately, that appeared to have no impact on the outcome.  I still have to gain focus of the program xlsm file before I can gain focus on the opened file."}], "tags": [], "owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "is_accepted": false, "score": 0, "last_activity_date": 1462395195, "creation_date": 1462395195, "answer_id": 37037806, "question_id": 37037566, "link": "https://stackoverflow.com/questions/37037566/when-opening-excel-workbook-using-vba-how-to-make-the-open-workbook-the-active-w/37037806#37037806", "title": "When opening Excel workbook using VBA how to make the open workbook the active window?", "body": "<p>Try adding this to the end of your VBA script:</p>\n\n<blockquote>\n<pre><code>Application.SendKeys (\"%{TAB}\")\n</code></pre>\n</blockquote>\n\n<p>It will try to do an Alt-Tab to switch windows, and then hopefully that'll solve your issue.  </p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 6105312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb6327fe368349dcd317c22de890c66?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6105312/steve"}, "edited": false, "score": 0, "creation_date": 1463086849, "post_id": 37055629, "comment_id": 61927040, "body": "Thanks Kellsens. That seemed to work, but I wonder what&#39;s the difference between that command and my <code>Workbooks(wb).Activate</code> command. It is not setting the focus on the open worksheet though, but at least I can interact with it."}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "reply_to_user": {"reputation": 25, "user_id": 6105312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb6327fe368349dcd317c22de890c66?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6105312/steve"}, "edited": false, "score": 0, "creation_date": 1463145207, "post_id": 37055629, "comment_id": 61953125, "body": "Workbooks(&lt;index&gt;).activate is the correct form to use. It will work if you use like dis Workbooks(wb.name).Activate To set focus to a worksheet use wb.worksheets(&lt;name of your worksheet&gt;).activate"}], "tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": true, "score": 2, "last_activity_date": 1462465707, "creation_date": 1462465707, "answer_id": 37055629, "question_id": 37037566, "link": "https://stackoverflow.com/questions/37037566/when-opening-excel-workbook-using-vba-how-to-make-the-open-workbook-the-active-w/37055629#37055629", "title": "When opening Excel workbook using VBA how to make the open workbook the active window?", "body": "<p>just try:</p>\n\n<pre><code>wb.activate\n</code></pre>\n\n<p>Works for me</p>\n"}], "owner": {"reputation": 25, "user_id": 6105312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb6327fe368349dcd317c22de890c66?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6105312/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5371, "favorite_count": 0, "accepted_answer_id": 37055629, "answer_count": 2, "score": 1, "last_activity_date": 1479418099, "creation_date": 1462394291, "last_edit_date": 1531161705, "question_id": 37037566, "link": "https://stackoverflow.com/questions/37037566/when-opening-excel-workbook-using-vba-how-to-make-the-open-workbook-the-active-w", "title": "When opening Excel workbook using VBA how to make the open workbook the active window?", "body": "<p>I'm using a an xlsm file form that calls up a second form to ask the user to select which workbook to open. The VBA code will then open that workfile. However, I'm finding that in Office 2016, the file opens behind the original xlsm file. That is, it will not become the active window. I can use Alt+Tab to go to the open file, but the file will not interact with my keystrokes or mouse clicks until I Alt+Tab to activate the originating xlsm file. Then when I reactive the VBA-opened file, I can interact with it. That is, the file that VBA opened will not become active until I touch base back with the workfile that has the VBA code. I've tried a series of activeworkbooks, application.activewindow commands to activate the opened workbook to no avail. </p>\n\n<p>Here is the code that I'm using:</p>\n\n<pre><code>Private Sub btn_select_Click()\n' User clicks on select. If a subcategory is selected open the file and stop program. If not repopulate sub-category\n    If IsNull(lst_subcategories) Or lst_subcategories = \"\" Then\n        lst_subcategories.Clear\n        Call populate_data\n    Else   ' open file and unload form (End)\n        If lst_datacategories &lt;&gt; \"Tourism\" Then\n            str_filetoopen = \"I:\\Bureau-Work\\Data System\\\" &amp; lst_datacategories &amp; \"\\\" &amp; lst_subcategories &amp; \".xlsx\"    ' May need to be F: drive\n        Else\n            str_filetoopen = \"I:\\Bureau-Work\\Data System\\\" &amp; lst_subcategories &amp; \"\\\" &amp; lst_subcategories &amp; \".xlsx\"    ' May need to be F: drive\n        End If\n\n        On Error Resume Next      ' drive or file may not be available.  If so error and retain from\n          Set wb = Workbooks.Open(str_filetoopen)\n          If wb Is Nothing Then\n            MsgBox \"I: Drive or Retrieve File is Not Accessible\"\n            GoTo handle    ' retains frm_editData\n          End If\n          Workbooks(wb).Activate\n          ActiveWindow.Visible = True\n        End     'exit all macros and forms once successfully loading file\n    End If\nhandle:\nEnd Sub\n</code></pre>\n\n<p>The \"Workbooks(wb).Activate\" and \"Activewindow.visible=True\" commands are attempts to set the new workbook window as the active window. To the best of my knowledge, this does not happen in Office 2013, but may be peculiar to Office 2016.  </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1462395013, "post_id": 37037424, "comment_id": 61625607, "body": "you cannot add dimensions to an array that is already declared.  So array(10,10) cannot be redim(ed) to array(10,10,10)"}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1462397433, "post_id": 37037424, "comment_id": 61626802, "body": "Well my arrays are both declared with empty parentheses, and once the number of dimensions is set by the user it doesn&#39;t change, so that&#39;s not an issue here"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462397885, "post_id": 37037424, "comment_id": 61627017, "body": "What you&#39;re specifically asking for doesn&#39;t work in VBA.  Without knowing the structure of the data you&#39;re trying to analyze, it&#39;s difficult to recommend alternate methods that could work for you.  A 15-dimensional array would be very cumbersome to work with, and in most cases is not necessary.  Generally, a 3-dimensional array is the most you would need.  For example, a 1-dimensional array is simply a list of values, A 2-dimensional array is a table of values, and a 3-dimensional array is several tables of values.  Is there some specific reason you need more than a 3-dimensional array?"}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462398400, "post_id": 37037424, "comment_id": 61627258, "body": "I&#39;m not specifically required to use multi-dimensional arrays, that&#39;s just how I have been able to visualize what I&#39;m trying. If you have an alternative approach I&#39;m all ears! I&#39;m trying to count how many individuals have combinations of allergens (e.g. dairy, soy, &amp; gluten) look for clusters. Because there are 451 allergens currently, a 1D array containing an element for each combination wouldn&#39;t really work past 5 or so dimensions."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462398466, "post_id": 37037424, "comment_id": 61627282, "body": "@MikeG Can you provide some sample data and expected results?"}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462399294, "post_id": 37037424, "comment_id": 61627651, "body": "Sure, I&#39;ll pull a sample of the source data and provide the results of my 2D script a little later on. Appreciate your help!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1462399739, "post_id": 37037424, "comment_id": 61627830, "body": "You could also create a class to hold the information......"}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462408387, "post_id": 37037424, "comment_id": 61630391, "body": "Sorceri, I&#39;m not sure what you mean by creating a class... you mean a class module? I don&#39;t think that will help much, beyond just making the code look a little neater. Or have I misunderstood what you&#39;re referring to?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462424718, "post_id": 37037424, "comment_id": 61634381, "body": "I would use a 2D array, the first column is a list of possible nTuples, and the second column the count. Now that you&#39;re using VBA, building the list of nTuples is fast and easy."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462425064, "post_id": 37037424, "comment_id": 61634488, "body": "Or, the first n Columns define the tuple, and the n+1 column provides your count."}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462399177, "post_id": 37038628, "comment_id": 61627592, "body": "Interesting idea, I&#39;ll have to give some thought to how I can make this fully scalable, but I think you might have the answer there."}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462414832, "post_id": 37038628, "comment_id": 61631913, "body": "hmm... I just ran a quick nCr computation to see what I&#39;m getting myself into, for n=451 and r = 6 there are 1.36E15 possible combinations. Something tells me my laptop won&#39;t be able to handle an array that large regardless of how it&#39;s structured. I may have to take the top 20 (or whatever) results at each level and iteratively run the count for each additional dimension, again paring down to the top 20 before proceeding."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1462398392, "creation_date": 1462398392, "answer_id": 37038628, "question_id": 37037424, "link": "https://stackoverflow.com/questions/37037424/large-array-with-user-defined-number-of-dimensions/37038628#37038628", "title": "Large Array with user-defined number of dimensions", "body": "<p>To expand on my comment, here is some modified code to use an array of arrays based on the provided <code>N_tuple</code> variable.  I am having a difficult time imagining a scenario where this wouldn't work for you:</p>\n\n<pre><code>Sub testroutine()\n\nDim x As Integer, y As Integer 'just a counter\nDim ArrayTemp() As Variant\nDim PairCount() As Variant\nDim AllergenRef As Object 'Object to store a reference to each AllergenID using AllergenKey as key\n    Set AllergenRef = CreateObject(\"Scripting.Dictionary\")\n\nFor x = 1 To 20\n    AllergenRef.Add x, (x * 10) + (2 ^ x) 'dummy data for my dictionary\nNext x\n\nDim N_tuple As Integer\nN_tuple = 5 'this value would be provided by a user form at runtime\n\n'Now that you have your N_tuple, redim your paircount array\nReDim PairCount(1 To N_tuple)\n\n'For each N_tuple, create an array and add it to the PairCount array\n'Note that you could easily have a 2-dimensional array for a table of values as ArrayTemp\nFor x = 1 To N_tuple\n    ReDim ArrayTemp(1 To AllergenRef.Count)\n    PairCount(x) = ArrayTemp\nNext x\n\n'Now you have an array of arrays, which can be easily accessed.\n'For example: PairCount(2)(3)\n'Or if the subarrays are 2-dimensional: PairCount(4)(6, 12)\n\n'This simply loops through the PairCount array and shows the ubound of its subarrays\nFor x = 1 To UBound(PairCount)\n    MsgBox UBound(PairCount(x))\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462805491, "post_id": 37081203, "comment_id": 61778809, "body": "Thanks Marc, that approach makes so much more sense than the way I had originally started down! Even doing it this way takes a very long time at 5 tuples, I can&#39;t imagine what it would have been otherwise. I didn&#39;t fully understand everything you were doing in your code, so I ended up writing my own version. Probably less efficient than yours, but at least I can troubleshoot it! Thanks for all your help!"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462806580, "post_id": 37081203, "comment_id": 61779515, "body": "Hey Mike, I liked the exercise. I&#39;ll comment it and clean it up later. i think it&#39;s natural for everybody to think of full combination calculation, and then allocate. I&#39;ve experienced this alternative in the past for similar problems of huge combination/permutations, and its always worth thinking of formulating data first, then decompose - as opposed to &#39;constructing&#39; data structures when most of the construction won&#39;t be used."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "edited": false, "score": 0, "creation_date": 1462823283, "post_id": 37081203, "comment_id": 61789293, "body": "Hi Mike, I&#39;ve tidied the code up a bit, and added comments so you can follow. It is running a lot more efficiently now - much faster."}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1462823229, "last_edit_date": 1462823229, "creation_date": 1462567847, "answer_id": 37081203, "question_id": 37037424, "link": "https://stackoverflow.com/questions/37037424/large-array-with-user-defined-number-of-dimensions/37081203#37081203", "title": "Large Array with user-defined number of dimensions", "body": "<p>I wouldnt' worry about the max possible combinations with your medium-sized dataset. You wont be able to make all the possible combinations. You will have many combinations that will not occur in the sample population. Do not try and calculate them all, and then count the occurrences. </p>\n\n<p>Instead, work through your sample population, and create the tuples as data entries on the worksheet 'array'. I suggest using the 3-digit allergen key as identifier numbers, and combine the numbers in tuples a Long(perhaps Decimal may be needed for larger numbers). </p>\n\n<p>The approach I suggest is to combine the tuples as longs which can be easily be decomposed later. Then use the frequency function to count the occurrences of each tuple 'number'. so if there are allergens with keys: 1, 17, 451 - they form a composed long of 1,017,451 (identical to 451, 17, &amp; 1)- we ensure that any tuple has forced order of smallest key to largest key. So the max triple is 449,450,451, and the smallest is 1,002,003. Note that you can NEVER have 3,002,001 as that would duplicate 1,002,003.</p>\n\n<p>The module I had a play with is below:\n<strong>EDIT</strong> - for better code</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nPublic Function concID(paramArr() As Variant) As Variant\n' this function takes an array of numbers and arranges the array into\n' one long code number - with order of smallest to largest\n' the code number generated has each individual array entry as a 3-digit component\n\n  Dim wsf As WorksheetFunction\n  Dim decExp As Integer\n  Dim i As Long, j As Long\n  Dim bigNum As Variant   ' may need to cast to Decimal??\n\n  Set wsf = WorksheetFunction\n\n  'may use cDec if necessary here??\n  For i = 1 To UBound(paramArr)\n        'determine the position of the component by multiplying by a multiple of 10^3\n        decExp = 3 * (UBound(paramArr) - i)\n        bigNum = bigNum + wsf.Small(paramArr, i) * 10 ^ decExp\n  Next i\n  concID = bigNum\n\nEnd Function\n\nPublic Sub runAllergen()\n\n  Dim ws As Worksheet\n  Dim dataRange As Range, tupleRange As Range, uniqueList As Range, freqRange As Range, r As Range\n  Dim i As Long, j As Long, counter As Long\n  Dim dataArray As Variant, arr As Variant, tempholder As Long\n  Dim bigArray(1 To 10 ^ 6, 1 To 1) As Variant ' the array which will hold all the generated combinations from the data\n  Dim tuple As Long\n\n  tuple = 3\n  'this will come in as a user input.\n  Set ws = Sheet1\n  Set dataRange = ws.Range(\"A2:A10001\")     'I have 10k people in my dataset, and this is just the allergen data vector\n\n  Application.ScreenUpdating = False  'IMPORTANT for efficiency\n\n  tempholder = 1 'this is the array index which the next combi entry is to be put into bigArray\n  dataArray = dataRange.Value 'write entire worksheet column to internal array for efficiency\n  For i = 1 To UBound(dataArray)\n        'obtain array of allergen values in each data row to obtain tuples from\n        arr = Split(dataArray(i, 1), \",\")\n        If UBound(arr) + 1 &gt;= tuple Then\n              'give over the array of row data to make tuples from and write to bigArray\n              'return the next available index of bigArray to store data\n              tempholder = printCombinations(arr, tuple, bigArray(), tempholder)\n        End If\n  Next i\n\n  Set r = ws.Range(\"B2\")\n  'write entire list of tuples from data population to worksheet for efficiency - MASSIVE performance boost\n  r.Resize(tempholder - 1, 1).Value = bigArray\n  'copy tuple output over to another column to remove duplicates and get unique list\n  Set tupleRange = ws.Range(r, r.End(xlDown))\n  tupleRange.Copy\n  Set r = ws.Range(\"D2\")\n  r.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n  'remove duplicates from copied tuple output to get a unique list of codes to serve as bins in FREQUENCY function\n  ws.Range(r, r.End(xlDown)).RemoveDuplicates Columns:=1, Header:=xlNo\n  Set uniqueList = ws.Range(r, r.End(xlDown))\n  Application.CutCopyMode = False\n  'set the frquency output range which is always 1 more row than the bins array\n  Set freqRange = uniqueList.Offset(0, 1).Resize(uniqueList.Rows.Count + 1, 1)\n  'get the frequency of each tuple\n  freqRange.FormulaArray = \"=FREQUENCY(R2C\" &amp; tupleRange.Column &amp; \":R\" &amp; tupleRange.Rows.Count + 1 &amp; _\n                    \"C\" &amp; tupleRange.Column &amp; _\n                    \",R2C\" &amp; uniqueList.Column &amp; \":R\" &amp; uniqueList.Rows.Count + 1 &amp; \"C\" &amp; uniqueList.Column &amp; \")\"\n\n  Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function printCombinations(pool As Variant, r As Long, printVector As Variant, tempPosition As Long) As Long\n\n  'this function writes the data row arrays as tuples/combis to the bigArray,\n  'and returns the next available index in bigArray\n  Dim i As Long, j As Long, n As Long\n  Dim tempholder() As Variant\n  Dim idx() As Long\n\n  ReDim tempholder(1 To r)\n  ReDim idx(1 To r)\n\n  n = UBound(pool) - LBound(pool) + 1\n  For i = 1 To r\n        idx(i) = i\n  Next i\n\n  Do\n        For j = 1 To r\n              tempholder(j) = CLng(pool(idx(j) - 1))\n        Next j\n\n        'we now have an array of size tuple from the row data, so construct our code number,\n        'and write to the next available index in bigArray\n\n        printVector(tempPosition, 1) = concID(tempholder)\n        tempPosition = tempPosition + 1\n\n        ' Locate last non-max index\n        i = r\n        While (idx(i) = n - r + i)\n              i = i - 1\n              If i = 0 Then\n                    'the algorithm has ended with the last index exhausted\n                    'return the next available index of bigArray\n                    printCombinations = tempPosition\n                    Exit Function\n              End If\n        Wend\n\n        idx(i) = idx(i) + 1\n        For j = i + 1 To r\n              idx(j) = idx(i) + j - i\n        Next j\n  Loop\n\nEnd Function\n</code></pre>\n\n<p>Initial set-up:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6VRda.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6VRda.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could also copy-paste over your frequency Range into values etc....</p>\n"}], "owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 37081203, "answer_count": 2, "score": 1, "last_activity_date": 1462823229, "creation_date": 1462393732, "last_edit_date": 1495541766, "question_id": 37037424, "link": "https://stackoverflow.com/questions/37037424/large-array-with-user-defined-number-of-dimensions", "title": "Large Array with user-defined number of dimensions", "body": "<p>I recently wrote a <a href=\"https://stackoverflow.com/questions/36947246/sumproduct-or-countif-on-a-2d-matrix\">question</a> asking for help on how to count the number of occurrences of each and every unique pair of allergies within a population. The solutions I got were great, however I now need to look at combinations of 3+ allergies, and doing it all using Excel tables will take forever. </p>\n\n<p>I decided to write a VBA script to do this, which works great for pairs. It's also much faster since I went back and changed the format of the source data so that each ExceptionID's associated AllergenID's are stored in a single comma-delimited string.</p>\n\n<p>I'm now looking at moving up to a 3D or higher array, and because we don't know how many dimensions we might need to go up to (potentially 10 or 15) I would rather avoid using a series of <code>Case</code> or nested <code>If/Then</code> statements.</p>\n\n<p>My research turned up <a href=\"https://stackoverflow.com/questions/31285020/redim-variable-number-of-dimensions-in-vba\">this article</a> in which I gather that what I'm asking is practically impossible, but I wanted to ask about that OP's statement that </p>\n\n<blockquote>\n  <p>I was thinking it would be possible to do if I could construct the Redim statement at runtime as a string and execute the string, but this doesn't seem possible.</p>\n</blockquote>\n\n<p>I basically had the same idea. The code below generates a Type Mismatch error, but is there no variation of this that might work? Can we not pass other functions (like <code>join</code>) inside <code>ReDim</code>?</p>\n\n<pre><code>Sub testroutine()\n\nDim x As Integer, y As Integer 'just a counter\nDim PairCount() As String\nDim AllergenRef As Object 'Object to store a reference to each AllergenID using AllergenKey as key\n    Set AllergenRef = CreateObject(\"Scripting.Dictionary\")\n\nFor x = 1 To 20\n    AllergenRef.Add x, (x * 10) + (2 ^ x) 'dummy data for my dictionary\nNext x\n\nDim N_tuple As Integer\nN_tuple = 5 'this value would be provided by a user form at runtime\nDim ArrayDim() As String\nReDim ArrayDim(1 To N_tuple)\n\nFor x = 1 To N_tuple\n\n    ArrayDim(x) = \"1 to \" &amp; AllergenRef.Count\n\nNext x\n\nReDim PairCount(Join(ArrayDim, \",\")) 'This is the line that throws an error\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/3104504/is-it-possible-to-dynamically-build-a-multi-dimensional-array-in-java\">This article</a> makes it sound like what I'm doing is possible in Java, but I don't speak any Javanese so I can't really tell how similar this is to what I'm trying to achieve, or if there's a way to apply this method to VBA...</p>\n\n<p>========UPDATE============<br>\nHere is a sample of the data I'm working with (in separate columns, I added dashes for clarity)</p>\n\n<blockquote>\n  <p>ExceptionID - ExcAllergens<br>\n  035 - 100380<br>\n  076 - 100107,100392,100345,100596,100141,100151,100344<br>\n  200 - 100123,100200<br>\n  325 - 100381<br>\n  354 - 100381,100123<br>\n  355 - 100381,100123<br>\n  360 - 100586<br>\n  390 - 100151,100344,100345,100349<br>\n  441 - 100380,100368<br>\n  448 - 100021,100181,100345,100200,100344,100295<br>\n  491 - 100381<br>\n  499 - 100333<br>\n  503 - 100333<br>\n  507 - 100331,100346,100596,100345,100344,100269,100283  </p>\n</blockquote>\n\n<p>And here is an extract from the Allergen definitions table (Allergen Key is something I just added so as to have smaller numbers to work with, the 6 digit numbers are what is used in our DB.)</p>\n\n<blockquote>\n  <p>AllergenKey    - AllergenID    - AllergenTag<br>\n  01  - 100011    - A\u00e7ai Berry<br>\n  02  - 100012    - Acetic Acid<br>\n  03  - 100013    - Agar Agar<br>\n  04  - 100014    - Agave<br>\n  05  - 100015    - Alcohol<br>\n  06  - 100016    - Allspice<br>\n  07  - 100017    - Ammonium Bicarbonate<br>\n  08  - 100018    - Amylase<br>\n  09  - 100019    - Annatto<br>\n  10  - 100020    - Apple<br>\n  11  - 100021    - Apple, Raw<br>\n  12  - 100022    - Apricot<br>\n  13  - 100023    - Arrowroot<br>\n  14  - 100025    - Ascorbic Acid<br>\n  15  - 100027    - Asparagus<br>\n  16  - 100028    - Avocado<br>\n  17  - 100029    - Bacterial Culture<br>\n  18  - 100030    - Baking Powder  </p>\n</blockquote>\n\n<p>Note that there are 6810 exception profiles ranging from 1 to 51 separate allergies (around 4 or 5 on average), and 451 different allergens. Here is the result from my analysis of allergen pairs (btw when I say \"Allergen\" it also includes dietary preferences like vegetarian):</p>\n\n<blockquote>\n  <p>Top 10 pairs   - Pair Count    - Allergen 1    - Allergen 2<br>\n  1   - 245   - Dairy - Gluten<br>\n  2   - 232   - Eggs  - Nuts<br>\n  3   - 190   - Dairy - Eggs<br>\n  4   - 173   - Gluten    - Oats<br>\n  5   - 146   - Soy (May Contain) - Soy<br>\n  6   - 141   - Dairy - Nuts<br>\n  7   - 136   - Beef  - Pork<br>\n  8   - 120   - Dairy - Soy<br>\n  9   - 114   - Sesame (May Contain)  - Nuts<br>\n  10  - 111   - Vegetarian 1  - Pork  </p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 7, "creation_date": 1462389676, "post_id": 37036044, "comment_id": 61622788, "body": "CSV is a text format. You can&#39;t have a formatted CSV file. Either you want a formatted file, or you want a <i>Comma-Separated Values</i> text file."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1462390342, "post_id": 37036044, "comment_id": 61623113, "body": "To preserve the formatting you must save it as a .xls type file (.xls, .xlsx, .xlsm, etc)."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462425800, "post_id": 37036044, "comment_id": 61634731, "body": "There are many examples on this site of exporting the contents of worksheet to a .csv without use .SaveAs."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1462556811, "post_id": 37036044, "comment_id": 61701723, "body": "I strongly suspect that your regional settings may be using a comma for a decimal place and possibly even a period for a thousands separator. If this is the case then the CSV creation is working exactly as it was designed to and you will have to make adjustments with hte correct code page."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "edited": false, "score": 0, "creation_date": 1462542066, "post_id": 37042986, "comment_id": 61692396, "body": "i see commas at the end of csv file (when checking in txt format). How can i remove them?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "edited": false, "score": 0, "creation_date": 1462552569, "post_id": 37042986, "comment_id": 61699371, "body": "In my test case, I did not. If you are getting extra commas, it&#39;s because &#39;UsedRange&#39; is bigger than you expected.  There&#39;s techniques to clean that up, but that run the risk of omitting a cell located away from you main table. What kind of data is on the sheet you are saving?"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1462554722, "last_edit_date": 1495541273, "creation_date": 1462425740, "answer_id": 37042986, "question_id": 37036044, "link": "https://stackoverflow.com/questions/37036044/preserve-formatting-when-saving-xls-as-csv/37042986#37042986", "title": "Preserve formatting when saving xls as csv", "body": "<p><a href=\"https://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh\">See this</a> or <a href=\"https://stackoverflow.com/questions/19275943/exporting-data-into-a-csv-excel-vba\">this</a> or <a href=\"https://stackoverflow.com/questions/8419828/how-to-create-a-separate-csv-file-from-vba\">this</a> for examples of writing a .csv file instead of saving to one.</p>\n\n<p>Below is code extracted from the first example ...</p>\n\n<pre><code>Sub makeCSV(theSheet As Worksheet)\nDim iFile As Long, myPath As String\nDim myArr() As Variant, outStr As String\nDim iLoop As Long, jLoop As Long\n\nmyPath = Application.ActiveWorkbook.Path\niFile = FreeFile\nOpen myPath &amp; \"\\myCSV.csv\" For Output Lock Write As #iFile\n\nmyArr = theSheet.UsedRange\nFor iLoop = LBound(myArr, 1) To UBound(myArr, 1)\n    outStr = \"\"\n    For jLoop = LBound(myArr, 2) To UBound(myArr, 2) - 1\n        If InStr(1, myArr(iLoop, jLoop), \",\") Then\n            outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, jLoop) &amp; \"\"\"\" &amp; \",\"\n        Else\n            outStr = outStr &amp; myArr(iLoop, jLoop) &amp; \",\"\n        End If\n    Next jLoop\n    If InStr(1, myArr(iLoop, jLoop), \",\") Then\n        outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, UBound(myArr, 2)) &amp; \"\"\"\"\n    Else\n        outStr = outStr &amp; myArr(iLoop, UBound(myArr, 2))\n    End If\n    Print #iFile, outStr\nNext iLoop\n\nClose iFile\nErase myArr\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>modified to deal with unusual shaped ranges</strong></p>\n\n<pre><code>Sub makeCSV(theSheet As Worksheet)\nDim iFile As Long, myPath As String\nDim myArr() As Variant, outStr As String\nDim iLoop As Long, jLoop As Long\nDim lastCol As Long\n\n' set up output file\nmyPath = Application.ActiveWorkbook.Path\niFile = FreeFile\nOpen myPath &amp; \"\\myCSV.csv\" For Output Lock Write As #iFile\n\nmyArr = theSheet.UsedRange\nFor iLoop = LBound(myArr, 1) To UBound(myArr, 1) ' loop through all rows\n    outStr = \"\"\n    lastCol = UBound(myArr, 2) ' find last column with data in it\n    For jLoop = UBound(myArr, 2) To LBound(myArr, 2) Step -1\n        If myArr(iLoop, jLoop) = \"\" Then\n            lastCol = jLoop - 1\n        Else\n            Exit For\n        End If\n    Next jLoop\n    For jLoop = LBound(myArr, 2) To lastCol - 1 ' loop until second last column\n        If InStr(1, myArr(iLoop, jLoop), \",\") Then\n            outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, jLoop) &amp; \"\"\"\" &amp; \",\"\n        Else\n            outStr = outStr &amp; myArr(iLoop, jLoop) &amp; \",\"\n        End If\n    Next jLoop\n    If InStr(1, myArr(iLoop, jLoop), \",\") Then ' last column has no \",\" after it\n        outStr = outStr &amp; \"\"\"\" &amp; myArr(iLoop, lastCol) &amp; \"\"\"\"\n    Else\n        outStr = outStr &amp; myArr(iLoop, lastCol)\n    End If\n    Print #iFile, outStr\nNext iLoop\n\n'clean up\nClose iFile\nErase myArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1319, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462554722, "creation_date": 1462388921, "question_id": 37036044, "link": "https://stackoverflow.com/questions/37036044/preserve-formatting-when-saving-xls-as-csv", "title": "Preserve formatting when saving xls as csv", "body": "<p>.SaveAs fileName:=\"name\" &amp; \".CSV\", FileFormat:=xlCSV</p>\n\n<p>The above is what i am using to save an excel as csv. however, in the process i lose all my formatting. For example, decimals becomes whole numbers etc.. How can i preserve formatting when writing the above code in excel vba.</p>\n"}, {"tags": ["vba", "excel-2010"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462389034, "post_id": 37035659, "comment_id": 61622430, "body": "Seems, you&#39;re trying to paste image into word document instead of linked chart."}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462389346, "post_id": 37035659, "comment_id": 61622608, "body": "Yes, I am trying to do this with VBA. But I want to resize the Chart."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462389470, "post_id": 37035659, "comment_id": 61622685, "body": "Inside word document or sheet?"}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462389874, "post_id": 37035659, "comment_id": 61622890, "body": "I am trying to insert the chart to a Word doc."}], "answers": [{"comments": [{"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1462394103, "post_id": 37037462, "comment_id": 61625156, "body": "So don&#39;t use <code>Chart</code> and just try it with <code>Shapes</code> object?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1462394645, "post_id": 37037462, "comment_id": 61625413, "body": "A <code>Chart</code> is a <code>Shape</code> and some properties like the height and width are only available on the <code>Shape</code>."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 1, "creation_date": 1462501922, "post_id": 37037462, "comment_id": 61673008, "body": "The <code>chart</code> is contained within a special <code>shape</code> called a <code>chartobject</code>. The <code>chartobject</code> has all the properties of a <code>shape</code>. You can access the <code>chartobject</code> using <code>chart.parent</code>."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1462394311, "last_edit_date": 1462394311, "creation_date": 1462393840, "answer_id": 37037462, "question_id": 37035659, "link": "https://stackoverflow.com/questions/37035659/resize-a-chart-object-with-excel-vba/37037462#37037462", "title": "Resize a Chart Object with Excel VBA", "body": "<p>You could call \"Worksheet.Shapes.AddChart\" to create the chart and set the size:</p>\n\n\n\n<pre><code>With ActiveSheet.Shapes.AddChart(xlColumnClustered, Width:=100, Height:=100)\n  With .Chart\n    .SetSourceData ws1.Range(\"A2:C12\")\n  End With\n  .CopyPicture\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1462395649, "creation_date": 1462395649, "answer_id": 37037930, "question_id": 37035659, "link": "https://stackoverflow.com/questions/37035659/resize-a-chart-object-with-excel-vba/37037930#37037930", "title": "Resize a Chart Object with Excel VBA", "body": "<p>This is what I added </p>\n\n<pre><code>Set cht = ws1.Shapes.AddChart(xlColumnClustered, Width:=300, Height:=300).Chart\n</code></pre>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3153, "favorite_count": 0, "accepted_answer_id": 37037462, "answer_count": 2, "score": 0, "last_activity_date": 1462395649, "creation_date": 1462387710, "question_id": 37035659, "link": "https://stackoverflow.com/questions/37035659/resize-a-chart-object-with-excel-vba", "title": "Resize a Chart Object with Excel VBA", "body": "<p>I want to resize a <code>Chart</code> object. I am creating a graph from a set of data in Excel and inserting the graph in a Word doc via VBA. </p>\n\n<p>I tried to use <code>.Width</code> property from the <code>ChartObjects</code> object but I couldn't extend this to chart. ( I got an application error with <code>ws1.ChartObjects</code>.)</p>\n\n<pre><code>Sub CPU_Top_10_Chart()\n\nDim wdApp   As Word.Application\nDim wdDoc   As Word.Document\nDim cht     As Chart\nDim ws1     As Worksheet\n\n Set wdApp = CreateObject(\"Word.Application\")\n Set wdDoc = wdApp.Documents.Add(\"C:\\...\\chart_test.docx\")\n\n Set cht = Charts.Add\n Set ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\n\n With cht\n\n        .SetSourceData Source:=ws1.Range(\"A2:C12\")\n        .ChartType = xlColumnClustered\n\nEnd With\n\ncht.CopyPicture\nwdDoc.Bookmarks(\"insert_chart\").Range.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1462387548, "post_id": 37035594, "comment_id": 61621542, "body": "Do you know you can do this without VBA, with conditional formatting?"}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1462389360, "post_id": 37035594, "comment_id": 61622615, "body": "Yes, but this idea has other applications in my model such as writing a formula for a set of conditions and after that range another set of conditions."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1462390576, "post_id": 37035594, "comment_id": 61623222, "body": "Also that seems to be possible without VBA, with in-cell formulas."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462391763, "post_id": 37035594, "comment_id": 61623904, "body": "Your question is unclear. If <code>s</code> is a string variable which holds a value like &quot;A1&quot; then <code>Range(s)</code> works exactly like <code>Range(&quot;A1&quot;)</code>. By itself, that answers your question, though I suspect that you have larger questions about how VBA works."}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462395521, "post_id": 37035594, "comment_id": 61625880, "body": "@John Coleman, I just rephrased my question in my original post. Thanks for your help."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1462427655, "post_id": 37035594, "comment_id": 61635453, "body": "How do you know in which cells the start and end dates will be?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1462457285, "post_id": 37037940, "comment_id": 61652739, "body": "Ralph, thanks much. I just ran your code within my code. In your example, won&#39;t rng1 always be cell A1? How do I make A1 a variable cell address instead? The range changes in each scenario I run."}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1463069993, "post_id": 37037940, "comment_id": 61917409, "body": "Am I misunderstanding the above code? .Range(&quot;C3&quot;) is always cell reference C3, correct? How can C3 be a variable that I can declare in a previous step. Thanks."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1463070925, "post_id": 37037940, "comment_id": 61918030, "body": "<code>rng2</code> is the variable not <code>C3</code>. So, yes, above I am setting <code>rng2</code> to <code>C3</code>. But the good think about <b>variables</b> is that you can change them. You can change it to refer to <code>D1</code> or whatever you want. Still, it does not matter which range you want. At some point in your code you will have to write what you want (<code>C3</code> or <code>D1</code> or whatever else)."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1462395717, "creation_date": 1462395717, "answer_id": 37037940, "question_id": 37035594, "link": "https://stackoverflow.com/questions/37035594/how-to-select-a-range-of-cells-using-two-variables-in-vba/37037940#37037940", "title": "How to select a range of cells using two variables in VBA", "body": "<p>I am not sure if I understood the question correctly. So, please have a look at the following and let me know if this resolves your \"problem\":</p>\n\n<pre><code>Option Explicit\n\nPublic Sub tmpTest()\n\nDim rng1 As Range\nDim rng2 As Range\nDim rngComposite As Range\n\nWith ThisWorkbook.Worksheets(1)\n    Set rng1 = .Range(\"A1\")\n    Set rng2 = .Range(\"C3\")\n    Set rngComposite = .Range(rng1, rng2)\n    Debug.Print rngComposite.Address\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Essentially, the range <code>.Range(rng1, rng2)</code> is as dynamic as the underlying ranges and will change each time that <code>rng1</code> or <code>rng2</code> changes.</p>\n"}], "owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2701, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462395717, "creation_date": 1462387441, "last_edit_date": 1495542705, "question_id": 37035594, "link": "https://stackoverflow.com/questions/37035594/how-to-select-a-range-of-cells-using-two-variables-in-vba", "title": "How to select a range of cells using two variables in VBA", "body": "<p>I would like to use:</p>\n\n<pre><code>    Set rng1 = .Range(\"A1\")\n    Set rng2 = .Range(\"C3\")\n</code></pre>\n\n<p>as discussed in this <a href=\"https://stackoverflow.com/questions/12527725/how-to-create-a-range-from-2-ranges-in-vba\">link</a>. The OP had cell A1 and cell C3 as two separate one-cell ranges. He asked how to change the range so that all cells in between them are also included in a new bigger range. My issue is similar, but my cell range changes with each new scenario. Example #1 start date in cell D1 and end date in cell Y1, new range is D1:Y1; or example #2 start date in cell B1 and end date in cell AZ1, new range is B1:AZ1. How can I change the above code so that a variable can be used instead of a static range?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1462393182, "post_id": 37035298, "comment_id": 61624681, "body": "It seems with Excel 2010, directly copying worksheets always corrupts images contained on the sheet. There are workarounds to this (copying the worksheet then deleting objects in the new sheet and then copying and pasting the images from the old sheet directly), but I have not seen any direct solutions. <a href=\"http://stackoverflow.com/questions/5617122/inserted-image-fails-to-display-when-sheet-is-copied-to-another-workbook-in-exce\">This question</a> and <a href=\"http://stackoverflow.com/questions/31551700/excel-vba-code-to-move-worksheets-with-image-add-screen-updating-and-it-errors\">this</a> are similar."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6292237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baad5b16e830ce104c84810df3edebfd?s=128&d=identicon&r=PG&f=1", "display_name": "D. Souza", "link": "https://stackoverflow.com/users/6292237/d-souza"}, "is_accepted": false, "score": 0, "last_activity_date": 1462465533, "last_edit_date": 1495540780, "creation_date": 1462465533, "answer_id": 37055569, "question_id": 37035298, "link": "https://stackoverflow.com/questions/37035298/merging-multiple-worksheets-with-images-into-one-workbook-image-error/37055569#37055569", "title": "Merging multiple worksheets with Images into one workbook - Image error", "body": "<p>just found a workaround that helped!</p>\n\n<p>I just added \"Application.ScreenUpdating = True\" before closing the source workbook, it takes longer to merge all worsheets, but at least the images are displayed correctly!</p>\n\n<p>Here follows the new code:</p>\n\n<pre><code>Sub MergePlans()\nDim CurFile As String, DirLoc As String\nDim DestWB As Workbook\nDim ws As Object\n\nDirLoc = ThisWorkbook.Path &amp; \"\\Merge\\\" \nCurFile = Dir(DirLoc &amp; \"*.xlsx\")\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet DestWB = Workbooks.Add(xlWorksheet)\n\nDo While CurFile &lt;&gt; vbNullString\n    Dim OrigWB As Workbook\n    Set OrigWB = Workbooks.Open(Filename:=DirLoc &amp; CurFile, ReadOnly:=True)\n\n    For Each ws In OrigWB.Sheets\n        ws.Select\n        ws.Copy After:=DestWB.Sheets(DestWB.Sheets.Count)\n    Next\n    **Application.ScreenUpdating = True**\n    OrigWB.Close Savechanges:=False\n    CurFile = Dir\nLoop\n\nApplication.DisplayAlerts = False\nDestWB.Sheets(1).Delete\nApplication.DisplayAlerts = True\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nSet DestWB = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Found this workaround <a href=\"https://stackoverflow.com/questions/31551700/excel-vba-code-to-move-worksheets-with-image-add-screen-updating-and-it-errors\">here</a> - Option 1!</p>\n\n<p>Tks Dan!</p>\n"}], "owner": {"reputation": 1, "user_id": 6292237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baad5b16e830ce104c84810df3edebfd?s=128&d=identicon&r=PG&f=1", "display_name": "D. Souza", "link": "https://stackoverflow.com/users/6292237/d-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462465533, "creation_date": 1462386459, "last_edit_date": 1531164843, "question_id": 37035298, "link": "https://stackoverflow.com/questions/37035298/merging-multiple-worksheets-with-images-into-one-workbook-image-error", "title": "Merging multiple worksheets with Images into one workbook - Image error", "body": "<p>I just started using VBA and I've been using a code to merge multiple worksheets into a single workbook, it works fine except for worksheets containing images. In these cases the image won't show in the new workbook created. It appears the box where the image should be with an error message. I use MS Office 2010. </p>\n\n<p>Here follows the code I've been using:</p>\n\n<pre><code>Sub MergePlans()\nDim CurFile As String, DirLoc As String\nDim DestWB As Workbook\nDim ws As Object\n\nDirLoc = ThisWorkbook.Path &amp; \"\\Merge\\\" \nCurFile = Dir(DirLoc &amp; \"*.xlsx\")\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet DestWB = Workbooks.Add(xlWorksheet)\n\nDo While CurFile &lt;&gt; vbNullString\n    Dim OrigWB As Workbook\n    Set OrigWB = Workbooks.Open(Filename:=DirLoc &amp; CurFile, ReadOnly:=True)\n\n    For Each ws In OrigWB.Sheets\n        ws.Select\n        ws.Copy After:=DestWB.Sheets(DestWB.Sheets.Count)\n    Next\n\n    OrigWB.Close Savechanges:=False\n    CurFile = Dir\nLoop\n\nApplication.DisplayAlerts = False\nDestWB.Sheets(1).Delete\nApplication.DisplayAlerts = True\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nSet DestWB = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Any idea of what is going on? I'd appreciate any help!\nTks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462385483, "post_id": 37034937, "comment_id": 61620246, "body": "It works, I&#39;m an idiot. Thankyou..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1462387516, "post_id": 37034937, "comment_id": 61621521, "body": "Also, I recommend not using <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>.Select</code></a>.So, just snug up your line ending in <code>.Select</code> with the part after the next line&#39;s <code>Activecell.</code>  So, <code>Cells(a, 3).EntireRow.Delete = True</code>  ...which is what @Findwindow suggested.   That&#39;s probably why you were getting the error (just if you were wondering)."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462389226, "post_id": 37034937, "comment_id": 61622537, "body": "So false alarm. It doesn&#39;t work as intended. When I tried @findwindow&#39;s the macro deleted a lot more than intended    What am I doing wrong? When I ran the code with  <b>Cells(a, 3).EntireRow.Delete</b> the macro deleted all cells aside from 3 where the 3 that were left the cells don&#39;t match at all..    I&#39;m trying to delete rows where cell A and cell B DONT match. It seems to be doing the opposite. <b>&lt;&gt;</b> is the not equals operator in VBA isnt it?"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462390225, "post_id": 37034937, "comment_id": 61623053, "body": "My apologies for being unclear and seriously thankyou for the help I really appreciate it. To clarify I am comparing columns H and I as you stated. What I want to do is have the macro identify if the cells are exactly the same. If they are not the entire row is deleted."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462393354, "post_id": 37034937, "comment_id": 61624775, "body": "@findwindow Yes I am. When I put in &quot;= True&quot; I get an object error so I took it out. It only runs without the &quot;= True&quot; part. When It does it seems to delete anything that is similar.."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462395534, "post_id": 37034937, "comment_id": 61625888, "body": "I added the photos in the original post. The first Picture is the input, the second is the output.."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462396382, "post_id": 37034937, "comment_id": 61626289, "body": "Do you mean <b>Trim (Cells(a, 3).EntireRow.Delete)</b>? It still has similar output to what I posted.."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462396964, "post_id": 37034937, "comment_id": 61626568, "body": "I&#39;ll be honest I&#39;m not sure what <b>lr = Range(&quot;C65536&quot;).End(xlUp).Row</b> means..  Sadly the Trim function still does not fix the issue. But no worries :) thankyou for all youve done!"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462397695, "post_id": 37034937, "comment_id": 61626937, "body": "I am because you&#39;re helping me :)"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1462397717, "post_id": 37034937, "comment_id": 61626945, "body": "I can&#39;t get this macro to do what I want, its so annoying :P"}], "answers": [{"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 1, "last_activity_date": 1462401608, "last_edit_date": 1462401608, "creation_date": 1462401297, "answer_id": 37039202, "question_id": 37034937, "link": "https://stackoverflow.com/questions/37034937/vba-how-to-delete-rows-when-value-of-column-x-does-not-match-value-of-column-y/37039202#37039202", "title": "VBA How to Delete Rows when value of Column X does not match value of column Y", "body": "<p>Try this. This could break if second column has more words than first XD</p>\n\n<pre><code>Sub Gooddata()\n\nDim lr As Long\nDim arr As Variant\nDim brr As Variant\n\nApplication.ScreenUpdating = False\n\nWith ActiveSheet\n\nlr = .Cells(.Rows.count, \"G\").End(xlUp).Row\n\nFor A = lr To 1 Step -1\n\n    I = 0\n    arr = Split(Trim(.Cells(A, 7).Value2), \" \")\n    brr = Split(Trim(.Cells(A, 8).Value2), \" \")\n\n    For Each e In arr\n\n        '.Cells(A, 9) = e\n        If e &lt;&gt; brr(I) Then\n            .Cells(A, 3).EntireRow.Delete\n            Exit For\n            'GoTo yarr\n        End If\n        I = I + 1\n\n    Next e\n\n'yarr:\n'Erase arr\n'Erase brr\n\nNext A\n\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ey8Mp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ey8Mp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M7Dyx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7Dyx.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1462401608, "creation_date": 1462385169, "last_edit_date": 1462395804, "question_id": 37034937, "link": "https://stackoverflow.com/questions/37034937/vba-how-to-delete-rows-when-value-of-column-x-does-not-match-value-of-column-y", "title": "VBA How to Delete Rows when value of Column X does not match value of column Y", "body": "<p>I'm trying to delete every row where the cell value for column x does not match the cell value of column y. I keep getting an object error and I'm pretty sure I'm missing something obvious. </p>\n\n<pre><code>Sub Gooddata()\n\nApplication.ScreenUpdating = False\n\nlr = Range(\"C65536\").End(xlUp).Row\nFor a = lr To 1 Step -1\nIf Cells(a, 8).Value &lt;&gt; Cells(a, 9).Value Then\nCells(a, 3).Select\nActiveCell.EntireRow.Delete = True\nEnd If\nNext a\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Edit: I have made edits to the code based on the suggestions of the comments here's the input image the code and the output image. </p>\n\n<p><a href=\"https://i.stack.imgur.com/h6UJS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h6UJS.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Gooddata()\n\nApplication.ScreenUpdating = False\n\nlr = Range(\"C65536\").End(xlUp).Row\nFor a = lr To 1 Step -1\nIf Cells(a, 8).Value &lt;&gt; Cells(a, 9).Value Then\nCells(a, 3).EntireRow.Delete\nEnd If\nNext a\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If the code executed in the way that I want it to Old Argus Building 12 will not be deleted however the row below it will because of the comma and dash. </p>\n\n<p><a href=\"https://i.stack.imgur.com/11tUC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/11tUC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1462541034, "post_id": 37035337, "comment_id": 61691659, "body": "this works except this will add the value given to Column N in this example and apply it to subsequent columns. I would like the value inputed in the user form to add to the CURRENT value , not get the value from one column and drag it to the rest of the columns"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1462544322, "post_id": 37035337, "comment_id": 61694002, "body": "@Luis see edit about. You can loop over the new range, and add the TextBox value to each individual cell."}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1462546943, "post_id": 37035337, "comment_id": 61695846, "body": "would I add the For Each in each individual case?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1462547210, "post_id": 37035337, "comment_id": 61696012, "body": "@ You don&#39;t need to add it in the <code>Select Case</code> block. The code would be added in the same place that it exists in your current code. Right now, your code read:     With ws         .Cells(irow, &quot;A&quot;).value = Me.PartTextBox.value         .Cells(irow, iCol).value = .Cells(irow, iCol).value + CLng(Me.AddTextBox.value)     End With. You&#39;d add the <code>For Each</code> loop directly in the line below <code>.Cells(irow, A).value</code>."}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1462547559, "post_id": 37035337, "comment_id": 61696223, "body": "I have done as instructed and I am getting a invalid or unqualified reference and it highlights .cells"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 1, "creation_date": 1462548171, "post_id": 37035337, "comment_id": 61696642, "body": "@Luis I edited my post again to include the whole source code. Check to see how I implemented <code>nExtend</code> variable, and check where I implemented the Loop. Let me know if that clears things up"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1462548128, "last_edit_date": 1462548128, "creation_date": 1462386575, "answer_id": 37035337, "question_id": 37034929, "link": "https://stackoverflow.com/questions/37034929/add-userform-value-to-multiple-columns/37035337#37035337", "title": "Add userform Value to Multiple Columns", "body": "<h2>EDIT TO INCLUDE ALL SOURCE CODE:</h2>\n\n<pre><code>Private Sub cmdAdd_Click()\n    If TrialVersion Then Exit Sub\n\n    Dim irow As Long\n    Dim lastRow As Long\n    Dim iCol As String\n    Dim c As Range\n    Dim ws As Worksheet\n    Dim value As Long\n    Dim NewPart As Boolean\n    Dim ws_warehouse(7) As Worksheet    '7 is total warehouse tab you have\n    Dim nExtend As Integer\n    Dim cel As Range\n\n    Set ws = Worksheets(\"Main\")\n\n    Set ws_warehouse(1) = Worksheets(\"Elkhart East\")\n    Set ws_warehouse(2) = Worksheets(\"Tennessee\")\n    Set ws_warehouse(3) = Worksheets(\"Alabama\")\n    Set ws_warehouse(4) = Worksheets(\"North Carolina\")\n    Set ws_warehouse(5) = Worksheets(\"Pennsylvania\")\n    Set ws_warehouse(6) = Worksheets(\"Texas\")\n    Set ws_warehouse(7) = Worksheets(\"West Coast\")\n\n    Set c = ws.Range(\"A7:A1048576\").Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n            SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole)\n    If c Is Nothing Then\n    'find first empty row in database\n        lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n        irow = lastRow + 1\n        NewPart = True\n    Else\n    'find row where the part is\n        irow = ws.Cells.Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n            SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n        NewPart = False\n    End If\n\n    'check for a part number\n    If Trim(Me.PartTextBox.value) = \"\" Then\n      Me.PartTextBox.SetFocus\n      MsgBox \"Please Enter A Part Number\"\n      Exit Sub\n    End If\n\n    If Trim(Me.MonthComboBox.value) = \"\" Then\n      Me.MonthComboBox.SetFocus\n      MsgBox \"Please Enter A Month\"\n      Exit Sub\n    End If\n\n    If Trim(Me.AddTextbox.value) = \"\" Then\n      Me.AddTextbox.SetFocus\n      MsgBox \"Please Enter A Value To Add Or Substract\"\n      Exit Sub\n    End If\n\n    nExtend = 1 'Set this as a default.\n    Select Case MonthComboBox.value\n        Case \"Current Month\"\n            iCol = \"C\"\n\n        Case \"Current Month +1\"\n            iCol = \"N\"\n            nExtend = 4\n        Case \"Current Month +2\"\n            iCol = \"O\"\n            nExtend = 3\n        Case \"Current Month +3\"\n            iCol = \"P\"\n            nExtend = 2\n        Case \"Current Month +4\"\n            iCol = \"Q\"\n    End Select\n\n    actWarehouse = Me.warehousecombobox.ListIndex + 1\n\n    With ws\n        .Cells(irow, \"A\").value = Me.PartTextBox.value\n\n        For Each cel In .Cells(irow, iCol).Resize(, nExtend)\n            cel.value = cel.value + CLng(Me.AddTextbox.value)\n        Next cel\n    End With\n\n    With ws_warehouse(actWarehouse)\n        'find part number\n        l_row = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        NewPart = True\n        For r = 7 To l_row\n            If Trim(.Range(\"A\" &amp; r)) = \"\" Then Exit For\n            If LCase(.Range(\"A\" &amp; r)) = LCase(Me.PartTextBox.Text) Then\n                irow = r\n                Exit For\n                NewPart = False\n            End If\n        Next r\n        If NewPart Then irow = r\n\n        .Cells(irow, \"A\").value = Me.PartTextBox.value\n        .Cells(irow, iCol).value = .Cells(irow, iCol).value + CLng(Me.AddTextbox.value)\n    End With\n\n    'clear the data\n    Me.PartTextBox.value = \"\"\n    Me.MonthComboBox.value = \"\"\n    Me.AddTextbox.value = \"\"\n    Me.PartTextBox.SetFocus\n    Me.warehousecombobox.value = \"\"\n\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    'Empty NameTextBox\n     PartTextBox.value = \"\"\n\n    'Empty PhoneTextBox\n     AddTextbox.value = \"\"\n\n    'Empty DinnerComboBox\n\n    'Fill DinnerComboBox\n    With MonthComboBox\n         .AddItem \"Current Month\"\n         .AddItem \"Current Month +1\"\n         .AddItem \"Current Month +2\"\n         .AddItem \"Current Month +3\"\n         .AddItem \"Current Month +4\"\n\n    End With\n\n    With warehousecombobox\n        .AddItem \"Elkhart East\"\n        .AddItem \"Tennessee\"\n        .AddItem \"Alabama\"\n        .AddItem \"North Carolina\"\n        .AddItem \"Pennsylvania\"\n        .AddItem \"Texas\"\n        .AddItem \"West Coast\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If the columns are always consecutive, maybe you can add a second <code>integer</code> variable that tells the code how many columns to include. As an example, in your post, you show that <code>Current Month + 1</code> starts at <code>Column N</code> and extends 3 columns to the right (O, P, Q). Your code could look something like:</p>\n\n<pre><code>Select Case MonthComboBox.value\n    Case \"Current Month + 1\"\n        iCol = \"C\"\n        nExtend = 4 \n</code></pre>\n\n<p>Then when you handle the values, the code would look something like:</p>\n\n<pre><code>.Cells(irow, iCol).Resize(,nExtend).value = .Cells(irow, iCol).value + CLng(Me.AddTextBox.value)\n</code></pre>\n\n<p>Note: Even though you are technically extending 3 columns, the input to the <code>Resize</code> function is 4. Also note the leading comma because we are not changing the row resize.</p>\n\n<h2>EDIT BASED ON NEW INFO:</h2>\n\n<p>Use a loop to change each value in the range, such as below:</p>\n\n<pre><code>Select Case MonthComboBox.value\n    Case \"Current Month + 1\"\n        iCol = \"C\"\n        nExtend = 4 \n\nFor Each cel in .Cells(irow, iCol).Resize(,nExtend)\n    cel.Value = cel.Value + CLng(Me.AddTextBox.Value)\nNext cel\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 37035337, "answer_count": 1, "score": 0, "last_activity_date": 1462548128, "creation_date": 1462385144, "last_edit_date": 1462453512, "question_id": 37034929, "link": "https://stackoverflow.com/questions/37034929/add-userform-value-to-multiple-columns", "title": "Add userform Value to Multiple Columns", "body": "<p>Hey guys this one is a complicated one. I have created a userform that will add a value from a user to a certain column (THIS IS CURRENT CODE). However instead of just adding it to that column I want it to add it to the subsequent columns. For example if I were to select current +1 and value=500 I want that value to add it to column N and subsequent \"O\", \"P\" \"Q\". I thought it would be easy as adding it to the case but it's not that easy</p>\n\n<pre><code>        Case \"Current Month +1\"\n            iCol = \"N\" and \"O\" and \"P\" and \"Q\"\n\n        Case \"Current Month +2\"\n            iCol = \"O\" and \"P\" and \"Q\"\n</code></pre>\n\n<p>****It's not this easy</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n    If TrialVersion Then Exit Sub\n\n    Dim irow As Long\n    Dim lastRow As Long\n    Dim iCol As String\n    Dim c As Range\n    Dim ws As Worksheet\n    Dim value As Long\n    Dim NewPart As Boolean\n    Dim ws_warehouse(7) As Worksheet    '7 is total warehouse tab you have\n\n    Set ws = Worksheets(\"Main\")\n\n    Set ws_warehouse(1) = Worksheets(\"Elkhart East\")\n    Set ws_warehouse(2) = Worksheets(\"Tennessee\")\n    Set ws_warehouse(3) = Worksheets(\"Alabama\")\n    Set ws_warehouse(4) = Worksheets(\"North Carolina\")\n    Set ws_warehouse(5) = Worksheets(\"Pennsylvania\")\n    Set ws_warehouse(6) = Worksheets(\"Texas\")\n    Set ws_warehouse(7) = Worksheets(\"West Coast\")\n\n    Set c = ws.Range(\"A7:A1048576\").Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n            SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole)\n    If c Is Nothing Then\n    'find first empty row in database\n        lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n        irow = lastRow + 1\n        NewPart = True\n    Else\n    'find row where the part is\n        irow = ws.Cells.Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n            SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n        NewPart = False\n    End If\n\n    'check for a part number\n    If Trim(Me.PartTextBox.value) = \"\" Then\n      Me.PartTextBox.SetFocus\n      MsgBox \"Please Enter A Part Number\"\n      Exit Sub\n    End If\n\n    If Trim(Me.MonthComboBox.value) = \"\" Then\n      Me.MonthComboBox.SetFocus\n      MsgBox \"Please Enter A Month\"\n      Exit Sub\n    End If\n\n    If Trim(Me.AddTextBox.value) = \"\" Then\n      Me.AddTextBox.SetFocus\n      MsgBox \"Please Enter A Value To Add Or Substract\"\n      Exit Sub\n    End If\n\n    Select Case MonthComboBox.value\n        Case \"Current Month\"\n            iCol = \"C\"\n\n        Case \"Current Month +1\"\n            iCol = \"N\"\n\n        Case \"Current Month +2\"\n            iCol = \"O\"\n\n        Case \"Current Month +3\"\n            iCol = \"P\"\n\n        Case \"Current Month +4\"\n            iCol = \"Q\"\n    End Select\n\n    actWarehouse = Me.warehousecombobox.ListIndex + 1\n\n    With ws\n        .Cells(irow, \"A\").value = Me.PartTextBox.value\n        .Cells(irow, iCol).value = .Cells(irow, iCol).value + CLng(Me.AddTextBox.value)\n    End With\n\n    With ws_warehouse(actWarehouse)\n        'find part number\n        l_row = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        NewPart = True\n        For r = 7 To l_row\n            If Trim(.Range(\"A\" &amp; r)) = \"\" Then Exit For\n            If LCase(.Range(\"A\" &amp; r)) = LCase(Me.PartTextBox.Text) Then\n                irow = r\n                Exit For\n                NewPart = False\n            End If\n        Next r\n        If NewPart Then irow = r\n\n        .Cells(irow, \"A\").value = Me.PartTextBox.value\n        .Cells(irow, iCol).value = .Cells(irow, iCol).value + CLng(Me.AddTextBox.value)\n    End With\n\n    'clear the data\n    Me.PartTextBox.value = \"\"\n    Me.MonthComboBox.value = \"\"\n    Me.AddTextBox.value = \"\"\n    Me.PartTextBox.SetFocus\n    Me.warehousecombobox.value = \"\"\n\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    'Empty NameTextBox\n     PartTextBox.value = \"\"\n\n    'Empty PhoneTextBox\n     AddTextBox.value = \"\"\n\n    'Empty DinnerComboBox\n\n    'Fill DinnerComboBox\n    With MonthComboBox\n         .AddItem \"Current Month\"\n         .AddItem \"Current Month +1\"\n         .AddItem \"Current Month +2\"\n         .AddItem \"Current Month +3\"\n         .AddItem \"Current Month +4\"\n\n    End With\n\n    With warehousecombobox\n        .AddItem \"Elkhart East\"\n        .AddItem \"Tennessee\"\n        .AddItem \"Alabama\"\n        .AddItem \"North Carolina\"\n        .AddItem \"Pennsylvania\"\n        .AddItem \"Texas\"\n        .AddItem \"West Coast\"\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5293913, "user_type": "registered", "profile_image": "https://graph.facebook.com/821026689128/picture?type=large", "display_name": "Britain Bruner", "link": "https://stackoverflow.com/users/5293913/britain-bruner"}, "edited": false, "score": 0, "creation_date": 1462392842, "post_id": 37034951, "comment_id": 61624487, "body": "Thanks for the tool! This works great in excel, so it must be my paste into word that&#39;s messing it up. I can get the correct range readouts and everything, but it disregards the skip between columns b and d.   I can recreate multiple sheets, that may be easier for importing into word.  I&#39;ve got a couple more hours at work to tinker, will post any progress."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1462385201, "creation_date": 1462385201, "answer_id": 37034951, "question_id": 37034681, "link": "https://stackoverflow.com/questions/37034681/excel-vba-macro-copy-paste-static-range-with-dynamic-range/37034951#37034951", "title": "Excel VBA Macro Copy/Paste static range with dynamic range", "body": "<p>Here is a code snippet which simplifies your problem</p>\n\n<pre><code>Sub Test()\n\nSet rangeA = Range(\"A1:B2\")\nSet rangeB = Range(\"D1:D2\")\n\nSet rangeC = Range(rangeA, rangeB)\nMsgBox (\"rangeC is \" &amp; rangeC.Address)\n\nSet rangeD = Union(rangeA, rangeB)\nMsgBox (\"rangeD is \" &amp; rangeD.Address)\n\nEnd Sub \n</code></pre>\n\n<p>Like you it creates two ranges which aren't next to each other then it attempts to join the two.  </p>\n\n<p>If you just use rangeC=range(rangeA,rangeB) it creates a range from the start of rangeA to the end of range B (\"A1:D2\")</p>\n\n<p>if you use rangeD=union(rangeA,rangeB) it creates a non continuous range of the two combined (\"A1:B2,D1:D2\").</p>\n\n<p>then you won't get column C included.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5293913, "user_type": "registered", "profile_image": "https://graph.facebook.com/821026689128/picture?type=large", "display_name": "Britain Bruner", "link": "https://stackoverflow.com/users/5293913/britain-bruner"}, "is_accepted": false, "score": 0, "last_activity_date": 1463519469, "creation_date": 1463519469, "answer_id": 37286300, "question_id": 37034681, "link": "https://stackoverflow.com/questions/37034681/excel-vba-macro-copy-paste-static-range-with-dynamic-range/37286300#37286300", "title": "Excel VBA Macro Copy/Paste static range with dynamic range", "body": "<p>Finished it, it works but has a few kinks if you run it more than once without closing out.</p>\n\n<p>Sub PrinttoWord()\n       'this macro prints the excel table of fireworks to a word document, currently formatting works up through most of the tables. Formatting breaks at fountains</p>\n\n<pre><code>   'Dim Selection As Excel.Application\n   Dim CFsh As Worksheet\n   Dim Traffic As Worksheet\n   Dim Template As Range\n   Dim lastcol As Integer\n   Dim lastrow As Integer\n   Dim lastcolT As Integer\n   Dim lastrowT As Integer\n   Dim i As Integer\n   Dim WordApp As Word.Application\n   Dim WordDoc As Word.Document\n   Dim WordCont As Range\n   Dim strFWDoc As String\n   Dim IDQRange As Range\n   Dim AnswRange As Range\n   Dim FWTable As Range\n   Dim CFTables As Range\n   Dim DevDef As Range\n   Dim Defbox As Range\n   Dim j As Integer\n\n\n\n\n   Set CFsh = Sheets(\"ConsumerFireworks\")\n   Set Traffic = Sheets(\"Traffic\")\n\n   'Finding CFsh Array's end boundaries\n   lastcol = CFsh.Cells(4, CFsh.Columns.Count).End(xlToLeft).Column\n   lastrow = CFsh.Cells(CFsh.Rows.Count, 1).End(xlUp).Row\n\n\n   'Optimize Code\n   Application.ScreenUpdating = False\n   Application.EnableEvents = False\n\n   'Copy Tables\n   For i = 3 To lastcol\n   'i = 4 'control\n   CFsh.Activate\n\n   Set IDQRange = CFsh.Range(CFsh.Cells(4, 1), CFsh.Cells(lastrow, 2))\n   Set AnswRange = CFsh.Range(CFsh.Cells(4, i), CFsh.Cells(lastrow, i))\n\n   Set FWTable = Range(IDQRange, AnswRange)\n   Set CFTables = Union(IDQRange, AnswRange)\n\n   CFTables.Copy\n\n   'Finding Traffic Array's end boundaries\n\n\n\n   'MsgBox (\"CFTables is \" &amp; CFTables.Address) examination\n\n\n\n\n\n   Traffic.Range(\"A1\").PasteSpecial Paste:=xlPasteAll\n   Application.CutCopyMode = False\n\n   lastcolT = Traffic.Cells(1, Traffic.Columns.Count).End(xlToLeft).Column\n   lastrowT = Traffic.Cells(Traffic.Rows.Count, 1).End(xlUp).Row\n\n   Set Template = Traffic.Range(Traffic.Cells(1, 1), Traffic.Cells(lastrowT, lastcolT))\n   Template.AutoFilter Field:=3, Criteria1:=\"&lt;&gt;#N/A\", Operator:=xlFilterValues\n   'Template.Columns.AutoFit\n   ' Merge Device Definition\n   Set DevDef = Traffic.Range(\"B1\")\n   Set Dev = Traffic.Cells(1, 3)\n   Set Defbox = Traffic.Range(DevDef, Dev)\n   Traffic.Activate\n\n       DevDef.Select\n       Selection.ClearContents\n       Defbox.Select\n       Selection.Merge\n       With Defbox\n           .HorizontalAlignment = xlLeft\n           .VerticalAlignment = xlTop\n           .WrapText = True\n           .Orientation = 0\n           .AddIndent = False\n           .IndentLevel = 0\n           .ShrinkToFit = False\n           .ReadingOrder = xlContext\n           .MergeCells = True\n       End With\n       Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n       Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n       With Selection.Borders(xlEdgeLeft)\n           .LineStyle = xlContinuous\n           .ColorIndex = 0\n           .TintAndShade = 0\n           .Weight = xlMedium\n       End With\n       With Selection.Borders(xlEdgeTop)\n           .LineStyle = xlContinuous\n           .ColorIndex = 0\n           .TintAndShade = 0\n           .Weight = xlMedium\n       End With\n       With Selection.Borders(xlEdgeBottom)\n           .LineStyle = xlContinuous\n           .ColorIndex = 0\n           .TintAndShade = 0\n           .Weight = xlMedium\n       End With\n       With Selection.Borders(xlEdgeRight)\n           .LineStyle = xlContinuous\n           .ColorIndex = 0\n           .TintAndShade = 0\n           .Weight = xlMedium\n       End With\n       Selection.Borders(xlInsideVertical).LineStyle = xlNone\n       Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n\n\n\n   Columns(\"A:A\").Select\n       Selection.ColumnWidth = 4.6\n       Columns(\"B:B\").Select\n       Range(\"B2\").Activate\n       Selection.ColumnWidth = 39.4\n       Columns(\"C:C\").Select\n       'Range(\"C2\").Activate\n       'Selection.ColumnWidth = 39.4\n\n   Template.Rows.AutoFit\n\n   Template.Copy\n\n   'Word not already open error\n   On Error Resume Next\n\n\n\n   'Activate word if it is open\n   Set WordApp = GetObject(class:=\"Word.Application\")\n   If Err.Number = 429 Then\n   Err.Clear\n   'Create a word application if word is not open\n   Set WordApp = CreateObject(\"Word.Application\")\n   End If\n\n   'Set word app visible\n       WordApp.Visible = False\n\n   'define FWDoc path\n\n   strFWDoc = Application.ActiveWorkbook.Path &amp; \"\\Fireworks.docm\"\n\n   'Check for document name in folder path, if not recognized, inform the user and exitmacro.\n   If Dir(strFWDoc) = \"\" Then\n   MsgBox \"The file was not found in the folder/\", cbExclamation, \"Sorry, that document does not exist.\"\n\n   End If\n\n   'Activate Word\n\n   WordApp.Activate\n   'Set WordDoc = WordApp.Documents(\"Fireworks.docx\")\n   Set WordDoc = WordApp.Documents(strFWDoc)\n   'If not open, then open\n   If WordDoc Is Nothing Then Set WordDoc = WordApp.Documents.Open(strFWDoc)\n   'activate document\n   WordDoc.Activate\n\n\n\n   'Paste to word\n   If i &gt; 3 Then WordDoc.Range(WordDoc.Content.End - 1).InsertBreak Type:=wdPageBreak\n\n   xLApp.Activate\n   CFsh.Activate\n   Set SubSec = CFsh.Cells(2, i)\n       SubSec.Copy\n       WordApp.Activate\n       WordDoc.Range(WordDoc.Content.End - 1).PasteAndFormat (wdFormatOriginalText)\n       'WordDoc.Range(WordDoc.Content.End).Select\n       'Selection.Style = ActiveDocument.Styles(\"FW Subsection\")\n       Application.CutCopyMode = False\n       'WordDoc.Range.InsertParagraphAfter\n   xLApp.Activate\n   CFsh.Activate\n   Set DeviceName = CFsh.Cells(3, i)\n       DeviceName.Copy\n       WordApp.Activate\n       WordDoc.Range(WordDoc.Content.End - 1).PasteAndFormat (wdFormatOriginalText)\n       'WordDoc.Range(WordDoc.Content.End).Select\n       'Selection.Style = ActiveDocument.Styles(\"FW Device Name\")\n       Application.CutCopyMode = False\n       'WordDoc.Range.InsertParagraphAfter\n   xLApp.Activate\n   Template.Copy\n   WordApp.Activate\n       WordDoc.Range(WordDoc.Content.End - 1).Paste\n       WordDoc.Range.InsertParagraphAfter\n       Application.CutCopyMode = False\n\n   j = j + 1\n\n       'working method pasting and inserting page break\n       WordDoc.Range(WordDoc.Content.End - 1).Paste 'AndFormat (wdFormatOriginalText)\n       WordDoc.Tables(j).Select\n       WordApp.Selection.Style = ActiveDocument.Styles(\"No Spacing\")\n       'Application.CutCopyMode = False\n       'WordDoc.Range.InsertParagraphAfter\n\n   'With WordDoc\n   '    .Content.Style = .Styles(\"No Spacing\")\n   'End With\n\n\n\n       'Feeble attempt to hide coppied cells\n       CFsh.Columns(i).Hidden = True\n       Application.CutCopyMode = False\n       Template.AutoFilter\n       Traffic.Cells.Delete\n\n\n\n   Next i\n\n   'WordDocNotFound:\n   'MsgBox \"Microsoft Word File 'Practice.docx' is not currently open, Terminating.\", 16\n\n   CFsh.Columns.Hidden = False\n   Application.CutCopyMode = False\n   WordApp.Visible = True\n\n\n\n\n\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5293913, "user_type": "registered", "profile_image": "https://graph.facebook.com/821026689128/picture?type=large", "display_name": "Britain Bruner", "link": "https://stackoverflow.com/users/5293913/britain-bruner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 778, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1463519469, "creation_date": 1462384174, "last_edit_date": 1462395914, "question_id": 37034681, "link": "https://stackoverflow.com/questions/37034681/excel-vba-macro-copy-paste-static-range-with-dynamic-range", "title": "Excel VBA Macro Copy/Paste static range with dynamic range", "body": "<p>Good morning everyone.</p>\n\n<p>I am not to active on here but here is a project I am working on (it's a lot of search, copy, paste, try, edit, repeat) - </p>\n\n<p>It's a table with Multiple columns built like this:</p>\n\n<p><p>Col 1    | Col 2   | Col 3    | Col 4  |  ...  | Col i\n<p>Row 1    |  Row 1  |  Row 1   |  Row 1 |  ...  |  Row 1\n<p>Row 2    |  Row 2  |  Row 2   |  Row 2 |  ...  |  Row 2\n<p> ...\n<p>Row n    |  Row n  |  Row n   |  Row n |  ...  |  Row n</p>\n\n<pre><code>Sub CopySubsectionToTable()\n\nDim CFsh As Worksheet\nDim lastcol As Integer\nDim lastrow As Integer\nDim i As Integer\nDim WordApp As Word.Application\nDim WordDoc As Word.Document\nDim IDQRange As Range\nDim AnswRange As Range\nDim FWTable As Range\n\nSet CFsh = Sheets(\"ConsumerFireworks\")\n\n'Finding CFsh Array's end boundaries\nlastcol = CFsh.Cells(4, CFsh.Columns.Count).End(xlToLeft).Column\nlastrow = CFsh.Cells(CFsh.Rows.Count, 1).End(xlUp).Row\nSet IDQRange = CFsh.Range(CFsh.Cells(4, 1), CFsh.Cells(lastrow, 2))\n\n'Optimize Code\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n'Set Destination To Word Document\nSet WordApp = CreateObject(class:=\"Word.Application\")\n    WordApp.Visible = True\nSet WordDoc = WordApp.Documents.Add\n\n'Copy Tables\n\nFor i = 4 To lastcol\nSet AnswRange = CFsh.Range(CFsh.Cells(4, i), CFsh.Cells(lastrow, i))\nSet FWTable = Range(IDQRange, AnswRange)\n\nFWTable.Resize(, i).Copy\n\nIf i &gt; 4 Then WordDoc.Range(WordDoc.Content.End - 1).InsertBreak Type:=wdPageBreak\n\n    WordDoc.Range(WordDoc.Content.End - 1).Paste\n    WordDoc.Range.InsertParagraphAfter\n\n    'Feeble attempt to hide coppied cells\n    CFsh.Columns(i).Hidden = True\n\nNext i\n\nCFsh.Columns.Hidden = False\nApplication.CutCopyMode = False\nSet AppWord = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The result looks like this</p>\n\n<p><p>Column 1 | Column 2| Column 3 | Column i\n<p>Row 1    |  Row 1  |  Row 1   |  Row 1\n<p>Row 2    |  Row 2  |  Row 2   |  Row 2\n<p> ...\n<p>Row n    |  Row n  |  Row n   |  Row n</p>\n\n<p><p><i> page break</i></p>\n\n<p><p>Column 1 | Column 2| Column 3 | Column i\n<p>Row 1    |  Row 1  |  Row 1   |  Row 1\n<p>Row 2    |  Row 2  |  Row 2   |  Row 2\n<p> ...\n<p>Row n    |  Row n  |  Row n   |  Row n</p>\n\n<p><p><i> page break</i></p>\n\n<p><p><i> repeats to i</i></p>\n\n<p>Why is it copy/pasting column 3? I'd like it to skip through the massive table, keep the col 1, col 2, and then take every column after column 3 to make a table between each page break. </p>\n\n<p>Any help or direction would be appreciated.  Thanks!</p>\n\n<p><p><b>UPDATE</b></p>\n\n<p>Here is a control I am running - </p>\n\n<pre><code>Sub CopySubsectionToTable()\n\nDim CFsh As Worksheet\nDim lastcol As Integer\nDim lastrow As Integer\nDim i As Integer\nDim WordApp As Word.Application\nDim WordDoc As Word.Document\nDim IDQRange As Range\nDim AnswRange As Range\nDim FWTable As Range\nDim CFTables As Range\n\nSet CFsh = Sheets(\"ConsumerFireworks\")\n\n'Finding CFsh Array's end boundaries\nlastcol = CFsh.Cells(4, CFsh.Columns.Count).End(xlToLeft).Column\nlastrow = CFsh.Cells(CFsh.Rows.Count, 1).End(xlUp).Row\nSet IDQRange = CFsh.Range(CFsh.Cells(4, 1), CFsh.Cells(lastrow, 2))\n\n'Optimize Code\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n'Set Destination To Word Document\nSet WordApp = CreateObject(class:=\"Word.Application\")\n    WordApp.Visible = True\nSet WordDoc = WordApp.Documents.Add\n\n'Copy Tables\n\n'For i = 4 To lastcol\ni = 4\nSet AnswRange = CFsh.Range(CFsh.Cells(4, i), CFsh.Cells(lastrow, i))\nSet FWTable = Range(IDQRange, AnswRange)\nSet CFTables = Union(IDQRange, AnswRange)\nMsgBox (\"CFTables is \" &amp; CFTables.Address)\n\n'FWTable.Resize(, i).Copy\nCFTables.Copy\n\nIf i &gt; 4 Then WordDoc.Range(WordDoc.Content.End - 1).InsertBreak Type:=wdPageBreak\n\n    WordDoc.Range(WordDoc.Content.End - 1).Paste\n    'typical location for copypaste error\n    WordDoc.Range.InsertParagraphAfter\n\n    'Feeble attempt to hide coppied cells\n    CFsh.Columns(i).Hidden = True\n\n'Next i\n\nCFsh.Columns.Hidden = False\nApplication.CutCopyMode = False\nSet AppWord = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Setting the CFTables Union gives me the correct address i.e. $A$1:$B$50,$D$1:$D$50</p>\n\n<p>Aside from the copy paste error with teh clipboard I aim to clean up later, it pastes teh one table into word with Column C!</p>\n\n<p>I suspect this is the culprit</p>\n\n<pre><code>WordDoc.Range(WordDoc.Content.End - 1).Paste\n</code></pre>\n\n<p><p><b>UPDATE#2</b></p>\n\n<p>Well *#$&amp; ME, I select the ranges manually and paste them into word and it does the same thing.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1462392545, "post_id": 37034680, "comment_id": 61624316, "body": "<a href=\"http://stackoverflow.com/a/18419340/3657636\">This response</a> may address your issue."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462434044, "post_id": 37034680, "comment_id": 61638490, "body": "<code>Make sure the file&#47;path name doesn&#39;t contain more than 218 characters.</code> Have you verified this if it is not working? Maybe the path <code>sItem</code> is to long?"}], "owner": {"reputation": 23, "user_id": 6292040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156907010425422/picture?type=large", "display_name": "Marc Rumble", "link": "https://stackoverflow.com/users/6292040/marc-rumble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463042384, "creation_date": 1462384171, "last_edit_date": 1463042384, "question_id": 37034680, "link": "https://stackoverflow.com/questions/37034680/vba-to-save-workbook-twice-as-different-types-in-the-same-location", "title": "VBA to save workbook twice as different types in the same location", "body": "<p>Hi I have some code that seems to work great on PC's in the house but as soon as I try them in Work they don't seem to work. Really strange. Any ideas?</p>\n\n<p>The idea of the script is to </p>\n\n<ol>\n<li>ask for a name with a pop up</li>\n<li>ask for a location to save</li>\n<li>Then will move some things around.</li>\n<li>then it will save the a workbook as an xlsm with the name given in step 1 in the location given in step.</li>\n<li>then it will save the worksheet again as am xml with the name in step 1 given but added the text \"-upload\" to the file name to the location previously selected in step 2.</li>\n</ol>\n\n<p>I know it seems strange but it works on some but not on others, any reason for this?\nThe error I get on some is</p>\n\n<blockquote>\n  <p>Run-time error '1004':  The file could not be accessed. Try one of the\n  following: </p>\n  \n  <ul>\n  <li><p>Make the specified folder exist. </p></li>\n  <li><p>Make sure the folder that contains the file is not read-only. </p></li>\n  <li><p>Make sure the file name does not contain any of the following characters:  &lt; > ? [ ] : | or * </p></li>\n  <li><p>Make sure the file/path name doesn't contain more than 218 characters.</p></li>\n  </ul>\n</blockquote>\n\n<p>Any help is welcomed. The code I have is </p>\n\n<pre><code>Sub save_as_xlsm_and_XML()\nDim filename\nDim XML_Name_Complete\nDim XLSM_Name\nDim Temp_Name\nDim fldr As FileDialog\nDim sItem As String\nDim Last_Column As Long\n\nfilename = ActiveWorkbook.Name\nTemp_Name = InputBox(\"Enw Dosbarth\")\nIf Temp_Name = \"\" Then Exit Sub\n\n\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\n\nXLSM_Name = sItem &amp; \"\\\" &amp; Temp_Name\nXML_Name_Complete = sItem &amp; \"\\\" &amp; Temp_Name &amp; \"-lanlwythiad\"\n\nApplication.ScreenUpdating = False ' turn off the screen updating\n\n'Moving data from final_before_copy to adroddiad\n    Sheets(\"Final_Before_Copy\").Select\n    Rows(\"8:250\").Select\n    Selection.Copy\n    ActiveWindow.ScrollWorkbookTabs Sheets:=-1\n    Sheets(\"adroddiad\").Select\n    Rows(\"8:8\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Rows(\"1:4\").EntireRow.Hidden = True\n\n' Arbed fel XML '\n\n    Cells.Select\n    Selection.Copy\n    Workbooks.Add\n    ActiveSheet.Paste\n    ActiveWindow.DisplayGridlines = False\n    ActiveWindow.DisplayHeadings = False\n    Range(\"a1\").Select\n    ActiveSheet.Name = \"Adroddiad\"\n    Sheets(\"Sheet2\").Select\n    ActiveWindow.SelectedSheets.Delete\n    Sheets(\"Sheet3\").Select\n    ActiveWindow.SelectedSheets.Delete\n\nChDir sItem\n\nActiveWorkbook.SaveAs filename:=XML_Name_Complete _\n, FileFormat:=xlXMLSpreadsheet, CreateBackup:=True\nIf XML_Name_Complete = False Then Exit Sub\nApplication.DisplayAlerts = False\nActiveWorkbook.Close True\n\n\n'Arbed fel xlsm'\nThisWorkbook.Activate\nSheets(\"Marciau\").Select\nRange(\"A6\").Select\n\nChDir sItem\nActiveWorkbook.SaveAs filename:=XLSM_Name _\n, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nApplication.DisplayAlerts = False\n\nApplication.ExecuteExcel4Macro \"Show.ToolBar(\"\"Ribbon\"\",False)\"\n\n    Application.ScreenUpdating = True ' turn on the screen updating\n\nsuccessful_export = MsgBox(\"Adroddiad wedi ei arbed ac allforio yn lwyddiannus\", , \"System Adroddiadau\")\n\nNextCode:\nGetFolder = sItem\nSet fldr = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1462524271, "post_id": 37034679, "comment_id": 61681369, "body": "does Folderpath have a &quot;\\&quot; at its end ?"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5998471, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/508fb4029179c1a413f93b89ea9dd364?s=128&d=identicon&r=PG&f=1", "display_name": "shilohln", "link": "https://stackoverflow.com/users/5998471/shilohln"}, "edited": false, "score": 0, "creation_date": 1462385632, "post_id": 37034770, "comment_id": 61620351, "body": "That worked well, thank you!  I&#39;ll take your NewCell.Value = OldCel.Value suggestion as well."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 81, "user_id": 5998471, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/508fb4029179c1a413f93b89ea9dd364?s=128&d=identicon&r=PG&f=1", "display_name": "shilohln", "link": "https://stackoverflow.com/users/5998471/shilohln"}, "edited": false, "score": 0, "creation_date": 1462386297, "post_id": 37034770, "comment_id": 61620751, "body": "Awesome. If youre interested in the array configuration, here&#39;s where I asked code review about a better loop procedure. <a href=\"http://codereview.stackexchange.com/questions/121434/looping-through-files-in-a-folder\" title=\"looping through files in a folder\">codereview.stackexchange.com/questions/121434/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1462384534, "creation_date": 1462384534, "answer_id": 37034770, "question_id": 37034679, "link": "https://stackoverflow.com/questions/37034679/vba-excel-do-while-skipped-unsure-why/37034770#37034770", "title": "VBA Excel DO WHILE skipped, unsure why", "body": "<p>try this with your do while</p>\n\n<pre><code> path = \"path2folder\" &amp; \"\\\"  \n  Filename = Dir(path &amp; \"*.xl??\")\n\n  Do While Len(Filename) &gt; 0\n      DoEvents\n      Set wbk = Workbooks.Open(path &amp; Filename, True, True)\n           'add your code\n      wbk.Close False\n      Filename = Dir\n Loop\n</code></pre>\n\n<p>If you want to do everything in one go, you need to fill an array and then dump contents of an array into new worksheet. Doing it one at a time like you have will take forever if you searching through lots of workbooks. </p>\n\n<p>Also instead of copy &amp; pasting you can just say NewCell.value = OldCell.Value</p>\n"}], "owner": {"reputation": 81, "user_id": 5998471, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/508fb4029179c1a413f93b89ea9dd364?s=128&d=identicon&r=PG&f=1", "display_name": "shilohln", "link": "https://stackoverflow.com/users/5998471/shilohln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37034770, "answer_count": 1, "score": 0, "last_activity_date": 1462385109, "creation_date": 1462384168, "last_edit_date": 1495541273, "question_id": 37034679, "link": "https://stackoverflow.com/questions/37034679/vba-excel-do-while-skipped-unsure-why", "title": "VBA Excel DO WHILE skipped, unsure why", "body": "<p>I wrote an Excel macro, shown below, using some sample code from <a href=\"https://stackoverflow.com/questions/29516029/excel-loop-through-xlsm-files-and-copy-row-to-another-sheet\">\"Excel, loop through XLSM files and copy row to another sheet\"</a>.  It should loop through some .xlsm files in the same folder as <code>ThisWorkbook</code>, pulling everything from Columns C, D and E in a sheet named \"Summary2\" from each .xlsm file. Those should get copied into Columns C, D and E of <code>ThisWorkbook</code>, and the filename of each file in the folder should appear beside (in Col B) the data that accompanies it.  </p>\n\n<pre><code>Sub Summarize()\n\nDim SummaryWkb As Workbook, SourceWkb As Workbook\nDim SummarySheet As Worksheet, SourceWks As Worksheet\nDim FolderPath As String\nDim FileName As Variant\nDim NRow As Long\nDim LRow As Long\nDim LastRow As Long\n\nSet SummaryWkb = ThisWorkbook\nSet SummarySheet = SummaryWkb.Worksheets(1)\n\nSummarySheet.Name = \"Summary\"\n\nFolderPath = SummaryWkb.Path\nFileName = Dir(FolderPath)\n\n\nNRow = 2\nDo While (FileName &lt;&gt; \"\")\n\n    Set SourceWkb = Workbooks.Open(FolderPath &amp; FileName)\n    Set SourceWks = SourceWkb.Sheets(\"Summary2\")\n\n    'File Name Copy\n    SummarySheet.Range(\"B\" &amp; NRow) = FileName\n    NRow = NRow\n\n    'Data Copy\n    LastRow = SourceWks.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n    LRow = NRow + LastRow\n\n    SourceWks.Range(\"C2:C\" &amp; LastRow).Copy\n    SummarySheet.Range(\"C\" &amp; NRow &amp; \":C\" &amp; LRow).PasteSpecial xlPasteValues\n\n    SourceWks.Range(\"D2:D\" &amp; LastRow).Copy\n    SummarySheet.Range(\"D\" &amp; NRow &amp; \":D\" &amp; LRow).PasteSpecial xlPasteValues\n\n    SourceWks.Range(\"E2:E\" &amp; LastRow).Copy\n    SummarySheet.Range(\"E\" &amp; NRow &amp; \":D\" &amp; LRow).PasteSpecial xlPasteValues\n\n    SourceWkb.Close False\n    NRow = NRow + LastRow + 1\n\nFileName = Dir()\nLoop\n\nSummarySheet.Range(\"B1\") = \"Source\"\nSummarySheet.Range(\"C1\") = \"Machine\"\nSummarySheet.Range(\"D1\") = \"Quantity\"\nSummarySheet.Range(\"E1\") = \"Ranking\"\n\nSummarySheet.Columns.AutoFit\nSummaryWkb.Save\n\n\nMsgBox \"Summary Successfully Created!\", vbInformation\n\nSet SourceWkb = Nothing\nSet SourceWks = Nothing\nSet SummarySheet = Nothing\nSet SummaryWkb = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When I run this macro the <code>do while</code> loop gets skipped and I have no idea why.  Also, if there is a better way of copying and pasting all of the cells in one go I'd be happy to hear of it.</p>\n"}, {"tags": ["excel", "vba", "outlook", "rtf"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462384872, "post_id": 37034556, "comment_id": 61619851, "body": "Isn&#39;t this the same question as asked before: <a href=\"http://stackoverflow.com/questions/37014913/htmlbody-workaround-for-olappointment-object\" title=\"htmlbody workaround for olappointment object\">stackoverflow.com/questions/37014913/&hellip;</a>? Furthermore, it seems that there is another using having the exact same problem here (just now): <a href=\"http://stackoverflow.com/questions/37025009/vba-outlook-appointment#comment61615861_37025009\" title=\"vba outlook appointment%23comment61615861_37025009\">stackoverflow.com/questions/37025009/&hellip;</a> Maybe you can work it out together?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1462398896, "post_id": 37034556, "comment_id": 61627460, "body": "I am unclear what &quot;access&quot; means in your question.  (1) Are you receiving appointments that contain RTF bodies that you wish to extract and process?  (2) Do you have a table in Excel which you wish to distribute as part of an <code>AppointmentItem</code>?  If (2), why not distribute the Excel workbook as an attachment?"}, {"owner": {"reputation": 57, "user_id": 6287770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28e6337aeeaea1ff59355652d7251f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6287770/michael"}, "edited": false, "score": 0, "creation_date": 1462469179, "post_id": 37034556, "comment_id": 61660207, "body": "Thanks both for your replies. Tony - by &quot;access&quot; I simply mean get the values stored in the relevant cells of the table."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1462474616, "post_id": 37034556, "comment_id": 61663343, "body": "So you want to write to the <code>AppointmentItem</code>.  I tried outputting RTF many years ago and totally failed.  As far as I could determine at the time, there were no helpful functions.  It was up to the programmer to create a valid RTF string and output to RTFBody. Why isn&#39;t an attached Excel workbook an acceptable solution?"}, {"owner": {"reputation": 224, "user_id": 598477, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/uW2Bk.png?s=128&g=1", "display_name": "Big Dude", "link": "https://stackoverflow.com/users/598477/big-dude"}, "edited": false, "score": 0, "creation_date": 1508938257, "post_id": 37034556, "comment_id": 80814555, "body": "This might point you in the right direction: <a href=\"https://stackoverflow.com/questions/37014913/htmlbody-workaround-for-olappointment-object/46933216#46933216\">HTMLBody Workaround For OlAppointment Object?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1463837334, "creation_date": 1463837334, "answer_id": 37363579, "question_id": 37034556, "link": "https://stackoverflow.com/questions/37034556/how-to-programmatically-access-contents-of-a-table-in-an-outlook-appointment/37363579#37363579", "title": "How to Programmatically Access Contents of a Table in an Outlook Appointment", "body": "<p>Can you try this?</p>\n\n<pre><code>Private Sub Add_Appointments_To_Outlook_Calendar()\n\n    'Include Microsoft Outlook nn.nn Object Library from Tools -&gt; References\n    Dim oAppt As AppointmentItem\n    Dim Remind_Time As Double\n\n    i = 2\n    Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n\n    'Loop through entire list of Reminders to be added\n    While Subj &lt;&gt; \"\"\n        Set oAppt = Outlook.Application.CreateItem(olAppointmentItem)\n\n        oAppt.Subject = Subj\n        oAppt.Location = ThisWorkbook.Sheets(1).Cells(i, 2)\n        oAppt.Start = ThisWorkbook.Sheets(1).Cells(i, 3)\n        Remind_Time = ThisWorkbook.Sheets(1).Cells(i, 4) * 1 * 60\n        oAppt.ReminderMinutesBeforeStart = Remind_Time\n        oAppt.AllDayEvent = True\n        oAppt.Save\n\n        i = i + 1\n        Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n    Wend\n    MsgBox \"Reminder(s) Added To Outlook Calendar\"\n\nEnd Sub\n\n' The code comes from this link:\n</code></pre>\n\n<p><a href=\"http://officetricks.com/add-appointment-to-outlook-calendar-through-excel-macro-vba/\" rel=\"nofollow noreferrer\">http://officetricks.com/add-appointment-to-outlook-calendar-through-excel-macro-vba/</a></p>\n\n<p>I actually wrote a book about this, and so many other things. You can find it at the link below.</p>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/B01DJJKVZC\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">https://www.amazon.com/Automating-Business-Processes-Reducing-Increasing-ebook/dp/B01DJJKVZC?ie=UTF8&amp;keywords=ryan%20shuell&amp;qid=1463837322&amp;ref_=sr_1_1&amp;sr=8-1</a></p>\n"}], "owner": {"reputation": 57, "user_id": 6287770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28e6337aeeaea1ff59355652d7251f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6287770/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593324868, "creation_date": 1462383756, "last_edit_date": 1593324868, "question_id": 37034556, "link": "https://stackoverflow.com/questions/37034556/how-to-programmatically-access-contents-of-a-table-in-an-outlook-appointment", "title": "How to Programmatically Access Contents of a Table in an Outlook Appointment", "body": "<p>I'm working on a project where I need to somehow access the contents of a table embedded in an Outlook invite programmatically.  If it were in an email, I'd be dealing with an object of the class \"MailItem\" and I could call HTMLBody and use the \"table\" tags to get the contents.  However, to my knowledge, no similar functionality exists for \"AppointmentItem\" objects.  I know that there is the \"RTFBody\" function for MailItems, but I'm completely at a loss as to how to get the contents of the table using RTF and Google isn't very helpful on this front. For my purposes, the table in the Outlook invite can either be an embedded Excel Worksheet object, or simply a table you can insert by going to Insert | Table.</p>\n\n<p>My end goal is to get the contents of tables embedded in a shared team calendar and send them to an Excel worksheet where I've built a dashboard of meetings my team has.  The contents of the tables embedded in the Outlook invites on the team calendar have datapoints that I'd like to have show up dynamically in the dashboard.</p>\n\n<p>Any help would be greatly, greatly appreciated - Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462383138, "post_id": 37034207, "comment_id": 61618786, "body": "There&#39;s at least two paths you could take. 1) Open the .csv as a textstream and parse it for the information you want all in VBA, or 2) Open the .csv to a worksheet, use the worksheet functions (through VBA) to find what you want, then delete the worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 1695, "user_id": 297007, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/61b1a0f9ff6be52ae57b6a3260c8f07a?s=128&d=identicon&r=PG", "display_name": "Kefka", "link": "https://stackoverflow.com/users/297007/kefka"}, "edited": false, "score": 0, "creation_date": 1462389001, "post_id": 37034484, "comment_id": 61622414, "body": "Thanks, this does appear to work for what I need. Now I just need to convert it to do what I actually require, which I think will be doable using this format."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 3, "last_activity_date": 1462383480, "creation_date": 1462383480, "answer_id": 37034484, "question_id": 37034207, "link": "https://stackoverflow.com/questions/37034207/pulling-information-from-a-cell-in-a-csv-file-into-a-variable-in-excel-using-vb/37034484#37034484", "title": "Pulling information from a cell in a .csv file into a variable in Excel using vba", "body": "<p>Here's an example of one way to do it:</p>\n\n<pre><code>Sub OpenAndCount()\n    Dim sFile As String\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim cnt As Long\n    Dim rng1 As Range\n    Dim rng2 As Range\n\n\n    sFile = \"c:\\files\\file.csv\"\n    Set wb = Workbooks.Open(sFile)\n    Set ws = wb.Sheets(1)\n    Set rng1 = ws.Range(\"F2:F100000\")\n    Set rng2 = ws.Range(\"Z2:Z100000\")\n\n    cnt = Application.WorksheetFunction.CountIfs(rng1, \"=medium*\", rng2, \"=open\")\n\n    Debug.Print cnt\n    wb.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1695, "user_id": 297007, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/61b1a0f9ff6be52ae57b6a3260c8f07a?s=128&d=identicon&r=PG", "display_name": "Kefka", "link": "https://stackoverflow.com/users/297007/kefka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "accepted_answer_id": 37034484, "answer_count": 1, "score": 0, "last_activity_date": 1462383480, "creation_date": 1462382448, "question_id": 37034207, "link": "https://stackoverflow.com/questions/37034207/pulling-information-from-a-cell-in-a-csv-file-into-a-variable-in-excel-using-vb", "title": "Pulling information from a cell in a .csv file into a variable in Excel using vba", "body": "<p>I'm working on a vba macro for an excel sheet and I'm not sure how to go about doing one of my functions. I have a private sub in the macro that is used to get the path of a .csv file (say C:/files/file.csv stored as variable 'csvfile').</p>\n\n<p>What I need to do at this point is automatically pull information from that csv file according to a certain formula and save it as a variable:</p>\n\n<pre><code>=COUNTIFS(F2:F10000,\"=medium\",Z2:Z10000,\"=Open\")\n</code></pre>\n\n<p>So in summary, in a macro in spreadsheet Main.xlsx, I need to run the above formula on the file whose path is stored in variable csvfile, and save the returned number as a variable within the macro so I can make use of that number in my macro.</p>\n\n<p>I'll need to do this nine times actually with the formula slightly different each time, but once I have the single variable worked out I think I'll be able to modify it to produce all the results I need.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 0, "creation_date": 1462382883, "post_id": 37034137, "comment_id": 61618643, "body": "Use <code>CreateQueryDef</code> and <code>Parameters</code> to allow the use of <code>On Error</code> handlers and to avoid SQL Injection vulnerability"}, {"owner": {"reputation": 150, "user_id": 1605795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d682a44c94fbb871870bc5272011b12?s=128&d=identicon&r=PG", "display_name": "mattdeak", "link": "https://stackoverflow.com/users/1605795/mattdeak"}, "reply_to_user": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 0, "creation_date": 1462459838, "post_id": 37034137, "comment_id": 61654388, "body": "@Stavr00 thanks, I actually didn&#39;t know about CreateQueryDef. Very useful."}], "owner": {"reputation": 150, "user_id": 1605795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d682a44c94fbb871870bc5272011b12?s=128&d=identicon&r=PG", "display_name": "mattdeak", "link": "https://stackoverflow.com/users/1605795/mattdeak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593958680, "creation_date": 1462382200, "last_edit_date": 1593958680, "question_id": 37034137, "link": "https://stackoverflow.com/questions/37034137/how-do-i-check-that-an-sql-insertion-didnt-work-because-of-a-primary-key-violat", "title": "How do I check that an SQL insertion didn&#39;t work because of a Primary Key violation in Access VBA?", "body": "<p>I am looping through an array and filling a table in Access with its values through SQL INSERT INTO statements:</p>\n\n<pre><code>For i = 1 To UBound(vData)\n    quote = Chr(34) 'Quote string\n\n    'SQL string\n    strSql = \"INSERT INTO \" &amp; TABLE_NAME &amp; \" VALUES (\" &amp; _\n        quote &amp; vData(i, 1) &amp; quote &amp; \",\" &amp; quote &amp; vData(i, 2) &amp; quote &amp; \",\" &amp; vData(i, 3) &amp; \",\" &amp; _\n        quote &amp; vData(i, 4) &amp; quote &amp; \",\" &amp; vData(i, 5) &amp; \",\" &amp; vData(i, 6) &amp; \",\" &amp; _\n        vData(i, 7) &amp; \",\" &amp; vData(i, 8) &amp; \",\" &amp; vData(i, 9) &amp; \",\" &amp; _\n        vData(i, 10) &amp; \",\" &amp; vData(i, 11) &amp; \",\" &amp; vData(i, 12) &amp; _\n        \",\" &amp; vData(i, 13) &amp; \")\"\n\n'So we don't get a \"are you sure\" message on every insertion\n    DoCmd.SetWarnings False\n    DoCmd.RunSQL strSql\n    DoCmd.SetWarnings True\nNext\n</code></pre>\n\n<p>Occasionally it's possible that a record can't be inserted due to a primary key violation, in which case it is completely appropriate to just ignore it (which is what will automatically happen).\nHowever, I would like to - at the very least - present a message to the user letting them know that the item could not be inserted, but I can't find any corresponding error codes that I can use to detect such an event. </p>\n\n<p>I also don't want to turn warnings off because I'll get a \"Are you sure you want to append\" message on every insertion.</p>\n\n<p>Any ideas on how to detect this error in VBA?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6291926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c36387b72216d7b234454c6722a22e6?s=128&d=identicon&r=PG&f=1", "display_name": "MCSythera", "link": "https://stackoverflow.com/users/6291926/mcsythera"}, "edited": false, "score": 0, "creation_date": 1462464350, "post_id": 37034961, "comment_id": 61657380, "body": "I want to try this method, though it seems like a lot of blocks of code required compared to the other method given. I&#39;ll take some time to piece together a format that uses this and see how it works."}], "tags": [], "owner": {"reputation": 248, "user_id": 5988025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe12237ef56f4d0d4fcab9e62467f430?s=128&d=identicon&r=PG", "display_name": "David912", "link": "https://stackoverflow.com/users/5988025/david912"}, "is_accepted": false, "score": 0, "last_activity_date": 1462385243, "creation_date": 1462385243, "answer_id": 37034961, "question_id": 37033942, "link": "https://stackoverflow.com/questions/37033942/skipping-files-in-a-directory-with-same-name-from-inputbox/37034961#37034961", "title": "Skipping files in a directory with same name from inputbox", "body": "<p>This is what I would do:\nFirst, use string comparison to find all the files in the directory that starts with John Doe and store them in a dynamic array.</p>\n\n<p>Use <code>For...Each</code> statement to go through the files, and use\n<code>Dir(FilePath) LIKE \"John Doe*\"</code> to find your candidates.</p>\n\n<p>Then use a <code>Do...While</code> loop to go through the files in the array until you find your match.</p>\n\n<p>I could write the entire code for you but then you'd miss all the fun...</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6291926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c36387b72216d7b234454c6722a22e6?s=128&d=identicon&r=PG&f=1", "display_name": "MCSythera", "link": "https://stackoverflow.com/users/6291926/mcsythera"}, "edited": false, "score": 0, "creation_date": 1462464125, "post_id": 37043698, "comment_id": 61657247, "body": "That was an exceptionally simple solution, though I&#39;m not sure I understand how it works through the files. The resulting code simply substitutes strDir for the previous FilePath, includes your chunk of code, and does all the necessary steps in order. I&#39;ve already tried it on a test copy and works wells. How does that code determine the next file in line to select/display?"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 55, "user_id": 6291926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c36387b72216d7b234454c6722a22e6?s=128&d=identicon&r=PG&f=1", "display_name": "MCSythera", "link": "https://stackoverflow.com/users/6291926/mcsythera"}, "edited": false, "score": 0, "creation_date": 1462495830, "post_id": 37043698, "comment_id": 61671780, "body": "@MCSythera have added a short explanation above - this is how Dir works by design."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 2, "last_activity_date": 1462495797, "last_edit_date": 1495540780, "creation_date": 1462429084, "answer_id": 37043698, "question_id": 37033942, "link": "https://stackoverflow.com/questions/37033942/skipping-files-in-a-directory-with-same-name-from-inputbox/37043698#37043698", "title": "Skipping files in a directory with same name from inputbox", "body": "<p>You can loop through all the matches by adding a <code>strDir = Dir</code> at the end of your loop, which will exit after the match is met and not accepted (as the length of <code>StrDir</code> will be 0)</p>\n\n<p><em>update</em></p>\n\n<p>I realise the code looks a little strange but this is the way <code>Dir</code> works, ie each time it is called it looks for the same match as the initial <code>Dir</code> until it reaches the end of the list. See <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba/10382861#10382861\">Loop through files in a folder using VBA?</a></p>\n\n<p>ie</p>\n\n<pre><code>Do While Len(strDir) &gt; 0\nDOB = MsgBox(\"Is this your client's date of birth?\", vbYesNoCancel)\n\nIf DOB = vbCancel Then Exit Do\n\nIf DOB = vbYes Then\n    Workbooks.Open (filepath)\n    ActiveWorkbook.Close False\nExit Do\nEnd If\n\nstrDir = Dir\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6291926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c36387b72216d7b234454c6722a22e6?s=128&d=identicon&r=PG&f=1", "display_name": "MCSythera", "link": "https://stackoverflow.com/users/6291926/mcsythera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 37043698, "answer_count": 2, "score": 2, "last_activity_date": 1462495797, "creation_date": 1462381495, "last_edit_date": 1462464015, "question_id": 37033942, "link": "https://stackoverflow.com/questions/37033942/skipping-files-in-a-directory-with-same-name-from-inputbox", "title": "Skipping files in a directory with same name from inputbox", "body": "<p>I am creating a code that opens and imports data from a file that is selected based on a client's name. Each time a client is opened, a file is saved for them with their name and date of birth (without slashes). </p>\n\n<p>A sample file would look like <code>C:\\Data\\Clients\\John Doe 01011900.xlsx</code>. An InputBox on button-click provides a client's name, but what I'm getting stuck on is if there are 2 or more John Does in the folder.</p>\n\n<pre><code>Check = Application.InputBox(prompt:=\"What is your client's first and last name?\", Type:=2)\nFilePath = \"C:\\Data\\Clients\\\" &amp; Check &amp; \"*.xlsx\"\nIf Dir(FilePath, vbDirectory) = \"\" Then\n    Exit Sub\nEnd If\nDOB = MsgBox(\"Is this your client's date of birth? \" &amp; \"   \" &amp; Chr(149) &amp; \" \" &amp; Mid(Dir(FilePath), Len(Dir(FilePath)) - 12, 2) &amp; \"/\" &amp; Mid(Dir(FilePath), Len(Dir(FilePath) - 10, 2) &amp; \"/\" &amp; Mid(Dir(FilePath), Len(Dir(FilePath) - 8, 4) &amp; \" \" &amp; Chr(149), vbYesNoCancel)\nIf DOB = vbYes Then\n    Workbooks.Open (FilePath)\n    'Transfer Data\n    ActiveWorkbook.Close False\nElseIf DOB = vbNo Then\n    'Try again.\nElseIf DOB = vbCancel Then\n    'Do nothing.\nEnd If\n</code></pre>\n\n<p>My confusion is occurring at the DOB = vbNo, when someone says the date of birth does not match (meaning the next client with the same name needs to be selected). Everything else works great so far, so I just need help with the re-selection of the next file with the same name.</p>\n"}, {"tags": ["excel", "loops", "date", "timeline", "vba"], "answers": [{"comments": [{"owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462441640, "post_id": 37034161, "comment_id": 61642707, "body": "I get na error 13 type mismatch when i=2. Also, Where did you use the &quot;insertdate&quot; that you defined above? The dates i need before 04/04/2016 and after 11/04/2016 are still missing. The loop isn&#39;t even starting in the today date. I believe the answer is not much different from the @ScottCraner code but I have no clue what to change."}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "reply_to_user": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462444996, "post_id": 37034161, "comment_id": 61644595, "body": "Hi @carlos_cs, the difference is that with modification (commented) the sub will run until the date &#39;startDate&#39;. I fix the mismatch error and removed the insertDate (i just forgot in the code). Hope help you now.  P.S.: Voc&#234; &#233; brasileiro? rs..."}, {"owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462445754, "post_id": 37034161, "comment_id": 61645063, "body": "Hi @Kellsens sou portugu&#234;s. The problem with your code is that the loop doesn&#39;t find in the sheet1 the lines with today and end dates. The code must have a step before the loop: It should find if the start and today date already exist in sheet1, and if they don&#39;t then add them to the top and bottom respectively. Then i guess the loop should work."}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "reply_to_user": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462445920, "post_id": 37034161, "comment_id": 61645177, "body": "Prazer @carlos_cs. So, I&#39;m guessing the &#39;ts&#39; is your worksheet with the data and dates. You can change the worksheet referenced to the sheet where the dates are."}, {"owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462447928, "post_id": 37034161, "comment_id": 61646452, "body": "Hey @Kellsens, I changed your code a bit like I just wrote and now it does what I wanted!! Can you review it? The format around todaydate seems weird. Also, If you or someone can optimise it, it would be great!"}], "tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 0, "last_activity_date": 1462444896, "last_edit_date": 1462444896, "creation_date": 1462382269, "answer_id": 37034161, "question_id": 37033548, "link": "https://stackoverflow.com/questions/37033548/timeline-fill-sheet-with-the-missing-dates-between-given-interval/37034161#37034161", "title": "Timeline - fill sheet with the missing dates between given interval", "body": "<p>you can use the same solution proposed by @ScottCraner, just changing a few lines</p>\n\n<pre><code>Sub timeline()\n\nDim i As Integer\nDim ws As Worksheet\nDim ts As Worksheet\nDim startDate as Date\n\nSet ws = Sheets(\"Sheet15\") 'Change to your Output Sheet\nSet ts = Sheets(\"Sheet14\") 'Change to your data sheet\n\n' get the earliest day\nstartDate = cdate(application.WorksheetFunction.Min(cdate(ts.range(\"E1\")),cdate(ts.range(\"E2\"))))\n\nWith ws\n    i = ts.Range(\"A\" &amp; ts.Rows.Count).End(xlUp).Row\n    ts.Range(\"A1:C\" &amp; i).Copy .Range(\"A1\")\n    .Range(\"A1:C\" &amp; i).Sort Key1:=.Range(\"A2\"), Order1:=xlAscending, _\n        key2:=.Range(\"C2\"), Order2:=xlAscending, _\n        Header:=xlYes\n    Do Until .cells(i,1).value2 = startDate ' fill all dates 'til startDate\n        If .Cells(i, 1).Value2 = .Cells(i - 1, 1).Value2 Or .Cells(i, 1).Value2 = .Cells(i - 1, 1).Value2 + 1 Then\n            i = i - 1\n        Else\n            .Rows(i).Insert\n            .Cells(i, 1).Value = .Cells(i + 1, 1).Value2 - 1\n            .Cells(i, 2).Value = 0#\n            .Cells(i, 3).Value = \"--\"\n        End If\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "is_accepted": false, "score": 0, "last_activity_date": 1462455826, "creation_date": 1462455826, "answer_id": 37052256, "question_id": 37033548, "link": "https://stackoverflow.com/questions/37033548/timeline-fill-sheet-with-the-missing-dates-between-given-interval/37052256#37052256", "title": "Timeline - fill sheet with the missing dates between given interval", "body": "<p>This answer worked for me. I used @kellsens code a bit and got the answer myself!</p>\n\n<pre><code>Sub macro6()\nApplication.ScreenUpdating = False\nDim i As Long\nDim ws As Worksheet\nDim ts As Worksheet\nDim fs As Worksheet\nDim startDate As Date\nDim todaydate As Date\n\nFolha13.Select\n\nSet ws = Sheets(\"sheet1\") 'Change to your Output Sheet\nSet ts = Sheets(\"sheet2\") 'Change to your data sheet\nSet fs = Sheets(\"sheet3\") 'Change to your data sheet\nsheet2.Range(\"a1:c250\").ClearContents\n\n' get the earliest day\nstartDate = CDate(Application.WorksheetFunction.Min(CDate(fs.Range(\"b6\")), CDate(fs.Range(\"b7\"))))\ntodaydate = CDate(fs.Range(\"b10\"))\nWith ws\n    i = ts.Range(\"A\" &amp; ts.Rows.Count).End(xlUp).Row\n    ts.Range(\"A1:C\" &amp; i).Copy .Range(\"A1\")\n    .Range(\"A1:C\" &amp; i).Sort Key1:=.Range(\"A2\"), Order1:=xlAscending, _\n        key2:=.Range(\"C2\"), Order2:=xlAscending, _\n        Header:=xlYes\n\n        i = 2\n        If .Cells(i, 1).Value2 &lt;&gt; startDate Then\n            .Rows(i).Insert\n            .Cells(i, 1).Value = startDate\n            .Cells(i, 2).Value = 0#\n            .Cells(i, 3).Value = \"--\"\n\n     End If\n\n     i = ts.Range(\"A\" &amp; ts.Rows.Count).End(xlUp).Row + 1\n           If .Cells(i, 1).Value2 &lt;&gt; todaydate Then\n            .Rows(i + 1).Insert\n            .Cells(i + 1, 1).Value = todaydate\n            .Cells(i + 1, 2).Value = 0#\n            .Cells(i + 1, 3).Value = \"--\"\n\n     End If\n\n      i = ts.Range(\"A\" &amp; ts.Rows.Count).End(xlUp).Row + 2\n\n    Do Until .Cells(i, 1).Value2 = startDate ' fill all dates 'til startDate\n\n\n          If .Cells(i, 1).Value2 = .Cells(i - 1, 1).Value2 Or .Cells(i, 1).Value2 = .Cells(i - 1, 1).Value2 + 1 Then\n            i = i - 1\n        Else\n            .Rows(i).Insert\n            .Cells(i, 1).Value = .Cells(i + 1, 1).Value2 - 1\n            .Cells(i, 2).Value = 0#\n            .Cells(i, 3).Value = \"--\"\n        End If\n  Loop\n\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 486, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1462455826, "creation_date": 1462380163, "last_edit_date": 1531161705, "question_id": 37033548, "link": "https://stackoverflow.com/questions/37033548/timeline-fill-sheet-with-the-missing-dates-between-given-interval", "title": "Timeline - fill sheet with the missing dates between given interval", "body": "<p>I have the following Excel problem:<br/></p>\n\n<p>I currently have this in sheet1 columns A,B,C:<br/></p>\n\n<p>Date Time Worker<br/>\n 04/04/2016 4,5 John<br/>\n 05/04/2016 2 John<br/>\n 06/04/2016 6,5 John<br/>\n 07/04/2016 0 --<br/>\n 08/04/2016 0,5 Charles<br/>\n 08/04/2016 2 John<br/>\n 08/04/2016 0,5 William<br/>\n 09/04/2016 0 --<br/>\n 10/04/2016 0 --<br/>\n 11/04/2016 9 John<br/>\n 11/04/2016 3,75 William<br/></p>\n\n<p>I also have in sheet 3: <br/>\nThe Creation date of Project In cell E1 : 28/03/2016<br/>\nThe Actual start of Project In cell F1: 29/03/2016<br/>\nThe Today date In cell G1 (let's consider today date is the one i show next): 13/04/2016<br/></p>\n\n<p>What I want in sheet2:</p>\n\n<p>Choose the earliest date between Creation and Actual start of Project, which in this case is 28/03/2016<br/>\nThen add the missing dates with 0 Time and -- Worker until it reaches the Today date.<br/>\nIt should look like this after all done:</p>\n\n<p>Date Time Worker<br/>\n 28/03/2016 0 --<br/>\n 29/03/2016 0 --<br/>\n 30/03/2016 0 --<br/>\n 31/03/2016 0 --<br/>\n 01/04/2016 0 --<br/>\n 02/04/2016 0 --<br/>\n 03/04/2016 0 --<br/>\n 04/04/2016 4,5 John<br/>\n 05/04/2016 2 John<br/>\n 06/04/2016 6,5 John<br/>\n 07/04/2016 0 --<br/>\n 08/04/2016 0,5 Charles<br/>\n 08/04/2016 2 John<br/>\n 08/04/2016 0,5 William<br/>\n 09/04/2016 0 --<br/>\n 10/04/2016 0 --<br/>\n 11/04/2016 9 John<br/>\n 11/04/2016 3,75 William<br/>\n 12/04/2016 0 --<br/>\n 13/04/2016 0 --<br/></p>\n\n<p>It is the continuation of a problem i had but only detected now:<br/>\n<a href=\"https://stackoverflow.com/questions/36984494/timeline-loop-through-all-dates-between-first-and-last-given-and-add-date-to-c\">Timeline - loop through all dates between first and last given and add date to column if not found</a>\nLooking for a excel-vba macro solution because i believe it's the only way to do it.<br/>\nI'm new to VBA and stuck with this problem and all the help means a lot to me!</p>\n\n<p>Edited to say this: The cells where the dates of the creation, actual start of project and today are don't really matter, could be in any sheet. Just said that for exemple purpose. Hope the link provided can help you help me!</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1462381355, "post_id": 37033896, "comment_id": 61617795, "body": "The <code>makeChutesNegative</code> = <code>-1</code> so it <i>should</i> be decreasing when <code>isChute</code> is True."}, {"owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1462386817, "post_id": 37033896, "comment_id": 61621092, "body": "If that&#39;s the case, then the line above is <i>adding</i> instead of subtracting: <code>myChutesLadders(index) = myChutesLadders(index) - (makeChutesNegative * 50)</code>"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1462446543, "post_id": 37033896, "comment_id": 61645564, "body": "Right. So after the <code>if abs(mychutesladder(index))&gt;=98</code> I have the first line and the second line. If the first is <code>-</code> and the second is <code>+</code> I get a positive chute. With <code>+</code> then <code>+</code> I still get positive chutes and the total chutes can be <code>-250</code> instead of <code>-150</code>. If I do <code>+</code> and then <code>-</code> I can get a positive chute. If I do <code>-</code> and <code>-</code> then I can still get a positive chute. +1 for the help, but it still doesn&#39;t work."}], "tags": [], "owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "is_accepted": false, "score": 1, "last_activity_date": 1462381282, "creation_date": 1462381282, "answer_id": 37033896, "question_id": 37033537, "link": "https://stackoverflow.com/questions/37033537/sum-of-array-is-negative-and-trying-to-reach-constant-but-it-re-sizes-with-a-po/37033896#37033896", "title": "Sum of array is negative and trying to reach constant, but it re-sizes with a positive integer", "body": "<p>I'm reasonably confident that this is what is causing your problem:</p>\n\n<pre><code>      'This next array value will always be positive... it goes up by 50 every loop\n        myChutesLadders(countChutesLadders) = myChutesLadders(countChutesLadders) + (makeChutesNegative * 50) \n</code></pre>\n"}], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462446816, "creation_date": 1462380141, "last_edit_date": 1531164843, "question_id": 37033537, "link": "https://stackoverflow.com/questions/37033537/sum-of-array-is-negative-and-trying-to-reach-constant-but-it-re-sizes-with-a-po", "title": "Sum of array is negative and trying to reach constant, but it re-sizes with a positive integer", "body": "<p>My title is awful.</p>\n\n<p>I'm trying to make an array of a haphazard number of members, randomly assigned negative values. I want the sum of this array to fix itself to a specified constant. But, when it does, every once in a while I get a positive number as the last element. I'd rather just add that value to the previous element and delete the positive element. I cannot figure out where I'm going wrong.</p>\n\n<p><strong>Note</strong>: <em>this is an attempt at refactoring this one method to work on both positive and negative totals</em></p>\n\n<pre><code>I have x Chutes = -150 and y Ladders = 100. \nx + y should = Total, unless I resize the array. \nsum (Ladders + Chutes) = -50\n</code></pre>\n\n<p>This is the entire module before the function, it will print on to a sheet to see the results. </p>\n\n<p>To avoid reading the superfluous stuff, it generates a number and splits it to two groups, then passes those groups with the constants to the last function. <strong>The last function is where I'm having the problem</strong> - there are positive elements when my boolean specifying negative is <code>True</code>. </p>\n\n<pre><code>Option Explicit\n\nPublic Const TOTAL_LADDER As Long = 100\nPublic Const TOTAL_CHUTE As Long = -150\n\nPublic Sub ChutesAndLadders()\n    'testing only\n    Range(\"A:C\").ClearContents\n\n    Dim allChutesLadders As Long\n    Dim numberOfChutes As Long\n    Dim numberOfLadders As Long\n    Dim i As Long\n    Dim chutes As Variant\n    Dim ladders As Variant\n\n    allChutesLadders = TotalObjects\n    numberOfChutes = Int(allChutesLadders * Rnd + 1)\n    If numberOfChutes = allChutesLadders Then numberOfChutes = allChutesLadders - 1\n    If numberOfChutes = 1 Or numberOfChutes = 2 Then numberOfChutes = 3\n    numberOfLadders = allChutesLadders - numberOfChutes\n\n    If numberOfLadders = 1 Or numberOfLadders = 2 Then\n        numberOfLadders = 3\n        numberOfChutes = allChutesLadders - numberOfLadders\n    End If\n\n    Cells(1, 5) = \"Total\"\n    Cells(1, 6) = \"Chutes\"\n    Cells(1, 7) = \"Ladders\"\n    Cells(2, 5) = allChutesLadders\n    Cells(2, 6) = numberOfChutes\n    Cells(2, 7) = numberOfLadders\n    Cells(1, 1) = \"Chutes\"\n    Cells(1, 2) = \"Ladders\"\n\n    chutes = ChuteLadderLengths(numberOfChutes, TOTAL_CHUTE, True)\n\n        For i = 1 To UBound(chutes)\n            Cells(i + 1, 1) = chutes(i)\n        Next i\n\n\n    ladders = ChuteLadderLengths(numberOfLadders, TOTAL_LADDER, False)\n\n        For i = 1 To UBound(ladders)\n            Cells(i + 1, 2) = ladders(i)\n        Next i\n\nEnd Sub\n\nPrivate Function TotalObjects() As Long\n    Dim totalCount As Long\n    totalCount = Int((17 - 9 + 1) * Rnd + 9)\n    TotalObjects = totalCount\nEnd Function\n</code></pre>\n\n<p>And here is that function</p>\n\n<pre><code>Private Function ChuteLadderLengths(ByVal countChutesLadders As Long, ByVal totalChutesLadders As Long, ByVal isChute As Boolean) As Variant\n    Dim index As Long\n    Dim sumOfChutesLadders As Double\n    Dim differenceFromTarget As Long\n    Dim makeChutesNegative As Long\n    makeChutesNegative = 1\n    If isChute Then makeChutesNegative = -1\n\n    Dim myChutesLadders() As Double\n    ReDim myChutesLadders(1 To countChutesLadders)\n\n\n    For index = 1 To countChutesLadders\n        myChutesLadders(index) = Rnd()\n    Next index\n\n    sumOfChutesLadders = Application.WorksheetFunction.Sum(myChutesLadders)\n\n    For index = 1 To countChutesLadders\n        myChutesLadders(index) = Int(myChutesLadders(index) / sumOfChutesLadders * totalChutesLadders)\n\n        If myChutesLadders(index) = 0 Then myChutesLadders(index) = makeChutesNegative * 2\n\n    Next index\n\n    sumOfChutesLadders = Application.WorksheetFunction.Sum(myChutesLadders)\n\n\n    differenceFromTarget = totalChutesLadders - sumOfChutesLadders\n    If differenceFromTarget &lt;&gt; 0 Then\n\n        myChutesLadders(countChutesLadders) = myChutesLadders(countChutesLadders) + differenceFromTarget\n\n    End If\n\n\n    For index = 1 To countChutesLadders - 1\n        If Abs(myChutesLadders(index)) &gt;= 98 Then\n            myChutesLadders(index) = myChutesLadders(index) - (makeChutesNegative * 50)\n            myChutesLadders(countChutesLadders) = myChutesLadders(countChutesLadders) + (makeChutesNegative * 50)\n        End If\n    Next\n    'why can chutes end with a positive number?\n    If isChute And myChutesLadders(countChutesLadders) &gt;= 0 Then\n        myChutesLadders(countChutesLadders - 1) = myChutesLadders(countChutesLadders - 1) + myChutesLadders(countChutesLadders)\n        countChutesLadders = countChutesLadders - 1\n        ReDim Preserve myChutesLadders(1 To countChutesLadders)\n    End If\n    'Something can go wrong here\n    If Abs(myChutesLadders(countChutesLadders)) &gt;= 98 Then\n        ReDim Preserve myChutesLadders(1 To countChutesLadders + 1)\n        myChutesLadders(countChutesLadders + 1) = Application.WorksheetFunction.RoundDown(myChutesLadders(countChutesLadders) / 2, 0)\n        myChutesLadders(countChutesLadders) = Application.WorksheetFunction.RoundUp(myChutesLadders(countChutesLadders) / 2, 0)\n\n    End If\n\n'HOW DO I HAVE POSITIVE CHUTES HERE?\nIf isChute And myChutesLadders(countChutesLadders) &gt;= 0 Then MsgBox \"positive chute\"\n\n     ChuteLadderLengths = myChutesLadders()\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>In this part</p>\n\n<pre><code>        For index = 1 To countChutesLadders - 1\n            If Abs(myChutesLadders(index)) &gt;= 98 Then\n                myChutesLadders(index) = myChutesLadders(index) - (makeChutesNegative * 50)\n                myChutesLadders(countChutesLadders) = myChutesLadders(countChutesLadders) + (makeChutesNegative * 50)\n            End If\n        Next\n</code></pre>\n\n<ul>\n<li>Line 3 is <code>-</code> and line 4 is <code>+</code> which allows positive chutes</li>\n<li>If Line 3 is <code>+</code> and line 4 is <code>+</code> I still allow a positive chute and my total chutes can be <code>-250</code> instead of <code>-150</code></li>\n<li>If Line 3 is <code>+</code> and line 4 is <code>-</code> I still allow positive chute </li>\n<li>If Line 3 is <code>-</code> and line 4 is <code>-</code> I still allow positive chute</li>\n</ul>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2014"], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 2909306, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e0a1fbb2d34c238a2b199303a7f0123?s=128&d=identicon&r=PG&f=1", "display_name": "Istaley", "link": "https://stackoverflow.com/users/2909306/istaley"}, "edited": false, "score": 0, "creation_date": 1462392413, "post_id": 37034829, "comment_id": 61624239, "body": "Thanks for the response.  This was the original layout that I had in place, however I needed to combine the label and the parameters into one text box.  My reasoning was because the Export to Excel feature was so lousy that because the tiny Stores: text box would have to line up with a larger text box below (report table), it really effected the way in which Stores was presented.  i.e. right-aligned which made it far away from the edge of the report, if that makes any sense."}], "tags": [], "owner": {"reputation": 424, "user_id": 5822367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f3d973f080835aa7f41ca8237cf160b?s=128&d=identicon&r=PG&f=1", "display_name": "ArturoAP", "link": "https://stackoverflow.com/users/5822367/arturoap"}, "is_accepted": false, "score": 1, "last_activity_date": 1462384776, "creation_date": 1462384776, "answer_id": 37034829, "question_id": 37033264, "link": "https://stackoverflow.com/questions/37033264/ssrs-textbox-hanging-indent/37034829#37034829", "title": "SSRS textbox hanging indent", "body": "<p>You could use a table, in the first column you put \"Stores: \", in the second the string value, set the borders to none and finally play a little with the alignment (First column top-right alignment &amp; Second column top-left alignment, its your choice) to make it look as if it was all in a single text box.</p>\n"}, {"comments": [{"owner": {"reputation": 339, "user_id": 2909306, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e0a1fbb2d34c238a2b199303a7f0123?s=128&d=identicon&r=PG&f=1", "display_name": "Istaley", "link": "https://stackoverflow.com/users/2909306/istaley"}, "edited": false, "score": 0, "creation_date": 1462392220, "post_id": 37035065, "comment_id": 61624139, "body": "Thanks so much, I had messed around with that property before but I had been using positive numbers and I didn&#39;t see a change.  I thought it weird to have the property if it didn&#39;t do anything.  Will note that for the future.  Here I thought I would need some crazy expression"}], "tags": [], "owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "is_accepted": true, "score": 4, "last_activity_date": 1462385615, "creation_date": 1462385615, "answer_id": 37035065, "question_id": 37033264, "link": "https://stackoverflow.com/questions/37033264/ssrs-textbox-hanging-indent/37035065#37035065", "title": "SSRS textbox hanging indent", "body": "<p>The Textbox property you're looking for is called <code>HangingIndent</code>. Try setting it to -10pt.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ERU9F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERU9F.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/zlevK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zlevK.png\" alt=\"results\"></a></p>\n"}], "owner": {"reputation": 339, "user_id": 2909306, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e0a1fbb2d34c238a2b199303a7f0123?s=128&d=identicon&r=PG&f=1", "display_name": "Istaley", "link": "https://stackoverflow.com/users/2909306/istaley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5189, "favorite_count": 0, "accepted_answer_id": 37035065, "answer_count": 2, "score": 3, "last_activity_date": 1462385615, "creation_date": 1462379298, "question_id": 37033264, "link": "https://stackoverflow.com/questions/37033264/ssrs-textbox-hanging-indent", "title": "SSRS textbox hanging indent", "body": "<p>I currently have a text box within a table that displays multiple stores based on user parameter input.  The problem that I am experiencing that I would like to have a hanging indent that will force the store name to indent once it wraps to the next line (see screenshot).\n<a href=\"https://i.stack.imgur.com/IOYNt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IOYNt.jpg\" alt=\"Parameter label that needs a hanging indent\"></a></p>\n\n<p>Is this possible?  I am aware that I could put the \"Stores:\" in it's own textbox, however this makes it difficult when it comes to lining up report items to prevent hidden/merged cells/columns during export to Excel.</p>\n\n<p>The code that I am currently using in the text box is <code>=\"&lt;b&gt;\" &amp; Microsoft.VisualBasic.Interaction.iif(Parameters!StoreKey.Count &gt; 1, \"Stores:  \", \"Store:  \") &amp; \"&lt;/b&gt;\" &amp; Microsoft.VisualBasic.Strings.Join(Parameters!StoreKey.Label, \", \")</code></p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462377561, "post_id": 37032713, "comment_id": 61615505, "body": "A quick note: You didn&#39;t give a sheet for the final destination range. It&#39;s just <code>Range(wkbDest.Sheets()...</code>.  Same with your <code>Cells()</code> and <code>Columns.Count</code>. uses.  Put the worksheet (and workbook, if necessary) before those too. Otherwise, with multiple books/sheets, VBA can get confused."}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462378624, "post_id": 37032713, "comment_id": 61616166, "body": "I&#39;m not sure what you mean. Didn&#39;t I specify the worksheet for my final destination range when I say <code>wkbDest.Sheets(G7_Tab_Name)</code>. Same thing for <code>Columns.Count</code> when I say <code>wkbSource.Sheets(1)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462379612, "post_id": 37033196, "comment_id": 61616760, "body": "Thanks for the words of advice. I&#39;ve updated my code to match yours. However, like you said, the issue still remains. I&#39;m fairly confident it has something to do with how I&#39;m using <code>LastInputRow</code> and <code>LastInputColumn</code> in my <code>CopyRange</code> definition and in the destination line."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462380563, "post_id": 37033196, "comment_id": 61617367, "body": "@kschindl - Can you expand on the issue a little more? Let&#39;s say the last Row in column A is 1000, and the last Column is Z - you expect <code>CopyRange</code> to be (as your code is now) say <code>A1000:Z1</code>?  You might have that backwards. Try using the line in my edit."}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462380780, "post_id": 37033196, "comment_id": 61617505, "body": "Yeah, that would be the expectation. The issue is that no copying/pasting is happening. I put in a <code>CopyRange.Select</code> line to see what range was being used, but I saw that no range was selected when I stepped through the code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462381244, "post_id": 37033196, "comment_id": 61617741, "body": "@kschindl - Oh, I think I see why. In my edited code, just do <code>LastInputRow = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row</code> (leave out <code>Cells</code>)?  When stepping through the code, do your last Row and last Column variables get set correctly?  Another quick note, <code>Sheets(1)</code> isn&#39;t necessarily the same as <code>Sheets(&quot;Sheet1&quot;)</code>."}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462381639, "post_id": 37033196, "comment_id": 61617947, "body": "I edited my <code>CopyRange</code> to your suggestion, which makes way more sense. Still no copying/pasting happening though. I also changed my destination lines to match: <code>Destination:=DestWS.Range(DestWS.Cells(1, 1), DestWS.Cells(LastInputRow, LastInputColumn))</code>. I can see my last Row/Column are set correctly when debugging (27/13 respectively).  Also, I know <code>Sheets(1)</code> isn&#39;t the same. I&#39;m intentionally referring to the first sheet in the workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462382271, "post_id": 37033196, "comment_id": 61618294, "body": "@kschindl - Oh!! How did you declare <code>CopyRange</code>?  See my most recent edit."}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1462382731, "post_id": 37033196, "comment_id": 61618562, "body": "Just as you have it defined. Also, why is it invalid to say <code>SheetToCopy.CopyRange.Select</code> when <code>CopyRange</code> is a defined range? I&#39;m trying to validate that <code>CopyRange</code> has been set correctly."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462384839, "post_id": 37033196, "comment_id": 61619835, "body": "<code>invalid to say SheetToCopy.CopyRange.Select</code> not invalid. Just poor form."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 1, "creation_date": 1462387241, "post_id": 37033196, "comment_id": 61621347, "body": "@kschindl - You can&#39;t really do that, because <code>CopyRange</code> has the worksheet already in the variable.  Just use <code>CopyRange.Select</code>.  You can&#39;t do something like <code>Sheets(&quot;Sheet1&quot;).Sheets(&quot;Sheet1&quot;).Range(&quot;A1:A10&quot;)</code> which is what calling <code>SheettoCopy.CopyRange</code> is trying to do (does that make sense?)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1462390020, "post_id": 37033196, "comment_id": 61622954, "body": "lol that&#39;s what I get for jumping in half way. Ignore me. Listen to Batman."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1462382327, "last_edit_date": 1462382327, "creation_date": 1462379044, "answer_id": 37033196, "question_id": 37032713, "link": "https://stackoverflow.com/questions/37032713/copy-paste-data-with-cell-references-vba/37033196#37033196", "title": "Copy/Paste Data with Cell References (VBA)", "body": "<p>Whenever you use <code>Cells()</code>, <code>Range()</code>, <code>Columns()</code>, <code>Rows()</code>, etc. make sure you let VBA know what worksheet you expect that to be used on,\notherwise , it 'll use the ActiveSheet, which can cause errors.  You did this in some places, but not others. Below I've done a mix of using <code>With</code> statements\nto make life easier for those sheets with long names.  Read through the below and see if you can see what I did. Let me know if you have any questions!</p>\n\n<pre><code>Sub t()\n\nDim G7_Tab_Name As String\nG7_Tab_Name = \"G7\"\nDim wkbDest As Workbook\nSet wkbDest = ActiveWorkbook\nDim SheetToCopy As Worksheet\nSet SheetToCopy = wkbSource.Sheets(1)\n\nWith sheetToCopy\n    LastInputRow = .Cells(.Cells.Rows.Count, \"A\").End(xlUp).Row\n    LastInputColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nCopyRange = SheetToCopy.Range(SheetToCopy.Cells(LastInputRow, 1), SheetToCopy.Cells(1, LastInputColumn))\n\n'Check if any existing data\nDim destWS  As Worksheet\nIf Len(wkbDest.Sheets(G7_Tab_Name).Range(\"A1\").Value) &gt; 0 Then\n    wkbDest.Sheets(G7_Tab_Name).UsedRange.ClearContents\n    Set destWS = wkbDest.Sheets(G7_Tab_Name)\n    CopyRange.Copy Destination:=destWS.Range(destWS.Cells(LastInputRow, 1), destWS.Cells(1, LastInputColumn))\nElse\n    CopyRange.Copy Destination:=destWS.Range(destWS.Cells(LastInputRow, 1), destWS.Cells(1, LastInputColumn))\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>You did this in places, but not everywhere. I.E: <br>\n<code>LastInputRow = wkbSource.Sheets(1).Cells(Cells.Rows.Count, \"A\").End(xlUp).Row</code></p>\n\n<p>You correctly told the <em>first</em> <code>Cells()</code> which sheet to use, but VBA does not \"remember\" anything, so the next <code>Cells.Rows.Count</code> will be on the Active Sheet, which isn't necessarily your <code>wkbSource.Sheets(1)</code> sheet.  Change that line to <br><br>\n<code>LastInputRow = wkbSource.Sheets(1).Cells(wkbSource.Sheets(1).Cells.Rows.Count, \"A\").End(xlUp).Row</code></p>\n\n<p>(Note: This may not solve your issue, but it will absolutely help tighten up the code and leave room for fewer errors).</p>\n\n<p>Edit: Try replacing your <code>CopyRange</code> with this:</p>\n\n<pre><code>With sheetToCopy\ncopyRange = .Range(.Cells(1, 1), .Cells(LastInputRow, LastInputColumn))\nEnd With\n</code></pre>\n\n<p>This will make a range from A1 to the last row in the last column.</p>\n\n<p>Edit2: It's not clear from the code you posted how you declared <code>CopyRange</code>, but you should do it like this:</p>\n\n<pre><code>Dim CopyRange as Range\nSet CopyRange = .Range(.Cells(1, 1), .Cells(LastInputRow, LastInputColumn))\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2068, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462382327, "creation_date": 1462377443, "last_edit_date": 1462379295, "question_id": 37032713, "link": "https://stackoverflow.com/questions/37032713/copy-paste-data-with-cell-references-vba", "title": "Copy/Paste Data with Cell References (VBA)", "body": "<p>I'm trying to copy data from one file into another. First, I'd like to find the last row/column in the source file and use that information to copy the data. However, I can't seem to get the code to copy/paste with the references to the last row and column used. Here's what I currently have:</p>\n\n<pre><code>Dim G7_Tab_Name As String\n   G7_Tab_Name = \"G7\"\nDim wkbDest As Workbook\n   Set wkbDest = ActiveWorkbook\nDim SheetToCopy As Worksheet\n\nLastInputRow = wkbSource.Sheets(1).Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\nLastInputColumn = wkbSource.Sheets(1).Cells(1, Columns.Count).End(xlToLeft).Column\nSet SheetToCopy = wkbSource.Sheets(1)\nCopyRange = Range(SheetToCopy.Cells(LastInputRow, 1), SheetToCopy.Cells(1, LastInputColumn))\n\n'Check if any existing data\nIf Len(wkbDest.Sheets(G7_Tab_Name).Range(\"A1\").Value) &gt; 0 Then\n    wkbDest.Sheets(G7_Tab_Name).UsedRange.ClearContents\n    CopyRange.Copy _\n    Destination:=Range(wkbDest.Sheets(G7_Tab_Name).Cells(LastInputRow, 1), Cells(1, LastInputColumn))\n    Else\n       CopyRange.Copy _\n       Destination:=Range(wkbDest.Sheets(G7_Tab_Name).Cells(LastInputRow, 1), Cells(1, LastInputColumn))\nEnd If\n</code></pre>\n\n<p>I'm pretty sure that I'm not capturing the correct range in my CopyRange definition, but I don't know why. In this case, <code>lastRow=27</code> and <code>lastColumn=13</code>. So, I thought that the range would define as <code>\"A1:M27\"</code>.</p>\n\n<p>I'm defining these ranges as such because I need to loop through multiple files and copy data from the first sheet in each. This code will be included in a larger For loop to hit each file (once I can get it to copy/paste!)</p>\n"}, {"tags": ["image", "vba", "charts"], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "is_accepted": true, "score": 0, "last_activity_date": 1462384231, "creation_date": 1462384231, "answer_id": 37034700, "question_id": 37032607, "link": "https://stackoverflow.com/questions/37032607/paste-range-picture-to-chart-area-for-export-not-working/37034700#37034700", "title": "Paste range picture to chart area for export not working", "body": "<p>Got it...</p>\n\n<pre><code>With TempChrt\n</code></pre>\n\n<p>changed to</p>\n\n<pre><code>wkshtDC.Range(rng1.Address, rng2.Address).CopyPicture xlScreen, xlPicture\n    wkshtDC.ChartObjects(TempChrtNm).Activate\n    With ActiveChart\n        .Paste\n        .Export Filename:=\"G:\\MVOsafe\\Ramp-up\\misc\\TempMatrix\" &amp; i &amp; \".bmp\"\n    End With\n</code></pre>\n\n<p>where</p>\n\n<pre><code>TempChrtNm = TempChrt.Parent.Name\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 37034700, "answer_count": 1, "score": 0, "last_activity_date": 1462384231, "creation_date": 1462377162, "last_edit_date": 1462379972, "question_id": 37032607, "link": "https://stackoverflow.com/questions/37032607/paste-range-picture-to-chart-area-for-export-not-working", "title": "Paste range picture to chart area for export not working", "body": "<p>I'm having a hard time getting the picture to paste to my chart. I've tried various combinations of \"With TempChrt\" to get the .paste to work to no avail.\nIf perhaps I am going around my elbow to solve the problem I am open to suggestions.</p>\n\n<p>Essentially I would like to transfer cells with: specific size, background color, and values to a userform for viewing purposes only. Also sorry but i couldnt get the bold or italicized fonts to work on the bit of code with the problem but the line that hangs up is \".Paste\" following \"With TempChrt\". Method 'Paste' of object '_chart' failed.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n  Dim i As Byte\n  Dim rng1 As Range, rng2 As Range\n  Dim wkshtDC As Worksheet\n  Dim TempChrt As Chart\n  Dim TempChrtNm As String\n\n  Set wkshtDC = Worksheets(\"Data &amp; Calcs\")\n  wkshtDC.Unprotect \"123\"\n  Set TempChrt = wkshtDC.Shapes.AddChart.Chart\n  TempChrtNm = TempChrt.Parent.Name\n  With TempChrt.Parent\n    .Width = 87.12\n    .Height = 285.12\n    .Top = wkshtDC.Range(\"BC28\").Top\n    .Left = wkshtDC.Range(\"BC28\").Left\n  End With\n  For i = 1 To 4\n    Set rng1 = wkshtDC.Range(\"BE28\").Offset(0, i)\n    Set rng2 = wkshtDC.Range(\"BE46\").Offset(0, i)\n    If i &lt;&gt; 1 Then\n        TempChrt.Shapes.Range(Array(\"chart\")).Delete\n    End If\n    wkshtDC.Range(rng1.Address, rng2.Address).CopyPicture xlScreen, xlPicture\n    With TempChrt\n        .Paste\n        .Export Filename:=\"G:\\MVOsafe\\Ramp-up\\misc\\TempMatrix\" &amp; i &amp; \".bmp\"\n    End With\n    Me.Controls(\"Frame\" &amp; i).Picture = LoadPicture(\"G:\\MVOsafe\\Ramp-up\\misc\\TempMatrix\" &amp; i &amp; \".bmp\")\n  Next i\n  TempChrt.Parent.Delete\n  wkshtDC.Protect \"123\"\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462377414, "post_id": 37032622, "comment_id": 61615408, "body": "Thank you Nate -- what would row &quot;I&quot; be?  In this part of the formula:(&quot;ROWS($I$1:$I1)),COLUMNS($I$1:I$1)))"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462377529, "post_id": 37032622, "comment_id": 61615489, "body": "It counts the rows in a selection, so it increments by 1 each time, as the columns, so you are changing the index point with the rows, and the index column with the columns.  Row is k of the small function and columns is column of the index function"}, {"owner": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462377888, "post_id": 37032622, "comment_id": 61615722, "body": "But I don&#39;t have any data in row I -- does that matter?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462377989, "post_id": 37032622, "comment_id": 61615781, "body": "no, it&#39;s not doing counta or count, its Rows() which returns a count of the rows.  Try it, =rows(qq1:qq100) will give you 100, I is simply chosen, as it&#39;s where I&#39;ve put my 1st formula"}, {"owner": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462378086, "post_id": 37032622, "comment_id": 61615840, "body": "Thanks - I am getting the header line returned but no data."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462378151, "post_id": 37032622, "comment_id": 61615874, "body": "have you added as an array, CTRL SHIFT ENTER&gt;"}, {"owner": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462382203, "post_id": 37032622, "comment_id": 61618249, "body": "Hi Nathan - you&#39;re right, i wasn&#39;t added it as an array!  But two things: 1) this is dropping my last row of data that it should be including (as it contains &quot;domestic&quot;.  I do have a header row in the table I am inputting the extracted data - does that matter? Also, Is there a way where I can only bring back certain columns instead of all of them?  I would want columns A, C, D, and E.  And I would want the order of them to be A, E, C, D -- is this possible?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "edited": false, "score": 0, "creation_date": 1462382298, "post_id": 37032622, "comment_id": 61618307, "body": "You need to change to be $2$ where I have $1$ I think.  The 2nd part, change the columns(I:I) bit to be 1 for a, 2 for b, 3 for c etc."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1462377205, "creation_date": 1462377205, "answer_id": 37032622, "question_id": 37032508, "link": "https://stackoverflow.com/questions/37032508/how-to-extract-all-rows-from-excel-data-set-when-cell-column-contains-certain-te/37032622#37032622", "title": "How to extract all rows from excel data set when cell/column contains certain text", "body": "<p>Using an array formula, like so, having data in a1:f21, drag down and across from I1</p>\n\n<pre><code>=IFERROR(INDEX($A$1:$F$21,SMALL(IF($F$1:$F$21=\"domestic\",ROW($F$1:$F$21)),ROWS($I$1:$I1)),COLUMNS($I$1:I$1)),\"\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6291638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829e947cd7b73b065238ec6293465cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea S", "link": "https://stackoverflow.com/users/6291638/andrea-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3302, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462377205, "creation_date": 1462376890, "question_id": 37032508, "link": "https://stackoverflow.com/questions/37032508/how-to-extract-all-rows-from-excel-data-set-when-cell-column-contains-certain-te", "title": "How to extract all rows from excel data set when cell/column contains certain text", "body": "<p>I have an Excel data-set that contains more columns and rows than I need in my final table.  I would like to extract the rows that contain the word \"Domestic\" in it into a new table.<br>\nFor example, I have 6 columns of data (A, B, C, D, E, F) and column \"F\" is where the word \"Domestic\" would be if the cell contains it.  I would then like to bring back columns A, C, and D for all rows where column F contains \"Domestic\" - and if the row does not contain \"Domestic\" it is ignored. My headers is in row 1 and my data runs from row 2-5500. \nCan someone please help me with a formula or exact VBA code that would do this in Excel?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 5, "creation_date": 1462376207, "post_id": 37032253, "comment_id": 61614463, "body": "Do you accidentally put <code>?</code> in front of it?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1462379145, "post_id": 37032253, "comment_id": 61616476, "body": "Maybe time to look at proper error handling."}, {"owner": {"reputation": 564, "user_id": 4175088, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KlNYj.jpg?s=128&g=1", "display_name": "blindguy", "link": "https://stackoverflow.com/users/4175088/blindguy"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1462382190, "post_id": 37032253, "comment_id": 61618238, "body": "@GSerg I did, thanks."}], "owner": {"reputation": 564, "user_id": 4175088, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KlNYj.jpg?s=128&g=1", "display_name": "blindguy", "link": "https://stackoverflow.com/users/4175088/blindguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462376137, "creation_date": 1462376137, "last_edit_date": 1531164843, "question_id": 37032253, "link": "https://stackoverflow.com/questions/37032253/application-screenupdating-true-from-immediate", "title": "Application.ScreenUpdating = True from immediate", "body": "<p>I used to be able to set <code>Application.ScreenUpdating = True</code> from the immediate window after a macro crashed.  Now it just returns <code>True</code> or <code>False</code>.  Can anyone help?</p>\n\n<p>PS, sorry if this has been asked before.  I really did look but only found stuff for others with much different problems.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462381571, "post_id": 37031734, "comment_id": 61617914, "body": "What gives you this &quot;feeling&quot; that it does not do as you expect it to? Did you try to debug the code? Maybe if you include a few break-points and check the values of the variables? You could also include a few message boxes or a <code>Debug.Print i &amp; &quot; : comparing &quot; &amp; Trim(Worksheets(&quot;Master&quot;).Cells(i, 1)) &amp; &quot; to &quot; &amp; Trim(matching_artist)</code> and review the output thereof to ensure that things are going the way you expect / want them to go."}, {"owner": {"reputation": 17, "user_id": 6019131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc49c513d4cd1d21567c6261550480c7?s=128&d=identicon&r=PG&f=1", "display_name": "MBot93", "link": "https://stackoverflow.com/users/6019131/mbot93"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462383681, "post_id": 37031734, "comment_id": 61619095, "body": "Hiya! I&#39;ve edited my post to explain more about the issue, and why I have that feeling. The problem is the code runs fine, so I&#39;m not being shown where the issue is. I will try what you&#39;ve said now, thanks very much for the suggestion!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6019131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc49c513d4cd1d21567c6261550480c7?s=128&d=identicon&r=PG&f=1", "display_name": "MBot93", "link": "https://stackoverflow.com/users/6019131/mbot93"}, "edited": false, "score": 0, "creation_date": 1462384948, "post_id": 37034731, "comment_id": 61619911, "body": "Oh I see, that makes sense... I whacked it in and it works perfectly! You are such a star, thank you so much!"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1462384336, "creation_date": 1462384336, "answer_id": 37034731, "question_id": 37031734, "link": "https://stackoverflow.com/questions/37031734/multicolumn-list-box-not-showing-the-data-i-want-it-to/37034731#37034731", "title": "Multicolumn List Box not showing the data I want it to?", "body": "<p>The problem is that you are always updating (in your code) the very first row of your ListBox. While <code>i</code> goes from 1 to the last row in that sheet, you are always updating <code>ListBox1.List(0, someColumn)</code>. So, you are always updating row 0 (which is the first row in the ListBox.</p>\n\n<p>Give this a try and let me know if it works:</p>\n\n<pre><code>Set matchedartistcell = Worksheets(\"Lots\").Cells(curcell.Row, columnofregion)\nmatching_artist = matchedartistcell.Value2\nFor i = 1 To maxmaster\n    If Trim(Worksheets(\"Master\").Cells(i, 1)) = Trim(matching_artist) Then\n       ListBox1.AddItem (Worksheets(\"Master\").Cells(i, 2))\n       ListBox1.List(ListBox1.ListCount - 1, 1) = Worksheets(\"Master\").Cells(i, 4)\n       ListBox1.List(ListBox1.ListCount - 1, 2) = Worksheets(\"Master\").Cells(i, 5)\n       ListBox1.List(ListBox1.ListCount - 1, 3) = Worksheets(\"Master\").Cells(i, 6)\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6019131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc49c513d4cd1d21567c6261550480c7?s=128&d=identicon&r=PG&f=1", "display_name": "MBot93", "link": "https://stackoverflow.com/users/6019131/mbot93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 37034731, "answer_count": 1, "score": 0, "last_activity_date": 1462384336, "creation_date": 1462374738, "last_edit_date": 1462383611, "question_id": 37031734, "link": "https://stackoverflow.com/questions/37031734/multicolumn-list-box-not-showing-the-data-i-want-it-to", "title": "Multicolumn List Box not showing the data I want it to?", "body": "<p>I have been writing an Excel macro that matches names between two sheets and displays them in a list box. It has no problem in just matching names, but as soon as I try to include other data from one of the sheets, it doesn't seem to loop any more.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Set matchedartistcell = Worksheets(\"Lots\").Cells(curcell.Row, columnofregion)\nmatching_artist = matchedartistcell.Value\nFor i = 1 To maxmaster\n    If Trim(Worksheets(\"Master\").Cells(i, 1)) = Trim(matching_artist) Then\n       ListBox1.AddItem (Worksheets(\"Master\").Cells(i, 2))\n       ListBox1.List(0, 1) = Worksheets(\"Master\").Cells(i, 4)\n       ListBox1.List(0, 2) = Worksheets(\"Master\").Cells(i, 5)\n       ListBox1.List(0, 3) = Worksheets(\"Master\").Cells(i, 6)\n       End If\nNext i\n</code></pre>\n\n<p>So basically, the first column shows a list of names... But the second, third and fourth column show data for the last match on the same row as the first match (if that makes sense?)</p>\n\n<p>I feel like it's not looping in the way I would like it to, but I can't for the life of me figure out why... Any help would be greatly appreciated!!</p>\n\n<p>Thanks!</p>\n\n<p>EDIT for clarity:</p>\n\n<p>I'm including some pictures to better describe the problem, using a test workbook</p>\n\n<p>This is an example of the artists on the worksheet 'Master'\n<a href=\"https://i.stack.imgur.com/HpVpZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HpVpZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is an example of the worksheet I'm running the macro on ('Lots')\n<a href=\"https://i.stack.imgur.com/xGfMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xGfMc.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I run the macro for the artwork by Hannah Smith, I expect the List Box to look something like</p>\n\n<p>Mark Smith      British       1940     1999<br>\nAdam Smith      Australian    1901     1980<br>\nHannah Smith    Canadian      1982     </p>\n\n<p>However, it returns this\n<a href=\"https://i.stack.imgur.com/pwFdH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pwFdH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Mark Smith is being given the nationality and dates of Hannah Smith, and neither Adam Smith or Hannah Smith have any extra info.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 3, "last_activity_date": 1462375061, "creation_date": 1462375061, "answer_id": 37031853, "question_id": 37031516, "link": "https://stackoverflow.com/questions/37031516/userform-is-not-visible-when-placed-on-the-same-worksheet-along-with-activex-con/37031853#37031853", "title": "Userform is not visible when placed on the same worksheet along with activeX controls", "body": "<p>Adding an ActiveX control to a worksheet causes a reset of the VBAproject when that routine ends, which is why your form gets unloaded. I suggest you either use Form controls rather than ActiveX, or use <code>OnTime</code> to show the form after the reset:</p>\n\n<pre><code>Sub DemoFailure()\nDim myOleObj As OLEObject\nDim myRng As Range\n\nSet myRng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C4\")\nThisWorkbook.Sheets(\"Sheet1\").Select\nThisWorkbook.Sheets(\"Sheet1\").Activate\nWith ActiveSheet\n    myRng.RowHeight = 20\n    Set myOleObj = .OLEObjects.Add(ClassType:=\"Forms.CheckBox.1\", DisplayAsIcon:=False, Left:=myRng.Left + 2, Top:=myRng.Top + 2, Width:=myRng.Width - 4, Height:=myRng.Height - 4)\n    With myOleObj\n        '.Object.Caption =\n        .Name = \"CheckBox\" &amp; CStr(ii)\n    End With\nEnd With\nApplication.OnTime Now(), \"ShowIt\"\nEnd Sub\nSub ShowIt()\nUserForm1.Show vbModeless\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6056982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db52bb3a2deb6dd01bf016b24d81ce6?s=128&d=identicon&r=PG&f=1", "display_name": "CSEbe", "link": "https://stackoverflow.com/users/6056982/csebe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462375061, "creation_date": 1462374159, "last_edit_date": 1495535633, "question_id": 37031516, "link": "https://stackoverflow.com/questions/37031516/userform-is-not-visible-when-placed-on-the-same-worksheet-along-with-activex-con", "title": "Userform is not visible when placed on the same worksheet along with activeX controls", "body": "<p>I have asked this question before found under this link \n<a href=\"https://stackoverflow.com/questions/35970881/userform-on-excel-worksheet-dissappears-when-excel-sheet-has-activex-controls-w\">Userform on excel worksheet dissappears when excel sheet has activeX controls! Why</a>\nand I found that I had err'd in accepting the answer.  I'm trying to reopen the question again here.\nI have been working on a project in which I plan to have a worksheet that contains a userform and some activeX controls. The activeX controls are on the worksheet. I have duplicated the problem I'm facing with the script below. When subroutine finishes, the userform is not visible on the screen. If I comment-out the lines pertaining to the OLEObject, then I can see the userform as modeless on the screen. The question is, is this behavior expected? Why does the userform fail to be visible when there are activeX on the worksheet?</p>\n\n<pre><code>Sub DemoFailure()\nDim myOleObj As OLEObject\nDim myRng As Range\n\nSet myRng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C4\")\nThisWorkbook.Sheets(\"Sheet1\").Select\nThisWorkbook.Sheets(\"Sheet1\").Activate\nWith ActiveSheet\n    myRng.RowHeight = 20\n    Set myOleObj = .OLEObjects.Add(ClassType:=\"Forms.CheckBox.1\",     DisplayAsIcon:=False, Left:=myRng.Left + 2, Top:=myRng.Top + 2,   Width:=myRng.Width - 4, Height:=myRng.Height - 4)\n    With myOleObj\n        '.Object.Caption =\n        .Name = \"CheckBox\" &amp; CStr(ii)\n    End With\nEnd With\nUserForm1.Show vbModeless\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "projection", "forecasting", "trend"], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1462382619, "creation_date": 1462382619, "answer_id": 37034252, "question_id": 37031428, "link": "https://stackoverflow.com/questions/37031428/excel-trend-projection/37034252#37034252", "title": "Excel Trend Projection", "body": "<p>Are you familiar with the add-in solver or Data Analysis?  Sometimes you have to unhide it by going to options>add-in>\"Data Analysis\" to use it but it does simple analyses. You will find several helpful tools for doing stats in \"Data Analysis.\"</p>\n"}, {"comments": [{"owner": {"reputation": 1053, "user_id": 626000, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abcb2959e4b34d7e42ec8c89edaddae9?s=128&d=identicon&r=PG&f=1", "display_name": "jackuars", "link": "https://stackoverflow.com/users/626000/jackuars"}, "edited": false, "score": 0, "creation_date": 1462429708, "post_id": 37041753, "comment_id": 61636313, "body": "This looks good. Thanks for taking your time. Am open to other replies too."}, {"owner": {"reputation": 1053, "user_id": 626000, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abcb2959e4b34d7e42ec8c89edaddae9?s=128&d=identicon&r=PG&f=1", "display_name": "jackuars", "link": "https://stackoverflow.com/users/626000/jackuars"}, "edited": false, "score": 0, "creation_date": 1462430974, "post_id": 37041753, "comment_id": 61636963, "body": "What do I do if the values are situated across multiple worksheets? That is, one worksheet contains values for 2015 and other has values for 2016? How can I use ($A$1:$A$10) of 2015 worksheet to get the output in the 2016 worksheet?"}, {"owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "reply_to_user": {"reputation": 1053, "user_id": 626000, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abcb2959e4b34d7e42ec8c89edaddae9?s=128&d=identicon&r=PG&f=1", "display_name": "jackuars", "link": "https://stackoverflow.com/users/626000/jackuars"}, "edited": false, "score": 0, "creation_date": 1462445615, "post_id": 37041753, "comment_id": 61644971, "body": "My pleasure. It should still work regardless of where the values are stored, as long as you get the references right. You would just need to have the sheet name in front of the cells."}], "tags": [], "owner": {"reputation": 70, "user_id": 6273285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37144c3f9c0ad2efa9d222b27b3aa1e4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6273285/mikeg"}, "is_accepted": false, "score": 1, "last_activity_date": 1462418484, "creation_date": 1462418484, "answer_id": 37041753, "question_id": 37031428, "link": "https://stackoverflow.com/questions/37031428/excel-trend-projection/37041753#37041753", "title": "Excel Trend Projection", "body": "<p>You could use the Trend function, setting Known X's to Last Year weeks 1 to 14 and Known Y's to This Year weeks 1 to 14. </p>\n\n<p>Then set the New X's to the same week for last year and the function will use the Least Squares method to extrapolate for this year. </p>\n\n<p>If you use absolute references (e.g. $A$1:$A$10) for the Known X's and Y's, and a relative reference for the New X's, then you can just copy/paste the formula from This Year week 15 down.</p>\n\n<p>Keep in mind though that the further you get from the Known values, the less accurate the forecast becomes...</p>\n"}], "owner": {"reputation": 1053, "user_id": 626000, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abcb2959e4b34d7e42ec8c89edaddae9?s=128&d=identicon&r=PG&f=1", "display_name": "jackuars", "link": "https://stackoverflow.com/users/626000/jackuars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462418484, "creation_date": 1462373899, "question_id": 37031428, "link": "https://stackoverflow.com/questions/37031428/excel-trend-projection", "title": "Excel Trend Projection", "body": "<p>I'm trying to find a trend projection that compares between same week of 2 consecutive years and also from previous weeks of a particular year. What is the excel formula that helps me to do this?</p>\n\n<p>I need to find the projected values for week 15 all the way to week 53 for <strong>This year</strong>, based on </p>\n\n<ol>\n<li><p><strong>The previous weeks of <em>This</em> year</strong> (Week 1- Week 14) as well as </p></li>\n<li><p><strong>The same week <em>Last</em> year</strong> (Week 15)</p></li>\n</ol>\n\n<p><img src=\"https://i.imgur.com/n9cPWOT.png\" alt=\"excel sheet\"></p>\n"}, {"tags": ["vba", "outlook", "save", "attachment"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1462373723, "post_id": 37031141, "comment_id": 61612688, "body": "What is the result you are getting? Are you getting an error or is it not displaying properly?"}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1462374564, "post_id": 37031141, "comment_id": 61613298, "body": "Nothing happens. Nothing is saved at all. The rule is running and marking the message as read.If it helps, the rule is specific to my name so I&#39;m just forwarding emails to myself and then letting it run to see if it saves the attachments. It runs the script which is under Project 1 in VBA. The script is in Module 2 (deleted module 1 so I think that&#39;s why it&#39;s 2)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462376555, "post_id": 37032237, "comment_id": 61614714, "body": "I have permission and I tried &gt; 0 and put the test to see if it was not hitting and nothing saved still. Any suggestions? I don&#39;t know any more ways to get it to hit. It is a client only rule and I&#39;m trying to save to server if that may help."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462376628, "post_id": 37032237, "comment_id": 61614766, "body": "Have you set a break point in your <code>For Each</code> loop to see if it goes in your <code>For Each</code>?"}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462376745, "post_id": 37032237, "comment_id": 61614871, "body": "How would I do that? I&#39;m literally brand new to VBA so I really appreciate the help!"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462376871, "post_id": 37032237, "comment_id": 61614967, "body": "Gray column just to the left of your code, left-click in that column next to a line of code, preferably the first <code>If</code> line of code, and a red dot should appear. Then, run your application and if there are any attachments the code should &quot;pause&quot; on your break point. It will be red and highlighted in yellow when it stops. You then want to look at your Locals Window by going to View &gt; Locals Window, expand <code>itm</code> once and you should see <code>Attachments</code> in there. Let me know if you get that far."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462377264, "post_id": 37032237, "comment_id": 61615287, "body": "Nothing pops up on locals when I get an email. The rule runs and marks the message as read but it must not be running the script. Not sure what&#39;s going on here. I put the break point in the first if statement."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462377358, "post_id": 37032237, "comment_id": 61615359, "body": "Set the breakpoint on the <code>For Each</code> line now to see if your code pauses."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462378738, "post_id": 37032237, "comment_id": 61616224, "body": "So I got the break point at for each. Looks like everything runs as it should. It picks up that there is 1 attachment etc."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462379235, "post_id": 37032237, "comment_id": 61616523, "body": "So now it&#39;s saving and catching at the last else statement. So it&#39;s saving as &quot;caught&quot; in a shared folder. I don&#39;t know why the other else statements aren&#39;t picking up the attachment name."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462379345, "post_id": 37032237, "comment_id": 61616594, "body": "So the name I&#39;m using for objatt.displayname contains only part of the name of the attachment. Does it need to be exact? I just want it to pickup part of the name since the date is different each day I get the email sent to me."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462379375, "post_id": 37032237, "comment_id": 61616616, "body": "So it&#39;s like this  If InStr(objAtt.DisplayName, &quot;Backwater Nine.pdf&quot;) Then         and the attachment will come in as &quot;Backwater Nine 2016.04.12.pdf&quot; I just want it to pick up part of the name is in there since the date will always change. Also only want it to save the pdf&#39;s"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462379649, "post_id": 37032237, "comment_id": 61616786, "body": "You might try <code>objatt.FileName</code> instead. <code>InStr(objAtt.FileName, &quot;Backwater Nine.pdf&quot;, vbTextCompare) &gt; 0</code> sounds like it should fix it for you. <code>vbTextCompare</code> just says non-case sensitive, if you want case-sensitivity then use <code>vbBinaryCompare</code>."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462380358, "post_id": 37032237, "comment_id": 61617223, "body": "Getting a run-time error 13 type mismatch. Not sure why."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462380524, "post_id": 37032237, "comment_id": 61617340, "body": "Which line of your code? Please update what you have so far in your question."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462380957, "post_id": 37032237, "comment_id": 61617599, "body": "Looks like the first If statement."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462385852, "post_id": 37032237, "comment_id": 61620492, "body": "<code>InStr(1, objAtt.FileName, &quot;Backwater Nine.pdf&quot;, vbTextCompare) &gt; 0</code> try that. The <code>1</code> is for the start position. Sry for the delay, lunch time"}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462387628, "post_id": 37032237, "comment_id": 61621588, "body": "Nothing is catching still. So strange. The last else statement is still what goes through."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462388015, "post_id": 37032237, "comment_id": 61621820, "body": "If it hits the <code>Else</code>, then the none of your <code>If</code> conditions are being met and the <code>objAtt.FileName</code> does not match <code>&quot;Backwater Nine.pdf&quot;</code> or whatever you are looking to match."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462388317, "post_id": 37032237, "comment_id": 61622012, "body": "It matches word for word until the date. So the file name is Backwater Nine 2016.04.02.pdf and the statement goes: If InStr(1, objAtt.FileName, &quot;Backwater Nine.pdf&quot;, vbTextCompare) &gt; 0 Then"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462389621, "post_id": 37032237, "comment_id": 61622764, "body": "Then you would need to change to: <code>InStr(1, objAtt.FileName, &quot;Backwater Nine&quot;, vbTextCompare) &gt; 0</code> if <code>objAtt.FileName = &quot;Backwater Nine 2016.04.02.pdf&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462392164, "post_id": 37032237, "comment_id": 61624109, "body": "So if I change it to InStr(1, objAtt.FileName, &quot;Backwater Nine 2016.04.02&quot;, vbTextCompare) &gt; 0 it works. But I will be getting files with different dates every time. I just want it t look for a few key words. By the way... I really, really appreciate your help! You&#39;re awesome for doing this."}, {"owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462392475, "post_id": 37032237, "comment_id": 61624273, "body": "Actually... it works when I takeout .pdf from the name. But I only want PDF files to be saved... any way for this?"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "edited": false, "score": 0, "creation_date": 1462452132, "post_id": 37032237, "comment_id": 61649045, "body": "Are you sure the file type of the attachment you are testing is of type <code>pdf</code>? When you are debugging, you should be able to hover your mouse over <code>objAtt.FileName</code> and it should preview the value for you. You can also copy the value of <code>objAtt.FileName</code> from your locals window by expanding <code>objAtt</code> until you see <code>FileName</code>, then right click and copy. Paste it into your <code>InStr</code> where your double quotes are and trim out all the unnecessary stuff that was copied as well."}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 1, "last_activity_date": 1462377681, "last_edit_date": 1462377681, "creation_date": 1462376101, "answer_id": 37032237, "question_id": 37031141, "link": "https://stackoverflow.com/questions/37031141/outlook-vba-to-save-multiple-attachments-as-different-names/37032237#37032237", "title": "Outlook VBA to Save Multiple Attachments as Different Names", "body": "<p>My guess is you don't have permission to write to <code>P:\\ME\\TEST\\</code> or you aren't getting inside your <code>If</code> statements to save.</p>\n\n<p>You want to set your <code>If</code> lines to be a <code>&gt; 0</code>:</p>\n\n<pre><code>If InStr(objAtt.DisplayName, \"BBB AAA.pdf\") &gt; 0 Then\n</code></pre>\n\n<p>If any character is in the first position other than that name, then it will not go inside the <code>If</code>. Of course, that may also be the behavior you want.</p>\n\n<p>You can test if it is not hitting inside the <code>If</code> statments by adding:</p>\n\n<pre><code>Else\n    objAtt.SaveAsFile saveFolder &amp; \"not caught.pdf\"\nEnd If\n</code></pre>\n\n<p>If you don't get a save after adding the <code>Else</code> code, try saving to your local documents folder. Then, if you still don't get any saves, the <code>MailItem</code> doesn't have any attachments.</p>\n\n<p><strong>EDIT:</strong>\nShould look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/inrHr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/inrHr.png\" alt=\"VBA Editor\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1462380911, "creation_date": 1462373217, "last_edit_date": 1462380911, "question_id": 37031141, "link": "https://stackoverflow.com/questions/37031141/outlook-vba-to-save-multiple-attachments-as-different-names", "title": "Outlook VBA to Save Multiple Attachments as Different Names", "body": "<p>This is what I have so far:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"P:\\ME\\TEST\\\"\nDim dateFormat\ndateFormat = Format(Now, \"yyyy.mm.dd\")\n For Each objAtt In itm.Attachments\n        If InStr(objAtt.FileName, \"ASDFA ADSF.pdf\", vbTextCompare) &gt; 0 Then\n      objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ASDF ASDF.pdf\"\n        ElseIf InStr(objAtt.FileName, \"GASD.pdf\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ASDF ADSF ADD.pdf\"\n        ElseIf InStr(objAtt.FileName, \"ASDF AD.pdf\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ASDF ASDF.pdf\"\n        ElseIf InStr(objAtt.FileName, \"ASDF AS.pdf\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" asd asdf.pdf\"\n        Else\n        objAtt.SaveAsFile saveFolder &amp; \"Caught\"\n  End If\n  Set objAtt = Nothing\n Next\nEnd Sub\n</code></pre>\n\n<p>I used random letters just for privacy. I'm trying to get outlook to autosave email attachments as specific names with date in front using rules and VBA. What am I doing wrong here?</p>\n"}, {"tags": ["excel", "excel-formula", "countif", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3144, "user_id": 1071496, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e35e12577a07f1c6d79930a14f5cec88?s=128&d=identicon&r=PG", "display_name": "Marcello Grechi Lins", "link": "https://stackoverflow.com/users/1071496/marcello-grechi-lins"}, "is_accepted": false, "score": 0, "last_activity_date": 1462373901, "creation_date": 1462373901, "answer_id": 37031429, "question_id": 37031118, "link": "https://stackoverflow.com/questions/37031118/how-to-count-number-between-certain-range-of-rows/37031429#37031429", "title": "how to count number between certain range of rows?", "body": "<p>Here's what I would do</p>\n\n<ul>\n<li>Add a new column with the row index (8 to 14239) in your case</li>\n<li>Add Yet another column, with a formula to tell whether the column you just added is a multiple of 7. Put it's value like \"TRUE\" or \"FALSE\"</li>\n</ul>\n\n<p>You can use the <code>MOD</code> function to check the remainder of the division.</p>\n\n<pre><code>= MOD ( Number , Divisor )\n</code></pre>\n\n<p>By now, you should have, aside from the columns you already have, something like:</p>\n\n<p><code>8-----FALSE</code></p>\n\n<p><code>9-----FALSE</code></p>\n\n<p><code>10-----FALSE</code></p>\n\n<p><code>11-----FALSE</code></p>\n\n<p><code>12-----FALSE</code></p>\n\n<p><code>13-----FALSE</code></p>\n\n<p><code>14-----TRUE</code></p>\n\n<p><code>15-----FALSE</code></p>\n\n<p>Once you have that, just apply a filter on the \"TRUE/FALSE\" column, select the \"TRUE\" values and you will be able to count the number of \"3\"s on the actual value column, by also using a filter on it.</p>\n\n<p>I hope it helps, and it's easier than a really messy formula.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6129938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238e01485ac727e12f6974a8e76f5ff9?s=128&d=identicon&r=PG&f=1", "display_name": "wong km", "link": "https://stackoverflow.com/users/6129938/wong-km"}, "edited": false, "score": 0, "creation_date": 1462459093, "post_id": 37031576, "comment_id": 61653908, "body": "not working , got something like this :      2\t    468     3\t    468     1\t    468"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 3, "last_activity_date": 1462463486, "last_edit_date": 1462463486, "creation_date": 1462374331, "answer_id": 37031576, "question_id": 37031118, "link": "https://stackoverflow.com/questions/37031118/how-to-count-number-between-certain-range-of-rows/37031576#37031576", "title": "how to count number between certain range of rows?", "body": "<p>Simple and easy:</p>\n\n<pre><code>=SUMPRODUCT((B8:B14329=3)*(MOD(ROW(B8:B14329),7)=1))\n</code></pre>\n\n<p>Just change the <code>=1</code> to your needs. To start with row 1 <code>=1</code>, 2 <code>=2</code> ... 6 <code>=6</code>, 7 <code>=0</code>. This way, to start count at row 8 it is <code>=1</code></p>\n\n<p><strong>EDIT</strong>: having your exaple now, you want something completely different... lol.</p>\n\n<pre><code>=IF(MOD(ROW(),7)=0,COUNTIF(A8:A14,3),\"\")\n</code></pre>\n\n<p>Put this in row 14 and then drag down... change the <code>=0</code> as you need it.</p>\n"}], "owner": {"reputation": 27, "user_id": 6129938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238e01485ac727e12f6974a8e76f5ff9?s=128&d=identicon&r=PG&f=1", "display_name": "wong km", "link": "https://stackoverflow.com/users/6129938/wong-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37031576, "answer_count": 2, "score": 1, "last_activity_date": 1462463486, "creation_date": 1462373160, "last_edit_date": 1531161705, "question_id": 37031118, "link": "https://stackoverflow.com/questions/37031118/how-to-count-number-between-certain-range-of-rows", "title": "how to count number between certain range of rows?", "body": "<p>i would like to count number for every 7 rows, data are in one column. i use this formula, but it is not working.</p>\n\n<p>from <code>B8</code> to <code>B14329</code>, for every 7 rows, count number if it is equal to 3. so i know how many 3 in every 7 rows.</p>\n\n<pre><code>=COUNTIFS(B8:B14329, OFFSET($B$7,(ROW()-12)*7,0,7,1),B8:B14329,=3)\n</code></pre>\n\n<p>Thanks a lot!\ni want something like this:</p>\n\n<pre><code>data  count\n3    \n2   \n3   \n1   \n3   \n3   \n1       4\n1   \n2   \n2   \n3   \n3   \n1   \n1       2\n.....\n....\n...\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerquery"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1462375155, "post_id": 37030988, "comment_id": 61613735, "body": "Can&#39;t you either use Data validation dropdowns or link the controls to cells (with an additional INDEX formula) so that M can read the values?"}], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 6560720, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0a77146708fe3396808040a04ad3a487?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/6560720/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1467915187, "creation_date": 1467915187, "answer_id": 38252530, "question_id": 37030988, "link": "https://stackoverflow.com/questions/37030988/excel-power-query-2013-get-combobox-value/38252530#38252530", "title": "Excel Power Query 2013, Get Combobox Value", "body": "<p><strong>user3261018</strong>, </p>\n\n<p>you can try following approach:</p>\n\n<p>Assign the combobox value to a named cell, then address it with </p>\n\n<pre><code> Excel.CurrentWorkbook(){[Name=\"NameOfCellWithComboboxValue\"]}[Content]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3261018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d223ba7181b459c51b64218d552ee8e5?s=128&d=identicon&r=PG&f=1", "display_name": "user3261018", "link": "https://stackoverflow.com/users/3261018/user3261018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467915187, "creation_date": 1462372767, "question_id": 37030988, "link": "https://stackoverflow.com/questions/37030988/excel-power-query-2013-get-combobox-value", "title": "Excel Power Query 2013, Get Combobox Value", "body": "<p>I have a stored proc in my SQL DB which I would like to query for data via Power Query in excel. There are three parameters for this procedure for filtering data, and I would like to pass these via Power Query too. The specific parameters should come from some form controls present in my excel sheet - namely some dropdown comboboxes. I'd like to, within the Power Query M, extract the current value of the combobox and pass it as a parameter to the stored procedure.</p>\n\n<p>I know it's possible to gather cell and row/column data within M, but I haven't been able to find out how to collect form data.</p>\n\n<p>Is there an approach I can take for this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "gmail", "inbox"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462372547, "post_id": 37030037, "comment_id": 61611773, "body": "This question may be better suited for <a href=\"http://superuser.com/\">SuperUser.com</a> than SO. As you stated, you&#39;re asking for some code someone has. You also have three questions - 1 is possible, <a href=\"https://www.google.com/search?q=VBA+gmail&amp;oq=VBA+gmail\" rel=\"nofollow noreferrer\">Google</a> has plenty results for that 2 is probably possible, just use VBA in Outlook (why go through Excel?), 3 is probably quite tricky since the gmail inbox is web-based.  Also, what code did you try? Please post what you&#39;ve done, as SO is not a &quot;code for me&quot; or &quot;give me the code&quot; type site. See <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1462372706, "creation_date": 1462372706, "answer_id": 37030966, "question_id": 37030037, "link": "https://stackoverflow.com/questions/37030037/excel-vba-code-to-loop-through-gmail-emails-in-gmail-inbox/37030966#37030966", "title": "Excel vba code to loop through gmail emails in gmail inbox", "body": "<p>You just need to use the names of the folder, check the following</p>\n\n<pre><code>Sub SetFlagIcon()\n    Dim mpfInbox As Outlook.Folder\n    Dim obj As Outlook.MailItem\n    Dim i As Integer\n    Set mpfInbox = Application.GetNamespace(\"MAPI\").Folders(\"john.smith@gmail.com\").Folders(\"[Gmail]\").Folders(\"Sent Mail\")\n    ' Loop all items in the Inbox\\Test Folder\n    For i = 1 To mpfInbox.Items.Count\n        If mpfInbox.Items(i).Class = olMail Then\n            Set obj = mpfInbox.Items.Item(i)\n            For Each Recipient In obj.Recipients\n                If Recipient.Address = \"myfriend@hotmail.com\" Then\n                    'Set the yellow flag icon\n                    obj.FlagIcon = olYellowFlagIcon\n                    obj.Save\n                End If\n            Next Recipient\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6290988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1a19dc003458aca712c03523b8b315?s=128&d=identicon&r=PG&f=1", "display_name": "h10b", "link": "https://stackoverflow.com/users/6290988/h10b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1344, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462372706, "creation_date": 1462370423, "question_id": 37030037, "link": "https://stackoverflow.com/questions/37030037/excel-vba-code-to-loop-through-gmail-emails-in-gmail-inbox", "title": "Excel vba code to loop through gmail emails in gmail inbox", "body": "<p>Does anyone have excel vba code to copy and paste to loop through gmail emails in a gmail inbox?</p>\n\n<p>While there is a ton out there about:</p>\n\n<p>1) sending gmail with excel vba;</p>\n\n<p>2) looping through emails with excel vba in outlook; and</p>\n\n<p>3) looping through gmail emails in a gmail inbox using other programming languages;</p>\n\n<p>I couldn't find anything to loop through gmail emails in a gmail inbox. </p>\n\n<p>I know I'm actually asking for quite the finished product. It's not that I'm hoping that anyone would be so kind as to write the code for me, but I am hoping that someone might have it already. </p>\n\n<p>After all my attempts to tweak the code I was able to find relative to 1), 2) and 3) above, it became clear to me that I just need to go ahead and post this question. (Who knows, it may help a ton of other folks too.)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1462369806, "post_id": 37029689, "comment_id": 61609410, "body": "Are you <b>sure</b> you didn&#39;t assign <code>LoadData</code> to the other button?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1462369988, "post_id": 37029689, "comment_id": 61609591, "body": "okay not really the answer to the Problem, but does it work with &quot;Optional control As IRibbonControl&quot; ? But i am with rory, sounds like you bound &quot;LoadData&quot; to the second button and not &quot;refresh&quot;"}, {"owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1462382769, "post_id": 37029689, "comment_id": 61618585, "body": "Arg!  You&#39;re right @Rory.  The XML for the button that I thought called the refresh macro actually calls the LoadData macro, so that explains the error.  Thanks!  I&#39;m glad it&#39;s an easy fix.  Can you make you&#39;re comment an answer so I can mark it as the correct answer?  Thanks for your suggestion also Doktor Oswaldo - making the parameter optional would do the trick if I were to leave the XML as it currently is.  Thanks to you both."}], "owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1011, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462369532, "creation_date": 1462369532, "last_edit_date": 1531164843, "question_id": 37029689, "link": "https://stackoverflow.com/questions/37029689/calling-a-macro-from-excel-ribbon-control-vba", "title": "Calling a macro from Excel ribbon control - VBA", "body": "<p>So, I have a macro, <code>LoadData</code>, that I want to call in two separate macros, <code>TransmitNewAndOldRecords</code> and <code>refresh</code>, which are in turn called from a button on a custom tab of the Excel ribbon.</p>\n\n<p>The <code>TransmitNewAndOldRecords</code> works fine.  Here is the code for it.  You can see the call at the second to last line of the macro.</p>\n\n<pre><code>Sub TransmitNewAndOldRecords(control As IRibbonControl)\n'Reference Microsoft ActiveX Data Objects 6.1 Library\n\nDim conn As ADODB.Connection\nDim cmd As ADODB.Command\nDim pgconn As String\nDim Year As String\nDim SQLDelete As String\nDim SQLInsert As String\n\nSet conn = New ADODB.Connection\nSet cmd = New ADODB.Command\n\nYear = ActiveWorkbook.Sheets(\"SQL Creator\").Range(\"Year\").Value\n\npgconn = \"Driver={PostgreSQL};\" &amp; _\n        \"Server = me;\" &amp; _\n        \"Port = 1234;\" &amp; _\n        \"Database = database;\" &amp; _\n        \"Uid = me;\" &amp; _\n        \"Pwd = me;\"\n\nconn.ConnectionString = pgconn\nconn.Open \"PostgreSQL35W\", \"me\", \"me\"\ncmd.CommandType = adCmdText\ncmd.ActiveConnection = conn\n\n'Tests if there are any records to delete.  If so, define SQLDelete variable and execute SQL string that is assigned to SQLDelete variable.\nIf WorksheetFunction.CountIf(Range(\"DELETE\"), \"Y\") &lt;&gt; 0 Then\n    SQLDelete = DeleteRecords(ActiveWorkbook.Sheets(\"Budget\").Range(\"DELETE\"), Year)\n    cmd.CommandText = SQLDelete\n    cmd.Execute\nEnd If\n\n'Tests if there are any records to insert.  If so, define SQLInsert variable and execute SQL string that is assgined to SQLInsert variable.\nIf WorksheetFunction.CountIf(Range(\"INSERT\"), \"Y\") &lt;&gt; 0 Then\n    SQLInsert = InsertRecords(ActiveWorkbook.Sheets(\"Budget\").Range(\"INSERT\"), Year)\n    cmd.CommandText = SQLInsert\n    cmd.Execute\nEnd If\n\n\nconn.Close\n\n'If there are no new/old records to insert/delete, then display message box stating that.  IOF\nIf WorksheetFunction.CountIf(Range(\"DELETE\"), \"Y\") = 0 And WorksheetFunction.CountIf(Range(\"INSERT\"), \"Y\") = 0 Then\n    MsgBox \"No data to insert/delete into/from table.\", vbOKOnly\nElse\n    MsgBox \"Data saved successfully!\", vbOKOnly\nEnd If\n\nSet conn = Nothing\nSet cmd = Nothing\n\nCall LoadData\n\nEnd Sub\n</code></pre>\n\n<p>I also call the <code>LoadData</code> macro in a very simple macro, <code>refresh</code> (seen below), that just calls <code>LoadData</code>. I get an error (Wrong number of arguments or invalid property assignment) when I run <code>refresh</code>.  However, if I add the \"control as iRibbonControl\" parameter to <code>LoadData</code>, it works just fine when called from <code>refresh</code>, but then I get an \"Argument not optional\" error in the <code>TransmitNewAndOldRecords</code> macro above when calling <code>LoadData</code>.</p>\n\n<pre><code>Sub refresh(control As IRibbonControl)\n\nCall LoadData\n\nEnd Sub\n</code></pre>\n\n<p>I'm really confused, because if I add the \"control as IRibbonControl\" parameter to <code>LoadData</code>, then the <code>refresh</code> macro works, but the <code>TransmitNewAndOldRecords</code> macro errors out.  But, if I don't add the \"control as IRibbonControl\" parameter to <code>LoadData</code>, then the <code>refresh</code> macro errors out and the TransmitNewAndOldRecords works.  </p>\n\n<p>Does anybody know why this is happening?</p>\n\n<p>Here is the LoadData macro in case it's needed:</p>\n\n<pre><code>Sub LoadData()\n\nDim conn As ADODB.Connection\nDim cmd As ADODB.Command\nDim rs As ADODB.Recordset\nDim pgconn As String\nDim Team As Range\nDim FC As Range\nDim SQL As String\n\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nSet cmd = New ADODB.Command\nSet Team = ActiveWorkbook.Sheets(\"Info\").Range(\"Info_Team\")\nSet FC = ActiveWorkbook.Sheets(\"Info\").Range(\"Info_FundingCategory\")\nSQL = ActiveWorkbook.Sheets(\"SQL Creator\").Range(\"BudgetSQL\")\n\npgconn = \"Driver={PostgreSQL};\" &amp; _\n        \"Server = me;\" &amp; _\n        \"Port = 1234;\" &amp; _\n        \"Database = database;\" &amp; _\n        \"Uid = me;\" &amp; _\n        \"Pwd = me;\"\n\nconn.ConnectionString = pgconn\nconn.Open \"PostgreSQL35W\", \"me\", \"me\"\ncmd.CommandType = adCmdText\ncmd.ActiveConnection = conn\n\ncmd.CommandText = SQL\n\nrs.Open cmd\nActiveWorkbook.Sheets(\"Budget\").Range(\"A11:Y500\").ClearContents\nActiveWorkbook.Sheets(\"Budget\").Range(\"A11\").CopyFromRecordset rs\nrs.Close\nconn.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1462369159, "post_id": 37029504, "comment_id": 61608899, "body": "Can you post your code so far?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 2, "creation_date": 1462369794, "post_id": 37029504, "comment_id": 61609395, "body": "helper-column which tells (true/false or 0/1 or whatever) for being numeric and then sorting over the helper column first is no option??"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462369912, "post_id": 37029504, "comment_id": 61609512, "body": "do whatever you are doing to sort, when you are done, select the range of numbers and move them to the bottom of your list, select the whole list and move it back to its original position."}, {"owner": {"reputation": 27, "user_id": 4215814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bdf2f72e841b73b6655532d85c0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Adams", "link": "https://stackoverflow.com/users/4215814/jordan-adams"}, "edited": false, "score": 0, "creation_date": 1462369984, "post_id": 37029504, "comment_id": 61609587, "body": "So I can&#39;t really do a helper column because this is being used in a sub  on a full sheet"}], "answers": [{"comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1462371549, "post_id": 37030444, "comment_id": 61610923, "body": "FYI, his sort range is multiple columns if you didn&#39;t notice.  A2:CJ??"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1462371434, "creation_date": 1462371434, "answer_id": 37030444, "question_id": 37029504, "link": "https://stackoverflow.com/questions/37029504/vba-sort-letters-before-numbers-dates/37030444#37030444", "title": "VBA .sort letters before numbers / dates", "body": "<p>Let us assume your data are starting from A2. Your results will be placed from B2</p>\n\n<p>Try with below code</p>\n\n<pre><code>Sub test()\n    lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim Data() As String\n    Dim incre As Long\n    Dim Datanumeric() As String\n    ReDim Data(lastrow - 1)\n    ReDim Datanumeric(lastrow - 1)\n    For i = 2 To lastrow\n        If IsNumeric(Replace(Cells(i, 1), \"/\", \"\")) = True Then\n            Datanumeric(i - 1) = Cells(i, 1)\n        Else\n            Data(i - 1) = Cells(i, 1)\n        End If\n    Next i\n    Call sort(Data())\n    Call sort(Datanumeric())\n    incre = Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n    For i = 1 To lastrow - 1\n        If Data(i) &lt;&gt; \"\" Then\n            Cells(incre, 2) = Data(i)\n            incre = incre + 1\n        End If\n    Next i\n    For i = 1 To lastrow - 1\n        If Datanumeric(i) &lt;&gt; \"\" Then\n            Cells(incre, 2) = Datanumeric(i)\n            incre = incre + 1\n        End If\n    Next i\nEnd Sub\n\nSub sort(list() As String)\n    Dim First As Integer, Last As Long\n    Dim i As Long, j As Long\n    Dim temp As String\n    First = LBound(list)\n    Last = UBound(list)\n    For i = First To Last - 1\n        For j = i + 1 To Last\n            If list(i) &gt;= list(j) Then\n                temp = list(j)\n                list(j) = list(i)\n                list(i) = temp\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Proof of Work</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/A9BWY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A9BWY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 4215814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bdf2f72e841b73b6655532d85c0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Adams", "link": "https://stackoverflow.com/users/4215814/jordan-adams"}, "edited": false, "score": 0, "creation_date": 1462373699, "post_id": 37031078, "comment_id": 61612664, "body": "This would work fine if the list had a defined length and I didnt need to keep all of the formatting / cell highlighting...unfortunately I do"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 27, "user_id": 4215814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bdf2f72e841b73b6655532d85c0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Adams", "link": "https://stackoverflow.com/users/4215814/jordan-adams"}, "edited": false, "score": 0, "creation_date": 1462376461, "post_id": 37031078, "comment_id": 61614642, "body": "@JordanAdams The list does&#39;t need a defined length, but you&#39;ll have to supply the <code>Range</code> to the functions based on your own business logic. I&#39;ve made an edit to my post. Please review it and let us know if it helps."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1462376413, "last_edit_date": 1462376413, "creation_date": 1462373021, "answer_id": 37031078, "question_id": 37029504, "link": "https://stackoverflow.com/questions/37029504/vba-sort-letters-before-numbers-dates/37031078#37031078", "title": "VBA .sort letters before numbers / dates", "body": "<p>EDITED BASED ON NEW INFORMATION:</p>\n\n<p>The below method uses the built-in Excel Custom SortOrder feature to sort based on your requirements. It still uses much of the same helper codes as I previously offered, but this time it uses Excel to perform the sort rather than directly applying from the array. As with the previous code, it does NOT have to be a fixed length list, but you'll have to build in your own logic to test for the size of the sort list. If you need help with that, or anything else, please ask specific questions, and we'll try to offer assistance.</p>\n\n<pre><code>Sub TestTheMethod()\n    ' Run the SortCustom Method supplying the range in question.\n    ' NOTE: Do NOT include the header row.\n    ' First arg is the range to sort\n    ' Second arg is the key based on which you want to sort (note, the column only matters)\n\n    SortCustom Range(\"A2:C23\"), Range(\"B1\")\nEnd Sub\n\n\nSub SortCustom(rInput As Range, rSortField As Range)\n    ' First arg is the range to sort WITHOUT headers\n    ' Second arg is the sort field (only the column matters)\n\n\n    Dim nWidth As Long\n    Dim nHeight As Long\n    Dim vOutput() As Variant\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    nWidth = rInput.Columns.Count\n    nHeight = rInput.Rows.Count\n\n    ReDim vOutput(1 To nHeight, 1 To 1)\n\n    Set rng = Intersect(rInput, rSortField.EntireColumn)\n    vOutput = rng\n\n    BubbleSortArrayCustom vOutput, 1\n\n    Set ws = rInput.Parent\n\n    ws.Sort.SortFields.Clear\n    ws.Sort.SortFields.Add Key:=rng, _\n        CustomOrder:=Join(WorksheetFunction.Transpose(vOutput), \",\")\n\n    With ws.Sort\n        .SetRange rInput\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd Sub\n\nPrivate Sub BubbleSortArrayCustom(vArray() As Variant, nCompIdx As Integer)\n    Dim vPlaceHolder As Variant\n    Dim nFirst As Long\n    Dim nSecond As Long\n    Dim i As Long\n\n    For nFirst = LBound(vArray) To UBound(vArray)\n        For nSecond = nFirst + 1 To UBound(vArray)\n            If CompareTwoValues(vArray(nFirst, nCompIdx), vArray(nSecond, nCompIdx)) Then\n                For i = LBound(vArray, 2) To UBound(vArray, 2)\n                    vPlaceHolder = vArray(nFirst, i)\n                    vArray(nFirst, i) = vArray(nSecond, i)\n                    vArray(nSecond, i) = vPlaceHolder\n                Next i\n            End If\n        Next nSecond\n    Next nFirst\nEnd Sub\n\nPrivate Function CompareTwoValues(v1 As Variant, v2 As Variant) As Boolean\n    Dim bOutput As Boolean\n    Dim sType1 As String\n    Dim sType2 As String\n\n    sType1 = TypeName(v1)\n    sType2 = TypeName(v2)\n\n    If sType1 = \"String\" And sType2 = \"String\" Then\n        bOutput = (v1 &gt; v2)\n    ElseIf sType1 = \"String\" And sType2 &lt;&gt; \"String\" Then\n        bOutput = False\n    ElseIf sType2 = \"String\" And sType1 &lt;&gt; \"String\" Then\n        bOutput = True\n    Else\n        bOutput = (v1 &gt; v2)\n    End If\n\n    CompareTwoValues = bOutput\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>OLD POST:\nTake a look at the attached code. I've broken it down into helper functions to hopefully allow you to understand it easier and ultimately modify it to meet your needs. </p>\n\n<p>The code takes a range to sort and the key upon which to sort. Then it uses as array, a custom comparison method, and a bubble sort, to sort the array then replace the original information.</p>\n\n<p>Give it a try on a COPY of your work and see if it meets your needs. Let us know if you need more help with it.</p>\n\n<pre><code>Sub TestTheMethod()\n    ' Run the SortCustom Method supplying the range in question.\n    ' NOTE: Do NOT include the header row.\n    ' First arg is the range to sort\n    ' Second arg is the key based on which you want to sort (note, the column only matters)\n\n    SortCustom Range(\"A2:C23\"), Range(\"B1\")\nEnd Sub\n\n\nSub SortCustom(rInput As Range, rSortField As Range)\n    ' First arg is the range to sort WITHOUT headers\n    ' Second arg is the sort field (only the column matters)\n\n\n    Dim nWidth As Long\n    Dim nHeight As Long\n    Dim vOutput() As Variant\n\n    nWidth = rInput.Columns.Count\n    nHeight = rInput.Rows.Count\n\n    ReDim vOutput(1 To nHeight, 1 To nWidth)\n\n    vOutput = rInput\n\n    BubbleSortArrayCustom vOutput, (rSortField.Column - rInput.Range(\"A1\").Column + 1)\n\n\n    rInput = vOutput\nEnd Sub\n\nPrivate Sub BubbleSortArrayCustom(vArray() As Variant, nCompIdx As Integer)\n    Dim vPlaceHolder As Variant\n    Dim nFirst As Long\n    Dim nSecond As Long\n    Dim i As Long\n\n    For nFirst = LBound(vArray) To UBound(vArray)\n        For nSecond = nFirst + 1 To UBound(vArray)\n            If CompareTwoValues(vArray(nFirst, nCompIdx), vArray(nSecond, nCompIdx)) Then\n                For i = LBound(vArray, 2) To UBound(vArray, 2)\n                    vPlaceHolder = vArray(nFirst, i)\n                    vArray(nFirst, i) = vArray(nSecond, i)\n                    vArray(nSecond, i) = vPlaceHolder\n                Next i\n            End If\n        Next nSecond\n    Next nFirst\nEnd Sub\n\nPrivate Function CompareTwoValues(v1 As Variant, v2 As Variant) As Boolean\n    Dim bOutput As Boolean\n    Dim sType1 As String\n    Dim sType2 As String\n\n    sType1 = TypeName(v1)\n    sType2 = TypeName(v2)\n\n    If sType1 = \"String\" And sType2 = \"String\" Then\n        bOutput = (v1 &gt; v2)\n    ElseIf sType1 = \"String\" And sType2 &lt;&gt; \"String\" Then\n        bOutput = False\n    ElseIf sType2 = \"String\" And sType1 &lt;&gt; \"String\" Then\n        bOutput = True\n    Else\n        bOutput = (v1 &gt; v2)\n    End If\n\n    CompareTwoValues = bOutput\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1462376294, "last_edit_date": 1462376294, "creation_date": 1462375880, "answer_id": 37032156, "question_id": 37029504, "link": "https://stackoverflow.com/questions/37029504/vba-sort-letters-before-numbers-dates/37032156#37032156", "title": "VBA .sort letters before numbers / dates", "body": "<p>I assume that when you are sorting it now, the numbers appear at the beginning and the letters at the end? If that is always the case (and your letters won't ever start with numbers) couldn't you do the following:</p>\n\n<p>1) Sort everything in decending order, so now your letters appear at the beginning.</p>\n\n<p>2) Then sort just the letters in ascending order, followed by sorting just the numbers in ascending order.</p>\n\n<p>You could identify the letter range after Step 1 by working your way from the top of the sorted list until you came to a number.</p>\n\n<p>Would this achieve what you want?</p>\n"}], "owner": {"reputation": 27, "user_id": 4215814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bdf2f72e841b73b6655532d85c0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Adams", "link": "https://stackoverflow.com/users/4215814/jordan-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1149, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1462376413, "creation_date": 1462369049, "last_edit_date": 1462370267, "question_id": 37029504, "link": "https://stackoverflow.com/questions/37029504/vba-sort-letters-before-numbers-dates", "title": "VBA .sort letters before numbers / dates", "body": "<p>So im using the .sort method in VBA to sort a range of dates.  Mixed in these dates are occasional letters that mean certain things.</p>\n\n<p>I need a way to sort these letters before the dates, and have not yet found a way to do so with the .Sort method.</p>\n\n<p>Any suggestions? </p>\n\n<p>EX)</p>\n\n<pre><code>1/2/16\n4/6/16\n2/5/16\nB\n3/25/16\nFV\n8/10/16\n</code></pre>\n\n<p>--Needs to look like this--</p>\n\n<pre><code>B\nFV\n1/2/16\n2/5/16\n3/25/16\n4/6/16\n8/10/16\n</code></pre>\n\n<p>-- Thanks --</p>\n\n<p>--Current Code--</p>\n\n<pre><code>Dim x As Workbook\nSet x = Workbooks(\"I G T  Ship Balance sheet Template.xlsx\")\n\nlrSort = x.Sheets(\"Template\").Range(\"A500\").End(xlUp).Row\n\nx.Sheets(\"Template\").Range(\"A2:CJ\" &amp; lrSort).Sort Key1:=x.Sheets(\"Template\").Range(\"G2\"), Order1:=xlAscending\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 4, "creation_date": 1462368781, "post_id": 37029277, "comment_id": 61608604, "body": "<code>I cant get them to work together.</code> - What <i>exactly</i> isn&#39;t working?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1462369700, "post_id": 37029277, "comment_id": 61609323, "body": "Why not directly <code>WS.Cells(C, 5).Resize(1, 8).Copy</code>?"}, {"owner": {"reputation": 3, "user_id": 6290941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25dcf77b5559e7649fb4b1f042eb21a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/6290941/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1462370033, "post_id": 37029277, "comment_id": 61609646, "body": "Thanks I will use this"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6290941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25dcf77b5559e7649fb4b1f042eb21a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/6290941/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1462369287, "post_id": 37029443, "comment_id": 61608985, "body": "Perfect! Thank you"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 2, "last_activity_date": 1462369015, "last_edit_date": 1462369015, "creation_date": 1462368892, "answer_id": 37029443, "question_id": 37029277, "link": "https://stackoverflow.com/questions/37029277/excel-vba-nested-loop-issue/37029443#37029443", "title": "Excel VBA Nested Loop Issue", "body": "<p>Since you are looping across the sheets in the workbook, you should fully qualify any ranges with which you are working. Specifically, the following line:</p>\n\n<pre><code>WS.Range(Cells(C, 5), Cells(C, 12)).Copy\n</code></pre>\n\n<p>should be changed to:</p>\n\n<pre><code>WS.Range(WS.Cells(C, 5), WS.Cells(C, 12)).Copy\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6290941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25dcf77b5559e7649fb4b1f042eb21a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/6290941/dan-robertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 37029443, "answer_count": 1, "score": 0, "last_activity_date": 1462369015, "creation_date": 1462368551, "question_id": 37029277, "link": "https://stackoverflow.com/questions/37029277/excel-vba-nested-loop-issue", "title": "Excel VBA Nested Loop Issue", "body": "<p>really hoping someone can help me. </p>\n\n<p>I'm new to VBA only started picking bits up a few weeks back. I'm trying to create a nested loop to consolidate data from multiple tabs in Excel. </p>\n\n<p>This is based on the worksheet name beginning \">\" and column 3 containing a True or False value. Data is then pasted into a sheet called import. </p>\n\n<p>Both loops seem to work independently but I cant get them to work together.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub TestImport()\nDim WS As Worksheet\nDim Criteria As Boolean\nDim C As Integer\nCriteria = True\nApplication.ScreenUpdating = False\nSheets(\"Import\").UsedRange.Offset(1).Clear\nFor Each WS In ThisWorkbook.Worksheets\nIf Left(WS.Name, 1) = \"&gt;\" Then\n    For C = 2 To WS.Range(\"A1000\").End(xlUp).Row\n    If WS.Cells(C, 3) = Criteria Then\n        WS.Range(Cells(C, 5), Cells(C, 12)).Copy\n        Worksheets(\"Import\").Range(\"A100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        End If\n        Next C\n    End If\nNext WS\nApplication.ScreenUpdating = True\nSheets(\"Import\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["macos", "vba", "excel", "password-recovery"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1462368648, "post_id": 37029166, "comment_id": 61608508, "body": "Send it to someone with a windows PC and ask them to do it? In all seriousness the only way I&#39;ve seen this done effectively is by using API calls to grab and amend the value of a message being returned to the application. These APIs obviously aren&#39;t available for Mac so I&#39;m going to go out on a limb and say it&#39;s not possible."}], "owner": {"reputation": 1558, "user_id": 658182, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b2d2ab6c4516b7dadf78748831dc83bb?s=128&d=identicon&r=PG", "display_name": "user658182", "link": "https://stackoverflow.com/users/658182/user658182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1478499808, "creation_date": 1462368267, "last_edit_date": 1495539993, "question_id": 37029166, "link": "https://stackoverflow.com/questions/37029166/is-there-a-way-to-crack-or-bypass-the-vba-project-password-with-excel-2011-mac-e", "title": "Is there a way to crack or bypass the VBA project password with Excel 2011 Mac edition?", "body": "<p>There are several good sources (referenced below) that demonstrate how to bypass VBA project passwords for Windows versions of Excel. But, none of these work for Excel 2011 for Mac.</p>\n\n<p>Is there a way to achieve the same result with Excel 2011 for Mac?</p>\n\n<p>References:\n<a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project\">Is there a way to crack the password on an Excel VBA Project?</a></p>\n\n<p><a href=\"https://superuser.com/questions/807926/how-to-bypass-the-vba-project-password-from-excel\">https://superuser.com/questions/807926/how-to-bypass-the-vba-project-password-from-excel</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462367869, "post_id": 37028781, "comment_id": 61607896, "body": "you make a comment about column by column, but V2:V1000 is only 1 column.  are you number only in column V or are they in other columns as well?  if so those columns would be unaffected. in your second case, if AB1:AB1000 is empty then your selected range is really P1:AB2.  Without known your data this may be ok."}, {"owner": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462368282, "post_id": 37028781, "comment_id": 61608208, "body": "I actually meant column &quot;S&quot;. I&#39;m not sure what is wrong with S"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462368728, "post_id": 37028781, "comment_id": 61608577, "body": "take a look at <a href=\"http://stackoverflow.com/questions/12962656/format-cells-in-excel-for-decimal-places-using-a-macro\">this question</a> see if it helps any.  Seems there they defined what worksheet they were doing the number formatting on."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462369584, "post_id": 37028781, "comment_id": 61609239, "body": "ok when trying to debug this I had multiple workbooks open.  make sure you are defining which worksheet you were working with, and I would go as far as which work book too.  Second make sure the number you are dealing with actually have more or less than 2 decimals or you wont notice the difference."}, {"owner": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462372696, "post_id": 37028781, "comment_id": 61611908, "body": "tried that . didnt work. oh my god. this is killing me. I wrote an entire macro, but cant convert to decimal. ?? Any other ways to convert an entire range or a column to decimal"}], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 1761974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f470e4667fcd8b568db18f833d6f143a?s=128&d=identicon&r=PG", "display_name": "Ste Griffiths", "link": "https://stackoverflow.com/users/1761974/ste-griffiths"}, "is_accepted": false, "score": 0, "last_activity_date": 1462367706, "creation_date": 1462367706, "answer_id": 37028930, "question_id": 37028781, "link": "https://stackoverflow.com/questions/37028781/unable-to-convert-general-to-decimal-in-excel-vba/37028930#37028930", "title": "Unable to convert general to decimal in excel vba", "body": "<p>Using the following worked for me:</p>\n\n<pre><code>Range(\"V2:V1000\").NumberFormat = \"0.00\"\n</code></pre>\n\n<p>If it doesn't work for you, please post a screenshot of your sheet, maybe you have some screwy circumstances affecting your cells?</p>\n"}], "owner": {"reputation": 27, "user_id": 4227052, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/392f21ef2665462d05ee294baba0e009?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4227052/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462369998, "creation_date": 1462367346, "last_edit_date": 1462369998, "question_id": 37028781, "link": "https://stackoverflow.com/questions/37028781/unable-to-convert-general-to-decimal-in-excel-vba", "title": "Unable to convert general to decimal in excel vba", "body": "<p>I have the following code and i am trying to convert a range to decimal.</p>\n\n<pre><code>Range(\"V2:V1000\").Columns.Select\nSelection.NumberFormat = \"0.00\"\n (column by column)\n\nSet wb = Workbooks.Open(XlsFile)\nRange(\"P2\", Range(\"AB1000\").End(xlUp)).NumberFormat = \"#.00\"\n\n(range of columns)\n</code></pre>\n\n<p>none worked. It doesnt throw any error, but the numbers are still without decimals. Any help please.</p>\n\n<p>Update:</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/Z5BSk.png\" alt=\"Example\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1462368034, "creation_date": 1462368034, "answer_id": 37029057, "question_id": 37028765, "link": "https://stackoverflow.com/questions/37028765/getting-record-count-as-1-in-vba/37029057#37029057", "title": "Getting record count as -1 in VBA", "body": "<p>Per MSDN (here: <a href=\"https://msdn.microsoft.com/en-us/library/ms676701(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms676701(v=vs.85).aspx</a>)</p>\n\n<blockquote>\n  <p>The cursor type of the Recordset object affects whether the number of records can be determined. The RecordCount property will return -1 for a forward-only cursor; the actual count for a static or keyset cursor; and either -1 or the actual count for a dynamic cursor, depending on the data source.</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 5412462, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7a8aff538712b8d9b31715345ff580a3?s=128&d=identicon&r=PG&f=1", "display_name": "Daryl", "link": "https://stackoverflow.com/users/5412462/daryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462378288, "creation_date": 1462367287, "last_edit_date": 1531161705, "question_id": 37028765, "link": "https://stackoverflow.com/questions/37028765/getting-record-count-as-1-in-vba", "title": "Getting record count as -1 in VBA", "body": "<p>I have the following code in Excel VBA. When I add a watch on RecordSet, it always shows record count as -1. Infact it should show 3. I have checked the Fields in recordset(by adding a watch) and it shows correct field names.</p>\n\n<pre><code>Sub ConnectSqlServer()\nDim oConn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConnString As String\n\n'Create connection string\nsConnString = \"Provider=sqloledb; Server=D-SRVR; Database=test;    Trusted_Connection=True; Integrated Security=SSPI;\"\n'Create the Connection and Recordset objects\nSet oConn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\n'Open connection and execute\noConn.Open sConnString\nSet rs = oConn.Execute(\"SELECT top 3 * from employee;\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "serverxmlhttp"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462368899, "post_id": 37028710, "comment_id": 61608687, "body": "Sure your header is named &quot;Auth&quot;, not &quot;Authorization&quot;? Try <code>xhr.SetRequestHeader &quot;Authorization&quot;, authToken</code>"}, {"owner": {"reputation": 88, "user_id": 4717579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70dc41cda81e8c0cc791a4781e02a97?s=128&d=identicon&r=PG&f=1", "display_name": "Youcef Medjellakh", "link": "https://stackoverflow.com/users/4717579/youcef-medjellakh"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462369085, "post_id": 37028710, "comment_id": 61608846, "body": "Yes it is named &quot;Auth&quot; and sadly it is not possible to change it at this point (it was not created by me and it is already used by multiple clients) :("}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 4717579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70dc41cda81e8c0cc791a4781e02a97?s=128&d=identicon&r=PG&f=1", "display_name": "Youcef Medjellakh", "link": "https://stackoverflow.com/users/4717579/youcef-medjellakh"}, "edited": false, "score": 0, "creation_date": 1462865873, "post_id": 37130711, "comment_id": 61803620, "body": "Thank you, it actually works with the variable if <i>authToken</i> isn&#39;t an empty string. I don&#39;t really like to send random auth value but as long as it works... Thanks again, have a great day !"}], "tags": [], "owner": {"reputation": 5160, "user_id": 185117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d45e393a98a36a00454a1a659f9e214f?s=128&d=identicon&r=PG", "display_name": "jveazey", "link": "https://stackoverflow.com/users/185117/jveazey"}, "is_accepted": true, "score": 0, "last_activity_date": 1462861464, "creation_date": 1462861464, "answer_id": 37130711, "question_id": 37028710, "link": "https://stackoverflow.com/questions/37028710/custom-header-with-msxml2-serverxmlhttp/37130711#37130711", "title": "Custom header with MSXML2.ServerXMLHTTP", "body": "<p>Try changing the call to SetRequestHeader to use a string literal. I duplicated the problem when <code>authToken</code> does not have a value set.</p>\n\n<p>Change from this</p>\n\n<pre><code>xhr.setRequestHeader \"Auth\", authToken\n</code></pre>\n\n<p>To this</p>\n\n<pre><code>xhr.setRequestHeader \"Auth\", \"testdatahere\"\n</code></pre>\n"}], "owner": {"reputation": 88, "user_id": 4717579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70dc41cda81e8c0cc791a4781e02a97?s=128&d=identicon&r=PG&f=1", "display_name": "Youcef Medjellakh", "link": "https://stackoverflow.com/users/4717579/youcef-medjellakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7826, "favorite_count": 1, "accepted_answer_id": 37130711, "answer_count": 1, "score": 1, "last_activity_date": 1462861464, "creation_date": 1462367139, "question_id": 37028710, "link": "https://stackoverflow.com/questions/37028710/custom-header-with-msxml2-serverxmlhttp", "title": "Custom header with MSXML2.ServerXMLHTTP", "body": "<p>I am currently trying to use MSXML2.ServerXMLHTTP to send a POST http request.\nI need to add a custom header \"Auth\" so that my requests get authorized but it doesn't seem to work. \nHere is the code for my post function:</p>\n\n<pre><code>Function post(path As String, authToken As String, postData As String) As String\n  Dim xhr As Object\n  Dim message As String\nOn Error GoTo error:\n\n  Set xhr = CreateObject(\"MSXML2.ServerXMLHTTP\")\n  xhr.Open \"POST\", path, False\n  xhr.setRequestHeader \"Content-Type\", \"application/json\"\n  xhr.setRequestHeader \"Auth\", authToken\n  xhr.send postData\n\n  If xhr.Status = 200 Then\n    message = xhr.responseText\n  Else\n    message = xhr.Status &amp; \": \" &amp; xhr.statusText\n  End If\n\n  Set xhr = Nothing\n  post = message\nerror:\n  Debug.Print \"Error \" &amp; Err.Number; \":\" &amp; Err.Description\nEnd Function\n</code></pre>\n\n<p>And I end up with \"Error -2147012746 Requested Header was not found\" (The message is actually translated since I use a different language on my computer).</p>\n\n<p>However I didn't have this problem with the \"Microsoft.XMLHTTP\" Object. \nAm I doing something wrong ?</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1462367385, "creation_date": 1462367385, "answer_id": 37028794, "question_id": 37028654, "link": "https://stackoverflow.com/questions/37028654/passing-array-of-sheet-controls-to-modify-their-properties/37028794#37028794", "title": "Passing array of sheet controls to modify their properties", "body": "<p>For CheckBoxes:</p>\n\n<pre><code>Dim collChk(0 To 2) As MSForms.CheckBox\nSet collChk(0) = Chk0\nSet collChk(1) = Chk1\nSet collChk(2) = Chk2\n</code></pre>\n\n<p>Note you need to use <code>Set</code> as they are objects. Then:</p>\n\n<pre><code>Sub SetFalse(ByRef controls() As MSForms.CheckBox)\nDim i As Long\nFor i = LBound(controls) To UBound(controls)\n    controls(i) = False\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 937, "user_id": 2033475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/SJ5pn.png?s=128&g=1", "display_name": "jirkap", "link": "https://stackoverflow.com/users/2033475/jirkap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 37028794, "answer_count": 1, "score": 1, "last_activity_date": 1462367385, "creation_date": 1462366961, "last_edit_date": 1531164843, "question_id": 37028654, "link": "https://stackoverflow.com/questions/37028654/passing-array-of-sheet-controls-to-modify-their-properties", "title": "Passing array of sheet controls to modify their properties", "body": "<p>I'd like to pass an array of (sheet) controls to another sub to modify their properties:</p>\n\n<p>E.g.</p>\n\n<pre><code>Dim collChk(0 To 2) As ? ' Tried Variant, OLEObject, Control...\ncollChk(0) = chk0 \ncollChk(1) = chk1\ncollChk(2) = chk2\n</code></pre>\n\n<p>Sub:</p>\n\n<pre><code>Sub SetFalse(ByRef controls As ?)\nDim i As Long\nFor i = LBound(controls) To UBound(controls)\n    controls(i) = False\nNext i\nEnd Sub\n</code></pre>\n\n<p>But I keep getting: ByRef Argument Type mismatch or other errors</p>\n\n<p>It could also be a Collection, that doesn't matter, but I have not been able to set that up too. I'm a bit lost what works how. Originally, the idea was to pass it as ParamArray, but errors popped out too.</p>\n\n<p>(What would be great is simply to have a function that would work both with Sheet and UserForm controls but I want them specify manually and without duplication.)</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1462363033, "post_id": 37027021, "comment_id": 61604121, "body": "<code>Workbook.Unprotect [password]</code>"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1462366512, "post_id": 37027021, "comment_id": 61606757, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31297188/how-to-unprotect-an-excel-workbook\">How to unprotect an Excel workbook</a>"}], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1462363402, "creation_date": 1462363402, "answer_id": 37027255, "question_id": 37027021, "link": "https://stackoverflow.com/questions/37027021/unprotect-workbook-using-vbscript/37027255#37027255", "title": "Unprotect workbook using VbScript", "body": "<p>Use</p>\n\n<pre><code>Workbooks.Unprotect Password\n\nyour code here\n\nWorkbooks.Protect Password\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2511, "favorite_count": 0, "accepted_answer_id": 37027255, "answer_count": 1, "score": -1, "last_activity_date": 1462363402, "creation_date": 1462362718, "last_edit_date": 1531164843, "question_id": 37027021, "link": "https://stackoverflow.com/questions/37027021/unprotect-workbook-using-vbscript", "title": "Unprotect workbook using VbScript", "body": "<p>I'm using Vbscript to copy worksheets from one workbook to another workbook. I've protected the workbook to prevent anyone from deleting sheets. Because of workbook protection, vbscript cannot copy sheets. I don't know how to unprotect the workbook using vbscript. Does anyone have idea?</p>\n"}, {"tags": ["vba", "excel", "range", "selection"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1462365572, "post_id": 37027976, "comment_id": 61605975, "body": "Look great! I will test it. I also adjusted my own code some but that returns an error 13: types do not match. I will add it to my Original post, I would like to understand why that does not work."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1462366423, "post_id": 37027976, "comment_id": 61606683, "body": "I checked in VBA but did not see the ADO and SQL entries in the tools/references section. I will continu searching if I can find this."}, {"owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "reply_to_user": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1462367488, "post_id": 37027976, "comment_id": 61607593, "body": "I checked my workbook and you are right. Only four libraries are selected. OLE automation and microsoft excel and office 15.0 object libraries might not be selected in yours. Sorry but I dont know about your error."}], "tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 1, "last_activity_date": 1462365508, "last_edit_date": 1462365508, "creation_date": 1462365173, "answer_id": 37027976, "question_id": 37026979, "link": "https://stackoverflow.com/questions/37026979/copy-rows-in-range-with-specific-value-in-column-f/37027976#37027976", "title": "copy rows in range with specific value in column F", "body": "<p>Ok, I ll go with another way. You can use ADO SQL connection to get what you want. I have assumed your source sheet is <code>schaduwlab</code> and I copied query results to a sheet named <code>Sheet1</code>. You can change them according to your own work.</p>\n\n<pre><code>Sub tadaaa()\n\nDim con As Object, rs As Object\nDim query As String\nDim connector As String\nDim adres As String\n\n\n    Set con = CreateObject(\"adodb.connection\")\n    Set rs = CreateObject(\"adodb.recordset\")\n\n    adres = ThisWorkbook.FullName\n\n    connector = \"provider=microsoft.ace.oledb.12.0;data source=\" &amp; _\n             adres &amp; \";extended properties=\"\"Excel 12.0 Macro;hdr=yes\"\"\"\n\n    con.Open connector\n\n\n    query = \"select * from [schaduwblad$] where FCT = \"\"Omzet (x 1000)\"\" AND MKT = \"\"NL Food\"\"\"\n                            'Source sheet\n\n\n    Set rs = con.Execute(query) 'Execute the query\n\n    'Recording query results to any sheet you want.\n    Sheets(\"Sheet1\").Range(\"A65536\").End(3).Offset(1, 0).CopyFromRecordset rs\n\n    For j = 0 To rs.Fields.Count - 1 'For the headers\n        Sheets(\"Sheet1\").Cells(1, j + 1).Value = rs.Fields(j).Name\n    Next j\n\n\nSet rs = Nothing\n\nSet con = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>To get results, you should include ADO and SQL libraries from <code>Tools/References</code> in vba page. I couldn't check because of some works to do. But I arranged it from another vba that I have used before.</p>\n\n<p>Edit: I had tried and it worked. Also changed quotes in query.</p>\n"}], "owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570209908, "creation_date": 1462362630, "last_edit_date": 1570209908, "question_id": 37026979, "link": "https://stackoverflow.com/questions/37026979/copy-rows-in-range-with-specific-value-in-column-f", "title": "copy rows in range with specific value in column F", "body": "<p>I have an worksheet with lots of columns and also lots rows. from this worksheet I want to copy the rows which match 2 conditions:\n1. the value in column B must match the selected value from a dropdown list in a different worksheet\n2. the value in column F must match with the selected value from a different dropdown list.</p>\n\n<p>I have a script that works for condition one.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim fRow As Integer, lRow As Integer\nDim value As String\nDim mychart As chart\nDim mycharts As ChartObject\n\nIf ActiveCell.Address = Sheets(\"blad1\").Cells(1, 1).Address Then\n\nSheets(\"chartdata\").Cells.ClearContents\n\nFor Each ChartObject In Sheets(\"blad3\").ChartObjects\nChartObject.Delete\nNext\n\nvalue = Sheets(\"blad1\").Cells(1, 1).value\n\nWith Sheets(\"schaduwblad\")\nfRow = .Range(\"B:B\").find(what:=value, after:=Range(\"B1\")).Row\nlRow = .Range(\"B:B\").find(what:=value, after:=Range(\"B1\"), lookat:=xlWhole, searchdirection:=xlPrevious).Row\n.Range(\"B1:DT1\").Copy _\nSheets(\"chartdata\").Range(\"A1\")\n.Range(\"B\" &amp; fRow, \"DT\" &amp; lRow).Copy _\nSheets(\"chartdata\").Range(\"A2\")\n\n\n  With Sheets(\"blad3\")\n  Set mychart = .Shapes.AddChart.chart\n\n    With mychart\n      .SetSourceData Source:=Sheets(\"chartdata\").Range(\"B1\").CurrentRegion\n      .ChartType = xlLine\n      .HasTitle = True\n      .HasLegend = True\n\n      With .ChartTitle\n      .Text = \"=Blad1!R1C1\"\n      .AutoScaleFont = False\n      .Font.FontStyle = \"verdana\"\n\n      End With\n      With mychart.Legend\n\n        .FontSize = 8\n        .Position = xlLegendPositionBottom\n        .AutoScaleFont = False\n        .Font.FontStyle = \"verdana\"\n        .FontSize = 8\n      End With\n\n    End With\n  End With\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But I cannot create the script that is needed to also match condition 2.</p>\n\n<p>Here is a screenshot from the structure the document has:\n<a href=\"https://i.stack.imgur.com/Kl3ub.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kl3ub.png\" alt=\"https://i.imgsafe.org/5e7034c.png\"></a><br>\n<sub>(source: <a href=\"https://i.imgsafe.org/5e7034c.png\" rel=\"nofollow noreferrer\">imgsafe.org</a>)</sub>  </p>\n\n<p>The first condition is that the match with the value in column B. That is a closed range which can easily be copied. \nBut the second condition uses the value in column F, which is changing every row.</p>\n\n<p>For example, based on the screenshot, I want to select all the rows which have the value NL Food in column B and the Omzet (x 1000) in column F. (so rows which have Verkopen (x1000) in verpakkingen) have to be excluded from the selection.</p>\n\n<p>(the choice for omzet (x 1.000) or Verpakking (x 1.000) is also made using a drop down list).</p>\n\n<p>How can I make VBA to only select the rows which meet both conditions?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I was able to change the data layout so that now FCT is in column B directly after MKT. This way, all data is first sorted on MKT and after that on FCT so my data layout should make it easier to select the area which matches both conditions, as it is one closed range.\n<a href=\"https://i.stack.imgur.com/grMc2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/grMc2.png\" alt=\"http://i.imgsafe.org/00db13c.png\"></a></p>\n\n<p>Therefore, I thought I was able to change the code and have both conditions met.</p>\n\n<p>I added a <em>frow2</em> and <em>lrow2</em> which now have to find the <em>value2</em> parameter in column B. However, with the code which is posted below, I get an Error 13 message saying \"types do not match\". I do not understand why that is. I guess it has something to do with the way I defined the search range for frow2 and lrow2.</p>\n\n<p>Part of the adjusted code is below, I added the italic lines</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim fRow As Integer, lRow As Integer, frow2 As Integer, lrow2 As Integer\n\nDim value As String\nDim value2 As String\nDim mychart As chart\nDim mycharts As ChartObject\n\nIf ActiveCell.Address = Sheets(\"blad1\").Cells(1, 1).Address Then\n\nSheets(\"chartdata\").Cells.ClearContents\n\nFor Each ChartObject In Sheets(\"blad3\").ChartObjects\nChartObject.Delete\nNext\n\nvalue = Sheets(\"blad1\").Cells(1, 1).value\nvalue2 = Sheets(\"blad1\").Cells(1, 3).value\n\nWith Sheets(\"schaduwblad\")\nfRow = .Range(\"A:A\").find(what:=value, after:=Range(\"A1\")).Row\nlRow = .Range(\"A:A\").find(what:=value, after:=Range(\"A1\"), lookat:=xlWhole, searchdirection:=xlPrevious).Row\nfrow2 = .Range(.Cells(fRow, 2), .Cells(lRow, 2)).find(what:=value2, after:=Range(\"B1\"), lookat:=xlWhole).Row\nlrow2 = .Range(.Cells(fRow, 2), .Cells(lRow, 2)).find(what:=value2, after:=Range(\"B1\"), lookat:=xlWhole, searchdirection:=xlPrevious).Row\n.Range(\"E1:DS1\").Copy\nSheets(\"chartdata\").Range(\"A1\")\n.Range(\"E\" &amp; fRow, \"DS\" &amp; lrow2).Copy_\nSheets(\"chartdata\").Range(\"A2\")_\n</code></pre>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I tried this line (see below)  to find out why I get the error 13.</p>\n\n<pre><code>frow2 = .Range(\"B:B\").find(what:=value2, after:=Range(\"B1\"), lookat:=xlWhole).Row\n</code></pre>\n\n<p>Where I use the entire column B as search range. This works fine for the find methode. \nAs soon as I change the range to anything else I get the error 13 message: types do not match. </p>\n\n<p>It seems the <em>range.find</em> method cannot work with ranges which are defined more then just an entire column? (e.g. B2:B41).</p>\n\n<p><strong>Edit 3:</strong> The reason I got the error 13 message was that I searched in a range for example B2:B41 and in the find. parameters I entered B1 as find.after range. I changed it now like this and it works:</p>\n\n<pre><code>frow2 = .Range(.Cells(fRow, 2), .Cells(lRow, 2)).find(what:=value2, after:=Range(\"B\" &amp; fRow), lookat:=xlWhole).Row\nlrow2 = .Range(.Cells(fRow, 2), .Cells(lRow, 2)).find(what:=value2, after:=Range(\"B\" &amp; fRow), lookat:=xlWhole, searchdirection:=xlPrevious).Row\n</code></pre>\n"}, {"tags": ["excel", "date", "time", "graph", "vba"], "comments": [{"owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1462363082, "post_id": 37026644, "comment_id": 61604165, "body": "I&#39;m not sure if it is relevant, but the dates i get always appear in chronological order. Might make the code easier..."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1462363736, "post_id": 37026644, "comment_id": 61604628, "body": "I&#39;ve added the excel and excel-vba tags to your question"}], "answers": [{"comments": [{"owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "edited": false, "score": 0, "creation_date": 1462376295, "post_id": 37030897, "comment_id": 61614527, "body": "Thank you for the solution."}], "tags": [], "owner": {"reputation": 98, "user_id": 4859515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cdcb8f93603189e9d03f048249de56?s=128&d=identicon&r=PG&f=1", "display_name": "freakfeuer", "link": "https://stackoverflow.com/users/4859515/freakfeuer"}, "is_accepted": true, "score": 0, "last_activity_date": 1462373246, "last_edit_date": 1462373246, "creation_date": 1462372527, "answer_id": 37030897, "question_id": 37026644, "link": "https://stackoverflow.com/questions/37026644/automatically-organize-data-in-a-sheet-differently-in-order-to-create-a-dynamic/37030897#37030897", "title": "Automatically Organize data in a sheet differently (in order to create a dynamically updated graph)", "body": "<p>It's just a guess since you didn't say what the chart should display.</p>\n\n<p>I am pretty sure you can create this chart without the second sheet and a macro.</p>\n\n<p>Try this:</p>\n\n<ol>\n<li>Format the Range containing the data as table ( Select Range, Home -> Styles -> Format as Table) When you add a new row this table will automatically extend.</li>\n<li>Create a Pivot-Chart ( Select all cells in the new table, Insert -> PivotTable (the Name, not the symbol) -> PivotChart)</li>\n<li>Choose a destination for the PivotChart</li>\n<li>Click in the Pivot-Field and select your 3 entries</li>\n</ol>\n\n<p>It should look like this (I filtered the \"--\" Workers):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Td5ak.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Td5ak.png\" alt=\"enter image description here\"></a></p>\n\n<p>Play around in the 4 fields (drag&amp;drop) to fit it your style. If you add new rows simply right click anywhere in the pivot table and press refresh.</p>\n\n<p>Edit: I forgot to mention that I did this in Excel 2010.</p>\n"}], "owner": {"reputation": 104, "user_id": 6281534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8942ad29d9e153034eb2cfca0dd83d20?s=128&d=identicon&r=PG&f=1", "display_name": "carlos_cs", "link": "https://stackoverflow.com/users/6281534/carlos-cs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 37030897, "answer_count": 1, "score": 0, "last_activity_date": 1462373246, "creation_date": 1462361710, "last_edit_date": 1531161705, "question_id": 37026644, "link": "https://stackoverflow.com/questions/37026644/automatically-organize-data-in-a-sheet-differently-in-order-to-create-a-dynamic", "title": "Automatically Organize data in a sheet differently (in order to create a dynamically updated graph)", "body": "<p>I currently have this in sheet1 columns A,B,C:<br/></p>\n\n<p>Date    Time    Worker<br/> \n04/04/2016  4,5 John<br/> \n05/04/2016  2   John<br/> \n06/04/2016  6,5 John<br/> \n07/04/2016  0   --<br/> \n08/04/2016  0,5 Charles<br/> \n08/04/2016  2   John<br/> \n08/04/2016  0,5 William<br/> \n09/04/2016  0   --<br/> \n10/04/2016  0   --<br/> \n11/04/2016  9   John<br/> \n11/04/2016  3,75    William<br/> </p>\n\n<p>I want this in sheet2 columns A,B,C,D (or more in case of more names):<br/></p>\n\n<p>Date    Charles John    William<br/>\n04/04/2016  0   4,5 0<br/>\n05/04/2016  0   2   0<br/>\n06/04/2016  0   6,5 0<br/>\n07/04/2016  0   0   0<br/>\n08/04/2016  0,5 2   0,5<br/>\n09/04/2016  0   0   0<br/>\n10/04/2016  0   0   0<br/>\n11/04/2016  0   9   3,75<br/></p>\n\n<p>I need this because I need to make a graph and data has to be organised like this or I'm not able to create the graph! <br/>\nThe code (which i believe it's the only way) has to work with any given dates, times or worker names! Worker names in alphabetical order if you can.<br/>\nI don't have any clue how to code this and it is giving me nightmares for weeks. Really need all the help for this one. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1462362564, "creation_date": 1462362564, "answer_id": 37026952, "question_id": 37026377, "link": "https://stackoverflow.com/questions/37026377/copy-width-and-height-in-addition-to-data-in-vba/37026952#37026952", "title": "copy width and height in addition to data in VBA", "body": "<p>Use the <code>.PasteSpecial()</code> method</p>\n\n<pre><code>Set RngTemplate = ActiveWorkbook.Worksheets(\"Template\").Range(\"A1:AD1\")\nSet RngTarget = ActiveWorkbook.Worksheets(\"File1\").Range(\"A1:AD1\")   \nRngTemplate.Copy\nRngTarget.PasteSpecial\nRngTarget.PasteSpeical xlPasteColumnWidths\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 9864, "user_id": 2693545, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jxhDd.jpg?s=128&g=1", "display_name": "refactor", "link": "https://stackoverflow.com/users/2693545/refactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 37026952, "answer_count": 1, "score": 1, "last_activity_date": 1462362564, "creation_date": 1462360934, "last_edit_date": 1531164843, "question_id": 37026377, "link": "https://stackoverflow.com/questions/37026377/copy-width-and-height-in-addition-to-data-in-vba", "title": "copy width and height in addition to data in VBA", "body": "<p>Below code copies data(as well as formatting) from source range to target range.</p>\n\n<pre><code>Set RngTemplate = ActiveWorkbook.Worksheets(\"Template\").Range(\"A1:AD1\")\nSet RngTarget = ActiveWorkbook.Worksheets(\"File1\").Range(\"A1:AD1\")   \nRngTemplate.Copy RngTarget\n</code></pre>\n\n<p>But I also want the cell widths to be copied to target range, any idea how to implement it.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6290366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e135a10e4128e92d7c52be879aad2b23?s=128&d=identicon&r=PG&f=1", "display_name": "L. Kostanjsek", "link": "https://stackoverflow.com/users/6290366/l-kostanjsek"}, "edited": false, "score": 1, "creation_date": 1462368860, "post_id": 37026447, "comment_id": 61608653, "body": "Why I didn&#39;t think of that I don&#39;t know. Thank you so much, you&#39;re a life saver!"}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 0, "last_activity_date": 1462361091, "creation_date": 1462361091, "answer_id": 37026447, "question_id": 37026347, "link": "https://stackoverflow.com/questions/37026347/how-to-copy-the-values-within-a-dynamic-named-range/37026447#37026447", "title": "How to copy the values within a dynamic named range?", "body": "<p>Try pasting the value only:</p>\n\n<pre><code>Sub Sample() \n\nDim wsI As Worksheet, wsO As Worksheet\n\nSet wsI = ThisWorkbook.Sheets(\"Sheet1\")\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nwsI.Range(\"Pct_waste\").Copy \nwsO.Range(\"B4\").PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1462362488, "creation_date": 1462362488, "answer_id": 37026924, "question_id": 37026347, "link": "https://stackoverflow.com/questions/37026347/how-to-copy-the-values-within-a-dynamic-named-range/37026924#37026924", "title": "How to copy the values within a dynamic named range?", "body": "<p>or something like this</p>\n\n<pre><code>Sub test()\n\nDim r As Excel.Range\nDim i As Integer\n\nSet r = Range(\"test_range\")\n\nFor i = 1 To r.Cells.Count\n    Range(\"x\" &amp; i).Value = r.Cells(i, 1).Value\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>or you could do something like this as static formula in the sheet, =index(range_name,rows($A$1:$A1),1) and fill down, also trap the errors using IFERRROR, this will be static though.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1462362799, "creation_date": 1462362799, "answer_id": 37027049, "question_id": 37026347, "link": "https://stackoverflow.com/questions/37026347/how-to-copy-the-values-within-a-dynamic-named-range/37027049#37027049", "title": "How to copy the values within a dynamic named range?", "body": "<p>Use the <code>.Resize()</code> method:</p>\n\n<pre><code>Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nWith wsI.Range(\"Pct_waste\")\n    wsO.Range(\"B4\").Resize(.Rows.Count, .Columns.Count).Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6290366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e135a10e4128e92d7c52be879aad2b23?s=128&d=identicon&r=PG&f=1", "display_name": "L. Kostanjsek", "link": "https://stackoverflow.com/users/6290366/l-kostanjsek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 37026447, "answer_count": 3, "score": 0, "last_activity_date": 1462363645, "creation_date": 1462360848, "last_edit_date": 1462363645, "question_id": 37026347, "link": "https://stackoverflow.com/questions/37026347/how-to-copy-the-values-within-a-dynamic-named-range", "title": "How to copy the values within a dynamic named range?", "body": "<p>I've doing a waste calculation exercise at work, and I've got several dynamic named ranges whose cells all contain values arrived at by formulae. I need a module that will copy the values within a dynamic named range onto another sheet without copying the formulae themselves, just the values that the cells contain. I tried to use this:</p>\n\n<pre><code>Sub Sample()\n    Dim wsI As Worksheet, wsO As Worksheet\n\n    Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\n    Set wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\n    wsI.Range(\"Pct_waste\").Copy wsO.Range(\"B4\")\n\nEnd Sub\n</code></pre>\n\n<p>But this copies the formulae, which is no use. And I can't just use absolute references because I need to be able to quickly add new data. Ultimately, I intend to create a macro that will copy the values within the dynamic named ranges to a new sheet, then sort these values numerically and plot them on a scatter chart. So I need to find a way to copy all the values in my dynamic named ranges without copying the formulae themselves.</p>\n\n<p>Also, I'm fairly novice when it comes to VBA so go easy! </p>\n"}, {"tags": ["vba", "attachmate-extra"], "comments": [{"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1462361211, "post_id": 37026275, "comment_id": 61602853, "body": "I&#39;m not sure what you mean. How is a terminal emulation for mainframes like AS/400 (<a href=\"http://stackoverflow.com/tags/extra/info\">stackoverflow.com/tags/extra/info</a>) connected to printing a page in VBA (Visual Basic for Applications, scripting language used in Microsoft Office products such as Excel)? <b>EDIT:</b> Oh I get it, there is a software called &quot;Attachmate Extra&quot;... I&#39;m going to propose an edit to your question then."}, {"owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "reply_to_user": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1462362062, "post_id": 37026275, "comment_id": 61603442, "body": "@CherryDT Yes sorry, It is a mainframe that uses VBA also. And it works nearly the same as VBA for Excel... But the problem is that I can&#39;t find anything about printing the page."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1462362374, "post_id": 37026275, "comment_id": 61603656, "body": "OK now it appears I myself was confused and on the wrong track. Appears my edit went through anyway, but it was unnecessary then. Never mind."}], "answers": [{"tags": [], "owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "is_accepted": true, "score": 1, "last_activity_date": 1462543971, "creation_date": 1462543971, "answer_id": 37074636, "question_id": 37026275, "link": "https://stackoverflow.com/questions/37026275/attachmate-extra-vba-print-current-page/37074636#37074636", "title": "Attachmate Extra : VBA : Print current page", "body": "<p>It may be done easily using the <code>Session</code> object and its method <code>PrintDisplay</code></p>\n\n<p>It'll send the current data present on the page to the printer as if you pushed yourself on the printer icon.</p>\n\n<p><code>Sess0.PrintDisplay</code></p>\n"}], "owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 37074636, "answer_count": 1, "score": 0, "last_activity_date": 1462543971, "creation_date": 1462360637, "last_edit_date": 1462361994, "question_id": 37026275, "link": "https://stackoverflow.com/questions/37026275/attachmate-extra-vba-print-current-page", "title": "Attachmate Extra : VBA : Print current page", "body": "<p>Is there a function that exists to print the current page using Extra and VBA?</p>\n\n<p>I didn't found anything on the internet.. Thank you very much</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462362055, "post_id": 37026126, "comment_id": 61603436, "body": "Are you familiar with <i>VBA</i> ??"}, {"owner": {"reputation": 163, "user_id": 1576659, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c92effbc14b160082e7032f726c07a8c?s=128&d=identicon&r=PG", "display_name": "GiANTOnFire", "link": "https://stackoverflow.com/users/1576659/giantonfire"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462364191, "post_id": 37026126, "comment_id": 61604951, "body": "@Gary&#39;sStudent   I am indeed. Do you think that is the best way to do it? Can you give me some guidance on how to do it that way?"}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 1576659, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c92effbc14b160082e7032f726c07a8c?s=128&d=identicon&r=PG", "display_name": "GiANTOnFire", "link": "https://stackoverflow.com/users/1576659/giantonfire"}, "edited": false, "score": 0, "creation_date": 1462439639, "post_id": 37028772, "comment_id": 61641392, "body": "Thank you for this  - brill! As a relatively VBA newbie, how can I get this code to run regularly - such as every time column B: changes? or every time cell C5 is clicked into?"}, {"owner": {"reputation": 163, "user_id": 1576659, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c92effbc14b160082e7032f726c07a8c?s=128&d=identicon&r=PG", "display_name": "GiANTOnFire", "link": "https://stackoverflow.com/users/1576659/giantonfire"}, "edited": false, "score": 0, "creation_date": 1462440904, "post_id": 37028772, "comment_id": 61642233, "body": "sorry, silly question! I have now pulled my head back into today and done that!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1462367318, "creation_date": 1462367318, "answer_id": 37028772, "question_id": 37026126, "link": "https://stackoverflow.com/questions/37026126/excel-or-vba-populate-a-drop-down-list-from-a-dynamic-column-in-another-sheet/37028772#37028772", "title": "Excel or VBA - populate a drop down list from a dynamic column in another sheet with no duplicates", "body": "<p>Here is a start.  I assume the the list of items is in <em>Sheet2</em> somewhere from <strong>B1</strong> through <strong>B1000</strong>.  It's O.K. if the range is only partially filled <em>(adjust the 1000 to suit your needs)</em>.</p>\n\n<p>The code scans this list and builds a DV string.  The Data Validation is then applied to <em>Sheet1</em> cell <strong>C5</strong>:</p>\n\n<pre><code>Sub setupDV()\n    Dim rSource As Range, rDV As Range, r  As Range, csString As String\n    Dim c As Collection\n\n    Set rSource = Sheets(\"Sheet2\").Range(\"B1:B1000\")\n    Set rDV = Sheets(\"Sheet1\").Range(\"C5\")\n    Set c = New Collection\n    csString = \"\"\n    On Error Resume Next\n    For Each r In rSource\n        v = r.Value\n        If v &lt;&gt; \"\" Then\n            c.Add v, CStr(v)\n            If Err.Number = 0 Then\n                If csString = \"\" Then\n                    csString = v\n                Else\n                    csString = csString &amp; \",\" &amp; v\n                End If\n            Else\n                Err.Number = 0\n            End If\n        End If\n    Next r\n    On Error GoTo 0\n\n    'MsgBox csString\n\n    With rDV.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=csString\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 1576659, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c92effbc14b160082e7032f726c07a8c?s=128&d=identicon&r=PG", "display_name": "GiANTOnFire", "link": "https://stackoverflow.com/users/1576659/giantonfire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16013, "favorite_count": 1, "accepted_answer_id": 37028772, "answer_count": 1, "score": 1, "last_activity_date": 1463834172, "creation_date": 1462360260, "question_id": 37026126, "link": "https://stackoverflow.com/questions/37026126/excel-or-vba-populate-a-drop-down-list-from-a-dynamic-column-in-another-sheet", "title": "Excel or VBA - populate a drop down list from a dynamic column in another sheet with no duplicates", "body": "<p>I don't know if this is even possible, but I am trying to do a couple of things that require me to populate drop down lists, and a normal cell by cell list, based on the items in a column on another sheet. I know how to do this with a regular column, but the column I want to use changes length and has many duplicate values in it, as it is an inventory of sorts. </p>\n\n<p>So on this sheet, in C5, </p>\n\n<p><a href=\"https://i.stack.imgur.com/arEMH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/arEMH.png\" alt=\"enter image description here\"></a>\nthat value should be able to be selected from a drop down list based on the contents of column B in the second sheet, but also without having to scroll through duplicates. \n <a href=\"https://i.stack.imgur.com/8HR7J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8HR7J.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am happy to use either VBA or general excel formulas to achieve this. I am also aware that I don't think I have explained this very well so please feel free to prompt me for more information as required. </p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6286723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210045866890230/picture?type=large", "display_name": "Steve Brookes", "link": "https://stackoverflow.com/users/6286723/steve-brookes"}, "edited": false, "score": 0, "creation_date": 1462361634, "post_id": 37026252, "comment_id": 61603154, "body": "Thank you for your answer, however this seems to generate a compile error"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462378278, "post_id": 37026252, "comment_id": 61615953, "body": "Could it be that the <code>m.To</code> contains an <code>@</code> sign and that such a character is not allowed in a path? Maybe it works if you alter your answer to <code>savePath = &quot;S:\\Sales &amp; Marketing\\Sales\\Correspondence\\&quot; &amp; Replace(m.to, &quot;@&quot;, &quot;To&quot;) &amp; &quot;\\&quot;</code>?"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1462360587, "creation_date": 1462360587, "answer_id": 37026252, "question_id": 37025781, "link": "https://stackoverflow.com/questions/37025781/outlook-save-item-variable-path/37026252#37026252", "title": "Outlook Save Item Variable Path", "body": "<pre><code>savePath = \"S:\\Sales &amp; Marketing\\Sales\\Correspondence\\\" &amp; m.to &amp; \"\\\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6286723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210045866890230/picture?type=large", "display_name": "Steve Brookes", "link": "https://stackoverflow.com/users/6286723/steve-brookes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325585, "creation_date": 1462359435, "last_edit_date": 1593325585, "question_id": 37025781, "link": "https://stackoverflow.com/questions/37025781/outlook-save-item-variable-path", "title": "Outlook Save Item Variable Path", "body": "<p>I am using the following code to automatically save sent items to a folder:</p>\n\n<pre><code>Sub SaveACopy(Item As Object)\nConst olMsg As Long = 3\n\nDim m As MailItem\nDim savePath As String\n\nIf TypeName(Item) &lt;&gt; \"MailItem\" Then Exit Sub\n\nSet m = Item\n\nsavePath = \"S:\\Sales &amp; Marketing\\Sales\\Correspondence\\\"\nsavePath = savePath &amp; m.To &amp; Format(Now(), \"yyyy-mm-dd-hhNNss\")\nsavePath = savePath &amp; \".msg\"\n\n\nm.SaveAs savePath, olMsg\n</code></pre>\n\n<p>How do I dynamically change the path so that mail is stored in a folder relevant to the recipient? Effectively, a folder would be created if its the first email to the user, or if the folder exists, it will be stored in there. In my head the save path looks like this:</p>\n\n<pre><code>savePath = \"S:\\Sales &amp; Marketing\\Sales\\Correspondence\\m.to\\\"\n</code></pre>\n\n<p>But clearly, that does not work.</p>\n\n<p>Any assistance appreciated.</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1462356811, "post_id": 37024616, "comment_id": 61599653, "body": "What is the sample string to test? With any Unicode symbol? I cannot repro, <code>Execute</code> matches the Unicode character."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1462357211, "post_id": 37024616, "comment_id": 61599926, "body": "As written your code will only give the count from the last cell checked, whether or not it contains any special characters."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1462357321, "post_id": 37024616, "comment_id": 61599996, "body": "Actually, the <code>specialCharactersFound</code> will always contain the last &quot;special&quot; character."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462357437, "post_id": 37024616, "comment_id": 61600080, "body": "What do you mean by <i>the execute operation does not work as expected</i> ?  I&#39;ve run your code, it runs without error.  What results do you expect?"}, {"owner": {"reputation": 43, "user_id": 4706395, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/10d7605582195d0202073a8669768338?s=128&d=identicon&r=PG&f=1", "display_name": "kurkum", "link": "https://stackoverflow.com/users/4706395/kurkum"}, "edited": false, "score": 0, "creation_date": 1462359622, "post_id": 37024616, "comment_id": 61601686, "body": "The sample string can be &quot;\u0192&quot; (ASCII Code 159), for example.  Well, how can I make the specialCharactersFound object collect all the special characters found and not only the last special character?  Let&#39;s say, for example, that if &quot;A1&quot; cell contains the text &quot;\u0192&quot; and cell &quot;A2&quot; cell contatins the text &quot;&#225;&quot;, I expect to get the following messages:  &quot;Number of affected cells: 2&quot; &quot;Number of special characters found: 2&quot;  With the current code, the second message refers to 0 instead of 2.  Thanks for the help."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462359947, "post_id": 37024616, "comment_id": 61601931, "body": "<code>Set specialCharactersFound = RegExpo.Execute(strInput)</code> should be inside your <code>If</code> block. More importantly though - VBScript RegExp object doesn&#39;t work like java regex for example - you need to save the result of the match each time to another collection otherwise it will be overwritten with each iteration."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1462360748, "post_id": 37024616, "comment_id": 61602514, "body": "@WiktorStribi\u017cew No, it won&#39;t. It will contain <b>all</b> special characters from the last cell."}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1462360753, "creation_date": 1462360753, "answer_id": 37026318, "question_id": 37024616, "link": "https://stackoverflow.com/questions/37024616/excel-vba-regexp-test-operation-works-but-execute-operation-does-not/37026318#37026318", "title": "Excel VBA - RegExp - &quot;Test&quot; operation works, but &quot;Execute&quot; operation does not", "body": "<p>I suggest adding these 2 lines to variable declarations:</p>\n\n<pre><code>Dim specialCharactersFound As New Collection\nDim mtch As Object\n</code></pre>\n\n<p>and then, instead of the code between <code>counter = 0</code> and <code>Next</code>, use</p>\n\n<pre><code>counter = 0\nSet specialCharactersFound = New Collection ' Initialize the collection for special chars\n\nFor Each cell In Worksheets(1).Range(\"A1:A100\")\n    strInput = Worksheets(1).Range(cell.Address).Value\n    Set mtch = RegExpo.Execute(strInput)  ' Find the matches\n    For Each objMatch In mtch             ' Iterate throug the match collection\n       specialCharactersFound.Add (mtch(0).Value) ' Add the char found to the collection\n    Next\n    Worksheets(1).Range(cell.Address).Interior.ColorIndex = 20\n    counter = counter + 1   ' Increment the affected cell count\nNext\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4706395, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/10d7605582195d0202073a8669768338?s=128&d=identicon&r=PG&f=1", "display_name": "kurkum", "link": "https://stackoverflow.com/users/4706395/kurkum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 37026318, "answer_count": 1, "score": 0, "last_activity_date": 1462360753, "creation_date": 1462356482, "question_id": 37024616, "link": "https://stackoverflow.com/questions/37024616/excel-vba-regexp-test-operation-works-but-execute-operation-does-not", "title": "Excel VBA - RegExp - &quot;Test&quot; operation works, but &quot;Execute&quot; operation does not", "body": "<p>Please see the following code:</p>\n\n<pre><code>Sub CountAndHighlightProblematicCells()\n\nDim RegExpo As New RegExp\nDim strPattern As String: strPattern = \"[^\\u0020-\\u007E]\"\nDim specialCharactersFound As Object\n\n\nDim strInput As String\nDim counter As Long\n\nRegExpo.Global = True\nRegExpo.MultiLine = True\nRegExpo.IgnoreCase = False\nRegExpo.Pattern = strPattern\n\ncounter = 0\n\nFor Each cell In Worksheets(1).Range(\"A1:A100\")\n    strInput = Worksheets(1).Range(cell.Address).Value\n    If (RegExpo.Test(strInput)) Then\n        Worksheets(1).Range(cell.Address).Interior.ColorIndex = 20\n        counter = counter + 1\n    End If\n    Set specialCharactersFound = RegExpo.Execute(strInput)\n\nNext\n\nMsgBox (\"Number of affected cells: \" &amp; counter)\nMsgBox (\"Number of special characters found: \" &amp; specialCharactersFound.Count)\n\nEnd Sub\n</code></pre>\n\n<p>For some reason, the test operation works as expected, but the execute operation does not. </p>\n\n<p>If you think that it has something to do with the for loop, I checked and it does not - the execute operation does not work as expected even when The focus in on one cell only.</p>\n\n<p>What am I doing wrong? I'm not very experienced with VBA generally and RegExp \nspecifically.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Kurkum</p>\n"}, {"tags": ["excel", "vba", "unicode", "non-ascii-characters"], "comments": [{"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1462378777, "post_id": 37024107, "comment_id": 61616252, "body": "Terminology: As you know, Unicode is a superset of ASCII. However, the ASCII characters are in what is called a &quot;block&quot; not a <a href=\"http://www.fileformat.info/info/unicode/category/index.htm\" rel=\"nofollow noreferrer\">Unicode category</a>; specifically the <a href=\"http://unicode.org/charts/nameslist/\" rel=\"nofollow noreferrer\">C0 Controls and Basic Latin</a> block."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574435869, "post_id": 37024107, "comment_id": 104244538, "body": "FYI The ChrW CharCode argument is a <code>Long</code> that identifies a character, but doesn&#39;t allow values greater than <code>65535</code> (hex value <code>&amp;HFFFF</code>). It might be of some practical interest to find systematic ways to overcome this restriction - c.f. six solutions at <a href=\"https://stackoverflow.com/questions/56008191/get-unicode-characters-with-charcode-values-greater-hex-ffff\">Get UniCode characters with CharCode greater hex FFFF</a>, e.g. in Unicode block <code>1F300-1F5FF</code> &quot;Miscellaneous symbols and pictographs&quot; :-)"}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462355509, "post_id": 37024127, "comment_id": 61598736, "body": "Can you please give me an example for it. I am not able to find any application.clean() in the autotext code in vba."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462355739, "post_id": 37024127, "comment_id": 61598877, "body": "Please take a look at this <a href=\"http://pasteboard.co/FtkoMrB.png\" rel=\"nofollow noreferrer\">pasteboard.co/FtkoMrB.png</a>  I also have tried &quot;strName = Clean(strName)&quot; and they did not work."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1462355991, "post_id": 37024127, "comment_id": 61599048, "body": "Try with Application.WorksheetFunction.Clean(&quot;&#252;&#228;&#246;a\u0160sd&quot;). But it will not help you, it is only for non-printable characters. And yours are printable."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1462361355, "post_id": 37024127, "comment_id": 61602968, "body": "@Vityata You are right. This is just a test to see if you are paying attention xD :P  But @Jeevan <code>.clean</code> exist under <code>worksheetfunction</code> but it can also be called under <code>application</code>. I&#39;ll just leave the answer here for reference."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1462361614, "post_id": 37024127, "comment_id": 61603137, "body": "I did not get exactly what you mean. The &quot;application.clean&quot; does not show with Intellisense, but with &quot;application.worksheetfunction.clean&quot; it is there."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1462362133, "post_id": 37024127, "comment_id": 61603485, "body": "see this <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2003-customize/applicationxlfunc-v-worksheetfunctionxlfunc/2f05c80c-7e2e-4a4f-a638-cb0d03d9a234?auth=1\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2003-customi&zwnj;&#8203;ze/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1462355238, "creation_date": 1462355238, "answer_id": 37024127, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/37024127#37024127", "title": "Remove Unicode characters in a String", "body": "<p>try <code>application.clean()</code></p>\n\n<p>it will remove all unprintable characters</p>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462356540, "post_id": 37024397, "comment_id": 61599451, "body": "Yes It prints the same for me. I am having \u0178 as special character, but when passed as a string inside Replace method strName = Replace(strName, ChrW(376), &quot; &quot;), where strName is initially \u0178LPAIF becomes ?LPAIF. This string then goes to a write to file method, where the code crashes saying &quot;Run-time error &#39;5&#39; Invalid procedure call or argument&quot;. I think that ? newly produced is also not an ordinary question mark, but some special character. I want to replace it in my dynamic string, not in a static one as &quot;\u0178\u0178\u0178\u0178&quot; you shown."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462357229, "post_id": 37024397, "comment_id": 61599937, "body": "Hi, I think it is working in Debug.Print but when using actual value from cell where \u0178 is present, it doesn&#39;t do that."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1462355958, "creation_date": 1462355958, "answer_id": 37024397, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/37024397#37024397", "title": "Remove Unicode characters in a String", "body": "<p>What do you get when you write the following in the immediate window?</p>\n\n<pre><code>?Replace(\"\u0178\u0178\u0178\u0178\", ChrW(376), \"ale\")\n</code></pre>\n\n<p>I get:\nalealealeale</p>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462357268, "post_id": 37024531, "comment_id": 61599955, "body": "Hi, I tried this code, and it replaced \u0178 with a ? in the output. Which still doesn&#39;t solve the issue."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462357516, "post_id": 37024531, "comment_id": 61600145, "body": "I think while reading itself \u0178 is read as ? by excel. \u0178 is anyway invisible in excel sheet."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462357894, "post_id": 37024531, "comment_id": 61600422, "body": "As you see in my picture, the &quot;This \u0152 is \u0153 a \u0160 test\u0161 . \u0178 \u0192 Blubb.&quot; is actual content of my sheet. With this my code works exactly as I have described it. Where do you see the &quot;\u0178&quot; which is then <b>not</b> visible in the sheet?"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462358253, "post_id": 37024531, "comment_id": 61600700, "body": "I see \u0178 when I copy paste that string from the excel cell to a notepad. Thanks for trying to help. We have a solution now Ambie. Thanks for your efforts."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1462356260, "creation_date": 1462356260, "answer_id": 37024531, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/37024531#37024531", "title": "Remove Unicode characters in a String", "body": "<p>Supposing you have:</p>\n\n<p><a href=\"https://i.stack.imgur.com/L2FEy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L2FEy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the following code will get the <code>String</code> from <code>A1</code> and let through only <code>ANSI</code> (code 0 to 255) in <code>A2</code>.</p>\n\n<pre><code>Sub test()\n Dim s1 As String, s2 As String, c As String, i As Long, iAsc As Integer\n\n s1 = Range(\"A1\").Value\n\n s2 = \"\"\n\n For i = 1 To Len(s1)\n  c = Mid(s1, i, 1)\n  iAsc = AscW(c)\n  If iAsc &lt;= 255 Then\n   s2 = s2 &amp; c\n  End If\n Next\n\n Range(\"A2\").Value = s2\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462356668, "post_id": 37024561, "comment_id": 61599548, "body": "I am using something similar, but the moto of my code is not this. It should allow special character which are ASCII, but only remove special character which doesn&#39;t come under ASCII code of 0 to 255."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462358149, "post_id": 37024561, "comment_id": 61600617, "body": "My String looks like LPAIF in excel sheet, but there is a \u0178 char hidden in front which is not visible in excel, but it exist, so the string is \u0178LPAIF. Some solutions given above worked when I gave &quot;\u0178LPAIF&quot; as a static string, but not when read from excel directly. Anyway we have a solution now, thanks for trying to help."}, {"owner": {"reputation": 2461, "user_id": 11826132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7IobZ.png?s=128&g=1", "display_name": "rustyBucketBay", "link": "https://stackoverflow.com/users/11826132/rustybucketbay"}, "edited": false, "score": 0, "creation_date": 1568149660, "post_id": 37024561, "comment_id": 102181180, "body": "I tried hard removing strange characters from my string in VBA and this code was very helpfull for me"}, {"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "edited": false, "score": 0, "creation_date": 1605829573, "post_id": 37024561, "comment_id": 114780016, "body": "It removes all unicode characters in a string. However, it also removes spaces."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 2, "last_activity_date": 1462356329, "creation_date": 1462356329, "answer_id": 37024561, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/37024561#37024561", "title": "Remove Unicode characters in a String", "body": "<p>Try with below</p>\n\n<pre><code>Function ClearUnwantedString(fulltext As String) As String\n    Dim output As String\n    Dim character As String\n    For i = 1 To Len(fulltext)\n        character = Mid(fulltext, i, 1)\n        If (character &gt;= \"a\" And character &lt;= \"z\") Or (character &gt;= \"0\" And character &lt;= \"9\") Or (character &gt;= \"A\" And character &lt;= \"Z\") Then\n            output = output &amp; character\n        End If\n    Next\n    ClearUnwantedString = output\nEnd Function\n\nSub test()\n    a = ClearUnwantedString(\"dfj\u0152\u0153\u0160dskl\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 1, "creation_date": 1462357947, "post_id": 37025007, "comment_id": 61600463, "body": "Hey Thanks a lot, it works. Not sure of all conditions and all special Unicode characters, but for now it works well. It just takes too much time for processing."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 1, "creation_date": 1462358277, "post_id": 37025007, "comment_id": 61600712, "body": "If you&#39;re converting many strings eg in a loop, then try defining the pattern once and just calling the <code>.Replace</code> function inside your loop. That might help with speed."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462358482, "post_id": 37025007, "comment_id": 61600870, "body": "Thank you :) That did not reduce the time much but anyway it helped to reduce a little bit of time."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462383164, "post_id": 37025007, "comment_id": 61618799, "body": "Does this cover all the unicode or just 0 to 7F? Will this work for all boundary conditions? Please let me know."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462533601, "post_id": 37025007, "comment_id": 61687023, "body": "It will replace any character not in the Unicode range 0 to 127."}, {"owner": {"reputation": 409, "user_id": 2324547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd1a348b3f8da120d4f967731e3c86?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/2324547/frank"}, "edited": false, "score": 0, "creation_date": 1600630545, "post_id": 37025007, "comment_id": 113141455, "body": "Need to add this option in: regEx.Global = True"}, {"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "edited": false, "score": 0, "creation_date": 1605829528, "post_id": 37025007, "comment_id": 114780009, "body": "Only remove one Unicode character, not all of them in a string."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 7, "last_activity_date": 1462357511, "last_edit_date": 1495540973, "creation_date": 1462357511, "answer_id": 37025007, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/37025007#37025007", "title": "Remove Unicode characters in a String", "body": "<p>Would a <code>RegEx</code> solution be of interest to you?</p>\n\n<p>There are plenty of examples for different languages on this site - here's a C# one: <a href=\"https://stackoverflow.com/questions/123336/how-can-you-strip-non-ascii-characters-from-a-string-in-c\">How can you strip non-ASCII characters from a string? (in C#)</a>.</p>\n\n<p>Try this for VBA:</p>\n\n<pre><code>Private Function GetStrippedText(txt As String) As String\n    Dim regEx As Object\n\n    Set regEx = CreateObject(\"vbscript.regexp\")\n    regEx.Pattern = \"[^\\u0000-\\u007F]\"\n    GetStrippedText = regEx.Replace(txt, \"\")\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6628423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca233855968f8fc5322e645a127fab?s=128&d=identicon&r=PG&f=1", "display_name": "Mabaega", "link": "https://stackoverflow.com/users/6628423/mabaega"}, "edited": false, "score": 0, "creation_date": 1599303467, "post_id": 49231448, "comment_id": 112737132, "body": "wow... Thanks. it work for me without Application.WorksheetFunction.Trim. Worksheet function give me error."}, {"owner": {"reputation": 347, "user_id": 5326540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/316744cecf1f05658bf01f607ceb6539?s=128&d=identicon&r=PG&f=1", "display_name": "Sorin GFS", "link": "https://stackoverflow.com/users/5326540/sorin-gfs"}, "reply_to_user": {"reputation": 55, "user_id": 6628423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca233855968f8fc5322e645a127fab?s=128&d=identicon&r=PG&f=1", "display_name": "Mabaega", "link": "https://stackoverflow.com/users/6628423/mabaega"}, "edited": false, "score": 0, "creation_date": 1599315627, "post_id": 49231448, "comment_id": 112740189, "body": "@Mabaega Ofc, you may play with the <code>Replace</code> function too, e.g. you may put dashes, or leave the spaces, this is up to your needs. Lately, starting with the ClickToRun aproatch of MS Office gives 1004 error for the base excel functions in VBA..."}], "tags": [], "owner": {"reputation": 347, "user_id": 5326540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/316744cecf1f05658bf01f607ceb6539?s=128&d=identicon&r=PG&f=1", "display_name": "Sorin GFS", "link": "https://stackoverflow.com/users/5326540/sorin-gfs"}, "is_accepted": false, "score": 2, "last_activity_date": 1538150510, "last_edit_date": 1538150510, "creation_date": 1520845548, "answer_id": 49231448, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string/49231448#49231448", "title": "Remove Unicode characters in a String", "body": "<p>Don't need to loop each character</p>\n\n<p>Maybe late, but maybe it helps someone:</p>\n\n<pre><code>Public Function StripNonAsciiChars(ByVal InputString As String) As String\n    Dim i As Integer\n    Dim RegEx As Object\n    Set RegEx = CreateObject(\"VBScript.RegExp\")\n    With RegEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = \"[^\\u0000-\\u007F]\"\n        StripNonAsciiChars = Application.WorksheetFunction.Trim(RegEx.Replace(InputString, \" \"))\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23057, "favorite_count": 1, "accepted_answer_id": 37025007, "answer_count": 6, "score": 5, "last_activity_date": 1574290196, "creation_date": 1462355182, "last_edit_date": 1574290196, "question_id": 37024107, "link": "https://stackoverflow.com/questions/37024107/remove-unicode-characters-in-a-string", "title": "Remove Unicode characters in a String", "body": "<p>How do I remove all special characters which don't fall under ASCII category in VBA? </p>\n\n<p>These are some of the symbols which appear in my string.</p>\n\n<blockquote>\n  <p>\u0152 \u0153 \u0160 \u0161 \u0178 \u0192</p>\n</blockquote>\n\n<p>There are many more such characters. </p>\n\n<p>These don't belong to ASCII category as you can see here <a href=\"http://www.ascii.cl/htmlcodes.htm\" rel=\"nofollow noreferrer\">http://www.ascii.cl/htmlcodes.htm</a></p>\n\n<p>I tried something like this</p>\n\n<pre><code>strName = Replace(strName, ChrW(376), \" \")\n</code></pre>\n"}, {"tags": ["excel", "loops", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1619, "user_id": 3262483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73af2bdacceb9809bdd8615e530cd02e?s=128&d=identicon&r=PG&f=1", "display_name": "twin", "link": "https://stackoverflow.com/users/3262483/twin"}, "is_accepted": true, "score": 0, "last_activity_date": 1462354616, "creation_date": 1462354616, "answer_id": 37023894, "question_id": 37023660, "link": "https://stackoverflow.com/questions/37023660/vba-excel-loop-overwriting-results/37023894#37023894", "title": "VBA EXCEL: Loop overwriting results", "body": "<p>You don't update  <code>LastRow</code>, so you end up writing into the same cell again and again.\nInsert an increment like this:</p>\n\n<pre><code>    If autECLSession.autECLPS.GetTextRect(x, 26, x, 32) = \"Debitor\" Then\n        Range(\"B\" &amp; LastRow).Offset(1, 0).Value = Trim(autECLSession.autECLPS.GetTextRect(x, 9, x, 17))\n        LastRow = LastRow + 1\n    End If\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6289785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dca42bbfeba4c161542e678ebc0c249?s=128&d=identicon&r=PG&f=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/6289785/mehrdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 37023894, "answer_count": 1, "score": -1, "last_activity_date": 1462354616, "creation_date": 1462354040, "last_edit_date": 1531164843, "question_id": 37023660, "link": "https://stackoverflow.com/questions/37023660/vba-excel-loop-overwriting-results", "title": "VBA EXCEL: Loop overwriting results", "body": "<p>I'm having trouble with the code below, that does exactly what I want it to, but it keeps overwriting the results.</p>\n\n<p>It searches for the text \"debitor\" and if it's true, it copies.</p>\n\n<p>When it finds multiple results which it often does, it overwrites the results.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Dim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"ark1\")\n\nLastRow = sht.Cells(sht.Rows.Count, \"B\").End(xlUp).Row\n\nDo\nFor x = 13 To 20\n        If autECLSession.autECLPS.GetTextRect(x, 26, x, 32) = \"Debitor\" Then\n            Range(\"B\" &amp; LastRow).Offset(1, 0).Value = Trim(autECLSession.autECLPS.GetTextRect(x, 9, x, 17))\n        End If\n    Next\n    autECLSession.autECLPS.SendKeys \"[pf8]\"\n    autECLSession.autECLOIA.WaitForInputReady\nLoop Until autECLSession.autECLPS.GetTextRect(22, 2, 22, 36) = \"EO0D0018A Der kan ikke bladres frem\"\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1462363502, "post_id": 37023426, "comment_id": 61604444, "body": "Try specifying the range when inserting bookmarks. The way it is now, all the bookmarks are inserted at the current selection (right after the first table) and the text is inserted after the bookmarks. That means the last text that was inserted appears at the top. The next table is inserted right after the first one and merges."}], "answers": [{"comments": [{"owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "edited": false, "score": 0, "creation_date": 1462541345, "post_id": 37034278, "comment_id": 61691878, "body": "thanks for the comments, and the solution i will test this but solved it before the response."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "edited": false, "score": 1, "creation_date": 1462562270, "post_id": 37034278, "comment_id": 61704522, "body": "@SimonPrice Glad you found something that works, but you should avoid using the Selection object whenever possible. It&#39;s better to work with Range objects: more predictable (user clicking on the document while code is executing can&#39;t change the position); code is more readable; you can work with more than one Range, but only one Selection."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 3, "last_activity_date": 1462382702, "creation_date": 1462382702, "answer_id": 37034278, "question_id": 37023426, "link": "https://stackoverflow.com/questions/37023426/add-multiple-bookmarks-and-tables/37034278#37034278", "title": "Add multiple bookmarks and tables", "body": "<p>I believe your problem is that you don't specify <em>where</em> in the document the new bookmark(s) should be added. <code>Bookmarks.Add</code> has a second, optional parameter <code>Range</code> that lets you specify where to create the Bookmark. If you don't provide that information, Word will put it where it wants - you have no control.</p>\n\n<p>Assuming it should follow at the end of <code>r</code> then something like this:</p>\n\n<pre><code>Dim bm As Range\nSet bm = r.Duplicate\nActiveDocument.Bookmarks.Add (\"table_\" &amp; k, bm)\n' Do things...\nDim reason As Range\nSet reason = bm.Duplicate\nActiveDocument.Bookmarks.Add (\"reason_\" &amp; k, reason)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "is_accepted": true, "score": 0, "last_activity_date": 1462541388, "creation_date": 1462541388, "answer_id": 37073687, "question_id": 37023426, "link": "https://stackoverflow.com/questions/37023426/add-multiple-bookmarks-and-tables/37073687#37073687", "title": "Add multiple bookmarks and tables", "body": "<p>figured this out now</p>\n\n<p>i wasnt selecting the range  this is how i resolved it </p>\n\n<pre><code>encashment.Select\nSelection.MoveRight Unit:=wdCharacter, Count:=1\nSelection.TypeParagraph\nActiveDocument.Bookmarks.Add\n....\n</code></pre>\n"}], "owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 37073687, "answer_count": 2, "score": 1, "last_activity_date": 1462541388, "creation_date": 1462353432, "last_edit_date": 1462378391, "question_id": 37023426, "link": "https://stackoverflow.com/questions/37023426/add-multiple-bookmarks-and-tables", "title": "Add multiple bookmarks and tables", "body": "<p>I am trying to add multiple tables and text to a document based on the contents of a multi column listbox. </p>\n\n<p>I am able to add a table and all the other bookmarks, but for some reason when it adds the second table it overwrites the first table and so on. </p>\n\n<p>I would be grateful if someone could tell me where I am going wrong with this and help me put it right. </p>\n\n<pre><code>Private Sub Glossaries()\n\nDim r As Range\nSet r = ActiveDocument.Bookmarks(\"NewRecommendationText\").Range\nr.Text = \"text here\"\nWith r\n.Collapse Direction:=wdCollapseEnd\n.InsertParagraphAfter\n.Collapse Direction:=wdCollapseEnd\nEnd With\n\n'for each item in the listbox\nIf lbGlossaries.ListCount &gt; 0 Then\n\nFor k = 0 To lbGlossaries.ListCount - 1\n\nDim tblGloss As Table\n\nActiveDocument.Bookmarks.Add (\"table_\" &amp; k)\nDim bm As Range\nSet bm = ActiveDocument.Bookmarks(\"table_\" &amp; k).Range\nSet tblGloss = ActiveDocument.Tables.Add(bm, lbGlossaries.ListCount + 1, 5)\n        'Now populate the header row\n        With tblGloss\n            For x = 0 To 4\n                .Cell(1, x + 1).Range.Select\n                If x = 0 Then\n                Set_Table_Headers \"Customer Name\"\n                ElseIf x = 1 Then\n                    Set_Table_Headers \"Product\"\n                ElseIf x = 2 Then\n                    Set_Table_Headers \"Fund\"\n                ElseIf x = 3 Then\n                    Set_Table_Headers \"Risk Profile\"\n                ElseIf x = 4 Then\n                    Set_Table_Headers \"Lump Sum Amount\"\n                End If\n            Next\n        End With\n\n        With tblGloss\n\n\n            .Cell(i + 2, 0).Range.Select\n            Set_Table_Rows\n\n\n            Selection.TypeText Text:=lbGlossaries.Column(0, k)   ' customer\n            Selection.MoveRight Unit:=wdCell\n            Selection.TypeText Text:=lbGlossaries.Column(1, k) ' selected product\n            Selection.MoveRight Unit:=wdCell\n            Selection.TypeText Text:=lbGlossaries.Column(2, k) ' selected fund\n            Selection.MoveRight Unit:=wdCell\n            Selection.TypeText Text:=lbGlossaries.Column(3, k) ' risk profile\n            Selection.MoveRight Unit:=wdCell\n            Selection.TypeText Text:=lbGlossaries.Column(4, k) ' amount\n            Selection.MoveRight Unit:=wdCell\n            'Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend\n            'Selection.Cells.Merge\n            'Selection.MoveLeft Unit:=wdCharacter, Count:=1\n            'Selection.TypeText Text:=lbGlossaries.Column(5, i) ' reason\n\n\n        tblGloss.Select\n        tblGloss.Columns.AutoFit\n        Selection.Collapse Direction:=wdCollapseEnd\n        .AutoFitBehavior (wdAutoFitWindow)\n        End With\n\n        With bm\n        .Collapse Direction:=wdCollapseEnd\n        .InsertParagraphAfter\n        .Collapse Direction:=wdCollapseEnd\n        End With\n\n        ActiveDocument.Bookmarks.Add (\"reason_\" &amp; k)\n        Dim reason As Range\n        Set reason = ActiveDocument.Bookmarks(\"reason_\" &amp; k).Range\n        reason.Text = lbGlossaries.Column(5, k) ' reason\n\n\n\n        ''add the glossary text under here\n        activeBookmark = activeBookmark &amp; \"_glossary\" &amp; k\n        ActiveDocument.Bookmarks.Add (activeBookmark)\n\n        Dim glossary As Range\n        Set glossary = ActiveDocument.Bookmarks(activeBookmark).Range\n        glossary.Text = lbGlossaries.Column(6, i) &amp; Chr(13) &amp; Chr(13)\n\n        ''add the tax glossary text under here\n        activeBookmark = activeBookmark &amp; \"_Tax_glossary\" &amp; k\n        ActiveDocument.Bookmarks.Add (activeBookmark)\n\n        Dim TaxGlossary As Range\n        Set TaxGlossary = ActiveDocument.Bookmarks(activeBookmark).Range\n        TaxGlossary.Text = lbGlossaries.Column(7, i) &amp; Chr(13) &amp; Chr(13)\n\n        ''add the encashment glossary text under here\n        activeBookmark = activeBookmark &amp; \"_Encashment_glossary\" &amp; k\n        ActiveDocument.Bookmarks.Add (activeBookmark)\n        Dim encashment As Range\n        Set encashment = ActiveDocument.Bookmarks(activeBookmark).Range\n        encashment.Text = lbGlossaries.Column(8, i) &amp; Chr(13) &amp; Chr(13)\n\n        ''add the encashment designation text under here\n        activeBookmark = activeBookmark &amp; \"_designation\" &amp; k\n        ActiveDocument.Bookmarks.Add (activeBookmark)\n\n        Dim designation As Range\n        Set designation = ActiveDocument.Bookmarks(activeBookmark).Range\n        If lbCgt.Column(9, k) &lt;&gt; \"\" Then\n            designation.Text = lbGlossaries.Column(10, i)\n        Else\n            ActiveDocument.Bookmarks(activeBookmark).Delete\n        End If\n\n\n\n\nNext\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1462354588, "post_id": 37023343, "comment_id": 61598100, "body": "Can you check whether the table or the sheet is protected?"}, {"owner": {"reputation": 13, "user_id": 6289825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RXbXpbkK5qY/AAAAAAAAAAI/AAAAAAAAACs/rhYA-p4cDGc/photo.jpg?sz=128", "display_name": "Rex Darwin", "link": "https://stackoverflow.com/users/6289825/rex-darwin"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1462425334, "post_id": 37023343, "comment_id": 61634572, "body": "it is not protected. thanks for answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6289825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RXbXpbkK5qY/AAAAAAAAAAI/AAAAAAAAACs/rhYA-p4cDGc/photo.jpg?sz=128", "display_name": "Rex Darwin", "link": "https://stackoverflow.com/users/6289825/rex-darwin"}, "edited": false, "score": 0, "creation_date": 1462425601, "post_id": 37031922, "comment_id": 61634657, "body": "hello thank you so much for this. how can I make it work for the second run without deleting the pivottable3? thank you so much."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1462375264, "creation_date": 1462375264, "answer_id": 37031922, "question_id": 37023343, "link": "https://stackoverflow.com/questions/37023343/there-is-an-error-1004-application-defined-or-object-defined-error/37031922#37031922", "title": "There is an Error 1004: Application defined or object defined error", "body": "<p>You got the apostrophes in your <code>SourceData</code> and the <code>TableDestination</code> incorrect. The apostrophes should be only around the sheet name and not including the rows / columns towards the end. So, you got this:</p>\n\n<pre><code>\"'Sheet1!R4C1:R279594C33'\"\n</code></pre>\n\n<p>while it should be this</p>\n\n<pre><code>\"'Sheet1'!R4C1:R279594C33\"\n</code></pre>\n\n<p>The same applies to the TableDestination which should be <code>\"'Sheet8'!R3C1\"</code>.</p>\n\n<p>Also, note that this code can only work once! This is due to the fact that you name the newly created <code>PivotCache</code> \"PivotTable3\". As there can be only <strong>one</strong> <code>PivotCache</code> by that name the second run of the above code will automatically fail (unless you delete the \"PivotTable3\" before running the above code).</p>\n"}], "owner": {"reputation": 13, "user_id": 6289825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RXbXpbkK5qY/AAAAAAAAAAI/AAAAAAAAACs/rhYA-p4cDGc/photo.jpg?sz=128", "display_name": "Rex Darwin", "link": "https://stackoverflow.com/users/6289825/rex-darwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 37031922, "answer_count": 1, "score": 0, "last_activity_date": 1462375264, "creation_date": 1462353186, "question_id": 37023343, "link": "https://stackoverflow.com/questions/37023343/there-is-an-error-1004-application-defined-or-object-defined-error", "title": "There is an Error 1004: Application defined or object defined error", "body": "<p>Hi guys I am currently recording in a macro. I am turning raw datas in pivot table and automate it using macro. But whenever I press the button there is an error 1004: Application-defined or object-defined error.</p>\n\n<p>Here are the sample of my codes in the VBA.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"'Sheet1!R4C1:R279594C33'\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"'Sheet8!R3C1'\", TableName:=\"'PivotTable3'\", DefaultVersion _\n    :=xlPivotTableVersion14\n</code></pre>\n\n<p>I hope you could assist me guys on this one.</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462355496, "post_id": 37023285, "comment_id": 61598723, "body": "<i>re-arranging the data takes a long time for VBA do to</i> - only if you do it badly. Post that code and we can help optimise it"}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1462362537, "post_id": 37024405, "comment_id": 61603767, "body": "I&#39;ll give this a try. How do I create a collection object? Can you point me in a direction to learn more?  Thanks."}, {"owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "reply_to_user": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1462365737, "post_id": 37024405, "comment_id": 61606117, "body": "I have limited access right now but Just googling for &quot;VBA Collection&quot; should give you some good resources."}, {"owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "reply_to_user": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1462366089, "post_id": 37024405, "comment_id": 61606384, "body": "You can create a collection with Dim cln As New Collection OR in 2 lines as Dim cln As  Collection followed by Set clan = New Collection. In both cases then add items with cln.Add item:=itemtoad, key:= itemkey. When add a collection as the item to add, you will need to create a new collection each Tim you want to add an item."}], "tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1462356426, "last_edit_date": 1462356426, "creation_date": 1462355971, "answer_id": 37024405, "question_id": 37023285, "link": "https://stackoverflow.com/questions/37023285/in-excel-i-want-to-search-for-individual-words-across-a-worksheet-and-pull-an/37024405#37024405", "title": "In Excel, I want to search for individual words across a worksheet, and pull an associated number for each", "body": "<p>If your desired output is something like</p>\n\n<pre><code>Anne 1 2\nBarry 2 \n</code></pre>\n\n<p>etc.\nThen I think you can do this all in one step, i.e. a single cycle through Sheet 1 and then Sheet 2 and without any rearranging of data. The following is a rough outline:</p>\n\n<p>1) Create a Collection object and then read in the list of names from the first sheet. For each name you read in, add a new collection object into your initial collection, using the name as the key.\nSo you'll end up with a collection of collections, with as many entries in the \"master\" collection as you have names.</p>\n\n<p>2) Now cycle through your second sheet. For each name under a particular number, add that <em>number</em> to the collection in your master collection associated with that name (i.e. using the name as the key word to find the right collection within the master collection.</p>\n\n<p>3) Finally cycle through the master collection and for each collection within it, cycle through the list of numbers and dump them in the appropriate cells.</p>\n\n<p>The one problem with this approach is that you will get a list of numbers associated with each collection within the master collection - but you won't know the name associated with that collection! There are two solutions to that:\n- apart from your master collection, keep another collection to which you just add names. Thus the n'th element of the master collection has key \"Fred\" (say) which you can't actually see. But the n'th element of your name collection contains the string \"Fred\".\n- instead of using collections you could use a Dictionary associated with File Scripting. I believe here you can access the key value (though I have very little experience with this.</p>\n\n<p>You will need to be careful to handle duplicate names correctly. (You can't have two \"Fred\"'s as keys to your master collection.</p>\n"}, {"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1462362395, "post_id": 37025720, "comment_id": 61603674, "body": "Excellent. This seems like a good starting point. I&#39;m getting a mismatch error for this line, however:       data = data &amp; .Areas(i)&amp; Join(Application.Transpose(Range(.Areas(i).Offset(1), .Areas(i + 1).Offset(-1))), .Areas(i))  Can you tell me what the purpose of this line is, along with the Areas function? Thanks"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1462368333, "post_id": 37025720, "comment_id": 61608251, "body": "that line builds up a string that concatenates each name with its preceeding number, resulting in something like <i>&quot;1Anne1Ciaran2Anne2Barry2David2Freya3David3Eric3Freya&quot;</i> . <code>Areas</code> property of <code>Range</code> object returns a collection of all non adjacent multiple-area range (see <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff196243.aspx\" rel=\"nofollow noreferrer\">here</a>). The given code works for data like those you posted. And which I replicated down to more than 4k rows in &quot;Library&quot; while maintaining 6 entries in &quot;List&quot;. You may want to upload xlsx files (not xlsm!) with data sample that are giving you errors."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1462361574, "last_edit_date": 1462361574, "creation_date": 1462359297, "answer_id": 37025720, "question_id": 37023285, "link": "https://stackoverflow.com/questions/37023285/in-excel-i-want-to-search-for-individual-words-across-a-worksheet-and-pull-an/37025720#37025720", "title": "In Excel, I want to search for individual words across a worksheet, and pull an associated number for each", "body": "<p><strong>edited</strong>: to account for numbers greater then 9...</p>\n\n<p><strong>edited2</strong>: used array to speed things up</p>\n\n<p>I'd go like follows</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim cell As Range, lastCell As Range\nDim i As Long, iArr As Long, dataArr() As Long, nameCount As Long\nDim data As String\n\nWith Worksheets(\"Library\")\n    Set lastCell = .Cells(.Rows.Count, 1).End(xlUp)\n    With .Columns(\"A\").SpecialCells(xlCellTypeConstants, xlNumbers)\n        For i = 1 To .Areas.Count - 1\n            data = data &amp; .Areas(i) &amp; Join(Application.Transpose(Range(.Areas(i).Offset(1), .Areas(i + 1).Offset(-1))), .Areas(i))\n        Next i\n        data = data &amp; .Areas(i) &amp; Join(Application.Transpose(Range(.Areas(i).Offset(1), lastCell)), .Areas(i))\n    End With\nEnd With\n\nWith Worksheets(\"List\").Columns(\"A\").SpecialCells(xlCellTypeConstants, xlTextValues)\n    For Each cell In .Cells\n        nameCount = (Len(data) - Len(Replace(data, cell.Value, \"\"))) / Len(cell.Value)\n        ReDim dataArr(1 To nameCount) As Long\n\n        i = InStr(data, cell)\n        iArr = 0\n        Do While i &gt; 0\n            iArr = iArr + 1\n            dataArr(iArr) = GetNumber(Left(data, i - 1))\n            i = InStr(i + 1, data, cell)\n        Loop\n        cell.Offset(, 1).Resize(, iArr).Value = dataArr\n\n    Next cell\nEnd With\nEnd Sub\n\nFunction GetNumber(text) As Long\nDim i As Long\nDo While IsNumeric(Mid(text, Len(text) - i, 1))\n    i = i + 1\n    If i = Len(text) Then Exit Do\nLoop\nGetNumber = Right(text, i)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462361574, "creation_date": 1462353080, "last_edit_date": 1462358184, "question_id": 37023285, "link": "https://stackoverflow.com/questions/37023285/in-excel-i-want-to-search-for-individual-words-across-a-worksheet-and-pull-an", "title": "In Excel, I want to search for individual words across a worksheet, and pull an associated number for each", "body": "<p>So lets say I have two worksheets. One, the 'List' looks like this:</p>\n\n<pre><code>Anne\nBarry\nCiaran\nDavid\nEric\nFreya\n</code></pre>\n\n<p>But a few thousand names long. Another worksheet, called Library, has this:</p>\n\n<pre><code>1\nAnne\nCiaran\n2\nAnne\nBarry\nDavid\nFreya\n3\nDavid\nEric\nFreya\n</code></pre>\n\n<p>All the way down to 2000 or so.</p>\n\n<p>Now, I wish to add extra data to the first List, adding the associated numbers with each name adjacent to them. So the output would be:</p>\n\n<pre><code>Anne    1    2 \nBarry   2\nCiaran  1\nDavid   2    3\nEric    3\nFreya   2    3\n</code></pre>\n\n<p>Now, I'm hoping to have a VBA script that will produce the output from the data above. My first approach worked by cutting each segment from 'Library' as far as each number, and arranging them like so:</p>\n\n<pre><code> 1       2       3\n Anne    Anne    David\n Ciaran  Barry   Eric\n         David   Freya\n         Freya\n</code></pre>\n\n<p>Then ran through a simple script saying \"If something in List matches any word in Library, then copy whatever is in Row 1 there.\"</p>\n\n<p>However, re-arranging the data takes a long time for VBA do to. Is it possible to skip this step, and have a script work through the first list, saying \"If any of these names matches something in the 'Library,' then copy the first number that appears in cells above it.\" </p>\n\n<p>Is this the right approach? All feedback or suggestions welcome.</p>\n\n<p>EDIT: This is the original script. I'll return and look at the other answers in greater detail shortly.</p>\n\n<pre><code>     Private Sub PrepareLibrary()\n     Application.ScreenUpdating = False\n\n  Dim Rng As Range\n  Dim i As Long\n  Dim n As Range \n  Dim x As Long\n  Dim Library As Worksheet\n  Dim List As Worksheet 'Defines Library and List as Worksheets, for referencing later\n  Dim LastRow As Long\n  Set Library = Sheets(\"Library\")\n  Set List = Sheets(\"List\")\n  i = 1\n  x = 0\n  LastRow = Library.Range(\"A1\").SpecialCells(xlCellTypeLastCell).row\n\n  Do While i &lt;= LastRow\n  Set Rng = Library.Range(\"A\" &amp; i)\n  Set n = Library.Range(\"A1\")\n\n  If IsNumeric(Rng) = True Then  'If Rng is Numeric, then....\n  x = x + 1 'Increases X, just like i as described earlier. However, in this script, X serves a different purpose\n  Rng.Copy\n  n.Offset(0, x).Insert Shift:=xlDown 'The amount of columns offset from the range    'n' defined here determined by the integer X\n  i = i + 1\n  ElseIf IsNumeric(Rng) = False Then\n  Rng.Copy\n  n.Offset(1, x).Insert Shift:=xlDown\n  i = i + 1\n  ElseIf Application.WorksheetFunction.CountA(Rng) = 0 Then\n  i = i + 1\n\n   End If\n   Loop 'This script essentially re-arragnes the single column of keywords into multiple columns, one for each record\n</code></pre>\n"}, {"tags": ["vba", "function", "excel"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1462355820, "post_id": 37023003, "comment_id": 61598923, "body": "Great. Thanks, @HedgePig. Don&#39;t worry, all cells are numbers, i.e 123-... How would I add to the macro one step before that to also find all , (comma) and replace them with nothing (delete)?"}, {"owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "reply_to_user": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1462356224, "post_id": 37023003, "comment_id": 61599198, "body": "Glad it helped. To remove any commas, use the Replace command, e.g.      c = Replace(c, &quot;,&quot;, &quot;&quot;) before the If condition. Note that this will replace a comma in text field but NOT &quot;replace&quot; the comma in numbers formatted with commas - as this is a formatting issue"}], "tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": true, "score": 1, "last_activity_date": 1462352354, "creation_date": 1462352354, "answer_id": 37023003, "question_id": 37022662, "link": "https://stackoverflow.com/questions/37022662/perform-if-function-in-vba/37023003#37023003", "title": "Perform IF function in VBA", "body": "<p>1) Use the the For Each.... loop construct to loop through each cell in a range.\n2) If you are wanting to convert \"numbers\" of the 123- to -123 to a proper number and not text, use the Val command to convert a string to a number.\nNote however that if you if you have cell with something like \"ABC-\", this will become -ABC which VBA then attempts to convert to a number ...and produces zero as a result</p>\n\n<pre><code>Sub MoveMinus()\nDim c As Range\n   For Each c In Intersect(Selection, Selection.Worksheet.UsedRange)\n      If (Right(c, 1) = \"-\") Then\n         c = Val(\"-\" &amp; Left(c, Len(c) - 1))  'Val to make the result numeric\n      End If\n   Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 37023003, "answer_count": 1, "score": 0, "last_activity_date": 1462377548, "creation_date": 1462351486, "last_edit_date": 1462377548, "question_id": 37022662, "link": "https://stackoverflow.com/questions/37022662/perform-if-function-in-vba", "title": "Perform IF function in VBA", "body": "<p>I use an =IF function</p>\n\n<pre><code>=IF(RIGHT(A1;1)=\"-\";\"-\"&amp;LEFT(A1;LEN(A1)-1);A1)*1\n</code></pre>\n\n<p>to shift a minus sign from the end of the cell to the beginning but I'd like to use it in a macro so it is performed on the same <strong>column</strong> (or the same <strong>selection</strong>)...</p>\n"}, {"tags": ["vba", "excel", "recursion", "ip"], "comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1462524372, "post_id": 37022429, "comment_id": 61681432, "body": "making a function named <code>Range</code> is at best dubious and will lead to mistakes"}, {"owner": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1462790856, "post_id": 37022429, "comment_id": 61768847, "body": "I should use an while loop to fix it? How?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "edited": false, "score": 0, "creation_date": 1462778226, "post_id": 37023349, "comment_id": 61761386, "body": "Thank you for solving the first failure, but with a higher ip range I get also the error."}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "edited": false, "score": 0, "creation_date": 1462780639, "post_id": 37023349, "comment_id": 61762669, "body": "this solved your stack overflow problem. caused by failure with in your recurse method. If you have a problem in your algorithm.?IPGen(1,256) [1-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-6]) ?IPGen(22,256) 2[2-9]|[3-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-6]) ?IPGen(22,26) 2[2-6]. Can you give a specific method call that is failing."}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "edited": false, "score": 0, "creation_date": 1463905269, "post_id": 37023349, "comment_id": 62255905, "body": "So did that answer your question? Was there anything else?"}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "edited": false, "score": 0, "creation_date": 1464086278, "post_id": 37023349, "comment_id": 62328751, "body": "Hi, new here, so just wondering why did you unaccept this answer?"}], "tags": [], "owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1462353202, "creation_date": 1462353202, "answer_id": 37023349, "question_id": 37022429, "link": "https://stackoverflow.com/questions/37022429/vba-out-of-stack-space-error-28-recursive-procedures/37023349#37023349", "title": "vba Out of stack space (Error 28) - recursive procedures", "body": "<p>for a = \"abc\", Mid(a,1) returns \"abc\"\nI suspect you are wanting Mid(a,1,1) which would return \"a\"</p>\n\n<p>for example</p>\n\n<pre><code>ElseIf Mid(a, 1, 1) = Mid(b, 1, 1) And Len(a) = Len(b) And Len(a) = 3 Then                                  'wenn erste Zahl gleich und L\u00e4nge beider =3\n        Debug.Print a, b, \"|a| = |b| = 3; a(1)=b(1) \"\n        aa = Mid(a, 2, Len(a))\n        bb = Mid(b, 2, Len(b))\n        IPGen = Mid(a, 1, 1) &amp; \"(\" &amp; IPGen(aa, bb) &amp; \")\"                           'return: erste Zahl, \"(\", IPGen(rest, rest), \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1462359413, "last_edit_date": 1462359413, "creation_date": 1462358359, "answer_id": 37025362, "question_id": 37022429, "link": "https://stackoverflow.com/questions/37022429/vba-out-of-stack-space-error-28-recursive-procedures/37025362#37025362", "title": "vba Out of stack space (Error 28) - recursive procedures", "body": "<p>You could also re-write this so that it doesn't use recursion. The end result is perhaps not as elegant but no doubt faster and will produce a working regular expression:</p>\n\n<hr>\n\n<p><strong><em>Example Use:</em></strong> <code>MsgBox GenIP(122, 223)</code><br>\n<strong><em>Produces:</em></strong> &nbsp; &nbsp; &nbsp; <code>[12][0-9][0-9]</code></p>\n\n<hr>\n\n<pre><code>Function GenIP(a As Byte, b As Byte) As String\n\n    Dim strA As String * 3\n    Dim strB As String * 3\n    Dim retV(1 To 3) As String\n\n    strA = Format$(a, \"000\")\n    strB = Format$(b, \"000\")\n\n    If a = b Then\n        GenIP = strA\n    Else\n        With WorksheetFunction\n            retV(1) = Left$(IIf(.Min(a, b) = a, strA, strB), 1)\n            retV(2) = Mid$(IIf(.Min(a, b) = a, strA, strB), 2, 1)\n            retV(3) = Right$(IIf(.Min(a, b) = a, strA, strB), 1)\n\n            For i = .Min(a, b) To .Max(a, b)\n                If Right(retV(1), 1) &lt;&gt; Left$(Format$(i, \"000\"), 1) And Len(retV(1)) &lt; 3 Then\n                    retV(1) = retV(1) &amp; Left$(Format$(i, \"000\"), 1)\n                End If\n                If Right(retV(2), 1) &lt;&gt; Mid$(Format$(i, \"000\"), 2, 1) And Len(retV(2)) &lt; 10 Then\n                    retV(2) = retV(2) &amp; Mid$(Format$(i, \"000\"), 2, 1)\n                End If\n                If Right(retV(3), 1) &lt;&gt; Right$(Format$(i, \"000\"), 1) And Len(retV(3)) &lt; 10 Then\n                    retV(3) = retV(3) &amp; Right$(Format$(i, \"000\"), 1)\n                End If\n            Next\n        End With\n\n        If Len(retV(1)) = 3 Then\n            retV(1) = \"0-2\"\n        End If\n        If Len(retV(2)) = 10 Then\n            retV(2) = \"0-9\"\n        End If\n        If Len(retV(3)) = 10 Then\n            retV(3) = \"0-9\"\n        End If\n\n        GenIP = \"[\" &amp; retV(1) &amp; \"][\" &amp; retV(2) &amp; \"][\" &amp; retV(3) &amp; \"]\"\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4742258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4e23b83eab2c1feade3572e02f00bc34?s=128&d=identicon&r=PG&f=1", "display_name": "user4742258", "link": "https://stackoverflow.com/users/4742258/user4742258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462781614, "creation_date": 1462350766, "last_edit_date": 1531164843, "question_id": 37022429, "link": "https://stackoverflow.com/questions/37022429/vba-out-of-stack-space-error-28-recursive-procedures", "title": "vba Out of stack space (Error 28) - recursive procedures", "body": "<p>I am newbie in the theme VBA.</p>\n\n<p>I want to made an IP range to a regular expression.\nThis bit of Code should made the start (a) and end (b) of an number range to a regular expression, for instance a=111, b=114, result=(1(1[1-4])).</p>\n\n<pre><code>Function IPAll(a As String, b As String) As String\n    Dim Dot1%, Dot2%, Dot3%\n    Dim LowIP(3) As Variant\n    Dot1 = InStr(1, a, \".\")\n    Dot2 = InStr(Dot1 + 1, a, \".\")\n    Dot3 = InStr(Dot2 + 1, a, \".\")\n\n    If Dot1 &lt;&gt; 0 Then\n        LowIP(0) = Mid(a, 1, Dot1 - 1)\n        If Dot2 &lt;&gt; 0 Then\n            LowIP(1) = Mid(a, Dot1 + 1, Dot2 - Dot1 - 1)\n            If Dot3 &lt;&gt; 0 Then\n                LowIP(2) = Mid(a, Dot2 + 1, Dot3 - Dot2 - 1)\n                LowIP(3) = Mid(a, Dot3 + 1, Dot3 - 1)\n            Else\n                LowIP(2) = Mid(a, Dot2 + 1, Dot2 - 1)\n            End If\n        Else\n            LowIP(1) = Mid(a, Dot1 + 1, Dot1 - 1)\n            If LowIP(1) = \"\" Then                   'Fehler bei \"\" *1 abfangen\n                LowIP(1) = 0\n            End If\n        End If\n    Else\n        LowIP(0) = a\n        LowIP(1) = 0\n    End If\n\n\n    Dim HighIP(3) As Variant\n    Dot1 = InStr(1, b, \".\")\n    Dot2 = InStr(Dot1 + 1, b, \".\")\n    Dot3 = InStr(Dot2 + 1, b, \".\")\n\n    If Dot1 &lt;&gt; 0 Then\n        HighIP(0) = Mid(b, 1, Dot1 - 1)\n        If Dot2 &lt;&gt; 0 Then\n            HighIP(1) = Mid(b, Dot1 + 1, Dot2 - Dot1 - 1)\n            If Dot3 &lt;&gt; 0 Then\n                HighIP(2) = Mid(b, Dot2 + 1, Dot3 - Dot2 - 1)\n                HighIP(3) = Mid(b, Dot3 + 1, Dot3 - 1)\n            Else\n                HighIP(2) = Mid(b, Dot2 + 1, Dot2 - 1)\n            End If\n        Else\n            HighIP(1) = Mid(b, Dot1 + 1, Dot1 - 1)\n             If HighIP(1) = \"\" Then\n                HighIP(1) = 0\n            End If\n        End If\n    Else\n        HighIP(0) = b\n        HighIP(1) = 0\n    End If\n\n    Dim splita As Variant: splita = LowIP\n    Dim splitb As Variant: splitb = HighIP\n\n    Dim zeros$: zeros = \"\"\n    Dim twofivefives$: twofivefives = \"\"\n    Dim j%\n    Dim len_splita%: len_splita = (UBound(Split(a, \".\")) + 1)\n    For j = 0 To len_splita                  'je nach l\u00e4nge von a wird zeros zu z.B. 0.0.0.0. und twofivefives zu z.B 255.255.255.255.\n        zeros = zeros &amp; \"0.\"\n        twofivefives = twofivefives &amp; \"255.\"\n    Next j\n    zeros = Mid(zeros, 1, Len(zeros) - 1)       'wegnehmen des letzten Punktes\n    twofivefives = Mid(twofivefives, 1, Len(twofivefives) - 1)\n\n\n\n    If splita(0) = splitb(0) And len_splita = 1 Then                                                                                    'wenn erste Zahl gleich und L\u00e4nge beider =1\n        IPAll = splita(0)                                                                                                                   'return: erste Zahl\n    ElseIf splita(0) = splitb(0) Then                                                                                                   'wenn erste Zahl gleich\n        IPAll = splita(0) &amp; \"\\.\" &amp; IPAll(Mid(a, InStr(a, \".\") + 1, Len(a)), Mid(b, InStr(b, \".\") + 1, Len(b)))                              'return: erste Zahl, \"\\.\" IPAll( rest von a, rest von b)\n    ElseIf len_splita = 1 Then                                                                                                          'wenn a nur eine Zahl\n        IPAll = \"(\" &amp; IPGen(a, b) &amp; \")\"                                                                                                     'return: \"(\", IPGen(a, b), \")\"\n    ElseIf splita(1) = 0 And splitb(1) = 255 Then                                                                                       'wenn zweite Zahl a =0 und zweite zahl b =255\n        IPAll = \"(\" &amp; IPGen(splita(0), splitb(0)) &amp; \")\\.\" &amp; IPAll(Mid(a, InStr(a, \".\") + 1, Len(a)), Mid(b, InStr(b, \".\") + 1, Len(b)))     'return: \"(\", IPGen(erste Zahl a, erste Zahl b), \")\\.\", IPAll(alles nach ersten . aus a, alles nach ersten . aus b)\n    ElseIf splita(1) &lt;&gt; 0 And splitb(1) &lt;&gt; 255 And (splita(1) * 1 + 1) = (splitb(1) * 1) Then                                           'wenn zweite zahl a !=0 und zweite zahl b != 255 und (zweite zahl a) +1 gleich zweite zahl b\n        IPAll = \"(\" &amp; splita(0) &amp; \"\\.\" &amp; IPAll(Mid(a, InStr(a, \".\") + 1, Len(a)), twofivefives)                                             'return: \"(\", erste zahl a, \"\\.\", IPAll(alles nach ersten . aus a, twofivefives)\n        IPAll = IPAll &amp; \"|\" &amp; splitb(0) &amp; \"\\.\" &amp; IPAll(CStr(zeroes), Mid(b, InStr(b, \".\") + 1, Len(b))) &amp; \")\"                               'return: \"|\", erste zahl a, \"\\.\", IPAll(zeroes, alles nach ersten . aus b), \")\"\n    ElseIf splita(1) &lt;&gt; 0 And splitb(1) &lt;&gt; 255 Then                                                                                     'wenn zweite zahl a !=0 und zweite zahl b !=255\n        IPAll = \"(\" &amp; splita(0) &amp; \"\\.\" &amp; IPAll(Mid(a, InStr(a, \".\") + 1, Len(a)), twofivefives)                                             'return: \"(\", erste zahl a, \"\\.\", IPAll(alles nach ersten . aus a, twofivefives)\n        IPAll = IPAll &amp; \"|(\" &amp; IPAll((splita(0) * 1 + 1) &amp; \".\" &amp; zeroes, (splitb(0) * 1 - 1) &amp; \".\" &amp; twofivefives) &amp; \")\"                    'return: \"|(\", IPAll(erste Zahl a +1 und \".\" und zeroes, erste zahl b -1 und \".\" und twofivefives), \")\"\n        IPAll = IPAll &amp; \"|\" &amp; splitb(0) &amp; \"\\.\" &amp; IPAll(CStr(zeroes), Mid(b, InStr(b, \".\") + 1, Len(b))) &amp; \")\"                               'return: \"|\", erste Zahl b, \"\\.\", IPAll(zeroes, alles nach ersten . aus b), \")\"\n    ElseIf splita(1) &lt;&gt; 0 Then                                                                                                          'wenn zweite zahl a !=0\n        IPAll = \"(\" &amp; splita(0) &amp; \"\\.\" &amp; IPAll(Mid(a, InStr(a, \".\") + 1, Len(a)), twofivefives)                                             'return: \"(\", erste zahl, \"\\.\", IPAll(alles nach ersten . aus a, twofivefives)\n        IPAll = IPAll &amp; \"|\" &amp; IPAll((splita(0) * 1 + 1) &amp; \".\" &amp; zeroes, (splitb(0) * 1) &amp; \".\" &amp; twofivefives) &amp; \")\"                         'return: \"|\", IPAll(erste zahl a +1 und \".\" und zeroes, erste zahl b und \".\" und twofivefives), \")\"         &lt;-warum nicht b -1 ?\n    ElseIf splitb(1) &lt;&gt; 255 Then                                                                                                        'wenn zweite zahl b !=255\n        IPAll = \"(\" &amp; IPAll(splita(0) &amp; \".\" &amp; zeros, (splitb(0) * 1 - 1) &amp; \".\" &amp; twofivefives)                                              'return: \"(\", IPAll(erste zahl a und \".\" und zeroes, erste zahl b -1 und \".\" und twofivefives)\n        IPAll = IPAll &amp; \"|\" &amp; splitb(0) &amp; \"\\.\" &amp; IPAll(CStr(zeroes), Mid(b, InStr(b, \".\") + 1, Len(b))) &amp; \")\"                               'return: \"|\", erste zahl b, \"\\.\", IPAll(zeroes, alles nach ersten . aus b), \")\"\n    End If\n\nEnd Function\n\nFunction IPGen(a As Variant, b As Variant) As Variant\n         If a = \"\" Then      'Fehler bei \"\" * 1 abfangen\n        a = 0\n    End If\n    If a * 1 &gt; b * 1 Then\n        Dim temp%: temp = a\n        a = b\n        b = temp\n    End If\n    If a = b Then\n        IPGen = a\n    ElseIf Mid(a, 1, 1) = Mid(b, 1, 1) And Len(a) = Len(b) And Len(a) = 3 Then                                  'wenn erste Zahl gleich und L\u00e4nge beider =3\n        IPGen = Mid(a, 1, 1) &amp; \"(\" &amp; IPGen(Mid(a, 2, Len(a)), Mid(b, 2, Len(b))) &amp; \")\"                              'return: erste Zahl a, \"(\", IPGen(rest, rest), \")\"\n    ElseIf Len(a) = Len(b) And Len(a) = 3 Then                                                                  'wenn L\u00e4nge beider gleich 3\n        IPGen = Mid(a, 1, 1) &amp; \"(\" &amp; IPGen(Mid(a, 2, Len(a)), 99) &amp; \")|\" &amp; IPGen((Mid(a, 1, 1) * 1 + 1) &amp; \"00\", b)  'return: erste Zahl a, \"(\", IPGen(rest, 99), \")|\", IPGen( erste Zahl +1 und \"00\", b)\n    ElseIf Len(b) = 3 Then                                                                                      'wenn L\u00e4nge a =3\n        IPGen = IPGen(a, 99) &amp; \"|\" &amp; IPGen(100, b)                                                                  'return: IPGen(a, 99), \"|\", IPGen(100, b)\n    ElseIf Mid(a, 1, 1) = Mid(b, 1, 1) And Len(a) = Len(b) And Len(a) = 2 Then                                  'wenn erste Zahl gleich und L\u00e4nger beider gleich 2\n        IPGen = Mid(a, 1, 1) &amp; ip_range(Mid(a, 2, 1), Mid(b, 2, 1))                                                 'return: erste Zahl a, ip_range(zweite Zahl a, zweite Zahl b)\n    ElseIf Len(a) = Len(b) And Mid(a, 2, 1) = 0 And Mid(b, 2, 1) = 9 And Len(a) = 2 Then                        'wenn zweite Zahl a =0, zweite Zahl b =9 und L\u00e4nge beider =2\n        IPGen = ip_range(Mid(a, 1, 1), Mid(b, 1, 1)) &amp; ip_range(Mid(a, 2, 1), Mid(b, 2, 1))                         'return: ip_range(erste Zahl a, erste Zahl b + ip_range(zweite Zahl a, zweite Zahl b))\n    ElseIf Len(a) = Len(b) And Mid(a, 2, 1) &lt;&gt; 0 And Len(a) = 2 Then                                            'wenn zweite Zahl ungleich 0 und L\u00e4nge beider =2\n        IPGen = IPGen(a, Mid(a, 1, 1) &amp; \"9\") &amp; \"|\" &amp; IPGen(Mid(a, 1, 1) * 1 + 1 &amp; \"0\", b)                           'return: IPGen(a, erste Zahl a und \"9\"), \"|\", IPGen(erste Zahl + 1 und \"0\", b)\n    ElseIf Len(a) = Len(b) And Mid(b, 2, 1) &lt;&gt; 9 And Len(b) = 2 Then                                            'wenn zweite Zahl b ungleich 9 und L\u00e4nge beider =2\n        IPGen = IPGen(a, (Mid(b, 1, 1) * 1 - 1) &amp; \"9\") &amp; \"|\" &amp; IPGen(Mid(b, 1, 1) &amp; \"0\", b)                         'return: IPGen(a, erste Zahl b -1 und \"9\"), \"|\", IPGen(erste Zahl b und \"0\", b)\n    ElseIf Len(a) = 1 And Len(b) = 1 Then                                                                       'wenn L\u00e4nge beider =1\n        IPGen = ip_range(a, b)                                                                                      'return: ip_range(a, b)\n    ElseIf Len(a) = 1 Then                                                                                      'wenn L\u00e4nge a =1\n        IPGen = ip_range(a, 9) &amp; \"|\" &amp; IPGen(10, b)                                                                 'return: ip_range(a, 9), \"|\", IPGen(10, b)\n    End If\n\nEnd Function\n\nFunction ip_range(a As Variant, b As Variant) As Variant\n    ip_range = \"[\" &amp; a &amp; \"-\" &amp; b &amp; \"]\"\nEnd Function\n</code></pre>\n\n<p>But MS Ecel don't like recursive procedures and if I use the function <code>MsgBox IPAll(\"10.6.24.1\", \"10.6.25.254\")</code>it says: \"Out of stack space (Error 28)\". What can I do? How can I solve it?</p>\n\n<p>Edited: it works with subnet mask 26, but I get the error if use a 22 subnet for an ip range.\nCould I edit the space of the stack space?</p>\n\n<p>King regards.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 1, "creation_date": 1462354362, "post_id": 37022585, "comment_id": 61597941, "body": "shouldnt you add a &#39;.row&#39; in the for..each loop?"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "reply_to_user": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1462354908, "post_id": 37022585, "comment_id": 61598330, "body": "No, because we&#39;re working with ranges here rather than ListRows."}], "tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 0, "last_activity_date": 1462351264, "creation_date": 1462351264, "answer_id": 37022585, "question_id": 37022410, "link": "https://stackoverflow.com/questions/37022410/vba-concatenate-columns-on-the-first-column/37022585#37022585", "title": "VBA - Concatenate columns on the first column", "body": "<pre><code>Dim r As Range\nFor Each r In Sheet1.UsedRange\n   r(1, 1).Value = r(1, 1).Value &amp; \" \" &amp; r(1, 2).Value &amp; \" \" &amp; r(1, 3).Value\n   r(1, 2).Value = \"\"\n   r(1, 3).Value = \"\"\nNext r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1462351331, "creation_date": 1462351331, "answer_id": 37022607, "question_id": 37022410, "link": "https://stackoverflow.com/questions/37022410/vba-concatenate-columns-on-the-first-column/37022607#37022607", "title": "VBA - Concatenate columns on the first column", "body": "<pre><code>Dim tempval As String\n\nDim row As Integer, col As Integer\n\nApplication.ScreenUpdating = False\n\n'loop through rows\nFor row = 1 To 3 Step 1\n\n    'clear temp string\n    tempval = \"\"\n\n    'loop through columns\n    For col = 1 To 3 Step 1\n\n        'save columnvalues in temp\n        tempval = tempval &amp; Cells(row, col).Value\n\n        'delete cell value\n        Cells(row, col).Value = \"\"\n    Next col\n\n    'paste saved string into first cell\n    Cells(row, 1).Value = tempval\nNext row\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "edited": false, "score": 0, "creation_date": 1462361738, "post_id": 37023973, "comment_id": 61603238, "body": "Thanks, but I already solved the solution before you wrote this. Sorry !"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "edited": false, "score": 0, "creation_date": 1462367255, "post_id": 37023973, "comment_id": 61607384, "body": "You&#39;re welcome. You mat want to post your solution so as to have other user benefit from it. Cheers"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1462354836, "creation_date": 1462354836, "answer_id": 37023973, "question_id": 37022410, "link": "https://stackoverflow.com/questions/37022410/vba-concatenate-columns-on-the-first-column/37023973#37023973", "title": "VBA - Concatenate columns on the first column", "body": "<p>the following does what you ask and is a little more generic in that:</p>\n\n<ul>\n<li><p>it takes into account all cells of column \"A\" with some text in it</p></li>\n<li><p>it extends the range whose content is to be concatenated to all consecutive non blank cells in the given row</p></li>\n</ul>\n\n<p>in other words this approach doesn't suffer neither from any possible variations of columns number to consider (they can be 3, as per your example, or more or less) nor from the condition of having all rows having the same number of cells filled</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim cell As Range\n\nWith Worksheets(\"mySheet\").Columns(\"A\").SpecialCells(xlCellTypeConstants, xlTextValues)\n    For Each cell In .Cells\n        cell.Value = Join(Application.Transpose(Application.Transpose(Range(cell, cell.End(xlToRight)))))\n        Range(cell.Offset(, 1), cell.End(xlToRight)).Clear\n    Next cell\n    .WrapText = False\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 37022607, "answer_count": 3, "score": 0, "last_activity_date": 1462354836, "creation_date": 1462350699, "last_edit_date": 1462353111, "question_id": 37022410, "link": "https://stackoverflow.com/questions/37022410/vba-concatenate-columns-on-the-first-column", "title": "VBA - Concatenate columns on the first column", "body": "<p>I want to concatenate columns but in the first column in VBA, like that :</p>\n\n<pre><code>A         | B         | C         |\nsentence1 | sentence2 | sentence3 |\nsentence4 | sentence5 | sentence6 |\nsentence7 | sentence8 | sentence9 |\n</code></pre>\n\n<p>-></p>\n\n<pre><code>A                             | B       | C      \nsentence1 sentence2 sentence3 | nothing | nothing\nsentence4 sentence5 sentence6 | nothing | nothing\nsentence7 sentence8 sentence9 | nothing | nothing\n</code></pre>\n\n<p>How can I do ?\nThanks in advance !</p>\n"}, {"tags": ["mysql", "sql", "excel", "vba"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1462351905, "post_id": 37022286, "comment_id": 61596207, "body": "Are you really using MySQL here?"}], "answers": [{"tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 0, "last_activity_date": 1462352944, "creation_date": 1462352944, "answer_id": 37023220, "question_id": 37022286, "link": "https://stackoverflow.com/questions/37022286/how-to-extract-particular-cell-to-my-sql-in-excel/37023220#37023220", "title": "how to extract particular cell to my SQL in EXCEL", "body": "<p>I assume you copied your accounts into a range like <code>Range(\"E1:E10\")</code>.\nThen you can use a for loop to change accounts for every turn.\nChange your Query as,</p>\n\n<pre><code>SQL_Query = \"Select * From Customer_Table Where Account =\"\n</code></pre>\n\n<p>then try a <code>For Loop</code>.</p>\n\n<pre><code>Dim Query as String\nFor i = 1 to 10\n    Query = SQL_Query &amp; Cells(i,4).value\n    'Do your query here.\n    'Be careful about that your results should be copied under the last row.\n    'Otherwise only the last one will be shown.\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6289584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gk-fjmvr5-g/AAAAAAAAAAI/AAAAAAAAAF8/Q4F1vA5JzCU/photo.jpg?sz=128", "display_name": "Kila", "link": "https://stackoverflow.com/users/6289584/kila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462352944, "creation_date": 1462350334, "last_edit_date": 1531161705, "question_id": 37022286, "link": "https://stackoverflow.com/questions/37022286/how-to-extract-particular-cell-to-my-sql-in-excel", "title": "how to extract particular cell to my SQL in EXCEL", "body": "<p>Here is a example table in Excel:</p>\n\n<pre><code>ID Name  Account\n1  Jon   001\n2  Snow  002\n3  Alive 003\n</code></pre>\n\n<p>I want to create a SQL according to account. It looks like,</p>\n\n<pre><code>SELECT * FROM CUSTOMER_TABLE WHERE ACCOUNT=' ';\n</code></pre>\n\n<p>Is it possible to make system could fulfill <code>ACCOUNT=' '</code>? Like system could input each value automatically.</p>\n\n<p>It should like <code>WHERE ACCOUNT='C1', ACCOUNT='C2', ACCOUNT='C3'...</code></p>\n"}, {"tags": ["vba", "operator-keyword"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 2, "creation_date": 1462349839, "post_id": 37022057, "comment_id": 61594875, "body": "Are you sure you&#39;re comparing numbers with numbers and not numbers with strings or something like that? Try converting everything to numbers before comparing."}, {"owner": {"reputation": 33, "user_id": 6289544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730004747027861/picture?type=large", "display_name": "Mark Lakshman", "link": "https://stackoverflow.com/users/6289544/mark-lakshman"}, "reply_to_user": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1462350478, "post_id": 37022057, "comment_id": 61595320, "body": "I am pretty sure both are numbers. LastRow is defined as an Integer."}, {"owner": {"reputation": 33, "user_id": 6289544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730004747027861/picture?type=large", "display_name": "Mark Lakshman", "link": "https://stackoverflow.com/users/6289544/mark-lakshman"}, "reply_to_user": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 1, "creation_date": 1462350564, "post_id": 37022057, "comment_id": 61595380, "body": "thanks for the really quick help by the way."}], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "is_accepted": true, "score": 2, "last_activity_date": 1462350083, "creation_date": 1462350083, "answer_id": 37022201, "question_id": 37022057, "link": "https://stackoverflow.com/questions/37022057/vba-evaluates-and-operators-incorrectly/37022201#37022201", "title": "VBA evaluates &gt; and &lt; operators incorrectly", "body": "<p>One tip - use the <code>Val()</code> function on any expression to ensure that you are comparing numbers with numbers.  Val() returns 0 if the expression cannot be converted - which can also be useful sometimes.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6289544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730004747027861/picture?type=large", "display_name": "Mark Lakshman", "link": "https://stackoverflow.com/users/6289544/mark-lakshman"}, "is_accepted": false, "score": -1, "last_activity_date": 1462351041, "creation_date": 1462351041, "answer_id": 37022511, "question_id": 37022057, "link": "https://stackoverflow.com/questions/37022057/vba-evaluates-and-operators-incorrectly/37022511#37022511", "title": "VBA evaluates &gt; and &lt; operators incorrectly", "body": "<p>Ok so I used the val() function and it works. Thanks for the tip!</p>\n\n<p>val(Cells(LastRow, 1).Value )</p>\n\n<p>Dont really understand why i Need this though</p>\n"}], "owner": {"reputation": 33, "user_id": 6289544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730004747027861/picture?type=large", "display_name": "Mark Lakshman", "link": "https://stackoverflow.com/users/6289544/mark-lakshman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 37022201, "answer_count": 2, "score": 2, "last_activity_date": 1462351041, "creation_date": 1462349605, "last_edit_date": 1462350699, "question_id": 37022057, "link": "https://stackoverflow.com/questions/37022057/vba-evaluates-and-operators-incorrectly", "title": "VBA evaluates &gt; and &lt; operators incorrectly", "body": "<p>I have the following simple code, which vba evaluates incorrectly (imho) and i can not figure it out even after searching the web extensively:</p>\n\n<pre><code>ElseIf TextBoxSNo.Value &lt; 1 Then\n    MsgBox (\"Please choose existing S.No\")\n    Exit Sub\nElseIf TextBoxSNo.Value &gt; Cells(LastRow, 1).Value Then\n    MsgBox (\"Please choose existing S.No\")\n    Exit Sub\n</code></pre>\n\n<p>This Code ristricts the values one can enter into an Excel userform. It works fine when the user enters a Value lower than 1 or higher than Cells(LastRow, 1).Value.</p>\n\n<p>However, it also Shows me the error message when I enter a valid value. How can this be? I even checked the values the code evaluates by printing them out in the MsgBox along with the Error Message. It really seems like vba evaluates 5>100 as true and prints out the error message.</p>\n\n<p>Edit: If I only Keep the first ElseIf Statement, it works as expected. Only when I add the second ElseIf, it evaluates incorrectly. LastRow is defined as an Integer, so I am comparing numbers to numbers</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1462348990, "post_id": 37021741, "comment_id": 61594350, "body": "<code>Range(...).Value</code> returns a 2D array (even if the range is only one column (or row)), in your case <code>9x1</code>.  Access elements by specifying both dimensions, eg <code>y = vArray(1,1)</code>"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 3, "creation_date": 1462349919, "post_id": 37021741, "comment_id": 61594934, "body": "Here you can use <code>vArray = Application.WorksheetFunction.Transpose(Range(&quot;G2:G10&quot;).Valu&zwnj;&#8203;e)</code> so you get Variant 1D Array (1 To 9)."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 6103621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1de597e2f79fadcc39be906607ca4e7d?s=128&d=identicon&r=PG", "display_name": "Ivan Tokarev", "link": "https://stackoverflow.com/users/6103621/ivan-tokarev"}, "is_accepted": false, "score": 0, "last_activity_date": 1462355972, "creation_date": 1462355972, "answer_id": 37024406, "question_id": 37021741, "link": "https://stackoverflow.com/questions/37021741/excel-vba-pull-single-value-out-of-range-and-put-into-a-cell/37024406#37024406", "title": "Excel VBA pull single value out of range and put into a cell", "body": "<p>You can do the following:</p>\n\n<pre><code> Sub anothertest()\n     Dim vArray() As Variant\n     Dim x As Integer\n     Dim y As Variant\n     With ActiveSheet\n        vArray = Application.WorksheetFunction.Transpose(Range(\"G2:G10\").Value) \n     End With\n     x = UBound(vArray) - LBound(vArray) + 1\n     MsgBox x\n     y = vArray(1)\n     MsgBox y\n     Cells(1, 10).Value = y\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6090305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fdc70c9115c7a15d6fbe8ca84508915?s=128&d=identicon&r=PG&f=1", "display_name": "Johann Muller", "link": "https://stackoverflow.com/users/6090305/johann-muller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1029, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462399029, "creation_date": 1462348612, "last_edit_date": 1462399029, "question_id": 37021741, "link": "https://stackoverflow.com/questions/37021741/excel-vba-pull-single-value-out-of-range-and-put-into-a-cell", "title": "Excel VBA pull single value out of range and put into a cell", "body": "<p>The following code works sometimes and sometimes not:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub anothertest()\n    Dim vArray As Variant\n    Dim x As Integer\n    Dim y As String\n    'vArray = Array(\"Cat\", \"Dog\", \"Rabbit\")\n    With ActiveSheet\n        vArray = Range(\"G2:G10\").Value\n    End With\n    x = UBound(vArray) - LBound(vArray) + 1\n    MsgBox x\n    y = vArray(1)\n    MsgBox y\n    Cells(1, 10).Value = y\nEnd Sub\n</code></pre>\n\n<p>It works with <code>vArray = Array(\"Cat\", \"Dog\", \"Rabbit\")</code>, returning <code>x</code> as <code>3</code> and <code>y</code> as <code>Dog</code>.<br>\nHowever, if I comment that out and activate <code>With Activesheet</code> to <code>End With</code>, it rightly returns <code>x</code> as <code>9</code> but returns a <code>Runtime error 9, script out of range</code>, even though it will print the full range correctly in a <code>for each</code> loop.<br>\nI need the sub to work with the range argument.  It works perfectly elsewhere in my script where I use <code>for each</code> loops, but here I need to pick one value out of the range per sheet.  Also, I am curious as to why it does not work, if I run into the problem again.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1462347468, "post_id": 37021299, "comment_id": 61593372, "body": "You are using a range address as myCrit, should you be using cells(r,1).value?"}, {"owner": {"reputation": 3, "user_id": 6289382, "user_type": "registered", "profile_image": "https://graph.facebook.com/972644719451126/picture?type=large", "display_name": "Borro", "link": "https://stackoverflow.com/users/6289382/borro"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1462348139, "post_id": 37021299, "comment_id": 61593792, "body": "Unfortunately it doesn&#39;t help. Can you think of other cell address format which could work?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1462348352, "post_id": 37021299, "comment_id": 61593940, "body": "have you tried, range(myCrit) or just cells(r,1)"}, {"owner": {"reputation": 3, "user_id": 6289382, "user_type": "registered", "profile_image": "https://graph.facebook.com/972644719451126/picture?type=large", "display_name": "Borro", "link": "https://stackoverflow.com/users/6289382/borro"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1462348690, "post_id": 37021299, "comment_id": 61594161, "body": "Nathan, range(mycrit) works like a charm ! Thanks a lot !"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1462348591, "last_edit_date": 1495535632, "creation_date": 1462348591, "answer_id": 37021733, "question_id": 37021299, "link": "https://stackoverflow.com/questions/37021299/vba-sumif-with-variable-range/37021733#37021733", "title": "VBA sumif with variable range", "body": "<p>You need ranges and you need to set them. In your code, if you write debug.print after myval like this:</p>\n\n<pre><code>For r = 2 To abc - 2\n   mycrit = Cells(r, 1).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n   myval = Cells(r, c).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n   myval = Application.WorksheetFunction.SumIf(CritRng, mycrit, SumRng)\n   debug.print myval\nNext r\n\nEnd sub\n</code></pre>\n\n<p>you would probably get some result in the immediate window. Ctrl+G.\nIn order to get some result try with:</p>\n\n<pre><code>For r = 2 To abc - 2\n    mycrit = Cells(r, 1).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n    myval = Cells(r, c).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n    myval = Application.WorksheetFunction.SumIf(CritRng, mycrit, SumRng)\n    Cells(r,c) = myval\nNext r\n\nEnd sub\n</code></pre>\n\n<p>Finally - 2 things - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">try to avoid usage of select</a> and format your code :)\n<a href=\"http://www.mrexcel.com/forum/excel-questions/664263-using-defined-variable-range-sumif-visual-basic-applications.html\" rel=\"nofollow noreferrer\">Here</a> you may find some examples of sumif with VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1462349410, "creation_date": 1462349410, "answer_id": 37022005, "question_id": 37021299, "link": "https://stackoverflow.com/questions/37021299/vba-sumif-with-variable-range/37022005#37022005", "title": "VBA sumif with variable range", "body": "<p>Try to avoid using select statements. Also learn to use the <code>Application.ScreenUpdating</code> property to speed up your code (This disables the screen refreshing between each write to the excel sheet and updates everything at the end making it much faster)</p>\n\n<pre><code>Sub sumif_test()\n    Dim ws As Worksheet\n    Dim NoCol As Integer, NoRow As Integer\n    Dim CritRng As Range, SumRng As Range\n\n    Application.ScreenUpdating = False\n\n    Set ws = Worksheets(\"AB\")\n\n    With ws\n        NoRow = .Cells(.Cells.Rows.Count, 1).End(xlUp).Row\n        NoCol = .Cells(1, .Cells.Columns.Count).End(xlToLeft).Column\n        Set CritRng = .Range(\"A:A\")\n        Set SumRng = .Range(\"N:N\")\n    End With\n\n    For r = 2 To NoRow\n        Cells(r, NoCol) = WorksheetFunction.SumIf(CritRng, Cells(r, 1), SumRng)\n    Next r\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I've rewritten your code to avoid using the select statement. Please take a look at it and see if you can figure out what each part does.</p>\n"}], "owner": {"reputation": 3, "user_id": 6289382, "user_type": "registered", "profile_image": "https://graph.facebook.com/972644719451126/picture?type=large", "display_name": "Borro", "link": "https://stackoverflow.com/users/6289382/borro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6018, "favorite_count": 0, "accepted_answer_id": 37022005, "answer_count": 2, "score": 0, "last_activity_date": 1462349410, "creation_date": 1462347312, "last_edit_date": 1531164843, "question_id": 37021299, "link": "https://stackoverflow.com/questions/37021299/vba-sumif-with-variable-range", "title": "VBA sumif with variable range", "body": "<p>I'm new to VBA, so I have to ask you for a help.\nBelow, I got VBA code which should sum data from different sheet [AB] based on value from first column of active sheet. The number of rows and columns is variable, so cell adresses need to be absolute.</p>\n\n<pre><code>Sub sumif_test\n\nRange(\"A1\").Select\nSelection.End(xlDown).Select\nabc = ActiveCell.Row\nSelection.End(xlUp).Select\nSelection.End(xlToRight).Select\n\nActiveCell.Offset(1, 1).Select\n\nDim mycrit As Variant\nDim myval As Variant\nDim CritRng As Range\nDim SumRng As Range\n\nSet CritRng = Worksheets(\"AB\").Range(\"A:A\")\nSet SumRng = Worksheets(\"AB\").Range(\"N:N\")\n\nc = ActiveCell.Column\nr = ActiveCell.Row\n\nFor r = 2 To abc - 2\nmycrit = Cells(r, 1).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nmyval = Cells(r, c).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nmyval = Application.WorksheetFunction.SumIf(CritRng, mycrit, SumRng)\n\nNext r\n\nEnd sub\n</code></pre>\n\n<p>With this code I don't get any result.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462344792, "post_id": 37020395, "comment_id": 61591886, "body": "For the methods that aren&#39;t working for you, what do <code>iRow1</code> and <code>iRow2</code> evaluate to?"}, {"owner": {"reputation": 31, "user_id": 6289171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99d27eb38675eb70fdcc5f1268a70d3?s=128&d=identicon&r=PG&f=1", "display_name": "Space_girl", "link": "https://stackoverflow.com/users/6289171/space-girl"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462344998, "post_id": 37020395, "comment_id": 61592013, "body": "iRow1 = 14, iRow 2 = 255, iRow 3 = 275. The reason why I have got (iRow1 + 1) etc. is because I want a blank row between some sections for ease of looking at the data"}, {"owner": {"reputation": 31, "user_id": 6289171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99d27eb38675eb70fdcc5f1268a70d3?s=128&d=identicon&r=PG&f=1", "display_name": "Space_girl", "link": "https://stackoverflow.com/users/6289171/space-girl"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462345184, "post_id": 37020395, "comment_id": 61592121, "body": "Oops I see my issue. The offsets I&#39;ve put in don&#39;t match what I want. <i>facepalm</i>"}, {"owner": {"reputation": 31, "user_id": 6289171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99d27eb38675eb70fdcc5f1268a70d3?s=128&d=identicon&r=PG&f=1", "display_name": "Space_girl", "link": "https://stackoverflow.com/users/6289171/space-girl"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462348358, "post_id": 37020395, "comment_id": 61593947, "body": "Even after trying it again, it still hasn&#39;t worked (I&#39;ve edited the original post to correct the initial mistake I had though) :( Any further ideas would be welcome, thank you !"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1462361217, "post_id": 37020395, "comment_id": 61602862, "body": "honestly the only reason i could possibly imagine is that your iRow values are wrong. put a debug.print iRow1 &amp; &quot;  &quot; &amp; iRow 2 just before your not working methods and check the result. Sorry if you have allready done that, but it is hard to imagine an erro on another part =)"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462382698, "post_id": 37020395, "comment_id": 61618540, "body": "or <code>debug.print Range(Cells(iRow+1,1), Cells(iRow2-2,67)).Address</code> to make sure the Range is evaluating correctly - but it looks OK."}, {"owner": {"reputation": 31, "user_id": 6289171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99d27eb38675eb70fdcc5f1268a70d3?s=128&d=identicon&r=PG&f=1", "display_name": "Space_girl", "link": "https://stackoverflow.com/users/6289171/space-girl"}, "edited": false, "score": 0, "creation_date": 1462519264, "post_id": 37020395, "comment_id": 61678677, "body": "Thank you all, I solved my problem, I was incorrectly using Row 2, when I should have used Row 3, silly mistake, but thank you !"}], "owner": {"reputation": 31, "user_id": 6289171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99d27eb38675eb70fdcc5f1268a70d3?s=128&d=identicon&r=PG&f=1", "display_name": "Space_girl", "link": "https://stackoverflow.com/users/6289171/space-girl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1656, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462353248, "creation_date": 1462344406, "last_edit_date": 1531164843, "question_id": 37020395, "link": "https://stackoverflow.com/questions/37020395/run-time-error-1004-the-command-requires-at-least-two-rows-of-source-data", "title": "Run-time error &#39;1004&#39; The command requires at least two rows of source data", "body": "<p>This is my first time asking a question on Stack Overflow, would really appreciate any help / tips. </p>\n\n<p>I wish to automate the range for the advanced filter function, so that the last row at the time of import of each subsequent section is stored in a different <code>iRow_number</code>, that can be used to store the references for automation.</p>\n\n<p>The non-automated method works, but the automated doesn't and it's driving me up the wall as I can't figure out why. The error I am getting is </p>\n\n<blockquote>\n  <p>\"Run-time error '1004': This command requires at least two rows of\n  source data. You cannot use the command on a selection in only one\n  row. Try the following: If you're using an advanced filter, select a\n  range of cells that contains at least two rows of data. Then click the\n  advanced filter command again. If you're creating a PivotTable report\n  or\"...(not relevant).</p>\n</blockquote>\n\n<p>Please help ! </p>\n\n<p>Attached is my code. </p>\n\n<pre><code>Dim iRow3 As Long\n\nSub Filter()\n\nDim ws1 As Worksheet\nDim iRow1 As Long\nDim iRow2 As Long\nDim cell1 As Long\nDim cell2 As Long\n\nSet ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\n\n'import_filter_criteria()\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;C:\\Users\\XXXXXXX\" _\n    , Destination:=Range(\"$A$1\"))\n    .Name = \"filter_criteria\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\niRow1 = ws1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n'import_Headings()\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;C:\\Users\\XXXXXXXX\" _\n    , Destination:=Range(\"$A$\" &amp; (iRow1 + 1)))\n    .Name = \"headings\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\n\niRow2 = ws1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n'import_Data()\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;C:\\Users\\XXXXXXX\" _\n    , Destination:=Range(\"$A$\" &amp; (iRow2)))\n    .Name = \"mass_evol_db\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 2\n    .TextFileParseType = xlFixedWidth\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(2, 5, 9, 1, 5, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1, 1, 1, 1, 1, 9)\n    .TextFileFixedColumnWidths = Array(4, 13, 1, 8, 11, 1, 8, 3, 11, 11, 11, 11, 14, 14, 14, _\n    14, 14, 14, 14, 14, 14, 9, 9, 9, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 6, 6, 6, 6, 6, 6, 6, 6 _\n    , 6, 6, 6, 15, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\niRow3 = ws1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n' filter_in_action()\n</code></pre>\n\n<p>THIS METHOD WORKS, but isn't automated in the ranges</p>\n\n<pre><code>Range(\"A15:BO253\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _\nRange(\"A1:BO13\"), CopyToRange:=Range(\"$A$\" &amp; (iRow3 + 1)), Unique:=False\n</code></pre>\n\n<p>THESE TWO METHODs DON'T WORK</p>\n\n<pre><code>Range(Cells((iRow1 + 1), 1), Cells((iRow2 - 2), 67)).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _\nRange(Cells(1, 1), Cells((iRow1 - 1), 67)), CopyToRange:=Range(\"$A$\" &amp; (iRow3 + 1)), Unique:=False\n\nRange(\"A\" &amp; (iRow1 + 1) &amp; \":BO\" &amp; (iRow2 - 2)).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _\nRange(\"A1:BO\" &amp; (iRow1 - 1)), CopyToRange:=Range(\"$A$\" &amp; (iRow3 + 1)), Unique:=False\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1462347254, "post_id": 37020032, "comment_id": 61593246, "body": "How are you opening Access in decompile mode? Is it via a <code>.bat</code> file with the a line like: <code>&quot;C:\\Program Files\\Microsoft Office\\Office\\MSACCESS.EXE&quot; &quot;d:\\My Documents\\myAccessDatabase.mdb&quot; &#47;decompile</code>?"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1462347610, "post_id": 37020032, "comment_id": 61593464, "body": "If you&#39;re still able to run some kind of script on the file, you could adapt the VBA described on this thread to try and export out your VBA modules to a text file <a href=\"http://www.utteraccess.com/forum/lofiversion/index.php/t2019941.html\" rel=\"nofollow noreferrer\">utteraccess.com/forum/lofiversion/index.php/t2019941.html</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1462350339, "post_id": 37020032, "comment_id": 61595232, "body": "<b><a href=\"http://stackoverflow.com/a/3268188/3820271\">Decompile</a></b> - follow these steps to the letter."}, {"owner": {"reputation": 1, "user_id": 6289148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TfuQA4RaFc/AAAAAAAAAAI/AAAAAAAAA1g/UD3RCtlCW0g/photo.jpg?sz=128", "display_name": "Laurence Lock Lee", "link": "https://stackoverflow.com/users/6289148/laurence-lock-lee"}, "edited": false, "score": 0, "creation_date": 1462567387, "post_id": 37020032, "comment_id": 61706935, "body": "ok...been away but thanks for your prompt replies. I will let you know how I go."}, {"owner": {"reputation": 1, "user_id": 6289148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TfuQA4RaFc/AAAAAAAAAAI/AAAAAAAAA1g/UD3RCtlCW0g/photo.jpg?sz=128", "display_name": "Laurence Lock Lee", "link": "https://stackoverflow.com/users/6289148/laurence-lock-lee"}, "edited": false, "score": 0, "creation_date": 1462569756, "post_id": 37020032, "comment_id": 61707972, "body": "ok I&#39;ve just tried the command line decompile step but I get the &quot;Database cannot be opened because the VBA project contained it it cannot be read....&quot;...which is what I am trying to recover."}, {"owner": {"reputation": 1, "user_id": 6289148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TfuQA4RaFc/AAAAAAAAAAI/AAAAAAAAA1g/UD3RCtlCW0g/photo.jpg?sz=128", "display_name": "Laurence Lock Lee", "link": "https://stackoverflow.com/users/6289148/laurence-lock-lee"}, "edited": false, "score": 0, "creation_date": 1462569886, "post_id": 37020032, "comment_id": 61708013, "body": "I can try the VBA script by creating a new module to run it, but will I run into the same problems as it doesn&#39;t seem to be able to address the existing modules any more?"}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1462577190, "post_id": 37020032, "comment_id": 61710243, "body": "Import the all but the modules into new database and then import the modules from a backup."}, {"owner": {"reputation": 1, "user_id": 6289148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TfuQA4RaFc/AAAAAAAAAAI/AAAAAAAAA1g/UD3RCtlCW0g/photo.jpg?sz=128", "display_name": "Laurence Lock Lee", "link": "https://stackoverflow.com/users/6289148/laurence-lock-lee"}, "edited": false, "score": 0, "creation_date": 1462696015, "post_id": 37020032, "comment_id": 61738479, "body": "Unfortunately no recent backup (I know...)... Tables are fine."}], "owner": {"reputation": 1, "user_id": 6289148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TfuQA4RaFc/AAAAAAAAAAI/AAAAAAAAA1g/UD3RCtlCW0g/photo.jpg?sz=128", "display_name": "Laurence Lock Lee", "link": "https://stackoverflow.com/users/6289148/laurence-lock-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1448, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593588333, "creation_date": 1462343129, "last_edit_date": 1593588333, "question_id": 37020032, "link": "https://stackoverflow.com/questions/37020032/cannot-access-any-vba-modules-in-ms-access-2016", "title": "Cannot access any VBA Modules in MS Access 2016", "body": "<p>My VBA Project seems to be corrupted. When I try to open a module I get a \"Module name 'xxxx' is misspelled or relates to a module that doesn't exist\". This all seemed to happen after a run time error inferring a corruption had taken place. I have tried to open Access in decompile mode and then open the data base, but still no luck...though I'm not sure how you tell its in decompile mode. I'd desperately like to get some code out that I've been working on for a couple of days.... I can open the tables and queries, so it seems its just the VBA project.</p>\n\n<p>Any ideas? is there a way of accessing the modules outside of the data base?</p>\n"}, {"tags": ["vba", "excel", "loops", "label"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462346365, "post_id": 37019976, "comment_id": 61592764, "body": "I think it is not a good idea to give a simple numeric value (ie: labelCounter) as name for your labels. Maybe build a name like you do for checkboxes: <code>UserForm1.Controls.Add(&quot;Forms.Label.1&quot;, &quot;label_&quot; &amp; labelCounter, True)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462346945, "post_id": 37020979, "comment_id": 61593065, "body": "Is <code>&quot;&quot; &amp; j</code> better than <code>CStr(j)</code> ?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462347007, "post_id": 37020979, "comment_id": 61593111, "body": "@Rory: sorry, I was editing my answer while you already posted yours. and as long the OP&#39;s question is concerned they gave the same solution (though in different &quot;flavours&quot;) -&gt; credits to you!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462347328, "post_id": 37020979, "comment_id": 61593292, "body": "@VincentG No, not better or worse."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1462346428, "creation_date": 1462346428, "answer_id": 37020979, "question_id": 37019976, "link": "https://stackoverflow.com/questions/37019976/vba-excel-loop-on-userform-label/37020979#37020979", "title": "VBA Excel loop on userform.label", "body": "<p>Assuming your controls are in pairs, it should be:</p>\n\n<pre><code>Wzorce = Wzorce + UserForm1.Controls(\"\" &amp; j).Caption\n</code></pre>\n\n<p>though I think you should name the labels the same way you did the checkboxes.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1462346852, "creation_date": 1462346852, "answer_id": 37021158, "question_id": 37019976, "link": "https://stackoverflow.com/questions/37019976/vba-excel-loop-on-userform-label/37021158#37021158", "title": "VBA Excel loop on userform.label", "body": "<p>you have to use</p>\n\n<pre><code>Wzorce = Wzorce + UserForm1.Controls(CStr(j)).Caption\n</code></pre>\n\n<p>here follows some other possible enhancements of your code</p>\n\n<pre><code>Dim theLabel As MSForms.Label, chkbox As MSForms.CheckBox\nDim Wynik1 As Variant, Wzorce As Variant\n\ni = 1\nWhile Not Sheets(\"I_M_1_1PW\").Cells(9 + i, 43) = \"koniec\"\n\n    Set theLabel = UserForm1.Controls.Add(\"Forms.Label.1\", i, True)\n    With theLabel\n        .Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 43)\n        .Left = 10\n        .Width = 100\n        .Top = 13 * i\n        Debug.Print i &amp; \"   \" &amp; theLabel.Caption\n    End With\n\n    Set chkbox = UserForm1.Controls.Add(\"Forms.CheckBox.1\", \"CheckBox_\" &amp; i)\n    With chkbox\n        .Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 44)\n        .Left = 100\n        .Width = 75\n        .Top = 13 * i\n    End With\n\n    i = i + 1\nWend\n\n...\n\nFor j = 1 To Granica - 1       \n\n  If UserForm1.Controls(\"CheckBox_\" &amp; j).Value = True Then\n         Wynik1 = chkboxes(j).Caption + Wynik1\n         Wzorce = Wzorce + UserForm1.Controls(j).Caption    \n  End If\nNext\n</code></pre>\n\n<p>Finally here follows same code above but with exploitation of control arrays, which can possibly make your code more readable and maintainable:</p>\n\n<pre><code>Dim theLabel As MSForms.Label, chkbox As MSForms.CheckBox\nDim labels() As MSForms.Label, chkboxes() As MSForms.CheckBox\n\ni = 1\nWhile Not Sheets(\"I_M_1_1PW\").Cells(9 + i, 43) = \"koniec\"\n\n    Set theLabel = UserForm1.Controls.Add(\"Forms.Label.1\", i, True)\n    With theLabel\n        .Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 43)\n        .Left = 10\n        .Width = 100\n        .Top = 13 * i\n        Debug.Print i &amp; \"   \" &amp; theLabel.Caption\n    End With\n    ReDim Preserve labels(1 To i)\n    Set labels(i) = theLabel\n\n    Set chkbox = UserForm1.Controls.Add(\"Forms.CheckBox.1\", \"CheckBox_\" &amp; i)\n    With chkbox\n        .Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 44)\n        .Left = 100\n        .Width = 75\n        .Top = 13 * i\n    End With\n    ReDim Preserve chkboxes(1 To i)\n    Set chkboxes(i) = chkbox\n\n    i = i + 1\nWend\n\n...\n\nFor j = 1 To Granica - 1\n    If chkboxes(j).Value = True Then\n        Wynik1 = chkboxes(j).Caption + Wynik1\n        Wzorce = Wzorce + labels(j).Caption\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6289133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47552054af390c3464e5cf79b3215a23?s=128&d=identicon&r=PG&f=1", "display_name": "Ghabon", "link": "https://stackoverflow.com/users/6289133/ghabon"}, "is_accepted": false, "score": 0, "last_activity_date": 1462369914, "creation_date": 1462369914, "answer_id": 37029823, "question_id": 37019976, "link": "https://stackoverflow.com/questions/37019976/vba-excel-loop-on-userform-label/37029823#37029823", "title": "VBA Excel loop on userform.label", "body": "<p>Great it works. </p>\n\n<pre><code>Wzorce = Wzorce + UserForm1.Controls(\"label_\" &amp; j).Caption\n</code></pre>\n\n<p>Ty user3598756.</p>\n"}], "owner": {"reputation": 1, "user_id": 6289133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47552054af390c3464e5cf79b3215a23?s=128&d=identicon&r=PG&f=1", "display_name": "Ghabon", "link": "https://stackoverflow.com/users/6289133/ghabon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2727, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1462369914, "creation_date": 1462342953, "question_id": 37019976, "link": "https://stackoverflow.com/questions/37019976/vba-excel-loop-on-userform-label", "title": "VBA Excel loop on userform.label", "body": "<p>Iam creating my labels and checkbox by code:</p>\n\n<pre><code>i = 1\nWhile Not Sheets(\"I_M_1_1PW\").Cells(9 + i, 43) = \"koniec\"\n\n    Set theLabel = UserForm1.Controls.Add(\"Forms.Label.1\", labelCounter, True)\n    With theLabel\n        .Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 43)\n        .Left = 10\n        .Width = 100\n        .Top = 13 * labelCounter\n        Debug.Print labelCounter &amp; \"   \" &amp; theLabel.Caption\n    End With\n\nSet chkbox = UserForm1.Controls.Add(\"Forms.CheckBox.1\", \"CheckBox_\" &amp; i)\n    chkbox.Caption = Sheets(\"I_M_1_1PW\").Cells(9 + i, 44)\n    chkbox.Left = 100\n    chkbox.Width = 75\n    chkbox.Top = 13 * labelCounter\ni = i + 1\nlabelCounter = labelCounter + 1\n</code></pre>\n\n<p>I can search for active check box by code: </p>\n\n<pre><code>For j = 1 To Granica - 1\n\n            If UserForm1.Controls(\"CheckBox_\" &amp; j).Value = True Then\n\n             Wynik1 = UserForm1.Controls(\"CheckBox_\" &amp; j).Caption + Wynik1\n    '*         Wzorce = Wzorce + UserForm1.label(j).Caption\n\n            End If\nNext\n</code></pre>\n\n<p>But in '*  place i got problem, cant take label.caption when iam using \nUserForm1.Controls(j).Caption its looping through all parts parts of user.form not only labels.</p>\n"}, {"tags": ["vba", "excel", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462343977, "post_id": 37020153, "comment_id": 61591435, "body": "Do I have to use <code>Workbooks(&quot;Your_worksheet_name_here&quot;)</code>? It&#39;s the same workbook but a different sheet. <code>targetSheet.Range(&quot;F3:ZZ3&quot;).End(xlToRight).Offset(-2, 1).Paste</code> creates an error."}, {"owner": {"reputation": 101, "user_id": 6103621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1de597e2f79fadcc39be906607ca4e7d?s=128&d=identicon&r=PG", "display_name": "Ivan Tokarev", "link": "https://stackoverflow.com/users/6103621/ivan-tokarev"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462344543, "post_id": 37020153, "comment_id": 61591754, "body": "I misunderstood your problem,look at OldUgly&#39;s reply. I think his point aboud dots in code is correct."}], "tags": [], "owner": {"reputation": 101, "user_id": 6103621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1de597e2f79fadcc39be906607ca4e7d?s=128&d=identicon&r=PG", "display_name": "Ivan Tokarev", "link": "https://stackoverflow.com/users/6103621/ivan-tokarev"}, "is_accepted": false, "score": 1, "last_activity_date": 1462343623, "creation_date": 1462343623, "answer_id": 37020153, "question_id": 37019968, "link": "https://stackoverflow.com/questions/37019968/run-a-macro-on-a-different-sheet-using-vba-excel/37020153#37020153", "title": "Run a Macro on a different sheet using VBA (Excel)", "body": "<p>You have to specify worksheetname for the macro. For example you can try this:</p>\n\n<pre><code> Workbooks(\"Your_worksheet_name_here\").Sheets(\"1. Stock &amp; Demand\").Range(\"F3:ZZ3\").End(xlToRight).Offset(-2, 1).Paste\n</code></pre>\n\n<p>Normally, to keep things clear i do something like this:</p>\n\n<pre><code> Set targetSheet = Workbooks(\"Your_worksheet_name_here\").Sheets(\"1. Stock &amp; Demand\")\n targetSheet.Range(\"F3:ZZ3\").End(xlToRight).Offset(-2, 1).Paste\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462344857, "post_id": 37020356, "comment_id": 61591929, "body": "Thank you! But now the row <code>&#39;Selects the first empty cell in 1. Stock &amp; Demand and pastes&#39;     .Range(&quot;F3:ZZ3&quot;).End(xlToRight).Offset(-2, 1).Paste</code> gives me an error."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345374, "post_id": 37020356, "comment_id": 61592226, "body": "<code>.Range(&quot;F3:ZZ3&quot;).End(xlToRight)</code> evaluates to cell <code>XFD3</code>, the last column in the worksheet. <code>.Offset(-2,1)</code> tries to go up two rows and to the right one row - right off the sheet. I don&#39;t know what you are trying to do - so I can&#39;t tell you a solution."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345481, "post_id": 37020356, "comment_id": 61592292, "body": "That what the macro should do but doesn&#39;t. Visual Basic shows me a yellow line :/. <b>Run-time error &#39;438&#39;: Object doesn&#39;t support this properly method.</b>"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345595, "post_id": 37020356, "comment_id": 61592348, "body": "That&#39;s what the macro DOES do. You are trying to paste to a cell that doesn&#39;t exist, so it throws an error. The yellow line is just telling you where the error is."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345719, "post_id": 37020356, "comment_id": 61592424, "body": "But this macros does work on <b>1. Stock &amp; Demand</b>. But doesn&#39;t when I let it run from a differen sheet. That&#39;s really confusing for me."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345730, "post_id": 37020356, "comment_id": 61592433, "body": "Where do you want to paste what you&#39;ve copied?"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1462345917, "post_id": 37020356, "comment_id": 61592529, "body": "I want that he goes to the end of the sheet and copies the last 3 columns. Then the macro should paste it to the first empty column and takes out the formulas from the previously copied three columns."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1462346838, "post_id": 37020356, "comment_id": 61593004, "body": "You need <code>PasteSpecial</code> rather than <code>Paste</code>."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 1, "last_activity_date": 1462344287, "creation_date": 1462344287, "answer_id": 37020356, "question_id": 37019968, "link": "https://stackoverflow.com/questions/37019968/run-a-macro-on-a-different-sheet-using-vba-excel/37020356#37020356", "title": "Run a Macro on a different sheet using VBA (Excel)", "body": "<p>Something minor - inside your <code>With</code> statements, you are mis-coding. Take notice of the \".\". By misplacing / omitting it, you will end up with results in the incorrect tab.</p>\n\n<p>For example </p>\n\n<pre><code>With Sheets(\"1. Stock &amp; Demand\")\n    Lastcol = .Cells(1, Columns.Count).End(xlToLeft).Column\n    Columns(Lastcol - 3).Resize(, 1).PasteSpecial Paste:=xlPasteValues\nEnd With\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>With Sheets(\"1. Stock &amp; Demand\")\n    Lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    .Columns(Lastcol - 3).Resize(, 1).PasteSpecial Paste:=xlPasteValues\nEnd With\n</code></pre>\n\n<p>and this ...</p>\n\n<pre><code>With Sheets(\"1. Stock &amp; Demand\")\n    Lastcol = .Cells(1, Columns.Count).End(xlToLeft).Column\n    Columns(Lastcol - 1).Resize(, 1).Select\n    Selection.Copy\n\n'Selects the first empty cell in 1. Stock &amp; Demand and pastes'\n    Sheets(\"1. Stock &amp; Demand\").Range(\"F3:ZZ3\").End(xlToRight).Offset(-2, 1).Paste\n\n'Pastes the Today()'\n    Sheets(\"1. Stock &amp; Demand\").Range(\"F3:ZZ3\").End(xlToRight).Offset(-1, 0).Select\n    Selection.Value = Date\n</code></pre>\n\n<p>should be ...</p>\n\n<pre><code>With Sheets(\"1. Stock &amp; Demand\")\n    Lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    .Columns(Lastcol - 1).Resize(, 1).Copy\n\n'Selects the first empty cell in 1. Stock &amp; Demand and pastes'\n    .Range(\"F3:ZZ3\").End(xlToRight).Offset(-2, 1).Paste\n\n'Pastes the Today()'\n    .Range(\"F3:ZZ3\").End(xlToRight).Offset(-1, 0).Value = Date\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462820348, "creation_date": 1462342912, "last_edit_date": 1462820348, "question_id": 37019968, "link": "https://stackoverflow.com/questions/37019968/run-a-macro-on-a-different-sheet-using-vba-excel", "title": "Run a Macro on a different sheet using VBA (Excel)", "body": "<p>I want to make a sheet that has different macro-buttons This sheet is named <strong>Buttons</strong>. The macro-buttons in this sheet are linked to macros that should run on different sheets. I tried to make a macro-button for the sheet <strong>1. Stock &amp; Demand</strong>:</p>\n\n<pre><code>Sub NeuerTag()\n\n'Abfrage ob der Tag eingef\u00fcgt werden soll, No = QUIT'\nIf MsgBox(\"M\u00f6chtest du die Tabelle vorbereiten?\", vbYesNo) = vbNo Then Exit Sub\n\n'Copies the last three coloumns of the Worksheet 1. Stock &amp; Demand'\nWith Sheets(\"1. Stock &amp; Demand\")\nLastcol = .Cells(1, Columns.Count).End(xlToLeft).Column\nColumns(Lastcol - 1).Resize(, 1).Select\nSelection.Copy\n\n'Selects the first empty cell in 1. Stock &amp; Demand and pastes'\nSheets(\"1. Stock &amp; Demand\").Range(\"F3:ZZ3\").End(xlToRight).Offset(-2, 1).Paste\n\n'Pastes the Today()'\nSheets(\"1. Stock &amp; Demand\").Range(\"F3:ZZ3\").End(xlToRight).Offset(-1, 0).Select\nSelection.Value = Date\n\n'Paste Special - Values'\nWith Sheets(\"1. Stock &amp; Demand\")\nLastcol = .Cells(1, Columns.Count).End(xlToLeft).Column\nColumns(Lastcol - 3).Resize(, 1).PasteSpecial Paste:=xlPasteValues\n\nEnd With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Now I have a Problem. Every time I make a macro-button and let it run it only does his Job in the sheet <strong>Buttons</strong> and not in the sheet I want it to work.</p>\n\n<p>I have to say I'm not really good at coding so please explain it to me like im five ;-).</p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462343953, "post_id": 37018912, "comment_id": 61591415, "body": "There is a difference between file access and HTTPS resource access via URI. Thats why your <code>IsFileOpen</code> will not work with a URI. But what happens if you simply check <code>wbk.ReadOnly</code> ? Should be <code>FALSE</code> if not locked and <code>TRUE</code> if locked."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1462344561, "post_id": 37018912, "comment_id": 61591763, "body": "Have you seen or tried this? <a href=\"http://stackoverflow.com/questions/25668098/detect-if-sharepoint-file-is-open\">Sharepoint detect if file is open</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462395169, "post_id": 37018912, "comment_id": 61625686, "body": "@AxelRichter At what point in the code would I apply this? The <code>Workbooks.Open(location)</code> command will already prompt to open a copy if the file is in use. How would I check <code>wbk.ReadOnly</code> to intercept that prompt?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1462422512, "post_id": 37018912, "comment_id": 61633710, "body": "@Moosli, thanks, but that approach opens a dialog if the file is in use. I edited the question."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462428904, "post_id": 37018912, "comment_id": 61635943, "body": "@teylyn: I had tested this with our SharePoint and the workbook is simply opened read only without any dialog if it is opened writable already by someone else. I am not a SharePoint expert. So I don&#39;t know whether this is any setting in SharePoint. You have tried to suppress the dialog using <code>Application.DisplayAlerts = False</code>?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462430401, "post_id": 37018912, "comment_id": 61636675, "body": "@AxelRichter Are you on SharePoint Online? If so, could you post the exact code? DisplayAlerts does nothing to the dialog. I see it every time."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462431961, "post_id": 37018912, "comment_id": 61637435, "body": "@teylyn: &quot;Are you on SharePoint Online?&quot; No, our company has it&#39;s own SharePoint server. The code was simply <code>Set wbk = Workbooks.Open(location) : MsgBox wbk.ReadOnly</code> where <code>location</code> was a SharePoint URI.  Excel was Excel 2007. Result of the code was <code>False</code> or <code>True</code> dependent of if the workbook behind the URI was opened already or not. No dialog ever."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1462443615, "post_id": 37018912, "comment_id": 61643858, "body": "@AxelRichter Ah, thanks. It&#39;s different with SharePoint online. Probably because simultaneous multi-user edit is now supported in Excel online, but not with Excel desktop."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1518516752, "post_id": 37018912, "comment_id": 84528920, "body": "I wonder what triggered a downvote almost two years after the question was posted. There still is no satisfactory answer to the actual issue. Meanwhile, Excel on a 365 license and online storage can do co-authoring.  But that does not solve the issue as posed in the original question. So what is the downvote about? I guess the downvoter does not really understand the issues at play here."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13887716, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7803e6a79791ab2c664770083e125b9a?s=128&d=identicon&r=PG", "display_name": "Mindileigh", "link": "https://stackoverflow.com/users/13887716/mindileigh"}, "is_accepted": false, "score": 0, "last_activity_date": 1594158691, "creation_date": 1594158691, "answer_id": 62784457, "question_id": 37018912, "link": "https://stackoverflow.com/questions/37018912/check-if-workbook-in-sharepoint-365-is-locked-for-editing/62784457#62784457", "title": "Check if workbook in SharePoint 365 is locked for editing", "body": "<p>I also work with SharePoint &amp; Office 365.\nThe code below worked for me.  In it, pickListFilePath is the path to the file on SharePoint 365.</p>\n<pre><code>'Open the workbook.  If it is already open (opens as read only),close it and loop to retry until it opens as editable.\n\nTryOpenUntilOpenToEdit:\n        Dim objExcel : objExcel = CreateObject(&quot;Excel.Application&quot;)\n        objExcel.DisplayAlerts = False\n        objExcel.ScreenUpdating = False\n\n        On Error Resume Next\n        Dim objPickListWB : objPickListWB = objExcel.Workbooks.Open(pickListFilePath, Notify:=False)\n\n        If Err().Number &lt;&gt; 0 Or objPickListWB.ReadOnly Then\n            objPickListWB.Close\n            objExcel.Quit\n            Err.Clear()\n            GoTo TryOpenUntilOpenToEdit\n        End If\n</code></pre>\n"}], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2548, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594169391, "creation_date": 1462338427, "last_edit_date": 1594169391, "question_id": 37018912, "link": "https://stackoverflow.com/questions/37018912/check-if-workbook-in-sharepoint-365-is-locked-for-editing", "title": "Check if workbook in SharePoint 365 is locked for editing", "body": "<p>I have a document library in SharePoint 365 and I use a local Excel macro file to open workbooks in SharePoint online via VBA. This works fine with code like </p>\n\n<pre><code>location = \"https://mycompany.sharepoint.com/sites/ABC/LibraryA/Book1.xlsx\"\nSet wbk = Workbooks.Open(location)\n</code></pre>\n\n<p>However, when users are editing the workbook in Excel Online, the workbook is locked / in use, and then the code runs into a prompt to save a local copy of the file. I want to avoid that and branch to code that handles things differently if the workbook is in use.</p>\n\n<p>If the workbook were stored on my company file server, things would be easy. I could use this <a href=\"https://support.microsoft.com/en-us/kb/291295\" rel=\"nofollow noreferrer\">Macro code to check whether a file is already open</a> provided by the Microsoft support site: </p>\n\n<pre><code>Sub TestFileOpened()\n\n    ' Test to see if the file is open.\n    If IsFileOpen(\"c:\\Book2.xls\") Then\n        ' Display a message stating the file in use.\n        MsgBox \"File already in use!\"\n        '\n        ' Add code here to handle case where file is open by another\n        ' user.\n        '\n    Else\n        ' Display a message stating the file is not in use.\n        MsgBox \"File not in use!\"\n        ' Open the file in Microsoft Excel.\n        Workbooks.Open \"c:\\Book2.xls\"\n        '\n        ' Add code here to handle case where file is NOT open by another\n        ' user.\n        '\n    End If\n\nEnd Sub\n\n' This function checks to see if a file is open or not. If the file is\n' already open, it returns True. If the file is not open, it returns\n' False. Otherwise, a run-time error occurs because there is\n' some other problem accessing the file.\n\nFunction IsFileOpen(filename As String)\n    Dim filenum As Integer, errnum As Integer\n\n    On Error Resume Next   ' Turn error checking off.\n    filenum = FreeFile()   ' Get a free file number.\n    ' Attempt to open the file and lock it.\n    Open filename For Input Lock Read As #filenum\n    Close filenum          ' Close the file.\n    errnum = Err           ' Save the error number that occurred.\n    On Error GoTo 0        ' Turn error checking back on.\n\n    ' Check to see which error occurred.\n    Select Case errnum\n\n        ' No error occurred.\n        ' File is NOT already open by another user.\n        Case 0\n         IsFileOpen = False\n\n        ' Error number for \"Permission Denied.\"\n        ' File is already opened by another user.\n        Case 70\n            IsFileOpen = True\n\n        ' Another error occurred.\n        Case Else\n            Error errnum\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>The problem is that when I run this with the SharePoint URL, the error code returned is 75 (<a href=\"https://msdn.microsoft.com/en-us/library/aa264531%28v=vs.60%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Path/File access error (Error 75)</a>, regardless of whether the file is in use or not.  </p>\n\n<p>Mapping the SharePoint 365 location as a network drive (WebDav) is not an option. There are simply too many things to maintain as described in <a href=\"https://support.microsoft.com/en-gb/kb/2616712\" rel=\"nofollow noreferrer\">How to configure and to troubleshoot mapped network drives that connect to SharePoint Online sites in Office 365</a>. Going through this would be too much for the end user.</p>\n\n<p>I need to find a way to check with VBA if a file stored in SharePoint online is open for use, while using the URL to access the file.</p>\n\n<p>Ideas welcome. </p>\n\n<p><strong>Edit:</strong> Comments suggested approaches to open the workbook as read only, then change a workbook property, or open the workbook and evaluate the <code>.ReadOnly</code> property. The problem with this approach is that if the workbook is changed from Read Only to Edit, this dialog pops up:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qbnu2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qbnu2.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Even if I click to open a read-only copy, the result is wrong. If I could suppress this dialog and instead evaluate the trigger that caused the dialog to appear, I could take it from there. </p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1499403074, "post_id": 37018710, "comment_id": 76900525, "body": "What do you see for that message in OutlookSpy if you click IMessage button?"}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 0, "last_activity_date": 1462390093, "creation_date": 1462390093, "answer_id": 37036387, "question_id": 37018710, "link": "https://stackoverflow.com/questions/37018710/extract-mail-properties-shown-as-blank-on-military-classified-siprnet/37036387#37036387", "title": "Extract Mail properties shown as blank on military classified SIPRNet", "body": "<p>So, you can use the PropertyAccessor object to get information that Outlook object model does'nt show.</p>\n\n<p>In this site (<a href=\"http://www.slipstick.com/developer/read-mapi-properties-exposed-outlooks-object-model/\" rel=\"nofollow\">http://www.slipstick.com/developer/read-mapi-properties-exposed-outlooks-object-model/</a>) you will find all the explanation on how to use it. </p>\n"}], "owner": {"reputation": 13, "user_id": 6288781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717cc49f6cf1f6c8b170679322161a80?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6288781/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499320724, "creation_date": 1462337306, "last_edit_date": 1499320724, "question_id": 37018710, "link": "https://stackoverflow.com/questions/37018710/extract-mail-properties-shown-as-blank-on-military-classified-siprnet", "title": "Extract Mail properties shown as blank on military classified SIPRNet", "body": "<p>I am working on code that runs in Excel. The code reads a pst file in Outlook and goes through all the emails in the target folder and places the Subject, Date &amp; Time Received, Sender Name, and Body in the Excel file. </p>\n\n<p>The code works on a computer running Office 2010 and 2013 that is not on a secured network. The Locals Window image below shows the run on the open system.</p>\n\n<p>On an Office 2010 computer (Windows 7) that is set up in a military classified area use SIPRNet (Secret Internet Protocol Router Network), the Body and Sender Name in the Mail Item is empty for email that has both. The Locals Window also shows the Body and Sender Name missing. </p>\n\n<p>Here is the code:   </p>\n\n<pre><code>Private lRow As Long, x As Date, oWS As Worksheet\n\nSub GetFromInbox()\n\n    Dim olApp As Object\n    Dim olNs As Object\n    Dim oRootFldr As Object ' Root folder to start\n    Dim lCalcMode As Long\n    Dim olFileName As String\n    Dim olFolderName As String\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n\n    olFileName = Range(\"B5\")\n    olFolderName = Range(\"B6\")\n\n    Set oRootFldr = olNs.Folders(olFileName).Folders(olFolderName)\n    Set oWS = ActiveSheet\n\n    lRow = 10\n    lCalcMode = Application.Calculation\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    GetFromFolder oRootFldr\n    Application.ScreenUpdating = True\n    Application.Calculation = lCalcMode\n\n    Set oWS = Nothing\n    Set oRootFldr = Nothing\n    Set olNs = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n\nPrivate Sub GetFromFolder(oFldr As Object)\n\n    Dim oItem As Object, oSubFldr As Object\n\n    ' Process all mail items in this folder\n    For Each oItem In oFldr.Items\n        If TypeName(oItem) = \"MailItem\" Then\n            With oItem \n                oWS.Cells(lRow, 1).Value = .Subject\n                oWS.Cells(lRow, 2).Value = .ReceivedTime\n                oWS.Cells(lRow, 3).Value = .SenderName\n                oWS.Cells(lRow, 4).Value = MailBody(oItem)\n                lRow = lRow + 1\n            End With\n        End If\n    Next\n    Columns(\"D:D\").WrapText = False\n\n    ' Recurse all Subfolders\n    For Each oSubFldr In oFldr.Folders\n        GetFromFolder oSubFldr\n    Next\n\nEnd Sub\n\n\nPublic Function MailBody(ByVal MailItem As MailItem) As String\n\n    Select Case MailItem.BodyFormat\n        Case OlBodyFormat.olFormatPlain, OlBodyFormat.olFormatUnspecified\n            MailBody = MailItem.Body\n        Case OlBodyFormat.olFormatHTML\n            MailBody = MailItem.HtmlBody\n        Case OlBodyFormat.olFormatRichText\n            MailBody = MailItem.RTFBody\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>Locals Window during run on the open system <img src=\"https://i.stack.imgur.com/5Etgr.png\" alt=\"Locals Window during run\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13601, "user_id": 1564659, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f7524296b1d11599c7a1bd2c045a73ac?s=128&d=identicon&r=PG", "display_name": "Aminah Nuraini", "link": "https://stackoverflow.com/users/1564659/aminah-nuraini"}, "edited": false, "score": 0, "creation_date": 1462332925, "post_id": 37017824, "comment_id": 61587500, "body": "Explain what do you mean with not working"}, {"owner": {"reputation": 782, "user_id": 370806, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/59d11e22dadef58cbdb06bc82604f5f4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/370806/john"}, "edited": false, "score": 0, "creation_date": 1462336533, "post_id": 37017824, "comment_id": 61588474, "body": "Don&#39;t know if it will help but I would move the While Loop inside the If Then above it. You really don&#39;t want to process the loop if you can&#39;t open the file, correct?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5448218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MGptAHKu4tM/AAAAAAAAAAI/AAAAAAAAADM/OYKBgRgfo8A/photo.jpg?sz=128", "display_name": "Amrit", "link": "https://stackoverflow.com/users/5448218/amrit"}, "edited": false, "score": 0, "creation_date": 1462341871, "post_id": 37019165, "comment_id": 61590422, "body": "Thanks for your help Karthic. Can you please tell me what I need to enter in username and password field. I am getting some automation error while running the above script. Also My database is name.accdb"}, {"owner": {"reputation": 11, "user_id": 5448218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MGptAHKu4tM/AAAAAAAAAAI/AAAAAAAAADM/OYKBgRgfo8A/photo.jpg?sz=128", "display_name": "Amrit", "link": "https://stackoverflow.com/users/5448218/amrit"}, "edited": false, "score": 0, "creation_date": 1462353268, "post_id": 37019165, "comment_id": 61597111, "body": "Hi Karthic, now the array is giving type mismatch error where I am trying to read the line and split"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 11, "user_id": 5448218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MGptAHKu4tM/AAAAAAAAAAI/AAAAAAAAADM/OYKBgRgfo8A/photo.jpg?sz=128", "display_name": "Amrit", "link": "https://stackoverflow.com/users/5448218/amrit"}, "edited": false, "score": 0, "creation_date": 1462355944, "post_id": 37019165, "comment_id": 61599003, "body": "Try Dim myarray() As String"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1462346302, "last_edit_date": 1462346302, "creation_date": 1462339637, "answer_id": 37019165, "question_id": 37017824, "link": "https://stackoverflow.com/questions/37017824/vba-macro-i-am-trying-to-load-a-csv-file-into-an-access-database/37019165#37019165", "title": "VBA Macro. I am trying to load a csv file into an access database", "body": "<p>try with below</p>\n\n<pre><code>Sub test()\n    Dim objStream As Variant\n    Dim myarray1\n    Dim myarraycount\n    Dim i\n    Dim dbloc\n    Dim myarray()\n    Dim objFile As Variant\n    Dim con As ADODB.Connection\n    Dim rec As ADODB.Recordset\n    Set con = New ADODB.Connection\n    Set rec = New ADODB.Recordset\n    rec.CursorLocation = adUseClient\n    dbloc = \"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\xml.mdb\"\n    usernm = \"\" '&lt;========User Name goes here\n    pword = \"\" '&lt;========Password goes here\n    con.Open \"PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; dbloc &amp; \";\", usernm, pword\n    qry = \"select * from Table1\"\n    rec.Open qry, con, adOpenDynamic, adLockOptimistic\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    If fso.FileExists(\"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\") Then ' C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\"\n        Set objStream = fso.OpenTextFile(\"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\", 1, False, 0) '(\"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\", 1, False, 0)\n    End If\n    Do While Not objStream.AtEndOfStream\n        strLine = objStream.ReadLine\n        myarray1 = Split(strLine, \",\")\n        myarraycount = UBound(myarray1)\n        ReDim myarray(myarraycount)\n         rec.AddNew\n         rec(\"FUND\") = myarray1(0)\n         rec(\"ACCOUNT\") = myarray1(1)\n         rec(\"HTFREC\") = myarray1(2)\n         rec(\"F1\") = myarray1(3)\n         rec(\"F2\") = myarray1(4)\n         rec(\"F3\") = myarray1(5)\n         rec(\"F4\") = myarray1(6)\n         rec(\"F5\") = myarray1(7)\n         rec(\"F6\") = myarray1(8)\n         rec(\"F7\") = myarray1(9)\n         rec(\"F8\") = myarray1(10)\n         rec(\"F9\") = myarray1(11)\n         rec(\"F10\") = myarray1(12)\n         rec(\"F11\") = myarray1(13)\n         rec(\"F12\") = myarray1(14)\n         rec.Update\n         i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1255, "user_id": 3103059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ace5267f00efbd4a9a1d6af5beefd00?s=128&d=identicon&r=PG&f=1", "display_name": "agcala", "link": "https://stackoverflow.com/users/3103059/agcala"}, "is_accepted": false, "score": 0, "last_activity_date": 1506007178, "last_edit_date": 1506007178, "creation_date": 1506004991, "answer_id": 46346943, "question_id": 37017824, "link": "https://stackoverflow.com/questions/37017824/vba-macro-i-am-trying-to-load-a-csv-file-into-an-access-database/46346943#46346943", "title": "VBA Macro. I am trying to load a csv file into an access database", "body": "<p>You can try this code</p>\n\n<pre><code>Public Sub CSVtoArray(A() As String, csvline As String, Optional b As \nBoolean = False)\n'***************************************************************************\n'* Array A() will be loaded with csv columns values                        *\n'* cvsline is the csv string to parse                                      *\n'* DO NOT USE parameter b. It is only for internal workings                *\n'***************************************************************************\nDim k As Integer, j As Integer\nIf Not b Then\n ReDim A(0)\n CSVtoArray A(), csvline, True\n Exit Sub\nEnd If\nk = InStr(csvline, \",\")\nj = UBound(A)\nj = j + 1\nReDim Preserve A(j)\nIf k = 0 Then\n A(j) = Trim(csvline)\n Exit Sub\nEnd If\nA(j) = Trim(Mid(csvline, 1, k - 1))\nCSVtoArray A(), Mid(csvline, k + 1), True\nEnd Sub\n</code></pre>\n\n<p>The array which is going to hold the csv columns should be declared as <code>String</code> but you can use any type. Remember that the fields of an <code>ADODB.Recordset</code> can be thought as an array <code>rec(i)</code>. So using this routine your code would look like</p>\n\n<pre><code>    CSVtoArray myarray,strline\n    rec.AddNew\n     for j=0 to rec.Items.Count-1\n      rs(j)=myarray(j+1)\n     rec.Update\n</code></pre>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 11, "user_id": 5448218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MGptAHKu4tM/AAAAAAAAAAI/AAAAAAAAADM/OYKBgRgfo8A/photo.jpg?sz=128", "display_name": "Amrit", "link": "https://stackoverflow.com/users/5448218/amrit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506007178, "creation_date": 1462332185, "last_edit_date": 1462899459, "question_id": 37017824, "link": "https://stackoverflow.com/questions/37017824/vba-macro-i-am-trying-to-load-a-csv-file-into-an-access-database", "title": "VBA Macro. I am trying to load a csv file into an access database", "body": "<p>I am trying to write a VBA macro which can load a csv file into a predefined access table. Please help me out friends. The line of code where I am trying to read the csv file content into array is throwing error as type mismatch</p>\n\n<pre><code>Sub load_data()\nDim objStream As Variant\nDim objFile As Variant\nDim qry As String\nDim connectionString As String\nDim con As New ADODB.Connection\nDim rs As ADODB.Recordset\nDim i As Integer\ni = 0\nconnectionString = \"DBQ=C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\my.mdb; Driver={Microsoft Access Driver (*.mdb)}\"\ncon.Open connectionString\nqry = \"SELECT * FROM Table1\"\nSet rs = New ADODB.Recordset\nrs.Open qry\n\n Set fso = CreateObject(\"Scripting.FileSystemObject\")\nIf fso.FileExists(\"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\") Then\n    Set objStream = fso.OpenTextFile(\"C:\\Users\\amritansh.s\\Desktop\\NewExcelAutomation\\Sample.csv\", 1, False, 0)\nEnd If\nDo While Not objStream.AtEndOfStream\n    strLine = objStream.ReadLine\n       ReDim myarray(0)\n    **myarray = Split(strLine, \",\")**\n\n     rs.AddNew\n     rs(\"FUND\") = myarray(0)\n     rs(\"ACCOUNT\") = myarray(1)\n     rs(\"HTFREC\") = myarray(2)\n     rs(\"F1\") = myarray(3)\n     rs(\"F2\") = myarray(4)\n     rs(\"F3\") = myarray(5)\n     rs(\"F4\") = myarray(6)\n     rs(\"F5\") = myarray(7)\n     rs(\"F6\") = myarray(8)\n     rs(\"F7\") = myarray(9)\n     rs(\"F8\") = myarray(10)\n     rs(\"F9\") = myarray(11)\n     rs(\"F10\") = myarray(12)\n     rs(\"F11\") = myarray(13)\n     rs(\"F12\") = myarray(14)\n     rs.Update\n     i = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462331987, "post_id": 37017197, "comment_id": 61587278, "body": "I think <a href=\"http://stackoverflow.com/questions/18602979/how-to-give-a-time-delay-of-less-than-one-second-in-excel-vba\">this SO post</a> answers your question.  Try <code>Applicaton.Wait(Now() + 1&#47;(24*60*60.0*2))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1462375475, "creation_date": 1462375475, "answer_id": 37032005, "question_id": 37017197, "link": "https://stackoverflow.com/questions/37017197/attempt-at-creating-a-chart-that-changes-data-with-time-too-laggy/37032005#37032005", "title": "Attempt at creating a chart that changes data with time too laggy?", "body": "<p>This seemed to solve my problem:</p>\n\n<pre><code>Public Function PauseEvent(ByVal Delay As Double)\n  Dim dblEndTime As Double\n  dblEndTime = Timer + Delay\n  Do While Timer &lt; dblEndTime\n    DoEvents\n  Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462375475, "creation_date": 1462327248, "last_edit_date": 1531164843, "question_id": 37017197, "link": "https://stackoverflow.com/questions/37017197/attempt-at-creating-a-chart-that-changes-data-with-time-too-laggy", "title": "Attempt at creating a chart that changes data with time too laggy?", "body": "<p>I am trying to create a chart that changes the data with time. The Y data are the same but only the X data are changed. I am using Application.Wait to allow for some time between each change in X values (So I can see it with my eye). However when I run the code its very laggy and I am not sure if I am using the Application.Wait function properly but I want between each change a time of 0.5 seconds. Is there a way to make it more smooth so that I can see the graph as it changes with time (as the code loops through the rows)</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub UpdateChart()\n\nDim ChtObj As ChartObject\nDim counter As Integer\nDim timecount As Double\n\n\nSet ChtObj = ActiveSheet.ChartObjects.Add(200, 50, 500, 500)\n\n'Creating intial graph\nWith ChtObj.Chart\n    'Chart Type\n    .ChartType = xlXYScatterSmooth\n\n    'Datainput\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"Bending moment\"\n    .SeriesCollection(1).Values = Range(\"D3:H3\")\n    .SeriesCollection(1).XValues = Application.Union(Cells(5, 4), Cells(5, 5), Cells(5, 6), Cells(5, 7), Cells(5, 8))\n    .HasLegend = False\n\n    'Title\n    .HasTitle = True\n    .ChartTitle.Text = \"Bending moment along pile \" &amp; ActiveSheet.Name &amp; \" at time 0 seconds\"\n\n    'X-Axis\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Bending moment (kN.m)\"\n    'Y-Axis\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Length along pile (m)\"\n\nEnd With\n\n'Loopingthrough data to be done**\ncounter = 6\ntimecount = 0\nWhile (Not IsEmpty(Cells(counter, 4)))\n\n    'Pausing for half a second and recording cumulative time\n    timecount = timecount + 0.5\n    Application.Wait (Now() + TimeValue(\"0:00:005\"))\n\n    'Updating Chart data\n    With ChtObj.Chart\n        .SeriesCollection(1).XValues = Application.Union(Cells(counter, 4), Cells(counter, 5), Cells(counter, 6), Cells(counter, 7), Cells(counter, 8))\n        .ChartTitle.Text = \"Bending moment along pile \" &amp; ActiveSheet.Name &amp; \" at time \" &amp; timecount &amp; \" s\"\n    End With\n\n    'Next row\n    counter = counter + 1\nWend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "multiple-conditions"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462328068, "post_id": 37017184, "comment_id": 61586390, "body": "So a little debugging is in need.  put your cursor in the For i line and hit F9.  Then run the code.  It will stop at this line.  In VBEyou can see the values of everything in the &quot;Locals&quot; window.  You can expand all the arrays and make sure that there is data.  If not check all your other variables to ensure they are returning the correct numbers.  Then if everything is right hit F8 to go step by step, verifying each step.  Also I do not believe you want the <code>Exit For</code> in there.  Also you know you are comparing row by row and not each value in one array against all values in the others?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1462328528, "post_id": 37017184, "comment_id": 61586486, "body": "You never write the contents of <code>c6arr</code> back to the worksheet. Also, In Row 1 of your data, <code>c2arr</code> is negative so will fail both tests.  Also, in your code, <code>c1arr</code> will never be equal to both <code>c4arr</code> and <code>c5arr</code> so if <code>c2arr</code> &gt; 0 then &quot;Manual Review&quot; will always be the results.  As Scott writes, the <code>Exit For</code> will exit the loop if you pass the first test and stop processing the rest of the rows.  There also seem to be errors in your expected results, as you have an instance where result2 is neither &quot;manual review&quot; nor c3arr."}, {"owner": {"reputation": 19, "user_id": 6080040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac01e56ae4ba108f636cbc0d9e8bd7b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.T.", "link": "https://stackoverflow.com/users/6080040/j-t"}, "edited": false, "score": 0, "creation_date": 1462328827, "post_id": 37017184, "comment_id": 61586547, "body": "All the data returns correctly. I input the Exit For because I thought the second statement might be overwriting the first.  It looks like the issue is as you noted: row by row comparison vs each value of array against all values another.  Is that an easy fix?"}, {"owner": {"reputation": 19, "user_id": 6080040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac01e56ae4ba108f636cbc0d9e8bd7b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.T.", "link": "https://stackoverflow.com/users/6080040/j-t"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1462329871, "post_id": 37017184, "comment_id": 61586812, "body": "@RonRosenfeld you are correct thank you!  The code is part of a larger stmt edited too much which altered the code inadvertently.  The output has returned but the issue still remains.  All values return the final if stmt rather than one returning &quot;completed&quot;.  I removed the Exit for but the code is still broken."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1462330590, "post_id": 37017184, "comment_id": 61586979, "body": "@J.T. I would expect that from your code.  In NO instance in your example, is Reference = Reference2, or Amount = Amount2."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462331026, "post_id": 37017184, "comment_id": 61587064, "body": "@J.T. - If you want help diagnosing a problem with the logic, perhaps describe what logic you want. As it stands, everything seems to evaluate correctly - the only thing that looks wrong is your expected results."}, {"owner": {"reputation": 19, "user_id": 6080040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac01e56ae4ba108f636cbc0d9e8bd7b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.T.", "link": "https://stackoverflow.com/users/6080040/j-t"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1462331079, "post_id": 37017184, "comment_id": 61587076, "body": "@RonRosenfeld The code was adjusted and sample data image updated.  15D456\t150.00 does indeed match but returns incorrect result.  I do want the loop to stop if the first test is passed I placed the Exit For back into the code.  The results do not change in either way however."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1462331379, "post_id": 37017184, "comment_id": 61587142, "body": "@J.T. They do not match <b>in the same row</b> which is how you are doing the comparison."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1462331457, "post_id": 37017184, "comment_id": 61587159, "body": "You will need at least one more loop, or Find, or worksheetfunction.Match to do what you want."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462332807, "post_id": 37017184, "comment_id": 61587461, "body": "@J.T. - OK, finally think your expected logic is clear. You want to search ALL of Reference for occurrences of Reference2 - where that is found,  determine if the Amount criteria is satisfied. Scott&#39;s right - you need another loop."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462333581, "post_id": 37017184, "comment_id": 61587655, "body": "@J.T. - I think you want the second row to come back as &quot;Working&quot;, not &quot;Completed&quot;. If you want &quot;Completed&quot;, can you explain why?"}, {"owner": {"reputation": 19, "user_id": 6080040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac01e56ae4ba108f636cbc0d9e8bd7b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.T.", "link": "https://stackoverflow.com/users/6080040/j-t"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462334918, "post_id": 37017184, "comment_id": 61587992, "body": "@OldUgly The image has been updated.  You have the logic correct; if E2 (Reference2) matches to A2:A5 (Reference) and F2 (Amount2) matches corresponding B2:B5 (Amount) then corresponding C2:C5 (Action) would input into G2 (Action2).  The code sample and image were poorly edited after hours of troubleshooting so that is my error.  The coding I&#39;ve done so far is cobbled together from researching so I&#39;ll need more research to see how to nest loops as the simple way I know isn&#39;t working either.  I appreciate all the help in diagnosing the logic!"}], "answers": [{"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 1, "last_activity_date": 1462335569, "creation_date": 1462335569, "answer_id": 37018383, "question_id": 37017184, "link": "https://stackoverflow.com/questions/37017184/vba-if-and-multiple-conditions/37018383#37018383", "title": "VBA If And multiple conditions", "body": "<p>Added an extra loop and broke up the if logic in order to get the correct (?) behavior.</p>\n\n<p>I get these results ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/v3TvT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v3TvT.png\" alt=\"enter image description here\"></a></p>\n\n<p>... from this code ...</p>\n\n<pre><code>Sub test()\nDim i As Integer, j As Integer, lastrow As Long\nDim col1 As Range, col2 As Range, col3 As Range, col4 As Range, col5 As Range, col6 As Range\nDim c1arr, c2arr, c3arr, c4arr, c5arr, c6arr As Variant\n\n    Set col1 = ActiveSheet.Cells.Find(\"Reference\", , xlValues, xlWhole)\n    Set col2 = ActiveSheet.Cells.Find(\"Amount\", , xlValues, xlWhole)\n    Set col3 = ActiveSheet.Cells.Find(\"Action\", , xlValues, xlWhole)\n    Set col4 = ActiveSheet.Cells.Find(\"Reference2\", , xlValues, xlWhole)\n    Set col5 = ActiveSheet.Cells.Find(\"Amount2\", , xlValues, xlWhole)\n    Set col6 = ActiveSheet.Cells.Find(\"Action2\", , xlValues, xlWhole)\n\n    lastrow = Cells(Rows.Count, col1.Column).End(xlUp).Row\n\n    c1arr = Range(Cells(2, col1.Column), Cells(lastrow, col1.Column)).Value\n    c2arr = Range(Cells(2, col2.Column), Cells(lastrow, col2.Column)).Value\n    c3arr = Range(Cells(2, col3.Column), Cells(lastrow, col3.Column)).Value\n\n    lastrow = Cells(Rows.Count, col4.Column).End(xlUp).Row\n\n    c4arr = Range(Cells(2, col4.Column), Cells(lastrow, col4.Column)).Value\n    c5arr = Range(Cells(2, col5.Column), Cells(lastrow, col5.Column)).Value\n    c6arr = Range(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value\n\n    For i = 1 To UBound(c4arr)\n        If c6arr(i, 1) = \"\" Then ' if already determined an answer, don't try again\n            For j = 1 To UBound(c1arr)\n                If c1arr(j, 1) = c4arr(i, 1) Then ' found Reference2 within Reference\n                    If c2arr(j, 1) = c5arr(i, 1) And c2arr(j, 1) &gt; 0 Then\n                        c6arr(i, 1) = c3arr(j, 1)\n                    Else\n                        c6arr(i, 1) = \"Manual Review\"\n                    End If\n                End If\n            Next j\n        End If\n        If c6arr(i, 1) = \"\" Then ' if haven't found an answer yet, it needs review\n            c6arr(i, 1) = \"Manual Review\"\n        End If\n    Next i\n\n    Range(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value = c6arr\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1462441840, "last_edit_date": 1462441840, "creation_date": 1462390023, "answer_id": 37036367, "question_id": 37017184, "link": "https://stackoverflow.com/questions/37017184/vba-if-and-multiple-conditions/37036367#37036367", "title": "VBA If And multiple conditions", "body": "<p>It is not clear to me, from your code and your example, when you want to see \"Manual Review\" in Action2.  Obviously, if References match but Amounts do not; but since that does not encompass all of the possibilities, that part of the code is a bit \"sloppy\".  In the code below, all instances where there is no match will be marked \"Manual Review\".  If that is truly the case, then the code could be made a bit cleaner (and faster).</p>\n\n<p>Here's another way of doing this, using <code>WorksheetFunction.Match</code>.</p>\n\n<pre><code>Option Explicit\n   Sub test()\nDim i As Integer, lastrow As Long, J As Long\nDim col1 As Range, col2 As Range, col3 As Range, col4 As Range, col5 As Range, col6 As Range\nDim c1arr, c2arr, c3arr, c4arr, c5arr, c6arr As Variant\n\n\nSet col1 = ActiveSheet.Cells.Find(\"Reference\", , xlValues, xlWhole)\nSet col2 = ActiveSheet.Cells.Find(\"Amount\", , xlValues, xlWhole)\nSet col3 = ActiveSheet.Cells.Find(\"Action\", , xlValues, xlWhole)\nSet col4 = ActiveSheet.Cells.Find(\"Reference2\", , xlValues, xlWhole)\nSet col5 = ActiveSheet.Cells.Find(\"Amount2\", , xlValues, xlWhole)\nSet col6 = ActiveSheet.Cells.Find(\"Action2\", , xlValues, xlWhole)\n\nlastrow = Cells(Rows.Count, col1.Column).End(xlUp).Row\n\nc1arr = Range(Cells(2, col1.Column), Cells(lastrow, col1.Column)).Value\nc2arr = Range(Cells(2, col2.Column), Cells(lastrow, col2.Column)).Value\nc3arr = Range(Cells(2, col3.Column), Cells(lastrow, col3.Column)).Value\nc4arr = Range(Cells(2, col4.Column), Cells(lastrow, col4.Column)).Value\nc5arr = Range(Cells(2, col5.Column), Cells(lastrow, col5.Column)).Value\nc6arr = Range(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value\n\n'Clear c6arr\nReDim c6arr(1 To UBound(c6arr, 1), 1 To 1)\n\nFor i = 1 To UBound(c1arr)\n    If c2arr(i, 1) &gt; 0 Then\n        On Error Resume Next\n            J = WorksheetFunction.Match(c1arr(i, 1), c4arr, 0)\n            If Err.Number = 0 Then\n                If c2arr(i, 1) = c5arr(J, 1) Then\n                    c6arr(J, 1) = c3arr(i, 1)\n                Else\n                    c6arr(J, 1) = \"Manual Review\"\n                End If\n            End If\n        On Error GoTo 0\n    End If\nNext i\n\n'Fill the blanks\nFor i = 1 To UBound(c6arr, 1)\n    If c6arr(i, 1) = \"\" Then c6arr(i, 1) = \"Manual Review\"\nNext i\n\nRange(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value = c6arr\nEnd Sub\n</code></pre>\n\n<p>These are the results using your most recently posted image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TYjMo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TYjMo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 19, "user_id": 6080040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac01e56ae4ba108f636cbc0d9e8bd7b6?s=128&d=identicon&r=PG&f=1", "display_name": "J.T.", "link": "https://stackoverflow.com/users/6080040/j-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4153, "favorite_count": 0, "accepted_answer_id": 37018383, "answer_count": 2, "score": 0, "last_activity_date": 1462441840, "creation_date": 1462327135, "last_edit_date": 1462335049, "question_id": 37017184, "link": "https://stackoverflow.com/questions/37017184/vba-if-and-multiple-conditions", "title": "VBA If And multiple conditions", "body": "<p>Could anyone help troubleshoot my coding?  The If statement requires three separate conditions = true or it checks the next if statement and loop back for the all cells the array.  There is no error so its difficult to determine the issue, plus I'm very new to VBA so there is probably a better way to accomplish this.</p>\n\n<p><em>Note: The cells needed in the arrays are not static hence the Find.</em> </p>\n\n<pre><code>    Sub test()\nDim i As Integer\nDim col1 As Range, col2 As Range, col3 As Range, col4 As Range, col5 As Range, col6 As Range\nDim c1arr, c2arr, c3arr, c4arr, c5arr, c6arr As Variant\n\nSet col1 = ActiveSheet.Cells.find(\"Reference\", , xlValues, xlWhole)\nSet col2 = ActiveSheet.Cells.find(\"Amount\", , xlValues, xlWhole)\nSet col3 = ActiveSheet.Cells.find(\"Action\", , xlValues, xlWhole)\nSet col4 = ActiveSheet.Cells.find(\"Reference2\", , xlValues, xlWhole)\nSet col5 = ActiveSheet.Cells.find(\"Amount2\", , xlValues, xlWhole)\nSet col6 = ActiveSheet.Cells.find(\"Action2\", , xlValues, xlWhole)\n\nlastrow = Cells(Rows.Count, col1.Column).End(xlUp).Row\n\nc1arr = Range(Cells(2, col1.Column), Cells(lastrow, col1.Column)).Value\nc2arr = Range(Cells(2, col2.Column), Cells(lastrow, col2.Column)).Value\nc3arr = Range(Cells(2, col3.Column), Cells(lastrow, col3.Column)).Value\nc4arr = Range(Cells(2, col4.Column), Cells(lastrow, col4.Column)).Value\nc5arr = Range(Cells(2, col5.Column), Cells(lastrow, col5.Column)).Value\nc6arr = Range(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value\n\nFor i = 1 To UBound(c1arr)\n    If c2arr(i, 1) &gt; 0 And c1arr(i, 1) = c4arr(i, 1) And c2arr(i, 1) = c5arr(i, 1) Then\n            c6arr(i, 1) = c3arr(i, 1)\n    ElseIf c2arr(i, 1) &gt; 0 And c1arr(i, 1) &lt;&gt; c4arr(i, 1) And c2arr(i, 1) &lt;&gt; c5arr(i, 1) Then\n            c6arr(i, 1) = \"Manual Review\"\n    End If\nNext\n\nRange(Cells(2, col6.Column), Cells(lastrow, col6.Column)).Value = c6arr\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/668tK.jpg\" rel=\"nofollow\">UPDATED IMAGE</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462327043, "post_id": 37017084, "comment_id": 61586165, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1462326310, "creation_date": 1462326310, "answer_id": 37017084, "question_id": 37016791, "link": "https://stackoverflow.com/questions/37016791/dynamic-input-for-same-chart-updating/37017084#37017084", "title": "Dynamic Input for same chart updating", "body": "<p>To add a discontinuous range from the active sheet use</p>\n\n<pre><code>.SeriesCollection(1).XValues = Application.Union(Cells(5, 4), Cells(5, 6), Cells(5, 8), Cells(5, 10), Cells(5, 12))\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37017084, "answer_count": 1, "score": 0, "last_activity_date": 1462326310, "creation_date": 1462323934, "last_edit_date": 1531164843, "question_id": 37016791, "link": "https://stackoverflow.com/questions/37016791/dynamic-input-for-same-chart-updating", "title": "Dynamic Input for same chart updating", "body": "<p>I am trying to create a chart that will update its values automatically as time goes. The Y values of the data are constant while the X values are changing with time. My data is as follows:</p>\n\n<pre><code>               Y data = 1    1.5     2    2.5      3\nAt time = 0    X data = 10   10     10    10       10\nAt time = 0.5  X data = 20   20     20    20       20\nAt time = 1.0  X data = 30   30     30    30       30\nAt time = 1.5  X data = 40   40     40    40       40\n</code></pre>\n\n<p><strong>*NOTE MY X DATA ARE NOT CONSECUTIVE, THEY ARE IN 5 COLUMNS AS SHOWN ABOVE BUT NOT CONSECUTIVE COLUMNS.</strong></p>\n\n<p>This is what I have reached until now</p>\n\n<pre><code>Sub UpdateChart()\n    Dim ChtObj As ChartObject\n    Dim BM1 As Range, BM2 As Range, BM3 As Range, BM4 As Range, BM5 As Range\n\nSet ChtObj = ActiveSheet.ChartObjects.Add(200, 150, 500, 500)\n\n'Creating intial graph\nWith ChtObj.Chart\n    'Chart Type\n    .ChartType = xlXYScatterSmooth\n\n    'Datainput\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"Bending moment\"\n    .SeriesCollection(1).Values = Range(\"D3:H3\")\n    ''How to do this .SeriesCollection(1).XValues = Range((Cells(5, 4), Cells(5, 6), Cells(5, 8), Cells(5, 10), Cells(5, 12))\n    .HasLegend = False\n\n    'Title\n    .HasTitle = True\n    .ChartTitle.Text = \"Bending moment along pile \" &amp; ActiveSheet.Name\n\n    'X-Axis\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Bending moment (kN.m)\"\n    'Y-Axis\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Length along pile (m)\"\n\nEnd With\n\n'Loopingthrough data to be done**\n\nEnd Sub\n</code></pre>\n\n<p>How can I enter the X data using Cells() function so I can incorporate that into the loop? \nYour help is greatly appreciated!</p>\n\n<p><strong>My X data are not in continuous</strong></p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1462321938, "post_id": 37016527, "comment_id": 61584978, "body": "In VBScript use <code>Next</code>, not <code>Next i</code>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1462321981, "post_id": 37016527, "comment_id": 61584992, "body": "In VBScript you always use <code>Next</code> rather than <code>Next i</code> or something similar. Also, VBScript can only control Excel if you create an Excel Application Object. Also -- you <i>never</i> give typenames in declarations in VBScript, since everything is variant. Really, you should find a couple of good examples of a VBScript program interacting with Excel, and make sure you understand that code before trying to modify a VBA macro to run as a VBScript program."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462323306, "post_id": 37016527, "comment_id": 61585300, "body": "@JohnColeman Thank you very much! I took your recommendation and found a couple of great starting points. Much appreciated."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": false, "score": 0, "last_activity_date": 1462322129, "creation_date": 1462322129, "answer_id": 37016581, "question_id": 37016527, "link": "https://stackoverflow.com/questions/37016527/800a0401-vbs-error/37016581#37016581", "title": "800A0401 vbs error", "body": "<p><code>Next</code> closes a <code>for</code> loop. But you don't have any for loops. Delete both lines with <code>next</code> on them.</p>\n\n<p>EG As before you can't declare anything except as variant which is done by omitting the <code>as type</code>. You just don't think about type.</p>\n\n<pre><code>Public Function ZeroToBlank(x)\n    If x = \"0\" Then\n        ZeroToBlank = \"\"\n    Else\n        ZeroToBlank = x\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462322129, "creation_date": 1462321612, "last_edit_date": 1531161705, "question_id": 37016527, "link": "https://stackoverflow.com/questions/37016527/800a0401-vbs-error", "title": "800A0401 vbs error", "body": "<p>I copied my excel vb code into a vbs and I know there are semantic/logic differences, would really appreciate some guidance. I'm getting the error above for \"<strong>Next i</strong>\" (line 44) - which is essentially an integer.</p>\n\n<pre><code>Set xlBook = GetObject(\"C:\\Users\\midi\\Desktop\\IT\\E\\PRF.xlsm\")\n   For each wsheet in xlbook.worksheets\n   msgbox wsheet.name\n\nnext\n\nSub RefreshConns()\n    ' Refreshes the connections according to the specified cells\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\nSheets(\"Run Macro\").Activate\nDim connName \nDim connStr \nDim sqltext ' SQL text\n\nDim TempconnName \nDim TempconnStr \nDim Tempsqltext ' temporary SQL text\nDim i \nDim SiteName \n\nSiteName = ActiveSheet.Cells(1, 2)\n'MsgBox (SiteName)\nFor i = 5 To 11\nconnName = ActiveSheet.Cells(i, 1).Value\nconnStr = ActiveSheet.Cells(i, 2).Value\nsqltext = ActiveSheet.Cells(i, 4).Value\n'MsgBox (connName)\n\nTempconnStr = Replace(connStr, \"SiteNameVBA\", SiteName)\n'Debug.Print (ActiveWorkbook.Connections(connName).ODBCConnection.Connection)\n'MsgBox (TempconnStr)\n'Tempsqltext = Replace(sqltext, \"SiteNameVBA\", SiteName)\n\n'On Error Resume Next\nActiveWorkbook.Connections(connName).ODBCConnection.CommandText = sqltext\nActiveWorkbook.Connections(connName).ODBCConnection.Connection = \"ODBC;\" &amp; TempconnStr\nActiveWorkbook.Connections(connName).Refresh\n\nNext i\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n\nPublic Function ZeroToBlank(x String) String\nIf x = \"0\" Then\n    ZeroToBlank = \"\"\nElse\n    ZeroToBlank = x\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1462316171, "post_id": 37015713, "comment_id": 61583469, "body": "Do the same thing you did with <code>wb</code>: <code>Set Book2 = workbooks.open</code>"}, {"owner": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 0, "creation_date": 1462317479, "post_id": 37015713, "comment_id": 61583840, "body": "I think you&#39;re missing the extension, for example the .xlsx in &quot;InfoPedia Page Views (ASG Compete).xlsx&quot;"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462318028, "post_id": 37015713, "comment_id": 61583989, "body": "You are opening the workbook in the instance of Excel <code>xl</code> that you created, so you should use <code>Set Book2 = xl.workbooks(&quot;...</code>.  That said, why do you need another reference to the workbook when you already have <code>wb</code>?  And why are you creating another instance of Excel, nothing in your code suggests a need to do this?"}, {"owner": {"reputation": 21, "user_id": 6288135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156882298780500/picture?type=large", "display_name": "Garret Zhang", "link": "https://stackoverflow.com/users/6288135/garret-zhang"}, "edited": false, "score": 0, "creation_date": 1462383124, "post_id": 37015713, "comment_id": 61618774, "body": "Well, I found a macro online where I would be able to go through each spreadsheet within a folder to refresh without fully understand how it works. I am just trying to build on top of what I found... which is why I am having trouble with this... The original macro was just to open the spreadsheet and refresh it. What I want is to open the spreadsheet, refresh, and use vlookup to export that data. I thought the way to do that is to set book2 of the opened spreadsheet, so when I do the vlookup through VBA, I can reference where the search range is from... I hope this make sense! Thanks everyone!"}, {"owner": {"reputation": 21, "user_id": 6288135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156882298780500/picture?type=large", "display_name": "Garret Zhang", "link": "https://stackoverflow.com/users/6288135/garret-zhang"}, "edited": false, "score": 0, "creation_date": 1462383517, "post_id": 37015713, "comment_id": 61618991, "body": "If I understand correctly Chris, is that wb is already another instance of Excel, when setting book2, I am actually setting a third one, which I don&#39;t need to since wb is what I should be useing for the second workbook. I changed my formula to remove the Book2, and replaced it with just wb...         Set SearchRange = wb.Sheets(&quot;Page Views Sorted Most to Least&quot;).Range(&quot;B:D&quot;)             ActiveWorkbook.Sheets(&quot;Reference&quot;).Cells(1, 4).Value = .VLookup(ThisWorkbook.Sheets(&quot;reference&quot;).Range(&quot;B1&quot;), SearchRange, 3, False)  The set part went through fine, but I am getting stuck on vlookup now... @.@"}, {"owner": {"reputation": 21, "user_id": 6288135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156882298780500/picture?type=large", "display_name": "Garret Zhang", "link": "https://stackoverflow.com/users/6288135/garret-zhang"}, "edited": false, "score": 0, "creation_date": 1462383918, "post_id": 37015713, "comment_id": 61619260, "body": "IT WORKED!! seems like my vlookup was looking at a value that didn&#39;t exist. Thank you so much for your explaining Chris, you helped me figured this out!! :D"}], "owner": {"reputation": 21, "user_id": 6288135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156882298780500/picture?type=large", "display_name": "Garret Zhang", "link": "https://stackoverflow.com/users/6288135/garret-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462353325, "creation_date": 1462315981, "last_edit_date": 1462353325, "question_id": 37015713, "link": "https://stackoverflow.com/questions/37015713/unable-to-set-workbook", "title": "Unable to Set workbook", "body": "<p>I have being doing research on why I am unable to set my workbook for the past couple of hours. What I am trying to do is go through each spreadsheet within a folder to refresh the data and import them using <code>Vlookup</code> at the <code>Set Book2 = workbooks(\"InfoPedia Page Views (ASG Compete)\")</code> is when I am getting an error </p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range</p>\n</blockquote>\n\n<p>Please, if anyone can tell why my code isn't working, I would really appreciated it.</p>\n\n<pre><code>enter code here\nSub Test()\n\nDim Book2 As Workbook\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet xl = CreateObject(\"Excel.Application\")\nxl.Visible = True\n\nFor Each f In fso.getfolder(\"C:\\Users\\v-gazhan\\Desktop\\Infopedia Quality Project\\Infopedia Quality Dashboard\\Page Views\").Files\n\n\n  If LCase(fso.GetextensionName(f.Name)) = \"xlsx\" Then\n\n    Set wb = xl.workbooks.Open(f.Path)\n\n    '   Set the correct month\n    wb.SlicerCaches(\"Slicer_Month_Name\").VisibleSlicerItemsList = Array _\n        ( _\n        \"[Time].[Month Name].&amp;[10]\")\n\n    With Application.WorksheetFunction\n\n    If fso.getbasename(f.Name) = \"InfoPedia Page Views (ASG Compete)\" Then\n\n        ***Set Book2 = workbooks(\"InfoPedia Page Views (ASG Compete)\")***\n\n        Set SearchRange = Book2.Sheets(\"Page Views Sorted Most to Least\").Range(\"B:D\")\n\n        ActiveWorkbook.Sheets(\"Reference\").Cells(1, 4).Value = .VLookup(Sheets(\"reference\").Range(\"B1\"), SearchRange, 3, False)\n\n    End If\n\n    End With\n\n    wb.Close\n\n  End If\n\nNext\n\nxl.Qu    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "batch-file"], "comments": [{"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 2, "creation_date": 1462315664, "post_id": 37015428, "comment_id": 61583343, "body": "Hard to say without seeing your vbs code."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1462315908, "post_id": 37015428, "comment_id": 61583404, "body": "that&#39;s fair, updating now to include my vbs!"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "edited": false, "score": 0, "creation_date": 1462321237, "post_id": 37016056, "comment_id": 61584822, "body": "I tried this method as well and it was successful as well! Thank you,"}], "tags": [], "owner": {"reputation": 23, "user_id": 6279498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f6b09feab090b7d217c0b1de12d837?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Massucci", "link": "https://stackoverflow.com/users/6279498/carlos-massucci"}, "is_accepted": false, "score": 2, "last_activity_date": 1462319789, "last_edit_date": 1462319789, "creation_date": 1462318365, "answer_id": 37016056, "question_id": 37015428, "link": "https://stackoverflow.com/questions/37015428/execute-vbs-from-a-batch-for-a-specific-workbook/37016056#37016056", "title": "Execute .vbs from a batch for a specific workbook", "body": "<p>One way is to declare a <strong>system</strong> environment variable using <code>setx</code>.\nRunning your batch with administration privilege try this:</p>\n\n<pre><code>setx PATHFILE \"/path/file.xls\" /M\n</code></pre>\n\n<p>Check if is declared:</p>\n\n<pre><code>set | find \"PATHFILE\"\n</code></pre>\n\n<p>And read it with the function <code>Environ()</code> to open you Workbook in your vbs:</p>\n\n<pre><code>Workbooks.Open Environ(\"PATHFILE\") \n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>You do not need to use system environment variable (<code>/m</code> argument) as you can use only user environment. You need to just remember that the programs need to restart to read the user and system environment variable.</p>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "edited": false, "score": 0, "creation_date": 1462319573, "post_id": 37016076, "comment_id": 61584432, "body": "so for instance, instead of: &quot;Dim connName as String &#39; connection name&quot; it would be &quot;Dim connName  String &#39; connection Name&quot;? Apologies for the confusion here, I&#39;ve never had to work directly on vbs before."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "reply_to_user": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "edited": false, "score": 1, "creation_date": 1462320104, "post_id": 37016076, "comment_id": 61584564, "body": "No, just <code>dim connName</code> (which implies <code>as variant</code> in vbs and excel&#39;s vba). Excel&#39;s VBA also supports this style of programming (<code>as string</code> is optional in excel). So VBScript can be pasted into excel but usually not the other way round."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "edited": false, "score": 0, "creation_date": 1462321208, "post_id": 37016076, "comment_id": 61584817, "body": "thank you! I have another error in the vbs code but will post it in another question for proper documentation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": true, "score": 1, "last_activity_date": 1462319807, "last_edit_date": 1462319807, "creation_date": 1462318506, "answer_id": 37016076, "question_id": 37015428, "link": "https://stackoverflow.com/questions/37015428/execute-vbs-from-a-batch-for-a-specific-workbook/37016076#37016076", "title": "Execute .vbs from a batch for a specific workbook", "body": "<pre><code>Set xlBook = GetObject(\"C:\\Users\\User\\Documents\\Super.xls\")\nFor each wsheet in xlbook.worksheets\n    msgbox wsheet.name\nnext\n</code></pre>\n\n<p>Is how. Remember there are no excel constants in VBS, there is no <code>dim x as something</code> as vbs only does variants. so just <code>dim x</code>.</p>\n\n<p>Other ways to a running copy of excel</p>\n\n<pre><code>Set GetExcelApp = GetObject(\"\", \"Excel.Application\")\nMsgbox GetExcelApp\n</code></pre>\n\n<p>To start a new excel and showing an excel constant replaced by it's value (43).</p>\n\n<pre><code>set xlapp = createobject(\"Excel.Application\")\nxlapp.Workbooks.Open \"C:\\Users\\User\\Documents\\Super.xls\"\n'43 is 95/97 look up xlExcel9795 in object browser to see other options\nxlapp.ActiveWorkbook.SaveAs \"C:\\Users\\User\\Documents\\Super.xls\", 43\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37016076, "answer_count": 2, "score": 0, "last_activity_date": 1462319807, "creation_date": 1462314342, "last_edit_date": 1462316012, "question_id": 37015428, "link": "https://stackoverflow.com/questions/37015428/execute-vbs-from-a-batch-for-a-specific-workbook", "title": "Execute .vbs from a batch for a specific workbook", "body": "<p>I have a .bat file and I'm using it to execute a .vbs which I've pulled out of an excel workbook.</p>\n\n<p>Currently, my .bat file looks like:</p>\n\n<pre><code>echo Starting program\n\nstart C:\\Users\\midi\\Desktop\\Refresh_Data_Connection.vbs\n\necho Finish program \n</code></pre>\n\n<p>However, the issue with my .vbs file is that it doesn't reference a specific workbook which I need it to. How could I set the .vbs to alter a specific workbook stored on my desktop? Any help/feedback or push in the right direction would be really helpful, thanks in advance!</p>\n\n<p>My vbs is:</p>\n\n<pre><code>Sub RefreshConns()\n\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\nSheets(\"Run Macro\").Activate\nDim connName As String ' connection name\nDim connStr As String ' connection string\nDim sqltext ' SQL text\n\nDim TempconnName As String ' temporary connection name\nDim TempconnStr As String ' temporary connection string\nDim Tempsqltext ' temporary SQL text\nDim i As Integer\nDim SiteName As String\n\nSiteName = ActiveSheet.Cells(1, 2)\n'MsgBox (SiteName)\nFor i = 5 To 11\nconnName = ActiveSheet.Cells(i, 1).Value\nconnStr = ActiveSheet.Cells(i, 2).Value\nsqltext = ActiveSheet.Cells(i, 4).Value\n'MsgBox (connName)\n\nTempconnStr = Replace(connStr, \"SiteNameVBA\", SiteName)\n'Debug.Print (ActiveWorkbook.Connections(connName).ODBCConnection.Connection)\n'MsgBox (TempconnStr)\n'Tempsqltext = Replace(sqltext, \"SiteNameVBA\", SiteName)\n\n'On Error Resume Next\nActiveWorkbook.Connections(connName).ODBCConnection.CommandText = sqltext\nActiveWorkbook.Connections(connName).ODBCConnection.Connection = \"ODBC;\" &amp; TempconnStr\nActiveWorkbook.Connections(connName).Refresh\n\nNext i\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n\n\nPublic Function ZeroToBlank(x As String) As String\nIf x = \"0\" Then\n    ZeroToBlank = \"\"\nElse\n    ZeroToBlank = x\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1462317869, "creation_date": 1462317869, "answer_id": 37016004, "question_id": 37015386, "link": "https://stackoverflow.com/questions/37015386/word-macro-to-add-comments-to-a-document-failing-at-tables/37016004#37016004", "title": "Word Macro to Add Comments to a Document Failing at Tables", "body": "<p>You can add a check if it is a table, and then if the paragraph has cells, as follows:</p>\n\n<pre><code>    If .Paragraphs(i).Range.Tables.Count = 0 Then\n        Set cmtNewComment = .Paragraphs(i).Range.Comments.Add(.Range(.Paragraphs(i).Range.Words(1).Start, (.Paragraphs(i).Range.Words(1).End - 1)), strParaStyle)\n        cmtNewComment.Author = \" \"\n    ElseIf .Paragraphs(i).Range.Cells.Count &gt; 0 Then\n        Set cmtNewComment = .Paragraphs(i).Range.Comments.Add(.Range(.Paragraphs(i).Range.Words(1).Start, (.Paragraphs(i).Range.Words(1).End - 1)), strParaStyle)\n        cmtNewComment.Author = \" \"\n    End If\n</code></pre>\n\n<p>Note that you don't need to use the <code>Selection</code> as you never change it.</p>\n"}], "owner": {"reputation": 563, "user_id": 3493984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iI51g.jpg?s=128&g=1", "display_name": "LadyCygnus", "link": "https://stackoverflow.com/users/3493984/ladycygnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 37016004, "answer_count": 1, "score": 0, "last_activity_date": 1594050711, "creation_date": 1462314063, "last_edit_date": 1594050711, "question_id": 37015386, "link": "https://stackoverflow.com/questions/37015386/word-macro-to-add-comments-to-a-document-failing-at-tables", "title": "Word Macro to Add Comments to a Document Failing at Tables", "body": "<p>I'm writing a Microsoft Word VBA macro that runs through every paragraph of a word document and adds a comment to every paragraph. That comment contains the style for that paragraph. This way a coworker can print out the document with comments and know how to style similar documents in the future.</p>\n\n<p>I'm almost there, the code adds the comments to every paragraph, but dies at the first row of a table:</p>\n\n<blockquote>\n  <p>\"This method or property is not available because the object refers to the end of a table row.\"</p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub aa_AddStylesComment()\n'\n' aa_AddStylesComment Macro\n' Author: Me!\n'\n\nDim strParaStyle As String\nDim cmtNewComment As Comment\n\n'Run through word file and delete any comments with author set to a space character (that is the author of the comments added by the script)\nFor J = ActiveDocument.Comments.Count To 1 Step -1\n  With ActiveDocument\n    If .Comments(J).Author = \" \" Then\n      .Comments(J).Delete\n    End If\n  End With\nNext J\n\n'Running through every paragraph\nFor i = 1 To ActiveDocument.Paragraphs.Count\n  With ActiveDocument\n\n    'Get paragraph style\n    strParaStyle = .Paragraphs(i).Style\n\n    'Create a new comment and collect it - then change the author to space character\n    Set cmtNewComment = Selection.Comments.Add(.Range(.Paragraphs(i).Range.Words(1).Start, (.Paragraphs(i).Range.Words(1).End - 1)), strParaStyle)\n    cmtNewComment.Author = \" \"\n\n  End With\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1462312888, "post_id": 37015103, "comment_id": 61582379, "body": "Insert button, right click, assign macro to it?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462314032, "post_id": 37015103, "comment_id": 61582832, "body": "The setup you&#39;ve described doesn&#39;t lend itself to longevity.  If this forms keeps getting used for months or years, the number of hidden sheets and the number of references to those hidden sheets will increase to an enormous number, potentially slowing down the workbook considerably, and absolutely making it very unwieldy for anyone working on the sheet, especially if it ever needs updates/changes.  Why not just have users enter their data on a new row of the Data sheet directly?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1462315439, "post_id": 37015103, "comment_id": 61583279, "body": "@tigeravatar some users will make you cry when they destroy the sheet. But you make a good point. OP should just keep <code>data</code> sheet hidden and instead have button send whatever was entered on sheet 1 onto last row+1 of <code>data</code>"}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1462318741, "post_id": 37015103, "comment_id": 61584196, "body": "It&#39;s a template workbook. It is filled out, saved, emailed, and the template is used again. I fill out the excel form with one customer&#39;s information and that file isn&#39;t used again."}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1462395724, "post_id": 37015103, "comment_id": 61625987, "body": "I found a code that some what works. How can I make this code say a sheet name only instead of it being keyed onto B6 and B7? Sub ShowHideWorksheets() Dim Cell As Range For Each Cell In Range(&quot;B6:B7&quot;)     ActiveWorkbook.Worksheets(Cell.Value).Visible = Not ActiveWorkbook.Worksheets(Cell.Value).Visible Next Cell End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1462371521, "post_id": 37020326, "comment_id": 61610895, "body": "Thank you for taking the time to fill out the response. I am the worst to explain my thoughts. What I think might be clear, is often confusing for others. I&#39;ll try to explain it better. I use Excel to fill out a form that is later emailed to another person. I plan on creating a 4th Sheet within the document that will autopopulate fields in the other three sheets. For example, I create a work order number and put it on all three sheets. My solution is to create a 4th sheet that a user can type in the information that will fill in the rest of those fields. So if I make WO12345, it is on all 3"}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1462371619, "post_id": 37020326, "comment_id": 61610995, "body": "However, once they fill in this 4th sheet, I wanted to create a button that can hide the sheet. All the information will be there, just hidden. Because once it is sent to the next person, they may be confused about this 4th sheet and could cause a work flow problem. The people filling out the 4th sheet aren&#39;t excel savvy and right click and hide sheet is too much...... So a solution was the button that could hide it once they filled it in."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1462344189, "creation_date": 1462344189, "answer_id": 37020326, "question_id": 37015103, "link": "https://stackoverflow.com/questions/37015103/how-do-i-hide-a-sheet-with-a-button-in-excel/37020326#37020326", "title": "How do I hide a sheet with a button in Excel?", "body": "<p>It's actually not very clear to me what's your exact goal</p>\n\n<p>for instance, assuming \"Sheet 2\" and \"Sheet2\" would point to the same sheet, in your question you seem to reference it as being both a \"Form\" sheet (<em>\"...sheet 1 has a form to fill out....<strong>Sheet 2</strong> and 3 also have the same fields...\"</em>) and \"Data\" sheet (<code>Worksheets(\"Sheet2\").Visible = False</code>)</p>\n\n<p>so here follow some <em>possible</em> solutions:</p>\n\n<p>1) you want to hide \"Data\" sheet before closing the workbook it's contained in</p>\n\n<p>then place the following code in \"ThisWorkbook\" code pane of the workbook containing \"Data\" sheet</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    ThisWorkbook.Worksheets(\"Data\").Visible = False\nEnd Sub\n</code></pre>\n\n<p>2) you want to hide \"Data\" sheet once some cells have been filled up in ANY sheet other than \"Data\"</p>\n\n<p>then place the following code in \"ThisWorkbook\" code pane of the workbook containing \"Data\" sheet</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    If Sh.Name &lt;&gt; \"Data\" Then\n        With Sh\n            'here follows code to check if \"the information is added\"\n            'for instance:\n            If WorksheetFunction.CountA(.Range(\"A2:C2\")) = .Range(\"A2:C2\").Count Then ThisWorkbook.Worksheets(\"Data\").Visible = False 'check if all cells in range \"A2\" to \"C2\" has been filled with some data\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>3) you want to hide \"Data\" sheet once some cells have been filled up in ALL sheets other than \"Data\"</p>\n\n<p>then place the following code in \"ThisWorkbook\" code pane of the workbook containing \"Data\" sheet</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim sht As Worksheet\n    Dim hideBool As Boolean: hideBool = True 'set initial value as true\n\n    If Sh.Name &lt;&gt; \"Data\" Then\n        For Each sht In ThisWorkbook.Worksheets\n            With Sh\n                'here follows code to check if \"the information is added\"\n                'for instance:\n                hideBool = hideBool And WorksheetFunction.CountA(.Range(\"A2:C2\")) = .Range(\"A2:C2\").Count ''check if all cells in range \"A2\" to \"C2\" of current sheet has been filled with some data\n            End With\n            If Not hideBool Then Exit For\n        Next sht\n        ThisWorkbook.Worksheets(\"Data\").Visible = Not hideBool ' hide if ALL sheets met \"information is added\" condition\n    End If\nEnd Sub\n</code></pre>\n\n<p>4) otherwise give more info about the desired behavior</p>\n"}], "owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1308, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462395823, "creation_date": 1462312755, "last_edit_date": 1462395823, "question_id": 37015103, "link": "https://stackoverflow.com/questions/37015103/how-do-i-hide-a-sheet-with-a-button-in-excel", "title": "How do I hide a sheet with a button in Excel?", "body": "<p>I would like to create a button to hide the sheet. Ideally, it would hide the sheet where the button is located. </p>\n\n<p>To be simple, sheet 1 has a form to fill out. The typical name, address, phone number, etc. Sheet 2 and 3 also have the same fields that is going to be referenced to the 'Data' tab as well. On a sheet named 'Data', I will add fields that will populate simply with the = option like (=Data!...)</p>\n\n<p>However, I do not want the Data page in view once the information is added. We all know the simple right click and hide sheet. But sometimes that's too much for some people that will use this sheet and a pretty button would work better. </p>\n\n<p>I was successful using:\nModule 1</p>\n\n<pre><code>Sub SheetCommand()\nIf Worksheets(\"Sheet1\").Range(\"C2\").Value &lt;&gt; vbNullString Then\nWorksheets(\"Sheet2\").Visible = False\nElse\nWorksheets(\"Sheet2\").Visible = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Sheet1 Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address &lt;&gt; \"$C$2\" Then Exit Sub\nRun \"SheetCommand\"\nEnd Sub\n</code></pre>\n\n<p>However, I am not very VB savvy and have hit a dead end. Could someone help show me how to apply this to a button? I don't want it to reference the $C$2 field as noted on the example, but just when someone presses the button, the sheet goes away. I'm not worried about getting it back as someone can be ready to get it the old fashioned way. This would help the data entry process for this manual form so much easier.</p>\n\n<hr>\n\n<p>Edit: basically, I need help creating a vba code where I can hide the page. I'd like to create a button where once clicked, it hides that page. I showed an example of a code where I got it to work but it only works if that cell is populated. How do I make it work on button click? </p>\n\n<hr>\n\n<p>I found this code that does what I need but I would like to tell it a specific Sheet Name instead of having to type it in B6 and B7. </p>\n\n<pre><code>Sub ShowHideWorksheets()\nDim Cell As Range\nFor Each Cell In Range(\"B6:B7\")\nActiveWorkbook.Worksheets(Cell.Value).Visible = Not\nActiveWorkbook.Worksheets(Cell.Value).Visible\nNext Cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "mshtml"], "answers": [{"comments": [{"owner": {"reputation": 224, "user_id": 598477, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/uW2Bk.png?s=128&g=1", "display_name": "Big Dude", "link": "https://stackoverflow.com/users/598477/big-dude"}, "edited": false, "score": 0, "creation_date": 1576493065, "post_id": 46933216, "comment_id": 104904721, "body": "Did this solve your problem? If so, may you mark my answer as the correct one? Thx :)"}], "tags": [], "owner": {"reputation": 224, "user_id": 598477, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/uW2Bk.png?s=128&g=1", "display_name": "Big Dude", "link": "https://stackoverflow.com/users/598477/big-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1508936548, "creation_date": 1508936548, "answer_id": 46933216, "question_id": 37014913, "link": "https://stackoverflow.com/questions/37014913/htmlbody-workaround-for-olappointment-object/46933216#46933216", "title": "HTMLBody Workaround For OlAppointment Object?", "body": "<p>I don't know if this is much of a help but I had issues with not being able to insert a range from my Excel file (e.g. a table) to an Appointment. You are right, if this were an E-Mail object there would be the possibility to use the .HTMLBody property.</p>\n\n<p>Since this is an appointment you have \"copy &amp; paste\" your previously selected range into your appointment.</p>\n\n<p>This is what worked for me:</p>\n\n<pre><code>Sub MakeApptWithRangeBody()\n\nDim olApp As Outlook.Application\nDim olApt As Outlook.AppointmentItem\n\nConst wdPASTERTF As Long = 1\n\nSet olApp = Outlook.Application\nSet olApt = olApp.CreateItem(olAppointmentItem)\n\nWith olApt\n    .Start = Now + 1\n    .End = Now + 1.2\n    .Subject = \"Test Appointment\"\n    Sheet1.ListObjects(1).Range.Copy\n    .Display\n    .GetInspector.WordEditor.Windows(1).Selection.PasteAndFormat wdPASTERTF\nEnd With\n\nEnd Sub\n</code></pre>\n\n<h1>How does it work?</h1>\n\n<blockquote>\n  <p>Unlike email, the AppointmentItem does not have an HTMLBody property.\n  If it did, then I would convert the range to HTML and use that\n  property. Formatted text in the body of an AppointmentItem is Rich\n  Text Format (RTF). I don\u2019t know of any good ways to convert a range to\n  RTF. Sure, you could learn what all the RTF codes are and build the\n  string to put into the RTFBody property of the AppointmentItem. Then\n  you could go to the dentist for a no-novocaine root canal. I\u2019m not\n  sure which of those would be more fun. </p>\n</blockquote>\n\n<p>He is right, I tried to work with the RTF syntax which is horrible.</p>\n\n<blockquote>\n  <p>A better way is to programmatically copy the range and paste it into\n  the body of the appointment. Since Office 2007, almost every Outlook\n  object allows you to compose in Word. That\u2019s an option I quickly turn\n  off, but it\u2019s still there under the hood. We\u2019ll use that to our\n  advantage.</p>\n</blockquote>\n\n<p>Please see the original source for more details: <a href=\"http://dailydoseofexcel.com/archives/2015/01/21/inserting-a-range-into-an-outlook-appointment/\" rel=\"nofollow noreferrer\">Inserting a Range into an Outlook Appointment</a></p>\n\n<p>Hope that helps you somehow.</p>\n"}], "owner": {"reputation": 57, "user_id": 6287770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28e6337aeeaea1ff59355652d7251f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6287770/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1508936548, "creation_date": 1462311921, "question_id": 37014913, "link": "https://stackoverflow.com/questions/37014913/htmlbody-workaround-for-olappointment-object", "title": "HTMLBody Workaround For OlAppointment Object?", "body": "<p>I am working on a project that links outlook meetings and appointments from an Outlook calendar to a formatted Excel spreadsheet. I am able to pull the outlook appointments/meetings without issue using VBA. That being said, when the events are pulled some of the content from the body will not export to Excel, specifically an embedded Excel worksheet object. My goal is to link the embedded Excel sheet to a stand-alone Excel file, which will serve as a dashboard. </p>\n\n<p>The code I have thus far is able to pull the sender, appointment date, and the body message of the Outlook invite.  The issue is that I cannot seem to get the embedded Excel sheet to export to Excel. If this were in an email, I know I could use the .HTMLBody property and pull the data that has been tagged as a table.  However, since I'm working with olAppointmentItems and not MailItems, so I think the HTMLBody property isn't an option. </p>\n\n<p>I am hoping someone can point me in the direction of a workaround that will enable me to pull the embedded worksheet object in outlook.  The relevant parts of the code I'm running is below, and I receive an error message indicating that the olAppointments Object doesn\u2019t support the .HTMLBody property. The variables in the Call in the Public Sub are named cells in the Excel Sheet the macro is in.</p>\n\n<p>Any suggestions would be greatly appreciated. Thanks!</p>\n\n<pre><code>Public Sub ExtractAppointments_ForPublic()\nWith Worksheets(\"Calendar\")\n    Call GetCalData(.Range(\"dtFrom\").Value, .Range(\"dtTo\").Value)\nEnd With\nEnd Sub\n\nPrivate Sub GetCalData(StartDate As Date, Optional EndDate As Date)\n'Source:  http://www.codeforexcelandoutlook.com/blog/2008/08/extract-calendar-data-from-outlook-into-excel/\n' -------------------------------------------------\n' Notes:\n' If Outlook is not open, it still works, but much slower (~8 secs vs. 2 secs w/ Outlook open).\n' Make sure to reference the Outlook object library before running the code\n' End Date is optional, if you want to pull from only one day, use: Call GetCalData(\"7/14/2008\")\n' -------------------------------------------------\n\nDim olApp As Object\nDim olNS As Object\nDim objRecipient As Object\nDim myCalItems As Object\nDim ItemstoCheck As Object\nDim ThisAppt As Object\nDim MyItem As Object\nDim StringToCheck As String\nDim MyBook As Excel.Workbook\nDim rngStart As Excel.Range\nDim strTable As String\nDim strSharedMailboxName As String\nDim i As Long\nDim NextRow As Long\nDim wsTarget As Worksheet\n\nSet MyBook = Excel.ThisWorkbook\n\n'&lt;------------------------------------------------------------------\n'Set names of worksheets, tables and mailboxes here!\nSet wsTarget = MyBook.Worksheets(\"Calendar\")\nstrTable = \"tblCalendar\"\nstrSharedMailboxName = wsTarget.Range(\"mailbox\").Value\n'------------------------------------------------------------------&gt;\n\nSet rngStart = wsTarget.Range(strTable).Cells(1, 1)\n\n'Clear out previous data\nWith wsTarget.Range(strTable)\n    If .Rows.Count &gt; 1 Then .Rows.Delete\nEnd With\n\n' if no end date was specified, then the requestor only wants one day, so set EndDate = StartDate\n' this will let us return appts from multiple dates, if the requestor does in fact set an appropriate end date\nIf EndDate = \"12:00:00 AM\" Then\n    EndDate = StartDate\nEnd If\n\nIf EndDate &lt; StartDate Then\n    MsgBox \"Those dates seem switched, please check them and try again.\", vbInformation\n    GoTo ExitProc\nEnd If\n\nIf EndDate - StartDate &gt; 28 Then\n    ' ask if the requestor wants so much info\n    If MsgBox(\"This could take some time. Continue anyway?\", vbInformation + vbYesNo) = vbNo Then\n        GoTo ExitProc\n    End If\nEnd If\n\n' get or create Outlook object and make sure it exists before continuing\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &lt;&gt; 0 Then\n    Set olApp = CreateObject(\"Outlook.Application\")\nEnd If\nOn Error GoTo 0\nIf olApp Is Nothing Then\n    MsgBox \"Cannot start Outlook.\", vbExclamation\n    GoTo ExitProc\nEnd If\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\n\n' link to shared calendar\nSet objRecipient = olNS.CreateRecipient(strSharedMailboxName)\nobjRecipient.Resolve\nSet myCalItems = olNS.GetSharedDefaultFolder(objRecipient, 9).Items '9=olFolderCalendar\n\nWith myCalItems\n    .Sort \"[Start]\", False\n    .IncludeRecurrences = True\nEnd With\n\nStringToCheck = \"[Start] &gt;= \" &amp; Chr(34) &amp; StartDate &amp; \" 12:00 AM\" &amp; Chr(34) &amp; \" AND [End] &lt;= \" &amp; _\n                Chr(34) &amp; EndDate &amp; \" 11:59 PM\" &amp; Chr(34)\n\nSet ItemstoCheck = myCalItems.Restrict(StringToCheck)\n\nIf ItemstoCheck.Count &gt; 0 Then\n    ' we found at least one appt\n    ' check if there are actually any items in the collection, otherwise exit\n    If ItemstoCheck.Item(1) Is Nothing Then GoTo ExitProc\n\n    For Each MyItem In ItemstoCheck\n        If MyItem.Class = 26 Then ' 26=olAppointment. See https://msdn.microsoft.com/en-us/library/office/ff863329.aspx\n            ' MyItem is the appointment or meeting item we want,\n            ' set obj reference to it\n\n            Set ThisAppt = MyItem\n\n            ' see https://msdn.microsoft.com/en-us/library/office/dn320241.aspx for documentation\n\n            With rngStart\n\n                    .Offset(NextRow, 0).Value = ThisAppt.Subject\n                    .Offset(NextRow, 1).Value = ThisAppt.Organizer\n                    .Offset(NextRow, 2).Value = Format(ThisAppt.Start, \"MM/DD/YYYY\")\n                    .Offset(NextRow, 3).Value = ThisAppt.Body\n\n                    'I need something here that will let me access the table in the \n                    'Outlook invite. See the Function I below as what I was thinking before I came across the issue above.                                             \n\n                NextRow = wsTarget.Range(strTable).Rows.Count\n\n            End With\n        End If\n    Next MyItem\n\nElse\n    MsgBox \"There are no appointments or meetings during\" &amp; _\n           \"the time you specified. Exiting now.\", vbCritical\nEnd If\n\nExitProc:\nSet myCalItems = Nothing\nSet ItemstoCheck = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\nSet rngStart = Nothing\nSet ThisAppt = Nothing\nEnd Sub\n\nFunction GetTableAsHTML(Meeting As Object, OutputLoc As Excel.Range)\n    If Meeting.Class = 26 Then '#26 is defined as olAppointment\n    Dim oHTML As MSHTML.HTMLDocument: Set oHTML = New MSHTML.HTMLDocument\n    Dim oElColl As MSHTML.IHTMLElementCollection\n    With oHTML\n        On Error GoTo 0\n        .Body = Meeting.HTMLBody\n        On Error GoTo 0\n        Set oElColl = .getElementsByTagName(\"table\")\n    End With\n\n    Dim x As Long, y As Long\n\n    For x = 0 To oElColl(0).Rows.Length - 1\n        For y = 0 To oElColl(0).Rows(x).Cells.Length - 1\n            Range(OutputLoc).Offset(x, y).Value = oElColl(0).Rows(x).Cells(y).innerText\n        Next y\n    Next x\nEnd If\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462311935, "post_id": 37014795, "comment_id": 61581989, "body": "Ranges and Cells... that is Excel, not Word. Fixed the tags accordingly."}, {"owner": {"reputation": 9, "user_id": 4991922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/668d3ec119982281607b54d965042e51?s=128&d=identicon&r=PG&f=1", "display_name": "Nihal Costa", "link": "https://stackoverflow.com/users/4991922/nihal-costa"}, "reply_to_user": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462477844, "post_id": 37014795, "comment_id": 61665182, "body": "I was looking for assistance in Word VBA. Specifically calculating time difference in a word table"}], "answers": [{"comments": [{"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462454488, "post_id": 37014989, "comment_id": 61650735, "body": "@Nihal Costa: Does this solve your problem? If so, please accept this answer."}], "tags": [], "owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1462312230, "creation_date": 1462312230, "answer_id": 37014989, "question_id": 37014795, "link": "https://stackoverflow.com/questions/37014795/calculate-time-difference-in-vba-for-word/37014989#37014989", "title": "Calculate time difference in VBA for Word", "body": "<p>Dates can be subtracted like numbers:</p>\n\n<pre><code>Sub DetermineDuration()\n    Range(\"B2\") = Range(\"D2\") - Range(\"D1\")\nEnd Sub\n</code></pre>\n\n<p>Make sure to format cell B2 as <code>Time</code> our you will just end up with a floating point number.</p>\n"}, {"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1462319462, "creation_date": 1462319462, "answer_id": 37016218, "question_id": 37014795, "link": "https://stackoverflow.com/questions/37014795/calculate-time-difference-in-vba-for-word/37016218#37016218", "title": "Calculate time difference in VBA for Word", "body": "<p>You can use the <code>DateDiff</code> function to return a specific interval type, like hours, minutes or seconds, without precision. It returns a regular number, not a time value. In the <em>interval</em> parameter you have to specify a valid interval value. You can learn about the function and see the valid interval values here <a href=\"http://www.techonthenet.com/excel/formulas/datediff.php\" rel=\"nofollow\">MS Excel: How to use the DATEDIFF Function (VBA)</a></p>\n\n<pre><code>yyyy    Year\nq   Quarter\nm   Month\ny   Day of year\nd   Day\nw   Weekday\nww  Week\nh   Hour\nn   Minute\ns   Second\n</code></pre>\n\n<p>As you can see, \"h:mm:ss\" is not a valid interval. You can use this format to get the seconds difference:</p>\n\n<pre><code>DateDiff(\"s\", Range(\"D2\"), Range(\"D1\"))\n</code></pre>\n\n<p>If you want to get a time value, you can convert using the <code>TimeSerial</code> function.</p>\n"}], "owner": {"reputation": 9, "user_id": 4991922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/668d3ec119982281607b54d965042e51?s=128&d=identicon&r=PG&f=1", "display_name": "Nihal Costa", "link": "https://stackoverflow.com/users/4991922/nihal-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1462544326, "creation_date": 1462311382, "last_edit_date": 1462544326, "question_id": 37014795, "link": "https://stackoverflow.com/questions/37014795/calculate-time-difference-in-vba-for-word", "title": "Calculate time difference in VBA for Word", "body": "<p>I would like to calculate the time difference between 2 cells and the result showing in the 3rd cell of a MS WORD TABLE.\nFor instance, cell D2 showing 2pm and D1 showing 1pm and the difference in cell B2</p>\n\n<pre><code>Sub DetermineDuration()\n    Dim dtDuration As Date\n\n    dtDuration = DateDiff(\"h:mm:ss\", D2, D1)\n    Range(\"B2\").dtDuration\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462313285, "post_id": 37014338, "comment_id": 61582512, "body": "Just because you declare a variable to be variant does not mean that it stays just that at run-time. Just test it yourself: <code>Dim varTMP As Variant</code> then set it to 20 in the next line <code>varTMP = 20</code> and finally ask what type the variable is <code>Debug.Print TypeName(varTMP)</code>. You will get the answer <code>Integer</code>. So, maybe you want to include a few more TextBoxes to check what you are comparing to one another..."}, {"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462318643, "post_id": 37014338, "comment_id": 61584170, "body": "Thanks, that&#39;s the problem. But BoundVal = CVar(Arr(i)) isn&#39;t succeeding at changing BoundVal to a variant. How else might it be done?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462387852, "post_id": 37027997, "comment_id": 61621732, "body": "Thank you, but <code>BoundVal = CLng(IIf(IsNumeric(Arr(i)), Arr(i), 0))</code> doesn&#39;t work for dates, throws a Type Mismatch error still."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462389593, "post_id": 37027997, "comment_id": 61622755, "body": "As written in my answer &quot;All dates and times in VBA are numbers&quot;. And the line <code>Arr = Split(cell.Value2, Chr(10))</code> should ensure that the array is filled with numbers only (using the <code>.Value2</code> property and <b>not</b> the <code>.Value</code> property). But if this answer doesn&#39;t help you, maybe someone else can be of help..."}, {"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462392513, "post_id": 37027997, "comment_id": 61624298, "body": ".Value2 didn&#39;t make a difference. The MsgBox TypeName() traps I have in my code tell me that Arr(j) is a String, which means <code>IsNumeric(Arr(i))</code> is returning false each time and keeping BoundVal stubbornly at 0."}, {"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462399179, "post_id": 37027997, "comment_id": 61627594, "body": "I discovered that declaring BoundVal as a Date worked as a cheat for now. Would still like to find a way to handle both dates and integers as their proper respective data types. Thanks for all the other good process stuff, I&#39;ll be putting that to use."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462399920, "post_id": 37027997, "comment_id": 61627903, "body": "If your dates are currently <code>String</code> (text) then you need to convert them to real / actual dates first: <code>MsgBox CLng(CDate(&quot;November 13, 2015&quot;))</code>. That should give you 42321 (as in 42,321 days after December 31, 1899 as noted above). Then you have dates and numbers all in one. Yet, I wouldn&#39;t do this conversion in the VBA code. Look at your sheets (the data on the sheets) and convert these &quot;text dates&quot; to actual dates. That would probably be better. Remember: dates in Excel are numbers. So, you can check if a cell contains a date by changing the number format to <code>.NumberFormat = &quot;#,##0&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462401305, "post_id": 37027997, "comment_id": 61628373, "body": "Unfortunately for that idea, I have multiple dates (and integers) in some cells. So it&#39;s all text. That&#39;s why I&#39;m using the Split function to begin with."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462481008, "post_id": 37027997, "comment_id": 61666885, "body": "I just updated the code and tried to make it work for dates and numbers alike. Since I do not have your file there is no way I could test it and the above is a pure shot in the dark. Anyway, even if it needs some tweaking you&#39;ll catch my drift and should be able to make it work. I sure hope this resolves this post and we can close it."}, {"owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "edited": false, "score": 0, "creation_date": 1462489692, "post_id": 37027997, "comment_id": 61670369, "body": "<code>CLng(IIf(IsNumeric(Arr(i)), Arr(i), CDate(Arr(i))))</code> got it working. Thanks again for the help!"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1462480897, "last_edit_date": 1462480897, "creation_date": 1462365239, "answer_id": 37027997, "question_id": 37014338, "link": "https://stackoverflow.com/questions/37014338/inequality-operators-fail-when-comparing-variants/37027997#37027997", "title": "Inequality operators fail when comparing variants", "body": "<p>You need to get away from all these <code>Variant</code> variables. This type (similar to declaring a variable as an <code>Object</code>) should be your very last resort. <code>Variant</code> can be anything and might even change in the course of the code (as shown above). So, if you are using them to compare them to something else then you might end up comparing a <code>Boolean</code> (TRUE or FALSE)  to a <code>Date</code> or a <code>String</code> or something else. VBA is there to enable you and take control! So, I'd recommend that you do just that.</p>\n\n<p>Having said that and due to the fact that we are missing some code (obviously, the above code is incomplete as makes use of some variables which are neither declared nor initialized) here are some hints on how you can improve your code and possibly get to a working result yourself:</p>\n\n<p>(1) If you want to declare multiple variables in one line then you still need to repeat the variable type for each variable. So, you need to write</p>\n\n<pre><code>Dim Arr as Variant, TempArr as Variant, BoundVal As Long\n</code></pre>\n\n<p>(2) Try to avoid <code>Variant</code> whenever possible and use the appropriate type instead. For example <code>BoundVal</code> seems to store whole numbers or dates and therefore the data type <code>Long</code> might be best.</p>\n\n<p>(3) Arrays are normally (VBA default) ranging from 0 to ArrayCount - 1. So, the base is set to 0: <code>Option Base 0</code> <a href=\"https://msdn.microsoft.com/en-us/library/aa266179(v=vs.60).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa266179(v=vs.60).aspx</a> Still, to make your code last longer (and more transparent) I'd include this line in your code and change your loops to</p>\n\n<pre><code>For j = LBound(Arr) To UBound(Arr)\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>For j = 0 To UBound(Arr)\n</code></pre>\n\n<p>(4) Force yourself to declare all variables to ensure that you know what's going on: <code>Option Explicit</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278855.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278855.aspx</a></p>\n\n<p>(5) Use <code>.Value2</code> whenever possible instead of <code>.Value</code> for a small speed bonus. Furthermore, this will essentially give you dates in form of a number only and not as a date\u00b2.</p>\n\n<p>After all of the above changes your code should look something like this:</p>\n\n<pre><code>Option Base 0\nOption Explicit\n\nSub tmpSO(Optional targetColumn As Long, Optional leftBoundColumn As Long, Optional rightBoundColumn As Long)\n\nDim cell As Range\nDim Arr As Variant, TempArr As Variant\nDim BoundVal As Long, TagIndex() As Long, i As Long, j As Long\n\n'set the defaults for optional parameters\nIf targetColumn = 0 Then targetColumn = 2\nIf leftBoundColumn = 0 Then leftBoundColumn = 1\nIf rightBoundColumn = 0 Then rightBoundColumn = ActiveSheet.ListObjects(\"Table2\").ListColumns.Count\n\nFor Each cell In ActiveSheet.ListObjects(\"Table2\").ListColumns(targetColumn).DataBodyRange\n\n    Arr = Split(cell.Value2, Chr(10))\n    ReDim TagIndex(LBound(Arr) To UBound(Arr))\n    For i = LBound(Arr) To UBound(Arr)\n        'starts with first value and index, use default 0 if necessary\n        If IsDate(Arr(i)) Then             'if the item can be interpreted as a date then\n            BoundVal = CLng(CDate(Arr(i))) 'convert the string to a date and convert the date to a number\n        Else                               'otherwise treat it as a number only\n            BoundVal = CLng(IIf(IsNumeric(Arr(i)), Arr(i), 0))\n        End If\n        TagIndex(i) = i                    'as default\n        For j = LBound(Arr) To UBound(Arr)\n            If CLng(IIf(IsDate(Arr(j)), CDate(Arr(j)), Arr(j))) &lt; BoundVal Then      'if sorter finds a smaller value,\n                BoundVal = CLng(IIf(IsDate(Arr(j)), CDate(Arr(j)), Arr(j)))          'flags it...\n                TagIndex(i) = j            '...and its index as smaller,\n            End If                         'keeps looking,\n        Next j                             'leaves For loop with the smallest,\n        Arr(TagIndex(i)) = 201             'and moves it up out of reach so sorter won't\n    Next i                                 'flag it anymore (none of the values go above 200)\n\n    For j = leftBoundColumn To rightBoundColumn\n        TempArr = Split(Cells(cell.Row, j).Value, Chr(10))\n        For i = 0 To UBound(TempArr)\n            Arr(i) = TempArr(TagIndex(i))\n        Next i\n        Cells(cell.Row, j).Value2 = Join(Arr, Chr(10))\n    Next j\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Disclaimer: I know that this answer is not complete and that the above code probably needs some tweaking before it really does what you want it to do. Yet, the code works without errors (tested on my system) and introduces some best practices to get you going in the right direction and (possibly) resolve all obstacles. </p>\n\n<p><sub>\u00b2 All dates and times in VBA are numbers! Dates are stored as the days between December 31, 1899 and the day you wish to store while times are always stored as decimals which represent a fraction of the day. So, 0.5 = half a day = 12 noon. 0.75 = three quarters of a day = 6 pm. Today's date is May 04, 2016. That is 42,495 days after December 31, 1899. Hence, the <code>.Value2</code> for today's date is 42,495.</sub> </p>\n"}], "owner": {"reputation": 3, "user_id": 6046786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d20c89e9ee251b9b328891962b89617?s=128&d=identicon&r=PG", "display_name": "Brandon Adams", "link": "https://stackoverflow.com/users/6046786/brandon-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 37027997, "answer_count": 1, "score": 0, "last_activity_date": 1462480897, "creation_date": 1462309530, "last_edit_date": 1531164843, "question_id": 37014338, "link": "https://stackoverflow.com/questions/37014338/inequality-operators-fail-when-comparing-variants", "title": "Inequality operators fail when comparing variants", "body": "<p>I've written an algorithm that sorts integer values in ascending order, but keeps corresponding info in adjacent cells sorted in-line with it. It uses Arr as a snapshot of the cell being sorted, builds an array of the values' indices (TagIndex) if they were sorted in ascending order, then applies TagIndex to that and the adjacent cells.</p>\n\n<p>For example, it should take this...</p>\n\n<pre><code>----------------------------------\n| 5/14/12  |  87  |  91  |  102  |\n| 12/8/11  |  96  |  81  |  93   |\n| 9/30/10  |  75  |  101 |  74   |\n| 4/26/08  |  107 |  95  |  64   |\n----------------------------------\n</code></pre>\n\n<p>...and sort by the second leftmost column to turn it into this:</p>\n\n<pre><code>----------------------------------\n| 9/30/10  |  75  |  101 |  74   |\n| 5/4/12   |  87  |  91  |  102  |\n| 12/8/11  |  96  |  81  |  93   |\n| 4/26/08  |  107 |  95  |  64   |\n----------------------------------\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>Dim cell as Range\nDim Arr, TempArr, BoundVal As Variant\n\nFor Each cell In ActiveSheet.ListObjects(\"Table2\").ListColumns(targetColumn).DataBodyRange\n\n    Arr = Split(cell.Value, Chr(10))\n    ReDim TagIndex(0 To UBound(Arr)) As Variant\n    For i = 0 To UBound(Arr)\n        BoundVal = Arr(i) 'starts with first value and index\n        TagIndex(i) = i   'as defaults\n        For j = 0 To UBound(Arr)\n            If Arr(j) &lt; BoundVal Then  'if sorter finds a smaller value,\n                BoundVal = Arr(j)      'flags it...\n                TagIndex(i) = j        '...and its index as smaller,\n            End If                     'keeps looking,\n        Next j                         'leaves For loop with the smallest,\n        Arr(TagIndex(i)) = 201         'and moves it up out of reach so sorter won't \n    Next i                             'flag it anymore (none of the values go above 200)\n\n    For j = leftBoundColumn To rightBoundColumn \n        TempArr = Split(Cells(cell.Row, j).Value, Chr(10))\n        For i = 0 To UBound(TempArr)\n            Arr(i) = TempArr(TagIndex(i))\n        Next i\n        Cells(cell.Row, j).Value = Join(Arr, Chr(10))\n    Next j\n\nNext cell\n</code></pre>\n\n<p>This code worked dandy at first, but I had two separate versions - one for sorting integers and another for sorting dates - and wanted one that would handle both. To do that, I tried declaring BoundVal as a Variant in the new one. When the results went wonky, keen use of MsgBox'es revealed that it was failing logic tests at the &lt; operator, trying to tell me No for 96&lt;201 and Yes for 107&lt;75 (but no for 117/107, like it should).</p>\n\n<p>If I go back to declaring BoundVal as an Integer, it starts working fine for integers but gives me a Type Mismatch error when I try it on dates.</p>\n\n<p>Is there some fundamental problem with comparing Arr(j) &lt; BoundVal? Both are variants, both are descended from strings. Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1462309845, "post_id": 37014137, "comment_id": 61581003, "body": "The password isn&#39;t stored anywhere, only a hash of it. And you can easily write a nested loop that will invariably produce a colliding hash and unprotect the worksheet. There&#39;s no use in storing a plaintext password anywhere. What are you trying to achieve exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1462360984, "last_edit_date": 1462360984, "creation_date": 1462311324, "answer_id": 37014781, "question_id": 37014137, "link": "https://stackoverflow.com/questions/37014137/set-and-checking-password-of-a-workbook/37014781#37014781", "title": "set and checking password of a workbook", "body": "<p>If I understand correctly, then you can verify the password simply by trying it out and catching any possible error while doing so:</p>\n\n<pre><code>Public Sub ProectSheet()\n\nFor Each ws In ThisWorkbook.Worksheets\n    ws.Protect \"pw\"\nNext ws\n\nEnd Sub\n\nPublic Sub UnprotectSheets()\n\nstrPW = InputBox(\"PW?\")\nFor Each ws In ThisWorkbook.Worksheets\n    On Error GoTo WrongPassword\n    ws.Unprotect strPW\nNext ws\nMsgBox \"All sheets are now unprotected.\"\n\nExit Sub\n\nWrongPassword:\n    MsgBox \"The password you entered is incorrect.\"\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1462311448, "creation_date": 1462311448, "answer_id": 37014816, "question_id": 37014137, "link": "https://stackoverflow.com/questions/37014137/set-and-checking-password-of-a-workbook/37014816#37014816", "title": "set and checking password of a workbook", "body": "<p>There is no way to test for the sheet password except trying to unprotect the sheet with that password.</p>\n\n<p>Just do <code>f.Unprotect mdp</code>, although if <code>mdp</code> contains an invalid password you get a runtime error that you probably should catch:</p>\n\n<pre><code>For Each f In ActiveWorkbook.Worksheets\n    On Error Resume Next\n        f.Unprotect mdp\n        lngError = Err\n    On Error GoTo 0\n    If lngError &lt;&gt; 0 Then MsgBox \"Mauvais mdp !\"\nNext f\n</code></pre>\n\n<p>If you only want to test if the provided password was correct but want the sheet still protected you can just protect it again afterwards:</p>\n\n<pre><code>For Each f In ActiveWorkbook.Worksheets\n    On Error Resume Next\n        f.Unprotect mdp\n        lngError = Err\n    On Error GoTo 0\n    If lngError = 0 Then\n        f.Protect mdp, True, True, True\n    Else\n        MsgBox \"Mauvais mdp !\"\n    End If\nNext f\n</code></pre>\n\n<p>Keep in mind though that - as Mat's Mug mentioned in the comments - there is an infinity of matching passwords, because you just have to create one that has the same hash as the original one. And that's pretty easy.</p>\n\n<p>You should never expect a sheet protection to hold against someone who does not know the password. It can easily be circumvented.</p>\n"}], "owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 37014781, "answer_count": 2, "score": 1, "last_activity_date": 1462360984, "creation_date": 1462308692, "last_edit_date": 1531164843, "question_id": 37014137, "link": "https://stackoverflow.com/questions/37014137/set-and-checking-password-of-a-workbook", "title": "set and checking password of a workbook", "body": "<p>I want to create and protect a workbook.</p>\n\n<p>This is what I did for protection:</p>\n\n<pre><code>Sub Protege()\n    Dim f As Worksheet\n    Dim mdp As String\n\n    mdp = InputBox(\"mdp est ?\")\n\n    For Each f In ActiveWorkbook.Worksheets\n        f.Protect mdp, True, True, True\n    Next f\nEnd Sub\n</code></pre>\n\n<p>Now, this is what I did to unprotect this workbook:</p>\n\n<pre><code>Sub unprotected()\n    Dim f As Worksheet\n\n    For Each f In ActiveWorkbook.Worksheets\n        f.Unprotect\n    Next f\nEnd Sub\n</code></pre>\n\n<p>but I want to check the password first. I mean entering a password and see if it matches with the true password.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "datediff"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462368209, "post_id": 37013824, "comment_id": 61608150, "body": "I tried this and got the following Compile error: Expected: line number or label or statement or end of statement. It seems to be triggered by the &quot;id in&quot;."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462370240, "post_id": 37013824, "comment_id": 61609819, "body": "@shadow2451 this is SQL, not VBA."}, {"owner": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462807337, "post_id": 37013824, "comment_id": 61780041, "body": "Sorry, I&#39;m just getting into VBA and I haven&#39;t done much with SQL yet. Would this be inserted in the query or as an On Click procedure in the form?"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1462307503, "creation_date": 1462307503, "answer_id": 37013824, "question_id": 37013667, "link": "https://stackoverflow.com/questions/37013667/insert-date-time-on-last-modified-record-in-access-2013/37013824#37013824", "title": "Insert date/time on last modified record in Access 2013", "body": "<p>Not perfect, but you could start with something  like this:  </p>\n\n<pre><code>update clock \nset timeOut =  Now()\nwhere employeeId = fOsUsername()\nand id in (select top 1 id from clock where employeeId = fOsUsername() \n                  and timeOut is null and timeIn &gt; Date()-1\n                  order by id desc\n          )    \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462369520, "post_id": 37020544, "comment_id": 61609183, "body": "I assume this would be in the query (sorry, I&#39;m not familiar with SQL yet). This is giving me a parameter box to input ID when I run the report. What format should I use for the ClockIn and ClockOut text boxes on the report?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462370448, "post_id": 37020544, "comment_id": 61610002, "body": "Yes, it is SQL. Just modify to fit your table name etc. and copy paste into the SQL pane. Of course, you will have to adjust the report to use this source. The values are datetime so the format to use is <i>h:nn</i>"}, {"owner": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462807186, "post_id": 37020544, "comment_id": 61779939, "body": "Now I get three input boxes when running the report (ClockIn, ClockOut, and ID) and leaving them blank results in an error: &quot;This expression is typed incorrectly, or it is too complex to be evaluated&quot;. Why am I getting input boxes?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "edited": false, "score": 0, "creation_date": 1462815526, "post_id": 37020544, "comment_id": 61784948, "body": "You get parameter boxes when you state field names that don&#39;t exist. You listed the actual field names in your question, so - if these exist - a copy-n-paste of my SQL into a new query will work as is."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1462344992, "creation_date": 1462344992, "answer_id": 37020544, "question_id": 37013667, "link": "https://stackoverflow.com/questions/37013667/insert-date-time-on-last-modified-record-in-access-2013/37020544#37020544", "title": "Insert date/time on last modified record in Access 2013", "body": "<p>You could do like this:</p>\n\n<pre><code>Select\n    EmployeeID,\n    Sum(TimeIn) As ClockIn,\n    Sum(TimeOut) As ClockOut\nFrom\n    YourClockTable\nGroup By\n    EmployeeID,\n    DateValue(Nz(TimeIn, TimeOut))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6287698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fbb133a34ea8f3dbdd4644953ab822?s=128&d=identicon&r=PG&f=1", "display_name": "shadow2451", "link": "https://stackoverflow.com/users/6287698/shadow2451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1594642171, "creation_date": 1462306945, "last_edit_date": 1594642171, "question_id": 37013667, "link": "https://stackoverflow.com/questions/37013667/insert-date-time-on-last-modified-record-in-access-2013", "title": "Insert date/time on last modified record in Access 2013", "body": "<p>I built a simple time clock database. The table has four columns: </p>\n\n<ul>\n<li>ID (autonumber)</li>\n<li>EmployeeID</li>\n<li>TimeIn (Date/Time)</li>\n<li>TimeOut (Date/Time).</li>\n</ul>\n\n<p>An employee sees only a form with two buttons, Clock In and Clock Out.\nEach button has an On Click event to add a new record to the table with the <code>fOSUserName</code> and <code>Now()</code> under <code>TimeIn</code> or <code>TimeOut</code>, depending on which button is clicked. </p>\n\n<p>All of this works great, however, I need a report to show the number of hours worked per day. In order to get a report with accurate <code>DateDiff()</code>, the <code>TimeIn</code> and <code>TimeOut</code> data has to be on the same row. I've tried LastModified, MovePrevious/MoveNext, and IfNull and I can't get TimeOut on the same row without manually moving it.</p>\n"}, {"tags": ["c++", "vba", "excel"], "comments": [{"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1462307386, "post_id": 37013618, "comment_id": 61579754, "body": "I code for money, but help for free. You&#39;re not experienced in C++ - what do you use? Write pseudocode! Anything!"}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1462307657, "post_id": 37013618, "comment_id": 61579913, "body": "I have done some beginner vba code for excel and willing to learn more on vba, but can&#39;t actually understand what is happening in the above program to figure out a logic to reverse it."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1462308353, "post_id": 37013618, "comment_id": 61580254, "body": "If you are not familiar with C++ notation, read about how to do base conversion somewhere else and write your own code from that. Some hints: <code>v % base</code> is the last digit when written in that base. By dividing by <code>base</code> you &quot;cut off&quot; the last digit because you&#39;re doing integer calculation so the rational part gets dropped. Your code just does that over and over with minimal lines/characters of  code (and comments!). Thinking about what happens in base 10 might be helpful. (v mod 10 is obviously the last decimal digit of v)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462309080, "post_id": 37013618, "comment_id": 61580633, "body": "Can we assume that in the least significant place the lower case <i>a</i> corresponds to <b>0</b> and the lower case <i>b</i> corresponds to <b>1</b>, etc. ??"}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462309470, "post_id": 37013618, "comment_id": 61580814, "body": "@Gary&#39;sStudent - Upper case <i>A</i> is <b>1</b> and so on, lower case <i>a</i> is <b>27</b>. The total index starts from 1 to 52. 52 in the above test program return lowercase <i>z</i>."}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1462309664, "post_id": 37013618, "comment_id": 61580910, "body": "@arcadeprecinct: Thanks for the hint, I&#39;ll try to read more on this when I get home. I was just asked (at work) if I can reverse it,"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462309791, "post_id": 37013618, "comment_id": 61580971, "body": "Then how is a decimal <b>0</b> represented in the base-52 system ??"}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462310350, "post_id": 37013618, "comment_id": 61581248, "body": "@Gary&#39;sStudent - The count starts from <b>1</b> and runs up to <b>52</b>. From what I am able to under stand from   arcadeprecinct&#39;s hint above, it works based on the combination of letters. Similar to what excel does for it&#39;s column numbers. For <b>53</b>, it&#39;s <i>AA</i> and <b>50</b> is <i>x</i>. Hope that makes sense"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1462354572, "post_id": 37013618, "comment_id": 61598088, "body": "It turns out I was completely wrong, the code is indeed converting 53 to AA.  See my answer for an explanation."}], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1462314011, "post_id": 37015209, "comment_id": 61582820, "body": "This seems to be the correct way to convert column names to integers. However it&#39;s not actually base 52 (or 26) because there is no zero (as you noted in your comment to the original question) and the digits go up to the  base. So z as the last position would be the first value as A in the second position. (52*52^0 and 1*52^1)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1462314482, "post_id": 37015209, "comment_id": 61582993, "body": "@arcadeprecinct  you are correct about the zero, but <i>Praveen</i> is only concerned about mapping positive values in the fashion that he indicated."}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "edited": false, "score": 1, "creation_date": 1462316963, "post_id": 37015209, "comment_id": 61583696, "body": "Thanks for your help guys <i>Gary&#39;sStudent</i> and <i>arcadeprecinct</i>. I also managed to figure out the logic on paper, but <i>Gary&#39;sStudent</i> was quicker to actually write a function and show a demo. Thanks a lot once again!!.  I used the following link to understand the base conversion: <a href=\"http://mathforum.org/library/drmath/view/55730.html\" rel=\"nofollow noreferrer\">mathforum.org/library/drmath/view/55730.html</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462319171, "post_id": 37015209, "comment_id": 61584320, "body": "Base 52 characters should be numbers 0..51 (similar to base 10 numbers 0..9)  So furmula should be <code>deccimal = deccimal + (InStr(1, chSET, CH) - 1) * (52 ^ K)</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462319870, "post_id": 37015209, "comment_id": 61584494, "body": "@chrisneilsen  <b>You are completely correct</b> for standard bases like binary or octal, or hexadecimal, but this is NOT a standard base................. <i>Praveen</i> did not want to incorporate a <b>0</b>, so there is no zero place-holder like <b>JA0MES</b> or <b>A0</b>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462320168, "post_id": 37015209, "comment_id": 61584582, "body": "@chrisneilsen  The only encodement I have ever encountered without a <b>0</b> is Roman Numerals."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462322911, "post_id": 37015209, "comment_id": 61585205, "body": "@Gary I don&#39;t think Praveen knows what he wants."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462323487, "post_id": 37015209, "comment_id": 61585343, "body": "@Gary besides, my reading of the OPs posted code (that he wants to reverse) is that it is coding base52 (ie 0..51 digits).  Op has already stated he can&#39;t read that code."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462324142, "post_id": 37015209, "comment_id": 61585501, "body": "@chrisneilsen  I based my code on <i>Praveen</i>&#39;s examples in his last comment to his question rather than the code that he posted"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462324543, "post_id": 37015209, "comment_id": 61585601, "body": "@Gary I&#39;m more concerned about the value of the Q/A to SO.  A Q that asks <i>VBA convert base 52 number to base 10 based on charset</i> that has an (accepted) answer that is <i>not</i> base52 is harmfull.  I think you should highlight at the top of your answer that it is not base52"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462354085, "post_id": 37015209, "comment_id": 61597732, "body": "@chrisneilsen actually this is the reverse of OPs code. Notice the v-- within the loop. That makes it not really base 52 so I think the name of the function is a bad choice, especially without comments."}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462369777, "post_id": 37015209, "comment_id": 61609379, "body": "@chrisneilsen - The answers from <i>Garry&#39;s Student</i> &amp; <i>arcadeprecinct</i> made me realize that this is not standard base 52 conversion. I have edited the original question to remove reference to base 52."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462369980, "post_id": 37015209, "comment_id": 61609582, "body": "@chrisneilsen  the question confused me as well..........I could not match what the Poster wanted until I realized this is non-standard."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1462364913, "last_edit_date": 1462364913, "creation_date": 1462313253, "answer_id": 37015209, "question_id": 37013618, "link": "https://stackoverflow.com/questions/37013618/vba-convert-excel-style-column-name-with-52-charset-to-original-number/37015209#37015209", "title": "VBA convert Excel Style Column Name (with 52 charset) to original number", "body": "<p><strong>EDIT:</strong>  The character string format being translated to decimal by the code described below is NOT a standard base-52 schema.  The schema does not include <strong>0</strong> or any other digits.  Therefore this code should not be used, as is, to translate a standard base-52 value to decimal.</p>\n\n<hr>\n\n<p>O.K. this is based on converting a <strong>single character</strong> based on its position in a long string.  the string is:</p>\n\n<pre><code>chSET = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\"\n</code></pre>\n\n<p>The <em>InStr()</em> function tells us the <strong>A</strong> is in position <strong>1</strong> and the <strong>Z</strong> is in position <strong>26</strong> and that <strong>a</strong> is in position <strong>27</strong>.  All characters get converted the same way.</p>\n\n<p>I use this rather than <em>Asc()</em> because <em>Asc()</em> has a gap between the upper and lower case letters.</p>\n\n<p>The least significant character's value gets multiplied by 52^0<br>The next character's value gets multiplied by 52^1<br>The third character's value gets multiplied by 52^3, etc.  The code:</p>\n\n<pre><code>Public Function deccimal(s As String) As Long\n    Dim chSET As String, arr(1 To 52) As String\n    Dim L As Long, i As Long, K As Long, CH As String\n\n    chSET = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\"\n    deccimal = 0\n    L = Len(s)\n    K = 0\n    For i = L To 1 Step -1\n        CH = Mid(s, i, 1)\n        deccimal = deccimal + InStr(1, chSET, CH) * (52 ^ K)\n        K = K + 1\n    Next i\nEnd Function\n</code></pre>\n\n<p>Some examples:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xdojH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xdojH.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>NOTE:</em></strong></p>\n\n<p>This is NOT the way bases are usually encoded.  Usually bases start with a <strong>0</strong> and allow <strong>0</strong> in any of the encoded value's positions.  In all my previous <em>UDF()</em>'s similar to this one, the first character in <code>chSET</code> is a <strong>0</strong> and I have to use <code>(InStr(1, chSET, CH) - 1) * (52 ^ K)</code></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462356842, "post_id": 37023602, "comment_id": 61599678, "body": "Thank you <b>very much</b> ...................your explanation is WAY better than mine."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462357909, "post_id": 37023602, "comment_id": 61600437, "body": "Well it isn&#39;t actually what OP wanted, that was provided by your answer but I thought it was worth explaining what happens because of the confusion. In my opinion the naming C function is misleading and the minimalist code and lack of commenting make it difficult to see what is happening."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462358366, "post_id": 37023602, "comment_id": 61600780, "body": "I think that c++ in general is a language that makes it easy to code, but hard to read........but maybe that&#39;s just me!"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462360192, "post_id": 37023602, "comment_id": 61602109, "body": "I agree. If you&#39;re not familiar with pointers and the syntax it&#39;s near impossible to read. <code>*--</code> looks weird as hell as a unary operator in front of a variable while <code>i = i-1; result[i]=...</code> could probably be understood with basic knowledge in any language."}, {"owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "edited": false, "score": 1, "creation_date": 1462368971, "post_id": 37023602, "comment_id": 61608755, "body": "@arcadeprecinct - <b>Thanks a lot for detailed explanation</b>. I got what I wanted earlier, but this is step-by-step explanation of the concepts and the difference from the normal base conversion. <b>You Rock..</b> Cheers !!"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 2, "last_activity_date": 1462360328, "last_edit_date": 1462360328, "creation_date": 1462353889, "answer_id": 37023602, "question_id": 37013618, "link": "https://stackoverflow.com/questions/37013618/vba-convert-excel-style-column-name-with-52-charset-to-original-number/37023602#37023602", "title": "VBA convert Excel Style Column Name (with 52 charset) to original number", "body": "<p>Gary's Student provided a good and easy to understand way to get the number from what I call \"Excel style base 52\" and this is what you wanted.</p>\n\n<p>However this is a little different from the usual base 52. I'll try to explain the difference to regular base 52 and its conversion. There might be an easier way but this is the best I could come up with that also explains the code you provided. </p>\n\n<p>As an example: The number zz..zz means 51*(1 + 52 + 52^2 + ... 52^(n-1)) in regular base 52 and 52*(1 + 52 + 52^2 + ... 52^(n-1)) in Excel style base 52. So Excel style get's higher number with fewer digits. <a href=\"http://www.wolframalpha.com/input/?i=(52%5En-1)%2F51\" rel=\"nofollow\">Here</a> is how much that difference is based on number of digits. How is this possible? It uses leading zeros so 1, 01, 001 etc are all different numbers. Why don't we do this normally? It would mess up the easy arithmetic of the usual system.</p>\n\n<p>We can't just shift all the digits by one after the base change and we can't just substract 1 before the base change to counter the fact that we start at 1 instead of 0. I'll outline the problem with base 10. If we'd use Excel style base 10 to number the columns, we would have to count like \"0, 1, 2, ..., 9, 00, 01, 02, ...\". On the first glance it looks like we just have to shift the digits so we start counting at 1 but this only works up to the 10th number. </p>\n\n<pre><code>1  2 .. 10  11 .. 20  21  ..  99  100 .. 110  111 //normal counting\n0  1 ..  9  00 .. 09  10  ..  88   89 ..  99  000 //excel style counting\n</code></pre>\n\n<p>You notice that whenever we add a new digit we shift again. To counter that, we have to do a shift by 1 before calculating each digit, not shift the digit after calculating it. (This only makes a difference if we're at 52^k) Note that we still assign A to 0, B to 1 etc.</p>\n\n<p>Normally what you would do to change bases is looping with something like</p>\n\n<pre><code>nextDigit = x mod base //determining the last digit\nx = x/base             //removing the last digit\n//terminate if x = 0\n</code></pre>\n\n<p>However now it is </p>\n\n<pre><code>x = x - 1\nnextDigit = x mod base\nx = x/base\n//terminate if x = 0\n</code></pre>\n\n<p>So x is decremented by 1 first! Let's do a quick check for x=52:</p>\n\n<p>Regular base 52:</p>\n\n<pre><code>nextDigit = x mod 52 //52 mod 52 = 0 so the next digit is A\nx = x/52 //x is now 1\n//next iteration\nnextDigit = x mod 52 //1 mod 52 = 1 so the next digit is B\nx = x/52 //1/52 = 0 in integer arithmetic\n//terminate because x = 0\n//result is BA\n</code></pre>\n\n<p>Excel style:</p>\n\n<pre><code>x = x-1 //x is now 51\nnextDigit = x mod 52 //51 mod 52 = 51 so the next digit is z\nx = x/52 //51/52 = 0 in integer arithmetic\n//terminate because x=0\n//result is z\n</code></pre>\n\n<p>It works!</p>\n\n<h2>Part 2: Your C++ code</h2>\n\n<p>Now for let's read your code:</p>\n\n<ul>\n<li><p><code>x % y</code> means x mod y</p></li>\n<li><p>When you do calculations with integers, the result will be an integer which is achieved by rounding down. So 39/10 will produce 3 etc.</p>\n\n<ul>\n<li><code>x++</code> and <code>++x</code> both increment x by 1. </li>\n</ul></li>\n</ul>\n\n<p>You can use this in other statements to save a line of code. <code>x++</code> means x is incremented after the statement is evaluated and <code>++x</code> means it is incremented before the statement is evaluated</p>\n\n<pre><code>y=f(x++);\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>y = f(x);\nx = x + 1;\n</code></pre>\n\n<p>while </p>\n\n<pre><code>y=f(++x);\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>x = x + 1; \ny = f(x);\n</code></pre>\n\n<p>This goes the same way for <code>--</code></p>\n\n<ul>\n<li><code>Char* p</code> creates a pointer to a <code>char</code>.</li>\n</ul>\n\n<p>A pointer points to a certain location in memory. If you change the pointer, it points to a different location. E.g. doing <code>p--</code> moves the pointer one to the left. To read or write the value that is saved at the location, use <code>*p</code>. E.g. <code>*p=\"a\";</code> \"a\" is written to the memory location that <code>p</code> points at. <code>*p--=\"a\";</code> \"a\" is written to the memory but the pointer is moved to the left afterwards so *p is now whatever is in the memory left of \"a\".</p>\n\n<ul>\n<li>strings are just arrays of type char.</li>\n</ul>\n\n<p>The end of a string is always '\\0' if the computer reads a string it continues until it finds '\\0'</p>\n\n<p>This is hopefully enough to understand the code. Here it is </p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;climits&gt;\nusing namespace std;\nstring base52(unsigned long v)\n{\n    char const digits[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\"; //The digits. (Arrays start at 0)\n    size_t const base = sizeof(digits) - 1; //The base, based on the digits that were given\n    char result[sizeof(unsigned long)*CHAR_BIT + 1]; //The array that holds the answer \n        //sizeof(unsigned long)*CHAR_BIT is the number of bits of an unsigned long\n        //which means it is the absolute longest that v can be in any base.\n        //The +1 is to hold the terminating character '\\0' \n    char* current = result + sizeof(result); //This is a pointer that is supposed to point to the next digit. It points to the first byte after the result array (because its start + length)\n        //(i.e. it will go through the memory from high to low)\n    *--current = '\\0';  //The pointer gets moved one to the left (to the last char of result and the terminating char is added\n        //the pointer has to be moved to the left first because it was actually pointing to the first byte after the result.\n\n    while (v != 0) {  //loop until v is zero (until there are no more digits left.\n        v--; //v = v - 1. This is the important part that does the 1 -&gt; A part\n        *--current = digits[v % base];  // the pointer is moved one to the left and the corresponding digit is saved\n        v /= base; //the last digit is dropped\n    }\n    return current; //current is returned, which points at the last saved digit. The rest of the result array (before current) is not used.\n}\n\n// for testing\n\n\nint main()\n{\n    cout&lt;&lt; base52(705);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6287718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TPw9JH5noKw/AAAAAAAAAAI/AAAAAAAAABM/H50bVSyq_Vs/photo.jpg?sz=128", "display_name": "Praveen", "link": "https://stackoverflow.com/users/6287718/praveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 37015209, "answer_count": 2, "score": 2, "last_activity_date": 1462372417, "creation_date": 1462306757, "last_edit_date": 1531164843, "question_id": 37013618, "link": "https://stackoverflow.com/questions/37013618/vba-convert-excel-style-column-name-with-52-charset-to-original-number", "title": "VBA convert Excel Style Column Name (with 52 charset) to original number", "body": "<p>I have a c++ program that takes an integer and convert it to lower and uppercase alphabets, similar to what excel does to convert column index to column number but also including lower case letters.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;climits&gt;\nusing namespace std;\nstring ConvertNum(unsigned long v)\n{\n    char const digits[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n    size_t const base = sizeof(digits) - 1;\n    char result[sizeof(unsigned long)*CHAR_BIT + 1];\n    char* current = result + sizeof(result);\n    *--current = '\\0';\n\n    while (v != 0) {\n        v--;\n        *--current = digits[v % base];\n        v /= base;\n    }\n    return current;\n}\n\n// for testing\n\n\nint main()\n{\n    cout&lt;&lt; ConvertNum(705);\n\n    return 0;\n}\n</code></pre>\n\n<p>I need the vba function to reverse this back to the original number. I do not have a lot of experience with C++ so I can not figure out a logic to reverse this in vba. Can anyone please help.</p>\n\n<p><strong>Update 1:</strong> I don't need already written code, just some help in the logic to reverse it. I'll try to convert the logic into code myself.</p>\n\n<p><strong>Update 2:</strong> Base on the wonderful explanation and help provided in the answer, it's clear that the code is not converting the number to a usual base52, it is misleading. So I have changed the function name to eliminate the confusion for future readers.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462314865, "post_id": 37014227, "comment_id": 61583111, "body": "Hi, still same error :( , the error is in Line With ChtObj.Chart, so it didnt even reach the .ChartType yet.."}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462315136, "post_id": 37014227, "comment_id": 61583192, "body": "Changed a bit in the code and it worked! Thanks again teylyn!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1462309068, "creation_date": 1462309068, "answer_id": 37014227, "question_id": 37013604, "link": "https://stackoverflow.com/questions/37013604/error-at-creating-simple-x-y-smooth-chart/37014227#37014227", "title": "Error at creating simple x y smooth chart", "body": "<p>You have a typo in the first line of the <code>With</code> statement. Hard to see, but there is a <code>1</code> instead of an <code>l</code>.It should be</p>\n\n<pre><code>.ChartType = xlXYScatterSmooth\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37014227, "answer_count": 1, "score": 0, "last_activity_date": 1462309068, "creation_date": 1462306708, "last_edit_date": 1531164843, "question_id": 37013604, "link": "https://stackoverflow.com/questions/37013604/error-at-creating-simple-x-y-smooth-chart", "title": "Error at creating simple x y smooth chart", "body": "<p>I am trying to create a dynamic chart that will change the data set with time, but I am stuck at the first step which is creating a simple chart with a certain limited number of points.</p>\n\n<p>My x values and Y values are at rows 3 and 5.</p>\n\n<p>The code I am trying to run is to create the chart in the same worksheet I am using:</p>\n\n<p>Sub UpdateChart()</p>\n\n<pre><code>Dim ChtObj As ChartObject\n\nSet ChtObj = ActiveSheet.ChartObjects(\"Bending Moment along \" &amp; ActiveSheet.Name) 'Adjust chart name to your chart\n\nWith ChtObj.Chart\n    .ChartType = x1XYScatterSmooth\n    .SetElement msoElementLegendNone\n    .Axes(xlValue).MinimumScale = 0\n    .Axes(xlValue).MaximumScale = 5\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"Bending moment\"\n    .SeriesCollection(1).Values = Range(\"D3:H3\")\n    .SeriesCollection(1).XValues = Range(\"D5:H5\")\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I am getting error run-time 5, invalid procedure call or argument? This happens at the line of: With ChtObj.Chart</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462312857, "post_id": 37013582, "comment_id": 61582370, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) with <b>their</b> code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. Also, please elaborate why you haven&#39;t been able to use the referenced code."}, {"owner": {"reputation": 11, "user_id": 2965040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7374de5cc3f867edd50f87f3be76c6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshTheGoat", "link": "https://stackoverflow.com/users/2965040/joshthegoat"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462368966, "post_id": 37013582, "comment_id": 61608749, "body": "Thanks Ralph.  I&#39;m definitely in the &quot;aspirant&quot; category.  I&#39;ve edited my post to include the code I&#39;ve tried to get working thus far along with the link, but I have yet to get it to actually compile.  Thanks for the feedback."}], "owner": {"reputation": 11, "user_id": 2965040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7374de5cc3f867edd50f87f3be76c6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshTheGoat", "link": "https://stackoverflow.com/users/2965040/joshthegoat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2070, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1462365755, "creation_date": 1462306641, "last_edit_date": 1462365755, "question_id": 37013582, "link": "https://stackoverflow.com/questions/37013582/excel-vba-search-userform-listbox-with-multiple-columns-via-textbox", "title": "Excel VBA - Search Userform Listbox with Multiple Columns via textbox", "body": "<p>I'm trying to work out the code needed to filter or search a listbox included on a userform that contains multiple columns and multiple rows. On the userform, I have a textbox that allows user input that would ideally filter out the non-matching entries from the Listbox.  </p>\n\n<p>I've found <a href=\"http://yoursumbuddy.com/listbox-filter-wildcards-unique-values/\" rel=\"nofollow\">a few solutions online</a>, but nothing that I could get to work on a listbox with multiple columns in a userform.  The way it's coded from the example is trying to transpose a single column of data, and I'm guessing I need to alter the code to use an array.  I'm just not strong enough with VBA to know exactly how to change that piece.</p>\n\n<p>I'm also receiving an error on the GoToRow() function, but I believe it's tied into the single vs multiple column listbox issue.</p>\n\n<p>I've included a link to a basic mockup of my project below since I'm using a userform with a listbox and textbox that are named.</p>\n\n<p><a href=\"https://www.dropbox.com/s/diu05ncwbltepqp/BasicListboxExample.xlsm?dl=0\" rel=\"nofollow\">https://www.dropbox.com/s/diu05ncwbltepqp/BasicListboxExample.xlsm?dl=0</a></p>\n\n<p>The listbox on my userform has five columns and is named ProjectList, and the textbox is named SearchTextBox.</p>\n\n<pre><code>Option Explicit\nConst ProjectNameCol = \"B\"\nDim PS As Worksheet\nPrivate loActive As Excel.ListObject\n\nPrivate Sub UserForm_Activate() ' Main code on Userform Activation, calls support subs\n\n    Set PS = Sheets(\"ProjectSheet\") 'stores value for Project Sheet Worksheet as PS\n    Set loActive = ActiveSheet.ListObjects(1)\n\n    'populates listbox with data from ProjectSheet Worksheet named table\n    ProjectList.RowSource = \"AllData\"\n\n    '# of Columns for listbox\n    ProjectList.ColumnCount = 5\n\n    'Column Width for listbox\n    ProjectList.ColumnWidths = \"140; 100; 100; 100; 100\"\n\n    Me.ProjectList.TextColumn = 1\n    Me.ProjectList.MatchEntry = fmMatchEntryComplete\n    ResetFilter\n\nEnd Sub\n\nPrivate Sub SearchTextBox_Change()\n    'Can't get anything to work here\n    ResetFilter\nEnd Sub\n\nSub ResetFilter()\n\nDim rngTableCol As Excel.Range\nDim varTableCol As Variant\nDim RowCount As Long\nDim FilteredRows() As String\nDim i As Long\nDim ArrCount As Long\nDim FilterPattern As String\n\n'the asterisks make it match anywhere within the string\nIf Not ValidLikePattern(Me.SearchTextBox.Text) Then\n    Exit Sub\nEnd If\nFilterPattern = \"*\" &amp; Me.SearchTextBox.Text &amp; \"*\"\n\nSet rngTableCol = loActive.ListColumns(1).DataBodyRange\n'note that Transpose won't work with &gt; 65536 rows\nvarTableCol = Application.WorksheetFunction.Transpose(rngTableCol.value)\nRowCount = UBound(varTableCol)\nReDim FilteredRows(1 To 2, 1 To RowCount)\nFor i = 1 To RowCount\n        'Like operator is case sensitive,\n        'so need to use LCase if not CaseSensitive\n        If (LCase(varTableCol(i)) Like LCase(FilterPattern)) Then\n            'add to array if ListBox item matches filter\n            ArrCount = ArrCount + 1\n            'there's a hidden ListBox column that stores the record num\n            FilteredRows(1, ArrCount) = i\n            FilteredRows(2, ArrCount) = varTableCol(i)\n        End If\nNext i\nIf ArrCount &gt; 0 Then\n    'delete empty array items\n    'a ListBox cannot contain more than 65536 items\n    ReDim Preserve FilteredRows(1 To 2, 1 To Application.WorksheetFunction.Min(ArrCount, 65536))\nElse\n    're-initialize the array\n    Erase FilteredRows\nEnd If\nIf ArrCount &gt; 1 Then\n    Me.ProjectList.List = Application.WorksheetFunction.Transpose(FilteredRows)\nElse\n    Me.ProjectList.Clear\n    'have to add separately if just one match\n    'or we get two rows, not two columns, in ListBox\n    If ArrCount = 1 Then\n        Me.ProjectList.AddItem FilteredRows(1, 1)\n        Me.ProjectList.List(0, 1) = FilteredRows(2, 1)\n    End If\nEnd If\nEnd Sub\n\nPrivate Sub ProjectList_Change()\nGoToRow\nEnd Sub\n\nSub GoToRow()\nIf Me.ProjectList.ListCount &gt; 0 Then\n    Application.Goto loActive.ListRows(Me.ProjectList.value).Range.Cells(1),True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Over in my modules I have:</p>\n\n<pre><code>Function ValidLikePattern(LikePattern As String) As Boolean\nDim temp As Boolean\nOn Error Resume Next\ntemp = (\"A\" Like \"*\" &amp; LikePattern &amp; \"*\")\nIf Err.Number = 0 Then\n    ValidLikePattern = True\nEnd If\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462309274, "post_id": 37013580, "comment_id": 61580729, "body": "If either the answers below answered your question then please mark the one that best answered as the correct answer, by clicking the check mark by the correct answer.  this is something only you can do.  It will close the question as being answered."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6282989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31eaa925c1a74fbd79c44f8ce01dc30?s=128&d=identicon&r=PG&f=1", "display_name": "excel ", "link": "https://stackoverflow.com/users/6282989/excel"}, "edited": false, "score": 0, "creation_date": 1462307246, "post_id": 37013630, "comment_id": 61579664, "body": "When using this formula I get #N/A As output. I noticed when using my colum header my data starts at e2 not e1...I modified formula to =COUNTBLANK(E2:INDEX(E:E,MATCH(1E+99,A:A))) however same output. any insight? ty so far!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 6282989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31eaa925c1a74fbd79c44f8ce01dc30?s=128&d=identicon&r=PG&f=1", "display_name": "excel ", "link": "https://stackoverflow.com/users/6282989/excel"}, "edited": false, "score": 0, "creation_date": 1462307432, "post_id": 37013630, "comment_id": 61579789, "body": "Are your Items, numbers or text?"}, {"owner": {"reputation": 3, "user_id": 6282989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31eaa925c1a74fbd79c44f8ce01dc30?s=128&d=identicon&r=PG&f=1", "display_name": "excel ", "link": "https://stackoverflow.com/users/6282989/excel"}, "edited": false, "score": 0, "creation_date": 1462307508, "post_id": 37013630, "comment_id": 61579828, "body": "format is set to date on date sold and for item it is text and numbers like 2015 ford exhaust or just ford exhaust format set to general on item"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 6282989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31eaa925c1a74fbd79c44f8ce01dc30?s=128&d=identicon&r=PG&f=1", "display_name": "excel ", "link": "https://stackoverflow.com/users/6282989/excel"}, "edited": false, "score": 0, "creation_date": 1462307548, "post_id": 37013630, "comment_id": 61579850, "body": "No column A, is it a number or a string?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1462307670, "last_edit_date": 1462307670, "creation_date": 1462306810, "answer_id": 37013630, "question_id": 37013580, "link": "https://stackoverflow.com/questions/37013580/auto-update-formula-based-on-another-cell-excel/37013630#37013630", "title": "auto update formula based on another cell excel", "body": "<p>This will grow as the data grows:</p>\n\n<pre><code>=COUNTBLANK(E1:INDEX(E:E,MATCH(1E+99,A:A)))\n</code></pre>\n\n<p>If your data in Column A is a string then use this instead:</p>\n\n<pre><code>=COUNTBLANK(E1:INDEX(E:E,MATCH(\"ZZZ\",A:A)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1462307823, "post_id": 37013874, "comment_id": 61580006, "body": "FWIW Offset is a volatile function, in that it will calculate every time excel recalculates.  If used just once it will not slow down excel but if there are hundreds it will add to the recalc time.  Non volatile function only recalc when the data to which they refer change.  Again as this is a one off equation it would not make much of a difference."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462307949, "post_id": 37013874, "comment_id": 61580063, "body": "note to self, avoid offset if used repeatedly.  is count volatile?  If you throw an offset function into a named range, will the named range be recalculated on ever sheet recalc as well?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462308052, "post_id": 37013874, "comment_id": 61580116, "body": "No to your first question and yes to your second.  There have been very few times I could not replace offset and Indirect with INDEX."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1462308197, "post_id": 37013874, "comment_id": 61580181, "body": "I really like your second equation, it is simple and allows for full column reference."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1462309329, "post_id": 37013874, "comment_id": 61580754, "body": "apparently I work both ends of the spectrum for possible formulas!"}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 2, "last_activity_date": 1462307679, "creation_date": 1462307679, "answer_id": 37013874, "question_id": 37013580, "link": "https://stackoverflow.com/questions/37013580/auto-update-formula-based-on-another-cell-excel/37013874#37013874", "title": "auto update formula based on another cell excel", "body": "<pre><code>=COUNTBLANK(OFFSET($A$1$,0,0,COUNTA(A:A),1))\n</code></pre>\n\n<p>Should count the number of blanks in the column E that match your data.</p>\n\n<p>You could also go with:</p>\n\n<pre><code>=COUNTA(A:A)-COUNTA(E:E)\n</code></pre>\n\n<p>That assumes there is nothing under your table</p>\n"}], "owner": {"reputation": 3, "user_id": 6282989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31eaa925c1a74fbd79c44f8ce01dc30?s=128&d=identicon&r=PG&f=1", "display_name": "excel ", "link": "https://stackoverflow.com/users/6282989/excel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "accepted_answer_id": 37013630, "answer_count": 2, "score": 0, "last_activity_date": 1462307679, "creation_date": 1462306636, "last_edit_date": 1531161705, "question_id": 37013580, "link": "https://stackoverflow.com/questions/37013580/auto-update-formula-based-on-another-cell-excel", "title": "auto update formula based on another cell excel", "body": "<p>I have formula: =COUNTBLANK(E1:E3)</p>\n\n<p>I want the e3 to continue to auto increment when I add a column to A4. </p>\n\n<p>All help and input is highly appreciated</p>\n\n<p>I am using Excel 2010</p>\n\n<p>Adding more details of what i need to complete this issue:</p>\n\n<p>I've Merged cells A-B, C-D, E-F. A-b = item, c-d = item serial, e-f is date item sold.</p>\n\n<pre><code>Item     |    Serial    |    Date Sold\n1             001            01/10/2016\n2        |    867       |               \n3        |    999       |    02/11/2014\n</code></pre>\n\n<p>Items in store: 1</p>\n\n<p>If item sold date is blank that means my item should still be in store.</p>\n\n<p>So when I add a new item in A-B I need to auto update My formula reading date item sold. So I have formula =COUNTBLANK(E1:E3) which is dependant on A1-Axx depending on how many items I have in store.</p>\n\n<p>If I add item to A4 I need my countblank formula to see I added a new item and Start counting E4 as a blank item now and show, 2 items in store.. </p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1462306695, "post_id": 37013484, "comment_id": 61579365, "body": "A generic input box and then asking them to confirm their input, eg: what worksheet number? You entered X, is this correct?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1462383307, "post_id": 37013484, "comment_id": 61618863, "body": "@NickSlash &#39;s suggestion is workable. If you want something &quot;fancier&quot; you could create a UserForm with a listbox or combobox that your code fills with the worksheet names. The user selects an entry, confirms the UserForm, and your code procedes from there."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6225111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd95a616199cb7bfc0b9e3c3e79f596?s=128&d=identicon&r=PG&f=1", "display_name": "Robert 30005", "link": "https://stackoverflow.com/users/6225111/robert-30005"}, "is_accepted": false, "score": 0, "last_activity_date": 1462405083, "last_edit_date": 1462405083, "creation_date": 1462388749, "answer_id": 37035988, "question_id": 37013484, "link": "https://stackoverflow.com/questions/37013484/how-to-call-one-of-several-excel-sheets-in-a-workbook-to-export-values-to-word/37035988#37035988", "title": "How to call one of several Excel sheets in a Workbook to export values to Word?", "body": "<p>Try the code below:</p>\n\n<pre><code>foreach(Excel.Worksheet xlworksheet in xlWorkBook.Worksheets)\n{\n    //find a selected worksheet\n    if (xlworksheet.EnableSelection == XlEnableSelection.xlNoRestrictions)\n    {\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6268472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e3236f0a9c1c21801a698d00eada5c7?s=128&d=identicon&r=PG&f=1", "display_name": "VeryBasicApplication", "link": "https://stackoverflow.com/users/6268472/verybasicapplication"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462405083, "creation_date": 1462306233, "last_edit_date": 1462383346, "question_id": 37013484, "link": "https://stackoverflow.com/questions/37013484/how-to-call-one-of-several-excel-sheets-in-a-workbook-to-export-values-to-word", "title": "How to call one of several Excel sheets in a Workbook to export values to Word?", "body": "<p>I have a template word document that is using labels to input data from an excel spreadsheet. Due to the nature of my working environment I cannot use MailMerge for this task. The data will always be in the same cells because the admin staff always inputs new data in the third row. </p>\n\n<p>My problem is that the information could be drawn from one of several excel worksheets within the workbook. I could run through a series of MsgBox prompts (as I did in my example code) but that seems inefficient.   </p>\n\n<p>Is there any way I can prompt the user to select one of the seven worksheets within that workbook? </p>\n\n<p>My code: </p>\n\n<pre><code>Sub Populate()\n\nDim objExcel As New Excel.Application\nDim exWb As Excel.Workbook\n\nSet exWb = objExcel.Workbooks.Open(\"c:\\\")\nMSG1 = MsgBox(\"Is the information found on Sheet 1?\", vbYesNo, \"Sheet Selection\")\n\nIf MSG1 = vbYes Then \n ThisDocument.This.Caption = \"Objet/Subject: \" &amp; exWb.Sheets(\"Sheet1\").Cells(3, 3)\n ThisDocument.That.Caption = exWb.Sheets(\"Sheet1\").Cells(3, 1)\n ThisDocument.Your.Caption = exWb.Sheets(\"Sheet1\").Cells(3, 2)\nElse \n MSG2 = MsgBox(\"Is the information found on Sheet 2?\", vbYesNo, \"Sheet Selection\")\nEnd If\n\nIf MSG2 = vbYes Then\nThisDocument.This.Caption = \"Objet/Subject: \" &amp; exWb.Sheets(\"Sheet2\").Cells(3, 3)\n ThisDocument.That.Caption = exWb.Sheets(\"Sheet2\").Cells(3, 1)\n ThisDocument.Your.Caption = exWb.Sheets(\"Sheet2\").Cells(3, 2)\n\nexWb.Close\n\nSet exWb = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1462306363, "post_id": 37013356, "comment_id": 61579171, "body": "What runtime error do you get?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1462306676, "post_id": 37013356, "comment_id": 61579354, "body": "The runtime error is type mismatch."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462312315, "post_id": 37013356, "comment_id": 61582149, "body": "On which line are you getting this error?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462313021, "post_id": 37013356, "comment_id": 61582418, "body": "@Ralph on this line: If (cell_search.Value) = &quot;Not in Range&quot; Then"}], "answers": [{"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462308387, "post_id": 37013757, "comment_id": 61580280, "body": "The compiler still stops in this row with the runtime error missmatch: If cell_search.Value = &quot;Not in Range&quot; Then"}, {"owner": {"reputation": 511, "user_id": 2611889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5529ac140dc77f25406806aea65c4ca?s=128&d=identicon&r=PG", "display_name": "zack.lore", "link": "https://stackoverflow.com/users/2611889/zack-lore"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462309793, "post_id": 37013757, "comment_id": 61580972, "body": "I cannot re-create your error.  In my test this corrected the issue.  What type of data are you expecting in rng?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462313084, "post_id": 37013757, "comment_id": 61582441, "body": "The fields in the range display based on a formula either &quot;In Range&quot; or &quot;Not in Range&quot; ."}], "tags": [], "owner": {"reputation": 511, "user_id": 2611889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5529ac140dc77f25406806aea65c4ca?s=128&d=identicon&r=PG", "display_name": "zack.lore", "link": "https://stackoverflow.com/users/2611889/zack-lore"}, "is_accepted": true, "score": 1, "last_activity_date": 1462313831, "last_edit_date": 1462313831, "creation_date": 1462307259, "answer_id": 37013757, "question_id": 37013356, "link": "https://stackoverflow.com/questions/37013356/runtime-error-on-delete-loop/37013757#37013757", "title": "Runtime error on delete loop", "body": "<p>Is rng being set to Nothing?  Try this:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\nDim rng As Range\nDim cell_search As Range\nDim del As Range\nDim FrRngCount As Range\nDim I As Integer\nDim DatatoData As Worksheet\n\nSet DatatoData = ThisWorkbook.Worksheets(\"PCA DATA2\")\n\nSet FrRngCount = DatatoData.Range(\"A:A\")\nI = Application.WorksheetFunction.CountA(FrRngCount)    \n\nSet rng = Intersect(DatatoData.Range(\"CV2:CV\" &amp; I), DatatoData.UsedRange)\n\nIf Not rng Is Nothing Then\n\nFor Each cell_search In rng\n    cell_search.Activate\n    If cell_search.Value = \"Not in Range\" Then\n        If del Is Nothing Then\n            Set del = cell_search\n        Else: Set del = Union(del, cell_search)\n        End If\n    End If\nNext cell_search\n\nEnd If\n\nOn Error Resume Next\ndel.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>This is what I have and it seems to work.  I added the cell_search.Active for debugging.  You should give this a try and see what cell it activates when you get your error.</p>\n"}, {"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462315302, "post_id": 37015336, "comment_id": 61583246, "body": "Thanks, the loop seems to be working now, however when I add del.EntireRow.Delete after the loop I get an error that the object variable is not set."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462315501, "post_id": 37015336, "comment_id": 61583300, "body": "That means that rng is empty and therefore there is nothing to be deleted."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1462317945, "post_id": 37015336, "comment_id": 61583963, "body": "Still not working. Now it says that the method &#39;Union&#39; of object _Global failed. Any suggestions on how to fix this?"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1462313811, "creation_date": 1462313811, "answer_id": 37015336, "question_id": 37013356, "link": "https://stackoverflow.com/questions/37013356/runtime-error-on-delete-loop/37015336#37015336", "title": "Runtime error on delete loop", "body": "<p>Based on your above comment (where the error occurs) it seems that the <code>.Value</code> of that cell cannot be determined. This is the case, when a formula is in that cell which produces an error (for example <code>#DIV/0!</code> or <code>#NAME?</code> or <code>#Ref!</code>).</p>\n\n<p>So, I'd suggest that you test the cell's <code>.Value</code> first before you evaluate it:</p>\n\n<pre><code>For Each cell_search In Rng\n    If IsError(cell_search.Value) Then\n        'What should happen in this case?\n    Else\n        If (cell_search.Value) = \"Not in Range\" Then\n            If del Is Nothing Then\n                Set del = cell_search\n            Else: Set del = Union(del, cell_search)\n            End If\n        End If\n    End If\nNext cell_search\n</code></pre>\n\n<p>Please let me know if this resolved the problem for you.</p>\n"}], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37013757, "answer_count": 2, "score": 1, "last_activity_date": 1462313831, "creation_date": 1462305740, "last_edit_date": 1462306743, "question_id": 37013356, "link": "https://stackoverflow.com/questions/37013356/runtime-error-on-delete-loop", "title": "Runtime error on delete loop", "body": "<p>Any ideas why I am getting run-time error type mismatch for the code below? There seems to be an issue with the if statement.</p>\n\n<p>The run-time error is type mismatch</p>\n\n<pre><code>Dim rng As Range\nDim cell_search As Range\nDim del As Range\nDim FrRngCount As Range\nDim I As Integer\nDim DatatoData As Worksheet\n\nSet DatatoData = ThisWorkbook.Worksheets(\"PCA DATA2\")\n\nSet FrRngCount = DatatoData.Range(\"A:A\")\nI = Application.WorksheetFunction.CountA(FrRngCount)\n\nSet rng = Intersect(DatatoData.Range(\"CV2:CV\" &amp; I), DatatoData.UsedRange)\n\nFor Each cell_search In rng\nIf (cell_search.Value) = \"Not in Range\" Then\n    If del Is Nothing Then\n        Set del = cell_search\n    Else: Set del = Union(del, cell_search)\n    End If\nEnd If\nNext cell_search\nOn Error Resume Next\ndel.EntireRow.Delete\n</code></pre>\n\n<p>Thanks for your help. Pete</p>\n"}, {"tags": ["sql-server", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1462309201, "post_id": 37013322, "comment_id": 61580688, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4784820/bind-access-form-to-the-results-from-a-stored-procedure\">Bind Access form to the results from a Stored Procedure</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6287459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0591983878c0514086e48d6a78cdb?s=128&d=identicon&r=PG&f=1", "display_name": "ryan drayton", "link": "https://stackoverflow.com/users/6287459/ryan-drayton"}, "edited": false, "score": 0, "creation_date": 1462378306, "post_id": 37022040, "comment_id": 61615972, "body": "Thank you so much for your help.  I dd have a version of the code using the open method but without the adopenKeySet and the locktype. I am receiving a different error &quot;class does not support automation or expected interface&quot;"}, {"owner": {"reputation": 1377, "user_id": 3641543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZQ2k.jpg?s=128&g=1", "display_name": "RichardCL", "link": "https://stackoverflow.com/users/3641543/richardcl"}, "reply_to_user": {"reputation": 3, "user_id": 6287459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0591983878c0514086e48d6a78cdb?s=128&d=identicon&r=PG&f=1", "display_name": "ryan drayton", "link": "https://stackoverflow.com/users/6287459/ryan-drayton"}, "edited": false, "score": 0, "creation_date": 1462382368, "post_id": 37022040, "comment_id": 61618343, "body": "It might be easier to open a new question showing the updated code that you are now using and which statement the error occurs on."}], "tags": [], "owner": {"reputation": 1377, "user_id": 3641543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZQ2k.jpg?s=128&g=1", "display_name": "RichardCL", "link": "https://stackoverflow.com/users/3641543/richardcl"}, "is_accepted": true, "score": -1, "last_activity_date": 1462351394, "last_edit_date": 1462351394, "creation_date": 1462349557, "answer_id": 37022040, "question_id": 37013322, "link": "https://stackoverflow.com/questions/37013322/receiving-an-error-the-object-you-entered-is-not-a-valid-record-set-property/37022040#37022040", "title": "Receiving an Error &quot; The object you entered is not a valid record set property&quot; access 2013 assigning record set to a form", "body": "<p>You need to call the Open method of an ADO.Recordset object.</p>\n\n<p>To demonstrate this, first create a simple stored procedure in SQL Server.</p>\n\n<pre><code>USE AdventureWorks2016CTP3;\nGO\n\nCREATE PROCEDURE dbo.up_TestPerson\nAS\n    SELECT BusinessEntityID, FirstName, LastName\n        FROM Person.Person;\n</code></pre>\n\n<p>Then create a Microsoft Access form with this code behind.</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    Dim cnn As New ADODB.Connection\ncnn.ConnectionString = \"DRIVER={SQL Server Native Client 11.0};SERVER=V-SQL16-R;DATABASE=AdventureWorks2016CTP3;Trusted_Connection=yes;\"\n    cnn.Open\n\n    Dim cmd1 As New ADODB.Command\n    Set cmd1.ActiveConnection = cnn\n    cmd1.CommandText = \"dbo.up_TestPerson\"\n    cmd1.CommandType = adCmdStoredProc\n\n    Dim rst As New ADODB.Recordset\n    rst.Open cmd1, , adOpenKeyset, adLockPessimistic\n\n    Set Me.Recordset = rst\n\nEnd Sub\n</code></pre>\n\n<p>Open the form, and it displays the data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3VELM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3VELM.png\" alt=\"enter image description here\"></a></p>\n\n<p>To demonstrate using a parameter, create a stored procedure like this. (Same as the first stored procedure, except it has a parameter and a WHERE clause.)</p>\n\n<pre><code>CREATE PROCEDURE dbo.up_TestPerson2\n(\n    @PersonType nchar(2)\n)\nAS\nSELECT BusinessEntityID, FirstName, LastName\n    FROM Person.Person\n    WHERE PersonType = @PersonType;\n</code></pre>\n\n<p>Create another Access form with this code behind. (Same as the first form, except for the block where we create and configure the parameter.)</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    Dim cnn As New ADODB.Connection\n    cnn.ConnectionString = \"DRIVER={SQL Server Native Client 11.0};SERVER=V-SQL16-R;DATABASE=AdventureWorks2016CTP3;Trusted_Connection=yes;\"\n    cnn.Open\n\n    Dim cmd1 As New ADODB.Command\n    Set cmd1.ActiveConnection = cnn\n    cmd1.CommandText = \"dbo.up_TestPerson2\"\n    cmd1.CommandType = adCmdStoredProc\n\n    ' This is new\n    Dim prm1 As ADODB.Parameter\n    Set prm1 = cmd1.CreateParameter(\"@PersonType\", adWChar, adParamInput, 2)\n    cmd1.Parameters.Append prm1\n    prm1.Value = \"EM\"\n\n    Dim rst As New ADODB.Recordset\n    rst.Open cmd1, , adOpenKeyset, adLockPessimistic\n\n    Set Me.Recordset = rst\n\nEnd Sub\n</code></pre>\n\n<p>Open the form and it displays records matching the parameter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DSHi9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DSHi9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5415833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea4e003bb7fc9abccaf1e8e9103b709?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5415833/jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1552349237, "last_edit_date": 1552349237, "creation_date": 1552348141, "answer_id": 55112049, "question_id": 37013322, "link": "https://stackoverflow.com/questions/37013322/receiving-an-error-the-object-you-entered-is-not-a-valid-record-set-property/55112049#55112049", "title": "Receiving an Error &quot; The object you entered is not a valid record set property&quot; access 2013 assigning record set to a form", "body": "<p>I had this problem, spent hours looking for it... turned to be right under my nose:\nA function that had work perfectly well, repopulating an Access combo box from  Mysql backed, suddenly gave this message after I changed adUseClient to adUseServer for barely relevant reasons. Here's the code (with thanks to Author: Christian Coppes) </p>\n\n<pre><code>Public Function fnADOComboboxSetRS(cmb As String, strSQL As String, strCallingForm As String, Optional StrCnnstring As String)\n    On Error GoTo fnADOComboboxSetRS_Error\n\n    Dim sourceDB As New clsAdoDBHelper\n    Dim RS1 As New ADODB.Recordset\n\n    If Len(StrCnnstring &amp; vbNullString) = 0 Then\n       sourceDB.Connect CnString\n    Else\n       sourceDB.Connect StrCnnstring\n\n    End If\n\n    Set RS1 = sourceDB.OpenRecordset(strSQL, adUseClient)\n\n    Set Application.Forms(strCallingForm).Controls(cmb).Recordset = RS1\nfnADOComboboxSetRS_Exit:\n    If Not RS1 Is Nothing Then\n        If RS1.State = adStateOpen Then RS1.Close\n        Set RS1 = Nothing\n    End If\n    Exit Function\n\nfnADOComboboxSetRS_Error:\n    Select Case Err\n        Case Else\n            'fnErr \"modODBC-&gt;fnADOComboboxSetRS\", True\n            Resume fnADOComboboxSetRS_Exit\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6287459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0591983878c0514086e48d6a78cdb?s=128&d=identicon&r=PG&f=1", "display_name": "ryan drayton", "link": "https://stackoverflow.com/users/6287459/ryan-drayton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1618, "favorite_count": 0, "accepted_answer_id": 37022040, "answer_count": 2, "score": 0, "last_activity_date": 1552349237, "creation_date": 1462305638, "last_edit_date": 1462315163, "question_id": 37013322, "link": "https://stackoverflow.com/questions/37013322/receiving-an-error-the-object-you-entered-is-not-a-valid-record-set-property", "title": "Receiving an Error &quot; The object you entered is not a valid record set property&quot; access 2013 assigning record set to a form", "body": "<p>I am using Access 2013 to upgrade an old application with sql 2012 back end.  I have several Stored Procedures with parameters which i need to call and assigned to forms and reports.</p>\n\n<p>The issue i am having is that i get the error \"7965\" every time i try to assigned the returned record set to the form \ni am using the open event of the form and the following code\nPrivate Sub Form_Open(Cancel As Integer)</p>\n\n<pre><code>    Dim cmd1 As ADODB.Command\n    Dim recs1 As New ADODB.Recordset\n    Dim prm1 As ADODB.Parameter\n    Dim prm2 As ADODB.Parameter\n    Dim prm3 As ADODB.Parameter\n    Set cnn = CreateObject(\"ADODB.Connection\")\n\n    cnn.ConnectionString = \"DRIVER={SQL Server Native Client     11.0};SERVER=192.168.0.12;DATABASE=SavingsPlusCorp;Trusted_Connection=yes;\"\n\n\n    cnn.Open cnn.ConnectionString\n    Set cmd1 = New ADODB.Command\n\n\n    Set cmd1.ActiveConnection = cnn\n\n\ncmd1.CommandText = \"dbo.iNVENSOLDSp\"\ncmd1.CommandType = adCmdStoredProc\n\nSet prm1 = cmd1.CreateParameter(\"@branchid\", adInteger, adParamInput, 2)\ncmd1.Parameters.Append prm1\n\nSet prm2 = cmd1.CreateParameter(\" @Beginning_Date\", adDate, adParamInput)\ncmd1.Parameters.Append prm2\n\nSet prm3 = cmd1.CreateParameter(\" @Ending_Date\", adDate, adParamInput)\ncmd1.Parameters.Append prm3\n\nSet prm4 = cmd1.CreateParameter(\"@vENDORID\", adInteger, adParamInput, 2)\ncmd1.Parameters.Append prm4\n\nSet prm5 = cmd1.CreateParameter(\"@catID\", adInteger, adParamInput, 2)\ncmd1.Parameters.Append prm5\n\n\n\nprm1.Value = Form_ReportGenerator.Branches\nprm2.Value = Form_ReportGenerator.Begin_Date\nprm3.Value = Form_ReportGenerator.Ending_Date\nprm4.Value = Form_ReportGenerator.Vendors\nprm5.Value = Form_ReportGenerator.Category\n\n\nSet recs1 = CreateObject(\"ADOdB.recordset\")\n recs1.CursorType = adOpenKeyset\n recs1.CursorLocation = adUseClient\n'Set recs1 = cmd1.Execute\n'recs1.Open\nSet Me.Recordset = cmd1.Execute \n</code></pre>\n\n<p>I have also tried</p>\n\n<pre><code>set me.Recordset= recs1\n</code></pre>\n\n<p>with the same results\nplease help\nThe solution in the the thread identified as a possible is almost identical to my attempt \nIn fact I used it to build my attempt\nI used the command. Execute and assigned it to my form</p>\n\n<pre><code>Set me.RecordSet = cmd1.execute\n</code></pre>\n\n<p>It is this line that returns the error\nIs their an issue with the provider I am using to connect\nI don't understand why it is not working\nPlease help</p>\n"}, {"tags": ["vba", "dynamic"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1462311405, "last_edit_date": 1462311405, "creation_date": 1462305638, "answer_id": 37013321, "question_id": 37013193, "link": "https://stackoverflow.com/questions/37013193/vba-dynamic-cell-reference-in-cell-formula/37013321#37013321", "title": "VBA dynamic cell reference in cell formula", "body": "<p>This is what <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823188.aspx\" rel=\"nofollow\">FormulaR1C1</a> was made for:</p>\n\n<pre><code>Sub foooo()\n\nDim ws As Worksheet\nSet ws = ActiveSheet\nws.Range(\"H1:H100\").FormulaR1C1 = \"=RIGHT(RC-1,LEN(RC-1)-LEN(RC-7))\"\n\nEnd Sub\n</code></pre>\n\n<p>It will do the whole range at once.</p>\n\n<p>If you really want to loop then:</p>\n\n<pre><code>Sub foooo()\nDim i As Long\nDim ws As Worksheet\nSet ws = ActiveSheet\nFor i = 1 To 100\n    ws.Cells(i, \"H\").FormulaR1C1 = \"=RIGHT(RC-1,LEN(RC-1)-LEN(RC-7))\"\nNext i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The problem with your formula is that the default characteristic of a range object is its value not its address.  so:</p>\n\n<pre><code>ActiveCell.Formula = \"=right(offset(\" &amp; ActiveCell.Address(0,0) &amp; \",0,-1),len(offset(\" &amp; ActiveCell.Address(0,0) &amp; \",0,-1)-len(offset(\" &amp; ActiveCell.Address(0,0) &amp; \",0,-7))\"\n</code></pre>\n\n<p>Though I would avoid a column full of OFFSET Functions.  OFFSET is a volatile function in that it calculates every time excel calculates regardless if any of the data to which it refers has changed.  A column full of these will slow down the calculation times.</p>\n"}], "owner": {"reputation": 23, "user_id": 5847159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a9942c773f8383dee60ec9600a6cfda?s=128&d=identicon&r=PG&f=1", "display_name": "ssnch", "link": "https://stackoverflow.com/users/5847159/ssnch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1631, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462311405, "creation_date": 1462305127, "question_id": 37013193, "link": "https://stackoverflow.com/questions/37013193/vba-dynamic-cell-reference-in-cell-formula", "title": "VBA dynamic cell reference in cell formula", "body": "<p>I'm trying to convert this formula \"=RIGHT(G7,LEN(G7)-LEN(OFFSET(H7,0,-7)))\" into VBA and wherever it references cell H7 I want it to use ActiveCell instead as this formula is used in a loop and is entered in a different row each time. Hope I explained my predicament articulately.</p>\n\n<p>My attempt at converting the formula ended with:</p>\n\n<blockquote>\n  <p>ActiveCell.Formula = \"=right(offset(\" &amp; ActiveCell &amp;\n  \",0,-1),len(offset(\" &amp; ActiveCell &amp; \",0,-1)-len(offset(\" &amp; ActiveCell\n  &amp; \",0,-7))\"</p>\n</blockquote>\n\n<p>which gives me Run-time error '1004': Application-defined or object defined error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1462305663, "post_id": 37013190, "comment_id": 61578781, "body": "Have you tried <code>ActiveWorkbook.SaveAs Filename:=uncPathFileName, FileFormat:=52</code>   as in <code>ActiveWorkbook.SaveAs Filename:=x:\\myFile.xlsm, FileFormat:=52</code>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1462305984, "post_id": 37013190, "comment_id": 61578946, "body": "Sorry, it would be as in <code>ActiveWorkbook.SaveAs Filename:=&quot;\\\\fileServer01\\pathPart\\myFile1.xlsm&quot;, FileFormat:=52</code>"}, {"owner": {"reputation": 961, "user_id": 358574, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/44FFS.jpg?s=128&g=1", "display_name": "Tom McDonald", "link": "https://stackoverflow.com/users/358574/tom-mcdonald"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1462306032, "post_id": 37013190, "comment_id": 61578974, "body": "Yes, per your suggestion, I tried that, but I get &quot;application defined error&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 961, "user_id": 358574, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/44FFS.jpg?s=128&g=1", "display_name": "Tom McDonald", "link": "https://stackoverflow.com/users/358574/tom-mcdonald"}, "is_accepted": true, "score": 0, "last_activity_date": 1462306424, "creation_date": 1462306424, "answer_id": 37013524, "question_id": 37013190, "link": "https://stackoverflow.com/questions/37013190/saveas-unc-path-fails-but-mapped-path-works/37013524#37013524", "title": "saveAs UNC path fails but mapped path works", "body": "<p>OK, my bad.  I upon triple checking I discovered the UNC path-part was misspelled.</p>\n"}, {"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1462306716, "creation_date": 1462306716, "answer_id": 37013608, "question_id": 37013190, "link": "https://stackoverflow.com/questions/37013190/saveas-unc-path-fails-but-mapped-path-works/37013608#37013608", "title": "saveAs UNC path fails but mapped path works", "body": "<p>Try using the Filename parameter <code>ActiveWorkbook.SaveAs Filename:=uncPathFileName, FileFormat:=52</code></p>\n\n<p>The drive may be mapped to a share... So you might no have the permissions through the UNC path... </p>\n\n<p>If <code>ActiveWorkbook.SaveAs Filename:=\"\\\\fileServer01\\pathPart\\myFile1.xlsm\", FileFormat:=52</code> then there may be an access issue.</p>\n\n<p>The only other thing i can think of is trying the current format , FileFormat:=CurrentFormat</p>\n"}], "owner": {"reputation": 961, "user_id": 358574, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/44FFS.jpg?s=128&g=1", "display_name": "Tom McDonald", "link": "https://stackoverflow.com/users/358574/tom-mcdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 37013524, "answer_count": 2, "score": 0, "last_activity_date": 1462306716, "creation_date": 1462305118, "last_edit_date": 1531164843, "question_id": 37013190, "link": "https://stackoverflow.com/questions/37013190/saveas-unc-path-fails-but-mapped-path-works", "title": "saveAs UNC path fails but mapped path works", "body": "<p>I have some Excel VBA code below that saves an Excel file.  It works if I save using as a mapped drive, but fails if I use a UNC path.  I double-checked the UNC path and it is correct.</p>\n\n<p>I get: \"Run-time error '1004' method saveAs of object _Workbook failed\"</p>\n\n<pre><code>mappedFileName = \"x:\\myFile.xlsm\"\nuncPathFileName = \"\\\\fileServer01\\pathPart\\myFile1.xlsm\"\nActiveWorkbook.SaveAs mappedFileName, FileFormat:=52 \nActiveWorkbook.SaveAs uncPathFileName, FileFormat:=52 \n</code></pre>\n"}, {"tags": ["vba", "excel", "sumifs"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1462303553, "post_id": 37012703, "comment_id": 61577526, "body": "What sets the color?  Is it a conditional format?"}, {"owner": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462303729, "post_id": 37012703, "comment_id": 61577639, "body": "Yes, green colour is a conditional format."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462303779, "post_id": 37012703, "comment_id": 61577665, "body": "Okay what is the condition that makes it green then?  You will need to use that instead."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1462303784, "post_id": 37012703, "comment_id": 61577669, "body": "If it is conditional formatting, then the obvious and most robust solution is to target the condition that causes green rather than the color green per se."}, {"owner": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "edited": false, "score": 0, "creation_date": 1462304211, "post_id": 37012703, "comment_id": 61577912, "body": "in column A should be unique numbers. If some of them exists in another sheet then this cell is green coloured and this row should be excluded from sumifs"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462304412, "post_id": 37012703, "comment_id": 61578024, "body": "Are you using a formula in the conditional formatting? if so what exactly is it?"}, {"owner": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "edited": false, "score": 0, "creation_date": 1462305123, "post_id": 37012703, "comment_id": 61578477, "body": "=AND(A2&lt;&gt;&quot;&quot;;COUNTIF(Sheets2!A:A;A2)=1)"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "edited": false, "score": 0, "creation_date": 1462306263, "post_id": 37013227, "comment_id": 61579107, "body": "@otis if this solved your question please mark as correct by clicking the check mark by the answer.  It is something only you can do."}, {"owner": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "edited": false, "score": 0, "creation_date": 1462353929, "post_id": 37013227, "comment_id": 61597619, "body": "just for info, how could I re-write that sumproduct formula to VBA command ?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1462305246, "creation_date": 1462305246, "answer_id": 37013227, "question_id": 37012703, "link": "https://stackoverflow.com/questions/37012703/exclude-coloured-cells-from-sumifs/37013227#37013227", "title": "Exclude coloured cells from SumIfs", "body": "<p>You can use SUMPRODUCT() no need for VBA:</p>\n\n<pre><code>=SUMPRODUCT((C1:C100=3)*(D1:D100)*(A1:A100 &lt;&gt;\"\")*(countif(Sheet2!A:A,A1:A100)=1))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6287444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a35fd6ebeee0ab6a8080e33efd76a7?s=128&d=identicon&r=PG&f=1", "display_name": "otis", "link": "https://stackoverflow.com/users/6287444/otis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 37013227, "answer_count": 1, "score": 0, "last_activity_date": 1462305249, "creation_date": 1462303410, "last_edit_date": 1531164843, "question_id": 37012703, "link": "https://stackoverflow.com/questions/37012703/exclude-coloured-cells-from-sumifs", "title": "Exclude coloured cells from SumIfs", "body": "<p>I have a table like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WAAtZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WAAtZ.png\" alt=\"Table for SumIfs\"></a></p>\n\n<p>I need to create some Sumifs command in VBA to exclude green cells from criteria. I have the excel formula =SUMIFS(D:D;C:C;1) and need to add somehow next condition. In VBA I have:</p>\n\n<pre><code>Sub TotalItems()\n    Dim sum As Integer\n    sum = Application.WorksheetFunction.SumIfs(Range(\"D:D\"), Range(\"C:C\"), _\n         3)\n   MsgBox sum\nEnd Sub\n</code></pre>\n\n<p>which returns 10.</p>\n\n<p>I need to count only rows without any border colour in range \"A:A\". I tried to write the formula like this, but it returns an error:</p>\n\n<pre><code> Application.WorksheetFunction.SumIfs(Range(\"D:D\"), Range(\"C:C\"), 3, Range(\"A:A\").Interior.Color, 0)\n</code></pre>\n\n<p>Any idea how to solve this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 1, "last_activity_date": 1462302514, "creation_date": 1462302514, "answer_id": 37012461, "question_id": 37012174, "link": "https://stackoverflow.com/questions/37012174/copy-4-worksheets-from-workbook-a-which-contains-5-worksheets/37012461#37012461", "title": "Copy 4 worksheets from workbook A which contains 5 worksheets", "body": "<p>one solution is create the new workbook (B) and then navigate through the worksheets of workbook (A) copying only the worksheets you want.</p>\n\n<pre><code>Sub test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = Workbooks.Add\n    For Each ws In ThisWorkbook.Worksheets\n        If Not ws.name = \"&lt;name of worksheet you don't wanto to copy&gt;\" Then\n            ws.Copy after:=wb.Worksheets(wb.Worksheets.Count)\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462302514, "creation_date": 1462301498, "last_edit_date": 1531164843, "question_id": 37012174, "link": "https://stackoverflow.com/questions/37012174/copy-4-worksheets-from-workbook-a-which-contains-5-worksheets", "title": "Copy 4 worksheets from workbook A which contains 5 worksheets", "body": "<p>I need to copy 4 worksheets from workbook A which contains 5 worksheets and create a new workbook B and paste the copied worksheets in the new workbook.</p>\n\n<p>I have done it for one sheet. how can i ameliorate this code :</p>\n\n<pre><code>Sub test()\n\n    ThisWorkbook.Sheets.Copy\n\n    'Saving the new workbook B\n    ActiveWorkbook.SaveAs \"C:\\Users\\John\\B.xls\", FileFormat:=18\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "basic"], "comments": [{"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 2, "creation_date": 1462305982, "post_id": 37011796, "comment_id": 61578944, "body": "What do you mean by static typing ?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 0, "creation_date": 1462306261, "post_id": 37011796, "comment_id": 61579106, "body": "@SuperPeanut Yeah, after reading for 30 minutes about different variable calssifications, the same question popped into my mind. :)"}], "answers": [{"tags": [], "owner": {"reputation": 548, "user_id": 5516712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831ee3a6cc04a3d7c1f078c88f701df9?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Roos", "link": "https://stackoverflow.com/users/5516712/ryan-roos"}, "is_accepted": true, "score": 3, "last_activity_date": 1462312744, "creation_date": 1462312744, "answer_id": 37015100, "question_id": 37011796, "link": "https://stackoverflow.com/questions/37011796/what-version-of-visual-basic-introduced-static-types/37015100#37015100", "title": "What version of Visual Basic introduced static types?", "body": "<p>Introduce in the first version of VB.Net (Visual Studio 2003) with the use of Option Strict ON compiler statement. (<a href=\"https://msdn.microsoft.com/en-us/library/zcd4xwzs(v=vs.71).aspx\" rel=\"nofollow\">MSDN</a>)</p>\n"}], "owner": {"reputation": 265968, "user_id": 116, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f6flX.jpg?s=128&g=1", "display_name": "Mark Harrison", "link": "https://stackoverflow.com/users/116/mark-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 37015100, "answer_count": 1, "score": 1, "last_activity_date": 1462312744, "creation_date": 1462300352, "question_id": 37011796, "link": "https://stackoverflow.com/questions/37011796/what-version-of-visual-basic-introduced-static-types", "title": "What version of Visual Basic introduced static types?", "body": "<p>In what version of Visual Basic was the concept of static typing introduced?</p>\n"}]