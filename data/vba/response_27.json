[{"tags": ["string", "vba", "cmd"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5083751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55406f03ac43f8a6faf371d595419926?s=128&d=identicon&r=PG&f=1", "display_name": "John Mandrake", "link": "https://stackoverflow.com/users/5083751/john-mandrake"}, "edited": false, "score": 0, "creation_date": 1437002379, "post_id": 31442857, "comment_id": 50854742, "body": "I will try, Thank you so much."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 55, "user_id": 5083751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55406f03ac43f8a6faf371d595419926?s=128&d=identicon&r=PG&f=1", "display_name": "John Mandrake", "link": "https://stackoverflow.com/users/5083751/john-mandrake"}, "edited": false, "score": 0, "creation_date": 1437002452, "post_id": 31442857, "comment_id": 50854766, "body": "I just found a second double-quote issue. See in-code comments."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1437002472, "post_id": 31442857, "comment_id": 50854769, "body": "It&#39;s one too few, not one too many. Should have been <code>&quot;&quot;&quot;C:\\Program Files\\R\\R-3.2.1\\bin\\i386\\Rscript.exe&quot;&quot; &quot; &amp; fp</code>"}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1437002720, "post_id": 31442857, "comment_id": 50854855, "body": "@GSerg good point. He will also need a space. He should be able to figure that all out if he writes his code on multiple lines and checks his values, which is really what I&#39;m driving at. Teaching someone to fish, so to speak."}, {"owner": {"reputation": 55, "user_id": 5083751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55406f03ac43f8a6faf371d595419926?s=128&d=identicon&r=PG&f=1", "display_name": "John Mandrake", "link": "https://stackoverflow.com/users/5083751/john-mandrake"}, "edited": false, "score": 0, "creation_date": 1437003724, "post_id": 31442857, "comment_id": 50855212, "body": "Thanks guys I was able to make it work, just need a template for a correct string. The debug.print command is a lifesaver. Really useful."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 1, "last_activity_date": 1437002615, "last_edit_date": 1437002615, "creation_date": 1437002340, "answer_id": 31442857, "question_id": 31442802, "link": "https://stackoverflow.com/questions/31442802/vba-concatenation-is-not-working-calling-shell-in-vba/31442857#31442857", "title": "VBA concatenation is not working (Calling Shell in VBA)", "body": "<p>You need another double quote, but you are probably also going to have more problems if you don't check your values as you go. For example, you will also need to add a space.</p>\n\n<p>I suggest changing your code to work like this, and then you can see what path is being used:</p>\n\n<pre><code>Dim fp As String \nDim sPath As String\n\nfp = \"C:\\Users\\OEM\\Documents\\R\\file.R\"\n\n'added double-quote and space right after .exe\"\nsPath  = \"\"\"C:\\Program Files\\R\\R-3.2.1\\bin\\i386\\Rscript.exe\"\" \" &amp; fp \n\n'here's where you'll figure out your issues:\nDebug.Print sPath \n\nCall shell(sPath, vbNormalFocus)\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5083751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55406f03ac43f8a6faf371d595419926?s=128&d=identicon&r=PG&f=1", "display_name": "John Mandrake", "link": "https://stackoverflow.com/users/5083751/john-mandrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 31442857, "answer_count": 1, "score": 1, "last_activity_date": 1437002615, "creation_date": 1437001941, "last_edit_date": 1437002264, "question_id": 31442802, "link": "https://stackoverflow.com/questions/31442802/vba-concatenation-is-not-working-calling-shell-in-vba", "title": "VBA concatenation is not working (Calling Shell in VBA)", "body": "<p>I have the following vba scrip that works fine:</p>\n\n<pre><code>Call shell(\"\"\"C:\\Program Files\\R\\R-3.2.1\\bin\\i386\\Rscript.exe\"\"   C:\\Users\\OEM\\Documents\\R\\file.R\", vbNormalFocus)\n</code></pre>\n\n<p>However when I define a filepath variable:</p>\n\n<pre><code>Dim fp As String\nfp = \"C:\\Users\\OEM\\Documents\\R\\file.R\"\n</code></pre>\n\n<p>and try:</p>\n\n<pre><code>Call shell(\"\"\"C:\\Program Files\\R\\R-3.2.1\\bin\\i386\\Rscript.exe\"\"   &amp; fp &amp; file.R\", vbNormalFocus)\n</code></pre>\n\n<p>the code does not work, I know this is a concatenation problem but I'm struggling to get it right.</p>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 3911, "user_id": 879715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc0d51aceacd0d5b50fc3114730f4cd4?s=128&d=identicon&r=PG", "display_name": "Derek Tomes", "link": "https://stackoverflow.com/users/879715/derek-tomes"}, "edited": false, "score": 0, "creation_date": 1436999960, "post_id": 31442394, "comment_id": 50853930, "body": "Try changing the code to <code>.Value = Now</code> on both lines"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1437000506, "post_id": 31442394, "comment_id": 50854116, "body": "No way to test, but try <code>Format(Now, &quot;mm&#47;dd&#47;yyyy&quot;)</code>?"}, {"owner": {"reputation": 14759, "user_id": 123723, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0af39d29746ae4e1aac45fd517269f58?s=128&d=identicon&r=PG", "display_name": "C-Pound Guru", "link": "https://stackoverflow.com/users/123723/c-pound-guru"}, "edited": false, "score": 0, "creation_date": 1437063555, "post_id": 31442394, "comment_id": 50885907, "body": "<code>dtBeginDate.Value = Format(Now, &quot;short date&quot;)</code> works just fine here if it&#39;s the <code>DTPicker</code> control from <code>MSCOMCT2.OCX</code>. Perhaps you can tell us what type of control <code>dtBeginDate</code> is?"}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1437488383, "post_id": 31442394, "comment_id": 51042622, "body": "sorry it took so long for me to see this, it is the DTPicker control"}], "answers": [{"comments": [{"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1437492984, "post_id": 31442543, "comment_id": 51046319, "body": "I tried both turning off option explicit and changing to the dateNow format, and still recieve the same issue."}], "tags": [], "owner": {"reputation": 3911, "user_id": 879715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc0d51aceacd0d5b50fc3114730f4cd4?s=128&d=identicon&r=PG", "display_name": "Derek Tomes", "link": "https://stackoverflow.com/users/879715/derek-tomes"}, "is_accepted": false, "score": 0, "last_activity_date": 1437000415, "creation_date": 1437000415, "answer_id": 31442543, "question_id": 31442394, "link": "https://stackoverflow.com/questions/31442394/compile-error-method-or-data-member-not-found/31442543#31442543", "title": "Compile error Method or data member not found", "body": "<p>It's been a few years since I did VB6 but... </p>\n\n<p>You may have turned on 'option explicit' which has changed how fussy the compiler is.</p>\n\n<ul>\n<li>dtBeginDate.Value is probably type 'date' </li>\n<li>Format(Now, \"short date\") is type 'string'</li>\n</ul>\n\n<p>Try this:</p>\n\n<pre><code>dtBeginDate.Value = Now\ndtEndDate.Value = Now\n</code></pre>\n\n<p>If you want to remove the time portion of 'Now' you may need to do something like this:</p>\n\n<pre><code>Dim dateNow As Date\ndateNow = DateValue(Now)\ndtBeginDate.Value = dateNow \ndtEndDate.Value = dateNow \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1437492836, "post_id": 31538879, "comment_id": 51046196, "body": "That kept the same issue"}, {"owner": {"reputation": 76, "user_id": 2215383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ba99a0ecb96d1de215e3c619f445d9?s=128&d=identicon&r=PG", "display_name": "SuperDre", "link": "https://stackoverflow.com/users/2215383/superdre"}, "reply_to_user": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1437638980, "post_id": 31538879, "comment_id": 51116275, "body": "Hmmm, then it seems that there is something wrong with the OCX as it should work perfectly normal... Have you tried a new empty project with only the datepicker to check our examples? Otherwise try re-registering the OCX, and it that fails, reinstall the OCX. If it fails on Value, and it is the default microsoft datepicker from the MSCOMCT2.OCX then there is certainly something wrong with the OCX"}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1438101459, "post_id": 31538879, "comment_id": 51306206, "body": "I think you found the issue. I cannot seem to get the ocx to register though. I do it through the elevated cmd and it says it registered successfully,  but then using a the nirsoft register viewer it doesnt show up as registered, and when I go into the project it is saying it isnt registered."}, {"owner": {"reputation": 76, "user_id": 2215383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ba99a0ecb96d1de215e3c619f445d9?s=128&d=identicon&r=PG", "display_name": "SuperDre", "link": "https://stackoverflow.com/users/2215383/superdre"}, "reply_to_user": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1438196514, "post_id": 31538879, "comment_id": 51356080, "body": "Have tried first to unregister it first? then reboot and register it.. Or try something like cleansweep and let it fix the registry and then retry it.."}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1438200388, "post_id": 31538879, "comment_id": 51358236, "body": "I did unregister, then register, I havent tried cleansweep, let me try that."}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1438201922, "post_id": 31538879, "comment_id": 51359082, "body": "I used ccleaner, and did the whole registry fix, still cant get MSCOMCT2.OCX to register."}, {"owner": {"reputation": 76, "user_id": 2215383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ba99a0ecb96d1de215e3c619f445d9?s=128&d=identicon&r=PG", "display_name": "SuperDre", "link": "https://stackoverflow.com/users/2215383/superdre"}, "reply_to_user": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1438329492, "post_id": 31538879, "comment_id": 51415963, "body": "did you try to register it in <b>C:\\Windows\\System32</b> or in <i>*C:\\Windows\\SysWow64*</i> (I&#39;m sorry to ask, don&#39;t want to treat you as a rookie). Or is this the first time you are using VB6 with a 64bit Windows 7? It might be you need to run the IDE in elevated mode.."}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1439308189, "post_id": 31538879, "comment_id": 51802581, "body": "I tried to register it to both of them. (Dont be sorry, I am a rookie to VB) Also I did try running it in elevated mode.."}], "tags": [], "owner": {"reputation": 76, "user_id": 2215383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ba99a0ecb96d1de215e3c619f445d9?s=128&d=identicon&r=PG", "display_name": "SuperDre", "link": "https://stackoverflow.com/users/2215383/superdre"}, "is_accepted": false, "score": 0, "last_activity_date": 1437481215, "creation_date": 1437481215, "answer_id": 31538879, "question_id": 31442394, "link": "https://stackoverflow.com/questions/31442394/compile-error-method-or-data-member-not-found/31538879#31538879", "title": "Compile error Method or data member not found", "body": "<p>how about changing the code to:</p>\n\n<pre><code>Private Sub Form_Load()\n    cmdClose.Visible = False\n    cmdRun.Visible = False\n    lblRun.Visible = False\n    dtBeginDate.Value = Date\n    dtEndDate.Value = Date\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1437577618, "post_id": 31549269, "comment_id": 51089357, "body": "That has not worked either. Keep in mind this was completely working code with no change. I don&#39;t know whether it is not letting me compile because of windows updates (i have seen a few of those online), or what. Thank you for your help. If you get any more ideas let me know."}], "tags": [], "owner": {"reputation": 3911, "user_id": 879715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/dc0d51aceacd0d5b50fc3114730f4cd4?s=128&d=identicon&r=PG", "display_name": "Derek Tomes", "link": "https://stackoverflow.com/users/879715/derek-tomes"}, "is_accepted": false, "score": 0, "last_activity_date": 1437511488, "creation_date": 1437511488, "answer_id": 31549269, "question_id": 31442394, "link": "https://stackoverflow.com/questions/31442394/compile-error-method-or-data-member-not-found/31549269#31549269", "title": "Compile error Method or data member not found", "body": "<p>A <code>\"Method or data member not found\"</code> error probably means that <code>dtBeginDate</code> and <code>dtEndDate</code> don't actually have a <code>.Value</code> property. </p>\n\n<p>Try setting the <code>.Text</code> property instead.</p>\n\n<pre><code>Private Sub Form_Load()\n    cmdClose.Visible = False\n    cmdRun.Visible = False\n    lblRun.Visible = False\n    dtBeginDate.Text = Format(Now, \"short date\")\n    dtEndDate.Text = Format(Now, \"short date\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1442346441, "post_id": 32416244, "comment_id": 53042431, "body": "Ya, in the comments we figured that out. SuperDre pointed me to the ocx i need to register. Now the issue is the fact that the ocx refuses to actually register. (mscomct2.ocx) I believe if I actually get that running, then I will be set."}, {"owner": {"reputation": 10720, "user_id": 999082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/374368c921c7546bb4f38e2ccd633ad6?s=128&d=identicon&r=PG", "display_name": "Jazimov", "link": "https://stackoverflow.com/users/999082/jazimov"}, "reply_to_user": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1442407395, "post_id": 32416244, "comment_id": 53068756, "body": "Where on your system is the mscomct2.ocx file that you&#39;re trying to register (i.e., what is the folder name)? What version of Windows are you using (version and bit-type)? When you&#39;re not in an elevated CMD prompt, can you still see the mscomct2.ocx file when you browse the folder that contains it? Did you try running the nirsoft tool in an elevated command prompt or as Admin--and in that context does it see that the OCX is registered?"}, {"owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1442524137, "post_id": 32416244, "comment_id": 53128573, "body": "I have tried Syswow64, and system32 for folders, I have used elevated cmd, yes I can see it. It says I registered successfully. I have windows 7 64 bit, and the tool (in elevated) does not see it registered"}, {"owner": {"reputation": 10720, "user_id": 999082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/374368c921c7546bb4f38e2ccd633ad6?s=128&d=identicon&r=PG", "display_name": "Jazimov", "link": "https://stackoverflow.com/users/999082/jazimov"}, "reply_to_user": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "edited": false, "score": 0, "creation_date": 1442536860, "post_id": 32416244, "comment_id": 53132664, "body": "Do you know that the VB6 IDE is not supported under Windows 7 64-bit? I think you should make a 32-bit virtual machine that supports the IDE (such as Windows XP 32-bit), install VB6 there from its setup disc, and then manage, debug, and compile your 32-bit exes there. The compiled 32-bit EXEs will run successfully under Windows 7 64-bit (as long as you supply all of the necessary dependencies in the Setup program for your VB6 app)."}], "tags": [], "owner": {"reputation": 10720, "user_id": 999082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/374368c921c7546bb4f38e2ccd633ad6?s=128&d=identicon&r=PG", "display_name": "Jazimov", "link": "https://stackoverflow.com/users/999082/jazimov"}, "is_accepted": false, "score": 0, "last_activity_date": 1441476886, "creation_date": 1441476886, "answer_id": 32416244, "question_id": 31442394, "link": "https://stackoverflow.com/questions/31442394/compile-error-method-or-data-member-not-found/32416244#32416244", "title": "Compile error Method or data member not found", "body": "<p>Jacob,</p>\n\n<p>Here's the deal: You need to first identify what kind of object dtBeginDate and dtEndDate are. Until you know that, you're going to be running around in circles.</p>\n\n<p>Can you find the line of code that declares these dtBeginDate and dtEndDate variables? For example, you show that dateNow is declared as a Date data type. But I don't see what dtBeginDate or dtEndDate are... </p>\n\n<p>If you have controls on the form named dtBeginDate and dtEndDate, then that means there is a DLL or OCX that contains the control code. It also means that your project has a reference to the DLL/OCX that provides the object you've named \"dtBeginDate\". </p>\n\n<p>If the code used to work then obviously you do not have a coding issue.</p>\n\n<p>To best help you, let's first identify if dtBeginDate has been declared as a variable of a certain type--or if it is the name of a control that's on a form. </p>\n"}], "owner": {"reputation": 16, "user_id": 4965764, "user_type": "registered", "profile_image": "https://graph.facebook.com/1118617168165497/picture?type=large", "display_name": "Jacob Baird", "link": "https://stackoverflow.com/users/4965764/jacob-baird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4521, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1441476886, "creation_date": 1436999628, "last_edit_date": 1437493220, "question_id": 31442394, "link": "https://stackoverflow.com/questions/31442394/compile-error-method-or-data-member-not-found", "title": "Compile error Method or data member not found", "body": "<p>I am getting the compile error, method or data member not found. This code is previously compilable with no issues. (Havent had to compile it for almost a year). It highlights both <code>.Value =</code>.</p>\n\n<pre><code>Private Sub Form_Load()\n    cmdClose.Visible = False\n    cmdRun.Visible = False\n    lblRun.Visible = False\n    dtBeginDate.Value = Format(Now, \"short date\")\n    dtEndDate.Value = Format(Now, \"short date\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "office365", "outlook-addin"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1437000515, "creation_date": 1437000515, "answer_id": 31442559, "question_id": 31442373, "link": "https://stackoverflow.com/questions/31442373/microsoft-outlook-appointments-events/31442559#31442559", "title": "Microsoft outlook appointments events", "body": "<p>You can mark it with the appropriate color category. You can watch incoming messages in the Inbox folder using Items.ItemAdd event on the Inbox folder and process the meeting updates for the appointments. </p>\n"}], "owner": {"reputation": 568, "user_id": 2826646, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e483174091e4682f2580971864a918b6?s=128&d=identicon&r=PG", "display_name": "int3", "link": "https://stackoverflow.com/users/2826646/int3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306509, "creation_date": 1436999525, "last_edit_date": 1593306509, "question_id": 31442373, "link": "https://stackoverflow.com/questions/31442373/microsoft-outlook-appointments-events", "title": "Microsoft outlook appointments events", "body": "<p>Is there anyway to mark any appointments automatically with red in case of refused or green in case of accepted and prevent it being deleted from the calendar when refused?\nI thought searching and programming it with VBA but I'm kind of lost on this and I need help.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436999637, "post_id": 31442329, "comment_id": 50853807, "body": "What a concept. I appreciate it."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436999803, "post_id": 31442329, "comment_id": 50853871, "body": "@THATnewbie For additional information, do not forget to visit <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">MSDN</a>. To know more about coding explicitly in VBA, <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this is a good read</a>."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1437000019, "post_id": 31442329, "comment_id": 50853948, "body": "@L42 That link is actually not the right one-- it&#39;s for Visual Basic .NET"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 4, "last_activity_date": 1436999988, "last_edit_date": 1436999988, "creation_date": 1436999318, "answer_id": 31442329, "question_id": 31442293, "link": "https://stackoverflow.com/questions/31442293/vba-to-only-run-on-a-certain-worksheet/31442329#31442329", "title": "VBA to only run on a certain worksheet", "body": "<p><strong>Put a dot before \"Rows\"</strong></p>\n\n<p>Your reference \"Rows\" is using whatever active Rows (equivalent to ActiveSheet.Rows), but the dot will use the \"With\" block.</p>\n\n<pre><code>With Worksheets(\"Sheet 1\")\n    .Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nEnd With\n</code></pre>\n\n<p>Without the dot, the With block isn't even considered and the code is equivalent to:</p>\n\n<pre><code> Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>This is also true for the bang operator (!).</p>\n\n<p>Reference:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa266330(v=vs.60).aspx\" rel=\"nofollow\">VBA With Statement</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 2, "last_activity_date": 1437005648, "creation_date": 1437005648, "answer_id": 31443359, "question_id": 31442293, "link": "https://stackoverflow.com/questions/31442293/vba-to-only-run-on-a-certain-worksheet/31443359#31443359", "title": "VBA to only run on a certain worksheet", "body": "<p>For a single line of code I would not bother with a With statement:</p>\n\n<pre><code>Worksheets(\"Sheet 1\").Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 4873023, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e9c1585e7555cbab6f857c2ea04806fe?s=128&d=identicon&r=PG&f=1", "display_name": "san-san", "link": "https://stackoverflow.com/users/4873023/san-san"}, "is_accepted": false, "score": 0, "last_activity_date": 1437038093, "creation_date": 1437038093, "answer_id": 31450086, "question_id": 31442293, "link": "https://stackoverflow.com/questions/31442293/vba-to-only-run-on-a-certain-worksheet/31450086#31450086", "title": "VBA to only run on a certain worksheet", "body": "<p>Add '.' in Rows ...</p>\n\n<pre><code>With Worksheets(\"Sheet 1\")\n     .Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4066, "favorite_count": 0, "accepted_answer_id": 31442329, "answer_count": 3, "score": 1, "last_activity_date": 1437038093, "creation_date": 1436999174, "last_edit_date": 1436999852, "question_id": 31442293, "link": "https://stackoverflow.com/questions/31442293/vba-to-only-run-on-a-certain-worksheet", "title": "VBA to only run on a certain worksheet", "body": "<p>The code below will insert a new row above column 2 whenever the macro is ran. However, if I click a different sheet and run the macro, it inserts a new row in that sheet instead of <strong>Sheet 1</strong> like I had specified. Is there a way to make it so that when I run the macro it will only do those actions on a particular sheet no matter what sheet I am on?</p>\n\n<pre><code>With Worksheets(\"Sheet 1\")\n    Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nEnd With\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 1072, "user_id": 2697034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/562538339/picture?type=large", "display_name": "LaRae White", "link": "https://stackoverflow.com/users/2697034/larae-white"}, "edited": false, "score": 0, "creation_date": 1437006818, "post_id": 31442108, "comment_id": 50855994, "body": "I updated my question to include how I&#39;m filling my array as well as added in the Operator param, but now nothing comes back filtered at all in the subsequent sheets."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1436998697, "last_edit_date": 1436998697, "creation_date": 1436998394, "answer_id": 31442108, "question_id": 31441972, "link": "https://stackoverflow.com/questions/31441972/vba-autofilter-multiple-worksheets-based-on-array-of-numbers-ignore-if-not-in-l/31442108#31442108", "title": "VBA AutoFilter multiple worksheets based on array of numbers, ignore if not in list", "body": "<p>If you use arrays as <em>Criteria</em>, you'll have to use a 1D array.<br>\nBut then, you need to supply the <code>Operator</code> argument to actually filter all that is in the array.</p>\n\n<p><strong>Sample:</strong></p>\n\n<pre><code>ActiveSheet.UsedRange.AutoFilter Field:=columnNum, _\n                                 Criteria1:=mainIDs, _\n                                 Operator:xlFilterValues\n</code></pre>\n\n<p>To know more about <em>AutoFilter Method</em> check <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884(v=office.15).aspx\" rel=\"nofollow\">MSDN</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": true, "score": 1, "last_activity_date": 1437026196, "creation_date": 1437026196, "answer_id": 31446268, "question_id": 31441972, "link": "https://stackoverflow.com/questions/31441972/vba-autofilter-multiple-worksheets-based-on-array-of-numbers-ignore-if-not-in-l/31446268#31446268", "title": "VBA AutoFilter multiple worksheets based on array of numbers, ignore if not in list", "body": "<p>If you use an array for filtering you have to cast the values to strings before.\nAs I understood you're adding integer/long values to the array. Autofilter can't work with this.</p>\n\n<p>In addition you have to change your array to a string array <code>mainIDs() as String</code> or declare it as Variant.</p>\n\n<pre><code>For Each row In .UsedRange.Columns(1).SpecialCells(xlCellTypeVisible)\n    If row.Value &lt;&gt; \"ID\" Then '***Column header\n        mainIDs(i) = Cstr(row.Value) 'Cast values to string\n        i = i + 1\n    End If\nNext\n</code></pre>\n\n<p>Then it should work, please let me know if it helped you.</p>\n"}], "owner": {"reputation": 1072, "user_id": 2697034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/562538339/picture?type=large", "display_name": "LaRae White", "link": "https://stackoverflow.com/users/2697034/larae-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 31446268, "answer_count": 2, "score": 1, "last_activity_date": 1437026196, "creation_date": 1436997828, "last_edit_date": 1437006714, "question_id": 31441972, "link": "https://stackoverflow.com/questions/31441972/vba-autofilter-multiple-worksheets-based-on-array-of-numbers-ignore-if-not-in-l", "title": "VBA AutoFilter multiple worksheets based on array of numbers, ignore if not in list", "body": "<p>Let's say I have a workbook with 3 worksheets on it. I've filtered down the first sheet based on column <strong>State</strong> that equals <em>Ohio</em>. I then get a list of values from that filtered list from column <strong>ID</strong> and put them into an Integer/Long array. Basically I put all the <strong>ID's</strong> for each row that has the state column <em>Ohio</em>.</p>\n\n<p>I am now trying to filter the remaining tables based on their <strong>ID</strong> column where they match my array of <strong>ID's</strong>. The problem is when it comes across filtered <strong>ID's</strong> that are not in the new sheet, instead of providing me with the matches for each sheet, I am left with only the last matching value. Here's an example of my VBA trying to filter the remaining sheets:</p>\n\n<pre><code>For Each sheet In Worksheets\n\nIf sheet.Name &lt;&gt; \"Sheet1\" Then\n    sheet.Activate        \n\n    columnNum = ActiveSheet.UsedRange.Find(\"ID\").Column\n    ActiveSheet.AutoFilterMode = False\n    ActiveSheet.UsedRange.AutoFilter\n\n    '***Problem is here\n    ActiveSheet.UsedRange.AutoFilter Field:=columnNum, Criteria1:=mainIDs, Operator:=xlFilterValues\n\nEnd If\n\nNext\n</code></pre>\n\n<p>As I mentioned earlier <code>mainIDs</code> is an array of Integer that is being carried over to each sheet to filter on. Why is it only bringing me back the last match? Do I need to somehow tell it to ignore filtered values that aren't in the new sheet? How?</p>\n\n<p><strong>EDIT:</strong> Here's how I filled my array</p>\n\n<pre><code>Dim mainIDs() As Long, size As Integer, i As Integer\n\nsize = ActiveSheet.UsedRange.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 2\nReDim mainIDs(size)\n\ni = 0\nFor Each row In .UsedRange.Columns(1).SpecialCells(xlCellTypeVisible)\n    If row.Value &lt;&gt; \"ID\" Then '***Column header\n        mainIDs(i) = row.Value\n        i = i + 1\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436996751, "post_id": 31441376, "comment_id": 50852625, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a> has <code>xlCellTypeFormula</code> as one of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow noreferrer\">xlCellType constants</a> to look for. That may significantly reduce the cells to cycle through."}], "tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1436995315, "creation_date": 1436995315, "answer_id": 31441376, "question_id": 31441375, "link": "https://stackoverflow.com/questions/31441375/scrape-excel-formulas-from-cells/31441376#31441376", "title": "Scrape Excel formulas from cells", "body": "<p>The answer depends on the type of output wanted.</p>\n\n<p>For starters, it is possible to expose all formulas by converting all fields to text format. (Try this on a copy of the document so you don't have to rely on the UNDO command to revert things back to their original format.)</p>\n\n<p>Another approach is to create a worksheet in Excel containing the Source worksheet name, cell address, and formula, in three separate columns.</p>\n\n<pre><code>Public Sub ListFormulas()\n\n  Dim sWS As Worksheet\n  Dim tWS As Worksheet\n  Dim lRow As Long\n  Dim aCell As Range\n\n  With ActiveWorkbook\n    Set sWS = .Sheets(\"BiosList 2.16\")   'SourceWorksheetName\n    Set tWS = .Sheets(\"Junk\")    '*** i.e. where the list will be created  TargetWorksheetName\n\n  End With\n\n  With tWS\n    .Range(\"A1\").Value = \"Source Worksheet\"\n    .Range(\"B1\").Value = \"Cell Address\"\n    .Range(\"C1\").Value = \"Formula\"\n  End With\n\n  lRow = 2    '*** Start target list in row 2\n\n  For Each aCell In sWS.UsedRange\n    If Left(aCell.Formula, 1) = \"=\" Then\n      With tWS\n        .Range(\"A\" &amp; lRow).Value = sWS.Name\n        .Range(\"B\" &amp; lRow).Value = aCell.Address\n        .Range(\"C\" &amp; lRow).Value = \"'\" &amp; aCell.Formula\n      End With\n      lRow = lRow + 1\n    End If\n  Next aCell\n  MsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1436999748, "creation_date": 1436999748, "answer_id": 31442422, "question_id": 31441375, "link": "https://stackoverflow.com/questions/31441375/scrape-excel-formulas-from-cells/31442422#31442422", "title": "Scrape Excel formulas from cells", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> has <code>xlCellTypeFormula</code> as one of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow\">xlCellType constants</a> to look for. That may significantly reduce the cells to cycle through as opposed to using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837123.aspx\" rel=\"nofollow\">Range .HasFormula property</a> or the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> looking for <code>=*</code> within the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215923%28v=office.11%29.aspx\" rel=\"nofollow\">UsedRange property</a>.</p>\n\n<pre><code>Option Explicit\n\nSub enumFormulas()\n    Dim f As Long, w As Long, ws As Worksheet\n    Dim fws As String, rng As Range, allFormulas As Range\n    Dim vPROPs As Variant\n\n    On Error GoTo bm_Safe_Exit\n    appTGGL\n    fws = \"Formulas\"\n\n    On Error GoTo bm_New_List_ws\n    Set ws = Sheets(fws)\n    On Error GoTo bm_Safe_Exit\n    For w = 1 To Worksheets.Count\n        With Worksheets(w)\n            If LCase(.Name) = LCase(fws) Then GoTo bm_Next_ws\n            On Error Resume Next\n            Set allFormulas = .Cells.SpecialCells(xlCellTypeFormulas, 23)\n            On Error GoTo bm_Safe_Exit\n\n            If Not allFormulas Is Nothing Then\n                For Each rng In allFormulas\n                    With rng\n                        vPROPs = Array(.Parent.Name, _\n                                       .Address(0, 0), _\n                                       .Value, _\n                                       .Value2, _\n                                       .Text, _\n                                       .Formula, _\n                                       .FormulaR1C1, _\n                                       .NumberFormat)\n                    End With\n                    With ws.Cells(Rows.Count, 1).End(xlUp) _\n                      .Offset(1, 0).Resize(1, UBound(vPROPs))\n                        .NumberFormat = \"@\"\n                        .Offset(0, 2).Resize(1, 1).NumberFormat = vPROPs(UBound(vPROPs))\n                        .Offset(0, 3).Resize(1, 1).NumberFormat = \"General\"\n                        .Value2 = vPROPs\n                    End With\n                Next\n            End If\nbm_Next_ws:\n        End With\n    Next w\n\nGoTo bm_Safe_Exit\nbm_New_List_ws:\n    If Err.Number = 9 Then\n        vPROPs = Array(\"Worksheet\", \",Address\", \".Value\", \".Value2\", \".Text\", \".Formula\", \".FormulaR1C1\")\n        Worksheets.Add after:=Sheets(Sheets.Count)\n        With Sheets(Sheets.Count)\n            .Name = fws\n            .Cells(1, 1).Resize(1, UBound(vPROPs) + 1) = vPROPs\n        End With\n        Resume\n    End If\nbm_Safe_Exit:\n    appTGGL\nEnd Sub\n\nSub appTGGL(Optional bTGGL As Boolean = True)\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.ScreenUpdating = bTGGL\n    Application.Cursor = IIf(bTGGL, xlDefault, xlWait)\nEnd Sub\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> with its <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells property</a> have numerous properties and other valid information for documenting a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224506(v=office.11).aspx\" rel=\"nofollow\">Worksheet object</a> or a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow\">Worksheets collection</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1437005930, "creation_date": 1437005930, "answer_id": 31443391, "question_id": 31441375, "link": "https://stackoverflow.com/questions/31441375/scrape-excel-formulas-from-cells/31443391#31443391", "title": "Scrape Excel formulas from cells", "body": "<p>You just want to see the formulas as opposed to the result?</p>\n\n<pre><code>CTRL-` \n</code></pre>\n\n<p>(Key under the esc key on the keyboard, to the left of 1) cycles between formula and result view in a worksheet.</p>\n"}], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1437005930, "creation_date": 1436995315, "last_edit_date": 1531164843, "question_id": 31441375, "link": "https://stackoverflow.com/questions/31441375/scrape-excel-formulas-from-cells", "title": "Scrape Excel formulas from cells", "body": "<p>For documentation purposes, I want to catalog all formulas within a worksheet. How would I go about it in VBA? </p>\n\n<p>Show the VBA used to loop through all cells in a worksheet and copy only the formulas to another list.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1437054301, "post_id": 31441856, "comment_id": 50878928, "body": "I used <code>objShape.Fill.Solid</code> but without any results. Right now the result is that the new picture is added without deleting the old one"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1437000903, "last_edit_date": 1437000903, "creation_date": 1436997369, "answer_id": 31441856, "question_id": 31441010, "link": "https://stackoverflow.com/questions/31441010/vba-delete-picture-within-textbox/31441856#31441856", "title": "VBA delete picture within textbox", "body": "<p><strong>Use the Shape.Fill property</strong> </p>\n\n<p>This returns a FillFormat object which is used to add or remove Pictures.</p>\n\n<pre><code>'This will clear the existing picture\nobjShape.Fill.Solid\n\n'This will set a picture using a path\nobjShape.Fill.UserPicture (\"C:\\Users\\Public\\Pictures\\Sample Pictures\\Lighthouse.jpg\")\n</code></pre>\n\n<p>Reference:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff845248(v=office.14).aspx\" rel=\"nofollow\">FillFormat Members (Word)</a></li>\n</ul>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "is_accepted": false, "score": 0, "last_activity_date": 1437061077, "creation_date": 1437061077, "answer_id": 31458679, "question_id": 31441010, "link": "https://stackoverflow.com/questions/31441010/vba-delete-picture-within-textbox/31458679#31458679", "title": "VBA delete picture within textbox", "body": "<p>Okay, so the solution was pretty simple... and now I don't have to reinsert the caption and the references are still there.</p>\n\n<pre><code> Set rng = objShape.TextFrame.TextRange\n rng.InlineShapes(1).Delete\n Set picture = rng.InlineShapes.AddPicture(fileName:=fullPath, LinkToFile:=False, SaveWithDocument:=True)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1437061077, "creation_date": 1436994083, "last_edit_date": 1436995045, "question_id": 31441010, "link": "https://stackoverflow.com/questions/31441010/vba-delete-picture-within-textbox", "title": "VBA delete picture within textbox", "body": "<p>So I have a document with textboxes that contain a picture and caption. I have written a code to loop through the objects, check if the object is a textbox, and if so, copies the text of the caption, clears the textbox, replaces the picture with an updated one, and reinserts the caption.</p>\n\n<p>However, the document has already made cross references that reference the captions. So when I reinsert the captions, the cross references no longer work. I think I can solve this issue by deleting only the picture within each textbox, so the caption stays and the cross references work.</p>\n\n<p>I'm not sure how to reference the picture, though, within my code. Any help would be appreciated!</p>\n\n<pre><code> For Each objShape In ActiveDocument.Shapes\n    If objShape.Type = msoTextBox Then\n\n       str = objShape.TextFrame.TextRange.Text\n        If InStr(str, \"(\") &gt; 0 Then\n            captionTag = BetweenParentheses(str)\n            If captionTag = imageTag Then\n                If InStr(str, \"Figure\") &gt; 0 Then\n\n                   'problem area\n                    Dim objPic As Word.InlineShapes\n                    objPic.Delete\n\n\n                   'does stuff\n                    Dim firstTerm As String\n                    Dim secondTerm As String\n                    Dim caption As String\n                    Dim caption2 As String\n\n                    firstTerm = \":\"\n                    secondTerm = \")\"\n\n                    Dim startPos As Long\n                    Dim stopPos As Long\n                    Dim nextPosition As Long\n                    nextPosition = 1\n\n                    caption = objShape.TextFrame.TextRange\n\n\n                    Do Until nextPosition = 0\n                        startPos = InStr(nextPosition, caption, firstTerm, vbTextCompare) + 1\n                        stopPos = InStr(startPos, caption, secondTerm, vbTextCompare) + 1\n                        caption = Mid$(caption, startPos + Len(firstTerm), stopPos - startPos - Len(firstTerm))\n                        nextPosition = InStr(stopPos, caption, firstTerm, vbTextCompare)\n                   Loop\n\n\n\n                    Set rng = objShape.TextFrame.TextRange\n                    Set picture = rng.InlineShapes.AddPicture(fileName:=fullPath, LinkToFile:=False, SaveWithDocument:=True)\n                    picture.ScaleHeight = 29.5 \n                    picture.ScaleWidth = 29.5\n                    rng.InsertCaption Label:=\"Figure\", Title:=\": \" &amp; caption, position:=wdCaptionPositionBelow, ExcludeLabel:=False\n\n                    With objShape.TextFrame\n                        .TextRange.Font.Name = \"Calibri Light\"\n                        .TextRange.Font.Size = 9\n                        .TextRange.Font.Color = RGB(79, 129, 189)\n                    End With\n                    'Next objPic\n                End If\n            End If\n        End If\n    End If\n\nNext objShape\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table", "interpolation"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437001717, "post_id": 31440647, "comment_id": 50854535, "body": "How is the Pivot Table set up?  I&#39;m not clear on how you are doing that Calculated Field.  Also regarding speed, the math here seems relatively simple (unless your custom formula is doing something not obvious), so it&#39;s not entirely clear why it is so slow.  I assume 50x50=2500 combinations/interpolations?  Even so, that should be manageable.  What did the <code>INDEX&#47;MATCH</code> approach look like?  Finally, is your actual data arranged as above?  You should be able to compute it fairly quickly in that form, skipping every other row (or returning the same value)."}], "owner": {"reputation": 103, "user_id": 4528961, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/461c21411b718be05690f5f3824737ad?s=128&d=identicon&r=PG&f=1", "display_name": "Helos35", "link": "https://stackoverflow.com/users/4528961/helos35"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1436992892, "creation_date": 1436992892, "question_id": 31440647, "link": "https://stackoverflow.com/questions/31440647/interpolated-calculated-field-in-excel-2010-pivot-tables", "title": "Interpolated Calculated Field in Excel 2010 Pivot Tables", "body": "<p>I'm attempting to use pivot tables to interpolate a value from a large, multi variable table in excel. Is there any way to interpolate on a range within a Calculated Field? (Or any other good way to accieve this).</p>\n\n<p>What I'm trying to do - \nI have the following table, and I'm trying to interpolate the Delta for each combination of Alpha and Beta at a Gamma of 5. With this simplified data, the answer would 15 for each set Alpha/Beta. In my real data, the Gammas and Deltas are not always nice even arrays, though they are sorted properly. </p>\n\n<pre><code>Alpha   Beta    Gamma   Delta\nA       X        0      10\nA       X       10      20\nA       Y        0      10\nA       Y       10      20\nB       X        0      10\nB       X       10      20\nB       Y        0      10\nB       Y       10      20\n</code></pre>\n\n<p>What I've tried\nFormula -> Calculated Field -> Formula: = INTERP(5,Gamma,Delta)\n*Note that INTERP is a custom linear interpolater. yv = INTERP(xv,x,y).</p>\n\n<p>Excel won't let me do that, so I was wondering if there is a better way? I could obviously just manualy pull the interpolation arrays, but my data has ~50 Alphas and ~50 Betas, so that would take a very long time. I've tried automatically pulling the arrays with a combination of INDEX and MATCH (using array formulas), and it works. The only problem is that it becomes so slow that every time the cells recalculate, it ties up the program for ~30 seconds or so. </p>\n\n<p>Any ideas would be appreciated. I'm thinking of using pivot tables, but a regular formula solution or VBA solution would work too.  Thanks!</p>\n"}, {"tags": ["vba", "excel", "graph"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1437002139, "post_id": 31440643, "comment_id": 50854663, "body": "Why can&#39;t you add a picture?  You have the rep.  Is the data sensitive?  If so, can you make it gibberish for example&#39;s sake?  I see no obvious reason that call would fail there.  If you want better control over the <code>Series</code> you should use <code>SeriesCollection.NewSeries</code> and manually set the <code>XValues</code> and <code>Values</code> to the <code>Range</code> that you want.  It provides much greater control than <code>SetSourceData</code>.  If you comment that line out, does it run correctly... or is more going wrong than that line?"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1446036637, "post_id": 31440643, "comment_id": 54574415, "body": "You need to use <code>PlotBy</code> in <code>SetSourceData</code>, as in <code>.SetSourceData Source:=_range_, PlotBy:=xlColumns</code>."}], "answers": [{"tags": [], "owner": {"reputation": 363, "user_id": 2253290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3fb61a991ec4d32280cf9e4702bff868?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/2253290/benoit"}, "is_accepted": false, "score": 1, "last_activity_date": 1437005594, "creation_date": 1437005594, "answer_id": 31443355, "question_id": 31440643, "link": "https://stackoverflow.com/questions/31440643/excel-source-data-wrong-direction/31443355#31443355", "title": "Excel source data wrong direction", "body": "<p>Thanks to @Byron Wall's, creating series manually with <code>.SeriesCollection.NewSeries</code> instead of <code>.SetSourceData</code> worked really well. Here's the working code</p>\n\n<pre><code>With ActiveSheet.ChartObjects.Add _\n        (Left:=10, Width:=480, Top:=240, Height:=265)\n    With .Chart\n        .ChartType = xlLineMarkers\n\n        .SeriesCollection.NewSeries\n        .SeriesCollection(1).Values = Sheets(\"Results\").Range(\"D4:D\" &amp; seasonCount + 3)\n        .SeriesCollection(1).XValues = Sheets(\"Results\").Range(\"A4:A\" &amp; seasonCount + 3)\n        .SeriesCollection(1).Name = \"Indice de rigueur hivernale\"\n        .SeriesCollection(1).MarkerStyle = xlMarkerStyleCircle\n        .SeriesCollection(1).Format.Line.Weight = 4\n        .SeriesCollection(1).Border.Weight = 0.75\n\n        .SeriesCollection.NewSeries\n        .SeriesCollection(2).Values = Sheets(\"Results\").Range(\"G4:G\" &amp; seasonCount + 3)\n        .SeriesCollection(2).ChartType = xlColumnClustered\n        .SeriesCollection(2).AxisGroup = 2\n        .SeriesCollection(2).Name = \"Consommation de sel totale\"\n\n        With .SeriesCollection(2).Format.Line\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.349999994\n            .Transparency = 0\n        End With\n        With .SeriesCollection(2).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.25\n            .Transparency = 0\n            .Solid\n        End With\n\n        .SetElement (msoElementChartTitleAboveChart)\n        .SetElement (msoElementLegendBottom)\n        .SetElement (msoElementPrimaryValueAxisTitleRotated)\n        .SetElement (msoElementSecondaryValueAxisTitleRotated)\n        .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Indice de rigueur hivernale\"\n        .Axes(xlValue, xlSecondary).AxisTitle.Text = \"Consommation de sel (tonnes)\"\n        .ChartStyle = 19\n        .ChartTitle.Text = \"Indice par rapport au sel total\"\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 2253290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3fb61a991ec4d32280cf9e4702bff868?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/2253290/benoit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1437005594, "creation_date": 1436992889, "last_edit_date": 1437004882, "question_id": 31440643, "link": "https://stackoverflow.com/questions/31440643/excel-source-data-wrong-direction", "title": "Excel source data wrong direction", "body": "<p>I get parameter not valid at line <code>.SeriesCollection(1).MarkerStyle = xlMarkerStyleCircle</code></p>\n\n<p>The thing is that my Source Data doesn't seem to work, or rather, does work, but not like I think it would.</p>\n\n<p>I'm unable to add picture, so I'll try the best I can describe what is happening and what I'm looking for.</p>\n\n<p>To help, here's a table </p>\n\n<pre><code>3    season A      col B  col C col D    col E   col F   col G\n4    2010 - 2011       9,66   1,25  10,9    10175   20837   31012\n5    2011 - 2012       7,34   0,62  8       8110    21884   29994\n6    2012 - 2013       7,84   0,18  8       6840    17943   24783\n</code></pre>\n\n<p>Which <code>seasonCount = 3</code></p>\n\n<p>What I have : The series are horizontaly and depend on the number of season. Like for this table above, I get 3 seriesCollection. And again for this table, <code>seriesCollection(1) is D4:G4</code></p>\n\n<p>What I want Vertical Series, SourceData is <code>\"D4:G\" &amp; seasonCount + 3</code> which would be D4 to G6. With <code>SeriesCollection(1) = \"D4:D6\"</code> I then delete collections corresponding to col E and col F and now <code>SeriesCollection(2) = \"G4:G6\"</code></p>\n\n<pre><code>With ActiveSheet.ChartObjects.Add _\n        (Left:=10, Width:=480, Top:=240, Height:=265)\n    With .Chart\n        .ChartType = xlLineMarkers\n\n        .SetSourceData Source:=Sheets(\"Results\").Range(\"D4:G\" &amp; seasonCount + 3)\n\n        .SeriesCollection(1).XValues = Sheets(\"Results\").Range(\"A4:A\" &amp; seasonCount + 3)\n        .SeriesCollection(1).Name = \"Indice de rigueur hivernale\"\n        .SeriesCollection(1).MarkerStyle = xlMarkerStyleCircle\n        .SeriesCollection(1).Format.Line.Weight = 4\n        .SeriesCollection(1).Border.Weight = 0.75\n\n        .SeriesCollection(2).Delete\n        .SeriesCollection(2).Delete\n\n        .SeriesCollection(2).ChartType = xlColumnClustered\n        .SeriesCollection(2).AxisGroup = 2\n        .SeriesCollection(2).Name = \"Consommation de sel totale\"\n\n        With .SeriesCollection(2).Format.Line\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.349999994\n            .Transparency = 0\n        End With\n        With .SeriesCollection(2).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.25\n            .Transparency = 0\n            .Solid\n        End With\n\n        .SetElement (msoElementChartTitleAboveChart)\n        .SetElement (msoElementLegendBottom)\n        .SetElement (msoElementPrimaryValueAxisTitleRotated)\n        .SetElement (msoElementSecondaryValueAxisTitleRotated)\n        .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Indice de rigueur hivernale\"\n        .Axes(xlValue, xlSecondary).AxisTitle.Text = \"Consommation de sel (tonnes)\"\n        .ChartStyle = 19\n        .ChartTitle.Text = \"Indice par rapport au sel total\"\n    End With\nEnd With\n</code></pre>\n\n<p>EDIT**</p>\n\n<p>I wasn't able to add a picture earlier but now I can. This is the results :\n<img src=\"https://i.stack.imgur.com/p0m46.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is another table that is working perfectly fine, as you can see, there isn't much change in the code. The difference is the <code>seasonCount</code> variable and the fact that the X axis is now column A and not B. </p>\n\n<p>Working Code and Graph :</p>\n\n<p><img src=\"https://i.stack.imgur.com/64X89.jpg\" alt=\"EDIT\"></p>\n\n<pre><code>With ActiveSheet.ChartObjects.Add _\n        (Left:=10, Width:=480, Top:=240, Height:=265)\n    With .Chart\n        .ChartType = xlLineMarkers\n\n        .SetSourceData Source:=Sheets(\"Results\").Range(\"E4:H10\")\n\n\n        .SeriesCollection(1).XValues = Sheets(\"Results\").Range(\"B4:B10\")\n        .SeriesCollection(1).Name = \"Indice de rigueur hivernale\"\n        .SeriesCollection(1).MarkerStyle = xlMarkerStyleCircle\n        .SeriesCollection(1).Format.Line.Weight = 4\n        .SeriesCollection(1).Border.Weight = 0.75\n\n        .SeriesCollection(2).Delete\n        .SeriesCollection(2).Delete\n\n        .SeriesCollection(2).ChartType = xlColumnClustered\n        .SeriesCollection(2).AxisGroup = 2\n        .SeriesCollection(2).Name = \"Consommation de sel totale\"\n\n        With .SeriesCollection(2).Format.Line\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.349999994\n            .Transparency = 0\n        End With\n        With .SeriesCollection(2).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = -0.25\n            .Transparency = 0\n            .Solid\n        End With\n\n        .SetElement (msoElementChartTitleAboveChart)\n        .SetElement (msoElementLegendBottom)\n        .SetElement (msoElementPrimaryValueAxisTitleRotated)\n        .SetElement (msoElementSecondaryValueAxisTitleRotated)\n        .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Indice de rigueur hivernale\"\n        .Axes(xlValue, xlSecondary).AxisTitle.Text = \"Consommation de sel (tonnes)\"\n        .ChartStyle = 19\n        .ChartTitle.Text = \"Indice par rapport au sel total\"\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1437023710, "post_id": 31441473, "comment_id": 50860352, "body": "Did you ever try this?"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 1, "last_activity_date": 1437035942, "last_edit_date": 1437035942, "creation_date": 1436995745, "answer_id": 31441473, "question_id": 31440567, "link": "https://stackoverflow.com/questions/31440567/trying-to-use-vba-to-write-query-in-access/31441473#31441473", "title": "Trying to use VBA to write query in Access", "body": "<p>Is there a better way to write the VBA or see an Error?</p>\n\n<p><strong>Yes. You need Error Handling</strong></p>\n\n<p>I don't think the issue is in the code, I think it's in the SQL.</p>\n\n<p>To troubleshoot your code, wrap it in an good error handler.</p>\n\n<pre><code>Public Sub MyRoutine()\n\n    On Error GoTo EH\n\n    'put your code here\n\n    GoTo FINISH\n\nEH:\n\n    With Err\n        MsgBox \"Error\" &amp; vbTab &amp; .Number &amp; vbCrLf _\n            &amp; \"Source\" &amp; vbTab &amp; .Source &amp; vbCrLf &amp; vbCrLf _\n            &amp; .Description\n    End With\n\n    'for use during debugging\n    Debug.Assert 0\n    GoTo FINISH\n    Resume\n\nFINISH:\n\n    'any cleanup code here\n\nEnd Sub\n</code></pre>\n\n<p>When the msgbox shows the error, make note of the Source. This should help you determine where the error comes from.</p>\n\n<p>The lines following 'for use during debugging are helpful. Here's how to use them: </p>\n\n<ul>\n<li>execution will stop on the Debug.Assert 0 line</li>\n<li>drag the yellow arrow (which determines which line to run next) to the Resume line</li>\n<li>hit {F8} on the keyboard (or use the menu Debug > Step Into)</li>\n</ul>\n\n<p>This will go to the line where the error occurred. In your case, it will probably be the last line of your code.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437000373, "post_id": 31441814, "comment_id": 50854060, "body": "I may not have explained it well. I created a real Query called from my form: DoCmd.OpenQuery &quot;updateRecert&quot;                                                                                                UPDATE dbo_Billing AS a INNER JOIN dbo_certs AS b ON a.peopleid = b.peopleid  SET a.recertifying = -1 WHERE b.certificationExpireDate = &#39;2015-08-31 00:00:00.000&#39;;"}, {"owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "reply_to_user": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437023594, "post_id": 31441814, "comment_id": 50860321, "body": "@XiXiangQua, what type of certificationExpireDate? String or date/time?"}, {"owner": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437055337, "post_id": 31441814, "comment_id": 50879816, "body": "It is stored in SQL Server as datetime like &#39;2008-12-31 00:00:00.000&#39;"}, {"owner": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437063807, "post_id": 31441814, "comment_id": 50886052, "body": "Why would this cause a datatype mismatch?: UPDATE dbo_Billing AS a INNER JOIN dbo_certs AS b ON a.peopleid = b.peopleid SET a.recertifying = -1 WHERE (((b.certificationExpireDate)=&#39;2015-08-31 00:00:00.000&#39;));"}, {"owner": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437071555, "post_id": 31441814, "comment_id": 50890401, "body": "I was able to create a standalone query which successfully marks the needed records:   UPDATE dbo_Billing AS a INNER JOIN dbo_certs AS b ON a.peopleid = b.peopleid SET a.recertifying = -1 WHERE year(b.certificationExpireDate) = Forms!billing!billyear and month(b.certificationExpireDate) = Forms!billing!billmonth;                            Thanks all!!"}, {"owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "reply_to_user": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "edited": false, "score": 0, "creation_date": 1437075517, "post_id": 31441814, "comment_id": 50892544, "body": "@XiXiangQua because it&#39;s not pass-through query and you use odbc linked table, so to work with datetime fields you have use &#39;#&#39; symbol"}], "tags": [], "owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "is_accepted": false, "score": 0, "last_activity_date": 1437024130, "last_edit_date": 1437024130, "creation_date": 1436997192, "answer_id": 31441814, "question_id": 31440567, "link": "https://stackoverflow.com/questions/31440567/trying-to-use-vba-to-write-query-in-access/31441814#31441814", "title": "Trying to use VBA to write query in Access", "body": "<p>Error in SQL... but!! Are you sure that <code>certificationExpireDate</code> is <strong><em>string</em></strong> and <strong><em>all the time</em></strong> equal to <code>yyyy-mm-dd</code> pattern?? It's dangerouse to have relation with  \"not certain\" key like you have. I think this is not a good db design.</p>\n\n<p>But, after all, for your case:</p>\n\n<p><strong><em>VBA:</em></strong></p>\n\n<pre><code>sRecert = \"UPDATE Billing a inner join certs b \" &amp; _\n          \"on format(a.imaginary_date_field, \"\"\"yyyy-mm-dd\"\"\") = b.certificationExpireDate \" &amp; _\n          \"set a.recertifying = -1 \" &amp; _\n          \"where CInt(Left((b.certificationExpireDate),4)) =  \" &amp; byear &amp; \" and CInt(Mid((b.certificationExpireDate),6,2)) =  \" &amp; bmonth\n</code></pre>\n\n<p><strong><em>QueryDef:</em></strong></p>\n\n<pre><code>PARAMETERS Forms!your_form!byear Short, Forms!your_form!bmonth Short;\nUPDATE Billing a inner join certs b\n    on format(a.imaginary_date_field, \"yyyy-mm-dd\") = b.certificationExpireDate\n    set a.recertifying = -1\n    where CInt(Left((b.certificationExpireDate),4)) = Forms!your_form!byear and CInt(Mid((b.certificationExpireDate),6,2)) = Forms!your_form!bmonth\n</code></pre>\n\n<hr>\n\n<p><strong><em>UPDATED</em></strong></p>\n\n<blockquote>\n  <p>mismatch error</p>\n</blockquote>\n\n<p>You get error probable because you have date/time field, not a string. Date in MS Access queries write with <code>#</code> symbol. <code>WHERE b.certificationExpireDate = #2015-08-31 00:00:00.000#;</code></p>\n\n<p>In your case:</p>\n\n<pre><code>PARAMETERS Forms!your_form!byear Short, Forms!your_form!bmonth Short;\nUPDATE dbo_Billing AS a INNER JOIN dbo_certs AS b ON a.peopleid = b.peopleid \nSET a.recertifying = -1\nWHERE year(b.certificationExpireDate) = Forms!your_form!byear and Month(b.certificationExpireDate) = Forms!your_form!bmonth;\n</code></pre>\n\n<p>For more info follow <a href=\"https://support.office.com/en-ca/article/Examples-of-using-dates-as-criteria-in-Access-queries-aea83b3b-46eb-43dd-8689-5fc961f21762\" rel=\"nofollow\">this</a> link</p>\n"}], "owner": {"reputation": 1, "user_id": 5121077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd38a5e64d6695b7b668d34ea06787e?s=128&d=identicon&r=PG&f=1", "display_name": "Xi XiangQua", "link": "https://stackoverflow.com/users/5121077/xi-xiangqua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1437035942, "creation_date": 1436992626, "last_edit_date": 1437006733, "question_id": 31440567, "link": "https://stackoverflow.com/questions/31440567/trying-to-use-vba-to-write-query-in-access", "title": "Trying to use VBA to write query in Access", "body": "<p>I am getting a type mismatch with the following syntax in my Access VBA. I am trying to update my table named \"Billing\" by seeing if any records have a date that looks at a string value in my \"Certs\" table like \"2012-07-01\" corresponding to my form's billYear textbox e.g. 2012 and my billMonth textbox e.g. 07. Is there a better way to write the VBA or see an error - many thanks:</p>\n\n<pre><code>Dim sRecert As String\nDim byear As Integer\nDim bmonth As Integer\n\nbyear = Me.billYear\nbmonth = Me.billMonth\n\nsRecert = \"Update Billing set recertifying = -1 where (select     certificationExpireDate from certs where Left((certificationExpireDate),4) =  \" &amp; byear\n    &amp; \" and Mid((certificationExpireDate),6,2) =  \" &amp; bmonth &amp; \")\"\n\nDoCmd.RunSQL sRecert\n</code></pre>\n\n<p>I may not have explained it well. I created a real Query called from my form: \nDoCmd.OpenQuery \"updateRecert\"<br>\nI set up my SQL below as a test on a real date I\u2019m working with. It is in SQL Server (ODBC linked)\nMy dbo_certs table and my dbo_billing table share only one joinable field peopleID:</p>\n\n<pre><code>UPDATE dbo_Billing AS a INNER JOIN dbo_certs AS b ON a.peopleid = b.peopleid \nSET a.recertifying = -1\nWHERE b.certificationExpireDate = '2015-08-31 00:00:00.000';\n</code></pre>\n\n<p>The above gave a data mismatch error.\nMy bottom line is I have two text boxes on my form to pass in data preferably into my VBA code:</p>\n\n<ul>\n<li>billMonth which in this case is 8 because it is an integer so that is\na problem</li>\n<li>billYear is 2015</li>\n</ul>\n\n<p>so I need to update my dbo_billing table\u2019s \u2018recertifying\u2019 field with -1 if the dbo_cert\u2019s field \u2018certificationExpireDate\u2019 is '2015-08-31 00:00:00.000' but only if that can be gotten from the form.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 2, "creation_date": 1436992524, "post_id": 31440467, "comment_id": 50850435, "body": "Try putting <code>Application.Quit</code> after the Close statement."}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1436992848, "post_id": 31440467, "comment_id": 50850637, "body": "@DeanOC Under the last line, correct? If so, it didn&#39;t work."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 2, "creation_date": 1436994789, "post_id": 31440467, "comment_id": 50851725, "body": "It worked for me @bdkong - running <code>Application.Quit</code> gave me a popup &quot;Do you want to save?&quot;. This can be disabled by adding <code>Application.DisplayAlerts = False</code>, but i don&#39;t think you will need it in your case."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1437167998, "post_id": 31440467, "comment_id": 50934663, "body": "Hmm, what do you mean <code>Application.quit</code> doesn&#39;t work? Does it give an error? Does it close the workbook, but not the application? What happens if you run this command in the Immediate window?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1436998593, "creation_date": 1436998593, "answer_id": 31442154, "question_id": 31440467, "link": "https://stackoverflow.com/questions/31440467/excel-does-not-completely-close-when-using-workbook-close/31442154#31442154", "title": "Excel does not completely close when using Workbook.Close", "body": "<p>To make sure the question doesn't remain unanswered, using both suggestions</p>\n\n<p>(credit to @DeanOC and @user1274820)</p>\n\n<hr>\n\n<pre><code>'Closes Populated JD Form\nWorkbooks(Name).Close SaveChanges:=False\n\n'Closes Transfer Template\nWorkbooks(\"Transfer Template.xlsm\").Close SaveChanges:=False\n\nWith Application\n    .DisplayAlerts = False\n    .Quit\nEnd With\n</code></pre>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1437049293, "post_id": 31443431, "comment_id": 50875093, "body": "I don&#39;t understand how this is supposed to fix my trouble with @DeanOC &#39;s answer. First of all I don&#39;t want to save changes. Secondly, it doesn&#39;t give   me the option to save because I&#39;ve already denoted that I don&#39;t want to save it."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1437050931, "post_id": 31443431, "comment_id": 50876296, "body": "It doesn&#39;t save it it just fools excel into thinking it has been saved so it closes without prompting you"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1437054252, "post_id": 31443431, "comment_id": 50878880, "body": "Ahh, I see what you&#39;re saying. It&#39;s still not working though :/"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1437168054, "post_id": 31443431, "comment_id": 50934689, "body": "Found my problem. I had a bit of code that was slightly above the app quit code that was closing the workbook. Deleted that and it worked fine."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 7, "last_activity_date": 1437006990, "last_edit_date": 1437006990, "creation_date": 1437006215, "answer_id": 31443431, "question_id": 31440467, "link": "https://stackoverflow.com/questions/31440467/excel-does-not-completely-close-when-using-workbook-close/31443431#31443431", "title": "Excel does not completely close when using Workbook.Close", "body": "<p>Don't turn the display alerts off as it will suppress any genuine questions.</p>\n\n<p>Use this instead</p>\n\n<pre><code>ActiveWorkbook.Saved = True\nApplication.Quit\n</code></pre>\n\n<p>This will stop Excel for asking about saving changes as it now thinks that it has been saved already. A good example of this is your personal macro workbook, I use mine a LOT and am always creating or modifying code in there. If I turn the alert off and there are changes in my personal workbook, I lose them all.</p>\n\n<p>Try not to bulk fix possible scenarios where possible. Another example is errors, have an error trapping routine and deal with it as needed as opposed to a blanket statement of on error resume next.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2457356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3623ce5faf2916830073c65a37a72e8e?s=128&d=identicon&r=PG", "display_name": "user2457356", "link": "https://stackoverflow.com/users/2457356/user2457356"}, "is_accepted": false, "score": 0, "last_activity_date": 1554066156, "last_edit_date": 1554066156, "creation_date": 1554049775, "answer_id": 55442998, "question_id": 31440467, "link": "https://stackoverflow.com/questions/31440467/excel-does-not-completely-close-when-using-workbook-close/55442998#55442998", "title": "Excel does not completely close when using Workbook.Close", "body": "<p>Once I removed <strong>atpvbaen.xls</strong> from my references, application.quit worked as advertised.</p>\n\n<p>I was tearing my hair out - until I realized I had atpvbaen.xls set as a reference - which was ANOTHER excel thread left alive.  I didn't need it for this application, so I disabled it.  In the VB Editor, <code>Tools =&gt; References un-check atpvbaen.xls.</code> If I had needed it, maybe shutting that one down deliberately would have worked. </p>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10822, "favorite_count": 1, "accepted_answer_id": 31443431, "answer_count": 3, "score": 1, "last_activity_date": 1554066156, "creation_date": 1436992300, "last_edit_date": 1495542329, "question_id": 31440467, "link": "https://stackoverflow.com/questions/31440467/excel-does-not-completely-close-when-using-workbook-close", "title": "Excel does not completely close when using Workbook.Close", "body": "<p>In the macro I'm running, I end with closing the last Excel Workbook that's open. When I run it everything closes except one window which doesn't have a spread sheet, just a light-blue backdrop. Am I using a wrong command or is there just no way to close all open windows?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3628252/closing-excel-application-using-vba\">Here</a> is a post asking my exact question, but the solution isn't working for me.</p>\n\n<p>Here are the last two commands that I'm using:</p>\n\n<pre><code>'\n' Closes Populated JD Form\n'\n    Workbooks(name).Close SaveChanges:=False\n\n'\n' Closes Transfer Template\n'\n    Workbooks(\"Transfer Template.xlsm\").Close SaveChanges:=False\n</code></pre>\n\n<p>Thanks in advance!!!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1437069087, "post_id": 31441957, "comment_id": 50888984, "body": "Thank you very much for the pictures and the thorough explanation. I have no trouble using my VBA skills from Access in Word now."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1436997802, "creation_date": 1436997802, "answer_id": 31441957, "question_id": 31440269, "link": "https://stackoverflow.com/questions/31440269/iterating-through-excel-document-to-replace-words-in-word/31441957#31441957", "title": "Iterating through excel document to replace words in word", "body": "<p>To run VBA code in Word press Alt-F8</p>\n\n<p>It will display a form with all available Public Subs or Functions in the document.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>Open a Word file and the VBA editor window (Alt-F11)</li>\n<li>Click menu item: Insert -> Module</li>\n<li>Create a myFindAndReplace Sub similar to this:</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub myFindAndReplace()\n\n    Const MAX_ITEMS As Long = 3\n    Dim i As Long, arr1(1 To MAX_ITEMS) As String, arr2(1 To MAX_ITEMS) As String\n\n    arr1(1) = \"find1\"\n    arr1(2) = \"find2\"\n    arr1(3) = \"find3\"\n\n    arr2(1) = \"replace1\"\n    arr2(2) = \"replace2\"\n    arr2(3) = \"replace3\"\n\n    With Application.ActiveDocument.Content.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        For i = 1 To MAX_ITEMS\n            .Text = arr1(i)\n            .Replacement.Text = arr2(i)\n            .Forward = True\n            .Wrap = wdFindContinue\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = False\n            .MatchSoundsLike = False\n            .MatchAllWordForms = False\n            .Execute Replace:=wdReplaceAll\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Back in Word click Alt-F8 and you'll get the available macros:</p>\n\n<p><img src=\"https://i.stack.imgur.com/5MqdO.png\" alt=\"available macros form\"></p>\n\n<hr>\n\n<p>Word has the following events in VBA module <strong>ThisDocument</strong> (under the Project with your file name):</p>\n\n<ul>\n<li>Document_BuildingBlockInsert()</li>\n<li>Document_Close()</li>\n<li>Document_ContentControlAfterAdd()</li>\n<li>Document_ContentControlBeforeContentUpdate()</li>\n<li>Document_ContentControlBeforeDelete()</li>\n<li>Document_ContentControlBeforeStoreUpdate()</li>\n<li>Document_ContentControlOnEnter()</li>\n<li>Document_ContentControlOnExit()</li>\n<li>Document_New()</li>\n<li>Document_Open()</li>\n<li>Document_Sync()</li>\n<li>Document_XMLAfterInsert()</li>\n<li>Document_XMLBeforeDelete()</li>\n</ul>\n\n<p>Now you can either</p>\n\n<ol>\n<li><p>Build the entire two arrays (in Word) and use them directly in the code, as in the sample Sub</p></li>\n<li><p>Or open the Excel file and iterate through each row to perform the replacement in Word</p></li>\n</ol>\n\n<p>Option 2 is more convoluted</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "accepted_answer_id": 31441957, "answer_count": 1, "score": 0, "last_activity_date": 1436997802, "creation_date": 1436991656, "last_edit_date": 1531164843, "question_id": 31440269, "link": "https://stackoverflow.com/questions/31440269/iterating-through-excel-document-to-replace-words-in-word", "title": "Iterating through excel document to replace words in word", "body": "<p>I have an excel document with two columns and 100 rows. One column is a word to look for in a word document and the second column is the word that I want to replace the searched word with.</p>\n\n<p>I want to iterate through each row in the excel table and use the inputs to search and replace in a word document.</p>\n\n<p>I have experience with VBA in Access but I have never used it with Word or Excel before and I am very confused.</p>\n\n<p>The function I think will work is this:</p>\n\n<pre><code>function replace(find,replace)\nwith activedocument.content.find\n.forward=True\n.wrap=wdFindContinue\n.Execute fintext:=find,replacewith:=replace,matchcase:=False,matchwholeword:=True\nend with\nend function\n</code></pre>\n\n<p>In access you would then call that function in an event, but word doesn't have events. I just want to run the code. When I select run a form asking me to create a macro appears and I get lost.</p>\n\n<p>How do I run vba code in Word?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "csv", "ms-access", "powerpivot"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3703089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1687d44458c704d0e19b1a2599913d2?s=128&d=identicon&r=PG&f=1", "display_name": "Oggy", "link": "https://stackoverflow.com/users/3703089/oggy"}, "edited": false, "score": 0, "creation_date": 1436993322, "post_id": 31440521, "comment_id": 50850914, "body": "Thanks for answering this is very informative... I guess &quot;better way&quot; would just mean less programming time and less steps during which something could be messed up. I have some experience with VBA but this seems it could be quite a bit for me to take on in addition to my normal work activities... Thx rdster"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 31, "user_id": 3703089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1687d44458c704d0e19b1a2599913d2?s=128&d=identicon&r=PG&f=1", "display_name": "Oggy", "link": "https://stackoverflow.com/users/3703089/oggy"}, "edited": false, "score": 0, "creation_date": 1437052754, "post_id": 31440521, "comment_id": 50877675, "body": "No problem....and yes, taking the time to start automating pieces will take some extra time in the beginning.  However, make the first thing you automate the one piece that gets used the most, or takes the most time.  Once that part is done...it frees up more time to expand your macros."}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 1, "last_activity_date": 1436993021, "last_edit_date": 1436993021, "creation_date": 1436992455, "answer_id": 31440521, "question_id": 31440214, "link": "https://stackoverflow.com/questions/31440214/emailed-excel-spreadsheet-to-multiple-csv-files/31440521#31440521", "title": "Emailed Excel Spreadsheet to Multiple CSV Files", "body": "<p>You can certainly do it that way.  I used to have an Outlook macro that would trigger when my morning data dumps would come in, save the data file and then open Excel and launch VBA code that opened the master file &amp; the data file...copied over the data, either refreshed or deleted and recreated the pivot tables, formatted everything, and then either saved files, or created emails with the reports ready to go...I just had to review them.  Cut my work day down to only a couple of hours of work.  I had just about everything automated that ran on a schedule.</p>\n\n<p>It took time to get all the macros working correctly and consistently, but once they did...good times!</p>\n\n<p>\"A better way\" may be subjective...does better mean faster coding time, faster processing, cheaper?  Its hard to beat using MS Office products generally as most everyone already has them...VBA is well documented and fairly easy to learn.</p>\n"}, {"tags": [], "owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1436996066, "creation_date": 1436996066, "answer_id": 31441548, "question_id": 31440214, "link": "https://stackoverflow.com/questions/31440214/emailed-excel-spreadsheet-to-multiple-csv-files/31441548#31441548", "title": "Emailed Excel Spreadsheet to Multiple CSV Files", "body": "<p>Once you find a way to automate Outlook and pull your Excel attachment effectively, you definitely want to look into Power Query (A free Addin for Excel 2010/2013 and built into Excel 2016).</p>\n\n<p>Power Query gives you an easy way to establish connections to different data sources, in which you can then transform the data (Insert Columns, perform aggregations, etc) and then load it into Excel or Power Pivot if you choose to go down that route. Once you perform the task once, it will automate all your steps when you refresh.</p>\n\n<p>For example, you can set up a connection to a folder that will append all Excel files in the folder to a master file.  So each time an Excel file gets dropped into that folder, all you need to do is refresh the master file.  </p>\n\n<p>There are a lot of other awesome things Power Query can do. I recommend checking out some of Mike Girvin's (The most enthusiastic Excel teacher of all time) videos. He has a whole video series on Power Query. The link below is to the video where he walks you through connecting to a folder:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=a7E29H5ZUmE\" rel=\"nofollow\">https://www.youtube.com/watch?v=a7E29H5ZUmE</a></p>\n\n<p>Chris Webb also blogs about Power Query pretty often on his site and has written a book on it:</p>\n\n<p><a href=\"http://blog.crossjoin.co.uk/category/power-query/\" rel=\"nofollow\">http://blog.crossjoin.co.uk/category/power-query/</a></p>\n"}], "owner": {"reputation": 31, "user_id": 3703089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1687d44458c704d0e19b1a2599913d2?s=128&d=identicon&r=PG&f=1", "display_name": "Oggy", "link": "https://stackoverflow.com/users/3703089/oggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436996066, "creation_date": 1436991467, "question_id": 31440214, "link": "https://stackoverflow.com/questions/31440214/emailed-excel-spreadsheet-to-multiple-csv-files", "title": "Emailed Excel Spreadsheet to Multiple CSV Files", "body": "<p>Scenario: I receive a daily Excel spreadsheet in Outlook. It contains numerous rows of customer data. Each day, I must append the new spreadsheet records to a master spreadsheet, then create multiple pivot tables in both the master spreadsheet and the new spreadsheet in order to get statistics from different columns to input into multiple CSV files which each supply data to a business intelligence dashboard widget I connect to through DropBox.</p>\n\n<p>Data can also be supplied to the business intelligence dashboard (Geckoboard.com) using Google Sheets, but CSV seems to be the best data format for this given the data originally comes from Excel.</p>\n\n<p>I want to automate this process as much as possible. I've posed a similar question recently and it seems I would have to use VBA to trigger an Outlook macro based on an email subject heading, then within this macro kick off macros in Excel to create the PivotTables and resulting CSVs which are then overwritten each day in my DropBox folder.</p>\n\n<p>But is there a better way to do this? I'm looking into PowerPivot and Access as potential solutions. Maybe Pivot Tables are not the right way to go either. I currently use it to get things like counts of each row label or counts of customers who meet a certain condition.</p>\n\n<p>If you would like clarification, let me know. Thank you for reading and contemplating my question.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436990740, "post_id": 31439970, "comment_id": 50849397, "body": "When you debug, what line does the error point to?"}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436991010, "post_id": 31439970, "comment_id": 50849551, "body": "[Report_RWA Allocation by User].Filterby_txt.Value = User_cb.Column(1)"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "is_accepted": true, "score": 0, "last_activity_date": 1436996349, "creation_date": 1436996349, "answer_id": 31441620, "question_id": 31439970, "link": "https://stackoverflow.com/questions/31439970/run-time-error-2465-cant-find-field-ms-access/31441620#31441620", "title": "run-time error &#39;2465&#39; - can&#39;t find field MS Access", "body": "<p>Turns out that access could not find my report even though the name was correct. I had to add it as a Microsoft Access Class Object before the code would run without any errors. </p>\n"}], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 31441620, "answer_count": 1, "score": 0, "last_activity_date": 1436996349, "creation_date": 1436990623, "last_edit_date": 1436992892, "question_id": 31439970, "link": "https://stackoverflow.com/questions/31439970/run-time-error-2465-cant-find-field-ms-access", "title": "run-time error &#39;2465&#39; - can&#39;t find field MS Access", "body": "<p>I have a field on a report that is populated by a combo box on a seperate form. I am receiving an error when executing my code stating \"can't find the field '|1' referred to in your expression - I have the exact same code in a different module in my database and it works without errors so I'm not sure what I'm doing wrong. Thank you in advance for any assistance. </p>\n\n<pre><code>Private Sub Reportfilter_bt_Click()\n\n    If IsNull(User_cb.Value) = True Then\n        MsgBox \"Please select a user from the dropdown menu\", vbCritical, \"Database Error\"\n    Else\n\n        DoCmd.OpenReport \"RWA Allocation by User\", acViewReport\n\n        [Report_RWA Allocation by User].Filterby_txt.Value = User_cb.Column(1)\n\n        DoCmd.Close acForm, \"RWA Task Report\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ontime"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1436990877, "post_id": 31439866, "comment_id": 50849468, "body": "That linked page seems pretty comprehensive - why not add your exact use case and existing code to your question, so there&#39;s something concrete to work with?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1436993663, "post_id": 31439866, "comment_id": 50851110, "body": "Basically, your macro needs to be a string, so if you have multiple arguments, you surround the whole thing in single quotes. If you need to use full quotes in your arguments, just use 2 instead of 1. <code>&quot;&#39;MyMacro &quot;&quot;StringParameter&quot;&quot;,&quot;&quot;Other String Parameter&quot;&quot;&#39;&quot;</code>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1436993776, "post_id": 31439866, "comment_id": 50851187, "body": "Beginning = <code>&quot;&#39;</code> End = <code>&#39;&quot;</code> Everything else just think of separately. Double quotes = Single quotes."}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 5752070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035e0487a4d38761585782ee37a9e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Leon Rom", "link": "https://stackoverflow.com/users/5752070/leon-rom"}, "edited": false, "score": 2, "creation_date": 1516021478, "post_id": 31464597, "comment_id": 83509980, "body": "Thanks (+) for fully working example! But you wrote &quot;When you want to call it from another workbook it has to be public&quot; - <b>not ony so</b>!   If you want to set the parameters the called function has to be <b>public even in the same module</b> (I&#39;d spent 2 hours to undersand that)    And next... The text <code>Now + TimeSerial(0, 0, **1**)</code> is somewhat redundantly. I know - all write this. But enough is <code>Now + TimeSerial(0, 0, **0**)</code>. Moreover - this example works for me even with such: <code>Application.OnTime Now, &quot;&#39;CallMeOnTime &quot;&quot;&quot; &amp; strTest1 &amp; &quot;&quot;&quot;,&quot;&quot;&quot; &amp; strTest2 &amp; &quot;&#39;&quot;</code>"}], "tags": [], "owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "is_accepted": false, "score": 11, "last_activity_date": 1437081067, "creation_date": 1437081067, "answer_id": 31464597, "question_id": 31439866, "link": "https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime/31464597#31464597", "title": "Multiple Variable Arguments to Application.OnTime", "body": "<p>you have to consider the following constraints:</p>\n\n<ul>\n<li>the macro you want to call has to reside in a module. When you want to call it from another workbook it has to be public.</li>\n<li>you cannot use brackets for calling the macro like you would do with a function or a sub with parameters most probably. When using brackets Excel will complain that macro doesn't exist</li>\n<li>I didn't try a function, but anyway there is nobody who can work with the return value, so define your method as a sub.</li>\n<li>you have to use aposthophs to encapsulate the macro name</li>\n<li>you have to use quotes to encapsulate string and date values , either with chr$(34) (reminds me to old times) or just double the quotes</li>\n<li>you can pass over integers without quotes, I didn't try Doubles</li>\n<li>separate arguments by a comma</li>\n<li>the order of the arguments must match the order of the arguments in your method</li>\n</ul>\n\n<p>Find attached the code:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Dim strTest1 As String\n    Dim strTest2 As String\n\n    strTest1 = \"This is test1\"\n    strTest2 = \"This is test2\"\n\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"'CallMeOnTime \"\"\" &amp; strTest1 &amp; \"\"\",\"\"\" &amp; strTest2 &amp; \"'\"\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"'CallMeOnTime \" &amp; Chr$(34) &amp; \"Test\" &amp; Chr$(34) &amp; \",\" &amp; Chr$(34) &amp; \"Test\" &amp; Chr$(34) &amp; \"'\"\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"'CallMeOnTime2'\"\nEnd Sub\nPublic Sub CallMeOnTime(strTest1 As String, strTest2 As String)\n    MsgBox (\"test1: \" &amp; strTest1 &amp; \" test2:\" &amp; strTest2)\nEnd Sub\n\nPublic Sub CallMeOnTime2()\n    MsgBox (\"CallMeOnTime2\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 1, "creation_date": 1568897427, "post_id": 44903276, "comment_id": 102426960, "body": "would be nice if you can state the difference to Holger&#39;s answer more explicitly. Then it would be worth a +1"}, {"owner": {"reputation": 131, "user_id": 3329384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8408337ab9dd3bcb3c6a283e3f105a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick P", "link": "https://stackoverflow.com/users/3329384/nick-p"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1569405443, "post_id": 44903276, "comment_id": 102583764, "body": "The inclusion of an <code>Integer</code> in the string argument is a minor addition to Holger&#39;s answer. As it&#39;s handled slightly differently, I thought it was worth showing explicitly."}], "tags": [], "owner": {"reputation": 131, "user_id": 3329384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8408337ab9dd3bcb3c6a283e3f105a?s=128&d=identicon&r=PG&f=1", "display_name": "Nick P", "link": "https://stackoverflow.com/users/3329384/nick-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1569405283, "last_edit_date": 1569405283, "creation_date": 1499163580, "answer_id": 44903276, "question_id": 31439866, "link": "https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime/44903276#44903276", "title": "Multiple Variable Arguments to Application.OnTime", "body": "<p>Just wanted to add an additional example which I found helpful, with reference to <a href=\"https://www.mrexcel.com/forum/excel-questions/81724-calling-procedure-parameters.html#post398494\" rel=\"nofollow noreferrer\">this post on MrExcel</a>.</p>\n\n<p>Application.OnTime with multiple arguments of different types (String and Integer)</p>\n\n<pre><code>Dim testName As String\nDim counter As Integer\n\n...\n\n' String then Integer argument\nApplication.OnTime Now + TimeValue(\"00:00:02\"), \"'TestSub \"\"\" &amp; testName &amp; \"\"\", \" &amp; counter &amp; \" '\"\n\n' Integer then String argument\nApplication.OnTime Now + TimeValue(\"00:00:02\"), \"'SubTest \" &amp; counter &amp; \", \"\"\" &amp; testName &amp; \"\"\" '\"\n</code></pre>\n\n<p>The only difference from <a href=\"https://stackoverflow.com/a/31464597/3329384\">this answer</a> is the inclusion of the <code>counter</code> Integer, which is handled slightly differently from a String.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "is_accepted": false, "score": 2, "last_activity_date": 1579601919, "last_edit_date": 1579601919, "creation_date": 1579453259, "answer_id": 59812342, "question_id": 31439866, "link": "https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime/59812342#59812342", "title": "Multiple Variable Arguments to Application.OnTime", "body": "<p>Huhlo,</p>\n\n<p>I have fought with the tricky syntax for arguments to <code>Application.OnTime</code> ( or <code>Application.Run</code>, which is similar) every time I have needed it. I have often come here, as well as arrived a few times at the other links referenced here. As often they almost,  but did not quite,  got me there. </p>\n\n<p>So I have spent some time making myself some worked examples to reference in the future, and I have also convinced myself finally that I understand what is going on.</p>\n\n<p>So I am sharing my solutions , and finally I think I can have a stab at answering the original question regarding ..<em>concisely  explaining / justifying the syntax</em>.. ..</p>\n\n<p>I am deliberately giving very full explicit code lines  for two reasons:- </p>\n\n<p>_  1. Its easy to simplify it to the more usual shortened version if you only need that, but going the other way , from the more common simplified form to the full explicit form, should you need that, is quite hard. </p>\n\n<p>_  2.Showing the  full explicit code line syntax helps with my attempt at explain the syntax, and so is needed in answering the question fully. </p>\n\n<p>The full explicit syntax would be needed , for example ,  to ensure the corrects file were opened, when we want to trigger a macro in a closed workbook. ( In such a  case, the closed workbook would be opened. The VBA <code>Application.OnTime</code> code line will do this opening, provided it has the full explicit form )</p>\n\n<p>I am using 2 example files. If you want to try my demos, then  the first should be opened , the second can be closed or open , but the second should be in the same folder. (  The reason why it needs to be in the same folder is just for simplified demonstration, -  I have organised that demonstration macros will look for the closed workbook in the same folder. In the practice,   the closed workbook can be anywhere if you replace  exactly this bit  ,  (  including the first  <code>\"</code>   ) ,  with the full path and file name of the closed workbook </p>\n\n<pre><code>\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\n</code></pre>\n\n<p>So you would replace that last bit with something of the form:</p>\n\n<pre><code>C:\\Elston\\Desktop\\MyFolder\\UverFile.xls\n</code></pre>\n\n<p>A complete code line would then have a form something like this:</p>\n\n<pre><code>Application.OnTime Now(), \"'C:\\Elston\\Desktop\\MyFolder\\UverFile.xls\" &amp; \"'\"      &amp;      \"!'Modul1.MacroUndermacroInUverFile 465, \"\"25\"\"'\"\n</code></pre>\n\n<p>.</p>\n\n<p>Open workbook - MainFile.xls : <a href=\"https://app.box.com/s/prqhroiqcb0qccewz5si0h5kslsw5i5h\" rel=\"nofollow noreferrer\">https://app.box.com/s/prqhroiqcb0qccewz5si0h5kslsw5i5h</a></p>\n\n<p>Module \u201c<code>Modul1</code>\u201d in MainFile.xls </p>\n\n<pre><code>Option Explicit\n' Public variable code section\nPrivate Pbic_Arg1 As String\nPublic Pbic_Arg2 As Double\n\n\n\n\nSub MainMacro()    '    https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime/31464597       http://markrowlinson.co.uk/articles.php?id=10\nRem 1\n                                                                                                                                                                                                                          Debug.Print \"Rem 1\" &amp; vbCr &amp; vbLf &amp; \"This workbook module, single arrgument\"\n' This workbook module, single argument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.UnderMainMacro 465'\": Debug.Print \"!'Modul1.UnderMainMacro 465'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.UnderMainMacro \"\"465\"\"'\": Debug.Print \"!'Modul1.UnderMainMacro \"\"465\"\"'\"\n Application.OnTime Now(), \"'Modul1.UnderMainMacro  465'\" '  --- more usual simplified form. In this case I nned the extra  Modul1.  because Sub UnderMainMacro( ) is private\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"UverFile module, single argument\"\n' UverFile module, single argument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"           &amp;          \"!'Modul1.MacroInUverFile 465'\": Debug.Print \"!'Modul1.MacroInUverFile 465'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'Modul1.MacroInUverFile \"\"465\"\"'\": Debug.Print \"!'Modul1.MacroInUverFile \"\"465\"\"'\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"Thisworkbook module, multiple arguments\"\n' Thisworkbook module, multiple arguments\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.UnderUnderMainMacro 465, 25'\": Debug.Print \"!'Modul1.UnderUnderMainMacro 465, 25'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.UnderUnderMainMacro 465, \"\"25\"\"'\": Debug.Print \"!'Modul1.UnderUnderMainMacro 465, \"\"25\"\"' \"\n Application.OnTime Now(), \"'UnderUnderMainMacro 465,  25 '\" '  --- more usual simplified form. I don't even need the extra  Modul1.  because it is not private\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"UverFile module, multiple argument\"\n' UverFile module, multiple argument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'Modul1.MacroUnderMacroInUverFile 465, 25'\": Debug.Print \"!'Modul1.MacroUnderMacroInUverFile 465, 25'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'Modul1.MacroUndermacroInUverFile 465, \"\"25\"\"'\": Debug.Print \"!'Modul1.MacroUndermacroInUverFile 465, \"\"25\"\"'\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"mess about with argument positions\"\n' mess about with argument positions\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.UnderUnderMainMacro      465   ,     \"\"25\"\"          '\": Debug.Print \"!'Modul1.UnderUnderMainMacro      465   ,     \"\"25\"\"          '\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"This workbook first worksheet code module, single arrgument\"\n' This workbook first worksheet code module, single arrgument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;           \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWsCodeModule 465'\": Debug.Print \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWcCodeModule 465'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWsCodeModule \"\"465\"\"'\": Debug.Print \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWcCodeModule \"\"465\"\"'\"\n                                                                  Debug.Print vbCr &amp; vbLf &amp; \"UverFile  first worksheet code module, single arrgument\"\n' UverFile  first worksheet code module, single arrgument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModule 465'\": Debug.Print \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModule 465'\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModule \"\"465\"\"'\": Debug.Print \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModule \"\"465\"\"'\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"This workbook first worksheet code module, multiple arguments\"\n' This workbook first worksheet code module, multiple arguments\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWsCodeModuleMultipleArguments 465      ,  \"\"25\"\"         '\": Debug.Print \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWcCodeModuleMultipleArguments 465      ,  \"\"25\"\"         '\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWsCodeModuleMultipleArguments      \"\"465\"\"   ,   25    '\": Debug.Print \"!'\" &amp; ThisWorkbook.Worksheets.Item(1).CodeName &amp; \".InLisWbFirstWcCodeModuleMultipleArguments      \"\"465\"\"   ,   25    '\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"UverFile  first worksheet code module, Multiple  arrgument\"\n' UverFile  first worksheet code module, Multiple  arrgument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModuleMultipleArguments   465   ,    \"\"25\"\"       '\": Debug.Print \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModuleMultipleArguments   465   ,    \"\"25\"\"       '\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; \"UverFile.xls\" &amp; \"'\"          &amp;          \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModuleMultipleArguments \"\"465\"\"   ,    \"\"25\"\"  '\": Debug.Print \"!'\" &amp; \"Tabelle1\" &amp; \".InUverFileFirstWsCodeModuleMultipleArguments \"\"465\"\"   ,    \"\"25\"\"  '\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"Doubles do not have to be in quotes either  ' This workbook module, double argument arrgument\"\n' Doubles do not have to be in quotes either  ' This workbook module, double argument arrgument\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"           &amp;          \"!'Modul1.DoubleCheck 465.5   , \"\"25.4\"\"    '\": Debug.Print \"!'Modul1.DoubleCheck 465.5   , \"\"25.4\"\"    '\"\n\nRem 2 Variables\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"Rem 2 Variables\" &amp; vbCr &amp; vbLf &amp; \"'2a)  \"\"Pseudo\"\"  variables use\"\n'2a) \"Pseudo\" variables use\nDim Arg1_str465 As String, Arg2_Dbl25 As Double\n Let Arg1_str465 = \"465.42\": Let Arg2_Dbl25 = 25.4\n ' Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.DoubleCheck  Arg1_str465   ,   Arg2_Dbl25    '\": Debug.Print \"!'Modul1.DoubleCheck  Arg1_str465   ,   Arg2Db_l25    '\"  ' This code line will not work, that is to say it will not find the varables and take  0  values when VBA later runs the Scheduled macro,  Sub DoubleCheck( )\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.DoubleCheck   \"\"\" &amp; Arg1_str465 &amp; \"\"\"   ,   \"\"\" &amp; Arg2_Dbl25 &amp; \"\"\"    '\": Debug.Print \"!'Modul1.DoubleCheck  \"\"\" &amp; Arg1_str465 &amp; \"\"\"  ,   \"\"\" &amp; Arg2_Dbl25 &amp; \"\"\"  '\"\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"           &amp;           \"!'Modul1.DoubleCheck   \"\"\" &amp; Arg1_str465 &amp; \"\"\"   ,   \" &amp; Arg2_Dbl25 &amp; \"    '\": Debug.Print \"!'Modul1.DoubleCheck  \"\"\" &amp; Arg1_str465 &amp; \"\"\"  ,   \" &amp; Arg2_Dbl25 &amp; \"  '\"\n                                                                                                                                                                                                                          Debug.Print vbCr &amp; vbLf &amp; \"'2b) Real varable use\"\n'2b) Real varable use\n Let Modul1.Pbic_Arg1 = \"465.42\": Let Pbic_Arg2 = 25.4\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.DoubleCheck   Modul1.Pbic_Arg1     ,   Pbic_Arg2    '\": Debug.Print \"!'Modul1.DoubleCheck  Modul1.Pbic_Arg1  ,   Pbic_Arg2  '\"\n\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.DoubleCheck Modul1.Pbic_Arg1, Pbic_Arg2'\"\n                                                                                                                                 ''      Debug.Print Pbic_Arg2 '' This gives 999.99 in  Debug F8  mode , 25.4 in  normal  run\n\nRem 3 ByRef check\n Application.OnTime Now(), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.ByRefCheck'\"\n Application.OnTime Now() + TimeValue(\"00:00:00\"), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.ByRefCheck'\"\n Application.OnTime Now() + TimeValue(\"00:00:01\"), \"'\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \"'\"          &amp;          \"!'Modul1.ByRefCheck'\"\nEnd Sub\nPrivate Sub UnderMainMacro(ByVal Nmbr As Long)\n MsgBox prompt:=\"Arg1 is   \" &amp; Nmbr\nEnd Sub\nSub UnderUnderMainMacro(ByVal Nmbr As Long, ByVal NuverNmbr As Long)\n MsgBox prompt:=\"Arg1 is  \" &amp; Nmbr &amp; \", Arg2 is  \" &amp; NuverNmbr\nEnd Sub\nSub DoubleCheck(ByVal DblNmr1 As Double, ByRef DblNmr2 As Double) ' provided the signature line is declared appropriately, all number argument types dont have to be in  \"\"\n MsgBox prompt:=\"Arg1 is  \" &amp; DblNmr1 &amp; \", Arg2 is  \" &amp; DblNmr2\n Let DblNmr2 = 999.99\nEnd Sub\n</code></pre>\n\n<p>(That above  is the main module from which all macros are run)</p>\n\n<p>Worksheets Class module of first worksheet \u201c<code>Tabelle1</code>\u201d in MainFile.xls</p>\n\n<pre><code>Option Explicit\nSub InLisWbFirstWsCodeModule(ByRef Nmbr As Long)\n MsgBox prompt:=\"Arg1 is   \" &amp; Nmbr\n Let Nmbr = 999\nEnd Sub\nSub InLisWbFirstWsCodeModuleMultipleArguments(ByVal Nmbr As Long, ByVal NuverNmbr As Long)\n MsgBox prompt:=\"Arg1 is  \" &amp; Nmbr &amp; \", Arg2 is  \" &amp; NuverNmbr\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<p>.\n.</p>\n\n<p>Closed workbook - UverFile.xls :  <a href=\"https://app.box.com/s/u7r2jw79m8ou70otn7xcxced2qkot4w4\" rel=\"nofollow noreferrer\">https://app.box.com/s/u7r2jw79m8ou70otn7xcxced2qkot4w4</a></p>\n\n<p>Module \u201c<code>Modul1</code>\u201d in UverFile.xls</p>\n\n<pre><code>Option Explicit\nPrivate Sub MacroInUverFile(ByVal Nmbr As Long)\n MsgBox prompt:=\"Arg1 is   \" &amp; Nmbr\nEnd Sub\nSub MacroUnderMacroInUverFile(ByVal Nmbr As Long, ByVal NuverNmbr As Long)\n MsgBox prompt:=\"Arg1 is  \" &amp; Nmbr &amp; \", Arg2 is  \" &amp; NuverNmbr\nEnd Sub\n</code></pre>\n\n<p>Worksheets Class module of first worksheet \u201c<code>Tabelle1</code>\u201d in UverFile.xls</p>\n\n<pre><code>Option Explicit\nSub InUverFileFirstWsCodeModule(ByVal Nmbr As Long)\n MsgBox prompt:=\"Arg1 is   \" &amp; Nmbr\nEnd Sub\nSub InUverFileFirstWsCodeModuleMultipleArguments(ByVal Nmbr As Long, ByVal NuverNmbr As Long)\n MsgBox prompt:=\"Arg1 is  \" &amp; Nmbr &amp; \", Arg2 is  \" &amp; NuverNmbr\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<p>.</p>\n\n<p>I have tried to give a good spread of working examples, which I found useful to then use as a template to modify to exactly my needs. </p>\n\n<p><strong>Here is the explanation to how things work</strong> , which makes the syntax more understandable: </p>\n\n<p><strong>First the  nested   <code>'</code></strong> \nThis is generally how VBA handles making any spaces  be taken as literal spaces, ( rather than , for example, mistaking them as separating arguments).  You will see that in the codes,  as I have posted here in the forum post,   I have done some exaggerated spaces in all code lines which helps to split up the two main parts of the code </p>\n\n<p>the LHS , which in a simplified / shortened use would be typically be  left out</p>\n\n<p>and</p>\n\n<p>the RHS , most of which is always needed . (Most likely  xou may only  see the macro name and the arguments .  The extra module code name allows you to use macros in any modules , ( regardless of if they are Private or Public )</p>\n\n<p>Just to make that clear, I have some exagerated spaces in the code windows above either side of one of the <code>&amp;</code>s , so pseudo I have</p>\n\n<pre><code> \"---------LHS-------------\"       &amp;         \"---------RHS------------------\"\n</code></pre>\n\n<p>or like, pseudo</p>\n\n<pre><code>    \"String bit containg full path and file name what you mostly don't use\"            &amp;          \"String bit containing the macro name and the arguments like you more typically see\"\n</code></pre>\n\n<p>Those exaggerated extra spaces either side of that <code>&amp;</code> will vanish if you copy and paste that code into the VB editor code window. If, however,  I were to add spaces within the path string on the LHS, such as changing a file name from  <code>UverFile.xls</code> to <code>Uver  File.xls</code> , then as perhaps expected, the spaces will not change when posting into the VB Editor code window. This is because the  enclosing <code>' '</code> is doing its job of ensuring that all is taken as literally as it is given. </p>\n\n<p>On the RHS we need also that the information is taken exactly as we give it.   My geuss is that, this string part needs to be stored into a buffer from when it is then retrieved and pseudo physically put in later by VBA when the scheduled macro is run. This is why I can add some rogue spaces,  as I have done in the code section named  <em>'  mess about with argument positions</em> , and in a few places in code lines after.  This modification is also not changed when you post into the VB Code window. This helps us to understand the  nested  <code>\" \"</code></p>\n\n<p><strong>the  nested  <code>\"\"</code>   in the variable arguments bit.</strong></p>\n\n<p>This is much  less difficult then a lot of literature suggests. </p>\n\n<p>The only time you really need those enclosing quote pair is if you are giving string values in the argument. That is generally the case in VBA code lines, the enclosing quote aroiund a string indicating that a string is being given.  ( Since you are  already inside a string, then   each of the  quotes need to be doubled, as is the standard VBA syntax required to get a single quote to appear in the final string as is \"seen\" by VBA). \nIf you are using variables, rather than hard coding, then you never need this next  complicated syntax which I am showing, ( provided you have your variables at the top of a module, outside any subroutine ). What I am saying is, that the following complicated argument syntax , which one often sees, is ,  in most cases,  more complicated than  needed</p>\n\n<pre><code>\"\"\" &amp; Arg1 &amp; \"\"\" ,  \"\"\" &amp; Arg2 &amp; \"\"\"\n</code></pre>\n\n<p>In most cases, that complicated form above can be reduced to this sort of form below</p>\n\n<pre><code>Arg1 ,  Arg2\n</code></pre>\n\n<p>To use that simplified form, the variables must be outside the macro with the scheduling <code>Application.OnTime</code> code line, and it must be at the top of the code module, or else,  the scheduled macro which is to be set off by VBA later , won\u2019t know where to get the variables from. ( If the variables are not in the same module as the scheduling module, then they must be declared as Public. It is best to referrence them explicitly, like <code>Module2.Arg1</code>  or  <code>Sheet1.Arg1</code>  or  <code>ThisWorkbook.Arg1</code>  etc  )</p>\n\n<p>So do not really \u201cneed\u201d that complicated syntax, provided you use \u201cmodule level\u201d variables.  </p>\n\n<p>But if you use that complicated syntax, it will have the effect  of placing the value from the variable in the final argument string that VBA puts into the code line it write to run the scheduled macro later. This would have the effect of that if  you use that syntax, and your variables are local, ( that is to say they are within the scheduling macro ) , then you might be fooled into thinking that you , (  that is to say VBA in the scheduled macro later  ),  are using the variables. </p>\n\n<p>In fact what you are doing is that you are hard coding with values into the string that will finally be used by VBA later  in the scheduled macro. I suppose you might say that is using variables within the scheduling macro, at least from the practical point of use.  But understanding what is actually going on, helps , I think, to see where the sometime daunting syntax comes from.  The point is that in such a case you are not really putting variables in the argument. What you are actually dong is using variables within the scheduling macro  to hard code the arguments</p>\n\n<p>In my demo macros, I refer to that way of using the scheduling macro variables as \"Pseudo\" variables use.</p>\n\n<p>Further more, the point that Nick P was making in his answer, is that 4 of those quotes around each  variable in that very complicated argument syntax, are  there  to give  the typical required finally seen double enclosing <code>\" \"</code> pair around a string value. If one of those variables in the example, for example <code>Arg2</code> , is a number, then even for the case of using the \u201ctrick\u201d to make it appear that you are using variable within the scheduling macro,  you can do away with some of those quotes, in particular the ones giving finally as seen by VBA,  the enclosing <code>\" \"</code> pair,  reducing it to </p>\n\n<pre><code>\"\"\" &amp; Arg1 &amp; \"\"\" ,  \" &amp; Arg2 &amp; \"\n</code></pre>\n\n<p>That is what Nick P was demonstrating.</p>\n\n<p>_.____________________</p>\n\n<p><strong>Examining the right hand side syntax for  macro name and arguments.</strong></p>\n\n<p>In all the coding I have a <code>Debug.Print</code> after each <code>Application.OnTime</code> code line. What this is showing is the actual RHS part of the string that VBA uses later  when running the scheduled macro. So that is showing the part containing the macro name and the arguments.  This helps to show the main point I am trying to get across. </p>\n\n<p>For example, the string in what I refer to as the \"Pseudo\" variables use , looks like this:</p>\n\n<pre><code>!'Modul1.DoubleCheck  \"465.42\"  ,   \"25.4\"  '\n</code></pre>\n\n<p>Or, as noted,  if a variable, for example, the second is a number , then you can also use this</p>\n\n<pre><code>!'Modul1.DoubleCheck  \"465.42\"  ,   25.4  '\n</code></pre>\n\n<p>For what I call the Real variable use,  the string \u201cseen\u201d must actually use the variable names </p>\n\n<pre><code>!'Modul1.DoubleCheck  Modul1.Pbic_Arg1  ,   Pbic_Arg2  '\n</code></pre>\n\n<p>Just to clarify that Last code line above.  The sub routine being scheduled is <code>Sub DoubleCheck( )</code> which I have located in my code module with the code name <code>Modul1</code> </p>\n\n<p>Also in that same code module are placed at the top of the module , declarations for the variable, <code>Pbic_Arg1</code>  and    <code>Pbic_Arg2</code>  .  <code>Pbic_Arg1</code> is Private, and <code>Pbic_Arg2</code> is Pubic</p>\n\n<p>If you try my coding out running from the VB Editor in step ( F8 ) mode , whilst you have the Immediate Window open , then I think that will help make everything clear</p>\n\n<p><strong>Summary</strong></p>\n\n<p>At the end of the day, the key to getting the syntax correct , and to understanding it ,  is as follows: </p>\n\n<p>You must arrange it such that what VBA \u201chas\u201d, ( which you can check via a <code>Debug.Print</code> of the string you are giving )  needs to have on the right hand side a similar form to how you might manually write in arguments in a code line to call a sub routine taking in arguments. </p>\n\n<p>You can add a few extra spaces between multiple arguments and the separating  comer , just as you might do carelessly  when typing in manually a series of arguments in a typical VBA Call code line. Presumably, VBA later, when it uses exactly your given string, it does something similar to what happens when you physically write or paste such things in, the result of which is that  those extra spaces get removed. </p>\n\n<p>The point of the enclosing <code>' '</code> is to indicate to VBA to take literally exactly as you have written it. In my explicit code lines we need that for both the LHS and the RHS. More typically the LHS is ommited.</p>\n\n<p>Any  use of a complicated combination of many double or triple <code>\"</code> pairs is more of a trick to give you a way to effectively use variables that are within the scheduling macro ,  in the scheduling <code>Application.OnTime</code> code line. </p>\n\n<p>If your variables are in a code module outside of any sub routine, then the variable syntax is much simplified. In this case  you do not actually need any quotes within the main string, not even if the a variable type is string. </p>\n\n<p>( The complete second argument of the <code>Application.OnTime</code> , which relates to the scheduled macro and its arguments , always needs to be enclosed in a quote pair. That is simply how the <code>Application.OnTime</code> has been written. ( That is very useful, since you can then build up the string with variables , rather than being restricted to hard coding ) )</p>\n\n<p>Alan</p>\n\n<p>Ref</p>\n\n<p><a href=\"https://groups.google.com/forum/?hl=es#!msg/microsoft.public.excel.programming/S10tMoosYho/4rf3VBejtU0J\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/?hl=es#!msg/microsoft.public.excel.programming/S10tMoosYho/4rf3VBejtU0J</a></p>\n\n<p><a href=\"https://www.mrexcel.com/board/threads/calling-a-procedure-with-parameters.81724/#post398494\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/board/threads/calling-a-procedure-with-parameters.81724/#post398494</a></p>\n\n<p><a href=\"http://markrowlinson.co.uk/articles.php?id=10\" rel=\"nofollow noreferrer\">http://markrowlinson.co.uk/articles.php?id=10</a></p>\n\n<p><a href=\"http://www.excelfox.com/forum/showthread.php/2404-Notes-tests-Application-Run-OnTime-Multiple-Variable-Arguments-ByRef-ByVal?p=11870&amp;viewfull=1#post11870\" rel=\"nofollow noreferrer\">http://www.excelfox.com/forum/showthread.php/2404-Notes-tests-Application-Run-OnTime-Multiple-Variable-Arguments-ByRef-ByVal?p=11870&amp;viewfull=1#post11870</a></p>\n\n<p>P.S.\n@ Holger Leichsenring - Hi .  I think the apostrophes must enclose the macro name AND the arguments. Any number types can be passed without  quotes. The macro you want to call can  reside in any module, in any workbook, (open or closed) , and need not be Public. ( My geuss is that <code>Application.OnTime</code> uses the same wiring as <code>Application.Run</code> , which has the advantage, over  simple Calling a sub  , that it will run both Public and Private subs (   <a href=\"https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run/59809370#59809370\">Difference between Calling a Sub and Application.Run</a>       ) )  </p>\n\n<p>Gru\u00df, Alan</p>\n"}], "owner": {"reputation": 91, "user_id": 5120966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d23dfbad023db48695596f584397ae0?s=128&d=identicon&r=PG&f=1", "display_name": "solemn", "link": "https://stackoverflow.com/users/5120966/solemn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19438, "favorite_count": 4, "answer_count": 3, "score": 9, "last_activity_date": 1579601919, "creation_date": 1436990255, "last_edit_date": 1437063411, "question_id": 31439866, "link": "https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime", "title": "Multiple Variable Arguments to Application.OnTime", "body": "<p>I am working on a data acquisition frontend for Excel 2010.\nI can't figure out the syntax for passing multiple local variable arguments to <code>Application.OnTime</code>. </p>\n\n<p><a href=\"http://markrowlinson.co.uk/articles.php?id=10\" rel=\"noreferrer\">http://markrowlinson.co.uk/articles.php?id=10</a> provides a good example for a single variable as an argument, but the explanation on how to extrapolate this to multiple variables is not clear to me.</p>\n\n<p>Does anyone have a concise explanation of the correct nesting of <code>\"</code> and <code>'</code> characters when passing multiple local variable arguments?</p>\n\n<p>Edit: Code example would be like this: <code>Application.OnTime Now + TimeSerial(0, 0, 5), \"'runScheduledReport \"\"\" &amp; iArg1 &amp; \"\",\"\" &amp; iArg2 &amp; \"\" \"\" &amp; iArg3 &amp; \"\" \"\"'\"</code>.\nI understand that we're using the double quote as an escape character within the string, but can't really figure out the ordering of the strings being passed.</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 3212, "user_id": 1295435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf39389382759c77d2ffc06815de574f?s=128&d=identicon&r=PG&f=1", "display_name": "byako", "link": "https://stackoverflow.com/users/1295435/byako"}, "edited": false, "score": 0, "creation_date": 1436990375, "post_id": 31439723, "comment_id": 50849157, "body": "Your question is not very clear. Which <code>If</code> do you refer to? Also, what do you mean by <i>it does not do what it is supposed to after the &quot;Else&quot;</i>?"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436990441, "post_id": 31439723, "comment_id": 50849203, "body": "You aren&#39;t really explaining much of what is supposed to happen after the else. What are you trying to accomplish after the else? and what is actually happening after the else? Also just as a side note, you have a lot of unnecessary things in your code. Like, you use <code>Sheet1.Activate</code> many times over. You only need to use that once, the first time. You also don&#39;t need the <code>Worksheets(1)</code> in front of all the <code>Range()</code> because <code>Worksheets(1)</code> refers to <code>Sheet1</code> which you have already activated. It is basically redundant."}, {"owner": {"reputation": 29, "user_id": 5120951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Co8LWx_9qmo/AAAAAAAAAAI/AAAAAAAAAEs/fia2bqCVAb8/photo.jpg?sz=128", "display_name": "Lizmert Lopez", "link": "https://stackoverflow.com/users/5120951/lizmert-lopez"}, "edited": false, "score": 0, "creation_date": 1437061744, "post_id": 31439723, "comment_id": 50884637, "body": "Thanks for your help. What I would like to have the program do is that if the statement &#39;If UserADT &lt; ADT And UserSpeed &lt; Speed Then&#39; is not met, using info from a specific column, the program moves to the next column and check for &#39; If UserADT &gt;= ADT And UserSpeed &gt;= Speed Then&#39; and so on until it finds the column that meets the requirements."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436992777, "post_id": 31440501, "comment_id": 50850600, "body": "how come your first few entries (` .Range(&quot;C9, G9, K9, O9&quot;).Value = spnBridgeWidth.Value<code>) works? When I tried the same, it wouldn&#39;t let me?  I tried </code>With Sheets(1) // .Range(&quot;C9&quot;).Value = spnBridgeWidth.Value` and get the RunTime 424 error.  Is that because of how I am using &quot;Sheets(1)&quot; and his <code>Sheet1</code> is a variable that isn&#39;t &quot;Sheets(1)&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1436994279, "post_id": 31440501, "comment_id": 50851453, "body": "No, you can use the <code>Sheet1</code> Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow noreferrer\">.CodeName property</a>, the Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a> or the index on the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheets collection</a>. It was likely just a typo or possibly you were confusing Worksheet<b>s</b> with Worksheet."}, {"owner": {"reputation": 29, "user_id": 5120951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Co8LWx_9qmo/AAAAAAAAAAI/AAAAAAAAAEs/fia2bqCVAb8/photo.jpg?sz=128", "display_name": "Lizmert Lopez", "link": "https://stackoverflow.com/users/5120951/lizmert-lopez"}, "edited": false, "score": 0, "creation_date": 1437061710, "post_id": 31440501, "comment_id": 50884613, "body": "Thanks for your help. What I would like to have the program do is that if the statement &#39;If UserADT &lt; ADT And UserSpeed &lt; Speed Then&#39; is not met, using info from a specific column, the program moves to the next column and check for &#39; If UserADT &gt;= ADT And UserSpeed &gt;= Speed Then&#39; and so on until it finds the column that meets the requirements."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1436992389, "last_edit_date": 1495539829, "creation_date": 1436992389, "answer_id": 31440501, "question_id": 31439723, "link": "https://stackoverflow.com/questions/31439723/moving-to-next-cell-when-using-if-statements/31440501#31440501", "title": "moving to next cell when using if statements", "body": "<p>This may tidy your code up sufficiently to add some logic to the results being cycled through.</p>\n\n<p>Sub tble()\n    Dim co As Long</p>\n\n<pre><code>    With Sheet1\n        .Range(\"C9, G9, K9, O9\").Value = spnBridgeWidth.Value\n        .Range(\"C10, G10, K10, O10\").Value = spnVehLnWidth.Value\n        .Range(\"C12, G12, K12, O12\").Value = spnNoOfLn.Value\n\n        UserADT = UserTool.txtADT.Value\n        UserSpeed = UserTool.txtSpeed.Value\n\n        For co = 0 To 12 Step 4\n            With .Range(\"C4\").Offset(0, co)\n                ADT = .Value\n                Speed = .Offset(1, 0).Value 'could also be .Range(\"C5\")\n                SpaceAvailable = .Offset(10, 0).Value\n                MinSpaceNMT = .Offset(14, 0).Value\n            End With\n\n            'At this point I am unclear on why the logic changes\n            'from less than to greater than or equal\n\n            'If UserADT &lt; ADT And UserSpeed &lt; Speed Then\n            '    If SpaceAvailable &gt; MinSpaceNMT Then\n\n            'If UserADT &gt;= ADT And UserSpeed &gt;= Speed Then\n            '    If SpaceAvailable &gt; MinSpaceNMT Then\n            '        MsgBox \"Safe passage can be within the bridge with Alt. 1.2\"\n            '    Else\n            '        MsgBox \"Safe passage can be outside the bridge\"\n            'When you have cycled through and met your conditions, use:\n            Exit For\n            'and you will jump out of the loop\n        Next co\n    End With\nEnd Sub\n</code></pre>\n\n<p>The latter portion cycles though C9, G9, K9, O9 adding 4 to the column with each pass. You just need to check the values on each pass to see if they meet your criteria for a breakout.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1436992596, "creation_date": 1436992596, "answer_id": 31440558, "question_id": 31439723, "link": "https://stackoverflow.com/questions/31439723/moving-to-next-cell-when-using-if-statements/31440558#31440558", "title": "moving to next cell when using if statements", "body": "<p>Without some more information, the below could get you started.  Note I removed the .Select and .Activate, as those aren't necessary and it makes the code a little easier to read:</p>\n\n<pre><code>Sub test()\nDim spnBridgeWidth, spnVenLnWidth, spnNoOfLn\nDim startCell     As Range, otherCell As Range\n\nSet startCell = Range(\"C4\")\nSet otherCell = Range(\"G4\")\nspnBridgeWidth = 10\nspnVenLnWidth = 20\nspnNoOfLn = 40\n\n\nWith Sheet1\n    .Range(\"C9\").Value = spnBridgeWidth\n    .Range(\"C10\").Value = spnVehLnWidth\n    .Range(\"C12\").Value = spnNoOfLn\n\n    .Range(\"G9\").Value = spnBridgeWidth\n    .Range(\"G10\").Value = spnVehLnWidth\n    .Range(\"G12\").Value = spnNoOfLn\n\n    Sheet1.Activate\n    .Range(\"K9\").Value = spnBridgeWidth\n    .Range(\"K10\").Value = spnVehLnWidth\n    .Range(\"K12\").Value = spnNoOfLn\n\n    .Range(\"O9\").Value = spnBridgeWidth\n    .Range(\"O10\").Value = spnVehLnWidth\n    .Range(\"O12\").Value = spnNoOfLn\nEnd With\n\nWith startCell\n    ADT = .Value\n    Speed = .Offset(1, 0).Value\n\n    SpaceAvailable = .Offset(10, 0).Value\n    MinSpaceNMT = .Offset(14, 0).Value\nEnd With\n\nUserADT = UserTool.txtADT.Value\nUserSpeed = UserTool.txtSpeed.Value\n\n\nIf UserADT &lt; ADT And UserSpeed &lt; Speed Then\n\n    If SpaceAvailable &gt; MinSpaceNMT Then\n\n\n        MsgBox \"Safe passage can be within the bridge with Alt. 1\"\n\n    Else\n       ' Sheet1.Activate\n        'Range(\"G4\").Select\n\n        ADT = otherCell.Value\n        Speed = otherCell.Offset(1, 0).Value\n\n        SpaceAvailable = otherCell.Offset(10, 0).Value\n        MinSpaceNMT = otherCell.Offset(14, 0).Value\n\n        UserADT = UserTool.txtADT.Value\n        UserSpeed = UserTool.txtSpeed.Value\n\n\n        If UserADT &gt;= ADT And UserSpeed &gt;= Speed Then\n\n            If SpaceAvailable &gt; MinSpaceNMT Then\n\n\n                MsgBox \"Safe passage can be within the bridge with Alt. 1.2\"\n\n            Else\n\n                MsgBox \"Safe passage can be outside the bridge\"\n\n\n            End If\n        End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>edit: Bah - Jeeped beat me to it, his looks a little more \"put together\" :P</p>\n"}], "owner": {"reputation": 29, "user_id": 5120951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Co8LWx_9qmo/AAAAAAAAAAI/AAAAAAAAAEs/fia2bqCVAb8/photo.jpg?sz=128", "display_name": "Lizmert Lopez", "link": "https://stackoverflow.com/users/5120951/lizmert-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436993133, "creation_date": 1436989738, "last_edit_date": 1436993133, "question_id": 31439723, "link": "https://stackoverflow.com/questions/31439723/moving-to-next-cell-when-using-if-statements", "title": "moving to next cell when using if statements", "body": "<p>I am very new using VBA. This is what I have done:</p>\n\n<pre><code>Dim ADT As String\n    Dim Speed As String\n    Dim SpaceAvailable As Integer\n    Dim MinSpaceNMT As Integer\n    Dim UserADT As Integer\n    Dim UserSpeed  As Integer\n\n\n    Sheet1.Activate\n    Worksheets(1).Range(\"C9\").Value = spnBridgeWidth.Value\n    Worksheets(1).Range(\"C10\").Value = spnVehLnWidth.Value\n    Worksheets(1).Range(\"C12\").Value = spnNoOfLn.Value\n\n    Sheet1.Activate\n    Worksheets(1).Range(\"G9\").Value = spnBridgeWidth.Value\n    Worksheets(1).Range(\"G10\").Value = spnVehLnWidth.Value\n    Worksheets(1).Range(\"G12\").Value = spnNoOfLn.Value\n\n    Sheet1.Activate\n    Worksheets(1).Range(\"K9\").Value = spnBridgeWidth.Value\n    Worksheets(1).Range(\"K10\").Value = spnVehLnWidth.Value\n    Worksheets(1).Range(\"K12\").Value = spnNoOfLn.Value\n\n    Sheet1.Activate\n    Worksheets(1).Range(\"O9\").Value = spnBridgeWidth.Value\n    Worksheets(1).Range(\"O10\").Value = spnVehLnWidth.Value\n    Worksheets(1).Range(\"O12\").Value = spnNoOfLn.Value\n\n    Sheet1.Activate\n    Range(\"C4\").Select\n\n    ADT = ActiveCell.Value\n    Speed = ActiveCell.Offset(1, 0).Value\n\n    SpaceAvailable = ActiveCell.Offset(10, 0).Value\n    MinSpaceNMT = ActiveCell.Offset(14, 0).Value\n\n    UserADT = UserTool.txtADT.Value\n    UserSpeed = UserTool.txtSpeed.Value\n\n\n    If UserADT &lt; ADT And UserSpeed &lt; Speed Then\n\n    If SpaceAvailable &gt; MinSpaceNMT Then\n\n\n   MsgBox \"Safe passage can be within the bridge with Alt. 1\"\n\n   Else\n            Sheet1.Activate\n            Range(\"G4\").Select\n\n            ADT = ActiveCell.Value\n            Speed = ActiveCell.Offset(1, 0).Value\n\n            SpaceAvailable = ActiveCell.Offset(10, 0).Value\n            MinSpaceNMT = ActiveCell.Offset(14, 0).Value\n\n            UserADT = UserTool.txtADT.Value\n            UserSpeed = UserTool.txtSpeed.Value\n\n\n   If UserADT &gt;= ADT And UserSpeed &gt;= Speed Then\n\n   If SpaceAvailable &gt; MinSpaceNMT Then\n\n\n            MsgBox \"Safe passage can be within the bridge with Alt. 1.2\"\n\n   Else\n\n            MsgBox \"Safe passage can be outside the bridge\"\n\n\n              End If\n           End If\n       End If\n   End If\n</code></pre>\n\n<p>I am trying to have the program move to the next column with information and check if the \"If statement\" is satisfied. However, it does not do what it is supposed to after the \"Else\". Please help me!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436990686, "post_id": 31439707, "comment_id": 50849360, "body": "What version of Excel? xl2013 introduced the <a href=\"https://support.office.com/en-us/article/ISFORMULA-function-E4D1355F-7121-4EF2-801E-3839BFD6B1E5\" rel=\"nofollow noreferrer\">ISFORMULA function</a>. Between that and other native worksheet functions you should be good to go."}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 4873023, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e9c1585e7555cbab6f857c2ea04806fe?s=128&d=identicon&r=PG&f=1", "display_name": "san-san", "link": "https://stackoverflow.com/users/4873023/san-san"}, "is_accepted": false, "score": 0, "last_activity_date": 1437038522, "creation_date": 1437038522, "answer_id": 31450245, "question_id": 31439707, "link": "https://stackoverflow.com/questions/31439707/excel-conditional-formatting-hardcodes-formulas-lnks/31450245#31450245", "title": "Excel + Conditional Formatting hardcodes / formulas / lnks", "body": "<p>Yes, for cell value color, just change the font.color after your hard coded value. same for the links. But I don't get what you mean in changing the color of forumla.</p>\n"}], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437038522, "creation_date": 1436989694, "last_edit_date": 1531161705, "question_id": 31439707, "link": "https://stackoverflow.com/questions/31439707/excel-conditional-formatting-hardcodes-formulas-lnks", "title": "Excel + Conditional Formatting hardcodes / formulas / lnks", "body": "<p>Is there a way to conditonally format an entire excel worksheet where all the hard coded cell values are blue, all the links are green, and all the formulas are black?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1436989553, "post_id": 31439630, "comment_id": 50848724, "body": "What is the value of tempSum at the 39th iteration? Because tempSum is declared as an integer it can only hold a value of 32,767. You might need to change tempSum to a long."}, {"owner": {"reputation": 25, "user_id": 3158492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8457e1a76306970c26554970581e9f5?s=128&d=identicon&r=PG&f=1", "display_name": "augusthippo", "link": "https://stackoverflow.com/users/3158492/augusthippo"}, "reply_to_user": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1436989787, "post_id": 31439630, "comment_id": 50848845, "body": "Are you sure about that 32,767? The reason I ask is this: <a href=\"https://msdn.microsoft.com/en-us/library/06bkb8w2.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/06bkb8w2.aspx</a> It is 33,000 at that iteration. But I wasn&#39;t getting an overflow error. No error at all actually."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1436989845, "post_id": 31439630, "comment_id": 50848871, "body": "VBA &lt;&gt; VB.NET...  And UDF&#39;s typically won&#39;t raise an error - they just return #VALUE"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1436989897, "post_id": 31439630, "comment_id": 50848905, "body": "In VBA, an integer is only 16 bits."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436990811, "post_id": 31439630, "comment_id": 50849429, "body": "Just to confirm, you do know that <code>=SUM(A$1:A1)</code> in B1 (then filled down) would accomplish the same thing."}, {"owner": {"reputation": 25, "user_id": 3158492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8457e1a76306970c26554970581e9f5?s=128&d=identicon&r=PG&f=1", "display_name": "augusthippo", "link": "https://stackoverflow.com/users/3158492/augusthippo"}, "edited": false, "score": 0, "creation_date": 1436991687, "post_id": 31439630, "comment_id": 50849945, "body": "Today is not my best day to look good."}], "answers": [{"tags": [], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "is_accepted": true, "score": 0, "last_activity_date": 1436990902, "creation_date": 1436990902, "answer_id": 31440049, "question_id": 31439630, "link": "https://stackoverflow.com/questions/31439630/excel-vba-running-sum-function/31440049#31440049", "title": "Excel VBA Running Sum Function", "body": "<p>It seems that your numbers are getting too large for <code>integer</code> to hold. Try switching the data type to <code>long</code></p>\n"}], "owner": {"reputation": 25, "user_id": 3158492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8457e1a76306970c26554970581e9f5?s=128&d=identicon&r=PG&f=1", "display_name": "augusthippo", "link": "https://stackoverflow.com/users/3158492/augusthippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2752, "favorite_count": 0, "accepted_answer_id": 31440049, "answer_count": 1, "score": 0, "last_activity_date": 1436990902, "creation_date": 1436989359, "question_id": 31439630, "link": "https://stackoverflow.com/questions/31439630/excel-vba-running-sum-function", "title": "Excel VBA Running Sum Function", "body": "<p>I have a UDF that is attempting to tabulate a running sum of a column of numbers. If column A were my data and column B was the UDF output it would look like:</p>\n\n<pre><code>Column A | Column B\n5        | 5\n10       | 15\n1000     | 1015\n</code></pre>\n\n<p>And so on.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Option Explicit\nPublic Function runningSum(myCell As range) As Integer\n\nDim rowNum As Integer\nDim colNum As Integer\nDim tempSum As Integer\nDim i As Integer\nDim ws As Worksheet\n\nrowNum = myCell.row\ncolNum = myCell.Column\ntempSum = 0\nSet ws = ActiveSheet\n\nWith ws\n    For i = 1 To rowNum\n        tempSum = tempSum + ws.Cells(i, colNum).Value\n    Next i\n    runningSum = tempSum\nEnd With\nExit Function\n\nEnd Function\n</code></pre>\n\n<p>The issue that I am running into is this: at the 39th and each successive iteration I get a #VALUE error. Help please? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1436988791, "post_id": 31439396, "comment_id": 50848325, "body": "I created a class for my progress bar so I can call it whenever necessary."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1436988997, "post_id": 31439396, "comment_id": 50848425, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2169975/is-it-better-to-show-progressbar-userforms-in-vba-as-modal-or-modeless\">Is it better to show ProgressBar UserForms in VBA as modal or modeless?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1436989297, "creation_date": 1436989297, "answer_id": 31439615, "question_id": 31439396, "link": "https://stackoverflow.com/questions/31439396/progress-bar-in-excel-using-vba-and-userforms/31439615#31439615", "title": "Progress Bar in Excel using VBA and userForms", "body": "<p>You are opening the userform as a modal form. To return the control back to the calling module, you must open the userform modelessly:</p>\n\n<pre><code>UserForm1.Show vbModeless\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5120883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2fc134c5a3a28606082a555ce2a8cc?s=128&d=identicon&r=PG&f=1", "display_name": "lamos", "link": "https://stackoverflow.com/users/5120883/lamos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 31439615, "answer_count": 1, "score": 0, "last_activity_date": 1436989297, "creation_date": 1436988567, "question_id": 31439396, "link": "https://stackoverflow.com/questions/31439396/progress-bar-in-excel-using-vba-and-userforms", "title": "Progress Bar in Excel using VBA and userForms", "body": "<p>so I've been looking and cant find anything on this, I hope someone can help.</p>\n\n<p>what I am trying to do:</p>\n\n<p>I want to create a progress bar for my excel workbook that I am making. in order to accomplish this I have created a user form with data fields that I can manipulate from outside of the userform. what I would like to do is to load the userform from inside a module and then from the same module update the userform as the module continues to run.</p>\n\n<p>is there a way to do this?</p>\n\n<p>currently when I use <code>userForm1.Show</code> it displays the userform, but the control never goes back to the calling module, and the code ends when reaching the <code>End Sub</code> for <code>Private Sub userForm1_Activate()</code></p>\n\n<p>any help would be appreciated.</p>\n\n<p>thank you</p>\n"}, {"tags": ["javascript", "jquery", "vba", "events"], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "edited": false, "score": 0, "creation_date": 1436989393, "post_id": 31439365, "comment_id": 50848647, "body": "Is there anyway to move the click handler to the web worker page? I know they don&#39;t allow you to use DOM but I can&#39;t move the code to a background thread (at least not right now)."}, {"owner": {"reputation": 18000, "user_id": 2234742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qznzf.png?s=128&g=1", "display_name": "Maximillian Laumeister", "link": "https://stackoverflow.com/users/2234742/maximillian-laumeister"}, "reply_to_user": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "edited": false, "score": 1, "creation_date": 1436989535, "post_id": 31439365, "comment_id": 50848712, "body": "@GetOtterHere Make a click event on your main page that doesn&#39;t do anything except post a &quot;button clicked&quot; message to the worker thread. Then when the worker thread receives that message, it can handle the event."}], "tags": [], "owner": {"reputation": 18000, "user_id": 2234742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qznzf.png?s=128&g=1", "display_name": "Maximillian Laumeister", "link": "https://stackoverflow.com/users/2234742/maximillian-laumeister"}, "is_accepted": true, "score": 7, "last_activity_date": 1436988653, "last_edit_date": 1436988653, "creation_date": 1436988469, "answer_id": 31439365, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents/31439365#31439365", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>If your application <em>really requires</em> long-running JavaScript code, one of the best ways to deal with it is by using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\" rel=\"noreferrer\">JavaScript web workers</a>. JavaScript code normally runs on the foreground thread, but by creating a web worker you can effectively keep a long-running process on a background thread, and your UI thread will be free to respond to user input.</p>\n\n<p>As an example, you create a new worker like this:</p>\n\n<pre><code>var myWorker = new Worker(\"worker.js\");\n</code></pre>\n\n<p>You can then post messages to it from the js in the main page like this:</p>\n\n<pre><code>myWorker.postMessage([first.value,second.value]);\nconsole.log('Message posted to worker');\n</code></pre>\n\n<p>And respond to the messages in <code>worker.js</code> like this:</p>\n\n<pre><code>onmessage = function(e) {\n  console.log('Message received from main script');\n  var workerResult = 'Result: ' + (e.data[0] * e.data[1]);\n  console.log('Posting message back to main script');\n  postMessage(workerResult);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3629, "user_id": 4730201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yjnMS.png?s=128&g=1", "display_name": "Ricardo Pontual", "link": "https://stackoverflow.com/users/4730201/ricardo-pontual"}, "is_accepted": false, "score": 1, "last_activity_date": 1436988515, "creation_date": 1436988515, "answer_id": 31439382, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents/31439382#31439382", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>You can use the setTimeout:</p>\n\n<pre><code>setTimeout(function() { }, 3600);\n</code></pre>\n\n<p>3600 it's the time in milliseconds:</p>\n\n<p><a href=\"http://www.w3schools.com/jsref/met_win_settimeout.asp\" rel=\"nofollow\">http://www.w3schools.com/jsref/met_win_settimeout.asp</a></p>\n"}, {"comments": [{"owner": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "edited": false, "score": 0, "creation_date": 1436989239, "post_id": 31439405, "comment_id": 50848572, "body": "I&#39;m making a bunch of AJAX calls to a printer and I&#39;m trying to implement a &#39;cancel&#39; button. The problem is that if the button is clicked at any point, the code won&#39;t execute until after the loop is done. I was hoping there was a DoEvents feature where I could check if the button&#39;s been clicked after each iteration. And any time I try a solution with an anonymous function my ui code doesn&#39;t run anymore. (debugging shows the values are there but something like &amp;(selector).dialog(&#39;open&#39;) won&#39;t show)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "edited": false, "score": 1, "creation_date": 1436989373, "post_id": 31439405, "comment_id": 50848639, "body": "@GetOtterHere: Don\u2019t use synchronous XHR, ever. If you make it asynchronous, this problem doesn\u2019t exist, for one. =)"}, {"owner": {"reputation": 18000, "user_id": 2234742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qznzf.png?s=128&g=1", "display_name": "Maximillian Laumeister", "link": "https://stackoverflow.com/users/2234742/maximillian-laumeister"}, "reply_to_user": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "edited": false, "score": 0, "creation_date": 1436989668, "post_id": 31439405, "comment_id": 50848787, "body": "@GetOtterHere With the clarification in your comment, it seems like what you want to do is change your XHR requests to be asynchronous, instead of using web workers."}, {"owner": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "reply_to_user": {"reputation": 18000, "user_id": 2234742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qznzf.png?s=128&g=1", "display_name": "Maximillian Laumeister", "link": "https://stackoverflow.com/users/2234742/maximillian-laumeister"}, "edited": false, "score": 0, "creation_date": 1436991808, "post_id": 31439405, "comment_id": 50850020, "body": "@minitech, @MaximillianLaumeister Yea I just tried implementing a web worker and the line <code>myWorker.postMessage([first.value,second.value]);</code> doesn&#39;t get executed until after the loop is finished. But I&#39;ll definitely rework the XHR requests."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 0, "last_activity_date": 1436988600, "creation_date": 1436988600, "answer_id": 31439405, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents/31439405#31439405", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>There is no exact equivalent to <code>DoEvents</code>. Something close is using <code>setTimeout</code> for each iteration:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>(function next(i) {\n    // exit condition\n    if (i &gt;= 10) {\n        return;\n    }\n\n    // body of the for loop goes here\n\n    // queue up the next iteration\n    setTimeout(function () {\n        // increment\n        next(i + 1);\n    }, 0);\n})(0); // initial value of i\n</code></pre>\n\n<p><em>However</em>, that\u2019s rarely a good solution, and is almost never necessary in web applications. There might be an event you could use that you\u2019re missing. What\u2019s your real problem?</p>\n"}, {"tags": [], "owner": {"reputation": 16264, "user_id": 52239, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2418cf397adaa4f72547f14e61348028?s=128&d=identicon&r=PG", "display_name": "Craig Gidney", "link": "https://stackoverflow.com/users/52239/craig-gidney"}, "is_accepted": false, "score": 2, "last_activity_date": 1442895034, "creation_date": 1442895034, "answer_id": 32708215, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents/32708215#32708215", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>With the introduction of generators in ES6, you can write a helper method that uses <code>yield</code> to emulate DoEvents without much syntactic overhead:</p>\n\n<pre><code>doEventsOnYield(function*() {\n    ... synchronous stuff ...\n\n    yield;  // Pump the event loop. DoEvents() equivalent.\n\n    ... synchronous stuff ...\n});\n</code></pre>\n\n<p>Here's the helper method, which also exposes the completion/failure of the function as a Promise:</p>\n\n<pre><code>function doEventsOnYield(generator) {\n    return new Promise((resolve, reject) =&gt; {\n        let g = generator();\n        let advance = () =&gt; {\n            try {\n                let r = g.next();\n                if (r.done) resolve();\n            } catch (ex) {\n                reject(ex);\n            }\n            setTimeout(advance, 0);\n        };\n        advance();\n    });\n}\n</code></pre>\n\n<p>Note that, at this time, you probably need to run this through an ES6-to-ES5 transpiler for it to run on common browsers.</p>\n"}, {"tags": [], "owner": {"reputation": 586, "user_id": 1863152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cfc323f028fd836267b55e6c9c9c900?s=128&d=identicon&r=PG", "display_name": "www-0av-Com", "link": "https://stackoverflow.com/users/1863152/www-0av-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1510854360, "last_edit_date": 1510854360, "creation_date": 1510853831, "answer_id": 47335941, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents/47335941#47335941", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>Here's a tested example of how to use Yield as a direct replacement for DoEvents. </p>\n\n<p>(I've used Web Worker and it's great, but it's far removed from DoEvents and near-impossible to access global variables). This has been formatted for ease of understanding and attempts to show how the extras required (to make the function handle yield) could be treated as an insertion within the original function. \"yield\" has all sorts of other features, but used thus, it is a near direct replacement for DoEvents.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>//'Replace DoEvents with Yield ( https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/yield )\r\nvar misc = 0; //'sample external var\r\n\r\nfunction myfunction() { //'This is the beginning of your original function which is effectively replaced by a handler inserted as follows..\r\n//'-----------------------------------Insert Handler..\r\n  var obj = myfuncGen.next(); //'start it\r\n  if (obj.done == false) {\r\n    setTimeout(myfunction, 150); //'adjust for the amount of time you wish to yield (depends how much screen drawing is required or etc)\r\n  }\r\n}\r\nvar myfuncGen = myfuncSurrogate(); //'creates a \"Generator\" out of next. \r\nfunction* myfuncSurrogate() { //'This the original function repackaged! Note asterisk. \r\n//'-------------------------------------End Insert    \r\n  var ms;       //...your original function continues here....\r\n  for (var i = 1; i &lt;= 9; i++) { //'sample 9x loop\r\n    ms = new Date().getTime();\r\n    while (new Date().getTime() &lt; ms + 500); //'PAUSE (get time &amp; wait 500ms) as an example of being busy\r\n    misc++; //'example manipulating an external var\r\n    outputdiv.innerHTML = \"Output Div&lt;br&gt;demonstrating progress.. \" + misc;\r\n    yield; //'replacement for your doevents, all internal stack state and variables effectively hibernate.\r\n  }\r\n  console.log(\"done\");\r\n}\r\n\r\nmyfunction(); //'and start by calling here. Note that you can use \"return\" to return a value except by call backs.</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id='outputdiv' align='center'&gt;&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>..If you are new to all this, be aware that without the insertion and the yield keyword, you would simply wait 5 seconds while nothing happened and then the progress {div} would read \"9\" (because all the other changes to {div} were invisible). </p>\n"}], "owner": {"reputation": 593, "user_id": 4632971, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1048181f53e97b685e092f5781a8ba76?s=128&d=identicon&r=PG&f=1", "display_name": "Ph33ly", "link": "https://stackoverflow.com/users/4632971/ph33ly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13072, "favorite_count": 1, "accepted_answer_id": 31439365, "answer_count": 5, "score": 9, "last_activity_date": 1528591974, "creation_date": 1436988246, "question_id": 31439286, "link": "https://stackoverflow.com/questions/31439286/does-javascript-have-anything-similar-to-vbas-doevents", "title": "Does Javascript have anything similar to VBA&#39;s DoEvents?", "body": "<p>I have a long running for-loop in my code and I'd like to delay to loop to handle other tasks in the event queue (like a button press). Does javascript or JQuery have anything that could help me? Basically I'm trying to do something similar to delaying loops like here (<a href=\"https://support.microsoft.com/en-us/kb/118468\" rel=\"noreferrer\">https://support.microsoft.com/en-us/kb/118468</a>).</p>\n"}, {"tags": ["vba", "excel", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4952073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1767d0a0ca7cf9ee367daa5d508e743c?s=128&d=identicon&r=PG", "display_name": "gokool108", "link": "https://stackoverflow.com/users/4952073/gokool108"}, "is_accepted": false, "score": 1, "last_activity_date": 1436988916, "creation_date": 1436988916, "answer_id": 31439504, "question_id": 31439282, "link": "https://stackoverflow.com/questions/31439282/excel-vba-adding-1-hour-to-a-date-time-string/31439504#31439504", "title": "Excel VBA Adding 1 hour to a date / time string", "body": "<p>No VBA needed...assuming the time value above(06/10/15 4:53pm) is in cell A1 the Formula you are looking for is: </p>\n\n<pre><code>=A1+TIME(1,0,0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603384917, "post_id": 31439513, "comment_id": 114027580, "body": "May I ask your reasoning for selecting the chosen answer? This answer is more concise, executes more than twice as fast, is easier to understand, and was submitted before the chosen answer."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1436988961, "creation_date": 1436988961, "answer_id": 31439513, "question_id": 31439282, "link": "https://stackoverflow.com/questions/31439282/excel-vba-adding-1-hour-to-a-date-time-string/31439513#31439513", "title": "Excel VBA Adding 1 hour to a date / time string", "body": "<p>Since you asked for a VBA solution:</p>\n\n<pre><code>s = \"06/10/15 4:53pm\"\n\nMsgBox CDate(s) + 1 / 24\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603384737, "post_id": 31439538, "comment_id": 114027485, "body": "<code>DateAdd()</code> is slow and unnecessary for something as simple as adding hours to a date. My answer (on this page) is more than twice as fast to execute. It&#39;s also MUCH more concise."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603396224, "post_id": 31439538, "comment_id": 114032681, "body": "@ExcelHero Here are my thoughts on why my answer has been upvoted and accepted. If someone must ask how to add an hour to a date string in vba, they should get an answer which is easy to replicate and understand in vba. My answer uses sound, built-in functions for doing what the OP asked in vba. Yours is mostly a math equation, which is a shortcut. My answer explains the need for conversion in the opening line. That&#39;s what someone needs to understand if they have this question. You are optimizing the solution but missing the point of the question. No optimization is need. This is a spreadsheet"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603396755, "post_id": 31439538, "comment_id": 114032912, "body": "Appreciate your comment, but I&#39;ve made a 30-year career optimizing spreadsheets. Your notion is EXTREMELY WRONG. Your answer is OK. It is not great."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603398251, "post_id": 31439538, "comment_id": 114033475, "body": "@ExcelHero -- I concede YOU ARE RIGHT about optimization, especially having made a 30 year career of it. I respect that. I was pointing out the question was not about optimization. It was about converting data types. My answer is clear because it addressed the core issue -- understanding. Your answer is optimized for speed and brevity, but not for understanding. You may feel entitled to votes because your answer is short and fast, but those are not people&#39;s only concerns. Understanding is paramount. I&#39;ve made a career of optimizing understanding. Clarity was the appropriate response here."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603413792, "post_id": 31439538, "comment_id": 114037527, "body": "Once a user realizes what <code>1 &#47; 24</code> means, they immediately become a much more effective Excel user... and not only on the VBA side. I teach advanced Excel... formulas and VBA. <code>DateAdd()</code> has it&#39;s uses, but understanding my answer (which does not take much thought) gets a user further down the path to being an effective spreadsheet modeler."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1603471599, "post_id": 31439538, "comment_id": 114057739, "body": "@ExcelHero I agree. I would be happy to upvote your answer if it included a few things: 1) Some explanatory text regarding the need for conversions from string to date and date to string, 2) Something about dates supporting math where 1 = a day, and 3) a solution for getting the string back in the original format (which the OP asked for). Your suggestions would definitely improve my answer if I incorporated them. I would be happy to include these in mine if you do not want to include them in yours."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 9, "last_activity_date": 1571241996, "last_edit_date": 1571241996, "creation_date": 1436989021, "answer_id": 31439538, "question_id": 31439282, "link": "https://stackoverflow.com/questions/31439282/excel-vba-adding-1-hour-to-a-date-time-string/31439538#31439538", "title": "Excel VBA Adding 1 hour to a date / time string", "body": "<p>Convert it to a date, add an hour, and convert back to string using format</p>\n\n<pre><code>Private Sub TestIt()\n\n    MsgBox AddHour(\"06/10/15 4:53pm\")\n\nEnd Sub\n\nPublic Function AddHour(ByVal sTime As String) As String\n    Dim dt As Date\n\n    dt = CDate(sTime)\n    dt = DateAdd(\"h\", 1, dt)\n\n    AddHour = Format(dt, \"mm/dd/yy h:nnam/pm\")\n\nEnd Function\n</code></pre>\n\n<p>Reference:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions\" rel=\"nofollow noreferrer\">VBA CDate Function</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dateadd-function\" rel=\"nofollow noreferrer\">VBA DateAdd Function</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755.aspx\" rel=\"nofollow noreferrer\">VBA Format Function</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "is_accepted": false, "score": 0, "last_activity_date": 1507720314, "creation_date": 1507720314, "answer_id": 46686764, "question_id": 31439282, "link": "https://stackoverflow.com/questions/31439282/excel-vba-adding-1-hour-to-a-date-time-string/46686764#46686764", "title": "Excel VBA Adding 1 hour to a date / time string", "body": "<p>For operations with date and time in VBA is DateAdd function. You can find how to use it in this link: <a href=\"https://www.techonthenet.com/excel/formulas/dateadd.php\" rel=\"nofollow noreferrer\">https://www.techonthenet.com/excel/formulas/dateadd.php</a></p>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32412, "favorite_count": 0, "accepted_answer_id": 31439538, "answer_count": 4, "score": 5, "last_activity_date": 1571241996, "creation_date": 1436988238, "last_edit_date": 1436996052, "question_id": 31439282, "link": "https://stackoverflow.com/questions/31439282/excel-vba-adding-1-hour-to-a-date-time-string", "title": "Excel VBA Adding 1 hour to a date / time string", "body": "<p>I have a text string that looks like this: \"06/10/15 4:53pm\".  I want to add 1 hour (60 minutes exactly) to the text string looks like this:  \"06/10/15 5:53pm\"</p>\n\n<p>Any suggestions would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 2, "creation_date": 1436985758, "post_id": 31438457, "comment_id": 50846631, "body": "Objects must be instantiated before you use them. Add the line [Set cnn = New ADODB.Connection] before cnn.Open"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1436985876, "post_id": 31438457, "comment_id": 50846689, "body": "...similar for your <code>rst</code> object"}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436985890, "post_id": 31438457, "comment_id": 50846700, "body": "@DonJewett Same error. I&#39;ve worked in VBA without that line before, is it necessary If I declare cnn as a ADODB.Connection object?"}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436986008, "post_id": 31438457, "comment_id": 50846778, "body": "Okay it worked after @TimWilliams&#39;s suggestion, but error&#39;d later down the road. That&#39;s another question in itself, though. Gosh, I&#39;ve never had this much trouble coding in excel haha. Thanks guys!"}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 2, "creation_date": 1436986133, "post_id": 31438457, "comment_id": 50846838, "body": "@RyanWelsh - Yes, it is necessary. The examples you have probably seen do this in one line rather than two, like so: Dim cnn As New ADODB.Connection"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436986717, "post_id": 31438457, "comment_id": 50847170, "body": "@DonJewett Post as answer?"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436986208, "post_id": 31438582, "comment_id": 50846887, "body": "As TimWilliams said in comments, I had to do the same with my recordset. This was the issue I was having, in this regard. Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1436994777, "post_id": 31438582, "comment_id": 50851718, "body": "That is not early/late binding - late binding would be <code>Dim cnn as Object: Set cnn = Createobject(&quot;ADODB.Connection&quot;)</code>   &quot;Dim X As New Y&quot; is <i>auto-instancing</i>"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1436987827, "last_edit_date": 1436987827, "creation_date": 1436985900, "answer_id": 31438582, "question_id": 31438457, "link": "https://stackoverflow.com/questions/31438457/91-object-variable-with-block-not-set-on-adodb-connection-line/31438582#31438582", "title": "&#39;91&#39; Object Variable/With Block not set on ADODB Connection line", "body": "<p>Early bind it as new.</p>\n\n<pre><code>Dim cnn As new ADODB.Connection\n</code></pre>\n\n<p>You can do as Don Jewett said and do it in two lines:</p>\n\n<pre><code>Dim cnn As ADODB.Connection\nSet cnn = New ADODB.Connection\n</code></pre>\n\n<p>That is late binding and in your case just an extra line of code. If you have code where your connection may never be made due to logic, it is good to do late binging near the opening of the connection so the binding doesn't happen until it is needed.  But since you are using your connection and recordset right away, you might as well early bind it.</p>\n"}], "owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 31438582, "answer_count": 1, "score": 2, "last_activity_date": 1436987827, "creation_date": 1436985466, "last_edit_date": 1436986309, "question_id": 31438457, "link": "https://stackoverflow.com/questions/31438457/91-object-variable-with-block-not-set-on-adodb-connection-line", "title": "&#39;91&#39; Object Variable/With Block not set on ADODB Connection line", "body": "<p>I am trying to query a database to fill a listbox (as well as other various tasks). I get the following error when I run my code:</p>\n\n<p>Error:</p>\n\n<pre><code>91 \nObject variable or With block variable not set\n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    On Error GoTo UserForm_Initialize_Err\n    Dim cnn As ADODB.Connection\n    Dim rst As ADODB.Recordset\n    Dim StrDBPath As String\n    Dim strSQL As String\n\n\nstrSQL = \"SELECT [Heads A].[Date Entered], [Heads A Issues].Department, [Heads A Issues].Equipment, [Heads A Issues].[Operation Issues], Sum([Heads A Issues].Downtime) AS SumOfDowntime1, IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew')) AS Crew \" &amp; _\n        \"FROM [Heads A] INNER JOIN [Heads A Issues] ON [Heads A].[HeadLineA ID] = [Heads A Issues].[HeadLineA ID]\" &amp; _\n        \" GROUP BY [Heads A].[Date Entered], [Heads A Issues].Department, [Heads A Issues].Equipment, [Heads A Issues].[Operation Issues], IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew'))\" &amp; _\n        \" HAVING ((([Heads A].[Date Entered])&gt;=#\" &amp; Sheets(\"Choices\").Cells(2, 1).Value &amp; \"# And ([Heads A].[Date Entered])&lt;=#\" &amp; Sheets(\"Choices\").Cells(2, 2).Value &amp; \"#) And (([Heads A Issues].Department)='\" &amp; Sheets(\"Choices\").Cells(2, 3).Value &amp; \"') And ((IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew'))) Like IIf('\" &amp; Sheets(\"Choices\").Cells(2, 4).Value &amp; \"'='all','*-Crew','\" &amp; _\n        Sheets(\"Choices\").Cells(2, 4).Value &amp; \"'))) ORDER BY [Heads A Issues].Department, [Heads A Issues].Equipment;\"\n\nStrDBPath = Application.ActiveWorkbook.Path &amp; \"\\Daily Closing Report V997.accdb\"\n\ncnn.Open \"Provider=Microsoft.Ace.OLEDB.12.0;\" &amp; _ 'THIS IS WHERE THE ISSUE IS\n                         \"Data Source=\" &amp; StrDBPath &amp; \";\" &amp;_\n                         \"Jet OLEDB:Engine Type=5;\" &amp; _\n                         \"Persist Security Info=False;\"\n\nrst.Open strSQL, cnn, adOpenStatic, adLockOptimistic\n\nCopyText (strSQL)\n\nIf (rst.RecordCount = 0) Then\n    MsgBox \"0 records found.\"\n    Unload UserForm1\n    Exit Sub\nEnd If\n\nIf rst.RecordCount &gt; 0 Then\n    rst.MoveFirst\nEnd If\nWith Me.ListBox1\n    .Clear\n    Do While rst.EOF = False\n        .AddItem rst![Department,Heads A]\n        rst.MoveNext\n    Loop\n    End With\nUserForm_Initialize_Exit:\n     On Error Resume Next\n     rst.Close\n     cnn.Close\n     Set rst = Nothing\n     Set cnn = Nothing\n     Exit Sub\nUserForm_Initialize_Err:\n     MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n     Resume UserForm_Initialize_Exit\nEnd Sub\n</code></pre>\n\n<p>I have narrowed down that the error is appearing on the line where I open my connection (marked above), but I'm not sure why it is acting up as it is. TIA!</p>\n"}, {"tags": ["vba", "excel", "excel-web-query"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5120584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726c89b56183d98c512bcd8cd941e912?s=128&d=identicon&r=PG&f=1", "display_name": "VladM", "link": "https://stackoverflow.com/users/5120584/vladm"}, "edited": false, "score": 0, "creation_date": 1436990474, "post_id": 31438609, "comment_id": 50849215, "body": "I finished compiling the code but I get this error:&quot;Compile error: End If without block If&quot; ... I may have typed something out of place :("}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 23, "user_id": 5120584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726c89b56183d98c512bcd8cd941e912?s=128&d=identicon&r=PG&f=1", "display_name": "VladM", "link": "https://stackoverflow.com/users/5120584/vladm"}, "edited": false, "score": 0, "creation_date": 1436991918, "post_id": 31438609, "comment_id": 50850081, "body": "@VladM suggest an edit to my answer and add your code below mine"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1436985995, "creation_date": 1436985995, "answer_id": 31438609, "question_id": 31438382, "link": "https://stackoverflow.com/questions/31438382/create-query-table-based-on-cell-value/31438609#31438609", "title": "Create Query table based on cell value", "body": "<p>I don't know much about your query conditions as you don't list them, but this will handle your loop and output needs:</p>\n\n<pre><code>Sub QueryIt()\n    Dim CurRow As Long, LastRow As Long, DestRow As Long\n\n    LastRow = Sheets(\"Tracker\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    For CurRow = 1 to LastRow\n        If Sheets(\"Tracker\").Range(\"C\" &amp; CurRow).Value = \"New\" Then\n            DestRow = Sheets(\"X\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n            'Query command with address: \"http://efm/telecom/engineeringWorkOrders/viewEWOStatusLog.aspx?ewonumber=\" &amp; Sheets(\"Tracker\").Range(\"A\" &amp; CurRow).Value\n            'Output query to Sheets(\"X\").Range(\"A\" &amp; DestRow).Value\n        End If\n    Next CurRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5120584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726c89b56183d98c512bcd8cd941e912?s=128&d=identicon&r=PG&f=1", "display_name": "VladM", "link": "https://stackoverflow.com/users/5120584/vladm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 31438609, "answer_count": 1, "score": 2, "last_activity_date": 1436985995, "creation_date": 1436985218, "last_edit_date": 1436985672, "question_id": 31438382, "link": "https://stackoverflow.com/questions/31438382/create-query-table-based-on-cell-value", "title": "Create Query table based on cell value", "body": "<p>I want the macro to run from top to bottom on column C (on Sheet \"Tracker\") to find any cells that match the \"Waiting\", \"Deferred\", \"New\", or \"Pending\" text. </p>\n\n<p>Each time it finds a match I want to run a web query on Sheet \"X\" with the address:</p>\n\n<p>\"<a href=\"http://efm/telecom/engineeringWorkOrders/viewEWOStatusLog.aspx?ewonumber=\" rel=\"nofollow\">http://efm/telecom/engineeringWorkOrders/viewEWOStatusLog.aspx?ewonumber=</a>\"\n+\nthe corresponding value in column A from the matched cell in column C. </p>\n\n<pre><code>If (in Sheet \"Tracker\") Range(\"C\" &amp; CurRow).Value is \"New\" Then\n    Run a web query in Sheet \"X\" (Starting in cell A1) with the address: \"http://efm/telecom/engineeringWorkOrders/viewEWOStatusLog.aspx?ewonumber=\" &amp; Range(\"A\" &amp; CurRow).Value\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "edited": false, "score": 0, "creation_date": 1437053808, "post_id": 31439160, "comment_id": 50878531, "body": "Hi user3476534, I&#39;ve tried to use the command you suggested but unfortunately it didn&#39;t work. In this case instead of getting the values without commas I get nothing, i.e. the cells remain blank... I also tried to add <b>Worksheets(&quot;Sheet1&quot;)</b> to it but it still got me no results! I used: <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;H2:O1440&quot;).PasteSpecial xlPasteValues</code>"}], "tags": [], "owner": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "is_accepted": false, "score": 0, "last_activity_date": 1436987800, "creation_date": 1436987800, "answer_id": 31439160, "question_id": 31438318, "link": "https://stackoverflow.com/questions/31438318/vba-excel-neglects-comma-when-pasting-external-data/31439160#31439160", "title": "VBA - excel neglects comma when pasting external data", "body": "<p>Instead of pasting with application.paste, try to paste only the values. ie: Instead of</p>\n\n<pre><code>Application.Paste Destination:=Worksheets(\"Sheet1\").Range(\"H2:O1440\")\n</code></pre>\n\n<p>Use</p>\n\n<pre><code>Range(\"H2:O1440\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>If that doesn't work, parse the output as a string.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "edited": false, "score": 0, "creation_date": 1437054136, "post_id": 31447686, "comment_id": 50878782, "body": "Hey Nicolas! I tried to use the commands you suggested but then instead of getting the wrong numbers I simply get blank cells, which is pretty odd... As I said, this is on of my first times using vba, so I really don&#39;t know what could have gone wrong with this command line! Anyhow, I appreciate the help."}, {"owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "edited": false, "score": 0, "creation_date": 1437054745, "post_id": 31447686, "comment_id": 50879321, "body": "Same thing... Still blank."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1437054427, "last_edit_date": 1437054427, "creation_date": 1437031054, "answer_id": 31447686, "question_id": 31438318, "link": "https://stackoverflow.com/questions/31438318/vba-excel-neglects-comma-when-pasting-external-data/31447686#31447686", "title": "VBA - excel neglects comma when pasting external data", "body": "<p>You can also try this:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"H2\").PasteSpecial xlPasteValuesAndNumberFormats\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1546468189, "post_id": 31457897, "comment_id": 94865127, "body": "Many thanks!! Works really good. I only used: <code>interval.NumberFormat = &quot;@&quot; &#39;set format to text</code> then <code>&quot;I pasted my code&quot;</code> and last I used: <code>interval.NumberFormat = &quot;General&quot; &#39;set format to general</code> to preserve copy paste values with <code>.</code> and <code>,</code> values."}], "tags": [], "owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "is_accepted": true, "score": 1, "last_activity_date": 1437058969, "last_edit_date": 1492088371, "creation_date": 1437058969, "answer_id": 31457897, "question_id": 31438318, "link": "https://stackoverflow.com/questions/31438318/vba-excel-neglects-comma-when-pasting-external-data/31457897#31457897", "title": "VBA - excel neglects comma when pasting external data", "body": "<p>Problem solved!\nI also posted the question in the portuguese speaking community of stackoverflow and got a very helpful answer. With little adjustments it solved my problem!\nThe link to the solution in portuguese follows:</p>\n\n<p><a href=\"https://pt.stackoverflow.com/questions/74860/vba-excel-n%C3%A3o-reconhece-v%C3%ADrgula-de-dados-externos\">https://pt.stackoverflow.com/questions/74860/vba-excel-n%C3%A3o-reconhece-v%C3%ADrgula-de-dados-externos</a></p>\n\n<p>But for those who would prefer the english version I'll try to summarize what was done to fix the code:</p>\n\n<p>1- declare range variables:</p>\n\n<pre><code>Dim interval As Range 'represent the cells in which info was pasted\nDim Cell As Range 'to allow cell format to be changed\n</code></pre>\n\n<p>2- after copying the results from the esternal program and before pasting:</p>\n\n<pre><code>Set interval = Worksheets(\"Sheet1\").Range(\"H2:O1440\") 'set interval to paste the results\ninterval.NumberFormat = \"@\" 'set format to text\n</code></pre>\n\n<p>3- after pasting: </p>\n\n<pre><code>interval.NumberFormat = \"General\" 'set format to general\nFor Each Cell In interval\n    Cell.Value = FormatNumber(CDbl(Cell.Value), 2) 'set only 2 decimal places\n    Cell.Value = CDbl(Cell.Value) 'set to double\nNext\n</code></pre>\n\n<p>The rest of the code stays as it is.</p>\n\n<p>Special thanks to Cantoni who helped with the solution in the pt version.</p>\n"}], "owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1941, "favorite_count": 0, "accepted_answer_id": 31457897, "answer_count": 3, "score": 4, "last_activity_date": 1437058969, "creation_date": 1436984991, "last_edit_date": 1495541388, "question_id": 31438318, "link": "https://stackoverflow.com/questions/31438318/vba-excel-neglects-comma-when-pasting-external-data", "title": "VBA - excel neglects comma when pasting external data", "body": "<p>I'm trying to write a vba code using the DDE method. The code aims to copy a set of columns of an excel table and paste it in a parametric table in the EES (Engineering Equation Solver) software. Then an EES code is run to solve de table, generating columns of output data. This data is then copied and pasted back in the excel file that contains the input data.</p>\n\n<p>Since I'm new to vba, I've used the example provided by EES (Executing EES Macro Commands from EXCEL) as a guideline.</p>\n\n<p>The problem occurs when the data is pasted back in the excel spreadsheet: the code seems to be neglecting the decimal separator! Both my excel and EES are set to work with the comma as the decimal separator and when I manually copy the results from EES and paste then to excel the number is pasted normally, with the comma (also the numbers from excel are correctly pasted into ESS).</p>\n\n<p>However, when I set the code to perform this task numbers such as \"15,47\" are pasted in excel as \"1,55E+12\" or \"1547421377050\". The code is shown below:</p>\n\n<pre><code>Private Sub cmdDDE_Click()\nDim ChNumber As Integer\nDim myShell As String\n\nChNumber = -1\nmyShell = frmEESDDE.txtApp.Text\n\nOn Error Resume Next\n\n'Copy selected rows into clipboard\nRange(\"B2:G1401\").Select\nSelection.Copy\n\nShell_R = Shell(myShell, 1)\n\nIf Shell_R &lt;&gt; \"\" Then\n'Initiate DDE\nChNumber = Application.DDEInitiate(app:=\"ees\", topic:=\"\")\n\nIf ChNumber &lt;&gt; -1 Then\n    'Open EES\n    Application.DDEExecute ChannelNumber, \"[Open C:\\EES\\Tablesolve.ees]\"\n    'Paste data\n    Application.DDEExecute ChannelNumber, \"[Paste Parametric 'Table 1' R1 C1]\"\n    'Solve parametrictable\n    Application.DDEExecute ChannelNumber, \"[SOLVETABLE 'TABLE 1' Rows=1..1400]\"\n    'Copy results\n    Application.DDEExecute ChannelNumber, \"[COPY ParametricTable 'Table 1' R1 C7:R1400 C14]\"\n    'Choose separators\n    Application.DecimalSeparator = \",\"\n    Application.ThousandsSeparator = \".\"\n    Application.UseSystemSeparators = False\n    'Paste results from EES into EXCEL\n    Application.Paste Destination:=Worksheets(\"Sheet1\").Range(\"H2:O1440\")\n    Application.UseSystemSeparators = True\n    'Quit EES and Terminate DDE\n    DDEExecute ChNumber, \"QUIT\"\n    Application.DDETerminate ChNumber\nElse\n    MsgBox \"Unable to initiate connection to EES\", vbExclamation, \"EES DDE\"\nEnd If\n\nfrmEESDDE.Hide\n\nElse\n    MsgBox \"The application, \" &amp; myShell &amp; \", was not found\", vbExclamation, \"EES DDE\"\nEnd If\n</code></pre>\n\n<p>PS = As you can see I've tried to set the decimal separator to \",\" as suggested in this link: <a href=\"https://stackoverflow.com/questions/28105731/pasting-decimal-numbers-in-excel-comma-and-point-decimal-separator\">Pasting decimal numbers in excel / comma and point decimal separator</a> but it didn't work either!</p>\n\n<p>I appreciate your help!</p>\n"}, {"tags": ["excel", "vba", "for-loop", "checkbox", "userform"], "comments": [{"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436991764, "post_id": 31438313, "comment_id": 50849992, "body": "I don&#39;t understand what you are trying to do in the follow up."}, {"owner": {"reputation": 21, "user_id": 5120642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105360615685079/picture?type=large", "display_name": "Greg Jagger", "link": "https://stackoverflow.com/users/5120642/greg-jagger"}, "reply_to_user": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436992645, "post_id": 31438313, "comment_id": 50850517, "body": "This will select the cells and change their color &amp; add text &quot;BLOCKED&quot; if they are selected as blocked on the userform. I have it working with the 16 if statements, I was just curious if there was a better/more efficient way."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436993001, "post_id": 31438313, "comment_id": 50850726, "body": "I don&#39;t see a reason for if statements. Figure out what changes in each case and use your loop to set the increment values of c, m, j, and k each time."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5120642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105360615685079/picture?type=large", "display_name": "Greg Jagger", "link": "https://stackoverflow.com/users/5120642/greg-jagger"}, "edited": false, "score": 0, "creation_date": 1436991437, "post_id": 31438788, "comment_id": 50849790, "body": "Hi Don! Thanks for this. I just added an update to my original question and wanted to see if you had any suggestions. Thanks again!"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1436986589, "creation_date": 1436986589, "answer_id": 31438788, "question_id": 31438313, "link": "https://stackoverflow.com/questions/31438313/how-to-loop-through-checkboxes-on-dynamically-created-userform/31438788#31438788", "title": "How to loop through checkboxes on dynamically created userform?", "body": "<p>Loop through them by name the same way you created them.</p>\n\n<pre><code>Dim ctl As Control\n\nFor i = 2 To 17\n    Set ctl = Controls.Item(\"CheckBox_\" &amp; i)    \nNext 'i\n</code></pre>\n\n<p>Also, I would create module level constants for the initial values of col, lcol, etc. and reuse those in both routines.</p>\n"}], "owner": {"reputation": 21, "user_id": 5120642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105360615685079/picture?type=large", "display_name": "Greg Jagger", "link": "https://stackoverflow.com/users/5120642/greg-jagger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1231, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436991403, "creation_date": 1436984969, "last_edit_date": 1436991403, "question_id": 31438313, "link": "https://stackoverflow.com/questions/31438313/how-to-loop-through-checkboxes-on-dynamically-created-userform", "title": "How to loop through checkboxes on dynamically created userform?", "body": "<p>I'm trying to utilize a dynamically created userform and based on what boxes are check, gray out certain cells. </p>\n\n<p>As background, this is for an injection molding facility. QA sets up the cavity numbers that are running. This dynamic userform creates checkboxes based on the cavity numbers that are input on the worksheet. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n\nDim col         As Long\nDim row         As Long\nDim lcol        As Long\nDim i           As Long\nDim j           As Long\nDim chkBox      As MsForms.CheckBox\nDim l           As MsForms.Frame\nDim t           As MsForms.Label\n\nSet l = Me.Controls.Add(\"Forms.Frame.1\", \"cavz\", True)\n    l.Caption = \"BLOCKED CAVITIES\"\n    l.Height = 195\nSet t = l.Controls.Add(\"Forms.Label.1\", \"mark\")\n    t.Caption = \"Mark all cavities that are currently blocked:\"\n    t.Width = 175\n    t.Top = 10\n\ncol = 2 'Set your column index here\nrow = 8\nlcol = 17\nj = 1\n\nFor i = col To lcol\nSet chkBox = l.Controls.Add(\"Forms.CheckBox.1\", \"CheckBox_\" &amp; i)\nIf Worksheets(\"QA\").Cells(row, i).Value &lt;&gt; \"\" Then\n    chkBox.Caption = Worksheets(\"QA\").Cells(row, i).Value\nElseIf Worksheets(\"QA\").Cells(row, i).Value = \"\" Then\n    GoTo 10\nEnd If\nIf i &lt;= 9 Then\n    'MsgBox \"i = \" &amp; i\n    chkBox.Left = 5\n    chkBox.Top = 5 + ((i - 1) * 20)\nElseIf i &gt; 9 Then\n    j = j + 1\n    'MsgBox \"j = \" &amp; j\n    chkBox.Left = 100\n    chkBox.Top = 5 + ((j - 1) * 20)\nEnd If\n10\nNext i\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nUnload Me\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\nDim x As Control\nDim cavz As MsForms.Frame\n\nFor Each x In cavz.Controls\nIf x.Value = True Then\n    If x.Value = Range(\"B8\") Then\n        Range(\"B8:B14\").Select\n        Selection.Interior.ColorIndex = 16\n    End If\nEnd If\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>I started out doing one thing, and somehow this is what my code turned into. It's not the neatest code, but I would still consider myself a novice at this. Plus, this is the first time I couldn't find the answer on my own and thus my first time asking for help. So, any help would be greatly appreciated!</p>\n\n<p>Thanks!</p>\n\n<p><strong><em>UPDATE</em></strong>\nThis is great! Thank you Don. However, I do have a follow up question. Perhaps I've been banging my head against this for too long, but I cannot think of a more efficient way to do this. Here is what I'm now doing:</p>\n\n<pre><code>For i = 2 To 17\nSet ctl = Controls.Item(\"CheckBox_\" &amp; i)\n    If ctl = True Then\n        If i = 2 Then\n            Range(Cells(j, c), Cells(m, c)).Select\n            Selection.Interior.ColorIndex = 16\n            Range(Cells(k, c), Cells(m, c)).Select\n            With Selection\n                .Merge\n                Cells(k, c) = \"BLOCKED\"\n                .Orientation = 90\n                .VerticalAlignment = xlCenter\n                .HorizontalAlignment = xlCenter\n            End With\n        End If\nNext i\n</code></pre>\n\n<p>etc</p>\n\n<p>I'm in the process of writing if i = 1 through 17, but I feel like there's a more efficient way and I just can't crack it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437107202, "post_id": 31437559, "comment_id": 50902717, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"comments": [{"owner": {"reputation": 2387, "user_id": 556079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2023fd0c7b1a1cab5d98a71f72f46d30?s=128&d=identicon&r=PG", "display_name": "jkupczak", "link": "https://stackoverflow.com/users/556079/jkupczak"}, "edited": false, "score": 0, "creation_date": 1436988094, "post_id": 31438325, "comment_id": 50847940, "body": "Would it be possible to set that code as a variable? I tried <code>myRange = Range(tblN &amp; &quot;[&quot; &amp; colN &amp; &quot;]&quot;)</code> but it didn&#39;t work. Also, what is the most efficient way to get the <code>tblN</code> and <code>colN</code>?"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1436985002, "creation_date": 1436985002, "answer_id": 31438325, "question_id": 31437559, "link": "https://stackoverflow.com/questions/31437559/how-can-i-set-the-range-of-the-first-listobject-in-an-excel-worksheet-to-be-a-va/31438325#31438325", "title": "How can I set the range of the first listobject in an Excel worksheet to be a variable?", "body": "<p>You can use string concatenation. <code>Range(tblN &amp; \"[\" &amp; colN &amp; \"]\")</code> where <code>tblN</code> and <code>colN</code> are string variables with the table name and column name.</p>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 2, "last_activity_date": 1436991426, "creation_date": 1436991426, "answer_id": 31440196, "question_id": 31437559, "link": "https://stackoverflow.com/questions/31437559/how-can-i-set-the-range-of-the-first-listobject-in-an-excel-worksheet-to-be-a-va/31440196#31440196", "title": "How can I set the range of the first listobject in an Excel worksheet to be a variable?", "body": "<p>Presuming I understand your question correctly, you can refer point a variable to the first table in the worksheet as such:</p>\n\n<pre><code>Sub Testit()\n    Dim tbl As ListObject\n\n    Set tbl = Sheet1.ListObjects(1)\nEnd Sub\n</code></pre>\n\n<p>From there, you can reference the tables properties as needed. Examples follow:</p>\n\n<pre><code>MsgBox tbl.Name\nMsgBox tbl.ListColumns.Count\nMsgBox tbl.ListColumns(2).Name\n</code></pre>\n"}], "owner": {"reputation": 2387, "user_id": 556079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2023fd0c7b1a1cab5d98a71f72f46d30?s=128&d=identicon&r=PG", "display_name": "jkupczak", "link": "https://stackoverflow.com/users/556079/jkupczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 31440196, "answer_count": 2, "score": 2, "last_activity_date": 1437107197, "creation_date": 1436982588, "last_edit_date": 1437107197, "question_id": 31437559, "link": "https://stackoverflow.com/questions/31437559/how-can-i-set-the-range-of-the-first-listobject-in-an-excel-worksheet-to-be-a-va", "title": "How can I set the range of the first listobject in an Excel worksheet to be a variable?", "body": "<p>I have a macro in Excel that I use to alter and process data in a table. I'm trying to make it less specific in the table that it affects. When I need to search through the table, my macro explicitly references the table name and sometimes the specific table header like so:</p>\n\n<p><code>Range(\"productUpdate[id]\")</code></p>\n\n<p>I want my macro to be able to handle table's that do not match that specific criteria. I figured I could assign the name to a variable, but I don't know to get the data I need. How would I accomplish this?</p>\n\n<p>My criteria for finding the information:</p>\n\n<ul>\n<li>The table's name could be anything. </li>\n<li>The first column header could be named anything. </li>\n<li>The table is always going to be the first table/listobject in the worksheet.</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983003, "post_id": 31437485, "comment_id": 50845029, "body": "I apologize that I didn&#39;t specify the line. I&#39;ll try your edits!"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983127, "post_id": 31437485, "comment_id": 50845111, "body": "@Ryan Welsh Welcome to stackoverflow. Let me know if the changes work.  If they do work, please accept the answer."}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983168, "post_id": 31437485, "comment_id": 50845133, "body": "This did make the error go away, however the listbox isn&#39;t being populated. That is another question in itself, so I&#39;ll see what I can do and go from there. Thanks!"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983407, "post_id": 31437485, "comment_id": 50845275, "body": "Yes, if the recordset was eof or bof the query is not returning any records.  That brings you closer to the solution.  I would suggest displaying the strSQL in a messagebox so you can see what you are getting in your variable that you are querying.  Or you can break after it is built and display it in your immediate window if you are familiar with the IDE."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983581, "post_id": 31437485, "comment_id": 50845389, "body": "Let me know if you need help debuging that."}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436983894, "post_id": 31437485, "comment_id": 50845588, "body": "I&#39;ve copied the output of strSQL to my clipboard and pasted it into a query w/in the database and it works just fine. So that isn&#39;t the issue, but that doesn&#39;t leave me with much else to debug. What else do you think it could be?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "edited": false, "score": 0, "creation_date": 1436984508, "post_id": 31437485, "comment_id": 50845920, "body": "I just posted a bit more above about the cnn and rst declarations. If that doesn&#39;t help it may be due to the suttle sql syntax differneces between the query browser that is executing your query successfully and vba adodb. I would open a new question. In your new question just show your query coming from the strsql variable. Describe that it produces records in query browser but not from your adodb recordset.open add tags vba, sql, whatever DB you are querying, and the tag for whatever query browser you are using if there is one."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1436984326, "last_edit_date": 1436984326, "creation_date": 1436982324, "answer_id": 31437485, "question_id": 31437339, "link": "https://stackoverflow.com/questions/31437339/eof-bof-error-excel-vba/31437485#31437485", "title": "EOF/BOF Error - Excel VBA", "body": "<p>Without knowing what line you are getting the error on I assume it is in this section</p>\n\n<pre><code> rst.MoveFirst\n With Me.ListBox1\n     .Clear\n     Do\n         .AddItem rst![Department]\n         rst.MoveNext\n     Loop Until rst.EOF\n End With\n</code></pre>\n\n<p>I would make these changes.</p>\n\n<pre><code> If rst.recordcount &gt; 0 then\n     rst.MoveFirst\n End if\n With Me.ListBox1\n     .Clear\n     Do while rst.eof = false\n         .AddItem rst![Department]\n         rst.MoveNext\n     Loop\n End With\n</code></pre>\n\n<p>I would also suggest using a lock on your recordset.  Look into adLockOptimistic and adlockpessimistic.</p>\n\n<pre><code>rst.Open strSQL, cnn, adOpenStatic, adLockOptimistic \n</code></pre>\n\n<p>To answer your last comment I would try declaring the objects different. Not that there is anything wrong with the way you did it since it didn't produce any errors. Try like this</p>\n\n<pre><code>Dim cnn As new adodb.connection\nDim rst As new adodb.recordset\n</code></pre>\n\n<p>This is early binding. So you can take out the set cnn=CreateObject() and set rst=CreateObject()\nSee if that get's you anywhere. </p>\n"}], "owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 1, "accepted_answer_id": 31437485, "answer_count": 1, "score": 1, "last_activity_date": 1436984326, "creation_date": 1436981959, "last_edit_date": 1531164843, "question_id": 31437339, "link": "https://stackoverflow.com/questions/31437339/eof-bof-error-excel-vba", "title": "EOF/BOF Error - Excel VBA", "body": "<p>I am receiving the following error when I try to query a database from an excel file:</p>\n\n<pre><code>Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record.\n</code></pre>\n\n<p>Why does this error pop up? I've tested my SQL in-database and it works without issue (I've checked 4 times that I don't have typos).</p>\n\n<p>I plan on appending a specific row of this data to a listbox, and doing various other things with the rest of the data. To test my SQL, I figured I would just take this first step.</p>\n\n<p>My code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Check = True\n    On Error GoTo UserForm_Initialize_Err\n    Dim cnn As Object\n    Dim rst As Object\n    Dim StrDBPath As String\n    Dim strSQL As String\n    Set cnn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n    strSQL = \"SELECT [Heads A].[Date Entered], [Heads A Issues].Department, [Heads A Issues].Equipment, [Heads A Issues].[Operation Issues], Sum([Heads A Issues].Downtime) AS SumOfDowntime1, IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew')) AS Crew \" &amp; _\n            \"FROM [Heads A] INNER JOIN [Heads A Issues] ON [Heads A].[HeadLineA ID] = [Heads A Issues].[HeadLineA ID]\" &amp; _\n            \" GROUP BY [Heads A].[Date Entered], [Heads A Issues].Department, [Heads A Issues].Equipment, [Heads A Issues].[Operation Issues], IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew'))\" &amp; _\n            \" HAVING ((([Heads A].[Date Entered])&gt;=#\" &amp; Sheets(\"Choices\").Cells(2, 1).Value &amp; \"# And ([Heads A].[Date Entered])&lt;=#\" &amp; Sheets(\"Choices\").Cells(2, 2).Value &amp; \"#) And (([Heads A Issues].Department)='\" &amp; Sheets(\"Choices\").Cells(2, 3).Value &amp; \"') And ((IIf([Head A Crew]='3','C-Crew',IIf([Head A Crew]='2','B-Crew','A-Crew'))) Like IIf('\" &amp; Sheets(\"Choices\").Cells(2, 4).Value &amp; \"'='all','*-Crew','\" &amp; _\n            Sheets(\"Choices\").Cells(2, 4).Value &amp; \"'))) ORDER BY [Heads A Issues].Department, [Heads A Issues].Equipment;\"\n\n    StrDBPath = Application.ActiveWorkbook.Path &amp; \"\\Daily Closing Report V997.accdb\"\n     cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                             \"Data Source=\" &amp; StrDBPath &amp; \";\" &amp; _\n                             \"Jet OLEDB:Engine Type=5;\" &amp; _\n                             \"Persist Security Info=False;\"\n     rst.Open strSQL, _\n              cnn, adOpenStatic\n     rst.MoveFirst\n     With Me.ListBox1\n         .Clear\n         Do\n             .AddItem rst![Department]\n             rst.MoveNext\n         Loop Until rst.EOF\n     End With\nUserForm_Initialize_Exit:\n     On Error Resume Next\n     rst.Close\n     cnn.Close\n     Set rst = Nothing\n     Set cnn = Nothing\n     Exit Sub\nUserForm_Initialize_Err:\n     MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n     Resume UserForm_Initialize_Exit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436981454, "post_id": 31437154, "comment_id": 50844096, "body": "Have you tried just recording a macro and using the code from manually clicking on the filters?"}, {"owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436981501, "post_id": 31437154, "comment_id": 50844123, "body": "@Constuntine : sorry I didnt understand you"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 1, "creation_date": 1436981714, "post_id": 31437154, "comment_id": 50844253, "body": "If you go to the Developer tab and click <code>Record Macro</code>. It will give you the VBA code for everything you are doing. So just click <code>Record Macro</code>. Then select what you want to filter. Go to the <code>Data</code> tab and select filter. It will place an arrow on whatever data you selected. Click the arrow and place the filters. After that, go back and click <code>Stop Recording</code>. Then go to your code editor and there will be a module in there that has the code you need to filter. Then simply copy and paste it where you need it."}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "edited": false, "score": 0, "creation_date": 1436985422, "post_id": 31437154, "comment_id": 50846456, "body": "I don&#39;t understand your filter. Any value will be either &lt;&gt; &quot;<i>ABC</i>&quot; or &lt;&gt;&quot;XYZ&quot;. Perhaps you mean to use xlAnd"}, {"owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1437067157, "post_id": 31437154, "comment_id": 50887927, "body": "@Constuntine : thank you so much.. i did what you told"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1437067407, "post_id": 31437154, "comment_id": 50888053, "body": "Posted in the answers so you can mark as solved."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "edited": false, "score": 0, "creation_date": 1437067187, "post_id": 31450364, "comment_id": 50887941, "body": "thanks san-san. this question is resolved.. i did what Constuntine  told in above comment"}], "tags": [], "owner": {"reputation": 64, "user_id": 4873023, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e9c1585e7555cbab6f857c2ea04806fe?s=128&d=identicon&r=PG&f=1", "display_name": "san-san", "link": "https://stackoverflow.com/users/4873023/san-san"}, "is_accepted": false, "score": 0, "last_activity_date": 1437038834, "creation_date": 1437038834, "answer_id": 31450364, "question_id": 31437154, "link": "https://stackoverflow.com/questions/31437154/add-two-criterias-in-vba-range-filter/31450364#31450364", "title": "Add two criterias in VBA range filter", "body": "<p>What is your criteria in your second filter? I think that one was missing.</p>\n"}, {"tags": [], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "is_accepted": true, "score": 0, "last_activity_date": 1437067381, "creation_date": 1437067381, "answer_id": 31460705, "question_id": 31437154, "link": "https://stackoverflow.com/questions/31437154/add-two-criterias-in-vba-range-filter/31460705#31460705", "title": "Add two criterias in VBA range filter", "body": "<p>If you go to the Developer tab and click <code>Record Macro</code>. It will give you the VBA code for everything you are doing. So just click <code>Record Macro</code>. Then select what you want to filter. Go to the <code>Data</code> tab and select filter. It will place an arrow on whatever data you selected. Click the arrow and place the filters. After that, go back and click <code>Stop Recording</code>. Then go to your code editor and there will be a module in there that has the code you need to filter. Then simply copy and paste it where you need it.</p>\n"}], "owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 31460705, "answer_count": 2, "score": 1, "last_activity_date": 1437067381, "creation_date": 1436981359, "last_edit_date": 1531164843, "question_id": 31437154, "link": "https://stackoverflow.com/questions/31437154/add-two-criterias-in-vba-range-filter", "title": "Add two criterias in VBA range filter", "body": "<p>I am trying to select a range of values based on filter 1 and filter 2 and then delete all those values; so that I am only left with filter1 and filter2 values in column. I am able to add one filter, but I am not able to add two filters. Please help/guide.</p>\n\n<p>Code:</p>\n\n<pre><code>Case \"Sheet-1\"\n                         iCol = 2\n                         Rows(\"4:4\").Select      \n                         Selection.AutoFilter\n                         ActiveSheet.Range(\"$A$4:$WXR$99999\").AutoFilter Field:=iCol, Criteria1:= _\n                         \"&lt;&gt;*ABC*\", Operator:=xlOr, Criteria2:=\"&lt;&gt;XYZ*\"\n                         Rows(\"5:5\").Select \n                         Range(Selection, Selection.End(xlDown)).Select\n                         Range(Selection, Selection.End(xlDown)).Select\n                         Selection.Delete Shift:=xlUp\n                         ActiveSheet.Range(\"$A$4:$WXR$99999\").AutoFilter Field:=iCol\n</code></pre>\n"}, {"tags": ["vba", "excel", "parsing"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1436981052, "post_id": 31436930, "comment_id": 50843860, "body": "You want <code>77.170 (+&#47;- 0.025)</code> to become <code>77.170 +&#47;- 0.025</code> right? Are the nominal and tolerance in the same cell? The outcome should be in 1 or 2 cells?"}, {"owner": {"reputation": 13, "user_id": 5013001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a2057246e3830a74bd3112ce8c018c4?s=128&d=identicon&r=PG&f=1", "display_name": "fredark", "link": "https://stackoverflow.com/users/5013001/fredark"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1436981246, "post_id": 31436930, "comment_id": 50843965, "body": "No, I want to seperate it into two different variables in VBA, where one variable will be just the first number, and the second will be just the second. I dont need the +/- for anything. Sorry that this was unclear."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1436987872, "post_id": 31436930, "comment_id": 50847812, "body": "Please consider my suggested improvement."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5013001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a2057246e3830a74bd3112ce8c018c4?s=128&d=identicon&r=PG&f=1", "display_name": "fredark", "link": "https://stackoverflow.com/users/5013001/fredark"}, "edited": false, "score": 0, "creation_date": 1436981485, "post_id": 31437128, "comment_id": 50844112, "body": "Thanks, this might work, but I cant change the document I&#39;m working on. I need to store it in variables so I can manipulate it and use it on a seperate workbook. This would change the document the information is on, wouldn&#39;t it?"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1436981297, "creation_date": 1436981297, "answer_id": 31437128, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437128#31437128", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>Use Text to Columns and a formula.</p>\n\n<p>Go to Data--->Text to Columns. Choose delimited and choose Space as your delimiter. This should split the text string into something like:</p>\n\n<pre><code>ColA  |ColB|ColC\n77.170|(+/-|0.025)\n</code></pre>\n\n<p>Column C is a bit funky, so let's just grab everything but the last character.</p>\n\n<p>In column D put this:</p>\n\n<pre><code>=LEFT(C1,LEN(C1)-1)\n</code></pre>\n\n<p>Finally, you should get:</p>\n\n<pre><code>ColA  |ColB |ColC  |ColD |\n77.170|(+/- |0.025)|0.025|\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "is_accepted": false, "score": 0, "last_activity_date": 1436981306, "creation_date": 1436981306, "answer_id": 31437131, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437131#31437131", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>I would use a combination of instr() and mid to get what you need. For example</p>\n\n<pre><code>measurments=\"77.170 (+/- 0.025)\"\nmid(measurements,1,instr(measurements,\" \"))\ntrim(mid(measurements,instr(measurements,\"-\")+1,instr(measurements,\")\")-instr(measurements,\"-\")-1))\n</code></pre>\n\n<p>or, to combine,</p>\n\n<pre><code>measurments=\"77.170 (+/- 0.025)\"\nmid(measurements,1,instr(measurements,\" \")) &amp; \" \" &amp; trim(mid(measurements,instr(measurements,\"-\")+1,instr(measurements,\")\")-instr(measurements,\"-\")-1))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5013001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a2057246e3830a74bd3112ce8c018c4?s=128&d=identicon&r=PG&f=1", "display_name": "fredark", "link": "https://stackoverflow.com/users/5013001/fredark"}, "edited": false, "score": 0, "creation_date": 1436981602, "post_id": 31437174, "comment_id": 50844180, "body": "Awesome answer! I think this will probably work for me, Thanks!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1436981422, "creation_date": 1436981422, "answer_id": 31437174, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437174#31437174", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>Consider:</p>\n\n<pre><code>Sub dural()\n    s = \"77.170 (+/- 0.025)\"\n    s2 = Replace(Replace(Replace(s, \" \", \"\"), \"+/-\", \"\"), \")\", \"\")\n    ary = Split(s2, \"(\")\n    MsgBox ary(0) &amp; vbCrLf &amp; ary(1)\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/JHUKj.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1436981429, "creation_date": 1436981429, "answer_id": 31437176, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437176#31437176", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>Try using a combination of <a href=\"http://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow\">InStr()</a>, <a href=\"http://www.techonthenet.com/excel/formulas/left.php\" rel=\"nofollow\">Left()</a>, Right(). </p>\n\n<p>Get the index/position of the '(' using InStr and then extract the characters using Left and Right. If you want to get the final data as a double or a Long use CDbl() or CLng() respectively. </p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "is_accepted": false, "score": 0, "last_activity_date": 1436982462, "creation_date": 1436982462, "answer_id": 31437525, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437525#31437525", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>For getting text out of other text consider using Regular Expresions.\nTo use them in VBA you will need in Reference 'VBScript_RegExp_55' library.</p>\n\n<p>The reason why you might want to do that is because following code returns whatever first two numbers show up in your text( it can be modified to be much smarter than that), regardless of other text around it.</p>\n\n<pre><code>Dim Regex As RegExp\nDim Matches As MatchCollection\n\nSet Regex = New RegExp\nRegex.Pattern = \"\\d*\\.\\d*\"\nRegex.Global = True\n\nSet Matches = Regex.Execute(\"77.170 (+/- 0.025)\")\n\nMsgBox (Matches(0).Value &amp; \" \" &amp; Matches(1).Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1436983855, "creation_date": 1436983855, "answer_id": 31437973, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba/31437973#31437973", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>Assuming s is your measurement string, here is the most direct way:</p>\n\n<pre><code>v = Split(Left(s, Len(s) - 1), \" (+/- \")\n</code></pre>\n\n<p>That's it. Now v(0) holds the nominal value and v(1) holds the tolerance.</p>\n"}], "owner": {"reputation": 13, "user_id": 5013001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a2057246e3830a74bd3112ce8c018c4?s=128&d=identicon&r=PG&f=1", "display_name": "fredark", "link": "https://stackoverflow.com/users/5013001/fredark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 31437174, "answer_count": 6, "score": -2, "last_activity_date": 1436983855, "creation_date": 1436980655, "question_id": 31436930, "link": "https://stackoverflow.com/questions/31436930/how-to-parse-this-specific-type-of-data-in-excel-vba", "title": "How to parse this specific type of data in excel VBA?", "body": "<p>I have a bunch of different sets of engineering measurements in the format:</p>\n\n<p>77.170 (+/- 0.025)</p>\n\n<p>And I need to split it into the first number, which is the nominal value, and the number in the parenthesis, the tolerance. Not sure exactly how to do this in excel VBA. I was thinking I would use the Split function with a space delimiter, giving me the first number, then the unnecessary characters, then the tolerance, but the tolerance will include a parenthesis. How could I get rid of just that parenthesis, and will what I just suggested even work? Thanks!</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1436980602, "post_id": 31436882, "comment_id": 50843600, "body": "How is the data formatted in the cells you are referencing in the x-axis?"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1436981035, "post_id": 31436882, "comment_id": 50843848, "body": "It is just a numeric value formated as a string"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1436982542, "post_id": 31436882, "comment_id": 50844741, "body": "excuse me formated as a date not a string"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436986286, "post_id": 31436882, "comment_id": 50846932, "body": "What type of chart are they?  You probably want Scatterplots if you want to format the X-axes like that."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1436986361, "post_id": 31436882, "comment_id": 50846979, "body": "Actulaly they are plain line graphs, with two series ploted on one axis"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436986472, "post_id": 31436882, "comment_id": 50847045, "body": "So try switching the type after pasting"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436982503, "creation_date": 1436980472, "last_edit_date": 1531164843, "question_id": 31436882, "link": "https://stackoverflow.com/questions/31436882/excel-failling-to-recognize-type-of-chart", "title": "Excel failling to recognize type of chart", "body": "<p>I have following code to copy all charts on one sheet into another.</p>\n\n<p>Problem is that in spite of the fact that my charts have numeric(timeseries) data for horizontal axis Excel treats it as categorical. I can tell that is does that because it tries to display every single date on the axis( in spite of my code swtiching it to once a month), and once select \"Format Axis\" I only see fields for Categorical data( I am missing fields like Maximim, Major Unit etc.).</p>\n\n<p>This is the code I am using, to be hones I copeid most of it of some forum but I cannot recall where if I do find it again I'll post a link: </p>\n\n<pre><code>Sub CopyCharts(Source As Worksheet, Target As Worksheet)\n    Dim SChart         As ChartObject\n    Dim NChart         As ChartObject\n    Dim NewSheetNChart As ChartObjects\n    Dim ChartTop       As Single\n    Dim ChartLeft      As Single\n    Dim ChartIndex     As Integer\n    Dim ChartSeries    As Series\n    Dim XAxis          As Axis\n\n    For Each SChart In Source.ChartObjects\n        'Save chart's current position\n        ChartTop = SChart.Top\n        ChartLeft = SChart.Left\n\n        'Copy and paste the chart\n        SChart.Copy\n        Target.Paste\n\n        'Find the chart in a new spreadsheet\n        ChartIndex = ChartIndex + 1\n        Set NewSheetNChart = Target.ChartObjects\n        Set NChart = NewSheetNChart(ChartIndex)\n\n        'Align the charts\n        NChart.Top = ChartTop\n        NChart.Left = ChartLeft\n\n        'Delink sereis from source\n        For Each ChartSeries In NChart.Chart.SeriesCollection\n            ChartSeries.XValues = ChartSeries.XValues\n            ChartSeries.Values = ChartSeries.Values\n            ChartSeries.Name = ChartSeries.Name\n        Next ChartSeries\n\n        'Set the X axis to correct values\n        Set XAxis = NChart.Chart.Axes(xlCategory, xlPrimary)\n        With XAxis\n            .CategoryType = xlTimeScale\n            .BaseUnit = xlMonths\n            .MajorUnit = 1\n        End With\n    Next SChart\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "enums", "com", "vb6"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1437001160, "post_id": 31436665, "comment_id": 50854323, "body": "Declare an enum in C# with values taken from <code>VariantType</code>?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1437004008, "post_id": 31436665, "comment_id": 50855290, "body": "<a href=\"https://msdn.microsoft.com/en-US/library/system.runtime.interopservices.varenum%28v=vs.80%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-US/library/&hellip;</a>"}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1437034989, "post_id": 31436665, "comment_id": 50865913, "body": "@GSerg Thanks but I&#39;d like to keep the same enum to be fully compatible with the old API. I&#39;ve chosen an int rather than an enum because it is more &quot;neutral&quot;."}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1437035166, "post_id": 31436665, "comment_id": 50866006, "body": "@HansPassant Thanks for the suggestion. This seems an interesting middle-ground between a neutral but opaque int and an expressive but new/unknown enum."}], "owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1437000783, "creation_date": 1436979864, "question_id": 31436665, "link": "https://stackoverflow.com/questions/31436665/use-the-vba-varianttype-enum-from-a-c-com-addin", "title": "Use the VBA VariantType enum from a C# COM addin", "body": "<p>I'm migrating a VB6 <strong>COM addin</strong> used from <strong>VBA</strong>.</p>\n\n<p>This addin exposes a method that returns instances of the <code>vbVarType</code> enum:</p>\n\n<pre><code>Function GetSomeType() As VbVarType\n    GetSomeType = vbVariant\nEnd Function\n</code></pre>\n\n<p>I'm trying to mimick it in C# and I've found the <code>VariantType</code> enum in assembly <code>Microsoft.VisualBasic</code> which seems to mirror <code>vbVarType</code>:</p>\n\n<pre><code>VariantType GetSomeType()\n{\n    return VariantType.Variant;\n}\n</code></pre>\n\n<p>Unfortunately the <code>VariantType</code> enum is not <strong>COM-visible</strong> so I can't use it in the signature of my new COM method.</p>\n\n<p>I've found a workaround by returning the value as a raw integer:</p>\n\n<pre><code>int GetSomeType()\n{\n    return (int)VariantType.Variant;\n}\n</code></pre>\n\n<p>This is working fine but my COM function signature is not as clear as the VB6 one.</p>\n\n<p>Is there a way to expose the <code>vbVarType</code> (and more generally any other VBA enum) from a C# COM addin?</p>\n"}, {"tags": ["excel", "vba", "abap"], "comments": [{"owner": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "edited": false, "score": 0, "creation_date": 1437169822, "post_id": 31436427, "comment_id": 50935268, "body": "Is there a reason <i>why</i> you want to interface to SAP using the GUI? Can you not go the route of using a BAPI or web service? Using the GUI is definitely not a recommended route, unless you absolutely have to... (for example, if you&#39;re simulating user interaction with the system)."}, {"owner": {"reputation": 326, "user_id": 4683578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-igBBwNkx8j0/AAAAAAAAAAI/AAAAAAAACEM/NMMG8lv-9g0/photo.jpg?sz=128", "display_name": "hosford42", "link": "https://stackoverflow.com/users/4683578/hosford42"}, "reply_to_user": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "edited": false, "score": 0, "creation_date": 1437504852, "post_id": 31436427, "comment_id": 51053443, "body": "I was told when I came on board that the group was waiting for back end access of some sort, and in the meantime had automated the process via the GUI. I <i>despise</i> automating GUIs, and would love to use another alternative, but the existing automated process is rather involved and is unfortunately already built around the GUI. If you have information on the BAPI or web service, neither of which I have heard of previously, I would greatly appreciate it, but I also need an answer to the original question if you have one."}, {"owner": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "edited": false, "score": 1, "creation_date": 1437550033, "post_id": 31436427, "comment_id": 51069880, "body": "The BAPI or web service to be used would depend on the data you&#39;re interface to the SAP system. In a SAP ECC system you can use transaction <code>BAPI</code> to find a list of BAPIs you can use. Services used to be nicely documented in the Enterprise Services Workplace but that seems to have been retired and I can&#39;t seem to find an adequate replacement. Regarding your original question, what are you using to automate the GUI? And which version of SAP GUI are you using?"}, {"owner": {"reputation": 326, "user_id": 4683578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-igBBwNkx8j0/AAAAAAAAAAI/AAAAAAAACEM/NMMG8lv-9g0/photo.jpg?sz=128", "display_name": "hosford42", "link": "https://stackoverflow.com/users/4683578/hosford42"}, "reply_to_user": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "edited": false, "score": 0, "creation_date": 1437596240, "post_id": 31436427, "comment_id": 51101151, "body": "Using Python + COM to automate the 7.4 GUI. I think I&#39;ve got the clipboard issue figured out. I will definitely check out the BAPI transaction. Thanks!"}], "owner": {"reputation": 326, "user_id": 4683578, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-igBBwNkx8j0/AAAAAAAAAAI/AAAAAAAACEM/NMMG8lv-9g0/photo.jpg?sz=128", "display_name": "hosford42", "link": "https://stackoverflow.com/users/4683578/hosford42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1608977915, "creation_date": 1436979096, "last_edit_date": 1608977915, "question_id": 31436427, "link": "https://stackoverflow.com/questions/31436427/what-clipboard-formats-does-sap-read", "title": "What clipboard formats does SAP read?", "body": "<p>We have an automated process that interfaces with the SAP GUI via Excel, copying table data from an Excel spreadsheet into the Windows clipboard and then pasting it out to an SAP \"multiselect\" modal window. I would like to bypass the use of Excel by directly sending data to the clipboard in the appropriate format, but it isn't clear what formats SAP can read, and my Google searches all just turn up information on how to press the clipboard-related buttons.</p>\n\n<p>I have already written code to access the GUI directly and write the values to the multiselect table, but this way is <em>much</em> slower than using the clipboard. Any information on how to speed this process up would be greatly appreciated, whether it pertains to the appropriate clipboard format or some other way to rapidly transfer the data.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 2868299, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31abd6c60306a9df9cddf151a74ea805?s=128&d=identicon&r=PG&f=1", "display_name": "DixieFlatline", "link": "https://stackoverflow.com/users/2868299/dixieflatline"}, "edited": false, "score": 1, "creation_date": 1436979869, "post_id": 31436414, "comment_id": 50843159, "body": "Gah! Of course I was looking at the wrong page. Thanks for the quick answer. +1"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 285, "user_id": 2868299, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31abd6c60306a9df9cddf151a74ea805?s=128&d=identicon&r=PG&f=1", "display_name": "DixieFlatline", "link": "https://stackoverflow.com/users/2868299/dixieflatline"}, "edited": false, "score": 2, "creation_date": 1436982126, "post_id": 31436414, "comment_id": 50844510, "body": "@DixieFlatline  Just an FYI,  You can also access the last row at anytime by  SourceSheet.UsedRange.Rows.Count  and the last column by SourceSheet.UsedRange.Columns.Count"}, {"owner": {"reputation": 285, "user_id": 2868299, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31abd6c60306a9df9cddf151a74ea805?s=128&d=identicon&r=PG&f=1", "display_name": "DixieFlatline", "link": "https://stackoverflow.com/users/2868299/dixieflatline"}, "edited": false, "score": 1, "creation_date": 1436990990, "post_id": 31436414, "comment_id": 50849539, "body": "Thanks for the tip! I compared that with the method I was using and I noticed that mine only counts rows with data, and yours also counts rows with formatting."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 285, "user_id": 2868299, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31abd6c60306a9df9cddf151a74ea805?s=128&d=identicon&r=PG&f=1", "display_name": "DixieFlatline", "link": "https://stackoverflow.com/users/2868299/dixieflatline"}, "edited": false, "score": 1, "creation_date": 1461619914, "post_id": 31436414, "comment_id": 61271873, "body": "@DixieFlatline <a href=\"http://stackoverflow.com/a/11169920/1188513\">Actually <code>UsedRange</code> isn&#39;t reliable at all for that</a>"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 29, "last_activity_date": 1560641505, "last_edit_date": 1560641505, "creation_date": 1436979065, "answer_id": 31436414, "question_id": 31436397, "link": "https://stackoverflow.com/questions/31436397/vba-integer-overflow-at-70-000/31436414#31436414", "title": "VBA Integer Overflow at 70,000", "body": "<p>The website you are looking at is for Visual Studio (.NET) .</p>\n\n<p>VBA Integer is 32,768. You need to use a long.</p>\n\n<p>A VBA Long variable holds whole numbers from -2,147,483,648 to 2,147,483,647 and uses 4 bytes (32 bits) of memory.</p>\n\n<pre><code>Dim lLastRow as Long\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 2868299, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31abd6c60306a9df9cddf151a74ea805?s=128&d=identicon&r=PG&f=1", "display_name": "DixieFlatline", "link": "https://stackoverflow.com/users/2868299/dixieflatline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7870, "favorite_count": 3, "accepted_answer_id": 31436414, "answer_count": 1, "score": 9, "last_activity_date": 1560641505, "creation_date": 1436979003, "question_id": 31436397, "link": "https://stackoverflow.com/questions/31436397/vba-integer-overflow-at-70-000", "title": "VBA Integer Overflow at 70,000", "body": "<p>I have a worksheet with 70,000 rows of data and a simple macro that counts the total number of rows:</p>\n\n<pre><code>Dim LastRow as Integer    \nLastRow = SourceSheet.Cells.Find(what:=\"*\", searchdirection:=xlPrevious, searchorder:=xlByRows).Row\nMsgBox (LastRow)\n</code></pre>\n\n<p>This returns an overflow error. Changing LastRow to Long returns the correct value of 70,000.</p>\n\n<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/06bkb8w2.aspx\">Microsoft's website</a>, a VBA integer should be able to hold values between -2,147,483,648 and 2,147,483,647. My output is well within this range, so why would it fail?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1436986428, "post_id": 31436314, "comment_id": 50847026, "body": "If I understand what you&#39;re asking about, <a href=\"http://stackoverflow.com/q/5282128/11683\">you can&#39;t</a>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5117046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYljK.jpg?s=128&g=1", "display_name": "Chris Iriarte", "link": "https://stackoverflow.com/users/5117046/chris-iriarte"}, "edited": false, "score": 0, "creation_date": 1436995845, "post_id": 31439140, "comment_id": 50852246, "body": "Hm, there must be something else wrong with the function call and/or argument pass.  Even with putting &quot;Optional&quot; on all the parameters with values (for ALL the arguments, not just Lat and Lon), I&#39;m still getting zeros as a function return.  I&#39;m sure the fact the function argument window appears with a direct function call but not with a call from the sub is a clue ..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436987761, "creation_date": 1436987761, "answer_id": 31439140, "question_id": 31436314, "link": "https://stackoverflow.com/questions/31436314/excel-vba-can-a-sub-call-a-udf-with-unassigned-arguments/31439140#31439140", "title": "Excel VBA: Can a sub call a UDF with unassigned arguments?", "body": "<p>You should be able to pass in optional values as parameters that default to a value that would never be used. If the values are those 'impossible' values then rewrite then with input boxes.</p>\n\n<pre><code>Sub GeoToTM()\n\n    'Declare variables\n    Dim s As String\n    Dim TM() As Variant\n    Dim Lat As Double\n    Dim Lon As Double\n    Dim TMProj As Integer\n    Dim Ellipsoid As Integer\n\n    'Call Excel function\n\n    'with Lat and Lon as values then\n    TM = GeoConv(TMProj, Ellipsoid, Lat, Lon)\n\n    'with Lat and Lon unassigned\n    TM = GeoConv(TMProj, Ellipsoid)\n\nEnd Sub\n\n'VBA function wrapper\nFunction GeoConv(TMProj As Integer, Ellipsoid As Integer, _\n            Optional Lat As Double = -1, Optional Lon As Double = -1) As Variant\n\n    Dim East As Double\n    Dim North As Double\n    Dim locTM(1 To 2) As Variant\n\n    If Lat &lt; 0 Then _\n        Lat = CDbl(InputBox(\"Latitude: \", \"Supply Latitude\", \"0.000\"))\n    If Lon &lt; 0 Then _\n        Lon = CDbl(InputBox(\"Latitude: \", \"Supply Longtitude\", \"0.000\"))\n\n    'Call C++ function\n    GeodeticToTM Lat, Lon, TMProj, Ellipsoid, East, North\n\n    locTM(1) = East: locTM(2) = North\n    GeoConv = locTM\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 5117046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYljK.jpg?s=128&g=1", "display_name": "Chris Iriarte", "link": "https://stackoverflow.com/users/5117046/chris-iriarte"}, "is_accepted": false, "score": 0, "last_activity_date": 1437515102, "creation_date": 1437515102, "answer_id": 31550165, "question_id": 31436314, "link": "https://stackoverflow.com/questions/31436314/excel-vba-can-a-sub-call-a-udf-with-unassigned-arguments/31550165#31550165", "title": "Excel VBA: Can a sub call a UDF with unassigned arguments?", "body": "<p>Well, here's how I got it to work:</p>\n\n<p>Rearranging the code, I ...</p>\n\n<ul>\n<li>declared the \"input\" variables in the main sub, </li>\n<li>selected the cell range, </li>\n<li>put the Excel formula in the range with Selection.FormulaArray, </li>\n<li>called the already populated function wizard with Application.Dialogs(xlDialogFunctionWizard).Show,</li>\n<li>then called the Excel function.</li>\n</ul>\n\n<p>So, the .Show allows the user to populate the arguments which then get passed to the Excel function/DLL function.</p>\n\n<pre><code>Sub GeoToTM()\n\n'Declare variables\nDim TM() As Double\nDim Lat As Double\nDim Lon As Double\nDim TMProj As Integer\nDim Ellipsoid As Integer\n\nDim resultRng As Range\nDim Arg As Boolean\n\n'Initialize Cells\nActiveCell.Offset(-1, 0).Value = \"Easting\"\nActiveCell.Offset(-1, 1).Value = \"Northing\"\n\n'Call Excel function\nSet resultRng = Range(ActiveCell, ActiveCell.Offset(0, 1))\nresultRng.Select\nSelection.FormulaArray = \"= GeoConv()\"\nArg = Application.Dialogs(xlDialogFunctionWizard).Show\nIf Arg = False Then Exit Sub\n\nTM = GeoConv(Lat, Lon, TMProj, Ellipsoid)\n\nEnd Sub\n</code></pre>\n\n<p>I actually had to remove \"Option\" from the arguments in the function so this would work, but it did!</p>\n\n<p>Chris</p>\n"}], "owner": {"reputation": 37, "user_id": 5117046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYljK.jpg?s=128&g=1", "display_name": "Chris Iriarte", "link": "https://stackoverflow.com/users/5117046/chris-iriarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1437515102, "creation_date": 1436978742, "last_edit_date": 1531164843, "question_id": 31436314, "link": "https://stackoverflow.com/questions/31436314/excel-vba-can-a-sub-call-a-udf-with-unassigned-arguments", "title": "Excel VBA: Can a sub call a UDF with unassigned arguments?", "body": "<p>I've written an Excel module to convert latitude/longitude to UTM coordinates.  The main procedure is a sub that defines the arguments and calls the function that in turn calls a DLL function.  The idea is the function opens the function argument window for the user to provide the data (function is defined in another sub with Application.MacroOptions).</p>\n\n<pre><code>Sub GeoToTM()\n\n'Declare variables\nDim TM() As Variant\nDim Lat As Double\nDim Lon As Double\nDim TMProj As Integer\nDim Ellipsoid As Integer\n\n'Call Excel function\n\nTM = GeoConv(Lat, Lon, TMProj, Ellipsoid)\n\nEnd Sub\n\n'VBA function wrapper\nFunction GeoConv(Lat, Lon, TMProj, Ellipsoid) As Variant\n\nDim East As Double\nDim North As Double\nDim locTM(1 To 2) As Variant\n\n'Call C++ function\nGeodeticToTM Lat, Lon, TMProj, Ellipsoid, East, North\n\nlocTM(1) = East: locTM(2) = North\nGeoConv = locTM\n\nEnd Function\n</code></pre>\n\n<p>The function on its own performs as advertised but when I run the entire module the function is accessed but the function argument window does not appear; the arguments are never populated so the function returns zeros.</p>\n\n<p>How do I get this to work?  Is \"Option\" arguments the trick here?</p>\n\n<p>Thanks,</p>\n\n<p>Chris</p>\n"}, {"tags": ["excel", "ms-access", "vba", "format-conversion"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1436979092, "post_id": 31436310, "comment_id": 50842706, "body": "Add  <code>xlApp.Visible = True</code> after <code>Set xlApp = New Excel.Application</code>.  When you run the code with that change, is there any information displayed in Excel which explains the problem?"}, {"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1436983740, "post_id": 31436310, "comment_id": 50845502, "body": "Thanks HansUp. After doing that, I can see that it opens the 1st excel file, saves it as text, then closes the excel file. Next, it opens the 2nd second file, formats it as text but tries to save it with the same name as the 1st text file. (&quot;A file already exists ... Do you want to replace it?&quot;). Any suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1436986574, "post_id": 31438172, "comment_id": 50847093, "body": "Fantastic - thanks! That sorted it. One last thing though - im still being prompted to &#39;save&#39; each file. Ive been playing around with Do.CmdSetWarnings False. Does it matter where in the code I insert that?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1436986652, "post_id": 31438172, "comment_id": 50847128, "body": "Where do you get that prompt?  At <code>ActiveWorkbook.Close</code>?  If so, use <code>ActiveWorkbook.Close savechanges:=False</code>  I would never recommend anyone use <code>Do.CmdSetWarnings False</code>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1436984931, "last_edit_date": 1436984931, "creation_date": 1436984554, "answer_id": 31438172, "question_id": 31436310, "link": "https://stackoverflow.com/questions/31436310/converting-excel-files-to-text-using-access-vba/31438172#31438172", "title": "Converting Excel files to Text using Access VBA", "body": "<p>By adding <code>xlApp.Visible = True</code> after <code>Set xlApp = New Excel.Application</code> you discovered Excel is waiting for you to tell it whether to overwrite an existing file which has the same name as the one you're trying to save.</p>\n\n<p>That happens because you assign a value to <em>myfile</em> just once ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>myfile = Dir(strPath &amp; \"\\*.xls\")\n</code></pre>\n\n<p>... but then re-use that same name as the basis for generating the name of each <em>.txt</em> file you attempt to save ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>FileName:=strPath &amp; \"\\\" &amp; Replace(myfile, \".xls\", \".txt\")\n</code></pre>\n\n<p>I think you can just substitute <em>objFile.Name</em> there because it should match the name of the current workbook file ... which means your <em>.txt</em> file name will be different each time through the <code>For Each</code> loop.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>FileName:=strPath &amp; \"\\\" &amp; Replace(objFile.Name, \".xls\", \".txt\")\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1956, "favorite_count": 0, "accepted_answer_id": 31438172, "answer_count": 1, "score": 1, "last_activity_date": 1437054066, "creation_date": 1436978724, "last_edit_date": 1495542106, "question_id": 31436310, "link": "https://stackoverflow.com/questions/31436310/converting-excel-files-to-text-using-access-vba", "title": "Converting Excel files to Text using Access VBA", "body": "<p>I am trying to save every .xls file in a folder location as text using Access VBA. I have patched together the code below. However, it only successfully saves the 1st excel file as text and then it seems to hang. </p>\n\n<p>I have reviewed this post which I think achieves something similar to what I want: <a href=\"https://stackoverflow.com/questions/17141885/batch-convert-excel-to-text-delimited-files\">HERE</a> .But I have been at this for so long that nothing is making sense!! Any ideas? Is it getting stuck on <code>ActiveWorkbook.Close</code>?</p>\n\n<pre><code> Public Sub FormatAsText()\nDim myfile As String\nDim xlApp As Excel.Application\nDim xlWB1 As Excel.Workbook\n\nDim objFso As FileSystemObject\nDim strPath As String\nDim objFolder As Folder\nDim objFile As File\n\n        Set xlApp = New Excel.Application\n        strPath = \"C:FolderLocation...\"\n\n        Set objFso = CreateObject(\"Scripting.FileSystemObject\")\n        Set objFolder = objFso.GetFolder(strPath)\n\n        myfile = Dir(strPath &amp; \"\\*.xls\")\n\n            For Each objFile In objFolder.Files\n                If objFile.Name Like \"*.xls\" Then\n                    Workbooks.Open objFile, ReadOnly:=False\n                    ActiveWorkbook.SaveAs FileName:=strPath &amp; \"\\\" &amp; Replace(myfile, \".xls\", \".txt\"), FileFormat:=xlTextWindows\n                    ActiveWorkbook.Close\n                End If\n            Next objFile\n\n        Debug.Print myfile\n\nSet xlApp = Nothing\nSet xlWB1 = Nothing\n\nSet objFso = Nothing\n\nSet objFolder = Nothing\nSet objFile = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436978710, "post_id": 31436249, "comment_id": 50842446, "body": "Might want to put that <code>Application.EnableEvents = False</code> below the <code>If Target.Row = 1 Then Exit Sub</code> or it will get turned off and immediately exited (thereby remaining off)."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436979018, "post_id": 31436249, "comment_id": 50842644, "body": "@Jeeped - Good catch."}, {"owner": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "edited": false, "score": 0, "creation_date": 1436979858, "post_id": 31436249, "comment_id": 50843153, "body": "Worked Perfect! I appreciate it! Ya, good catch btw. Surprised I didnt see that"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 5, "last_activity_date": 1436978762, "last_edit_date": 1436978762, "creation_date": 1436978564, "answer_id": 31436249, "question_id": 31436190, "link": "https://stackoverflow.com/questions/31436190/exclude-first-row-from-macro/31436249#31436249", "title": "Exclude first row from macro", "body": "<p>The ActiveCell can change to something else after you edit, so use the Target range rather than the ActiveCell. For example, if I hit {enter} to finish my edit, the ActiveCell is now on row 2 rather than 1.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \n    Application.EnableEvents = False\n\n    With Target\n        If .Row &gt; 1 Then \n            Cells(.Row, \"I\").Value = Now \n        End If\n    End With\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I'm using With syntax to show the same Row you are comparing is the one you are editing. You could still put these on separate lines if you wish.</p>\n\n<p>Also, user Jeeped makes a good point about the Application.EnableEvents = True line. It won't run if the row is 1, so they get turned off indefinitely. Better to test for > 1 and only run your update code on that condition.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "edited": false, "score": 1, "creation_date": 1436984937, "post_id": 31436615, "comment_id": 50846166, "body": "This code is great except that when you try to clear a bunch of cells at once, then a bunch of dates come up and they cant be deleted"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "edited": false, "score": 0, "creation_date": 1436985821, "post_id": 31436615, "comment_id": 50846664, "body": "That&#39;s a very valid point Hans. I&#39;ve seen situations where timestamping the deletion of a row is important but that should not completely exclude removing the timestamp altogether. I&#39;ve modified to suit. Values in the timestamp column (column I) can be removed from column I alone but not with other cells."}, {"owner": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "edited": false, "score": 0, "creation_date": 1436986429, "post_id": 31436615, "comment_id": 50847029, "body": "How come I didnt have you guys around when I took my first excel class in engineering..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1436985734, "last_edit_date": 1436985734, "creation_date": 1436979677, "answer_id": 31436615, "question_id": 31436190, "link": "https://stackoverflow.com/questions/31436190/exclude-first-row-from-macro/31436615#31436615", "title": "Exclude first row from macro", "body": "<p>If you turn off event handling, provide error control that makes sure that events will be re-enabled.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo Safe_Exit\n    Application.EnableEvents = False\n    Dim r As Long, rw As Long, rng As Range, newTarget As Range\n    For Each rng In Target\n        If rng.Column &lt;&gt; 9 Then\n            If newTarget Is Nothing Then\n                Set newTarget = rng\n            Else\n                Set newTarget = Union(newTarget, rng)\n            End If\n        End If\n    Next rng\n    For r = 1 To newTarget.Rows.Count\n        rw = newTarget.Rows(r).Row\n        If rw &gt; 1 Then _\n            Cells(rw, \"I\").Value = Now\n    Next r\n\nSafe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>If you are pasting or filling a large number of values then Target is all of the cells that changed. You need to guard against the top row while everything else receives the timestamp. When Target is more than a single cell, you only want to timestamp once per row.</p>\n\n<p>And you don't want to turn off event handling then exit without turning it back on again.</p>\n"}], "owner": {"reputation": 51, "user_id": 5094344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153101105550345/picture?type=large", "display_name": "Hans Maggio", "link": "https://stackoverflow.com/users/5094344/hans-maggio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "accepted_answer_id": 31436615, "answer_count": 2, "score": 4, "last_activity_date": 1437019987, "creation_date": 1436978328, "last_edit_date": 1437019987, "question_id": 31436190, "link": "https://stackoverflow.com/questions/31436190/exclude-first-row-from-macro", "title": "Exclude first row from macro", "body": "<p>I have a macro that puts the current time into a cell upon editing any row. my problem is that this macro also executes for row 1 which are the titles. So it ends up changing the title of a column to a time.  </p>\n\n<p>The macro works fine but still changes the title. I tried the following: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n\n    If ActiveCell.Row = 1 Then Exit Sub\n\n    Cells(Target.Row, \"I\").Value = Now\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1436978462, "post_id": 31436034, "comment_id": 50842303, "body": "Brilliant. Thank you very much Mr. Williams!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1436977819, "creation_date": 1436977819, "answer_id": 31436034, "question_id": 31435814, "link": "https://stackoverflow.com/questions/31435814/how-can-i-change-the-file-path-of-a-workbook-in-vba/31436034#31436034", "title": "How can I change the file path of a Workbook in VBA?", "body": "<pre><code>Const MY_PATH As String = \"C:\\Temp\\\"\nDim name As String\n\nWith Workbooks(\"Transfer Template\").Sheets(\"Sheet1\")\n    name = .Range(\"B1\").Value &amp; \"_\" &amp; .Range(\"B4\").Value\nEnd With    \n\nWorkbooks(\"Protected_Form.xls\").SaveAs Filename:= MY_PATH &amp; name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 1, "last_activity_date": 1436979073, "last_edit_date": 1436979073, "creation_date": 1436978653, "answer_id": 31436282, "question_id": 31435814, "link": "https://stackoverflow.com/questions/31435814/how-can-i-change-the-file-path-of-a-workbook-in-vba/31436282#31436282", "title": "How can I change the file path of a Workbook in VBA?", "body": "<p>Your problem is that the default folder isn't where you want to save this file. You can change this setting from the main menu, or in code:</p>\n\n<pre><code>Application.DefaultFilePath =  \"H:\\Projects\\\"\n</code></pre>\n\n<p><strong>However...</strong> Your system security settings or 'roaming profile' might not let you do this, and the command will fail silently. Worse, you might do this, and succeed on your own PC, and pass it onto a user who has a differently-configured workstation. </p>\n\n<p>It's best to specify the path explicitly:</p>\n\n<pre><code>Dim wbk As Excel.Workbook\nDim strName As String\nDim strPath As String\n\nSet wbk = Application.Workbooks(\"Protected_Form.xls\")\n\nWith Application.Workbooks(\"Transfer Template\").Sheets(\"Sheet1\")\n    strName = .Range(\"B1\").Value &amp; \"_\" &amp; .Range(\"B4\").Value\nEnd With\n\nstrPath = \"H:\\Projects\\\"\n\nwbk.SaveAs Filename:=strPath &amp; strName\n</code></pre>\n\n<p>Always check that you have the '\\' backslash on your folder path: it's a very common error.</p>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5999, "favorite_count": 0, "accepted_answer_id": 31436034, "answer_count": 2, "score": 0, "last_activity_date": 1436979073, "creation_date": 1436977141, "question_id": 31435814, "link": "https://stackoverflow.com/questions/31435814/how-can-i-change-the-file-path-of-a-workbook-in-vba", "title": "How can I change the file path of a Workbook in VBA?", "body": "<p>So I have a Workbook that is being saved. It is being saved under a name from two cells in a different workbook. As of right now, it saves automatically to the documents folder on my computer. I would like to change this to a folder of my choosing. I'm guessing this should be pretty straight-forward. Here's my code so far:</p>\n\n<pre><code>    Dim name As String\n\n    name = Workbooks(\"Transfer Template\").Sheets(\"Sheet1\").Range(\"B1\").Value &amp; \"_\" &amp; Workbooks(\"Transfer Template\").Sheets(\"Sheet1\").Range(\"B4\").Value\n    Windows(\"Protected_Form.xls\").Activate\n    ActiveWorkbook.SaveAs Filename:=name\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "utf-8", "vbscript", "vb6"], "answers": [{"comments": [{"owner": {"reputation": 10898, "user_id": 40691, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d181288c6d64fa3ab1ffe464e98afd34?s=128&d=identicon&r=PG", "display_name": "wqw", "link": "https://stackoverflow.com/users/40691/wqw"}, "edited": false, "score": 0, "creation_date": 1542968881, "post_id": 31436631, "comment_id": 93762661, "body": "<code>adSaveCreateNotExist</code> is an unused constant"}, {"owner": {"reputation": 626, "user_id": 1955444, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/97c7e8ae90905258fc06d0b56c9fabfb?s=128&d=identicon&r=PG", "display_name": "Antoni Gual Via", "link": "https://stackoverflow.com/users/1955444/antoni-gual-via"}, "edited": false, "score": 0, "creation_date": 1596193063, "post_id": 31436631, "comment_id": 111740603, "body": "Great!. The first SaveToFile is not relly needed, a .Flush would do the job. To test the code, save the it as UTF16-LE in Notepad or the test string will not be garbled by vbs when it reads the source.."}], "tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": true, "score": 23, "last_activity_date": 1508730811, "last_edit_date": 1508730811, "creation_date": 1436979741, "answer_id": 31436631, "question_id": 31435662, "link": "https://stackoverflow.com/questions/31435662/vba-save-a-file-with-utf-8-without-bom/31436631#31436631", "title": "VBA : save a file with UTF-8 without BOM", "body": "<p>In the best of all possible worlds the Related list would contain a reference to <a href=\"https://stackoverflow.com/questions/4143524/can-i-export-excel-data-with-utf-8-without-bom\">this question</a> which I found as the first hit for \"vbscript adodb.stream bom vbscript site:stackoverflow.com\".</p>\n\n<p>Based on the second strategy from <a href=\"https://stackoverflow.com/a/4180703/603855\">boost's answer</a>:</p>\n\n<pre><code>Option Explicit\n\nConst adSaveCreateNotExist = 1\nConst adSaveCreateOverWrite = 2\nConst adTypeBinary = 1\nConst adTypeText   = 2\n\nDim objStreamUTF8      : Set objStreamUTF8      = CreateObject(\"ADODB.Stream\")\nDim objStreamUTF8NoBOM : Set objStreamUTF8NoBOM = CreateObject(\"ADODB.Stream\")\n\nWith objStreamUTF8\n  .Charset = \"UTF-8\"\n  .Open\n  .WriteText \"a\u00c4\u00f6\"\n  .Position = 0\n  .SaveToFile \"toto.php\", adSaveCreateOverWrite\n  .Type     = adTypeText\n  .Position = 3\nEnd With\n\nWith objStreamUTF8NoBOM\n  .Type    = adTypeBinary\n  .Open\n  objStreamUTF8.CopyTo objStreamUTF8NoBOM\n  .SaveToFile \"toto-nobom.php\", adSaveCreateOverWrite\nEnd With\n\nobjStreamUTF8.Close\nobjStreamUTF8NoBOM.Close\n</code></pre>\n\n<p>Evidence:</p>\n\n<pre><code>chcp\nActive code page: 65001\n\ndir\n ...\n15.07.2015  18:48                 5 toto-nobom.php\n15.07.2015  18:48                 8 toto.php\n\ntype toto-nobom.php\na\u00c4\u00f6\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2485, "user_id": 3899560, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Dh4tr.png?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/3899560/julien"}, "edited": false, "score": 0, "creation_date": 1436987100, "post_id": 31436726, "comment_id": 50847397, "body": "thanks anyway for your answer Nile, it works finally with the solution of Ekkehard.Horner"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1566931117, "post_id": 31436726, "comment_id": 101807641, "body": "AFAIK this results in <i>UTF-16</i> encoding (supported in all current versions of Windows)."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1567000295, "post_id": 31436726, "comment_id": 101832127, "body": "@T.M - best check that: separately, in the VBA IDE&#39;s exported text, and in the text displayed on the worksheet itself."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1567008874, "post_id": 31436726, "comment_id": 101837163, "body": "@NigelHeffernan, thx for feedback to a possible version issue (?); actually the Notepad editor in my newly installed Office 2019 64bit shows <i>UTF-16LE</i> as current saving option for the exported text so I guess it <i>is</i> UTF-16 encoded."}], "tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 3, "last_activity_date": 1436980019, "creation_date": 1436980019, "answer_id": 31436726, "question_id": 31435662, "link": "https://stackoverflow.com/questions/31435662/vba-save-a-file-with-utf-8-without-bom/31436726#31436726", "title": "VBA : save a file with UTF-8 without BOM", "body": "<p>I knew that the Scripting File System Object's stream inserted a Byte Order Mark, but I haven't seen that with the ADODB Stream. </p>\n\n<p>Or at least, not yet: I rarely use the ADODB stream object... </p>\n\n<p>But I do remember putting this remark into some code a few years ago:</p>\n\n<pre><code>'   ****   WHY THIS IS COMMENTED OUT   **** **** **** **** **** **** **** ****\n'\n'   Microsoft ODBC and OLEDB database drivers cannot read the field names from\n'   the header when a unicode byte order mark (&amp;HFF &amp; &amp;HFE) is inserted at the\n'   start of the text by Scripting.FileSystemObject 'Write' methods. Trying to\n'   work around this by writing byte arrays will fail; FSO 'Write' detects the\n'   string encoding automatically, and won't let you hack around it by writing\n'   the header as UTF-8 (or 'Narrow' string) and appending the rest as unicode\n'\n'   (Yes, I tried some revolting hacks to get around it: don't *ever* do that)\n'\n'   **** **** **** **** **** **** **** **** **** **** **** **** **** **** ****\n'\n'    With FSO.OpenTextFile(FilePath, ForWriting, True, TristateTrue)\n'        .Write Join(arrTemp1, EOROW)\n'        .Close\n'    End With ' textstream object from objFSO.OpenTextFile\n'\n'   **** **** **** **** **** **** **** **** **** **** **** **** **** **** ****\n</code></pre>\n\n<p>You can tell I was having a bad day. </p>\n\n<p>Next, using prehistoric PUT commands from the days before file-handling had emerged from the primordial C:</p>\n\n<pre><code>'   **** WHY WE 'PUT' A BYTE ARRAY INSTEAD OF A VBA STRING VARIABLE  **** ****\n'\n'       Put #hndFile, , StrConv(Join(arrTemp1, EOROW), vbUnicode)\n'       Put #hndFile, , Join(arrTemp1, EOROW)\n'\n'   If you pass unicode, Wide or UTF-16 string variables to PUT, it prepends a\n'   Unicode Byte Order Mark to the data which, when written to your file, will\n'   render the field names illegible to Microsoft's JET ODBC and ACE-OLEDB SQL\n'   drivers (which can actually read unicode field names, if the helpful label\n'   isn't in the way). However, the 'PUT' statements writes a Byte array as-is\n'\n'   **** **** **** **** **** **** **** **** **** **** **** **** **** **** ****\n</code></pre>\n\n<p>So there's the code that actually does it:</p>\n\n<pre><code>Dim arrByte() As Byte\nDim strText   As String\nDim hndFile   As String\n\n\n    strText = \"Y'all knew that strings are actually byte arrays?\"\n    arrByte = strText \n\n    hndFile = FreeFile\n    Open FilePath For Binary As #hndFile\n\n    Put #hndFile, , arrByte\n    Close #hndFile\n\n    Erase arrByte\n</code></pre>\n\n<p>I'm assuming that strText is actually UTF-8. I mean, we're in VBA, in Microsoft Office, and we <strong>absolutely</strong> know that this is always going to be UTF-8, even we use it in a foreign country...</p>\n\n<p>...Right?</p>\n"}], "owner": {"reputation": 2485, "user_id": 3899560, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Dh4tr.png?s=128&g=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/3899560/julien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26065, "favorite_count": 9, "accepted_answer_id": 31436631, "answer_count": 2, "score": 12, "last_activity_date": 1508730811, "creation_date": 1436976619, "last_edit_date": 1436977124, "question_id": 31435662, "link": "https://stackoverflow.com/questions/31435662/vba-save-a-file-with-utf-8-without-bom", "title": "VBA : save a file with UTF-8 without BOM", "body": "<p>it's probably sthg simple, here is what I tried :</p>\n\n<pre><code> Set objStream = CreateObject(\"ADODB.Stream\")\n Set objStreamNoBOM = CreateObject(\"ADODB.Stream\")\n\n With objStream\n        .Open\n        .Charset = \"UTF-8\"\n        .WriteText \"aaaaaa\"\n        .Position = 0\n    End With\n\n    With objStreamNoBOM\n      '.Charset = \"Windows-1252\"   ' WORK\n       .Charset = \"UTF-8\"          ' DOESN'T WORK!!\n       .Open\n       .Type = 2\n       .WriteText objStream.ReadText\n       .SaveToFile \"toto.php\", 2\n       .Close\n    End With\n    objStream.Close\n</code></pre>\n\n<p>if the charset is UTF-8, then there is \u00ef\u00bb at the beginning of the file.</p>\n\n<p>Any idea on how to save a file with UTF-8 and without BOM?</p>\n"}, {"tags": ["excel", "vba", "grouping", "sumifs"], "comments": [{"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1436976341, "post_id": 31435234, "comment_id": 50841032, "body": "I would definitely use a pivot table for this. It is possible with VBA but, unless there is a compelling reason not to use a pivot, you&#39;re wasting your time. Do you need assistance creating a pivot table?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1437107248, "post_id": 31435234, "comment_id": 50902726, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1443331505, "creation_date": 1443331505, "answer_id": 32804897, "question_id": 31435234, "link": "https://stackoverflow.com/questions/31435234/how-can-i-sum-values-given-a-name-across-a-data-array/32804897#32804897", "title": "How can I sum values given a name across a data array?", "body": "<p>A PivotTable seems particularly suitable because it is very easy but also because if offers potential for a lot of additional analysis:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/r38Mq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r38Mq.jpg\" alt=\"SO31435234 example\"></a></p>\n\n<p>Here I have selected the whole of the two columns (hence <code>(blank)</code> in the PT) so additional entries may be continued below those already there - additions though will not be included in the PT until it is refreshed (three clicks).</p>\n\n<p>For example, if the two entries each for <code>Phones</code> and <code>Tablets</code> are because each sale is recorded individually (or by salesperson etc) then switching <code>Sum of</code> to <code>Count of</code> (or just adding the latter) would show the number of sales (ie some multiple), rather than the number of units sold.</p>\n\n<p>You mention \"weekly units\" - record the date of sale as an additional column and include it in the PT and the rows in the PT may be grouped by week - and/or month and/or year etc. It is also easy to display maximums and minimums - and there are very many more options, quick to set up and very quick to calculate. </p>\n\n<p>The order can be changed (eg <code>Phones</code> put first) but defaults to alphabetic ascending.</p>\n\n<p>However, I may be misinterpreting <em>another column in row 1</em>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4167750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b8def9713b5e5dd432e3c3c02a557c?s=128&d=identicon&r=PG&f=1", "display_name": "user4167750", "link": "https://stackoverflow.com/users/4167750/user4167750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443331505, "creation_date": 1436975495, "last_edit_date": 1442056704, "question_id": 31435234, "link": "https://stackoverflow.com/questions/31435234/how-can-i-sum-values-given-a-name-across-a-data-array", "title": "How can I sum values given a name across a data array?", "body": "<p>This would be fairly straightforward in SQL, but I'm stuck in Excel and am now not sure if I should use Pivots or a Macro in Excel. </p>\n\n<p>Situation: I have two columns. One has a list of names or category types (for example: \"Phones\", \"Tablets\", \"Computers\", \"Tablets\", \"Phones\"). The second column has corresponding data in it--weekly units sold (for example: 5, 7, 3, 6, 5).  </p>\n\n<p>Ask: I would like to have the same two columns, only a unique name listed once in column one with the sum of its units sold in column two (i.e. in the example, to have a single column that lists once \"Row 1: Phones and another column in row 1 that has total units \"10\", Row 2: Tablets and another column \"13\".</p>\n\n<p>Sorry, a bit of a convoluted explanation without images. Anyhow, I know this can be done with several sumifs, but I need to do this across 20 data arrays for over 1000 different categories. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1436975745, "post_id": 31435190, "comment_id": 50840639, "body": "Select the first sheet, Shift+click on the last sheet tab - delete the first column."}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 1, "creation_date": 1436976702, "post_id": 31435190, "comment_id": 50841287, "body": "I know you already have an answer, but what I normally do is just record a macro of what I want to do. Then modify it for what I need to do (i.e. looping over all worksheets). Some things seem confusing or daunting until you record the macro and realize it isn&#39;t actually that hard. It also helps you teach yourself a little more."}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1436991874, "post_id": 31435190, "comment_id": 50850055, "body": "@Constuntine Great thanks! I will try the recording method as well- might make the more complicated macros easier!"}], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436975767, "post_id": 31435318, "comment_id": 50840651, "body": "I think you want ws.Range(&quot;A:A&quot;)"}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "edited": false, "score": 0, "creation_date": 1436991794, "post_id": 31435318, "comment_id": 50850014, "body": "Awesome! Thanks - just what I needed!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 5, "last_activity_date": 1436975693, "creation_date": 1436975693, "answer_id": 31435318, "question_id": 31435190, "link": "https://stackoverflow.com/questions/31435190/how-to-delete-the-first-column-in-every-sheet-in-a-workbook-using-vba/31435318#31435318", "title": "How to delete the first column in every sheet in a workbook using VBA", "body": "<p>You need to loop over all the worksheets:</p>\n\n<pre><code>Sub qwerty()\n    Dim ws As Worksheet\n    For Each ws In Sheets\n        ws.Cells(1, 1).EntireColumn.Delete\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3805, "favorite_count": 1, "accepted_answer_id": 31435318, "answer_count": 1, "score": 0, "last_activity_date": 1436975701, "creation_date": 1436975395, "last_edit_date": 1531164843, "question_id": 31435190, "link": "https://stackoverflow.com/questions/31435190/how-to-delete-the-first-column-in-every-sheet-in-a-workbook-using-vba", "title": "How to delete the first column in every sheet in a workbook using VBA", "body": "<p>I have a workbook with 10+ sheets, and I need to delete the first column in every sheet.<br>\nInstead of manually doing this, I was wondering if anyone knew a short VBA macro that could do this for me?<br>\nThanks!</p>\n"}, {"tags": ["vba", "for-loop", "range", "each"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1436975365, "post_id": 31434979, "comment_id": 50840331, "body": "A perfect example of why putting <code>Option Explicit</code> at the top of each module is a good idea - in the VBE window select Tools ~ Options ~ Editor Tab ~ Tick &#39;Require Variable Declaration&#39;."}, {"owner": {"reputation": 118, "user_id": 5106689, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/44a3aa59c1376602b548bcc096662b60?s=128&d=identicon&r=PG&f=1", "display_name": "Sayjota", "link": "https://stackoverflow.com/users/5106689/sayjota"}, "edited": false, "score": 0, "creation_date": 1436975442, "post_id": 31434979, "comment_id": 50840385, "body": "Thanks I actually do use Option Explicit. In the &quot;IterRng&quot; was a typo I made when posting to StackOverflow. Any other ideas? I&#39;m convinced it&#39;s related to when I made a class module get property called &quot;Range&quot;. But I&#39;ve since removed that property and even deleted the entire class module even."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436975539, "post_id": 31434979, "comment_id": 50840472, "body": "I manually set itersrng to $B$2:$B$281 and it was printing the correct ranges here. Have you tried on a blank new sheet?"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 1, "last_activity_date": 1436974850, "creation_date": 1436974850, "answer_id": 31434979, "question_id": 31434903, "link": "https://stackoverflow.com/questions/31434903/vba-excel-for-each-range-fails/31434979#31434979", "title": "VBA Excel - for each range fails", "body": "<p>missed an \"s\" off the variable?</p>\n\n<pre><code>For Each r In IterRng\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>For Each r In ItersRng\n</code></pre>\n\n<p>Apart from the the code is working here</p>\n"}], "owner": {"reputation": 118, "user_id": 5106689, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/44a3aa59c1376602b548bcc096662b60?s=128&d=identicon&r=PG&f=1", "display_name": "Sayjota", "link": "https://stackoverflow.com/users/5106689/sayjota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436975468, "creation_date": 1436974641, "last_edit_date": 1436975468, "question_id": 31434903, "link": "https://stackoverflow.com/questions/31434903/vba-excel-for-each-range-fails", "title": "VBA Excel - for each range fails", "body": "<p>In the following code, for each range in range is failing. r is not returning a single cell but instead the entire parent range.</p>\n\n<p>I had previously created a class module with a get property called \"range\". That seemed to be the cause that broke the loop. However I have since removed that module and restarted excel / restarted the computer even. And the loop still fails. </p>\n\n<p>Any ideas?</p>\n\n<pre><code>Private Sub GetIters()\n\n    Dim FilterRng       As Range\n    Dim ItersRng        As Range\n    Dim r               As Range\n\n    Set FilterRng = pFieldRng.Resize(pCountRow + 1, COUNTCOL)\n    Set ItersRng = FilterRng.Columns(ITERPOS).Offset(1, 0).Resize(pCountRow, 1)\n\n    Debug.Print IterRng.Address 'returns $B$2:$B$281\n\n    For Each r In IterRng\n\n        Debug.Print r.Address 'returns $B$2:$B$281\n\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11171, "user_id": 4967110, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/hB02M.jpg?s=128&g=1", "display_name": "AZhao", "link": "https://stackoverflow.com/users/4967110/azhao"}, "is_accepted": true, "score": 2, "last_activity_date": 1436975660, "creation_date": 1436975660, "answer_id": 31435310, "question_id": 31434853, "link": "https://stackoverflow.com/questions/31434853/compare-two-folders-of-files-in-excel-vba/31435310#31435310", "title": "Compare two folders of files in Excel VBA", "body": "<p>Use dir to pull a list of the contents of each folder.  Concatenate those two lists into one big list, called 'BigList' </p>\n\n<p>Sort the list using something like this: <a href=\"http://www.thespreadsheetguru.com/the-code-vault/2015/3/24/applying-an-alphabetical-sort-to-your-vba-array-list\" rel=\"nofollow\">http://www.thespreadsheetguru.com/the-code-vault/2015/3/24/applying-an-alphabetical-sort-to-your-vba-array-list</a></p>\n\n<p>Then, iterate through the sorted list.  With each iteration of the for loop, save the current value for comparison to the next value.  If the values are the same, then save the value to a new list, say 'duplicate values'.  Then keep going until you are through 'big list' and you should have the list you want in 'duplicate values'</p>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 0, "accepted_answer_id": 31435310, "answer_count": 1, "score": 0, "last_activity_date": 1506077960, "creation_date": 1436974530, "last_edit_date": 1531161705, "question_id": 31434853, "link": "https://stackoverflow.com/questions/31434853/compare-two-folders-of-files-in-excel-vba", "title": "Compare two folders of files in Excel VBA", "body": "<p>I need to read all the files in one folder, and then look for that file in a second folder so they can be compared in Excel (looking for changes in key locations). So for instance if we had these files:</p>\n\n<pre><code>folder one\n   test1\n   test2\n   test3\n\nfolder two\n   test1\n   test2\n   test4\n</code></pre>\n\n<p>...then the code would return test1 and test2, as the other two are unique.</p>\n\n<p>Normally I use Dir for working with lists of files, but that only works on one folder at a time. I suspect there's an easy solution for this, but I've always used Dir and none of MS's examples I can find avoid this.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4670348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f6a080ed7a7446c675eb231c33b3234?s=128&d=identicon&r=PG&f=1", "display_name": "Ren&#233;", "link": "https://stackoverflow.com/users/4670348/ren%c3%a9"}, "edited": false, "score": 0, "creation_date": 1436981012, "post_id": 31434867, "comment_id": 50843838, "body": "I tried to implement the loop but when I set the following code up I get to about 1000 rows between the rows with the values. What does I need to change to make it correct. I think that I used the wrong lines of the code. Could you implement it for one sheet? Thanks"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 79, "user_id": 4670348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f6a080ed7a7446c675eb231c33b3234?s=128&d=identicon&r=PG&f=1", "display_name": "Ren&#233;", "link": "https://stackoverflow.com/users/4670348/ren%c3%a9"}, "edited": false, "score": 0, "creation_date": 1436981194, "post_id": 31434867, "comment_id": 50843932, "body": "Which loop? Post your current code with your question above.  We can work on what you have now."}, {"owner": {"reputation": 79, "user_id": 4670348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f6a080ed7a7446c675eb231c33b3234?s=128&d=identicon&r=PG&f=1", "display_name": "Ren&#233;", "link": "https://stackoverflow.com/users/4670348/ren%c3%a9"}, "edited": false, "score": 0, "creation_date": 1437033520, "post_id": 31434867, "comment_id": 50865069, "body": "I added the new, not working code. If you would be so kind and have a look at it and give ma a hint, where my mistake is."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1437051883, "last_edit_date": 1437051883, "creation_date": 1436974558, "answer_id": 31434867, "question_id": 31434719, "link": "https://stackoverflow.com/questions/31434719/vba-looping-excel-sheets/31434867#31434867", "title": "VBA looping excel sheets", "body": "<p>Here is a sub that will loop sheets and make one active by name.</p>\n\n<pre><code>Dim ws As Excel.Worksheet\nPrivate Sub loopsheets(strSheetName As String)\n    iFoundWorksheet = 0\n    For iIndex = 1 To ActiveWorkbook.Worksheets.count\n        Set ws = Worksheets(iIndex)\n        If UCase(ws.Name) = UCase(strSheetName) Then\n            iFoundWorksheet = iIndex\n            Exit For\n        End If\n    Next iIndex\n    If iFoundWorksheet = 0 Then\n        MsgBox \"No worksheet was found with the name RESULTS (this is not case sensetive). Aborting.\"\n    End If\n    Set ws = ea.Worksheets(iFoundWorksheet)\n    ws.Activate\n\nEnd Sub\n</code></pre>\n\n<p>Or just loop through the sheets and do something.</p>\n\n<pre><code>For iIndex = 1 To ActiveWorkbook.Worksheets.count\n\n    Set ws = Worksheets(iIndex)\n    'Do something here.\n\n    'Or call you sub\n    Year_to_Month\n\nNext iIndex\n</code></pre>\n\n<p>And usedRange is a better way to loop through the contents of a sheet as opposed ot using Range(\"A400\") and Range(\"A4:A400\").</p>\n\n<pre><code> 'Loop through the columns.\n Dim lRow as long\n For lRow = 1 To ws.UsedRange.Rows.count\n     'Do something here.\n Next lRow\n</code></pre>\n\n<p>To check if something is filled you would do something like this.</p>\n\n<pre><code>If  ws.cells(RowIndex, ColIndex).Interior.ColorIndex &gt; 0 then\n     'We have a filled cell\nEnd if\n</code></pre>\n\n<p>You can address sheets by name or index</p>\n\n<pre><code>Set ws = Worksheets(3)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 4873023, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e9c1585e7555cbab6f857c2ea04806fe?s=128&d=identicon&r=PG&f=1", "display_name": "san-san", "link": "https://stackoverflow.com/users/4873023/san-san"}, "is_accepted": false, "score": 1, "last_activity_date": 1437039373, "creation_date": 1437039373, "answer_id": 31450553, "question_id": 31434719, "link": "https://stackoverflow.com/questions/31434719/vba-looping-excel-sheets/31450553#31450553", "title": "VBA looping excel sheets", "body": "<p>You could record a macro then just repeat the flow. press f8 to run it line by line.. You could understand it better if you'll do that.</p>\n"}], "owner": {"reputation": 79, "user_id": 4670348, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f6a080ed7a7446c675eb231c33b3234?s=128&d=identicon&r=PG&f=1", "display_name": "Ren&#233;", "link": "https://stackoverflow.com/users/4670348/ren%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 31434867, "answer_count": 2, "score": 1, "last_activity_date": 1437051883, "creation_date": 1436974163, "last_edit_date": 1531164843, "question_id": 31434719, "link": "https://stackoverflow.com/questions/31434719/vba-looping-excel-sheets", "title": "VBA looping excel sheets", "body": "<p>I am actually a vba beginner and created my first code, but I need do it more flexible ...\nI would like to select more excel sheets, when I use the makro. Actually I use only the sheet called \"sector_share_se\", but how could I run the same makro for selected sheets e.g. \"sheet_1\", \"sheet_5\" and other? Furthermore is there a way to count the filled rows in a cloumn? Then I could create a flexible range instead of Range(\"A400\") and Range(\"A4:A400\").  </p>\n\n<p>What did i do here?</p>\n\n<p>I want to set the yearly data on a monthly scala. I create 11 empty rows between the filled rows and copy the monthly scale from the sheet called \"MSCI\". The last step is to fill the empty cells with NA's (in a way 11 NA's for each row with a value) </p>\n\n<pre><code>   Sub Year_to_Month()\n    ' emtpy space in selected sheet\n    Sheets(\"sector_share_se\").Select\n    Dim i As Long\n    i = sector_share_se\n        For i = Range(\"A400\").End(xlUp).Row To 5 Step -1\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n            Cells(i, 1).EntireRow.Insert\n        Next i\n\n    ' Create time frequency\n           Sheets(\"MSCI\").Range(\"A4:A400\").Copy\n           Sheets(\"sector_share_se\").Range(\"A4:A400\").PasteSpecial\n\n    ' replace empty with NA\n        Range(\"A4:AI310\").Select\n        Selection.Replace What:=\"\", Replacement:=\"NA\", LookAt:=xlPart, _\n            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n            ReplaceFormat:=False\n    End Sub\n</code></pre>\n\n<p>Thanks in advance \nRen\u00e9</p>\n\n<p>Edit with Information of @MatthewD:</p>\n\n<pre><code>' I understand iIndex as number of the excel sheet and it is possible to \n' adress the correct sheet with it but how can I use here more sheets that I\n' can enter only the Number (or Name) of the sheet e.g. iIndex = 1,2,3,7,9,15 \n\n\nDim lRow As long\nDim iIndex As long\nFor iIndex = 1 To ActiveWorkbook.Worksheets.count\n    Set ws = Worksheets(iIndex)\n    For ws = Range(\"A400\").End(xlUp).Row To 5 Step -1\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n        Cells(i, 1).EntireRow.Insert\n    Next i\n\n' I hope that I set the maximum lenght with \"ws.UsedRange.Rows.count\" \n' and copy it row by row\n   For lRow = 1 To ws.UsedRange.Rows.count\n     Sheets(\"MSCI\").Range(\"1:lRow\").Copy\n     Sheets(\"banking_sector\").Range(\"1:lRow\").PasteSpecial\n   Next lRow\n\n' I think that this is quiet okay (I recorded it only), it should \n' select the hole data and replace the NA's\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Replace What:=\"\", Replacement:=\"NA\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 3, "last_activity_date": 1436974622, "creation_date": 1436974622, "answer_id": 31434896, "question_id": 31434629, "link": "https://stackoverflow.com/questions/31434629/vba-return-meridiem-am-pm-from-current-date/31434896#31434896", "title": "VBA return Meridiem (AM/PM) from current Date", "body": "<p>try using below</p>\n\n<pre><code>Format(Now, \"am/pm\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 229, "user_id": 3203789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b544378febffab0307c19e5dedb78620?s=128&d=identicon&r=PG&f=1", "display_name": "Cessna", "link": "https://stackoverflow.com/users/3203789/cessna"}, "is_accepted": false, "score": 1, "last_activity_date": 1437154346, "last_edit_date": 1437154346, "creation_date": 1436976533, "answer_id": 31435636, "question_id": 31434629, "link": "https://stackoverflow.com/questions/31434629/vba-return-meridiem-am-pm-from-current-date/31435636#31435636", "title": "VBA return Meridiem (AM/PM) from current Date", "body": "<pre><code>Format(TimeValue(Now), \"hh:mm AM/PM\").\n</code></pre>\n\n<p>Change AM/PM to am/pm - A/P to a/p. for  lowercase-uppercase display.</p>\n"}], "owner": {"reputation": 332, "user_id": 5073888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KH4J1.png?s=128&g=1", "display_name": "Stephen Collins", "link": "https://stackoverflow.com/users/5073888/stephen-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1284, "favorite_count": 0, "accepted_answer_id": 31434896, "answer_count": 2, "score": 1, "last_activity_date": 1437154346, "creation_date": 1436973987, "question_id": 31434629, "link": "https://stackoverflow.com/questions/31434629/vba-return-meridiem-am-pm-from-current-date", "title": "VBA return Meridiem (AM/PM) from current Date", "body": "<p><code>Year(Now)</code> returns the current Year</p>\n\n<p><code>Month(Now)</code> returns the current Month</p>\n\n<p><code>Day(Now)</code> returns the current Day</p>\n\n<p><code>Hour(Now)</code> returns the current Hour</p>\n\n<p><code>Minute(Now)</code> returns the current Minute</p>\n\n<p><strong>How do you return AM/PM?</strong></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1436976728, "post_id": 31434610, "comment_id": 50841303, "body": "Use .Find and .FindNext to loop through all search results..."}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1436977185, "post_id": 31434610, "comment_id": 50841569, "body": "=IF(&quot;&quot;&amp;E1&amp;&quot;&quot;=&#39;SHEET1&#39;!E2:E100,ROW(&#39;SHEET1&#39;!E2:E100)).  If you highlight the formula and press F9 you can see all of the occurrences that get returned. This is the first step. The next step depends on what you where you want to go from here. Also note, when doing this formula in particular, do not reference the whole column."}], "answers": [{"comments": [{"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1436977885, "post_id": 31435949, "comment_id": 50841974, "body": "Referencing the whole column E with this type of formula will really pay a toll on your computer as you noted. The range should be made to reference the current data, such as &quot;E2:E1000&quot;."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1436978088, "last_edit_date": 1436978088, "creation_date": 1436977530, "answer_id": 31435949, "question_id": 31434610, "link": "https://stackoverflow.com/questions/31434610/returning-multiple-results-with-match-function/31435949#31435949", "title": "Returning Multiple Results with Match Function", "body": "<p>Say <em>Sheet1</em> is like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/mUaY6.png\" alt=\"enter image description here\"></p>\n\n<p>and in the other sheet, there is a <strong><em>12</em></strong> in cell <strong>E1</strong></p>\n\n<p>then pick a cell and enter the <em>Array Formula</em>:</p>\n\n<pre><code>=IFERROR(SMALL(IF(Sheet1!E:E=$E$1,ROW(Sheet1!E:E)-MIN(ROW(Sheet1!E:E))+1,\"\"),ROW(A1)),\"\")\n</code></pre>\n\n<p>and copy down to display:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JNqvE.png\" alt=\"enter image description here\"></p>\n\n<p><em>Array formulas</em> must be entered with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> rather than just the <kbd>Enter</kbd> key.</p>\n\n<p>NOTE:  This kind of <em>array formula</em> can be <strong>painfully slow!</strong>  Personally, I would replace all the <strong>E:E</strong> with <strong>$E$1:$E$999999</strong> to improve the speed.</p>\n"}], "owner": {"reputation": 21, "user_id": 5061589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153442029721410/picture?type=large", "display_name": "DragoSalaamii", "link": "https://stackoverflow.com/users/5061589/dragosalaamii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 31435949, "answer_count": 1, "score": 0, "last_activity_date": 1436978088, "creation_date": 1436973934, "last_edit_date": 1531161705, "question_id": 31434610, "link": "https://stackoverflow.com/questions/31434610/returning-multiple-results-with-match-function", "title": "Returning Multiple Results with Match Function", "body": "<p>I am looking for matches of information in Column E of one worksheet to Column E of a second worksheet.</p>\n\n<p>I've used:\n    =MATCH(\"<em>\"&amp;E1&amp;\"</em>\",'SHEET1'!E:E,0)</p>\n\n<p>and this returns me which row the match is in.</p>\n\n<p>However I have multiple hits on my search, but it is only returning me the row of the first hit.</p>\n\n<p>Is there a way to get a list of all hits, not just the first occurrence?\nThank you!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437107261, "post_id": 31434486, "comment_id": 50902729, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436975918, "creation_date": 1436975918, "answer_id": 31435409, "question_id": 31434486, "link": "https://stackoverflow.com/questions/31434486/vba-to-send-an-autoreply-message-to-only-domains-outside-organization/31435409#31435409", "title": "VBA To send an autoreply message to only domains outside organization", "body": "<p>You just have to make a test before adding recepients, so change <code>Recipients.Add Item.SenderEmailAddress</code> to :</p>\n\n<pre><code>If InStr(1, Item.SenderEmailAddress, \"domain.com\") &gt; 0 Then\n    'User from \"@domain.com\"\n    'Do not respond\nElse\n    'Not a user from \"@domain.com\"\n    .Recipients.Add Item.SenderEmailAddress\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437107256, "creation_date": 1436973636, "last_edit_date": 1437107256, "question_id": 31434486, "link": "https://stackoverflow.com/questions/31434486/vba-to-send-an-autoreply-message-to-only-domains-outside-organization", "title": "VBA To send an autoreply message to only domains outside organization", "body": "<p>I want to be able to select a bunch of emails and run the macro, and leave out a particular domain. How can I modify my code to NOT send the auto reply to people from a particular domain like \"@domain.com\"? Thanks</p>\n\n<pre><code>Option Explicit\n\nSub ReplywithTemplate2()\nDim Item As Outlook.MailItem\nDim oRespond As Outlook.MailItem\nDim OutPut As Integer\n\nFor Each Item In ActiveExplorer.Selection\n\n' This sends a response back using a template\nSet oRespond = Application.CreateItemFromTemplate(\"C:\\Users\\Accounting\\AppData\\Roaming\\Microsoft\\Templates\\scautoreply.oft\")\n\nOn Error Resume Next\n    With oRespond\n        .SentOnBehalfOfName = \"Subpayables Invoices\"\n        .Recipients.Add Item.SenderEmailAddress\n        .Subject = Item.Subject 'use Item.Subject to keep the original subject\n\n        ' use .display for testing, change to .send once you have it working as desired\n        .Display\n    End With\n\nNext\n\nOutPut = MsgBox(\"Successfully Completed the Task.\", vbInformation, \"Auto Reply From Template\")\n\nSet oRespond = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1436979038, "post_id": 31435690, "comment_id": 50842665, "body": "Don, thank you very much for your time. And I will surely follow the way you suggested to do so. But if I run the above code I am getting Number:4601 error. Cannot activate application"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1436979283, "post_id": 31435690, "comment_id": 50842830, "body": "I am getting error at this line strDocName = Dir(FOLDER_PATH &amp; &quot;<i>V1.2.doc</i>&quot;)"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437021077, "post_id": 31435690, "comment_id": 50859565, "body": "Thats great Don, even now I am getting the data to excel. But can I limit to only first table? Because, I am getting all 4 tables data to excel."}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437021469, "post_id": 31435690, "comment_id": 50859670, "body": "Whooohoooo...!!!! Thank you Don. I made it. I changed nCount =1 from nCount = .Tables.Count &amp; now my first table data sits in an excel. Thank you sooooo much for your help Don. Don, I am shouting on mountain. Thanks again."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437031359, "post_id": 31435690, "comment_id": 50863835, "body": "I broke out the code into two parts -- one calls the other with a parameter. Use this and the information found in this link to work through the problem. <a href=\"http://stackoverflow.com/questions/31414106/get-list-of-excel-files-in-a-folder-using-vba/31414262#31414262\" title=\"get list of excel files in a folder using vba\">stackoverflow.com/questions/31414106/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 0, "last_activity_date": 1437031277, "last_edit_date": 1437031277, "creation_date": 1436976704, "answer_id": 31435690, "question_id": 31434484, "link": "https://stackoverflow.com/questions/31434484/copy-first-table-from-word-document-to-an-excel-using-excel-macro-vba/31435690#31435690", "title": "Copy first table from word document to an excel using excel macro VBA", "body": "<p>There are a number of problems with the code you are not seeing because the error handling isn't working very well for you. I have corrected them below. The On Error Resume Next is not very revealing because when an error occurs, the code just keeps running forward. You want to correct those as you go by catching most of them while you are writing the routine. </p>\n\n<p>Before I made edits, I did a few things which you should get in a habit of doing:</p>\n\n<ol>\n<li><strong>Added Option Explict</strong>  (this will make it harder to introduce bugs in your code because it requires explicit syntax. This is a great discipline and I can't encourage it enough)</li>\n<li><strong>Compiled</strong>. (Do this regularly as you write your code. It will help you solve issues along the way)</li>\n<li><strong>Declared the variable i</strong>. This was flagged when I compiled with Option Explicit (wasn't creating an issue in your code, but bugs are easy to introduce if you don't use explicit variables)</li>\n</ol>\n\n<p>Then I changed to to use specific object references</p>\n\n<ol>\n<li><strong>Set a reference to the Word library</strong> (this makes debugging way easier because you will have intellisense in the editor and can explore the Word library using [F2])</li>\n<li><strong>Updated generic object references</strong> to Word.Application and Word.Document</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/V81UI.png\" alt=\"Setting a Reference to Word library\"> </p>\n\n<p><strong>Then I fixed the Errors.</strong> </p>\n\n<p>First I changed Error Handling to use On Error GoTo, and then I worked through each error that happened as I worked through the code.</p>\n\n<ol>\n<li>wdApp.Activate caused an Error  </li>\n<li>wdDoc never actually gets created, so it is Nothing</li>\n</ol>\n\n<p>After I corrected these, I added a line to get the document with \"V1.2.doc\" in the name.</p>\n\n<p>Finally, I removed the loop so only the first Table was copied as the question requested.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ImportTableDataWord()\n    Const FOLDER_PATH As String = \"C:\\Test\\\"\n\n    Dim sFile As String\n\n    'use the * wildcard to select the first file ending with \"V1.2.doc\" \n    sFile = Dir(FOLDER_PATH &amp; \"*V1.2.doc\")\n\n    If sFile = \"\" Then\n        MsgBox \"The file is not present or was not found\"\n        Exit Sub\n    End If\n\n    ImportTableDataWordDoc FOLDER_PATH &amp; sFile\n\nEnd Sub\n\nPublic Sub ImportTableDataWordDoc(ByVal strDocName As String)\n\n    Dim WdApp As Word.Application\n    Dim wddoc As Word.Document\n    Dim nCount As Integer\n    Dim rowWd As Long\n    Dim colWd As Long\n    Dim x As Long\n    Dim y As Long\n    Dim i As Long\n\n    On Error GoTo EH\n\n    If strDocName = \"\" Then\n        MsgBox \"The file is not present or was not found\"\n        GoTo FINISH\n    End If\n\n    Set WdApp = New Word.Application\n    WdApp.Visible = False\n\n    Set wddoc = WdApp.Documents.Open(strDocName)\n\n    If wddoc Is Nothing Then\n        MsgBox \"No document object\"\n        GoTo FINISH\n    End If\n\n    x = 1\n    y = 1\n\n    With wddoc\n\n        If .Tables.Count = 0 Then\n            MsgBox \"No Tables Found in the document\"\n            GoTo FINISH\n        Else\n\n            With .Tables(1)\n                For rowWd = 1 To .Rows.Count\n                    For colWd = 1 To .Columns.Count\n                        Cells(x, y) = WorksheetFunction.Clean(.Cell(rowWd, colWd).Range.Text)\n                        y = y + 1\n                    Next 'colWd\n                    y = 1\n                    x = x + 1\n                Next 'rowWd\n            End With\n\n        End If\n\n    End With\n\n    GoTo FINISH\n\nEH:\n\n    With Err\n        MsgBox \"Number\" &amp; vbTab &amp; .Number &amp; vbCrLf _\n            &amp; \"Source\" &amp; vbTab &amp; .Source &amp; vbCrLf _\n            &amp; .Description\n    End With\n\n    'for debugging purposes\n    Debug.Assert 0\n    GoTo FINISH\n    Resume\n\nFINISH:\n\n    On Error Resume Next\n    'release resources\n\n    If Not wddoc Is Nothing Then\n        wddoc.Close savechanges:=False\n        Set wddoc = Nothing\n    End If\n\n    If Not WdApp Is Nothing Then\n        WdApp.Quit savechanges:=False\n        Set WdApp = Nothing\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 0, "accepted_answer_id": 31435690, "answer_count": 1, "score": 1, "last_activity_date": 1531211667, "creation_date": 1436973632, "last_edit_date": 1531164843, "question_id": 31434484, "link": "https://stackoverflow.com/questions/31434484/copy-first-table-from-word-document-to-an-excel-using-excel-macro-vba", "title": "Copy first table from word document to an excel using excel macro VBA", "body": "<p>I am newbie to Excel Macro and VBA.</p>\n\n<p>I have a requirement to copy the table data from a word document to an excel sheet using macro VBA.</p>\n\n<p>I need document V1.2 version to be executed among many version of documents in a specific folder.\nFor ex: I have documents <code>\"C:\\Test\\FirstDocV1.1.doc\"</code> &amp; <code>\"C:\\Test\\FirstDocV1.2.doc\"</code>. </p>\n\n<p>I want only <code>\"C:\\Test\\FirstDocV1.2.doc\"</code> to be executed and fetch the table data.\nI tried anyhow, but it is saying as \"No tables\".</p>\n\n<p>See my code as below.</p>\n\n<pre><code>Sub importTableDataWord()\n    Dim WdApp As Object, wddoc As Object\n    Dim strDocName As String\n\n    On Error Resume Next\n    Set WdApp = GetObject(, \"Word Application\")\n\n    If Err.Number = 429 Then\n       Err.Clear\n        Set WdApp = CreateObject(\"Word Application\")\n    End If\n\n    WdApp.Visible = True\n    strDocName = \"C:\\Test\\FirstDocV1.2.doc\"\n\n'I am manually giving for version 1.2 doc. But I need to select which contains v1.2 version automatically from Test folder.    \n    If Dir(strDocName) = \"\" Then\n        MsgBox \"The file is not present\" &amp; strDocName &amp; vbCrLf &amp; \" or was not found\"\n        Exit Sub\n    End If\n\n    WdApp.Activate\n    Set wddoc = WdApp.Documents(strDocName)\n\n    If wddoc Is Nothing Then Set wddoc = WdApp.Documents.Open(strDocName)\n        wddoc.Activate\n        Dim Tble As Integer\n        Dim rowWd As Long\n        Dim colWd As Long\n        Dim x As Long, y As Long\n\n        x = 1\n        y = 1\n\n        With wddoc\n            Tble = wddoc.tables.Count\n            If Tble = 0 Then\n                MsgBox \"No Tables Found in the document\"\n                Exit Sub\n            End If\n\n            For i = 1 To Tble\n                With .tables(i)\n                    For rowWd = 1 To .Rows.Count\n                        For colWd = 1 To .Columns.Count\n                            Cells(x, y) = WorksheetFunction.Clean(.cell(rowWd, colWd).Range.Text)\n                            y = y + 1\n                        Next colWd\n                        y = 1\n                        x = x + 1\n                    Next rowWd\n                End With\n            Next\n        End With\n\n    wddoc.Close savechanges:=False\n    WdApp.Quit\n\n    Set wddoc = Nothing\n    Set WdApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me please.</p>\n"}, {"tags": ["vba", "excel", "ms-word", "powerpoint"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1436974300, "post_id": 31434446, "comment_id": 50839550, "body": "What do you mean by constants? Do you mean VBA identifiers declared with the key word <code>Const</code>? If so -- I don&#39;t see how you can do much better than using select case or a dictionary. Wrapping it in a function is a sign of good programming rather than bad programming. If by constant you mean entries in the workbook&#39;s Names collection (named ranges or named values) then it is easy to access them from string variables."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1436974498, "post_id": 31434446, "comment_id": 50839700, "body": "@JohnColeman : I&#39;ll edit right away to avoid misunderstandings, but indeed I meant <code>Const</code> variables declared in VBA, I know the others are accessible via <code>ListObject</code>... For the function, I know it is still a good solution but I was wondering if there was a more direct way to do this, even if it apparently does not."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1436974867, "post_id": 31434446, "comment_id": 50839977, "body": "Is there any reason that they <i>aren&#39;t</i> names? In any event -- rather than writing a function to return the value from a string, perhaps you can write a function that runs once on workbook_open() and creates or updates  names which serve as aliases for these. Named ranges are more natural in VBA then const-tagged ranges (to give a term for what you seem to be doing)."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1436975542, "post_id": 31434446, "comment_id": 50840474, "body": "Nope, and indeed it seems to be a better idea that the VBA Consts that I started with! Thx for input, I haven&#39;t thought of it that way but I&#39;ll most probably change it to Named Ranges! I&#39;ll still let open the question for a bit and see if anyone has interesting input on the subject"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1436975864, "post_id": 31434446, "comment_id": 50840719, "body": "A fair amount of my VBA code has lines which look like <code>Set Data = Range(&quot;Data&quot;)</code> (where Data is a Range variable). I almost never reassign such variables so, de facto if not de-jure, they function as consts which are bound to specific ranges in the spreadsheet."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1436976183, "post_id": 31434446, "comment_id": 50840934, "body": "I use these a lot too, but when you declare them as Public and assign them in Workbook_Open, do you still need to free them in Workbook_Close?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1436976265, "post_id": 31434446, "comment_id": 50840988, "body": "VBA has automatic garbage collection. This shouldn&#39;t be an issue."}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436974304, "post_id": 31434677, "comment_id": 50839553, "body": "I didn&#39;t thought of that! It is an interesting work around but I think I&#39;ll prefer my <code>Select Case</code> function, but anyway, thank you for the input! ;)"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 1, "last_activity_date": 1436974085, "creation_date": 1436974085, "answer_id": 31434677, "question_id": 31434446, "link": "https://stackoverflow.com/questions/31434446/vba-is-there-a-way-to-get-a-constant-value-from-a-variable-string/31434677#31434677", "title": "VBA - Is there a way to get a Constant value from a variable String?", "body": "<p>I'm not a pro and my answer it's only what I've done to solve a similar problem, anyway, I hope it helps:</p>\n\n<p>You can add controls (for example Textbox) named as your constants and set the value you need, then you'll be able to catch any value with this:</p>\n\n<pre><code>Me.Controls(\"RG_\" &amp; extension(i)).text\n</code></pre>\n"}], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 31434677, "answer_count": 1, "score": 0, "last_activity_date": 1436974601, "creation_date": 1436973549, "last_edit_date": 1531164843, "question_id": 31434446, "link": "https://stackoverflow.com/questions/31434446/vba-is-there-a-way-to-get-a-constant-value-from-a-variable-string", "title": "VBA - Is there a way to get a Constant value from a variable String?", "body": "<p>I have created <strong>few Constants</strong> (VBA identifiers declared with the key word <code>Const</code>) that look like <code>Rg_Euro</code>, <code>Rg_Usd</code>, <code>Rg_Cad</code>, ... to define specific regions into my workbook.</p>\n\n<p>As I have these <strong>\"extensions\"</strong> (<strong><code>Euro</code>, <code>Usd</code>, <code>Cad</code>, ...</strong>) in the DataBase that I'm working with, <strong>I tried to get the values of my constant by creating a string</strong> like this : <code>Str = \"Rg_\" &amp; extension(i)</code></p>\n\n<p>But I <strong>can't seem to find a workaround to call the Constant and get its value from it...</strong> I'm googled it but didn't found what I was looking for and I'm starting to think that it might not be possible directly...</p>\n\n<p><em>I thought of a User Defined Function with a <code>Select Case</code> on the String to return the right value, but it is just going to add another function</em>, <strong>so I'm looking for a more direct solution if there is one!</strong></p>\n"}, {"tags": ["excel", "vba", "session", "xmlhttprequest"], "comments": [{"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 2, "creation_date": 1436982591, "post_id": 31434437, "comment_id": 50844770, "body": "just an observation, but you create a new &#39;xmlHttp&#39; object before executing the second GET.  perhaps you can reuse the existing &#39;xmlHttp&#39; object and see if that helps keep you session alive?"}], "answers": [{"tags": [], "owner": {"reputation": 2986, "user_id": 4316726, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a9dbbe67417449dad8b918b8f1756266?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Powell", "link": "https://stackoverflow.com/users/4316726/brian-powell"}, "is_accepted": false, "score": 5, "last_activity_date": 1436982553, "creation_date": 1436982553, "answer_id": 31437545, "question_id": 31434437, "link": "https://stackoverflow.com/questions/31434437/establishing-an-api-session-with-xmlhttp-in-vba/31437545#31437545", "title": "Establishing an API session with xmlHttp in VBA", "body": "<p>So, to anyone else who runs across this, the simple solution was to remove the following line from the <strong>second</strong> call:</p>\n\n<pre><code>Set xmlHttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\n</code></pre>\n\n<p>By not creating a new object, vba is able to keep and use the cookie from the first login call.</p>\n\n<p>The final code looks like this:</p>\n\n<pre><code>'Login\nstrLogin = \"https://URL.COM/authenticateUser?login=username&amp;apiKey=password\"\nSet xmlHttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\nxmlHttp.Open \"GET\", strLogin\nxmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\nxmlHttp.send\n\n'Save the response to a string\nstrReturn = xmlHttp.responseText\n\n\n'Open URL and get JSON data\n\nstrUrl = \"https://URL.COM/Search/search?searchTerm=\" &amp; Keyword &amp; \"&amp;mode=beginwith\"\nxmlHttp.Open \"GET\", strUrl\nxmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\nxmlHttp.send\n\n'Save the response to a string\nstrReturn = xmlHttp.responseText\n\n\nSheets(1).Cells(20, 2).Value = strReturn\n</code></pre>\n\n<p>And the API which requires a login is able to keep the session established.</p>\n"}], "owner": {"reputation": 2986, "user_id": 4316726, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a9dbbe67417449dad8b918b8f1756266?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Powell", "link": "https://stackoverflow.com/users/4316726/brian-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12175, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1577090432, "creation_date": 1436973531, "last_edit_date": 1577090432, "question_id": 31434437, "link": "https://stackoverflow.com/questions/31434437/establishing-an-api-session-with-xmlhttp-in-vba", "title": "Establishing an API session with xmlHttp in VBA", "body": "<p>I apologize if my question's title is incorrect - I'm used to the idea of PHP sessions with APIs.</p>\n\n<p>I'm trying to accomplish the same feat in VBA with the following code:</p>\n\n<pre><code>'Login\nstrLogin = \"https://URL.COM/authenticateUser?login=username&amp;apiKey=password\"\nSet xmlHttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\nxmlHttp.Open \"GET\", strLogin\nxmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\nxmlHttp.send\n\n'Save the response to a string\nstrReturn = xmlHttp.responseText\n\n\n'Open URL and get JSON data\n\nstrUrl = \"https://URL.COM/Search/search?searchTerm=\" &amp; Keyword &amp; \"&amp;mode=beginwith\"\nSet xmlHttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\nxmlHttp.Open \"GET\", strUrl\nxmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\nxmlHttp.send\n\n'Save the response to a string\nstrReturn = xmlHttp.responseText\n\n\nSheets(1).Cells(20, 2).Value = strReturn\n</code></pre>\n\n<p>With this API, I need to login first prior to executing any calls that will return data.</p>\n\n<p>My problem is that I cannot determine how to \"stay logged in\" so that my second call works.</p>\n\n<p>after I login, <code>strReturn</code> is populated with the following string: </p>\n\n<pre><code>{\"Status\":{\"Code\":\"2\",\"Message\":\"Authentication Succeeded\",\"Success\":\"true\"}}\n</code></pre>\n\n<p>However, when I go to utilize <code>strUrl</code>, I get the following message:</p>\n\n<p><code>{\"Status\":{\"Code\":\"1\",\"Message\":\"Invalid User Name Or Password\",\"Success\":\"false\"}}\n</code></p>\n\n<p>I have used this code in prior projects where I needed to supply an API key along with the URL for each request to the server - so this obviously worked fine.  I'm not sure how to achieve the concept of \"establishing a session\" though with xmlHttp.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436973464, "post_id": 31434312, "comment_id": 50838972, "body": "When it does occur, can you &quot;continue&quot; and the macro keeps running, as it should? What error gets thrown when that happens? Or does it force you to stop and is expecting you to fix something?"}, {"owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436973745, "post_id": 31434312, "comment_id": 50839156, "body": "@user3578951   If i&#39;m in Excel, then I get Run-time error -2147467259(80004005).  If I&#39;m in Debug Mode, then I also receive the message that Method &#39;Axes&#39; of object &#39;Charts&#39; failed.   In both situations, the macro stops."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436973929, "post_id": 31434312, "comment_id": 50839270, "body": "Just looking around online, does this work? Instead of that line, try <code>.Axes(xlValue, xlSecondary).SetElement (msoElementChartTitleAboveChart)</code>.  Note that is untested and may give an error too..."}, {"owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436974008, "post_id": 31434312, "comment_id": 50839317, "body": "@user3578951 Gives the same error"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436974445, "post_id": 31434312, "comment_id": 50839665, "body": "Hm, maybe in the Do While loop (the one before the last one, where you have <code>.SeriesCollection(cont2).AxisGroup = xlSecondary</code>, add this after that: <code>.HasAxis(xlValue, xlSecondary) = True   .Axes(xlCategory, xlSecondary).CategoryType = xlAutomatic</code>  Does it let you set that &quot;hasAxis&quot; then?"}, {"owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436975594, "post_id": 31434312, "comment_id": 50840523, "body": "@user3578951 I&#39;ve just noticed something... The error comes up when the lines, where the data is written, are hidden. Maybe this is the problem?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436976118, "post_id": 31434312, "comment_id": 50840884, "body": "Ah, yes - that might be causing an issue.  Do you need them hidden, or can you show them? If you unhide, does everything work fine?"}, {"owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1436976263, "post_id": 31434312, "comment_id": 50840986, "body": "@user3578951 I think I managed to solve this problem... I think I was adding a title to the secondary axis, when no series where assigned to that axis. I created a variable cont3 that counts the number of Series for the secondary axis."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436976719, "post_id": 31434312, "comment_id": 50841297, "body": "Ah, I missed that you didn&#39;t set the secondary axis series - that should fix it up!"}, {"owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436977620, "post_id": 31434312, "comment_id": 50841813, "body": "@user3578951 but now the thing is: shouldn&#39;t &#39;graf.Chart.HasAxis(xlValue, xlSecondary) = True&#39; take care of it?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "edited": false, "score": 0, "creation_date": 1436977954, "post_id": 31434312, "comment_id": 50842023, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/83353/discussion-between-user3578951-and-an-old-man-in-the-sea\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 582, "user_id": 3336667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55bcff89476fdb1048642e6b250bb068?s=128&d=identicon&r=PG&f=1", "display_name": "Rao", "link": "https://stackoverflow.com/users/3336667/rao"}, "is_accepted": false, "score": 0, "last_activity_date": 1488191078, "creation_date": 1488191078, "answer_id": 42483263, "question_id": 31434312, "link": "https://stackoverflow.com/questions/31434312/adding-a-secondary-axis-with-excel-vba/42483263#42483263", "title": "Adding a secondary axis with Excel VBA", "body": "<p>Disclaimer: This is not strictly speaking an Answer, since it does not contain a new information, only repeats it. But because this question goes unanswered (except the the hint of <code>@An old man in the sea.</code> hidden deep within a comments), I would like to write it down here in usual way to possibly help other people.</p>\n\n<hr>\n\n<p>I also got some very helpful error messages like <code>System.Runtime.InteropServices.COMException (0x80004005): Error HRESULT E_FAIL has been returned from a call to a COM component.</code>.</p>\n\n<p>As <code>@An old man in the sea.</code> had suggested in a comments, I moved problematic part concerning formatting axis tiles, scales, etc. after the axis had some data connected to it. This resulted in a disapperance of Exception and after several days a progress had been achieved :-)</p>\n\n<p>So in pseudocode instead of</p>\n\n<pre><code>FormatSecondaryAxis(chart);\nDrawDataToSecondaryAxis(chart);\n</code></pre>\n\n<p>just swap order and do drawing first and formatting second. </p>\n\n<hr>\n\n<p>Oh and by the way, this C# code:</p>\n\n<pre><code>chart.HasAxis[Excel.XlAxisType.xlValue, Excel.XlAxisGroup.xlSecondary] = true;\nchart.HasAxis[Excel.XlAxisType.xlCategory, Excel.XlAxisGroup.xlSecondary] = true;\nchart.SetElement(Microsoft.Office.Core.MsoChartElementType.msoElementSecondaryValueAxisTitleAdjacentToAxis);\n</code></pre>\n\n<p>does not do the trick. The last line throws the Exception, if no actual data are not connected to the axis.</p>\n"}], "owner": {"reputation": 259, "user_id": 3482266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9cfa2670f8085a5eb850ab823e0ee834?s=128&d=identicon&r=PG&f=1", "display_name": "An old man in the sea.", "link": "https://stackoverflow.com/users/3482266/an-old-man-in-the-sea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3699, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1488191078, "creation_date": 1436973193, "question_id": 31434312, "link": "https://stackoverflow.com/questions/31434312/adding-a-secondary-axis-with-excel-vba", "title": "Adding a secondary axis with Excel VBA", "body": "<p>Well I've written this code that does more than just adding the secondary axis. However, sometimes, it returns a run-time error on the last <strong>With</strong> command, on the <code>.Axes(xlValue, xlSecondary).HasTitle = True</code> at the end of the code. For the sake of completeness I transcribed the whole programme. This run-time error doesn't always occur, but I don't seem to understand when it does occur, or why... Do you know how to solve this problem?</p>\n\n<p>Any help would be appreciated</p>\n\n<pre><code>Private Sub criargraf()\nDim cont, cont2 As Integer\n\nApplication.ScreenUpdating = False\n\nIf Sheets(\"SubUN\").ChartObjects.Count &gt; 0 Then\n        Sheets(\"SubUN\").ChartObjects.Delete\nEnd If\n\nSheets(\"SubUN\").Shapes.AddChart\n\nSet graf = Sheets(\"SubUN\").ChartObjects(1)\n\nIf graf.Chart.SeriesCollection.Count &gt; 0 Then\n\n    cont = graf.Chart.SeriesCollection.Count\n\n        Do While cont &gt; 0\n\n        graf.Chart.SeriesCollection(1).Delete '\u00e0s vezes,Quando se cria um gr\u00e1fico, este j\u00e1 vem com uma s\u00e9rie, portanto tens de fazer um Newseries a menos\n        cont = cont - 1\n\n        Loop\n\n    End If\n\n    With graf.Chart\n\n        .ChartArea.Width = 878\n        .Parent.Height = 470\n        .Parent.Top = 37\n        .Parent.Left = 575\n\n        .HasLegend = True\n        .Legend.Left = 215\n        .Legend.Top = 400\n        .Legend.Height = 100\n        .Legend.Width = 500\n\n        .PlotArea.Height = 350\n        .PlotArea.Width = 830\n\n        .PlotArea.Left = 20\n        .PlotArea.Top = 30\n\n\n        .ChartType = xlLine\n        .HasTitle = True\n        .ChartTitle.Characters.Text = Range(\"E134\")\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Meses\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = Range(\"E131\")\n    End With\n\n    cont = 1\n    cont2 = 1\n\n    Do While Range(\"L\" &amp; 121 + cont).Value &lt;&gt; \"\"\n        If Sheets(\"SubUN\").Rows(120 + cont).EntireRow.Hidden = False Then\n            With graf.Chart\n                .SeriesCollection.NewSeries\n                .SeriesCollection(cont2).Values = Sheets(\"SubUN\").Range(\"M\" &amp; (120 + cont) &amp; \":X\" &amp; (120 + cont))\n                .SeriesCollection(cont2).Name = Sheets(\"SubUN\").Range(\"L\" &amp; (120 + cont))\n                .SeriesCollection(cont2).XValues = Range(\"M120:X120\")\n            End With\n            cont2 = cont2 + 1\n        End If\n    cont = cont + 1\n\n    Loop\n\n    cont = 1\n    Do While Range(\"L\" &amp; 145 + cont).Value &lt;&gt; \"\"\n        If Sheets(\"SubUN\").Rows(145 + cont).EntireRow.Hidden = False Then\n            With graf.Chart\n                .SeriesCollection.NewSeries\n                .SeriesCollection(cont2).Values = Sheets(\"SubUN\").Range(\"M\" &amp; (145 + cont) &amp; \":X\" &amp; (145 + cont))\n                .SeriesCollection(cont2).Name = Sheets(\"SubUN\").Range(\"L\" &amp; (145 + cont))\n                .SeriesCollection(cont2).XValues = Range(\"M145:X145\")\n            End With\n            cont2 = cont2 + 1\n        End If\n    cont = cont + 1\n\n    Loop\n\n\n\n    cont = 1\n    Do While Range(\"L\" &amp; 168 + cont).Value &lt;&gt; \"\"\n        If Sheets(\"SubUN\").Rows(168 + cont).EntireRow.Hidden = False Then\n            With graf.Chart\n                .SeriesCollection.NewSeries\n                .SeriesCollection(cont2).Values = Sheets(\"SubUN\").Range(\"M\" &amp; (168 + cont) &amp; \":X\" &amp; (168 + cont))\n                .SeriesCollection(cont2).Name = Sheets(\"SubUN\").Range(\"L\" &amp; (168 + cont))\n                .SeriesCollection(cont2).XValues = Range(\"M168:X168\")\n                .SeriesCollection(cont2).AxisGroup = xlSecondary\n                .SeriesCollection(cont2).ChartType = xlColumnClustered\n                .SeriesCollection(cont2).ApplyDataLabels\n                '.SeriesCollection(cont2).DataLabels.Position = xlLabelPositionAbove\n\n            End With\n\n            cont2 = cont2 + 1\n\n        End If\n\n        cont = cont + 1\n\n    Loop\n\n   If cont2 &gt; 2 Then\n\n   graf.Chart.HasAxis(xlValue, xlSecondary) = True\n   With graf.Chart\n        '.Legend.Left = 2000 * (cont2) ^ -1\n        .Legend.Width = 100 * (cont2)\n        .Axes(xlValue, xlSecondary).HasTitle = True\n        .Axes(xlValue, xlSecondary).AxisTitle.Characters.Text = \" Varia\u00e7\u00e3o (%)\"\n        .Axes(xlValue).HasMajorGridlines = True\n        .Axes(xlValue).MajorGridlines.Border.LineStyle = xlDashDotDot\n        .Axes(xlValue).MajorGridlines.Border.Color = RGB(190, 190, 190)\n\n    End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "vba", "position"], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1436973997, "last_edit_date": 1495535205, "creation_date": 1436973997, "answer_id": 31434633, "question_id": 31434066, "link": "https://stackoverflow.com/questions/31434066/user-forms-vba-position-bringing-forward-and-backward/31434633#31434633", "title": "User forms VBA position - bringing forward and backward", "body": "<p>After a fair bit of searching, it would seem the answer to your question is No.  There doesn't appear to be any way to adjust the Zorder or use \"Bring to Front\" or \"Send to Back\" in VBA.  As per the answer here:  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/23202271/use-z-order-and-position-to-organize-open-forms-in-ms-access\">Use Z-order and position to organize open forms in MS Access</a></p>\n\n<p>And here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/16517419/microsoft-access-z-index-property\">Microsoft Access z-index property</a></p>\n\n<p>The only alternative I have found mentioned was to layer your controls perfectly and the use <code>.Setfocus</code> to bring them to the front.  Personally in my database I simply just toggle <code>.Visible</code> for the control to <code>False</code> or <code>True</code> in order to give the illusion of controls \"Moving\". </p>\n\n<p><strong>Note:</strong> After reviewing your tags I notice you don't have an Excel or Access one in there.  My answer is based off of Access, if you are using excel please adjust your tags. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15078165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18e1d27e1b46b98514e24acf849c7ee?s=128&d=identicon&r=PG", "display_name": "David Gilbert", "link": "https://stackoverflow.com/users/15078165/david-gilbert"}, "is_accepted": false, "score": 0, "last_activity_date": 1611590949, "creation_date": 1611590949, "answer_id": 65888339, "question_id": 31434066, "link": "https://stackoverflow.com/questions/31434066/user-forms-vba-position-bringing-forward-and-backward/65888339#65888339", "title": "User forms VBA position - bringing forward and backward", "body": "<p>In response to this old question of moving items to the front or rear on Excel forms, I have found that the &quot;Bring Forward&quot; and &quot;Send Backward&quot; controls do not work.  By accident I found that if you delete an item in an Excel form and then undelete it, it will move it to the front.</p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10765, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1611590949, "creation_date": 1436972568, "question_id": 31434066, "link": "https://stackoverflow.com/questions/31434066/user-forms-vba-position-bringing-forward-and-backward", "title": "User forms VBA position - bringing forward and backward", "body": "<p>Is there any index to control which picture, textbox, frame... will be in front of the other? Is there any property similar tor the PHP's z-index?</p>\n\n<p>I am trying to right click and sending backward, but I get no change. </p>\n"}, {"tags": ["excel", "userform", "multipage", "vba"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 5122706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd87326768f609c296d43a9eb1fb17dd?s=128&d=identicon&r=PG&f=1", "display_name": "I-J", "link": "https://stackoverflow.com/users/5122706/i-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1440516755, "last_edit_date": 1495540755, "creation_date": 1440515235, "answer_id": 32207628, "question_id": 31433997, "link": "https://stackoverflow.com/questions/31433997/excel-vba-userform-multipage-and-frame-copy-paste/32207628#32207628", "title": "Excel VBA Userform Multipage and Frame (copy/paste)", "body": "<p>OK, I haven't got much information from you to go with, but I can make this work by using the following method. If you want to use it, you will have to modify it to suit your own needs. </p>\n\n<p>To follow this example, you will need to create a new UserForm, preferably in a new workbook, and follow my instructions below.</p>\n\n<p>I have created a UserForm as you state, with a Multipage - currently I have pages 0 and 1 on it. Page 0 I am ignoring for the purposes of this example (you mentioned it was just the General Settings page). </p>\n\n<p>Seperate from the Multipage, I have put the main CommandButton (the one which actually adds the new Page when it's clicked) and have named it <code>AddProgramButton</code> as you did. </p>\n\n<p>On Page 1, I have a frame as you state. Within this frame, I have put a CommandButton, a TextBox and a ComboBox on mine. I don't know what your controls are, but you will need to follow my example for now.</p>\n\n<p>Now we need to start entering the code. First, if you haven't already got one, insert a Standard Module in your project. At the top of this standard module, enter the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic myButtonArr() As New CButton\nPublic myComboArr() As New CCombo\nPublic myTextBoxArr() As New CTextBox\n</code></pre>\n\n<p>Now, in your UserForm module, you should input the following (note that some of this is the information you first provided):</p>\n\n<pre><code>Option Explicit\nPrivate Sub UserForm_Initialize()\n    Dim ctl As Control\n    For Each ctl In MultiPage1.Pages(1).Controls\n        Select Case TypeName(ctl)\n            Case Is = \"CommandButton\"\n                ReDim Preserve myButtonArr(1 To 1)\n                Set myButtonArr(1).myButton = ctl\n            Case Is = \"ComboBox\"\n                ReDim Preserve myComboArr(1 To 1)\n                Set myComboArr(1).myCombo = ctl\n                ctl.AddItem \"A\"\n                ctl.AddItem \"B\"\n            Case Is = \"TextBox\"\n                ReDim Preserve myTextBoxArr(1 To 1)\n                Set myTextBoxArr(1).myTextBox = ctl\n        End Select\n    Next ctl\nEnd Sub\n\nPrivate Sub AddProgramButton_Click()\n\n    Dim l As Double, r As Double\n    Dim ctl As Control\n    Dim PAGECOUNT As Long\n\n    MultiPage1.Pages.Add\n\n    MultiPage1.Pages(1).Controls.Copy\n    PAGECOUNT = MultiPage1.Pages.Count\n    MultiPage1.Pages(\"Page\" &amp; PAGECOUNT).Paste\n    MultiPage1.Pages(\"Page\" &amp; PAGECOUNT).Caption = \"#\" &amp; PAGECOUNT - 1\n\n     For Each ctl In MultiPage1.Pages(1).Controls\n        If TypeOf ctl Is MSForms.Frame Then\n            l = ctl.Left\n            r = ctl.Top\n            Exit For\n        End If\n    Next\n\n    For Each ctl In MultiPage1.Pages(PAGECOUNT - 1).Controls\n        If TypeOf ctl Is MSForms.Frame Then\n            ctl.Left = l\n            ctl.Top = r\n            Exit For\n        End If\n    Next\n\n    For Each ctl In MultiPage1.Pages(PAGECOUNT - 1).Controls\n        Select Case TypeName(ctl)\n            Case Is = \"CommandButton\"\n                ReDim Preserve myButtonArr(1 To PAGECOUNT - 1)\n                Set myButtonArr(PAGECOUNT - 1).myButton = ctl\n            Case Is = \"ComboBox\"\n                ReDim Preserve myComboArr(1 To PAGECOUNT - 1)\n                Set myComboArr(PAGECOUNT - 1).myCombo = ctl\n                ctl.AddItem \"A\"\n                ctl.AddItem \"B\"\n            Case Is = \"TextBox\"\n                ReDim Preserve myTextBoxArr(1 To PAGECOUNT - 1)\n                Set myTextBoxArr(PAGECOUNT - 1).myTextBox = ctl\n        End Select\n    Next ctl\n\n\nEnd Sub\n</code></pre>\n\n<p>Now, for each control I have within the frame, we need to create a new Class. Insert <strong>three</strong> new <strong><em>Class Modules</em></strong>. You must name these as follows:</p>\n\n<p><code>CButton</code></p>\n\n<p><code>CCombo</code></p>\n\n<p><code>CTextBox</code></p>\n\n<p>Now open the CButton class module, and insert the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents myButton As MSForms.CommandButton\n\nPrivate Sub myButton_Click()\n    MsgBox \"You clicked the button on one of the pages\"\nEnd Sub\n</code></pre>\n\n<p>Next, open the CCombo class module, and insert the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents myCombo As MSForms.ComboBox\n\nPrivate Sub myCombo_Change()\n    MsgBox \"You changed the value of the ComboBox on one of the pages\"\nEnd Sub\n</code></pre>\n\n<p>Finally, open the CTextBox class module, and insert the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents myTextBox As MSForms.TextBox\n\nPrivate Sub myTextBox_Change()\n    MsgBox \"You changed some text in the TextBox on one of the pages\"\nEnd Sub\n</code></pre>\n\n<p>Now, if you test your Userform, it should work. You should hopefully be able to modify my example to match your own requirements. </p>\n\n<p>Note: the events in the class module will produce an identical response regardless of which page is selected. You will have to modify the code yourself (or provide more information) to \"personalise\" the results. </p>\n\n<p>BTW you probably found your original code here: <a href=\"https://stackoverflow.com/questions/10822450/copy-elements-from-one-page-to-another-in-multipage-with-vba-in-excel\">Copy Elements From One Page To Another in Multipage with VBA in Excel</a>. </p>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3117, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1501514609, "creation_date": 1436972417, "last_edit_date": 1531164843, "question_id": 31433997, "link": "https://stackoverflow.com/questions/31433997/excel-vba-userform-multipage-and-frame-copy-paste", "title": "Excel VBA Userform Multipage and Frame (copy/paste)", "body": "<p>I have a Userform Control Panel that I am making for a workbook. I have a page named #1, which is for the workbook sheet #1. I also have an 'Add sheet' button that copies the #1 page and creates a #2 page.</p>\n\n<p>The problem is that the code for the controls on the #1 page do not work on the newly created #2 page. And I don't know what the page #2 controls are called so I can't make code for it beforehand.</p>\n\n<p>This is the Copy/Paste code that I found somewhere. Page 0 is the General settings page and page 1 is the #1 page. I have a Frame taking up the whole Multipage area so it copies the frame and everything in it and copies it.</p>\n\n<pre><code>Option Explicit\nPrivate Sub AddProgramButton_Click()\n\nDim l As Double, r As Double\nDim ctl As Control\nDim PAGECOUNT As Long\n\nMultiPage1.Pages.Add\n\nMultiPage1.Pages(1).Controls.Copy\nPAGECOUNT = MultiPage1.Pages.Count\nMultiPage1.Pages(\"Page\" &amp; PAGECOUNT).Paste\nMultiPage1.Pages(\"Page\" &amp; PAGECOUNT).Caption = \"#\" &amp; PAGECOUNT - 1\n\n For Each ctl In MultiPage1.Pages(1).Controls\n    If TypeOf ctl Is MSForms.Frame Then\n        l = ctl.Left\n        r = ctl.Top\n        Exit For\n    End If\nNext\n\nFor Each ctl In MultiPage1.Pages(PAGECOUNT - 1).Controls\n    If TypeOf ctl Is MSForms.Frame Then\n        ctl.Left = l\n        ctl.Top = r\n        Exit For\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "statistics", "modeling", "normal-distribution", "vba"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1436971943, "post_id": 31433691, "comment_id": 50837886, "body": "We need to know the mean of the distribution too."}, {"owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1436971990, "post_id": 31433691, "comment_id": 50837920, "body": "Apologize. X is the mean"}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1436972014, "post_id": 31433691, "comment_id": 50837934, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6241784/produce-random-numbers-with-specific-distribution-with-excel\">Produce random numbers with specific distribution with Excel</a>"}, {"owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "edited": false, "score": 0, "creation_date": 1436972212, "post_id": 31433691, "comment_id": 50838065, "body": "I believe the Norminv will actually just give a uniform type distribution. RAND() is just a uniform 0-1"}, {"owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "edited": false, "score": 0, "creation_date": 1436972326, "post_id": 31433691, "comment_id": 50838148, "body": "Basically I want to produce numbers 68% of the time within 1 deviation, 95% of the time withing 2 deviation etc. etc."}], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1436981227, "last_edit_date": 1436981227, "creation_date": 1436980827, "answer_id": 31436985, "question_id": 31433691, "link": "https://stackoverflow.com/questions/31433691/how-do-i-use-a-standard-distribution-to-guess-where-the-value-falls-in-the-futur/31436985#31436985", "title": "How do I use a standard distribution to guess where the value falls in the future?", "body": "<p>You can use the excel function 'NORMINV' to convert a random input 'RAND()' to a normal distribution.</p>\n\n<pre><code>=NORMINV(RAND(),Mean,Std Dev)\n</code></pre>\n\n<p>i.e. if you repeat this many times, save and analyze the results, you'll see a bell curve over the input Mean value.</p>\n\n<p>Does that get you started?</p>\n\n<p>The tricky bit comes when you come up with the formula to predict what a value will be in the future using this.</p>\n"}], "owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436981227, "creation_date": 1436971693, "last_edit_date": 1531161705, "question_id": 31433691, "link": "https://stackoverflow.com/questions/31433691/how-do-i-use-a-standard-distribution-to-guess-where-the-value-falls-in-the-futur", "title": "How do I use a standard distribution to guess where the value falls in the future?", "body": "<p>I have a mean value x and I want to model it into the future. I want to output a value of what it could be in 6 months. Assuming the value follows a normal distribution and we have the standard deviation how do I randomize the value x while following a normal distribution? I'm doing this in excel, but just understanding it would help too! Basically I want to produce numbers 68% of the time within 1 deviation, 95% of the time withing 2 deviation etc. etc.</p>\n"}, {"tags": ["vba", "excel", "copy-paste", "transpose"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436973111, "post_id": 31433624, "comment_id": 50838713, "body": "You are going to be better off dumping your loop results to a new sheet for easy use.  Or you could do a filter perhaps."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436973317, "post_id": 31433624, "comment_id": 50838858, "body": "Quick note - I know you&#39;re only starting with it as an example, but that IF loop will always run - you are looking for NO space - but your formula will return an empty cell. It&#39;s <code>&quot; &quot;</code>  or <code>&quot;&quot;</code>.  It looks like you might instead be able to use Index/Match to return those values that have a count.  Can you post some sample data and a sample &quot;finished&quot; table?"}, {"owner": {"reputation": 1, "user_id": 5119863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea9aaa2644ca7bd62b6f3ce12a3aba?s=128&d=identicon&r=PG&f=1", "display_name": "Dinjo", "link": "https://stackoverflow.com/users/5119863/dinjo"}, "edited": false, "score": 0, "creation_date": 1436974555, "post_id": 31433624, "comment_id": 50839743, "body": "I understand that it has to be ended, that is not my problem. I will post something momentarily."}, {"owner": {"reputation": 1, "user_id": 5119863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea9aaa2644ca7bd62b6f3ce12a3aba?s=128&d=identicon&r=PG&f=1", "display_name": "Dinjo", "link": "https://stackoverflow.com/users/5119863/dinjo"}, "edited": false, "score": 0, "creation_date": 1436974812, "post_id": 31433624, "comment_id": 50839931, "body": "Apparently I cannot post anything because I do not have a 10 reputation. Just got the account today."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436975162, "post_id": 31433624, "comment_id": 50840194, "body": "You can host off-site on imgur or something and add the links.  A mod or 2000 rep user can edit the pictures in for you."}, {"owner": {"reputation": 1, "user_id": 5119863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea9aaa2644ca7bd62b6f3ce12a3aba?s=128&d=identicon&r=PG&f=1", "display_name": "Dinjo", "link": "https://stackoverflow.com/users/5119863/dinjo"}, "edited": false, "score": 0, "creation_date": 1436976247, "post_id": 31433624, "comment_id": 50840979, "body": "Check @brad mahan&#39;s post."}, {"owner": {"reputation": 1, "user_id": 5119863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea9aaa2644ca7bd62b6f3ce12a3aba?s=128&d=identicon&r=PG&f=1", "display_name": "Dinjo", "link": "https://stackoverflow.com/users/5119863/dinjo"}, "edited": false, "score": 0, "creation_date": 1436976384, "post_id": 31433624, "comment_id": 50841069, "body": "So basically, in G, if there is a value, copy the corresponding Section (Column A) and transpose paste so that I can go on to use a VLOOKUP for the rest of the problem!"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 5090585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad26312bbe0693a2490a820e54e2cbe?s=128&d=identicon&r=PG&f=1", "display_name": "brad mahan", "link": "https://stackoverflow.com/users/5090585/brad-mahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436976130, "last_edit_date": 1436976130, "creation_date": 1436975362, "answer_id": 31435169, "question_id": 31433624, "link": "https://stackoverflow.com/questions/31433624/copy-a-range-of-cells-with-certain-criteria-paste-correct-criteria-as-transpose/31435169#31435169", "title": "Copy a range of cells with certain criteria. Paste correct criteria as transpose", "body": "<p>Just to clarify before I go any further in my answer, are you basically trying to copy and transpose (paste values) to a different location within a Macro?  If so what is the qualifier from Column E that signifies that you should look up column A? </p>\n\n<p>I am also working with Dinjo on this project. Here is his examples.</p>\n\n<p><img src=\"https://i.stack.imgur.com/SpCF2.png\" alt=\"Data\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/PVnVz.png\" alt=\"Result\"></p>\n"}], "owner": {"reputation": 1, "user_id": 5119863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea9aaa2644ca7bd62b6f3ce12a3aba?s=128&d=identicon&r=PG&f=1", "display_name": "Dinjo", "link": "https://stackoverflow.com/users/5119863/dinjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436976130, "creation_date": 1436971532, "last_edit_date": 1436974772, "question_id": 31433624, "link": "https://stackoverflow.com/questions/31433624/copy-a-range-of-cells-with-certain-criteria-paste-correct-criteria-as-transpose", "title": "Copy a range of cells with certain criteria. Paste correct criteria as transpose", "body": "<p>I am working on a project where column G has an If Statement:</p>\n\n<pre><code>=IF(AND(E2&gt;0,E2&lt;6),COUNTIF($E$2:$E$58,E2),\"\")\n</code></pre>\n\n<p>I want to be able to use a macro that will loop through the range and copy all values with a count in them. However, I do not want to copy column E, I need the information from column A that corresponds with column E's count. Column A is the Bin Location. After that I would like to be able to transpose those values into B72.</p>\n\n<p>Here is what I am thinking logically, but I am not too strong in VBA and need some help.</p>\n\n<pre><code>If range.cell(Column E) &lt;&gt; \" \" then\n\n'grab that cell and go over to column A value and copy. Next cell\n\n'Store all the values(Column A) and transpose starting at B72\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1436972524, "post_id": 31433586, "comment_id": 50838300, "body": "Cell(&quot;Contents&quot;,A1) Returns the contents of cell A1, not my sheet name."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 1, "creation_date": 1436973085, "post_id": 31433586, "comment_id": 50838693, "body": "cells will never work like that. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194567.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194567.aspx</a>"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1436973436, "post_id": 31433586, "comment_id": 50838953, "body": "Ahhh, was looking at the formula, not the VBA code <a href=\"https://support.office.com/en-ca/article/CELL-function-51bd39a5-f338-4dbe-a33f-955d67c2b2cf\" rel=\"nofollow noreferrer\">support.office.com/en-ca/article/&hellip;</a>"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 1, "creation_date": 1436973591, "post_id": 31433586, "comment_id": 50839061, "body": "ahhh. range(&quot;A1&quot;).value without the sheet ref will give you the contents of A1 on the activesheet. I have amended the above answer slightly"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1436974189, "post_id": 31433586, "comment_id": 50839472, "body": "Is there any way to use two cells to name the file? For example the contents of A1 underscore contents of A2?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 1, "creation_date": 1436974315, "post_id": 31433586, "comment_id": 50839564, "body": "name = range(&quot;A1&quot;).value &amp; &quot;_&quot; &amp; range(&quot;A2&quot;).value you can concatenate as much as you like using &amp;."}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1436974624, "post_id": 31433586, "comment_id": 50839793, "body": "Thank you so much! I regret that I have but one upvote to give."}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 1, "last_activity_date": 1436973648, "last_edit_date": 1436973648, "creation_date": 1436971431, "answer_id": 31433586, "question_id": 31433489, "link": "https://stackoverflow.com/questions/31433489/save-a-file-with-a-name-that-corresponds-to-a-cell-value/31433586#31433586", "title": "Save a file with a name that corresponds to a cell value", "body": "<p>Have you considered the file path? or which workbook you are getting A1 from?</p>\n\n<p>I assume Contents is a sheet and A1 is the filename ( for future people looking at this Contents was not the sheet)</p>\n\n<pre><code>Dim name As String\nname = range(\"A1\").value\nActiveWorkbook.SaveAs Filename:=name\n</code></pre>\n\n<p>just for your knowledge to do the same with cells you can use</p>\n\n<pre><code>cells(1,1).value\n</code></pre>\n\n<p>Cells expects numerical values for column/row</p>\n\n<p>To point to a sheet you can use</p>\n\n<pre><code>sheets(\"sheet1\").range(\"A1\").value\nsheets(\"sheet1\").cells(1,1).value\n</code></pre>\n\n<p>You could shorten this whole thing by using</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=range(\"A1\").value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1436971911, "creation_date": 1436971911, "answer_id": 31433792, "question_id": 31433489, "link": "https://stackoverflow.com/questions/31433489/save-a-file-with-a-name-that-corresponds-to-a-cell-value/31433792#31433792", "title": "Save a file with a name that corresponds to a cell value", "body": "<p>You have to remove brackets:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=name\n</code></pre>\n\n<p>Or if you want to use bracket, you need to put parameters inside them and add keyword <code>Call</code> at the beginning:</p>\n\n<pre><code>Call ActiveWorkbook.SaveAs(Filename:=name)\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11758, "favorite_count": 0, "accepted_answer_id": 31433586, "answer_count": 2, "score": 1, "last_activity_date": 1557215180, "creation_date": 1436971215, "last_edit_date": 1557215180, "question_id": 31433489, "link": "https://stackoverflow.com/questions/31433489/save-a-file-with-a-name-that-corresponds-to-a-cell-value", "title": "Save a file with a name that corresponds to a cell value", "body": "<p>Background: I'm working with a macro that transfers data between different workbooks. One of the workbooks is a conduit for data and doesn't change. The other workbook is a blank form that is populated, saved as a specific name and then reused.</p>\n\n<p>Problem: The workbook being saved needs to use the contents of a cell in the conduit workbook for it's name.</p>\n\n<p>I found a similar post <a href=\"https://stackoverflow.com/questions/21897456/using-vba-to-save-a-file-in-excel-2010-with-a-different-name-each-time\">here</a>. The answer gives me a syntax error.</p>\n\n<pre><code>Sub TestTestTestTest()\n'\n' TestTestTestTest Macro\n'\n\n'\n    Dim name As String\n    name = Cells(\"Contents\", A1)\n    ActiveWorkbook.SaveAs() Filename:=name**********\nEnd Sub\n</code></pre>\n\n<p>The starred line is the source of the syntax error.</p>\n"}, {"tags": ["vba", "excel", "combobox", "userform"], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "is_accepted": true, "score": 0, "last_activity_date": 1437056416, "creation_date": 1437056416, "answer_id": 31456908, "question_id": 31433218, "link": "https://stackoverflow.com/questions/31433218/select-second-pivot-table-row-data-after-first-row-input-vba-userforms-combobo/31456908#31456908", "title": "Select Second Pivot Table Row Data After First Row Input VBA Userforms &amp; ComboBox", "body": "<p>I have been toying around with this all day and found that you have to make the second row visible. This code works well. Note showing the detail BEFORE counting.</p>\n\n<pre><code>    Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").ShowDetail = _\nTrue\n\nFor i = 1 To lCommentCount\n    pti = Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").LabelRange.Offset(i, 0).Value\n    If Me.ptDatabox.Text = pti Then\n        OEEDataEntry.commentbox.AddItem Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").LabelRange.Offset(i, 1)\n    End If\nNext i\n\nFor i = Me.commentbox.ListCount - 1 To 0 Step -1\n    If Me.commentbox.List(i) = \"\" Or Me.commentbox.List(i) = \"Grand Total\" Or Me.commentbox.List(i) = (\"(blank)\") Then\n        Me.commentbox.RemoveItem (i)\n    End If\nNext i\n</code></pre>\n\n<p>If for whatever reason you want to change the information given in the first box then you would need to make it so that on reexit of that first box that you collapse all the bullets so <code>Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").ShowDetail =  False</code> \nbut that needs to be before you start counting items in the list.</p>\n"}], "owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 31456908, "answer_count": 1, "score": 0, "last_activity_date": 1437056416, "creation_date": 1436970470, "last_edit_date": 1436971753, "question_id": 31433218, "link": "https://stackoverflow.com/questions/31433218/select-second-pivot-table-row-data-after-first-row-input-vba-userforms-combobo", "title": "Select Second Pivot Table Row Data After First Row Input VBA Userforms &amp; ComboBox", "body": "<p>I have a Userform in which I submit some data, from the data my box populates with more data, and after I select the data from that box I need to select data from for that item from a third box.  The data gathered is from a PivotTable. </p>\n\n<p>Box1 is just a supplied combobox while 2 and 3 are directly from a PivotTable. I have the functionality for Box2 working based off Box1 but that's because they are separated by sheets.</p>\n\n<p>The goal is that Box1 can = A,B,C then if Box1=A then Box2 can = 1,2,3 then if Box2 = 1 then Box3= x,y,z. </p>\n\n<p>The problem being in Box3 it returns the information for Box2= 1,2 AND 3 rather than just 1. </p>\n\n<p>My current code is:</p>\n\n<pre><code>    lCommentCount = Sheets(pt).PivotTables(\"Pivottable1\").TableRange2.Rows.Count\n\n    For i = 1 To lCommentCount\n        If Me.ptDatabox.Value = Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").LabelRange.Offset(i, 0).List Then\n            OEEDataEntry.commentbox.AddItem Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"ptData\").LabelRange.Offset(i, 1)\n        End If\n    Next i\n\n    For i = Me.commentbox.ListCount - 1 To 0 Step -1\n        If Me.commentbox.List(i) = \"\" Or Me.commentbox.List(i) = \"Grand Total\" Or Me.commentbox.List(i) = (\"(blank)\") Then\n            Me.commentbox.RemoveItem (i)\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["excel", "vba", "formulas"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5003516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5102c07a089fe0cf8fb28db961a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "jonothan bird", "link": "https://stackoverflow.com/users/5003516/jonothan-bird"}, "edited": false, "score": 0, "creation_date": 1436992312, "post_id": 31436225, "comment_id": 50850321, "body": "Thank you very much, this has the exact same effect as my old formula. Now the character count is below 255, however I still get the 1004 error. The line is as follows: . .  <code>Range(&quot;A3&quot;).FormulaArray = &quot;=IFERROR(INDEX(&#39;Client Contact Database.xlsx&#39;!Data.ContactsFull,SMALL(IF(&#39;Client Contact Database.xlsx&#39;!Data.ContactClients=$L$1,ROW(&#39;Client Contact Database.xlsx&#39;!Data.ContactClients)-1),ROW(1:1)),1), &quot;&quot;)&quot;</code> ."}, {"owner": {"reputation": 11, "user_id": 5003516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5102c07a089fe0cf8fb28db961a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "jonothan bird", "link": "https://stackoverflow.com/users/5003516/jonothan-bird"}, "edited": false, "score": 0, "creation_date": 1437062170, "post_id": 31436225, "comment_id": 50884938, "body": "Any thoughts would be greatly appreciated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 5003516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5102c07a089fe0cf8fb28db961a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "jonothan bird", "link": "https://stackoverflow.com/users/5003516/jonothan-bird"}, "edited": false, "score": 0, "creation_date": 1437071723, "post_id": 31436225, "comment_id": 50890481, "body": "It seems that I will have to build a full test environment in order to locate your problem. Am I correct in assuming that <code>ContactsFull</code> and <code>ContactClients</code> are named ranges with worksheet (not workbook) scope on the external Data worksheet found in [Client Contact Database.xlsx]? Can yo provide some sample data together with expected results (in your original question at the top of this page through edit)?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436978472, "creation_date": 1436978472, "answer_id": 31436225, "question_id": 31433181, "link": "https://stackoverflow.com/questions/31433181/most-efficient-way-to-place-hundreds-of-array-formulas/31436225#31436225", "title": "Most efficient way to place hundreds of array formulas?", "body": "<p>First off, swap out your <code>IF(ISERROR(&lt;formula&gt;), \"\", &lt;formula&gt;)</code> for something that uses the <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow\">IFERROR function</a>. This will effectively cut your formula in half as IFERROR takes care of error control and default value without duplicating the formula.</p>\n\n<pre><code>=iferror(INDEX('Client Contact Database.xlsx'!Data.ContactsFull,SMALL(IF('Client Contact Database.xlsx'!Data.ContactClients=$L$1,ROW('Client Contact Database.xlsx'!Data.ContactClients)-1),ROW(1:1)),1), \"\")\n</code></pre>\n\n<p>I did not build all of the external references and named ranges for a full build environment, but I believe I transcribed that correctly.</p>\n"}], "owner": {"reputation": 11, "user_id": 5003516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5102c07a089fe0cf8fb28db961a73fb?s=128&d=identicon&r=PG&f=1", "display_name": "jonothan bird", "link": "https://stackoverflow.com/users/5003516/jonothan-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436978472, "creation_date": 1436970368, "last_edit_date": 1436974643, "question_id": 31433181, "link": "https://stackoverflow.com/questions/31433181/most-efficient-way-to-place-hundreds-of-array-formulas", "title": "Most efficient way to place hundreds of array formulas?", "body": "<p>I am new to VBA and advanced formulas for that matter and would deeply appreciate some guidance here.</p>\n\n<p>I have a workbook that acts as a GUI for a database in another workbook. I use the following array formula to act as a search function:</p>\n\n<pre><code>{=IF(ISERROR(INDEX('Client Contact Database.xlsx'!Data.ContactsFull,SMALL(IF('Client Contact Database.xlsx'!Data.ContactClients=$L$1,ROW('Client Contact Database.xlsx'!Data.ContactClients)),ROW(1:1)),2)),\"\",INDEX('Client Contact Database.xlsx'!Data.ContactsFull,SMALL(IF('Client Contact Database.xlsx'!Data.ContactClients=$L$1,ROW('Client Contact Database.xlsx'!Data.ContactClients)-1),ROW(1:1)),1))}\n</code></pre>\n\n<p>Although very sloppy, this works fine. However, I now need to add option buttons to toggle between searching for two different things. This means I have to replace the array formula from A3:L104 through VBA. My question is twofold:</p>\n\n<ol>\n<li><p>How can I shorten this formula to under 255 chars to use with .FormulaArray? I tried putting it in two halves but my understanding of syntax is not sufficient.</p></li>\n<li><p>Even if I got that to work, I imagine it would be extremely slow and inefficient. Is there a better way to go about this task?</p></li>\n</ol>\n\n<p>Any help is greatly appreciated, I'm in way over my head with this. Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1436970282, "post_id": 31432746, "comment_id": 50836622, "body": "Can you list all of the other events on that form that runs code?  Such as AfterUpdate, OnCurrent, etc."}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1436971967, "post_id": 31432746, "comment_id": 50837906, "body": "I have commented out all the code for all the other events (OnUpdate was the only one having code).  So when I run this, the OnChange is pretty much the only event that has any code running."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1436972754, "post_id": 31432746, "comment_id": 50838455, "body": "What about the events for <code>myForm</code>?"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1436977525, "post_id": 31432746, "comment_id": 50841760, "body": "What is <code>theCurrentPrimaryKeyValueForTheValueIn_MyCombo</code>? Is it meant to be a control, a function? Is it different to <code>Me.myCombo</code>?"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1436977896, "post_id": 31432746, "comment_id": 50841984, "body": "Also, if you want to delete a particular record in your subform, why not use a button with that delete procedure and do away with the combo box and its OnChange event altogether?"}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437182307, "post_id": 31432746, "comment_id": 50938125, "body": "Sorry guys, I was a bit sick for a couple of days.  So here&#39;s the answers:  Newd: There area a couple of statements related to the comboboxes in myForm itself (in the Load event), but nothing related to mySubform."}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437182326, "post_id": 31432746, "comment_id": 50938130, "body": "Matt Hall: theCurrentPrimaryKeyValueforTheValueIn_Mycombo is just my description of what the primary key would be for the current row in the subform.  I did not include the original code for the sake of simplicity.  The other way that I could demonstrate it is as: strSql = &quot;DELETE FROM mySubformRecordSource WHERE PrimaryKeyColumn= &quot; &amp; [PrimaryKeyColumn]"}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437182338, "post_id": 31432746, "comment_id": 50938133, "body": "Matt Hall: Your second question:  My end users will be modifying the content of the comboboxes.  They might just try deleting stuff, and I dont want the program to crash when they do so, instead, I want the code do what they are intending, which is deleting a row."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437187615, "post_id": 31436215, "comment_id": 50938937, "body": "I actually created a public function in the parent form to be called from the subform On_Change event, and got the same error (3162) when that function was called."}, {"owner": {"reputation": 987, "user_id": 781933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi9qK.jpg?s=128&g=1", "display_name": "rfb", "link": "https://stackoverflow.com/users/781933/rfb"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437291999, "post_id": 31436215, "comment_id": 50961433, "body": "It&#39;s not the correct way because you are imposing synchronous execution an the case is similar to the original where you manage only the requery from subForm.  You should raise a custom event from child caught from parent that executes your code. This is the best pattern in my opinion because you are not breaking the parent-child/one-to-many logic, assuming parent has more decision power than child. I can give you code snippet if you need it."}, {"owner": {"reputation": 987, "user_id": 781933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi9qK.jpg?s=128&g=1", "display_name": "rfb", "link": "https://stackoverflow.com/users/781933/rfb"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437292085, "post_id": 31436215, "comment_id": 50961452, "body": "Try also calling <code>requery</code> of subForm from parentForm. It should be ok"}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437323438, "post_id": 31436215, "comment_id": 50969586, "body": "Would appreciate if you give me the code snippet.  Even though my form and subform work right now (with the me.dirty explained above), your solution sounds more elegant, and curious to learn about it."}, {"owner": {"reputation": 987, "user_id": 781933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi9qK.jpg?s=128&g=1", "display_name": "rfb", "link": "https://stackoverflow.com/users/781933/rfb"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1437722646, "post_id": 31436215, "comment_id": 51159502, "body": "@Kambiz The pattern that i suggested deals with the potential source of &quot;notification conflict&quot;, when parent is informed on a change of child, the deletion of a record that, actually, is correctly treated by parent showing &quot;#DELETED&quot;. There are no conflicts indeed but only a difficulty to manage user interface updates. In the suggested pattern the notification is managed manually, not regarding recordset changes, that is postponed. There is only one observer, removing timing and conflict issues. The child form could, even, have read only setting on his recordsource."}], "tags": [], "owner": {"reputation": 987, "user_id": 781933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi9qK.jpg?s=128&g=1", "display_name": "rfb", "link": "https://stackoverflow.com/users/781933/rfb"}, "is_accepted": false, "score": 1, "last_activity_date": 1437406994, "last_edit_date": 1437406994, "creation_date": 1436978422, "answer_id": 31436215, "question_id": 31432746, "link": "https://stackoverflow.com/questions/31432746/how-to-update-a-subform-after-performing-a-delete-query/31436215#31436215", "title": "How to update a subform after performing a DELETE query?", "body": "<p>Not entering on the choices of used cursors etc I think that the solution could be simply \"requery\" the parent form called by the code of the subform.</p>\n\n<p>But i also have found similar situation in past projects that i made (sorry not beeing exaustive, i'm not using VBA anymore) and the requery command was done on subform but from the main form code, something like this:</p>\n\n<pre><code>If local_procedures.deleteContratto(anagrafica_id_par, servizio_id_par) = OK Then\n    Me.subfrm_contratti_frm_anagrafica.Requery\n    ...\n</code></pre>\n\n<p>In this case you could delegate parent form to call delete procedure and update logic (<code>.Requery</code>) of the child form, by mean of an event raised from subForm listen on parent for example.</p>\n\n<p>For the sake of completeness i started hinting about cursors because i think it's the underlying reason for these kind of sync failures between recordsets, the parent form one and the child form one.\nThere are many advices about using <code>dbSeeChanges</code> with <code>db.Execute</code> on SQL Server backend and the resulting default cursors. </p>\n\n<hr>\n\n<h2>UPDATE</h2>\n\n<p>Here's a code snippet where a custom event is raised from child to be caught from parent that is delegated to execute code regarding the child. </p>\n\n<p>This pattern doesn't break the parent-child/one-to-many logic, assuming parent has more decision power than child. </p>\n\n<pre><code>' in mySubform\n' assuming theCurrentPrimaryKeyValueForTheValueIn_MyCombo is a Long ID\nPublic Event DeleteRequest(record_ID As Long)\n\nPrivate Sub myCombo_Change()\n    If IsNull(Me.myCombo.Text) Or Me.myCombo.Text = vbNullString Then\n        RaiseEvent DeleteRequest(theCurrentPrimaryKeyValueForTheValueIn_MyCombo)   \n    End If\nEnd Sub\n\n' in myForm\nPrivate WithEvents frmMySubform As Form__mySubform\n' you could have more instances of mySubform concerning different issues or subrecords and manage each one correctly ...\nPrivate WithEvents frmMySubform2nd As Form__mySubform\n\nPrivate Sub frmMySubform_DeleteRequest(record_ID As Long)\n\n    Dim strSql As String\n    strSql = \"DELETE FROM mySubformRecordSource WHERE PrimaryKeyColumn= \" &amp; record_ID\n    CurrentDb.Execute strSql\n\n    With Me.frmMySubform.Form\n        .Requery\n        ' ...\n    end With \n\nEnd Sub\n\nPrivate Sub frmMySubform2nd_DeleteRequest(record_ID As Long)\n\n    Dim strSql As String\n    strSql = \"DELETE FROM my2ndSubformRecordSource WHERE PrimaryKeyColumn= \" &amp; record_ID\n    CurrentDb.Execute strSql\n\n    With Me.frmMySubform2nd.Form\n        .Requery\n        ' ...\n    end With    \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 781933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi9qK.jpg?s=128&g=1", "display_name": "rfb", "link": "https://stackoverflow.com/users/781933/rfb"}, "edited": false, "score": 0, "creation_date": 1437722346, "post_id": 31494746, "comment_id": 51159341, "body": "The workaround issues change notifications regarding two observers that arise on child recordset change. The two observers of the notification are child form and parent form.   The <code>Me.Dirty</code> workaround switchs off the notification of child recordset change and postpone the user interface updates with the manual <code>Me.Requery</code> call.   See also new comment on my answer."}], "tags": [], "owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "is_accepted": false, "score": 1, "last_activity_date": 1437247386, "last_edit_date": 1495541649, "creation_date": 1437247386, "answer_id": 31494746, "question_id": 31432746, "link": "https://stackoverflow.com/questions/31432746/how-to-update-a-subform-after-performing-a-delete-query/31494746#31494746", "title": "How to update a subform after performing a DELETE query?", "body": "<p>I solved the problem by putting Me.Dirty = False after reading this discussion:\n<a href=\"https://stackoverflow.com/questions/13993301/editing-record-issues-in-access-sql-write-conflict\">Editing Record issues in Access / SQL (Write Conflict)</a></p>\n\n<pre><code>Private Sub myCombo_Change()\nIf IsNull(Me.myCombo.Text) Or Me.myCombo.Text = vbNullString Then\n    Me.Dirty = False\n    Dim strSql As String\n    strSql = \"DELETE FROM mySubformRecordSource WHERE PrimaryKeyColumn= \" &amp; theCurrentPrimaryKeyValueForTheValueIn_MyCombo\n    CurrentDb.Execute strSql\n    Me.Requery        \nEnd If\nEnd Sub\n</code></pre>\n\n<p>The form and subform work flawlessly now, but I still dont quite understand the complete logic behind the solution.  It has something to do with Me.Dirty=False saving the changes to the content of a non-nullable (or nullable, both work fine) column before programmatically delete the entire record.  How exactly though, I dont know and will appreciate input.</p>\n"}], "owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1994, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1437406994, "creation_date": 1436969233, "last_edit_date": 1436971874, "question_id": 31432746, "link": "https://stackoverflow.com/questions/31432746/how-to-update-a-subform-after-performing-a-delete-query", "title": "How to update a subform after performing a DELETE query?", "body": "<p>I have a form, myForm, that includes a subform, <code>mySubform</code>. The records in <code>mySubform</code> have a many to one relationship with the record source of the <code>myForm</code>, as expected, and There is a combobox in <code>mySubform</code>, <code>myCombo</code>, whose values is linked to one of the columns of the record source of <code>mySubform</code>.  </p>\n\n<p>I have been having difficulty to delete a record in <code>mySubform</code>, by erasing the current value in <code>myCombo</code>.  I have put the code below under the <code>OnChange</code> event of <code>myCombo</code> (after trying many different alternatives).  </p>\n\n<p>Please not that I have simplified the delete query and the actual one works fine in the back-end (SQL Server).  However, after performing the delete operation, I get this error when the execution reaches <code>Me.Requery</code>:</p>\n\n<blockquote>\n  <p>Error 3162 You tried to assign a Null value to a variable that is not a Variant data type. </p>\n</blockquote>\n\n<p>Also, after having the degugger skip the <code>Me.Requery</code> and going back to the form, the deleted record shows \"#DELETED\" in every combobox and textbox for that particular record, and <code>mySubform</code> is not any good beyond that point. </p>\n\n<p>I have looked up very many resources and tried different statements instead of Me.Requery, but none has worked so far.  Help is much appreciated.</p>\n\n<pre><code>Private Sub myCombo_Change()\nIf IsNull(Me.myCombo.Text) Or Me.myCombo.Text = vbNullString Then\n    Dim strSql As String\n    strSql = \"DELETE FROM mySubformRecordSource WHERE PrimaryKeyColumn= \" &amp; theCurrentPrimaryKeyValueForTheValueIn_MyCombo\n    CurrentDb.Execute strSql\n    Me.Requery        \nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436968492, "post_id": 31432343, "comment_id": 50835198, "body": "I&#39;m going to guess that since you&#39;re setting the value of <code>ActiveCell</code>, and moving the cursor <i>while</i> doing it, you&#39;re going to get inconsistent results, at best. <b>However</b>, that&#39;s just a guess since you haven&#39;t told us what&#39;s wrong - is this just some kind of test to see if &quot;we&quot; know what we&#39;re talking about? If you&#39;re getting a specific error, edit your post to include it, please."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "edited": false, "score": 0, "creation_date": 1436972372, "post_id": 31432975, "comment_id": 50838184, "body": "This helps, but appears to add the total rows in that column to the anchor row number.  That means it is creating a large range and referencing that in the formula, whereas i want to look up the contiguous block and select that as a range."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436973120, "post_id": 31432975, "comment_id": 50838720, "body": "I think you&#39;d be better served by A) identifying your rows before you attempt to set the formula, then create the formula with those specific values, and B) <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>ActiveCell</code></a>."}, {"owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "edited": false, "score": 0, "creation_date": 1436974412, "post_id": 31432975, "comment_id": 50839631, "body": "defeats the whole purpose; the top cell in the column will be varying length from the last cell."}, {"owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "edited": false, "score": 0, "creation_date": 1436976308, "post_id": 31432975, "comment_id": 50841014, "body": "Jeeped, I actually want to sum from the top of the column down through two rows above the active cell."}, {"owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "edited": false, "score": 0, "creation_date": 1436978539, "post_id": 31432975, "comment_id": 50842341, "body": "@Jeeped - thanks!  That works great on the first instance.  I then have two empty rows, and another contiguous column of data, and need to repeat the process.  Problem is, the above code now has a static reference to the second row, rather than a dynamic CTRL + UP type reference to select the top cell in this next range.  This same pattern repeats for about 10 groups. Thoughts?"}, {"owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "edited": false, "score": 0, "creation_date": 1436981414, "post_id": 31432975, "comment_id": 50844074, "body": "@Jeeped...    ActiveCell.FormulaR1C1 = &quot;=SUM(R[-2]C:R&quot; &amp; Selection.End(xlUp).End(xlUp).Row &amp; &quot;C)&quot;  Needed that double End(xlUp) to push pass the bottom cell and up into the end of the range.  Appreciate your help"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1436977264, "last_edit_date": 1436977264, "creation_date": 1436969836, "answer_id": 31432975, "question_id": 31432343, "link": "https://stackoverflow.com/questions/31432343/what-is-wrong-with-line-2/31432975#31432975", "title": "What is wrong with line 2?", "body": "<p>First, you are trying to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839539.aspx\" rel=\"nofollow\">Range.End property</a> without telling <code>.End</code> what it is the end of.</p>\n\n<pre><code>With ActiveCell\n    .FormulaR1C1 = \"=SUM(R[\" &amp; .Parent.Cells(Rows.Count, .Column).End(xlUp).Row &amp; \"]C:R[-2]C)\"\nEnd With\n</code></pre>\n\n<p>Secondly, that formula is almost always going to be a circular reference since you want to total from two rows above the active cell (in the same column) to the last populated row in the same column. That sounds like it will include the cell itself which is a circular reference.</p>\n\n<p>To sum from the second row (in the active cell's column) to two rows above the active cell then this would be appropriate.</p>\n\n<pre><code>With ActiveCell\n    if .row &gt; 3 then\n        .FormulaR1C1 = \"=SUM(R2C:R\" &amp; .row - 2 &amp; \"C)\"\n    end if\nEnd With\n</code></pre>\n\n<p>If you needed this to start at the first row then the formula would begin with <code>\"=SUM(R1C:R\" &amp; ...</code> .</p>\n"}], "owner": {"reputation": 3, "user_id": 5119493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8c6d16aba114e0a4a1cd86aa9add518?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Quigley", "link": "https://stackoverflow.com/users/5119493/jon-quigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 31432975, "answer_count": 1, "score": 0, "last_activity_date": 1436977264, "creation_date": 1436968288, "last_edit_date": 1531164843, "question_id": 31432343, "link": "https://stackoverflow.com/questions/31432343/what-is-wrong-with-line-2", "title": "What is wrong with line 2?", "body": "<pre><code>ActiveCell.Offset(1, -1).Range(\"A1\").Select\nActiveCell.FormulaR1C1 = \"=SUM(R[\" &amp; End(xlUp).Row &amp; \"]C:R[-2]C)\"\n</code></pre>\n\n<p>I'm attempting to sum a range which will vary in length, and starts 2 rows above where I'm inserting this formula.</p>\n\n<p>I'm getting a \"Compile Error:Syntax Error\" message when i attempt to run.</p>\n"}, {"tags": ["excel", "vba", "csv", "excel-2010"], "comments": [{"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 1, "creation_date": 1436969749, "post_id": 31432329, "comment_id": 50836189, "body": "Have you tried to record a macro while importing the file to get the proper syntax?  Developer Tab-&gt;Code-&gt;Record Macro-&gt;Data Tab-&gt; Get External Data-&gt;From Text ---&gt;Fill in  Import file wizard ---  Developer Tab-&gt;Code-&gt;Stop Recording"}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436972135, "post_id": 31432965, "comment_id": 50838008, "body": "thanks for the function! When I compile it, however, I get the error message &quot;Compile error: Method or data member not found&quot;. The line in question:"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436972139, "post_id": 31432965, "comment_id": 50838011, "body": "Set WsDest = Wb.Worksheets.Add"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436972709, "post_id": 31432965, "comment_id": 50838424, "body": "My bad, it must be <code>Set WsDest = Wb.Sheets.Add</code>"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436980271, "post_id": 31432965, "comment_id": 50843392, "body": "then I get the error: &quot;Compile error: method / data member not found&quot; on line &quot;Set WsDest.Wb.Sheets.Add&quot;."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1437031674, "last_edit_date": 1437031674, "creation_date": 1436969817, "answer_id": 31432965, "question_id": 31432329, "link": "https://stackoverflow.com/questions/31432329/how-to-import-csv-excel-data-to-be-cell-separated-using-vba-excel-2010-msofiledi/31432965#31432965", "title": "How to import CSV Excel data to be cell separated using VBA Excel 2010 msoFileDialogOpen", "body": "<p>This would be one way to go :</p>\n\n<pre><code>Public Sub Function4_FileExplorer()\nDim File As String, _\n    Wb As Workbook, _\n    Ws As Worksheet, _\n    WsDest As Worksheet\n\n'   Start File Explorer to select file containing data (simple GUI, much easier than coding vFileName)\nOn Error GoTo ErrorHandler\nWith Application.FileDialog(msoFileDialogOpen)\n    .AllowMultiSelect = False\n    If .Show Then\n        File = .SelectedItems(1)\n        Set Wb = Workbooks.Open(File) ' there used to be Path.Open here but that doesn't work (since Path is a string)\n    End If\nEnd With\n\nSet Ws = Wb.ActiveSheet\n'Or\n'Set Ws = Wb.Sheets(\"Sheet_Name_Here\")\n\nWs.Copy After:=Wb.Sheets(Wb.Sheets.Count)\nSet WsDest = Wb.ActiveSheet\n\n    WsDest.Range(\"A1:A\" &amp; WsDest.Range(\"A\" &amp; WsDest.Rows.Count).End(xlUp).Row).TextToColumns _\n            Destination:=WsDest.Range(\"AA1\"), _\n            DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, _\n            ConsecutiveDelimiter:=False, _\n            Tab:=False, _\n            Semicolon:=False, _\n            Comma:=True, _\n            Space:=False, _\n            Other:=False, _\n            FieldInfo:=Array(1, 1), _\n            TrailingMinusNumbers:=True\n\nWsDest.Range(\"AA1\").Activate\nGoTo SubCloser\nExit Sub\n\nErrorHandler:\nMsgBox \"Error detected\" &amp; vbNewLine &amp; \"Error\" &amp; Err.Number &amp; _\n       Err.Description, vbCritical, \"Error Handler: Error \" &amp; Err.Number\n\nSubCloser:\nSet Wb = Nothing\nSet Ws = Nothing\nSet WsDest = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 31432965, "answer_count": 1, "score": 0, "last_activity_date": 1437031674, "creation_date": 1436968240, "question_id": 31432329, "link": "https://stackoverflow.com/questions/31432329/how-to-import-csv-excel-data-to-be-cell-separated-using-vba-excel-2010-msofiledi", "title": "How to import CSV Excel data to be cell separated using VBA Excel 2010 msoFileDialogOpen", "body": "<p>I am trying to use msoFileDialogOpen in VBA (using Excel 2010) to import data from a file. The macro should make it delimited and separated by comma on import. Here is the macro:</p>\n\n<pre><code>Public Sub Function4_FileExplorer()\nDim file As String\n'   Start File Explorer to select file containing data (simple GUI, much easier than coding vFileName)\nOn Error GoTo ErrorHandler\nWith Application.FileDialog(msoFileDialogOpen)\n.AllowMultiSelect = False\nIf .Show Then\n    file = .SelectedItems(1)\n    Workbooks.Open file ' there used to be Path.Open here but that doesn't work (since Path is a string)\nEnd If\nEnd With\nErrorHandler:\nMsgBox \"Error detected\" &amp; vbNewLine &amp; \"Error\" &amp; Err.Number &amp; _\n       Err.Description, vbCritical, \"Error Handler: Error \" &amp; Err.Number\n\nEnd Sub\n</code></pre>\n\n<p>This demonstrates what the kind of files I am trying to separate, 1 value per cell (just Excel files, not in Notepad):</p>\n\n<p><a href=\"http://blogs.technet.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-76-18-metablogapi/2055.HSG09091001_5F00_71EB0EE6.jpg\" rel=\"nofollow\">http://blogs.technet.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-76-18-metablogapi/2055.HSG09091001_5F00_71EB0EE6.jpg</a></p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1187, "user_id": 651740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49d25a5b1991c87d2a194c220de1b00?s=128&d=identicon&r=PG", "display_name": "Marc Johnston", "link": "https://stackoverflow.com/users/651740/marc-johnston"}, "is_accepted": false, "score": 0, "last_activity_date": 1436968618, "creation_date": 1436968618, "answer_id": 31432474, "question_id": 31432322, "link": "https://stackoverflow.com/questions/31432322/simple-vb-print-function-taking-two-parameters/31432474#31432474", "title": "Simple VB Print Function Taking Two Parameters", "body": "<p>This built-in method comes really close.  You just have to provide the \"print\" action.</p>\n\n<pre><code>Strings.StrDup(count, text + vbCrLf)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 122, "user_id": 2572833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5d451e1920c5de4deb3e34b86b85bf50?s=128&d=identicon&r=PG", "display_name": "user2572833", "link": "https://stackoverflow.com/users/2572833/user2572833"}, "edited": false, "score": 1, "creation_date": 1436972838, "post_id": 31432853, "comment_id": 50838514, "body": "Thank you so much. This isn&#39;t exactly what I needed, but it put me on the right path, and I was able to edit your code to do what I needed."}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "reply_to_user": {"reputation": 122, "user_id": 2572833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5d451e1920c5de4deb3e34b86b85bf50?s=128&d=identicon&r=PG", "display_name": "user2572833", "link": "https://stackoverflow.com/users/2572833/user2572833"}, "edited": false, "score": 0, "creation_date": 1436972930, "post_id": 31432853, "comment_id": 50838579, "body": "Sorry, I couldn&#39;t give you what you needed. BUT at least you got to where you needed."}], "tags": [], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "is_accepted": false, "score": 1, "last_activity_date": 1436969536, "creation_date": 1436969536, "answer_id": 31432853, "question_id": 31432322, "link": "https://stackoverflow.com/questions/31432322/simple-vb-print-function-taking-two-parameters/31432853#31432853", "title": "Simple VB Print Function Taking Two Parameters", "body": "<p>Here is a basic function that should accomplish what you need</p>\n\n<pre><code>Public Function printNumofTimes(text As String, number As Integer)\n    for index = 1 to number                                 \n        Debug.Print text\n    Next index\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 122, "user_id": 2572833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5d451e1920c5de4deb3e34b86b85bf50?s=128&d=identicon&r=PG", "display_name": "user2572833", "link": "https://stackoverflow.com/users/2572833/user2572833"}, "is_accepted": true, "score": 2, "last_activity_date": 1436972993, "creation_date": 1436972993, "answer_id": 31434243, "question_id": 31432322, "link": "https://stackoverflow.com/questions/31432322/simple-vb-print-function-taking-two-parameters/31434243#31434243", "title": "Simple VB Print Function Taking Two Parameters", "body": "<p>@Constuntine had put me on the right path. The code I ended up using was:</p>\n\n<pre><code>Public Function printText(text As String, number As Integer)\n    dim index as integer\n    dim s as string = \"\"\n    for index = 0 to number\n      if index = number\n         s = s + text\n      else\n         s = s + text + VBCRLF\n      end if\n    Next index\n    return s\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 2572833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5d451e1920c5de4deb3e34b86b85bf50?s=128&d=identicon&r=PG", "display_name": "user2572833", "link": "https://stackoverflow.com/users/2572833/user2572833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 31434243, "answer_count": 3, "score": 1, "last_activity_date": 1436972993, "creation_date": 1436968223, "question_id": 31432322, "link": "https://stackoverflow.com/questions/31432322/simple-vb-print-function-taking-two-parameters", "title": "Simple VB Print Function Taking Two Parameters", "body": "<p>I'm looking for a function that will take two parameters (a string and an integer) and print the string on a new line for each count of the integer.</p>\n\n<p>For example, the parameters (\"test\", 2) would return:</p>\n\n<pre><code>test\ntest\n</code></pre>\n\n<p>I'm sure this is a simple bit of code, but I have never worked with VB before.</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 317, "user_id": 4927169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8984e70979ff8e62437366209f87b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Etheur", "link": "https://stackoverflow.com/users/4927169/etheur"}, "edited": false, "score": 1, "creation_date": 1436968323, "post_id": 31432092, "comment_id": 50835055, "body": "<code>Cells</code> refers to coordiantes (e.g. <code>Cells(1,2)</code> points to cell <code>A2</code>). Try using <code>Range(&quot;L1&quot;)</code> instead"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436970293, "post_id": 31432501, "comment_id": 50836632, "body": "If I wanted to check N1 as well would I do Range(&quot;L1 &amp; N1&quot;)?"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "reply_to_user": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436970428, "post_id": 31432501, "comment_id": 50836737, "body": "You could use <code>or</code> in between, so if either <code>L1</code> or <code>N1</code> returned <code>#VALUE!</code> it would refresh. so <code>If IsError(Range(&quot;L1&quot;)) or IsError(Range(&quot;N1&quot;)) Then</code>"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 1, "creation_date": 1436970809, "post_id": 31432501, "comment_id": 50837022, "body": "Perfection. Thank you so much Constuntine"}], "tags": [], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "is_accepted": true, "score": 1, "last_activity_date": 1436968677, "creation_date": 1436968677, "answer_id": 31432501, "question_id": 31432092, "link": "https://stackoverflow.com/questions/31432092/macro-to-redo-previous-step-if-value-appears/31432501#31432501", "title": "Macro to redo previous step if #VALUE! appears", "body": "<p>Try using <code>IsError()</code> to check for the <code>#VALUE!</code> error.</p>\n\n<pre><code>If IsError(Range(\"L1\")) Then\n    Application.CalculateFullRebuild\n    Else\n    Call TimeStamp\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 31432501, "answer_count": 1, "score": 0, "last_activity_date": 1436968677, "creation_date": 1436967660, "question_id": 31432092, "link": "https://stackoverflow.com/questions/31432092/macro-to-redo-previous-step-if-value-appears", "title": "Macro to redo previous step if #VALUE! appears", "body": "<p>The following macro code I thought would do the above part but it says that the 3rd line isn't a valid line. I am not quite sure what it would have to be to make it work. It is suppose to refresh the workbook which line 2 does. then look to see if L1 (and N1 if that is possible) brought back a value that is equal to #Value!. If it did then refresh, if not then call TimeStamp.</p>\n\n<pre><code>Sub Refresh()\n    Application.CalculateFullRebuild\n    If Cells(\"L1\").Value = \"#Value!\" Then\n        Application.CalculateFullRebuild\n        Else\n        Call TimeStamp\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437107359, "post_id": 31431973, "comment_id": 50902743, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436968714, "post_id": 31432303, "comment_id": 50835373, "body": "If this has answered your question please mark it as answered (greyed out tick to the left of answer)"}, {"owner": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "edited": false, "score": 0, "creation_date": 1436969304, "post_id": 31432303, "comment_id": 50835858, "body": "I responded higher, couldnt press shift or enter here hehe"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "edited": false, "score": 0, "creation_date": 1436970882, "post_id": 31432303, "comment_id": 50837078, "body": "the sum line is referencing the sheets sum function and putting the range of B2:B152 through the sum this is then added to consolidated. the message box is purely to show the sum after it can be removed when you implement the solution"}, {"owner": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "edited": false, "score": 0, "creation_date": 1436986711, "post_id": 31432303, "comment_id": 50847168, "body": "Yes I will thick it ! Just : Ok the code is working (No compile errors) but how do I tell Vba that I want to insert this results in my sheet called Consolidated in Cells ranging from B2 to B152. Because nothing is happening right now! Thanks for your time"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "edited": false, "score": 0, "creation_date": 1437036393, "post_id": 31432303, "comment_id": 50866768, "body": "Im a bit confused. Consolidated is the sheet you want the sum to appear? The sum is only 1 value and you want that value copied over B2:B152? What range do you want sumed up on the &quot;E2016&quot; sheets? Or have I completly missed this?"}, {"owner": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "edited": false, "score": 0, "creation_date": 1437984681, "post_id": 31432303, "comment_id": 51241731, "body": "Sorry ! Didnt see you answered !! Thanks for your help thats the code that I finally found in order for you to understand :"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 1, "last_activity_date": 1436968176, "creation_date": 1436968176, "answer_id": 31432303, "question_id": 31431973, "link": "https://stackoverflow.com/questions/31431973/vba-sum-between-special-sheets/31432303#31432303", "title": "VBA Sum between Special Sheets", "body": "<p>Some thing like below?</p>\n\n<pre><code>Private Sub Consolidated_Income_Statement()\nDim Sheet As Worksheet\nDim Consolidated As Integer\nFor Each Sheet In Sheets\n    If Right(Sheet.Name, 5) = \"E2016\" Then\n        Consolidated = Consolidated + Application.WorksheetFunction.Sum(Sheet.Range(\"B2:B152\"))\n    End If\nNext\n\nMsgBox \"Sum is : \" &amp; Consolidated\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5119623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfaf5eda58142caaedd59823e2dd510?s=128&d=identicon&r=PG&f=1", "display_name": "Eraa Nova", "link": "https://stackoverflow.com/users/5119623/eraa-nova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 31432303, "answer_count": 1, "score": 2, "last_activity_date": 1437107355, "creation_date": 1436967399, "last_edit_date": 1437107355, "question_id": 31431973, "link": "https://stackoverflow.com/questions/31431973/vba-sum-between-special-sheets", "title": "VBA Sum between Special Sheets", "body": "<p>Hope you are all doing well. Im here because of a question Im trying to solve since this morning and I CANT stand it anymore.\nThat is the context : I have an excel workbook in which I have different sheets containing different business plans for different countries. My goal is to make a consolidated Income statement with the sum of the criteria (COGS, Net profit, Salaries....) in each sell.</p>\n\n<p>Each cell in the A column corresponds to a criterion and I want the numbers to appear in the B column (Total of all companies for each criterion).</p>\n\n<p>Thats my code : Initially it wasnt like this but thats one of my attempting drafts let me explain below why Im trying this format</p>\n\n<pre><code>Private Sub Consolidated_Income_Statement()\nDim Sheet As Worksheet\nDim Consolidated As Worksheet\n\nFor Each Sheet In Sheets\n    Do While Cells(B2, B152) &lt;&gt; \"\"\n    Consolidated = Sum(Call BPs, B152)\n    GoTo Consolidated\nNext\nEnd Sub\n\nSub BPs()\nDim Sheet As Worksheet\nFor Each Sheet In Sheets\n    If Right(Sheet.Name, 50) = \"E2016\" Then\nEnd Sub\n</code></pre>\n\n<p>The fact is that I want to sum the cells only of the sheets containing \"E2016\" and Im trying to create a call button to use it my private sub once I have determined that I only want these E2016 sheets.</p>\n\n<p>And thats how I tried to do it initially </p>\n\n<pre><code>Private Sub Consolidated_Income_Statement()\nDim Sheet As Worksheet\nDim Consolidated As Worksheet\nFor Each Sheet In Sheets\n    If Right(Sheet.Name, 50) = \"E2016\" Then\n        Do While Cells(B2, B152) &lt;&gt; \"\"\n        Consolidated = Sum('I WANT TO SELECT MY E2016, B152)\n        GoTo Consolidated\n        Next\nEnd Sub\n</code></pre>\n\n<p>But nothing is working ! Sorry if these questions are too basic but Im learning VBA on my own for my company since 2 days and Im facing a couple of difficulties ! Thank you very much for your help ! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436968262, "post_id": 31431891, "comment_id": 50835002, "body": "what value is in the cell? and is it on the first worksheet in cells(11,4)?"}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436968367, "post_id": 31431891, "comment_id": 50835083, "body": "It has 01/02/15   and I am trying to make it  15/01/02"}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436968399, "post_id": 31431891, "comment_id": 50835115, "body": "its always 8 characters in the cell if that helps"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436970328, "post_id": 31432412, "comment_id": 50836663, "body": "Hi I tried this but it gives me an error (type mismatch) on  d =DateValue(s)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436970834, "post_id": 31432412, "comment_id": 50837041, "body": "@Dean  Are you sure the cell contain stuff like <i>12/25/15</i> with <b>no additional spaces</b> ??"}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436971089, "post_id": 31432412, "comment_id": 50837236, "body": "yes, and I m just wondering is there a way to do it as a string and just change the order within the cell?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436971628, "post_id": 31432412, "comment_id": 50837647, "body": "@Dean  To do this with strings only, see my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1436971593, "last_edit_date": 1436971593, "creation_date": 1436968478, "answer_id": 31432412, "question_id": 31431891, "link": "https://stackoverflow.com/questions/31431891/how-to-change-mm-dd-yy-to-yy-mm-dd-in-vba-i-can-change-the-format-but-it-doesn/31432412#31432412", "title": "how to change mm/dd/yy to yy/mm/dd in vba, I can change the format but it doesn&#39;t change the value of the cell", "body": "<p>If you change the format of a cell and the displayed value does not respond, then the value is <em>Text</em> rather than a true <em>Date</em>.  To fix this:</p>\n\n<pre><code>Sub dural()\n    Dim s As String, d As Date\n    With ThisWorkbook.Worksheets(1).Cells(11, 4)\n        s = .Text\n        d = DateValue(s)\n        .Clear\n        .Value = d\n        .NumberFormat = \"yy/mm/dd\"\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To do this with pure strings:</p>\n\n<pre><code>Sub dural2()\n    Dim s As String\n    With ThisWorkbook.Worksheets(1).Cells(11, 4)\n        s = Trim(.Text)\n        ary = Split(s, \"/\")\n        .NumberFormat = \"@\"\n        .Value = ary(2) &amp; \"/\" &amp; ary(0) &amp; \"/\" &amp; ary(1)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 31432412, "answer_count": 1, "score": 0, "last_activity_date": 1436971593, "creation_date": 1436967188, "last_edit_date": 1531164843, "question_id": 31431891, "link": "https://stackoverflow.com/questions/31431891/how-to-change-mm-dd-yy-to-yy-mm-dd-in-vba-i-can-change-the-format-but-it-doesn", "title": "how to change mm/dd/yy to yy/mm/dd in vba, I can change the format but it doesn&#39;t change the value of the cell", "body": "<p>I have cells that have dates in the format mm/dd/yy, how can I change the cell to yy/mm/dd in vba, I tried using <code>ThisWorkbook.Worksheets(1).Cells(11, 4).NumberFormat = \"yy/mm/dd\"</code> but it doesn't change the value of the cell.</p>\n"}, {"tags": ["excel", "ribbon", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7441033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4b34a30cab516ff17593c7b2289a10?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Cesar Oliveira", "link": "https://stackoverflow.com/users/7441033/alan-cesar-oliveira"}, "is_accepted": true, "score": 1, "last_activity_date": 1504148170, "creation_date": 1504148170, "answer_id": 45972518, "question_id": 31431494, "link": "https://stackoverflow.com/questions/31431494/vba-custom-ribbon-tabs-in-ms-excel-add-in/45972518#45972518", "title": "VBA - Custom Ribbon Tabs in MS Excel add-in", "body": "<p>You can simply enable/disable the company's add-ins, using:</p>\n\n<pre><code>Application.AddIns(\"name of the add in here\").Installed = False\n</code></pre>\n\n<p>Of course, considering you know the other add-in names.</p>\n"}], "owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 45972518, "answer_count": 1, "score": 2, "last_activity_date": 1504148170, "creation_date": 1436966196, "last_edit_date": 1531164843, "question_id": 31431494, "link": "https://stackoverflow.com/questions/31431494/vba-custom-ribbon-tabs-in-ms-excel-add-in", "title": "VBA - Custom Ribbon Tabs in MS Excel add-in", "body": "<p>I develop, for our department, an MS Excel add-in that includes a custom ribbon tabs that shows up when user lunch the add-in and hide some MS Excel tabs that we do not needs.\nThis custom ribbon   includes a quit function to unload the add-in.\nThe problem is that the company does provide some add-in with custom tab.</p>\n\n<p>I would like to know, how I can hide temporary their custom tab and show them when the user quit out add-in.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1436965949, "post_id": 31431150, "comment_id": 50833119, "body": "Serious question, can you explain why the &quot;direction&quot; of the loop could have missed things the way it was. For my own knowledge please."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 3, "creation_date": 1436966423, "post_id": 31431150, "comment_id": 50833474, "body": "If you go from <code>0 to Something.Count</code>, and delete items, you&#39;ll have an &quot;out of range&quot; error because there&#39;ll be lesser and lesser items during your loop. In the opposite direction, you&#39;ll go from <code>Something.Count to 0</code> and avoid that kind of issue! ;) (same problems with sheets, workbooks, charts, shapes, ...)"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1436966498, "post_id": 31431150, "comment_id": 50833532, "body": "Makes perfect sense once you said it.  Thank you."}, {"owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "edited": false, "score": 0, "creation_date": 1436967161, "post_id": 31431150, "comment_id": 50834058, "body": "I received the compiling error: Method or data member not found for .item :(. I am using ms 2010 if that changes anything"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1436967907, "post_id": 31431150, "comment_id": 50834719, "body": "My bad, I think it is <code>.List</code> for Comboboxes and not <code>.Item</code>, give it a try"}, {"owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "edited": false, "score": 1, "creation_date": 1436968190, "post_id": 31431150, "comment_id": 50834954, "body": "Beautiful. Thank you!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1436968478, "post_id": 31431150, "comment_id": 50835186, "body": "Glad I could help! ;) So just 2 quick pointers for that site : once your problem is solved, you can accept an answer (tick right under up/down votes, that&#39;ll become green) to mark your question as answered. And use the up/down votes when you find something useful or not (question or answer)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 3, "last_activity_date": 1436967955, "last_edit_date": 1436967955, "creation_date": 1436965259, "answer_id": 31431150, "question_id": 31430990, "link": "https://stackoverflow.com/questions/31430990/trying-to-remove-specific-items-from-an-already-populated-combobox-vba/31431150#31431150", "title": "Trying to remove specific items from an already populated Combobox VBA", "body": "<p>You just need to <code>.List(i)</code> when you test the values stored into the ComboBox.</p>\n\n<p>Also I changed the \"direction\" <em>(see second comment for details)</em> of the second loop to avoid missing items.</p>\n\n<p>Here is you revised code :</p>\n\n<pre><code>lcomboCount = Sheets(pt).PivotTables(\"PivotTable1\").TableRange2.Rows.Count\nFor i = 1 To lcomboCount\n    datapoint = Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"combo\").LabelRange.Offset(i, 0).Value\n    UserForm1.ComboBox.AddItem datapoint\nNext i\nFor i = Me.ComboBox.ListCount - 1 To 0 Step -1\n    If Me.ComboBox.List(i) = \"\" Or Me.ComboBox.List(i) = \"Grand Total\" Or Me.ComboBox.List(i) = (\"(blank)\") Then\n        Me.ComboBox.RemoveItem (i)\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4054, "favorite_count": 0, "accepted_answer_id": 31431150, "answer_count": 1, "score": 2, "last_activity_date": 1436967955, "creation_date": 1436964832, "last_edit_date": 1436965336, "question_id": 31430990, "link": "https://stackoverflow.com/questions/31430990/trying-to-remove-specific-items-from-an-already-populated-combobox-vba", "title": "Trying to remove specific items from an already populated Combobox VBA", "body": "<p>In VBA I am writing a code that gathers information based off an initial input in a userform. </p>\n\n<p>From the initial entrance point I want the code to go out and find the corresponding data and add it. I have that all working well. </p>\n\n<p>But I am gathering the data from a pivot table and if the <strong>pivot table is open it returns \"\" spaces, \"(blank)\" and \"Grand Total\", which I want to get rid of</strong>. </p>\n\n<p>My Current code is:</p>\n\n<pre><code>lcomboCount = Sheets(pt).PivotTables(\"Pivottable1\").TableRange2.Rows.Count\nFor i = 1 To lcomboCount\ndatapoint = Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"combo\").LabelRange.Offset(i, 0).Value\nUserForm1.ComboBox.AddItem Sheets(pt).PivotTables(\"PivotTable1\").PivotFields(\"combo\").LabelRange.Offset(i, 0)\nNext i\nFor i = 0 To Me.ComboBox.ListCount - 1\nIf Me.ComboBox = \"\" Or Me.ComboBox = \"Grand Total\" Or Me.ComboBox = (\"(blank)\") Then\n    Me.ComboBox.RemoveItem (i)\nEnd If\nNext i\n</code></pre>\n\n<p>I had a <code>Msgbox</code> in there at one point to see if my values were reading correctly and they were. </p>\n"}, {"tags": ["excel", "vba", "variables", "controls"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5119395, "user_type": "registered", "profile_image": "https://graph.facebook.com/838036592954758/picture?type=large", "display_name": "B&#246;ser Hase", "link": "https://stackoverflow.com/users/5119395/b%c3%b6ser-hase"}, "edited": false, "score": 0, "creation_date": 1436966097, "post_id": 31430999, "comment_id": 50833239, "body": "doesn&#39;t work cause it can&#39;t handle: <code>If ToggleButton1.Value = True Then</code>"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 1, "user_id": 5119395, "user_type": "registered", "profile_image": "https://graph.facebook.com/838036592954758/picture?type=large", "display_name": "B&#246;ser Hase", "link": "https://stackoverflow.com/users/5119395/b%c3%b6ser-hase"}, "edited": false, "score": 0, "creation_date": 1436966884, "post_id": 31430999, "comment_id": 50833814, "body": "why doesnt it? try above just change chkCheckBox to the name of you controls minus the number of course"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1436966848, "last_edit_date": 1436966848, "creation_date": 1436964843, "answer_id": 31430999, "question_id": 31430734, "link": "https://stackoverflow.com/questions/31430734/using-a-variable-as-part-of-a-control-name-to-constantly-check-a-condition/31430999#31430999", "title": "Using a variable as part of a control name (to constantly check a condition)", "body": "<p>Try adapting this</p>\n\n<pre><code>For i As Integer = 1 To 12\n    cont = me.controls(\"chkCheckBox\" &amp; i)\n    if cont.value then\n        msgbox cont.name &amp; \" is TRUE\"\n    endif\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5119395, "user_type": "registered", "profile_image": "https://graph.facebook.com/838036592954758/picture?type=large", "display_name": "B&#246;ser Hase", "link": "https://stackoverflow.com/users/5119395/b%c3%b6ser-hase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436966848, "creation_date": 1436964191, "question_id": 31430734, "link": "https://stackoverflow.com/questions/31430734/using-a-variable-as-part-of-a-control-name-to-constantly-check-a-condition", "title": "Using a variable as part of a control name (to constantly check a condition)", "body": "<p>I am using toggle buttons that change color, caption and add / subtract to a counter. Since I will have to have a few of those buttons I'd rather habe a general function instead of having to change the script for each button.</p>\n\n<p>This is what I currently have:</p>\n\n<pre><code>Private Sub ToggleButton1_Click()\nIf ToggleButton1.Value = True Then\n    ToggleButton2.BackColor = RGB(0, 255, 0)\n    ToggleButton2.Caption = \"PASS\"\n    Range(\"A1\").Value = Range(\"A1\").Value + 1\n\n    If Range(\"A2\").Value &gt; \"0\" Then\n        Range(\"A2\").Value = Range(\"A2\").Value - 1\n    End If\n\n\n\nElse\n    ToggleButton1.BackColor = RGB(255, 0, 0)\n    ToggleButton1.Caption = \"FAIL\"\n    Range(\"A2\").Value = Range(\"A2\").Value + 1\n\n    If Range(\"A1\").Value &gt; \"0\" Then\n        Range(\"A1\").Value = Range(\"A1\").Value - 1\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>What I expect is something like:</p>\n\n<pre><code>For i = 1 to 100\n    If ToggleButton &amp; i.Value = True Then\n     ....\n</code></pre>\n\n<p>Or maybe even something like\nFor each togglebutton do blah</p>\n\n<p>So how do I use a variable in the control name? TIA</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1436964073, "post_id": 31430592, "comment_id": 50831637, "body": "What problem are you having? It&#39;s not clear from your question..."}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436964180, "post_id": 31430592, "comment_id": 50831707, "body": "im trying to write a macro so that once this barcode is scanned and the worksheet_change even is triggered, parsed, and the hyperlink is found, the hyperlink is automatically clicked. But I have having trouble getting this macro to work for me."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1436964377, "post_id": 31430592, "comment_id": 50831852, "body": "What behavior are you seeing? Is worksheet_change not being triggered? Can&#39;t figure out how to click the hyperlink? Getting errors? Just trying to figure out what question to answer. :-)"}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436964565, "post_id": 31430592, "comment_id": 50832007, "body": "No, all the code I posted is currently working. When I scan the barcode in the scan cell it automatically parses it and the hyperlink is identified in the H column to the right of the parse. However my attempts are adding code (like this Range(&quot;H3&quot;).Hyperlinks(1).Follow (True)) to either the textsplit sub or the worksheet change event have been unsuccessful leaving me with errors like &quot;Run -error &quot;9&quot; subscript out of range&quot;. Thank you so much for your time!"}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436964657, "post_id": 31430592, "comment_id": 50832087, "body": "So basically everything is working and I currently want to add in a macro to automatically click the sharepoint link after the barcode is scanned so that no actions or anything are necessary."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1436965039, "post_id": 31430592, "comment_id": 50832385, "body": "Cool. It would be helpful (and attract better answers) if you would edit your question to include your exact problem (getting the error when trying to follow the hyperlink), the code that is generating the error, with the location of the error in the code identified as closely as possible."}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436965365, "post_id": 31430592, "comment_id": 50832654, "body": "Thanks for the advice. I hope my post is a little clearer now."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 0, "creation_date": 1436966522, "post_id": 31431507, "comment_id": 50833551, "body": "When I tried to implement that change into my code I receive a &quot;Compile error: Type mismatch&quot; with the debug screen pointing to : <a href=\"http://imgur.com/5I2KJZN\" rel=\"nofollow noreferrer\">imgur.com/5I2KJZN</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 1, "creation_date": 1436967004, "post_id": 31431507, "comment_id": 50833916, "body": "My bad... there is actually no reason to keep it as a function, convert it to a regular sub like in the edit! ;)"}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 1, "creation_date": 1436967160, "post_id": 31431507, "comment_id": 50834057, "body": "Wow that worked absolutely beautifully. Your a saint, thank you so much!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 1, "creation_date": 1436967765, "post_id": 31431507, "comment_id": 50834585, "body": "Ahah! A saint, maybe not, but I do love to see that I helped! ;) Enjoy and see you someday on the site!"}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 0, "creation_date": 1436967863, "post_id": 31431507, "comment_id": 50834680, "body": "One more thing if you could help. That worked perfectly, however now if I save the document with a couple barcodes scanned in, close it, and re-open it, it triggers the macros and opens several on my browser. Any way of tweaking this code so that it does not trigger on opening of the file?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 1, "creation_date": 1436968347, "post_id": 31431507, "comment_id": 50835069, "body": "Easiest way I can think of would be to declare a <code>Public Boolean</code> and set it to <b>False</b> in <code>Workbook_Open</code> and test it into <code>Worksheet_Change</code> to <code>Exit Sub</code> if it is set to False, and also reset it to <b>True</b> in <code>Workbook_Activate</code>. That might be enough. And btw, as your are working with <b>Objects variables, don&#39;t forget to free them</b> once they are used : <code>Set KeyCells = Nothing</code>"}, {"owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 0, "creation_date": 1436970197, "post_id": 31431507, "comment_id": 50836558, "body": "Im no quite sure what you mean by delcaring a Public Boolean or really the rest of your comment for that matter. Im still pretty new to VBA and especially excel VBA."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "edited": false, "score": 1, "creation_date": 1436970663, "post_id": 31431507, "comment_id": 50836919, "body": "<a href=\"http://stackoverflow.com/questions/2722146/how-do-i-declare-a-global-variable-in-vba\" title=\"how do i declare a global variable in vba\">stackoverflow.com/questions/2722146/&hellip;</a> and <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=109:excel-vba-events-event-procedures-handlers-triggering-a-vba-macro&amp;catid=79&amp;Itemid=475\" rel=\"nofollow noreferrer\">globaliconnect.com/excel/&hellip;</a> should help you to through it! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1436967028, "last_edit_date": 1436967028, "creation_date": 1436966214, "answer_id": 31431507, "question_id": 31430592, "link": "https://stackoverflow.com/questions/31430592/excel-hyperlink-follow-macro-after-worksheet-change-event/31431507#31431507", "title": "Excel hyperlink follow macro after worksheet_change event", "body": "<p>Ok so it is simply your HLink macro that doesn't do the proper thing, most easy way would be to directly follow the hyperlink :</p>\n\n<pre><code>Sub HLink(rng As Range)\n   If rng(1).Hyperlinks.Count Then rng.Hyperlinks(1).Follow\nEnd Sub\n</code></pre>\n\n<p>This will <strong>automatically open your default browser to go the URL/address of your hyperlink</strong>.</p>\n\n<p>And the hard way would be to reference an IE application and open the address that you found in it and then work with it, but if it's on only to open the hyperlink, that code would be enough!</p>\n"}], "owner": {"reputation": 37, "user_id": 5111797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb310b4a79f0392c268e4c90e17673ff?s=128&d=identicon&r=PG&f=1", "display_name": "Namorg", "link": "https://stackoverflow.com/users/5111797/namorg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 1, "accepted_answer_id": 31431507, "answer_count": 1, "score": 2, "last_activity_date": 1528982530, "creation_date": 1436963797, "last_edit_date": 1528982530, "question_id": 31430592, "link": "https://stackoverflow.com/questions/31430592/excel-hyperlink-follow-macro-after-worksheet-change-event", "title": "Excel hyperlink follow macro after worksheet_change event", "body": "<p>I have an excel sheet that takes a barcode scan (2D/QR barcode formated like SN1234567 7654321 PA01234-5 A B C) when scanned in via a plug &amp; play scanner and parses said barcode to individual cells to the right with the space being the delimiting character. Now after this parse I have a cell using a combination of the excel hyperlink function an Hlink macro(shown below) and a vlookup function to find a hyperlink on a different worksheet using the parsed information. Now, I'm trying to write a macro so that once this barcode is scanned and the worksheet_change even is triggered, parsed, and the hyperlink is found, the hyperlink is automatically clicked. (I'm using this system to attempt to \"idiot-proof\" a process in which operators fail type in numbers correctly.) anyway a screenshot of my workbook and all the code I currently am using will be below, can you please help me solve this issue?</p>\n\n<p>a screen shot of said spreadsheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/VB4cW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VB4cW.jpg\" alt=\"screenshot\"></a></p>\n\n<p>Worksheet change code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range, rng As Range\n\n' The variable KeyCells contains the cells that will\n' cause an alert when they are changed.\nSet KeyCells = Range(\"A1:A10\")\n\n'Target can be a multi-cell range, so you need to account\n'  for that possibility\nSet rng = Application.Intersect(KeyCells, Target)\n\nIf Not rng Is Nothing Then\n    'prevent re-activating this sub when splitting text...\n    Application.EnableEvents = False\n    textsplit Target\n    Application.EnableEvents = True\nEnd If\n\nExit Sub\n\nhaveError:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>parse code:</p>\n\n<pre><code>Sub textsplit(rng As Range)\nDim c As Range, arr\n\nFor Each c In rng.Cells\n    If Len(c.Value) &gt; 0 Then\n        arr = Split(c.Value, \" \")\n        c.Offset(0, 1).Resize(1, UBound(arr) + 1).Value = arr\n    End If\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Hlink code: </p>\n\n<pre><code>Function HLink(rng As Range) As String\n'extract URL from hyperlink\n'posted by Rick Rothstein\n  If rng(1).Hyperlinks.Count Then HLink = rng.Hyperlinks(1).Address\nEnd Function\n</code></pre>\n\n<p>used in the sharepoint link cell with this formaula which find and extract the hyperlink of a cell on a different page.       <code>=HYPERLINK(HLink(INDEX(Table_owssvr[Name],MATCH(Parse!C3&amp;\"_\"&amp;Parse!D3,Table_owss vr[Name],0))),INDEX(Table_owssvr[Name],MATCH(Parse!C3&amp;\"_\"&amp;Parse!D3,Table_owssvr[Name],0)))</code></p>\n\n<p>EDIT (for clarity): All of this code that I posted is currently working, <strong>the problem I am having is automatically</strong> (with the only user input being to scan said barcode into excel) <strong>following the hyperlink generated in column H</strong>.</p>\n\n<p>EDIT 2: To give a little bit more info, I just tried to add this code\nActiveWorkbook.FollowHyperlink Address:=Range(\"H3\").Address, NewWindow:=False, AddHistory:=True\nin the worksheet change sub after the textsplit call. This implementation yielded the error \"Run-time error '-2147221014(800401ea)': Cannot open the specified file.\"</p>\n\n<p>I am thinking that this error is due to the value of H3 being the \"friendly name\" portion of the hyperlink function. Meaning that when this macro tried to \"click\" or follow H3 it was met with the value 4512517_PA06872-1 and not the actual hyperlink needed to follow it. </p>\n"}, {"tags": ["arrays", "vba", "if-statement"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436963818, "post_id": 31430442, "comment_id": 50831431, "body": "I don&#39;t understand how the title refers to the question... is <code>0</code> out of range for <code>strArray</code>? If so, possibly you have an <code>On Error Resume Next</code> that could cause the code to blow through the <code>If</code> statement?"}, {"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436965097, "post_id": 31430442, "comment_id": 50832435, "body": "It executes the if statement even using the on error resume next."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1436965694, "post_id": 31430442, "comment_id": 50832908, "body": "If you know that <code>strArray(0)</code> is out of range, why write that in the code? If you&#39;re just looking for the first element of the array, you could use <code>strArray(Lbound(strArray))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1436965018, "post_id": 31430899, "comment_id": 50832379, "body": "It doesn&#39;t work since strArray(0) = &lt;Subscript out of range&gt;"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1436965460, "post_id": 31430899, "comment_id": 50832728, "body": "try above now. can you do ? strArray(0) in the immediate window?"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1436965396, "last_edit_date": 1436965396, "creation_date": 1436964607, "answer_id": 31430899, "question_id": 31430442, "link": "https://stackoverflow.com/questions/31430442/if-comparison-with-subscript-out-of-range/31430899#31430899", "title": "If comparison with subscript out of range", "body": "<p>Make sure the array(0) is not empty before trying to do string manipulation</p>\n\n<pre><code>sub t\nIf Initialized(strArray) Then ' is array setup\n    If strArray(0) &lt;&gt; \"\" Then ' if array has value\n        If Left(strArray(0), 3) = \"Usu\" Then\n             booleanVariable = True\n        End If\n    Else\n        MsgBox \"No value in array\"\n    End If\nElse\n    MsgBox \"Array not setup\"\nEnd If\nend sub\n\nFunction Initialized(val) As Boolean\nOn Error GoTo errHandler\n    Dim i\n\n    If Not IsArray(val) Then GoTo exitRoutine\n\n    i = UBound(val)\n\n    Initialized = True\nexitRoutine:\n    Exit Function\nerrHandler:\n    Select Case Err.Number\n        Case 9 'Subscript out of range\n            GoTo exitRoutine\n        Case Else\n            Debug.Print Err.Number &amp; \": \" &amp; Err.Description, _\n                \"Error in Initialized()\"\n    End Select\n    Debug.Assert False\n    Resume\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436965396, "creation_date": 1436963400, "last_edit_date": 1436965137, "question_id": 31430442, "link": "https://stackoverflow.com/questions/31430442/if-comparison-with-subscript-out-of-range", "title": "If comparison with subscript out of range", "body": "<p>I don't understand why the code bellow is executed when the value of \nstrArray(0) is Subscript out of range. My booleanVariable changes to true and I don't want that. </p>\n\n<pre><code>If Left(strArray(0), 3) = \"Usu\" Then\n     booleanVariable = True    \nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436963798, "post_id": 31430377, "comment_id": 50831413, "body": "Can you tell me how to do it in vba?"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436963879, "post_id": 31430377, "comment_id": 50831493, "body": "Which bit? All this can be solved via formulas! Not that I&#39;m against vba ... it&#39;s just that formulas never crash so i only use vba when i need to!"}, {"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436964775, "post_id": 31430377, "comment_id": 50832187, "body": "I would have explained to you why I need to use vba but let&#39;s not get to that. Is there any way I can do it using VBA"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436965958, "post_id": 31430377, "comment_id": 50833127, "body": "I&#39;ve added a vba version ... i really would like to know why you have to use vba though?! :0)"}, {"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436966891, "post_id": 31430377, "comment_id": 50833821, "body": "The code is showing subscript out of range on: dDepartmentTotals(ideptno) = dDepartmentTotals(ideptno) + Sheets(&quot;Sheet1&quot;).Cells(i, 3). Btw did I add that the no. of departments can be dynamic."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 1, "creation_date": 1436967369, "post_id": 31430377, "comment_id": 50834254, "body": "<a href=\"http://www.excel-easy.com/vba/array.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/array.html</a> ... everything you need to know about arrays. I think it&#39;s only fair you do some of the work."}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 4, "last_activity_date": 1436965900, "last_edit_date": 1436965900, "creation_date": 1436963216, "answer_id": 31430377, "question_id": 31430024, "link": "https://stackoverflow.com/questions/31430024/maximum-and-minimum-against-strings/31430377#31430377", "title": "Maximum and minimum against strings", "body": "<p>Using the following as an example:</p>\n\n<h2><img src=\"https://i.stack.imgur.com/OhAeO.png\" alt=\"enter image description here\"></h2>\n\n<p>You need to use <code>SUMIF()</code> to get the total in column E</p>\n\n<p><a href=\"http://www.techonthenet.com/excel/formulas/sumif.php\" rel=\"nofollow noreferrer\">http://www.techonthenet.com/excel/formulas/sumif.php</a></p>\n\n<p>In your case you need the following (row 2):</p>\n\n<pre><code>=SUMIF($B$2:$B$11,\"=\" &amp; D2,$C$2:$C$11)\n</code></pre>\n\n<p>Then <code>COUNTIF</code> in column F (row 2):</p>\n\n<p><a href=\"https://support.office.com/en-za/article/COUNTIF-function-e0de10c6-f885-4e71-abb4-1f464816df34\" rel=\"nofollow noreferrer\">https://support.office.com/en-za/article/COUNTIF-function-e0de10c6-f885-4e71-abb4-1f464816df34</a></p>\n\n<pre><code>=COUNTIF(B2:B11,\"=\"&amp;D2) \n</code></pre>\n\n<p>Average is obviously sum/count!</p>\n\n<p>And then you can use the following information to work out the max and min ... <a href=\"http://www.contextures.com/excelminmaxfunction.html#minif\" rel=\"nofollow noreferrer\">http://www.contextures.com/excelminmaxfunction.html#minif</a></p>\n\n<p>By placing the department name in column D, and referencing it in the <code>SUMIF\\COUNTIF</code> forumals, you can create a list of departments as long as you want!</p>\n\n<hr>\n\n<p><strong>NOTE</strong> the <code>MINIF</code> example is an array formula ... best look that up first if you've never used one before ...  <a href=\"http://www.excel-easy.com/functions/array-formulas.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/functions/array-formulas.html</a></p>\n\n<hr>\n\n<p>If you really must use VBA, then this will work for the example worksheet i've shown at the top of this post ...</p>\n\n<pre><code>Sub CalculateStuff()\n\nDim dDepartmentTotals(4) As Integer\nDim dDepartmentMinimum(4) As Integer: For i = 1 To 4: dDepartmentMinimum(i) = 32767: Next i\nDim dDepartmentMaximum(4) As Integer\nDim dDepartmentAverage(4) As Integer\nDim dDepartmentCount(4) As Integer\n\nFor i = 2 To 11\n\n    ideptno = CInt(Right(Sheets(\"Sheet1\").Cells(i, 2), 1))\n    dDepartmentTotals(ideptno) = dDepartmentTotals(ideptno) + Sheets(\"Sheet1\").Cells(i, 3)\n    If dDepartmentMaximum(ideptno) &lt; Sheets(\"Sheet1\").Cells(i, 3) Then dDepartmentMaximum(ideptno) = Sheets(\"Sheet1\").Cells(i, 3)\n    If Sheets(\"Sheet1\").Cells(i, 3) &lt; dDepartmentMinimum(ideptno) Then dDepartmentMinimum(ideptno) = Sheets(\"Sheet1\").Cells(i, 3)\n    dDepartmentCount(ideptno) = dDepartmentCount(ideptno) + 1\nNext i\n\nFor i = 1 To 4\n\n    dDepartmentAverage(i) = dDepartmentTotals(i) \\ dDepartmentCount(i)\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436965900, "creation_date": 1436962154, "question_id": 31430024, "link": "https://stackoverflow.com/questions/31430024/maximum-and-minimum-against-strings", "title": "Maximum and minimum against strings", "body": "<p>I have data as shown:\n<a href=\"http://bit.ly/1O6aaWX\" rel=\"nofollow\">http://bit.ly/1O6aaWX</a></p>\n\n<p>For each department I have to calculate minimum, maximum wait time and if possible, average time too. The no. of departments can be dynamic. I have got no clue how to do this. </p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 2, "creation_date": 1436961983, "post_id": 31429809, "comment_id": 50830100, "body": "You are losing it because the formatting information specified in the numeric field is used for display purposes only in Access.  It is not actually part of the data returned from the field, and numbers will always be returned without leading zeros."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1436962657, "post_id": 31429809, "comment_id": 50830596, "body": "Ah right! that does make sense actually. I guess the easiest way is to use a text field then?"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1436962562, "creation_date": 1436962562, "answer_id": 31430160, "question_id": 31429809, "link": "https://stackoverflow.com/questions/31429809/how-do-i-retain-a-leading-zero-when-concatinating-values-in-ms-access/31430160#31430160", "title": "how do I retain a leading zero when concatinating values in MS Access?", "body": "<p>I take it that part_type_code is a string, so try:</p>\n\n<pre><code>part_type_code = Format$(GroupVal, \"00\") &amp; \" \" &amp; Format$(CatVal, \"00\")\n</code></pre>\n"}], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 31430160, "answer_count": 1, "score": 2, "last_activity_date": 1436965196, "creation_date": 1436961652, "last_edit_date": 1436965196, "question_id": 31429809, "link": "https://stackoverflow.com/questions/31429809/how-do-i-retain-a-leading-zero-when-concatinating-values-in-ms-access", "title": "how do I retain a leading zero when concatinating values in MS Access?", "body": "<p>I am running a concatenation of 2 fields which are number fields formatted to <code>00</code>. This was intended to add a leading zero for numbers 1-9. In a form I have begun to concatenate these two together however I am losing the leading 0. </p>\n\n<pre><code>Private Sub PartCodeBtn_Click()\nDim GroupVal As String\nDim CatVal As string\n\nGroupVal = Me!Prt_GroupDS.Form![Group_Number]\nCatVal = Me!Part_Cat_DS.Form![PartCat_Number]\n\npart_type_code = GroupVal &amp; \" \" &amp; CatVal\n</code></pre>\n\n<p>I am getting a part type code result of <code>32 1</code> instead of <code>32 01</code>. \ndoes anyone know how to keep the leading zero, or why I have lost it?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436961824, "post_id": 31429840, "comment_id": 50829991, "body": "Oh, so is that why this function always loops twice? About the .xls/.xlsm filter: good idea, 99% of the time a good practice, but I am opening machine files: .438, etc."}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1436961958, "post_id": 31429840, "comment_id": 50830084, "body": "Thanks! I adapted this to my code and now the data is pasted. My macro is almost fixed now!"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1436961712, "creation_date": 1436961712, "answer_id": 31429840, "question_id": 31429682, "link": "https://stackoverflow.com/questions/31429682/vba-excel-2010-msofiledialogopen-path-open-run-time-error-424-object-required/31429840#31429840", "title": "VBA Excel 2010 msoFileDialogOpen Path.Open Run-time error &#39;424&#39;: Object required", "body": "<p><code>path</code> is a <code>String</code> so has no <code>.Open</code> method (which you call even if the dialog was dismissed; i.e. when <code>.Show</code> returns <code>false</code>)</p>\n\n<p>Assuming you want to open the selected workbook (you should add a xls/x/m filter)</p>\n\n<pre><code>Dim file As String\n'   Start File Explorer to select file containing data (simple GUI, much easier than coding vFileName)\nWith Application.FileDialog(msoFileDialogOpen)\n    .AllowMultiSelect = False\n    If .Show Then\n        file = .SelectedItems(1)\n        Workbooks.Open file\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1436961802, "creation_date": 1436961802, "answer_id": 31429877, "question_id": 31429682, "link": "https://stackoverflow.com/questions/31429682/vba-excel-2010-msofiledialogopen-path-open-run-time-error-424-object-required/31429877#31429877", "title": "VBA Excel 2010 msoFileDialogOpen Path.Open Run-time error &#39;424&#39;: Object required", "body": "<p>The reason is that you assign string value to the variable <code>Path</code> and after that you are trying to call method <code>Open</code> on this string:</p>\n\n<pre><code>Path.Open\n</code></pre>\n\n<p>String is a primitive value and it doesn't have any methods. You can use it as a parameter for function but you cannot call its own methods, since they don't have any.</p>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 31429840, "answer_count": 2, "score": 0, "last_activity_date": 1436961802, "creation_date": 1436961285, "last_edit_date": 1592644375, "question_id": 31429682, "link": "https://stackoverflow.com/questions/31429682/vba-excel-2010-msofiledialogopen-path-open-run-time-error-424-object-required", "title": "VBA Excel 2010 msoFileDialogOpen Path.Open Run-time error &#39;424&#39;: Object required", "body": "<p>I have a simple function which lets the user select a file using Excel 2010's VBA's msoFileDialogOpen property to select a file. When I run it I get the errror:</p>\n<blockquote>\n<p>Run-time error '424':</p>\n<p>Object required</p>\n</blockquote>\n<p>Here is the offending line:</p>\n<pre><code>    Path.Open\n</code></pre>\n<p>Here is the entire function:</p>\n<pre><code>Public Sub Function4_FileExplorer()\nDim file As Variant\n'   Start File Explorer to select file containing data (simple GUI, much easier than coding vFileName)\nWith Application.FileDialog(msoFileDialogOpen)\n    .AllowMultiSelect = False\n    If .Show Then\n        file = .SelectedItems(1)\n        Path = file\n    End If\n    Path.Open\nEnd With\nMsgBox file\n\nExit Sub\nErrorHandler:\nMsgBox &quot;Error detected&quot; &amp; vbNewLine &amp; &quot;Error&quot; &amp; Err.Number &amp; _\n       Err.Description, vbCritical, &quot;Error Handler: Error &quot; &amp; Err.Number\n\nEnd Sub\n</code></pre>\n<p>How should I fix this run-time error? I Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 491, "user_id": 4809220, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--SSWpMsOc-g/AAAAAAAAAAI/AAAAAAAADCQ/ruh_sD3h3lA/photo.jpg?sz=128", "display_name": "DangeMask", "link": "https://stackoverflow.com/users/4809220/dangemask"}, "edited": false, "score": 2, "creation_date": 1436961219, "post_id": 31429562, "comment_id": 50829582, "body": "Does it say anythin more than &quot;Runtime error&quot;? On which row of code does the error appear?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1436987205, "post_id": 31432104, "comment_id": 50847462, "body": "Hi R3uK, thanks for your help, i don&#39;t have the error anymore, it was on the first &quot;ActiveSheet.Paste&quot; but now the data doesn&#39;t get paste together, but it jumps 21 cells every time, do you have any ideas? Sorry for my bad English!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437032062, "post_id": 31432104, "comment_id": 50864252, "body": "It jumps cells... I have no clue where this can come from... Because we are supposed to be pasting on a different sheet each time, but every time starting on <code>A2</code>, so I don&#39;t see what can happen can you be a bit more precise on the jumps? or make a screenshot?"}, {"owner": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437041747, "post_id": 31432104, "comment_id": 50870320, "body": "sorry, it was my mistake, there was a conflict with the rest of de code in the first module, so I created a second module and added a new command button to start this macro."}, {"owner": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437041932, "post_id": 31432104, "comment_id": 50870442, "body": "is there a way I can change the code to select some specific items, like  : items 1 to 10 go to Sheet1 and 11 to 20 to Sheet2?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437050313, "post_id": 31432104, "comment_id": 50875837, "body": "If by items, you mean rows, that is the line you need to modify : <code>WsFrom.Range(&quot;A1&quot;, WsFrom.Range(&quot;A&quot; &amp; WsFrom.Rows.Count).End(xlUp)).Copy</code> but you&#39;ll have to duplicate it to copy/paste the first part and then copy/paste the second"}, {"owner": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437059778, "post_id": 31432104, "comment_id": 50883231, "body": "Thank you very much your help was amazing."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "edited": false, "score": 0, "creation_date": 1437115929, "post_id": 31432104, "comment_id": 50905596, "body": "@NitoNascimento : Glad I could help! ;)   So just 2 quick pointers for that site :  once your problem is solved, you can accept an answer (tick right under up/down votes, that&#39;ll become green) to mark your question as answered. And use the up/down votes when you find something useful or not (question or answer)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1436967676, "creation_date": 1436967676, "answer_id": 31432104, "question_id": 31429562, "link": "https://stackoverflow.com/questions/31429562/trying-to-copy-and-paste-some-variable-data/31432104#31432104", "title": "Trying to copy and paste some variable data", "body": "<p>Here is your code largely reviewed, because the <code>.Select</code> command is really ressource-greedy and now it is far more readable!</p>\n\n<p>I don't know on which line you had the error with your code but it is an important information, so add it even if this solve your problem! ;)</p>\n\n<p>Here is the code :</p>\n\n<pre><code>Sub Nito_Nascimento()\nDim WsFrom As Worksheet, _\n    WsTo As Worksheet\n\n    Set WsFrom = Sheets(\"Hulp_IO\")\n    Set WsTo = Sheets(\"IO\")\n\n    WsFrom.Range(\"A1\", WsFrom.Range(\"A\" &amp; WsFrom.Rows.Count).End(xlUp)).Copy\n    WsTo.Range(\"B2\").PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        Operation:=xlNone, _\n                        SkipBlanks:=True, _\n                        Transpose:=False\n\n    Set WsFrom = Sheets(\"Hulp_Modbus_PMSX_Lees_Tags\")\n    Set WsTo = Sheets(\"Modbus_Lees_Tags_PMSX\")\n    Application.CutCopyMode = False\n    WsFrom.Range(\"A1\", WsFrom.Range(\"A\" &amp; WsFrom.Rows.Count).End(xlUp)).Copy\n    WsTo.Range(\"A2\").PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        Operation:=xlNone, _\n                        SkipBlanks:=True, _\n                        Transpose:=False\n\n    Set WsFrom = Sheets(\"Hulp_Modbus_PMSX_Schrijf_Tags\")\n    Set WsTo = Sheets(\"Modbus_Schrijf_Tags_PMSX\")\n    Application.CutCopyMode = False\n    WsFrom.Range(\"A1\", WsFrom.Range(\"A\" &amp; WsFrom.Rows.Count).End(xlUp)).Copy\n    WsTo.Range(\"A2\").PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        Operation:=xlNone, _\n                        SkipBlanks:=True, _\n                        Transpose:=False\n\n    Set WsFrom = Sheets(\"Hulp_Modbus_Pakscan_Lees_Tags\")\n    Set WsTo = Sheets(\"Modbus_Lees_Tags_PackScan\")\n    Application.CutCopyMode = False\n    WsFrom.Range(\"A1\", WsFrom.Range(\"A\" &amp; WsFrom.Rows.Count).End(xlUp)).Copy\n    WsTo.Range(\"A2\").PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        Operation:=xlNone, _\n                        SkipBlanks:=True, _\n                        Transpose:=False\n\n    Set WsFrom = Sheets(\"Hulp_Modbus_Pakscan_Schrijf_Tag\")\n    Set WsTo = Sheets(\"Modbus_Schrijf_Tags_PackScan\")\n    Application.CutCopyMode = False\n    WsFrom.Range(\"A1\", WsFrom.Range(\"A\" &amp; WsFrom.Rows.Count).End(xlUp)).Copy\n    WsTo.Range(\"A2\").PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        Operation:=xlNone, _\n                        SkipBlanks:=True, _\n                        Transpose:=False\n\n    Application.CutCopyMode = False\n    Sheets(\"Start\").Activate\n    Set WsFrom = Nothing\n    Set WsTo = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5119229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--x41Y5hXLoc/AAAAAAAAAAI/AAAAAAAAFAE/lJuKcqBO1vA/photo.jpg?sz=128", "display_name": "Nito Nascimento", "link": "https://stackoverflow.com/users/5119229/nito-nascimento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 31432104, "answer_count": 1, "score": 1, "last_activity_date": 1436967676, "creation_date": 1436960920, "last_edit_date": 1436962791, "question_id": 31429562, "link": "https://stackoverflow.com/questions/31429562/trying-to-copy-and-paste-some-variable-data", "title": "Trying to copy and paste some variable data", "body": "<p>i'm working on a existing excel file with lots of macros and want to copy and paste variable data from 5 different sheets to 5 other sheets without copying blank cells. this is what i made so far and gives me Runtime error 1004:</p>\n\n<pre><code>Sub Macro1()\n\n    Sheets(\"Hulp_IO\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"IO\").Select\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hulp_Modbus_PMSX_Lees_Tags\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Modbus_Lees_Tags_PMSX\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hulp_Modbus_PMSX_Schrijf_Tags\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Modbus_Schrijf_Tags_PMSX\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hulp_Modbus_Pakscan_Lees_Tags\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Modbus_Lees_Tags_PackScan\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hulp_Modbus_Pakscan_Schrijf_Tag\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Modbus_Schrijf_Tags_PackScan\").Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n    Sheets(\"Start\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1436960173, "post_id": 31429114, "comment_id": 50828909, "body": "If you wish to copy all the worksheets with all the data and all the formulas and all the formatting to a new workbook, why not <b>save the old workbook under a new name</b> ??"}, {"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1436960720, "post_id": 31429114, "comment_id": 50829274, "body": "Yeah, but thats not an Option, because it isn&#39;t me using this Excel-woorkbook later and it should do this, because the user won&#39;t do it, so I make it sure with the vba code it happens"}, {"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1436961345, "post_id": 31429114, "comment_id": 50829668, "body": "@Nicola  The code is almost working, but the Debugger has a Problem with the column: &quot;workbook.Sheets(index).....&quot;  error 9, so I tried this with the Name of the wb (test) workbook.Sheets(test)...  but it didnt work"}, {"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1436971927, "post_id": 31429114, "comment_id": 50837874, "body": "My Questions are:  1.How can I name the new workbook, example: The old one is timetable.xlsm  The new pasted one should be named as timetable_v2.xlsm   2.and with which command can be the names of the worksheet be retained in the pasted file?   3.I also get this Debugger error 9:  WBN.Sheets(Array(&quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet3&quot;)).Delete   What should I replace or change?"}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436960266, "creation_date": 1436960266, "answer_id": 31429341, "question_id": 31429114, "link": "https://stackoverflow.com/questions/31429114/copy-paste-cells-value/31429341#31429341", "title": "Copy/Paste cells &amp; value", "body": "<p>You can try as follow:</p>\n\n<pre><code>Sub CopyPaste()\n\n    Dim aSheet As Worksheet\n    Dim workbook As workbook\n    Dim index As Integer\n\n    Set workbook = Workbooks.Add(xlWBATWorksheet)\n\n    For Each aSheet In Worksheets\n\n        aSheet.Range(\"A1:G10\").Copy\n\n        workbook.Sheets(index).Range(\"A1\").PasteSpecial Paste:=xlPasteFormulasAndNumberFormats\n\n        index = index + 1\n\n        Application.CutCopyMode = False\n\n    Next aSheet\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "is_accepted": false, "score": 0, "last_activity_date": 1436963011, "creation_date": 1436963011, "answer_id": 31430306, "question_id": 31429114, "link": "https://stackoverflow.com/questions/31429114/copy-paste-cells-value/31430306#31430306", "title": "Copy/Paste cells &amp; value", "body": "<p>Just had a quick look for you, this seems to do the job:</p>\n\n<p>credit: <a href=\"http://www.get-digital-help.com/2012/10/02/copy-each-sheet-in-active-workbook-to-new-workbooks/\" rel=\"nofollow\">get digital help</a></p>\n\n<pre><code>Dim WBN As Workbook, WBC As Workbook, WB As Workbook\nDim WS As String\nDim SHT As Worksheet\n\nSet WBN = Workbooks.Add\nFor Each WB In Application.Workbooks\nIf WB.Name &lt;&gt; WBN.Name Then\n    For Each SHT In WB.Worksheets\n        SHT.Copy After:=WBN.Sheets(WBN.Worksheets.Count)\n        WBN.Sheets(WBN.Worksheets.Count).Name = Left(WB.Name, 30 - Len(SHT.Name)) &amp; \"-\" &amp; SHT.Name\n    Next SHT\nEnd If\nNext WB\nApplication.DisplayAlerts = False\nWBN.Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Delete\nWBN.Application.DisplayAlerts = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "edited": false, "score": 0, "creation_date": 1437034507, "post_id": 31433798, "comment_id": 50865645, "body": "Well the Problem with the error 9 still exist, so it won&#39;t be named the as I wanted to, but you help me a lot thanks"}, {"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "edited": false, "score": 0, "creation_date": 1437036522, "post_id": 31433798, "comment_id": 50866843, "body": "I just deleted <code>WBN.Sheets(Array(&quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet3&quot;)).Delete </code> And it works fine"}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "reply_to_user": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "edited": false, "score": 0, "creation_date": 1437044566, "post_id": 31433798, "comment_id": 50872163, "body": "Great, glad you got there!"}, {"owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "edited": false, "score": 0, "creation_date": 1437054026, "post_id": 31433798, "comment_id": 50878695, "body": "When the wb is pasted, there is also a &quot;sheet1&quot; ws in the new v2 wb, but I dont want that. How can I get rid of the useless sheet1 from copy/paste?"}], "tags": [], "owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "is_accepted": true, "score": 0, "last_activity_date": 1437032951, "last_edit_date": 1437032951, "creation_date": 1436971914, "answer_id": 31433798, "question_id": 31429114, "link": "https://stackoverflow.com/questions/31429114/copy-paste-cells-value/31433798#31433798", "title": "Copy/Paste cells &amp; value", "body": "<p>So i assume you will be saving the second workbook for it to be named? therefore just add your path below where you want to save it, also it now retains the sheet names.\nI'm not sure why you are getting a debugger error its working fine for me, try this code and see if you still get it? </p>\n\n<pre><code>Sub newworkbook()\nDim WBN As workbook, WBC As workbook, WB As workbook\nDim WS As String\nDim SHT As Worksheet\n\nSet WBN = Workbooks.Add\n\nFor Each WB In Application.Workbooks\n\nIf WB.Name &lt;&gt; WBN.Name Then\nFor Each SHT In WB.Worksheets\n    SHT.Copy After:=WBN.Sheets(WBN.Worksheets.Count)\n    WBN.Sheets(WBN.Worksheets.Count).Name = (SHT.Name) &amp; \" \"\nNext SHT\nEnd If\nNext WB\nApplication.DisplayAlerts = False\nWBN.Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Delete\nWBN.Application.DisplayAlerts = True\nActiveWorkbook.SaveAs \"C:\\YOURPATH\\timetable_v2.xls\" 'change path to whatever\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1437037136, "creation_date": 1437037136, "answer_id": 31449746, "question_id": 31429114, "link": "https://stackoverflow.com/questions/31429114/copy-paste-cells-value/31449746#31449746", "title": "Copy/Paste cells &amp; value", "body": "<p>I just deleted <code>WBN.Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Delete\n</code>\nAnd it works fine</p>\n\n<p>The new workbook is saved as an .xlsx file, but of course I Need it as an .xlsm file....when I just added it into the path, it doesnt work</p>\n\n<pre><code>ActiveWorkbook.SaveAs \"U:\\Excel\\timetable_v2.xlsm\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4819883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87875a8a0f98beb402c00be6afb01cdd?s=128&d=identicon&r=PG&f=1", "display_name": "donduc_jr", "link": "https://stackoverflow.com/users/4819883/donduc-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 31433798, "answer_count": 4, "score": 0, "last_activity_date": 1437037136, "creation_date": 1436959609, "last_edit_date": 1531164843, "question_id": 31429114, "link": "https://stackoverflow.com/questions/31429114/copy-paste-cells-value", "title": "Copy/Paste cells &amp; value", "body": "<p>I want to copy/paste all worksheet inlcuding the values/formula in the cells to another new workbook.</p>\n\n<p>This code just copy the first ws, but not all other. How can I make sure, that all ws are gettin copied and pasted without writing all the names from the ws in the vba-code?</p>\n\n<pre><code>Sub CopyPaste()\nDim ws As Worksheet, wb As Workbook\nSet ws = ActiveSheet\nSet wb = Workbooks.Add(xlWBATWorksheet)\nws.Range(\"A1:G10\").Copy\nwb.Sheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\nwb.Sheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436957991, "post_id": 31428482, "comment_id": 50827558, "body": "in the sql just dont select them?"}, {"owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436958119, "post_id": 31428482, "comment_id": 50827643, "body": "Ok, sounds simple, but how to do it with checkmark in form?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1436963482, "post_id": 31429739, "comment_id": 50831200, "body": "Thanks for your reply. I get run-time error - The command or action &#39;UnhideColumns&#39; isnt available now."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1436963662, "post_id": 31429739, "comment_id": 50831323, "body": "@tomsre What kind of a form do you have that shows these columns?  I had just assume it was a splitform by the way you were speaking about it."}, {"owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1436968013, "post_id": 31429739, "comment_id": 50834811, "body": "Thanks for reply. No, I have a simple form. In form i have a button witch runs the query. I want to adjust the query&#39;s columns &quot;Show&quot; atribute from the form. In other words, when I uncheck my checkbox in my form, it need to uncheck the &quot;Show&quot; checkbox, what you can find in query design view."}, {"owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1436968781, "post_id": 31429739, "comment_id": 50835429, "body": "What do you mean? The database is used only by me."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1436969911, "post_id": 31429739, "comment_id": 50836309, "body": "@tomsre Okay, so would simply right clicking on one of the column headers and selecting &quot;UnHide&quot; work in your situation.  That will bring up a list of all of the columns and you just choose which ones you want to be hidden."}, {"owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "edited": false, "score": 0, "creation_date": 1437027565, "post_id": 31429739, "comment_id": 50861775, "body": "Thanks for reply. I guess you dont actually understand what I need. I have a search form with text boxes where I enter search criteria. Just likethis one created in this video: <a href=\"https://www.youtube.com/watch?v=CTiA_4Me0cI/\" rel=\"nofollow noreferrer\">youtube.com/watch?v=CTiA_4Me0cI</a>  ... I want checkboxes in the form next to every text box and if I unckeck the checkbox next to on of the text boxes, that column in query doesnt show up when I run it."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436963597, "last_edit_date": 1436963597, "creation_date": 1436961454, "answer_id": 31429739, "question_id": 31428482, "link": "https://stackoverflow.com/questions/31428482/how-to-hide-ms-access-query-column-with-vba/31429739#31429739", "title": "How to hide MS Access query column with VBA?", "body": "<p>Instead of building your own checkboxes and making your own events, you could simply create a \"Show/Hide\" button that when clicked will allow the user to select which columns they want to view.  </p>\n\n<p><strong>Code:</strong> </p>\n\n<pre><code>Private Sub btnShowHide_Click()\n    DoCmd.RunCommand acCmdUnhideColumns\nEnd Sub\n</code></pre>\n\n<p><strong>What it Does:</strong></p>\n\n<p>This will make it so that when the user clicks the <code>btnShowHide</code> button, it will show a menu where the user can check or uncheck the columns that they want to hide. </p>\n"}], "owner": {"reputation": 1, "user_id": 5119010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d966315e5f450733549504877b2776a5?s=128&d=identicon&r=PG&f=1", "display_name": "tomsre", "link": "https://stackoverflow.com/users/5119010/tomsre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 935, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436963597, "creation_date": 1436957756, "last_edit_date": 1436958043, "question_id": 31428482, "link": "https://stackoverflow.com/questions/31428482/how-to-hide-ms-access-query-column-with-vba", "title": "How to hide MS Access query column with VBA?", "body": "<p>I have searched older posts, but couldnt find a solution. \nI got a query with many columns. I have created a basic search form, where I can input criteria for all the columns in that query, so I can perform the search. Problem is, I dont need to show all the columns. For example, there could be a checkmark for every column in the form, to hide/show it the query result. Could someone help me with the code, to achieve it? I need it in checkmark's AfterUpdate event. Thanks in advance! :)</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1436961947, "post_id": 31428473, "comment_id": 50830078, "body": "I&#39;d use an ArrayList instead as it has a <code>.Exists()</code> method for fast comparison."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436962951, "post_id": 31428473, "comment_id": 50830812, "body": "Be sure to let us know who the winner was (on your data). :P"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436975883, "post_id": 31428473, "comment_id": 50840732, "body": "Since your code is functioning as expected, just slower than you&#39;d like, this would be a much better fit on <a href=\"http://codereview.stackexchange.com/\">Code Review</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436962297, "post_id": 31429740, "comment_id": 50830308, "body": "How are you returning the values back into Sheet2 from the function(s)?"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1436964240, "post_id": 31429740, "comment_id": 50831748, "body": "@Jeeped <code>destination = result</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436965122, "post_id": 31429740, "comment_id": 50832452, "body": "I guess I would have just kept that one as a sub since it returns no value."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 2, "last_activity_date": 1436965424, "last_edit_date": 1436965424, "creation_date": 1436961456, "answer_id": 31429740, "question_id": 31428473, "link": "https://stackoverflow.com/questions/31428473/is-there-a-faster-way-to-compare-data-between-dynamic-arrays-in-vba/31429740#31429740", "title": "Is there a faster way to compare data between dynamic arrays in VBA?", "body": "<p>I think using Dictionaries would make the code faster.</p>\n\n<p>Below is the code doing the same task but it uses Dictionary object.\nOn my computer it is about 100x faster than your own code (tested on two worksheets with 5K rows each, for bigger data sets the gain should be even better).</p>\n\n<pre><code>Public Function TestVLookupArray2()\n    Dim dict As Object\n    Dim result As Variant\n    Dim i As Long\n    Dim destination As Excel.Range\n\n\n    'Load values from Sheet1 into Dictionary.\n    Set dict = getDataFromSheetAsDictionary(Sheets(\"Sheet1\"))\n\n    result = getDataFromSheet(Sheets(\"Sheet2\"))\n\n    For i = LBound(result, 1) To UBound(result, 1)\n\n        With dict\n            If .exists(result(i, 1)) Then\n                result(i, 2) = .Item(result(i, 1))\n            Else\n                result(i, 2) = \"NULL\"\n            End If\n        End With\n\n    Next i\n\n    With Sheets(\"Sheet2\")\n        Set destination = .Range(.Cells(1, 1), .Cells(UBound(result, 1), UBound(result, 2)))\n        destination = result\n    End With\n\nEnd Function\n\n\nPrivate Function getDataFromSheet(wks As Excel.Worksheet) As Variant\n    Dim lastRow As Long\n\n    With wks\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        getDataFromSheet = .Range(.Cells(1, 1), .Cells(lastRow, 2))\n    End With\n\nEnd Function\n\n\nPrivate Function getDataFromSheetAsDictionary(wks As Excel.Worksheet) As Object\n    Dim i As Long\n    Dim key As String\n    Dim value As Variant\n    Dim arr As Variant\n\n    Set getDataFromSheetAsDictionary = VBA.CreateObject(\"Scripting.Dictionary\")\n\n    arr = getDataFromSheet(wks)\n\n    With getDataFromSheetAsDictionary\n        For i = LBound(arr, 1) To UBound(arr, 1)\n\n            If Not .exists(arr(i, 1)) Then\n                Call .Add(arr(i, 1), arr(i, 2))\n            End If\n\n        Next i\n    End With\n\nEnd Function\n</code></pre>\n\n<p>Note that this code consists of 3 separate functions, you need to include all of them.</p>\n\n<p>Here is the article introducing to Dictionaries: <a href=\"http://www.techbookreport.com/tutorials/vba_dictionary.html\" rel=\"nofollow\">http://www.techbookreport.com/tutorials/vba_dictionary.html</a></p>\n\n<p>If you have any questions to this code, let me know in comments.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5119022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uH5IfLWiWEA/AAAAAAAAAAI/AAAAAAAAA6g/kHBGNA0OXOM/photo.jpg?sz=128", "display_name": "VBACrazy", "link": "https://stackoverflow.com/users/5119022/vbacrazy"}, "edited": false, "score": 0, "creation_date": 1437394234, "post_id": 31429802, "comment_id": 50993327, "body": "So, I went with this option, it seemed to make most sense and in short tests it was considerably faster. I then went to modify this for the live data sets, where I am trying to pull three columns of data through into the original data set. For one column of data it was pulling through in around 7-8 minutes. However, to pull through multiple columns, I couldn&#39;t find a way to get this to work without creating another loop or defining multiple dictionaries. This tripled the overhead and resulted in a worse time to run than the original. Wish I understood it more :("}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505847921, "post_id": 31429802, "comment_id": 79577934, "body": "The logic path here seems convoluted, this could really use inline comments."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1436963725, "last_edit_date": 1436963725, "creation_date": 1436961634, "answer_id": 31429802, "question_id": 31428473, "link": "https://stackoverflow.com/questions/31428473/is-there-a-faster-way-to-compare-data-between-dynamic-arrays-in-vba/31429802#31429802", "title": "Is there a faster way to compare data between dynamic arrays in VBA?", "body": "<p>I concur with the Scripting.Dictionary method.</p>\n\n<blockquote>\n  <p>This procedure makes use of a Scripting.Dictionsry. You need to go into the VBE's Tools \u25ba References and add a reference to the Microsoft Scripting Runtime.</p>\n</blockquote>\n\n<pre><code>Sub TESTVLOOKUPARRAY()\n    Dim PSORG1 As Variant, PSORG2 As Variant\n    Dim a As Long, b As Long\n    Dim dPSORG2 As New Scripting.dictionary\n\n    dPSORG2.CompareMode = TextCompare\n\n    Debug.Print Timer\n\n    With Sheets(\"Sheet1\")\n        a = .Cells(Rows.Count, 1).End(xlUp).Row\n        PSORG2 = .Cells(1, 1).Resize(a, 2).Value2 ' PSORG2 is now an allocated array\n        For b = LBound(PSORG2, 1) To UBound(PSORG2, 1)\n            dPSORG2.Item(PSORG2(b, 1)) = PSORG2(b, 2)\n        Next b\n    End With\n\n    With Sheets(\"Sheet2\")\n        a = .Cells(Rows.Count, 1).End(xlUp).Row\n        PSORG1 = .Cells(1, 1).Resize(a, 2).Value2 ' PSORG1 is now an allocated array\n    End With\n\n    Debug.Print dPSORG2.Count\n    Debug.Print LBound(PSORG2, 1) &amp; \":\" &amp; UBound(PSORG2, 1)\n    Debug.Print LBound(PSORG2, 2) &amp; \":\" &amp; UBound(PSORG2, 2)\n    Debug.Print LBound(PSORG1, 1) &amp; \":\" &amp; UBound(PSORG1, 1)\n    Debug.Print LBound(PSORG1, 2) &amp; \":\" &amp; UBound(PSORG1, 2)\n\n    For b = LBound(PSORG1, 1) To UBound(PSORG1, 1)\n        If dPSORG2.Exists(PSORG1(b, 1)) Then\n            PSORG1(b, 2) = dPSORG2.Item(PSORG1(b, 1))\n        Else\n            PSORG1(b, 2) = \"NULL\"\n        End If\n    Next b\n\n\n    With Sheets(\"Sheet2\")\n        .Cells(1, 1).Resize(UBound(PSORG1, 1), UBound(PSORG1, 2)) = PSORG1\n    End With\n\n    Debug.Print Timer\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>FWIW, my sample data of 110K rows on Sheet1 and 95K rows in Sheet2 ran in 20 minutes, 40 seconds with your original code. The above took 1.72 seconds on the same data.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436962491, "post_id": 31430082, "comment_id": 50830462, "body": "If you assign <code>PSORG2(i, 2) = &quot;NULL&quot;</code> before entering the <code>For j = 1 To UBound(PSORG2)</code> it will be overwritten (and exited) if found otherwise it will stay the same. Might be marginally faster than continually checking if you have reached the end of the loop."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1436967010, "post_id": 31430082, "comment_id": 50833921, "body": "That&#39;s true. Good tip @Jeeped. I&#39;ve amended the code. Thanks!"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1436975738, "last_edit_date": 1436975738, "creation_date": 1436962336, "answer_id": 31430082, "question_id": 31428473, "link": "https://stackoverflow.com/questions/31428473/is-there-a-faster-way-to-compare-data-between-dynamic-arrays-in-vba/31430082#31430082", "title": "Is there a faster way to compare data between dynamic arrays in VBA?", "body": "<p>I've used a <code>for next</code> loop, as a pose to the <code>do</code> loop used by yourself.</p>\n\n<pre><code>Sub speed_up2()\n    Dim PSORG1() As Variant, PSORG2() As Variant\n    Dim PSORG1Tot As Range, PSORG2Tot As Range, Destination As Range\n    Dim PSORG1RT As Long, PSORG2RT As Long\n    Dim wb As Workbook, ws_1 As Worksheet, ws_2 As Worksheet\n    Dim i As Byte, j As Byte\n\n    Set wb = ThisWorkbook\n    Set ws_1 = wb.Sheets(\"Sheet1\")\n    Set ws_2 = wb.Sheets(\"Sheet2\")\n\n    with ws_1\n        PSORG2RT = .Cells(Rows.Count, 1).End(xlUp).Row ' Get last row\n        Set PSORG2Tot = .Range(\"A1:B\" &amp; PSORG2RT)\n        PSORG2 = PSORG2Tot ' PSORG2 is now an allocated array\n    End With\n\n    With ws_2\n        PSORG1RT = .Cells(Rows.Count, 1).End(xlUp).Row\n        Set PSORG1Tot = .Range(\"A1:B\" &amp; PSORG1RT)\n        PSORG1 = PSORG1Tot ' PSORG1 is now an allocated array\n    End With\n\n    For i = 1 To UBound(PSORG1)\n        For j = 1 To UBound(PSORG2)\n            PSORG1(i, 2) = \"NULL\"\n            If PSORG1(i, 1) = PSORG2(j, 1) Then\n                PSORG1(i, 2) = PSORG2(j, 2)\n                Exit For\n            End If\n        Next j\n    Next i\n\n    Set Destination = ws_2.Range(\"A1\")\n    Destination.Resize(UBound(PSORG1, 1), UBound(PSORG1, 2)).Value = PSORG1\nEnd Sub\n</code></pre>\n\n<p>Please see <a href=\"http://bytes.com/topic/access/insights/797078-next-vs-do-loop-winner\" rel=\"nofollow\">here</a> for a speedtest which was performed between the <code>for next</code> loop and the <code>do</code> loop.</p>\n\n<p>As specified in the article, the <code>for next</code> loop is performing the calculation of the next iteration for you, whereas with the <code>do</code> loop you are having to increment the iteration yourself each time. This can save a large amount of time.</p>\n\n<p>I've also amended the method of getting the last row, which is used to create the range. This is my personal preference; it may also be safer to use than <code>Application.COUNTA</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 5119022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uH5IfLWiWEA/AAAAAAAAAAI/AAAAAAAAA6g/kHBGNA0OXOM/photo.jpg?sz=128", "display_name": "VBACrazy", "link": "https://stackoverflow.com/users/5119022/vbacrazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2183, "favorite_count": 1, "accepted_answer_id": 31429802, "answer_count": 3, "score": 6, "last_activity_date": 1436975738, "creation_date": 1436957738, "last_edit_date": 1531164843, "question_id": 31428473, "link": "https://stackoverflow.com/questions/31428473/is-there-a-faster-way-to-compare-data-between-dynamic-arrays-in-vba", "title": "Is there a faster way to compare data between dynamic arrays in VBA?", "body": "<p>I have the below code working successfully, however it has to run on two arrays of 130k+ rows each. Current run time on the full data set is around 24 minutes and having added a count at one point, it is looping 9.8 billion times. </p>\n\n<p>I have read through articles on using Match, Vlookup and they all seem to suggest that an iterative loop (as I have used) is the fastest method, however I have been unable to understand how to get the other methods to work with dynamic arrays and hence test appropriately.</p>\n\n<p>Is anyone able to tell me if there is a faster way to complete this activity, and if so, demonstrate how?</p>\n\n<pre><code>Sub TESTVLOOKUPARRAY()\n    Dim PSORG1() As Variant\n    Dim PSORG1Tot As Variant\n    Dim PSORG1RT As Variant\n    Dim PSORG2() As Variant\n    Dim PSORG2Tot As Variant\n    Dim PSORG2RT As Variant\n\n    Sheets(\"Sheet1\").Select\n    PSORG2RT = Application.CountA(Range(\"A:A\"))\n    PSORG2Tot = \"A1:B\" &amp; PSORG2RT\n    PSORG2 = Range(PSORG2Tot) ' PSORG2 is now an allocated array\n\n    Sheets(\"Sheet2\").Select\n    PSORG1RT = Application.CountA(Range(\"A:A\"))\n    PSORG1Tot = \"A1:B\" &amp; PSORG1RT\n    PSORG1 = Range(PSORG1Tot) ' PSORG1 is now an allocated array\n\n    a = 2 ' to increment ORG values in PSORG1\n\n    Do\n        Finish = \"No\"\n        b = 1 ' to increment ORG values in PSORG2\n        Do\n            If PSORG1(a, 1) = PSORG2(b, 1) Then\n                PSORG1(a, 2) = PSORG2(b, 2)\n                Finish = \"True\"\n            ElseIf b = PSORG2RT Then\n                PSORG1(a, 2) = \"NULL\"\n                Finish = \"True\"\n            End If\n            b = b + 1\n        Loop Until Finish = \"True\"\n        a = a + 1\n    Loop Until a = PSORG1RT + 1\n\n    Sheets(\"Sheet2\").Select\n    Set Destination = Range(\"A1\")\n    Destination.Resize(UBound(PSORG1, 1), UBound(PSORG1, 2)).Value = PSORG1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1436966986, "post_id": 31431044, "comment_id": 50833900, "body": "In what ways?  Try to give full answers that allow OP and future users to understand the issue fully.   Including myself :-)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1436967272, "post_id": 31431044, "comment_id": 50834159, "body": "Thanks pointing me to find out more about fix which was all I needed to create a work around.  However, I think the above shows a access vba bug.  Info on fix can be found [here](<a href=\"https://msdn.microsoft.com/en-us/library/xh29swte(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/xh29swte(v=vs.90).as&zwnj;&#8203;px</a>"}], "tags": [], "owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "is_accepted": true, "score": 1, "last_activity_date": 1436964963, "creation_date": 1436964963, "answer_id": 31431044, "question_id": 31428248, "link": "https://stackoverflow.com/questions/31428248/in-access-vba-int-0-005-10-6-5001-really/31431044#31431044", "title": "In Access VBA int(-0.005 * (10 ^ 6)) = -5001 Really", "body": "<p>I think you need the Fix function - the issue is that you've got negative numbers so the idea of 'rounding up' changes.</p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1436968714, "post_id": 31432226, "comment_id": 50835375, "body": "Yes I see.  Thanks.  So does this mean that in the intermediate window any  numbers are treated as double by functions like int()."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1436970522, "post_id": 31432226, "comment_id": 50836810, "body": "Yes, you can be fooled this way, as you cannot Dim a variable here."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1436967961, "creation_date": 1436967961, "answer_id": 31432226, "question_id": 31428248, "link": "https://stackoverflow.com/questions/31428248/in-access-vba-int-0-005-10-6-5001-really/31432226#31432226", "title": "In Access VBA int(-0.005 * (10 ^ 6)) = -5001 Really", "body": "<p>There is no bug here, but you use Double which will introduce errors.</p>\n\n<p>Use Currency or Decimal instead:</p>\n\n<pre><code>? Int(-CCur(0.005) * 1000000)    \n? Int(-CDec(0.005) * 1000000)\n</code></pre>\n\n<p>Returns 5000.</p>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1436969150, "creation_date": 1436969150, "answer_id": 31432704, "question_id": 31428248, "link": "https://stackoverflow.com/questions/31428248/in-access-vba-int-0-005-10-6-5001-really/31432704#31432704", "title": "In Access VBA int(-0.005 * (10 ^ 6)) = -5001 Really", "body": "<p>Thanks for the help.</p>\n\n<p>My function ened up looking like this:</p>\n\n<pre><code>    Public Function RoundItUp(AValue As Double, DecimalPlaces As Integer, Optional RoundNegativeValuesUp As Boolean = False) As Variant\n\n        '\n        'Rounding up\n        '\n        'To round upwards towards the next highest number, take advantage of the way Int() rounds negative numbers downwards, like this:\n        '    - Int( - [MyField])\n        '\n        'As shown above, Int(-2.1) rounds down to -3. Therefore this expression rounds 2.1 up to 3.\n        '\n        'To round up to the higher cent, multiply by -100, round, and divide by -100:\n        '    Int(-100 * [MyField]) / -100\n        '\n        ' Note Decimal values must be used not double ones!  See below\n\n        Dim Multiplier As Long\n\n        If DecimalPlaces &lt;= 0 Then\n            RoundItUp = Null\n            Exit Function\n        End If\n\n        Multiplier = 10 ^ DecimalPlaces\n\n\n        ' Both the Int and Fix functions remove the fractional part of Number and return the resulting integer value.\n        ' The difference between Int and Fix functions is that if Number is negative,\n        ' Int returns the first negative integer less than or equal to Number, whereas\n        ' Fix returns the first negative integer greater than or equal to Number.\n        '\n        ' For example, Int converts -8.4 to -9, and Fix converts -8.4 to -8.\n        '\n        ' Fix(number) is equivalent to Sign(number) * Int(Abs(number)).\n\n        If AValue &lt; 0 And RoundNegativeValuesUp Then\n\n            RoundItUp = Fix(CDec(AValue * Multiplier)) / Multiplier\n\n        Else\n\n            RoundItUp = Int(CDec(AValue * Multiplier)) / Multiplier\n\n        End If\n\n\n\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 31431044, "answer_count": 3, "score": 0, "last_activity_date": 1436969150, "creation_date": 1436957113, "last_edit_date": 1436964305, "question_id": 31428248, "link": "https://stackoverflow.com/questions/31428248/in-access-vba-int-0-005-10-6-5001-really", "title": "In Access VBA int(-0.005 * (10 ^ 6)) = -5001 Really", "body": "<p>Consider this:</p>\n\n<p>Text from the access VBA debug window: </p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>? -0.005 * (10 ^ 6)\n-5000 ' Which is as you would expect\n\n? int(-5000)\n-5000 ' Which is as you would expect\n\n? int(-0.005 * (10 ^ 6))\n-5001 ' Which is NOT what I expected \n\n? Int(-0.005 * 1000000)\n-5001 ' Which is NOT what I expected \n</code></pre>\n\n<p>Here's the function I wrote which I expected to always round a number up to the number of decimal places shown.</p>\n\n<p>Am I missing something.  Does anyone know ho I might write a function to do this?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Public Function RoundItUp(AValue As Double, DecimalPlaces As Integer) As Variant\n        '\n        'Rounding up\n        '\n        'To round upwards towards the next highest number, take advantage of the way Int() rounds negative numbers downwards, like this:\n        '    - Int( - [MyField])\n        '\n        'As shown above, Int(-2.1) rounds down to -3. Therefore this expression rounds 2.1 up to 3.\n        '\n        'To round up to the higher cent, multiply by -100, round, and divide by -100:\n        '    Int(-100 * [MyField]) / -100\n\n        Dim Multiplier As Long\n\n        If DecimalPlaces &lt;= 0 Then\n            RoundItUp = Null\n            Exit Function\n        End If\n\n        Multiplier = 10 ^ DecimalPlaces\n\n        If AValue &lt; 0 Then\n\n            RoundItUp = Int(AValue)\n\n        Else\n\n            RoundItUp = -Int(-AValue * Multiplier) / Multiplier\n\n        End If\n\n\n\n    End Function\n</code></pre>\n\n<p>And more debug window text showing how I discovered the error:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>? rounditup(0.005,6)\n0.005001 \n\n? -AValue *  Multiplier\n-5000 \n\n? Int(-AValue * Multiplier)\n-5001 \n\n? int(-5000)\n-5000 \n\n? Int((-AValue * Multiplier))\n-5001 \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 180, "user_id": 4499392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcdc96efb22327d79f4c502f84968710?s=128&d=identicon&r=PG", "display_name": "Ad Wicks", "link": "https://stackoverflow.com/users/4499392/ad-wicks"}, "edited": false, "score": 0, "creation_date": 1436956536, "post_id": 31427950, "comment_id": 50826661, "body": "You could make a dictionary of the variations of spelling and then for each word in the string check it against the array of potential matches."}], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1436956604, "last_edit_date": 1495541910, "creation_date": 1436956604, "answer_id": 31428066, "question_id": 31427950, "link": "https://stackoverflow.com/questions/31427950/excel-vba-a-kind-of-fuzzy-match/31428066#31428066", "title": "Excel VBA, a kind of fuzzy match", "body": "<p>YMMV of course but two things to look at are:</p>\n\n<p><strong><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=15011\" rel=\"nofollow noreferrer\">Fuzzy Lookup Add-In for Excel</a></strong></p>\n\n<blockquote>\n  <p>... performs fuzzy matching of textual data in Microsoft Excel. It can\n  be used to identify fuzzy duplicate rows within a single table or to\n  fuzzy join similar rows between two different tables. The matching is\n  robust to a wide variety of errors including spelling mistakes,\n  abbreviations, synonyms and added/missing data.</p>\n</blockquote>\n\n<p>Calculating the <a href=\"https://stackoverflow.com/questions/4243036/levenshtein-distance-in-excel\">Levenshtein Distance</a> may also be useful.</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 4942465, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1056677347694312/picture?type=large", "display_name": "Nick Dragosh", "link": "https://stackoverflow.com/users/4942465/nick-dragosh"}, "edited": false, "score": 0, "creation_date": 1436957319, "post_id": 31428168, "comment_id": 50827110, "body": "Thank you all for your responses. I will have a crack at it."}], "tags": [], "owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1436956871, "creation_date": 1436956871, "answer_id": 31428168, "question_id": 31427950, "link": "https://stackoverflow.com/questions/31427950/excel-vba-a-kind-of-fuzzy-match/31428168#31428168", "title": "Excel VBA, a kind of fuzzy match", "body": "<p>Here is a VBA implementation of the Levenshein Distance. You can adjust the threshold to fit your needs.</p>\n\n<pre><code>Public Function Levenshtein(str1 As String, str2 As String) As Integer\nOn Error GoTo ErrHandler\n    Dim arrLev, intLen1 As Integer, intLen2 As Integer, i As Integer\n    Dim j, arrStr1, arrStr2, intMini As Integer\n\n    intLen1 = Len(str1)\n    ReDim arrStr1(intLen1 + 1)\n    intLen2 = Len(str2)\n\n    ReDim arrStr2(intLen2 + 1)\n    ReDim arrLev(intLen1 + 1, intLen2 + 1)\n\n    arrLev(0, 0) = 0\n    For i = 1 To intLen1\n        arrLev(i, 0) = i\n        arrStr1(i) = Mid(str1, i, 1)\n    Next\n\n    For j = 1 To intLen2\n        arrLev(0, j) = j\n        arrStr2(j) = Mid(str2, j, 1)\n    Next\n\n    For j = 1 To intLen2\n        For i = 1 To intLen1\n            If arrStr1(i) = arrStr2(j) Then\n                arrLev(i, j) = arrLev(i - 1, j - 1)\n            Else\n                intMini = arrLev(i - 1, j) 'deletion\n                If intMini &gt; arrLev(i, j - 1) Then intMini = arrLev(i, j - 1) 'insertion\n                If intMini &gt; arrLev(i - 1, j - 1) Then intMini = arrLev(i - 1, j - 1) 'deletion\n\n                arrLev(i, j) = intMini + 1\n            End If\n        Next\n    Next\n\n    Levenshtein = arrLev(intLen1, intLen2)\n    Exit Function\n\nErrHandler:\n    MsgBox Err.Description\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": false, "score": 0, "last_activity_date": 1436956893, "last_edit_date": 1495535059, "creation_date": 1436956893, "answer_id": 31428179, "question_id": 31427950, "link": "https://stackoverflow.com/questions/31427950/excel-vba-a-kind-of-fuzzy-match/31428179#31428179", "title": "Excel VBA, a kind of fuzzy match", "body": "<p>You could use the Soundex2 algorithm to match similar-sounding words. <a href=\"https://stackoverflow.com/questions/1607690/finding-similar-sounding-text-in-vba/1607709#1607709\">This SO post</a> has some pointers on soundex in VBA.<br>\nNote that the algorithm relies on characteristics predominantly found in English.</p>\n"}, {"tags": [], "owner": {"reputation": 235, "user_id": 5069335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1162b95b37e32225c314ba2fc124385?s=128&d=identicon&r=PG&f=1", "display_name": "citywall", "link": "https://stackoverflow.com/users/5069335/citywall"}, "is_accepted": true, "score": 0, "last_activity_date": 1436956965, "creation_date": 1436956965, "answer_id": 31428205, "question_id": 31427950, "link": "https://stackoverflow.com/questions/31427950/excel-vba-a-kind-of-fuzzy-match/31428205#31428205", "title": "Excel VBA, a kind of fuzzy match", "body": "<p>The concept you are looking for is called \"full text search\".</p>\n\n<p>I'm not a 100 % sure, but I think that is it not native in Excel nor VBA.\nTo my best knowledge not even MS Access supports this.</p>\n\n<p>Check out the Add-In suggested by Alex K or look at embedding a real database in your app.</p>\n"}], "owner": {"reputation": 375, "user_id": 4942465, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1056677347694312/picture?type=large", "display_name": "Nick Dragosh", "link": "https://stackoverflow.com/users/4942465/nick-dragosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5903, "favorite_count": 1, "accepted_answer_id": 31428205, "answer_count": 4, "score": 0, "last_activity_date": 1436956965, "creation_date": 1436956274, "question_id": 31427950, "link": "https://stackoverflow.com/questions/31427950/excel-vba-a-kind-of-fuzzy-match", "title": "Excel VBA, a kind of fuzzy match", "body": "<p>I want to automate a script in Excel VBA and I am stuck.</p>\n\n<p>I have a string = \"The patient population is x. From this, a lot of patients are males. A particular male patint has 3 deadly diseases.\" (the strings will be longer)</p>\n\n<p>Now what i want to do is search how many times the word \"patient\" appears in this string even if the words have spell problems and how are they written. </p>\n\n<p>My ideea was to let`s say match with a confidence of 80% the word \"patient\" with all the words in the string and the result i am aiming for is .. there are 3 matches and the words that are in the string :\"patient\",\"patients\",\"patint \".\nIs there a way to do this?</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2013"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 5679526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6Zqu.jpg?s=128&g=1", "display_name": "zan_li", "link": "https://stackoverflow.com/users/5679526/zan-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1458346766, "creation_date": 1458346766, "answer_id": 36096351, "question_id": 31427591, "link": "https://stackoverflow.com/questions/31427591/receive-data-from-sharepoint-2013-excel-workbook-using-vba-excel/36096351#36096351", "title": "Receive data from SharePoint 2013 Excel-workbook using VBA Excel", "body": "<p>I can only give you a partial answer.  The GUIDs come from the 'Modify View' URL in SharePoint.  Say you go to a given list and view that you like, then you select the menu to modify that view.  Once on that page, you take that entire URL and deobfuscate it either manually or using a web based solution.  That should leave you with a GUID next to the list and view sections.  </p>\n\n<p><a href=\"http://i.stack.imgur.com/FXhG5.jpg\" rel=\"nofollow\">Picture of Menu - from walkthrough</a></p>\n\n<p>As for permissions, I suspect you need contribute permissions to the list to get the GUIDs.  I'm not sure if there is another way to find the URL with the list and view GUIDs visible without going to that page. (I would suspect, but am not certain, that you need only read permissions to actually pull the report in Excel.)</p>\n\n<blockquote>\n  <p>To create a personal view, you must have the contribute permission level for the list or library, such as by being member of the default site name Member group. To create a public view, you must have the design permission level for the list or library, such as by being member of the default Designer SharePoint group for the site.</p>\n</blockquote>\n\n<p>-from Office Support site \"<a href=\"https://support.office.com/en-us/article/Create-modify-or-delete-a-view-10c68afb-d901-4b15-848b-82d399eba089\" rel=\"nofollow\">Create, modify, or delete a view</a>\"</p>\n"}], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458346766, "creation_date": 1436955357, "last_edit_date": 1492087279, "question_id": 31427591, "link": "https://stackoverflow.com/questions/31427591/receive-data-from-sharepoint-2013-excel-workbook-using-vba-excel", "title": "Receive data from SharePoint 2013 Excel-workbook using VBA Excel", "body": "<p>I have 2 questions.</p>\n\n<p>1) Which SP Access/Rights do I need to be able to make this work? </p>\n\n<p>I have looked at <a href=\"https://sharepoint.stackexchange.com/questions/29021/import-sharepoint-list-into-excel-using-vba-only\">https://sharepoint.stackexchange.com/questions/29021/import-sharepoint-list-into-excel-using-vba-only</a> but I am still unable to find my GUIDs (LISTNAME/VIEWNAME). I guess I might be missing SP Rights?</p>\n\n<p>2) Is it possible first to run some <code>IF-statements</code> that will match data from the SP Excel workbook with data in my desktop Excel workbook? This would be a sort of security check, to make sure that data only will be transfered if these statements are answered correct.  </p>\n\n<p>Any help will truely be appreciated as I have no experience with VBA links to SP.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": false, "score": 1, "last_activity_date": 1436956299, "creation_date": 1436956299, "answer_id": 31427957, "question_id": 31427445, "link": "https://stackoverflow.com/questions/31427445/conditional-elseif-does-not-work/31427957#31427957", "title": "Conditional ELSEIF does not work", "body": "<p>Your conditions like:</p>\n\n<pre><code>1 &lt; a &lt;= 10 \n</code></pre>\n\n<p>are always true. First part <code>(1 &lt; a)</code> evaluates to <code>True</code> or <code>False</code> and then it is converted to integer (<code>True</code> = <code>1</code>, <code>False</code> = <code>0</code>). Both values are <code>&lt;=10</code>.</p>\n\n<p>You should change thes conditions to:</p>\n\n<pre><code>(1 &lt; a) And (a &lt;= 10)\n</code></pre>\n\n<p>Brackets are optional, comparison operators have higher precedence. </p>\n"}, {"tags": [], "owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "is_accepted": false, "score": 0, "last_activity_date": 1436958364, "creation_date": 1436958364, "answer_id": 31428702, "question_id": 31427445, "link": "https://stackoverflow.com/questions/31427445/conditional-elseif-does-not-work/31428702#31428702", "title": "Conditional ELSEIF does not work", "body": "<p>user3964075 nailed the core issue.  I think making the code a little bit more readable will help to filter out other possible trouble areas.  Why do you set the value of 'z' and then not use it?</p>\n\n<pre><code>  z = CLng(NumData / 8) \n</code></pre>\n\n<p>Where are the variables d, e, f...; Range2, Range3, Range4...; Acc_Sum2, Acc_Sum3... assigned, and what are they doing?  Can each group be replaced by a single variable?</p>\n\n<p>You may also want to create a simple Between function \nto clean up a lot of your conditional statements.</p>\n\n<pre><code> Public Function Between(x As Integer, min As Integer, max As Integer) As Boolean\n     Between = x &lt;= max And x &gt;= min\n End Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd1e25f9cdcbfca15721bfaae4817751?s=128&d=identicon&r=PG&f=1", "display_name": "Pandan", "link": "https://stackoverflow.com/users/5118780/pandan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436965899, "creation_date": 1436965899, "answer_id": 31431368, "question_id": 31427445, "link": "https://stackoverflow.com/questions/31427445/conditional-elseif-does-not-work/31431368#31431368", "title": "Conditional ELSEIF does not work", "body": "<p>Thanks, user3964075 &amp; Carl for your prompt response. It's worked! Carl, the z variable was slotted in when I was trying to figure out the problem. I thought it would be too much to post the whole code. It does require a lot of cleaning up. Appreciate your tips. </p>\n"}], "owner": {"reputation": 1, "user_id": 5118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd1e25f9cdcbfca15721bfaae4817751?s=128&d=identicon&r=PG&f=1", "display_name": "Pandan", "link": "https://stackoverflow.com/users/5118780/pandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1436965899, "creation_date": 1436954890, "last_edit_date": 1436955364, "question_id": 31427445, "link": "https://stackoverflow.com/questions/31427445/conditional-elseif-does-not-work", "title": "Conditional ELSEIF does not work", "body": "<p>Not sure how to solve this. \"a\" was meant to start from 1 to NumData, but I have deliberately change the start from 44200 to check the ELSEIF. For NumData = 117,350, </p>\n\n<p>I would expect the 3rd ELSEIF to be activated. Instead throughout the whole run, it only step-into the first ELSEIF even though the \"a\" value does not meet the conditions. </p>\n\n<p>What should I do?</p>\n\n<pre><code>For a = 44200 To NumData 'Int1\n    If a &gt; 1 Then\n        If UCase(Trim(Range1(a, 3))) = UCase(Trim(Range1(a - 1, 3))) Then\n            GoTo Line1 'Next count loop if next Platform name the same\n        End If\n    End If\n\n        For b = 1 To NumData\n            lat1 = Range1(a, 5)\n            lat2 = Range1(b, 5)\n            long1 = Range1(a, 6)\n            long2 = Range1(b, 6)\n            CompRad = Dist(lat1, lat2, long1, long2)\n\n            If (CompRad &lt;= Radius And CompRad &gt;= 0) Then\n                z = CLng(NumData / 8)\n                If a &lt;= CLng(NumData / 8) Then\n                    For c = 1 To 6\n                        Range2(d, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum2 = Acc_Sum2 + Range2(d, 4)\n                    d = d + 1\n                ElseIf CLng(NumData / 8) &lt; a &lt;= 2 * CLng(NumData / 8) Then\n                    z = 2 * CLng(NumData / 8)\n                    For c = 1 To 6\n                        Range3(e, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum3 = Acc_Sum3 + Range3(e, 4)\n                    e = e + 1\n                ElseIf 2 * CLng(NumData / 8) &lt; a &lt;= 3 * CLng(NumData / 8) Then\n                    For c = 1 To 6\n                        Range4(f, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum4 = Acc_Sum4 + Range4(f, 4)\n                    f = f + 1\n                ElseIf 3 * CLng(NumData / 8) &lt; a &lt;= 4 * CLng(NumData / 8) Then\n                    z = 3 * CLng(NumData / 8)\n                    For c = 1 To 6\n                        Range5(g, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum5 = Acc_Sum5 + Range5(g, 4)\n                    g = g + 1\n                ElseIf 4 * CLng(NumData / 8) &lt; a &lt;= 5 * CLng(NumData / 8) Then\n                    For c = 1 To 6\n                        Range6(h, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum6 = Acc_Sum6 + Range6(h, 4)\n                    h = h + 1\n                ElseIf 5 * CLng(NumData / 8) &lt; a &lt;= 6 * CLng(NumData / 8) Then\n                    For c = 1 To 6\n                        Range7(i, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum7 = Acc_Sum7 + Range7(i, 4)\n                    i = i + 1\n                ElseIf 6 * CLng(NumData / 8) &lt; a &lt;= 7 * CLng(NumData / 8) Then\n                    For c = 1 To 6\n                        Range8(j, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum8 = Acc_Sum8 + Range8(j, 4)\n                    j = j + 1\n                ElseIf 7 * CLng(NumData / 8) &lt; a &lt;= NumData Then\n                    For c = 1 To 6\n                        Range9(k, c) = Range1(b, c)\n                    Next c\n                    Acc_Sum9 = Acc_Sum9 + Range9(k, 4)\n                    k = k + 1\n                End If\n            End If\n        Next b\n</code></pre>\n\n<p>Line1:</p>\n\n<pre><code>Next a\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 994, "user_id": 3512224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e0819faf0bafba4b48b12c5f13bd103?s=128&d=identicon&r=PG&f=1", "display_name": "quantum285", "link": "https://stackoverflow.com/users/3512224/quantum285"}, "is_accepted": true, "score": 1, "last_activity_date": 1436955713, "creation_date": 1436955713, "answer_id": 31427726, "question_id": 31427086, "link": "https://stackoverflow.com/questions/31427086/evaluating-togglebutton-on-specific-worksheet/31427726#31427726", "title": "Evaluating ToggleButton on specific worksheet", "body": "<p>Simply:</p>\n\n<pre><code>Public Sub Check_Button()\nIf Sheets(\"sheet1\").ToggleButton1.Value = True Then\n    Debug.Print \"true\"\nElse\n    Debug.Print \"false\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>And whilst it's probably not good practice it's worth mentioning you can lose the <code>\".Value\"</code> as such:</p>\n\n<pre><code>If Sheets(\"sheet1\").ToggleButton1 = True Then\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 3392896, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/857c5585516e72d24b37cea8387c1a22?s=128&d=identicon&r=PG&f=1", "display_name": "malte", "link": "https://stackoverflow.com/users/3392896/malte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 31427726, "answer_count": 1, "score": 0, "last_activity_date": 1436955713, "creation_date": 1436953953, "last_edit_date": 1531161705, "question_id": 31427086, "link": "https://stackoverflow.com/questions/31427086/evaluating-togglebutton-on-specific-worksheet", "title": "Evaluating ToggleButton on specific worksheet", "body": "<p>How can I evaluate the status of a toggle button on a specific worksheet?</p>\n\n<p>If my code is stored with the specific worksheet, I can just refer to the name of the button:</p>\n\n<pre><code>Private Sub ToggleButton1_Click()\nIf ToggleButton1.Value = True Then\n    Debug.Print \"true\"\nElse\n    Debug.Print \"false\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>However, if my code is stored in a module the above method does not worked. I have tried the following but it also does not work:</p>\n\n<pre><code>Public Sub Check_Button()\nIf Sheets(\"sheet1\").OLEObjects(\"ToggleButton1\").Value = True Then\n    Debug.Print \"true\"\nElse\n    Debug.Print \"false\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1436970704, "post_id": 31426723, "comment_id": 50836951, "body": "Google  terms like &quot;control powerpoint from excel&quot; or &quot;automate powerpoint from excel&quot; (without the quotes) to get lots of code examples.  That&#39;ll get you considerably closer. You&#39;ll need to open the presentation you want to work with.  From there, how will you know which slide the image is on?  You can find the image by looping through all the shapes on the slide checking each for an ID match.  The shape&#39;s .Top property will give you the Y coordinate (relative to the top of the slide, in Points)"}, {"owner": {"reputation": 23, "user_id": 4619158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c96385e6534348e9a91dceef026979?s=128&d=identicon&r=PG&f=1", "display_name": "destro", "link": "https://stackoverflow.com/users/4619158/destro"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1437032215, "post_id": 31426723, "comment_id": 50864347, "body": "Thanks! The image and slides are fairly static, so they&#39;ll always have the same image ID and it will always be the e.g. second slide. I&#39;ll give it a go"}], "owner": {"reputation": 23, "user_id": 4619158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c96385e6534348e9a91dceef026979?s=128&d=identicon&r=PG&f=1", "display_name": "destro", "link": "https://stackoverflow.com/users/4619158/destro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436952960, "creation_date": 1436952960, "question_id": 31426723, "link": "https://stackoverflow.com/questions/31426723/get-powerpoint-data-using-excel-vba", "title": "Get Powerpoint data using Excel VBA", "body": "<p>I got a couple of pictures on a scroll bar, that can be positioned independently. Now I want to run a script in Excel, that creates a Powerpoint instance and gets the Y-coordinate of a picture by its image ID.</p>\n\n<pre><code>Dim PPApp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.Slide\n\nSet PPApp = CreateObject(\"Powerpoint.Application\")\n\nPPApp.Visible = True\n</code></pre>\n\n<p>That's what I got so far, to create a Powerpoint instance. Now I don't really know how to tell Excel/VBA which ppt to read &amp; how to give me the Y-coordinate on slide XY.</p>\n"}, {"tags": ["excel", "vba", "visual-studio", "csv"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436956554, "post_id": 31425972, "comment_id": 50826666, "body": "What you want change name, file or sheet?"}, {"owner": {"reputation": 1, "user_id": 4214217, "user_type": "registered", "profile_image": "https://graph.facebook.com/2239439/picture?type=large", "display_name": "Sudric87", "link": "https://stackoverflow.com/users/4214217/sudric87"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1437033353, "post_id": 31425972, "comment_id": 50864953, "body": "File name, not sheet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4214217, "user_type": "registered", "profile_image": "https://graph.facebook.com/2239439/picture?type=large", "display_name": "Sudric87", "link": "https://stackoverflow.com/users/4214217/sudric87"}, "edited": false, "score": 0, "creation_date": 1437033388, "post_id": 31428094, "comment_id": 50864979, "body": "Thanks for I actually need to change the file name, i.e. workbook name based on the value of cell A3 in the workbook itself."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436956666, "creation_date": 1436956666, "answer_id": 31428094, "question_id": 31425972, "link": "https://stackoverflow.com/questions/31425972/change-spreadsheet-name-based-on-timestamp-in-spreadsheet-cell/31428094#31428094", "title": "Change Spreadsheet name based on timestamp in spreadsheet cell", "body": "<p>You can use as follow:</p>\n\n<pre><code>'Loop all sheet from workbook\nFor Each aSheet In Worksheets\n\n    'Actually, sheet name not accept \"/\", \"\\\" and \":\".\n    'So, I change format as follow and change sheet name.\n    aSheet.Name = Format(aSheet.Range(\"A3\"), \"dd-mm-yyyy hh-mm-ss\")\n\nNext aSheet\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4214217, "user_type": "registered", "profile_image": "https://graph.facebook.com/2239439/picture?type=large", "display_name": "Sudric87", "link": "https://stackoverflow.com/users/4214217/sudric87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594196040, "creation_date": 1436951033, "last_edit_date": 1594196040, "question_id": 31425972, "link": "https://stackoverflow.com/questions/31425972/change-spreadsheet-name-based-on-timestamp-in-spreadsheet-cell", "title": "Change Spreadsheet name based on timestamp in spreadsheet cell", "body": "<p>I have about a 1000 files in the following format:</p>\n\n<ul>\n<li>YYYYMMDD_HHMM - 5Min.csv</li>\n<li>YYYYMMDD_HHMM - Hourly.csv</li>\n</ul>\n\n<p>For example: </p>\n\n<ul>\n<li>20150701_1259 - Hourly.csv</li>\n<li>20150701_1300 - 5Min.csv</li>\n</ul>\n\n<p>etc...</p>\n\n<p>Except the timestamp is different for each file. Inside each CSV are various figures but the most important is the timestamp in cell A3 in the form:</p>\n\n<p>DD/MM/YYYY HH:MM:SS</p>\n\n<p>What I need to do is grab the timestamp INSIDE the sheet and change the file name of that spreadsheet to this timestamp.</p>\n\n<p>I am quite familiar with excel/macros/VBA. However, I am not sure how to go about this outside of excel. I know it has to do with command prompt and most likely creating a Visual Basic code.</p>\n\n<p>If anyone can provide any info on how to start that would be great. I have Visual Studio Express installed but am not very familiar with it but more than willing to learn!</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 4144995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://lh3.googleusercontent.com/-O_Mtu9ao818/AAAAAAAAAAI/AAAAAAAAAJ0/gqZrykBXfzs/photo.jpg?sz=128", "display_name": "S K padala", "link": "https://stackoverflow.com/users/4144995/s-k-padala"}, "edited": false, "score": 0, "creation_date": 1436952606, "post_id": 31426549, "comment_id": 50824199, "body": "can you be some more clear. what is out-in cell dropdown option."}, {"owner": {"reputation": 231, "user_id": 4144995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://lh3.googleusercontent.com/-O_Mtu9ao818/AAAAAAAAAAI/AAAAAAAAAJ0/gqZrykBXfzs/photo.jpg?sz=128", "display_name": "S K padala", "link": "https://stackoverflow.com/users/4144995/s-k-padala"}, "edited": false, "score": 0, "creation_date": 1436957529, "post_id": 31426549, "comment_id": 50827250, "body": "Thanks @Poof. It&#39;s working but the can we customize the error alert box that comes after entering a wrong value"}, {"owner": {"reputation": 169, "user_id": 5092236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9dea858559fb747eafd9f9896cd470?s=128&d=identicon&r=PG&f=1", "display_name": "Poof", "link": "https://stackoverflow.com/users/5092236/poof"}, "reply_to_user": {"reputation": 231, "user_id": 4144995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://lh3.googleusercontent.com/-O_Mtu9ao818/AAAAAAAAAAI/AAAAAAAAAJ0/gqZrykBXfzs/photo.jpg?sz=128", "display_name": "S K padala", "link": "https://stackoverflow.com/users/4144995/s-k-padala"}, "edited": false, "score": 0, "creation_date": 1436959913, "post_id": 31426549, "comment_id": 50828763, "body": "Yes. While creating validation there are 3 tabs: Settings,Input message,Error alert. Select the third one and there you can change the message that will appear after inputting wrong value."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1436963983, "post_id": 31426549, "comment_id": 50831568, "body": "I didn&#39;t realise you could do the validation without displaying the dropdown. Handy to know but I&#39;m not sure if I&#39;ll ever find an application for it. Unless, maybe, you have the validation words in a range immediately above the cells you are filling to take advantage of autocomplete."}], "tags": [], "owner": {"reputation": 169, "user_id": 5092236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9dea858559fb747eafd9f9896cd470?s=128&d=identicon&r=PG&f=1", "display_name": "Poof", "link": "https://stackoverflow.com/users/5092236/poof"}, "is_accepted": true, "score": 2, "last_activity_date": 1436952737, "last_edit_date": 1436952737, "creation_date": 1436952539, "answer_id": 31426549, "question_id": 31425681, "link": "https://stackoverflow.com/questions/31425681/how-to-limit-excel-column-to-limited-number-of-words/31426549#31426549", "title": "how to limit excel column to limited number of words", "body": "<p>Hey you should be able to do it just like dropdown list but without in-cell dropdown option marked. Its an option that is automaticly marked when you validate column by list in validation form.</p>\n"}], "owner": {"reputation": 231, "user_id": 4144995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://lh3.googleusercontent.com/-O_Mtu9ao818/AAAAAAAAAAI/AAAAAAAAAJ0/gqZrykBXfzs/photo.jpg?sz=128", "display_name": "S K padala", "link": "https://stackoverflow.com/users/4144995/s-k-padala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 31426549, "answer_count": 1, "score": 1, "last_activity_date": 1436952737, "creation_date": 1436950193, "last_edit_date": 1531161705, "question_id": 31425681, "link": "https://stackoverflow.com/questions/31425681/how-to-limit-excel-column-to-limited-number-of-words", "title": "how to limit excel column to limited number of words", "body": "<p>I'm working with VBA, Excel. I have some set of words, say 10. </p>\n\n<p>When I choose a particular column, then what ever I enter in that coulmn must be from those selected set of words. </p>\n\n<p>It's like dropdown list but I really donot want to use dropdown list. This must be done to a column(or set of cells).</p>\n"}, {"tags": ["excel", "vba", "charts", "title"], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 97, "user_id": 4978108, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/663dc6868e6100b80bba674020008c91?s=128&d=identicon&r=PG&f=1", "display_name": "adventurer", "link": "https://stackoverflow.com/users/4978108/adventurer"}, "edited": false, "score": 0, "creation_date": 1437311377, "post_id": 31459295, "comment_id": 50965913, "body": "Great. Mark it as an answer."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 0, "last_activity_date": 1437062689, "creation_date": 1437062689, "answer_id": 31459295, "question_id": 31425137, "link": "https://stackoverflow.com/questions/31425137/give-title-to-multiple-charts-with-the-text-in-the-merged-cells-in-row-1/31459295#31459295", "title": "Give title to multiple charts with the text in the merged cells in row 1", "body": "<p>Make sure the chart has a title, then link the title to the first cell of the merged block in the first row.</p>\n\n<pre><code>With cht1\n    .SetSourceData rChtDat1, xlColumns\n    .HasTitle = True\n    .ChartTitle.Text = \"=\" &amp; rUsed.Cells(1, iColMerge).Address(, , , True)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4978108, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/663dc6868e6100b80bba674020008c91?s=128&d=identicon&r=PG&f=1", "display_name": "adventurer", "link": "https://stackoverflow.com/users/4978108/adventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 31459295, "answer_count": 1, "score": 2, "last_activity_date": 1437062689, "creation_date": 1436948577, "question_id": 31425137, "link": "https://stackoverflow.com/questions/31425137/give-title-to-multiple-charts-with-the-text-in-the-merged-cells-in-row-1", "title": "Give title to multiple charts with the text in the merged cells in row 1", "body": "<p><a href=\"http://bit.ly/1CG7T4c\" rel=\"nofollow\">http://bit.ly/1CG7T4c</a> this link shows the sample data and the charts I am obtaining by running the code given below. I have dynamic number of departments.</p>\n\n<p>I want each chart to take the titles as the respective department names i.e. those given in each of the merged cells above the data for each chart.</p>\n\n<p>Kindly suggest me a code for the same.</p>\n\n<pre><code> Option Explicit\n\n Sub PlotSeparateChartsByMergedFirstRow()\n Dim rUsed As Range, rMerged As Range, rChtData As Range\n Dim rChtDat1 As Range, rChtDat2 As Range\n Dim iColMerge As Long, iColData As Long\n Dim cht1 As Chart, cht2 As Chart\n\n Const iChtHeight As Double = 175\n\n Set rUsed = ActiveSheet.UsedRange\n iColMerge = 1\n\n Do\n iColMerge = iColMerge + 1\n If iColMerge &gt; rUsed.Columns.Count Then Exit Do\n\n If rUsed.Cells(1, iColMerge).MergeCells Then\n Set rMerged = rUsed.Cells(1, iColMerge).MergeArea\n Set rChtData = rMerged.Resize(rUsed.Rows.Count)\n\n ' x values\n Set rChtDat1 = rUsed.Columns(1)\n Set rChtDat2 = rUsed.Columns(1)\n\n ' y values\n For iColData = 1 To rChtData.Columns.Count - 1 Step 2\n Set rChtDat1 = Union(rChtDat1, rChtData.Columns(iColData))\n Set rChtDat2 = Union(rChtDat2, rChtData.Columns(iColData + 1))\n Next\n\n ' charts\n ' 2007, 2010\n Set cht1 = ActiveSheet.Shapes.AddChart(xlColumnClustered, rChtData.Left,        rChtData.Height, rChtData.Width, iChtHeight).Chart\n\n With cht1\n .SetSourceData rChtDat1, xlColumns\n End With\n\n ' 2007, 2010\n Set cht2 = ActiveSheet.Shapes.AddChart(xlColumnClustered, rChtData.Left, rChtData.Height + iChtHeight, rChtData.Width, iChtHeight).Chart\n\n With cht2\n .SetSourceData rChtDat2, xlColumns\n End With\n\n nd If\n iColMerge = iColMerge + rMerged.Columns.Count - 1\n Loop\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 4, "creation_date": 1436948419, "post_id": 31425023, "comment_id": 50821563, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/12200834/break-out-of-a-while-wend-loop-in-vba\">Break out of a While...Wend loop in VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1436975382, "creation_date": 1436975382, "answer_id": 31435181, "question_id": 31425023, "link": "https://stackoverflow.com/questions/31425023/vba-how-to-stop-the-while-loop/31435181#31435181", "title": "VBA How to stop the While loop", "body": "<p>As far as I can see, you're not resetting your variables you're using within your loop</p>\n\n<p>Without more of the code, it's a bit difficult to say what exactly is the issue but try the following...</p>\n\n<pre><code>While Sheets(\"Temp BU v2\").Cells(1, iColCountTempList) &lt;&gt; \"\"\n    If sChooseTemp = Sheets(\"Temp BU v2\").Cells(1, iColCountTempList) Then\n        MsgBox \"WHOOHOO!\"\n        iRow = 1\n        While Sheets(\"Temp BU v2\").Cells(iRow, iColCountTempList) &lt;&gt; \"\"\n            If sChooseTempCont = iRow Then\n                MsgBox \"YEAH!\"\n                sFinalMail = Sheets(\"Temp BU v2\").Cells(iRow, iColCountTempList)\n            Else\n                iRow = iRow + 1\n            End If\n        Wend\n    Else\n        iColCountTempList = iColCountTempList + 1\n    End If\nWend\n</code></pre>\n\n<blockquote>\n  <p>On a separate note; this isn't a great technique for matching. You may want to consider using a .find function instead or a match/index solution. Also using Do loops is normally preferable to While loops</p>\n</blockquote>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1436977346, "creation_date": 1436948201, "last_edit_date": 1436977346, "question_id": 31425023, "link": "https://stackoverflow.com/questions/31425023/vba-how-to-stop-the-while-loop", "title": "VBA How to stop the While loop", "body": "<p>I can't stop the second loop. It just keeps incrementing. How do I stop a While Loop in VBA? </p>\n\n<pre><code>While Sheets(\"Temp BU v2\").Cells(1, iColCountTempList) &lt;&gt; \"\"\n    If sChooseTemp = Sheets(\"Temp BU v2\").Cells(1, iColCountTempList) Then\n        MsgBox \"WHOOHOO!\"\n        While Sheets(\"Temp BU v2\").Cells(iRow, iColCountTempList) &lt;&gt; \"\"\n            If sChooseTempCont = iRow Then\n                MsgBox \"YEAH!\"\n                sFinalMail = Sheets(\"Temp BU v2\").Cells(iRow, iColCountTempList)\n            Else\n                iRow = iRow + 1\n            End If\n        Wend\n    Else\n        iColCountTempList = iColCountTempList + 1\n    End If\nWend\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1436950501, "post_id": 31424768, "comment_id": 50822855, "body": "I&#39;ve updated my answer to explain what i mean by &#39;same level&#39; ... Also ... what version of Outlook are you using?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1436986095, "post_id": 31424768, "comment_id": 50846818, "body": "Is that an Exchange mailbox? Is it already open in Outlook?"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436948522, "post_id": 31424927, "comment_id": 50821622, "body": "Thanks but this doesn&#39;t appear to be working, it says an object could not be found"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436948625, "post_id": 31424927, "comment_id": 50821681, "body": "Can you post an image of your folder structure? Also, that link deals with other cases where the folder is at a different level :0)"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436948751, "post_id": 31424927, "comment_id": 50821755, "body": "please see updated question with outlook folder structure"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436949537, "post_id": 31424927, "comment_id": 50822228, "body": "Are <code>account1@hewden.co.uk</code> and <code>NewSuppliers@hewden.co.uk</code> on the same level?"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436949944, "post_id": 31424927, "comment_id": 50822490, "body": "what do you mean by same level?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1436950145, "post_id": 31424927, "comment_id": 50822623, "body": "Where is that folder is located relative to the top and/or Inbox folder?"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1436950578, "post_id": 31424927, "comment_id": 50822901, "body": "@3-14159265358979323846264 I think I understand what you mean, however newsuppliers@hewden.co.uk is a completely different account/mailbox"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1436950608, "post_id": 31424927, "comment_id": 50822919, "body": "Try <code>olNs.GetSharedDefaultFolder(&quot;NewSuppliers@Hewden.co.uk&quot;)</code>"}, {"owner": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1554422775, "post_id": 31424927, "comment_id": 97757157, "body": "@0m3r I am trying to do something similar <a href=\"https://stackoverflow.com/questions/55526145/excel-vba-create-meeting-in-non-default-calendar\" title=\"excel vba create meeting in non default calendar\">stackoverflow.com/questions/55526145/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 0, "last_activity_date": 1436950267, "last_edit_date": 1436950267, "creation_date": 1436947896, "answer_id": 31424927, "question_id": 31424768, "link": "https://stackoverflow.com/questions/31424768/scan-non-default-outlook-inbox-for-email/31424927#31424927", "title": "Scan non default outlook inbox for email?", "body": "<p>You need to use the following, assuming that the folder you want is at the same level in the folder hierarchy</p>\n\n<pre><code>Set Items = Session.GetDefaultFolder(olFolderCalendar).Parent.Folders(\"YouFolderName\").Items\n</code></pre>\n\n<p>See here for more details ... <a href=\"http://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/\" rel=\"nofollow noreferrer\">http://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/</a></p>\n\n<hr>\n\n<p>Have you tried the following function from the above link ...</p>\n\n<pre><code>Function GetFolderPath(ByVal FolderPath As String) As Outlook.Folder\nDim oFolder As Outlook.Folder\nDim FoldersArray As Variant\nDim i As Integer\n\nOn Error GoTo GetFolderPath_Error\nIf Left(FolderPath, 2) = \"\\\\\" Then\n    FolderPath = Right(FolderPath, Len(FolderPath) - 2)\nEnd If\n'Convert folderpath to array\nFoldersArray = Split(FolderPath, \"\\\")\nSet oFolder = Application.Session.Folders.item(FoldersArray(0))\nIf Not oFolder Is Nothing Then\n    For i = 1 To UBound(FoldersArray, 1)\n        Dim SubFolders As Outlook.Folders\n        Set SubFolders = oFolder.Folders\n        Set oFolder = SubFolders.item(FoldersArray(i))\n        If oFolder Is Nothing Then\n            Set GetFolderPath = Nothing\n        End If\n    Next\nEnd If\n'Return the oFolder\nSet GetFolderPath = oFolder\nExit Function\n\nGetFolderPath_Error:\nSet GetFolderPath = Nothing\nExit Function\nEnd Function\n</code></pre>\n\n<p>You may need to use the technique here first to find out the actual folder name ... <a href=\"https://msdn.microsoft.com/en-us/library/office/ff184607.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff184607.aspx</a></p>\n\n<hr>\n\n<p>In the image below, the Drafts, Clients, Outbox folders are all on the same level (they share the same parent folder james@...com), but the ChildFolder folder is not (it's parent is Drafts).</p>\n\n<p><img src=\"https://i.stack.imgur.com/70aeu.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1436953285, "creation_date": 1436953285, "answer_id": 31426830, "question_id": 31424768, "link": "https://stackoverflow.com/questions/31424768/scan-non-default-outlook-inbox-for-email/31426830#31426830", "title": "Scan non default outlook inbox for email?", "body": "<p>You should be able to just specify the name of your 2nd mailbox as a Folder.</p>\n\n<pre><code>Set Fldr = olNs.Folders(\"My 2nd mailbox\").Folders(\"Sub Folder\")\n</code></pre>\n\n<p>If you want the main inbox of the 2nd account, then you specify this as the sub folder of the account.</p>\n\n<pre><code>Set Fldr = olNs.Folders(\"My 2nd Inbox\").Folders(\"Inbox\")\n</code></pre>\n\n<p>Note that it's the name of the mailbox you use, not the e-mail address. Let me know how you get on.</p>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1436955428, "creation_date": 1436947402, "last_edit_date": 1436955428, "question_id": 31424768, "link": "https://stackoverflow.com/questions/31424768/scan-non-default-outlook-inbox-for-email", "title": "Scan non default outlook inbox for email?", "body": "<p>I am using the following vba code which checks for any emails with a specific subject heading. </p>\n\n<p>The problem is it checks my default outlook inbox folder when I need it to check the inbox of my other email account NewSuppliers@Hewden.co.uk</p>\n\n<p>Can someone please show me how I would do this? Thanks in advance</p>\n\n<pre><code>Sub Macro1() Set olApp = CreateObject(\"Outlook.Application\")\n     Dim olNs As Outlook.Namespace\n     Dim Fldr As Outlook.MAPIFolder\n     Dim myItem As Outlook.MailItem\n     Dim myAttachment As Outlook.Attachment\n     Dim I As Long\n     Dim olMail As Variant\n\n\n     Set olApp = New Outlook.Application\n     Set olNs = olApp.GetNamespace(\"MAPI\")\n     Set Fldr = olNs.GetDefaultFolder(olFolderInbox)\n     Set myTasks = Fldr.Items\n\n\n  Set olMail = myTasks.Find(\"[Subject] = \"\"New Supplier Request: Ticket\"\"\")\n  If Not (olMail Is Nothing) Then\n\n\n\n    For Each myItem In myTasks\n        If myItem.Attachments.Count &lt;&gt; 0 Then\n            For Each myAttachment In myItem.Attachments\n            If InStr(myAttachment.DisplayName, \".txt\") Then\n                I = I + 1\n                myAttachment.SaveAsFile \"\\\\uksh000-file06\\Purchasing\\NS\\Unactioned\\\" &amp; myAttachment\n                End If\n            Next\n        End If\n\n    Next\n\n\n\nFor Each myItem In myTasks\nmyItem.Delete\nNext\n\nCall Macro2\n\nElse\nMsgBox \"There Are No New Supplier Requests.\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>outlook folder structure:</p>\n\n<pre><code>account1@hewden.co.uk\nInbox\nDrafts\nSent\n\nNewSuppliers@hewden.co.uk\nInbox\nDrafts\nSent\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 1, "creation_date": 1436945965, "post_id": 31424244, "comment_id": 50820023, "body": "How does it fail? Any error messages?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436948960, "post_id": 31424244, "comment_id": 50821893, "body": "What value is held by <i>Schritte</i>?"}, {"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436948994, "post_id": 31424244, "comment_id": 50821914, "body": "Yep. A VBA error message appears saying: &quot;Runtime - Error 1004, Application- or object defined Error&quot;  ... ?:-| ...  and the script stops."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436949092, "post_id": 31424244, "comment_id": 50821972, "body": "Those cell references appear to be non-EN-US xlR1C1 style. What language pack is the 2010 under and what language pack was the 2003 under?"}, {"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436949763, "post_id": 31424244, "comment_id": 50822359, "body": "@Jeeped: It&#39;s an Integer asked via an input box. For example: 11 =&gt; &quot;=EP!Z3S2:Z3S13&quot;. I think that&#39;s alright. The stopping of the script (in Excel 2010) seems caused by the used syntax."}, {"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436950389, "post_id": 31424244, "comment_id": 50822783, "body": "@Jeeped: In the system settings of my Windows 7 it&#39;s German. Don&#39;t know which settings they used for Windows XP. But all labels etc. are in German so I guess they used it only in an environment with German settings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436950541, "post_id": 31424244, "comment_id": 50822879, "body": "If <i>Schritte</i> is 11 then <code>Str(Schritte + 2)</code> is 13 and <code>Mid(Str(Schritte + 2), 2)</code> is 3. Why not just <code>Str(Schritte + 2)</code>?"}, {"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436951010, "post_id": 31424244, "comment_id": 50823167, "body": "Yep. Exactly the same what I thought. But I displayed the return value of Mid(Str(Schritte + 2), 2) via MsgBox and it&#39;s correct. I suppose that this asking the value via InputBox adds additional digits to the value. And this digits shall be removed."}, {"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436951049, "post_id": 31424244, "comment_id": 50823196, "body": "By the way: &quot;Schritte&quot; means &quot;Steps&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "edited": false, "score": 0, "creation_date": 1436957957, "post_id": 31428453, "comment_id": 50827535, "body": "Thanks a lot for your effort and time. I really appreciate it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1436957676, "creation_date": 1436957676, "answer_id": 31428453, "question_id": 31424244, "link": "https://stackoverflow.com/questions/31424244/excel-2003-vba-syntax-causes-problems-in-excel-2010-alternatives/31428453#31428453", "title": "Excel 2003: VBA Syntax causes problems in Excel 2010 - Alternatives?", "body": "<p>You need to provide the cell ranges as coded <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range objects</a> and/or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells property</a>, possibly with the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa176182%28v=office.11%29.aspx\" rel=\"nofollow\">Range.Resize property</a>.</p>\n\n<pre><code>dim ws as worksheet\nset ws = worksheets(\"EP\")\n\nActiveChart.SeriesCollection(1).XValues = _\n  ws.range(\"Z1S2:Z1S\" &amp; Mid(Str(Schritte + 2), 2))\n\nWith ActiveChart.SeriesCollection(1)\n   .Values = ws.cells(3, 2).resize(1, int(Mid(Str(Schritte + 2), 2)))    '=EP!Z3S2:Z3S\" &amp; Mid(Str(Schritte + 2), 2)\n   .Name = ws.cells(3, 1)    '=EP!Z3S1\nEnd With\n</code></pre>\n\n<p>When I created a chart using strictly strings describing the ranges, I received <strong>Compile error: Type mismatch</strong>. As soon as I wrapped the strings in <code>Range</code> or referenced them more directly with <code>.Cells</code> the problem disappeared and the chart generated.</p>\n"}], "owner": {"reputation": 3470, "user_id": 2645857, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Ym5Rc.png?s=128&g=1", "display_name": "michael.zech", "link": "https://stackoverflow.com/users/2645857/michael-zech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 31428453, "answer_count": 1, "score": 1, "last_activity_date": 1436957676, "creation_date": 1436945909, "question_id": 31424244, "link": "https://stackoverflow.com/questions/31424244/excel-2003-vba-syntax-causes-problems-in-excel-2010-alternatives", "title": "Excel 2003: VBA Syntax causes problems in Excel 2010 - Alternatives?", "body": "<p>I've got an old VBA-script (Office 2003) to fix which fails in Office 2010.\nThe problem seems to be caused by the syntax used to reference sheets and cells. </p>\n\n<pre><code>ActiveChart.SeriesCollection(1).XValues = _\n    \"=EP!Z1S2:Z1S\" &amp; Mid(Str(Schritte + 2), 2)\n\n    With ActiveChart.SeriesCollection(1)\n       .Values = \"=EP!Z3S2:Z3S\" &amp; Mid(Str(Schritte + 2), 2)\n       .Name = \"=EP!Z3S1\"\n    End With\n</code></pre>\n\n<p>Is there an alternative to using \"=Sheet!CellRange\"?\nOr can the problem be solved by changing some configuration in Office / Excel?</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436945488, "post_id": 31423848, "comment_id": 50819749, "body": "What are the ones in the middle for and what code can you show that demonstrates any effort to try this yourself? <a href=\"http://stackoverflow.com/tour\">SO</a> is not a free code writing service."}, {"owner": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436946282, "post_id": 31423848, "comment_id": 50820251, "body": "Hello, really apologise that I am not putting down the details.   <a href=\"http://pastebin.com/hSA3AavG\" rel=\"nofollow noreferrer\">pastebin.com/hSA3AavG</a>   For my codes, I am not sure how I can loop through all the rows and instead of hard coding the position."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436950448, "post_id": 31425071, "comment_id": 50822819, "body": "Hello Jeeped, first of all, thank you very much for taking your time to reply me. I sincerely apologise for the rules that I have broken(still new to this site, not used to it!) I have tested the codes that you have provided and they are working.  However, one last request! When I ran the macro, it removed the original row. For example, if theres 1 to 3. It added in 1 to 2, 2 to 3 (but the original 1 to 3 has disappeared. Any idea on this?)  Once again, thank you so much! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436950860, "post_id": 31425071, "comment_id": 50823066, "body": "If you had a row from 14-Jul to 17-Jul it creates a new row 16-Jul to 17-Jul, another new row 15-Jul to 16-Jul and changes the original row to 14-Jul to 15-Jul. Isn&#39;t that what your last examples demonstrates?"}, {"owner": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436951190, "post_id": 31425071, "comment_id": 50823286, "body": "Ah. I think I may not have stated clearly. &quot;After the Macro, it adds under the original row.&quot; - my original statement in my last example. I should have elaborated, so as seen in my last example I should end up with 14Jul-16-Jul, 14Jul-15Jul, 15Jul-16Jul. Anyway you can modify the codes so it ends up like this? Once again, my apologies sir."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436952762, "post_id": 31425071, "comment_id": 50824292, "body": "I believe I understand the last example of desired out now. See revision above."}, {"owner": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "edited": false, "score": 0, "creation_date": 1436954845, "post_id": 31425071, "comment_id": 50825648, "body": "Thank you Mr Jeeped, this works exactly as I wanted. Have a very nice day ahead!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1436952727, "last_edit_date": 1436952727, "creation_date": 1436948347, "answer_id": 31425071, "question_id": 31423848, "link": "https://stackoverflow.com/questions/31423848/excel-vba-macro-to-manipulate-rows-based-on-criteria/31425071#31425071", "title": "Excel VBA Macro to manipulate rows based on criteria", "body": "<p>When inserting rows in a loop, always start at the bottom and work up or you risk losing your step sequence with the new rows being inserted. By stepping upwards the newly inserted rows assume row numbers that are already out of scope for the loop.</p>\n\n<pre><code>Sub StackOverflow()\n    Dim rw As Long, i As Long\n    With ActiveSheet\n        For rw = .Cells(Rows.Count, 1).End(xlUp).Row To 2 Step -1\n            If (CDate(.Cells(rw, 4).Value2) - CDate(.Cells(rw, 1).Value2)) &gt; 1 Then\n                For i = 1 To (CDate(.Cells(rw, 4).Value2) - CDate(.Cells(rw, 1).Value2))\n                    With .Cells(rw, 1).Resize(1, 5)\n                        .Copy\n                        .Insert Shift:=xlDown   ', copyorigin:=.Cells\n                    End With\n                    .Cells(rw + 1, 4) = .Cells(rw + 1, 4).Value2 - (i - 1)\n                    .Cells(rw + 1, 1) = .Cells(rw + 1, 4).Value2 - 1\n                Next i\n            End If\n        Next rw\n    End With\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>If your sample data accurately represented the actual data then the above should quickly expand your date ranges to a single day separation for each row.</p>\n"}], "owner": {"reputation": 3, "user_id": 5118189, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204538316918279/picture?type=large", "display_name": "Frashe", "link": "https://stackoverflow.com/users/5118189/frashe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 31425071, "answer_count": 1, "score": 0, "last_activity_date": 1436952727, "creation_date": 1436944679, "last_edit_date": 1436945652, "question_id": 31423848, "link": "https://stackoverflow.com/questions/31423848/excel-vba-macro-to-manipulate-rows-based-on-criteria", "title": "Excel VBA Macro to manipulate rows based on criteria", "body": "<p>I have tried searching and googling for solutions but to no avail.\nI apologise now if there are solutions out there that I had missed.</p>\n\n<p>(My Excel database) - Before running Macro</p>\n\n<pre><code>Start Date  Start Time  Number  Finish Date Finish Time\n14-Jul-15   22:00   1   16-Jul-15   06:00\n15-Jul-15   22:00   1   17-Jul-15   06:00\n15-Jul-15   22:00   1   16-Jul-15   06:00\n</code></pre>\n\n<p>(My Excel database) - After running Macro</p>\n\n<pre><code>Start Date  Start Time  Number  Finish Date Finish Time\n14-Jul-15   22:00   1   16-Jul-15   06:00\n14-Jul-15   22:00   1   15-Jul-15   06:00\n15-Jul-15   22:00   1   16-Jul-15   06:00\n15-Jul-15   22:00   1   17-Jul-15   06:00\n15-Jul-15   22:00   1   16-Jul-15   06:00\n16-Jul-15   22:00   1   17-Jul-15   06:00\n15-Jul-15   22:00   1   16-Jul-15   06:00\n</code></pre>\n\n<p>What I want the Macro to do is, \nCheck if the difference of \"Start Date\" and \"Finish Date\" is more than 2.\nIf the difference between both is 1 or 0, it moves on to the next row of data to check. \nHowever, if its more than 0 or 1, it adds another row under that particular row. Then it copies the similar content but then modifying the date.</p>\n\n<p>For example, </p>\n\n<pre><code>14-Jul-15   22:00   1   16-Jul-15   06:00\n</code></pre>\n\n<p>After the Macro, it adds under the original row. </p>\n\n<pre><code>14-Jul-15   22:00   1   15-Jul-15   06:00\n15-Jul-15   22:00   1   16-Jul-15   06:00\n</code></pre>\n\n<p>Sorry if my question is unclear, please assist me in creating this macro.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1436949037, "post_id": 31423592, "comment_id": 50821939, "body": "2013 uses different outlook references to 2010. Further more, say your workbook is created in 2010; then you open it in 2013 - The references will update to be correct for the 2013, but when going back to 2010 they won&#39;t change. Check your references in 2010 - they probably will be missing. If you wanted to be really clever you could have a look at <a href=\"http://stackoverflow.com/questions/9879825/how-to-add-a-reference-programmatically-in-excel-vba\">this</a> and correct them automatically on the <code>open</code> event"}, {"owner": {"reputation": 101, "user_id": 4666037, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9601320c0540b84a38bacce112e273?s=128&d=identicon&r=PG&f=1", "display_name": "Kapil Dhawan", "link": "https://stackoverflow.com/users/4666037/kapil-dhawan"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1437021740, "post_id": 31423592, "comment_id": 50859751, "body": "I need to add signature, client can run it on office 7, 10, 13. For signature I put the above code which is not working in case of 2010"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1436951779, "creation_date": 1436951779, "answer_id": 31426248, "question_id": 31423592, "link": "https://stackoverflow.com/questions/31423592/facing-issue-while-displaying-default-signature-from-macro-to-outlook/31426248#31426248", "title": "Facing issue while displaying default signature from macro to outlook", "body": "<p>It looks like you need to add a reference to Microsoft Outlook in Excel. </p>\n\n<ul>\n<li>In the Visual Basic Editor, on the Tools menu, click References.</li>\n<li>Click to select the Microsoft Outlook 14.0 Object Library check box, and then click OK.</li>\n</ul>\n\n<p>See <a href=\"https://support.microsoft.com/kb/201096?wa=wsignin1.0\" rel=\"nofollow\">How to automate Outlook from another program</a> for more information.</p>\n"}], "owner": {"reputation": 101, "user_id": 4666037, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9601320c0540b84a38bacce112e273?s=128&d=identicon&r=PG&f=1", "display_name": "Kapil Dhawan", "link": "https://stackoverflow.com/users/4666037/kapil-dhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156608, "creation_date": 1436943861, "last_edit_date": 1593156608, "question_id": 31423592, "link": "https://stackoverflow.com/questions/31423592/facing-issue-while-displaying-default-signature-from-macro-to-outlook", "title": "Facing issue while displaying default signature from macro to outlook", "body": "<p>Hi I have a macro in excel through which I am sending email with default signature of user which I am getting by </p>\n\n<pre><code>Signature = Environ(\"APPDATA\") &amp; \"\\Microsoft\\Signatures\\\"\n</code></pre>\n\n<p>its working fine in MSexcel2013 but in 2010 its causing error as 'Cannot find Project or library' on keyword Environ.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1436953891, "post_id": 31423132, "comment_id": 50825038, "body": "are you trying to apply this changes when msg is received?"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1436959070, "creation_date": 1436959070, "answer_id": 31428924, "question_id": 31423132, "link": "https://stackoverflow.com/questions/31423132/how-to-implement-automatic-date-in-the-subject-for-particular-sender-in-the-outl/31428924#31428924", "title": "How to implement automatic date in the subject for particular sender in the Outlook?", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865076(v=office.15).aspx\" rel=\"nofollow\">ItemSend</a> event of the Application class if you need to modify the outcoming emails. </p>\n\n<pre><code> Public WithEvents myOlApp As Outlook.Application \n\n Public Sub Initialize_handler()  \n  Set myOlApp = Outlook.Application  \n End Sub \n\n Private Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean)  \n  Dim prompt As String \n  prompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\"  \n  If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then  \n    Cancel = True  \n  End If  \n End Sub\n</code></pre>\n\n<p>In case if you need to modify incoming emails you need to handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class. This event fires once for every received item that is processed by Microsoft Outlook. The item can be one of several different item types, for example, MailItem, MeetingItem, or SharingItem. The EntryIDsCollection string contains the Entry ID that corresponds to that item. Note that this behavior has changed from earlier versions of the event when the EntryIDCollection contained a list of comma-delimited Entry IDs of all the items received in the Inbox since the last time the event was fired.</p>\n\n<p>The NewMailEx event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the EntryIDCollection array to call the NameSpace.GetItemFromID method and process the item. Use this method with caution to minimize the impact on Outlook performance. </p>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful.</p>\n"}], "owner": {"reputation": 11, "user_id": 5118087, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9ymO7aWw5Gc/AAAAAAAAAAI/AAAAAAAAAMQ/WiQYTROBYyk/photo.jpg?sz=128", "display_name": "yangyeswar Raajalingam", "link": "https://stackoverflow.com/users/5118087/yangyeswar-raajalingam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306492, "creation_date": 1436942300, "last_edit_date": 1593306492, "question_id": 31423132, "link": "https://stackoverflow.com/questions/31423132/how-to-implement-automatic-date-in-the-subject-for-particular-sender-in-the-outl", "title": "How to implement automatic date in the subject for particular sender in the Outlook?", "body": "<p>I need an automation feasibility for data changing in my subject and body of message.</p>\n\n<p>For example,</p>\n\n<p><strong>subject</strong>-update required 15-July-2015</p>\n\n<p><strong>body of message</strong></p>\n\n<p>xxxxxxxxxxxxx 14-july-2015</p>\n\n<p>Note-In subject my date has to be today's date but in Body of message I need previous day date.</p>\n\n<p>Can it be automation for this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 0, "creation_date": 1436938639, "post_id": 31422197, "comment_id": 50816342, "body": "Perhaps you could sort them ascending?"}, {"owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "edited": false, "score": 0, "creation_date": 1436938691, "post_id": 31422197, "comment_id": 50816363, "body": "you can find the answer to this in probably every tutorial and on many many other sites through a web search."}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436943059, "creation_date": 1436943059, "answer_id": 31423346, "question_id": 31422197, "link": "https://stackoverflow.com/questions/31422197/finding-minimum-value-based-on-a-range-of-values-in-another-column-in-excel-vba/31423346#31423346", "title": "finding Minimum value based on a range of values in another column in excel vba", "body": "<p>Here, I got one for you. It is an excel formula.</p>\n\n<pre><code>=MIN(IF(B1:B100=\"b2\",A1:A100))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4988836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/946ea0d1bf4e33d9cf0d0a38148203d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ramesh Shanmugam", "link": "https://stackoverflow.com/users/4988836/ramesh-shanmugam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1437113030, "creation_date": 1436938404, "last_edit_date": 1531164843, "question_id": 31422197, "link": "https://stackoverflow.com/questions/31422197/finding-minimum-value-based-on-a-range-of-values-in-another-column-in-excel-vba", "title": "finding Minimum value based on a range of values in another column in excel vba", "body": "<pre><code>10.00   b1\n11.00   b2\n22.00   b3\n2.00    b1\n323.00  b2\n1.00    b3\n423.00  b1\n32.00   b2\n42.00   b3\n43.00   b1\n522.00  b2\n53.00   b3\n22.00   b1\n344.00  b2\n33.00   b3\n23445.00    b1\n323.00  b2\n4.00    b3\n</code></pre>\n\n<p>How can I find the minimum value of column1 where value of column2 = b2? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1436949693, "creation_date": 1436949693, "answer_id": 31425500, "question_id": 31421757, "link": "https://stackoverflow.com/questions/31421757/how-can-i-add-a-line-break-in-the-email-body-after-pasting-each-chart/31425500#31425500", "title": "How can I add a line break in the email body after pasting each chart?", "body": "<p>This should work. Although it is almost too ugly for me to paste here...</p>\n\n<pre><code>wrdEdit.Application.Selection.Paste\nwrdEdit.Application.Selection.Range.InsertAfter vbCrLf\nwrdEdit.Application.Selection.Collapse wdCollapseEnd\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 31425500, "answer_count": 1, "score": 0, "last_activity_date": 1436949693, "creation_date": 1436935932, "question_id": 31421757, "link": "https://stackoverflow.com/questions/31421757/how-can-i-add-a-line-break-in-the-email-body-after-pasting-each-chart", "title": "How can I add a line break in the email body after pasting each chart?", "body": "<p>I would like the email message to have the charts pasted below each other, currently they are just pasted in a series and it looks very messy.\nHow can I add a line break in the email body after pasting each chart? I've tried using <br>, and pasting blank cells but it either doesn't work or I'm not using it properly.</p>\n\n<p>Many Thanks</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nOn Error Resume Next\n\nDim weekno As Long\nDim oApp As Outlook.Application\nDim oMail As MailItem\nDim wrdEdit\n\nActiveSheet.Select\nweekno = Range(\"C2\").Value\n\n'get running Outlook Application\nSet oApp = GetObject(, \"Outlook.Application\")\n'create a new email\nSet oMail = oApp.CreateItem(olMailItem)\n'set the subject and recipient\noMail.Subject = \"Execution and Unavailability Report for Week \" &amp; weekno\noMail.To = \"\"\n'show it\noMail.Display\n'change to HTML\noMail.BodyFormat = olFormatHTML\n'get the word editor\nSet wrdEdit = oApp.ActiveInspector.WordEditor\n\n\nActiveSheet.Range(\"A50\").Select\nSelection.Copy\nwrdEdit.Application.Selection.Paste\n\nActiveSheet.Range(\"A51\").Select\nSelection.Copy\nwrdEdit.Application.Selection.Paste\n\nActiveSheet.Range(\"A52\").Select\nSelection.Copy\nwrdEdit.Application.Selection.Paste\n\nActiveSheet.Range(\"A53\").Select\nSelection.Copy\nwrdEdit.Application.Selection.Paste\n\n    ActiveSheet.ChartObjects(1).Activate\n    ActiveChart.ChartArea.Copy\n    wrdEdit.Application.Selection.Paste\n\n    ActiveSheet.ChartObjects(2).Activate\n    ActiveChart.ChartArea.Copy\n    wrdEdit.Application.Selection.Paste\n\n\n    Sheets(\"ACT Statistics\").Select\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.ChartArea.Copy\n wrdEdit.Application.Selection.Paste\n\n    Sheets(\"ATD Statistics\").Select\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.ChartArea.Copy\n\n'paste it into the email\nwrdEdit.Application.Selection.Paste\n\n\n'use oMail.Send to autosend\n'release objects\nSet wrdEdit = Nothing\nSet oMail = Nothing\nSet oApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1205, "user_id": 4667934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk11W.jpg?s=128&g=1", "display_name": "LinkBerest", "link": "https://stackoverflow.com/users/4667934/linkberest"}, "edited": false, "score": 2, "creation_date": 1436932472, "post_id": 31421155, "comment_id": 50814483, "body": "See <a href=\"https://stackoverflow.com/questions/4013792/how-to-activate-a-specific-worksheet-in-excel\">this question for using Sheets(sheet_name).Select</a> and <a href=\"https://stackoverflow.com/questions/17559677/select-range-in-a-particular-sheet-in-excel-vba\">this question for selecting a range</a> - which also points to why you should use Activate"}, {"owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "reply_to_user": {"reputation": 1205, "user_id": 4667934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk11W.jpg?s=128&g=1", "display_name": "LinkBerest", "link": "https://stackoverflow.com/users/4667934/linkberest"}, "edited": false, "score": 0, "creation_date": 1436932596, "post_id": 31421155, "comment_id": 50814510, "body": "Thanks. but still I don&#39;t know what the problem is"}, {"owner": {"reputation": 1205, "user_id": 4667934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk11W.jpg?s=128&g=1", "display_name": "LinkBerest", "link": "https://stackoverflow.com/users/4667934/linkberest"}, "edited": false, "score": 0, "creation_date": 1436932809, "post_id": 31421155, "comment_id": 50814563, "body": "look closer, your code is only one word off"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 1, "creation_date": 1436939640, "post_id": 31421155, "comment_id": 50816669, "body": "If it did not work, could I know what is the error you get? You are using Sheet4 instead or worksheet(&quot;Sheet4&quot;). For your information, Sheet4 is the code name of the worksheet. &quot;Sheet4&quot; (with double quotes) is the name of the worksheet"}, {"owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "edited": false, "score": 0, "creation_date": 1436940770, "post_id": 31421155, "comment_id": 50817132, "body": "I don&#39;t think so there is any problem with sheet4. When I open the workbook, the macro doesn&#39;t select sheet4. No error comes up."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 3, "creation_date": 1436947416, "post_id": 31421155, "comment_id": 50821022, "body": "This method should have inside the <code>ThisWorkbook</code> module. Where did you put it?"}, {"owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "edited": false, "score": 0, "creation_date": 1437011966, "post_id": 31421155, "comment_id": 50857299, "body": "I put it in ThisWorkbook"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "edited": false, "score": 1, "creation_date": 1437011918, "post_id": 31437084, "comment_id": 50857290, "body": "True, but still doesn&#39;t work. I think there is a major problem with the workbook, because these codes work in other workbooks."}], "tags": [], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "is_accepted": true, "score": 1, "last_activity_date": 1436981133, "creation_date": 1436981133, "answer_id": 31437084, "question_id": 31421155, "link": "https://stackoverflow.com/questions/31421155/vba-select-a-sheet-when-the-workbook-is-opened/31437084#31437084", "title": "VBA Select a sheet when the workbook is opened", "body": "<p>If you hit <code>alt+F11</code> to go to the VBA code editor. On the left side, under the file name you will see the different sheets, and whatever modules you might have in there. If you go under the <code>ThisWorkbook</code> module\n and place your code there, it will automatically run when you start up the Excel File.</p>\n"}, {"tags": [], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "is_accepted": false, "score": 0, "last_activity_date": 1550007643, "creation_date": 1550007643, "answer_id": 54659071, "question_id": 31421155, "link": "https://stackoverflow.com/questions/31421155/vba-select-a-sheet-when-the-workbook-is-opened/54659071#54659071", "title": "VBA Select a sheet when the workbook is opened", "body": "<p>you are using the \"Select\" Method without an Activating a Sheet First! </p>\n\n<p>Yes, when you have closed your workbook last time, the current sheet will remain in the memory index and when you will again open the same workbook, the pointer search for the most recent sheet used based on the index no.</p>\n\n<pre><code>'Here is the code\nPrivate Sub Workbook_Open()\n    Sheet4.Activate\n    Sheet4.Select\n    Sheet4.Range(\"B1\").Select\nEnd Sub\n</code></pre>\n\n<p>using \"Select Method\" without Activating the Parent Object is a Crime. lol</p>\n\n<p>Hope this will help you. </p>\n"}], "owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2158, "favorite_count": 0, "accepted_answer_id": 31437084, "answer_count": 2, "score": 1, "last_activity_date": 1550007643, "creation_date": 1436932036, "question_id": 31421155, "link": "https://stackoverflow.com/questions/31421155/vba-select-a-sheet-when-the-workbook-is-opened", "title": "VBA Select a sheet when the workbook is opened", "body": "<p>The following program doesn't work when I open my workbook. What are the possible reasons?</p>\n\n<pre><code>' Select the first sheet when the workbook is opened.\nPrivate Sub Workbook_Open()\n\n    Sheet4.Select\n    Sheet4.Range(\"B1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436932275, "post_id": 31421109, "comment_id": 50814432, "body": "Why don&#39;t you use <code>transpose</code> method to dump the array into the range object of you desire?"}, {"owner": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "edited": false, "score": 0, "creation_date": 1437080487, "post_id": 31421109, "comment_id": 50895148, "body": "If you had a 4-fold improvement in performance, it&#39;s still taking 75 to 90 minutes.  I timed the <code>Application.Transpose</code> approach against the 2-d array approach on a selection of 25 columns by 3000 rows and the former approach pretty consistently took 1/8 longer.  If that holds for you, your execution time would drop by another 8 to 10 minutes (assuming all of the execution time is attributable to filling the data into the worksheet, which is perhaps unlikely: if I divide the execution times by the number of iterations, I get 0.09 and 0.08 seconds per iteration)."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 3, "last_activity_date": 1436932434, "creation_date": 1436932434, "answer_id": 31421196, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array/31421196#31421196", "title": "Quickly filling up excel cells from a Array", "body": "<p>Here is an example of how to populate to a range from an array without looping:</p>\n\n<pre><code>Sub PopulateFromArray()\n    Dim MyArr As Variant\n    MyArr = Array(\"Hello\", \"World\", \"This is some\", \"Text\")\n    Range(\"A1\").Resize(UBound(MyArr) + 1, 1).Formula = Application.Transpose(MyArr)\nEnd Sub\n</code></pre>\n\n<p>We are using resize to resize the range to populate using the upper boundary of the array. We add one to it because it is option base 0. We transpose the array because by the nature of an array the data goes across and we need it to go down. If we wanted to span columns instead of rows we would need to double transpose it like this:</p>\n\n<pre><code>Application.Transpose(Application.Transpose(MyArr))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 2, "last_activity_date": 1436932588, "creation_date": 1436932588, "answer_id": 31421222, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array/31421222#31421222", "title": "Quickly filling up excel cells from a Array", "body": "<pre><code>With ThisWorkbook.Worksheets(\"Data\")\n   NextRow = .Cells(.Rows.count, 2).End(xlUp).Row + 1\n   num = UBound(Price) - LBound(Price)\n   .Range(.Cells(NextRow, 1), .Cells(NextRow + num, 1)) = Application.Transpose(Price)\n   .Range(.Cells(NextRow, 2), .Cells(NextRow + num, 2)) = Application.Transpose(Quantity)\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "is_accepted": false, "score": 1, "last_activity_date": 1437077912, "last_edit_date": 1437077912, "creation_date": 1436933623, "answer_id": 31421385, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array/31421385#31421385", "title": "Quickly filling up excel cells from a Array", "body": "<p>To fill a range of N rows by M columns, put the data into a 2-dimensional array of the same size, then assign that array to the Value property of the range.</p>\n\n<pre><code>ReDim varValues(1 To lngRowCount, 1 To lngColCount)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>ReDim varValues(0 To lngRowCount - 1, 0 To lngColCount - 1)\n</code></pre>\n\n<p>I presume you can handle populating the array.  Then:</p>\n\n<pre><code>Set rngTheRange = 'I presume you can handle this, too\nrngTheRange.Value = varValues\n</code></pre>\n\n<p>Here is an example that uses this technique to fill the current selection with values 0 through N - 1, where N is the number of cells in the selection:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub X()\n    Dim rngCurrent As Range\n\n    Dim lngRows As Long\n    Dim lngCols As Long\n\n    Dim lngR As Long\n    Dim lngC As Long\n\n    Dim varValues() As Variant\n\n    Set rngCurrent = Selection\n\n    lngRows = rngCurrent.Rows.Count\n    lngCols = rngCurrent.Columns.Count\n\n    ReDim varValues(0 To lngRows - 1, 0 To lngCols - 1) As Variant\n\n    For lngR = 0 To lngRows - 1\n        For lngC = 0 To lngCols - 1\n            varValues(lngR, lngC) = lngR * lngCols + lngC\n        Next\n    Next\n\n    rngCurrent.Value = varValues\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1437181268, "post_id": 31421513, "comment_id": 50937955, "body": "Glad it helped, feel free to comment and ask questions if you have any doubts or need help."}], "tags": [], "owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1436934951, "last_edit_date": 1436934951, "creation_date": 1436934505, "answer_id": 31421513, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array/31421513#31421513", "title": "Quickly filling up excel cells from a Array", "body": "<p>You have number of arrays (25) with different data (e.g. Price, Quantity, SomeOtherArray) as per your question. As per my comment above.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetData()\nDim ws As Worksheet\nDim LastRow As Long\nDim arrPrice As Variant\nDim arrQty As Variant\n\nSet ws = Sheets(3)\n'-- starts at zero index\narrPrice = Array(50, 60, 70, 75)\narrQty = Array(250, 100, 50, 200)\n\n'-- change columns as per your needs\nLastRow = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n'-- UBound + 1 is because the array starts at zero index above\nws.Range(\"B1\").Offset(LastRow).Resize(UBound(arrPrice)+1).Value = Application.Transpose(arrPrice)\nws.Range(\"B1\").Offset(LastRow, 1).Resize(UBound(arrQty)+1).Value = Application.Transpose(arrQty)\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/Ya6A4.jpg\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1437085655, "post_id": 31435518, "comment_id": 50897416, "body": "That creates a 2D array with option base 1. As a test run your code to populate an array but use the range &quot;A1:A4&quot; and put a stop after you set MyArray then in the debug window enter ?MyArray(0) to get the bottom value. it errors, Then try ?MyArray(0,1) it errors, then try MyArray(1,1) and it will give you the first value. It&#39;s much harder to query a 2D array in your code than it is a 1D Array, Doable but harder."}, {"owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1463156076, "post_id": 31435518, "comment_id": 61960820, "body": "I almost always work with a table of data, so a 2D array works for me. You&#39;re right though, if you&#39;re working with purely 1D data then there are easier ways."}], "tags": [], "owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "is_accepted": false, "score": 1, "last_activity_date": 1436976195, "creation_date": 1436976195, "answer_id": 31435518, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array/31435518#31435518", "title": "Quickly filling up excel cells from a Array", "body": "<p>you can dump an array to a worksheet range very simply like this:</p>\n\n<pre><code>range(\"A1:B5\").value = myArray\n</code></pre>\n\n<p>you can populate an array conversly:</p>\n\n<pre><code>dim myArray as variant\nmyArray = range(\"A1:B5\").value\n</code></pre>\n\n<p>I use this method very frequently, I hardly ever work with data on a worksheet, I prefer to take it into an array first then work with the array.</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2160, "favorite_count": 0, "accepted_answer_id": 31421513, "answer_count": 5, "score": 1, "last_activity_date": 1437077912, "creation_date": 1436931725, "question_id": 31421109, "link": "https://stackoverflow.com/questions/31421109/quickly-filling-up-excel-cells-from-a-array", "title": "Quickly filling up excel cells from a Array", "body": "<p>I generate arrays from a external data tool and now want to fill the cells up using the data in the arrays. I have written the following code.</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Data\")\n   Lastrow = .Cells(.Rows.count, 2).End(xlUp).Row\n   For i = LBound(Price) To UBound(Price)\n   .Cells((Lastrow + 1), 1) = Price(i)\n   .Cells((Lastrow + 1), 2) = Quantity(i)\n   Lastrow = Lastrow + 1\n   Next i\nEnd With\n</code></pre>\n\n<p>All the arrays are of same length and I have around 25 odd arrays to work with. The code works fine but the problem I am facing is of speed. It takes me around 5-6 hours to fill the sheet once with around 3000 as the length of array. Please suggest your best way. Thank you. </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3684995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23ac3e0b1b2c0af4aebb39a883a2b8a?s=128&d=identicon&r=PG&f=1", "display_name": "gtmoripped", "link": "https://stackoverflow.com/users/3684995/gtmoripped"}, "edited": false, "score": 0, "creation_date": 1437013649, "post_id": 31432121, "comment_id": 50857744, "body": "OK, that&#39;s close. I&#39;m actually using a combo box and want the selection from that box to be the caption for the button. Sorry I wasn&#39;t very clear with my original post. The combo box is tied to the table. Thanks."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1436967718, "creation_date": 1436967718, "answer_id": 31432121, "question_id": 31421066, "link": "https://stackoverflow.com/questions/31421066/change-caption-of-button-to-field-in-a-table-using-access/31432121#31432121", "title": "Change caption of button to field in a table using Access", "body": "<p>You could simply use the Form's <code>OnCurrent</code> event to set the buttons caption.  </p>\n\n<p><strong>On Current:</strong> </p>\n\n<pre><code>Private Sub Form_Current()\n    If Nz(Me.FieldName, \"\") &lt;&gt; \"\" Then\n        Me.btnTest.Caption = Me.FieldName\n    Else\n        'Handle blank record here\n    End If\nEnd Sub\n</code></pre>\n\n<p>This will make it so ever time the selected record changes the button will update.  Also just add the code into the specific field's <code>AfterUpdate</code> event so it changes then as well.  </p>\n\n<p><strong>After Update:</strong> </p>\n\n<pre><code>Private Sub Textbox1_AfterUpdate()\n    If Nz(Me.FieldName, \"\") &lt;&gt; \"\" Then\n        Me.btnTest.Caption = Me.FieldName\n    Else\n        'Handle blank record here\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3684995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f23ac3e0b1b2c0af4aebb39a883a2b8a?s=128&d=identicon&r=PG&f=1", "display_name": "gtmoripped", "link": "https://stackoverflow.com/users/3684995/gtmoripped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3681, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436969824, "creation_date": 1436931365, "last_edit_date": 1436969824, "question_id": 31421066, "link": "https://stackoverflow.com/questions/31421066/change-caption-of-button-to-field-in-a-table-using-access", "title": "Change caption of button to field in a table using Access", "body": "<p>I am trying to make the caption of a button the content of a field from a table. </p>\n\n<p>Everything I am finding online in forums and MS websites only shows using a macro with the <code>OnClick</code>. I need it to display without every clicking. It also needs to dynamically change every time the field from the table changes. </p>\n\n<p>How can I achieve this? Again, I don't want an event such as <code>OnClick</code>, I want it to simply read as the field from the table reads.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "edited": false, "score": 0, "creation_date": 1436929787, "post_id": 31420736, "comment_id": 50813803, "body": "thank you for your immediate reply but which conditional formatting did you use?"}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "reply_to_user": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "edited": false, "score": 0, "creation_date": 1436930031, "post_id": 31420736, "comment_id": 50813882, "body": "See the screenshot. Select Column DH, select conditional formatting, Use a formula...., in the formula bos of the conditional formatting window enter =DH$1=TODAY(), Click on the Format button and select the Fill color you would like to use. Click OK. You can then use the format painter to copy this format to all other columns"}, {"owner": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "edited": false, "score": 0, "creation_date": 1436930634, "post_id": 31420736, "comment_id": 50814018, "body": "Now i get it.. But if this only works with the current sheet, this wont work if i have to open another new sheet and that would not be convenient if i have to do the repetitive task."}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "reply_to_user": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "edited": false, "score": 0, "creation_date": 1436930989, "post_id": 31420736, "comment_id": 50814099, "body": "True. See second answer for a fixed up VBA solution"}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 1, "last_activity_date": 1436928956, "creation_date": 1436928956, "answer_id": 31420736, "question_id": 31420612, "link": "https://stackoverflow.com/questions/31420612/excel-vba-highlight-entire-column-according-to-todays-date/31420736#31420736", "title": "Excel VBA highlight entire column according to today&#39;s date", "body": "<p>You can skip the whole VBA and use conditional formatting. See screenshot:\n<img src=\"https://i.stack.imgur.com/4vhO1.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "edited": false, "score": 0, "creation_date": 1436932194, "post_id": 31420990, "comment_id": 50814412, "body": "IT WORKS!! Thanks a lot Abe"}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": true, "score": 1, "last_activity_date": 1436930967, "creation_date": 1436930967, "answer_id": 31420990, "question_id": 31420612, "link": "https://stackoverflow.com/questions/31420612/excel-vba-highlight-entire-column-according-to-todays-date/31420990#31420990", "title": "Excel VBA highlight entire column according to today&#39;s date", "body": "<p>To use VBA:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Dim TodaysDate As Date\n  Dim Rng As Range\n\n  TodaysDate = CLng(Date)\n  With Rows(\"1:1\")\n  Set Rng = .Find(what:=TodaysDate, _\n  after:=.Cells(.Cells.Count), _\n  LookIn:=xlFormulas, _\n  lookat:=xlWhole, _\n  SearchOrder:=xlByRows, _\n  SearchDirection:=xlNext, MatchCase:=False)\nIf Not Rng Is Nothing Then\nRng.EntireColumn.Interior.Color = vbMagenta\nElse\n\n'Give a message that today's date was not found\n\n  MsgBox \"Nothing found\"\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 2723640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XTpJq.png?s=128&g=1", "display_name": "LBMG", "link": "https://stackoverflow.com/users/2723640/lbmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2027, "favorite_count": 0, "accepted_answer_id": 31420990, "answer_count": 2, "score": 0, "last_activity_date": 1462531936, "creation_date": 1436928110, "last_edit_date": 1531164843, "question_id": 31420612, "link": "https://stackoverflow.com/questions/31420612/excel-vba-highlight-entire-column-according-to-todays-date", "title": "Excel VBA highlight entire column according to today&#39;s date", "body": "<p>I have the following data in my excel table. My requirements is to highlight the the entire column of my current date.<br><br>\n<img src=\"https://i.stack.imgur.com/Ws4He.png\" alt=\"my excel table\"><br>\n<br>\nI have found a code where it search through my dates and select the today's date. However when i try to move to another cell to input some data, it keeps on going back to the selected date and i was unable to do key in. Below is my code.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)     \n  Dim TodaysDate As Date\n  Dim Rng As Range\n\n  TodaysDate = CLng(Date)\n  With Rows(\"1:1\")\n  Set Rng = .Find(what:=TodaysDate, _\n  after:=.Cells(.Cells.Count), _\n  LookIn:=xlFormulas, _\n  lookat:=xlWhole, _\n  SearchOrder:=xlByRows, _\n  SearchDirection:=xlNext, MatchCase:=False)\n\nIf Not Rng Is Nothing Then\n Application.Goto Rng, True\nElse\n\n'Give a message that today's date was not found\n\n  MsgBox \"Nothing found\"\nEnd If\nEnd With`\n</code></pre>\n\n<p><br>\nThe above code doesn't include the highlighting part yet since i have no idea how to do it since i just learn to do VBA since yesterday.<br>\nAny help will be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1436928532, "post_id": 31420462, "comment_id": 50813494, "body": "Please be more specific; phrases such as &quot;doesn&#39;t seem to like it.&quot; and &quot;didn&#39;t work&quot; are not helpful. Is the problem that the code won&#39;t run at all, or it runs but doesn&#39;t do what you want? If the former, please step thru your code with the debugger and tell us what line is failing. If the latter, we will need to know the current behaviour and the desired behaviour."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1436929653, "post_id": 31420462, "comment_id": 50813768, "body": "You&#39;re missing an <code>&#39;End If</code> in <code>Workbook_Open</code> (see code in my answer below). This might fix your problem."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436928950, "post_id": 31420596, "comment_id": 50813588, "body": "You know you have been working for too long when you forget to end your If/Then... But I didn&#39;t know you couldn&#39;t declare a sub within another sub, just went ahead and did it but its good to know I can&#39;t. Thanks!!"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436930094, "post_id": 31420596, "comment_id": 50813899, "body": "I&#39;ve got another problem not related to this that I just really don&#39;t know how to research unlike anything else. If I post a new question, think you could give it a look?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "reply_to_user": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1436930198, "post_id": 31420596, "comment_id": 50813931, "body": "Post away. I probably won&#39;t be able to look at it immediately, but someone else may be able to."}], "tags": [], "owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "is_accepted": true, "score": 2, "last_activity_date": 1436928026, "creation_date": 1436928026, "answer_id": 31420596, "question_id": 31420462, "link": "https://stackoverflow.com/questions/31420462/macro-to-clear-multiple-columns/31420596#31420596", "title": "Macro to Clear multiple Columns", "body": "<p>Declaring a sub within a sub will not work (I'm 99.9999% sure, but it's never entered my head to try this!)</p>\n\n<p>Move your <code>Sub Clear</code> declaration so that it's after <code>Workbook_Open</code>, and then just call <code>Clear</code> from within <code>Workbook_Open</code>, in the same way that you call <code>TimeStamp</code>. (You're also missing an <code>End If'</code> at the end of WorkBook_open)</p>\n\n<p>So your code would become:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Time &gt; TimeSerial(6, 45, 0) Then\n        Call TimeStamp\n    Else\n        Call Clear \n        Application.Wait \"06:45:00\"\n        Call TimeStamp\n    End If \nEnd Sub\n\nSub Clear()\n    Dim wb3 As Workbook\n    Set wb3 = ThisWorkbook\n    With wb3.Worksheets(\"Avnet\")\n       .Range(\"A2:A\" &amp; .Range(\"A2\").End(xlDown).Row).ClearContents\n    End With\nEnd Sub\n</code></pre>\n\n<p>As an aside, your Workbook_Open code can be simplified to:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Time &lt;= TimeSerial(6, 45, 0) Then\n        Call Clear \n        Application.Wait \"06:45:00\"\n    End If \n\n    Call TimeStamp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2506, "favorite_count": 0, "accepted_answer_id": 31420596, "answer_count": 1, "score": 1, "last_activity_date": 1436929651, "creation_date": 1436927138, "last_edit_date": 1436929651, "question_id": 31420462, "link": "https://stackoverflow.com/questions/31420462/macro-to-clear-multiple-columns", "title": "Macro to Clear multiple Columns", "body": "<p>Below is my code that automatically runs the TimeStamp Macro when I open the workbook. However, it only runs if the Time is 6:45 am or later. My problem is that I am trying to get it to clear the cell contents in Columns A through D from Row 2 and on if the time is before 6:45 am and before it runs the TimeStamp macro. I tried to do it with just Column A and the debugger says that the top line is an issue. I can't seem to figure out why it is an issue though. I assume I am breaking some sort of syntax rule but I am not sure.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Time &gt; TimeSerial(6, 45, 0) Then\n    Call TimeStamp\n    Else\n        Sub Clear()\n            Dim wb3 As Workbook\n            Set wb3 = ThisWorkbook\n                With wb3.Worksheets(\"Avnet\")\n                 .Range(\"A2:A\" &amp; .Range(\"A2\").End(xlDown).Row).ClearContents\n                End With\n        End Sub\n    Application.Wait \"06:45:00\"\n    Call TimeStamp\nEnd Sub\n</code></pre>\n\n<p>It worked prior to me adding in the Sub Clear() section...</p>\n\n<p>UPDATE:\nJust tried making the Sub Clear() a separate module and using the <code>call Clear()</code> but that didnt work either. Here is what it looked like</p>\n\n<p>The Clear () Code</p>\n\n<pre><code>Sub Clear()\n    Dim wb3 As Workbook\n    Set wb3 = ThisWorkbook\n    With wb3.Worksheets(\"Avnet\")\n        Range(\"A2:A\" &amp; .Range(\"A2\").End(xlDown).Row).ClearContents\n    End With\nEnd Sub\n</code></pre>\n\n<p>The Part to call the Clear() </p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Time &gt; TimeSerial(20, 0, 0) Then\n    Call TimeStamp\n    Else\n    Call Clear\n    Application.Wait \"19:35:00\"\n    Call TimeStamp\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 3, "creation_date": 1436927931, "post_id": 31420453, "comment_id": 50813355, "body": "<code>daysoftheweek.ListObjects.Count = 0</code>"}], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "is_accepted": true, "score": 4, "last_activity_date": 1436929034, "creation_date": 1436929034, "answer_id": 31420745, "question_id": 31420453, "link": "https://stackoverflow.com/questions/31420453/check-if-any-listobjects-exist-in-worksheet/31420745#31420745", "title": "Check If Any ListObjects Exist in Worksheet", "body": "<p><code>Worksheet.ListObjects</code> is a collection so it isn't <code>Nothing</code>. Like Paul Bica commented, you want to count how many objects are in the collection. Try this:</p>\n\n<pre><code>Dim daysoftheweek As Worksheet\n\nFor Each daysoftheweek In Sheets\n    If daysoftheweek.ListObjects.Count &gt; 0 Then\n        'Do Something Here - Only If The Sheet Contains A List Object\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1836, "user_id": 4942980, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d4cec7046fbc2a474f133dc6553077af?s=128&d=identicon&r=PG&f=1", "display_name": "Summer Developer", "link": "https://stackoverflow.com/users/4942980/summer-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8150, "favorite_count": 1, "accepted_answer_id": 31420745, "answer_count": 1, "score": 5, "last_activity_date": 1436929034, "creation_date": 1436927021, "question_id": 31420453, "link": "https://stackoverflow.com/questions/31420453/check-if-any-listobjects-exist-in-worksheet", "title": "Check If Any ListObjects Exist in Worksheet", "body": "<p>If I am looping through my sheets and want to test if any ListObjects exist in the given sheet, how do I do this? I tried this:</p>\n\n<pre><code>Dim daysoftheweek As Worksheet\nFor Each daysoftheweek In Sheets\nIf Not daysoftheweek.ListObjects Is Nothing Then\n'Do Something Here - Only If The Sheet Contains A List Object\nEnd If\nNext\n</code></pre>\n\n<p>But the IF conditional block still ran even when the sheet did not contain a ListObject.</p>\n"}, {"tags": ["excel", "msxml", "vba"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436932948, "post_id": 31420211, "comment_id": 50814594, "body": "You should post your code.So, we can think more and our solution will be effective for you."}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 1, "last_activity_date": 1436966644, "creation_date": 1436966644, "answer_id": 31431662, "question_id": 31420211, "link": "https://stackoverflow.com/questions/31420211/reading-xml-and-repeating-a-value-across-a-cell-range/31431662#31431662", "title": "Reading XML and repeating a value across a cell range", "body": "<p>Here, my approach for your problem.</p>\n\n<pre><code>Public Sub readXML()\n\n    Dim xmlUrl As String\n    Dim xmlDoc As New MSXML2.DOMDocument\n    Dim partner, elements, bNode, child  As MSXML2.IXMLDOMNode\n    Dim row As Integer\n\n    'Get xml file path\n    xmlUrl = ThisWorkbook.Path &amp; \"\\test.xml\"\n\n    xmlDoc.async = False\n\n    'If loading xml file has no error\n    If xmlDoc.Load(xmlUrl) Then\n\n        'Set start row of sheet\n        row = 1\n\n        'Get root element from xml document\n        Set elements = xmlDoc.DocumentElement\n\n        'Loop all child tags from \"n0:Partner\" tags\n        For Each partner In elements.ChildNodes\n\n            'Loop all child tags from 'n1:A' tags\n            For Each bNode In partner.ChildNodes(1).ChildNodes\n\n                Sheets(\"sheetname\").Range(\"A\" &amp; row) = partner.ChildNodes(0).Text\n\n                'Loop all child tags from from 'n1:B' tags\n                For Each child In bNode.ChildNodes\n\n                    'Check node name and set value to cell\n                    Select Case child.nodeName\n\n                        Case \"n1:C\"\n                            Sheets(\"sheetname\").Range(\"C\" &amp; row) = child.Text\n\n                        Case \"n1:D\"\n                            Sheets(\"sheetname\").Range(\"D\" &amp; row) = child.Text\n\n                        Case \"n1:E\"\n                            Sheets(\"sheetname\").Range(\"E\" &amp; row) = child.Text\n\n                    End Select\n\n                Next child\n\n                'Increase row\n                row = row + 1\n\n           Next bNode\n\n        Next partner\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5104610, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd9284880317b16e0ebb529f12bac7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/5104610/maurice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 31431662, "answer_count": 1, "score": 1, "last_activity_date": 1436966644, "creation_date": 1436925185, "last_edit_date": 1531164843, "question_id": 31420211, "link": "https://stackoverflow.com/questions/31420211/reading-xml-and-repeating-a-value-across-a-cell-range", "title": "Reading XML and repeating a value across a cell range", "body": "<p>I have the following xml that I would like to import into Excel using VBA</p>\n\n<pre><code>&lt;rootElement xmlns:n0=\"http://www.w3.org/n0/\" xmlns:n1=\"http://www.w3.org/n1/\"&gt;\n&lt;n0:Partner&gt;\n    &lt;n1:Identifier&gt;EMH38&lt;/n1:Identifier&gt;\n    &lt;n1:A&gt;\n        &lt;n1:B&gt;\n            &lt;n1:C&gt;WZFR8&lt;/n1:C&gt;\n            &lt;n1:D&gt;Coll&lt;/n1:D&gt;\n            &lt;n1:E&gt;1&lt;/n1:E&gt;\n        &lt;/n1:B&gt;\n        &lt;n1:B&gt;\n            &lt;n1:C&gt;X3HV7&lt;/n1:C&gt;\n            &lt;n1:D&gt;Coll&lt;/n1:D&gt;\n            &lt;n1:E&gt;2&lt;/n1:E&gt;\n        &lt;/n1:B&gt;\n        &lt;n1:B&gt;\n            &lt;n1:C&gt;X5E86&lt;/n1:C&gt;\n            &lt;n1:D&gt;Coll&lt;/n1:D&gt;\n            &lt;n1:E&gt;3&lt;/n1:E&gt;\n        &lt;/n1:B&gt;\n        &lt;n1:B&gt;\n            &lt;n1:C&gt;X5FC6&lt;/n1:C&gt;\n            &lt;n1:D&gt;Coll&lt;/n1:D&gt;\n        &lt;/n1:B&gt;\n        &lt;n1:B&gt;\n            &lt;n1:C&gt;X5FL6&lt;/n1:C&gt;\n            &lt;n1:D&gt;Coll&lt;/n1:D&gt;\n            &lt;n1:E&gt;5&lt;/n1:E&gt;\n        &lt;/n1:B&gt;\n    &lt;/n1:A&gt;\n&lt;/n0:Partner&gt;\n</code></pre>\n\n<p></p>\n\n<p>After reading in the file, the output in the Excel worksheet was</p>\n\n<pre><code> Identifier C       D       E\n EMH38      WZFR8      Coll     1\n            X3HV7      Coll     2\n            X5E86      Coll     3\n            X5FC6      Coll \n            X5FL6      Coll     5\n</code></pre>\n\n<p>The preferred output after reading in the file would have to be the following. \nHow can I make the Identifier appear on each row? </p>\n\n<pre><code> Identifier C       D       E\n EMH38      WZFR8      Coll     1\n EMH38      X3HV7      Coll     2\n EMH38      X5E86      Coll     3\n EMH38      X5FC6      Coll \n EMH38      X5FL6      Coll     5\n</code></pre>\n"}]