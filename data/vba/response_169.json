[{"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522888480, "post_id": 49661848, "comment_id": 86334867, "body": "Excel should recognize that format as a date in most locales. What is your locale? What exactly is in those cells?  And how do you know that Excel is not recognizing it as a date?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 1, "creation_date": 1522899768, "post_id": 49661848, "comment_id": 86337391, "body": "Try using DateValue function to convert text date into real date. DateValue(&quot;2018-04-01&quot;) will give you 43191, which you can format as you prefer."}], "answers": [{"tags": [], "owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1522919446, "creation_date": 1522919446, "answer_id": 49668446, "question_id": 49661848, "link": "https://stackoverflow.com/questions/49661848/excel-vba-inserting-missing-dates/49668446#49668446", "title": "Excel VBA inserting missing dates", "body": "<p>To help you with the date conversion. You could check your locale, and check if DateValue works for you.</p>\n\n<p>In terms of converting a date in 'yyyy-mm-dd' format using string functions, you could do it in vba as follows:</p>\n\n<pre><code>myDate = dateSerial(left(\"a\" &amp; x, 4),mid(\"a\" &amp; x, 6,2), mid(\"a\" &amp; x, 9,2))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9599074, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214600980913447/picture?type=large", "display_name": "Julian P", "link": "https://stackoverflow.com/users/9599074/julian-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522919446, "creation_date": 1522883865, "last_edit_date": 1522884597, "question_id": 49661848, "link": "https://stackoverflow.com/questions/49661848/excel-vba-inserting-missing-dates", "title": "Excel VBA inserting missing dates", "body": "<p>Hi I'm pretty new to vba and I have been trying for a long time to figure this out but can't seem to crack it. </p>\n\n<p>i have a workbook with several sheets, and in the even numbered sheets there are dates in <code>yyyy-mm-dd</code> format in column a, and data in columns b through whatever (it varies). </p>\n\n<p>Excel doesn't seem to be able to recognize these as dates, and I need to use a formula that finds missing dates in each sheet and then inserts a new row with the missing date (and blanks for the column's b thru however wide that sheet is). </p>\n\n<p>I have gotten lost just trying to convert the dates to <code>mm/dd/yy</code> so that Excel will at least recognize them as dates. </p>\n\n<p>my code is not great, but I have so far really only figured out how to loop across the even numbered sheets and insert blank columns.</p>\n\n<pre><code> Sub add_columns()\n    Dim i As Integer\n    Dim ws_num As Integer\n\n\n\n    Dim starting_ws As Worksheet\n    Set starting_ws = ActiveSheet\n    ws_num = ThisWorkbook.Worksheets.Count\n\n        For i = 2 To ws_num Step 2\n                ThisWorkbook.Worksheets(i).Activate\n                    Range(\"B1\").EntireColumn.Insert\n                    Range(\"B:D\").EntireColumn.Insert\n\n                 **For x = 2 to #ROWS in column B\n                    cell.b\"x\" = MID(b\"x\",3,2) \n                    cell.c\"x\" = mid(a\"x\",6,2)\n                    cell.d\"x\" = left(a\"x\",2)\n                    cell.e\"x\" = c\"x\" / d\"x\" / b\"x\"\n                 next**\n\n        Next   \nEnd Sub\n</code></pre>\n\n<p>The stuff between the stars is what I can't figure out, and this would really only give me dates in the right format, but even that would be a big help.</p>\n\n<p>After that I would try to write something to look across the dates, determine if a cell is equal to the previous plus one, if not insert new row, make date cell equal to the previous plus one, check again etc etc. </p>\n\n<p>Thanks  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522882724, "post_id": 49661668, "comment_id": 86333225, "body": "Why not just do a replace: <code>ActiveSheet.Range(&quot;R:R&quot;).Replace &quot;PENNSILVANIA&quot;,&quot;PENNSYLVANIA&quot;</code> and skip the loop."}, {"owner": {"reputation": 17, "user_id": 9523805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f305ea6d2c1d5efdc7936c10378f634?s=128&d=identicon&r=PG&f=1", "display_name": "NoobMaster101", "link": "https://stackoverflow.com/users/9523805/noobmaster101"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522883601, "post_id": 49661668, "comment_id": 86333497, "body": "That works for that particular case but for example if I have cells with &quot;Brandon&quot;, &quot;Brandon N Clark&quot; or &quot;Brandon &amp;Clark&quot;   and wanted them to be corrected to &quot;Brandon &amp; Clark&quot;, by finding all cells that include the word &quot;Brandon&quot; i can correct them all instead of looking at them case by case. That was my logic behind this but maybe your way is simpler?"}], "answers": [{"comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1522884214, "post_id": 49661818, "comment_id": 86333664, "body": "In which way this is different from OP?  The exit loop must happen when Penn is nothing."}, {"owner": {"reputation": 17, "user_id": 9523805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f305ea6d2c1d5efdc7936c10378f634?s=128&d=identicon&r=PG&f=1", "display_name": "NoobMaster101", "link": "https://stackoverflow.com/users/9523805/noobmaster101"}, "edited": false, "score": 0, "creation_date": 1522884289, "post_id": 49661818, "comment_id": 86333685, "body": "Thank you for fixing the indentation and for helping out. I tried your way but it is still giving me the same error when comparing  &#39;Penn.Address&#39; to &#39;Address&#39;."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1522885347, "post_id": 49661818, "comment_id": 86333972, "body": "Right, please swap the checks. I&#39;m doing this on my mobile phone and didn&#39;t test it."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1522885447, "last_edit_date": 1522885447, "creation_date": 1522883655, "answer_id": 49661818, "question_id": 49661668, "link": "https://stackoverflow.com/questions/49661668/vba-an-object-in-a-loop-is-going-to-nothing-and-is-giving-me-an-object-varia/49661818#49661818", "title": "VBA: An object in a loop is going to &quot;Nothing&quot; and is giving me an &quot;Object variable or With block variable not set&quot; Error", "body": "<p>The problem is with how Excel evaluates a compound logical statement. Many languages would encounter <code>Loop While Not Penn Is Nothing</code> and detect that <code>Penn Is Nothing</code> and terminate the loop immediately. Excel VBA evaluates <em>ALL</em> parts of the logical check before deciding the logical result. Therefore your error is tripping because <code>Penn.Address</code> is actually nothing but is attempting to compare it to <code>Address</code>. That's what's throwing the error.</p>\n\n<p>Rewrite your <code>If</code> and <code>Loop</code> to something like this</p>\n\n<pre><code>If Not Penn Is Nothing Then\n    Address = Penn.Address\n    Do\n        Penn.Value = \"PENNSYLVANIA\"\n        Set Penn = Columns(\"R\").FindNext(Penn)\n        If Penn Is Nothing Then\n            Exit Do\n        End If\n    Loop While Penn.Address &lt;&gt; Address\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522904624, "creation_date": 1522904624, "answer_id": 49664478, "question_id": 49661668, "link": "https://stackoverflow.com/questions/49661668/vba-an-object-in-a-loop-is-going-to-nothing-and-is-giving-me-an-object-varia/49664478#49664478", "title": "VBA: An object in a loop is going to &quot;Nothing&quot; and is giving me an &quot;Object variable or With block variable not set&quot; Error", "body": "<p>Since Find() wraps back to the first found range you could skip the first substitution, loop through all remaining values, exit loop at wrapping back to the first skipped value and finally substitute it</p>\n\n<pre><code>Sub CleanMFG()\n    Set Penn = Columns(\"R\").Find(What:=\"PENNSILVANIA\", LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n    If Not Penn Is Nothing Then\n        Address = Penn.Address\n        Do\n            Set Penn = Columns(\"R\").FindNext(Penn)\n            Penn.Value = \"PENNSYLVANIA\"\n        Loop While Not Penn.Address &lt;&gt; Address\n        Penn.Value = \"PENNSYLVANIA\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9523805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f305ea6d2c1d5efdc7936c10378f634?s=128&d=identicon&r=PG&f=1", "display_name": "NoobMaster101", "link": "https://stackoverflow.com/users/9523805/noobmaster101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 49661818, "answer_count": 2, "score": 1, "last_activity_date": 1522904624, "creation_date": 1522882586, "last_edit_date": 1531164843, "question_id": 49661668, "link": "https://stackoverflow.com/questions/49661668/vba-an-object-in-a-loop-is-going-to-nothing-and-is-giving-me-an-object-varia", "title": "VBA: An object in a loop is going to &quot;Nothing&quot; and is giving me an &quot;Object variable or With block variable not set&quot; Error", "body": "<p>I have a column with strings and I am going through it to find and correct errors. The following code goes through the column finds the error and replaces it with the correct string.</p>\n\n<p>This is correcting PENNSILVANIA to PENNSYLVANIA.</p>\n\n<pre><code>Sub CleanMFG()\n    Set Penn = Columns(\"R\").Find(What:=\"PENNSILVANIA\", LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n    If Not Penn Is Nothing Then\n        Address = Penn.Address\n        Do\n            Penn.Value = \"PENNSYLVANIA\"\n            Set Penn = Columns(\"R\").FindNext(Penn)\n        Loop While Not Penn Is Nothing And Penn.Address &lt;&gt; Address\n    End If\n</code></pre>\n\n<p>My problem is that after correcting all the instances of this error, the \"Penn\" object become Nothing and thus I get an error.</p>\n\n<p>Any ideas on how I can deal with this are appreciated.</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522879640, "post_id": 49661063, "comment_id": 86332098, "body": "Pivot table perhaps?"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522880557, "post_id": 49661063, "comment_id": 86332407, "body": "What is a pivot table?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522880584, "post_id": 49661063, "comment_id": 86332414, "body": "I thought <i>I</i> talked too much...  :-)  I removed everything except for the relevant parts, and tidied your code.  I&#39;m not sure if the comments were just for yourself but they were making the code harder to follow.  (...On a programming site, you don&#39;t need to explain what <code>+1</code> and <code>=TRUE</code> mean)  <b>:-)</b>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522880778, "post_id": 49661063, "comment_id": 86332488, "body": "Pivot tables might not help...  Question to confirm:   the target sheet should have one of each ID... based on the <code>Number</code> or the &quot;highest letter&quot; is <code>Revision</code>?  (Like <code>B &gt; A</code> ?  If so, what happens when you get to <code>Z</code>?)"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522880938, "post_id": 49661063, "comment_id": 86332548, "body": "After Z is AA, AB, AC, and so on until ZZ"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522881143, "post_id": 49661063, "comment_id": 86332635, "body": "The target sheet should have one of each ID based on the revision. The number and title columns can be ignored in this fragment"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522881163, "post_id": 49661063, "comment_id": 86332643, "body": "And that&#39;s what you want to sort the revision by?  Did you choose this method (so it can be changed to a &quot;modern-day&quot; method of organization) or is this coming from somewhere else (and has to stay)?  It&#39;s not impossible but it adds a potentially needless complication."}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522881311, "post_id": 49661063, "comment_id": 86332690, "body": "I think you&#39;re asking if I can switch ABCD to 1234? If so, no, they have to stay as letters because I am getting them from somewhere else. The excel sheet is already organized by newest to oldest, though"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522881422, "post_id": 49661063, "comment_id": 86332726, "body": "I&#39;m not very familiar with VBA syntax, but what I am trying to do is loop through the ID column and every time I find something new, add the whole row to the target sheet"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1522881453, "post_id": 49661063, "comment_id": 86332740, "body": "Is it perhaps because you have <code>For Each c In source.Range(&quot;D1:D5000&quot;)</code> ...meaning, for each cell in the range.  Then, when you call <code>c.Cells(4,1)</code> it&#39;s throwing an error because you can&#39;t ask for &quot;row 4, column 1&quot; of a <i>single cell</i>.  You either need <code>OFFSET()</code>, or perhaps you mean <code>For Each c In source.Range(&quot;D1:D5000&quot;).Rows</code> and switch to <code>c.Cells(1,4)</code>??"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522881631, "post_id": 49661063, "comment_id": 86332818, "body": "I tried to compare c with (c+1) but it also gave me a type mismatch. I&#39;m not sure if using a range was the best approach but I don&#39;t know how to loop through a sheet and use variables as coordinates instead of numbers"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522881908, "post_id": 49661063, "comment_id": 86332911, "body": "I can think of a <b>much</b> easier way to do this.  Just a question first:  Does the list <i>need</i> to be on a separate worksheet?  (Are you further manipulating the data on the other sheet or is it just for reference?) If you could click a button on this worksheet to toggle between  <code>&quot;view all&quot;</code> and <code>&quot;view most recent only&quot;</code>, would that work for you?"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522882282, "post_id": 49661063, "comment_id": 86333049, "body": "a toggle would work fine I think"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522882284, "post_id": 49661063, "comment_id": 86333050, "body": "I&#39;ll just be a couple minutes to write an answer with an example.  :)"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522883935, "post_id": 49661063, "comment_id": 86333596, "body": "Is your revision column actually filled with the letters A, B, C (denoting order)? Or is there some kind of &quot;Revision Date&quot; field that helps you identify what the latest revision is?"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522884143, "post_id": 49661063, "comment_id": 86333648, "body": "there is a revision date which is how I organized it already, but the sheet is already in order"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522965968, "post_id": 49661904, "comment_id": 86376277, "body": "When you say the =COUNTIF($D2$2:D2,D2) works even if the sheet is not in order, does that mean it will work if the revisions are not in order?"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522967831, "post_id": 49661904, "comment_id": 86376821, "body": "also, the data in the sheet is extracted from another website. so if I wanted to make something that could automate any sheet could I make something to paste that formula in the last column and would it work?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522967937, "post_id": 49661904, "comment_id": 86376857, "body": "No - I can see how that cab be misinterpreted.  It will still count the &quot;top-most&quot; occurrence of each ID as #1, even if unrelated ID&#39;s are inserted in between.  An array formula <i>could</i> be used to determine the newest revision even if they are completely mixed up, <b>but</b> the &quot;A-&gt;Z, AA-&gt;ZZ numbering&quot; system would need special consideration... although I was thinking about that.  <b>I&#39;ll add a tricky formula &amp; function to the end of my answer to convert the revision letters to a &quot;sortable&quot; number</b> in a couple minutes.   An alternate way would be to add the date of entry to each row."}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522968806, "post_id": 49661904, "comment_id": 86377076, "body": "I have a column M for date of entry, it&#39;s how I sorted it before, but what bugs me is when I recorded a macro to custom filter the sheet by number then ID then date, it only does it if the sheet is the same name as the one I recorded"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 0, "creation_date": 1522969161, "post_id": 49661904, "comment_id": 86377173, "body": "As for pasting the formula, I would record a macro of yourself entering the formula into the first cell and then double clicking the &quot;autofill&quot; handle in the bottom-right of the cell, then adjusting the generated code as necessary.  You&#39;d use something like:  <code>Range(&quot;E2&quot;).Formula = &quot;your formula here&quot;</code> (next line:) <code>Range(&quot;E2&quot;).AutoFill Destination:=Range(&quot;E2:E5000&quot;)</code> (or better yet, a formula to using <code>xlEnd</code> to figure out the <i>actual</i> end of the data."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1522969155, "last_edit_date": 1522969155, "creation_date": 1522884373, "answer_id": 49661904, "question_id": 49661063, "link": "https://stackoverflow.com/questions/49661063/copy-most-recent-revisions-for-each-id-to-new-worksheet/49661904#49661904", "title": "Copy most recent revisions for each ID to new worksheet", "body": "<p>There are actually a few ways this can be accomplished in seconds without even using VBA.  Here's one way.</p>\n\n<p>Using your sample data as an example, in columns A to D, and we want to hide everything except the <em>first</em> occurrence of each ID:</p>\n\n<ul>\n<li><p>In cell <code>E2</code> enter formula:  </p>\n\n<pre><code>=COUNTIF($D$2:D2,D2)\n</code></pre>\n\n<p>...and then copy or \"fill\" it down to row 5000 or however far your data goes.  (If necessary, <strong>insert</strong> a new column first -- you can always <strong>hide</strong> it when you're done setting this up.)</p></li>\n<li><p>Under the <code>Data</code> menu, click <code>Filter</code>.</p></li>\n<li><p>In the <em>Filter</em> menu on column <code>E</code>, choose to only show values of <code>1</code>.</p></li>\n</ul>\n\n<p>Everything disappears except the most recent.  At the bottom of the screen you'll see a count of total &amp; displayed rows.  Another advantage to this method is will work even if the columns are NOT in order.</p>\n\n<p><a href=\"https://i.imgur.com/34he6w4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/34he6w4.gif\" alt=\"img\"></a></p>\n\n<p>Now I know this isn't a <em>toggle button</em> but it's pretty darn close.  Just for the heck of it I'll slap together some code for a button too. (So yeah technically it uses VBA - except I'm going to make Excel write the code for me!)   ...</p>\n\n<hr>\n\n<h2>\"Toggle\" Command Button:</h2>\n\n<p>Add a command button and attach the following code to it (changing the name of the button and the auto-filter columns if necessary)</p>\n\n<pre><code>Sub Button1_Click()\n    With ActiveSheet.Shapes(\"Button 1\").TextFrame.Characters\n        If .Text &lt;&gt; \"Show All\" Then\n             'only most recent\n            .Text = \"Show All\"\n            ActiveSheet.Range(\"$A$1:$E$11\").AutoFilter Field:=5, Criteria1:=\"1\"\n        Else\n            'show all\n            ActiveSheet.Range(\"$A$1:$E$11\").AutoFilter Field:=5\n            .Text = \"Show Most Recent\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XXvEI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XXvEI.gif\" alt=\"img2\"></a></p>\n\n<hr>\n\n<h2>How to sort by your letter/numbering system</h2>\n\n<p>As mentioned, your numbering system of <code>A\u2192Z\u2192AA\u2192ZZ\u2192 etc</code> leaves a lot to be desired, especially since Excel doesn't sort letter that way.  (Alphabetically,<code>AA</code> comes long before <code>Z</code>.)  </p>\n\n<p>But I had an idea: if necessary you could use this \"sneaky\" method of getting the \"number\" from the letters, based on Excel's column numbers.  </p>\n\n<p><strong>Worksheet Formula:</strong></p>\n\n<pre><code>=COLUMN(INDIRECT(A1&amp;\"1\"))\n</code></pre>\n\n<p><strong>VBA Functiom:</strong></p>\n\n<pre><code>Function numberFromRevision(revStr As String) As Long\n    On Error Resume Next\n    numberFromRevision = Range(revStr &amp; \"1\").Column\nEnd Function\n</code></pre>\n\n<p>Both return results like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kuh7C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kuh7C.png\" alt=\"img\"></a></p>\n\n<p><strong>Maximum column</strong>:<code>XFD</code> = 16384 revisions.  This could be handy in a number of ways you haven't even considered yet.   :)</p>\n"}], "owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49661904, "answer_count": 1, "score": 3, "last_activity_date": 1524088222, "creation_date": 1522878997, "last_edit_date": 1524088222, "question_id": 49661063, "link": "https://stackoverflow.com/questions/49661063/copy-most-recent-revisions-for-each-id-to-new-worksheet", "title": "Copy most recent revisions for each ID to new worksheet", "body": "<p>I have 4 columns: <code>Number</code>, <code>Title</code>, <code>Revision</code>, <code>ID</code>.  Each row has a unique ID.  The sheet is grouped by ID and sorted so the newest revision is at the top.</p>\n\n<p>I'm trying to create a new sheet with only the <strong>most recent revisions for each ID</strong>.</p>\n\n<p><strong><em>My code:</em></strong></p>\n\n<pre><code> Sub mySub()\n\n    Dim j As Long\n    j = 2 ' row 1 on sheet2 is headings\n\n    Dim source As Excel.Worksheet 'source\n    Dim target As Excel.Worksheet 'target\n    Set source = ThisWorkbook.Worksheets(\"owssvr (1)\") 'source sheet\n    Set target = wb.Sheets.Add(Type:=xlWorksheet, _\n        after:=Application.ActiveSheet) '(\"Sheet2\") 'target sheet\n    Sheets(\"owssvr (1)\").Activate 'sheet with data\n\n    For Each c In source.Range(\"D1:D5000\") 'currently currently 5000 rows\n        Dim alreadythere As Boolean 'already on sheet2?\n        alreadythere = False 'not in sheet2 yet\n\n' ***** \"TYPE MISMATCH\" ERROR on following line *****\n        If c.Cells(4, 1).Value &lt;&gt; c.Offset(0, 1).Cells(4, 1).Value Then \n\n            For ctr = 1 To j 'checking from row 1 to last row in sheet2\n                If c = target.Cells(ctr, 4) Then 'if it is in sheet2\n                    alreadythere = True 'already exists\n                End If\n            Next ctr\n            If alreadythere = False Then 'if its not in sheet2 already\n                 source.Rows(c.Row).Copy 'copy\n                 target.Rows(j).PasteSpecial Paste:=xlPasteValues 'paste\n                 Application.CutCopyMode = False 'fix mode\n                 j = j + 1 'count new row\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p><strong>Data Example and Expected outcome:</strong>  </p>\n\n<pre><code>Number    Title    Revision    ID\n1        Title 1     C       GH6YY\n1        Title 1     B       GH6YY\n1        Title 1     A       SDF212\n2        Title 2     B       SDF212\n2        Title 2     A       SDF212\n3        Title 3     B       GTR3000\n3        Title 3     A       GTR3000\n3        Title 4     C       RTT24\n3        Title 4     B       RTT24\n3        Title 4     A       RTT24  \n</code></pre>\n\n<p><strong>Expected Outcome:</strong>  </p>\n\n<pre><code>Number   Title    Revision   ID\n1        Title 1     C       GH6YY\n2        Title 2     B       SDF212\n3        Title 3     B       GTR3000\n3        Title 4     C       RTT24  \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1522881635, "post_id": 49660561, "comment_id": 86332819, "body": "I figure out by myself. here the new code.                                                                           fileName = Range(&quot;C6&quot;).Value &amp; Format(Now(), &quot; mm-dd-yyyy hh_mm AM/PM&quot;)     ActiveWorkbook.SaveCopyAs fileName:=Path &amp; fileName &amp; &quot;.xlsm&quot;         ActiveWorkbook.Close False         ActiveWorkbook.Close     ActiveWorkbook.Close"}], "owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1523402924, "creation_date": 1522876520, "last_edit_date": 1523402924, "question_id": 49660561, "link": "https://stackoverflow.com/questions/49660561/run-time-error1004methodsaveasof-object-workbookfailed", "title": "Run-Time Error&#39;1004&#39;;Method&#39;SaveAs&#39;of object&#39;_Workbook&quot;Failed", "body": "<p>I am trying use my Material order template to sending email to a team group and saving the file to a specific location with a specific name on the Excel file based on the cell range. </p>\n\n<p>However, everything else work fine except the the code, <code>ActiveWorkbook.SaveAs fileName:=Path &amp; fileName &amp; \".xlsm\", FileFormat:=xlNormal.</code> I got yellow high-lined on the code above. it wont allow me save the file to the folder with new name. </p>\n\n<p>Here the code</p>\n\n<pre><code>Private Sub cmdNot_Click()\n\n    If Application.UserName = \"Ryan Tory\" Then\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim fileName As String\n    Dim mSubject As String\n    Dim signature As String\n    Dim fname As String\n    Dim mBody As String\n    Dim rng As Range\n    Dim rng1 As Range\n    Dim ws As Worksheet\n    Dim mailTo As String\n    Set ws = Sheets(\"MRO\")\n    fname = ws.Range(\"B4\")\n    mSubject = \"MRO Template\" &amp; \"  For  \" &amp; Range(\"C6\").Value\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    'mBody = \"\\\\000-Draft\\Material Request\\Manufacturing Change Order.xlsm\" &amp; \"  For  \" &amp; Range(\"C6\").Value\n    mBody = \"&lt;font size=\"\"3\"\" face=\"\"Calibri\"\"&gt;\" &amp; _\n                  \"Dear Team,&lt;br&gt;&lt;br&gt;\" &amp; _\n                  \"Please open the file from below link and put your signature on the respective cell after you completed your task.&lt;br&gt;&lt;B&gt;\" &amp; _\n                  ActiveWorkbook.Name &amp; \"&lt;/B&gt; is created.&lt;br&gt;\" &amp; _\n                  \"Click on this link to open the file : \" &amp; _\n                  \"&lt;A HREF=\"\"file://\" &amp; ActiveWorkbook.FullName &amp; _\n                  \"\"\"&gt;Link to the file&lt;/A&gt;\" &amp; _\n                  \"&lt;br&gt;&lt;br&gt;Best Regards,\" &amp; _\n                  \"&lt;br&gt;&lt;br&gt;&lt;/font&gt;\"\n\n    With OutMail\n    .display\n    End With\n    signature = OutMail.body\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n\n    With OutMail\n        '.To = \"email\"\n        .To = \"materials@OFTMG.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = mSubject &amp; \" For \"\n        '.body = \"Dear Team,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Please open the file from below link and put your signature on the respective cell and save the sheet\"\n        '.htmlbody = RangetoHTML(rng)\n        .htmlbody = mBody\n        '.Attachments.Add fileName\n        .display\n    End With\n    'ws.PageSetup.RightHeader = \"&amp;\"\"Calibri,italic\"\"&amp;11&amp; \" &amp; ws.Range(\"A1\")\n    ws.Protect (\"MRO\")\n    ws.Protect (\"MRO\")\n    Path = \"\\\\000-Draft\\Kaizen Training\\Material Request\\New\\\"\n    fileName = Range(\"C6\")\n    ActiveWorkbook.SaveAs fileName:=Path &amp; fileName &amp; \".xlsm\", FileFormat:=xlNormal\n    ActiveWorkbook.Close\n        On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n     End With\n\nElse\nMsgBox \"You are not authorised to send MRO form, please check with MRO Owner\", vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1522876272, "post_id": 49660464, "comment_id": 86330556, "body": "Use Set CheckForExistingWorkbooks = wb1"}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 2, "last_activity_date": 1522876631, "creation_date": 1522876631, "answer_id": 49660595, "question_id": 49660464, "link": "https://stackoverflow.com/questions/49660464/vba-function-to-check-if-a-workbook-exists/49660595#49660595", "title": "VBA function to check if a workbook exists", "body": "<p>Try this - without needing error detection:</p>\n\n<pre><code>Function CheckForExistingWorkbooks() As Workbook\n    Dim wb1 as Workbook\n    Dim TestStr As String, FilePath As String\n    FilePath = ThisWorkbook.Path &amp; \"\\Student Information.xlsx\"\n    If Len(Dir(FilePath)) = 0 Then\n        Set wb1 = Workbooks.Add\n    Else\n        Set wb1 = Workbooks.Open(FilePath)\n    End If\n    Set CheckForExistingWorkbooks = wb1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8820772, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-cMIw8NBJMRQ/AAAAAAAAAAI/AAAAAAAAAG4/j7iWHDN-E2o/photo.jpg?sz=128", "display_name": "Nimy Alex", "link": "https://stackoverflow.com/users/8820772/nimy-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "accepted_answer_id": 49660595, "answer_count": 1, "score": 1, "last_activity_date": 1522876751, "creation_date": 1522876126, "question_id": 49660464, "link": "https://stackoverflow.com/questions/49660464/vba-function-to-check-if-a-workbook-exists", "title": "VBA function to check if a workbook exists", "body": "<p>I have two workbooks <strong>1: Source.xlsx</strong> and <strong>2. Destination.xlsx</strong>. If the #2 exists in the same location as that of #1, then return the workbook to my main function, else create a new workbook and return it.\nI have the following code:</p>\n\n<pre><code>Function CheckForExistingWorkbooks() As Workbook\nDim wb1 As Workbook\nDim FilePath As String\nDim TestStr As String\n\nFilePath = ThisWorkbook.Path &amp; \"\\Student Information.xlsx\"\n\nTestStr = \"\"\nOn Error Resume Next\nTestStr = Dir(FilePath)\nOn Error GoTo 0\nIf TestStr = \"\" Then\n    Set wb1 = Workbooks.Add\nElse\n    Set wb1 = Workbooks.Open(FilePath)\nEnd If\n\nCheckForExistingWorkbooks = wb1\nEnd Function \n</code></pre>\n\n<p>On debugging, the function returns \"Nothing\". How do I get this to work?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 2, "creation_date": 1522879734, "post_id": 49661053, "comment_id": 86332136, "body": "Epic!! That explanation was crystal clear btw!  Thank you so much!!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522881014, "post_id": 49661053, "comment_id": 86332584, "body": "Great answer.  Going on the \ud83c\udf1f Favourite list, for future reference and referral. (and I&#39;m deleting my other lame response!)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 20, "last_activity_date": 1522878938, "creation_date": 1522878938, "answer_id": 49661053, "question_id": 49660399, "link": "https://stackoverflow.com/questions/49660399/is-it-possible-to-create-and-handle-a-custom-event-in-a-customized-userform/49661053#49661053", "title": "Is it possible to create and handle a custom Event in a Customized UserForm?", "body": "<p>Yes, but you need to understand how VBA/COM events work first.</p>\n\n<h3>A bit of background...</h3>\n\n<p>Notice the dropdowns/comboboxes at the top of the VBE's code panes? The leftmost one is listing all available <em>interfaces</em> and <em>event providers</em> - the rightmost one is listing the available <em>members</em> and <em>events</em> exposed by whatever is selected in the leftmost dropdown.</p>\n\n<p>So when you handle the <code>Click</code> event of some <code>OkButton</code> in the code-behind of <code>UserForm1</code>, the handler stub might look like this:</p>\n\n<pre><code>Private Sub OkButton_Click()\n\nEnd Sub\n</code></pre>\n\n<p>The signature is constructed in a very particular way, always in the same manner, regardless of whether you're implementing an interface or handling an event:</p>\n\n<pre><code>Private Sub [Provider]_[MemberName]([Args])\n</code></pre>\n\n<p>That underscore matters. Whatever you do, <strong>DO NOT</strong> name an event (or interface member) with an identifier that contains an underscore. In the case of an event, you'll hit a compile error:</p>\n\n<blockquote>\n  <p>Compile error: Invalid event name</p>\n</blockquote>\n\n<p>In the case of an interface, you'll also get a compile error, with the VBE complaining that interface members aren't implemented.</p>\n\n<p>This is why everything is <code>PascalCase</code> and not <code>Upper_Snake_Case</code> in VB. Stick to the convention, avoid underscores in public member names.</p>\n\n<p>If you're not sure what interfaces are and why I'm mentioning them in a post about events, lookup the <code>Implements</code> keyword, know that interfaces and events are very intimately related and work in a very similar fashion, and keep reading ;-)</p>\n\n<hr>\n\n<h3>The Provider</h3>\n\n<p>Any <em>class</em> can define events. A <code>UserForm</code> being a class, it can absolutely define events, yes. You define events exactly how you've done, using the <code>Event</code> keyword:</p>\n\n<pre><code>Public Event SomethingHappened(ByVal SomeArg As Long)\n</code></pre>\n\n<p>The class that defines the event is an event <em>provider</em> - it is the only class that is allowed to <em>raise</em> the events it defines.</p>\n\n<p>You raise events using the <code>RaiseEvent</code> keyword, and provide the arguments:</p>\n\n<pre><code>Private Sub OnSomethingHappened()\n    RaiseEvent SomethingHappened(42)\nEnd Sub\n</code></pre>\n\n<p>When and why you raise events is entirely up to your imagination.</p>\n\n<hr>\n\n<h3>The Client</h3>\n\n<p>Consider the <code>Click</code> event of a <code>CommandButton</code> on a <code>UserForm</code>: the <code>CommandButton</code> class probably has a method that listens for Win32 messages involving the mouse, and when it decides to handle a left-button click, it raises its <code>Click</code> event, and <em>something something</em> and poof the <code>OkButton_Click</code> procedure runs. Right?</p>\n\n<p>The part MSForms is automagically doing for you, is that when you add a <code>CommandButton</code> on the form, and name it <code>OkButton</code>, well this <code>OkButton</code> identifier essentially becomes a public field on the form, as if you had added a public, module-level variable:</p>\n\n<pre><code>Public OkButton As MSForms.CommandButton\n</code></pre>\n\n<p>Except, it actually looks like this:</p>\n\n<pre><code>Public WithEvents OkButton As MSForms.CommandButton\n</code></pre>\n\n<p>That <code>WithEvents</code> keyword makes the <code>OkButton</code> available in the left-side dropdown - <code>OkButton</code> becomes an <em>event provider</em>, and its <code>Click</code> event can be handled... in the form's code-behind.</p>\n\n<p>The <code>CommandButton</code> class doesn't know or care about a handler for its <code>Click</code> event: the event provider is the <code>OkButton</code> object, and the <em>client</em> is the <code>UserForm1</code> class you're implementing the handlers in.</p>\n\n<p>In other words, the event provider, and the client, are two completely separate classes.</p>\n\n<hr>\n\n<p>The catch is that <code>WithEvents</code> is only legal in a class module.</p>\n\n<p>You can make your <code>UserForm1</code> an <em>event provider</em>, but it cannot handle its own events.</p>\n\n<p>Declare the events in your <code>UserForm1</code> code-behind, and make sure you specify <code>ByVal</code> parameters for parameters that are meant to be read-only at the handler site - use <code>ByRef</code> when the handler can modify the value, e.g. for some <code>Cancel As Boolean</code> parameter that you can read when the handler returns:</p>\n\n<pre><code>Public Event StatusChange(ByVal oldStatus As Long, ByVal newStatus As Long)\n</code></pre>\n\n<p>Now add a class module, call it <code>MyPresenter</code>:</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents MyView As UserForm1\n\nPrivate Sub Class_Initialize()\n    Set MyView = New UserForm1\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set MyView = Nothing\nEnd Sub\n\nPublic Sub ShowDialog()\n    MyView.Show\nEnd Sub\n</code></pre>\n\n<p>Select <code>MyView</code> from the leftmost dropdown; the rightmost dropdown should contain the <code>StatusChange</code> event - and selecting it should create a handler stub:</p>\n\n<pre><code>Private Sub MyView_StatusChange(ByVal oldStatus As Long, ByVal newStatus As Long)\n    MsgBox \"Status changed from \" &amp; oldStatus &amp; \" to \" &amp; newStatus &amp; \"!\"\nEnd Sub\n</code></pre>\n\n<p>Now, in the standard/procedural module where you were normally showing your form, instantiate that presenter class instead:</p>\n\n<pre><code>Public Sub Macro1()\n    With New MyPresenter\n        .ShowDialog\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2602, "favorite_count": 14, "accepted_answer_id": 49661053, "answer_count": 1, "score": 7, "last_activity_date": 1523745073, "creation_date": 1522875824, "last_edit_date": 1531164843, "question_id": 49660399, "link": "https://stackoverflow.com/questions/49660399/is-it-possible-to-create-and-handle-a-custom-event-in-a-customized-userform", "title": "Is it possible to create and handle a custom Event in a Customized UserForm?", "body": "<p>I have a <code>UserForm</code> to which I added a property with the adequate Let and Get statements. I would like to have an event fire when the property changes. Event, <code>RaiseEvent</code> and Routine have been stated, all in the <code>UserForm</code> module. However, I can't find a way to assign the routine to the event.</p>\n\n<p>For what I know, this is different from the usual Custom Events in Class Modules situation, because it is not declared in a Class Module whose Class I can instantiate in a regular module. All my searches provided examples to Custom Events in Class Modules or Built-In Events in UserForms, but no material on Custom Events in UserForms.</p>\n\n<p>This actually made me wonder if it is at all possible to create Custom Events in UserForms and Private Subs to handle those Events. So is it possible to do it? And if so, what am I missing? How can I make <code>Private Sub UFStatus_StatusChange()</code> handle the event?</p>\n\n<p>Any help would be apreciated!</p>\n\n<p>So far, the code goes, all in the UserForm module:</p>\n\n<pre><code>Public Event StatusChange (old_status As Long, current_status As Long)\n\nDim old_status As Long\n\nPrivate current_status As Long\n\nPublic Property Let UFStatus (RHS As Long)\n    old_status = current_status\n    current_status = RHS\n    RaiseEvent StatusChange(old_status, current_status)\n\nEnd Property\n\nPrivate Sub UFStatus_StatusChange()\n    MsgBox(\"Status changed from \" &amp; old_status &amp; \"to \" &amp; current_status)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522875880, "post_id": 49660188, "comment_id": 86330373, "body": "1) Why aren&#39;t you using the code I supplied in your earlier question? 2) What does &quot;giving me issues&quot; mean exactly? I imagine the code will always go to that statement as you are basing your Select Case on the sheet code name which is different to the name shown on the sheet tab."}, {"owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522876049, "post_id": 49660188, "comment_id": 86330459, "body": "I did use it and it worked for the first part of the code but the info I entered in the userform wouldn&#39;t populate the sheet after I submitted it."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "edited": false, "score": 0, "creation_date": 1522934543, "post_id": 49660697, "comment_id": 86357507, "body": "I see what you mean it doesn&#39;t activate the sheet. But I think I will just create a button for each sheet that will activate the userform. I like this code better though thanks."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1522877066, "creation_date": 1522877066, "answer_id": 49660697, "question_id": 49660188, "link": "https://stackoverflow.com/questions/49660188/vba-userform-programming-script/49660697#49660697", "title": "VBA Userform programming script", "body": "<p>Try this, which builds on the previous code, and avoids activating the sheet. Doing this is not the end of the world but is not necessary.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim whichSheet As String, lastrow As Long\n\nwhichSheet = InputBox(\"In which sheet do you wish to enter data? Type in sheet name as Toner, Copy Paper, Alteration, Mail Package, Gloves, and Special Requests.\", \"Input\")\n\nSelect Case whichSheet\n    Case \"Toner\", \"Copy Paper\", \"Mail Package\", \"Alteration\", \"Gloves\", \"Special Requests\"\n        With Worksheets(whichSheet)\n            lastrow = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n            .Cells(lastrow, 1) = TextBox1\n            If Application.WorksheetFunction.CountIf(.Range(\"A2:A\" &amp; lastrow), .Cells(lastrow, 1)) &gt; 1 Then\n                MsgBox \"Submitting Entry\"\n                .Cells(lastrow, 1) = \"\"\n                .Cells(lastrow, 1) = TextBox1.Text\n                .Cells(lastrow, 2) = TextBox2.Text\n                .Cells(lastrow, 3) = TextBox3.Value\n                .Cells(lastrow, 4) = TextBox4.Text\n                .Cells(lastrow, 5) = TextBox5.Text\n            End If\n        End With\n    Case Else\n        MsgBox \"Please use another Sheet name\"\n        Exit Sub\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49660697, "answer_count": 1, "score": 0, "last_activity_date": 1522877066, "creation_date": 1522874990, "last_edit_date": 1531164843, "question_id": 49660188, "link": "https://stackoverflow.com/questions/49660188/vba-userform-programming-script", "title": "VBA Userform programming script", "body": "<p>I'm trying to make this code open specific sheets in excel using the exact sheet name as an input to get to it. If the sheet name is not there or spelled incorrectly it should display the \"Please use another Sheet name\" message. I have this so far, but the \"Case Else\" part is giving me issues. I appreciate your help.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Sheetname As String\nwhichSheet = InputBox(\"In which sheet do you wish to enter data? Specify sheet number as Toner, Copy Paper,etc.\", \"Input\")\nDim ws As Worksheet\nFor Each ws In Worksheets\n    Select Case ws.CodeName\n        Case \"Toner\", \"Copy Paper\", \"Mail Package\", \"Alteration\", \"Gloves\", \"Special Requests\"\n            Worksheets(whichSheet).Activate ws.Name\n        Case Else\n            MsgBox \"Please use another Sheet name\"\n            Exit Sub\n    End Select\nNext ws\n\nWorksheets(whichSheet).Activate\nDim lastrow\nlastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nlastrow = lastrow + 1\nCells(lastrow, 1) = TextBox1\nIf Application.WorksheetFunction.CountIf(Range(\"A2:A\" &amp; lastrow), Cells(lastrow, 1)) &gt; 1 Then\nMsgBox \"Submitting Entry\"\nCells(lastrow, 1) = \"\"\n\nCells(lastrow, 1) = TextBox1.Text\nCells(lastrow, 2) = TextBox2.Text\nCells(lastrow, 3) = TextBox3.Value\nCells(lastrow, 4) = TextBox4.Text\nCells(lastrow, 5) = TextBox5.Text\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522877655, "post_id": 49660001, "comment_id": 86331240, "body": "<b><i>So which is is: vb.net, vba, excel, access, or outlook?</i></b>  That&#39;s 5 different answer&#39;s you&#39;d require. Please <a href=\"https://stackoverflow.com/posts/49660001/edit\">edit</a> your question and also see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and also <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as well as <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">these tips</a>."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1522878108, "post_id": 49660001, "comment_id": 86331446, "body": "Use dCount instead dlookup."}], "answers": [{"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1522879023, "post_id": 49660871, "comment_id": 86331812, "body": "Just a heads up: not sure if you meant to use <code>DLookup</code> or <code>DCount</code> in your code, but <code>DLookup</code> will return <code>Null</code> if no records are found, not 0."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1522879411, "post_id": 49660871, "comment_id": 86332012, "body": "@LeeMac Oops  thanks I knew that - that was a test (you passed)...  ..I&#39;ve only used <code>DLookup</code> like a bazillion times, that&#39;s all.  :-)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522879482, "last_edit_date": 1522879482, "creation_date": 1522877961, "answer_id": 49660871, "question_id": 49660001, "link": "https://stackoverflow.com/questions/49660001/access-dlookup-multiple-criteria-return-boolean-and-ordertype-not-equal-to/49660871#49660871", "title": "access dlookup multiple criteria Return Boolean And ordertype not equal to", "body": "<p><code>DLookup</code> is for looking up an individual value.  </p>\n\n<p><code>DCount</code> is for counting.</p>\n\n<p>Try this one out:</p>\n\n<pre><code>Function AllowPurge(FileID As String) As Boolean\n\n    AllowPurge = (0 = DCount(\"FileID\", \"OrderMaster\", \"OrderStatus='S' _\n        AND FileID='\" &amp; FileID \"' AND OrderType='E'\"))\n\nExit Function\n</code></pre>\n\n<p>(assuming the table is called <code>OrderMaster</code>)</p>\n\n<p>You were pretty close, except missing single quotes around the string, and missing a space, and had an extra comma.</p>\n\n<p>The logic would have worked your way the same, this is just an alternate (shorter) form.</p>\n\n<p><sub><sub><em><a href=\"https://stackoverflow.com/questions/49660001/access-dlookup-multiple-criteria-return-boolean-and-ordertype-not-equal-to/49660871?noredirect=1#comment86331812_49660871\">Thanks Lee Mac!</a></em></sub></sub></p>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1522879793, "creation_date": 1522879793, "answer_id": 49661194, "question_id": 49660001, "link": "https://stackoverflow.com/questions/49660001/access-dlookup-multiple-criteria-return-boolean-and-ordertype-not-equal-to/49661194#49661194", "title": "access dlookup multiple criteria Return Boolean And ordertype not equal to", "body": "<p>Based on your stated logic:</p>\n\n<blockquote>\n  <p>I need to:</p>\n  \n  <ul>\n  <li>Allow purge - if every single order, other than E orders, are still open.</li>\n  <li>Don't allow purge - if any order, other than an E order, is marked as shipped.</li>\n  </ul>\n</blockquote>\n\n<p>I would suggest the following:</p>\n\n<pre><code>Function AllowPurge(FileID As String) As Boolean\n    AllowPurge = IsNull(DLookup(\"FileID\", \"OrderMaster\", \"OrderStatus='S' AND FileID='\" &amp; FileID &amp; \"' AND OrderType&lt;&gt;'E'\"))\nEnd Function\n</code></pre>\n\n<p>Here, the function will only return <code>True</code> if <strong>every</strong> non-E-Order (<code>OrderType&lt;&gt;'E'</code>) is marked as Shipped (<code>OrderStatus='S'</code>).</p>\n\n<p>Your current code seems to be testing for 'E-Orders' which have been shipped, and not checking whether every non-E-Order is open.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9598973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225cb70cc80d21f0ceb71d8fc8efa41a?s=128&d=identicon&r=PG&f=1", "display_name": "JJ D", "link": "https://stackoverflow.com/users/9598973/jj-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1522960734, "creation_date": 1522960734, "answer_id": 49681134, "question_id": 49660001, "link": "https://stackoverflow.com/questions/49660001/access-dlookup-multiple-criteria-return-boolean-and-ordertype-not-equal-to/49681134#49681134", "title": "access dlookup multiple criteria Return Boolean And ordertype not equal to", "body": "<p>Thanks for the response</p>\n\n<p>I tried this and seems to be working:</p>\n\n<pre><code>i = DLookup(\"COUNT(*)\", \"OrderMaster\", \"OrderType'E' AND OrderStatus='S' AND FileID=\" &amp; FileID)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9598973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225cb70cc80d21f0ceb71d8fc8efa41a?s=128&d=identicon&r=PG&f=1", "display_name": "JJ D", "link": "https://stackoverflow.com/users/9598973/jj-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1522960734, "creation_date": 1522874269, "last_edit_date": 1522877715, "question_id": 49660001, "link": "https://stackoverflow.com/questions/49660001/access-dlookup-multiple-criteria-return-boolean-and-ordertype-not-equal-to", "title": "access dlookup multiple criteria Return Boolean And ordertype not equal to", "body": "<pre><code>Private Function AllowPurge(FileID As String) As Boolean\nDim result As Boolean\nDim i As Integer\n\ni = DLookup(\"COUNT(*)\", \"OrderMaster\", \"OrderStatus='S' AND FileID=\" &amp; FileID, \"AND OrderType='E'\")\nIf i &gt; 0 Then\n    result = False\nElse\n    result = True\nEnd If\n\nAllowPurge = result\nEnd Function\n</code></pre>\n\n<p>OrderStatus is either marked as shipped or open 'S' or 'O'.</p>\n\n<p>I need to:</p>\n\n<ul>\n<li>Allow purge - if every single order, other than E orders, are still open.</li>\n<li>Don't allow purge - if any order, other than an E order, is marked as shipped.</li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1522873896, "post_id": 49659869, "comment_id": 86329321, "body": "Why are you mixing up the sheets - Sheet1 and Data?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1522873950, "post_id": 49659869, "comment_id": 86329352, "body": "You add the <code>|</code> in your <code>NewKey</code> variable, but then don&#39;t use it in your formula.  Use <code>.Formula = &quot;=VLOOKUP(&quot; &amp; NewKey &amp; &quot;,Data!$A$1:$B$&quot;...</code> instead"}, {"owner": {"reputation": 13, "user_id": 7953942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf01e4476139892b9150440b00509ef8?s=128&d=identicon&r=PG&f=1", "display_name": "MtArronK", "link": "https://stackoverflow.com/users/7953942/mtarronk"}, "edited": false, "score": 0, "creation_date": 1522874942, "post_id": 49659869, "comment_id": 86329885, "body": "Hi SJR. Yes I have two tabs in the workbook, Sheet 1 and Data"}, {"owner": {"reputation": 13, "user_id": 7953942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf01e4476139892b9150440b00509ef8?s=128&d=identicon&r=PG&f=1", "display_name": "MtArronK", "link": "https://stackoverflow.com/users/7953942/mtarronk"}, "edited": false, "score": 0, "creation_date": 1522875024, "post_id": 49659869, "comment_id": 86329925, "body": "Hi tigeravatar. That was a mistake I made when I created this post... I already edited the code. In this way I still got the same 1004 error."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522875063, "post_id": 49659869, "comment_id": 86329943, "body": "Edit: Do you mean to use this instead? <code>NewKey = Sheets(&quot;Data&quot;).Cells ...</code>.  Currently you&#39;re taking a cell from <code>Sheet 1</code> and then <code>|</code> and then a cell from <code>Data</code>...?"}, {"owner": {"reputation": 13, "user_id": 7953942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf01e4476139892b9150440b00509ef8?s=128&d=identicon&r=PG&f=1", "display_name": "MtArronK", "link": "https://stackoverflow.com/users/7953942/mtarronk"}, "edited": false, "score": 0, "creation_date": 1522875771, "post_id": 49659869, "comment_id": 86330318, "body": "Hi BruceWayne. Where NewKey takes the second part of its string doesn&#39;t really matter. I tried to both Sheet 1 and Data and neither worked."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1522876306, "creation_date": 1522876306, "answer_id": 49660508, "question_id": 49659869, "link": "https://stackoverflow.com/questions/49659869/vba-run-time-error-1004-for-special-characters-in-soft-coded-vlookup-function/49660508#49660508", "title": "VBA Run-time Error 1004 for Special Characters in Soft-coded Vlookup Function", "body": "<p>NewKey needs to be in quotes when the formula is placed on the sheet, so you need to include the quotes in the string:</p>\n\n<pre><code>NewKey = Sheets(\"Sheet1\").Cells(i, 1).Value &amp; \"|\" &amp; Sheets(\"Sheet1\").Cells(i, 2).Value\nSheets(\"Sheet1\").Cells(i, 3).Formula = \"=VLOOKUP(\"\"\" &amp; NewKey &amp; \"\"\",Data!$A$1:$B$\" &amp; LastRow &amp; \",\" &amp; ColmNum &amp; \",0)\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7953942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf01e4476139892b9150440b00509ef8?s=128&d=identicon&r=PG&f=1", "display_name": "MtArronK", "link": "https://stackoverflow.com/users/7953942/mtarronk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522876306, "creation_date": 1522873726, "last_edit_date": 1522874882, "question_id": 49659869, "link": "https://stackoverflow.com/questions/49659869/vba-run-time-error-1004-for-special-characters-in-soft-coded-vlookup-function", "title": "VBA Run-time Error 1004 for Special Characters in Soft-coded Vlookup Function", "body": "<p>When I was trying to throw a vertical bar \"|\" into my vlookup function, I got a 1004 error. I am not sure where it came from.</p>\n\n<p>Initially the data table looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/d8ICJ.png\" alt=\"original\"></p>\n\n<p>And my code was like this:</p>\n\n<pre><code>Sheets(\"Sheet 1\").Cells(i, 2).Formula = \"=VLOOKUP($A\" &amp; i &amp; \",Data!$A$1:$B$\" &amp; LastRow &amp; \",\" &amp; ColmNum &amp; \",0)\"\n</code></pre>\n\n<p>Everything worked fine till the format of the data table got changed to:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1Zfe0.png\" alt=\"New Format\"></p>\n\n<p>So I had to throw the vertical bar \"|\" into my code. My new code was like this:</p>\n\n<pre><code>NewKey = Sheets(\"Sheet 1\").Cells(i, 1).Value &amp; \"|\" &amp; Sheets(\"Data\").Cells(i, 2).Value\nSheets(\"Sheet 1\").Cells(i, 3).Formula = \"=VLOOKUP(\" &amp; NewKey &amp; \",Data!$A$1:$B$\" &amp; LastRow &amp; \",\" &amp; ColmNum &amp; \",0)\"\n</code></pre>\n\n<p>Apparently Excel 2010 did not like my codes and threw me a 1004 error. I am wondering if anyone knows a solution to this. Thank you in advance for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522873935, "post_id": 49659844, "comment_id": 86329344, "body": "Can&#39;t reproduce over here."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1522874014, "post_id": 49659844, "comment_id": 86329380, "body": "What is the active row when you apply the CF? since the row number is relative, it will be relative to the current row, so it will matter a lot where the current selection is. It must be in row 3 for the CF to work correctly."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1522874326, "post_id": 49659844, "comment_id": 86329529, "body": "I&#39;ve had this happen to me on a number of occasions -- the cell range in the Rule or the Applies To gets changed to an <i>extremely large</i> number. My only fix has been to go in and edit by hand to fix it."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1522874410, "post_id": 49659844, "comment_id": 86329578, "body": "The extremely large number would be the one of the last rows of an Excel sheet. This happens when a relative reference to a cell above the current cell is applied to row 1."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 7911094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8-exsrk0Tfc/AAAAAAAAAAI/AAAAAAAAPbM/60Mjhqeg8Ok/photo.jpg?sz=128", "display_name": "Steve Wolfe", "link": "https://stackoverflow.com/users/7911094/steve-wolfe"}, "is_accepted": true, "score": 0, "last_activity_date": 1522982329, "creation_date": 1522982329, "answer_id": 49684410, "question_id": 49659844, "link": "https://stackoverflow.com/questions/49659844/excel-2007-vba-apply-conditional-format-on-range-based-on-cell-values/49684410#49684410", "title": "Excel 2007 - VBA - Apply Conditional Format on Range Based on Cell Values", "body": "<p>Update:</p>\n\n<p>I solved this by recording a macro where I assigned the conditional formatting to a single line, copied the formatting, then pasted it over the active range.</p>\n\n<p>Thanks to everyone for your input, and hope this helps someone else down the road!</p>\n\n<p>Code</p>\n\n<pre><code>Range(\"A3:M3\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=($J3)&lt;&gt;\"\"\"\"\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.Copy\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7911094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8-exsrk0Tfc/AAAAAAAAAAI/AAAAAAAAPbM/60Mjhqeg8Ok/photo.jpg?sz=128", "display_name": "Steve Wolfe", "link": "https://stackoverflow.com/users/7911094/steve-wolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 0, "accepted_answer_id": 49684410, "answer_count": 1, "score": 0, "last_activity_date": 1522982329, "creation_date": 1522873649, "question_id": 49659844, "link": "https://stackoverflow.com/questions/49659844/excel-2007-vba-apply-conditional-format-on-range-based-on-cell-values", "title": "Excel 2007 - VBA - Apply Conditional Format on Range Based on Cell Values", "body": "<p>For some reason, I can't figure out why the same formula that I can apply to conditional formatting regularly doesn't work in VBA. I'm trying to highlight the row in that range if one of the cells in each row is not blank.</p>\n\n<p>Below is the code I'm working with:</p>\n\n<pre><code>With Range(\"$A3:$L1000\")\n.FormatConditions.Delete\n.FormatConditions.Add xlExpression, Formula1:=\"=($J3)&lt;&gt;\"\"\"\"\"\n.FormatConditions(1).Interior.ColorIndex = 46\n\nEnd With\n</code></pre>\n\n<p>When it applies to the document, here's the formula in Conditional Formatting\n<a href=\"https://i.stack.imgur.com/LI40P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LI40P.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/EfaMR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EfaMR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help/advice you all could provide would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522872943, "post_id": 49659225, "comment_id": 86328842, "body": "What rows are you trying to create the charts for? 2-11?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522873447, "post_id": 49659225, "comment_id": 86329098, "body": "I&#39;m guessing you&#39;re trying for something like <code>ActiveChart.SetSourceData Source:=Range(&quot;&#39;Master Sheet&#39;!$B$&quot; &amp; Counter &amp; &quot;:$J$&quot; &amp; Counter)</code>"}, {"owner": {"reputation": 37, "user_id": 9598514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b81d6d5201347af010486468eac4be0?s=128&d=identicon&r=PG&f=1", "display_name": "amea6995", "link": "https://stackoverflow.com/users/9598514/amea6995"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522874133, "post_id": 49659225, "comment_id": 86329434, "body": "@dwirony yes Rows 2-11. I tried the the line you provided and its not working. the data source for the 2nd and on graphs keep getting its data from B2:J2"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9598514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b81d6d5201347af010486468eac4be0?s=128&d=identicon&r=PG&f=1", "display_name": "amea6995", "link": "https://stackoverflow.com/users/9598514/amea6995"}, "edited": false, "score": 0, "creation_date": 1522942678, "post_id": 49660157, "comment_id": 86363789, "body": "i just ran it again. it finally worked. Thanks so much!! I really appreciate the help."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1522874832, "creation_date": 1522874832, "answer_id": 49660157, "question_id": 49659225, "link": "https://stackoverflow.com/questions/49659225/creating-charts-from-template-using-loop-in-vba/49660157#49660157", "title": "Creating Charts (from Template) using Loop in VBA", "body": "<p>Just used this and it worked fine. However you definitely want to work to remove all the <code>ActiveSheet</code>s, <code>Select</code>s and <code>Cut</code>/<code>Paste</code> from this.</p>\n\n<pre><code>Sub Macro6()\n\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.ApplyChartTemplate ( _\n        \"C:\\Users\\arboari\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Education.crtx\")\n    ActiveChart.SetSourceData Source:=Range(\"'Master Sheet'!$B$2:$J$2\")\n    ActiveChart.Parent.Cut\n    Sheets(\"Charts\").Select\n    ActiveSheet.Paste\n    Sheets(\"Master Sheet\").Select\n    ActiveCell.Offset(1, 0).Range(\"A1:I1\").Select\n\n    For counter = 1 To 10\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.ApplyChartTemplate ( _\n            \"C:\\Users\\arboari\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Education.crtx\")\n        ActiveChart.SetSourceData Source:=Range(\"'Master Sheet'!$B$\" &amp; counter &amp; \":$J$\" &amp; counter)\n        ActiveChart.Parent.Cut\n        Sheets(\"Charts\").Select\n        ActiveSheet.Paste\n        Sheets(\"Charts\").Select\n        Sheets(\"Master Sheet\").Select\n        ActiveCell.Offset(1, 0).Range(\"A1:I1\").Select\n    Next counter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9598514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b81d6d5201347af010486468eac4be0?s=128&d=identicon&r=PG&f=1", "display_name": "amea6995", "link": "https://stackoverflow.com/users/9598514/amea6995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 49660157, "answer_count": 1, "score": 0, "last_activity_date": 1522909283, "creation_date": 1522871163, "last_edit_date": 1522909283, "question_id": 49659225, "link": "https://stackoverflow.com/questions/49659225/creating-charts-from-template-using-loop-in-vba", "title": "Creating Charts (from Template) using Loop in VBA", "body": "<p>I'm trying to create multiple charts for each of the row I have in my spreadsheet. I have managed to be able to create a loop but I'm stuck on how to change the source of data for the corresponding selected row for the new chart. </p>\n\n<pre><code>Sub Macro6()\n\n    Range(\"B2\").Select\n    ActiveCell.Range(\"A1:I1\").Select\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.ApplyChartTemplate ( _\n        \"C:\\Users\\arboari\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Education.crtx\")\n    ActiveChart.SetSourceData Source:=Range(\"'Master Sheet'!$B$2:$J$2\")\n    ActiveChart.Parent.Cut\n    Sheets(\"Charts\").Select\n    ActiveSheet.Paste\n    Sheets(\"Master Sheet\").Select\n    ActiveCell.Offset(1, 0).Range(\"A1:I1\").Select\n\n    For Counter = 1 To 10\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.ApplyChartTemplate ( _\n            \"C:\\Users\\arboari\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Education.crtx\")\n        **ActiveChart.SetSourceData Source:=Range(\"'Master Sheet'!$B$2:$J$2\")**\n        ActiveChart.Parent.Cut\n        Sheets(\"Charts\").Select\n        ActiveSheet.Paste\n        Sheets(\"Charts\").Select\n        Sheets(\"Master Sheet\").Select\n        ActiveCell.Offset(1, 0).Range(\"A1:I1\").Select\n    Next Counter\n\nEnd Sub\n</code></pre>\n\n<p>The line in between the asterisks is what I'm trying to make relative since its absolute thus making the new graph's data source always the B2-J2 line. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1522866787, "post_id": 49657904, "comment_id": 86325252, "body": "Hello, what is ws.codename? is that like a TextBox? , if so then it may be <code>sheets(codename)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1522866600, "creation_date": 1522866600, "answer_id": 49658009, "question_id": 49657904, "link": "https://stackoverflow.com/questions/49657904/editing-vba-script-userform/49658009#49658009", "title": "Editing VBA script Userform", "body": "<p>If I've understood correctly, I think you are overcomplicating and this will suffice. You just need to check the sheet name entered via the input box and if it falls in the first list, activate it (I assume).</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim whichSheet As String\nwhichSheet = InputBox(\"In which sheet do you wish to enter data? Type in sheet name as Toner, Copy Paper, Alteration, Mail Package, Gloves, and Special Requests.\", \"Input\")\n\nSelect Case whichSheet\n    Case \"Toner\", \"Copy Paper\", \"Mail Package\", \"Alteration\", \"Gloves\", \"Special Requests\"\n        Worksheets(whichSheet).Activate\n    Case Else\n        MsgBox \"Please use another Sheet name\"\n        Exit Sub\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 49658009, "answer_count": 1, "score": 2, "last_activity_date": 1522866600, "creation_date": 1522866237, "last_edit_date": 1531164843, "question_id": 49657904, "link": "https://stackoverflow.com/questions/49657904/editing-vba-script-userform", "title": "Editing VBA script Userform", "body": "<pre><code>Private Sub CommandButton1_Click()\nDim Sheetname As String\nwhichSheet = InputBox(\"In which sheet do you wish to enter data? Type in sheet name as Toner, Copy Paper, Alteration, Mail Package, Gloves, and Special Requests.\", \"Input\")\nDim ws As Worksheet\nFor Each ws In Worksheets\n    Select Case ws.CodeName\n        Case \"Toner\", \"Copy Paper\", \"Mail Package\", \"Alteration\", \"Gloves\", \"Special Requests\"\n            Worksheets(whichSheet).Activate ws.Name\n        Case Else\n            If ws.CodeName &lt;&gt; (\"Toner\")(\"Copy Paper\"), \"Mail Package\", \"Alteration\", \"Gloves\", \"Special Requests\") Then\n            MsgBox \"Please use another Sheet name\"\n            Exit Sub\n            End If\n    End Select\nNext ws\n</code></pre>\n\n<p>Hello guys, I'm trying to make this code open specific sheets in excel using the exact sheet name as an input to get to it. If the sheet name is not there or spelled incorrectly it should display the \"Please use another Sheet name\" message. I have this so far but it won't even recognize the right sheet name. I appreciate your help.</p>\n"}, {"tags": ["arrays", "excel", "vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522865838, "post_id": 49657701, "comment_id": 86324675, "body": "Transpose and Application.Index to slice a column out of the array and write to sheet?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1522870324, "post_id": 49658782, "comment_id": 86327320, "body": "The transpose solved my problem! But i only did it at the worksheet write part, and left the GetColumn sub alone because that would be transposing it twice?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1522871705, "post_id": 49658782, "comment_id": 86328124, "body": "if you don&#39;t transpose it in GetColumn() also, then you write the same value in all the cells along the worksheet column"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1522869464, "creation_date": 1522869464, "answer_id": 49658782, "question_id": 49657701, "link": "https://stackoverflow.com/questions/49657701/how-to-bulk-read-and-write-data-from-multidimensional-arrays-picking-only-the-co/49658782#49658782", "title": "How to bulk read and write data from multidimensional arrays picking only the columns?", "body": "<p>if you have 1-based arrays (as you have if built from a Range) then you can simply go:</p>\n\n<pre><code>Call GetColumn(2)\nWorksheets(\"Sheet2\").Range(\"E2:E\" &amp; Flag).Value = Application.Transpose(ResultArr)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Sub GetColumn(ColumnNumber As Long)\n    ' Ensure Arr is an array.\n    If IsArray(dValueData) = False Then\n        Exit Sub\n    End If\n\n    ' Ensure ColumnNumber is less than or equal to the number of columns.\n    If UBound(dValueData, 2) &lt; ColumnNumber Then\n         Exit Sub\n    End If\n    If LBound(dValueData, 2) &gt; ColumnNumber Then\n        Exit Sub\n    End If\n\n    ResultArr = Application.Transpose(Application.Index(dValueData, 0, ColumnNumber))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49658782, "answer_count": 1, "score": 0, "last_activity_date": 1522869464, "creation_date": 1522865430, "question_id": 49657701, "link": "https://stackoverflow.com/questions/49657701/how-to-bulk-read-and-write-data-from-multidimensional-arrays-picking-only-the-co", "title": "How to bulk read and write data from multidimensional arrays picking only the columns?", "body": "<p>I have a bit of code that gets each column separately from a multidimensional array and paste in to a worksheet column. Wehn i run it line by line, i see that it copies the values into ResultArr correctly, but when it writes values to worksheet it paste the first value from that array into the whole column. I'm completely stuck on how to bulk write the data, is there a fix / better way to do this? The Flag is the number of rows, in double. </p>\n\n<pre><code>Sub MainSub()\n\nDim dValueData As Variant\nDim ResultArr() As Variant\n\n'Some code here to get value for dValueData array which has 7000 rows and 6 \ncolumns, which also involves another sub. I can see that this array has correct values and length.\n\n' Bulk writes data into Daily Views sheet to speed up code\nCall GetColumn(0)\nWorksheets(\"Sheet2\").Range(\"B2:B\" &amp; Flag).Value = ResultArr\nCall GetColumn(1)\nWorksheets(\"Sheet2\").Range(\"M2:M\" &amp; Flag).Value = ResultArr\nCall GetColumn(2)\nWorksheets(\"Sheet2\").Range(\"E2:E\" &amp; Flag).Value = ResultArr\nCall GetColumn(3)\nWorksheets(\"Sheet2\").Range(\"G2:G\" &amp; Flag).Value = ResultArr\nCall GetColumn(4)\nWorksheets(\"Sheet2\").Range(\"I2:I\" &amp; Flag).Value = ResultArr\nCall GetColumn(5)\nWorksheets(\"Sheet2\").Range(\"F2:F\" &amp; Flag).Value = ResultArr\nWorksheets(\"Sheet2\").Range(\"H2:H\" &amp; Flag).Value = ResultArr\nWorksheets(\"Sheet2\").Range(\"J2:J\" &amp; Flag).Value = ResultArr\n\nEnd Sub\n\nSub GetColumn(ColumnNumber As Long)\n\nDim RowNdx As Long\n' Ensure Arr is an array.\nIf IsArray(dValueData) = False Then\n    Exit Sub\nEnd If\n\n' Ensure ColumnNumber is less than or equal to the number of columns.\nIf UBound(dValueData, 2) &lt; ColumnNumber Then\n     Exit Sub\nEnd If\nIf LBound(dValueData, 2) &gt; ColumnNumber Then\n    Exit Sub\nEnd If\n\nReDim ResultArr(LBound(dValueData, 1) To UBound(dValueData, 1), 1)\nFor RowNdx = LBound(ResultArr) To UBound(ResultArr)\n    ResultArr(RowNdx, 1) = dValueData(RowNdx, ColumnNumber)\nNext RowNdx\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522868675, "post_id": 49657526, "comment_id": 86326397, "body": "Your question is rather unclear. Please <a href=\"https://stackoverflow.com/posts/49657526/edit\">edit</a> to clarify what the problem is. See if reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> helps."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1522870098, "post_id": 49657526, "comment_id": 86327190, "body": "Could please add a screenshot with more relevant lines, to help understand the request, i.e. some data before any input, some input lines, and the expected outcome after processing the input lines."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522871012, "post_id": 49657526, "comment_id": 86327696, "body": "Done &amp; Done added more screenshots and clear description @MathieuGuindon"}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1522871049, "post_id": 49657526, "comment_id": 86327718, "body": "Let me know if that more clear @EEM"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1522871575, "post_id": 49657526, "comment_id": 86328038, "body": "The first table and the second table are the same table (before &amp; after), so the table is meant to show only the end position? Or you have two separated tables?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1522871930, "post_id": 49657526, "comment_id": 86328267, "body": "<code>Date&amp;Time Booked</code> is a numeric TimeStamp? Are you using a ListObject (excel table) or just a range with formulas?"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1522867065, "post_id": 49657978, "comment_id": 86325421, "body": "So I think i explained the situation a bit poorly but you answer may be quite close.  The data is separated in a few columns I&#39;ll post a screenshot."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1522867290, "post_id": 49657978, "comment_id": 86325553, "body": "added a picture, also my concern is making sure when the all of the cells eventually reach zero that the residual balance is retained in the variable."}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1522866497, "creation_date": 1522866497, "answer_id": 49657978, "question_id": 49657526, "link": "https://stackoverflow.com/questions/49657526/subtracting-values-from-a-variable-until-that-variable-is-0-excel-vba/49657978#49657978", "title": "Subtracting values from a variable until that variable is 0 Excel VBA", "body": "<p>This could be an example of what you want to do, hopefully is usefull to you:</p>\n\n<pre><code>Sub test()\n\nDim reduce_amount As String\nreduce_amount = Val(InputBox(\"Number:\"))\n\nDim cell As Range\n\nFor Each cell In Selection\n\ncell_value = Mid(cell.Value, 6, 3)\n\nIf IsNumeric(cell_value) Then\n    reduce_amount = reduce_amount - cell_value\nEnd If\n\nNext cell\n\nIf reduce_amount &gt; 0 Then\n Selection.End(xlDown).Offset(1, 0).Value = \"AAPL \" &amp; reduce_amount &amp; \" Long\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qUrSv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qUrSv.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1522873297, "post_id": 49659446, "comment_id": 86329023, "body": "That was actually one of my first ideas!, kind of taking a T account approach to the situation, where you have debits and credits removing from each other.  I&#39;m trying to treat it more as a running inventory though than a ledger. I want to be able to see the active &quot;book&quot; of a running lists of stocks.  So in concept I should never have a short and a long position under the same bucket. Though your solution is definitely a legitimate and quite smart answer"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1522872048, "creation_date": 1522872048, "answer_id": 49659446, "question_id": 49657526, "link": "https://stackoverflow.com/questions/49657526/subtracting-values-from-a-variable-until-that-variable-is-0-excel-vba/49659446#49659446", "title": "Subtracting values from a variable until that variable is 0 Excel VBA", "body": "<p>I think you should make it so each transaction stands on it's own (unless you have a good reason to do it otherwise). I never store \"state\" in a cell if possible. What about keeping track of each bucket. Here's an example</p>\n\n<pre><code>Public Sub AddLots(ByVal Ticker As String, ByVal Lot As Double)\n\n    Dim rCell As Range\n    Dim LotRemains As Double\n    Dim dc As Scripting.Dictionary\n    Dim dToTake As Double\n    Dim ThisTicker As String, ThisLS As String, ThisLot As Double, ThisBucket As Long, ThisTotal As Double\n    Dim lo As ListObject\n    Dim aOutput() As Variant\n    Dim MaxBucket As Long\n    Dim i As Long\n\n    LotRemains = Lot\n    Set dc = New Scripting.Dictionary\n    Set lo = Sheet1.ListObjects(1)\n\n    For Each rCell In lo.ListColumns(1).DataBodyRange.Cells\n        'Store this row's values\n        ThisTicker = rCell.Value: ThisLS = rCell.Offset(0, 1).Value: ThisLot = rCell.Offset(0, 2).Value\n        ThisBucket = rCell.Offset(0, 3).Value: ThisTotal = rCell.Offset(0, 4).Value\n\n        'if the ticker is the same\n        If ThisTicker = Ticker Then\n            'if it's going the opposite way of our transaction\n            If (Lot &gt; 0 And ThisLS = \"Short\") Or _\n                (Lot &lt; 0 And ThisLS = \"Long\") Then\n\n                'if there's still something left in the bucket\n                If ThisTotal &lt;&gt; 0 Then\n                    If Abs(ThisTotal) &gt;= Abs(LotRemains) Then\n                        dToTake = LotRemains\n                    Else\n                        dToTake = -ThisTotal\n                    End If\n                    'store this bucket\n                    dc.Add ThisTicker &amp; \"|\" &amp; ThisBucket, dToTake\n                    'reduce the amount left to test\n                    LotRemains = LotRemains - dToTake\n                    'stop looking if we've used it all up\n                    If LotRemains = 0 Then Exit For\n                End If\n            End If\n        End If\n    Next rCell\n\n    'this is an array we'll write out to the worksheet\n    ReDim aOutput(1 To dc.Count + IIf(LotRemains &lt;&gt; 0, 1, 0), 1 To 4)\n\n    'for every bucket we saved, put it in the array\n    For i = 1 To dc.Count\n        aOutput(i, 1) = Ticker\n        aOutput(i, 2) = IIf(Lot &gt; 0, \"Long\", \"Short\")\n        aOutput(i, 3) = Abs(dc.Items(i - 1))\n        aOutput(i, 4) = Split(dc.Keys(i - 1), \"|\")(1)\n    Next i\n\n    'if we couldn't use it all up, get the next bucket number\n    If LotRemains &lt;&gt; 0 Then\n        For Each rCell In lo.ListColumns(1).DataBodyRange.Cells\n            If rCell.Value = Ticker Then\n                If rCell.Offset(0, 3).Value &gt; MaxBucket Then\n                    MaxBucket = rCell.Offset(0, 3).Value\n                End If\n            End If\n        Next rCell\n\n        'then add a new bucket to the array\n        aOutput(dc.Count + 1, 1) = Ticker\n        aOutput(dc.Count + 1, 2) = IIf(Lot &gt; 0, \"Long\", \"Short\")\n        aOutput(dc.Count + 1, 3) = Abs(LotRemains)\n        aOutput(dc.Count + 1, 4) = MaxBucket + 1\n    End If\n\n    'write out the new transactions to the worksheet\n    lo.ListRows.Add.Range.Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\n\nEnd Sub\n</code></pre>\n\n<p>Start here</p>\n\n<p><a href=\"https://i.stack.imgur.com/2kAg9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2kAg9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then run <code>AddLots \"BCS\", 400</code> and get</p>\n\n<p><a href=\"https://i.stack.imgur.com/X8etF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X8etF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then run <code>AddLots \"BCS\", -1000</code> and get</p>\n\n<p><a href=\"https://i.stack.imgur.com/P75NA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P75NA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then use a pivot table to see where you are by ticker, by bucket, or whatever</p>\n\n<p><a href=\"https://i.stack.imgur.com/hHl9h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hHl9h.png\" alt=\"enter image description here\"></a></p>\n\n<p>The formula in the last column of the table is</p>\n\n<pre><code>=SUMPRODUCT(([Ticker]=[@Ticker])*([Bucket]=[@Bucket])*([LS]=\"Long\")*([Lots]))-SUMPRODUCT(([Ticker]=[@Ticker])*([Bucket]=[@Bucket])*([LS]=\"Short\")*([Lots]))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1522947300, "creation_date": 1522947300, "answer_id": 49677683, "question_id": 49657526, "link": "https://stackoverflow.com/questions/49657526/subtracting-values-from-a-variable-until-that-variable-is-0-excel-vba/49677683#49677683", "title": "Subtracting values from a variable until that variable is 0 Excel VBA", "body": "<p><strong>Requirements:</strong></p>\n\n<ol>\n<li>Maintain a ledger of shares transactions, generated from an user form input <em>(one at a time)</em>.</li>\n<li>Calculate &amp; show the net position of the shares, using the FIFO inventory valuation method.</li>\n</ol>\n\n<p><strong>Proposed Solution:</strong><br>\nThe requirements can be achieved using:</p>\n\n<ol>\n<li>A <code>ListObject</code> to contain the ledger of transactions and to calculate the end position after each transaction.</li>\n<li>A <code>PivotTable</code> to show the end position of the shares <em>(and any other report needed)</em>.</li>\n</ol>\n\n<p>The figure below shows the proposed <code>ListObject</code> and <code>PivotTable</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/BwPoJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BwPoJ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>ListObject Fields:</strong>  </p>\n\n<p><em>Input from user form</em></p>\n\n<ul>\n<li><strong><em>Ticker        :</em></strong> Share symbol.</li>\n<li><strong><em>L/S       :</em></strong> Share position (Long\\Short).</li>\n<li><strong><em>Lots      :</em></strong> Quantity of shares.</li>\n</ul>\n\n<p><em>Calculated by VBA procedure</em></p>\n\n<ul>\n<li><strong><em>L/S.Net:</em></strong> Net share position (Long\\Short).</li>\n<li><strong><em>Qty:</em></strong> Net share quantity (absolute value).</li>\n<li><strong><em>Lots.Net:</em></strong> Net share quantity.</li>\n<li><strong><em>T:</em></strong> Record Type (P: Prior \\ R: Residual), used to flag the latest transaction of a share.</li>\n<li><strong><em>TimeStamp:</em></strong> Record date &amp; time of posting, used to apply the FIFO valuation method.</li>\n</ul>\n\n<p><strong>VBA Procedure:</strong>\n<em>See explanations\\coments inserted in the procedure.</em></p>\n\n<pre><code>Option Private Module\nOption Compare Text\nOption Explicit\nOption Base 1\nRem Updated 20180504_121918\n\nSub ListObject_Stocks_Ledger_FIFO(vRcrd As Variant)\nDim aFlds As Variant, vFld As Variant\naFlds = [{\"Ticker\",\"L/S\",\"Lots\",\"T\",\"TimeStamp\",\"Lots.Net\",\"L/S.Net\",\"Qty\"}]\nDim lo As ListObject, pt As PivotTable\nDim sTicker As String, lCnt As Long, lPos As Long\nDim lRow As Long, bCol As Byte, b As Byte\nDim sFml As String\nDim vValue As Variant\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n    Rem Set Objects\n    With ThisWorkbook.Worksheets(\"Sht(0)\")      'change as required\n        Application.Goto .Cells(1), 1\n        Set pt = .PivotTables(\"ptPositions\")\n        Set lo = .ListObjects(\"loPositions\")\n    End With\n\n    With lo\n\n        Rem Set ListObject New Row\n        lRow = 1 + .ListRows.Count\n        Select Case lRow\n        Case 1\n            Rem ListObject with zero records\n            .HeaderRowRange.Cells(2, 1).Value2 = \"!NEW\"\n\n        Case Else\n            vFld = \"Ticker\"\n            sTicker = vRcrd(1)\n            bCol = .ListColumns(vFld).Index\n            lCnt = WorksheetFunction.CountIfs(.DataBodyRange.Columns(bCol), sTicker)\n\n            Rem Flag prior Ticker records\n            Select Case lCnt\n            Case 0\n                Rem New Ticker - NO ACTION\n\n            Case 1\n                Rem Ticker with only one prior record\n                lPos = WorksheetFunction.Match(sTicker, .DataBodyRange.Columns(bCol), 0)\n                .ListColumns(\"T\").DataBodyRange.Cells(lPos).Value2 = \"P\"\n\n            Case Else\n                Rem Ticker with only one prior record\n                .Range.AutoFilter Field:=bCol, Criteria1:=sTicker\n                .ListColumns(\"T\").DataBodyRange.SpecialCells(xlCellTypeVisible).Value2 = \"P\"\n                .Range.AutoFilter\n\n        End Select: End Select\n\n        Rem Add New Record\n        For Each vFld In aFlds\n            b = 1 + b\n            bCol = .ListColumns(vFld).Index\n\n            Rem Set Field Value\\Formula\n            sFml = vbNullString\n            vValue = vbNullString\n            Select Case vFld\n            Case \"Ticker\", \"L/S\", \"Lots\":   vValue = vRcrd(b)\n            Case \"T\":                       vValue = \"R\"\n            Case \"TimeStamp\":               vValue = CDbl(Now)\n            Case \"L/S.Net\"\n                sFml = \"=IF(NOT(EXACT([@T],'R')),CHAR(39),\" &amp; vbLf _\n                    &amp; \"IF([@[Lots.Net]]&lt;0,'Short',IF([@[Lots.Net]]&gt;0,'Long','Zero')))\"\n\n            Case \"Qty\"\n                sFml = \"=IF(NOT(EXACT([@T],'R')),CHAR(39),\" &amp; vbLf _\n                    &amp; \"ABS([@[Lots.Net]]))\"\n\n            Case \"Lots.Net\"\n                sFml = \"=IF(NOT(EXACT([@T],'R')),CHAR(39),SUM(\" &amp; vbLf _\n                    &amp; \"SUMIFS([Lots],[Ticker],[@Ticker],[L/S],'Long',[TimeStamp],'&lt;='&amp;[@TimeStamp]),\" &amp; vbLf _\n                    &amp; \"-SUMIFS([Lots],[Ticker],[@Ticker],[L/S],'Short',[TimeStamp],'&lt;='&amp;[@TimeStamp])))\"\n\n            End Select\n\n            Rem Apply Field Value\\Formula\n            Select Case vbNullString\n            Case Is &lt;&gt; vValue\n                .DataBodyRange.Cells(lRow, bCol).Value2 = vValue\n\n            Case Is &lt;&gt; sFml\n                sFml = Replace(sFml, Chr(39), Chr(34))\n                With .DataBodyRange.Columns(bCol)\n                    .Formula = sFml\n                    .Value2 = .Value2\n\n    End With: End Select: Next: End With\n\n    Rem Sort ListObject\n    With lo.Sort\n        With .SortFields\n            .Clear\n            .Add Key:=lo.ListColumns(\"Ticker\").DataBodyRange, _\n                SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=lo.ListColumns(\"TimeStamp\").DataBodyRange, _\n                SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        End With\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Rem Refresh PivotTable\n    pt.PivotCache.Refresh\n\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = False\n\n    End Sub\n</code></pre>\n\n<p>Use this procedure to simulate the posting from the user form: </p>\n\n<pre><code>Sub ListObject_Stocks_Ledger_FIFO_TEST()\nDim aDATA As Variant, vRcrd As Variant\naDATA = Array( _\n    Array(\"AAPL\", \"Long\", \"300\"), _\n    Array(\"AAPL\", \"Long\", \"100\"), _\n    Array(\"AAPL\", \"Long\", \"100\"), _\n    Array(\"AAPL\", \"Short\", \"600\"), _\n    Array(\"BCS\", \"Long\", \"300\"), _\n    Array(\"BCS\", \"Long\", \"100\"), _\n    Array(\"BCS\", \"Short\", \"500\"), _\n    Array(\"Test\", \"Long\", \"100\"), _\n    Array(\"Test\", \"Long\", \"200\"), _\n    Array(\"Test\", \"Long\", \"300\"), _\n    Array(\"Test\", \"Short\", \"400\"))\n\n    For Each vRcrd In aDATA\n        Call ListObject_Stocks_Ledger_FIFO(vRcrd)\n: Stop\n    Next\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "is_accepted": false, "score": -1, "last_activity_date": 1523016839, "creation_date": 1523016839, "answer_id": 49692594, "question_id": 49657526, "link": "https://stackoverflow.com/questions/49657526/subtracting-values-from-a-variable-until-that-variable-is-0-excel-vba/49692594#49692594", "title": "Subtracting values from a variable until that variable is 0 Excel VBA", "body": "<p>I looked at all of the answers posted and took a few ideas from each. I used the below code to control the variable and then I have other code that kind of compiles everything using the final variable.</p>\n\n<p>The section of code that clears out the other lots though and defines the variable is below</p>\n\n<pre><code>Dim rCell As Range\nDim reduce_amount As Variant\nDim HBWS As Worksheet\nDim TickerTotalString As String\nTickerTotalString = \"Total \" &amp; TTB\nSet HBWS = Sheets(\"Hedgebook\")\nDim FormulaWS As Worksheet\nSet FormulaWS = Sheets(\"Formula_Template\")\n\nLastHBR = HBWS.Cells(HBWS.Rows.Count, \"B\").End(xlUp).Row\nClastHBC = HBWS.Cells(3, HBWS.Columns.Count).End(xlToLeft).Column\nLastFWSR = FormulaWS.Cells(FormulaWS.Rows.Count, \"B\").End(xlUp).Row\nCLASTFWSC = FormulaWS.Cells(3, FormulaWS.Columns.Count).End(xlToLeft).Column\n\n\nTickercolumn = HBWS.Cells.Find(What:=\"Ticker\").Column\nDatecolumn = HBWS.Cells.Find(What:=\"Date&amp;Time Booked\").Column\nLScolumn = HBWS.Cells.Find(What:=\"L/S\").Column\nLotscolumn = HBWS.Cells.Find(What:=\"Lots\").Column\nConversioncolumn = HBWS.Cells.Find(What:=\"Conversion Cents\").Column\nBorrowcolumn = HBWS.Cells.Find(What:=\"Borrow (bps)\").Column\n\nSet Tickerresult = HBWS.Cells.Find(What:=TickerTotalString, LookIn:=xlValues)\nIf Not Tickerresult Is Nothing Then\nTickerrow = Tickerresult.Row\nElse\nEnd If\n\nreduce_amount = LTB 'Userform input that defines the total lots\n\n\n\nIf reduce_amount &gt; 0 Then\nFor Each rCell In HBWS.Range(Cells(3, Tickercolumn), Cells(LastHBR, Tickercolumn))\n    If rCell.Value = TTB And rCell.Offset(0, -1).Value &lt;&gt; TickerTotalString And reduce_amount &gt; 0 Then\n    Cell_value = rCell.Offset(0, 3).Value\n        If reduce_amount &lt; Cell_value Then\n        rCell.Offset(0, 3).Value = Cell_value - reduce_amount\n        ElseIf reduce_amount &gt; Cell_value Then\n        rCell.Offset(0, 3).Value = 0\n        reduce_amount = reduce_amount - Cell_value\n        ElseIf reduce_amount = Cell_value Then\n        reduce_amount = 0\n        rCell.Offset(0, 3).Value = 0\n        End If\n    End If\nNext\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1523016839, "creation_date": 1522864724, "last_edit_date": 1522870984, "question_id": 49657526, "link": "https://stackoverflow.com/questions/49657526/subtracting-values-from-a-variable-until-that-variable-is-0-excel-vba", "title": "Subtracting values from a variable until that variable is 0 Excel VBA", "body": "<p>I'm doing work to automate a ledger of mine based on the FIFO accounting principle (First in First out), where anything that would be referred to as a contra balance would be subtracted from the first entry, then the second, until that variable is zero (or if there is residual begin a new accounting line).</p>\n\n<p>Generally what I have been doing to add a new position to this ledger (not removing any balance simply creating a line item is this...</p>\n\n<pre><code>Tickerstring = TTB 'TTB is the user defined input for the ticker\n\ntickercolumn = HBWS.Cells.Find(What:=\"Ticker\").Column 'Use this to identify \nwhat column the ticker field is\n\nSet TickerResult = HBWS.Cells.Find(What:=TickerString, LookIn:=xlValues)\nIf Not TickerResult Is Nothing Then\ntickerRow = TickerResult.Row\nElse\nEnd If 'Identifies the row which the actual Ticker is in i.e. the TTB\n\nHBWS.Cells(tickerRow, tickercolumn) = TTB\n</code></pre>\n\n<p>I use that same concept to define the amount of Shares, and whether they are long and short. Inserting Userform inputs into the respective cells.</p>\n\n<p>My question is, say I run that code 3 times and now have 3 lines items that look like this</p>\n\n<p>AAPL  300  Long</p>\n\n<p>AAPL  100  Long</p>\n\n<p>AAPL  100  Long</p>\n\n<p>Then I want to add a new position for 600 short, which would go through the FIFO accounting process and remove 300 from the first row, 100 from the second, 100 from the third, then create a new line with the 100 short. How would I go about doing that?</p>\n\n<p>I would imagine that I would be subtracting from a user defined variable i.e take 300 out of the first row, now my defined variable is left at 300 (when it started at 600).</p>\n\n<p>Basically i think the best way to describe this would be how do I subtract from a variable based on current workbook values, then continue using this in my sub procedure.</p>\n\n<p>EDIT: Editing my post for clarity</p>\n\n<p>i have the following entry in my spreadsheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/45kLh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/45kLh.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to run my macro to take my short position indicated in the below userform subtract it from currently in my spread sheet then create a residual line representing what is left in the short position</p>\n\n<p><a href=\"https://i.stack.imgur.com/UqFeR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UqFeR.png\" alt=\"enter image description here\"></a></p>\n\n<p>The end state should look like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/YuEKc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YuEKc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know if you need additional info</p>\n"}, {"tags": ["excel", "ribbon", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522864458, "post_id": 49657288, "comment_id": 86323924, "body": "&quot;Not working&quot; is not a useful description of the problem. Please be more specific."}, {"owner": {"reputation": 29, "user_id": 7047504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fcea848aa0ff0a3345cc52db37a3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7047504/alexander"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522866950, "post_id": 49657288, "comment_id": 86325347, "body": "the error &quot;invalid procedure call or argument&quot;"}, {"owner": {"reputation": 29, "user_id": 7047504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fcea848aa0ff0a3345cc52db37a3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7047504/alexander"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1523299204, "post_id": 49657288, "comment_id": 86493554, "body": "may somebody help?"}], "owner": {"reputation": 29, "user_id": 7047504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fcea848aa0ff0a3345cc52db37a3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7047504/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522864396, "creation_date": 1522863866, "last_edit_date": 1531164843, "question_id": 49657288, "link": "https://stackoverflow.com/questions/49657288/vba-code-for-c-addins-button-execution", "title": "VBA code for C# addins button execution", "body": "<p>I have add-ins (developed in C#) with buttons on the ribbon, \nhow I can execute a button on the ribbon connected to the add-ins?</p>\n\n<p>The following codes are not working:</p>\n\n\n\n<pre><code>Application.CommandBars(\"GuruExcelAddin\").Controls(\"FixIssueBtn\").Execute\n</code></pre>\n\n\n\n<pre><code>Application.CommandBars.ExecuteMso (\"FixIssueBtn\")\n</code></pre>\n\n<p>I want to execute the button from Excel VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522864248, "post_id": 49657262, "comment_id": 86323801, "body": "What workbook do \u201cSummary&quot; and &quot;Top Reasons\u201d worksheets belong to?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522864453, "post_id": 49657262, "comment_id": 86323920, "body": "While from your code it seems that input_Path and summary_file are taken from sheet textboxes snd not from filepickfolder as your narrative says"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9598429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513e0693cf1a637c913e05840db56fff?s=128&d=identicon&r=PG&f=1", "display_name": "Robertus Caesar", "link": "https://stackoverflow.com/users/9598429/robertus-caesar"}, "is_accepted": false, "score": -1, "last_activity_date": 1522865665, "creation_date": 1522865665, "answer_id": 49657762, "question_id": 49657262, "link": "https://stackoverflow.com/questions/49657262/trying-to-copy-specific-or-all-sheets-from-active-workbook-to-another-existing/49657762#49657762", "title": "Trying to copy specific (or all) sheets from active workbook to another existing workbook", "body": "<p>Try:</p>\n\n<p>For each worksheet in Workbooks(\"yourworkbook\").worksheets</p>\n\n<p>Your CopyCode</p>\n\n<p>Next Worksheet</p>\n"}], "owner": {"reputation": 55, "user_id": 7035299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cd5b72378346ec68897a036f37129e?s=128&d=identicon&r=PG&f=1", "display_name": "Kesavan Annamalai", "link": "https://stackoverflow.com/users/7035299/kesavan-annamalai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522865665, "creation_date": 1522863782, "last_edit_date": 1531164843, "question_id": 49657262, "link": "https://stackoverflow.com/questions/49657262/trying-to-copy-specific-or-all-sheets-from-active-workbook-to-another-existing", "title": "Trying to copy specific (or all) sheets from active workbook to another existing workbook", "body": "<pre><code>    Dim input_Path As String\n    Dim summary_file As String\n\n    input_Path = Sheet1.TextBox1.Text\n    Workbooks.Open input_Path\n\n    summary_file = Sheet1.TextBox3.Text\n    Workbooks.Open summary_file\n\n    Worksheets(Array(\"Summary\", \"Top Reasons\")).Copy after:=Workbooks(input_Path).Worksheets(Worksheets.Count)\n\nEnd sub\n</code></pre>\n\n<p>Trying to copy specific sheets from active workbook to another existing workbook. Both the workbooks are opened through folder picker with variable.</p>\n\n<p>i am unable to copy the sheets.</p>\n\n<p>can someone pls help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5976, "user_id": 2129801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678b0edc1262e07c7462ade977e883ca?s=128&d=identicon&r=PG", "display_name": "werner", "link": "https://stackoverflow.com/users/2129801/werner"}, "edited": false, "score": 1, "creation_date": 1522864945, "post_id": 49657251, "comment_id": 86324206, "body": "Welcome to Stack Overflow! Generally, questions should include a specific programming issue where you expected an outcome but got something else, like an error. It&#39;s not a code service or tutorial. If you describe what you have tried so far, maybe someone can help you."}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "reply_to_user": {"reputation": 5976, "user_id": 2129801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678b0edc1262e07c7462ade977e883ca?s=128&d=identicon&r=PG", "display_name": "werner", "link": "https://stackoverflow.com/users/2129801/werner"}, "edited": false, "score": 0, "creation_date": 1522867778, "post_id": 49657251, "comment_id": 86325856, "body": "I have tried below code"}, {"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1522867906, "post_id": 49657251, "comment_id": 86325929, "body": "Where is your code @umamaheswari ?"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522868861, "post_id": 49657251, "comment_id": 86326495, "body": "i have mentioned the code i tried in my description, with this i am able to compare only 2 cells, but i want to compare each string value in a cell with values in all other cells and return the Tag name for matched string value"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1522872186, "post_id": 49657251, "comment_id": 86328431, "body": "<code>Split</code> and <code>Join</code>? I know it is kind of obvious, but you never know, it just may work!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522919516, "post_id": 49659725, "comment_id": 86346815, "body": "Thanks a ton Ron.. its working exactly as expected... Thank you very much for the detailed steps..."}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522920571, "post_id": 49659725, "comment_id": 86347568, "body": "Can we pass multiple separators in this line &quot;V = Split(vSrc(I, 2), &quot;,&quot;)"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522920784, "post_id": 49659725, "comment_id": 86347715, "body": "if we hard code some separators like  Comma(,) , Semi column (;) etc. Macro should run based on the separator available in the excel data. Could you please let me know if this is possible?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522922488, "post_id": 49659725, "comment_id": 86348921, "body": "@umamaheswari What are possible separators? Will there only be one type per string? When <code>Join</code>ing, do we use the same as found? All can be done. Just need answers to create code."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924610, "post_id": 49659725, "comment_id": 86350438, "body": "@umamaheswari What are possible separators? Will there only be one type per string? Can a separator ever appear within the desired text substring? When Joining, do we use the same as found? All can be done. Just need answers to create code."}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924784, "post_id": 49659725, "comment_id": 86350552, "body": "Possible separators are &quot;,&quot; and &quot;OR&quot; between keywords. Yes, only Either one of this will be used per string. If i manually change from , to OR its working fine i just want to know if we hard code both separators so i dont need to manually change everytime?"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924796, "post_id": 49659725, "comment_id": 86350560, "body": "Product,System,Features"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924807, "post_id": 49659725, "comment_id": 86350569, "body": "Product OR System OR Features"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924879, "post_id": 49659725, "comment_id": 86350608, "body": "@umamaheswari For just the two, it is easy enough to detect.  And I will assume that the <code>OR</code> is upper case and surrounded by spaces.  I will edit my answer"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924898, "post_id": 49659725, "comment_id": 86350623, "body": "these Separators will not appear within the desired text string"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924920, "post_id": 49659725, "comment_id": 86350634, "body": "Yes OR is uppercase"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1522925969, "last_edit_date": 1522925969, "creation_date": 1522873167, "answer_id": 49659725, "question_id": 49657251, "link": "https://stackoverflow.com/questions/49657251/how-to-write-macro-for-finding-match-for-each-text-value-separated-by-comma-in-s/49659725#49659725", "title": "How to write macro for Finding match for each text value separated by comma in single cell with other cell values and return the matched values", "body": "<p>Here is a macro that can  reproduce what you want.</p>\n\n<ul>\n<li>I use a dictionary to make a list of the unique keywords.</li>\n<li>Each item of that dictionary is another dictionary of the associated tag names</li>\n<li>The output is only those primary dictionary items where the secondary dictionary contains more than one item</li>\n<li>I use the VBA functions <code>Split</code> and <code>Join</code> to break apart and reform the comma separated lists.</li>\n<li>I use early-binding for the dictionary object, finding it easier to code with the advantage of intellisense.  But you can easily change it to late-binding, as you have in your code above, if you prefer.</li>\n</ul>\n\n<p><strong>EDIT:</strong> <em>Code edited to allow for comma or <code>OR</code> as a delimiter.  The <code>Join</code> will always be done with a comma</em></p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub TagsForKeywords()\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n    Dim dKeyWords As Dictionary, dTagName As Dictionary\n    Dim I As Long\n    Dim V As Variant, W As Variant\n    Dim sKey As String\n    Dim sDelim As String\n\n\nSet wsSrc = Worksheets(\"sheet1\")\nSet wsRes = Worksheets(\"sheet1\")\n    Set rRes = wsRes.Cells(1, 7)\n\nWith wsSrc\n    vSrc = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(columnsize:=2)\nEnd With\n\nSet dKeyWords = New Dictionary\n    dKeyWords.CompareMode = TextCompare\n\n    For I = 2 To UBound(vSrc, 1)\n\n    'Find delimiter\n    sDelim = \",\"\n    If InStr(1, vSrc(I, 2), \" OR \", vbBinaryCompare) &gt; 0 Then _\n        sDelim = \" OR \"\n\n        V = Split(vSrc(I, 2), sDelim) 'array of keywords\n        For Each W In V\n            sKey = Trim(W)\n            Set dTagName = New Dictionary\n                dTagName.CompareMode = TextCompare\n            If Not dKeyWords.Exists(sKey) Then\n                dTagName.Add vSrc(I, 1), vSrc(I, 1)\n                dKeyWords.Add sKey, dTagName\n            Else\n                Set dTagName = dKeyWords(sKey)\n                If Not dTagName.Exists(vSrc(I, 1)) Then _\n                    dTagName.Add vSrc(I, 1), vSrc(I, 1)\n                Set dKeyWords(sKey) = dTagName\n            End If\n        Next W\n    Next I\n\n'Output results\n' Only for Tags that have duplicate keywords\n\n'So Output a row only if there are multiple Products tagged\nI = 0\nFor Each V In dKeyWords.Keys\n    If dKeyWords(V).Count &gt; 1 Then I = I + 1\nNext V\n\nReDim vRes(0 To I, 1 To 2)\n    vRes(0, 1) = \"Tag Name\"\n    vRes(0, 2) = \"Keywords\"\n\nI = 0\nFor Each V In dKeyWords.Keys\n If Not dKeyWords(V).Count = 1 Then\n    I = I + 1\n    vRes(I, 2) = V\n    W = dKeyWords(V).Keys\n    vRes(I, 1) = Join(W, \",\")\n  End If\nNext V\n\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    .Rows(1).Font.Bold = True\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6EmDH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6EmDH.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Multiple delimiters example</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LSq4W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LSq4W.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522900896, "post_id": 49660007, "comment_id": 86337690, "body": "@umamaheswari, any feedback?"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522921588, "post_id": 49660007, "comment_id": 86348334, "body": "Thank you, this code is working fine, only issue is case sensitivity, Its matching keyword if case is matching only."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522922232, "post_id": 49660007, "comment_id": 86348765, "body": "your question didn&#39;t mention any case sensitivity issue. so that shouldn&#39;t be a criteria to choose which answer to mark as the solution with. while I&#39;m always preferring a much shorter (and much more maintainable) code instead of a much longer (and much less maintainable) one..."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522922722, "post_id": 49660007, "comment_id": 86349066, "body": "anyhow, should you ever reach any sensitivity to short code, you may consider edited answer (one line added) to get rid of case sensitivity"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522923906, "post_id": 49660007, "comment_id": 86349951, "body": "I agree.. its working fine now.. when i tried changing the separator from comma to &quot;OR&quot;, its giving different results"}, {"owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "edited": false, "score": 0, "creation_date": 1522924075, "post_id": 49660007, "comment_id": 86350083, "body": "i know this is also not mentioned in my question, just giving my findings, i have tried keywords with separator &quot;OR&quot; as this is one of my business case-  Product OR System OR Features"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522926260, "post_id": 49660007, "comment_id": 86351564, "body": "@DisplayName For sure your code is shorter. And I like your technique. But maintainability is a relative issue, depending on familiarity with the techniques being used. In addition, I suspect that your code will run slower, and that this would be an issue on large data sources."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522928173, "post_id": 49660007, "comment_id": 86352893, "body": "@RonRosenfeld, what are you suspecting that from?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522928513, "post_id": 49660007, "comment_id": 86353137, "body": "Added \u201cOR\u201d handling."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522929168, "post_id": 49660007, "comment_id": 86353606, "body": "Your accessing of the worksheet multiple times.  Try your macro on a data source of 100,000 lines, for example."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522930118, "post_id": 49660007, "comment_id": 86354276, "body": "@RonRosenfeld, c\u2019mon: we both know it\u2019s only a matter of using an array to store range values (and adding some 2 or three code lines). But you must be right: umanaheswari didn\u2019t choose this solution and NOBODY upvoted it..."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522930916, "post_id": 49660007, "comment_id": 86354825, "body": "@DisplayName I used to revel in short code, back in my days of machine language programming. Unfortunately, unless very well documented, when I reviewed the code a month later, it would take a while to figure out what I had done.  Now, with faster machines and cheap memory, I try for code that runs quickly, but is also self-documenting with minimal comments. In this forum, where possible, I also like to present code that is easily scalable to large data sources, as that has been a frequent issue by the posters. At the end, it comes down to style and personal preferences."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522934552, "post_id": 49660007, "comment_id": 86357518, "body": "@RonRosenfeld, I must repeat myself _&quot;you must be right: umanaheswari didn\u2019t choose this solution and NOBODY upvoted it... &quot;"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522928473, "last_edit_date": 1522928473, "creation_date": 1522874289, "answer_id": 49660007, "question_id": 49657251, "link": "https://stackoverflow.com/questions/49657251/how-to-write-macro-for-finding-match-for-each-text-value-separated-by-comma-in-s/49660007#49660007", "title": "How to write macro for Finding match for each text value separated by comma in single cell with other cell values and return the matched values", "body": "<p>you could try this sub</p>\n\n<pre><code>Sub m()\n    Dim cell As Range\n    Dim kwd As Variant\n\n    With CreateObject(\"Scripting.Dictionary\")\n        .CompareMode = TextCompare\n        For Each cell In Range(\"B2\", Cells(Rows.Count, 2).End(xlUp))\n            For Each kwd In Split(Replace(Replace(cell.Value,\"OR\",\",\"),\" \",\"\"), \",\")\n                .Item(kwd) = .Item(kwd) &amp; cell.Offset(, -1).Value &amp; \" \"\n            Next\n        Next\n        Range(\"E1:F1\").Value = Range(\"A1:B1\").Value\n        For Each kwd In .Keys\n            If UBound(Split(.Item(kwd), \" \")) &gt; 1 Then\n                Cells(Rows.Count, 5).End(xlUp).Offset(1).Resize(, 2).Value = Array(Replace(Trim(.Item(kwd)), \" \", \",\"), kwd)\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9597881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-To4NHYI49WY/AAAAAAAAAAI/AAAAAAAAAQQ/4p-7fZuP9yE/photo.jpg?sz=128", "display_name": "uma maheswari", "link": "https://stackoverflow.com/users/9597881/uma-maheswari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 49659725, "answer_count": 2, "score": -1, "last_activity_date": 1522928473, "creation_date": 1522863736, "last_edit_date": 1522870854, "question_id": 49657251, "link": "https://stackoverflow.com/questions/49657251/how-to-write-macro-for-finding-match-for-each-text-value-separated-by-comma-in-s", "title": "How to write macro for Finding match for each text value separated by comma in single cell with other cell values and return the matched values", "body": "<p>I have two columns \"Tag Name\" and \"keywords\" in my input sheet, and the Keywords column has each cell with multiple values separated by comma. </p>\n\n<p>I would like to compare  each string value in a cell with other cell values in the Keywords column and if there is a matched instance between the cells return the output in specified format as mentioned below. </p>\n\n<p><strong>My Input will be like below:</strong></p>\n\n<pre><code>Tag Name    Keywords\n\nProduct1 -  Product,System,Features\n\nProduct2 -  Application,Product,System\n\nProduct3 -  Application,Apps,System\n</code></pre>\n\n<p><strong>Expected Output:</strong></p>\n\n<pre><code>Tag Name                        Keywords\n\nProduct1,Product2           -   Product\n\nProduct1,Product2,Product3  -   System\n\nProduct2,Product3           -   Application\n</code></pre>\n\n<p>Input and Output Screenshot\n<img src=\"https://i.stack.imgur.com/ZbzqI.png\" alt=\"\"></p>\n\n<pre><code>Public Function DupeWord(str1 As String, str2 As String) As String\nDim dictStr1Words As New Scripting.Dictionary\nDim colDupeWords As New Collection\n\n'Set up the Regular Expression\nDim oRegExp As New RegExp\nDim oMatches As MatchCollection\nDim oMatch As Match\nWith oRegExp\n  .Global = True\n  .MultiLine = True\n  .Pattern = \"([\\w']+)\"   'Matches any word character including underscore. Equivalent to '[A-Za-z0-9_']'\n  Set oMatches = .Execute(str1)\nEnd With\n\n'Add each word in Str1 into a Scripting.Dictionary\nFor Each oMatch In oMatches\n    If Not dictStr1Words.Exists(oMatch.Value) Then\n        dictStr1Words.Add oMatch.Value, 0\n    End If\nNext\n\nSet oMatches = oRegExp.Execute(str2)\n\n'Check to see if any of the words found in Str2 was in Str1 using the Scripting.Dictionary function Exists\nFor Each oMatch In oMatches\n    If dictStr1Words.Exists(oMatch.Value) Then\n        colDupeWords.Add oMatch.Value  'Add any dups to a collection\n    End If\nNext\n\n'If there are any dup words in the collection, join them up as a comma separated list, otherwise return \"No Matches!\"\nIf colDupeWords.Count &gt; 0 Then\n    DupeWord = JoinStringCollection(colDupeWords, \", \")\nElse\n    DupeWord = \"No Matches!\"\nEnd If\n\nEnd Function  \n</code></pre>\n\n<hr>\n\n<pre><code>Public Function JoinStringCollection(colStrings As Collection, strDelimiter As String) As String\n'This function joins a collection with a delimiter so that there is no need to lop off a trailing or leading delimiter\n    Dim strOut As String\n    Dim i As Long\n\n    If colStrings.Count &gt; 0 Then\n        strOut = colStrings.Item(1)\n    End If\n\n    If colStrings.Count &gt; 1 Then\n        For i = 2 To colStrings.Count\n            strOut = strOut &amp; strDelimiter &amp; colStrings.Item(i)\n        Next\n    End If\n\n    JoinStringCollection = strOut\nEnd Function\n</code></pre>\n\n<p>In excel sheet i am calling function =Dupeword(A1,A2)</p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1522861916, "post_id": 49656520, "comment_id": 86322493, "body": "...I just took a guess thinking I might be having too much happening in the loop... broke the 35 lines into 10-10-10-5 and it works.  Apparently I was using too much memory."}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522866802, "post_id": 49657907, "comment_id": 86325259, "body": "Sorry about that; in stripping out the other non-issue code, I forgot to carry my with statement.  Will update the post to show that, too."}], "tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1522866244, "creation_date": 1522866244, "answer_id": 49657907, "question_id": 49656520, "link": "https://stackoverflow.com/questions/49656520/excel-crashing-when-pulling-up-userform-with-initialize-if-vba-window-hasnt-b/49657907#49657907", "title": "Excel crashing when pulling up userform (with initialize) if VBA window hasn&#39;t been viewed during session", "body": "<p>You're using:</p>\n\n<pre><code>.Cells\n</code></pre>\n\n<p>.. but there's no parent object designation.</p>\n\n<p>You need to wrap a worksheet object around all the lines which use .Cells, like this:</p>\n\n<pre><code>With Worksheets(\"NameOfYourSheet\")\n    If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"a\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 1 + v).Value = True\n    ' etc...\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522866908, "creation_date": 1522861093, "last_edit_date": 1531164843, "question_id": 49656520, "link": "https://stackoverflow.com/questions/49656520/excel-crashing-when-pulling-up-userform-with-initialize-if-vba-window-hasnt-b", "title": "Excel crashing when pulling up userform (with initialize) if VBA window hasn&#39;t been viewed during session", "body": "<p><strong>Background:</strong></p>\n\n<p>I am developing a builder in Excel using a userform.  The userform is loaded by selecting a specific cell, then the userform_initialize starts.</p>\n\n<hr>\n\n<p><strong>Issue:</strong></p>\n\n<p>If I have not loaded VBA during the session I am looking to load the userform, Excel crashes.  I get an error message (bottom of post) that says I am accessing  memory that has been deallocated.</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>In review of my Option Explicit code, I am unsure of the issue, as it runs once VBA has been opened during the session.  Does anyone know if there is some type of loop error in a userform_initialize subroutine?</p>\n\n<p>Any help/advice would be appreciated.  The code is in the next subsection of this post.</p>\n\n<hr>\n\n<p><strong>Code in Question:</strong></p>\n\n<pre><code>Dim r As Long, c As Long, v As Long\n    r = ActiveCell.Row\n    c = ActiveCell.Column\n    With Sheets(\"Bldr\")\n         For v = 0 To 28\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"a\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 1 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"b\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 31 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"c\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 61 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"d\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 91 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"e\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 121 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"f\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 151 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"g\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 181 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"h\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 211 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"i\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 241 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"j\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 271 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"k\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 301 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"l\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 331 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"m\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 361 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"n\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 391 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"o\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 421 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"p\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 451 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"q\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 481 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"r\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 511 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"s\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 541 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"t\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 571 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"u\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 601 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"v\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 631 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"w\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 661 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"x\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 691 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"y\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 721 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"z\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 751 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"1\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 781 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"2\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 811 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"3\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 841 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"4\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 871 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"5\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 901 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"6\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 931 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"7\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 961 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"8\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 991 + v).Value = True\n             If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"9\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 1021 + v).Value = True\n         Next v\n    End With\n</code></pre>\n\n<hr>\n\n<p><strong>Error Code:</strong></p>\n\n<pre><code>Problem signature:\n  Problem Event Name:                     APPCRASH\n  Application Name:                       EXCEL.EXE\n  Application Version:                    16.0.8431.2236\n  Application Timestamp:                  5a9aa882\n  Fault Module Name:                      unknown\n  Fault Module Version:                   0.0.0.0\n  Fault Module Timestamp:                 00000000\n  Exception Code:                         c0000005\n  Exception Offset:                       00000000\n  OS Version:                             6.1.7601.2.1.0.256.4\n  Locale ID:                              1033\n\nAdditional information about the problem:\n  LCID:                                   1033\n  skulcid:                                1033\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery", "excel-2016"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1522866157, "post_id": 49656319, "comment_id": 86324875, "body": "I had difficulty finding the answer to this same question when I was first looking for it, as well. I think it&#39;s generally more advised to, when possible, run the query for the data without the variable restrictions, and then limit the data once it&#39;s in PowerQuery. There have been times when I&#39;ve gotten a warning from PQ about refreshing a query with this type of setup....."}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "edited": false, "score": 1, "creation_date": 1522870181, "post_id": 49657710, "comment_id": 86327246, "body": "Do you know how to get to the general query editor? Once there, go to the &quot;View&quot; tab, then you should see an &quot;Advanced Editor&quot; button second from the right. The button on the very right is the &quot;Query Dependencies&quot; button which is also semi-useful."}, {"owner": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "edited": false, "score": 0, "creation_date": 1522870315, "post_id": 49657710, "comment_id": 86327314, "body": "I&#39;m getting a <code>cyclic reference was encountered during evaluation</code> error when I paste the power query in the advanced editor. Can you help?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "edited": false, "score": 0, "creation_date": 1522870696, "post_id": 49657710, "comment_id": 86327541, "body": "I can try. Could you show me the code you have in your Advanced Editor? Also, just clarifying, that for Part 2), what I posted is really just an example of how it would look with the param line added, and the variable substitution in place."}, {"owner": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "edited": false, "score": 0, "creation_date": 1522870882, "post_id": 49657710, "comment_id": 86327622, "body": "Sure. <code>let     Client_UID = &quot;&#39;&quot; &amp; Text.From(Table1[value]{0}) &amp; &quot;&#39;&quot;,     Year = &quot;&#39;&quot; &amp; Text.From(Table1[value]{1}) &amp; &quot;&#39;&quot;,     Period = &quot;&#39;&quot; &amp; Text.From(Table1[value]{2}) &amp; &quot;&#39;&quot;,     Source = Sql.Database(&quot;0.0.0.0&quot;, &quot;TestDB&quot;, [Query=&quot;EXEC [sp_sprocname] @Client_UID = &quot; &amp;Client_UID &amp; &quot;, @Year = &quot; &amp;Year &amp; &quot;, @Period = &quot; &amp;Period &amp; &quot;, @Trans = &#39;123&#39;&quot;]) in     Source</code>"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "edited": false, "score": 0, "creation_date": 1522871317, "post_id": 49657710, "comment_id": 86327886, "body": "First, I just want to point out that of <code>@Year</code> is not supposed to be a SQL string (i.e. SQL is expecting an integer or double) you should change <code>Year = &quot;&#39;&quot; &amp; Text.From(Table1[value]{1}) &amp; &quot;&#39;&quot;</code> to <code>Year = Text.From(Table1[value]{1})</code>  Also, same with any other value SQL is not expecting a string for."}, {"owner": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1522871347, "post_id": 49657710, "comment_id": 86327904, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168248/discussion-between-soham-dasgupta-and-mistella\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 7, "last_activity_date": 1576796427, "last_edit_date": 1576796427, "creation_date": 1522865452, "answer_id": 49657710, "question_id": 49656319, "link": "https://stackoverflow.com/questions/49656319/replace-sql-query-parameter-in-a-excel-power-query/49657710#49657710", "title": "Replace SQL query parameter in a Excel power query", "body": "<p>For this to work, you need to set up three different parts:</p>\n\n<p>1) A parameter table in an Excel sheet</p>\n\n<p>2) Changes to the advanced editor in PowerQuery</p>\n\n<p>3) A macro to refresh the PQ when any cells in the parameter table are changed</p>\n\n<hr>\n\n<h2><strong>1) Excel Table</strong></h2>\n\n<p>You can see I included a column called <code>param</code> which <em>can</em> hold a Parameter name to help keep straight which parameter is which.</p>\n\n<p><a href=\"https://i.stack.imgur.com/O8C7B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O8C7B.png\" alt=\"Sample Param Table\"></a></p>\n\n<hr>\n\n<h2><strong>2) PQ Advanced Editor</strong></h2>\n\n<pre><code>let\n    ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Param = \"'\" &amp; Text.From(ParamTable[value]{0}) &amp; \"'\",\n    Source = Sql.Database(\"IP Address\", \"Database Name\", [Query=\"Select * from weeks#(lf)where date &gt;= '2018-01-01' and date &lt; \" &amp;Param])\nin\n    Source\n</code></pre>\n\n<p><em>Equivalent alternative:</em>  (Difference in location of variable used in SQL query.)</p>\n\n<pre><code>let\n    ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Param = \"'\" &amp; Text.From(ParamTable[value]{0}) &amp; \"'\",\n    Source = Sql.Database(\"IP Address\", \"Database Name\", [Query=\"Select * from weeks#(lf)where date &lt; \" &amp;Param &amp; \" and date &gt;= '2018-01-01'\"])\nin\n    Source\n</code></pre>\n\n<p><em>Alternative Variable Type:</em> (If dealing with numbers, the string markers <code>'</code> aren't required)</p>\n\n<pre><code>let\n    ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Param = Text.From(ParamTable[value]{0}),\n    Source = Sql.Database(\"IP Address\", \"Database Name\", [Query=\"Select * from weeks#(lf)where cnt &lt; \" &amp;Param &amp; \" and date &gt;= '2018-01-01'\"])\nin\n    Source\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>After pulling the Parameter Table into the PQ Query (<code>ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content]</code>), the columns can be accessed by column name <code>[value]</code> and the rows by a zero-index number <code>{0}</code>. Since I was pulling in a date-value. I needed to convert it to a string value I could insert into the SQL Query -- thus the <code>Text.From()</code> and the appended <code>'</code>'s to the ends (<em>SQL marks strings with single ' rather than the double \"</em>)</p>\n\n<p>Since I named the variable <code>Param</code>, to use it in the string, I substituted <code>&amp;Param</code> for the value which had originally been there.</p>\n\n<hr>\n\n<h2><strong>2.1 Power Query's Value.NativeQuery</strong></h2>\n\n<pre><code>let\n    ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Param = ParamTable[value]{0},\n    Source = Value.NativeQuery(Sql.Database(\"IP Address\", \"Database Name\"), \"Select * from weeks where date &lt; @dateSel and date &gt;= '2018-01-01'\",[dateSel = Param])\nin\n    Source\n</code></pre>\n\n<p><em>Alternative Formatting:</em></p>\n\n<pre><code>let\n    ParamTable = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Param = ParamTable[value]{0},\n    Source = Sql.Database(\"IP Address\", \"Database Name\"),\n    Data = Value.NativeQuery(Source, \"\n\nSelect * from weeks\nwhere date &lt; @dateSel and date &gt;= '2018-01-01'\n\n\",[dateSel = Param])\nin\n    Source\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>When using <code>Value.NativeQuery()</code>, you can pass a date or datetime value directly in as a variable without having to include the single apostrophes.</p>\n\n<p>Sometimes splitting the data retrieval into a <code>Source</code> step and a <code>NativeQuery</code> step can help with PQ's sporadic firewall issues.</p>\n\n<hr>\n\n<h2><strong>3) Macro</strong></h2>\n\n<p>This works for a simple check if anything in the table has changed, then runs the refresh. You will need to make sure this is placed in the correct module. Items you will need to change are:</p>\n\n<ul>\n<li><code>Sheet1</code> is the codename of the worksheet with the parameter table.</li>\n<li><code>\"Table\"</code> is the name of the Parameter table</li>\n<li><code>\"Query - Query1\"</code> is the name of the connection to be refreshed</li>\n</ul>\n\n<p><em>Note:</em> <code>Query1</code> is the name of the query. Default names for connections are usually <code>Query -</code> &amp; query name</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Sheet1.ListObjects(\"Table1\").DataBodyRange) Is Nothing Then\n        ThisWorkbook.Connections(\"Query - Query1\").Refresh\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4655, "user_id": 238631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/964be6c91230958b16680799436d57b0?s=128&d=identicon&r=PG", "display_name": "Soham Dasgupta", "link": "https://stackoverflow.com/users/238631/soham-dasgupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7785, "favorite_count": 2, "accepted_answer_id": 49657710, "answer_count": 1, "score": 3, "last_activity_date": 1580001561, "creation_date": 1522860416, "last_edit_date": 1580001561, "question_id": 49656319, "link": "https://stackoverflow.com/questions/49656319/replace-sql-query-parameter-in-a-excel-power-query", "title": "Replace SQL query parameter in a Excel power query", "body": "<p>I have a workbook where I fetch data from SQL Server using fixed parameter values for a SQL query.</p>\n\n<p>I want to make another sheet and have the parameter for the SQL query be taken from the cell values.</p>\n\n<p>I didn't find anything on this regard.</p>\n\n<p>Also I would like to refresh the data as soon as the cell values changes in the other sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522862441, "post_id": 49656292, "comment_id": 86322770, "body": "&quot;It is extracted as &#39;02/04/2018&#39;&quot; - What line extracts this?  The <code>Set matches = ...</code>?  When pasting why not do say <code>Range(&quot;A1&quot;).Value = Month(matches.value) &amp; &quot;&#47;&quot; &amp; Day(matches.value) &amp; &quot;&#47;&quot; &amp; Year(matches.value)</code>"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1522872356, "post_id": 49656292, "comment_id": 86328531, "body": "<code>Format</code> command in VBA. But you may also need the correct formatting to the Excel cells."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1522879817, "post_id": 49656292, "comment_id": 86332163, "body": "Even though you cannot share the data, you could create dummy data that replicates the problem.  It might also be useful to know which dates are passed unchanged.  They might be dates where one of the first two sections is <code>&gt;12</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1522887612, "last_edit_date": 1522887612, "creation_date": 1522879579, "answer_id": 49661162, "question_id": 49656292, "link": "https://stackoverflow.com/questions/49656292/vba-excel-date-formatting-assistance/49661162#49661162", "title": "VBA Excel Date formatting assistance", "body": "<p>You have provided an ambiguous date. <code>02/04/2018</code>, depending on your locale, could be either <code>04-Feb-2018</code> or <code>02-Apr-2018</code>.</p>\n\n<p>Exactly how to fix your problem depends on your locale settings.</p>\n\n<p>However, what you can do is create an unambiguous date by extracting separately the month, day and year, and creating a date from that.</p>\n\n<p>Change your regex pattern to split out date parts separately.</p>\n\n<pre><code>([\\s\\S]+?):\\s*([\\s\\S]+?)\\s*-\\s*([A-z]+)\\s*,\\s*([0-9]{2})\\/([0-9]{2})\\/([0-9]{4})\\b\n</code></pre>\n\n<p>Then add into your code lines like this:</p>\n\n<pre><code>Dim DT as Date\n... your regex stuff ...\n\nWith mc(0)\n    'DT = DateSerial(.SubMatches(5), .SubMatches(3), .SubMatches(4))\n    '  or\n    'DT = DateSerial(.SubMatches(5), .SubMatches(4), .SubMatches(3))\nEnd With\n</code></pre>\n\n<p>Choose the appropriate line depending on whether the date in your original data is MDY or DMY format.</p>\n\n<p>You can then write <code>DT</code> to the appropriate part of your worksheet, and format the cell as you wish.</p>\n"}], "owner": {"reputation": 111, "user_id": 4806694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8bae6f08360a1020c224e0599f96e60b?s=128&d=identicon&r=PG&f=1", "display_name": "Khazba", "link": "https://stackoverflow.com/users/4806694/khazba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522887612, "creation_date": 1522860329, "last_edit_date": 1522860645, "question_id": 49656292, "link": "https://stackoverflow.com/questions/49656292/vba-excel-date-formatting-assistance", "title": "VBA Excel Date formatting assistance", "body": "<p>So, I've run into the typical date formatting issue.</p>\n\n<p>Which is causing me a headache. \nI can't share the data for security reasons. But, I can describe the format. \nThe VBA is simple enough, and she be able to be worked out.</p>\n\n<p>In short, </p>\n\n<p>My macro obtains its data from Col C, where the regex extracts the department and date.</p>\n\n<p>I then call these in a loop to paste the data into Col A, B and finally C to replace the original data.</p>\n\n<p>My issue is, Col B has a date in it. <br>\nIt is extracted as \"02/04/2018\", but when it pastes it into the col, it appears as 04/02/2018. Which is a massive issue.</p>\n\n<p>I cannot get the VBA macro to hold, or set the format. So far.</p>\n\n<p>I will attach my script below and you can let me know. </p>\n\n<p>Thanks!</p>\n\n<p>Ps. This is the line I suspect is the issue.\n <code>ws.Range(\"B\" &amp; x).Value = match.SubMatches(3)</code></p>\n\n<p>I cannot figure out how to have it set the value as extracted from the string. sigh.</p>\n\n<pre><code>Sub Link()\n\n Dim ws As Worksheet\n    Dim lastRow As Long, x As Long\n    Dim matches As Variant, match As Variant\n    Dim Reg_Exp As Object\n    Dim rValue As String\n\n    Set Reg_Exp = CreateObject(\"vbscript.regexp\")\n\n    Reg_Exp.Pattern = \"([\\s\\S]+?):\\s*([\\s\\S]+?)\\s*-\\s*([A-z]+)\\s*,\\s*([0-9]{2}\\/[0-9]{2}\\/[0-9]{4})\\b\"\n\n\n    Set ws = Sheet2\n\n    lastRow = ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    For x = 1 To lastRow\n        Set matches = Reg_Exp.Execute(CStr(ws.Range(\"C\" &amp; x).Value))\n        If matches.Count &gt; 0 Then\n            For Each match In matches\n                ws.Range(\"A\" &amp; x).Value = match.SubMatches(3) &amp; match.SubMatches(1)\n                ws.Range(\"B\" &amp; x).Value = match.SubMatches(3)\n                ws.Range(\"C\" &amp; x).Value = match.SubMatches(1)\n            Next match\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522858433, "post_id": 49655663, "comment_id": 86320507, "body": "<b>1.</b> You are not exiting the loop, e.g. the possible exit is in a condition. <b>2.</b> <code>CreateMail (address)</code> is probably doing something related to the error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1522858488, "post_id": 49655663, "comment_id": 86320545, "body": "<code>currentCell = ThisWorkbook.Worksheets(&quot;Follow Up&quot;).Range(startCell).Offset(counter, 0)</code> needs to be <code>Set currentCell = ThisWorkbook.Worksheets(&quot;Follow Up&quot;).Range(startCell).Offset(counter, 0)</code>. However, your code is far from being optimal"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522858523, "post_id": 49655663, "comment_id": 86320566, "body": "Also, <code>Dim currentCell As Range</code>."}, {"owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "edited": false, "score": 0, "creation_date": 1522859822, "post_id": 49655663, "comment_id": 86321276, "body": "Nice it works but then I think gets stuck in the loop so my logic is probably wrong. The error once it crashes is (and i can only see it briefly before it closes) &quot;Method _Defaul&#39; of object &#39;Range&#39; Failed..  Imma poke it for a hot minute and see if i can figure it out.  Of course i&#39;ll always take help (hence being on this site. :) )"}, {"owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522860550, "post_id": 49655663, "comment_id": 86321753, "body": "thanks @ShaiRado rado but I never quite get it yet.  I have currentCell as Range and even use the set keyword for it. Thus it should be an object, right? Well if i change the while to &#39;While currentCell Is Not Empty&#39; but says it requires an object."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522860746, "post_id": 49655663, "comment_id": 86321868, "body": "@Xellinus if you tell us what you are trying to achieve, perhaps we can offer an easier code, and a more reliable one"}, {"owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "edited": false, "score": 0, "creation_date": 1522860993, "post_id": 49655663, "comment_id": 86322018, "body": "I edited to update with the other snip of code.  I&#39;m just parsing down a list of emails (all lines have a Member ID and name but not all have email and notes) and sending a templated email for each email address.  There will be more customization later (adding in names to the email etc etc) but for now i&#39;m just trying to get the loop for emailing everyone down."}, {"owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522865397, "post_id": 49655663, "comment_id": 86324456, "body": "I&#39;ve thought about parsing everything into a nested array but felt that was a little unnecessary.  The looping, which should be super simple, is vexing me.  I&#39;m used to more complex languages so i feel a fool here @ShaiRado"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522874742, "post_id": 49655663, "comment_id": 86329771, "body": "Which line is causing the crash? Step through it or use some logging. And if cuurentCell really is a Range, technically it can&#39;t be &gt; 0. VBA is forgiving, but your lack of data typing can be setting traps, here..."}, {"owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "edited": false, "score": 0, "creation_date": 1522881585, "post_id": 49655663, "comment_id": 86332797, "body": "well the &gt;0 is just an attempt to say &quot;if that cell is empty stop&quot;  but <code>While currentCell Is Not Empty</code> doesn&#39;t work as it claims currentCell is not an object which i thought it was."}], "owner": {"reputation": 33, "user_id": 9597807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed403089de8030c669315c41f20b73f?s=128&d=identicon&r=PG", "display_name": "Xellinus", "link": "https://stackoverflow.com/users/9597807/xellinus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523405439, "creation_date": 1522857976, "last_edit_date": 1531164843, "question_id": 49655663, "link": "https://stackoverflow.com/questions/49655663/weird-object-error-on-2nd-loop-of-while", "title": "Weird Object error on 2nd loop of while", "body": "<p>UPDATE: I'm an idiot</p>\n\n<p>SO this gives me the classic Object required error and i'm not 100% sure why.  It works on the first loop then errors on the second... meh?</p>\n\n<pre><code>Private Sub Email_Click()\n    Dim counter As Integer\n    Dim address As String\n    Dim startCell\n    Dim currentCell\n    counter = 0\n    startCell = \"B5\"\n    Set currentCell = ThisWorkbook.Worksheets(\"Follow Up\").Range(startCell) '.Offset(counter, 0).Value\n\n\nWhile currentCell &gt; 0\n\n\n    address = currentCell.Offset(counter, 2).Value\n    If (currentCell.Offset(counter, 2) &gt; 0) Then\n        CreateMail (address)\n        &lt;s&gt;counter = counter + 1&lt;/s&gt;\n        currentCell = ThisWorkbook.Worksheets(\"Follow Up\").Range(startCell).Offset(counter, 0)\n    Else\n\n    End If\n**counter = counter + 1**\n  Wend\n counter = 0\nEnd Sub\n</code></pre>\n\n<p>this is what the sheet looks like right now.  it's all test.    </p>\n\n<pre><code>Date    Member ID   Name    Email       Notes\n 1948828    bobby   bob@bob.com     awsda\n 2166295    jim         \n 2274434    james   Me@you.com      \n</code></pre>\n\n<p>EDIT* adding CreateMail code</p>\n\n<pre><code>Private Sub CreateMail(address As String)\n    Dim myolapp As Object\n    Dim myitem As Object\n\n    Set myolapp = CreateObject(\"Outlook.Application\")\n    myolapp.Session.Logon\n\n    Set myitem = myolapp.CreateItemFromTemplate(ThisWorkbook.Worksheets(\"Data\").Range(\"B11\").Value + \"NMFU.oft\")\n    myitem.Body = \"Hey test\" &amp; myitem.Body\n    myitem.Display 'or send\n    myitem.to = address\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1522863345, "post_id": 49655562, "comment_id": 86323258, "body": "Please specify URL and share VBA code you have, check <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 1, "user_id": 9596663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7niRQtJEPfQ/AAAAAAAAAAI/AAAAAAAAAIg/gHi0IO_5tpw/photo.jpg?sz=128", "display_name": "Nilton da Silva", "link": "https://stackoverflow.com/users/9596663/nilton-da-silva"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1522926627, "post_id": 49655562, "comment_id": 86351812, "body": "omegastripes I&#39;m sorry I put the code that I&#39;m adapting for my use."}], "owner": {"reputation": 1, "user_id": 9596663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7niRQtJEPfQ/AAAAAAAAAAI/AAAAAAAAAIg/gHi0IO_5tpw/photo.jpg?sz=128", "display_name": "Nilton da Silva", "link": "https://stackoverflow.com/users/9596663/nilton-da-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1522868195, "creation_date": 1522857633, "last_edit_date": 1531164843, "question_id": 49655562, "link": "https://stackoverflow.com/questions/49655562/vba-interacting-with-internet-explorer", "title": "VBA interacting with Internet Explorer", "body": "<p>I am using an Excel VBA code adapting my need, but I am not able to tell the code how to click on the example that I put in the attachment. The reference you have in Internet Explorer is this </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a href=\"/siconv/ConsultProposal/ProfileQueryProfileQueryProposal.of?id?proposed=1336163&amp;destino=&amp;idConvenio=\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>and I'm not sure how to put this prompt for VBA to click. Anyone who can help thanks, Nilton.</p>\n\n<pre><code>Sub lsConsultaObjetoPropostaSiconv()\n'Inclui a refer\u00eancia se n\u00e3o houver\nlReferenciaIE\n\nDim IE                  As InternetExplorer\nDim lProposta           As String\nDim lUltimaLinhaAtiva   As Long\nDim lContador           As Long\n\n'Identifica a \u00faltima c\u00e9lula ativa da lista\nlUltimaLinhaAtiva = Worksheets(\"Plan4\").Cells(Worksheets(\"Plan4\").Rows.Count, 1).End(xlUp).Row\n\n'Cria um objeto Internet Explorer\nSet IE = New InternetExplorer\n\n'Torna o objeto vis\u00edvel\nIE.Visible = True\n\n'Faz um loop por todas as linhas da planilha\nFor lContador = 2 To lUltimaLinhaAtiva\n    'Navega ao site Siconv\n    IE.Navigate \"https://www.convenios.gov.br/siconv/proposta/ConsultarProposta/ConsultarProposta.do\"\n\n    'Identifica se a p\u00e1gina j\u00e1 foi totalmente carregada\n    While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Wend\n\n    'Como a p\u00e1gina possui JavaScript que cria os objetos que s\u00e3o preenchidos ap\u00f3s a carga completa, \u00e9 necess\u00e1rio\n    'aguardar um tempo, coloquei 3 segundos, alterar conforme a necessidade.\n    'Caso n\u00e3o tenha javascript na cria\u00e7\u00e3o dos objetos da p\u00e1gina comentar esta parte do c\u00f3digo, pois ser\u00e1 bem\n    'mais r\u00e1pida a execu\u00e7\u00e3o.\n    sng = Timer\n    Do While sng + 3 &gt; Timer\n    Loop\n\n    'Carrega os dados da proposta que ser\u00e3o preenchidos na p\u00e1gina\n    lProposta = Range(\"A\" &amp; lContador).Value\n\n    'Carrega os dados da proposta na p\u00e1gina e submete os dados do formul\u00e1rio\n    IE.Document.all(\"numeroProposta\").innertext = lProposta\n    IE.Document.forms(\"consultarPropostaPreenchaOsDadosDaConsultaConsultarForm\").submit\n\n    'Identifica se a p\u00e1gina j\u00e1 foi totalmente carregada\n    While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Wend\n\n    Clica no n\u00famero da proposta e abre nova aba        \n    'IE.Document.body.getElementsByTagName (\"N\u00famero da Proposta\")\n    'IE.Document.getElementById(\"a\").Click\n\n     'Como a p\u00e1gina possui JavaScript que cria os objetos que s\u00e3o preenchidos ap\u00f3s a carga completa, \u00e9 necess\u00e1rio\n    'aguardar um tempo, coloquei 3 segundos, alterar conforme a necessidade.\n    'Caso n\u00e3o tenha javascript na cria\u00e7\u00e3o dos objetos da p\u00e1gina comentar esta parte do c\u00f3digo, pois ser\u00e1 bem\n    'mais r\u00e1pida a execu\u00e7\u00e3o.\n    sng = Timer\n    Do While sng + 3 &gt; Timer\n    Loop\n\n    'Faz um loop pelos objetos do tipo table na p\u00e1gina e procura pelo campo Objeto do Conv\u00eanio.\n    'Em seguida busca pela segunda coluna da linha de Situa\u00e7\u00e3o e armazena esta informa\u00e7\u00e3o diretamente na coluna B da linha da planilha\n    For Each i In IE.Document.body.getElementsByTagName(\"table\")\n        If InStr(i.innertext, \"Objeto do Conv\u00eanio\") &gt; 0 Then\n            For Each l In i.getElementsByTagName(\"tr\")\n                If InStr(l.innertext, lProposta) Then\n                    Range(\"B\" &amp; lContador).Value = l.getElementsByTagName(\"td\")(1).innertext \n                End If\n            Next l\n        End If\n    Next i\nNext lContador\n\nMsgBox \"Conclu\u00eddo!\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p><a href=\"https://i.stack.imgur.com/6FK2l.png\" rel=\"nofollow noreferrer\">Internet Explorer Print</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "edited": false, "score": 0, "creation_date": 1522856664, "post_id": 49655136, "comment_id": 86319383, "body": "Your question is not very clear, could you explain what you&#39;re trying to do (step by step). I &quot;fixed&quot; the compile error, but that won&#39;t solve your issue"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "edited": false, "score": 0, "creation_date": 1522856761, "post_id": 49655244, "comment_id": 86319465, "body": "Replaced with your code, but getting &quot;runtime error - type mismatch&quot;."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522856805, "post_id": 49655244, "comment_id": 86319491, "body": "Left will not work with multiple cell ranges.  The OP will need to loop and test each individually."}, {"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "reply_to_user": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "edited": false, "score": 0, "creation_date": 1522856998, "post_id": 49655244, "comment_id": 86319631, "body": "@user2574 I edited my post, but I&#39;m not sure if that&#39;s what you want to do, checking for each row 2 values, then saying OK"}], "tags": [], "owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "is_accepted": true, "score": 0, "last_activity_date": 1522856952, "last_edit_date": 1522856952, "creation_date": 1522856552, "answer_id": 49655244, "question_id": 49655136, "link": "https://stackoverflow.com/questions/49655136/set-string-to-a-range/49655244#49655244", "title": "Set String to a range", "body": "<p>You're selecting your substring the wrong way. You want to replace:</p>\n\n<pre><code>str = Worksheets(\"ORD_CS\").Range(Left(\"S:S\"), 20)\nstr1 = Worksheets(\"ORD_CS\").Range(Left(\"U:U\"), 20)\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Sub Macro1()\n'\n'Match Organization names\n'\n\n'\n    Dim sht As Worksheet\n    Dim LR As Long\n    Dim i As Long\n    Dim str As String, str1 As String\n\n    Set sht = ActiveWorkbook.Worksheets(\"ORD_CS\")\n    LR = sht.UsedRange.Rows.Count\n\n    With sht\n            For i = 8 To LR\n                If CStr(.Range(\"Q\" &amp; i).Value) = \"O\" Then\n                    str = Left(.Range(\"S\" &amp; i).Value, 20)\n                    str1 = Left(.Range(\"U\" &amp; i).Value, 20)\n                    If str = str1 Then\n                        Range(\"V\" &amp; i).Value = \"ok\"\n                    End If\n                End If\n            Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Currently, you're trying to select 20 characters from a range. And this string selection needs to be done in-loop, not at the beginning of the loop, unless I don't understand your question.</p>\n"}], "owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49655244, "answer_count": 1, "score": 0, "last_activity_date": 1522856952, "creation_date": 1522856253, "last_edit_date": 1531164843, "question_id": 49655136, "link": "https://stackoverflow.com/questions/49655136/set-string-to-a-range", "title": "Set String to a range", "body": "<p>I have column S &amp; U with Names. In Column Q i have the customer type (O for organization &amp; P for personal). For all the customer Q, i want to compare the first 20 characters of the column S and column U and if they match, get the value \"ok\" in column V. i have done a code, but its giving me compile error in the line - str = Worksheets(\"ORD_CS\").Range(Left(\"S:S\"), 20). Can some help me in fixing this code. Thanks</p>\n\n<pre><code>Sub Macro1()\n'\n'Match Organization names\n'\n\n'\n    Dim sht As Worksheet\n    Dim LR As Long\n    Dim i As Long\n    Dim str As String, str1 As String\n\n    Set sht = ActiveWorkbook.Worksheets(\"ORD_CS\")\n    LR = sht.UsedRange.Rows.Count\n    str = Worksheets(\"ORD_CS\").Range(Left(\"S:S\"), 20)\n    str1 = Worksheets(\"ORD_CS\").Range(Left(\"U:U\"), 20)\n\n    With sht\n            For i = 8 To LR\n                If CStr(.Range(\"Q\" &amp; i).Value) = \"O\" Then\n                    If str = str1 Then\n                        Range(\"V\" &amp; i).Value = \"ok\"\n                    End If\n                End If\n            Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions", "worksheet"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 9, "creation_date": 1522855714, "post_id": 49654877, "comment_id": 86318643, "body": "Try adding <code>...Sum(WS.Range(...</code>"}, {"owner": {"reputation": 47, "user_id": 9591382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bb0b82ba12e5f8dc9d923a4ec9aad1?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch103", "link": "https://stackoverflow.com/users/9591382/mitch103"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1522855896, "post_id": 49654877, "comment_id": 86318805, "body": "@MarcoGetrost Wow, I cant believe it! It worked! Thank you so much for your help!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522860714, "post_id": 49654877, "comment_id": 86321848, "body": "Hope you don&#39;t mind, I&#39;ve <a href=\"https://twitter.com/rubberduckvba/status/981571234252156930\" rel=\"nofollow noreferrer\">tweeted</a> a link to this post - Rubberduck would have fired an &quot;implicit ActiveWorkbook reference&quot; inspection result here, warning you about that unqualified <code>Range</code> call (and making it pretty easy to locate the problem)."}], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 1, "creation_date": 1522857784, "post_id": 49655356, "comment_id": 86320137, "body": "Very elegant answer!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1522856946, "creation_date": 1522856946, "answer_id": 49655356, "question_id": 49654877, "link": "https://stackoverflow.com/questions/49654877/vba-user-defined-function-returning-value-when-another-workbook-with-similar-sh/49655356#49655356", "title": "VBA User Defined Function returning #VALUE when another Workbook with similar Sheets is open", "body": "<p>You've been bitten by implicit qualifiers.</p>\n\n<p>When <code>Range</code> isn't explicitly qualified with a specific <code>Worksheet</code> object instance, it becomes an implicit member call on the <code>[_Global]</code> object.</p>\n\n<p>Unqualified <code>Range</code> calls therefore implicitly refer to whatever worksheet is currently active, in whatever workbook happens to be active.</p>\n\n<p>When you mean to work against a specific <code>Worksheet</code> object, like <code>WS</code> in your case, then you should qualify <code>Range</code>, <code>Rows</code>, <code>Columns</code>, <code>Names</code>, and <code>Cells</code> calls with that worksheet object.</p>\n\n<p>That's why <code>ColumnSum = Application.WorksheetFunction.Sum(WS.Range(...))</code> fixes it.</p>\n\n<hr>\n\n<p><code>ThisWorkbook</code> refers to the specific workbook where the VBA code is written in, which may or may not be the workbook <code>WS</code> belongs to. That's why it didn't work.</p>\n"}], "owner": {"reputation": 47, "user_id": 9591382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bb0b82ba12e5f8dc9d923a4ec9aad1?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch103", "link": "https://stackoverflow.com/users/9591382/mitch103"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 49655356, "answer_count": 1, "score": 3, "last_activity_date": 1549397666, "creation_date": 1522855514, "last_edit_date": 1549397666, "question_id": 49654877, "link": "https://stackoverflow.com/questions/49654877/vba-user-defined-function-returning-value-when-another-workbook-with-similar-sh", "title": "VBA User Defined Function returning #VALUE when another Workbook with similar Sheets is open", "body": "<p>I have a workbook with multiple User Defined Functions that sometimes give a #VALUE error. I have determined that these UDFs give a #VALUE error when another workbook with similar sheet names/tab colors is open at the same time as the workbook with the UDFs. The UDFs refer to other worksheets using tab color within the workbook to calculate its value. So my guess is that these UDFs are giving a #VALUE error because it cannot distinguish the difference in similarly named/colored worksheets in different open workbooks. </p>\n\n<p>For example, two open workbooks with the same tab color give these UDFs a #VAULE error. I confirmed this by opening a new worksheet with generic sheet names and white tab colors, and the UDFs did not give this error. These UDFs otherwise work perfectly as intended, except for this occurrence. Below is just an example of one of the UDFs that give this error under the circumstances. I have tried to fix this error by referencing \"ThisWorkbook\", but that does not seem to correct the error. I even tried moving the function to the \"ThisWorkbook\" Module, but apparently functions do not populate in excel in this module. I cannot figure out how to fix this issue. Your help is greatly appreciated!</p>\n\n<pre><code>Function ExpenseActualSum(Month)\n\nApplication.Volatile\nColumnNumber = Month.Column - 1\nExpenseMonthSum = 0\nDim WS As Worksheet\n\nFor Each WS In ThisWorkbook.Worksheets\n    If WS.Tab.Color = 255 Then\n\n        For Each Tbl In WS.ListObjects\n            If Tbl.Name Like \"Actual*\" Then\n            TableName = Tbl.Name\n            Exit For\n            End If\n        Next Tbl\n\n    ColumnSum = Application.WorksheetFunction.Sum(Range(TableName &amp; \"[[#All],[Column\" &amp; ColumnNumber &amp; \"]]\"))\n    ExpenseMonthSum = ExpenseMonthSum + ColumnSum\n    End If\nNext WS\n\nExpenseActualSum = ExpenseMonthSum\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1522855018, "post_id": 49654639, "comment_id": 86318157, "body": "<code>worksheetfunction.sum</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522855551, "post_id": 49654639, "comment_id": 86318528, "body": "To add a variable into a string, you need to close the string first:  <code>MsgBox &quot;Start at row &quot; &amp; first_line &amp; &quot; and end at line &quot; &amp; last_lin -1</code> should give you some clues.  (Pay attention to the colour-coding \u263a)"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "is_accepted": false, "score": 0, "last_activity_date": 1522855768, "creation_date": 1522855768, "answer_id": 49654969, "question_id": 49654639, "link": "https://stackoverflow.com/questions/49654639/sum-of-particular-cells-of-a-column/49654969#49654969", "title": "sum of particular cells of a column", "body": "<p>Suppose you wan to find sum of first three rows in a column. Then in the fourth row of that column you have to get the sum. VBA code will be like below for the fourth row of that column.</p>\n\n<pre><code>ws.cells(4,j) = \"=SUM(R[-3]C:R[-1]C)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1522858987, "creation_date": 1522858987, "answer_id": 49655937, "question_id": 49654639, "link": "https://stackoverflow.com/questions/49654639/sum-of-particular-cells-of-a-column/49655937#49655937", "title": "sum of particular cells of a column", "body": "<p>May be you can use this</p>\n\n<pre><code>With ws\n    first_line = .Cells(i, k).Value\n    last_line = .Cells(i + 3, k).Value\n    .Cells(last_line, j) = WorksheetFunction.Sum(.Range(.Cells(first_line, j), .Cells(last_line - 1, j)))\nEnd With \n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 9351236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4403fbf5d15ea4a0c60a0325204fa820?s=128&d=identicon&r=PG&f=1", "display_name": "user9351236", "link": "https://stackoverflow.com/users/9351236/user9351236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 49655937, "answer_count": 2, "score": -2, "last_activity_date": 1524830666, "creation_date": 1522854869, "last_edit_date": 1531164843, "question_id": 49654639, "link": "https://stackoverflow.com/questions/49654639/sum-of-particular-cells-of-a-column", "title": "sum of particular cells of a column", "body": "<p>I am running a macro where I need sum of a range of cells in a column. But that is a variable with every run. The range of cells will vary every time I will run the macro.I tried using the answer on this link <a href=\"https://stackoverflow.com/questions/2960695/excel-vba-sum-up-a-column\">Excel VBA - Sum up a column</a></p>\n\n<p>But its not working for my code. </p>\n\n<pre><code>first_line = ws.Cells(i, k).Value\nlast_line = ws. cells(i + 3, k).Value\nsum_each_col = \"=SUM(first_line, j:last_lin - 1, j)\"\nws.cells(last_line, j) = sum_each_col\n</code></pre>\n\n<p>j is the column no.\nIt is not working. I m sure I have misunderstood something in the code. Request you to please have a look at it once as I am just a beginner on this.</p>\n"}, {"tags": ["vba", "find", "range"], "comments": [{"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "edited": false, "score": 0, "creation_date": 1522854561, "post_id": 49654441, "comment_id": 86317790, "body": "You can do a for loop, finding the coordinate of your last cell, then selecting only this range. There are multiple ways to do it, including built-in functions (to find last row or column at least)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522859100, "post_id": 49654441, "comment_id": 86320916, "body": "How to check what\u2019s \u201cmarked for copying\u201d?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9597424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/893bfbe600bca1c9dc5e11dc4c581e57?s=128&d=identicon&r=PG&f=1", "display_name": "M.Gro&#223;", "link": "https://stackoverflow.com/users/9597424/m-gro%c3%9f"}, "edited": false, "score": 0, "creation_date": 1524232876, "post_id": 49654724, "comment_id": 86902957, "body": "It works perfectly, just had no time to answer, but really big thanks!!"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1522855512, "last_edit_date": 1522855512, "creation_date": 1522855147, "answer_id": 49654724, "question_id": 49654441, "link": "https://stackoverflow.com/questions/49654441/selecting-range-in-vba/49654724#49654724", "title": "Selecting Range in VBA", "body": "<p><a href=\"https://i.stack.imgur.com/xrADP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xrADP.png\" alt=\"enter image description here\"></a>I think you need to find word5 within the same column to create a limit if you dont to copy the entire column    </p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim xl_first_range As Range\n    Dim xl_second_range As Range\n\n    With ThisWorkbook.Sheets(\"worksheet(1)\")\n\n    'here I selected the right worksheet to search for the \"word1\"\n\n    Set xl_first_range = .Cells.Find(What:=\"word1\", LookIn:=xlFormulas, LookAt _\n    :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    True, SearchFormat:=False)\n\n    'here I searched for the \"word1\", which is a Header of a long table and word5 in the same column\n\n    Set xl_second_range = xl_first_range.EntireColumn.Cells.Find(What:=\"word5\", LookIn:=xlFormulas, LookAt _\n    :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    True, SearchFormat:=False)\n\n    'Select the entire Column until word5 cell\n\n    .Range(xl_first_range, xl_second_range).Copy\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522859661, "post_id": 49656047, "comment_id": 86321196, "body": "and what happend is there is no `&quot;word1&quot; in the worksheet ?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522860184, "post_id": 49656047, "comment_id": 86321514, "body": "@ShaiRado, it errors out, of course. same with \u201cword5\u201d. But I assumed from OP\u2019s question it has to be taken for granted that they are always in place"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522859460, "creation_date": 1522859460, "answer_id": 49656047, "question_id": 49654441, "link": "https://stackoverflow.com/questions/49654441/selecting-range-in-vba/49656047#49656047", "title": "Selecting Range in VBA", "body": "<p>Maybe you\u2019re after this</p>\n\n<pre><code>With .Sheets(\"worksheet(1)\")\n    .Range(.Cells.Find(What:=\"word1\"), .Cells.Find(What:=\"word5\").Copy\nEnd With\n</code></pre>\n\n<p>Of course this \u201cWith-End With\u201d block must be nested within some outer \u201cWith SomeWorkbookReference - End With\u201d outer block. Or you remove the dot before Sheets(\"worksheet(1)\")</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1522859507, "creation_date": 1522859507, "answer_id": 49656058, "question_id": 49654441, "link": "https://stackoverflow.com/questions/49654441/selecting-range-in-vba/49656058#49656058", "title": "Selecting Range in VBA", "body": "<p>You should avoid using all these <code>Select</code> and <code>Activate</code>, instead use fully qualified objects.</p>\n\n<p>Also, using the <code>Find</code> function you need to set the result to a <code>Range</code> object, and also handle a scenario an error will occur when <code>Find</code> is unable to find <code>\"word1\"</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim VariableRng As Range\n\nWith ThisWorkbook.Sheets(\"worksheet(1)\") '&lt;-- is \"worksheet(1)\" the name of your worksheet ?\n    ' set the range to Find result\n    Set VariableRng = .Cells.Find(What:=\"word1\")\n    If Not VariableRng Is Nothing Then ' find was successful\n        VariableRng.EntireColumn.Copy\n    Else ' Find failed &gt;&gt; raise error msgbox\n        MsgBox \"Can't find 'word1' in \" &amp; .name &amp; \" sheet\"\n    End If\nEnd With   \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9597424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/893bfbe600bca1c9dc5e11dc4c581e57?s=128&d=identicon&r=PG&f=1", "display_name": "M.Gro&#223;", "link": "https://stackoverflow.com/users/9597424/m-gro%c3%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1522859507, "creation_date": 1522854299, "last_edit_date": 1522855656, "question_id": 49654441, "link": "https://stackoverflow.com/questions/49654441/selecting-range-in-vba", "title": "Selecting Range in VBA", "body": "<p>Currently I have a problem regarding the selection of a range to copy into another worksheet. </p>\n\n<p>The idea of my steps and the current problem is explained in the code:</p>\n\n<pre><code> With .Sheets(\"worksheet(1)\").Select\n\n    ' here I selected the right worksheet to search for the \"word1\"         \n    Variable = Cells.Find(What:=\"word1\").Activate\n\n    'here I searched for the \"word1\", which is a Header of a long table           \n    ActiveCell.EntireColumn.Select\n\n    'I selected the entire Column\n     Selection.Copy\n\n    'Now I copy the whole  area\n\nEnd With\n</code></pre>\n\n<p>The problem is that I want to have not only the entire column, but everything marked for copying until a certain Name <code>word5</code> at the end of the table.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1522853690, "creation_date": 1522853690, "answer_id": 49654213, "question_id": 49653920, "link": "https://stackoverflow.com/questions/49653920/excel-get-textbox-value-that-calls-macro/49654213#49654213", "title": "Excel - Get Textbox value that calls macro", "body": "<p>One way to accomplish this is to rename all the text boxes to the name of the machine that they represent. Then assign all the text boxes to this procedure.</p>\n\n<pre><code>Option Explicit\n\nSub openRemoteViewer()\n\n    Dim whichMachine As String\n    whichMachine = Application.Caller\n\n    Dim path As String\n   ' Set the Path variable equal to the path of your program's installation\n    path = \"\"\"W:\\Remote\\CmRcViewer.exe\"\" \"\"\" &amp; whichMachine &amp; \"\"\"\"\n\n    Dim x As Variant\n    x = Shell(path, vbNormalFocus)\n\n End Sub\n</code></pre>\n\n<p>There are other ways, but I think this may be the easiest to implement.</p>\n"}], "owner": {"reputation": 37, "user_id": 4955323, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0db7450cdb0fa82dc4c4998fca6fb7ec?s=128&d=identicon&r=PG&f=1", "display_name": "NickPomroy", "link": "https://stackoverflow.com/users/4955323/nickpomroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49654213, "answer_count": 1, "score": 0, "last_activity_date": 1522853690, "creation_date": 1522852803, "last_edit_date": 1531164843, "question_id": 49653920, "link": "https://stackoverflow.com/questions/49653920/excel-get-textbox-value-that-calls-macro", "title": "Excel - Get Textbox value that calls macro", "body": "<p>I do a lot of remote IT support and made a map of all the computers in my building in textboxes. I wanted to be able to click on the relevant computer and have it open the remote viewing program.</p>\n\n<p>I found this code elsewhere on this site</p>\n\n<pre><code>Sub Auto_Open()\n    Dim x As Variant\n    Dim Path As String\n\n\n    ' Set the Path variable equal to the path of your program's installation\n    Path = \"\"\"W:\\Remote\\CmRcViewer.exe\"\" \"\"PC13054\"\"\"\n\n    x = Shell(Path, vbNormalFocus)\n End Sub \n</code></pre>\n\n<p>I was wondering if there is a way to pull the textbox.value of the textbox that calls the macro dynamically? Such as this.value?</p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1522852654, "post_id": 49653840, "comment_id": 86316314, "body": "delete from the first <code>IF</code> to and including the first <code>Else</code>. then delete the 2nd <code>End If</code>"}, {"owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522853818, "post_id": 49653840, "comment_id": 86317220, "body": "It worked. Thank you kindly"}], "owner": {"reputation": 27, "user_id": 5553858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d806f1cec83a589960eb6bba21b95e48?s=128&d=identicon&r=PG&f=1", "display_name": "sway", "link": "https://stackoverflow.com/users/5553858/sway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522852578, "creation_date": 1522852578, "last_edit_date": 1531164843, "question_id": 49653840, "link": "https://stackoverflow.com/questions/49653840/editing-vba-userform-script", "title": "Editing VBA userform script", "body": "<pre><code>Worksheets(whichSheet).Activate\nDim lastrow\nlastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nlastrow = lastrow + 1\nCells(lastrow, 1) = TextBox1\nIf Application.WorksheetFunction.CountIf(Range(\"A2:A\" &amp; lastrow), Cells(lastrow, 1)) &gt; 1 Then\nMsgBox \"Duplicate data! Only unique IDs allowed\", vbCritical, \"Remove Data\"\nCells(lastrow, 1) = \"\"\nElseIf Application.WorksheetFunction.CountIf(Range(\"A2:A\" &amp; lastrow), Cells(lastrow, 1)) = 1 Then\nanswer = MsgBox(\"Are you sure you want to add the record?\", vbYesNo + vbQuestion, \"Add Record\")\nIf answer = vbYes Then\nCells(lastrow, 1) = TextBox1.Text\nCells(lastrow, 2) = TextBox2.Text\nCells(lastrow, 3) = TextBox3.Value\nCells(lastrow, 4) = TextBox4.Text\nCells(lastrow, 5) = TextBox5.Text\nEnd If\nEnd If\n</code></pre>\n\n<p>For the code above I just want to get rid of the ID restriction for duplicate IDs. Any help with that will be appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522852363, "post_id": 49653691, "comment_id": 86316059, "body": "you can use the onChange event of each control in the main form to log changes then before the form is closed check that log and ensure the user has filled out the change details"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522853704, "post_id": 49653691, "comment_id": 86317138, "body": "<code>Form.Dirty</code> is True if any changes has been made to current record, so yeah, you can use that to control changes made. Set it up in all AfterUpdate Events of your textboxes, and then something like <code>If Form.Dirty=True Then...</code> and code to force user to put a  Note describing the change, Initials, and NoteDate. More info about <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-dirty-property-access\" rel=\"nofollow noreferrer\">Form.Dirty</a>"}, {"owner": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "edited": false, "score": 0, "creation_date": 1522867271, "post_id": 49653691, "comment_id": 86325540, "body": "Do I have to code an event for every control? Is there any event for when anything in the form is changed, before closing, set focus to the note subform and require a note to be inputted?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522926324, "post_id": 49653691, "comment_id": 86351601, "body": "I&#39;m afraid yes, you must code for all controls that are editable for users. At least, that what&#39;s MSDN says in the website of the link provided."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "edited": false, "score": 0, "creation_date": 1523369798, "post_id": 49668250, "comment_id": 86526834, "body": "Would you be able to show an example code of this? Thanks!"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "reply_to_user": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "edited": false, "score": 0, "creation_date": 1523457873, "post_id": 49668250, "comment_id": 86571333, "body": "Yes sure.  I&#39;ve updated my answer with more details."}], "tags": [], "owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "is_accepted": true, "score": 0, "last_activity_date": 1523474913, "last_edit_date": 1523474913, "creation_date": 1522918907, "answer_id": 49668250, "question_id": 49653691, "link": "https://stackoverflow.com/questions/49653691/is-it-possible-to-required-a-subform-if-main-form-has-been-changed-dirtied/49668250#49668250", "title": "Is it possible to required a subform if main form has been changed/dirtied?", "body": "<p>I have a similar situation, I use a hidden text control on the parent form, and when any of the subforms are updated they change the text in the hidden text control.  Then, when the user tries to save or exit the parent form, I check the hidden control and if it shows updates were made, it opens my pop up form to record the changes that have been made; i.e. your Note, initials and note date.\nif the changes are made only on the parent form controls and not in the subforms, the normal form BeforeUpdate process on the parent form catches the changes and allows you to prompt the user for the required note. \nHTH.</p>\n\n<p><strong>Further details added below</strong></p>\n\n<p>My forms are order forms, and I'm tracking changes to orders that have already been confirmed to the customer.<br>\nOn the main form I have an unbound text control called txtRevToDo.  It is not visible and has no default value.  The sub forms are continuous forms so moving between items on the sub form triggers the AfterUpdate code.</p>\n\n<p>In the sub forms AfterUpdate, on each separate sub form,  I have the following code.  I only capture updates to an order where the order line that changed has a cost.  If there is no cost, I don't need to track the change - </p>\n\n<pre><code>'set the parent form to dirty so that the changes to contract items can be tracked as a revision to the contract\nIf Not IsNull(Me.Cost) Then\nMe.Parent.txtRevToDo = \"Yes\"\nEnd If\n</code></pre>\n\n<p>On the main form, the user clicks on a 'Close' button to exit the form.  In the vba code for the OnClick event of that button control, I check the txtRevToDo with this code, which checks the status and sets the main form to be dirty if any trackable changes have been made on the subforms, and it then forces a save which triggers the main form BeforeUpdate code - </p>\n\n<pre><code>If Me.txtRevToDo = \"Yes\" Then\nMe.txtPaymentTerms.SetFocus\nMe.Dirty = True\nIf Me.Dirty Then Me.Dirty = False\nElse\nDoCmd.Close acForm, \"Edit Contract Details After Issued\"\nEnd If\n</code></pre>\n\n<p>The code in the main form BeforeUpdate which is triggered is this, and this code allows the user to complete the save or go back and make further changes - </p>\n\n<pre><code>'Provide the user with the option to save/undo\n'changes made to the record in the form\n\n\nIf MsgBox(\"Changes have been made to this record.\" _\n        &amp; vbCrLf &amp; vbCrLf &amp; \"Are you ready to save these changes and create the Contract revision? If you have further changes to make, please select 'No'.\" _\n        , vbYesNo, \"Changes Made...\") = vbYes Then\n       'increase the revision number by 1\n        Me.Revision = (Me.Revision + 1)\n        Me.txtContractStatus = \"Revised\"\n            'update the Contract Actions table with a record of the action\n                 strSQLApprove = ....my sql to update my table \n\n            'update this flag to reflect that the contract revision has been captured\n            Me.txtRevToDo = \"\"\n\n            'record the revision reason (this opens my pop up form that captures the changes made)\n            DoCmd.OpenForm \"Edit Contract Revisions\"\n            Forms![Edit Contract Revisions]!ContractNo = Me.ContractNo\n            Forms![Edit Contract Revisions]!txtRevision = Me.Revision\n            Forms![Edit Contract Revisions]!RevisedBy = TempVars!EmpID\n\nElse\n'update this flag so the revision can be captured even if no further changes are actually made\nMe.txtRevToDo = \"Yes\"\n\nEnd If\n</code></pre>\n\n<p>Please let me know if you need any more details, I hope that helps you to work out something similar for your situation. </p>\n"}], "owner": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 49668250, "answer_count": 1, "score": 0, "last_activity_date": 1594022608, "creation_date": 1522852188, "last_edit_date": 1594022608, "question_id": 49653691, "link": "https://stackoverflow.com/questions/49653691/is-it-possible-to-required-a-subform-if-main-form-has-been-changed-dirtied", "title": "Is it possible to required a subform if main form has been changed/dirtied?", "body": "<p>Is there any way to require 3 subform fields if the main form has been dirtied? I've googled this with no results so I'm wondering if this is even possible in Access. </p>\n\n<p>I have a MainForm with 5 subforms. One of the subforms is a NoteSubForm where the user inputs a Note (short text), their Initials (combo box), and the NoteDate (Date/Time). Anytime there are changes/updates to the MainForm, I want to require users to put a Note describing the change, Initials, and NoteDate. </p>\n\n<p>I'm thinking there can be a way using If/Then statements and the Dirty property. </p>\n\n<p>Any suggestions? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 6, "creation_date": 1522852171, "post_id": 49653647, "comment_id": 86315887, "body": "Code between code tags not as a picture please"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522852391, "post_id": 49653647, "comment_id": 86316091, "body": "I am also not clear what you are trying to achieve over time? Are you adding new blocks each quarter?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 5, "creation_date": 1522852509, "post_id": 49653647, "comment_id": 86316188, "body": "Please read about providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and come back to us when you have a more specific and exact programming question with your code. Right now the question kind of reads like: please code this for me."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522852659, "post_id": 49653647, "comment_id": 86316318, "body": "You say <i>I need to be able to see the past 4 quarters and anything beyond the last 4 quarters must be kept</i>. This is confusing. So you need just the last 4 quarters or ALL of them?"}, {"owner": {"reputation": 1, "user_id": 9596679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d12cf91b44a8d45b27055ecb2713299?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9596679/adam"}, "edited": false, "score": 0, "creation_date": 1522915799, "post_id": 49653647, "comment_id": 86344350, "body": "That&#39;s correct, I need to SEE the last 4 quarters (as in they must be visible) but I also need to keep anything beyond that but don&#39;t want them visible (as shown in my example).  I&#39;m not sure how much more specific I can be. I&#39;ve provided an example of what I need it to look like and the code I&#39;ve currently got. What more do you need?"}, {"owner": {"reputation": 1, "user_id": 9596679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d12cf91b44a8d45b27055ecb2713299?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9596679/adam"}, "edited": false, "score": 0, "creation_date": 1522916217, "post_id": 49653647, "comment_id": 86344606, "body": "The main problem seems to be with the insert so let&#39;s look at that first:  In the example I provided, I need to insert a new column before D, N and W. However, after inserting the column before column D, N then becomes O and W becomes X.  I need to code this in a way that the insert does not have a knock on affect to the rest of the changes but I&#39;m not sure if this is possible?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522931613, "post_id": 49653647, "comment_id": 86355369, "body": "Adam, you have to go in reverse order when deleting/inserting.  You start with the last as to not change the column number/letter of the subsequent columns.  E.g., Insert to column 26 (&quot;Z&quot;) makes the old Z column now column 27 (&quot;AA&quot;)/"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9596679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d12cf91b44a8d45b27055ecb2713299?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9596679/adam"}, "edited": false, "score": 0, "creation_date": 1522937860, "post_id": 49672632, "comment_id": 86360068, "body": "OK, so i&#39;ll insert the columns in reverse. That&#39;ll help me for this quarter. However, when I come back to it next quarter, I&#39;ll still have the same problem."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1, "user_id": 9596679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d12cf91b44a8d45b27055ecb2713299?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9596679/adam"}, "edited": false, "score": 0, "creation_date": 1522939433, "post_id": 49672632, "comment_id": 86361288, "body": "@Adam with what you&#39;re doing, the insert in reverse is the key.  Your bigger issue is finding the correct cell to insert.  You have called out specific columns, which are going to change.  You will need to dynamically determine the column to insert, for each table.  I would recommend Find or FindNext to get to the correct cells, since you&#39;re using the same set-up for each table."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1522931895, "creation_date": 1522931895, "answer_id": 49672632, "question_id": 49653647, "link": "https://stackoverflow.com/questions/49653647/how-do-i-prevent-an-insert-from-impacting-the-rest-of-my-vba-code/49672632#49672632", "title": "How do I prevent an insert from impacting the rest of my VBA code?", "body": "<p>Example of deletion in a loop, which should make more sense than just seeing other items inserted in individual lines of code (untested, top of head code)</p>\n\n<pre><code>Dim i as long, lr as long\nlr = cells(rows.count,1).end(xlup).row 'dynamic last row\nFor i = lr to 2 Step -2 'each loop goes BACKWARDS by counts of 2\n    Rows(i).delete 'every other row, from the last row until 2 is deleted\nNext i \n</code></pre>\n\n<p>Had I put the above code to read For i = 2 to lr Step 1, it would increase the row number 1 for every deletion, meaning that i would first delete row 2 (makes old row 4 now row 3), then deletes old row 5 (in the 4 position), etc.</p>\n\n<p>Similar if you do this for insert, you would push the other rows further down, so each insert would be in the incorrect place.</p>\n"}], "owner": {"reputation": 1, "user_id": 9596679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d12cf91b44a8d45b27055ecb2713299?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9596679/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1522931895, "creation_date": 1522852063, "last_edit_date": 1522918215, "question_id": 49653647, "link": "https://stackoverflow.com/questions/49653647/how-do-i-prevent-an-insert-from-impacting-the-rest-of-my-vba-code", "title": "How do I prevent an insert from impacting the rest of my VBA code?", "body": "<p>Every quarter I need to input the amount of each product we have and then compare this to the previous quarter. </p>\n\n<p>I need to be able to see the past 4 quarters. However, anything beyond the last 4 quarters must be kept (but not visible). So far, I've done this by grouping them. This means that if someone wants to see all of the information, they can. The most recent quarter also needs to be formatted differently to the rest (see images below).</p>\n\n<p><strong>To keep things simple, below is a very basic example of what I'm looking for.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/bGdyA.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/bGdyA.png</a></p>\n\n<p>So far, this is what I've got. However, this doesn't work perfectly because once it inserts the new column, all of the columns referenced are no longer correct:</p>\n\n<pre><code>Columns(\"D:D\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nColumns(\"B:C\").Select\nSelection.Copy\nColumns(\"C:C\").Select\nActiveSheet.Paste\n\nColumns(\"D:D\").Select\nSelection.AutoFill Destination:=Columns(\"C:D\"), Type:=xlFillFormats\n\nColumns(\"B:B\").Select\nSelection.ClearContents\n\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"Q2_18\"\nRange(\"L1\").Select\nActiveCell.FormulaR1C1 = \"=RC[-10]\"\nRange(\"U1\").Select\nActiveCell.FormulaR1C1 = \"=RC[-19]\"\n\n\nColumns(\"G:H\").Select\nSelection.Columns.Ungroup\nColumns(\"F:H\").Select\nSelection.Columns.Group\n</code></pre>\n\n<p>The main problem seems to be with the insert. In this example, I need to insert a new column before D, N and W. However, after inserting the column before column D, column N then becomes O and column W becomes X. I need to code this in a way that the insert does not have a knock on affect to the rest of the changes but I'm not sure if this is possible?</p>\n\n<p>It can take the best part of an hour to format all of the tables and that's before even looking at any of the figures. Therefore, any help would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522851684, "post_id": 49653460, "comment_id": 86315483, "body": "Why do you have an extra <code>&amp; &quot;</code> after <code>&quot;&quot;EBF&quot;&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522860017, "post_id": 49653515, "comment_id": 86321403, "body": "Thank you for this code snippet, which might provide some limited, immediate help. A <a href=\"//meta.stackexchange.com/q/114762/206345\">proper explanation would greatly improve its long-term value</a> by showing <i>why</i> this is a good solution to the problem, and would make it more useful to future readers with other, similar questions. Please <a href=\"https://stackoverflow.com/posts/49653515/edit\">edit</a> your answer to add some explanation, including the assumptions you&#39;ve made."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1522851690, "creation_date": 1522851690, "answer_id": 49653515, "question_id": 49653460, "link": "https://stackoverflow.com/questions/49653460/string-inside-an-excel-vba-formula/49653515#49653515", "title": "String inside an excel vba formula", "body": "<p><code>\"=D7-IFERROR(VLOOKUP(A7&amp;\"\"EBF\"\",sheet1!A2:B31,2,FALSE),0)\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1522851876, "post_id": 49653558, "comment_id": 86315645, "body": "And decide if it is CAF or EBF"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1522851800, "creation_date": 1522851800, "answer_id": 49653558, "question_id": 49653460, "link": "https://stackoverflow.com/questions/49653460/string-inside-an-excel-vba-formula/49653558#49653558", "title": "String inside an excel vba formula", "body": "<p>Like (Remembering to use the .Formula to assign)</p>\n\n<pre><code>Range(\"H7\").Formula = \"=D7-IFERROR(VLOOKUP(A7 &amp; \"\"CAF\"\" ,sheet1!A2:B31,2,FALSE),0)\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9272915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b8d44cda47579a2f52eb1200c9c2b8?s=128&d=identicon&r=PG&f=1", "display_name": "sysonic", "link": "https://stackoverflow.com/users/9272915/sysonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 49653558, "answer_count": 2, "score": 0, "last_activity_date": 1522851800, "creation_date": 1522851529, "question_id": 49653460, "link": "https://stackoverflow.com/questions/49653460/string-inside-an-excel-vba-formula", "title": "String inside an excel vba formula", "body": "<p>I have a VBA code that insert the formula below in a cell.\nI want to combine A7 and string \"EBF\" into one string inside the VLOOKUP formula but it seems to keep giving me error.</p>\n\n<p>This is what I want in the excel cell:</p>\n\n<p>=D7-IFERROR (VLOOKUP (A7&amp;\"CAF\",sheet1!A1:B31,2,FALSE),0)</p>\n\n<p>This is my VBA Code to insert the formula into the cell:</p>\n\n<pre><code>Range(\"H7\") = \"=D7-IFERROR(VLOOKUP(A7 &amp; \"\"EBF\"\" &amp; \",sheet1!A2:B31,2,FALSE),0)\"\n</code></pre>\n"}, {"tags": ["ms-access", "ms-word", "vba"], "comments": [{"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1522851614, "post_id": 49653426, "comment_id": 86315423, "body": "Maybe add &#39; On Error Resume Next &#39; before your IF statement .."}, {"owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "edited": false, "score": 0, "creation_date": 1522852338, "post_id": 49653426, "comment_id": 86316036, "body": "Post more of the code so we can give more specific advice.Is the document opened in a loop?"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1522854516, "last_edit_date": 1522854516, "creation_date": 1522852104, "answer_id": 49653666, "question_id": 49653426, "link": "https://stackoverflow.com/questions/49653426/if-word-activedocument-exists-close-it-vba/49653666#49653666", "title": "If word.ActiveDocument exists close it [VBA]", "body": "<p>You can check if there are open documents in the following way:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If word.Documents.Count Then '0 is falsy, all other values are truthy\n      word.ActiveDocument.Close SaveChanges:=wdSaveChanges\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6242134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ca720e8a39296ae009b8c3bdfc7c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6242134/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 49653666, "answer_count": 1, "score": 0, "last_activity_date": 1594636145, "creation_date": 1522851441, "last_edit_date": 1594636145, "question_id": 49653426, "link": "https://stackoverflow.com/questions/49653426/if-word-activedocument-exists-close-it-vba", "title": "If word.ActiveDocument exists close it [VBA]", "body": "<p>Here's my code:</p>\n\n<pre><code>    If Not (word.ActiveDocument Is Nothing) Then\n          word.ActiveDocument.Close SaveChanges:=wdSaveChanges\n    End If\n</code></pre>\n\n<p>I get an error if there is no active document. How can I prevent this? </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 363, "user_id": 8853275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eF7kmwnaDMo/AAAAAAAAAAI/AAAAAAAAD7w/BWrknx4Mvpc/photo.jpg?sz=128", "display_name": "Nelson Vides", "link": "https://stackoverflow.com/users/8853275/nelson-vides"}, "edited": false, "score": 0, "creation_date": 1522849996, "post_id": 49652635, "comment_id": 86314100, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2319683/vba-macro-on-timer-style-to-run-code-every-set-number-of-seconds-i-e-120-secon\">VBA Macro On Timer style to run code every set number of seconds, i.e. 120 seconds</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 363, "user_id": 8853275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eF7kmwnaDMo/AAAAAAAAAAI/AAAAAAAAD7w/BWrknx4Mvpc/photo.jpg?sz=128", "display_name": "Nelson Vides", "link": "https://stackoverflow.com/users/8853275/nelson-vides"}, "edited": false, "score": 0, "creation_date": 1522850173, "post_id": 49652635, "comment_id": 86314262, "body": "@NelsonVides Not a dupe, that&#39;s Excel-specific code and won&#39;t work in Access"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522851611, "post_id": 49652832, "comment_id": 86315421, "body": "How can i use this for kind of a loop then? as im trying to let the function run every 30 seconds from the beginning on..."}, {"owner": {"reputation": 560, "user_id": 9513937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvf4N.jpg?s=128&g=1", "display_name": "sunsetsurf", "link": "https://stackoverflow.com/users/9513937/sunsetsurf"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522852440, "post_id": 49652832, "comment_id": 86316135, "body": "The code &quot;Me.TimerInterval = 1000&quot; is the loop.  1000=1sec. Thus, 30000=30seconds. &quot;Me.TimerInterval = 30000&quot;"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522852578, "post_id": 49652832, "comment_id": 86316253, "body": "oh okay so I can then use the sub From_timer and put my code in there but how does it then run it and start over again? (as I sayed im not that good at VBA sorry)"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522909113, "post_id": 49652832, "comment_id": 86340474, "body": "hi @sunsetsurf thanks for this awesome instruction! the Pause function part works perfect! i do then get an error tho from the module after the caled function has endet... i get this errormessage: Subscript out of range (Error 9) any idea how i can fix this last part? :)"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522922848, "post_id": 49652832, "comment_id": 86349159, "body": "i kind of fixed the error but i found out that it does not loop &quot;infinitif&quot; the function just ends... i tryed it with an goto above the pause(time) and eaven I tryed to call the makro again what also didn&#39;t work... :( any idea?"}, {"owner": {"reputation": 560, "user_id": 9513937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvf4N.jpg?s=128&g=1", "display_name": "sunsetsurf", "link": "https://stackoverflow.com/users/9513937/sunsetsurf"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522923028, "post_id": 49652832, "comment_id": 86349269, "body": "Did you alter the code, or include it with other code? &quot;Subscript out of range&quot; is an index of an array or collection doesn&#39;t exist; ex: array index range is 0-9, but 1-10 was called."}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1522924106, "post_id": 49652832, "comment_id": 86350102, "body": "i just goth it runing &lt;3 XD now its onl my code that has to reset all the variables after the loop :) do you know how i do that?^^ thanks for everithing man!!"}], "tags": [], "owner": {"reputation": 560, "user_id": 9513937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvf4N.jpg?s=128&g=1", "display_name": "sunsetsurf", "link": "https://stackoverflow.com/users/9513937/sunsetsurf"}, "is_accepted": true, "score": 3, "last_activity_date": 1522932907, "last_edit_date": 1522932907, "creation_date": 1522849944, "answer_id": 49652832, "question_id": 49652635, "link": "https://stackoverflow.com/questions/49652635/run-vba-function-every-30-seconds-from-startupaccess/49652832#49652832", "title": "Run VBA Function every 30 seconds (from startup)(Access)", "body": "<p>You could consider using the <strong>Form's TimerInterval property</strong>. You could open a form (hidden) and have the timer trigger the code.</p>\n\n<p><strong>Example</strong><br>\nThe following example shows how to create a flashing button on a form by displaying and hiding an icon on the button. The <em>form's Load event procedure sets the form's TimerInterval property</em> to 1000 so the icon display is toggled once every second.</p>\n\n<pre><code>Sub Form_Load() \n    Me.TimerInterval = 1000 \nEnd Sub \n\nSub Form_Timer() \n    Static intShowPicture As Integer \n    If intShowPicture Then \n        ' Show icon. \n        Me!btnPicture.Picture = \"C:\\Icons\\Flash.ico\" \n    Else \n        ' Don't show icon. \n        Me!btnPicture.Picture = \"\" \n    End If \n    intShowPicture = Not intShowPicture \nEnd Sub\n</code></pre>\n\n<p><strong>To use this sample code:</strong><br>\n<strong>Note:</strong> Your screen will look different based on version you are using.<br>\nYou can Google: access me.timerinterval examples.<br></p>\n\n<ol>\n<li>Enable macros by clicking options | enable this content | OK.<a href=\"https://i.stack.imgur.com/lOhM0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lOhM0.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/lygnO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lygnO.png\" alt=\"enter image description here\"></a></li>\n<li>Create new blank form and view in design view.<a href=\"https://i.stack.imgur.com/3IMWc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3IMWc.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/0r1xv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0r1xv.png\" alt=\"enter image description here\"></a><br></li>\n<li><p>Add command button | cancel wizard | delete caption | name it btnPicture.<a href=\"https://i.stack.imgur.com/HctzY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HctzY.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/dOVWS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dOVWS.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/SrCqt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SrCqt.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/FaKBf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FaKBf.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Add form event procedures.<br>\nA. Deselect button and select form properties.<br>\nB. Click event loader for form in the property sheet.<br>\nC. Double click Code Builder.<br>\nD. Select all and then paste code from here.\n<a href=\"https://i.stack.imgur.com/Q40Eb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q40Eb.png\" alt=\"enter image description here\"></a></p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/GWkye.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GWkye.png\" alt=\"enter image description here\"></a></p>\n\n<p><br><br></p>\n\n<hr>\n\n<p><strong>FYI:</strong><br>\nFor the code mmehta did; you would put it in a module. <br>\nHe showed you how to extend on your thought process.<br>\nYou suggested:</p>\n\n<pre><code>Function Import_files\n    do every 30 seconds \n    run code\n    if needed reset any variables \n</code></pre>\n\n<blockquote>\n<pre><code>        myVariableInteger = 0\n        myVariableString = \"\"\n        myVariableString= vbNullString\n        myVariableInteger = Null\n        Set myVariableObject = Nothing\n</code></pre>\n</blockquote>\n\n<pre><code>    loop\nend function\n</code></pre>\n\n<p>He elaborated:</p>\n\n<pre><code>Function Import_files\n  Do\n    Pause(30)\n    run code (You're code here or better yet put your code in a sub routine and call the routine.)\n  Loop\nEnd Function\n</code></pre>\n\n<hr>\n\n<ol>\n<li><p>Put this code in a module</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Function Pause(NumberOfSeconds As Variant)\nOn Error GoTo Error_GoTo\n\nDim PauseTime As Variant\nDim Start As Variant\nDim Elapsed As Variant\n\nPauseTime = NumberOfSeconds\nStart = Timer\nElapsed = 0\nDo While Timer &lt; Start + PauseTime\n    Elapsed = Elapsed + 1\n    If Timer = 0 Then\n        ' Crossing midnight\n        PauseTime = PauseTime - Elapsed\n        Start = 0\n        Elapsed = 0\n    End If\n    DoEvents\nLoop\n\nExit_GoTo:\n    On Error GoTo 0\n    Exit Function\nError_GoTo:\n    Debug.Print Err.Number, Err.Description, Erl\n    GoTo Exit_GoTo\nEnd Function\n\nSub msgUser()\n    Dim x As Integer\n    x = MsgBox(\"Click 'OK' to continue.\", vbOKOnly, \"Ready?\")\nEnd Sub\n</code></pre></li>\n<li><p>Place your cursor in the routine Pause and press play.<a href=\"https://i.stack.imgur.com/6wCqt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6wCqt.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Watch the msgBox pop up every 30 seconds.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "is_accepted": false, "score": 0, "last_activity_date": 1522853292, "last_edit_date": 1522853292, "creation_date": 1522851057, "answer_id": 49653275, "question_id": 49652635, "link": "https://stackoverflow.com/questions/49652635/run-vba-function-every-30-seconds-from-startupaccess/49653275#49653275", "title": "Run VBA Function every 30 seconds (from startup)(Access)", "body": "<p>Try the below function for timer.</p>\n\n<pre><code>Function Import_files\n      Do\n            Pause(30)\n            run code\n      Loop\nend function\n\nPublic Function Pause(NumberOfSeconds As Variant)\n    On Error GoTo Error_GoTo\n\n    Dim PauseTime As Variant\n    Dim Start As Variant\n    Dim Elapsed As Variant\n\n    PauseTime = NumberOfSeconds\n    Start = Timer\n    Elapsed = 0\n    Do While Timer &lt; Start + PauseTime\n        Elapsed = Elapsed + 1\n        If Timer = 0 Then\n            ' Crossing midnight\n            PauseTime = PauseTime - Elapsed\n            Start = 0\n            Elapsed = 0\n        End If\n        DoEvents\n    Loop\n\nExit_GoTo:\n    On Error GoTo 0\n    Exit Function\nError_GoTo:\n    Debug.Print Err.Number, Err.Description, Erl\n    GoTo Exit_GoTo\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2346, "favorite_count": 0, "accepted_answer_id": 49652832, "answer_count": 2, "score": 0, "last_activity_date": 1522932907, "creation_date": 1522849438, "last_edit_date": 1522851910, "question_id": 49652635, "link": "https://stackoverflow.com/questions/49652635/run-vba-function-every-30-seconds-from-startupaccess", "title": "Run VBA Function every 30 seconds (from startup)(Access)", "body": "<p>So i have my code that should be executed when i start my access DB \n(it imports files from a folder)</p>\n\n<pre><code>Function import_files\n'all the code (works without errors)\nend function\n</code></pre>\n\n<p>My idea was a Macro that runs on startup then opens the function and uses</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:30\"), \"import_files\"\n</code></pre>\n\n<p>that of corse did not work because its not compatible with access... so you can use it like this:</p>\n\n<pre><code>Excel.Application.OnTime Now + TimeValue(\"00:00:30\"), \"import_files\"\n</code></pre>\n\n<p>just that u cant run anything from then on...</p>\n\n<p>is there any simple short solution to this</p>\n\n<p>someting basic like this</p>\n\n<pre><code>Function Import_files\ndo every 30 seconds \nrun code\nloop\nend function\n</code></pre>\n\n<p>Thanks for any help!\n(Im not that good in VBA :) )</p>\n"}, {"tags": ["vba", "shell", "command-line", "rscript"], "comments": [{"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1522850231, "post_id": 49652606, "comment_id": 86314319, "body": "You should concate the string you want to execute in a variable and make sure to add <code>&quot;</code> around all strings with <code>spaces</code>. A visible <code>&quot;</code> can be added by <code>&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 121, "user_id": 6493038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2006a8d2a54ed56fd7f7dd3aca06385b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6493038/sam"}, "reply_to_user": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1522854097, "post_id": 49652606, "comment_id": 86317457, "body": "@FloLie I have done that. I adjusted the code to make it clear. In the print-out, all 3 parts of the command are enclosed in quotes, as one would do in the shell directly. However, that does still not work (&quot;C:\\Program not recognized&quot;)."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1522855388, "post_id": 49652606, "comment_id": 86318414, "body": "You might try assigning Chr(34) to the QUOTE variable. BUT... If you type the entire thing in.literally, without variables, does it run? Figure that out, first, then try breaking it down..."}, {"owner": {"reputation": 121, "user_id": 6493038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2006a8d2a54ed56fd7f7dd3aca06385b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6493038/sam"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522856754, "post_id": 49652606, "comment_id": 86319459, "body": "@Cindy Meister Typing the whole command directly into an open shell window works. Executing WS_Shell.Run with the literal string does not. Calling .Run with the path and no or only unquoted arguments works as well. However, I need to be able to pass args containing spaces."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 6493038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2006a8d2a54ed56fd7f7dd3aca06385b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6493038/sam"}, "edited": false, "score": 0, "creation_date": 1522912595, "post_id": 49655307, "comment_id": 86342366, "body": "Thank you for your answer. Your code works and has helped me figure out that the problem seems to be the &quot;cmd.exe /K &quot; part of the command string (see update of the question). So, how do you get the shell window to stay open after the script has run (for testing/debugging)?"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 121, "user_id": 6493038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2006a8d2a54ed56fd7f7dd3aca06385b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6493038/sam"}, "edited": false, "score": 0, "creation_date": 1522939623, "post_id": 49655307, "comment_id": 86361434, "body": "Use <code>Sys.sleep(time)</code>  at the end of your R script to stop the shell window to close, example <code>Sys.sleep(60)</code> for 60 seconds, If you found my answer helpfull please mark it as an acceptable answer! :)"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 5, "last_activity_date": 1522857392, "last_edit_date": 1522857392, "creation_date": 1522856759, "answer_id": 49655307, "question_id": 49652606, "link": "https://stackoverflow.com/questions/49652606/wscript-shell-to-run-a-script-with-spaces-in-path-and-arguments-from-vba/49655307#49655307", "title": "WScript.Shell to run a script with spaces in path and arguments from VBA", "body": "<p><a href=\"https://i.stack.imgur.com/AEKq9.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/AEKq9.png\" alt=\"enter image description here\"></a>I used to run scripts and pass arguments from Excel, this code works for me.</p>\n\n<p>In order to run the script is very important that you first specify the path of your Rscript.exe and the path of your R script (.r file), then you can pass the arguments with spaces.</p>\n\n<pre><code>Sub run_R()\n\n    Dim shell As Object\n    Set shell = VBA.CreateObject(\"WScript.Shell\")\n    Dim waitTillComplete As Boolean: waitTillComplete = True\n    Dim style As Integer: style = 1\n    Dim errorcode As Integer\n    Dim path As String\n\n    path = Chr(34) &amp; \"C:\\R\\R-3.4.0\\bin\\i386\\Rscript.exe\" &amp; Chr(34) &amp; \" \" &amp; Chr(34) &amp; \"C:\\Users\\userexample\\Desktop\\accionable.r\" &amp; Chr(34) &amp; \" \" &amp; Chr(34) &amp; \"Argument 1\" &amp; Chr(34)\n\n    errorcode = shell.Run(path, style, waitTillComplete)\n\nEnd Sub\n</code></pre>\n\n<p>R code to read the arguments:</p>\n\n<pre><code>args = commandArgs(trailingOnly = T)\ncat(args[1])\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6493038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2006a8d2a54ed56fd7f7dd3aca06385b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6493038/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3581, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1538752302, "creation_date": 1522849372, "last_edit_date": 1522912757, "question_id": 49652606, "link": "https://stackoverflow.com/questions/49652606/wscript-shell-to-run-a-script-with-spaces-in-path-and-arguments-from-vba", "title": "WScript.Shell to run a script with spaces in path and arguments from VBA", "body": "<p>I need to call a script (R) from VBA using the WScript.Shell. The path to the file contains spaces. Additionally, a series of arguments is passed to the script, of which several also contain spaces.</p>\n\n<p>I have tried all thinkable combinations of quotes and double quotes around paths, arguments or even the whole string (notably <a href=\"https://stackoverflow.com/questions/14360599/vbs-with-space-in-file-path\">this here</a>). Nothing seems to work when arguments need to be passed (I either get \"C:\\Program\" not recognized\"- or \"invalid-syntax\"-errors in the command line).</p>\n\n<pre><code>Option Explicit\nPrivate Const QUOTE As String = \"\"\"\"\n\nSub test()\n    Dim WS_Shell As Object\n    Set WS_Shell = VBA.CreateObject(\"WScript.Shell\")\n    Dim err_code As Long\n\n    Dim path As String\n    Dim arg_1 As String\n    Dim arg_2_with_spaces As String\n\n    Dim complete_cmd_str As String\n\n    path = \"C:\\Program Files\\R\\R-3.3.2\\bin\\Rscript.exe\"\n    arg_1 = \"F:\\path\\to\\my\\script.R\"\n    arg_2_with_spaces = \"A string-arg with spaces\"\n\n    complete_cmd_str = \"cmd.exe /K \" &amp; QUOTE &amp; path &amp; QUOTE &amp; \" \" _\n                    &amp; QUOTE &amp; arg_1 &amp; QUOTE &amp; \" \" _\n                    &amp; QUOTE &amp; arg_2_with_spaces &amp; QUOTE\n\n    Debug.Print complete_cmd_str\n    err_code = WS_Shell.Run(complete_cmd_str, vbMinimizedNoFocus, True)\nEnd Sub\n</code></pre>\n\n<p>All of this is happening on Windows 7.</p>\n\n<p>How can i run a command line script with spaces both in path and in the arguments to be passed? Any help greatly appreciated!</p>\n\n<h2>Update:</h2>\n\n<p>The code works if the prefix \"cmd.exe /K \" is removed from the command string. However, for testing and debugging, I would like to keep the shell window open once the script has run. How can this be achieved?</p>\n"}, {"tags": ["excel", "excel-2010", "dashboard", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522849948, "post_id": 49652122, "comment_id": 86314064, "body": "Use a PivotTable and a PivotChart?  With a Page Filter for &quot;IN&quot;, this should do exactly what you want."}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522852712, "post_id": 49652122, "comment_id": 86316362, "body": "@Chronocidal, thank you for the advice! Actually, the filter is the filter is not a problem I guess, the issue I have is to address the correct colors to the correct series"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522853068, "post_id": 49652122, "comment_id": 86316681, "body": "Is there a problem with Else clauses <code>Worksheets(&quot;NatCo Dashboard&quot;).ChartObjects(&quot;Chart 9&quot;).Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)</code>? This is setting them to grey?"}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522854345, "post_id": 49652122, "comment_id": 86317646, "body": "@SJR, that is correct, I have changed the indexes and its partially working, trying to figure out the rest"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522854923, "post_id": 49652122, "comment_id": 86318090, "body": "Can you post a shot of the chart before the code?"}], "owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522847991, "creation_date": 1522847991, "last_edit_date": 1531161705, "question_id": 49652122, "link": "https://stackoverflow.com/questions/49652122/excel-vba-changing-chart-series-color-for-a-dynamic-table-based-on-specific-par", "title": "Excel-VBA: changing chart series color for a dynamic table based on specific parameters", "body": "<p>I have the following issue in Excel:</p>\n\n<p>I have a dynamic table that will feed a graph (stacked area), the results of the lookup function return a table that will hide the values which are \"empty\"</p>\n\n<p>The issue here is that for different chosen parameters (country), I get a different number of data series (market players) and in a different order. </p>\n\n<p>I have a helper column in that table which returns a value in the same line as the company that I want in a different color. </p>\n\n<p><a href=\"https://i.stack.imgur.com/YAVgN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YAVgN.png\" alt=\"enter image description here\"></a>\nI have some space in the table due to the possibility of having more MPs, then the table is filtered and the graph is generated. </p>\n\n<p>The issue is that I am trying to first: <strong>count the series, so I will not have an error for trying to reference missing series on the VBA (e.g. when I have code for 5 series but the lookup only returns three)</strong>. and second: <strong>Identify the row with the company name on it (DT) and make it an specific color in the chart and the others will be different shades of gray</strong></p>\n\n<p>What I am trying to do is (only parts of it because there is no space for everything):</p>\n\n<pre><code>    'Only display non-zero values in the chart chart\n    Sheets(\"Financials\").ListObjects(\"Table2\").Range.AutoFilter Field:=7\n    Sheets(\"Financials\").ListObjects(\"Table2\").Range.AutoFilter Field:=7, Criteria1:= _\n            \"IN\"\n\n    Dim iSrs As Long, nSrs As Long\n\n    If Sheets(\"Financials\").Range(\"f98\") = \"\" Then\n        GoTo EndPie:\n    End If\n\n    With Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\")\n        nSrs = Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection.Count\n        For iSrs = 1 To nSrs\n            Select Case nSrs\n                Case 1\n                    Select Case Sheets(\"Financials\").Range(\"m98\")\n                        Case \"DT\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(226, 0, 116)\n                        Case \"Orange\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(255, 153, 0)\n                        Case \"EE\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(52, 161, 160)\n                        Case Else\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                    End Select\n                Case 2\n                    Select Case Sheets(\"Financials\").Range(\"m98\")\n                        Case \"DT\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(226, 0, 116)\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Case \"Orange\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(255, 153, 0)\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Case \"EE\"\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(52, 161, 160)\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Case Else\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                            Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(190, 190, 190)\nEnd Select\n                Select Case Sheets(\"Financials\").Range(\"m99\")\n                    Case \"DT\"\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(226, 0, 116)\n                    Case \"Orange\"\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(255, 153, 0)\n                    Case \"EE\"\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(52, 161, 160)\n                    Case Else\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(217, 217, 217)\n                        Worksheets(\"NatCo Dashboard\").ChartObjects(\"Chart 9\").Chart.SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = RGB(190, 190, 190)\n                End Select\n            Case 3\n</code></pre>\n\n<p>Then it goes like this until Case 5 (max number possible)</p>\n\n<p>The problem is that eventually, the chart turns everything into grey, \n<a href=\"https://i.stack.imgur.com/cO34A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cO34A.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know what I could be doing wrong or even a better or more appropriate (cleaner) way for doing this? </p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522847611, "post_id": 49651965, "comment_id": 86312131, "body": "Share the import specification. That&#39;s where it&#39;s specified if your file is semicolon-delimited or comma-delimited."}, {"owner": {"reputation": 63, "user_id": 6878556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205162051809281/picture?type=large", "display_name": "Rudi Bloes", "link": "https://stackoverflow.com/users/6878556/rudi-bloes"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522847817, "post_id": 49651965, "comment_id": 86312310, "body": "It&#39;s semicolon-delimited"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522847856, "post_id": 49651965, "comment_id": 86312347, "body": "And where have you specified that in the import specification? As said, share the import specification."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6878556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205162051809281/picture?type=large", "display_name": "Rudi Bloes", "link": "https://stackoverflow.com/users/6878556/rudi-bloes"}, "edited": false, "score": 0, "creation_date": 1522907810, "post_id": 49656966, "comment_id": 86339896, "body": "Thanks a lot! This did the trick, I forgot the parentheses. Shame on me..."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 63, "user_id": 6878556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205162051809281/picture?type=large", "display_name": "Rudi Bloes", "link": "https://stackoverflow.com/users/6878556/rudi-bloes"}, "edited": false, "score": 0, "creation_date": 1522929168, "post_id": 49656966, "comment_id": 86353605, "body": "@RudiBloes You&#39;re welcome (I&#39;m assuming you meant double-quotes, not parentheses). Please mark my answer as the solution if it answered your question, so that the question appears as resolved for others browsing the open questions."}, {"owner": {"reputation": 63, "user_id": 6878556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205162051809281/picture?type=large", "display_name": "Rudi Bloes", "link": "https://stackoverflow.com/users/6878556/rudi-bloes"}, "edited": false, "score": 0, "creation_date": 1523088739, "post_id": 49656966, "comment_id": 86423876, "body": "Yes of course. I mix up languages sometimes. \u201cEntre parentheses\u201d Thanks again. I marked the answer."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1522862737, "creation_date": 1522862737, "answer_id": 49656966, "question_id": 49651965, "link": "https://stackoverflow.com/questions/49651965/ms-access-vba-docmd-transfertext-how-to-separate-columns/49656966#49656966", "title": "MS Access VBA DoCmd.TransferText How to Separate Columns?", "body": "<p>Is <code>specNote</code> a variable or the name of your specification?</p>\n\n<p>If the latter, try:</p>\n\n<pre><code>DoCmd.TransferText _\nTransferType:=acImportDelim, _\nSpecificationName:=\"specNote\", _\nTableName:=\"tblImport\", _\nFileName:=\"K:\\path\\file.csv\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6878556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205162051809281/picture?type=large", "display_name": "Rudi Bloes", "link": "https://stackoverflow.com/users/6878556/rudi-bloes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2346, "favorite_count": 0, "accepted_answer_id": 49656966, "answer_count": 1, "score": 0, "last_activity_date": 1594636125, "creation_date": 1522847518, "last_edit_date": 1594636125, "question_id": 49651965, "link": "https://stackoverflow.com/questions/49651965/ms-access-vba-docmd-transfertext-how-to-separate-columns", "title": "MS Access VBA DoCmd.TransferText How to Separate Columns?", "body": "<p>The following line should import a semi-colon <code>;</code> delimited <code>.csv</code> text file to a table. </p>\n\n<pre><code>DoCmd.TransferText TransferType:=acImportDelim, SpecificationName:=specNote, TableName:=\"tblImport\", FileName:=\"K:\\path\\file.csv\" \n</code></pre>\n\n<p>However this puts all the fields in one field. </p>\n\n<p>What is going wrong here?</p>\n\n<p>Any suggestions?</p>\n\n<p>I specified  </p>\n\n<ul>\n<li>File format: Delimited</li>\n<li>Field delimiter: <code>;</code></li>\n</ul>\n\n<p>I set this through the import wizard and saved this specification. With the wizard all went good.</p>\n\n<p>I want to share the specification but I dont know how to do that?</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1522849032, "post_id": 49652020, "comment_id": 86313301, "body": "Wow, so simple :/ This is perfect Thank you SJR :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522847686, "creation_date": 1522847686, "answer_id": 49652020, "question_id": 49651949, "link": "https://stackoverflow.com/questions/49651949/vba-copy-data-to-master-sheet-and-insert-sheet-name-next-to-each-row/49652020#49652020", "title": "VBA - Copy Data to Master Sheet and Insert Sheet Name Next to Each Row", "body": "<p>Instead of</p>\n\n<p><code>Set CopyRng = sh.Range(\"A:B\")</code></p>\n\n<p>try</p>\n\n<pre><code>Set CopyRng = sh.Range(\"A1\", sh.Range(\"B\" &amp; Rows.Count).End(xlUp))\n</code></pre>\n\n<p>as the former covers every row of the worksheet, hence the message box and the name running down the whole sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1522848317, "creation_date": 1522848317, "answer_id": 49652236, "question_id": 49651949, "link": "https://stackoverflow.com/questions/49651949/vba-copy-data-to-master-sheet-and-insert-sheet-name-next-to-each-row/49652236#49652236", "title": "VBA - Copy Data to Master Sheet and Insert Sheet Name Next to Each Row", "body": "<p>Something like:</p>\n\n<pre><code>Option Explicit\n\nSub CopySheetNameToColumn()\n\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    For Each sh In ActiveWorkbook.Worksheets\n\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            Last = GetLastRow(DestSh, 1)\n\n            With sh\n                Set CopyRng = sh.Range(\"A1:B\" &amp; GetLastRow(sh, 1))\n            End With\n\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            Else\n\n               CopyRng.Copy IIf(Last = 1, DestSh.Cells(1, \"B\"), DestSh.Cells(Last + 1, \"B\"))\n\n            End If\n\n            If Last = 1 Then\n                DestSh.Cells(Last, \"A\").Resize(CopyRng.Rows.Count).Value = sh.Name\n            Else\n                 DestSh.Cells(Last + 1, \"A\").Resize(CopyRng.Rows.Count).Value = sh.Name\n            End If\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n\n    With ws\n\n      GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n\n    End With\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522848954, "post_id": 49652243, "comment_id": 86313237, "body": "Thank you for the time and code @Cyril. I tried it, and get error at the first line immediately after the with statement. Object defined error."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522849208, "post_id": 49652243, "comment_id": 86313441, "body": "@EitelDagnin I tested it and fixed the issue.  Should do the entire thing for your other multi-line."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522850236, "post_id": 49652243, "comment_id": 86314326, "body": "Thank you @Cyril it works great, just two issues: 1) After the range is copied to the master sheet, two blank rows are inserted (which is not the problem) but then in Column A, the sheet name is also inserted there. 2) There&#39;s an End If inside the With block that caused the code to break."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522852560, "post_id": 49652243, "comment_id": 86316242, "body": "@EitelDagnin Good catch with the End If... I had commented an if statement out (including that line) and didn&#39;t remove the whole line of code when I pasted into stack overflow.  Regarding the 2 blank rows, if the sheet name is being pasted as well, then i would say there are two blank rows being counted as part of the copied source range."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1522852407, "last_edit_date": 1522852407, "creation_date": 1522848354, "answer_id": 49652243, "question_id": 49651949, "link": "https://stackoverflow.com/questions/49651949/vba-copy-data-to-master-sheet-and-insert-sheet-name-next-to-each-row/49652243#49652243", "title": "VBA - Copy Data to Master Sheet and Insert Sheet Name Next to Each Row", "body": "<p>You can shorten this significantly... there are lots of posts about getting items on a master sheet, 4 from yesterday alone.</p>\n\n<p>Take a look at this: </p>\n\n<pre><code>Dim lrSrc As Long, lrDst As Long, i As Long\nFor i = 1 To Sheets.Count\n    If Not Sheets(i).Name = \"Destination\" Then\n        lrSrc = Sheets(i).Cells(Sheets(i).Rows.Count, \"A\").End(xlUp).Row\n        lrDst = Sheets(\"Destination\").Cells(Sheets(\"Destination\").Rows.Count, \"A\").End(xlUp).Row\n        With Sheets(i)\n            .Range(.Cells(2, \"A\"), .Cells(lrSrc, \"B\")).Copy Sheets(\"Destination\").Range(Sheets(\"Destination\").Cells(lrDst + 1, \"B\"), Sheets(\"Destination\").Cells(lrDst + 1 + lrSrc, \"C\")) 'Assumes headers in first row aren't being copied\n            Sheets(\"Destination\").Range(Sheets(\"Destination\").Cells(lrDst + 1, \"A\"), Sheets(\"Destination\").Cells(lrDst + 1 + lrSrc, \"A\")).Value = Sheets(i).Name\n        End With\n    End If\n Next i\n</code></pre>\n\n<p><em>Code now tested</em></p>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1247, "favorite_count": 0, "accepted_answer_id": 49652020, "answer_count": 3, "score": 1, "last_activity_date": 1525768724, "creation_date": 1522847470, "last_edit_date": 1525768724, "question_id": 49651949, "link": "https://stackoverflow.com/questions/49651949/vba-copy-data-to-master-sheet-and-insert-sheet-name-next-to-each-row", "title": "VBA - Copy Data to Master Sheet and Insert Sheet Name Next to Each Row", "body": "<p>I have multiple sheets, each with data only in the first two columns: </p>\n\n<p><strong>Column A - ID</strong> </p>\n\n<p><strong>Column B - Name</strong></p>\n\n<p>I am trying to consolidate all these sheets into a master sheet. The format of the master sheet should be: </p>\n\n<p><strong>Column A - Sheet Name (From where the data was copied)</strong></p>\n\n<p><strong>Column B - ID</strong></p>\n\n<p><strong>Column C - Name</strong></p>\n\n<p>I have found a site that has code that does more or less this, however, after messing around with it for what feels like an eternity I just cannot get it to work.</p>\n\n<p>The code works, in the sense that it copies the correct range and inputs the sheet name into column A, however, it doesn't stop by the \"last row\" of the range in the master sheet, it continues to populate the ENTIRE column A and the <code>IF Statement</code> that counts the rows is triggered and I get the <code>msgbox</code> pop up (see below in code). At this point, the code just ends and it does not get a chance to execute for the remaining sheets.</p>\n\n<p>Link to site: <a href=\"https://www.rondebruin.nl/win/s3/win002.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win002.htm</a></p>\n\n<p>Below is the code from the original site, with some minor adjustments for the range I will be using:</p>\n\n<pre><code>Sub CopySheetNameToColumn()\nDim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"RDBMergeSheet\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"RDBMergeSheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            'Find the last row with data on the DestSh\n            Last = LastRow(DestSh)\n\n            'Fill in the range that you want to copy\n            Set CopyRng = sh.Range(\"A:B\")\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.count &gt; DestSh.Rows.count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            'This example copies values/formats, if you only want to copy the\n            'values or want to copy everything look at the example below this macro\n            CopyRng.Copy\n            With DestSh.Cells(Last + 1, \"B\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n            'Optional: This will copy the sheet name in the H column\n            DestSh.Cells(Last + 1, \"A\").Resize(CopyRng.Rows.count).Value = sh.Name\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Functions:</p>\n\n<pre><code>Function LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\n    On Error Resume Next\n    LastCol = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "onchange", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 1, "creation_date": 1522854408, "post_id": 49651540, "comment_id": 86317686, "body": "Thanks Peh. Fantastic!!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1522846309, "creation_date": 1522846309, "answer_id": 49651540, "question_id": 49651327, "link": "https://stackoverflow.com/questions/49651327/vba-mirror-areas-update-on-change/49651540#49651540", "title": "VBA mirror areas update on change", "body": "<p>First of all <code>Range(Target.Address)</code> doesn't make much sense <code>Target</code> is already a range so you convert a range into an address into a range. Just use <code>Target</code> directly.</p>\n\n<p>The issue here is that if you change a cell within <code>Worksheet_Change</code> event this triggers another <code>Worksheet_Change</code> event, which triggers another and \u2026</p>\n\n<p>So you need to <code>Application.EnableEvents = False</code> before the change and <code>Application.EnableEvents = True</code> afterwards.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Area1 As Range\n    Dim Area2 As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set Area1 = Range(\"B3:B9\")\n    Set Area2 = Range(\"D3:D9\")\n\n    Application.EnableEvents = False\n\n    If Not Application.Intersect(Area1, Target) Is Nothing Then\n        Range(\"D\" &amp; Target.Row) = Target.Value\n    End If\n\n    If Not Application.Intersect(Area2, Target) Is Nothing Then\n        Range(\"B\" &amp; Target.Row) = Target.Value\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 49651540, "answer_count": 1, "score": 1, "last_activity_date": 1522846309, "creation_date": 1522845744, "last_edit_date": 1531164843, "question_id": 49651327, "link": "https://stackoverflow.com/questions/49651327/vba-mirror-areas-update-on-change", "title": "VBA mirror areas update on change", "body": "<p>I have to areas in an Excel sheet that I need for them to get updated if there is a change in either of the area with the same value. See example of areas with example values:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CA76h.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CA76h.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The code that I tried is as follows:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Area1 As Range\n    Dim Area2 As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set Area1 = Range(\"B3:B9\")\n    Set Area2 = Range(\"D3:D9\")\n\n    If Not Application.Intersect(Area1, Range(Target.Address)) _\n           Is Nothing Then\n        Range(\"D\" &amp; Target.Row) = Target.Value\n    End If\n\n    If Not Application.Intersect(Area2, Range(Target.Address)) _\n           Is Nothing Then\n        Range(\"B\" &amp; Target.Row) = Target.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem is that I'm getting an error. I believe because when I write in Area 1 or 2 the code update the other area, but as a change is detected, then tries to change the initial area. Therefore, the code is getting in an endless loop.</p>\n\n<p>Any ideas on how I can sort this issue?</p>\n\n<p>What I'm trying to achieve is that what ever section the user updates, it will be replicated in the other.</p>\n"}, {"tags": ["string", "excel", "sequence", "data-extraction", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522847204, "post_id": 49651153, "comment_id": 86311822, "body": "&quot;<i>I need an algorithm for this.</i>&quot; Well if there is no pattern like always the same delimiters or always a specific amount of characters or something similar then there is no algorithm. You might be able to use Regular Expressions for that in combination with VBA but you will still need to find a pattern for that. Therefore I vote &quot;too broad to answer&quot;."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 3, "creation_date": 1522847550, "post_id": 49651153, "comment_id": 86312084, "body": "You want an algorithm which will pull out the zip code/postal code in <i>any</i> country?  Keeping in mind that each person in a country may write their address differently - the zip code may be at the beginning; not because it&#39;s meant to be there but because that&#39;s how the person wrote it.  When you find the algorithm please share!"}, {"owner": {"reputation": 3, "user_id": 9596368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e9a0daf33d10eb8fb2c5d0c4d7ca33?s=128&d=identicon&r=PG&f=1", "display_name": "antoniogouveia", "link": "https://stackoverflow.com/users/9596368/antoniogouveia"}, "edited": false, "score": 0, "creation_date": 1522850866, "post_id": 49651153, "comment_id": 86314811, "body": "I guess it will be difficult to obtain a general expression for all zip codes but i will be able to use a variation of my previous expression  to extract them based on the format and lenght of the different zip codes around the world. If you have any suggestions please let me know :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522851102, "post_id": 49651153, "comment_id": 86314999, "body": "@antoniogouveia Well since you are the only one who knows how your data looks like you are probably the only one who can find a pattern for it."}, {"owner": {"reputation": 3, "user_id": 9596368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e9a0daf33d10eb8fb2c5d0c4d7ca33?s=128&d=identicon&r=PG&f=1", "display_name": "antoniogouveia", "link": "https://stackoverflow.com/users/9596368/antoniogouveia"}, "edited": false, "score": 0, "creation_date": 1522851656, "post_id": 49651153, "comment_id": 86315459, "body": "The addresses would be similar to one I posted above. The postal code appears always in the end. That formula works almost perfectly for indian, japanese and chinese addresses and I have around 3,000 of addresses combined from those countries. I will only need to tweak it for other countries. I guess that will work."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522852100, "post_id": 49651153, "comment_id": 86315828, "body": "Well &quot;<i>similar to one I posted</i>&quot; is nothing that we can use to help you. We don&#39;t have a crystal ball."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522855421, "post_id": 49651153, "comment_id": 86318434, "body": "<i>The postal code appears always in the end</i>.  Your example has <i>India</i> at the end."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522855885, "post_id": 49651153, "comment_id": 86318790, "body": "Maybe pass the addresses through a service like Postcode Anywhere (now called PCA Direct)?  No idea what their international searching is like though."}, {"owner": {"reputation": 3, "user_id": 9596368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e9a0daf33d10eb8fb2c5d0c4d7ca33?s=128&d=identicon&r=PG&f=1", "display_name": "antoniogouveia", "link": "https://stackoverflow.com/users/9596368/antoniogouveia"}, "edited": false, "score": 0, "creation_date": 1522856100, "post_id": 49651153, "comment_id": 86318955, "body": "Wouldn&#39;t I need to have them isolated from the string first?"}, {"owner": {"reputation": 3, "user_id": 9596368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e9a0daf33d10eb8fb2c5d0c4d7ca33?s=128&d=identicon&r=PG&f=1", "display_name": "antoniogouveia", "link": "https://stackoverflow.com/users/9596368/antoniogouveia"}, "edited": false, "score": 0, "creation_date": 1522926203, "post_id": 49651153, "comment_id": 86351533, "body": "I found an expression with similar result as the one I&#39;ve posted above but with the advantage of being possible to input the needed format and lenght for the sequence to extract, if anyone is interested:  =TEXT(LOOKUP(10^8,MID(SUBSTITUTE(A1,&quot; &quot;,&quot;x&quot;),ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A1)-7)),8)+0),&quot;00000000&quot;)"}], "owner": {"reputation": 3, "user_id": 9596368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e9a0daf33d10eb8fb2c5d0c4d7ca33?s=128&d=identicon&r=PG&f=1", "display_name": "antoniogouveia", "link": "https://stackoverflow.com/users/9596368/antoniogouveia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522845228, "creation_date": 1522845228, "last_edit_date": 1531161705, "question_id": 49651153, "link": "https://stackoverflow.com/questions/49651153/extracting-the-last-sequence-of-numbers-in-excel", "title": "Extracting the last sequence of numbers in excel", "body": "<p>I have a list of addresses from which I need to extract the last sequence of numbers (zip code). I'm looking for a general expression from which I can extract the zip codes from addresses from all over the world. I would have to tweak the expression in order for it to work for each country, or for a group of countries, I assume. </p>\n\n<p>I'm trying to write a formula in excel that can recognise the last digit in a string, and from that, extract the numbers immediately before that last digit and stoping whenever it reaches a non-integer. Below I have an example of an address and the formula I've come up with (in E26), but I'm looking for something more compact:</p>\n\n<p><em>National Institute of Pharmaceutical Education and Research (NIPER), Phase X, Sector 67, SAS Nagar, Punjab, 160062, India.</em></p>\n\n<pre><code>=MID(E26, MAX(IF(ISNUMBER(VALUE(MID(E26,ROW(INDIRECT(\"1:\" &amp; LEN(E26))),1))),ROW(INDIRECT(\"1:\" &amp; LEN(E26))))+1)-6, 6)\n</code></pre>\n\n<p>The first part of recognizing the last digit is working fine, the problem is to recognize the beggining of the sequence, at least in cases where there's also street numbers within the string (such as in this case). This is why I'm subtacting -6 to the position where the last digit was found, since I know the lenght of the zip code in this particular country. However, it may not be the case for all countries. </p>\n\n<p>Plus there are cases, where there's a space between the sequence such as: <em>160 062</em>. Also, they won't always have delimeters that I could use to extract the zip codes, hence, the reason why a need an algorithm for this. </p>\n\n<p>I was wondering if there's a nitter way to do this? I would be open for VBA.  Thanks for your help!</p>\n\n<p>Best regards,\nAntonio</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522844897, "post_id": 49651011, "comment_id": 86310145, "body": "Which error are you getting? Are you running this in Word or Excel?  Looks like you&#39;re mixing commands from both?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1522845179, "post_id": 49651011, "comment_id": 86310326, "body": "If you&#39;re using Word methods from Excel, have you added the Word obect library?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1522845182, "post_id": 49651011, "comment_id": 86310330, "body": "Well, after having a long hard look at the code I&#39;ll have to say I haven&#39;t got a clue.  It doesn&#39;t look like the code has a whole lot to do with the question though.  One thing that jumps out is that the code is in Excel as you create the Word application using late binding, but then use <code>wdMove</code> and <code>wdLine</code> which Excel won&#39;t understand."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522845184, "post_id": 49651011, "comment_id": 86310331, "body": "@ashleedawg Error 4120, Running in Excel, I&#39;m using excel to do some things in word yes."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1522845302, "post_id": 49651011, "comment_id": 86310426, "body": "Trying using <code>5</code> instead of <code>wdLine</code> and <code>0</code> in place of <code>wdMove</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522845438, "post_id": 49651011, "comment_id": 86310509, "body": "Yes, the Word commands are very specific to Word. The same as you can&#39;t use Worksheets in Word as the document doesn&#39;t have them.  To find the numerical equivalent you can open the Word VBE and enter the text in the Immediate window: <code>?wdLine</code> will return 5 in Word."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1522845444, "post_id": 49651011, "comment_id": 86310516, "body": "Ashleedawg hit it on the head: you don&#39;t have a reference (Tools/Reference) to the Word library, so you can&#39;t use the <code>wd</code> enumerations - you&#39;ll need to use their Long integer equivalent values, as Darren suggested. Just putting <code>xl</code> in there is of no help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522845477, "post_id": 49651011, "comment_id": 86310538, "body": "@Darren Bartrup-Cook THANK YOU sooo much!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1522845613, "post_id": 49651011, "comment_id": 86310655, "body": "Or you can set a reference to Word using Tools/Reference that @CindyMeister suggests.  Intellisense &amp; all that becomes available then, but it falls over if someone is using a different version of Word."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "edited": false, "score": 0, "creation_date": 1522845707, "post_id": 49651011, "comment_id": 86310724, "body": "Since more people are going to use this I&#39;m sticking with the numerical ones. But I appreciate the help!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522851171, "post_id": 49651011, "comment_id": 86315055, "body": "&quot;Error 4120, Running in Excel&quot;, contradicts the notion of a <b>compile</b> error. Code that can&#39;t be <i>compiled</i>, will not <i>run</i>. If the code <i>runs</i>, then <code>Option Explicit</code> is missing - add it, and thank yourself later."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "edited": false, "score": 0, "creation_date": 1522852847, "post_id": 49651011, "comment_id": 86316487, "body": "<code>Option Explicit</code> is already present."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "edited": false, "score": 0, "creation_date": 1522852803, "post_id": 49653201, "comment_id": 86316454, "body": "Thank you for your explenation. Most of this is not new to me. But the magic number thing was. I get that it is better to not use them. But in this case its the best solution (for me). To not make it unclear I added comments behind the lines that say that <code>5</code> and <code>0</code> are equivalents of <code>wdLine</code> and <code>wdMove</code>. I will surely bookmark your Answer for future projects. It&#39;s very helpfull."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1522850843, "creation_date": 1522850843, "answer_id": 49653201, "question_id": 49651011, "link": "https://stackoverflow.com/questions/49651011/vba-parameter-error/49653201#49653201", "title": "VBA Parameter Error", "body": "<blockquote>\n  <p>Trying using 5 instead of wdLine and 0 in place of wdMove. \u2013 Darren Bartrup-Cook</p>\n</blockquote>\n\n<p>If you don't have a reference to the Microsoft Word type library, <code>wdLine</code> and <code>wdMove</code> are undefined.</p>\n\n<p>If <code>Option Explicit</code> isn't specified at the top of the module, then they become <em>undeclared variables</em> with a default type of <code>Variant</code>, and since they're passed as arguments to members that expect enum values, they'll be passed as <code>0</code> - which may or may not be a valid value for the invoked member, and may or may not work as intended.</p>\n\n<p>If <code>Option Explicit</code> is specified at the top of the module, the code doesn't compile, and the VBE highlights <code>wdLine</code> and <code>wdMove</code> as undeclared identifiers.</p>\n\n<blockquote>\n  <p>Since more people are going to use this I'm sticking with the numerical ones. But I appreciate the help! \u2013 MateoVD</p>\n</blockquote>\n\n<p>The best solution (assuming you're keeping the MS Word reference late-bound) is to maintain the readability of <code>wdLine</code> and <code>wdMove</code> values. Inlining their respective underlying integer value will work, but then you have <code>5</code> and <code>0</code> and no idea whatsoever about what these values mean: these are known as <strong>magic numbers</strong>, and they're a great source of hard-to-debug issues.</p>\n\n<p>Declare the constants yourself. <code>wdLine</code> and <code>wdMove</code> are members of the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/wdunits-enumeration-word\" rel=\"nofollow noreferrer\"><code>WdUnits</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/bb237814(v=office.12).aspx\" rel=\"nofollow noreferrer\"><code>WdMovementType</code></a> enumerations, respectively.</p>\n\n<p>You can define these enums yourself, at the top of any module - I'd recommend defining them in their own standard/procedural module (.bas), so that these values are accessible from anywhere in your code (they wouldn't be, if you defined them in e.g. a <code>Worksheet</code> class module):</p>\n\n<pre><code>'Module: WordConsts\n'@Folder(\"Microsoft Word Constants\")\nOption Explicit\n\nPublic Enum WdUnits\n    wdCell = 12\n    wdCharacter = 1\n    wdCharacterFormatting = 13\n    wdColumn = 9\n    wdItem = 16\n    wdLine = 5\n    wdParagraph = 4\n    wdParagraphFormatting = 14\n    wdRow = 10\n    wdScreen = 7\n    wdSection = 8\n    wdSentence = 3\n    wdStory = 6\n    wdTable = 15\n    wdWindow = 11\n    wdWord = 2\nEnd Enum\n\nPublic Enum WdMovementType\n    wdMove = 0\n    wdExtend = 1\nEnd Enum\n</code></pre>\n\n<p>And now you can keep your code as-is, and use <code>wdMove</code> and <code>wdLine</code> and any other possible legal values, without having to dig them and their underlying values up online.</p>\n\n<p>If you then add a reference to the Microsoft Word type library, the constants defined in your <code>WordConsts</code> module will take precedence over the same-name identifiers defined in the type library: this is called <em>shadowing</em>, or <em>hiding</em> - anything defined in your VBA project will always have higher precedence in identifier resolution.</p>\n\n<hr>\n\n<p>TL;DR: Write code that <em>says what it does</em>, and <em>does what it says</em>. Magic numbers don't say anything - avoid them. If a number means something, give it a meaningful name. When a name exists for that value, use it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 49653201, "answer_count": 1, "score": 0, "last_activity_date": 1522850843, "creation_date": 1522844806, "question_id": 49651011, "link": "https://stackoverflow.com/questions/49651011/vba-parameter-error", "title": "VBA Parameter Error", "body": "<p>I have been fiddling with this code for a few hours now and I can't get rid of the compile error.</p>\n\n<pre><code>Set objWord = CreateObject(\"Word.Application\")\n\n''more code\n\nobjWord.Selection.TypeText (FDS.Cells(2, 8).Value)\n\nobjWord.Selection.HomeKey Unit:=wdLine, Extend:=wdMove (error occurs here)\n\nActiveDocument.Indexes.MarkEntry Range:=objWord.Selection.Range, Entry:=(\"Device\")\nobjWord.Selection.EndKey Unit:=wdLine\n\n''more code\n</code></pre>\n\n<p>(I left out a lot of code since the module is huge)</p>\n\n<p>What I want the code to do in the end is look in a specific excel cell and take that value and place it in the currently open word document. Then that value has to be selected and given a marking and then going to the end of the line.</p>\n\n<p>I have tried all solutions that I know of and changing <code>Extend:=wdMove</code> to <code>Extend:=wdExtend</code> but nothing seems to work.</p>\n\n<p>The only way I can get rid of the error is removing <code>Unit:=wdLine</code>. But this also makes sure it doesn't select the Value anymore.</p>\n\n<p>Im hopeless at this point. So I will take any help.</p>\n\n<p>Thnx in advance.</p>\n"}, {"tags": ["excel", "vba", "cells"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 2, "creation_date": 1522843960, "post_id": 49650582, "comment_id": 86309437, "body": "Wouldn&#39;t it be <code>xlUp</code> for the row?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522843973, "post_id": 49650582, "comment_id": 86309446, "body": "Could you show some sample data and expected outcome? And is Delete as xlUp not ok?"}, {"owner": {"reputation": 9, "user_id": 9558880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbd9e9869e078cbbd678cfa0f4248f6?s=128&d=identicon&r=PG&f=1", "display_name": "BiggestPotato", "link": "https://stackoverflow.com/users/9558880/biggestpotato"}, "edited": false, "score": 0, "creation_date": 1522847214, "post_id": 49650582, "comment_id": 86311825, "body": "xlUp deletes the bottom row  but only the bottom row"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1522845042, "creation_date": 1522845042, "answer_id": 49651096, "question_id": 49650582, "link": "https://stackoverflow.com/questions/49650582/shifting-a-table-by-deleting-rows-and-columns/49651096#49651096", "title": "Shifting a table by deleting rows and columns", "body": "<p>Excel does not shift <code>Down</code> or <code>Right</code> when deleting.</p>\n\n<p>Only <code>Left</code> or <code>Up</code> are possible:</p>\n\n<p><strong>XlShift</strong> - Used only with Range objects. Specifies how to shift cells to replace deleted cells. Can be one of the following XlDeleteShiftDirection constants: <code>xlShiftToLeft</code> or <code>xlShiftUp</code> . If this argument is omitted, Microsoft Excel decides based on the shape of the range.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-delete-method-excel\" rel=\"nofollow noreferrer\">MSDN - Delete Range</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZKw2z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZKw2z.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 9558880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbd9e9869e078cbbd678cfa0f4248f6?s=128&d=identicon&r=PG&f=1", "display_name": "BiggestPotato", "link": "https://stackoverflow.com/users/9558880/biggestpotato"}, "edited": false, "score": 0, "creation_date": 1522847393, "post_id": 49651169, "comment_id": 86311956, "body": "This deletes all the correct columns and rows and does it far more efficiently than looping. The data ends up in the top left though. Do you know how I would define the new range for the remaining data so I could shift it down the right number of positions?"}, {"owner": {"reputation": 9, "user_id": 9558880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbd9e9869e078cbbd678cfa0f4248f6?s=128&d=identicon&r=PG&f=1", "display_name": "BiggestPotato", "link": "https://stackoverflow.com/users/9558880/biggestpotato"}, "edited": false, "score": 0, "creation_date": 1522852435, "post_id": 49651169, "comment_id": 86316125, "body": "I&#39;ve managed to move it down by selecting the range and pasting at the appropriate place, Thanks!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1522845271, "creation_date": 1522845271, "answer_id": 49651169, "question_id": 49650582, "link": "https://stackoverflow.com/questions/49650582/shifting-a-table-by-deleting-rows-and-columns/49651169#49651169", "title": "Shifting a table by deleting rows and columns", "body": "<p>Don\u2019t loop</p>\n\n<pre><code>Public Sub shiftrandom()\n    Dim Difference As Long\n    Difference = 5\n    With Range(\"B2:N20\")\n        .Resize(,Difference).Delete\n        .Rows(.Rows.Count - Difference + 1).Resize(Difference).Delete \n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9558880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbd9e9869e078cbbd678cfa0f4248f6?s=128&d=identicon&r=PG&f=1", "display_name": "BiggestPotato", "link": "https://stackoverflow.com/users/9558880/biggestpotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 49651169, "answer_count": 2, "score": 1, "last_activity_date": 1522845271, "creation_date": 1522843563, "last_edit_date": 1522844196, "question_id": 49650582, "link": "https://stackoverflow.com/questions/49650582/shifting-a-table-by-deleting-rows-and-columns", "title": "Shifting a table by deleting rows and columns", "body": "<p>I have a table populated by random numbers and I would like to delete x number of columns from the left of the table, x number of rows from the bottom of the table and move the remaining values to the bottom left corner.</p>\n\n<pre><code>Public Sub shiftrandom()\nDim Difference As integer\nDifference = 5\nDim i As Integer\nFor i = 1 To Difference\n    Range(\"B2:B20\").Delete Shift:=xlToLeft\n    Range(\"B20:N20\").Delete Shift:=xlDown\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Here B2:B20 is first column and B20:N20 is the last row. This is a 13x19 table.</p>\n\n<p>the <code>Range(\"B2:B20\").Delete Shift:=xlToLeft</code> works fine by its own, it shifts all the remaining values to the left by the correct number of columns, but the shift down line returns an </p>\n\n<blockquote>\n  <p>out of bounds error.</p>\n</blockquote>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 1, "creation_date": 1522842272, "post_id": 49649989, "comment_id": 86308282, "body": "Create a macro on the users PC and select &quot;Store Macro in&quot;  and &quot;Personal Macro Workbook&quot;. This will create the hidden workbook that you can then import macros to"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1522843167, "post_id": 49649989, "comment_id": 86308895, "body": "If you are to let others has every single personal macro you have, search in Explorer for <b>personal.xlsb</b> in your user profile, then copy paste this file (with excel closed) to similar path on other user&#39;s profile."}], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 3599495, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d1f1c6ffef694fb4d63f612c20885803?s=128&d=identicon&r=PG&f=1", "display_name": "user3599495", "link": "https://stackoverflow.com/users/3599495/user3599495"}, "is_accepted": true, "score": 0, "last_activity_date": 1522842343, "creation_date": 1522842343, "answer_id": 49650177, "question_id": 49649989, "link": "https://stackoverflow.com/questions/49649989/how-to-move-macros-from-one-user-login-to-another/49650177#49650177", "title": "How to move macros from one user login to another?", "body": "<p>You have to save the original file as macro-enabled (.xlsm),  not default (.xlsx). The other user will have an option to enable macros after opening macros. </p>\n\n<p>You can also consider using macro-enabled template file (.xltm). </p>\n\n<p>Since macros can be designed to damage system (like virus), it makes sense not to allow them in the default file format. </p>\n"}], "owner": {"reputation": 403, "user_id": 6463651, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4ebe0bcfa7618c1afa7295a3cc97452a?s=128&d=identicon&r=PG&f=1", "display_name": "Shubh", "link": "https://stackoverflow.com/users/6463651/shubh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 49650177, "answer_count": 1, "score": 0, "last_activity_date": 1522842645, "creation_date": 1522841813, "last_edit_date": 1522842645, "question_id": 49649989, "link": "https://stackoverflow.com/questions/49649989/how-to-move-macros-from-one-user-login-to-another", "title": "How to move macros from one user login to another?", "body": "<p><a href=\"https://i.stack.imgur.com/ELJVc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ELJVc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have previously made macros file and trying to move to other user id.\nHowever when i am clicking macros options in the same excel file from other user id i am unable to see personal.xlsb.\nCan anyone please guide step by step how to implement (copy/paste) macros?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51419, "user_id": 1213708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e617b05eacf75c49dcf76ebb312292ec?s=128&d=identicon&r=PG", "display_name": "Nigel Ren", "link": "https://stackoverflow.com/users/1213708/nigel-ren"}, "edited": false, "score": 1, "creation_date": 1522841292, "post_id": 49649797, "comment_id": 86307611, "body": "Not sure where PHP fits in here."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522841406, "post_id": 49649797, "comment_id": 86307671, "body": "Create a pivottable and use the filter between on dates?"}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "reply_to_user": {"reputation": 51419, "user_id": 1213708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e617b05eacf75c49dcf76ebb312292ec?s=128&d=identicon&r=PG", "display_name": "Nigel Ren", "link": "https://stackoverflow.com/users/1213708/nigel-ren"}, "edited": false, "score": 0, "creation_date": 1522841466, "post_id": 49649797, "comment_id": 86307719, "body": "@NigelRen My bad"}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522841541, "post_id": 49649797, "comment_id": 86307784, "body": "@QHarr That would be an idea but I&#39;d like to be able to automate this action to various kinds of files. VBA seems to be easier to transpose to all files"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522843690, "post_id": 49649797, "comment_id": 86309244, "body": "<code>Cells</code> does not use a string:  cell <code>H1</code> is <code>Cells(1,8)</code>, cell <code>J1</code> is <code>Cells(2,10)</code> etc"}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522844423, "post_id": 49649797, "comment_id": 86309776, "body": "@Chronocidal Thanks, should I use Range instead?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522844534, "post_id": 49649797, "comment_id": 86309859, "body": "You can use either of <code>Range(&quot;H&quot; &amp; Rows.Count)</code> or <code>Cells(Rows.Count, 8)</code> - I would usually recommend <code>Cells(..)</code> because it is <i>so</i> much easier for loops."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522846258, "post_id": 49650940, "comment_id": 86311147, "body": "Thanks a lot, that seems much more detailed. I&#39;m wondering, does the first part is necessary? Is it possible to directly update in column #2 without adding a new sheet?"}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522846363, "post_id": 49650940, "comment_id": 86311229, "body": "Moreover, &quot;    Union(Sheet1.ListObjects(&quot;Table1&quot;).HeaderRowRange, _         Sheet1.ListObjects(&quot;Table1&quot;).DataBodyRange).Copy Destination:=NewSheet.Cells(1, 1)&quot; seems to be source of error 424"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522846914, "post_id": 49650940, "comment_id": 86311614, "body": "Sorry - that should be <code>sht.ListObjects</code>, since that&#39;s the name of your worksheet.  <code>Sheet1</code> was my testing sheet.  And, I included the first part for 2 reasons:  First, your code did not have qualified ranges (so was producing data on <code>ActiveSheet</code>, which may-or-may-not be <code>Sht</code>) and also I have had... <i>issues</i>... working on Tables in the past (i.e. when they were first added to Excel) and prefer to turn them back into normal Ranges for operation where possible."}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522850219, "post_id": 49650940, "comment_id": 86314305, "body": "Thanks for your complete answer, but unfortunately, the part I refered to in the last comment generates an error 91, do you have any idea why?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522850508, "post_id": 49650940, "comment_id": 86314538, "body": "If Table1 does not have a header, then it will generate an error (change it to <code>sht.ListObjects(&quot;Table1&quot;).DataBodyRange.Copy Destination:=NewSheet.Cells(1, 1)</code>) - otherwise, if you have renamed <code>sht</code> you will also get an error (it needs to point at the Worksheet that your data-table is on)"}, {"owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522853304, "post_id": 49650940, "comment_id": 86316860, "body": "Ok but sht is not defined, what does it mean? Is it sheet 1?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "edited": false, "score": 0, "creation_date": 1522854299, "post_id": 49650940, "comment_id": 86317616, "body": "You tell me:  Your originally posted code contains the line <code>LastRow = sht.ListObjects(&quot;Table1&quot;).Range.Rows.Count</code> - I&#39;m just operating on that data table."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1522846931, "last_edit_date": 1522846931, "creation_date": 1522844571, "answer_id": 49650940, "question_id": 49649797, "link": "https://stackoverflow.com/questions/49649797/how-to-display-all-dates-between-2-dates-in-a-column/49650940#49650940", "title": "How to display all dates between 2 dates in a column?", "body": "<p>I'm going recommend a <code>FOR</code> loop, taking advantage of the fact that you can move your goalposts.</p>\n\n<p>Now, since you haven't qualified your <code>Cells</code> reference (e.g. <code>Sheet1.Cells</code>) I'm going to be creating a new sheet with the data on.  (Always, always, <strong>always</strong> qualify your sheets, even if it's <code>ActiveSheet.Cells</code> or <code>Me.Cells</code>.  It helps you spot <em>so</em> many 'unexpected' errors before they happen)</p>\n\n<p>Basically, we'll duplicate the input data, add a \"Dates\" column, then run down the rows filling it in.  If the Date is not the End Date, we duplicate the row and add 1 day - <strong>this also makes the loop longer</strong> - and when we reach the end of the loop we're done.</p>\n\n<pre><code>Sub DailyLines()\n    Dim NewSheet As Worksheet\n    Dim lWorkingRow As Long, lEndRow As Long\n    Set NewSheet = ThisWorkbook.Worksheets.Add\n\n    'Copy Table1 to working sheet\n    Union(sht.ListObjects(\"Table1\").HeaderRowRange, _\n        sht.ListObjects(\"Table1\").DataBodyRange).Copy Destination:=NewSheet.Cells(1, 1)\n    NewSheet.ListObjects(1).Unlist 'Convert table to range - this will mak it easier to work with\n    NewSheet.Calculate\n    NewSheet.Columns(8).Insert xlShiftRight 'Add a new column at H\n    NewSheet.Cells(1, 8).Value = \"Date\" 'Add a header to the new column\n    NewSheet.Calculate\n\n    'This is where the processing starts\n    lEndRow = NewSheet.Cells(NewSheet.Rows.Count, 1).End(xlUp).Row 'Find bottom row\n    If lEndRow &gt; 1 Then 'At least 1 row of data\n        For lWorkingRow = 2 To lEndRow 'Step through rows\n            'is this new data?\n            If Len(NewSheet.Cells(lWorkingRow, 8).Value) &lt; 1 Then 'Never processed this row before\n                NewSheet.Cells(lWorkingRow, 8).Value = NewSheet.Cells(lWorkingRow, 9).Value 'Default to StartDate\n            Else 'Not the first copy of the row\n                NewSheet.Cells(lWorkingRow, 8).Value = NewSheet.Cells(lWorkingRow, 8).Value + 1 'Increment by 1 day\n            End If\n            'Have we finished with this data?\n            If NewSheet.Cells(lWorkingRow, 8).Value + 1 &lt;= NewSheet.Cells(lWorkingRow, 10).Value Then 'Not reached EndDate\n                NewSheet.Rows(lWorkingRow).Copy NewSheet.Rows(lWorkingRow) 'Duplicate the row\n                lEndRow = lEndRow + 1 'IMPORTANT!  We now need to process 1 more row of data!\n            End If\n        Next lWorkingRow\n    End If\n\n    'Tidy up\n    Set NewSheet = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522846931, "creation_date": 1522841216, "last_edit_date": 1522841814, "question_id": 49649797, "link": "https://stackoverflow.com/questions/49649797/how-to-display-all-dates-between-2-dates-in-a-column", "title": "How to display all dates between 2 dates in a column?", "body": "<p>I'm currently working on a 16 000 rows excel file, I've checked for the past few days on the internet but didn't find any relevant help to this particular problem. </p>\n\n<p>The idea is that 2 columns (H and I) include starting date and end date for up to 365 lines (corresponds to 365 following days). For each line I'd like to write each date from start date to end date.\nFor example, my first 10 lines include a start date of 01/01/2018 and end date of 01/10/2018. For each line, i'd like to have each date as follows:</p>\n\n<ul>\n<li>01/01/2018</li>\n<li>01/02/1018</li>\n<li>01/03/2018</li>\n<li>...</li>\n<li>01/10/2018</li>\n</ul>\n\n<p>My main issue is that it should stop on the 10th line if the value of the cell equals to the date of 'end date' (if that can help, I have a 'number of days' columns which is the difference between end date and start date in column K)</p>\n\n<p>You'll find below my current codes. As I'm a beginner, it includes a fewmistakes. Can you please provide me with some help?</p>\n\n<pre><code>    Sub Dates()\n    Dim FirstDate As Date\n    Dim LastDate As Date\n    LastRow = sht.ListObjects(\"Table1\").Range.Rows.Count\n    FirstDate = Cells(\"8\" &amp; Rows.Count).Value\n    LastDate = Cells(\"9\" &amp; Rows.Count).Value\n    NbDays = Cells(\"11\" &amp; Rows.Count).Value\n\n    For X = Cells(\"2\" &amp; Rows.Count).End(xlDown) To LastRow\n            If FirstDate = LastDate Then\n                X = FirstDate\n\n    Else\n        Do\n            X = FirstDate + 1\n\n        Loop Until X.Value = LastDate\n\n    End Sub\n</code></pre>\n\n<p>Spreadsheet should look as follows:</p>\n\n<pre><code>    Type    Date     Start date   End Date\n    A   01/01/2018  01/01/2018  01/10/2018\n    A   01/02/2018  01/01/2018  01/10/2018\n    A   01/03/2018  01/01/2018  01/10/2018\n    A   01/04/2018  01/01/2018  01/10/2018\n    A   01/05/2018  01/01/2018  01/10/2018\n    A   01/06/2018  01/01/2018  01/10/2018\n    A   01/07/2018  01/01/2018  01/10/2018\n    A   01/08/2018  01/01/2018  01/10/2018\n    A   01/09/2018  01/01/2018  01/10/2018\n    A   01/10/2018  01/01/2018  01/10/2018\n    B   02/06/2018  02/06/2018  02/10/2018\n    B   02/07/2018  02/06/2018  02/10/2018\n    B   02/08/2018  02/06/2018  02/10/2018\n    B   02/09/2018  02/06/2018  02/10/2018\n    B   02/10/2018  02/06/2018  02/10/2018\n</code></pre>\n\n<p>I thank you in advance</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1522841701, "creation_date": 1522841701, "answer_id": 49649944, "question_id": 49649774, "link": "https://stackoverflow.com/questions/49649774/ms-access-filter-by-date-to-from/49649944#49649944", "title": "MS Access; Filter by Date, To &amp; From", "body": "<p>You can use:</p>\n\n<pre><code>strCriteria = \"[DateRecorded] &gt;= #\" &amp; Format(Me.txtDateFrom, \"yyyy\\/mm\\/dd\")  &amp; \"# And [DateRecorded] &lt;= #\" &amp; Format(Me.txtDateTo, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "edited": false, "score": 0, "creation_date": 1522843703, "post_id": 49650034, "comment_id": 86309252, "body": "thank you both for your help :) I really appreciate it!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1522841930, "creation_date": 1522841930, "answer_id": 49650034, "question_id": 49649774, "link": "https://stackoverflow.com/questions/49649774/ms-access-filter-by-date-to-from/49650034#49650034", "title": "MS Access; Filter by Date, To &amp; From", "body": "<p>Alternative to Gustav's answer, you could use the values on your form as parameters:</p>\n\n<pre><code>strCriteria = \"[DateRecorded] &gt;= Forms!MyFormName!txtDateFrom And [DateRecorded] &lt;= Forms!MyFormName!txtDateTo\"\n</code></pre>\n\n<p>This has the added advantage that when you change one of those search parameters, requerying the form is enough to work with the updated parameters.</p>\n"}], "owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "accepted_answer_id": 49649944, "answer_count": 2, "score": 1, "last_activity_date": 1522841930, "creation_date": 1522841147, "question_id": 49649774, "link": "https://stackoverflow.com/questions/49649774/ms-access-filter-by-date-to-from", "title": "MS Access; Filter by Date, To &amp; From", "body": "<p>From a table I have created a Split Form, with two 'Date' (To and From) texts boxes with a search button.</p>\n\n<pre><code>    Private Sub btnSearch_Click()\n' Search Button\nCall Search\nEnd Sub\n\nSub Search()\nDim strCriteria, task As String\n\nMe.Refresh\nIf IsNull(Me.txtDateFrom) Or IsNull(Me.txtDateTo) Then\n    MsgBox \"Please enter the date range\", vbInformation, \"Date Range Required\"\n    Me.txtDateFrom.SetFocus\nElse\n    strCriteria = \"([DateRecorded] &gt;= #\" &amp; Me.txtDateFrom &amp; \"# And [DateRecorded] &lt;= #\" &amp; Me.txtDateTo &amp; \"#)\"\n    task = \"select * from tblNCRs where (\" &amp; strCriteria &amp; \") order by [DateRecorded]\"\n    DoCmd.ApplyFilter task\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>When selecting dates and searching the code seems to work, however it is pulling up results randomly. (I believe that this is due to the code maybe using the American date format? Whereby I am using the UK Style, DD/MM/YYYY)</p>\n\n<p>What can I do to make this work correctly?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522848723, "post_id": 49649702, "comment_id": 86313059, "body": "why not use Index Match? Can this be in any column you are searching? And what do you mean by delimited by space?"}], "answers": [{"comments": [{"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1522848110, "post_id": 49651989, "comment_id": 86312561, "body": "If that works for you I would appreciate it if you accept it :)"}, {"owner": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522913086, "post_id": 49651989, "comment_id": 86342663, "body": "It is working .. thank you. But I have a query here to add on this. for suppose I have a text like this &quot;this is sample data to check flow-1 and to check flow-2 &quot;. Can you please let me how can I retrieve both flow-1 and flow-2 (it can be till flow-n) into same cell adjacent to it."}, {"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "reply_to_user": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522926303, "post_id": 49651989, "comment_id": 86351589, "body": "You should open a new question for that. A good name would be &quot;UDF Multi-Cell Array Formula to find multiple substrings in Cell&quot; I think I can work out an answer by tonight"}, {"owner": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522928740, "post_id": 49651989, "comment_id": 86353318, "body": "Thanks for that! And in the above base scenario which I have mentioned if the text is &quot;this is sample data to check                  flow&quot; , I will be getting the result as spaces. (Space is treated as the next string and thus it is gives the space as output) Is there a way to ignore spaces and get the word?"}, {"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "reply_to_user": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522929270, "post_id": 49651989, "comment_id": 86353701, "body": "As you can see in the screenshot, the above code works for the sample sentence as it used <code>spaces</code> as delimiter. Do you have <code>double spaces</code> in your text?"}, {"owner": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522930235, "post_id": 49651989, "comment_id": 86354364, "body": "Yeah, it can have any number of spaces after the word check."}], "tags": [], "owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "is_accepted": true, "score": 0, "last_activity_date": 1522847580, "creation_date": 1522847580, "answer_id": 49651989, "question_id": 49649702, "link": "https://stackoverflow.com/questions/49649702/how-to-search-for-a-string-in-a-cell-and-take-the-word-next-to-it-delimited-by-s/49651989#49651989", "title": "How to search for a string in a cell and take the word next to it delimited by space", "body": "<pre><code>Function findWord(rng As Range, criterion As String)\n\n    Dim cellContent As String\n    cellContent = rng.Value\n\n    Dim myArray As Variant\n    myArray = Split(cellContent, \" \")\n\n    found = False\n\n    For Each element In myArray\n        If found = True Then\n            findWord = element\n            Exit For\n        End If\n\n        If element = criterion Then\n            found = True\n        End If\n    Next element\n\n\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XzvIs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XzvIs.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "edited": false, "score": 0, "creation_date": 1522913937, "post_id": 49660505, "comment_id": 86343213, "body": "I have a query here. We are splitting with spaces (Split(cell.Text, &quot; &quot;)) . what if the word I am searching for starts I new line inside the cell. Is there a way to distinguish the new line inside cell?                                                                                                       &quot;this is new logic to  check flow-1 in new line&quot; something like this in a cell"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522876288, "creation_date": 1522876288, "answer_id": 49660505, "question_id": 49649702, "link": "https://stackoverflow.com/questions/49649702/how-to-search-for-a-string-in-a-cell-and-take-the-word-next-to-it-delimited-by-s/49660505#49660505", "title": "How to search for a string in a cell and take the word next to it delimited by space", "body": "<p>you could use this function</p>\n\n<pre><code>Function GetNextWord(cell As Range, word As String)\n    Dim words As Variant\n    words = Split(cell.Text, \" \")\n\n    Dim index  As Variant\n    index = Application.Match(word, words, 0)\n\n    If Not IsError(index) Then If index &lt;= UBound(words) Then GetNextWord = words(index)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9596369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f99ce81e2be543f0e9b22d14e7be76?s=128&d=identicon&r=PG&f=1", "display_name": "Sneha", "link": "https://stackoverflow.com/users/9596369/sneha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49651989, "answer_count": 2, "score": 0, "last_activity_date": 1522876288, "creation_date": 1522840948, "last_edit_date": 1522841604, "question_id": 49649702, "link": "https://stackoverflow.com/questions/49649702/how-to-search-for-a-string-in-a-cell-and-take-the-word-next-to-it-delimited-by-s", "title": "How to search for a string in a cell and take the word next to it delimited by space", "body": "<p>Hi please help me with the below stuff\nI need to search for a word \"check\" from the text in a cell in excel and take the word exactly next to it using VBA\nFor example if I have the below text in cell(1,B)\nthis is sample data to check flow</p>\n\n<p>Now macro should search for the word check and give me the word flow as my output. </p>\n"}, {"tags": ["excel", "shell", "vba"], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1522848440, "post_id": 49650217, "comment_id": 86312839, "body": "Wow! Thanks for the detailed solution, but there&#39;s an issue with <code>SendMessage w.hWnd, WM_SYSCOMMAND, SC_CLOSE, 0</code> . While the code find the folder window in question, the previous sequence does not close it and I do not know why, it just iterates past it. I&#39;m not sure it can help, but the code runs on a laptop with a 32 bit Office 2013 Professional Plus running on a French 64 bit Win 7 Enterprise version."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 1, "creation_date": 1522849099, "post_id": 49650217, "comment_id": 86313341, "body": "Well, that&#39;s odd. You can try if <code>w.Quit</code> works instead. And check the values of the variables <code>w.hWnd, WM_SYSCOMMAND, SC_CLOSE</code>?"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1522844102, "last_edit_date": 1522844102, "creation_date": 1522842455, "answer_id": 49650217, "question_id": 49649663, "link": "https://stackoverflow.com/questions/49649663/close-folder-opened-through-explorer-exe/49650217#49650217", "title": "Close folder opened through Explorer.exe", "body": "<p>The following code loops through all opened Explorer windows. So you can use that to match against the <code>LocationURL</code> and get the window handle <code>hWnd</code> and use Windows API <code>SendMessage</code> to close the window.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\n'for 64-bit Excel use\nPrivate Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n    (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Long) As LongPtr\n'for 32-bit Excel use\nPrivate Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n    (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Long) As Long\n\n\nConst WM_SYSCOMMAND = &amp;H112\nConst SC_CLOSE = &amp;HF060\n\nPublic Sub CloseWindowExample()\n    Dim sh As Object\n    Set sh = CreateObject(\"shell.application\")\n\n    Dim w As Variant\n    For Each w In sh.Windows\n        'print all locations in the intermediate window\n        Debug.Print w.LocationURL\n\n        ' select correct shell window by LocationURL\n        If w.LocationURL = \"file://sharepoint.com@SSL/DavWWWRoot/sites/folder\" Then\n            SendMessage w.hWnd, WM_SYSCOMMAND, SC_CLOSE, 0\n        End If\n    Next w\nEnd Sub\n</code></pre>\n\n<p>Note that the <code>LocationURL</code> path begins with <code>file://</code> and that all backslashes <code>\\</code> in the path are converted to slashes <code>/</code> as shown in the example.</p>\n\n<p>To make it compatible with both 64 and 32 bit Excel you can use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>#If VBA7 Then\n    Private Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n        (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Long) As LongPtr\n#Else\n    Private Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n        (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Long) As Long\n#End If\n</code></pre>\n\n<p>Note that one of these will be marked in red as compile error but the code will still run.</p>\n"}], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1682, "favorite_count": 0, "accepted_answer_id": 49650217, "answer_count": 1, "score": 1, "last_activity_date": 1522844102, "creation_date": 1522840825, "last_edit_date": 1531164843, "question_id": 49649663, "link": "https://stackoverflow.com/questions/49649663/close-folder-opened-through-explorer-exe", "title": "Close folder opened through Explorer.exe", "body": "<p>It's a bit of a silly question, but how do you close a folder through Excel VBA ? Below the code to opening it,</p>\n\n<pre><code>Shell \"Explorer.exe \\\\sharepoint.com@SSL\\DavWWWRoot\\sites\\folder\", vbMinimizedFocus\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/30764615/excel-vba-open-and-close-a-folder\">This</a> solution with the process ID unfortunately does not work.</p>\n"}, {"tags": ["vba", "excel", "milliseconds", "filetime"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522840851, "post_id": 49649562, "comment_id": 86307337, "body": "Is your filesystem FAT or NTFS?"}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522841162, "post_id": 49649562, "comment_id": 86307521, "body": "NTFS, windows 7, 64 bits"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522841485, "post_id": 49649562, "comment_id": 86307735, "body": "good, me too.  I&#39;ll put together an answer...  but may I ask first, what are you planning on doing with this, and why do you require that level of granularity?  (Also, VBA&#39;s <code>Date</code> type only has resolution of 1 second, so it will have to use a different data type.)  How you&#39;re going to use it may affect the answer."}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522841956, "post_id": 49649562, "comment_id": 86308053, "body": "In short, its about sorting scanned or splitted documents (pdf&#39;s). I already made the rename code and all. The problem is when i split a pdf in 100 pages it will be &quot;part 1 2 3 4 5&quot; and so on. Vba gets the date of last modified and it sorts after it. Only it can&#39;t sort them correctly if they have the same time and seconds of &quot;creation&quot;. So i need miliseconds (explorer sorts them right). I woud of found other solutions (extracting the number from part 1 2 3 ) but this code will sort other kinds of pdf from the scanner and so on and showing the miliseconds woud be perfect."}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522842338, "post_id": 49649562, "comment_id": 86308329, "body": "My english is far from perfect. So, vba reads the folder contents. Gets in excel the last modified date of the files from the folder. Sorts them after the date hh,mm,ss. From that point another piece of vba takes over inserting from another table &quot;new names&quot; for those files. The new names are already put in the order of the scanned documents or how they are displayed in a pdf that was splitted. The order has to match."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522842348, "post_id": 49649562, "comment_id": 86308337, "body": "uhh alright, kind of a strange requirement.  You&#39;re right, extracting the number from the filename would be much easier (1 line of code versus 100).  But have you <b>seen</b> the milliseconds?  How do you know Windows is sorting by that?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522842372, "post_id": 49649562, "comment_id": 86308358, "body": "let&#39;s go to chat"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1522842377, "post_id": 49649562, "comment_id": 86308361, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168209/discussion-between-ashleedawg-and-mistera\">continue this discussion in chat</a>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1522844426, "post_id": 49649562, "comment_id": 86309778, "body": "Sounds like an <a href=\"https://meta.stackexchange.com/q/66377/357835\">XY problem</a>. I don&#39;t think that getting time on a millisecond scale is a robust solution to your problem."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6281751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08419a4909399708a92c36a7f4c96060?s=128&d=identicon&r=PG&f=1", "display_name": "Markos", "link": "https://stackoverflow.com/users/6281751/markos"}, "edited": false, "score": 0, "creation_date": 1562935075, "post_id": 49650833, "comment_id": 100546983, "body": "WSeconds is used where should be wMiliseconds"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1522844268, "creation_date": 1522844268, "answer_id": 49650833, "question_id": 49649562, "link": "https://stackoverflow.com/questions/49649562/obtain-the-last-modified-date-of-a-file-with-milliseconds/49650833#49650833", "title": "Obtain the last modified date of a file with MILLISECONDS?", "body": "<p>The following module will retrieve Windows file creation, modify or accessed datetime including milliseconds, using a Windows API call.</p>\n\n<p>However it must be noted that there are a number of potential issues.  A big one is that the VBA <code>Date</code> data type has a resolution of 1 second, so the datetime needs to be returned as a String, or stored in a different data type (<code>Currency</code> is the correct size.)</p>\n\n<pre><code>Option Explicit\n\nDeclare Function GetFileTime Lib \"kernel32.dll\" (ByVal hFile As Long, _\n    lpCreationTime As FILETIME, lpLastAccessTime As FILETIME, _\n    lpLastWriteTime As FILETIME) As Long\n\nDeclare Function CreateFile Lib \"kernel32.dll\" Alias \"CreateFileA\" _\n    (ByVal lpFileName As String, ByVal dwDesiredAccess As Long, _\n    ByVal dwShareMode As Long, lpSecurityAttributes As Any, _\n    ByVal dwCreationDisposition As Long, ByVal dwFlagsAndAttributes As Long, _\n    ByVal hTemplateFile As Long) As Long\n\nDeclare Function CloseHandle Lib \"kernel32.dll\" (ByVal hObject As Long) As Long\n\nDeclare Function FileTimeToSystemTime Lib \"kernel32.dll\" _\n    (lpFileTime As FILETIME, lpSystemTime As SYSTEMTIME) As Long\n\nType FILETIME\ndwLowDateTime As Long\ndwHighDateTime As Long\nEnd Type\n\nType SYSTEMTIME\nwYear As Integer\nwMonth As Integer\nwDayOfWeek As Integer\nwDay As Integer\nwHour As Integer\nwMinute As Integer\nwSecond As Integer\nwMilliseconds As Integer\nEnd Type\n\n\nConst GENERIC_READ = &amp;H80000000\nConst GENERIC_WRITE = &amp;H40000000\nConst FILE_SHARE_READ = &amp;H1\nConst FILE_SHARE_WRITE = &amp;H2\nConst CREATE_ALWAYS = 2\nConst CREATE_NEW = 1\nConst OPEN_ALWAYS = 4\nConst OPEN_EXISTING = 3\nConst TRUNCATE_EXISTING = 5\nConst FILE_ATTRIBUTE_ARCHIVE = &amp;H20\nConst FILE_ATTRIBUTE_HIDDEN = &amp;H2\nConst FILE_ATTRIBUTE_NORMAL = &amp;H80\nConst FILE_ATTRIBUTE_READONLY = &amp;H1\nConst FILE_ATTRIBUTE_SYSTEM = &amp;H4\nConst FILE_FLAG_DELETE_ON_CLOSE = &amp;H4000000\nConst FILE_FLAG_NO_BUFFERING = &amp;H20000000\nConst FILE_FLAG_OVERLAPPED = &amp;H40000000\nConst FILE_FLAG_POSIX_SEMANTICS = &amp;H1000000\nConst FILE_FLAG_RANDOM_ACCESS = &amp;H10000000\nConst FILE_FLAG_SEQUENTIAL_SCAN = &amp;H8000000\nConst FILE_FLAG_WRITE_THROUGH = &amp;H80000000\n\nFunction GetDateValue(fName As String) As String\n'returns UTC (GMT) file time for specified file\n\n    Dim hFile As Long ' handle to the opened file\n    Dim ctime As FILETIME ' receives time of creation\n    Dim atime As FILETIME ' receives time of last access\n    Dim mtime As FILETIME ' receives time of last modification\n    Dim Thetime As SYSTEMTIME ' used to manipulate the time\n    Dim retval As Long ' return value\n\n    hFile = CreateFile(fName, GENERIC_READ, FILE_SHARE_READ, _\n        ByVal CLng(0), OPEN_EXISTING, FILE_ATTRIBUTE_ARCHIVE, 0)\n\n    retval = GetFileTime(hFile, ctime, atime, mtime)\n\n    'Choose which date to return: creation, modify or access date\n    'retval = FileTimeToSystemTime(ctime, Thetime) 'extract creation datetime\n    retval = FileTimeToSystemTime(mtime, Thetime) 'extract modified datetime\n    'retval = FileTimeToSystemTime(atime, Thetime) 'extract accessed datetime\n\n    retval = CloseHandle(hFile)\n\n    With Thetime\n        GetDateValue = .wYear &amp; Format(.wMonth, \"\\-00\") &amp; _\n            Format(.wDay, \"\\-00\") &amp; \" \" &amp; Format(.wHour, \"00\") &amp; _\n            Format(.wMinute, \"\\:00\") &amp; Format(.wSecond, \"\\:00\") &amp; _\n            Format(.wSecond, \"\\.000\")\n    End With\nEnd Function\n\nSub test()\n    MsgBox GetDateValue(\"c:\\logfile.txt\") \n    'returns a string like \"2018-03-31 16:13:52.052\"\nEnd Sub\n</code></pre>\n\n<p>I'm just pasting this here, it isn't perfect but it works and can be adjusted to your individual needs.  Note that you need to manually uncomment the line for <em>which</em> datetime you want the function to return.</p>\n\n<p>Be sure to read up before you use this for anything important because there are limitations depending on your file system and more.  For example, NTFS will often finish writing a file after you \"think\" it's finished... up to 1 hour later.</p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>VB Forumus: <a href=\"http://www.vbforums.com/showthread.php?30537-GetFileTime&amp;p=120358&amp;viewfull=1#post120358\" rel=\"nofollow noreferrer\">Code Source</a> (note the author's error mentioned in his following post.)</p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724290(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows File Times</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724320(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetFileTime Function</a> (Windows/C++)</p></li>\n<li><p>Stack Overflow : <a href=\"https://stackoverflow.com/q/47951860/8112776\">VBA String with Milliseconds to Date</a></p></li>\n</ul>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1783, "favorite_count": 0, "accepted_answer_id": 49650833, "answer_count": 1, "score": 2, "last_activity_date": 1562935032, "creation_date": 1522840470, "last_edit_date": 1522844613, "question_id": 49649562, "link": "https://stackoverflow.com/questions/49649562/obtain-the-last-modified-date-of-a-file-with-milliseconds", "title": "Obtain the last modified date of a file with MILLISECONDS?", "body": "<p>I am trying to get the date and time (last modified) of some files from a folder.  I managed to get the date and hour/minutes/seconds but I can not get the <strong><em>milliseconds</em></strong>.</p>\n\n<p>I already tried formatting the column in all the ways possible. I only get <code>0</code> for milliseconds. </p>\n\n<p>My code so far does:  </p>\n\n<ul>\n<li><p>the user chooses a folder  </p></li>\n<li><p>the code displays in column A all the file names found and in column B the date, hour,minute and seconds (last modified date/time)  </p></li>\n</ul>\n\n<p>What should I do to the current code to obtain the milliseconds ?</p>\n\n<p>This is my code:  </p>\n\n<pre><code>Private Function GetAllFiles(ByVal strPath As String, _\n    ByVal intRow As Integer, ByRef objFSO As Object) As Integer\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim i As Integer\n    i = intRow - ROW_FIRST + 1\n    Set objFolder = objFSO.GetFolder(strPath)\n    For Each objFile In objFolder.Files\n        'print file name\n        Cells(i + ROW_FIRST + 2, 1) = objFile.Name\n        'print file path\n        Cells(i + ROW_FIRST + 2, 2) = objFile.DateLastModified\n        i = i + 1\n    Next objFile\n    GetAllFiles = i + ROW_FIRST - 1\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522878086, "post_id": 49649516, "comment_id": 86331432, "body": "Any reason why you don&#39;t simply get them to make their selections via a Slicer?"}, {"owner": {"reputation": 1, "user_id": 9590691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb648c534899ce9b8667f8ae361183e?s=128&d=identicon&r=PG&f=1", "display_name": "Ksm", "link": "https://stackoverflow.com/users/9590691/ksm"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1523031952, "post_id": 49649516, "comment_id": 86407268, "body": "The person I\u2019m doing this for doesn\u2019t want any slicers. However if it\u2019s something VBA really can\u2019t do, I just need confirmation so I can go in a different direction."}], "owner": {"reputation": 1, "user_id": 9590691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb648c534899ce9b8667f8ae361183e?s=128&d=identicon&r=PG&f=1", "display_name": "Ksm", "link": "https://stackoverflow.com/users/9590691/ksm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522840317, "creation_date": 1522840317, "last_edit_date": 1531161705, "question_id": 49649516, "link": "https://stackoverflow.com/questions/49649516/vba-listbox-pivottable-selection", "title": "VBA ListBox PivotTable Selection", "body": "<p>I have made a macro that creates a pivot table that filters based on a users selection from a list box. It first creates the pivot table and then adds the filters based on the listbox selection. Here is an example:</p>\n\n<pre><code>If ListBox1 = (\"Fred\") Then\n  ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Employee\").CurrentPage = _\n    \"(All)\"\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Employee\")\n    .PivotItems(\"Tom\").Visible = False\n    .PivotItems(\"John\").Visible = False\n    .PivotItems(\"Mary\").Visible = False\nEnd If\n</code></pre>\n\n<p>To further elaborate, if the user selects Fred in the ListBox, it filters out all other employees, in this case, Tom, John, and Mary. </p>\n\n<p>Here is the issue. One of the ListBoxes I'm creating allows for the user to select multiple items. This means I'd need to hard code all combinations/permutations of the items into vba. Is there a way I could do this without individually coding every possible user choice combination? </p>\n\n<p>Please let me know if I need to provide more detail. </p>\n\n<p>Thanks,</p>\n\n<p>KJ</p>\n"}, {"tags": ["vba", "excel", "criteria", "copy-paste"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522841679, "post_id": 49649462, "comment_id": 86307873, "body": "Please clarify what you want to see happen and what is actually happening."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522842479, "post_id": 49649462, "comment_id": 86308436, "body": "1. When i run the macro, i want it copy the inserted data into that sheet depending on, what is choosen in cell &quot;D3&quot; - I have 12 options and 12 sheets, that it needs to copy to.  2. Right now, when i say run macro, it just copies to the sheet &quot;Opsamling&quot; with 17 empty rows - I have 17 rows filled with data - I dont want it to jump 17 rows, i wanted to start from the top and just move Down, when i run the macro Again - also when there comes new data.  I hope that is more clarifying."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522842581, "post_id": 49649462, "comment_id": 86308502, "body": "You may need to show more code as I can&#39;t see Opsamling or D3 referenced."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522842784, "post_id": 49649462, "comment_id": 86308633, "body": "That is all the code that i have, i have made everything else manuelle - But i couldnt move further, because i needed help from vba."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522842869, "post_id": 49649462, "comment_id": 86308691, "body": "My D3 options are: &quot;1. a&quot;;&quot;2.b&quot;;3.c&quot; and so on."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522844134, "post_id": 49650585, "comment_id": 86309574, "body": "Thank you so much, it looks very complicated - I just tried to copy it all and let it take a run, but it wont? it says &quot;run-time error 9 - Subsript out of range&quot;."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522844645, "post_id": 49650585, "comment_id": 86309956, "body": "I don&#39;t expect this to solve your problems. I think more information is required. It does show you how to use a value in a cell to determine which sheet to copy paste to and how to find the next row."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522844947, "post_id": 49650585, "comment_id": 86310177, "body": "Just tried it, and it Works perfectly - Thank you so much! I wouldnt have done it, if i was working with in 5 months of time! where should i Places these two &quot;Range(&quot;A1&quot;).PasteSpecial xlPasteValues     Range(&quot;A1&quot;).PasteSpecial xlPasteColumnWidths&quot; ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522845207, "post_id": 49650585, "comment_id": 86310355, "body": "You can simply do  targetSheet.Columns.AutoFit"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522845718, "post_id": 49650585, "comment_id": 86310732, "body": "You are simply my hero - Thank you so much! - I have two last quetions. 1. I want the data to always go Down instead of it gets under the first copy? What should i change? 2. I have protected everything, but when i run the code it cant copy over because it is protected - what can i do to change that?  Thank you so much, sir! You have helped me enormously."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522846389, "post_id": 49650585, "comment_id": 86311244, "body": "I don&#39;t know what you mean by down? If you are copying the same data and you simply want to overwrite then  change this  targetSheet.Range(&quot;A&quot; &amp; nextRow) to this targetSheet.Range(&quot;A1&quot;)"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522850969, "post_id": 49650585, "comment_id": 86314898, "body": "Hello sir, Again - I dont want to overwrite it, but when i let the macro run come up on the top and the older Down just move Down, if it makes sense."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522851011, "post_id": 49650585, "comment_id": 86314934, "body": "About the protected sheets, i have this code: Sub Workbook_Open()  Application.ScreenUpdating = False  For Each ws In Sheets   With ws  .Unprotect Password:=&quot;MKM&quot;  .Protect Password:=&quot;MKM&quot;, UserInterfaceOnly:=True  .EnableOutlining = True  End With   Next ws   Application.ScreenUpdating = True   End Sub&quot;  When i use your code with this one, it would not run, because it cant copy to a protected sheets - I want it all to be protected, but how can i also copy to another sheets and still let be protected?"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522852270, "post_id": 49650585, "comment_id": 86315972, "body": "Thank for you time, sir - I&#180;m really appreciate! - When i try to run it know, it says the passwords is wrong, even though i try to put it as it is - Can i maybe send you the file on e-mail?"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522852360, "post_id": 49650585, "comment_id": 86316056, "body": "No it dosent? I dont know why."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522852603, "post_id": 49650585, "comment_id": 86316273, "body": "Just tried, and it cant figure it out - Error 1004 comes up - Should i send you the file maybe?"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522852898, "post_id": 49650585, "comment_id": 86316528, "body": "I have just copied and pasted yours? Isnt it better to send you the file maybe?"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522853235, "post_id": 49650585, "comment_id": 86316803, "body": "I had thise error before and im actually pretty sure it has something to do with the password - The sheets names are all fine."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522853451, "post_id": 49650585, "comment_id": 86316959, "body": "Now try changing the password to something else and run it - i wont, right?"}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522853516, "post_id": 49650585, "comment_id": 86317004, "body": "I once protected with a password and then i changed it and it the error 1004 came always up, then i change the password back Again and was solved - But this time nothing of it Works."}, {"owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "edited": false, "score": 0, "creation_date": 1522853567, "post_id": 49650585, "comment_id": 86317048, "body": "I know the password - I dont know why it comes up, this times, but it must have something to do with the password i guess."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1522844542, "last_edit_date": 1522844542, "creation_date": 1522843575, "answer_id": 49650585, "question_id": 49649462, "link": "https://stackoverflow.com/questions/49649462/copy-to-other-worksheets-depending-on-criteria/49650585#49650585", "title": "Copy to other worksheets depending on criteria", "body": "<p>Here is what something might look like that uses D3 to target copying to another sheet. I expect this would have to be further refined as you supply more detail. This assume D3 hold a valid sheet name to copy to. It continually takes everything from the source sheet so you will end up with duplicate data. If you only want new rows transferred then you will need to track row count somewhere (potentially in another sheet).</p>\n\n<pre><code>Option Explicit\n\nSub Copypastemeddata()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim sourceCell As Range\n    Dim targetSheet As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Opg\u00f8rsel\")\n\n    Set sourceCell = ws.Range(\"D3\")  'Cell with sheet names for copying to\n\n    With ws\n\n          Set targetSheet = wb.Worksheets(sourceCell.Text)\n\n          Dim nextRow As Long\n          nextRow = GetLastRow(targetSheet, 1)\n          nextRow = IIf(nextRow = 1, 1, nextRow + 1)\n\n         .Range(\"A1\").CurrentRegion.Copy targetSheet.Range(\"A\" &amp; nextRow)\n\n    End With\n\nEnd Sub\n\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n\n    With ws\n\n      GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n\n    End With\n\nEnd Function\n</code></pre>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wNKsI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wNKsI.gif\" alt=\"Test run\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 9596212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5e55ac617ce7d22bd5927da071470c?s=128&d=identicon&r=PG&f=1", "display_name": "MzBarcaaa", "link": "https://stackoverflow.com/users/9596212/mzbarcaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49650585, "answer_count": 1, "score": 1, "last_activity_date": 1522844542, "creation_date": 1522840091, "last_edit_date": 1522840725, "question_id": 49649462, "link": "https://stackoverflow.com/questions/49649462/copy-to-other-worksheets-depending-on-criteria", "title": "Copy to other worksheets depending on criteria", "body": "<p>I am all new to VBA and are stuck. I have seen some Youtube videos and some threads here, but it is complicated for me - I hope, that some of you can help me :)  </p>\n\n<p>I use the macro below and have these obstacles with it.  </p>\n\n<ol>\n<li><p>When I run it, it leaves the first rows empty and when I insert new data and run it, Again, it just moves everything Down perfectly as I wanted it, but it dosent fill the empty cells - It just starts at row 17, because in the worksheet <code>Opg\u00f8rsel</code> I have 17 rows filled with data - I dont know, why it jumps like that.  </p></li>\n<li><p>In sheet <code>opg\u00f8rsel</code>, I have 12 options in cell <code>D3</code>  and depending on which option is chosen, I want it to copy it to that sheet - I have made 12 sheets as well - But I dont know how to make it like that.   </p></li>\n</ol>\n\n<p>.</p>\n\n<pre><code>Sub Copypastemeddata()\n    Worksheets(\"Opg\u00f8rsel\").Activate\n    Range(\"A1\").CurrentRegion.Copy\n    Worksheets(\"Opsamling\").Activate\n    Range(\"A1\").PasteSpecial\n    Range(\"A1\").PasteSpecial xlPasteValues\n    Range(\"A1\").PasteSpecial xlPasteColumnWidths\n    Selection.Insert Shift:=xlDownenter\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522839474, "post_id": 49649161, "comment_id": 86306437, "body": "Suggestion: Make an easier IF. Just if B5=USD then hide, if not, unhide. There is no need to specify B5=&quot;LC&quot;. If B5=USD then Hide Else Unhide."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522839749, "post_id": 49649161, "comment_id": 86306621, "body": "@QHarr Yes, sorry, i typed fast and did not the proper format. Let me fix it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522839825, "post_id": 49649161, "comment_id": 86306669, "body": "What does doesn&#39;t immediately unhide mean? At present it will hide if B5 is &quot;USD&quot; and unhide if &quot;LC&quot;. Seems to run perfectly well for me."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522839907, "post_id": 49649161, "comment_id": 86306726, "body": "@QHarr Ok, comments can be edited only in the first 5 minutes and i can&#39;t fix it :O Sorry about that."}, {"owner": {"reputation": 11, "user_id": 9486049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AsZ", "link": "https://stackoverflow.com/users/9486049/asz"}, "edited": false, "score": 0, "creation_date": 1522850023, "post_id": 49649161, "comment_id": 86314133, "body": "Dear all, I have tried all the solutions as mentioned, but unfortunately, my issue is still not solved. I have included some further explanations that may help. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1522839618, "post_id": 49649264, "comment_id": 86306532, "body": "Or you can even go with one liner like this: <code>Union(Columns(&quot;C&quot;), Columns(&quot;E&quot;)).EntireColumn.Hidden = cbool(Range(&quot;B5&quot;).Value = &quot;USD&quot;)</code>"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1522839782, "post_id": 49649264, "comment_id": 86306646, "body": "On a side note, although the event is not the good one, the code is working correctly on my side. It&#39;s just fired more times than necessary, but it&#39;s not because of the event chosen that the OP has the issue - I guess it&#39;s more about ScreenUpdating issues."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1522839838, "post_id": 49649264, "comment_id": 86306674, "body": "@Vityata - smart!  You won&#39;t be offended if I added that to the answer for the OP?"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1522839865, "post_id": 49649264, "comment_id": 86306690, "body": "and in case if the sheets are dynamically added, then you could go with something like <b>Workbook_SheetSelectionChange</b> and this will then start working for all worksheets. This sub needs to be put inside the ThisWorkbook Module. Also, you can write an if loop inside this sub to control which sheet needs to be considered and which one doesn&#39;t need to be considered."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1522842600, "post_id": 49649264, "comment_id": 86308513, "body": "@ashleedawg - nope, it&#39;s perfect :)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1522840091, "last_edit_date": 1522840091, "creation_date": 1522839506, "answer_id": 49649264, "question_id": 49649161, "link": "https://stackoverflow.com/questions/49649161/vba-is-not-updating-automatically-after-input/49649264#49649264", "title": "VBA is not updating automatically after input", "body": "<p>You're using the wrong event.</p>\n\n<p><code>SelectionChange</code> fires when you select a different cell, etc.</p>\n\n<p><code>Change</code> fires immediately after a cell's contents change.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"B5\").Value = \"USD\" Then\n        Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = True\n    ElseIf Range(\"B5\").Value = \"LC\" Then\n        Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = False\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Alternate Solution:</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target = Range(\"B5\") Then Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = (Target.Value = \"USD\")\nEnd Sub\n</code></pre>\n\n<p><sub>(adapted from @Vityata's <a href=\"https://stackoverflow.com/questions/49649161/vba-is-not-updating-automatically-after-input#comment86306532_49649264\">comment below</a>)</sub></p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-selectionchange-event-excel\" rel=\"nofollow noreferrer\"><strong><code>Worksheet.SelectionChange</code> Event</strong> (Excel)</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\"><strong><code>Worksheet.Change</code> Event</strong> (Excel)</a></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9486049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AsZ", "link": "https://stackoverflow.com/users/9486049/asz"}, "edited": false, "score": 0, "creation_date": 1522850473, "post_id": 49649347, "comment_id": 86314513, "body": "Thank you for the detailed explanation. I have tried this VBA code, but unfortunately it is not working. I have included some further explanation in my initial question. Thank you."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1522858488, "post_id": 49649347, "comment_id": 86320546, "body": "One is assuming that Range(&quot;B5&quot;) is changed physically. That would be the only way Worksheet_change event would kick in."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1522839734, "creation_date": 1522839734, "answer_id": 49649347, "question_id": 49649161, "link": "https://stackoverflow.com/questions/49649161/vba-is-not-updating-automatically-after-input/49649347#49649347", "title": "VBA is not updating automatically after input", "body": "<p>A few changes to your code: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$B$5\" Then\n        If Range(\"B5\").Value = \"USD\" Then\n            Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = True\n        Else\n            Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = False\n        End If\n        Application.Calculate\n    End If\nEnd Sub\n</code></pre>\n\n<p>1: the right event is <code>Change</code> (when a value changes in the sheet), not <code>SelectionChange</code> (when the selection changes). </p>\n\n<p>2: Your code works on my side, so I guess it's not working on your side because you have some calculation off. I've added the line <code>Application.Calculate</code> which will refresh the spreadsheet even if your calculations are set to manual. </p>\n\n<p>3: I've added an <code>If Target.Address</code> condition to check only when the cell that changed is the right one. </p>\n\n<p>4: I've added just <code>Else</code> instead of <code>ElseIf cell = \"LC\"</code>, because it's faster and because I think it's cleaner (if the user removes completely the value of the currency and before it was USD, nobody will unhide the columns C and E). </p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1522846945, "creation_date": 1522846945, "answer_id": 49651775, "question_id": 49649161, "link": "https://stackoverflow.com/questions/49649161/vba-is-not-updating-automatically-after-input/49651775#49651775", "title": "VBA is not updating automatically after input", "body": "<p>Keep it simple,</p>\n\n<pre><code>    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim rng As Range\n    Set rng = Range(\"B5\")\n    If rng.Value = \"USD\" Then Columns(\"C:E\").EntireColumn.Hidden = True\n    If rng.Value = \"LC\" Then Columns(\"C:E\").EntireColumn.Hidden = False\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9486049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AsZ", "link": "https://stackoverflow.com/users/9486049/asz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1522849907, "creation_date": 1522839152, "last_edit_date": 1522849907, "question_id": 49649161, "link": "https://stackoverflow.com/questions/49649161/vba-is-not-updating-automatically-after-input", "title": "VBA is not updating automatically after input", "body": "<p>I have created a Excel workbook for my work where I collect information. In this workbook I have a sheet where details in various currencies can be filled in. Based on the selection by the preparer the value in cell B5 will change to either USD or LC. In case the value in cell B5 will be USD, columns C and E should be hidden. The issue in here is that this code will not immediately unhide the columns. After clicking on a random cell, the columns are hidden. Please let me know if there is a solution for this issue whereby the columns are hidden without clicking on a random cell each time. Thank you.  </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Range(\"B5\").Value = \"USD\" Then\n        Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = True\n    ElseIf Range(\"B5\").Value = \"LC\" Then\n        Union(Columns(\"C\"), Columns(\"E\")).EntireColumn.Hidden = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thank you all for your comments. Let me further elaborate on my issue. In principle my VBA code works. The only thing is that after cell B5 is changed to USD, initially nothing happens. After I click on a random cell in this sheet, the VBA code works and hide the columns. The same is applicable in case the value in cell B5 is LC. Then again the VBA code does not work immediately. After clicking on a random cell in the sheet the columns are unhided.</p>\n\n<p>A small update with respect to cell B5. So cell B5 contains a formula that is linked to listed cell in another sheet. After a value is selected from the list in another sheet, cell B5 will determine through the IF functions if the value in B5 will be LC or USD. </p>\n\n<p>I am now afraid that after the preparer select in the listed cell a value, it will not click on a random cell in designated sheet resulting that he or she will see the wrong information. </p>\n\n<p>Please let me know if you require further information. Thank you. </p>\n\n<p>PS. I am not very strong in creating VBA codes. </p>\n"}, {"tags": ["vba", "listview"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522839107, "post_id": 49649106, "comment_id": 86306213, "body": "Can you clarify what you mean by <code>push those values into the selected items subitems (columns)</code>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1522839159, "post_id": 49649106, "comment_id": 86306241, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47195174/cant-get-listed-of-selected-items-from-multiselect-listbox-in-excel-userform\">Can&#39;t get listed of selected items from multiselect ListBox in Excel userform</a>"}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522839654, "post_id": 49649106, "comment_id": 86306559, "body": "I can use this to write the values to the listview:  ListView1.SelectedItem.SubItems(7) = SparesQty.Text .  I am using a listview not listbox."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840331, "post_id": 49649293, "comment_id": 86307016, "body": "MsgBox is coming back empty - no values"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840447, "post_id": 49649293, "comment_id": 86307097, "body": "check if your listview is filled with data ? and did you change the &#39;myListview&#39; with your listview name ?"}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840518, "post_id": 49649293, "comment_id": 86307125, "body": "Listview is definitely filled and I changed the code to match my controls names."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840554, "post_id": 49649293, "comment_id": 86307142, "body": "first column is a check box, would that matter?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840645, "post_id": 49649293, "comment_id": 86307199, "body": "Strange ! Where did you put the code ? did you put it in a Command Button Click event ?"}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522840693, "post_id": 49649293, "comment_id": 86307235, "body": "I think I have it -ListView1.SelectedItem.SubItems(i) gives me back the row data now All I need to do is step through rows. I will report back ASAP."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522841208, "post_id": 49649293, "comment_id": 86307549, "body": "so I have added link to an image in the original post of what I need to do. All I get back for the above code is the last row selected in the listview"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522841216, "post_id": 49649293, "comment_id": 86307556, "body": "If you are selecting with checking the checkboxes, Changing the &#39;ListView1.ListItems.Item(i).Selected&#39; to &#39;ListView1.ListItems.Item(i).Checked&#39; in The above code will resolve your problem .."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522841409, "post_id": 49649293, "comment_id": 86307675, "body": "I want the user to be able to add the selected text in the listboxes below the listview to the empty cells in the listview and then later when finished processing have only the check boxed items acted upon, hence the reason for multi-select and checkboxes. So the multi select is for the text updates and the check box is for the fial processing."}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1522842149, "post_id": 49649293, "comment_id": 86308188, "body": "I&#39;m sorry I can&#39;t check the picture, because of security problem at work .. It shows access denied .. I edited my answer so that you can change a value of a column in your listview , Check it .. Hope it helps .."}], "tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1522842130, "last_edit_date": 1522842130, "creation_date": 1522839610, "answer_id": 49649293, "question_id": 49649106, "link": "https://stackoverflow.com/questions/49649106/getting-selections-of-multiselect-listview-on-vba-userform/49649293#49649293", "title": "Getting Selections of Multiselect ListView on VBA UserForm", "body": "<p>To Get The selected Items, use the code :</p>\n\n<pre><code>ListeCount = myListview.ListItems.Count\nFor i = 1 To ListeCount\n        If myListview.ListItems.Item(i).Selected Then\n        MsgBox myListview.ListItems.Item(i).Text\n    End If\nNext i\n</code></pre>\n\n<p>EDIT #1 :</p>\n\n<pre><code>ListeCount = myListview.ListItems.Count\nFor i = 1 To ListeCount\n    If myListview.ListItems.Item(i).Checked Then\n            MsgBox myListview.ListItems.Item(i).Text\n            'Check if The column 2 of item 'i' is empty\n            If myListview.ListItems.Item(i).SubItems(1) = vbNullString Then\n                'Fill the empty column with a value\n                myListview.ListItems.Item(i).SubItems(1) = \"Test\"\n            End If\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2041, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522842130, "creation_date": 1522838971, "last_edit_date": 1522841148, "question_id": 49649106, "link": "https://stackoverflow.com/questions/49649106/getting-selections-of-multiselect-listview-on-vba-userform", "title": "Getting Selections of Multiselect ListView on VBA UserForm", "body": "<p><a href=\"https://i.stack.imgur.com/Cl5Ds.png\" rel=\"nofollow noreferrer\">listview sample</a>I am using a listview on a user form. I have multi-select enabled. I would like to select multiple items in the listview and then take the value found in some other text boxes on the same form and push those values into the selected items subitems (columns). The listview is somewhat of a new beast to me. I have the listview filling without issue. I am able to push data to a single selected row, but I am at a loss on how to get all the selected rows indexes and then push to all the subitems accordingly. I end up only getting the last selected row. </p>\n\n<p>Thx.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522837184, "post_id": 49648437, "comment_id": 86304970, "body": "What data is contained in an array?  An single value goes into a single cell.  Arrays are not single values. What would you <i>like</i> to have happen? Also, unrelated issue, but generally functions are used for <i>returning values</i>."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1522837270, "post_id": 49648437, "comment_id": 86305029, "body": "How many columns and rows has the usedrange causing that splitting?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1522837439, "post_id": 49648437, "comment_id": 86305138, "body": "your array item(s) for header (first row of array) has line feed in it. Replace it with blank."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1522837945, "post_id": 49648437, "comment_id": 86305451, "body": "I suspect in <code>ws.UsedRange</code> at least some cells in first two rows are merged over the rows. So it looks like one row but is two rows in real."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522839392, "post_id": 49648437, "comment_id": 86306389, "body": "@ashleedawg Edited the OP, to include an example of how the data in the worksheets is. I would like the data to go out of the worksheet into the array and into the new workbook without any changes in how it is organized."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522839670, "post_id": 49648437, "comment_id": 86306566, "body": "@DisplayName for one specific worksheet that has 2772 columns, it breaks at 2520, with the last 251 being on row 2 (all the data below that is normal)"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1522839691, "post_id": 49648437, "comment_id": 86306578, "body": "@cyboashu Sorry, I dont get what you mean, could you explain?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1522839732, "post_id": 49648437, "comment_id": 86306608, "body": "@AxelRichter No merged cells in this file, all identifiers are in one single cell."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522841896, "post_id": 49648437, "comment_id": 86308016, "body": "I am not sure if there is something wrong with the code per se. I can run it with as many columns as are available and rows. However, I haven&#39;t tested the impact of merged cells or line feed being present."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522843000, "post_id": 49648437, "comment_id": 86308777, "body": "@QHarr So, as I updated in the OP, the data gets transferred properly, the problem arrives when I save it as csv."}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522841884, "creation_date": 1522836788, "last_edit_date": 1522841884, "question_id": 49648437, "link": "https://stackoverflow.com/questions/49648437/saving-an-array-to-new-workbook", "title": "Saving an array to new workbook", "body": "<p><strong>Scenario:</strong> I have a workbook with multiple worksheets. I am trying to use a function (called within a sub) to export arrays with data from certain worksheets. The arrays are created before the function with the content from the worksheet with:</p>\n\n<pre><code>If ws.Name = \"AA\" Then\n            expaa = ws.UsedRange.Value\nEnd if\n</code></pre>\n\n<p>where <code>expaa</code> is previously defined as variant.</p>\n\n<p>The function I am using apparently finishes running, but the output on the new file saved is weird: instead of having one row of headers, the first row is split into 2 for some reason (all the others remain the same).</p>\n\n<p><strong>This is the function I am using:</strong></p>\n\n<pre><code>Function Exporter(arr As Variant, y As String, OutPath As String) As Variant\n    Dim lrow As Long, lColumn As Long\n    Dim w2 As Workbook\n    Dim d As Date\n\n    Workbooks.Add\n    Set w2 = ActiveWorkbook\n\n    w2.Worksheets(1).Range(\"A1\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr       \n    Application.DisplayAlerts = False\n    w2.SaveAs Filename:=OutPath &amp; \"\\\" &amp; y, FileFormat:=6\n    Application.DisplayAlerts = True\n\n    w2.Close True\n\nEnd Function\n</code></pre>\n\n<p>Which I call from the main sub with:</p>\n\n<pre><code>If aa_name &lt;&gt; \"\" Then\n    Exporter expaa , \"aa_OK\", wbpath\nEnd If\n</code></pre>\n\n<p>where aa_name is the name of the file used to retrieve the path.</p>\n\n<p><strong>Obs:</strong> The wbpath variable is a string with the path of my main workbook (therefore the new file is saved at the same location).</p>\n\n<p><strong>Question:</strong> What may be causing the first row of my output to be split? How can that be fixed?</p>\n\n<p><strong>Obs2:</strong> I know this can be done with copy procedure, and looping through the array and so on. I even got it to work with other methods. This post is only to understand what I am doing wrong with the current code.</p>\n\n<p><strong>Obs3:</strong> Regarding the data that is going to be passed: it is a matrix of days, identifiers and data, ex:</p>\n\n<pre><code>               Item1      Item2     Item3\n01/01/2000      1           1         2\n02/01/2000      1           2         1\n03/01/2000      2           2         2\n</code></pre>\n\n<p>with around 2000 rows and 3000 columns.</p>\n\n<p><strong>UPDATE:</strong> After retesting the code multiple times, It appears that the data of the first row only gets split when the file is save as csv (when the array is pasted, the output is normal). Any idea on what may be the cause for that?</p>\n"}, {"tags": ["vba", "excel", "object", "get"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522840642, "post_id": 49648366, "comment_id": 86307196, "body": "You don&#39;t need the Hungarian notation also what is GetUsername? Was the top part originally a function you called in the bottom?"}], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": true, "score": 0, "last_activity_date": 1522838200, "creation_date": 1522838200, "answer_id": 49648885, "question_id": 49648366, "link": "https://stackoverflow.com/questions/49648366/vba-combine-getoject-and-getusername-to-return-actual-name-of-logged-on-user-ins/49648885#49648885", "title": "VBA Combine GetOject and GetUsername to return actual name of logged on User instead of code", "body": "<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nSet objAD = CreateObject(\"ADSystemInfo\")\nSet objUser = GetObject(\"LDAP://\" &amp; objAD.Username)\nstrDisplayName = objUser.DisplayName\n\nIf Not Application.Intersect(Range(\"E6:N9000\"), Target) Is Nothing Then\n    If Target = \"NA\" Then\n        Cancel = True\n        Exit Sub\n    Else\n        If Target = vbNullString Then\n            Target = strDisplayName &amp; \" \" &amp; Format(Now, \"DD/MM/yy HH:MM:ss\")\n            Target.Interior.ColorIndex = 43\n            Cancel = True\n        Else\n            If Target &lt;&gt; vbNullString Then\n                Target = \"\"\n                Target.Interior.ColorIndex = 0\n                Cancel = True\n            End If\n        End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1522841003, "creation_date": 1522841003, "answer_id": 49649719, "question_id": 49648366, "link": "https://stackoverflow.com/questions/49648366/vba-combine-getoject-and-getusername-to-return-actual-name-of-logged-on-user-ins/49649719#49649719", "title": "VBA Combine GetOject and GetUsername to return actual name of logged on User instead of code", "body": "<p>Maybe?</p>\n\n<pre><code>Option Explicit\n\nPublic Function Username() As String\n\n    Dim AD As Object\n    Dim User As Object\n\n    Set AD = CreateObject(\"ADSystemInfo\")\n    Set User = GetObject(\"LDAP://\" &amp; AD.Username)\n\n     Username = User.DisplayName\n\nEnd Function\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    If Not Application.Intersect(Range(\"E6:N9000\"), Target) Is Nothing Then\n\n        Select Case Target\n\n        Case \"NA\"\n            Cancel = True\n            Exit Sub\n\n        Case vbNullString\n                Target = Username &amp; \" \" &amp; Format$(Now, \"DD/MM/yy HH:MM:ss\")\n                Target.Interior.ColorIndex = 43\n\n        Case Else\n                Target = vbNullString\n                Target.Interior.ColorIndex = 0\n\n        End Select\n\n        Cancel = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8085556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652ae46c7cddce8c0897cf73d73050d5?s=128&d=identicon&r=PG&f=1", "display_name": "tbolge74", "link": "https://stackoverflow.com/users/8085556/tbolge74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 49648885, "answer_count": 2, "score": 0, "last_activity_date": 1522841003, "creation_date": 1522836579, "question_id": 49648366, "link": "https://stackoverflow.com/questions/49648366/vba-combine-getoject-and-getusername-to-return-actual-name-of-logged-on-user-ins", "title": "VBA Combine GetOject and GetUsername to return actual name of logged on User instead of code", "body": "<p>I have two codes, the first picks up a full name (first and Surname) of the user and prints in a display box as \"Doe, John\".</p>\n\n<p>The second picks up the user ID when they double click on a cell in a defined range and prints the ID as \"A012345\" with the current time and date.</p>\n\n<p>I would like to combine the two so that instead of <strong><em>\"A012345 04/04/18 10:19:14\"</em></strong> \nI get <strong><em>\"Doe, John 04/04/18 10:19:14\"</em></strong></p>\n\n<p><strong>Code 1</strong></p>\n\n<pre><code>Sub Username()\nSet objAD = CreateObject(\"ADSystemInfo\")\nSet objUser = GetObject(\"LDAP://\" &amp; objAD.Username)\nstrDisplayName = objUser.DisplayName\nMsgBox strDisplayName\nEnd Sub\n</code></pre>\n\n<p><strong>Code 2</strong></p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim i\nDim Myrow As Integer\nDim lpBuff As String * 25\nDim ret As Long, Username As String\n\nret = GetUsername(lpBuff, 25)\nUsername = Left(lpBuff, InStr(lpBuff, Chr(0)) - 1)\n\n\ni = Status\n\nIf Not Application.Intersect(Range(\"E6:N9000\"), Target) Is Nothing Then\n    If Target = \"NA\" Then\n    Cancel = True\n    Exit Sub\n\n    Else\n  If Target = vbNullString Then\n    Target = Username &amp; \" \" &amp; Format(Now, \"DD/MM/yy HH:MM:ss\")\n     Target.Interior.ColorIndex = 43\n  Cancel = True\nElse\n    If Target &lt;&gt; vbNullString Then\n        Target = \"\"\n        Target.Interior.ColorIndex = 0\n        Cancel = True\n    End If\n    End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522836432, "post_id": 49648194, "comment_id": 86304470, "body": "Look at arrays, an array of workbooks <code>dim array() as excel.workbook</code>.  Redim the array to <code>.selecteditems.count</code> and then use a counter in your existing loop, to say <code>set array(counter)=workbooks.open(filepath)</code>"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522836503, "post_id": 49648194, "comment_id": 86304523, "body": "Ahh thats a very clever way. I shall have a fidle with that and see what I can come up with. Thank you"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1522836667, "post_id": 49648194, "comment_id": 86304646, "body": "or a <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/collection-object\" rel=\"nofollow noreferrer\">Collection</a>"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522837244, "post_id": 49648194, "comment_id": 86305016, "body": "@Nathan_Sav I have had a play with your idea, and cant seem to get it working, I&#39;ve added an edit to the end of  the question with my new code . Can you see my mistake?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522837450, "post_id": 49648194, "comment_id": 86305145, "body": "<code>set</code> should be there I believe.  Or even the native <code>workbooks()</code> collection may suffice?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522838341, "post_id": 49648194, "comment_id": 86305718, "body": "I wouldn&#39;t bother with the 1, see below using an array to simulate the filedialog results."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1522839528, "last_edit_date": 1522839528, "creation_date": 1522838241, "answer_id": 49648899, "question_id": 49648194, "link": "https://stackoverflow.com/questions/49648194/set-multiple-workbook-when-opening-more-than-one/49648899#49648899", "title": "Set Multiple Workbook, when opening more than one", "body": "<p>Not using the filedialog, but a similar approach, this is how I would tackle your issue</p>\n\n<pre><code>Public arrWorkbooks() As Excel.Workbook\n\nSub open_workbooks()\n\nDim strWorkbookPaths(2) As String\nDim intCounter As Integer\n\nstrWorkbookPaths(0) = \"C:\\Workspace\\Dummy Data\\test1.xlsx\"\nstrWorkbookPaths(1) = \"C:\\Workspace\\Dummy Data\\test2.xlsx\"\nstrWorkbookPaths(2) = \"C:\\Workspace\\Dummy Data\\test3.xlsx\"\n\nReDim arrWorkbooks(UBound(strWorkbookPaths))\n\nFor intCounter = 0 To UBound(strWorkbookPaths)\n\n    Set arrWorkbooks(intCounter) = Workbooks.Open(strWorkbookPaths(intCounter))\n\nNext intCounter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522861322, "creation_date": 1522861322, "answer_id": 49656581, "question_id": 49648194, "link": "https://stackoverflow.com/questions/49648194/set-multiple-workbook-when-opening-more-than-one/49656581#49656581", "title": "Set Multiple Workbook, when opening more than one", "body": "<p>There\u2019s a </p>\n\n<pre><code>Workbook\n</code></pre>\n\n<p>that must be:</p>\n\n<pre><code>Workbooks\n</code></pre>\n\n<p>And you don\u2019t need a 2D array </p>\n\n<p>So your code can be as follows:</p>\n\n<pre><code>Public WorkBookArray() As Excel.Workbook\nSub Channel_1()\n     With Application.FileDialog(msoFileDialogFilePicker) ' Opens a File Exploer dialog box '\n        .ButtonName = \"Select\"\n        .AllowMultiSelect = True  ' Disables the abilty to select more than 1 file\n        .InitialView = msoFileDialogViewDetails ' Sets the start location '\n        .Show ' Allows it to be seen '\n\n        ReDim WorkBookArray(1 To .SelectedItems.Count)\n\n        For Each oFD In .SelectedItems ' This is used to create a file path used to open the file\n            counter = counter + 1\n            Set WorkBookArray(counter,1) = Workbooks.Open(oFD)\n        Next \n     End With\nEnd Sub\n</code></pre>\n\n<p>Of course, as soon as any of those workbook gets clised, the corresponding item in WorkBookArray() becomes a null reference</p>\n"}], "owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522861322, "creation_date": 1522836116, "last_edit_date": 1522837598, "question_id": 49648194, "link": "https://stackoverflow.com/questions/49648194/set-multiple-workbook-when-opening-more-than-one", "title": "Set Multiple Workbook, when opening more than one", "body": "<p>I have a samll issue, I would like to be able to set workbooks as variables like so <code>Set MainWorkBook = ActiveWorkBook</code>, which is easy and great, however I now have to be able to open multiple unique workbook ranging from 2 to 50 or so depending on what I'm using  the code for. </p>\n\n<p>Ideally I would like to havethe first file selected as <code>1Book</code> then the second file selected as <code>2Book</code> etc. So they can be easily reference later on in the code </p>\n\n<p>Using this idea I would need to use a for loop, something like </p>\n\n<pre><code>For i = 1 To NUMBEROFOPENEDWORKBOOKS\n\n    WorkBookName = i &amp; \"Book\"\n\n\n    Set WorkBookName = ActiveWorkbook\n\nNext i\n</code></pre>\n\n<p>Where, <code>NUMBERIFOPENEDWORKBOOKS</code> is sudo code for a variable that defines how many workbooks i've selected, and then placed witin the <code>For Each</code> section of the code below. </p>\n\n<p>I open the workbooks using the code below. </p>\n\n<pre><code>Set FileChoice = Application.FileDialog(msoFileDialogFilePicker) ' Opens a File Exploer dialog box '\n\nWith FileChoice ' This is used to set what is being displayed '\n\n    .ButtonName = \"Select\"\n    .AllowMultiSelect = True  ' Enables the abilty to select more than 1 file\n    .InitialView = msoFileDialogViewDetails ' Sets the start location '\n    .Show ' Allows it to be seen '\n\n    For Each oFD In .SelectedItems ' This is used to create a file path used to open the file\n\n        FilePath = oFD\n        Workbooks.Open (FilePath)\n\n    Next oFD\n\nEnd With\n</code></pre>\n\n<p>I tried to add a for loop within the code using <code>.selectedItems</code> but that only confirmed that it would fail</p>\n\n<p>I hope all of this made sense.\nThank you for any help you can give. </p>\n\n<p><strong>EDIT 1</strong><br>\nI have taken the advide form the comment and trie to use an Arraty function to solve this, however when I run the code below, I get a <code>Object Required</code> error. </p>\n\n<p>Have I made a totaly clearing error that I can't see? </p>\n\n<pre><code>Public WorkBookArray() As Excel.Workbook\nSub Channel_1()\n\nSet FileChoice = Application.FileDialog(msoFileDialogFilePicker) ' Opens a File Exploer dialog box '\n\n    With FileChoice ' This is used to set what is being displayed '\n\n        .ButtonName = \"Select\"\n        .AllowMultiSelect = True  ' Disables the abilty to select more than 1 file\n        .InitialView = msoFileDialogViewDetails ' Sets the start location '\n        .Show ' Allows it to be seen '\n\n        ReDim WorkBookArray(.SelectedItems.Count, 1)\n\n        For Each oFD In .SelectedItems ' This is used to create a file path used to open the file\n\n            FilePath = oFD\n            counter = counter + 1\n            Set WorkBookArray(counter,1) = Workbook.Open(FilePath)\n\n        Next oFD\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform", "setfocus"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522839249, "post_id": 49648098, "comment_id": 86306296, "body": "Why are you not exiting the sub between before the error handler starts?  And, which version of Excel are you using?  In Office 2013, for example, UserForm Textboxes don&#39;t <i>have</i> an <code>Activate</code> method, so you&#39;d get a second error on <code>EB_Start.Activate</code>...  Try commenting that line out?"}], "answers": [{"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 1, "creation_date": 1522837007, "post_id": 49648245, "comment_id": 86304863, "body": "Appereantly this is not working either. If I klick the Msgbox Window away with enter, it still redirects me to the next Tab though I would like to redirect him to the Tab before. The Me.EB_Ende.SetFocus does not much more than the same without Me."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1522837577, "post_id": 49648245, "comment_id": 86305224, "body": "Did you try both of my suggestions?"}, {"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1522837812, "post_id": 49648245, "comment_id": 86305371, "body": "Kind of. I looked up the default order, but there is no option to repeat the same tab, if necessary. So I like that I know now this is possible, but I doen&#39;t really help me with the problem to redirect the user to the same box he/she just entered something wrong. -&gt; If it is imortant, I try to do all this in a Multipage"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1522836658, "last_edit_date": 1522836658, "creation_date": 1522836245, "answer_id": 49648245, "question_id": 49648098, "link": "https://stackoverflow.com/questions/49648098/userform-redirect-focus-on-textbox-after-msgbox/49648245#49648245", "title": "Userform - Redirect focus on textbox after MsgBox", "body": "<p>The funny thing is, you used the answer as a tag on your question:</p>\n\n<pre><code>Me.EB_Ende.SetFocus\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/textbox-control-setfocus-method-enterfieldbehavior-hideselection-multiline-value\" rel=\"nofollow noreferrer\">Here</a> is more information on <code>SetFocus</code>.</p>\n\n<p>Something else that might help...  you can change the default order that objects are \"tabbed\" through.  (ie., what cell should get focus after you press enter or tab in the current control:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s7hDu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s7hDu.png\" alt=\"img\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1522843404, "post_id": 49649352, "comment_id": 86309044, "body": "thank you for the explanation. Did not know that the BeforeUpdate is too early. Thanks for the solution"}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 2, "last_activity_date": 1522839743, "creation_date": 1522839743, "answer_id": 49649352, "question_id": 49648098, "link": "https://stackoverflow.com/questions/49648098/userform-redirect-focus-on-textbox-after-msgbox/49649352#49649352", "title": "Userform - Redirect focus on textbox after MsgBox", "body": "<p>Setting focus in <code>BeforeUpdate</code> event won't work - it is too soon. It is fired before focus is moved to the next control. Better approach is to handle <code>Exit</code> event and cancel it when needed:</p>\n\n<pre><code>Private Sub EB_Ende_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n  On Error GoTo Error_Handler\n  EB_Ende = CDate(EB_Ende)\n  Exit Sub   '&lt;-- exit sub when there is no error\nError_Handler:\n  Cancel = True\n  MsgBox (\"Please enter a valid date\"), , \"Datum\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1522843544, "post_id": 49649430, "comment_id": 86309131, "body": "thanks for the solution, I don&#39;t understand your second option entirely but I will look it up because it looks really good."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 1, "creation_date": 1522843799, "post_id": 49649430, "comment_id": 86309306, "body": "All it does is use the built-in <code>IsDate</code> to decide if the value Is a Date, instead of waiting for <code>CDate</code> to error"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 2, "last_activity_date": 1522839987, "creation_date": 1522839987, "answer_id": 49649430, "question_id": 49648098, "link": "https://stackoverflow.com/questions/49648098/userform-redirect-focus-on-textbox-after-msgbox/49649430#49649430", "title": "Userform - Redirect focus on textbox after MsgBox", "body": "<p>There are a couple of issues with your code (e.g. not exiting before the error handler, and do you want to use <code>Cancel=msoTrue</code> to cancel the text entry to <code>EB_Ende</code> when you get an error?) so you could try this:</p>\n\n<pre><code>Private Sub EB_Ende_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)\n   On Error GoTo Error_Handler\n   Me.EB_Ende = CDate(Me.EB_Ende)                                                  \n   Exit Sub\nError_Handler:\n    EB_Start.SetFocus\n    MsgBox (\"Please enter a valid date\"), , \"Datum\"\nEnd Sub\n</code></pre>\n\n<p>Or, you could skip the error-hander entirely:</p>\n\n<pre><code>Private Sub EB_Ende_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)\n    If IsDate(Me.EB_Ende) Then\n        Me.EB_Ende = CDate(Me.EB_Ende)                                                  \n    Else\n        Cancel = msoTrue\n        EB_Start.SetFocus\n        MsgBox (\"Please enter a valid date\"), , \"Datum\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3475, "favorite_count": 0, "accepted_answer_id": 49649352, "answer_count": 3, "score": 1, "last_activity_date": 1532353132, "creation_date": 1522835853, "last_edit_date": 1532353132, "question_id": 49648098, "link": "https://stackoverflow.com/questions/49648098/userform-redirect-focus-on-textbox-after-msgbox", "title": "Userform - Redirect focus on textbox after MsgBox", "body": "<p>I hope this is not that stupid, but I really did not find a post that was working for me.\n<strong>Situation:</strong> I want someone to put a date into a textbox in a Userform.<br>\n<strong>ErrorHandler:</strong> I wanted to have a very simple solution if the user doesn't enter the right format. (EB_Start.Activate and EB_Start.SetFocus are NOT working at all)</p>\n\n<p><em>For this I got:</em></p>\n\n<pre><code>Private Sub EB_Ende_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)\n   On Error GoTo Error_Handler\n   Me.EB_Ende = CDate(Me.EB_Ende)                                                  \n      Error_Handler:\n      EB_Start.Activate\n      EB_Start.SetFocus\nMsgBox (\"Please enter a valid date\"), , \"Datum\"\nEnd Sub\n</code></pre>\n\n<p><strong>Problem:</strong>\nMy Question is now, how do I redirect the focus on the textbox(EB_Ende)\nThe current reaction is, after the user presses Enter after the MsgBox showed up, It continued to the next textbox, but I want the user to be forced to reenter a valid date in the textbox.</p>\n\n<p>If someone could help me out with this, or redirect me to a Post or link that will answer my question I would really appreciate it.</p>\n\n<p>Best regards,\nLutscha</p>\n\n<p>This is the whole UserForm\n<a href=\"https://i.stack.imgur.com/ohOgY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ohOgY.png\" alt=\"Sry it is in german\"></a></p>\n"}, {"tags": ["vba", "excel", "action"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1522835801, "post_id": 49648008, "comment_id": 86304004, "body": "Which &quot;second action&quot;?  What do you mean &quot;it doesn&#39;t work&quot;? What &#39;s it &quot;supposed&quot; to do? Also the title of your question is hard to understand."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522837163, "post_id": 49648008, "comment_id": 86304957, "body": "I&#39;m not understanding the <code>lstMyData</code> lines of code - it&#39;s saying &quot;tell me which item in the listbox is selected and then select that item&quot;.  If nothing is selected then an error occurs as <code>ListIndex</code> will be -1 and <code>Selected</code> starts at 0.  The second part of the code - I take it the <i>second action</i> are the statements after the <code>Else</code> - will only execute if there&#39;s is a value in <code>Control1, 2 or 3</code>.  Do you have <code>ON ERROR RESUME NEXT</code> somewhere which will make it look like that code hasn&#39;t executed if no items are selected."}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522842660, "post_id": 49648008, "comment_id": 86308546, "body": "well, to be more specific. I&#39;m trying to make an interface for the user with a listbox. Once the user selected a name in the listbox, this same info apprears in the controlboxes. So if nothing is selected in the listbox, you get an msgbox saying you have to select a name. This to prevent deleting information by validating empty textboxes."}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522842908, "post_id": 49648008, "comment_id": 86308718, "body": "The user will also get the possibility to use checkboxes and textboxes to add data to the corresponding name.  The correct info with the correct name has been coverd by the use of &#39;i&#39; the the code.  But my problem is to get the data from the userform into my worksheet at the corresponding name."}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522843077, "post_id": 49648008, "comment_id": 86308833, "body": "So to solve my problem: I tried to take the same cell as the listbox (as it is the same database). So the &#39;i&#39; + rownumber will define where i want the userform information to be added ==&gt; check if the names are corresponding (userform-database)."}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522843118, "post_id": 49648008, "comment_id": 86308865, "body": "my 2 actions i want to perform are: 1) Me.checkbox1.value = True Then Worksheets(&quot;Database&quot;).cells(i+1, &quot;I&quot;).Value = &quot;TRUE&quot;   2) Worksheets (&quot;Database&quot;).Cells(i+1,&quot;J&quot;).value = Me.textbox1.Text   So the 1) is to get the true or false info from the checkbox to a specific cell. The 2) is to get the text info from the userform textbox to a specific cell as well.   Row I is the True or False row, Row J is the textbox info"}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522843578, "post_id": 49648008, "comment_id": 86309161, "body": "By it doesn&#39;t work i mean: If i put he code for the Checkbox first, i will get a TRUE in cells in row I. But as the code for the textbox is 2nd, No information will get in cells from row J at all. If i turn it the other way around, so i put the code for the textbox first and then the Checkbox. I will get my textinfo in row J but nothing in Row I from the checkbox..."}, {"owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "edited": false, "score": 0, "creation_date": 1522843619, "post_id": 49648008, "comment_id": 86309182, "body": "The listmydata: you have to think with a userform and database."}], "owner": {"reputation": 3, "user_id": 9595883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCjUT.jpg?s=128&g=1", "display_name": "Charles M", "link": "https://stackoverflow.com/users/9595883/charles-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522835937, "creation_date": 1522835604, "last_edit_date": 1531164843, "question_id": 49648008, "link": "https://stackoverflow.com/questions/49648008/vba-multi-actionswith-if-then-inc-after-if-then", "title": "VBA Multi actions(with if then inc) after IF THEN", "body": "<p>So, I've a code that gives me in this case only my first action in a cell. \nI can't get my 2nd action working. </p>\n\n<p>The code: </p>\n\n<pre><code>Private Sub CommandButton4_Click()\nDim i As Integer\n\nIf Me.Control1.Text = \"\" And Me.Control2.Text = \"\" And Me.Control3.Text = \"\" Then\nMsgBox \"Please select a name in the list\"\n\nElse\n\ni = Me.lstMyData.ListIndex\nMe.lstMyData.Selected(i) = True\n\n     If Me.CheckBox1.Value = True Then Worksheets(\"Database\").Cells(i + 1, \"I\").Value = \"TRUE\"\n\n     Worksheets(\"Database\").Cells(i + 1, \"J\").Value = Me.TextBox1.Text\n\nEnd If\n</code></pre>\n\n<p>Any idea why my 2nd action doesn't work? If I switch the actions I still got the same problem. The first one always works and the 2nd never. </p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522835591, "post_id": 49647850, "comment_id": 86303852, "body": "What error?  Where?  ...also, <code>Find</code> searches cell, not combo boxes."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522835761, "post_id": 49647850, "comment_id": 86303980, "body": "Is there a value in <code>date1_cbo</code>? Can you write <code>MsgBox date1_cbo</code> before the error and see what does it return?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522835764, "post_id": 49647850, "comment_id": 86303982, "body": "ok &quot;that&#39; error: that is <code>date1_cbo</code>? Is that supposed to refer to the combo box?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9337165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d11763e5c13b729b12e50419de2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Scott", "link": "https://stackoverflow.com/users/9337165/joey-scott"}, "edited": false, "score": 1, "creation_date": 1522837434, "post_id": 49648128, "comment_id": 86305132, "body": "Thanks this would work also, however, there is no need for a loop as there are no duplicate values so finding the first instance of the date and changing it would be all I need."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 9337165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d11763e5c13b729b12e50419de2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Scott", "link": "https://stackoverflow.com/users/9337165/joey-scott"}, "edited": false, "score": 0, "creation_date": 1522837535, "post_id": 49648128, "comment_id": 86305187, "body": "@JoeyScott - You are welcome. In general, you never know, next time you may need multiple cases."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1522836601, "last_edit_date": 1522836601, "creation_date": 1522835924, "answer_id": 49648128, "question_id": 49647850, "link": "https://stackoverflow.com/questions/49647850/excel-vba-find-function-changing-values-in-selection/49648128#49648128", "title": "Excel VBA .Find Function changing values in selection", "body": "<p>You are using a variable named <code>Selection</code>. VBA uses it as well. Rename your variable to anything else, rewrite your code and it should work. Even <code>Selection1</code> is quite ok:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim selection1 As Range\n    With Worksheets(1).Range(\"A1:A500\")\n        Set selection1 = .Find(\"vi\")\n    End With\n\n    If Not selection Is Nothing Then\n        selection1.Value = \"some other value\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To change multiple values with <code>Find()</code> as here - <code>A1:A10</code>, then some possibility is to do it like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myRng As Range\n\n    With Worksheets(1).Range(\"A1:A500\")\n        .Range(\"A1:A10\") = \"vi\"\n        Set myRng = .Find(\"vi\")\n        If Not myRng Is Nothing Then\n            Do Until myRng Is Nothing\n                myRng.Value = \"New value\"\n                Set myRng = .Find(\"vi\")\n            Loop\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>It is a bit slow, as far as it loops every time and it can be improved, if the range is united and replaced at once.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 9337165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d11763e5c13b729b12e50419de2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Scott", "link": "https://stackoverflow.com/users/9337165/joey-scott"}, "edited": false, "score": 0, "creation_date": 1522837182, "post_id": 49648384, "comment_id": 86304966, "body": "Thanks you were right. It was some type of formatting issue with date. That is interesting because I made sure the format for the combobox was the exact same as the format for the range of cells.  Also I changed selection to rng haha thanks again."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1522836644, "creation_date": 1522836644, "answer_id": 49648384, "question_id": 49647850, "link": "https://stackoverflow.com/questions/49647850/excel-vba-find-function-changing-values-in-selection/49648384#49648384", "title": "Excel VBA .Find Function changing values in selection", "body": "<p>a variable named as 'selection' is bad coding practice but totally legal. Don't use such names for the sake of clarity.</p>\n\n<hr>\n\n<p>Error 91 is caused when you are trying to read a property( <code>.value</code>) from null object. your selection variable is null cause date formats on the sheet and combobox are different. </p>\n\n<hr>\n\n<p>Just convert to date before attempting to find it in sheet. \n<code>Set selection = .Find(CDate(date1_cbo.Value))  '/ once again, selection is valid but bad name for variable.</code></p>\n"}], "owner": {"reputation": 47, "user_id": 9337165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d11763e5c13b729b12e50419de2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Scott", "link": "https://stackoverflow.com/users/9337165/joey-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 49648384, "answer_count": 2, "score": 1, "last_activity_date": 1522836644, "creation_date": 1522835221, "last_edit_date": 1522836126, "question_id": 49647850, "link": "https://stackoverflow.com/questions/49647850/excel-vba-find-function-changing-values-in-selection", "title": "Excel VBA .Find Function changing values in selection", "body": "<p>Heya this is probably simple but I cannot figure out what is wrong.</p>\n\n<p>I am trying to do .find for a specific date and change that selection to a user input date.</p>\n\n<p>I have a userform to select a date from a combobox (date1_cbo). The combobox source is linked to dates on a worksheet (Backend). There is a textbox below for writing the new date to change it to (date1_txt). I keep getting an error </p>\n\n<blockquote>\n  <p>object variable or with block variable not set. </p>\n</blockquote>\n\n<p>I have tried a few options without any luck here is my code:</p>\n\n<pre><code>Dim selection As Range\nDim check As Boolean\n\n'input box validation\ncheck = IsDate(date1_txt.Value)\nIf check = True Then\n    'find cell matching combobox\n    With Worksheets(\"Backend\").Range(\"A1:A500\")\n        Set selection = .Find(date1_cbo.Value) 'this is the problem\n        selection.Value = date1_txt.Value\n    End With\nElse\nEnd If\n</code></pre>\n\n<p>Interestingly .Find returns the range or Nothing. however because the combobox is linked to the cells I am searching through this should never return nothing... I dont understand why the error is occurring.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 3, "creation_date": 1522835333, "post_id": 49647810, "comment_id": 86303673, "body": "<a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">I indented your code</a>... doesn&#39;t that read well now?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9595846, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3FsmxJvPBuM/AAAAAAAAAAI/AAAAAAAAABU/TkdSYCh1Les/photo.jpg?sz=128", "display_name": "Liang Wu", "link": "https://stackoverflow.com/users/9595846/liang-wu"}, "edited": false, "score": 0, "creation_date": 1522844126, "post_id": 49647877, "comment_id": 86309568, "body": "Thanks for the reply :) this did work and set &quot;add&quot; as 1. However, the add=add+1 loop not functions after this change."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9, "user_id": 9595846, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3FsmxJvPBuM/AAAAAAAAAAI/AAAAAAAAABU/TkdSYCh1Les/photo.jpg?sz=128", "display_name": "Liang Wu", "link": "https://stackoverflow.com/users/9595846/liang-wu"}, "edited": false, "score": 0, "creation_date": 1522859327, "post_id": 49647877, "comment_id": 86321034, "body": "@LiangWu Are you sure of the position of the add = add + 1? Did you try moving it further down to see if you got the desired result?"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1522835301, "creation_date": 1522835301, "answer_id": 49647877, "question_id": 49647810, "link": "https://stackoverflow.com/questions/49647810/vba-how-to-reset-defined-variable/49647877#49647877", "title": "VBA- how to reset defined variable", "body": "<p>Switch these two lines:</p>\n\n<pre><code>Add = 1\nFor i = 19 To 1819\n</code></pre>\n\n<p>I.e: </p>\n\n<pre><code>For i = 19 To 1819\n    Add = 1\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9595846, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3FsmxJvPBuM/AAAAAAAAAAI/AAAAAAAAABU/TkdSYCh1Les/photo.jpg?sz=128", "display_name": "Liang Wu", "link": "https://stackoverflow.com/users/9595846/liang-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522835301, "creation_date": 1522835126, "last_edit_date": 1522835226, "question_id": 49647810, "link": "https://stackoverflow.com/questions/49647810/vba-how-to-reset-defined-variable", "title": "VBA- how to reset defined variable", "body": "<p>I have a code as below and i want to reset \"add\" as 1 when a new loop starts for the next row. </p>\n\n<pre><code>Sub Group()\n    DataBook = ThisWorkbook.Name\n    Dim i As Long\n    RowCount = 1\n    RowCount2 = 1\n    Add = 1\n    For i = 19 To 1819\n        If Workbooks(DataBook).Sheets(\"Template\").Range(\"G\" &amp; i).IndentLevel = 8 Then\n            Workbooks(DataBook).Sheets(\"Sheet1\").Cells(RowCount, 2) = Workbooks(DataBook).Sheets(\"Template\").Range(\"G\" &amp; i).Value\n            RowCount = RowCount + 1\n            If Workbooks(DataBook).Sheets(\"Template\").Range(\"G\" &amp; i - Add).IndentLevel = 7 Then\n                Workbooks(DataBook).Sheets(\"Sheet1\").Cells(RowCount2, 1) = Workbooks(DataBook).Sheets(\"Template\").Range(\"G\" &amp; i - Add)\n                RowCount2 = RowCount2 + 1\n                Add = Add + 1\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522834990, "post_id": 49647671, "comment_id": 86303439, "body": "Put your months in an array and loop through that replacing the hard-coded name with the array element."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522835132, "post_id": 49647671, "comment_id": 86303539, "body": "And you can reduce to one line <code>Range(&quot;C2:C11&quot;).FormulaR1C1 =...</code>"}, {"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522835300, "post_id": 49647671, "comment_id": 86303651, "body": "Hello @SJR I have edited my question for clarity, and will appreciate if you&#39;re able to demonstrate what you mean by typing out the code, as I&#39;m new to vba coding and am still trying to figure my way around. Much thanks in advance!"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522836378, "post_id": 49647930, "comment_id": 86304426, "body": "Hello, thanks for the reply! This formula doesn&#39;t quite work for me. I have 10 data points per month to be filled up via a single workbook. however, this formula only extracts the first value from the first workbook, and so on so forth. meaning for Jan, data points 2-10 show up as 0, and the first two data points in Feb also appear as 0."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522836778, "post_id": 49647930, "comment_id": 86304726, "body": "@imjellybrah26 well see my edit. You can add additional columns with formulas for each month like i showed by counting the column in <code>Offset(row, column)</code> upwards. If this doesn&#39;t help please add screenshots of your sheets into your question so we can see what it should look like."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522840415, "post_id": 49647930, "comment_id": 86307079, "body": "@imjellybrah26 I changed the answer. See if that helps."}, {"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522893522, "post_id": 49647930, "comment_id": 86335978, "body": "hello, your solution works ! Thank you so much for taking the time to help me :) However the code does not work when I specify the whole file path, as the folder containing my source workbooks are in a shared network. I copied the file path from Windows Explorer so it should not be wrong. The formula including filepath goes something like: Range(&quot;C2:C11&quot;).Offset(i * 10, 0).FormulaR1C1 = &quot;=IFERROR(VLOOKUP(RC[-1], &#39;\\\\network\\group\\org\\source\\incident_summary - &quot; &amp; ArrMonth(i) &amp; &quot;.csv!R3C2:R11C3,2,FALSE),0) &quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522909023, "post_id": 49647930, "comment_id": 86340437, "body": "@imjellybrah26 Well the issue is that you are trying to use a CSV file. But a CSV is basically a TXT file with comma separated values in it. So there are no sheets nor columns or rows you can access with a formula. It is necessary to convert that CSV into an Excel file first before you can access it with formulas."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1522909206, "last_edit_date": 1522909206, "creation_date": 1522835425, "answer_id": 49647930, "question_id": 49647671, "link": "https://stackoverflow.com/questions/49647671/looping-iferror-with-vlookup-that-refers-to-another-workbook/49647930#49647930", "title": "looping ifError with vlookup that refers to another workbook", "body": "<p>Well first of all I recommend to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code></a>. Then you cannot use Autofill for that, you will need to loop through the range and write each formula on it's own.</p>\n\n<p>So put month names into an array and loop through that array writing the formula in each cell:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FillFormula()\n    Dim ArrMonth As Variant\n    ArrMonth = Array(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\")\n\n    Dim i As Long\n    For i = LBound(ArrMonth) To UBound(ArrMonth)\n        Range(\"C2:C11\").Offset(i * 10, 0).FormulaR1C1 = \"=IFERROR(VLOOKUP(RC[-1],'incident_summary - \" &amp; ArrMonth(i) &amp; \".csv'!R3C2:R11C3,2,FALSE),0)\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note that you are trying to access a CSV file which is not possible. Formulas can only access Excel files. But a CSV is basically a TXT file with comma separated values in it. So there are no sheets nor columns or rows you can access with a formula. It is necessary to convert that CSV into an Excel file first before you can access it with formulas.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522835596, "post_id": 49647954, "comment_id": 86303854, "body": "well <code>Range(&quot;C2:C11&quot;).offset(,i)</code> should be <code>Range(&quot;C2&quot;).offset(i,0)</code> see my answer."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522835755, "post_id": 49647954, "comment_id": 86303974, "body": "Hm are you sure? The opening line suggests he is moving across columns, but then talks of 12 months in one column so you may be right. I&#39;ll leave until OP clarifies or he can just accept your answer."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522835877, "post_id": 49647954, "comment_id": 86304063, "body": "Well, yes you might be right: &quot;<i>loop down one column</i>&quot; is not very clear"}, {"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522836124, "post_id": 49647954, "comment_id": 86304252, "body": "Hello, to clarify, I want to loop the data such that at the destination workbook the data is filled down one column (My vlookup is programmed to fill up only one column)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522836507, "post_id": 49647954, "comment_id": 86304525, "body": "Can you try the two solutions and see which (if either) works as we have interpreted your question differently and still not sure what you are after. Should column C all be Jan, D Feb etc or should C2 be Jan, C3 Feb etc?"}, {"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522836728, "post_id": 49647954, "comment_id": 86304692, "body": "Jan occupies 10 rows, C2:C11, Feb occupies 10 rows, C12:C21, Mar occupies 10 rows, C22:C31, and so on"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522837228, "post_id": 49647954, "comment_id": 86305006, "body": "Ha we were both wrong. I&#39;ve amended the code above."}, {"owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "edited": false, "score": 0, "creation_date": 1522894523, "post_id": 49647954, "comment_id": 86336194, "body": "hello, I&#39;ve adopted PEH&#39;s solution ! Thank you so much for taking the time to help me :) However his code does not work when I specify the whole file path, as the folder containing my source workbooks are in a shared network. I copied the file path from Windows Explorer so it should not be wrong. The formula including filepath goes something like: Range(&quot;C2:C11&quot;).Offset(i * 10, 0).FormulaR1C1 = &quot;=IFERROR(VLOOKUP(RC[-1], &#39;\\\\network\\group\\org\\source\\incident_summary - &quot; &amp; ArrMonth(i) &amp; &quot;.csv!R3C2:R11C3,2,FALSE),0) &quot;. I&#39;m wondering if you know any fix?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1522837215, "last_edit_date": 1522837215, "creation_date": 1522835490, "answer_id": 49647954, "question_id": 49647671, "link": "https://stackoverflow.com/questions/49647671/looping-iferror-with-vlookup-that-refers-to-another-workbook/49647954#49647954", "title": "looping ifError with vlookup that refers to another workbook", "body": "<p>To illustrate my comment above as requested.</p>\n\n<pre><code>Sub x()\n\nDim months As Variant, i As Long, r As Range\n\nmonths = Array(\"Jan\", \"Feb\", \"Mar\") 'etc\nSet r = Range(\"C2:C11\")\n\nFor i = LBound(months) To UBound(months)\n    r.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(RC[-1],'incident_summary - \" &amp; months(i) &amp; \".csv'!R3C2:R11C3,2,FALSE),0)\"\n    Set r = r.Offset(10)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9595839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "imjellybrah26", "link": "https://stackoverflow.com/users/9595839/imjellybrah26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 49647930, "answer_count": 2, "score": 0, "last_activity_date": 1522909206, "creation_date": 1522834781, "last_edit_date": 1522836437, "question_id": 49647671, "link": "https://stackoverflow.com/questions/49647671/looping-iferror-with-vlookup-that-refers-to-another-workbook", "title": "looping ifError with vlookup that refers to another workbook", "body": "<p>I'm doing some data processing, and I want to achieve this:</p>\n\n<p>A  1</p>\n\n<p>B  36</p>\n\n<p>C  0</p>\n\n<p>D 36</p>\n\n<p>...</p>\n\n<p>To achieve this, I came up with a formula which I want to loop down one column :</p>\n\n<pre><code>Range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(RC[-1],'incident_summary - Jan.csv'!R3C2:R11C3,2,FALSE),0)\"\nRange(\"C2\").Select\nSelection.AutoFill Destination:=Range(\"C2:C11\"), Type:=xlFillDefault\nRange(\"C2:C11\").Select\n</code></pre>\n\n<p>This formula uses vLookup to look for the data point in the source workbook, all of which are located in the same folder on my shared network.\nAs the source workbook may not contain all the data points, ifError is set to return the number for that data point as 0 in the destination workbook.</p>\n\n<p>As you can tell from above, I have 10 data points per month, which I need to fill up for 12 months in one column.</p>\n\n<p>But is I cannot understand how can I loop this formula while changing 'incident_summary - Jan.csv' to Feb, Mar, Apr, etc... as I need to loop this formula for a whole year aka Jan-Dec so any suggestions?</p>\n"}, {"tags": ["vba", "excel", "create-directory"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522834670, "post_id": 49647576, "comment_id": 86303233, "body": "FileSystemObject for creating folders? <a href=\"https://stackoverflow.com/questions/31033820/filesystemobject-createfolder-to-create-directory-and-subdirectories\" title=\"filesystemobject createfolder to create directory and subdirectories\">stackoverflow.com/questions/31033820/&hellip;</a>   or MkDir"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522835556, "post_id": 49647576, "comment_id": 86303824, "body": "unrelatred observation:  you know that <code>ActiveWorkbook.Saved = True</code>  <code>ActiveWorkbook.Close</code> closes the current workbook <i>without</i> saving it, right?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "edited": false, "score": 0, "creation_date": 1522836432, "post_id": 49647775, "comment_id": 86304473, "body": "So by adding this after the line of code .Cells(MyRow, &quot;Q&quot;).Value = Sheets(&quot;Tracker&quot;).Cells(3, &quot;E&quot;).Value, this will add a folder in the dir with the cell value in active column 17?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "edited": false, "score": 0, "creation_date": 1522836708, "post_id": 49647775, "comment_id": 86304680, "body": "does <code>Sheets(&quot;Tracker&quot;).Cells(3, &quot;E&quot;).Value</code> contain the folder name?  (A value similar to <code>W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability</code>?)  If so, then yes, but change the code to <code>MkDir Sheets(&quot;Tracker&quot;).Cells(3, &quot;E&quot;).Value</code>."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522835026, "creation_date": 1522835026, "answer_id": 49647775, "question_id": 49647576, "link": "https://stackoverflow.com/questions/49647576/creating-folder-with-cell-as-name/49647775#49647775", "title": "Creating folder with cell as name", "body": "<p>Use <strong><code>MkDir</code></strong> create a folder using VBA:</p>\n\n<pre><code>MkDir \"FolderName\" \n</code></pre>\n\n<p>...creates a folder named \"<code>FolderName</code>\" in the current directory, or:</p>\n\n<pre><code>MkDir \"c:\\users\\bob\\desktop\\FolderName\"\n</code></pre>\n\n<p>...creates a folder named \"<code>FolderName</code>\" on Bob's desktop.</p>\n\n<p>To create folder <code>W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability</code>, use:</p>\n\n<pre><code>MkDir \"W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability\"\n</code></pre>\n\n<p>More info <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/mkdir-statement\" rel=\"nofollow noreferrer\">here</a> (but there's not much more to say).</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522836720, "last_edit_date": 1522836720, "creation_date": 1522835913, "answer_id": 49648122, "question_id": 49647576, "link": "https://stackoverflow.com/questions/49647576/creating-folder-with-cell-as-name/49648122#49648122", "title": "Creating folder with cell as name", "body": "<p>Expanding on the two version I mentioned in comments.  Update Activesheet with correct sheet and range with correct cell to collect folder name from. Currently have default <code>\"Testing\"</code> name created in case cell is empty where getting name from.</p>\n\n<p><strong>1) MKDIR</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub MyFileprojectTF()\n\n    Dim startPath As String\n    Dim myName As String\n\n    startPath = \"W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability\"\n    myName = ActiveSheet.Range(\"D1\").Text        ' Change as required to cell holding the folder title\n\n    If myName = vbNullString Then myName = \"Testing\"\n\n    Dim folderPathWithName As String\n    folderPathWithName = startPath &amp; Application.PathSeparator &amp; myName\n\n    If Dir(folderPathWithName, vbDirectory) = vbNullString Then\n        MkDir folderPathWithName\n    Else\n       MsgBox \"Folder already exists\"\n       Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>2) FSO</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub MyFileprojectTF()\n\n    Dim startPath As String\n    Dim myName As String\n\n    startPath = \"W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability\"\n    myName = ActiveSheet.Range(\"D1\").Text        ' Change as required to cell holding the folder title\n\n    If myName = vbNullString Then myName = \"Testing\"\n\n    Dim folderPathWithName As String\n    folderPathWithName = startPath &amp; Application.PathSeparator &amp; myName\n\n    If Dir(folderPathWithName, vbDirectory) = vbNullString Then\n        Dim fso As Object\n        Set fso = CreateObject(\"FileSystemObject\")\n        fso.CreateFolder folderPathWithName\n    Else\n       MsgBox \"Folder already exists\"\n       Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3373, "favorite_count": 0, "accepted_answer_id": 49648122, "answer_count": 2, "score": 1, "last_activity_date": 1522836720, "creation_date": 1522834562, "last_edit_date": 1522835474, "question_id": 49647576, "link": "https://stackoverflow.com/questions/49647576/creating-folder-with-cell-as-name", "title": "Creating folder with cell as name", "body": "<p>As I create a project number using the below code, I need to create a folder with the title as the new project number in the following path: <code>W:\\My system\\me\\my work\\PROJECTS\\Projects\\Reliability</code>, I know the code needs to be placed after (<code>.Cells(MyRow, \"Q\").Value = Sheets(\"Tracker\").Cells(3, \"E\").Value   'project NUMBER</code>) as title of the new project will be placed in \"active column 17\" once the below code is completed</p>\n\n<p>So I have this code which checks if a cell is empty and when prompted to create a project number, This works fine but I'm not sure how to add code to create the new folder in the above folder</p>\n\n<pre><code>Sub MyFileprojectTF()\n    'Detemine to open or create report.\n    'Application.ScreenUpdating = False\n    Dim MyNewFile As String\n    Dim MySht, MyWBK As String\n    Dim MyRow As Integer\n    MyRow = ActiveCell.Row\n    MySht = ActiveSheet.Name\n    MyWBK = ActiveWorkbook.Name\n\n    If ActiveCell.Column = 17 Then\n        If ActiveCell.Value &lt;&gt; \"\" Then 'if cell in the is empty\n            MyFileprojectOpenTF\n        Else\n            OpenTemplate 'opens template tracker for new project number\n\n            With Workbooks(\"project.xls\").Sheets(\"Tracker\")\n                .Cells(9, \"B\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"H\").Value  'Project\n                .Cells(10, \"B\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"J\").Value  'Customer\n                .Cells(2, \"G\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"P\").Value  'tracker\n                .Cells(14, \"E\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"O\").Value  'tech\n                .Cells(15, \"E\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"N\").Value  'FILE REF\n                .Cells(25, \"A\").Value = Workbooks(MyWBK).Sheets(MySht).Cells(MyRow, \"L\").Value  'Description\n            End With\n\n            '***********************************\n            NewProjectGSRTF\n            UpDateMyDataBaseTF\n            '***********************************\n\n            With Workbooks(MyWBK).Sheets(MySht)\n                .Cells(MyRow, \"Q\").Value = Sheets(\"Tracker\").Cells(3, \"E\").Value   'project NUMBER\n            End With\n\n            ActiveWorkbook.Saved = True\n            ActiveWorkbook.Close\n            Workbooks(MyWBK).Save\n        End If\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1522994700, "post_id": 49650544, "comment_id": 86383847, "body": "thank you for you help but I encounter error:  Method or data member no found  highlighting &quot;r.Target&quot;"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523044574, "post_id": 49650544, "comment_id": 86413520, "body": "The example demonstrates how to copy a range from each sheet in a source workbook and paste it to a single sheet in another workbook. In your code you need to set <code>rTarget</code> to be a valid range reference. In this particular case it is enough to set the address of the top left cell of the target area, e.g. <code>Set rTarget = Cells(10, 1)</code>"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1522843464, "creation_date": 1522843464, "answer_id": 49650544, "question_id": 49647517, "link": "https://stackoverflow.com/questions/49647517/vba-vlookup-index-match-from-another-workbook-with-multiple-worksheets-where-nam/49650544#49650544", "title": "vba vlookup/index match from another workbook with multiple worksheets where name and number of worksheet is variable", "body": "<p>To reach all sheet in Workbook2, do this: </p>\n\n<pre><code>Dim wbk1 as Workbook, wbk2 as Workbook\nDim sh1 as Worksheet, sh2 as Worksheet\nDim rTarget as Range\n\nSet wbk1 = &lt;name of workbook1&gt;\nSet sh1 = wbk1.Sheets(\"Sheet1\")\nSet wbk2 = &lt;name of workbook2&gt;\n\nfor each sh2 in wbk2\n   Set r = sh2.Range(\"A1:F300\")\n   Set rTarget = sh1.Range(&lt;Set the top left cell of the desired target&gt;\n   r.Copy Destination:=sh1.rTarget\n   &lt;do everything else what you want&gt;\nnext sh2\n</code></pre>\n\n<p>You need to change the target range loop by loop in order not to overwrite the previous copy. </p>\n"}], "owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1279, "favorite_count": 0, "accepted_answer_id": 49650544, "answer_count": 1, "score": 0, "last_activity_date": 1522843464, "creation_date": 1522834403, "question_id": 49647517, "link": "https://stackoverflow.com/questions/49647517/vba-vlookup-index-match-from-another-workbook-with-multiple-worksheets-where-nam", "title": "vba vlookup/index match from another workbook with multiple worksheets where name and number of worksheet is variable", "body": "<p>Objective: trying to perform index match/vlookup from workbook 2 to workbook 1</p>\n\n<p>Backgrounds:</p>\n\n<ol>\n<li>VBA must be coded on workbook 3 due to workbook 1 &amp; 2 are browsed by user.</li>\n<li>workbook 1 is always with one sheet  only where sheetname = \"sheet 1\"</li>\n<li>workbook 2 would contain multiple worksheets where worksheets name and number of worksheets is variable </li>\n</ol>\n\n<p>Below code is OK to copy data from 1ST sheet of workbook 2 to workbook 1.</p>\n\n<p>What should be done so I could copy data from all the worksheets of workbook2 to workbook 1?</p>\n\n<p>here is my code:</p>\n\n<pre><code> Sub datacopy()\n\n  'prompt user to select 1st workbook\n N = Application.GetOpenFilename _\n (Title:=\"Please choose OTS offline template file\", _\n FileFilter:=\"Excel Files *.xls*; *.csv (*.xls*; *.csv),\")\n Set twb = Workbooks.Open(N)\n\n If N = False Then\n MsgBox \"No file selected. Please click run again and select file\", \n vbExclamation, \"Sorry!\"\n Exit Sub\n Else\n End If\n\n  'prompt user to select 2nd workbook\n R = Application.GetOpenFilename _\n (Title:=\"Please choose WIP information file\", _\n FileFilter:=\"Excel Files *.xls*; *.csv (*.xls*; *.csv),\")\n Set extwbk = Workbooks.Open(R)\n If R = False Then\n MsgBox \"No file selected. Please click run again and select file.\", \n vbExclamation, \"Sorry!\"\n Exit Sub\n Else\n End If\n\n Dim Row As Long\n Dim Clm As Long\n\nextwbk.Sheets(1).Activate\n\ntable1 = twb.Sheets(\"Sheet1\").Range(\"A1:A5\") 'lookup value in 1st workbook\ntable2 = extwbk.activesheet.Range(\"A2:D5\") ' DataRange of vlookup array table in 2nd workbook\n\nRow = twb.Sheets(\"Sheet1\").Range(\"B2\").Row    \nClm = twb.Sheets(\"Sheet1\").Range(\"B2\").Column   \nOn Error Resume Next\n\nFor Each cl In table1 \ntwb.Sheets(\"Sheet1\").Cells(Row, Clm) \nApplication.WorksheetFunction.VLookup(cl, table2, 3, False)  \n\nRow = Row + 1\nNext cl\n\nextwbk.Close SaveChanges:=False\n\ntwb.Close SaveChanges:=True\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filtering", "protected"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522834256, "post_id": 49647376, "comment_id": 86302947, "body": "I seem to be able to use autofilter in sheet with using this code. I was I supposed to change this line: ActiveSheet.Cells.Locked = False ?"}, {"owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522834285, "post_id": 49647376, "comment_id": 86302959, "body": "Why are you using Activesheet.Protect Password:=&quot;ABC123&quot; with filtering code. You can first filter and then use Activesheet.Protect Password:=&quot;ABC123&quot; to protect sheet"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522834411, "post_id": 49647376, "comment_id": 86303051, "body": "@mmehta (psssst - that says &quot;<code>Unprotect</code>&quot;)   :)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522834500, "post_id": 49647376, "comment_id": 86303104, "body": "Can you please define <b>&quot;<code>Not Working</code>&quot;</b>?  What is the problem, and where?"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "reply_to_user": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522837789, "post_id": 49647376, "comment_id": 86305351, "body": "Thanks guys - Not working means that filtering is not enabled at all (the Filter button is greyed out). @mmehta Maybe I have misunderstood, but your suggestion implies users have to turn off protection (=need to know the password) to use filtering, but I do not want users to be able to turn off protection."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522838006, "post_id": 49647376, "comment_id": 86305477, "body": "@cdfj - once again, what is <b>Not Working</b>? You cannot select the cell with the filter, you cannot click on it, the results are wrong?"}, {"owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522839988, "post_id": 49647376, "comment_id": 86306783, "body": "To enable the filter you have to unprotect the sheet. But you can unprotect sheet add filter then protect sheet through macro but then filter is of no use."}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "reply_to_user": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522841858, "post_id": 49647376, "comment_id": 86307995, "body": "@mmehta - I HAVE misunderstood! You are right! Applying filtering and then protecting the sheet has solved the problem! MANY thank yous! This has been driving me crazy!"}, {"owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522849542, "post_id": 49647376, "comment_id": 86313719, "body": "Good to know. Kindly mark my answer as correct. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1522838420, "post_id": 49647557, "comment_id": 86305768, "body": "that&#39;s quite a big task (complex workbook), but I will give it a try. I will be gone for some time!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1522838453, "post_id": 49647557, "comment_id": 86305791, "body": "@cdfj - we will miss you! :)"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1522841914, "post_id": 49647557, "comment_id": 86308029, "body": "thank you! mmehta solution has saved me this painful exercise!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1522834504, "creation_date": 1522834504, "answer_id": 49647557, "question_id": 49647376, "link": "https://stackoverflow.com/questions/49647376/filtering-not-working-in-protected-sheet/49647557#49647557", "title": "Filtering not working in protected sheet", "body": "<p>Can you try something as small as this one:</p>\n\n<pre><code>Sub TestMe()        \n    ActiveSheet.Protect Password:=\"ABC123\", AllowFiltering:=True    \nEnd Sub\n</code></pre>\n\n<p>And see whether it works. If it does, probably there is some problem with the <code>ActiveSheet</code> in the loop I guess.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 8894786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rB8gq.jpg?s=128&g=1", "display_name": "LukaszPe", "link": "https://stackoverflow.com/users/8894786/lukaszpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1564270539, "last_edit_date": 1564270539, "creation_date": 1564266112, "answer_id": 57236498, "question_id": 49647376, "link": "https://stackoverflow.com/questions/49647376/filtering-not-working-in-protected-sheet/57236498#57236498", "title": "Filtering not working in protected sheet", "body": "<p>Not sure if this helps anybody but if you go into <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.protection.allowfiltering\" rel=\"nofollow noreferrer\">documentation</a> the AllowFiltering works this way that you have to have the autofilter set up and then protect your worksheet.</p>\n"}], "owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2734, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564270539, "creation_date": 1522834009, "question_id": 49647376, "link": "https://stackoverflow.com/questions/49647376/filtering-not-working-in-protected-sheet", "title": "Filtering not working in protected sheet", "body": "<p>I have the code below for protecting one sheet. Sorting works fine, but filtering does not, even though AllowFiltering is True. Are there any suggestions to what is preventing filtering from working?</p>\n\n<p>I have tried setting Userinterfaceonly to true and to false, but neither makes any difference. Likewise EnableSelection = xlUnlockedCells does not help.</p>\n\n<pre><code>Sub LockCols()\n\nDim Sh As Worksheet\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nFor Each Sh In ThisWorkbook.Worksheets\n\n    '2 other If/End If statements protecting other sheets\n\n    If Sh.Name = \"Combined\" Then\n\n            Sh.Activate\n            ActiveSheet.Unprotect Password:=\"ABC123\"\n            ActiveSheet.Cells.Locked = False 'True prevents sorting and filtering\n            ActiveSheet.Protect Password:=\"ABC123\", DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n                Userinterfaceonly:=True, _\n                AllowFiltering:=True, _\n                AllowSorting:=True, _\n                AllowInsertingColumns:=False, _\n                AllowDeletingColumns:=False, _\n                AllowInsertingRows:=False, _\n                AllowDeletingRows:=False, _\n                AllowFormattingCells:=False, _\n                AllowFormattingColumns:=True, _\n                AllowFormattingRows:=True, _\n                AllowInsertingHyperlinks:=False\n\n    End If\n\nNext\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1522833232, "post_id": 49647007, "comment_id": 86302217, "body": "On which line does it stop ? What is the value of doc.value when error happens ?"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1522833418, "post_id": 49647007, "comment_id": 86302351, "body": "It stops in the &quot;IF doc.value=&quot;NDA&quot; then&quot; line"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1522833452, "post_id": 49647007, "comment_id": 86302378, "body": "It doesnt seem to work for any value of doc selected from pull down list"}, {"owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522834001, "post_id": 49647007, "comment_id": 86302747, "body": "can you attach screenshot of access form? Is the list part of form and what are tabs?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1522834105, "post_id": 49647007, "comment_id": 86302830, "body": "@malavikanair - how is <code>doc</code> declared? Do you have <code>Option Explicit</code> on the top of the module?"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522834672, "post_id": 49647007, "comment_id": 86303234, "body": "@mmehta i cannot attach an image to my question because it says i must earn 10 reputation, i just have one."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522834839, "post_id": 49647007, "comment_id": 86303342, "body": "@mmehta yes, the list is part of form. The tabs include type of document(named &quot;doc&quot;), type of nda(named &quot;tnda&quot;), and some11 other tabs."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522835071, "post_id": 49647007, "comment_id": 86303496, "body": "@Vityata While designing the form, after having selected &quot;type of document&quot; tab in the form, on the &quot;property sheet&quot; of the combo box-&gt;Other option, i have named it as &quot;doc&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522835181, "post_id": 49647007, "comment_id": 86303568, "body": "Can you replace <code>doc.Value</code> with <code>Forms(&quot;doc&quot;).Value</code>?"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522835380, "post_id": 49647007, "comment_id": 86303705, "body": "@Vityata thanks! i did it..but its showing error that &quot;it cant find doc referred to in a macro expression or visual basic code&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522835505, "post_id": 49647007, "comment_id": 86303786, "body": "@malavikanair - try to put some pictures of your form in the question."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 1, "creation_date": 1522835836, "post_id": 49647007, "comment_id": 86304032, "body": "I have added the link@Vityata"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522836646, "post_id": 49647007, "comment_id": 86304635, "body": "@vityata hope its useful"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 0, "creation_date": 1522836992, "post_id": 49648382, "comment_id": 86304856, "body": "Thanks a ton Gustav! IT works!!..i tried the 2nd method you suggested. But can you please tell me how i can find the ID of the text?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 0, "creation_date": 1522837621, "post_id": 49648382, "comment_id": 86305251, "body": "Then you must look at the source of the combobox. If that is a field, it is a lookup field, and you must go to the table definition for that info."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 0, "creation_date": 1522838131, "post_id": 49648382, "comment_id": 86305570, "body": "Table definition from &quot;table properties&quot;?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 0, "creation_date": 1522841524, "post_id": 49648382, "comment_id": 86307772, "body": "The field definition in the table for that field. Second tab."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "edited": false, "score": 0, "creation_date": 1522902560, "post_id": 49648382, "comment_id": 86338134, "body": "I checked and data was of text type"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522907599, "post_id": 49648382, "comment_id": 86339795, "body": "As I see it, doc is a <i>multi-select combo box</i>, not a normal one. Using this code will yield unpredictable results because of that"}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522908229, "post_id": 49648382, "comment_id": 86340078, "body": "@ErikvonAsmuth Thanks! i have changed to single select values. But now i am working on another form and have updated it on my question. Kindly review"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522910854, "post_id": 49648382, "comment_id": 86341330, "body": "I highly recommend disabling and then enabling on the same event, not different ones. But just step through the code using breakpoints, and you should see what&#39;s going on."}, {"owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522912924, "post_id": 49648382, "comment_id": 86342555, "body": "@ErikvonAsmuth it works if i use <code>doc.value</code> instead of <code>doc.column(1)</code>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1522836638, "creation_date": 1522836638, "answer_id": 49648382, "question_id": 49647007, "link": "https://stackoverflow.com/questions/49647007/vba-in-access-and-conditional-formatting-of-forms/49648382#49648382", "title": "vba in access and conditional formatting of forms", "body": "<p>It's because Doc is a combobox, thus probably bound to an ID that is numeric.</p>\n\n<p>So either:</p>\n\n<pre><code>If doc.Value = &lt;insert value of ID of text \"NDA\"&gt; then\n</code></pre>\n\n<p>or use the column ID that holds \"NDA\", most likely the next:</p>\n\n<pre><code>If doc.Column(1) = \"NDA\" then\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9595617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "malavika nair", "link": "https://stackoverflow.com/users/9595617/malavika-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 49648382, "answer_count": 1, "score": 0, "last_activity_date": 1522907956, "creation_date": 1522832890, "last_edit_date": 1522907956, "question_id": 49647007, "link": "https://stackoverflow.com/questions/49647007/vba-in-access-and-conditional-formatting-of-forms", "title": "vba in access and conditional formatting of forms", "body": "<p>I have a form that collects different types of data. One of them is the type of document. On accessing the tab the user has to select a type of document, from a pull-down list. If the document is selected as \"NDA\", then a tab named \"type of NDA\" must be enabled. The following is the code I am trying to use:</p>\n\n<pre><code> Private Sub doc_AfterUpdate()\n    If doc.Value=\"NDA\" then\n       tnda.enabled=true\n    else\n       tnda.enabled=false\n    End if\n End Sub\n</code></pre>\n\n<p>The pgm is simple, yet whenever I run my forms it keeps showing \"error:type mismatch\" and the code stops working.</p>\n\n<p>Thanks for helping me with the above code.\nThis time i tried the code on a little more complicated form with more options. I tried to disable all the other options and enable them only according to the options i choose(from \"type of document\" tab in the form).Given below is the code:</p>\n\n<pre><code>    Private Sub doc_BeforeUpdate(cancel as integer)\n    tnda.enabled=false\n    tagr.enabled=false\nodoc.enabled=false\n    End Sub\n\n    Private Sub doc_AfterUpdate()\n    Select Case doc.column(1)\n    Case \"NDA\"\n    tnda.enabled=true\n    Case \"Agreement\"\n    tagr.enabled=true\n    Case \"Other\"\n    odoc.enabled=true\n    Case Else\n    End Select\n    End Sub\n\n    Private Sub doc_Oncurrent()\n    Select Case doc.column(1)\n    Case \"NDA\"\n    tnda.enabled=true\n    Case \"Agreement\"\n    tagr.enabled=true\n    Case \"Other\"\n    odoc.enabled=true\n    Case Else\n    End Select\n    End Sub\n</code></pre>\n\n<p>After running the pgm, all my tabs remain disabled irrespective of the choice of doc. Please provide valuable inputs in this regard.\nNote tnda:type of NDA\n          tagr:type of agreement\n            odoc:Other document and doc=type of document  <a href=\"https://i.stack.imgur.com/BavdL.png\" rel=\"nofollow noreferrer\">Find image of my form here</a></p>\n"}, {"tags": ["vba", "error-handling", "runtime-error"], "comments": [{"owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "edited": false, "score": 0, "creation_date": 1522832571, "post_id": 49646875, "comment_id": 86301777, "body": "are you getting different error messages in the same test case?"}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 1, "creation_date": 1522832756, "post_id": 49646875, "comment_id": 86301918, "body": "How big is this sub. is it possible to post the source code for the sub here. Also if you step through the sub, are you able to locate the line throwing the error."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "edited": false, "score": 0, "creation_date": 1522832921, "post_id": 49646875, "comment_id": 86302009, "body": "@JamesLingham - No. I all cases where I got this at runtime, it was <code>Array Index out of Bounds</code>."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1522833069, "post_id": 49646875, "comment_id": 86302115, "body": "@Alok - No. It wouldn&#39;t be possible. But besides the code itself, I couldn&#39;t yet find a systematic way of generating the error. My project moves emails/conversations among folders, so whenever I run it successfully, my emails have changed."}, {"owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "edited": false, "score": 0, "creation_date": 1522833385, "post_id": 49646875, "comment_id": 86302329, "body": "@sancho.s when the error pops up, do you get a &quot;debug&quot; option? By the sounds of it, there is a mistake with the logic and it is trying to access a member of an array which isn&#39;t there anymore.  as you said the macro moves emails, im guessing you remove an item from the array / collection, which makes the indexs in the array shift and the last ones unreachable.  could you provide some code to show how the loop is defined, and roughly what sort of action is executed?"}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1522833448, "post_id": 49646875, "comment_id": 86302371, "body": "Is it possible to provide the pseudo code flow here. I am assuming you are using an array variable within a loop, which at some stage gives you the error on a specific condition."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522833668, "post_id": 49646875, "comment_id": 86302515, "body": "Just a guess - It is probably somehow referencing to the Outlook object and this object is using some .Net error handling. When it is translated to VBA, it takes the VBA error handling, but the description stays because it is more descriptive - <a href=\"https://stackoverflow.com/questions/43417521/error-440-array-index-out-of-bounds\">see here similar case</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522834313, "post_id": 49646875, "comment_id": 86302978, "body": "@sancho.s For a definite answer, you&#39;ll need to post the portion of your code that&#39;s causing the problem, and any other code and background information related to it.  <b>(See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;.)</b>  We can only guess at your issue. It sounds to me like you&#39;re referring to a part of an array that doesn&#39;t exist (like Index #11 in an array with an upper bound of 10)."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523032572, "post_id": 49646875, "comment_id": 86407580, "body": "@ashleedawg - I agree an MCVE helps quite a bit for testing purposes. Nevertheless, I guess the answer to my generic question about which <code>Err.Description</code> (<code>\u201cArray Index out of Bounds\u201d</code> or <code>\u201cAutomation error\u201d</code>) is associated with <code>Err.Number</code> <code>440</code> is independent of my particular case. See edit."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9719085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58934a9479ef6daa8d813627e00a2ce3?s=128&d=identicon&r=PG&f=1", "display_name": "greenhalgh000", "link": "https://stackoverflow.com/users/9719085/greenhalgh000"}, "is_accepted": false, "score": 0, "last_activity_date": 1525045110, "creation_date": 1525045110, "answer_id": 50092323, "question_id": 49646875, "link": "https://stackoverflow.com/questions/49646875/outlook-vba-error-440-array-index-out-of-bounds-or-automation-error/50092323#50092323", "title": "Outlook VBA error 440: \u201cArray Index out of Bounds\u201d or &quot;Automation error&quot;?", "body": "<p>I have a similar project I am working on and received this error when I was moving a folder of emails and one of the emails was contained in the folder was in 'draft'.</p>\n"}], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525090250, "creation_date": 1522832497, "last_edit_date": 1592644375, "question_id": 49646875, "link": "https://stackoverflow.com/questions/49646875/outlook-vba-error-440-array-index-out-of-bounds-or-automation-error", "title": "Outlook VBA error 440: \u201cArray Index out of Bounds\u201d or &quot;Automation error&quot;?", "body": "<p>I have an Outlook VBA project under Office 2016.\nWhen running a given <code>Sub</code>, I got an <code>Outlook VBA error 440: \u201cArray Index out of Bounds\u201d</code> (I could not isolate a minimal, reproducible case yet).</p>\n<p>OTOH, <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/aa264975(v=vs.60)\" rel=\"nofollow noreferrer\">official documentation</a> and many other sources state that error 440 is used for <code>&quot;Automation error&quot;</code>.\nMoreover, if I issue in the immediate window <code>Err.Raise(440)</code> I get an <code>Automation error</code>.\nThis seems quite strange to me.\nI would expect a given value of <code>Err.Number</code> to be associated with a single values of <code>Err.Description</code>.\nMy generic question is then (regardless of my particular case):</p>\n<p><strong>Can the same value of <code>Err.Number</code> be associated with two different values of <code>Err.Description</code>? Under what circumstances?</strong>\nI could not find official documentation dealing with this apparent ambiguity.</p>\n<p>PS: This OP has two close votes for &quot;unclear what you're asking&quot;...\nI guess I could not have stated my question more clearly.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1522838936, "post_id": 49648796, "comment_id": 86306107, "body": "That is unfortunate! I&#39;ve seen examples of running assembly in VBA directly etc., so have a feeling this would be possible to solve in theory - but maybe so complex that it doesn&#39;t make sense (or would get blocked by most AV software anyway) .. In my case, I&#39;m building an IPC framework where Excel communicates with another process. Part of that is e.g. marshaling COM references across processes, so calling CoMarshalInterface(), which needs to write to an IStream, which in turns means I need to create a stream first - could not find any VBA-known ones for that (ADO&#39;s stream didn&#39;t work)"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 1, "creation_date": 1522846923, "post_id": 49648796, "comment_id": 86311620, "body": "Sounds to me that you&#39;re dealing with low level COM components that are not necessarily VBA-firendly . In this case, you need to consider using an external DLL where you have the free to do what you do and expose the methods you need to invoke/pass in to the VBA. That would be simpler and much more maintainable, I think."}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1522851694, "post_id": 49648796, "comment_id": 86315495, "body": "Can&#39;t disagree; I&#39;m still torn between VBA, or a proper XLL - latter would make these kind of things a breeze of course, but comes with its own downsides in my particular use case.. anyways, appreciate your input. Didn&#39;t know Set obj = Nothing in VBA calls IUnknown::Release. I&#39;ve modified CreateStreamOnHGlobal third parameter to be a ByRef stream as stdole.IUnknown and release it; this seems to work well in that particular case. (Will leave question open for a few days though, as in principle calling other interface methods, not just Release, may be interesting as well)"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 1, "creation_date": 1522859141, "post_id": 49648796, "comment_id": 86320942, "body": "Hm. That&#39;s clever. I&#39;m cuffed I didn&#39;t think of that. If the interface also implements IDispatch, you may be able to call other methods using latebinding with a <code>Object</code> variable since that&#39;ll go through the IDispatch::Invoke and thus not rely on you knowing the interface at compile time. If It does not implement IDispatch, then I would not expect it to work for unknown interfaces."}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1522915608, "post_id": 49648796, "comment_id": 86344222, "body": "Thanks! That&#39;s very interesting regarding IDispatch - I&#39;d assume most objects in question don&#39;t implement this (e.g. the IStream return by SHCreateMemStream would be interesting) - but only one way to find out ... :)"}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": true, "score": 3, "last_activity_date": 1522837938, "creation_date": 1522837938, "answer_id": 49648796, "question_id": 49646723, "link": "https://stackoverflow.com/questions/49646723/vba-invoke-method-of-native-object-without-type-information-e-g-call-iunknow/49648796#49648796", "title": "VBA - invoke method of native object without type information (e.g. call IUnknown::Release)", "body": "<p>You have two big problems here.</p>\n\n<p>First, in VBA, <code>Set something = Nothing</code> is what you'd do to call <code>IUnknown::Release</code> on the object. But you have a pointer, not something known to the VBA, so you can't use it like an object.</p>\n\n<p>Once you've went with pointers, you must go with the pointers all the way. You really can't just go \"I wanna use it like an object but I wanna a pointer sometime\".</p>\n\n<p>The next problem is that because you got a pointer, you are now limited in VBA with what you can do with it. VBA cannot have a <code>Declare</code> statement that references namespace scoped functions like <code>IUnknown::Release</code> -- that basically belongs to a class, and can't be called directly from a <code>Declare</code> statement because you need to have an instance and do a offset from it. But you can't go to the offset, say \"let's run whatever is there\" in VBA, either.</p>\n\n<p>You <em>might</em> be able to use CopyMemory API to copy the pointer to a <code>Object</code> variable, but I really don't recommend this since it usually ends in crashes, heartbreaks and tears. </p>\n\n<p>In short, I believe we have a XY problem here. Instead of asking on how to do <code>IUnknown::Release</code> in VBA, why don't you state what you are actually trying to solve? There might be an easier solution that doesn't involve all those API messes.</p>\n"}], "owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 49648796, "answer_count": 1, "score": 3, "last_activity_date": 1522837938, "creation_date": 1522832060, "last_edit_date": 1531164843, "question_id": 49646723, "link": "https://stackoverflow.com/questions/49646723/vba-invoke-method-of-native-object-without-type-information-e-g-call-iunknow", "title": "VBA - invoke method of native object without type information (e.g. call IUnknown::Release)", "body": "<p>I'm invoking a few native functions via VBA, which at times return pointers to certain objects. For example, I'm calling CreateStreamOnHGlobal(), which would return a pointer to an IStream interface.</p>\n\n<p>But - is there any way in VBA to call a method of this object? For example, when I'm done using that, I would like to release the stream via a call to IUnknown::Release. Given I don't have any type information whatsoever though, I can't do that directly.</p>\n\n<pre><code>Declare Function CreateStreamOnHGlobal Lib \"ole32\" (ByVal hGlobal As LongPtr, ByVal fDeleteOnRelease As Long, ppstm As Any) As Long\nDeclare Function GlobalAlloc Lib \"kernel32\" (ByVal uFlags As Long, ByVal dwBytes As Long) As Long\n\nConst GMEM_MOVEABLE = &amp;H2\n\nSub test()\n  Dim pMem, pStream AS LongPtr\n\n  pMem = GlobalAlloc(GMEM_MOVEABLE,0)\n  CreateStreamOnHGlobal(pMem, 1, pStream)\n\n  ' .. do stuff with the stream ..\n\n  ' now call .Release() on the IStream object pointed to by pStream - but how??\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to call an instance method of a type of which VBA doesn't have any type information?</p>\n\n<p>I'm not well-versed in C++ / lower level languages, so I'm not quite sure how and where interface functions are represented in memory, but maybe there's some way to get a function pointer (GetProcAddr maybe?) and invoke this (CreateTread?) somehow? Appreciate any ideas!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 1, "creation_date": 1522831944, "post_id": 49646659, "comment_id": 86301337, "body": "vba is neither java nor python"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 9595530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RN.Z", "link": "https://stackoverflow.com/users/9595530/rn-z"}, "edited": false, "score": 0, "creation_date": 1522833727, "post_id": 49646756, "comment_id": 86302549, "body": "I have in the answer.  Read about optional arguments."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1522832146, "creation_date": 1522832146, "answer_id": 49646756, "question_id": 49646659, "link": "https://stackoverflow.com/questions/49646659/how-can-i-close-the-workbook-when-application-run-is-completed-in-vba/49646756#49646756", "title": "How can I close the workbook when Application.run is completed in VBA?", "body": "<p>You could add an optional argument to <code>RefreshAllWorkbooks</code> say <code>blnCloseOnComplete</code> default <code>false</code> then at the end of the function <code>if blnCloseOnComplete then thisworkbook.close {true/false}</code> then call like <code>application.run RefreshAllWorkbooks(true)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9595530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RN.Z", "link": "https://stackoverflow.com/users/9595530/rn-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1522832146, "creation_date": 1522831858, "last_edit_date": 1522831953, "question_id": 49646659, "link": "https://stackoverflow.com/questions/49646659/how-can-i-close-the-workbook-when-application-run-is-completed-in-vba", "title": "How can I close the workbook when Application.run is completed in VBA?", "body": "<pre><code>Sub openWorkBook()\nWorkbooks.Open Filename:=\"C:\\Users\\Desktop\\data\\\" &amp; Cells(2, 1).Value\nApplication.Run \"RefreshAllWorkbooks\"\nEnd Sub\n</code></pre>\n\n<p>My code is shown as above. I open another workbook and use Application.Run \"RefreshAllWorkbooks\" to refresh all of the formula in the Excel workbook. It takes about 3 minutes to finish formula calculation (Actually it draws data from Bloomberg). And I want the workbook to close after finishing refreshing all data. How to improve the VBA codes above?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "is_accepted": false, "score": 0, "last_activity_date": 1522830125, "creation_date": 1522830125, "answer_id": 49646080, "question_id": 49645860, "link": "https://stackoverflow.com/questions/49645860/creating-pdf-through-excel/49646080#49646080", "title": "Creating PDF through Excel", "body": "<p>You may use File / Export / Create PDF/XPS Document menu for this purpose.</p>\n\n<p>When this feature is used when recording a VBA macro, below code is generated, you may use it or get your own code by recording a macro. Then you may use the code within a loop to create multiple PDFs with one go.</p>\n\n<p>This feature creates the PDF using the printable area of your sheet. So you may have to adjust the print area from your code before each PDF creation.</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"\\\\test.pdf\", Quality:= _\n        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "edited": false, "score": 0, "creation_date": 1522919322, "post_id": 49664183, "comment_id": 86346670, "body": "Where is myrange variable used?"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1522902541, "creation_date": 1522902541, "answer_id": 49664183, "question_id": 49645860, "link": "https://stackoverflow.com/questions/49645860/creating-pdf-through-excel/49664183#49664183", "title": "Creating PDF through Excel", "body": "<p>This will do what you want.</p>\n\n<pre><code>Sub Save_Each_Row_As_PDF()\n\nmyrange = \"A1:J10\"\nlastRow = Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\nFor myRow = 2 To lastRow\n\n    Range(\"A\" &amp; myRow &amp; \":J\" &amp; myRow).Select\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\your_path_here\\Book\" &amp; myRow &amp; \".pdf\", Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n        False\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1593955519, "creation_date": 1522829379, "last_edit_date": 1593955519, "question_id": 49645860, "link": "https://stackoverflow.com/questions/49645860/creating-pdf-through-excel", "title": "Creating PDF through Excel", "body": "<p>I want to create a PDF file with excel data. I have rows of data in excel, for each row I want to create a PDF file and save it to my machine. How to do it with excel or access macro in vba?</p>\n"}, {"tags": ["vba", "libreoffice", "openoffice-calc"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522830329, "post_id": 49645826, "comment_id": 86300326, "body": "On what line is error? And what do you mean by &quot;And I want to have an function in &quot;OnAction&quot; &quot; ?"}, {"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522831144, "post_id": 49645826, "comment_id": 86300828, "body": "Hello, the error is in line .OnAction = &quot;add_simple_Line_for_useCaseSheet&quot; The button creation works if I leave OnAction blank add_simple_Line_for_useCaseSheet is a function"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1522831833, "post_id": 49645826, "comment_id": 86301265, "body": "The error says what ? and does your function &#39;add_simple_Line_for_useCaseSheet &#39; have arguments ?"}, {"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522833503, "post_id": 49645826, "comment_id": 86302409, "body": "Hello, my function add_simple_Line_for_useCaseSheet is a function without parameters. it looks like   sub add_simple_Line_for_useCaseSheet     some Code End sub"}, {"owner": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1523039045, "post_id": 49645826, "comment_id": 86411024, "body": "Please ask a complete question. Do not add many comments all over here, edit your question to make it better."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522832385, "post_id": 49646177, "comment_id": 86301645, "body": "Hello, I did it that way several times. Could you show me how your &quot;MyMacro&quot; looks like ? maybe im missing a keyword or something."}, {"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522833991, "post_id": 49646177, "comment_id": 86302743, "body": "Hello, did you test it with Libreoffice 6 ?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522834190, "post_id": 49646177, "comment_id": 86302895, "body": "I didn\u2019t. And I can\u2019t since I don\u2019t have it"}, {"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522834211, "post_id": 49646177, "comment_id": 86302911, "body": "And did your function look like sub myNewFunction() With ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)         .OnAction = &quot;MyMacro&quot; &#39; change &quot;MyMacro&quot; to your actual macro name         .Caption = &quot;Add TestCase to  &quot; &amp; sReturn         .Name = &quot;Btn&quot; &amp; i     End With End Sub   sry I don&#39;t know how to comment in code format"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522837035, "post_id": 49646177, "comment_id": 86304880, "body": "I\u2019m not by my PC anymore, but I can tell you my Sub was like my shown code plus preceeding 1) dimming of involved variables (e.g: Dim t As Range, Dim i As Long) 2) initialization of i and setting of t range"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522832747, "last_edit_date": 1522832747, "creation_date": 1522830387, "answer_id": 49646177, "question_id": 49645826, "link": "https://stackoverflow.com/questions/49645826/execute-a-sub-function-on-a-button-which-is-created-programatically/49646177#49646177", "title": "Execute a sub Function on a button which is created programatically", "body": "<p>go as follows</p>\n\n<pre><code>    With ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n        .OnAction = \"MyMacro\" ' change \"MyMacro\" to your actual macro name\n        .Caption = \"Add TestCase to  \" &amp; sReturn\n        .Name = \"Btn\" &amp; i\n    End With\n</code></pre>\n\n<p>I tested it with the following macro <em>attached</em> to the button:</p>\n\n<pre><code>Sub MyMacro()\n    MsgBox \"HellO\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522832290, "post_id": 49646258, "comment_id": 86301577, "body": "Thank you for taking your time to answer. I copied your example and looked on the example on ozgrid.com and I still got an error in the .OnAction line. BASIC runtime Error &#39;1&#39; Type: com.sun.star.uno.RuntimeException Message: . Thats my error Message  Im using the newest  libre office. Do you think your example works in Libre office ? i have no idea why it doesn&#39;t work, every example I try results in the same result."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522832403, "post_id": 49646258, "comment_id": 86301662, "body": "It may indeed be a problem with what is supported in Libre Office. What is the rest of the message?  BASIC runtime Error &#39;1&#39; Type: com.sun.star.uno.RuntimeException Message: ........."}, {"owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "edited": false, "score": 0, "creation_date": 1522833450, "post_id": 49646258, "comment_id": 86302375, "body": "Hello, no there is no information besides   BASIC runtime error. &#39;1&#39;  Type: com.sun.star.uno.RuntimeException Message:   thats all. No further information. If I google basic runtime error 1 there is also not much information"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522842819, "last_edit_date": 1522842819, "creation_date": 1522830651, "answer_id": 49646258, "question_id": 49645826, "link": "https://stackoverflow.com/questions/49645826/execute-a-sub-function-on-a-button-which-is-created-programatically/49646258#49646258", "title": "Execute a sub Function on a button which is created programatically", "body": "<p>For Excel:</p>\n\n<p>Using a direct example from <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/18850-menu-bar-macro-parameters?t=28365\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>Sub test()\n\n    Dim t As Range\n    Dim Buttons As Object\n\n    Set t = ActiveSheet.Range(Cells(i + 6, 4), Cells(i + 6, 5)) '+6 to start at cell 6\n    Set Buttons = ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n\n    With Buttons\n        .OnAction = \"'Btn3 \"\"Hello\"\", 123'\"\n        .Caption = \"Add TestCase to  \" &amp; sReturn\n        .Name = \"Btn\" &amp; i\n\n    End With\n\nEnd Sub\n\nSub Btn3(strString As String, iInt As Integer)\n    MsgBox \"String = \" &amp; strString &amp; vbNewLine &amp; \"Integer = \" &amp; iInt\nEnd Sub\n</code></pre>\n\n<p>Caveat:</p>\n\n<p>Unable to test on Office Libre. This may be unsupported functionality.</p>\n"}, {"tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1522870220, "creation_date": 1522870220, "answer_id": 49658993, "question_id": 49645826, "link": "https://stackoverflow.com/questions/49645826/execute-a-sub-function-on-a-button-which-is-created-programatically/49658993#49658993", "title": "Execute a sub Function on a button which is created programatically", "body": "<blockquote>\n  <p>im rather new to VBA... the solutions work in Excel not in Libreoffice.</p>\n</blockquote>\n\n<p>So new that you do not even know what language to use!  For some reason, this seems to be a common misunderstanding.  Microsoft Excel uses VBA. \n For LibreOffice, write in <a href=\"https://help.libreoffice.org/Basic/Basic_Help\" rel=\"nofollow noreferrer\">LibreOffice Basic</a>.</p>\n\n<p>Complete example code for creating buttons is at <a href=\"https://forum.openoffice.org/en/forum/viewtopic.php?t=27424\" rel=\"nofollow noreferrer\">https://forum.openoffice.org/en/forum/viewtopic.php?t=27424</a>.</p>\n\n<p>A good place to start learning Basic is <a href=\"http://www.pitonyak.org/oo.php\" rel=\"nofollow noreferrer\">http://www.pitonyak.org/oo.php</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7592074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1470737492970371/picture?type=large", "display_name": "Florian Pilsl", "link": "https://stackoverflow.com/users/7592074/florian-pilsl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 49646258, "answer_count": 3, "score": -2, "last_activity_date": 1522870220, "creation_date": 1522829244, "last_edit_date": 1522842572, "question_id": 49645826, "link": "https://stackoverflow.com/questions/49645826/execute-a-sub-function-on-a-button-which-is-created-programatically", "title": "Execute a sub Function on a button which is created programatically", "body": "<p>im rather new to VBA. MY problem is:</p>\n\n<p>I create a Button when I Click another Button: the create Button is created as followed: </p>\n\n<pre><code>Set t = ActiveSheet.Range(Cells(i +6, 4), Cells(i+6, 5)) '+6 to start at cell 6\n    Set buttons =   ActiveSheet.Buttons.Add(t.Left, t.Top , t.Width, t.Height)\n        With buttons\n            .OnAction = \"\"  \n            .Caption = \"Add TestCase to  \" &amp; sReturn\n            .Name = \"Btn\" &amp; i\n\n        End With\n</code></pre>\n\n<p>And I want to have an function in \"OnAction\". But I just doesn't Work, I receive a \"Syntax Error\". Basically I just want to have a function executed on a Click on a button which is created programatically. I also looked several forums for this problem and nothing worked, I think cause it is libreoffice.<br>\nEdit: the solutions work in Excel not  in Libreoffice</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522828506, "post_id": 49645597, "comment_id": 86299310, "body": "If you post what you have tried so far, we can help to fix the issues in your code"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1522831312, "post_id": 49645597, "comment_id": 86300943, "body": "you can&#39;t &quot;set&quot; the ActiveCell like that - you need <code>Range(wert).Activate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1522832185, "post_id": 49645944, "comment_id": 86301500, "body": "<code>Cells(Rows.Count, 1).End(xlUp).Row</code> gets columns A last not empty cell row index &quot;from the bottom&quot;, i.e. there may be other empty cells in between this cell and first row, while OP wants <i>&quot;the first empty cell in column A&quot;</i>"}, {"owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522832538, "post_id": 49645944, "comment_id": 86301758, "body": "should be fine too."}, {"owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522844743, "post_id": 49645944, "comment_id": 86310027, "body": "It doesn&#39;t work the way I intended, because I have a couple of other lines before and after, I can&#39;t use the &quot;Exit Sub&quot;. Is there another way to skip the 2nd part with the empty cell as soon as the first is correct?"}], "tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": true, "score": 0, "last_activity_date": 1522847052, "last_edit_date": 1522847052, "creation_date": 1522829692, "answer_id": 49645944, "question_id": 49645597, "link": "https://stackoverflow.com/questions/49645597/vba-userform-search-for-existing-number-and-choose-row/49645944#49645944", "title": "VBA Userform: Search for existing number and choose row", "body": "<p>Test the code below :</p>\n\n<p>Edit (Even though it's not an optimized solution) :</p>\n\n<pre><code>Sub myTest()\n        lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n        found = 0\n        i = 1\n        Do While found = 0 And i &lt;= lastRow\n            If Cells(i, 1).Value = custno Then\n                'Activate the cell\n                Cells(i, 1).Activate\n                found = 1\n            End If\n            i = i + 1\n        Loop\n\n        If found = 0 Then\n            ' Get The first empty cell in column A\n            On Error Resume Next\n            firstEmptyCell = Range(\"A1:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n            If firstEmptyCell = vbNullString Then\n                n = Cells(Rows.Count, 1).End(xlUp).Row + 1\n            Else\n                n = firstEmptyCell\n            End If\n            ' If not found Activate The Last empty cell in column A\n            Cells(n, 1).Activate\n        End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522833784, "post_id": 49646340, "comment_id": 86302587, "body": "@spqx, any feedback?"}, {"owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522845114, "post_id": 49646340, "comment_id": 86310287, "body": "unfortunatly doesn&#39;t work. I don&#39;t get any errors but the changes in the userform won&#39;t get saved in the table."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522845505, "post_id": 49646340, "comment_id": 86310560, "body": "Your question wasn\u2019t about any change in userform to be saved in the sheet. It was about selecting cells in the sheet with relation to some userform control value"}, {"owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522845692, "post_id": 49646340, "comment_id": 86310710, "body": "Yes you&#39;re right. The second part of the code is about writing userform input into the active column. I&#39;ve tested again, and your code doesn&#39;t select an empty or used cell, it keeps stuck at A1."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522846637, "post_id": 49646340, "comment_id": 86311427, "body": "Step through it: place a breakpoint (press F9) at the line \u201cWith Range(\u201cA1\u201d,...\u201d and once the execution stops there press F8 to step to subsequent codelines and query relevant variables in Immediate Window (CTRL-G to pop it out), e.g. type \u201c?Me.custno\u201d and press return and see its current value"}, {"owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "edited": false, "score": 0, "creation_date": 1522846976, "post_id": 49646340, "comment_id": 86311663, "body": "You code just works fine. I had a line from an old try between the subs which changed the worksheet. After deleting the trouble causing line it works as intended. Thanks a lot!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 2, "last_activity_date": 1522830908, "creation_date": 1522830908, "answer_id": 49646340, "question_id": 49645597, "link": "https://stackoverflow.com/questions/49645597/vba-userform-search-for-existing-number-and-choose-row/49646340#49646340", "title": "VBA Userform: Search for existing number and choose row", "body": "<p>use this</p>\n\n<pre><code>Dim f As Range\nWith Range(\"A1\", Cells(Rows.Count, 1).End(xlUp)) ' reference all column A cells from row 1 down to last not empty one\n    Set f = .Find(what:=Me.custno, LookIn:=xlValues, lookat:=xlWhole) ' try finding 'custno'\n    If f Is Nothing Then 'if unsuccessful\n        .Cells(1, 1).End(xlDown).Offset(1).Activate ' activate the first not empty cell\n    Else 'else\n        f.Activate ' activate found cell\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8889148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e91b1343e5874c9bdd86477b94d570?s=128&d=identicon&r=PG&f=1", "display_name": "spqx", "link": "https://stackoverflow.com/users/8889148/spqx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 49645944, "answer_count": 2, "score": -2, "last_activity_date": 1522847052, "creation_date": 1522828365, "last_edit_date": 1522828618, "question_id": 49645597, "link": "https://stackoverflow.com/questions/49645597/vba-userform-search-for-existing-number-and-choose-row", "title": "VBA Userform: Search for existing number and choose row", "body": "<p>I got an excel sheet which has data about customers.\nI created a userform, which lets me input all information and save it.</p>\n\n<p>Now I want the userform to check column A (customer n\u00ba), and if the customer n\u00ba of the userform is already in there, I want it to select that row as active row/cell.\nIf not, I want the active cell to be the first empty cell in column A.</p>\n\n<p>I've tried a lot so far (For, if &amp; elseif, ...) but nothing seems to work.</p>\n\n<p>Can anyone help me? Thanks a lot and a nice day</p>\n\n<p>Edit: This is my latest try:</p>\n\n<pre><code>For i = 3 To 300000\nwert = \"A\" &amp; i\nIf Range(wert).Value = custno Then\nActiveCell = wert\n\nElseIf wert = \"\" Then\nActiveCell = Range(wert).Offset(1, 0)\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522830813, "post_id": 49645401, "comment_id": 86300621, "body": "How did the image <b>get onto</b> the clipboard in the first place?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522832272, "post_id": 49645401, "comment_id": 86301563, "body": "Hold On, what are you <b><i>actually</i></b> trying to do?  Is the goal to save an Excel chart as an image?  It seems like you&#39;re trying to find a workaround for a workaround for a workaround.  Your code shows an Excel Chart, yet your Question says Excel, and there&#39;s no indication of why it needs to be saved as a JPG as opposed to PNG or BMP.  Please, you need to give more information about what you&#39;re <b><i>actually trying to do</i></b>."}, {"owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522842361, "post_id": 49645401, "comment_id": 86308353, "body": "I&#39;m trying to update a tool that saves snapshots created with W7 default Snipping Tool. When user have a comment regarding drawing or other document he can simply make a screenshot of problematic area with Snipping Tool, select row in MS Access datasheet form and press &quot;add&quot; button. Current version of script uses external excel file (chart object) to make jpg and add link to specific row in MS Access form.  I found that possible solution may be freeimage.dll. I managed to convert image format but I&#39;m struggling with connection to clipboard..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522844772, "post_id": 49645401, "comment_id": 86310050, "body": "So you currently have VBA for Excel that inserts a JPG into an Access table?  It currently works but you&#39;re trying to eliminate Excel as a &quot;middle-man&quot;, correct?  Please post that code."}, {"owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522846346, "post_id": 49645401, "comment_id": 86311214, "body": "Code added. GoaI is to get rid of &quot;middle-man&quot; (excel) and do whole thing in MS Access. Now I have Access VBA that opens excel file and runs sub stored in excel file. Image in clipboard is pasted to excel worksheet, converted to chart object, saved to specific folder. When done excel file is closed without saving."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522834532, "post_id": 49647393, "comment_id": 86303127, "body": "In this case... do not <a href=\"https://www.google.co.uk/search?q=be+like+bob&amp;safe=strict&amp;tbm=isch&amp;tbo=u&amp;source=univ&amp;sa=X&amp;ved=0ahUKEwiE35bOqKDaAhUbOsAKHaaXBLYQsAQIKA&amp;biw=1422&amp;bih=659\" rel=\"nofollow noreferrer\">&quot;be like bob&quot;</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522834739, "post_id": 49647393, "comment_id": 86303282, "body": "@QHarr - isn&#39;t that supposed to be <a href=\"https://en.wikipedia.org/wiki/Be_like_Bill\" rel=\"nofollow noreferrer\">&quot;be like bill&quot;</a>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522844807, "post_id": 49647393, "comment_id": 86310077, "body": "@QHarr  That <i>must</i> be it.  :)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522846107, "post_id": 49647393, "comment_id": 86311047, "body": "As I interpreted it, OP is using a trick to get the image from the clipboard: open up a blank excel worksheet, execute a paste (pasting the image that&#39;s currently on the clipboard), save the pasted image to a jpg. The current code looks so non-functional, however, that I can&#39;t tell. But using that trick this should be possible."}, {"owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "edited": false, "score": 0, "creation_date": 1522847408, "post_id": 49647393, "comment_id": 86311966, "body": "In case of VBA I&#39;m self taught. I know that my code may look like... well not very proffesional but I&#39;m trying to do my best. I&#39;m out of ideas how to save picture from clipboard to jpg file without using excel (only MS Access VBA)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "edited": false, "score": 0, "creation_date": 1523170212, "post_id": 49647393, "comment_id": 86443508, "body": "@KrzysztofDrabik - I, too, am self taught VBA (I think most of us are).  No need to be perfect; just always willing to improve &amp; take advice. ;)  As for your issue, I&#39;ve put a lot of thought into it (this post has been a shortcut on my desktop staring at me all week!) and I don&#39;t think it&#39;s easily possible without using 3rd party tools. That being said, there are always alternative solutions.  For example, I still don&#39;t understand why you require <a href=\"https://en.wikipedia.org/wiki/JPEG\" rel=\"nofollow noreferrer\">JPG compression</a> specifically. Other formats could be easier to work with."}, {"owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "edited": false, "score": 0, "creation_date": 1523269781, "post_id": 49647393, "comment_id": 86475048, "body": "@ashleedawg I picked jpg because it is commonly used but if png or tiff will do the job then why not. I just want to save hdd space. As I mentioned before I managed to use freeimage.dll library to convert bmp to jpg but I still don&#39;t know how to create image object from clipboard that this library accepts. I&#39;ll try to ask in <a href=\"https://sourceforge.net/p/freeimage/discussion/36109/\" rel=\"nofollow noreferrer\">project&#39;s site</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "edited": false, "score": 0, "creation_date": 1523293740, "post_id": 49647393, "comment_id": 86490617, "body": "@KrzysztofDrabik as I stated, any image on the clipboard is stored as a Bitmap... so you&#39;re saying if you could save the image from the clipboard at a <code>.BMP</code> file then you can handle the conversion?"}, {"owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "edited": false, "score": 0, "creation_date": 1523345305, "post_id": 49647393, "comment_id": 86509935, "body": "@ashleedawg yes, I can handle conversion from .bmp to .jpg with freeimage.dll. I managed to convert tiff to jpg, I checked their documentation and bmp is also listed as input. Freeimage has function to save screenshot of whole screen or specific app window (by its ID) but it doesn&#39;t solve my problem - I want to save only selected part of screen. In problem description I mentioned working code but it works in excel, not in access."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522834059, "creation_date": 1522834059, "answer_id": 49647393, "question_id": 49645401, "link": "https://stackoverflow.com/questions/49645401/ms-access-save-picture-from-clipboard-as-jpg/49647393#49647393", "title": "MS Access save picture from clipboard as jpg", "body": "<p>Anything's possible but (for lack of further information) I suspect the suitable answer in this case is <strong>it's not possible</strong>.  At least not with the help of third-party utilities or other programming languages.</p>\n\n<p>To understand why, you need to understand how the clipboard works.  Here's some <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.clipboard(v=vs.110).aspx\" rel=\"nofollow noreferrer\">.NET documentation about the Clipboard Class</a>, but she short version is: not everything is stored the same way on a clipboard.</p>\n\n<ul>\n<li><p>When the clipboard stores a copied image, it's stored as Bitmap, always.  </p></li>\n<li><p>When the clipboard stores a file (like a JPG), it's not storing the actual data; it's storing a \"pointer\" to the file.  If you copy a JPG file to the clipboard, and delete the file, it can't be retrieved from the Clipboard either.   </p></li>\n</ul>\n\n<p><strong>Based on your code</strong>, I suspect what you're <em>trying</em> to do doing is copy a chart from Excel (or something similar) to the clipboard and wanting to save it to a file, as a workaround towards saving the object directly to file.</p>\n\n<p>If you're trying to save an Excel Object like a chart as a JPG File then do it directly:</p>\n\n<pre><code>ActiveChart.Export \"c:\\outputPath\\outputFileName.jpg\", \"JPG\"\n</code></pre>\n\n<p>Other graphics filters can also be used, depending on what's installed on your machine.</p>\n\n<hr>\n\n<h2>More information:</h2>\n\n<ul>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/chart-export-method-excel\" rel=\"nofollow noreferrer\"><strong>Chart.Export Method</strong> (Excel)</a></p></li>\n<li><p><a href=\"http://www.thewindowsclub.com/export-excel-charts-as-images\" rel=\"nofollow noreferrer\">How to easily export Excel Charts as Images</a></p></li>\n</ul>\n\n<hr>\n\n<p><sub>(I suspect this is example of a common problem around here: the <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\"><strong>XY Problem</strong></a>:  Programmer Bob is stuck on problem X, which he doesn't know how to solve.  He comes up with potential solution Y, but doesn't know exactly how to solve that either, so Bob asks for help with problem Y, which almost always results in unnecessary work for everyone involved, when Bob should have just asked about problem X.)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 2, "last_activity_date": 1525792406, "creation_date": 1525792406, "answer_id": 50236927, "question_id": 49645401, "link": "https://stackoverflow.com/questions/49645401/ms-access-save-picture-from-clipboard-as-jpg/50236927#50236927", "title": "MS Access save picture from clipboard as jpg", "body": "<p>Bit late but in case if you are still interested in this function. You can have a look at my <a href=\"https://github.com/krishKM/VBA_TOOLS/blob/master/README.md#save-clipboard-images-to-local-file\" rel=\"nofollow noreferrer\">VBA Tools Dll</a> Which allows to save clipbord images to a location you provide. There is a sample accdb file with vba wrapper for download in the sample folder.</p>\n\n<p>using vba wapper from the sample file it would be:</p>\n\n<pre><code>SaveClipboardToImage()\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SaveClipboardToImage(Optional Path As String = \"\", Optional FileNAme As String = \"\", Optional FileType As String = \"jpeg\")\n</code></pre>\n\n<p>which will return the full filepath where your file has been saved as or \"\" if no Image is found in clipboard.</p>\n\n<p>Please feel free to use online antivirus scanners before using any dlls.</p>\n"}], "owner": {"reputation": 11, "user_id": 9123305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/743f4bfaf4162aba9da5701449c6b684?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Drabik", "link": "https://stackoverflow.com/users/9123305/krzysztof-drabik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4265, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593955443, "creation_date": 1522827723, "last_edit_date": 1593955443, "question_id": 49645401, "link": "https://stackoverflow.com/questions/49645401/ms-access-save-picture-from-clipboard-as-jpg", "title": "MS Access save picture from clipboard as jpg", "body": "<p>I'm looking for code to save screenshot from clipboard as jpg file directly in MS access or VBA method to convert bmp to jpg. I found workaround but I'm not satisfied with its speed. (I'm using MS Access to open excel file, run code to paste and save picture as jpg, code below). </p>\n\n<p>I found <a href=\"https://www.mrexcel.com/forum/excel-questions/260955-how-do-i-save-bitmap-image-clipboard-bmp-file.html\" rel=\"nofollow noreferrer\">working code</a> but it saves picture as *.bmp. </p>\n\n<p>I'm using MS Access 2016</p>\n\n<p>Code in MS Access file:</p>\n\n<pre><code>Sub Copy_screenshot_to_file()\nDim db As Database\nSet db = CurrentDb()\nDim qSQL As String\n\nDim xl As Object\nDim xlApp As Object\nDim xlPath As String\nDim fPath As String\nfPath = \"\\\\XXX\\\"      'New file location\nxlPath = \"\\\\XXX...\\Export to JPG tool.xlsm\"      'excel file location\n\nDim dwg_nr As String\nDim row_nr As Long\nDim fName As String\nDim lName As String\nDim Date1 As Date\n\ndwg_nr = Screen.ActiveForm![PID_nr].Value\nrow_nr = Screen.ActiveForm![ID_num].Value\n\n'file name gen\nDate1 = Now()\nfName = dwg_nr &amp; \" \" &amp; Format(Date1, \"yyyy.dd.mm hh-mm\")\nlName = fPath &amp; fName &amp; \".jpg\"\n\n\n'generate screenshot\nSet xl = CreateObject(\"Excel.Application\")\nxl.Workbooks.Open (xlPath)\nxl.Visible = True '\nxl.Run \"RunCodeFromAccess\", fName, fPath\nxl.ActiveWorkbook.Close (False)\nxl.Quit\nSet xl = Nothing\n\nIf Dir(lName) = \"\" Then\n    MsgBox \"JPG file not created, please make new screenshot\"\n    Exit Sub\nEnd If\n\n\n'add link to DB\nqSQL = \"UPDATE tblXXX SET Field12 = '\" &amp; lName &amp; \"' WHERE ID_num = \" &amp; row_nr\ndb.Execute qSQL, dbFailOnError\n\nEnd Sub\n</code></pre>\n\n<p>Code in excel file: </p>\n\n<pre><code>Sub RunCodeFromAccess(Fname As String, fPath As String)\n\nDim ws As Worksheet\nSet ws = Sheets(\"Sheet1\")\nws.Paste\n'Range(\"A1\").Paste\nDim oDia As Object\nDim oChartArea\nDim sh As Shape\nDim PicName As String\n\nFor Each sh In ws.Shapes\nPicName = Fname\n    sh.CopyPicture\n    Set oDia = ws.ChartObjects.Add(0, 0, sh.Width, sh.Height)\n    Set oChartArea = oDia.Chart\n    oDia.Activate\n    With oChartArea\n        .ChartArea.Select\n        .Paste\n        .Export (fPath &amp; PicName &amp; \".jpg\")\n    End With\n    oDia.Delete\nsh.Delete\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["csv", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1522863277, "post_id": 49645230, "comment_id": 86323223, "body": "What exactly are you having trouble with?"}, {"owner": {"reputation": 11, "user_id": 7836104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38441dd21495805199ae9adfad0c0?s=128&d=identicon&r=PG&f=1", "display_name": "n.hanz", "link": "https://stackoverflow.com/users/7836104/n-hanz"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1522880205, "post_id": 49645230, "comment_id": 86332300, "body": "I already managed to solve it. Turns out I only had to change the HasFieldName parameter to false. Thanks for the help though :) Sorry, I&#39;m a bit new here, so do I need to answer my question now or do I do anything else?"}], "owner": {"reputation": 11, "user_id": 7836104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38441dd21495805199ae9adfad0c0?s=128&d=identicon&r=PG&f=1", "display_name": "n.hanz", "link": "https://stackoverflow.com/users/7836104/n-hanz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594636166, "creation_date": 1522827183, "last_edit_date": 1594636166, "question_id": 49645230, "link": "https://stackoverflow.com/questions/49645230/import-csv-to-ms-access-without-setting-table-column", "title": "Import CSV to MS Access without setting table column", "body": "<p>I have managed to import a csv file into a ms access table before, but this was done by specifying the table columns beforehand to match the csv. I am planning to tackle a larger csv file and was wondering if it is possible to have the table columns entered programmatically.</p>\n\n<pre><code>Private Sub Import_Click()\n'import excel file\n\n'delete current table data\n With CurrentDb\n CurrentDb.Execute \"DeleteTableData\"\nEnd With\n\n'import\nDim f As Variant\nSet f = Application.FileDialog(3)\n'set dialog title\nWith f\n.Title = \"Choose File\"\nf.AllowMultiSelect = False\n\n'Use the Show method to display the File Picker dialog box and return the \nuser's action.\n'The user pressed the action button.\nIf .Show = -1 Then\nFor Each f In .SelectedItems\n\n\n'import into table\nDoCmd.TransferText acImportDelim, , \"[Table1]\", f, True\nNext f\nMsgBox \"File Imported\"\nElse\n'Show if Canceled is selected in a message box\nf = \"No File Selected to Import.\"\nMsgBox f\nEnd If\n\nEnd With\nDoCmd.SetWarnings True\nDoCmd.Hourglass False\n\nEnd Sub\n</code></pre>\n\n<p>The user is able to choose any csv file they want and onclick it will import it and enter the data into a table.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1522825268, "post_id": 49644685, "comment_id": 86297205, "body": "<a href=\"https://stackoverflow.com/a/30393989/4539709\">stackoverflow.com/a/30393989/4539709</a>"}, {"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1522826696, "post_id": 49644685, "comment_id": 86298091, "body": "@0m3r thanks for the quick reply, unfortunately the code in the link closes <code>ThisWorkbook</code>."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 1, "creation_date": 1522834320, "post_id": 49644944, "comment_id": 86302985, "body": "So basically make a copy of the macro enabled file, open it, save the copy without any code and delete the macro enable copy ? Simple enough, thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1522834693, "post_id": 49644944, "comment_id": 86303244, "body": "@CCM Yes, basically that&#39;s it. I think it is better than the approach in your question, because it doesn&#39;t re-open the file the code is actually running in and therefore does not interrupt the running code."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1522826475, "last_edit_date": 1522826475, "creation_date": 1522826115, "answer_id": 49644944, "question_id": 49644685, "link": "https://stackoverflow.com/questions/49644685/how-to-save-a-macroless-copy-without-closing-the-current-file/49644944#49644944", "title": "How to save a macroless copy without closing the current file?", "body": "<ol>\n<li>Define your path <code>sPath = ThisWorkbook.Path &amp; \"\\\" &amp; sFileName</code> without extension</li>\n<li>Use <code>ThisWorkbook.SaveCopyAs sPath &amp; \".xlsm\"</code> to save a copy.</li>\n<li>Open that copy with <code>Set Wb = Application.Workbooks.Open(sPath &amp; \".xlsm\")</code></li>\n<li>Save again without <code>Wb.SaveAs sPath &amp; \".xlsx\", xlOpenXMLWorkbook</code></li>\n<li>Close workbook <code>Wb.Close SaveChanges:=False</code></li>\n</ol>\n\n<p>So something like the following should work, and would keep your current code running without any re-opening side effects of the current workbook.</p>\n\n<pre><code>Dim sPath As String\nsPath = ThisWorkbook.Path &amp; \"\\\" &amp; sFileName 'no extension!\n\nThisWorkbook.SaveCopyAs sPath &amp; \".xlsm\"\nDim Wb As Workbook\nSet Wb = Application.Workbooks.Open(sPath &amp; \".xlsm\")\nWb.SaveAs sPath &amp; \".xlsx\", xlOpenXMLWorkbook\nWb.Close SaveChanges:=False\n</code></pre>\n\n<p>And probably you want to delete the <code>xlsm</code> file copy</p>\n\n<pre><code>Kill sPath &amp; \".xlsm\"\n</code></pre>\n\n<p>You might want to make use of <code>Application.DisplayAlerts = False</code> and <code>Application.ScreenUpdating = False</code>.</p>\n"}], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1865, "favorite_count": 0, "accepted_answer_id": 49644944, "answer_count": 1, "score": 2, "last_activity_date": 1522827829, "creation_date": 1522825101, "last_edit_date": 1522827282, "question_id": 49644685, "link": "https://stackoverflow.com/questions/49644685/how-to-save-a-macroless-copy-without-closing-the-current-file", "title": "How to save a macroless copy without closing the current file?", "body": "<p>I am trying to save a copy of <code>ThisWorkbook</code> in <code>xlsx</code> while using <code>SaveCopyAs</code>. The problem is that <code>SaveCopyAs</code> saves the file as a macro enabled file, <code>xlsb</code> in my case which is not desired and while <code>SaveAs</code> does what I need, it also closes <code>ThisWorkbook</code> .</p>\n\n<p>Is there an easier way to save in a format that does not support macros and without doing workarounds ?</p>\n\n<p>Currently the best solution I found is the code snip below, but it's kinda finicky and it does not save the <code>ContentTypeProperties</code> that I need further on in the project, so does need to be added again.</p>\n\n<p>Any ideas are appreciated, thanks!</p>\n\n<pre><code>Dim sPath as String\n\nsPath = ThisWorkbook.FullName\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; sFileName &amp; \".xlsx\", 51\nApplication.Workbooks.Open (sPath)\nApplication.DisplayAlerts = True\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1522827404, "post_id": 49644236, "comment_id": 86298565, "body": "Have a look at dLookup."}], "answers": [{"comments": [{"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1522847428, "post_id": 49647756, "comment_id": 86311974, "body": "Thank you, this was indeed what I was looking for and it worked after reading up more on &quot;Select statements inside Insert statements&quot;"}], "tags": [], "owner": {"reputation": 1901, "user_id": 7182460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9dc8963c161d5689dc85c6771cf4b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Neil B", "link": "https://stackoverflow.com/users/7182460/neil-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1522834996, "creation_date": 1522834996, "answer_id": 49647756, "question_id": 49644236, "link": "https://stackoverflow.com/questions/49644236/look-up-value-in-linked-table-beforeinserting-corresponding-value/49647756#49647756", "title": "Look up value in linked table beforeinserting corresponding value", "body": "<p>Something like this:</p>\n\n<p><code>INSERT INTO tbl_user(day) VALUES((SELECT ID FROM tbl_dayOfWeek WHERE weekday = 'dayStringName'))</code></p>\n"}], "owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 49647756, "answer_count": 1, "score": 0, "last_activity_date": 1522834996, "creation_date": 1522823407, "last_edit_date": 1522825563, "question_id": 49644236, "link": "https://stackoverflow.com/questions/49644236/look-up-value-in-linked-table-beforeinserting-corresponding-value", "title": "Look up value in linked table beforeinserting corresponding value", "body": "<p>I am over simplifying what can only really be called an annoyance, that I am wondering if there is an answer for.</p>\n\n<p><em>The following is just an example</em> </p>\n\n<p>Say I have <code>tbl_user</code> with field <code>day</code> that is in a relationship with another table called <code>tbl_dayOfWeek</code>.</p>\n\n<p><code>tbl_user.day</code> takes a number that corresponds to the ID of <code>tbl_dayOfWeek</code>, where every <code>tbl_dayOfWeek.ID</code> is connected to a day of the week like <code>tbl_dayOfWeek.weekday</code>.</p>\n\n<p>Now every time I want to insert a record into tbl_user, the data that I have is the day of the week as a String - for instance <code>\"Monday\"</code>. So before I can enter the record I must first make a select query every time to find the ID number that corresponds to the string day value that I have, in the tbl_dayOfWeek table. </p>\n\n<p>My question is, is there a way to write the insert query where it looks up the corresponding day number when you give it the day string value, instead of me having to make two database calls to get the number of the string first, so that I can enter the number?</p>\n\n<p>Something like: \"INSERT INTO tbl_user (day) VALUES (tbl.dayOfWeek.ID) WHERE 'dayStringName' = tbl.dayOfWeek.weekday</p>\n"}, {"tags": ["excel", "pdf", "ms-word", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1522825726, "post_id": 49643742, "comment_id": 86297502, "body": "As pointed out in the <i>&quot;answer&quot;</i> provided by @Peh you&#39;ll need to use another program to password protect your files. If you want to create some sort of automation for that with VBA then you should make sure that this external program provides a VBA reference to access this program from Excel. Alternatively you can also put each file into a password protected ZIP file like so: <a href=\"https://stackoverflow.com/a/24529843/1153513\">stackoverflow.com/a/24529843/1153513</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1522825832, "post_id": 49643742, "comment_id": 86297575, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22448766/excel-vba-export-workbook-to-password-protected-zip-file\">EXCEL VBA- Export Workbook to Password-Protected ZIP file</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522859447, "post_id": 49644428, "comment_id": 86321085, "body": "Thanks a lot PEH for reply. Can you give us some more details of how using PDFCreator?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522871173, "post_id": 49644428, "comment_id": 86327785, "body": "@YasserKhalil that&#39;s too broad to answer here, but there are many tutorials out there on Google how to create password protected PDF files with VBA and PDFCreator. These should be detailed enough."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522877621, "post_id": 49644428, "comment_id": 86331225, "body": "Thanks a lot for reply. I already googled and installed PDFCteator it doesn&#39;t seem to work with newer versions .. It doesn&#39;t work for me"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522908624, "post_id": 49644428, "comment_id": 86340252, "body": "@YasserKhalil Well telling &quot;<i>it doesn&#39;t seem to work</i>&quot; is completely useless because it doesn&#39;t say anything meaningful. As I said this cannot be answered here in a comment. If you have a question ask a <i>new question</i> show the code you have tried in your question and tell which errors you get and in which line. Then ask a proper question to that code (reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help). &quot;<i>It doesn&#39;t work for me</i>&quot; doesn&#39;t help us to understand your issue."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522925565, "post_id": 49644428, "comment_id": 86351072, "body": "Thanks a lot. Here&#39;s the link <a href=\"https://www.excelguru.ca/content.php?185-Using-PDFCreator-with-security-options-set\" rel=\"nofollow noreferrer\">From Here</a> and I have added reference of PDFCreator but still got error on this line Dim pdfjob As PDFCreator.clsPDFCreator That&#39;s all .."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1522927817, "post_id": 49644428, "comment_id": 86352636, "body": "I can only say: Read my last comment carefully again."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1522824234, "creation_date": 1522824234, "answer_id": 49644428, "question_id": 49643742, "link": "https://stackoverflow.com/questions/49643742/mass-set-password-on-multiple-pdf-files/49644428#49644428", "title": "Mass Set Password on Multiple PDF Files", "body": "<p>Excel or Word cannot export a password protected PDF file. That's not supported. You would need a 3\u02b3\u1d48 party program like <em>PDFCreator</em> for that.</p>\n"}], "owner": {"reputation": 45, "user_id": 7922901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed32f4e562df19477415c121d1a3d540?s=128&d=identicon&r=PG&f=1", "display_name": "Junyi", "link": "https://stackoverflow.com/users/7922901/junyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 0, "accepted_answer_id": 49644428, "answer_count": 1, "score": 1, "last_activity_date": 1522824234, "creation_date": 1522821232, "last_edit_date": 1531164843, "question_id": 49643742, "link": "https://stackoverflow.com/questions/49643742/mass-set-password-on-multiple-pdf-files", "title": "Mass Set Password on Multiple PDF Files", "body": "<p>I have a batch of 700 pdf files which require me to password protect.</p>\n\n<p>My files are prepared using MailMerge in Words to obtain data from Excel and input into 700 pages of fixed template den convert them into each single pdf file.</p>\n\n<p>Am I able to password protect when I convert them to each single pdf file or am I able to use another method, for example, using Excel VBA to set the password for it?</p>\n\n<p>I am able to extract all the file name already.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3kQCw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3kQCw.png\" alt=\"Screenshot of the file name and password\"></a></p>\n\n<p>Appreciate any suggestion. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522819387, "post_id": 49643306, "comment_id": 86294264, "body": "Do you have an URL to go with this?"}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1522864758, "post_id": 49646602, "comment_id": 86324087, "body": "Did you try the script? What&#39;s the feedback?"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1522831699, "creation_date": 1522831699, "answer_id": 49646602, "question_id": 49643306, "link": "https://stackoverflow.com/questions/49643306/vba-code-to-select-from-html-drop-down-menu/49646602#49646602", "title": "VBA code to select from HTML Drop Down menu", "body": "<p>It is always a tough job to provide any solution hypothetically. However,give it a go. It should select <code>Paper &amp; Party Supplies</code> from the dropdown option:</p>\n\n<pre><code>Sub Select_Item()\n    Dim post As Object, elem As Object\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"webpage_link\"  ''Try with your URL\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n\n        ''If the content of that page generates dynamically, make sure to put here some delay\n\n        Set post = .document.querySelector(\"select[data-field='taxonomy_id']\")\n        For Each elem In post.getElementsByTagName(\"option\")\n             If InStr(elem.Value, \"1250\") &gt; 0 Then elem.Selected = True: Exit For\n         Next elem\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9594631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2198907aeb28588be74e9e262b40e7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9594631/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522831699, "creation_date": 1522819065, "last_edit_date": 1531164843, "question_id": 49643306, "link": "https://stackoverflow.com/questions/49643306/vba-code-to-select-from-html-drop-down-menu", "title": "VBA code to select from HTML Drop Down menu", "body": "<p>I am starting out on trying my hand at writing VBA code and having issues selecting items from a drop down list.  It is a dynamic drop down box where by default, it is \"None\", once a selection is made in the first box, another box opens using the same data-field = \"taxonomy_id\", with new parameters to choose.  </p>\n\n<p>The HTML code for the drop down:</p>\n\n<pre><code>&lt;select class=\"select select-custom\" data-field=\"taxonomy_id\"&gt;\n            &lt;option value=\"\"&gt;\n                    None\n            &lt;/option&gt;\n\n                &lt;optgroup label=\"Select a category\"&gt;\n                    &lt;option value=\"1\"&gt;Accessories&lt;/option&gt;\n                    &lt;option value=\"66\"&gt;Art &amp;amp; Collectibles&lt;/option&gt;\n                    &lt;option value=\"132\"&gt;Bags &amp;amp; Purses&lt;/option&gt;\n                    &lt;option value=\"199\"&gt;Bath &amp;amp; Beauty&lt;/option&gt;\n                    &lt;option value=\"323\"&gt;Books, Movies &amp;amp; Music&lt;/option&gt;\n                    &lt;option value=\"374\"&gt;Clothing&lt;/option&gt;\n                    &lt;option value=\"562\"&gt;Craft Supplies &amp;amp; Tools&lt;/option&gt;\n                    &lt;option value=\"825\"&gt;Electronics &amp;amp; Accessories&lt;/option&gt;\n                    &lt;option value=\"891\"&gt;Home &amp;amp; Living&lt;/option&gt;\n                    &lt;option value=\"1179\"&gt;Jewelry&lt;/option&gt;\n                    &lt;option value=\"1250\" selected=\"\"&gt;Paper &amp;amp; Party Supplies&lt;/option&gt;\n                    &lt;option value=\"1351\"&gt;Pet Supplies&lt;/option&gt;\n                    &lt;option value=\"1429\"&gt;Shoes&lt;/option&gt;\n                    &lt;option value=\"1552\"&gt;Toys &amp;amp; Games&lt;/option&gt;\n                    &lt;option value=\"1633\"&gt;Weddings&lt;/option&gt;\n            &lt;/optgroup&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p>The code I have used to select \"Paper &amp; Party Supplies\" is:</p>\n\n<pre><code>IE.document.all(\"taxonomy_id\").Value = \"1250\"\n</code></pre>\n\n<p>The code I use above fails to select the item in the initial drop down box.  Any help is appreciated.</p>\n"}, {"tags": ["excel", "string", "vba", "libreoffice-calc", "text-manipulation"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522815866, "post_id": 49642320, "comment_id": 86293024, "body": "Which version of Excel?"}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522816007, "post_id": 49642320, "comment_id": 86293058, "body": "Any version.  I&#39;m currently using Libreoffice calc 5.1.1.3.  I use Excel at work, though I&#39;m not sure of the actual version."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522817830, "post_id": 49643041, "comment_id": 86293715, "body": "I&#39;ve never used LibreOffice so I have no idea whether the functionality is the same in any of these examples.  (Did you know that as a <a href=\"https://developer.microsoft.com/en-us/office\" rel=\"nofollow noreferrer\">developer</a> or a <a href=\"https://www.microsoft.com/en-ca/education/products/office/default.aspx\" rel=\"nofollow noreferrer\">student</a>, <b>you can get <i>Office 365</i> for free</b> along with other goodies?  ...not a trial; totally free from Microsoft.)"}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1522849516, "post_id": 49643041, "comment_id": 86313688, "body": "My apologies.  I am aware of these functions that can be used in formulas.  By built-in function, I meant one automated by the software similar to the Text-to-columns function is built-in."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1522878917, "post_id": 49643041, "comment_id": 86331774, "body": "What do you mean? &quot;automated by the software&quot;? maybe you should give some examples of what you have and what you need before anyone spends any more time on this."}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1533041140, "post_id": 49643041, "comment_id": 90192623, "body": "In spreadsheet software, there&#39;s the text-to-columns function built in (in the menu).  Like I specifically mentioned in the question, I&#39;m aware of methods to achieve the same result using formulas.  There are formulas I can use within the cells to achieve the &quot;text-to-columns&quot; as well, but Excel, Calc, etc. have this feature built in.  Why do they no also have built in functions to do the reverse?"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 5, "last_activity_date": 1522817583, "creation_date": 1522817583, "answer_id": 49643041, "question_id": 49642320, "link": "https://stackoverflow.com/questions/49642320/reversing-text-to-columns-in-excel-calc/49643041#49643041", "title": "Reversing Text to Columns in Excel/Calc", "body": "<p>There are built-in functions that will allow you to combine multiple cells into one with a delimiter between each.</p>\n\n<p>Let's say you want to join cells <code>A1</code> to <code>A5</code> with a <code>,</code> in between each value.</p>\n\n<hr>\n\n<h2>Excel 2016</h2>\n\n<pre><code>=TEXTJOIN(\",\",TRUE,A1:A5)\n</code></pre>\n\n<hr>\n\n<h2>Older Excel Versions</h2>\n\n<p>You can easily combine <em>without</em> a delimiter:</p>\n\n<pre><code>=CONCAT(A1:A5)\n</code></pre>\n\n<p>The equivalent to concat is the <code>&amp;</code> text operator, which you could use like:</p>\n\n<pre><code>=A1 &amp; A2 &amp; A3 &amp; A4 &amp; A5\n</code></pre>\n\n<p>...for the same result as <code>CONCAT</code>.  To add the comma delimiter:</p>\n\n<pre><code>=A1 &amp; \",\" &amp; A2 &amp; \",\" &amp; A3 &amp; \",\" &amp; A4 &amp; \",\" &amp; A5\n</code></pre>\n\n<hr>\n\n<h2>Replacement for <code>TEXTJOIN</code> function</h2>\n\n<p>Better yet, we could build our own version of <code>TEXTJOIN</code>, which I'll call <code>TXTJOIN</code>:</p>\n\n<pre><code>Function TxtJoin(delim As String, ignoreEmpty As Boolean, rg As Range) As String\n    Dim c As Range\n    For Each c In rg\n        If Not ignoreEmpty Or Not IsEmpty(c) Then TxtJoin = TxtJoin &amp; delim &amp; c\n    Next c\n    If TxtJoin &lt;&gt; \"\" Then TxtJoin = Mid(TxtJoin, Len(delim) + 1)\nEnd Function\n</code></pre>\n\n<p>The first parameter <code>delim</code> is the delimiter to place between each value, and can be one or more characters, or even special characters like <code>CHAR(10)</code> for a Line Feed (which would display in cells that have <em>Word Wrap</em> enabled.)</p>\n\n<p>The second parameter <code>ignoreEmpty</code> can be FALSE if you want blank cells included in the results, with a delimiter between each one, or TRUE to skip blank cells. (Obviously if the specified range has no blank cells then it doesn't matter what option you choose.)</p>\n\n<p>The third parameter is a range of cells.  If there's more than one row or column specified, the formula will read right-to-left then top-to-bottom.</p>\n\n<p>With our example, you'd use it like:</p>\n\n<pre><code>=TxtJoin(\",\",TRUE,A1:A5)\n</code></pre>\n\n<p>(This is the same usage as for Excel 2016's <code>TEXTJOIN</code> function.)</p>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522879367, "post_id": 49659595, "comment_id": 86331990, "body": "I don&#39;t know - I&#39;m also having some trouble with Excel&#39;s functions not being automated as much as I&#39;d like...  I keep running <code>CLEAN()</code> and <code>FIXED()</code>, over and over, but <i>still</i> nothing&#39;s getting done around the house.  I&#39;m not having much more luck with <code>DOLLARS()</code> either. This is false advertising."}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1533041241, "post_id": 49659595, "comment_id": 90192692, "body": "Jim, spreadsheet functions work perfectly well to perform &quot;text-to-columns&quot; too, but that functionality is built in, why not in reverse as well?"}], "tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1522872635, "creation_date": 1522872635, "answer_id": 49659595, "question_id": 49642320, "link": "https://stackoverflow.com/questions/49642320/reversing-text-to-columns-in-excel-calc/49659595#49659595", "title": "Reversing Text to Columns in Excel/Calc", "body": "<p>This works in LibreOffice 5.4.3.2.  If it does not work in your version, you may want to download and install a newer version.</p>\n\n<pre><code>=TEXTJOIN(\",\";;A1:A5)\n</code></pre>\n\n<blockquote>\n  <p>By built-in function, I meant one automated by the software similar to the Text-to-columns function is built-in.</p>\n</blockquote>\n\n<p>I do not see such a feature.  It is not needed because spreadsheet functions work perfectly well.</p>\n"}], "owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15509, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1530822928, "creation_date": 1522812725, "last_edit_date": 1530822928, "question_id": 49642320, "link": "https://stackoverflow.com/questions/49642320/reversing-text-to-columns-in-excel-calc", "title": "Reversing Text to Columns in Excel/Calc", "body": "<p>Most spreadsheet software I've used has a <strong>text-to-columns</strong> function that splits a single column into multiple columns using several criteria (delimiter, # of character, etc).  I want to do this <strong>in reverse</strong>.</p>\n\n<p>I know I can use a formula to create a third column with the values of the two cells concatenated together with a delimiter between them but this seems clunky.</p>\n\n<p>Why is this not a built in function?  Or is it there somewhere that I can't see?</p>\n"}, {"tags": ["vba", "excel", "events", "onchange"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 3, "creation_date": 1522809626, "post_id": 49641815, "comment_id": 86291392, "body": "<code>not firing the Worksheet_Change</code> could be security settings, for the color try using Excel RGB color example <code>.Color = RGB(0, 0, 0)</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1522810189, "post_id": 49641815, "comment_id": 86291535, "body": "^ For firing events try running this line <code>Application.EnableEvents = True</code>, for the white bar place a break point on line <code>If Range(&quot;L3&quot;).Value &gt; Range(&quot;I3&quot;).Value</code> and check the values for both cells (and time format)"}, {"owner": {"reputation": 81, "user_id": 9581076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6474e07f625acd825d36999da8389634?s=128&d=identicon&r=PG&f=1", "display_name": "NWTech", "link": "https://stackoverflow.com/users/9581076/nwtech"}, "edited": false, "score": 0, "creation_date": 1522810713, "post_id": 49641815, "comment_id": 86291656, "body": "Paul do I put that line in before the first event."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1522811693, "post_id": 49641815, "comment_id": 86291899, "body": "Create a separate Sub like this: <code>Sub ee(): Application.EnableEvents = True: End Sub</code>, then press F5"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1522811764, "post_id": 49641815, "comment_id": 86291922, "body": "@paulbica The only way Events wouldn&#39;t be enabled is if he disabled them, or am I missing something?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522811876, "post_id": 49641815, "comment_id": 86291957, "body": "@ashleedawg: another reason for them to be disabled is if other code that disables them runs, gets an error and doesn&#39;t get to the point where they get enabled again (or the code doesn&#39;t enable them back)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1522812446, "post_id": 49641815, "comment_id": 86292094, "body": "@pica - again, he would have had to disable Events at some point in his code; I don&#39;t understand what leads you to believe he did that?  i don&#39;t mean to argue - just curious what lead to that &quot;hunch&quot;.   Also - a quick way to confirm is <code>[CTRL]+[G]</code> then <code>?Application.EnableEvents</code> and <code>[Enter]</code>."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522813123, "post_id": 49641815, "comment_id": 86292258, "body": "@ashleedawg That comment was meant for NWTech sorry. I&#39;ve just deleted it and reposted below."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522813691, "post_id": 49641815, "comment_id": 86292394, "body": "@ashleedawg - no problem. I&#39;m thinking that the code on the other computer might be created by someone else (or other utilities installed by the other user)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1522814969, "post_id": 49641815, "comment_id": 86292761, "body": "@paulbica well we&#39;ll find out who&#39;s right when (if?) he returns...  (Not that it&#39;s a competition!)  :)  I&#39;m betting the users were opening the file directly from email and quickly clicking past the macros-disabled warning..."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522829946, "post_id": 49641815, "comment_id": 86300089, "body": "@ashleedawg: I&#39;ve had that issue before.  In the end, I added a worksheet with big red text that said &quot;REOPEN THE WORKBOOK AND ENABLE MACROS&quot;, and use <code>Workbook_Open</code> and <code>Workbook_BeforeSave</code> to ensure that if you had Macros enabled then the sheet was <code>xlVeryHidden</code>, but if you had Macros <i>dis</i>abled then it was the only sheet that <b>wasn&#39;t</b> <code>xlVeryHidden</code>.  (<i>&quot;U5312 error: Faulty component exists between keyboard and chair.&quot;</i>)"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1573574957, "post_id": 49641815, "comment_id": 103921884, "body": "I wonder if  the code is in the worksheet module.The statement of the code being at the top of the code is why I&#39;m asking."}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 2, "creation_date": 1549645300, "post_id": 49642406, "comment_id": 95990334, "body": "To quickly test the EnableEvents portion, you can type Application.EnableEvents = True in the immediate window, hit enter, then try again."}, {"owner": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1600048923, "post_id": 49642406, "comment_id": 112955680, "body": "Application.EnableEvents was the killer for me! +1"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 5, "last_activity_date": 1522814202, "last_edit_date": 1522814202, "creation_date": 1522813508, "answer_id": 49642406, "question_id": 49641815, "link": "https://stackoverflow.com/questions/49641815/worksheet-change-event-not-firing/49642406#49642406", "title": "Worksheet_Change Event not firing", "body": "<p>There could be a number of factors causing this problem. One way to diagnose is to troubleshoot like this:</p>\n\n<p>At the beginning of your procedure, right after this line:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n</code></pre>\n\n<p>...add a <em>temporary</em> line:</p>\n\n<pre><code>MsgBox \"Changed: \" &amp; Target.Address\n</code></pre>\n\n<p>...then go change something in your worksheet (whatever change isn't firing the event as you'd expect).</p>\n\n<p><strong>One of two things will happen</strong>:</p>\n\n<ol>\n<li><p>You'll have a message box pop up, showing the cell reference of whatever was just changed.<br>\nThis demonstrates that the event is firing properly, so the issue must be in your code that follows.  </p></li>\n<li><p>Or, you won't get a message box pop up.  This indicates the event is <strong>not</strong> firing, which could be caused by a few possibilities:   </p>\n\n<ul>\n<li><p>Are macros completely disabled in the workbook?  This is often done automatically on workbooks received from outside sources.  Save the workbook to a trusted location on the local computer or network (rather than opening from the email).  Do other sections of code run properly?  When you close/re-open the file, are you given a warning about Macro Security?  Also, try rebooting the computer.</p></li>\n<li><p>Other security settings could be an issue.  Have you ever run VBA on these machines?  You can confirm sure code is able to run in Excels' security settings in:<br>\n<kbd>File</kbd>\u2192<kbd>Options</kbd>\u2192<kbd>Trust Center</kbd>\u2192<kbd>Trust Center Settings</kbd>\u2192<kbd>Macro Settings</kbd>  </p>\n\n<p>As well as making sure macros are enabled there, you could also check <kbd>Trusted Locations</kbd> in the Trust Center, and either save your document in a listed location, or add a new location.  Security settings will be \"reduced\" for documents saved in those locations.  </p></li>\n<li><p>Is <code>EnableEvents</code> being intentionally disabled elsewhere in your code?  If you wrote all the code, you should know whether you set <code>EnableEvents = False</code> at some point. Perhaps it was intentional, but it's not being re-enabled.</p></li>\n</ul></li>\n</ol>\n\n<p>Remember to remove the line you added temporarily, or that MsgBox will quickly get annoying by popping up every time a change is made.  :)</p>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522813800, "post_id": 49642441, "comment_id": 86292422, "body": "...but it was working for him at home.  (also I deleted my other comment, I thought you were referring to be telling him to enable events inside the event) :)"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522813908, "post_id": 49642441, "comment_id": 86292445, "body": "I&#39;m thinking (guessing) he might have moved the location of the code in between work and home pcs."}, {"owner": {"reputation": 81, "user_id": 9581076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6474e07f625acd825d36999da8389634?s=128&d=identicon&r=PG&f=1", "display_name": "NWTech", "link": "https://stackoverflow.com/users/9581076/nwtech"}, "edited": false, "score": 0, "creation_date": 1522895116, "post_id": 49642441, "comment_id": 86336330, "body": "My thanks to all the comments and suggestions.  We were able to find the problem.  My associate at work was trying to run the file from outlook.  When he actually saved the file to the computer and ran it in that manner, everything worked as planned."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522895196, "post_id": 49642441, "comment_id": 86336345, "body": "Cool. Can you add this as an answer and not a comment, so that other folk know that the issue is resolved without having to read through all the comments? Cheers."}, {"owner": {"reputation": 81, "user_id": 9581076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6474e07f625acd825d36999da8389634?s=128&d=identicon&r=PG&f=1", "display_name": "NWTech", "link": "https://stackoverflow.com/users/9581076/nwtech"}, "edited": false, "score": 0, "creation_date": 1522895368, "post_id": 49642441, "comment_id": 86336375, "body": "Also, Jeff, your suggestion is what I intended.  The reason that it is coded this way is because of the way that it is set up.  I was as specific as I was to ensure that we only capture specific information changes.  However I will say that all things being equal, I am learning as I go.  Input Ranges seem to be a bit difficult for me as they cover a large range, but I have learned that I can list specific cells for the code to fire on and that works, its handling the rest of the if statement that I seem to be having difficulty with."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522895523, "post_id": 49642441, "comment_id": 86336415, "body": "Cool. You definitely don&#39;t want to get into the habit of using &quot;naked&quot; cell addresses in your VBA. Excel Tables are good for this reason, as they are named ranges that Excel maintains automatically. And often I will add a named range to a table column, and reference that named range instead of the table column, just in case someone later changes that table column name."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 2, "last_activity_date": 1522813701, "creation_date": 1522813701, "answer_id": 49642441, "question_id": 49641815, "link": "https://stackoverflow.com/questions/49641815/worksheet-change-event-not-firing/49642441#49642441", "title": "Worksheet_Change Event not firing", "body": "<p>You say \"the change event is at the top of the code\". A worksheet change event will only fire if you put the code in the sheet module concerned. If you've put the code concerned in a non sheet module (e.g. \"Module 1\" or similar, listed under the \"Modules\" branch in the object explorer) then that's the problem. </p>\n\n<p>Also, you really shouldn't hard-code cell references like \"L3\" in your VBA code, because every hard reference will require amending should you (or a user) later insert rows/columns above/to the left of these references. Instead, assign meaningful named ranges to these cells back in Excel, and use those in your VBA.</p>\n\n<p>Also, when using event handlers like you're doing, you should have something like <code>If not intersect(Target, InputRange) is nothing then...</code> so that the code only runs if something of interest changes.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12361293, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/40ae79b4915b99046c07b6382c92c1a6?s=128&d=identicon&r=PG", "display_name": "RafalSroka", "link": "https://stackoverflow.com/users/12361293/rafalsroka"}, "is_accepted": false, "score": 1, "last_activity_date": 1573565678, "creation_date": 1573565678, "answer_id": 58819902, "question_id": 49641815, "link": "https://stackoverflow.com/questions/49641815/worksheet-change-event-not-firing/58819902#58819902", "title": "Worksheet_Change Event not firing", "body": "<p>I had the same problem.\nI checked everything.\nEverything seemed to be proper (enabled macros, EnableEvents=True, etc).\nI closed and opened Excel. \nProblem persisted.\nThere was nothing I could do.\nI restarted Windows. \nProblem disappeared. \nRestart took 7 minutes (with all applications closing &amp; restarting), trying to find the cause would take much more. Maybe I could have tried to find &amp; kill every Excel process in Task Manager.\nI don't like giving people the advice \"try rebooting\", but well, Windows is Windows. </p>\n"}, {"tags": [], "owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "is_accepted": false, "score": 0, "last_activity_date": 1595263350, "creation_date": 1595263350, "answer_id": 63000053, "question_id": 49641815, "link": "https://stackoverflow.com/questions/49641815/worksheet-change-event-not-firing/63000053#63000053", "title": "Worksheet_Change Event not firing", "body": "<p>I had a different problem.  I had saved my worksheet under a new name and then added the code for the event.  To get it to work, I had to close the worksheet and reopen it.  It then showed the button to enable macros and the code started to work.  Hope this helps someone.</p>\n<p>Wade</p>\n"}], "owner": {"reputation": 81, "user_id": 9581076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6474e07f625acd825d36999da8389634?s=128&d=identicon&r=PG&f=1", "display_name": "NWTech", "link": "https://stackoverflow.com/users/9581076/nwtech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19135, "favorite_count": 1, "answer_count": 4, "score": 6, "last_activity_date": 1595263350, "creation_date": 1522808860, "last_edit_date": 1522811613, "question_id": 49641815, "link": "https://stackoverflow.com/questions/49641815/worksheet-change-event-not-firing", "title": "Worksheet_Change Event not firing", "body": "<p>My Excel project functions properly at home (with <strong>Excel 2010</strong>), but not on two work computers (with <strong>Excel 2016</strong>) and I suspect the <code>Worksheet_Change</code> event is the problem.</p>\n\n<p>When the user makes changes, the yellow bar (in the screenshot) should turn white again, but it is not.  I am getting 2 different responses on 2 work computers.</p>\n\n<p>Two things to point out in the code:</p>\n\n<ol>\n<li><p>In some places I use <code>vbColor</code> extensions, in others I had to use a numerical code.</p></li>\n<li><p>One computer is not firing the <code>Worksheet_Change</code> event at all.  I would note that the change event is at the top of the code, although that shouldn't have anything to do with it.</p></li>\n</ol>\n\n<p>I'd appreciate advice and detailed explanations, to help me learn.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IJSPg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IJSPg.png\" alt=\"screenshot\"></a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) 'Check for On-Time and Delays then change the Command Button Colors to show completed.  \n\n'Return headers to white after jump to\nRange(\"B3:I3,O3:V3,B28:I28,O28:V28,B53:I53,O53:V53,B78:I78,O78:V78,B103:I103,O103:V103,B128:I128,O128:V128,B153:I153,O153:V153\").Interior.Color = vbWhite\n'Check for On Time and Delayed Trips\n'Trip 1 Scan Ready\nIf IsEmpty(Range(\"L3\").Value) = False Then\n    If Range(\"L3\").Value &gt; Range(\"I3\").Value Then 'If actual is greater than Departure\n        'If Delayed check for a delay code\n        If IsEmpty(Range(\"L24\").Value) Then 'If Delay code is missing\n            Range(\"K24:L25\").Interior.Color = 16711935\n            CommandButton1.BackColor = 16711935\n            CommandButton1.ForeColor = vbBlack\n        Else 'If Delay Code is present check for delay time\n            If IsEmpty(Range(\"L25\").Value) Then\n                Range(\"K24:L25\").Interior.Color.Index = 16711935\n                CommandButton1.BackColor = 16711935\n                CommandButton1.ForeColor = vbBlack\n            Else\n                CommandButton1.BackColor = vbRed\n                CommandButton1.ForeColor = vbWhite\n                Range(\"K24:L25\").Interior.Color = vbWhite\n            End If\n        End If\n    Else\n        'Flight was on Time\n        CommandButton1.BackColor = 32768 '32768 = Green\n        CommandButton1.ForeColor = vbWhite\n        Range(\"K24:L25\").Interior.Color = vbWhite\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1522804830, "post_id": 49641248, "comment_id": 86290222, "body": "What do you expect to happen when <code>cust</code> is set to cells C1 ... C6?"}, {"owner": {"reputation": 215, "user_id": 3839044, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd6ba387ddd920ec45ff1cfba90ed028?s=128&d=identicon&r=PG&f=1", "display_name": "user3839044", "link": "https://stackoverflow.com/users/3839044/user3839044"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1522804957, "post_id": 49641248, "comment_id": 86290248, "body": "Thanks, had a brainfreeze. Modified the range and that worked."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 7, "creation_date": 1522804990, "post_id": 49641248, "comment_id": 86290256, "body": "And once you fix that, the For loop will loop over 1000000+ rows = very slow and not necessary"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522808817, "post_id": 49641248, "comment_id": 86291169, "body": "@user3839044 further to Chris&#39;s comment, you can check how many loops you&#39;ll be running by adding a line just before your <code>For</code> statement: <code>MsgBox Srchcust.Cells.Count</code> and then run your code like normal.  It will probably tell you that loop is about to run <a href=\"https://support.office.com/en-us/article/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\" rel=\"nofollow noreferrer\">1,048,576 times</a>."}, {"owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "edited": false, "score": 1, "creation_date": 1522819520, "post_id": 49641248, "comment_id": 86294316, "body": "I see you found a solution - please post one so future googlers and stack explorers can orient themselves better"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1522822376, "post_id": 49641248, "comment_id": 86295535, "body": "You can reduce loop count by <code>Set Srchcust = Intersect(ActiveSheet.UsedRange,Range(&quot;C:C&quot;))</code>. Please replace <code>ActiveSheet</code> with your Worksheet."}, {"owner": {"reputation": 215, "user_id": 3839044, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd6ba387ddd920ec45ff1cfba90ed028?s=128&d=identicon&r=PG&f=1", "display_name": "user3839044", "link": "https://stackoverflow.com/users/3839044/user3839044"}, "edited": false, "score": 0, "creation_date": 1522886995, "post_id": 49641248, "comment_id": 86334468, "body": "Yes, I did figure out the solution after  chris neilsen&#39;s and ashleedawg&#39;s comments and I did also modify the range to prevent too many loops - in fact my code is very similar to the one below. Looks like the solution has been posted below as well, so that works out. Thank you all!"}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 3839044, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd6ba387ddd920ec45ff1cfba90ed028?s=128&d=identicon&r=PG&f=1", "display_name": "user3839044", "link": "https://stackoverflow.com/users/3839044/user3839044"}, "edited": false, "score": 0, "creation_date": 1522887070, "post_id": 49644334, "comment_id": 86334489, "body": "Thank you, I did actually figure out already thanks to the comments above and my code is very similar to yours as well, so thank you for posting the answer."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1522823837, "creation_date": 1522823837, "answer_id": 49644334, "question_id": 49641248, "link": "https://stackoverflow.com/questions/49641248/error-with-a-negative-offset/49644334#49644334", "title": "Error with a negative offset", "body": "<p>There is few issues with your code.</p>\n\n<p>First, the error - it happens, when you try reference a cell, that doesn't exist. You can address cells in worksheet with pair of <strong>positive</strong> integers, like <code>Cells(1, 1)</code> (<code>A1</code> cell), <code>Cells(3, 4)</code> (<code>D3</code> cell), etc.</p>\n\n<p>When you use offset, it's like you are subtracting particular coordinates. When you try to offset by pair <code>-1, -1</code> from cell B2 (<code>Cells(2, 2)</code>) you'll get <code>A</code> cell (<code>Cells(1, 1)</code>) due to <code>2-1=1</code>. When you try to do offset by <code>-6, 4</code> and loop throguh <code>C</code> column, what happens in cells from C1 through C6? Then, for example, one of the coordinates would be <code>1-6=-5</code>, which cannot be, thus the error.</p>\n\n<p>Another issue, you loop through whole <code>C</code> column! It's not necessary and inefficient! You should find last row of that column with this code:</p>\n\n<pre><code>Dim lastRow As Long\nlastRow = Cells(Rows.Count, 3).End(xlUp).Row\n</code></pre>\n\n<p>Then limit your range by defining it like:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range(\"C1:C\" &amp; lastRow)\n'or you should do like this, it won't give you error\n'Set rng = Range(\"C7:C\" &amp; lastRow)\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 3839044, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd6ba387ddd920ec45ff1cfba90ed028?s=128&d=identicon&r=PG&f=1", "display_name": "user3839044", "link": "https://stackoverflow.com/users/3839044/user3839044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2331, "favorite_count": 0, "accepted_answer_id": 49644334, "answer_count": 1, "score": -1, "last_activity_date": 1569593738, "creation_date": 1522804506, "last_edit_date": 1522808920, "question_id": 49641248, "link": "https://stackoverflow.com/questions/49641248/error-with-a-negative-offset", "title": "Error with a negative offset", "body": "<p>I'm trying to use the following code to find a value that is not a date and not an empty cell, and copy that value to 6 rows up and 4 rows right to the originally located value with an offset.</p>\n\n<p>Here is my code:</p>\n\n<pre><code> Sub copy_value()\n Dim Srchcust As Range, cust As Range\n Set Srchcust = Range(\"C:C\")\n For Each cust In Srchcust\n     If Not IsEmpty(cust) And Not IsDate(cust) Then\n         cust.Offset(-6, 4).Value = cust.Value\n     End If\n Next cust\n End Sub\n</code></pre>\n\n<p>For some reason, if the offset is set to a negative number, it gives me an error 1004, but as soon as I change -6 to 0, it works, but I need the value to be copied 6 rows above the value's current location.</p>\n\n<p>I would appreciate anyone's help you can let me know what I'm doing wrong here. </p>\n"}, {"tags": ["vba", "excel", "sas"], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1522861174, "post_id": 49642924, "comment_id": 86322114, "body": "I had similar issue.. Couldn&#39;t find any solution. Changing the port didn&#39;t work. And changing the Set statement with &quot;Nothing&quot; as variable as well causes Automation Error"}, {"owner": {"reputation": 19, "user_id": 9593941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sri Rama", "link": "https://stackoverflow.com/users/9593941/sri-rama"}, "edited": false, "score": 0, "creation_date": 1522863410, "post_id": 49642924, "comment_id": 86323289, "body": "I agree.. Tried the solution you gave @QHarr but it&#39;s not working. Throwing &quot;Automation Error&quot; with same error number"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522863465, "post_id": 49642924, "comment_id": 86323319, "body": "I\u2019ll give it another go later or tomorrow"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1522816861, "creation_date": 1522816861, "answer_id": 49642924, "question_id": 49640876, "link": "https://stackoverflow.com/questions/49640876/execute-excel-vba-macro-using-sas/49642924#49642924", "title": "Execute Excel VBA Macro using SAS", "body": "<p>Error says you are connecting to the metadata server and not the workspaceserver.</p>\n\n<p>According to <a href=\"https://communities.sas.com/t5/SAS-Enterprise-Guide/Calling-SAS-through-VBA/td-p/79673?nobounce\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<p>1) The workspaceservers default port is 8591.</p>\n\n<p>2) The workspaceserver may also run on a different machine. Connect to your profile, go to the serverlist, locate the server you want to connect to and right click the context menu \"properties\" to see the right connection profile for your workspaceserver.</p>\n\n<p>Suggested connection details:</p>\n\n<p>obServer.MachineDNSName = \"XXXXXXX\"</p>\n\n<p>obServer.Protocol = SASObjectManager.Protocols.ProtocolBridge</p>\n\n<p>obServer.Port = 8591</p>\n\n<p>Set obSAS = obObjectFactory.CreateObjectByServer(\"sas\", True, obServer, Nothing, Nothing)</p>\n\n<p>Unsure whether difference between using <code>SASApp</code> v <code>sas</code> so suggest you try with the first and if that fails then try with the second.</p>\n"}], "owner": {"reputation": 19, "user_id": 9593941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sri Rama", "link": "https://stackoverflow.com/users/9593941/sri-rama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522816861, "creation_date": 1522801134, "question_id": 49640876, "link": "https://stackoverflow.com/questions/49640876/execute-excel-vba-macro-using-sas", "title": "Execute Excel VBA Macro using SAS", "body": "<p>I have SAS EG version 7.1 and Office 2013 Installed on my system. I am trying to run my SAS projects by calling them from VBA. As a first step, I tried to call a simple PROC step using the below code I found online:</p>\n\n<pre><code>Sub createTable()\n    Dim obObjectFactory As New SASObjectManager.ObjectFactory\n\n    Dim obObjectKeeper As New SASObjectManager.ObjectKeeper\n\n    Dim obServer As New SASObjectManager.ServerDef\n\n    Dim obSAS as SAS.workspace\n\n    Dim query as String\n    query = \"PROC SQL; CREATE TABLE ME.TABLE1; RUN;\"\n\n    obServer.MachineDNSName = \"XXXXXXXXX\"\n    obServer.Protocol = ProtocolBridge\n    obServer.Port = 8561\n    obObjectFactory.LogEnabled = True\n\n    Set obSAS = obObjectFactory.CreateObjectByServer(\"SASApp\", True, obServer, \"\", \"\")\n\n    obSAS.LanguageService.Submit query\n\nEnd Sub\n</code></pre>\n\n<p>But I'm getting the Runtime error '-2147213310 at below line:</p>\n\n<pre><code>Set obSAS = obObjectFactory.CreateObjectByServer(\"SASApp\", True, obServer, \"\", \"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dMXev.jpg\" rel=\"nofollow noreferrer\">Runtime error '-2147213310</a>\nCan anyone please help me to move forward this error? Also, any guidance to run the SAS projects is greatly appreciated. I am new to both VBA and SAS.</p>\n"}, {"tags": ["excel", "oledbconnection", "oledbcommand", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522803703, "post_id": 49640808, "comment_id": 86289988, "body": "Could you give an example of your connection-related code so your question is more clear?  (There are a number of ways connections can be made.)"}, {"owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522804812, "post_id": 49640808, "comment_id": 86290219, "body": "ashleedawg, I don&#39;t have any code per-se, it&#39;s just a Connections in the &quot;Queries &amp; Connections&quot; area.  Each one has a connection string at the top and a bit of SQL in Command.  They each refer to a named-range of cells.  I didn&#39;t build this, it&#39;s inherited and I&#39;m trying to simplify the upkeep."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522806767, "post_id": 49640808, "comment_id": 86290667, "body": "fair enough...  I&#39;ll put some information in an answer in a minute"}], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522811343, "post_id": 49641570, "comment_id": 86291796, "body": "I really appreciate the help, but honestly I looked at every one of those links and they all <i>inextricably</i> tie a view or table to a connection.  What I need is <i>just</i> a connection.  I&#39;m frustrated with Microsoft because it just shouldn&#39;t be this difficult.  This is SQL-server btw.  The connection is a sql-auth user, not Trusted Connection."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522811880, "post_id": 49641570, "comment_id": 86291959, "body": "You want to be able to use an existing connection for other queries in Excel, correct?  Or, are you talking about using the MySQL ODBC Data Source connection in other applications and other workbooks?"}, {"owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522812935, "post_id": 49641570, "comment_id": 86292210, "body": "It&#39;s SQL-Server, not Mysql,  But all of this is in the same workbook.  There&#39;s dozens of ranges/tables in one giant sheet.  Each of them has a Connection defined.  Due to increasing security concerns, the pwd needs to change every month.  I was light in my original estimate--there&#39;s over 200 connections.  Changing them manually is beyond the pale.  The end-state I&#39;d like is to go to the Excel &quot;Existing Connections&quot; menu item, and choose one connection, and change the pwd there.  Then I would like all 200 queries--each a different view/table/sql-statement, simply refer to that single connection"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522814258, "post_id": 49641570, "comment_id": 86292552, "body": "Sorry I meant SQL Server (but it&#39;s the same anyway)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522814444, "post_id": 49641570, "comment_id": 86292602, "body": "It&#39;s tough to picture how these connections are setup without seeing...  but it sounds like you&#39;re not using an ODBC DSN  (Data Source) to the server, but you should be.  That would be the place where you enter the server information and password <b>once</b> and everything (Excel <i>and</i> other applications) all connect through there.  You would set that up by pressing the Windows key and typing <code>ODBC</code> and adding a new system connection (or it might even be setup there already)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522814694, "post_id": 49641570, "comment_id": 86292673, "body": "...once the ODBC <b>System</b> DSN is setup (with password, and tests properly with the &quot;Test Connection&quot; button), you can add the connection to an Excel document by clicking <code>Existing Connections</code> on the <code>Data</code> tab, and the connection should be listed as a data source.  Then you&#39;d change all of you queries etc to the new data source.  If there are tons, there may be a quick way to do it.  Once it&#39;s changed, you&#39;ll only have to set the password in one place monthly."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522814859, "post_id": 49641570, "comment_id": 86292728, "body": "Incidentally, specifying the password multiple times in multiple workbooks is indeed <i>very</i>insecure since the worksheet can easily be emailed somewhere (has it been?!), and it has the connection information including password attached to it.  That&#39;s exactly what monthly-password-changes are implemented to prevent."}, {"owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522815152, "post_id": 49641570, "comment_id": 86292814, "body": "Thank you, I think this is getting close...So the connection type is Oledb query.  I&#39;m thinking it should be ODBC.  I will look into changing them--if I have to change them all once that&#39;s no big deal, as long as all 200 or so &quot;Connections/Commands&quot; point to the single DSN.  And no--this is never emailed...I really wish Excel could encrypt it.  I&#39;m used to doing web apps or Winforms apps and I&#39;d always have a single connection string in the .config file, always encrypted.  So that&#39;s where my head was at when this was dropped on my desk.  I&#39;ll know more in the morning, thanks!!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522815229, "post_id": 49641570, "comment_id": 86292838, "body": "Alternatively you can setup and ODBC <b>File DSN</b> (instead of System) if you&#39;d prefer.  As for Excel encrypting, <b><i>Nope!</i></b> MS Office is <b>not</b> secure. Don&#39;t even trust the password protection, I can get into any password-protected Office document in under 3 minutes (<a href=\"https://stackoverflow.com/a/48722078/8112776\">and now you can too!</a>)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "edited": false, "score": 0, "creation_date": 1522815666, "post_id": 49641570, "comment_id": 86292964, "body": "Here are various sets of instructions on <a href=\"https://www.google.ca/search?q=create+odbc+file+dsn+sql+server\" rel=\"nofollow noreferrer\">setting up an ODBC File DSN to SQL Server</a>. You <i>may</i> need to download a driver but it&#39;s often installed already. 80% of the time the process is a breeze. (It took me weeks to get a connection to a personal web server/SQL Server to work properly because of 32bt/64bit issues.) Here&#39;s more about <a href=\"https://support.office.com/en-us/article/create-edit-and-manage-connections-to-external-data-89d44137-f18d-49cf-953d-d22a2eea2d46\" rel=\"nofollow noreferrer\">changing your connections</a> (for after it&#39;s setup)... <b>Good Luck!</b>"}, {"owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522819120, "post_id": 49641570, "comment_id": 86294170, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168169/discussion-between-jimo3-and-ashleedawg\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1522807056, "creation_date": 1522807056, "answer_id": 49641570, "question_id": 49640808, "link": "https://stackoverflow.com/questions/49640808/share-a-database-connection-for-multiple-queries-in-excel/49641570#49641570", "title": "Share a database connection for multiple queries in Excel?", "body": "<p>The short answer is <strong>Yes</strong> - you can re-use connections from Excel's <em>Queries &amp; Connections</em> window, and are encouraged to do so for the same reasons you mentioned, and more.</p>\n\n<p>How to do it in your individual case depends on a number of factors that aren't included in your question such as <strong><em>where</strong> the data is coming from</em> and <strong><em>what</strong> it's being used for</em>.</p>\n\n<p>Hopefully some of these resources will help shed some light...</p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>Super User : <a href=\"https://superuser.com/q/601224/774713\"><strong>\"Reuse SQL View in different sheets in SQL with different subqueries\"</strong></a></p></li>\n<li><p>MS TechNet : <a href=\"https://social.technet.microsoft.com/Forums/en-US/fa451be3-00ba-4557-94b4-cf7b4c8e6360/how-can-i-reuse-power-queries?forum=powerquery\" rel=\"nofollow noreferrer\"><strong>\"How can I re-use Power Queries?\"</strong></a></p></li>\n<li><p>WiseOwl : <a href=\"https://www.wiseowl.co.uk/blog/s2562/reuse-power-query.htm\" rel=\"nofollow noreferrer\"><strong>How to reuse a query created in Query Editor or Power Query</strong></a> </p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/overview-of-connecting-importing-data-86551057-0ef4-4104-a6ca-fa619aea904c\" rel=\"nofollow noreferrer\"><strong>Overview of connecting (importing) data</strong></a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/connection-properties-9d3599a9-e9b3-461d-99b2-c5505ddae6e0\" rel=\"nofollow noreferrer\"><strong>Connection properties</strong> (Excel)</a></p></li>\n</ul>\n"}], "owner": {"reputation": 328, "user_id": 2102817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/038c806900348374ca9db642d675b3b2?s=128&d=identicon&r=PG", "display_name": "jimo3", "link": "https://stackoverflow.com/users/2102817/jimo3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3697, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1522807056, "creation_date": 1522800487, "last_edit_date": 1531161705, "question_id": 49640808, "link": "https://stackoverflow.com/questions/49640808/share-a-database-connection-for-multiple-queries-in-excel", "title": "Share a database connection for multiple queries in Excel?", "body": "<p>I have a workbook (Excel 2016) with a few dozen \"Connections\" defined.  Each connection has different \"Command Text\" but the exact same Connection String.  Because this connection string will be changing often (monthly password changes or the occasional database move), I would like to share a <em>single</em> connection-string amongst many different Commands.  </p>\n\n<p>I saw a Microsoft article that said I could \"Export Connection\" as an .odc file, which I did--but I'm not used to Excel--where I come from \"Connection\" is one thing, \"Command\" is another--and this .odc file contains both.  So when I set all of my Connections to use the single .odc \"Connection\" file, all of my \"Commands\" were identical, so that was a disaster.</p>\n\n<p>I have to trust that there really is a way to share a single connection among many different commands that all come from the exact same database.  (edit)--I really don't want a Macro or more code to plop in a connection string--I'm hoping for something very similar to the \"Connection File\" concept--but one that really is a \"Connection\" only.\nThanks </p>\n"}, {"tags": ["ms-access", "vba", "recordset", "ms-access-2003"], "answers": [{"comments": [{"owner": {"reputation": 3702, "user_id": 1039753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b31d2582e730251114a5374a29a64dc5?s=128&d=identicon&r=PG", "display_name": "Arvo Bowen", "link": "https://stackoverflow.com/users/1039753/arvo-bowen"}, "edited": false, "score": 0, "creation_date": 1522893965, "post_id": 49643766, "comment_id": 86336072, "body": "Thanks!  I ended up doing that and it works great.  Any idea how to change the color of just one row?  When I try to change the <code>BackColor</code> of the same object &quot;Errors&quot; textbox it changes all the textboxes in that column."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3702, "user_id": 1039753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b31d2582e730251114a5374a29a64dc5?s=128&d=identicon&r=PG", "display_name": "Arvo Bowen", "link": "https://stackoverflow.com/users/1039753/arvo-bowen"}, "edited": false, "score": 0, "creation_date": 1522908993, "post_id": 49643766, "comment_id": 86340424, "body": "Yes, that how it works. You could try <i>Format Conditions</i>. If you can define some criteria for colour or no colour, it will do."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1522821337, "creation_date": 1522821337, "answer_id": 49643766, "question_id": 49640740, "link": "https://stackoverflow.com/questions/49640740/change-value-of-single-textbox-in-a-recordset/49643766#49643766", "title": "Change value of single textbox in a recordset", "body": "<p>To edit and save individual records, the textbox must be bound to a field of the table. </p>\n\n<p>So, add a field of Short Text to the table to hold your error message.</p>\n"}], "owner": {"reputation": 3702, "user_id": 1039753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b31d2582e730251114a5374a29a64dc5?s=128&d=identicon&r=PG", "display_name": "Arvo Bowen", "link": "https://stackoverflow.com/users/1039753/arvo-bowen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 49643766, "answer_count": 1, "score": 0, "last_activity_date": 1594636186, "creation_date": 1522799970, "last_edit_date": 1594636186, "question_id": 49640740, "link": "https://stackoverflow.com/questions/49640740/change-value-of-single-textbox-in-a-recordset", "title": "Change value of single textbox in a recordset", "body": "<p>First off I apologize for not knowing a lot about Microsoft Access forms.  I have had very little involvement with them and this is only to support a legacy product that will soon be replaced.</p>\n\n<p>I have a Microsoft Access form that has a detail section such as the image below (shown in <code>Design View</code>).\n<a href=\"https://i.stack.imgur.com/TzjV7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TzjV7.png\" alt=\"enter image description here\"></a></p>\n\n<p>I believe the first 6 textboxes are bound to a data set, the last one is bound to nothing (I added it for what I'm trying to do).  When I view the form in <code>Form View</code> I see many results (which come from the bound table).  The only textbox that does not have info in it is the last one to the right (Unbound).</p>\n\n<p>My goal is to just simply change the value and back color of the following textbox in red.\n<a href=\"https://i.stack.imgur.com/Xhkhg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xhkhg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to edit the contents (change \"jk\" to \"Error\") and I want to change the background of that one textbox to RED (vbRed).  The problem is when I try to change the backcolor it changes all the textboxes called \"Errors\" (that entire column).</p>\n\n<pre><code>ErrorHandler:\nForms![MyForm1]![Errors].BackColor = vbRed\n</code></pre>\n\n<p>If I want to get the value of the currently selected cell I can just do the following and it works fine...</p>\n\n<pre><code>MsgBox \"Debug: \" &amp; Forms![MyForm1]![Code] 'The first column\nMsgBox \"Debug: \" &amp; Forms![MyForm1]![Name] 'The second column\nMsgBox \"Debug: \" &amp; Forms![MyForm1]![Number] 'The third column\nMsgBox \"Debug: \" &amp; Forms![MyForm1]![Errors] 'The Unbound (last column)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522803567, "post_id": 49640573, "comment_id": 86289956, "body": "Is there a reason this needs to be done in VBA instead of with built-in tools like Conditional Formatting?"}, {"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522804277, "post_id": 49640573, "comment_id": 86290097, "body": "Yes, my reason is because VBA is faster than conditional formatting. The front end of my application is already at capacity with a lot of array formulas and I think if I added conditional formatting it would render the application unusable. I also have issues with conditional formatting rules being dupliucated when a user copies and pastes cells within the conditional formating range...before I know it I will have hundreds of duplicated conditional formatting rules   :)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522806268, "post_id": 49640573, "comment_id": 86290558, "body": "I&#39;m afraid you have it <i>absolutely backwards</i>.  Built-in functionality such as Conditional Formatting is built in far more efficient coding languages than VBA, and are vigorously tested by teams of professionals at multi-billion dollar companies, therefore when used properly, are exponentially more efficient and reliable than custom written VBA.  As for your concern of cells being <i>copied</i> repeatedly: this would be a valid concern if you individually formatted a cell and then copied it. (That makes &quot;two copies&quot; of the format.)  ..."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522818412, "post_id": 49640573, "comment_id": 86293905, "body": "@ashleedawg, I experienced worksheets growing/going out of control due to conditional formatting spreading, too. So I tend to use it as less as I can."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522819331, "post_id": 49640573, "comment_id": 86294245, "body": "@DisplayName Funny, I tend to lean towards Conditional Formatting as much as possible and find it more efficient than other alternatives.  That being said, I can&#39;t currently locate the pages I know I&#39;ve seen recommending Conditional Formatting to speed up Excel and reduce file size, so for now I retract (part) of my earlier comments.  (Of course the bottom line at the end of the day is [in my opinion]:  the <i>&quot;correct&quot;</i> method is <i>&quot;whichever gets the job done&quot;</i> and will vary quite a bit from case to case!)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522820319, "post_id": 49640573, "comment_id": 86294616, "body": "@ashleedawg holy words"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1522827297, "post_id": 49640573, "comment_id": 86298488, "body": "@DisplayName yup"}, {"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522884568, "post_id": 49640573, "comment_id": 86333769, "body": "I agree with that approach @ashleedawg &quot;Whichever gets the job done.&quot; In regards to using conditional formatting I guess I have been bitten too many times and had too clean up the mess created when the rules multiply. Perhaps I am missing something to prevent this from happening but I have developed a preference for VBA. I appreciate the input from you all."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522889843, "post_id": 49640573, "comment_id": 86335197, "body": "@shano I appreciate the feedback too.  One of these reasons I enjoy answering questions on here is because <b>I&#39;m</b> always learning at the same time. (That being said I&#39;m a big believer that #1 most important skill for programming is <i>Google Search Skills</i>.  There should be a  class!)  ... The beautiful thing with Excel/Access/Office/VBA is that there&#39;s &quot;10 ways to do most anything&quot;...  All completely different but none incorrect.  :-)"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 0, "creation_date": 1522813129, "post_id": 49641752, "comment_id": 86292260, "body": "Thanks Paul, its not quite exactly what I wanted. Let me try and explain better with an example. What I am trying to do is look at the value of A1 and if range B1:D1 has the same value as A1 then highlight the cell that matches A1. This criteria should loop through each row down to row A20. A1 could contain several values such as &quot;RT, VC, BB, TR&quot; I would want the VBA to check each of those values within each cell for example if B1 value was &quot;BB&quot; the criteria is met and that cell would be highlighted red. I hope that makes sense?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 0, "creation_date": 1522814618, "post_id": 49641752, "comment_id": 86292644, "body": "Another question: let&#39;s say you have <code>A1=&quot;RT, VC, BB, TR&quot;</code>. You want to look for each value only in B1, C1, and D1? or all the rows in columns B, C, and D?"}, {"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 0, "creation_date": 1522815251, "post_id": 49641752, "comment_id": 86292848, "body": "Hi Paul, I will try and update my original post to give more detail as expressed above. Regarding your last question, I would only want to look at B1, C1 &amp; D1. All rows must be checked based on their corresponding value in column A. for example A5 is used to determine B5, C5 &amp; D5 only, then move onto the next row... until row 20. Also each value in column A is sperated by a &quot;,&quot; and a space (If there is more than one value."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 1, "creation_date": 1522816429, "post_id": 49641752, "comment_id": 86293188, "body": "Please check the updated answer and let me know if there are any issues"}, {"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 0, "creation_date": 1522884213, "post_id": 49641752, "comment_id": 86333665, "body": "Wow! Thank you so much Paul, this works perfectly. I appreciate your help with this."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1522995223, "last_edit_date": 1522995223, "creation_date": 1522808408, "answer_id": 49641752, "question_id": 49640573, "link": "https://stackoverflow.com/questions/49640573/vba-to-colour-cells-if-cell-value-matches/49641752#49641752", "title": "VBA to colour cells if cell value matches", "body": "<p>This will go through all cells in column A, split each cell value (comma-delimited) into separate items, and search for each item in the same row (case insensitive), through columns B to D</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub MarkCellsInColumns()\n    Dim arr As Variant, r As Long, c As Long, i As Long, f As Range, vals As Variant\n\n    arr = Sheet1.UsedRange\n\n    With Sheet1.UsedRange\n        For r = 1 To UBound(arr)\n            If Not IsError(arr(r, 1)) Then\n                If Len(arr(r, 1)) &gt; 0 Then\n\n                    vals = Split(arr(r, 1), \",\")        'check each value in one cell\n                    For i = 0 To UBound(vals)\n                        For c = 2 To UBound(arr, 2)     'check all columns on same row\n                            If LCase(Trim$(vals(i))) = LCase(Trim$(arr(r, c))) Then\n                                If f Is Nothing Then\n                                    Set f = .Cells(r, c)\n                                Else\n                                    Set f = Union(f, .Cells(r, c))  'union of found cells\n                                End If\n                                f.Select\n                            End If\n                        Next c\n                    Next i\n\n                End If\n            End If\n        Next r\n        If Not f Is Nothing Then f.Interior.Color = vbRed   'color all in one operation\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result</p>\n\n<p><a href=\"https://i.stack.imgur.com/LsyFw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LsyFw.png\" alt=\"Result\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522818304, "post_id": 49643103, "comment_id": 86293868, "body": "Nice and simple!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522818636, "post_id": 49643103, "comment_id": 86293994, "body": "@QHarr, thanks. My code is taylored to OP\u2019s example where there are no possible substrings mismatches. Of course it can be easily enhanced to handle that case, too."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522818691, "post_id": 49643103, "comment_id": 86294020, "body": "I was busy writing a regex and then your answer popped up. It was a &quot;duh&quot; moment......"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522818892, "post_id": 49643103, "comment_id": 86294091, "body": "@QHarr &amp; DisplayName - what a coincidence you&#39;re both here, I was just querying &quot;who has all the tag badges iin (VBA,Excel,Excel-VBA) and has answered the most related questions this year?&quot;....  And the two of you are pretty much tied for 1st (<a href=\"https://data.stackexchange.com/stackoverflow/query/834388/who-has-badges-for-excel-vba-excel-vba-and-answers-the-most-related-questions\" rel=\"nofollow noreferrer\">See the query</a>)  Stats are as up to Monday on SEDE so the balance could have tipped since then"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522818949, "post_id": 49643103, "comment_id": 86294115, "body": "@QHarr, I envy you for being able to use RegExp: I have never been bold (and smart) enough to face it!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522819036, "post_id": 49643103, "comment_id": 86294140, "body": "@ashleedawg, I guess it\u2019s QHarr!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522819184, "post_id": 49643103, "comment_id": 86294192, "body": "morning or rather evening @ashleedawg. I can&#39;t compete with the speed provided or quality of DisplayName&#39;s answers but I will continue plodding through what I can. Stats are up for what on SEDE Monday? P.s. my Regex Fu is weak."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522819454, "post_id": 49643103, "comment_id": 86294293, "body": "@QHarr seems to me you said something similar about &quot;competing&quot; with me, and then proceeded to blow me away at a 2:1 answer rate since then...  Careful DsiplayName, he&#39;s just trying to get you to drop your guard."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522820241, "post_id": 49643103, "comment_id": 86294590, "body": "@ashleedawg, I know that! I\u2019ll be watching out!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 4, "last_activity_date": 1522818274, "last_edit_date": 1522818274, "creation_date": 1522817912, "answer_id": 49643103, "question_id": 49640573, "link": "https://stackoverflow.com/questions/49640573/vba-to-colour-cells-if-cell-value-matches/49643103#49643103", "title": "VBA to colour cells if cell value matches", "body": "<p>You may try this</p>\n\n<pre><code>Public Sub Main()\n    Dim cell As Range, cell2 As Range\n    For Each cell In ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2:A20\")\n        For Each cell2 In cell.Offset(, 1).Resize(, 3)\n            If Instr(cell.Value, cell2.Value) &gt; 0 Then cell2.Interior.ColorIndex = 3\n        Next\n    Next \nEnd Sub\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Public Sub Main()\n    Dim cell As Range\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For Each cell In .Range(\"B:D\").SpecialCells(xlCellTypeConstants)\n            If Instr(.Cells(cell.Row,1).Value, cell.Value) &gt; 0 Then cell.Interior.ColorIndex = 3\n        Next\n    End With \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "accepted_answer_id": 49641752, "answer_count": 2, "score": 3, "last_activity_date": 1522995223, "creation_date": 1522798612, "last_edit_date": 1522815961, "question_id": 49640573, "link": "https://stackoverflow.com/questions/49640573/vba-to-colour-cells-if-cell-value-matches", "title": "VBA to colour cells if cell value matches", "body": "<p>I am relatively new to VBA and have this script which searches for the Array \"VC\" and changes the matching cells within the range by colouring them red. </p>\n\n<p>My problem is I need to change the criteria from -MyArr = Array(\"VC\") to instead search column A and find any corresponding matches in the same row within the range \"B2:D20\" then colour the matches red as the below script does. </p>\n\n<p>As per the below script I don't want a case sensitive search and am using XLpart to include partial matches. Please help, thanks</p>\n\n<pre><code>Sub Mark_cells_in_column()\n    Dim FirstAddress As String\n    Dim MyArr As Variant\n    Dim Rng As Range\n    Dim I As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    MyArr = Array(\"VC\")\n    With Sheets(\"Sheet1\").Range(\"A2:d20\")\n        For I = LBound(MyArr) To UBound(MyArr)\n             Set Rng = .Find(What:=MyArr(I), _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n            If Not Rng Is Nothing Then\n                FirstAddress = Rng.Address\n                Do\n                    Rng.Interior.ColorIndex = 3\n                    Set Rng = .FindNext(Rng)\n                Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n            End If\n        Next I\n    End With\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Sample data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/suUGs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/suUGs.png\" alt=\"Sample data\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": true, "score": 1, "last_activity_date": 1522797894, "creation_date": 1522797894, "answer_id": 49640493, "question_id": 49640371, "link": "https://stackoverflow.com/questions/49640371/selecting-a-random-word-from-a-list/49640493#49640493", "title": "Selecting a random word from a list", "body": "<p>Use <code>MergeArea</code>?</p>\n\n<pre><code>Sub showRandomWord()\nDim ws As Worksheet, ws2 As Worksheet\nDim stRow As Long, endRow As Long, dataCol As Long\nDim dispRow As Long, dispCol As Long\n\nSet ws = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\nstRow = 2\ndataCol = 1\ndispRow = 2\ndispCol = 2\n\nWith ws\n    endRow = .Cells(.Rows.Count, dataCol).End(xlUp).Row\nEnd With\n\nws2.Cells(dispRow, dispCol).Value = \"\"\nws.Cells(Application.RandBetween(stRow, endRow), dataCol).Value\n\nws2.Range(\"J2\").MergeArea.ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9583682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b3da6e213694a896545fb06f96f6d1?s=128&d=identicon&r=PG&f=1", "display_name": "AC130", "link": "https://stackoverflow.com/users/9583682/ac130"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 49640493, "answer_count": 1, "score": 0, "last_activity_date": 1591737089, "creation_date": 1522797049, "last_edit_date": 1591737089, "question_id": 49640371, "link": "https://stackoverflow.com/questions/49640371/selecting-a-random-word-from-a-list", "title": "Selecting a random word from a list", "body": "<p>I am trying to get my macro(next word) to select a random word from a list and then another macro(definition) does a vlookup to return the definition. When I select the macro to grab a new word I need it to clear the macro for the definition so that I cant see it until i select the definition button. Right now i get  runtime error 1004 and it highlights my .clearcontent code at the end.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C2IxO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C2IxO.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub showRandomWord()\nDim ws As Worksheet, ws2 As Worksheet\nDim stRow As Long, endRow As Long, dataCol As Long\nDim dispRow As Long, dispCol As Long\n\nSet ws = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\nstRow = 2\ndataCol = 1\ndispRow = 2\ndispCol = 2\n\nWith ws\n    endRow = .Cells(.Rows.Count, dataCol).End(xlUp).Row\nEnd With\nws2.Cells(dispRow, dispCol).Value = \nws.Cells(Application.RandBetween(stRow, endRow), dataCol).Value\n\nWorksheets(\"Sheet2\").Range(\"J2\").ClearContents\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9584302, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823468214333039/picture?type=large", "display_name": "Jake Kruk", "link": "https://stackoverflow.com/users/9584302/jake-kruk"}, "edited": false, "score": 0, "creation_date": 1522808785, "post_id": 49640656, "comment_id": 86291166, "body": "I can&#39;t find atvbean.vbs or atpvbean.xlam in the Tools/References tab."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 27, "user_id": 9584302, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823468214333039/picture?type=large", "display_name": "Jake Kruk", "link": "https://stackoverflow.com/users/9584302/jake-kruk"}, "edited": false, "score": 0, "creation_date": 1522809321, "post_id": 49640656, "comment_id": 86291284, "body": "@JakeKruk If the add-in is installed it should appear towards the top of the references list."}, {"owner": {"reputation": 27, "user_id": 9584302, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823468214333039/picture?type=large", "display_name": "Jake Kruk", "link": "https://stackoverflow.com/users/9584302/jake-kruk"}, "edited": false, "score": 0, "creation_date": 1522810594, "post_id": 49640656, "comment_id": 86291628, "body": "Had to enable the Analysis Toolpack for VBA. Thanks!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1522799323, "creation_date": 1522799323, "answer_id": 49640656, "question_id": 49640363, "link": "https://stackoverflow.com/questions/49640363/vba-t-test-two-sample-assuming-unequal-variances/49640656#49640656", "title": "VBA t-Test: Two-Sample Assuming Unequal Variances", "body": "<p>Rather than using <code>Application.Run</code>, add a reference to <code>atvbaen.vbs</code> to your project (using <code>Tools/References</code> in the VBA editor) after doing this, you should be able to just do something like:</p>\n\n<pre><code>Pttestv ActiveSheet.Range(\"A2:\" &amp; \"A\" &amp; (Sheets(\"Sheet1\").Range(\"E3\").Value +1)),  ActiveSheet.Range(\"B2:\" &amp; \"B\" &amp; (Sheets(\"Sheet1\").Range(\"E3\").Value + 1)), \"\", False, 0.05, 0\n</code></pre>\n\n<p>If you really want to use <code>Application.Run</code>, you would need to include the full path to the file <code>ATPVBAEN.XLAM</code>. VBA is looking for it in your documents folder, which is not where it is located.</p>\n"}], "owner": {"reputation": 27, "user_id": 9584302, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823468214333039/picture?type=large", "display_name": "Jake Kruk", "link": "https://stackoverflow.com/users/9584302/jake-kruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 49640656, "answer_count": 1, "score": 0, "last_activity_date": 1522799335, "creation_date": 1522796982, "last_edit_date": 1531164843, "question_id": 49640363, "link": "https://stackoverflow.com/questions/49640363/vba-t-test-two-sample-assuming-unequal-variances", "title": "VBA t-Test: Two-Sample Assuming Unequal Variances", "body": "<p>How do you code in VBA a t-test: two-sample assuming unequal variances? Here's what I have so far. When I run it, a window says \"Sorry, we couldn't find C:\\Users\\Jacob\\Documents\\ATPVBAEN.XLAM. Is it possible it was moved, renamed or deleted?\"</p>\n\n<pre><code>Application.Run \"ATPVBAEN.XLAM!Pttestv\", ActiveSheet.Range(\"A2:\" &amp; \"A\" &amp; \n(Sheets(\"Sheet1\").Range(\"E3\").Value + 1)), _\n        ActiveSheet.Range(\"B2:\" &amp; \"B\" &amp; (Sheets(\"Sheet1\").Range(\"E3\").Value + \n1)), \"\", False, 0.05, 0\n</code></pre>\n"}, {"tags": ["sql", "excel", "teradata", "vba"], "comments": [{"owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 1, "creation_date": 1522795825, "post_id": 49640180, "comment_id": 86288067, "body": "Try <code>QueryA = &quot;select *  from database.table WHERE Name = &quot; &amp; ConcatSQL</code> (remove the last <code>&amp; &quot;</code>)"}, {"owner": {"reputation": 11, "user_id": 7159152, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-veEVVZFP5BY/AAAAAAAAAAI/AAAAAAAAIag/dVRx0lD_pnw/photo.jpg?sz=128", "display_name": "Joshua3m", "link": "https://stackoverflow.com/users/7159152/joshua3m"}, "reply_to_user": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1522796919, "post_id": 49640180, "comment_id": 86288328, "body": "This same issue as before run-time error 3021 Either BOF or EOF is true , or the current record haseen deleted."}, {"owner": {"reputation": 1276, "user_id": 5812981, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/1Ed7a.jpg?s=128&g=1", "display_name": "access_granted", "link": "https://stackoverflow.com/users/5812981/access-granted"}, "edited": false, "score": 0, "creation_date": 1522887676, "post_id": 49640180, "comment_id": 86334649, "body": "QueryA = &quot;select *  from database.table WHERE &quot; &amp; chr(34) &amp; Name &amp; chr(34) &amp; &quot; = &#39;&quot; &amp; ConcatSQL &amp; &quot;&#39;&quot; - assuming your column name is actually Name. Otherwise: QueryA = &quot;select *  from database.table WHERE Column_Name = &#39;&quot; &amp; ConcatSQL &amp; &quot;&#39;&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 6406676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tKqoTYfIoLg/AAAAAAAAAAI/AAAAAAAAAE4/nAM6WSK4jN0/photo.jpg?sz=128", "display_name": "David Cram", "link": "https://stackoverflow.com/users/6406676/david-cram"}, "edited": false, "score": 2, "creation_date": 1522857913, "post_id": 49640440, "comment_id": 86320218, "body": "Teradata uses double quotes rather than brackets."}, {"owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "reply_to_user": {"reputation": 709, "user_id": 6406676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tKqoTYfIoLg/AAAAAAAAAAI/AAAAAAAAAE4/nAM6WSK4jN0/photo.jpg?sz=128", "display_name": "David Cram", "link": "https://stackoverflow.com/users/6406676/david-cram"}, "edited": false, "score": 0, "creation_date": 1522858256, "post_id": 49640440, "comment_id": 86320420, "body": "@DavidCram you are right <a href=\"https://community.teradata.com/t5/General/How-to-use-reserved-key-words-as-column-names/td-p/55983\" rel=\"nofollow noreferrer\">community.teradata.com/t5/General/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": false, "score": 0, "last_activity_date": 1522858349, "last_edit_date": 1522858349, "creation_date": 1522797544, "answer_id": 49640440, "question_id": 49640180, "link": "https://stackoverflow.com/questions/49640180/vba-teradata-sql/49640440#49640440", "title": "VBA Teradata SQL", "body": "<p>One possible reason for the error is that field <code>Name</code> is a reserved word in Teradata, so you should use <code>\"Name\"</code> (using double quotes) instead</p>\n\n<pre><code>QueryA = \"select *  from database.table WHERE \" &amp; Chr(34) &amp; \"Name\" &amp; Chr(34) &amp; \" = \" &amp; ConcatSQL\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1276, "user_id": 5812981, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/1Ed7a.jpg?s=128&g=1", "display_name": "access_granted", "link": "https://stackoverflow.com/users/5812981/access-granted"}, "is_accepted": false, "score": -1, "last_activity_date": 1522960932, "last_edit_date": 1522960932, "creation_date": 1522887856, "answer_id": 49662350, "question_id": 49640180, "link": "https://stackoverflow.com/questions/49640180/vba-teradata-sql/49662350#49662350", "title": "VBA Teradata SQL", "body": "<p>Could you try this:</p>\n\n<pre><code>On Error Resume Next\nSet rs = cmdSQLData.Execute()\nIf Err.Number&lt;&gt;0 Then\n  MsgBox(Err.Description)\nEnd If\n</code></pre>\n\n<p>And post the output? Also can you post the output of QueryA.</p>\n"}], "owner": {"reputation": 11, "user_id": 7159152, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-veEVVZFP5BY/AAAAAAAAAAI/AAAAAAAAIag/dVRx0lD_pnw/photo.jpg?sz=128", "display_name": "Joshua3m", "link": "https://stackoverflow.com/users/7159152/joshua3m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522960932, "creation_date": 1522795661, "last_edit_date": 1531164843, "question_id": 49640180, "link": "https://stackoverflow.com/questions/49640180/vba-teradata-sql", "title": "VBA Teradata SQL", "body": "<p>For some reason it's returning run-time error 3021 , SQL string is working ok when trying in Terada SQLAssistant. </p>\n\n<p>Can someone give me hint what I'm doing wrong ? </p>\n\n<p>Value in cell equal to John Doe </p>\n\n<pre><code>Dim ConcatSQL As String\n\nConcatSQL = Sheets(\"LogIn\").Cells(8, 3).Value\n\n\n\nQueryA = \"select *  from database.table WHERE Name = \" &amp; ConcatSQL &amp; \"   \n\n cmdSQLData.CommandText = QueryA\ncmdSQLData.CommandType = adCmdText\ncmdSQLData.CommandTimeout = 0\nMsgBox (QueryA)\n\nSet rs = cmdSQLData.Execute()\nRow = 1\nrs.MoveFirst ' it's falling here \n Do While (rs.EOF = False And rs.BOF = False)\n</code></pre>\n"}, {"tags": ["vba", "excel", "dialog"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522820744, "post_id": 49640048, "comment_id": 86294795, "body": "Why not unprotect the sheet or allow user to select unlocked cells? Or do you genuinely want the user to only be able to view and even if they select a cell for no alert to be raised?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522876759, "post_id": 49643904, "comment_id": 86330793, "body": "Was this helpful?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1522821898, "creation_date": 1522821898, "answer_id": 49643904, "question_id": 49640048, "link": "https://stackoverflow.com/questions/49640048/excel-vba-how-to-disable-protected-sheet-dialog-on-keydown/49643904#49643904", "title": "Excel VBA: How To Disable Protected Sheet Dialog On Keydown", "body": "<p>So here is a workaround by <a href=\"https://www.mrexcel.com/forum/excel-questions/50595-possible-change-default-protected-sheet-msg.html\" rel=\"nofollow noreferrer\">kskinne</a>:</p>\n\n<p>1) Make sure all cells you don't want changed are locked <code>Format Cells &gt; Locked</code> </p>\n\n<p>2) Then instead of protecting worksheet use the following code in the code pane for the sheet of interest.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n\n    If Target.Locked = True Then Application.Undo\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I like this solution. I don't think switching-off <code>DisplayAlerts</code> will work. I put \n<code>Application.DisplayAlerts = False</code> into <code>Worksheet_Activate</code> event and the message still fired.</p>\n"}], "owner": {"reputation": 51, "user_id": 9078370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71075cc7a2418b372933445e2a5e1a3?s=128&d=identicon&r=PG&f=1", "display_name": "Nickprovs", "link": "https://stackoverflow.com/users/9078370/nickprovs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2452, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522823669, "creation_date": 1522794846, "last_edit_date": 1522823669, "question_id": 49640048, "link": "https://stackoverflow.com/questions/49640048/excel-vba-how-to-disable-protected-sheet-dialog-on-keydown", "title": "Excel VBA: How To Disable Protected Sheet Dialog On Keydown", "body": "<p>After doing a File > Protect Workbook > Protect Current Sheet > Unselect All > Okay</p>\n\n<p>Anytime I press a keydown while viewing the sheet I get a </p>\n\n<p>\"The cell or chart you're trying to change is on a protected sheet.\" dialog.</p>\n\n<p>I'd like to disable this.</p>\n\n<p>I currently have a Auto_Open macro which does a Application.DisplayAlerts = False</p>\n\n<p>This does not seem to help, even though I'm sure the macro is running on startup.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1522792812, "post_id": 49639728, "comment_id": 86287142, "body": "Assume the possible row label items after pivot.refreshall are unknown. Thus, I cannot manually activate filters one by one with a macro. It needs to show all except blank."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522796779, "post_id": 49639728, "comment_id": 86288296, "body": "Is this an OLAP/PowerPivot PivotTable, or a &#39;traditional&#39; one?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522857323, "post_id": 49639728, "comment_id": 86319842, "body": "non OLAP. Below answer is sufficient. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 1, "last_activity_date": 1522796929, "creation_date": 1522796929, "answer_id": 49640353, "question_id": 49639728, "link": "https://stackoverflow.com/questions/49639728/macro-to-update-filter-on-pivot-to-include-all-but-blank-while-leaving-field-s/49640353#49640353", "title": "Macro to update filter on pivot to include all but &quot;Blank&quot; while leaving field settings as is", "body": "<p>Fire up the Macro recorder, then clear the filter, and deselect blank. That will give you the code you need.</p>\n\n<p>For a non OLAP PivotTable, it will be as simple as this:</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"test\")\n        .ClearAllFilters\n        .PivotItems(\"(blank)\").Visible = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "accepted_answer_id": 49640353, "answer_count": 1, "score": 0, "last_activity_date": 1522796929, "creation_date": 1522792645, "last_edit_date": 1531161705, "question_id": 49639728, "link": "https://stackoverflow.com/questions/49639728/macro-to-update-filter-on-pivot-to-include-all-but-blank-while-leaving-field-s", "title": "Macro to update filter on pivot to include all but &quot;Blank&quot; while leaving field settings as is", "body": "<p>I need a macro to select the Row Label filter and select all but \"Blank.\" The last condition is, I need the macro to leave field settings as is: namely, I need the \"Show items with no data\" to remain unchecked. </p>\n\n<p>We tried .showallitems=true but this modified the field settings to show items with no data. </p>\n\n<p>Also tried pivotitem.visible=true but nothing happened. </p>\n"}, {"tags": ["excel", "sas", "vba"], "comments": [{"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1522790336, "post_id": 49639181, "comment_id": 86286250, "body": "Link doesn&#39;t work"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1522791251, "post_id": 49639181, "comment_id": 86286618, "body": "On which line are you getting the error?"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1522791382, "post_id": 49639181, "comment_id": 86286658, "body": "On the line I modified. The one posted in question"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1522791447, "post_id": 49639181, "comment_id": 86286682, "body": "Ah! ok. You mentioned that, it just seems like an odd line to get that error. Try wrapping parantheses around the query string like `obSAS.LanguageService.Submit(&quot;Proc... whatnot... etc...;&quot;) and see if that fixes it up"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1522791565, "post_id": 49639181, "comment_id": 86286719, "body": "Tried that.. Didn&#39;t work"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1522821607, "post_id": 49639181, "comment_id": 86295187, "body": "Post the rest of your code"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522827106, "post_id": 49639181, "comment_id": 86298358, "body": "Please add the relevant code that you <b>actually</b> use by <a href=\"https://stackoverflow.com/posts/49639181/edit\">edit</a>ing the original question."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1522942272, "post_id": 49639181, "comment_id": 86363537, "body": "Edited the question"}, {"owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1523288363, "post_id": 49639181, "comment_id": 86487609, "body": "Most probably <code>obSAS</code> was not set by the <code>CreateObjectByServer()</code> method. Try to do insert a <code>If obSAS Is Nothing Then ... Else ... End If</code> to confirm. Without documentation of SASObjectManager that is as far as we can help."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1523289946, "post_id": 49639181, "comment_id": 86488608, "body": "I believe you&#39;re right.. obSAS is Nothing. That explains the error.. but is there a way to solve this? @Dr Yunke"}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1523375044, "post_id": 49639181, "comment_id": 86530617, "body": "Post on communities.sas.com and the developers can help you out there."}], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1523292635, "post_id": 49737598, "comment_id": 86489978, "body": "I tried that as well. When I use synchronous connection, it throws Automation Error. A window pops up with Run Time Error &#39;-2147213310 (80042002)&#39;"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1523300870, "post_id": 49737598, "comment_id": 86494423, "body": "So you think that there is nothing wrong in my code? I did double checked the port number and  machine name etc using ITConfig2.exe and everything matches. I&#39;ll give a try with sas tech support"}], "tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": false, "score": 0, "last_activity_date": 1523295564, "last_edit_date": 1523295564, "creation_date": 1523291587, "answer_id": 49737598, "question_id": 49639181, "link": "https://stackoverflow.com/questions/49639181/language-service-submit-error-91/49737598#49737598", "title": "Language Service Submit: Error &#39;91&#39;", "body": "<p>You are trying to create an Asynchronous connection. I would try to create a syncronous connection instead (change second parameter to true).</p>\n\n<pre><code>Set obSAS = obObjectFactory.CreateObjectByServer(\"sas\", True, obServer, \"\", \"\")\n</code></pre>\n\n<blockquote>\n  <p>Synchronous indicates whether a connection is synchronous or\n  asynchronous. The synchronous connection is most frequently used and\n  is the simplest connection to create. If this parameter equals TRUE,\n  CreateObjectByServer does not return until a connection is made. If\n  this parameter equals FALSE, the function returns a null value\n  immediately. When a connection is made, the object is stored in the\n  ObjectKeeper.</p>\n</blockquote>\n\n<p>From SAS documentation. Thus why your variable is <code>Nothing</code> right away.</p>\n\n<p><a href=\"http://support.sas.com/rnd/itech/doc9/dev_guide/dist-obj/winclnt/omcreate.html\" rel=\"nofollow noreferrer\">http://support.sas.com/rnd/itech/doc9/dev_guide/dist-obj/winclnt/omcreate.html</a></p>\n\n<p>Now for the Submit method, I suggest you add some error checking code like</p>\n\n<pre><code>If obSAS Is Nothing Then\n   MsgBox(\"Connection failed\")\nElse\n   obSAS.LanguageService.Submit \"PROC SQL; CREATE TABLE ME.TABLE1; RUN;\" 'Error at submit\nEnd If\n</code></pre>\n\n<p>That above will answer your question of why you are getting the error <em>Object variable or With block variable not set</em>.</p>\n\n<p>For the later <strong>Run Time Error '-2147213310 (80042002)'</strong> that is a different issue/question. And you should try to contact SAP tech support, with the information you provided there is nothing much we can do. The error must give you additional information in form of html tags. From the link you supplied, it seems this error is caused by a bad connection settings/parameters.</p>\n\n<blockquote>\n  <p>The workspaceservers default port is <strong>8591</strong>. Perhaps the\n  workspaceserver also runs on a different machine. Connect to your\n  profile, go to the serverlist, locate the server you want to connect\n  to and right click the context menu \"properties\" to see the right\n  connection profile for your workspaceserver.</p>\n  \n  <p>BTW: if you are using IWA (integrated windows authentication) you must\n  not provide a username and password (Nothing).</p>\n</blockquote>\n\n<pre><code>Set obSAS = obObjectFactory.CreateObjectByServer(\"sas\", True, obServer, Nothing, Nothing)\n</code></pre>\n"}], "owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1523295564, "creation_date": 1522789736, "last_edit_date": 1531164843, "question_id": 49639181, "link": "https://stackoverflow.com/questions/49639181/language-service-submit-error-91", "title": "Language Service Submit: Error &#39;91&#39;", "body": "<p>I followed the solution posted in below link to execute a simple SAS Query through VBA:\n<a href=\"https://communities.sas.com/t5/SAS-Enterprise-Guide/Calling-SAS-through-VBA/td-p/79673\" rel=\"nofollow noreferrer\">Calling SAS through VBA</a></p>\n\n<pre><code>Dim obObjectFactory As New SASObjectManager.ObjectFactory\nDim obObjectKeeper As New SASObjectManager.ObjectKeeper\nDim obServer As New SASObjectManager.ServerDef\nDim obSAS As SAS.Workspace\nDim cn As New ADODB.Connection\nDim rs As New ADODB.Recordset\nobServer.MachineDNSName = \"xxxx@company.com\"\nobServer.Protocol = ProtocolBridge\nobServer.Port = 8561\nobObjectFactory.LogEnabled = True\nSet obSAS = obObjectFactory.CreateObjectByServer(\"sas\", False, obServer, \"\", \"\")\nobSAS.LanguageService.Submit \"PROC SQL; CREATE TABLE ME.TABLE1; RUN;\" 'Error at submit\n</code></pre>\n\n<p>But I'm getting error at the above submit line as \"Object variable or With block variable not set\"</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522793497, "post_id": 49639162, "comment_id": 86287368, "body": "Please take a moment to read in the <a href=\"https://stackoverflow.com/help\">help center</a> about how to effectively ask questions on Stack Overflow. This is not free code-writing service or a tutorial site. You&#39;re expected to have done basic research and ask very specific questions about code you have."}, {"owner": {"reputation": 1, "user_id": 9593471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aaron Tarazon", "link": "https://stackoverflow.com/users/9593471/aaron-tarazon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522796277, "post_id": 49639162, "comment_id": 86288184, "body": "Cindy, my apologies.  Will do. - Aaron"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1522798585, "creation_date": 1522798585, "answer_id": 49640568, "question_id": 49639162, "link": "https://stackoverflow.com/questions/49639162/selecting-outer-row-for-subtable-ms-word-vba/49640568#49640568", "title": "Selecting Outer Row for Subtable MS Word VBA", "body": "<p>The method isn't especially obvious:</p>\n\n<pre><code>Selection.Tables(1).Range.Characters.Last.Next.Cells(1).Row.Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9593471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aaron Tarazon", "link": "https://stackoverflow.com/users/9593471/aaron-tarazon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1522817008, "creation_date": 1522789650, "last_edit_date": 1522817008, "question_id": 49639162, "link": "https://stackoverflow.com/questions/49639162/selecting-outer-row-for-subtable-ms-word-vba", "title": "Selecting Outer Row for Subtable MS Word VBA", "body": "<p>For MS Word tables/vba:</p>\n\n<p>I have a sub-table within a row. When the cursor is placed in the sub-table, I'd like to select the outer table's row. I can't seem to find a way to select the outer row. Your assistance is very much appreciated. Thank you!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1522885252, "last_edit_date": 1522885252, "creation_date": 1522794110, "answer_id": 49639956, "question_id": 49639139, "link": "https://stackoverflow.com/questions/49639139/when-docmd-openform-opens-a-blank-form-because-no-record-was-found-display-a-me/49639956#49639956", "title": "When DoCmd.OpenForm opens a blank form because no record was found, display a message box that says record is not found", "body": "<p>You have two choices</p>\n\n<p>Either put your event handling in the OnOpen event of the form named SchoolForm (and maybe use OpenArgs or an invisible textbox to set some kind of Status on that form so it knows where it was opened from, and why)</p>\n\n<p>or simpler:</p>\n\n<p>Check for existence of the SchoolID in the table before attempting to open SchoolForm</p>\n\n<p>Could use a DLookup or a DCount</p>\n\n<p>e.g.</p>\n\n<pre><code>If DCount(\"SchoolID\", \"YourTableOrQueryForSchools\", \"SchoolID=\" &amp; \"\"\"\" &amp; Me.txtSearchBar.Value &amp; \"\"\"\") = 0 Then\n\n    MsgBox \"Please enter a valid SchoolID.\", 64, \"Try Again\"\n    Me.txtSearchBar = \"\"\n    Me.txtSearchBar.Setfocus\n\nElse\n\n    DoCmd.OpenForm \"SchoolForm\", , , \"SchoolID = \" &amp; \"\"\"\" &amp;  Me.txtSearchBar.Value &amp; \"\"\"\", acFormReadOnly  \n\nEnd If  \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 49639956, "answer_count": 1, "score": 0, "last_activity_date": 1594022960, "creation_date": 1522789513, "last_edit_date": 1594022960, "question_id": 49639139, "link": "https://stackoverflow.com/questions/49639139/when-docmd-openform-opens-a-blank-form-because-no-record-was-found-display-a-me", "title": "When DoCmd.OpenForm opens a blank form because no record was found, display a message box that says record is not found", "body": "<p>I have a MainMenu where the user can enter a SchoolID in a search bar (txtSearchBar) and when they click on the SearchBySchoolID button, it opens the form, SchoolForm, based on the SchoolID. Sometimes the user clicks the SearchBySchoolID button without entering anything in the txtSearchBar so when the code below is executed, SchoolForm still opens but it is all blank. </p>\n\n<p>What can I add to my code below so that a message box saying \"No SchoolID found\" pops up instead of bringing the user to a blank SchoolForm when they type nothing into my search bar? </p>\n\n<pre><code>Private Sub SearchBySchoolID_Click()\n\nDim txtSearchBar As String\n\nOn Error GoTo ErrorIDSearch\n\nDoCmd.OpenForm \"SchoolForm\", , , \"SchoolID = \" &amp; (\"\"\"\" &amp;    \nMe.txtSearchBar.Value &amp; \"\"\"\"), acFormReadOnly  \n\n\nExitErrorIDSearch:\n\nExit Sub\n\n\nErrorSIDSearch:\n\nIf Err.Number = 3075 Then\n\nMsgBox \"Please enter a valid SchoolID.\"\n\n    Else\n\nMsgBox \"The following error has occured:\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Error Description: \" &amp; Err.Description &amp; vbCrLf &amp; vbCrLf &amp; , _\n            vbCritical, \"An Error has Occured!\"\n\n         Resume ExitErrorIDSearch\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9470143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61dcdb66e5206fe9636ecb4edce9d713?s=128&d=identicon&r=PG&f=1", "display_name": "Lukb42", "link": "https://stackoverflow.com/users/9470143/lukb42"}, "edited": false, "score": 0, "creation_date": 1522790038, "post_id": 49639092, "comment_id": 86286119, "body": "That worked perfectly, thanks so much! Now I just have to go figure out &quot;Len&quot; Thanks again!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 15, "user_id": 9470143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61dcdb66e5206fe9636ecb4edce9d713?s=128&d=identicon&r=PG&f=1", "display_name": "Lukb42", "link": "https://stackoverflow.com/users/9470143/lukb42"}, "edited": false, "score": 1, "creation_date": 1522790134, "post_id": 49639092, "comment_id": 86286163, "body": "My pleasure. Checking Len(gth) equals zero is equivalent to checking if the cell is empty."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522789318, "creation_date": 1522789318, "answer_id": 49639092, "question_id": 49639009, "link": "https://stackoverflow.com/questions/49639009/copy-cell-above-if-2-criteria-from-separate-columns-are-met/49639092#49639092", "title": "Copy cell above if 2 criteria from separate columns are met", "body": "<p>Try this. Your first loop wasn't doing anything and your second was only checking column E.</p>\n\n<pre><code>Sub CopyFIN() 'copies FIN from account above if E is empty and AJ is anything other than empty\n\nDim lr As Long\nDim rcell As Range\nDim col As Range\n\nApplication.ScreenUpdating = False\n\nlr = Cells(Rows.Count, 6).End(xlUp).Row\nSet col = Range(\"E12:E\" &amp; lr)\n\nFor Each rcell In col\n    If Len(rcell) = 0 And Len(Cells(rcell.Row, \"AJ\")) &gt; 0 Then\n        rcell.Offset(-1, 0).Copy rcell\n    End If\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9470143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61dcdb66e5206fe9636ecb4edce9d713?s=128&d=identicon&r=PG&f=1", "display_name": "Lukb42", "link": "https://stackoverflow.com/users/9470143/lukb42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 49639092, "answer_count": 1, "score": 0, "last_activity_date": 1522796390, "creation_date": 1522788895, "last_edit_date": 1531164843, "question_id": 49639009, "link": "https://stackoverflow.com/questions/49639009/copy-cell-above-if-2-criteria-from-separate-columns-are-met", "title": "Copy cell above if 2 criteria from separate columns are met", "body": "<p>Looking for VBA to copy cell above (in column E) if cell in E is empty and AJ is anything other than empty. Currently this is copying the cell above but is not taking into account the AJ column. Fairly new to VBA and not sure where I am going wrong. Any input is greatly appreciated. </p>\n\n<pre><code>Sub CopyFIN() 'copies FIN from account above if E is empty and AJ is anything other than empty\n\nDim lr As Long\nDim rcell As Range\nDim col As Range\n\nApplication.ScreenUpdating = False\n\nlr = Cells(Rows.Count, 6).End(xlUp).Row\nSet col = Range(\"E12:E\" &amp; lr)\nSet col2 = Range(\"AJ12:AJ\" &amp; lr)\n\n    For Each rcell In col2\n        If rcell.Value &lt;&gt; \"\" Then\n        End If\n    Next\n\n    For Each rcell In col\n        If rcell.Value = \"\" Then\n            rcell.Offset(-1, 0).Copy rcell\n        End If\n    Next\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522788866, "post_id": 49638964, "comment_id": 86285599, "body": "What is the value of the relevant cell in column B when it errors? Not an integer perhaps?"}, {"owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522789126, "post_id": 49638964, "comment_id": 86285708, "body": "all values in column B are the result from a countif function, so i believe they&#39;re all integers"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1522789356, "post_id": 49638964, "comment_id": 86285817, "body": "I didn&#39;t ask what you believed, but what it actually is when you run the code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522789493, "post_id": 49638964, "comment_id": 86285875, "body": "Looks like <code>Range(&quot;B&quot; &amp; n)</code> contains an error value. Hit the error, and when VBA breaks on that instruction hit Ctrl+G and type <code>?n, Range(&quot;B&quot; &amp; n).Value</code> - I expect that to output something like <code>17      Error2042</code> - now go to the active sheet and look at what <code>B17</code> contains. If that&#39;s an error value, then there&#39;s your problem: you can&#39;t coerce an error into an <code>Integer</code>."}, {"owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "edited": false, "score": 0, "creation_date": 1522789967, "post_id": 49638964, "comment_id": 86286077, "body": "i am not sure which cell causes the error, as the macro has repeatedly performed what I want it to do. but, it still triggers the error code, which i would like to learn why it does so, and if it could cause a problem in the future..?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522790095, "post_id": 49638964, "comment_id": 86286147, "body": "If you do exactly what I just said in that comment, the immediate pane will tell you exactly what the problem cell is."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522790378, "post_id": 49638964, "comment_id": 86286271, "body": "If there&#39;s no error cell, look for empty ones. Or see answer below - that <code>Debug.Print</code> statement will print all the problematic rows to the immediate pane (Ctrl+G). Protip: learn to use the debugger and inspect your variables&#39; values at run-time in break mode."}, {"owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522790464, "post_id": 49638964, "comment_id": 86286311, "body": "thanks, @MathieuGuindon.. immediate pane returns &quot;1      count&quot; and the active sheet has the same value (1) as it did before"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522790549, "post_id": 49638964, "comment_id": 86286358, "body": "well then, bingo. Row 1 contains &quot;count&quot; - what&#39;s the numeric value for that?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522790557, "post_id": 49638964, "comment_id": 86286361, "body": "So your first cell contains &quot;count&quot; which is not an integer!"}, {"owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "edited": false, "score": 0, "creation_date": 1522790813, "post_id": 49638964, "comment_id": 86286465, "body": "ahh.. the header row! how do i bypass that first (header) row, while allowing macro to remain dynamic with number of rows in column (e.g., B:B)?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522791099, "post_id": 49638964, "comment_id": 86286561, "body": "You do realize that your loop quite explicitly goes <code>LastRow To 1 Step -1</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "edited": false, "score": 0, "creation_date": 1522792225, "post_id": 49639226, "comment_id": 86286950, "body": "changing <code>LastRow To 1 Step -1</code> to <code>LastRow To 2 Step -1</code> did the trick! + thanks for the valuable (and kind) lessons on declarations and assumptions"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "edited": false, "score": 0, "creation_date": 1522793984, "post_id": 49639226, "comment_id": 86287534, "body": "@jaeger my pleasure! Check out my user profile for some valuable links, too! Rubberduck inspections can probably spare you a Stack Overflow question or two ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1522791185, "last_edit_date": 1522791185, "creation_date": 1522790010, "answer_id": 49639226, "question_id": 49638964, "link": "https://stackoverflow.com/questions/49638964/insert-number-of-rows-based-on-value-in-adjacent-cell/49639226#49639226", "title": "Insert number of rows based on value in adjacent cell", "body": "<p>Your loop includes row 1:</p>\n\n<pre><code>LastRow To 1 Step -1\n</code></pre>\n\n<p>Make that <code>To 2 Step -1</code> to skip the heading.</p>\n\n<hr>\n\n<p>That said...</p>\n\n<p>You have declared <code>temp</code> as an <code>Integer</code>.</p>\n\n<pre><code>Dim temp As Integer\n</code></pre>\n\n<p>That means whatever you assign to <code>temp</code> must be compatible with a 16-bit signed integer value, i.e. any numeric value between -32677 and 32767.</p>\n\n<p>Some values will implicitly convert to an <code>Integer</code>. e.g. 44.634 will assign <code>temp</code> with 45.</p>\n\n<p>Some values won't convert though.</p>\n\n<ul>\n<li>An empty string <code>\"\"</code> (or any non-numeric string for that matter) can't be converted to an <code>Integer</code>.</li>\n<li>An error value (e.g. <code>#NA</code>) can't be converted to <em>anything</em>.</li>\n</ul>\n\n<p>Your code is making assumptions:</p>\n\n<pre><code>temp = Range(\"B\" &amp; n) ' &lt;&lt; run-time error 13 / \"type mismatch\"\n</code></pre>\n\n<p>It's assuming that the <code>ActiveSheet</code> is the sheet you want to be working with. It's assuming <code>n</code> has a value that represents a valid worksheet row number - you haven't declared <code>n</code>, so it's likely a <code>Variant/Long</code>, or <code>Variant/Integer</code>, so <code>n</code> is probably fine (still, it should be declared).</p>\n\n<p>It's assuming that the value of the range can be coerced into an <code>Integer</code>.</p>\n\n<p>Remove these assumptions.</p>\n\n<pre><code>Dim cellValue As Variant\ncellValue = ActiveSheet.Range(\"B\" &amp; n).Value\n\nIf IsNumeric(cellValue) Then\n    temp = CInt(cellValue)\nElse\n    'skip. cell is invalid.\n    Debug.Print \"Row# \" &amp; n &amp; \" contains an invalid value.\"\nEnd If\n</code></pre>\n\n<p>I'd recommend using a 32-bit integer type (i.e. <code>Long</code>) instead of <code>Integer</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 3230269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3128f9d7953d157accbc1eab60ca0a4?s=128&d=identicon&r=PG", "display_name": "jaeger", "link": "https://stackoverflow.com/users/3230269/jaeger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522791185, "creation_date": 1522788637, "last_edit_date": 1522789335, "question_id": 49638964, "link": "https://stackoverflow.com/questions/49638964/insert-number-of-rows-based-on-value-in-adjacent-cell", "title": "Insert number of rows based on value in adjacent cell", "body": "<p>I have adapted a VB macro to insert extra rows below values (see \"interval\" in column A) when there are duplicate instances of associated values occur (see \"count\" in Column C). More specifically, when there is a count of duplicates that is greater than 1 (0 = no instances, 1 = single instance) with a particular time interval, I want to insert extra rows so that there will be room to insert the duplicated values in order of their appearance.</p>\n\n<p>Images of the Excel data <a href=\"https://i.stack.imgur.com/ktJbD.png\" rel=\"nofollow noreferrer\">before execution</a>, <a href=\"https://i.stack.imgur.com/KSxCV.png\" rel=\"nofollow noreferrer\">after execution</a>.</p>\n\n<p>Below is the code I have been working with, and it appears to be working. But, it draws an error code every time I run the macro. Could someone please explain why this section of code is triggering the error, and how to fix it? here is the error code that appears: \"Run-time error code '13' Type: mismatch\", and debugging points to this line of code: <code>temp = Range(\"B\" &amp; n)</code></p>\n\n<pre><code>Sub dupeIntervals()\n' insert new rows to match how many utterances are in a particular time interval\n    Worksheets(\"Align\").Activate\n    Dim r, count As Range\n    Dim LastRow As Long\n    Dim temp As Integer\n    Set r = Range(\"A:C\")\n    Set count = Range(\"B:B\")\n    LastRow = Range(\"B\" &amp; Rows.count).End(xlUp).Row\n    For n = LastRow To 1 Step -1\n        temp = Range(\"B\" &amp; n) ' &lt;&lt; run-time error 13 / \"type mismatch\"\n        If (temp &gt; 1) Then\n            Rows(n + 1 &amp; \":\" &amp; n + temp - 1).Insert Shift:=xlDown\n        End If\n    Next n\nEnd Sub\n</code></pre>\n\n<p>Thanks! </p>\n\n<p>P.S. here is the anecdotal explanation of how I am using this macro:\nI am transforming utterances from transcribed interviews from continuous data (millisecond time-stamp of when utterance began) into 5-second time intervals. on occasion, there will be more than one utterance per 5s interval, which requires extra rows for inserting those extra utterances within a given interval.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522788527, "post_id": 49638897, "comment_id": 86285452, "body": "Yes you can do this with VBA. Have you tried anything?"}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1522794282, "post_id": 49638986, "comment_id": 86287623, "body": "When running this the value does increase but so does the cell #. Need the value to increase by 1 in the same cell on each sheet"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1522825916, "post_id": 49638986, "comment_id": 86297626, "body": "You said in your question &quot;Would want second worksheet to have a value of 91 on <b>B2</b> and so on&quot;. Remove the offset bit if not."}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 1, "creation_date": 1522849341, "post_id": 49638986, "comment_id": 86313557, "body": "Thanks for your help"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1522788776, "creation_date": 1522788776, "answer_id": 49638986, "question_id": 49638897, "link": "https://stackoverflow.com/questions/49638897/increment-value-on-multiple-worksheets/49638986#49638986", "title": "Increment value on multiple worksheets", "body": "<p>If I understand correctly, this should do what you want.</p>\n\n<pre><code>Sub x()\n\nDim i As Long, n As Long\n\nn = 90\n\nFor i = 1 To Worksheets.Count\n    Sheets(i).Range(\"B1\").Offset(i - 1).Value = n + i - 1\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1522789341, "post_id": 49639041, "comment_id": 86285810, "body": "I ran this and it incremented only the second worksheet (which is labeled 103) all the rest did not increment"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1522792176, "post_id": 49639041, "comment_id": 86286936, "body": "I tested this with a workbook with 250 sheets and it incremented correctly."}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1522793600, "post_id": 49639041, "comment_id": 86287399, "body": "It does work when i created a new workbook and ran the script you provided. It did, however, increment the cell as well. 101 has 90 in B1; 102 has 91 in B2; 103 has 92 in B3 etc. I am adding a picture to show VBA with my workbooks"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1522792171, "last_edit_date": 1522792171, "creation_date": 1522789044, "answer_id": 49639041, "question_id": 49638897, "link": "https://stackoverflow.com/questions/49638897/increment-value-on-multiple-worksheets/49639041#49639041", "title": "Increment value on multiple worksheets", "body": "<p>Another example of how to accomplish the task.  Added check for original worksheet</p>\n\n<pre><code>Sub SetWorksheetValues()\nDim ws As Worksheet\nDim firstWS As Worksheet\nDim cValue As Long\nDim counter As Long\n'set the counter to 2\ncounter = 2\n'set the first worksheet that has our beginning value\nSet firstWS = ThisWorkbook.Worksheets(\"101\")\n'get the value and increment by 1\ncValue = firstWS.Range(\"B1\").Value + 1\n    For Each ws In ThisWorkbook.Worksheets\n        'skip the worksheet with our starting value\n        If ws.Name &lt;&gt; firstWS.Name Then\n            'set the cell value\n            ws.Range(\"B\" &amp; counter).Value = cValue\n            'increment each value by 1\n            cValue = cValue + 1\n            counter = counter + 1\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>to test it</p>\n\n<p>create a workbook and add a module in it.\nrun the following macro</p>\n\n<pre><code>Sub AddLotsOfWorksheets()\nDim i As Long\nDim c As Long\nDim ws As Worksheet\nc = 101\n    For i = 1 To 250\n        Set ws = ThisWorkbook.Worksheets.Add(Before:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count))\n        ws.Name = CStr(c)\n        c = c + 1\n    Next i\nEnd Sub\n</code></pre>\n\n<p>add 1 (or 90) in B1 on sheet 101</p>\n\n<p>Run the SetWorksheetValues</p>\n\n<p>sheet 350 cell B250 should have a value of 250 if 1 was entered \nor \n339 if 90 was entered.</p>\n"}], "owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 49638986, "answer_count": 2, "score": 0, "last_activity_date": 1522849456, "creation_date": 1522788308, "last_edit_date": 1522849456, "question_id": 49638897, "link": "https://stackoverflow.com/questions/49638897/increment-value-on-multiple-worksheets", "title": "Increment value on multiple worksheets", "body": "<p>Have an excel worksheet that has several worksheets that are all labeled differently, no pattern at all (ie; Sheet1, Sheet2, Sheet3 etc)\nIn the first worksheet on cell <code>B2</code> I have a value of <code>90</code> and would like every other worksheet to auto increment value by 1.\nWould want second worksheet to have a value of <code>91</code> on <code>B2</code> and so on,,\nI know i could tediously add <code>=SUM('WorksheetName'!B2 +1)</code> to do this but would take forever as i would have to manually type the sheet name each instance\nAny way to add some VBA? or another formula?</p>\n\n<p>To help clarify, \nMy first worksheet is labeled <code>101</code> and has a value of <code>90</code> on cell B2\n<a href=\"https://i.stack.imgur.com/45jOM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/45jOM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522786414, "post_id": 49638371, "comment_id": 86284442, "body": "Step through your code and check the values returned by your function. You might want to post the code for that too. Do the cells you are pasting contain formulae?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1522787047, "post_id": 49638371, "comment_id": 86284766, "body": "You haven&#39;t assigned a value to <code>DstLastRow</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522787340, "post_id": 49638371, "comment_id": 86284912, "body": "@chrisneilsen- uninitialised it will be zero so doesn&#39;t matter."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1522809159, "post_id": 49638371, "comment_id": 86291240, "body": "This seems to be a duplicate question, <a href=\"https://stackoverflow.com/questions/18854432/copy-all-worksheets-into-one-sheet?rq=1\">SO Question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522788647, "post_id": 49638516, "comment_id": 86285491, "body": "Adding in the LastOccupiedRowNum lines did not work when tested. Thus I subbed that out for a set number of 28 as each sheet had data up till Column AB."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522790021, "post_id": 49638516, "comment_id": 86286108, "body": "Your problem was getting the last row and this function gives you the last row, of course, you can include this in the main sub but it is not recommended. I am sure I could get this work, but since others answered and you are happy then  I would not work more on it"}, {"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522790526, "post_id": 49638516, "comment_id": 86286350, "body": "I think I was treating the previous script in an universal fashion which ended up to working the way I thought it would. Thanks for taking a look at this!"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1522786826, "creation_date": 1522786826, "answer_id": 49638516, "question_id": 49638371, "link": "https://stackoverflow.com/questions/49638371/i-am-looking-to-combine-multiple-sheets-into-a-single-consolidated-sheet/49638516#49638516", "title": "I am looking to combine multiple sheets into a single consolidated sheet", "body": "<p>You have copied this from somewhere else and you have forgotten to copy the function that gets the last row of a worksheet, namely this one <code>LastOccupiedRowNum</code></p>\n\n<p>So add this function to the same module and the code should work. Please don't forget to mark this as the right answer if it did work:</p>\n\n<pre><code>Function LastOccupiedRowNum(Optional sh As Worksheet, Optional colNumber As Long = 1) As Long\n    'Finds the last row in a particular column which has a value in it\n    If sh Is Nothing Then\n        Set sh = ActiveSheet\n    End If\n    LastOccupiedRowNum= sh.Cells(sh.Rows.Count, colNumber).End(xlUp).row\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522787279, "post_id": 49638603, "comment_id": 86284885, "body": "PS: I assumed that column A is contiguous in all sheets."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1522849348, "last_edit_date": 1522849348, "creation_date": 1522787197, "answer_id": 49638603, "question_id": 49638371, "link": "https://stackoverflow.com/questions/49638371/i-am-looking-to-combine-multiple-sheets-into-a-single-consolidated-sheet/49638603#49638603", "title": "I am looking to combine multiple sheets into a single consolidated sheet", "body": "<p>Try finding the last row dynamically, rather than using .cells</p>\n\n<pre><code>Dim lrSrc as Long, lrDst as Long, i as Long\nFor i = 1 to Sheets.Count\n    If Not Sheets(i).Name = \"Destination\" Then\n        lrSrc = Sheets(i).Cells( Sheets(i).Rows.Count,\"A\").End(xlUp).Row\n        lrDst = Sheets(\"Destination\").Cells( Sheets(\"Destination\").Rows.Count, \"A\").End(xlUp).Row\n        With Sheets(i)\n            .Range(.Cells(2,\"A\"), .Cells(lrSrc,\"AB\")).Copy Sheets(\"Destination\").Range(Sheets(\"Destination\").Cells(lrDst+1,\"A\"),Sheets(\"Destination\").Cells(lrDst+1+lrSrc,\"AB\"))\n        End With\n    End If\n Next i\n</code></pre>\n\n<p>This should replace your sub and the related function.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522790336, "post_id": 49638766, "comment_id": 86286249, "body": "Spoke to soon. It seems I have some blanks that are not being copied over. I noticed if I place some characters in the cell it works fine."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522790609, "post_id": 49638766, "comment_id": 86286379, "body": "What exactly do you mean &quot;some blanks&quot;? Where?"}, {"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522790809, "post_id": 49638766, "comment_id": 86286461, "body": "There is a notes section in Column A for each sheet the first sheet the notes have not been entered yet thus leave around 84 rows blank. If I type something into that row and run the script it pulls it over if I dont it seems to leave it out."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522791064, "post_id": 49638766, "comment_id": 86286550, "body": "If you have 20 rows of data in column A then 20 rows will be copied across to the master sheet, even if you have blank rows in the middle. Are you saying that you have rows with no data in column A but data in other columns? If so, this relates to the comment I made above."}, {"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522791250, "post_id": 49638766, "comment_id": 86286617, "body": "Ah I see - I might just end up rearranging the columns then so that Column A is my main identifier. Thank you"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522791611, "post_id": 49638766, "comment_id": 86286730, "body": "You could do that or the code could be amended if you like?"}, {"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1522847937, "post_id": 49638766, "comment_id": 86312408, "body": "I think it will be okay to just rearrange the columns so that column A contains consistent data."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522787780, "creation_date": 1522787780, "answer_id": 49638766, "question_id": 49638371, "link": "https://stackoverflow.com/questions/49638371/i-am-looking-to-combine-multiple-sheets-into-a-single-consolidated-sheet/49638766#49638766", "title": "I am looking to combine multiple sheets into a single consolidated sheet", "body": "<p>Throwing another method into the mix. This does assume that the data you are copying has as many rows in column A as it does in any other column. It doesn't require your function.</p>\n\n<pre><code>Sub CombineData()\n\nDim wkstDst As Worksheet\nDim wkstSrc As Worksheet\nDim rngSrc As Range\n\nSet wkstDst = ThisWorkbook.Worksheets(\"Master\")\n\nFor Each wkstSrc In ThisWorkbook.Worksheets\n   If wkstSrc.Name &lt;&gt; \"Master\" Then\n        With wkstSrc\n            Set rngSrc = .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 28)\n            rngSrc.Copy Destination:=wkstDst.Cells(Rows.Count, 1).End(xlUp)(2)\n        End With\n    End If\nNext wkstSrc\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "accepted_answer_id": 49638766, "answer_count": 3, "score": 2, "last_activity_date": 1522849348, "creation_date": 1522786254, "last_edit_date": 1531164843, "question_id": 49638371, "link": "https://stackoverflow.com/questions/49638371/i-am-looking-to-combine-multiple-sheets-into-a-single-consolidated-sheet", "title": "I am looking to combine multiple sheets into a single consolidated sheet", "body": "<p>Would like to create a Macro to loop through all of the sheets in the workbook and select all the data from each worksheet and then paste said data into a single consolidate table on the \"Master\" sheet. All sheets have the same column heading to Column \"AB\".</p>\n\n<p>Currently tried using this code but I have been unable to get anything to paste over onto the Master worksheet. Might be overthinking setting the range each tab. </p>\n\n<p>Just looking for a simple solution to copy all active data from each sheet and paste it into one sheet so that is its all consolidated.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub CombineData()\nDim wkstDst As Worksheet\nDim wkstSrc As Worksheet\nDim WB As Workbook\nDim rngDst As Range\nDim rngSrc As Range\nDim DstLastRow As Long\nDim SrcLastRow As Long\n\n'Refrences\nSet wkstDst = ActiveWorkbook.Worksheets(\"Master\")\n\n\n'Setting Destination Range\nSet rngDst = wkstDst.Cells(DstLastRow + 1, 1)\n\n'Loop through all sheets exclude Master\nFor Each wkstSrc In ThisWorkbook.Worksheets\n   If wkstSrc.Name &lt;&gt; \"Master\" Then\n\n        SrcLastRow = LastOccupiedRowNum(wkstSrc)\n        With wkstSrc\n            Set rngSrc = .Range(.Cells(2, 1), .Cells(SrcLastRow, 28))\n            rngSrc.Copy Destination:=rngDst\n        End With\n\n        DstLastRow = LastOccupiedRowNum(wkstDst)\n        Set rngDst = wkstDst.Cells(DstLastRow + 1, 1)\n\n    End If\n\n Next wkstSrc\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 1, "creation_date": 1522786755, "post_id": 49638325, "comment_id": 86284621, "body": "We are going to need a little more detail. Expand on your question based on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8375053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XvPPT.jpg?s=128&g=1", "display_name": "Bertrand Leroy", "link": "https://stackoverflow.com/users/8375053/bertrand-leroy"}, "is_accepted": true, "score": 1, "last_activity_date": 1522786506, "creation_date": 1522786506, "answer_id": 49638434, "question_id": 49638325, "link": "https://stackoverflow.com/questions/49638325/vlookup-to-display-only-when-button-is-clicked-and-clear-when-a-new-word-is-sele/49638434#49638434", "title": "Vlookup to display only when button is clicked and clear when a new word is selected", "body": "<p>Simply set the value of the cell to empty when you click the first button?</p>\n\n<pre><code>Sub Word()\nRange(\"J3\").ClearContents\n' or Range(\"J3\")=\"\"\n\n' then your code to fetch the new word to show\n\n End Sub\n</code></pre>\n\n<p>HTH,</p>\n\n<p>B</p>\n"}], "owner": {"reputation": 35, "user_id": 9583682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b3da6e213694a896545fb06f96f6d1?s=128&d=identicon&r=PG&f=1", "display_name": "AC130", "link": "https://stackoverflow.com/users/9583682/ac130"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 49638434, "answer_count": 1, "score": 0, "last_activity_date": 1591737111, "creation_date": 1522786067, "last_edit_date": 1591737111, "question_id": 49638325, "link": "https://stackoverflow.com/questions/49638325/vlookup-to-display-only-when-button-is-clicked-and-clear-when-a-new-word-is-sele", "title": "Vlookup to display only when button is clicked and clear when a new word is selected", "body": "<p>I have a button coded that will randomly select a word from a list. I have another button that uses the vlookup function to show the definition of the random word selected. When I hit new word it selects a word and automatically displays the definition before the definition button is clicked.</p>\n\n<p>How can I get the definition button (vlookup coding) to only show the definition when the button is clicked?</p>\n\n<pre><code> Sub Definition3()\nRange(\"J3\") = \"=VLookup(B2, Sheet1!A:B, 2, False)\"\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1522785327, "post_id": 49638137, "comment_id": 86283969, "body": "You have <code>Column(t.Column).Copy</code>.  There&#39;s no worksheet given, so it&#39;s using whatever the activesheet is.  You want to do something like <code>Ws.Column(t.Column).Copy</code>.  Similarly, when you paste to just <code>Sheets(ts)</code>, there&#39;s no workbook mentioned, so you need to make sure to add the new workbook&#39;s reference first, i.e. <code>wb.Sheets(ts)...</code>"}, {"owner": {"reputation": 155, "user_id": 8820772, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-cMIw8NBJMRQ/AAAAAAAAAAI/AAAAAAAAAG4/j7iWHDN-E2o/photo.jpg?sz=128", "display_name": "Nimy Alex", "link": "https://stackoverflow.com/users/8820772/nimy-alex"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522787101, "post_id": 49638137, "comment_id": 86284790, "body": "@BruceWayne : That worked! thank you...Can you put it as the solution, so that I can mark it."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1522788282, "creation_date": 1522788282, "answer_id": 49638885, "question_id": 49638137, "link": "https://stackoverflow.com/questions/49638137/copy-specific-columns-from-an-inactive-sheet-to-one-excel-sheet-using-vba/49638885#49638885", "title": "Copy specific columns from an inactive sheet to one excel sheet using vba", "body": "<p>Always remember to qualify any <code>Range()</code> object with it's Worksheet and/or Workbook.  As noted in the comments:</p>\n\n<p>You have <code>Column(t.Column).Copy</code>. There's no worksheet given, so it's using whatever the activesheet is. </p>\n\n<p>You want to do something like <code>Ws.Column(t.Column).Copy</code>. </p>\n\n<p>Similarly, when you paste to just <code>Sheets(ts)</code>, there's no workbook mentioned, so you need to make sure to add the new workbook's reference first, i.e. <code>wb.Sheets(ts)...</code> </p>\n"}], "owner": {"reputation": 155, "user_id": 8820772, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-cMIw8NBJMRQ/AAAAAAAAAAI/AAAAAAAAAG4/j7iWHDN-E2o/photo.jpg?sz=128", "display_name": "Nimy Alex", "link": "https://stackoverflow.com/users/8820772/nimy-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 49638885, "answer_count": 1, "score": 0, "last_activity_date": 1522788282, "creation_date": 1522785231, "question_id": 49638137, "link": "https://stackoverflow.com/questions/49638137/copy-specific-columns-from-an-inactive-sheet-to-one-excel-sheet-using-vba", "title": "Copy specific columns from an inactive sheet to one excel sheet using vba", "body": "<p>My excel workbook has the following sheets:</p>\n\n<ol>\n<li><strong>Overview</strong> - Consists of description and a button that should export data about students in an organisation.</li>\n<li><strong>Sep Intake</strong> - Student details who were admitted in September</li>\n<li><strong>Jan Intake</strong> - Student details who were admitted in January</li>\n<li><strong>May Intake</strong> - Students who were admitted in May</li>\n</ol>\n\n<p>Sheet #2, #3 and #4 consists of all the academic and personal information together. The objective is to just copy and create an excel with only columns Name, Student Id and Term in it.\nFor this, there is a button that is placed in sheet \"<strong>Overview</strong>\", when clicked produces the excel sheet.</p>\n\n<p>The following is my code that I use for my macro:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim t As Range\nDim Ws1 As Worksheet\nDim Ws As Worksheet\nDim ts As String\nDim nc As Integer\nDim i As Range\nDim j As Integer\nDim LASTROW As Integer\nDim k As Integer\nDim wb As Workbook\nDim valuessheet As Worksheet\n\nSet Ws1 = Sheets(CStr(ActiveSheet.Range(\"D3\").Value)) 'change control from Overview to Jan Intake\nWs1.Activate\nSet Ws = ActiveSheet\nSet valuesheet = ThisWorkbook.Sheets(\"Ref\") 'Ref is a hidden sheet that consists the required column name listed in range K3 to K5\n\nSet wb = Workbooks.Add\nts = wb.ActiveSheet.Name\nnc = 2\nj = 3\n\nFor Each i In valuesheet.Range(\"K3:K5\").Cells 'Change range\n    Set t = Ws.Range(\"A3:X50\").Find(What:=i.Value, lookat:=xlWhole, LookIn:=xlValues, _\n                MatchCase:=False)\n    If Not t Is Nothing Then\n    Columns(t.Column).Copy _\n      Destination:=Sheets(ts).Cells(1, nc)\n      nc = nc + 1\n   Else:    MsgBox \"Title Not Found\"\n   End If\nNext i    \nEnd Sub\n</code></pre>\n\n<p>I am getting the value of <strong>t</strong> correctly, but the macro keeps copying the columns of sheet <strong>Overview</strong> to the new workbook.\nHow do I rectify that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522785580, "post_id": 49638131, "comment_id": 86284070, "body": "If you want to use the third sheet, no matter the name, you can use <code>Workbooks(&quot;Fruits.xlsm&quot;).Sheets(3).Range(&quot;A1&quot;)...</code> which will do something with <code>A1</code> from the third (via index) worksheet.  So if you look at the worksheet tabs, from left to right, it will choose the third one."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1522787206, "post_id": 49638131, "comment_id": 86284833, "body": "But the sheet called &quot;Sheet 3&quot; may not be the third sheet ...."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9593146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b027c61a60b92e7a6cc52d402974c851?s=128&d=identicon&r=PG&f=1", "display_name": "blair b", "link": "https://stackoverflow.com/users/9593146/blair-b"}, "edited": false, "score": 1, "creation_date": 1523463580, "post_id": 49638753, "comment_id": 86575421, "body": "I&#39;m getting an runtime error 424, but I dont see any incorrect implementation of workbook name and dimensioned indexOfSheet3 as Long. Any other tips?"}, {"owner": {"reputation": 13, "user_id": 9593146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b027c61a60b92e7a6cc52d402974c851?s=128&d=identicon&r=PG&f=1", "display_name": "blair b", "link": "https://stackoverflow.com/users/9593146/blair-b"}, "edited": false, "score": 1, "creation_date": 1523464834, "post_id": 49638753, "comment_id": 86576200, "body": "Nevermind got it! Just a correction:wbSource.Sheets(i).Copy After line"}], "tags": [], "owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "is_accepted": true, "score": 2, "last_activity_date": 1523490411, "last_edit_date": 1523490411, "creation_date": 1522787724, "answer_id": 49638753, "question_id": 49638131, "link": "https://stackoverflow.com/questions/49638131/copy-worksheets-after-a-specific-worksheet/49638753#49638753", "title": "Copy worksheets after a specific worksheet", "body": "<pre><code>Dim wb As Workbook\nSet wb = Workbooks(\"Fruits.xlsm\")\nDim ws As Worksheet\n\nSet ws = wb.Sheets(wb.Sheets(\"Sheet 3\").Index +1)\nws.Copy\n</code></pre>\n\n<p>Note:</p>\n\n<p>Defining the Workbook you are operating in is always a good Idea. Next lets take a closer look at Worksheet Objects.</p>\n\n<p>With <code>Workbook.Sheets(index/name)</code> you can access a worksheet at a certain position = index e.g <code>1 for the first sheet in the workbook</code> or by its name.</p>\n\n<p>Now you are looking for a sheet next to a sheet of which you know the name.</p>\n\n<p><code>wb.Sheets(\"Sheet 3\").Index</code> returns the position of <code>Sheet 3</code>. Now you want the sheet to its right. This will be at the position <code>wb.Sheets(\"Sheet 3).Index +1</code>.</p>\n\n<p>EDIT:</p>\n\n<p>I think the question has been edited to copy \"all sheets following 'Sheet 3'\"</p>\n\n<p>The code for this:</p>\n\n<pre><code>Dim wbSource As Workbook\nDim wbTarget As Workbook\nSet wbSource = Workbooks(\"Fruits.xlsm\")\nDim ws As Worksheet\nSet wbTarget = Workbooks.Add\n\nindexOfSheet3 = wbSource.Sheets(\"Sheet 3\").Index\n\nFor i = indexOfSheet3 + 1 To wbSource.Sheets.Count\n    wbSource.Sheets(i).Copy After:= wbTarget.Sheets(wbTarget.Sheets.Count)\nNext i\n\n'Delete the defualt sheet\nApplication.DisplayAlerts = False\nwbTarget.Sheets(1).Delete\nApplication.DisplayAlerts = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1522789108, "post_id": 49638801, "comment_id": 86285699, "body": "This only works, if &quot;Sheet 3&quot; is also at index 3 in the Workbook, which is most of the time a reasonable assumption, but not stated in the question, so I would state that in your answer."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522787920, "creation_date": 1522787920, "answer_id": 49638801, "question_id": 49638131, "link": "https://stackoverflow.com/questions/49638131/copy-worksheets-after-a-specific-worksheet/49638801#49638801", "title": "Copy worksheets after a specific worksheet", "body": "<p>I\u2019d go the opposite way: copy all worksheets to a new workbook and delete its first three ones:</p>\n\n<pre><code>Workbooks(\"Fruits.xlsm\").Worksheets.Copy\n\nDim i As Long\nApplication.DisplayAlerts = False\nFor i = 3 To 1 Step - 1\n    Worksheets(i).Delete\nNext\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9593146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b027c61a60b92e7a6cc52d402974c851?s=128&d=identicon&r=PG&f=1", "display_name": "blair b", "link": "https://stackoverflow.com/users/9593146/blair-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 49638753, "answer_count": 2, "score": 0, "last_activity_date": 1523490411, "creation_date": 1522785211, "question_id": 49638131, "link": "https://stackoverflow.com/questions/49638131/copy-worksheets-after-a-specific-worksheet", "title": "Copy worksheets after a specific worksheet", "body": "<p>I have a workbook that has a dynamic number of worksheets within it. The relevant worksheets I want to extract always occur after the worksheet \"Sheet 3\". The problem is the relevant worksheets have dynamic names e.g. \"Apple-A\", \"Orange-1\", etc. and I wanted to create a code that will always copy every sheet after \"Sheet 3\" regardless of their naming convention.</p>\n\n<p>To this point I have only been able to copy sheets when specifically calling its name e.g. </p>\n\n<pre><code>total = Workbooks(\"Fruits.xlsm\").Worksheets.Count\nWorkbooks(\"Fruits\").Worksheets(\"Apple-A\").Copy_after:=Workbooks(\"Fruits.xlsm\").Worksheets(total)\n</code></pre>\n\n<p>Is there a method for copying a number of sheets to a new workbook after a certain worksheet name is called?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1522785201, "post_id": 49638122, "comment_id": 86283899, "body": "Then loop through columns? What have you tried so far? This is relatively easy considering it looks like you have done most of the &#39;heavy lifting&#39;."}, {"owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522785855, "post_id": 49638122, "comment_id": 86284196, "body": "Hello Bruce, I only googled for the most suitable code. I tried: change col = activecell.column&#39; - deleted or - deleted col = .range(&quot;A:J&quot;).column - adjusted  But with no success. I am not a very advanced user, so I probably cannot do anything more."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "edited": false, "score": 0, "creation_date": 1522788679, "post_id": 49638458, "comment_id": 86285508, "body": "Hello, I always get: &quot;runtime error 438. Object does not support this property or method.&quot; Should I adjust something?"}, {"owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "edited": false, "score": 0, "creation_date": 1522791243, "post_id": 49638458, "comment_id": 86286616, "body": "Yes I tried, but unfortunately it did not work at all. I was given only zeros everywhere and crosses in the rest of the spreadsheet. :)"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1522789978, "last_edit_date": 1522789978, "creation_date": 1522786591, "answer_id": 49638458, "question_id": 49638122, "link": "https://stackoverflow.com/questions/49638122/filling-a-row-with-values-above/49638458#49638458", "title": "Filling a row with values above", "body": "<p>Try this:</p>\n\n<pre><code>Sub FillColBlanks()\n    With ActiveSheet.UsedRange\n        If WorksheetFunction.CountBlank(.Cells) &gt; 0 Then\n            With .SpecialCells(xlCellTypeBlanks)\n                .FormulaR1C1 = \"=R[-1]C\"\n                .Value = .Value\n            End With\n        End If\n    End With\nEnd Sub   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "edited": false, "score": 0, "creation_date": 1522790130, "post_id": 49638510, "comment_id": 86286160, "body": "Hello Bruce, this macro runs quite slow, is there a possibility to adjust it? Moreover, sometimes I get only zeros in my columns."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "edited": false, "score": 0, "creation_date": 1522790204, "post_id": 49638510, "comment_id": 86286191, "body": "Can you post some sample data? Also, try changing <code>rng.EntireColumn...</code> to just <code>rng.Value = rng.Value</code> as it won&#39;t have to run over the entire column.  Also, add <code>Application.Screenupdating = False</code> at the top, then turn it to <code>True</code> at the end."}, {"owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "edited": false, "score": 0, "creation_date": 1522791625, "post_id": 49638510, "comment_id": 86286737, "body": "I only changed the part with rng.Value and now it works immediately. Thanks!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1522786804, "creation_date": 1522786804, "answer_id": 49638510, "question_id": 49638122, "link": "https://stackoverflow.com/questions/49638122/filling-a-row-with-values-above/49638510#49638510", "title": "Filling a row with values above", "body": "<p>This will loop through column A to J (<code>For i = 1 to 10</code> in the code).  You can adjust as necessary.</p>\n\n<pre><code>Sub FillColBlanks()\n'by Dave Peterson  2004-01-06\n'fill blank cells in column with value above\n'http://www.contextures.com/xlDataEntry02.html\nDim wks     As Worksheet\nDim rng     As Range\nDim emptyRng As Range\nDim i       As Long\n\nSet wks = ActiveSheet\n\nWith wks\n    For i = 1 To 10\n        Set rng = .Range(.Cells(1, i), .Cells(.Cells(Rows.Count, i).End(xlUp).Row, i))\n        On Error Resume Next\n        Set emptyRng = rng.SpecialCells(xlCellTypeBlanks)\n        On Error GoTo 0\n        If emptyRng Is Nothing Then    ' If we have empty cells, do the following\n            MsgBox (\"No blanks found\")\n            'Exit Sub ' Commented this out because you want to keep looping through columns, not exit sub.\n        Else\n            emptyRng.FormulaR1C1 = \"=R[-1]C\"\n            rng.EntireColumn.Value = rng.EntireColumn.Value\n        End If\n    Next i\nEnd With                     'wks\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9220962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef62ce18b0d20fc7716942ac388f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jeame", "link": "https://stackoverflow.com/users/9220962/jeame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 49638510, "answer_count": 2, "score": 0, "last_activity_date": 1522789978, "creation_date": 1522785171, "question_id": 49638122, "link": "https://stackoverflow.com/questions/49638122/filling-a-row-with-values-above", "title": "Filling a row with values above", "body": "<p>this macro is for filling empty rows with values from the row above. I would need to adjust it, so that all the columns are being filled and not only B column. Thanks!</p>\n\n<pre><code>Sub FillColBlanks()\n'by Dave Peterson  2004-01-06\n'fill blank cells in column with value above\n'http://www.contextures.com/xlDataEntry02.html\nDim wks As Worksheet\nDim rng As Range\nDim LastRow As Long\nDim col As Long\n\nSet wks = ActiveSheet\nWith wks\ncol = activecell.column\n'or\n'col = .range(\"b1\").column\n\nSet rng = .UsedRange  'try to reset the lastcell\nLastRow = .Cells.SpecialCells(xlCellTypeLastCell).Row\nSet rng = Nothing\nOn Error Resume Next\nSet rng = .Range(.Cells(2, col), .Cells(LastRow, col)) _\n              .Cells.SpecialCells(xlCellTypeBlanks)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n   MsgBox \"No blanks found\"\n   Exit Sub\nElse\n   rng.FormulaR1C1 = \"=R[-1]C\"\nEnd If\n\n'replace formulas with values\n With .Cells(1, col).EntireColumn\n   .Value = .Value\nEnd With\n\nEnd With\n\nEnd Sub   \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1522784600, "creation_date": 1522784600, "answer_id": 49637985, "question_id": 49637657, "link": "https://stackoverflow.com/questions/49637657/merging-cells-automatically-in-excel/49637985#49637985", "title": "Merging Cells automatically in Excel", "body": "<p>The following should work - assuming no funkyness in the data or layout.</p>\n\n<pre><code>Sub insert_rows()\nDim lastRow As Long\nlastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\nDim tmpRng As Range\n\nSet tmpRng = Range(\"B\" &amp; lastRow)\n\nDim rowsToAdd As Long, i As Long\nrowsToAdd = 3\n\nDo While tmpRng.Rows(1).Row &gt;= 2\n    With tmpRng.Rows(2)\n        For i = 1 To rowsToAdd\n            .Insert shift:=xlDown, copyorigin:=xlFormatFromLeftOrAbove\n        Next i\n    End With\n    Set tmpRng = tmpRng.End(xlUp)\nLoop\nEnd Sub\n</code></pre>\n\n<p>Note it's inserting a row within column B. If you want an entire row inserted, then change the line to <code>With tmpRng.rows(2).EntireRow</code></p>\n"}], "owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49637985, "answer_count": 1, "score": -2, "last_activity_date": 1522784600, "creation_date": 1522783258, "last_edit_date": 1531161705, "question_id": 49637657, "link": "https://stackoverflow.com/questions/49637657/merging-cells-automatically-in-excel", "title": "Merging Cells automatically in Excel", "body": "<p>I have a worksheet where I'm checking column \"B\". In COlumn \"B\" starting from the 2nd row I have merged cells in this way, B2 is merged with B3, B4 is merged with B5 and B6 is merged with B7, etc...Is it possible to create a VBA loop in excel what will expand the mergings? I would like to have 5 merged cells in Column B, so this loop should insert 3 cells between B2 and B3, between B4 and B5 and etc... Is it possible? and how?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "export"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522783302, "post_id": 49637461, "comment_id": 86282995, "body": "I&#39;m not too good with SQL but maybe you need to pass the variable&#39;s reference instead of the literal string? <code>strSql = &quot;INSERT INTO Data (Food, Drinks, Color) VALUES (&quot; &amp; Foodrng &amp; &quot;, &quot; &amp; Drinksrng &amp; &quot;, &quot; &amp; Colorrng &amp; &quot;)&quot;</code>  (You may also try <code>Foodrng.Address</code> if it doesn&#39;t work)"}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1522786105, "post_id": 49637955, "comment_id": 86284300, "body": "@Parfait Nope, that doesn&#39;t work and that&#39;s why the code comment <i>Adjust ranges to select single cells</i>. The proper way is to use a recordset and iterate through the cells. Or even better: import from Access instead of exporting from Excel. That way, you can customize more easily."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1522786514, "post_id": 49637955, "comment_id": 86284488, "body": "@Parfait I guess that&#39;s true. Added clarification."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522846027, "post_id": 49637955, "comment_id": 86310977, "body": "Compile error: User defined type not defined.   This happenes on the first AND second cmd variable"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522846194, "post_id": 49637955, "comment_id": 86311098, "body": "Set a reference to ADO (Microsoft ActiveX Data Objects) if you want to use ADO. Doing this all with late bindings is unnecesarily hard."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522846710, "post_id": 49637955, "comment_id": 86311473, "body": "I will have multiple users with different versions of access (Therefore different library versions).  Wont using early binding cause unwanted issues?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522846951, "post_id": 49637955, "comment_id": 86311644, "body": "Usually, no. Multiple versions of ADO get installed with Access to avoid compatibility issues. But feel free to convert it yourself to late bindings. Be aware that you need to convert all those enums too."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522847358, "post_id": 49637955, "comment_id": 86311925, "body": "Ok, thank you for your help.  When adding in ADO reference, I now get a run-time error &#39;424&#39; (object required) on the .parameters.append line."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522847456, "post_id": 49637955, "comment_id": 86312001, "body": "What values correspond to where the &quot;?, ?, ?&quot;  are in the strSql string?  I am under the impression they are the access table rows?   The eddited version works now until the .exectue line (Syntax error in INSERT INTO statement).  I am assuming it has to do with what I stated above?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522847915, "post_id": 49637955, "comment_id": 86312397, "body": "They&#39;re markers that get replaced by the parameters when you execute the query."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522848249, "post_id": 49637955, "comment_id": 86312677, "body": "Ok, so they should be left as &quot;?&quot;.  Any idea why the edited version errors on the .execute line (Syntax error in INSERT INTO statement)?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522848379, "post_id": 49637955, "comment_id": 86312792, "body": "One of your field names or your table name is likely a keyword. Try the current edit."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522848792, "post_id": 49637955, "comment_id": 86313110, "body": "That was it!  Huge thank you, I really appreciate it."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522850163, "post_id": 49637955, "comment_id": 86314251, "body": "If one of my cells does not contain a value, then I receive parameter ?_7 has no default value.  Where 7 is the 7th &quot;?&quot; being filled in.   Is there a way for access to accept blank values?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522850558, "post_id": 49637955, "comment_id": 86314586, "body": "You can use <code>adEmpty</code> instead of <code>adVarWChar</code> to specify that a parameter doesn&#39;t contain a value"}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522851616, "post_id": 49637955, "comment_id": 86315427, "body": "<code>adEmpty</code> doesn&#39;t seem to be working,  Is there an ADO data type that accepts values no matter what?  The values of cells I am submitting are not always integers, there sometimes text, and sometimes blank.  For example, cell &quot;A1&quot; may start as an integer, then the next time around it will be blank."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1522851713, "post_id": 49637955, "comment_id": 86315507, "body": "You should use the appropriate type for the field in Access. There&#39;s no field that can accept all that in Access."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1522848313, "last_edit_date": 1522848313, "creation_date": 1522784441, "answer_id": 49637955, "question_id": 49637461, "link": "https://stackoverflow.com/questions/49637461/export-data-to-access-from-excel-vba/49637955#49637955", "title": "Export data to Access from Excel VBA", "body": "<p>When inserting using queries, you need to pass values using parameters. I highly recommend using recordsets over insert queries.</p>\n\n<p>A normal insert query can only insert one row at a time. You will need to adjust the code to insert one row at a time. You can either use a recordset, or execute a query for each row.</p>\n\n<pre><code>Foodrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"D6\") 'Adjust ranges to select single cells\nDrinksrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"E6\")\nColorrng= Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"B12:B21\")\n\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source= C:\\Users\\User1\\MyDBase.accdb\"\ncn.Open strConnection\n\nstrSql = \"INSERT INTO [Data] ([Food], [Drinks], [Color]) VALUES (?, ?, ?)\"\nDim cmd As ADODB.Command\nSet cmd = New ADODB.Command\nWith cmd\n    Set .ActiveConnection = cn\n    .CommandText = strSql\n    .Parameters.Append .CreateParameter(, adVarWChar, adParamInput, , foodRng) 'adVarWChar for text \n    .Parameters.Append .CreateParameter(, adInteger, adParamInput, , Drinksrng) 'adInteger for whole numbers (long or integer)\n    .Parameters.Append .CreateParameter(, adInteger, adParamInput, , Colorrng)\n    .Execute\nEnd With\ncn.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1530, "user_id": 227606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3ce007486db68908d145951bef649a?s=128&d=identicon&r=PG", "display_name": "Piotr Rodak", "link": "https://stackoverflow.com/users/227606/piotr-rodak"}, "is_accepted": false, "score": 0, "last_activity_date": 1541239385, "creation_date": 1541239385, "answer_id": 53130247, "question_id": 49637461, "link": "https://stackoverflow.com/questions/49637461/export-data-to-access-from-excel-vba/53130247#53130247", "title": "Export data to Access from Excel VBA", "body": "<p>There maybe also another way, or two, perhaps worth consideration.</p>\n\n<p>The first would be to set up your Excel spreadsheet as a linked table in Access - maybe it can be done with VBA. This would save you the requirement to copy the data. You might also be able to set up your target worksheet and use insert..select directly from ADODB to insert the data into Excel from Access.</p>\n\n<p>The second, would be to completely avoid Access altogether if your requirements allow for this. Excel can be used as a database to some extent and supports SQL querying.\n<a href=\"https://selectcompare.com/blogs/news/write-select-statements-for-excel-spreadsheets\" rel=\"nofollow noreferrer\">https://selectcompare.com/blogs/news/write-select-statements-for-excel-spreadsheets</a></p>\n"}], "owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2766, "favorite_count": 0, "accepted_answer_id": 49637955, "answer_count": 2, "score": 0, "last_activity_date": 1541239385, "creation_date": 1522782447, "last_edit_date": 1522785628, "question_id": 49637461, "link": "https://stackoverflow.com/questions/49637461/export-data-to-access-from-excel-vba", "title": "Export data to Access from Excel VBA", "body": "<p>I am brand new to access and struggling to understand how to relate access table/column/row formatting to excel exporting in VBA.</p>\n\n<p>I have created an access table called <em>Data</em> and three columns <em>Food, Drinks, Color</em>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0lSDK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0lSDK.png\" alt=\"Access Table\"></a></p>\n\n<p>I would like to export these range of cells to Access from my excel spreadsheet:</p>\n\n<pre><code>Foodrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"D6\")\nDrinksrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"E6\")\nColorrng= Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"B12:B21\")\n</code></pre>\n\n<p>Everything online says I should use this for because of my version:</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\"\n</code></pre>\n\n<p>I would like to use <code>INSERT TO</code> formatting to write to my database because I will be expanding the database columns quite a bit, and I feel this is the easiest way to keep track of which is going where.</p>\n\n<pre><code>strSql = \"INSERT INTO Data (Food, Drinks, Color) VALUES (Foodrng, Drinksrng,Colorrng)\"\n</code></pre>\n\n<p>I always get a syntax error when executing:</p>\n\n<pre><code>Set rs = cn.Execute(strSql)\n</code></pre>\n\n<p>What is the correct way to export to the Access database using the above method? Any/all information will be super helpful as I am brand new to Access</p>\n\n<p><strong>My full code:</strong></p>\n\n<pre><code>    Foodrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"D6\")\n    Drinksrng = Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"E6\")\n    Colorrng= Workbooks(xlFile).Sheets(\"ToBeExported\").Range(\"B12:B21\")\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source= C:\\Users\\User1\\MyDBase.accdb\"\n    cn.Open strConnection\n\n   strSql = \"INSERT INTO Data (Food, Drinks, Color) VALUES (Foodrng, Drinksrng,Colorrng)\"\n\n    Set rs = cn.Execute(strSql)\n    'MsgBox rs.Fields(0) &amp; \" rows in MyTable\"\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n</code></pre>\n"}]