[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501113890, "post_id": 45339239, "comment_id": 77640517, "body": "You have to use <code>Set</code> with objects, so <code>Set col1 = r.Columns(i)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1501114142, "creation_date": 1501114142, "answer_id": 45339321, "question_id": 45339239, "link": "https://stackoverflow.com/questions/45339239/working-with-columns-in-a-range-in-excel-vba/45339321#45339321", "title": "Working with columns in a range in Excel VBA", "body": "<p>You have to <code>Set</code> objects, you can't use the default <code>Let</code> with them.</p>\n\n<p>Also, as this appears to be a UDF (based on your comment \"It exits on the line <code>col1 = r.Columns(1).Select</code>\", rather than you saying that it crashes out on that line), you need to be aware that your code won't be permitted to make changes to Excel cells other than by returning a value from the function.</p>\n\n<pre><code>Function CompareAllColumns(r As Range, o As Range)\n    Dim numCols As Integer\n    Dim i As Integer\n    Dim j As Integer\n    Dim col1 As Range\n    Dim col2 As Range\n    Dim Matches As Integer\n\n    Matches = 0\n    numCols = r.Columns.Count\n    Dim ac1 As String\n    Dim ac2 As String\n    Dim a As String\n\n    a = r.Address\n\n    For i = 1 To numCols - 1\n        'use Set for an object\n        Set col1 = r.Columns(i)\n        ac1 = col1.Address\n\n        For j = i + 1 To numCols\n            'use Set for an object\n            Set col2 = r.Columns(j)\n\n            If Compare(col1, col2) Then\n                'You can't set values within a UDF\n                'o.Value = \"Columns \" &amp; i &amp; \" and \" &amp; j &amp; \" are the same\"\n                'You can't \"Select\" things within a UDF\n                'o = o.Offset(1).Select\n                Matches = Matches + 1\n            End If\n        Next\n    Next\n\n    CompareAllColumns = Matches\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1147, "user_id": 3746992, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/34aeb66c5760cba86fdb7cba621f1caa?s=128&d=identicon&r=PG&f=1", "display_name": "James Curran", "link": "https://stackoverflow.com/users/3746992/james-curran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 45339321, "answer_count": 1, "score": 0, "last_activity_date": 1501144585, "creation_date": 1501113538, "last_edit_date": 1531164843, "question_id": 45339239, "link": "https://stackoverflow.com/questions/45339239/working-with-columns-in-a-range-in-excel-vba", "title": "Working with columns in a range in Excel VBA", "body": "<p>I have a function that compares two columns and returns true or false. \nI have another function that takes a range as an input, and should do all pairwise comparisons of the columns in that range.</p>\n\n<p>However I seem to be drawing a blank at extracting (and storing) columns from a range. The function exits when I ask for the ith column. This is my code:</p>\n\n<pre><code>Function CompareAllColumns(r As Range, o As Range)\nDim numCols As Integer\nDim i As Integer\nDim j As Integer\nDim col1 As Range\nDim col2 As Range\nDim Matches As Integer\n\nMatches = 0\nnumCols = r.Columns.Count\nDim ac1 As String\nDim ac2 As String\nDim a As String\n\na = r.Address\n\nFor i = 1 To numCols - 1\n    col1 = r.Columns(i).Select\n    ac1 = col1.Address\n\n    For j = i + 1 To numCols\n        col2 = r.Columns(j).Select\n\n        If (Compare(col1, col2)) Then\n            o.Value = \"Columns \" &amp; i &amp; \" and \" &amp; j &amp; \" are the same\"\n            o = o.Offset(1).Select\n            Matches = Matches + 1\n        End If\n    Next\nNext\n\nCompareAllColumns = Matches\nEnd Function\n</code></pre>\n\n<p>It exits on the line <code>col1 = r.Columns(1).Select</code> - the <code>Select</code> is there experimentally but makes no difference to correct execution.</p>\n"}, {"tags": ["arrays", "vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1501112689, "post_id": 45339101, "comment_id": 77640244, "body": "You need to declare it as <code>Dim shets(1 To 4) as Worksheet</code> (I assume it is a <code>Worksheet</code> that you are using and not a <code>Chart</code> - if you aren&#39;t sure, use <code>Dim shets(1 To 4) As Sheet</code> - but definitely not <code>As Sheets</code>)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501112828, "post_id": 45339101, "comment_id": 77640277, "body": "If you want to dimension it to have <code>sheetCount</code> positions, use <code>Dim shets() As Worksheet</code> and then, after determining the value of <code>sheetCount</code> ,use  <code>ReDim shets(1 To sheetCount) As Worksheet</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1501113183, "post_id": 45339101, "comment_id": 77640346, "body": "FWIW - <code>alpha(j)</code> can be replaced by <code>j</code> and, similarly, <code>alpha(j + newShift)</code> can be replaced by <code>j + newShift</code>.  And you have an object (<code>ThisWorksheet</code>) which you have never declared or set.  And <code>Sheet1.Activate</code> <code>Sheet2.Activate</code> <code>Sheet3.Activate</code> <code>Sheet4.Activate</code> can be replaced by just <code>Sheet4.Activate</code>, and even that is probably not required."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501164657, "post_id": 45345915, "comment_id": 77667866, "body": "I was having great difficulty with correcting the issues aside from my actual question once they were brought to my attention, so thank you for fixing those up.  But I am still error 9 on ReDim shets(1 To nSheets)"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501164901, "post_id": 45345915, "comment_id": 77668062, "body": "Ah that was a typo by me, a variable name I should have changed. I have updated my code, just change <code>nSheets</code> (which doesn&#39;t exist) to <code>sheetCount</code>! Consider marking this answer as accepted if it helped you out :)"}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501167168, "post_id": 45345915, "comment_id": 77669953, "body": "As soon as the code is fully functional I will absolutely accept it, however I am still running into error 9 as well as an error on WorksheetsSheet.  Could you explain what WorksheetsSheet is and maybe why I am getting this error 9?"}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501169610, "post_id": 45345915, "comment_id": 77671743, "body": "WorksheetsSheet is in the Dim statement at the top, its the first actual line of code.  And error 9 is the subscript out of range error, my bad on that.  Thanks again for your continued help on this"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501169701, "post_id": 45345915, "comment_id": 77671805, "body": "Apologies, another typo and me being blind enough to miss it even after you pointed it out! I&#39;ve corrected my code, should just be an array of <code>WorkSheet</code> objects. Are you then still getting the error? If so which line?"}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501170724, "post_id": 45345915, "comment_id": 77672487, "body": "I thought that might have been the issue, but I still get the subscript out of range error on  Set shets(n) = ThisWorkbook.Sheets(&quot;Sheet&quot; &amp; n)"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501170883, "post_id": 45345915, "comment_id": 77672607, "body": "Do you actually have a sheet called &quot;Sheet1&quot; or &quot;Sheet2&quot; or ... ? Insert a breakpoint on that line, and look at the value of <code>n</code> just before it breaks, check you have a sheet called &quot;Sheet[n]&quot; (where [n] is actually the value of <code>n</code>). You can replace that <code>for</code> loop with your previous manual assignment if it&#39;s clearer for you. If you actually want to use the 1st, 2nd, 3rd and 4th sheets then just use <code>Set shets(n) = ThisWorkbook.Sheets(n)</code> (again, assuming <code>n</code> in within the range of actually existing sheets)"}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501171283, "post_id": 45345915, "comment_id": 77672876, "body": "oh my god... my sheet names were dates, this fixed it, I&#39;m getting the text in the wrong boxes but I can fix that easily.  My only question now would be: can I still name the sheets with dates and reference them some other way?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "edited": false, "score": 0, "creation_date": 1501172277, "post_id": 45345915, "comment_id": 77673580, "body": "Ah nailed it! Yes, as I mention if they are <i>always</i> sheets <code>1</code> to <code>sheetCount</code> (or offset, but consecutive) then use the sheet number instead of name <code>Set shets(n) = ThisWorkbook.Sheets(n)</code>... If they aren&#39;t and you want to use the names then just manually use the names like you did in your original code. If it&#39;s anything more complicated then maybe ask another question here or work out your own neat way to pick up their names :)"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 0, "last_activity_date": 1501169663, "last_edit_date": 1501169663, "creation_date": 1501145791, "answer_id": 45345915, "question_id": 45339101, "link": "https://stackoverflow.com/questions/45339101/declaring-and-initializing-a-dynamic-array-of-sheets-in-vba/45345915#45345915", "title": "Declaring and initializing a dynamic array of sheets in VBA", "body": "<p>There were quite a few questionable bits of code in what you posted above. I have gone through and re-written the offending lines, and included comments justifying why in the below code.</p>\n\n<p>Not only should this fix your \"out of range\" error (because you didn't declare the size of your array) but it will fix the other errors you were yet to encounter (not declaring variable values, looping through every row in each worksheet, not referencing sheet objects properly, ...).</p>\n\n<pre><code>Sub news()\n    ' No need to activate sheets\n    ' No need for array of letters for the columns: '.Cells(row,col)' can take a number for 'col'\n    ' Integers replaced by Longs, no real incentive to use Integer type and Long can be larger\n\n    ' Array of sheets: use WorkSheet objects, not a Sheets object \n    Dim shets() As WorkSheet\n    ' Remember to assign a value to sheetCount\n    Dim sheetCount As Long: sheetCount = 4\n    ' Must declare the size of your array, this method keeps it generic\n    ' could have used 'Dim shets(1 To 4) As WorkSheet'\n    Dim n As Long\n    ReDim shets(1 To sheetCount)\n    ' Keeping with generic theme, loop over shets to define sheets, makes expanding easier\n    For n = 1 To sheetCount\n        ' Fully qualify sheets by using workbook object\n        Set shets(n) = ThisWorkbook.Sheets(\"Sheet\" &amp; n)\n    Next n\n    ' Used to make sure photos goes to photos, videos to videos, and compliance to compliance\n    Dim newShift As Long: newShift = 7\n    ' For loop counter variables: Must specify EACH type, 'Dim i, j, k As Long' declares i and j as Variants\n    Dim i As Long, j As Long, k As Long\n    ' Go through the sheets\n    For i = 2 To sheetCount\n        ' Go through the columns\n        For j = 3 To 7 Step 2\n            ' Go through the rows. Don't just use '.Rows' object as that includes all unused rows in sheet!\n            ' Also using one of the sheet objects, as 'ThisWorksheet' doesn't exist\n            For k = 2 To shets(i).UsedRange.Rows.Count\n                ' Don't access sheet objects using 'Sheets(shets(..))', simply use 'shets(..)'\n                If shets(i - 1).Cells(k, j) = shets(i).Cells(k, j) Then\n                    shets(i).Cells(k, j + newShift).Value = False\n                ElseIf shets(i - 1).Cells(k, j) &lt; shets(i).Cells(k, j) Then\n                    shets(i).Cells(k, j + newShift).Value = True\n                Else\n                    shets(i).Cells(k, j + newShift).Value = \"ERROR\"\n                End If\n            Next\n            newShift = newShift - 1\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 45345915, "answer_count": 1, "score": 0, "last_activity_date": 1501169663, "creation_date": 1501112474, "last_edit_date": 1501112725, "question_id": 45339101, "link": "https://stackoverflow.com/questions/45339101/declaring-and-initializing-a-dynamic-array-of-sheets-in-vba", "title": "Declaring and initializing a dynamic array of sheets in VBA", "body": "<p>I am trying to create an array of sheets in Excel.  Each sheet has several columns and rows that need to be searched, compared, and filled accordingly.  I am having trouble creating the array of sheets.  I keep getting a Subscript out of range error on line #27.  It happens on all 4 of the sheets if I comment out the preceding ones.</p>\n\n<pre><code>Sub news()\n\n    'activate sheets\n    Sheet1.Activate\n    Sheet2.Activate\n    Sheet3.Activate\n    Sheet4.Activate\n\n    'array of letters for the columns\n    Dim alpha(1 To 13) As String\n    alpha(1) = \"a\"\n    alpha(2) = \"b\"\n    alpha(3) = \"c\"\n    alpha(4) = \"d\"\n    alpha(5) = \"e\"\n    alpha(6) = \"f\"\n    alpha(7) = \"g\"\n    alpha(8) = \"h\"\n    alpha(9) = \"i\"\n    alpha(10) = \"j\"\n    alpha(11) = \"k\"\n    alpha(12) = \"l\"\n    alpha(13) = \"m\"\n\n    'array of sheets\n    Dim shets() As Sheets, sheetCount As Integer\n    Set shets(1) = Sheets(\"Sheet1\")\n    Set shets(2) = Sheets(\"Sheet2\")\n    Set shets(3) = Sheets(\"Sheet3\")\n    Set shets(4) = Sheets(\"Sheet4\")\n\n    'used to make sure i am not shifted and photos goes to photos, videos to videos, and compliance to compliance\n    Dim newShift As Integer\n    newShift = 7\n\n    'for loop counter variables\n    Dim i, j, k As Integer\n\n    'goes through the sheets\n    For i = 2 To sheetCount\n        'goes through the columns\n        For j = 3 To 7 Step 2\n            'goes through the rows\n            For k = 2 To ThisWorksheet.Rows.count\n                If (Sheets(shets(i - 1)).Cells(k, alpha(j)) = Sheets(shets(i)).Cells(k, alpha(j))) Then\n                    Sheets(shets(i)).Cells(k, alpha(j + newShift)) = False\n                ElseIf (Sheets(shets(i - 1)).Cells(k, alpha(j)) &lt; Sheets(shets(i)).Cells(k, alpha(j))) Then\n                    Sheets(shets(i)).Cells(k, alpha(j + newShift)) = True\n                Else\n                    Sheets(shets(i)).Cells(k, alpha(j + newShift)) = \"ERROR\"\n                End If\n            Next\n            newShift = newShift - 1\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501111182, "post_id": 45338784, "comment_id": 77639859, "body": "Not related to the problem, but <code>If my_FileName &lt;&gt; False Then</code> should be <code>If my_FileName3 &lt;&gt; False Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1501111894, "last_edit_date": 1501111894, "creation_date": 1501111488, "answer_id": 45338972, "question_id": 45338784, "link": "https://stackoverflow.com/questions/45338784/copy-from-one-excel-application-to-sheet-without-changing-dates-vba-excel/45338972#45338972", "title": "Copy from one Excel Application To Sheet Without Changing Dates VBA EXCEL", "body": "<p>The difference in the dates can be explained by inconsistent use of the date system between the two workbooks.  One will be using the 1904 date system, and one won't be:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BVxzw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BVxzw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If the destination workbook is using the 1904 date system, you will need to subtract 1462 from each value copied in order to convert it back to the same date that you started with.</p>\n"}], "owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 45338972, "answer_count": 1, "score": 0, "last_activity_date": 1501111894, "creation_date": 1501110079, "question_id": 45338784, "link": "https://stackoverflow.com/questions/45338784/copy-from-one-excel-application-to-sheet-without-changing-dates-vba-excel", "title": "Copy from one Excel Application To Sheet Without Changing Dates VBA EXCEL", "body": "<p>I am trying to copy an entire sheet from one application sheet to another open one with the following code</p>\n\n<pre><code>'Open Application\nMsgBox \"Select Report\"\nDim my_FileName3 As Variant\nmy_FileName3 = Application.GetOpenFilename(\"Excel Files (*.xl*),\" &amp; _\n    \"*.xl*\", 1, \"Select ManMan File\", \"Open\", False)\nIf my_FileName &lt;&gt; False Then\n Workbooks.Open Filename:=my_FileName3\nEnd If\n\n'Set Active\nvar3 = ActiveWorkbook.Name\n\n'Copy Everything\n Dim lastRow3 As Long\n lastRow3 = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n ActiveSheet.Range(\"a1:z\" &amp; lastRow3).Copy Destination:=Workbooks   (var1).Sheets(\"Sheet4\").Range(Var1R)\n\n'Close Worksheet\n Workbooks(var3).Close False\n</code></pre>\n\n<p>This code above works but the problem is the dates have been completely changed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hz0Xm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hz0Xm.png\" alt=\"First Document Worksheet Before copy\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/XW5iQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XW5iQ.png\" alt=\"Second Application Sheet4 After copy\"></a></p>\n\n<p>Any idea what I might be doing wrong? Ignore the empty row.</p>\n"}, {"tags": ["vba", "reference", "compilation"], "answers": [{"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1501111150, "post_id": 45338031, "comment_id": 77639849, "body": "If you&#39;re using Vista or later, you want the <code>Microsoft ActiveX Data Objects 6.x Library</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1501105781, "creation_date": 1501105781, "answer_id": 45338031, "question_id": 45337981, "link": "https://stackoverflow.com/questions/45337981/user-defined-type-not-defined-adodb-recordset/45338031#45338031", "title": "user defined type not defined adodb.recordset", "body": "<p>You need a different reference - \"Microsoft ActiveX Data Objects x.x Library\" - no \"Recordset\"</p>\n"}], "owner": {"reputation": 33, "user_id": 8290307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22fb52d84a7cd70eedeed6ec69f4169?s=128&d=identicon&r=PG&f=1", "display_name": "Kam", "link": "https://stackoverflow.com/users/8290307/kam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501105781, "creation_date": 1501105539, "question_id": 45337981, "link": "https://stackoverflow.com/questions/45337981/user-defined-type-not-defined-adodb-recordset", "title": "user defined type not defined adodb.recordset", "body": "<p>My program doesn't compile.\nI have this in my class module.\nHere is where it cops out:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Private pCornerCell As String\nPrivate pRecordset As ADODB.Recordset    &lt;-- PROBLEM HERE\nPrivate pSheet As Worksheet\n</code></pre>\n\n<p>&lt;--  thows message that \"User-defined type not defined\"</p>\n\n<p>I have references set:\nTools --> References shows\nMicrosoft ActiveX Data Objects Recordset 6.0 Library as checked.</p>\n"}, {"tags": ["python", "vba", "excel", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 8372413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c000af2fb9ec75cef708845113b042?s=128&d=identicon&r=PG&f=1", "display_name": "VBAMadeMeDoIt", "link": "https://stackoverflow.com/users/8372413/vbamademedoit"}, "is_accepted": false, "score": 3, "last_activity_date": 1501186607, "last_edit_date": 1501186607, "creation_date": 1501184212, "answer_id": 45359590, "question_id": 45337749, "link": "https://stackoverflow.com/questions/45337749/xlwings-issue-writing-to-cells-in-excel-2010/45359590#45359590", "title": "xlwings issue writing to cells in Excel 2010", "body": "<p>Turns out I misunderstood the behavior of functions in Excel and the usage of the decorator <code>xw.func</code> - which will essentially convert that block of code into an Excel Function. Function behavior is described here:<br>\n<a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel</a><br>\nI had hoped to circumvent macros entirely to reduce overhead but sadly the inherent restrictions of using Excel prevent this - <strong>functions cannot modify the contents of any other piece of the workbook</strong>. I hope this saves someone else the trouble of losing a couple days of work, though they were certainly educational. If anyone sees this and can suggest a viable workaround given my environment, you're more than welcome to.</p>\n"}], "owner": {"reputation": 143, "user_id": 8372413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c000af2fb9ec75cef708845113b042?s=128&d=identicon&r=PG&f=1", "display_name": "VBAMadeMeDoIt", "link": "https://stackoverflow.com/users/8372413/vbamademedoit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1501186607, "creation_date": 1501104559, "last_edit_date": 1501178741, "question_id": 45337749, "link": "https://stackoverflow.com/questions/45337749/xlwings-issue-writing-to-cells-in-excel-2010", "title": "xlwings issue writing to cells in Excel 2010", "body": "<p>At present I'm working to manage SQL connections to an Excel file via a Python script. The script uses xlwings to read and write to the workbook. Unfortunately, only the 'read' piece is functioning. I've combed Stackoverflow for quite some time today and noone seems to have this exact issue. Here is some debugging code I wrote up in the pertinent Python script(it exists on a worksheet as a UDF, the sheet I'm trying to write to is a different one); I'm not terribly experienced with Python or xlwings yet so feel free to gripe about structure/syntax :)</p>\n\n<pre><code>@xw.func\ndef compatTest():\n    #use active workbook\n    wb = xw.Book.caller()\n    #does the sheet Notes exist?\n    if wb.sheets['Notes']:\n        status = \"Status: \"\n        #does A1 in Notes have a value?\n        if wb.sheets['Notes'].range('$A$1').value:\n            status += \"Good\"\n            #Can we write to the specified empty cell?\n            try: \n                wb.sheets['Notes'].range('$E$1').value = 'something'\n            #Nope :(\n            except Exception as e:\n                status = e.message\n                return status + \"can't write :(\"\n            #This return statement shouldn't evaluate, just casting a wide net here\n            return status + \" \" + str(wb.sheets['Notes'].range('$A$1').value)\n        else:\n            #A1 in notes is blank\n            status += \"Bad\"\n            wb.sheets['Notes'].range('$E$1').value = 'nothing'\n            return status + \" \" + 'blank :('\n</code></pre>\n\n<p>Output in cell with the UDF in it: \"can't write :(\" - this means the error message isn't being returned.</p>\n\n<p>I'm using the xlwings 0.11.4 add-in and VBA reference(I am <strong>not</strong> using the VBA module as it appears to overlap with the add-in and generates VBA error 49 'Bad DLL calling convention'). I haven't touched the add-in code, as unlike the module the settings aren't handled in the file. The settings I have entered in the xlwings ribbon are all accurate.\n<br>\n<br>\nCurrent settings:<br>\nOS: Windows Server 2008 R2 Enterprise(testing here due to restrictions, script won't be deployed here)<br>\nPython version/distro: 2.7/Anaconda2<br>\nxlwings version: 0.11.4<br>\nExcel version: 2010 v. 14.0.7182.5000(32 bit)<br>\n<br>\n<br>\n<strong>Edit:</strong> Interestingly enough, when I first open the file(after updating links &amp; hitting 'Continue' for outdated links), the cell with the UDF displays \"Status: Good \". If I double click the cell to re-evaluate the UDF, it changes to \"can't write :(\" again.\n<br>\nIf I change the except block to the following:</p>\n\n<pre><code> except:\n            a = str(sys.exc_info()[0])\n            b = str(sys.exc_info()[1])\n            c = str(sys.exc_info()[2])\n            status = str(a + \" \\ \" + b + \" \\ \" + c)\n            return status\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>\"&lt;class 'pywintypes.com_error'&gt; \\ (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146827284), None) \\ &lt;traceback object at 0x0000000007B95708&gt;\"\n</code></pre>\n\n<p><br>\n<strong>Edit #2:</strong><br>\nOddly enough I can write to cells using the <em>xw.sub</em> decorator:<br></p>\n\n<pre><code>@xw.sub\ndef SomeFunction():\n    wb = xw.Book.caller()\n    wb.sheets['Notes'].range('B3').value = \"hello world\"\n</code></pre>\n\n<p>That code works just fine, but I'd rather run as much as I can through UDFs if possible.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1501103560, "post_id": 45337510, "comment_id": 77637056, "body": "Change <code>L22</code> to <code>LR22</code>.  And add <code>Option Explicit</code> as the first line of your code module - that will force you to declare all your variables, and therefore notifies you when you make a typo like this."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501103640, "post_id": 45337510, "comment_id": 77637097, "body": "Thanks but now the whole list is in red.."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1501103860, "post_id": 45337510, "comment_id": 77637204, "body": "Well that is a completely different question - that is &quot;why does the current cell&#39;s value always exist in a range including the current cell&quot; and can probably be fixed by testing that <code>x &lt;&gt; y + 1</code>.  (It&#39;s early morning, and I am still drinking my coffee, but I think that&#39;s the reason.)"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501103985, "post_id": 45337510, "comment_id": 77637273, "body": "Thanks this makes sense now. And it works great!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1501107973, "post_id": 45337510, "comment_id": 77638936, "body": "The suggestion of @YowE3K to add <code>Option Explicit</code> is almost indispensable for writing reliable VBA code. You can do it once and for all by enabling <code>Require Variable Declaration</code> in <code>Tools&#47;Options&#47;Editor</code> in the VBA editor."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1501108659, "post_id": 45337510, "comment_id": 77639166, "body": "You should also undo the color change on <code>Else</code> of <code>If x &lt;&gt; y + 1 Then</code>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1501111342, "post_id": 45337510, "comment_id": 77639902, "body": "@JohnColeman <code>Option Explicit</code> and indenting make for debuggable code. <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck VBA</a> will do both for you. ;-)"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501120217, "post_id": 45337510, "comment_id": 77641981, "body": "corrected your formatting"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1501154760, "post_id": 45337510, "comment_id": 77659759, "body": "<i>Must</i> you use VBA? If this is Excel 2003 or newer, select your column of ZIP codes, select <code>Home</code> | <code>Conditional Formatting</code> | <code>Highlight Duplicates</code> and select your color pattern (text &amp; background), <i>et voila!</i> all your duplicate ZIP Codes are highlighted without a lick of VBA. (NOTE: menu selections are for 2010, may be different in other versions of Excel)"}], "answers": [{"comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1501155130, "post_id": 45340430, "comment_id": 77659977, "body": "This will work when the list is ordered by zipcode. Changing the formula to include a match function may do the trick though."}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1501123215, "creation_date": 1501123215, "answer_id": 45340430, "question_id": 45337510, "link": "https://stackoverflow.com/questions/45337510/vba-method-range-of-object-error/45340430#45340430", "title": "vba method range of object error", "body": "<p>You can do this without code. Sort column L, then add the conditional formatting formula A1=A2. This will highlight duplicate entries in consecutive cells.</p>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1501154494, "creation_date": 1501103510, "last_edit_date": 1531164843, "question_id": 45337510, "link": "https://stackoverflow.com/questions/45337510/vba-method-range-of-object-error", "title": "vba method range of object error", "body": "<p>I am trying to highlight the duplicate zip codes with font color Red in column L, from L2. I did some research online and modified the codes accordingly but they are not working properly. </p>\n\n<p>I used <strong>F8</strong> and it stopped at the line y = Worksheet... I  tried to add the word <strong>Application.</strong> in front of WorksheetFunction but it is giving me the same error.</p>\n\n<pre><code>Sub test()\n    Dim x, y, LR22 As Long\n    Dim zip As Worksheet\n\n    Set zip = Worksheets(\"Zip\")\n    LR22 = zip.Cells(Rows.Count, \"L\").End(xlUp).Row\n\n\n    For x = 2 To LR22\n        If zip.Cells(x, 12) &lt;&gt; \"\" Then\n            y = WorksheetFunction.Match(zip.Cells(x, 12), zip.Range(\"L2:L\" &amp; L22), 0)\n            If x &lt;&gt; y Then\n                zip.Cells(x, 12).Font.Color = vbRed\n            End If\n        End If\n    Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1501103069, "post_id": 45337376, "comment_id": 77636799, "body": "How isn&#39;t it working for you? (Meaning what is it doing wrong, or isn&#39;t it doing?)  It seems to work for me. I have data in <code>A1:B16</code>, and it highlighted <code>A4:B16</code> blue-ish."}, {"owner": {"reputation": 135, "user_id": 7823968, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3b7e03a0d338515beed6369f1e176f84?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/7823968/hema"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501103952, "post_id": 45337376, "comment_id": 77637258, "body": "Yes...it does seem to work now. I had misplaced it in the code. Thanks for the review. Your comment did make me understand that my code is indeed working. I&#39;m new to VBA and learning! Thanks!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501104587, "post_id": 45337376, "comment_id": 77637526, "body": "No worries! FYI, you can replace your code from <code>g = ...</code> to <code>End If</code> with a single line, <code>lastRow = WorksheetFunction.Max(ws.Range(&quot;A&quot; &amp; ws.Rows.Count).End(xlUp).Row, ws.Range(&quot;B&quot; &amp; ws.Rows.Count).End(xlUp).Row)</code>.  That uses the <code>MAX()</code> function to just choose the larger row. No need for <code>g</code>, <code>h</code>, or the <code>If</code> statement :D"}], "owner": {"reputation": 135, "user_id": 7823968, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3b7e03a0d338515beed6369f1e176f84?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/7823968/hema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501102938, "creation_date": 1501102938, "question_id": 45337376, "link": "https://stackoverflow.com/questions/45337376/how-to-format-only-certain-cells-using-vba", "title": "How to format only certain cells using vba?", "body": "<p>I want to change the background color for columns A and B starting from Row 4 and upto the row that contains data. The following code doesn't seem to work. Please review.</p>\n\n<pre><code>Sub GeneralColorForAllPopulatedCells()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim g As Long, h As Long\nDim lastRow As Long\nDim rng As Range\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n\ng = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\nh = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n\nIf g &gt; h Then\n    lastRow = g\nElse\n    lastRow = h\nEnd If\n\nSet rng = ws.Range(\"A4:B\" &amp; lastRow)\nrng.Interior.Color = RGB(204, 229, 255)\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks,\nHema</p>\n"}, {"tags": ["vba", "excel", "sorting", "numbers"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1501102736, "post_id": 45337266, "comment_id": 77636614, "body": "Create a 3-digit column and a 2-digit column. The advanced sort interface allows you to first sort by one column and then the other."}, {"owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501103061, "post_id": 45337266, "comment_id": 77636796, "body": "Thanks, I will do that."}, {"owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501103449, "post_id": 45337266, "comment_id": 77637001, "body": "Sorry John Coleman, I accidentally deleted your comment.  I have edited my question to include the code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501103464, "post_id": 45337266, "comment_id": 77637008, "body": "Your approach of creating a new column, sorting by it and then deleting seems logical. What you could do is create <i>two</i> new columns, one identical to what you already have and a new one using <code>Left</code> rather than <code>Right</code>. In the sort command use <code>Key2</code> and <code>Option2</code>. Delete both columns at the end.  By the way -- I deleted my comment when it had become moot. You can&#39;t delete someone else&#39;s comment (unless you have moderator status)."}, {"owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501104342, "post_id": 45337266, "comment_id": 77637418, "body": "Would I add this new column before or after deleting this first column?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501107723, "post_id": 45337266, "comment_id": 77638830, "body": "Before -- both columns would need to exist when you invoke <code>sort</code>"}, {"owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501114246, "post_id": 45337266, "comment_id": 77640589, "body": "I can&#39;t seem to get the sort right.  How do I create the column that uses the <code>Left</code>?  And how do I sort in the right order?  I know I need to sort by the last 2 digits first and then sort by the <code>Key2</code> next but my code keeps getting errors.  How would you write the code?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501121125, "post_id": 45337266, "comment_id": 77642154, "body": "you only need to add one column. example: your 5 digit numbers in column A. cell B1 formula <code>=right(&quot;A1&quot;,2)</code> ... copy cell B1 and paste into rest of B column until end of data in column A. now column B contains last two digits of column A data. ... now sort the two columns any way you like ... note: when experimenting with column sorting, add another column and fill with 1,2,3,4,5.....( ascending) to use as an index, so that you can return to the original order of the data (just sort on the added index column)"}, {"owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "edited": false, "score": 0, "creation_date": 1501122273, "post_id": 45337266, "comment_id": 77642417, "body": "Found a simple solution:  Just sort all the numbers ascending and then sort by the last 2 digits using the code I have above and everything works perfectly.  It should anyway."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1501124925, "creation_date": 1501124925, "answer_id": 45340681, "question_id": 45337266, "link": "https://stackoverflow.com/questions/45337266/sorting-numbers-by-last-two-digits-using-vba-macro/45340681#45340681", "title": "Sorting Numbers By Last Two Digits Using VBA Macro", "body": "<p>Your solution in the last comment seems simple enough; this does the same thing (Sheet1, Col A)</p>\n\n<pre><code>Public Sub CustomSort()\n    Const START_ROW = 2, START_COL = 1\n    Dim ws As Worksheet, lr As Long, lFormula As String, rFormula As String\n    Dim sortL As Range, sortR As Range\n\n    Application.ScreenUpdating = False\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    lr = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    ws.Columns(START_COL + 1).Insert Shift:=xlToRight\n    ws.Columns(START_COL + 2).Insert Shift:=xlToRight\n    lFormula = \"=LEFT(\" &amp; Replace(ws.Cells(START_ROW, START_COL).Address, \"$\", \"\") &amp; \",3)\"\n    rFormula = \"=RIGHT(\" &amp; Replace(ws.Cells(START_ROW, START_COL).Address, \"$\", \"\") &amp; \",2)\"\n\n    With ws.UsedRange   'Apply Formulas\n        .Columns(START_COL + 1).Offset(1).Formula = lFormula\n        .Columns(START_COL + 2).Offset(1).Formula = rFormula\n        Set sortL = .Columns(START_COL + 1).Offset(1).Resize(lr - 1)\n        Set sortR = .Columns(START_COL + 2).Offset(2).Resize(lr - 1)\n    End With\n\n    With ws.Sort        'Apply Sort\n        With .SortFields\n            .Clear\n            .Add Key:=sortR\n            .Add Key:=sortL\n        End With\n        .SetRange ws.UsedRange.Offset(1).Resize(lr - 1)\n        .Apply\n    End With\n\n    ws.Columns(START_COL + 2).Delete    'Remove helper columns (if needed)\n    ws.Columns(START_COL + 1).Delete    'Remove helper columns (if needed)\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result:</p>\n\n<blockquote>\n<pre><code>Before | After\n--------------\n12300  | 12300\n15600  | 12400\n12400  | 15600\n15700  | 15700\n12301  | 12301\n15601  | 12401\n12401  | 15601\n15601  | 15601\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1501133399, "creation_date": 1501133399, "answer_id": 45342077, "question_id": 45337266, "link": "https://stackoverflow.com/questions/45337266/sorting-numbers-by-last-two-digits-using-vba-macro/45342077#45342077", "title": "Sorting Numbers By Last Two Digits Using VBA Macro", "body": "<p>Try this code.</p>\n\n<pre><code>Sub test()\n    Dim vDB, vNew()\n    Dim Ws As Worksheet\n    Dim n As Long, i As Long\n    Set Ws = ActiveSheet\n\n    With Ws\n        vDB = .Range(\"a1\", .Range(\"a\" &amp; Rows.Count).End(xlUp))\n        n = UBound(vDB, 1)\n        ReDim vNew(1 To n, 1 To 2)\n        For i = 1 To n\n            vNew(i, 1) = Left(vDB(i, 1), 3)\n            vNew(i, 2) = Right(vDB(i, 1), 2)\n        Next i\n        .Range(\"b:c\").Insert\n        .Range(\"b1\").Resize(n, 2) = vNew\n        .Range(\"a1\").CurrentRegion.Sort Key1:=Range(\"c1\"), Order1:=xlAscending, Key2:=Range(\"b1\"), Order2:=xlAscending, Header:=xlNo\n        .Range(\"b:c\").Delete\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 1699192, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/e09bf70c86055ca7ba70765c17b9b823?s=128&d=identicon&r=PG", "display_name": "Jason Keith McCoy", "link": "https://stackoverflow.com/users/1699192/jason-keith-mccoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 657, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501133399, "creation_date": 1501102572, "last_edit_date": 1531164843, "question_id": 45337266, "link": "https://stackoverflow.com/questions/45337266/sorting-numbers-by-last-two-digits-using-vba-macro", "title": "Sorting Numbers By Last Two Digits Using VBA Macro", "body": "<p>I have a spreadsheet with a large list of 5 digit numbers.  I want to organize these numbers by the last 2 digits.  I have a working formula that does this so this is not my problem.  My problem is now that these numbers are organized by the last 2 digits, is there any way to now sort these numbers by all 5 digits?  What I mean is this:  My numbers are now ordered like this:</p>\n\n<pre><code>    12300\n    15600\n    12400\n    15700\n    12301\n    15601\n    12401\n    15601 \n    etc\n</code></pre>\n\n<p>What I now what to do is sort them once again by all 5 digits but also within the subset of having sorted them by the last 2 digits like so:</p>\n\n<pre><code>    12300\n    12400\n    15600\n    15700\n    12301\n    12401\n    15601\n    15701 \n    etc \n</code></pre>\n\n<p>Is this possible?</p>\n\n<p>Here is the code that will sort the numbers by the last two digits:</p>\n\n<pre><code>[B:B].Insert Shift:=xlToRight\nn = [A65000].End(xlUp).Row\nFor Each c In Range(\"A1:A\" &amp; n)\nc.Offset(0, 1) = Right(c, 2)\nNext c\nRange(\"A1:B\" &amp; n).Sort Key1:=[B2], Order1:=xlAscending\n[B:B].Delete\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 1, "creation_date": 1501106621, "post_id": 45337212, "comment_id": 77638362, "body": "Is it VBA or VB? If you want VBA, please title acordingly. If you want VB, please change your tags accordingly. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "is_accepted": false, "score": 2, "last_activity_date": 1501161884, "last_edit_date": 1501161884, "creation_date": 1501102713, "answer_id": 45337305, "question_id": 45337212, "link": "https://stackoverflow.com/questions/45337212/and-operator-in-vb/45337305#45337305", "title": "And operator in VB", "body": "<blockquote>\n  <p>If they select an option from the dropdown menu and populate the FSValue cell, but do not indicate a quantity, I would like to display an error message.</p>\n</blockquote>\n\n<pre><code>FSValue = \"\" \n</code></pre>\n\n<p>Look at those things together. At this point, they have selected a value. <code>FSValue</code> is no longer blank. You want this:</p>\n\n<pre><code>FSValue &lt;&gt; \"\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501104755, "post_id": 45337450, "comment_id": 77637589, "body": "Excel VBA doesn&#39;t have a <code>Nz</code> function - that would be Access VBA."}, {"owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501248615, "post_id": 45337450, "comment_id": 77710775, "body": "Yea, sorry, I should have realized by the code sample it was Excel VBA."}], "tags": [], "owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501103199, "creation_date": 1501103199, "answer_id": 45337450, "question_id": 45337212, "link": "https://stackoverflow.com/questions/45337212/and-operator-in-vb/45337450#45337450", "title": "And operator in VB", "body": "<p>You may want to wrap your tests in an NZ function,</p>\n\n<p>If Nz(FSValue,\"\") = \"\" Then\n    If Nz(FSQuantity,0) = 0 Then\n        MsgBox (\"Please Enter a Quantity\")\n        Range(\"F47\").Select\n        Exit Sub\n    End if\nEnd if</p>\n"}], "owner": {"reputation": 61, "user_id": 7381147, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e129d0f0cbacf221b59c982417722307?s=128&d=identicon&r=PG&f=1", "display_name": "PFost", "link": "https://stackoverflow.com/users/7381147/pfost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501161884, "creation_date": 1501102380, "last_edit_date": 1501104793, "question_id": 45337212, "link": "https://stackoverflow.com/questions/45337212/and-operator-in-vb", "title": "And operator in VB", "body": "<p>I am trying to program some VB code to display an error message if someone selects an licensing option from a drop down menu but does not indicate a quantity.</p>\n\n<p>When they select the licensing option, it populates a cell with a defined name of FSValue . Right next to that is another cell to specify the quantity, called FSQuantity. The default value for FSValue is blank (empty), and the default value for FSQuantity is zero.</p>\n\n<p>If they select an option from the dropdown menu and populate the FSValue cell, but do not indicate a quantity, I would like to display an  error message.</p>\n\n<p>This is the code I am trying to use (I have tried several iterations of this, using both the defined cell names and cell locations):</p>\n\n<pre><code>If (FSValue = \"\") And (FSQuantity = 0) Then\n     MsgBox (\"Please Enter a Value Quantity\")\n     Range(\"F47\").Select\n     Exit Sub\nEnd If\n</code></pre>\n\n<p>I've also tried with nested if statements such as:</p>\n\n<pre><code>If FSValue = \"\" Then\n    If FSQuantity=0 Then\n        MsgBox (\"Please Enter a Quantity\")\n        Range(\"F47\").Select\n        Exit Sub\n    End if\nEnd if\n</code></pre>\n\n<p>Nothing is working and it doesn't seem like it should be that difficult. Any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1501100749, "post_id": 45336700, "comment_id": 77635525, "body": "You can&#39;t <code>Select</code> a range on a non-active sheet.  The question is ... why would you want to?  <code>Sheet3.Range(&quot;A200:Q200&quot;).Select</code> <code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False</code> is equivalent to <code>Sheet3.Range(&quot;A200:Q200&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False</code> so there is no need to <code>Select</code> anything.  Please have a read of <a href=\"https://stackoverflow.com/q/10714251/6535336\">How to avoid using Select in Excel VBA macros</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1501100919, "post_id": 45336700, "comment_id": 77635620, "body": "Having said that though, I doubt whether you will be able to paste an entire row (if <code>.Value = &quot;Complete - Design&quot;</code>, or nothing otherwise) into 17 cells."}], "owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501100512, "creation_date": 1501100512, "question_id": 45336700, "link": "https://stackoverflow.com/questions/45336700/excel-vba-loop-module-sheet-out-of-range", "title": "Excel VBA loop module sheet out of range?", "body": "<p>I am encountering a runtime error 1004 \"Select method of Range class failed\" on a script I have running within a module. The script is tied to a button on a different sheet. When run, the script is meant to look at the N column of the sheet \"projects overview,\" find any rows containing the value \"Complete - Design\" and copies the values of that row to a temporary holding row on sheet3. From that point, the row is added to a third and final sheet (sheet9) where it's inserted into a running list of other rows that have been copied. The original row on the \"projects overview\" sheet is then deleted.</p>\n\n<p>I get the error when the script reaches the Sheet3.Range(\"A200:Q200\").Select part of the code. I feel like it has something to do with activating the sheet from within this module because the rest of the script is enveloped in a with statement that targets the projects overview sheet, but I don't know how to resolve that conflict. Any help would be appreciated. Thanks!</p>\n\n<pre><code>Sub CompleteJob()\n\nDim Firstrow As Long\n    Dim lastRow As Long\n    Dim LrowProjectsOverview As Long\n\n    With Sheets(\"Projects Overview\")\n        .Select\n\n        Firstrow = .UsedRange.Cells(1).Row\n        lastRow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n        For LrowProjectsOverview = lastRow To Firstrow Step -1\n            With .Cells(LrowProjectsOverview, \"N\")\n                If Not IsError(.Value) Then\n                    If .Value = \"Complete - Design\" Then .EntireRow.Copy\n\n                    Sheet3.Range(\"A200:Q200\").Select\n\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n\n\n                        If Sheet9.Range(\"B2\").Value = \"\" Then\n                            Sheet9.Range(\"A2:Q2\").Value = Sheet3.Range(\"A200:Q200\").Value\n                            Sheet3.Range(\"A200:Q200\").ClearContents\n\n                            Else\n\n                            Sheet9.Range(\"B2\").EntireRow.Insert\n                            Sheet9.Range(\"A2:Q2\").Value = Sheet3.Range(\"A200:Q200\").Value\n                            Sheet3.Range(\"A200:Q200\").ClearContents\n                            Sheet9.Range(\"B2:Q2\").Interior.Color = xlNone\n                            Sheet9.Range(\"B2:Q2\").Font.Bold = False\n                            Sheet9.Range(\"B2:Q2\").Font.Color = vbBlack\n                            Sheet9.Range(\"B2:Q2\").RowHeight = 14.25\n\n                        End If\n\n                        If Sheet9.Range(\"B2\").Value = \"\" Then\n                           Sheet9.Range(\"B2\").EntireRow.Delete\n\n                        End If\n\n                    If .Value = \"Complete - Design\" Then .EntireRow.Delete\n\n                End If\n            End With\n        Next LrowProjectsOverview\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "image", "text", "ms-word", "footer"], "comments": [{"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1501134530, "post_id": 45336656, "comment_id": 77646012, "body": "Can you provide a little drawing how the image should be placed? Should it be centered of the page or centered below the text &quot;page x out of y&quot; ? How big should the picture be? I&#39;m interested why you do this in VBA?"}, {"owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1501160294, "post_id": 45336656, "comment_id": 77663932, "body": "I added a picture. I just want the the image at the bottom of the document. I believe it doesn&#39;t need to be re-scaled. I do it to format documents for a company from excel to word..It just saves time having the entire document automated."}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1501163376, "post_id": 45336656, "comment_id": 77666778, "body": "Thanks for the answer Philip. I get the idea now. I&#39;m still interested on the size of the picture. It influences where to place the page and file path. Can you provide the height of the pic in Centimeters?"}, {"owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1501163581, "post_id": 45336656, "comment_id": 77666935, "body": "about 3cm perhaps"}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1501761467, "post_id": 45336656, "comment_id": 77927441, "body": "Did the answer (<a href=\"https://stackoverflow.com/a/45388748/1306012\">stackoverflow.com/a/45388748/1306012</a>) help you?"}], "answers": [{"tags": [], "owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1501328244, "last_edit_date": 1501328244, "creation_date": 1501327731, "answer_id": 45388748, "question_id": 45336656, "link": "https://stackoverflow.com/questions/45336656/how-to-insert-page-footer-with-page-numbers-file-path-and-image/45388748#45388748", "title": "How to insert page footer with page numbers, file path and image?", "body": "<p>I've worked out something. Its bigger then I thought it would become. I sure it gets you started with what you want to reach.</p>\n\n<p>There was some help involved from experts-exchange.com with their solution on\n\"<a href=\"https://www.experts-exchange.com/questions/23467589/VBA-to-insert-a-modified-Page-x-of-y-in-a-Word-Footer.html#discussion\" rel=\"nofollow noreferrer\">VBA to insert a modified Page x of y in a Word Footer</a>\". I've mentiond it in the code where I use it to convert test into fields.</p>\n\n<p>As mentioned in your other question \"<a href=\"https://stackoverflow.com/a/45353009/1306012\">How to enable page numbers without affecting footers/headers</a>\" I follow the approach to use tables with empty borders. They allow you to place content very exact.\nThat's why the code below will insert a table with three columns:</p>\n\n<pre><code> ___________________ ________________________ ___________\n|_Your footer text__|_Center part if needed__|_Page X/Y__|\n</code></pre>\n\n<p>Below find the code. The main method <code>InsertFooter</code> you'll want to call from your code. It will do what you desire:</p>\n\n<pre><code>Sub InsertFooter()\n\nDim footer As HeaderFooter\nDim footerRange As range\nDim documentSection As Section\nDim currentView As View\nDim footerTable As table\nDim pictureShape As Shape\n\nOn Error GoTo MyExit\n\n' Disable updating to prevent flickering\nApplication.ScreenUpdating = False\n\nFor Each documentSection In ActiveDocument.Sections\n    For Each footer In documentSection.Footers\n        If footer.Index = wdHeaderFooterPrimary Then\n            Set footerRange = footer.range\n            ' add table to footer\n            Set footerTable = AddTableToFooter(footerRange)\n            ' Make table border transparent\n            SetTableTransparentBorder footerTable\n            ' Insert page X out of Y into third column in table\n            InsertPageNumbersIntoTable footerTable\n            ' Insert file path\n            InsertFilePathIntoTable footerTable\n            ' Add picture to footer\n            AddPictureToFooter footerRange, \"C:\\Pictures\\happy.jpg\", 3\n        End If\n    Next footer\nNext documentSection\n\nMyExit:\n' Enable updating again\nApplication.ScreenUpdating = True\nApplication.ScreenRefresh\n\nEnd Sub\n\nSub AddPictureToFooter(range As range, filePath As String, pictureHeightInCm As Single)\n    Set pictureShape = range.InlineShapes.AddPicture(FileName:=filePath, LinkToFile:=False, SaveWithDocument:=True).ConvertToShape\n    pictureShape.WrapFormat.Type = wdWrapFront\n    pictureShape.height = CentimetersToPoints(pictureHeightInCm)\n    pictureShape.Top = 0\nEnd Sub\n\nSub InsertPageNumbersIntoTable(tableToChange As table)\n    ' Attention no error handling done!\n\n    ' inserts \"Page {page} of {pages}\" into the third column of a table\n    Dim cellRange As range\n    Set cellRange = tableToChange.Cell(1, 3).range\n    cellRange.InsertAfter \"Page { PAGE } of { NUMPAGES }\"\n    TextToFields cellRange\nEnd Sub\n\n\n' Credits go to\n' https://www.experts-exchange.com/questions/23467589/VBA-to-insert-a-modified-Page-x-of-y-in-a-Word-Footer.html#discussion\nSub TextToFields(rng1 As range)\n    Dim c As range\n    Dim fld As Field\n    Dim f As Integer\n    Dim rng2 As range\n    Dim lFldStarts() As Long\n\n    Set rng2 = rng1.Duplicate\n    rng1.Document.ActiveWindow.View.ShowFieldCodes = True\n\n    For Each c In rng1.Characters\n        DoEvents\n        Select Case c.Text\n            Case \"{\"\n                ReDim Preserve lFldStarts(f)\n                lFldStarts(f) = c.Start\n                f = f + 1\n            Case \"}\"\n                f = f - 1\n                If f = 0 Then\n                    rng2.Start = lFldStarts(f)\n                    rng2.End = c.End\n                    rng2.Characters.Last.Delete '{\n                    rng2.Characters.First.Delete '}\n                    Set fld = rng2.Fields.Add(rng2, , , False)\n                    Set rng2 = fld.Code\n                    TextToFields fld.Code\n                End If\n            Case Else\n        End Select\n    Next c\n    rng2.Expand wdStory\n    rng2.Fields.Update\n    rng1.Document.ActiveWindow.View.ShowFieldCodes = False\nEnd Sub\n\nSub InsertFilePathIntoTable(tableToChange As table)\n    ' Attention no error handling done!\n\n    ' inserts \"Page {page} of {pages}\" into the third column of a table\n    Dim cellRange As range\n    Set cellRange = tableToChange.Cell(1, 1).range\n    cellRange.InsertAfter \"{ FILENAME \\p }\"\n    TextToFields cellRange\nEnd Sub\n\nSub SetTableTransparentBorder(tableToChange As table)\n    tableToChange.Borders(wdBorderTop).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderLeft).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderBottom).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderRight).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderVertical).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone\n    tableToChange.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone\nEnd Sub\n\nFunction AddTableToFooter(footerRange As range) As table\n    Dim footerTable As table\n    Set footerTable = ActiveDocument.Tables.Add(range:=footerRange, NumRows:=1, NumColumns:=3, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitFixed)\n    ' Algin third column to right\n    footerTable.Cell(1, 3).range.ParagraphFormat.Alignment = wdAlignParagraphRight\n    Set AddTableToFooter = footerTable\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1597, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501328263, "creation_date": 1501100367, "last_edit_date": 1501328263, "question_id": 45336656, "link": "https://stackoverflow.com/questions/45336656/how-to-insert-page-footer-with-page-numbers-file-path-and-image", "title": "How to insert page footer with page numbers, file path and image?", "body": "<p><a href=\"https://i.stack.imgur.com/TLWA1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TLWA1.jpg\" alt=\"enter image description here\"></a>I'm trying to format the footer so it has the page # (x out of y) on the top right of the footer, and  then the image centered below. I ended up writing an algorithm for the page # and then used inlineshapes to insert the image above.  The problem is the text is below the image and the image is not centered. Any help would be appreciated. </p>\n\n<pre><code>.ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).range.Paragraphs.Alignment = wdAlignParagraphCenter 'Centers Header'\n.ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).range.InlineShapes.AddPicture (\"X:\\EQP\\Residential Maintenance Agreement\\Archived RMA templates\\AA Logo Swoops cropped 2.JPG\") 'Calls for image header'\n.ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).range.Paragraphs.Alignment = wdAlignParagraphCenter 'Centers Footer'\n.ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).range.InlineShapes.AddPicture (\"X:\\EQP\\Residential Maintenance Agreement\\Footer Template.PNG\")\nWith wdapp.ActiveDocument.Sections(1).Footers(1).range.Paragraphs(1)\n    .range.InsertAfter vbCr &amp; \"Page \"\n    Set r = .range\n    E = .range.End\n    r.Start = E\n    .range.Fields.Add r, wdFieldPage\n    .range.InsertAfter \" of \"\n    E = .range.End\n    r.Start = E\n    .range.Fields.Add r, wdFieldNumPages\n    .Alignment = wdAlignParagraphRight\n    '.Alignment = wdAlignParagraphCenter\n    '.range.InlineShapes.AddPicture (\"X:\\EQP\\Residential Maintenance Agreement\\Footer Template.PNG\")\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1501099953, "post_id": 45336501, "comment_id": 77635074, "body": "A1 &amp; A2 &amp; A3 work. Concatenate doesn&#39;t. Possibly because it is a large range, i just used A1:A3 in question as a sample."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1501100433, "post_id": 45336501, "comment_id": 77635341, "body": "Not CONCATENATE(), CONCAT() it is different and only available with a subscription to OFFICE 365. @Jonnyboi"}, {"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1501100542, "post_id": 45336501, "comment_id": 77635407, "body": ":( I dont got. Sigh i guess this slow way will have to do"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1501100803, "last_edit_date": 1501100803, "creation_date": 1501099855, "answer_id": 45336501, "question_id": 45336464, "link": "https://stackoverflow.com/questions/45336464/concat-function-without-office-365/45336501#45336501", "title": "CONCAT Function without OFFICE 365", "body": "<p>If you have CONCAT() function:</p>\n\n<pre><code>=CONCAT(A1:A3)\n</code></pre>\n\n<p>IF not:</p>\n\n<pre><code>= A1 &amp; A2 &amp; A3\n</code></pre>\n\n<hr>\n\n<p>If you do not have CONCAT, put this UDF in a module and use the formula as described above:</p>\n\n<pre><code> Function CONCAT(rng As Range)\n Dim rngArr As Variant\n Dim i As Long, j as long\n rngArr = rng.Value\n For i = LBound(rngArr, 1) To UBound(rngArr, 1)\n    For j = LBound(rngArr, 2) To UBound(rngArr, 2)\n        CONCAT = CONCAT &amp; rngArr(i, j)\n    Next j\n Next i\n End Function\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 45336501, "answer_count": 1, "score": -1, "last_activity_date": 1501165537, "creation_date": 1501099715, "last_edit_date": 1531161705, "question_id": 45336464, "link": "https://stackoverflow.com/questions/45336464/concat-function-without-office-365", "title": "CONCAT Function without OFFICE 365", "body": "<p>I have my data like so, in A1:A3 in excel.</p>\n\n<p><code>stack','   over','   flow','</code>  </p>\n\n<p>Is there anyway to combine this into one cell?</p>\n\n<p>I've tried copy and paste to word and notepad ++ but they give me these with space gaps between them. My idea is to use these in a SQL query.</p>\n\n<p>Other questions on here regard VBA for multiple rows. \nConcatenante does not work as in reality I use a larger range then A1:A3</p>\n"}, {"tags": ["excel", "vba", "split", "duplicates"], "answers": [{"tags": [], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "is_accepted": false, "score": 0, "last_activity_date": 1501101052, "creation_date": 1501101052, "answer_id": 45336831, "question_id": 45336230, "link": "https://stackoverflow.com/questions/45336230/excel-2010-split-cell-and-duplicate-row/45336831#45336831", "title": "Excel 2010 split cell and duplicate row", "body": "<p>I would:</p>\n\n<ol>\n<li><p>Insert two columns after <code>I</code> and use formulas below (example for line 2):</p></li>\n<li><p>Set cells in <code>J</code> with this formula: <code>=LEFT(I2;SEARCH(\";\";I2)-1)</code></p></li>\n<li><p>Set cells in <code>K</code> with this formula: <code>=MID(I2;SEARCH(\";\";I2)+1;10000)</code></p></li>\n<li><p>Copy the two new columns' content and <strong>paste special as values</strong> in the same place. </p></li>\n<li><p>Finally delete column <code>I</code>.</p></li>\n</ol>\n\n<p>...And do the same for column <code>M</code></p>\n\n<p>You could always write a macro to iterate rows, read values, split them with a <code>Split()</code> function, write the new values in new columns, but I don't think it is worth the effort.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 2, "last_activity_date": 1501205058, "creation_date": 1501205058, "answer_id": 45363429, "question_id": 45336230, "link": "https://stackoverflow.com/questions/45336230/excel-2010-split-cell-and-duplicate-row/45363429#45363429", "title": "Excel 2010 split cell and duplicate row", "body": "<p>According to your description, this should do what you want.</p>\n\n<pre><code>Option Explicit\n\n'Qual coluna possui os termos que repetem?\nConst ANALYSIS_ROW1 As String = \"I\"\nConst ANALYSIS_ROW2 As String = \"M\"\n\n'Em qual linha come\u00e7am os dados?\nConst DATA_START_ROW As Long = 2\n\nSub ReplicateData()\n    Dim iRow As Long\n    Dim LastRow As Long\n    Dim ws As Worksheet\n    Dim iSplit() As String\n    Dim iIndex As Long\n    Dim iSize As Long\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    With ThisWorkbook\n        .Worksheets(\"Sheet1\").Copy After:=.Worksheets(\"Sheet1\")\n        Set ws = ActiveSheet\n    End With\n\n    With ws\n        LastRow = .Cells(.Rows.Count, ANALYSIS_ROW1).End(xlUp).Row\n    End With\n\n\n    For iRow = LastRow To DATA_START_ROW Step -1\n        iSplit = Split(ws.Cells(iRow, ANALYSIS_ROW1).Value2, \";\")\n        iSplit = Split(ws.Cells(iRow, ANALYSIS_ROW2).Value2, \";\")\n        iSize = UBound(iSplit) - LBound(iSplit) + 1\n        If iSize = 1 Then GoTo Continue\n\n        ws.Rows(iRow).Copy\n        ws.Rows(iRow).Resize(iSize - 1).Insert\n        For iIndex = LBound(iSplit) To UBound(iSplit)\n            ws.Cells(iRow, ANALYSIS_ROW1).Offset(iIndex).Value2 = iSplit(iIndex)\n            ws.Cells(iRow, ANALYSIS_ROW2).Offset(iIndex).Value2 = iSplit(iIndex)\n        Next iIndex\nContinue:\n    Next iRow\n\n    Application.CutCopyMode = False\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8372216, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aCRkDxiKIOU/AAAAAAAAAAI/AAAAAAAAAJU/xLGfU5-hME4/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/8372216/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 45363429, "answer_count": 2, "score": 1, "last_activity_date": 1501205058, "creation_date": 1501098758, "question_id": 45336230, "link": "https://stackoverflow.com/questions/45336230/excel-2010-split-cell-and-duplicate-row", "title": "Excel 2010 split cell and duplicate row", "body": "<p>I know similar questions have been answered but they did not work for me. I am not an expert with excel so I could use some help.</p>\n\n<p>I have data in columns A-P but in columns I and M there is data separated by a semi-colon. I need to split both columns I and M and make duplicated rows with all the other data. I would imagine that I have to split I and make duplicate rows and then repeat for M but I'm not sure.</p>\n\n<p>Sorry again for asking a similar question.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501109582, "post_id": 45336183, "comment_id": 77639458, "body": "Where does <code>ComboBox1.DropDown</code> get called - <code>ComboBox1_Change()</code>? Is <code>ComboBox1.MatchEntry = 1</code> (fmMatchEntryComplete)? This is a UserForm and not ActiveX one right?"}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501159899, "post_id": 45336183, "comment_id": 77663597, "body": "Yes .DropDown is called by ComboBox_Change(), but in a its own Sub that is dedicated to building the list.  .MatchEntry is set to none, I had issues because these lines:      s = ComboBox1.Value         ComboBox1.clear         ComboBox1.Value = s  while clearing the list, was also setting the value of the box to the first matched value.  I definently should have mentioned it is a ActiveX control, I&#39;ll try a User Form and see if it acts differently."}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501160323, "post_id": 45336183, "comment_id": 77663956, "body": "Still need to learn how to format text on SO, I&#39;ll check out the documentation so I can separate code and comments."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501198619, "post_id": 45336183, "comment_id": 77686421, "body": "Easiest way is to select codes to be pasted here, press tab, Copy, then paste in your Edit box. Why do you need to rebuild the list upon text change? Is it because the desired value may not be the first word user typing in?"}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501247457, "post_id": 45336183, "comment_id": 77709879, "body": "Yea, users will need to know if the entry has already been made, so after 4 or so letters are typed, a drop down list should appear of existing names that include (or are close to) what they have entered.  The existing name may be different than what they expected it to be. Its important because a cross-reference number is generated for entries and its based on if the input already exists."}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501247725, "post_id": 45336183, "comment_id": 77710119, "body": "Had a tough time trying to set the properties of a user form dropdown box, I&#39;d rather use ActiveX unless this just isnt possible. I may need to just take out &quot;.dropdown&quot; and inform users to click the dropdown periodically?  Can I send &quot;F4&quot; as a keystroke or somthing?"}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501255397, "post_id": 45375330, "comment_id": 77715788, "body": "Not sure if this will help, but when it comes to ComboBoxes, I never use the <code>Change</code> event, I use the <code>Click</code> event."}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501527031, "post_id": 45375330, "comment_id": 77807754, "body": "Interesting, I dont think that will fit my needs as I would like the list to change as you type."}], "tags": [], "owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "is_accepted": false, "score": 0, "last_activity_date": 1501253571, "last_edit_date": 1501253571, "creation_date": 1501250118, "answer_id": 45375330, "question_id": 45336183, "link": "https://stackoverflow.com/questions/45336183/combobox-dropdown-method-only-shows-one-list-item/45375330#45375330", "title": "ComboBox.Dropdown Method only shows one list item", "body": "<p>I've been calling .DropDown in a custom Sub that creates the list, I needed to change it so it is now the last line in ComboBox1_Change().</p>\n\n<p>Not sure why it acts differently in _change() than it did in my Sub (that was called by _change())!</p>\n\n<p>I think that this is actually related to using the .clear method and then calling .Dropdown, it doesn\u2019t recalculate how many lines to show. I may need to just keep them in separate Subs Thanks for your responses @PatricK</p>\n\n<p>Edit: Not solved, it now works correctly with the first \"change\" more letters typed causes the rest of the list to stay un-cleared while the first row is updated and has the scroll buttons. I wish I knew exactly how these methods are written and when they get executed.</p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "is_accepted": false, "score": 0, "last_activity_date": 1501596567, "creation_date": 1501596567, "answer_id": 45440185, "question_id": 45336183, "link": "https://stackoverflow.com/questions/45336183/combobox-dropdown-method-only-shows-one-list-item/45440185#45440185", "title": "ComboBox.Dropdown Method only shows one list item", "body": "<pre><code>ComboBox1.Visible = False\nComboBox1.Visible = True\nComboBox1.Activate\nIf ComboBox1.ListCount &gt; 0 Then\n   ComboBox1.DropDown\nEnd If\n</code></pre>\n\n<p>This code seems to do the trick, at least more than one line is diplayed, and the list is becomes shorter if items are removed, unlike before.</p>\n"}], "owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501596567, "creation_date": 1501098568, "last_edit_date": 1501242883, "question_id": 45336183, "link": "https://stackoverflow.com/questions/45336183/combobox-dropdown-method-only-shows-one-list-item", "title": "ComboBox.Dropdown Method only shows one list item", "body": "<p>I'm using a ComboBox in excel (vba) that adds items to the list based on what is typed (near matches) so that if what they are typing already exists in the data range, they can see it and click. </p>\n\n<p>This is all working fine except for the method ComboBox1.DropDown, which is supposed to display the list. Unfortunately it only shows one item with the scroll buttons. Clicking the drop down button or pressing f4 shows the correct number of lines determined by the box's properties. </p>\n\n<p>I've searched and searched, any clue how to show all items in the list automatically?</p>\n\n<p>This is my first question on SO, please advise if tagged incorectly.</p>\n\n<p>edit: ActiveX control, .listRows and .listFillRange do not seem to help</p>\n"}, {"tags": ["vba", "excel", "multiple-columns"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501098728, "post_id": 45335944, "comment_id": 77634407, "body": "You don&#39;t need VBA for this. Insert the following formula to G2 and copy/paste to below cells. <code>=INDEX(C2:F2,MATCH(TRUE,INDEX((C2:F2&lt;&gt;0),0),0))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6097, "user_id": 2876079, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6NZXD.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2876079/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1501101413, "creation_date": 1501101413, "answer_id": 45336932, "question_id": 45335944, "link": "https://stackoverflow.com/questions/45335944/excel-vba-shift-data-across-multiple-columns-to-a-single-column/45336932#45336932", "title": "Excel VBA - Shift data across multiple columns to a single column", "body": "<p>As Tehscript mentioned you dont need a macro. If you nevertheless want to use a macro (maybe your real case is more complex than the example) here is a starting point for you. </p>\n\n<p>The example below will shift the cells only once. So you might want to execute the loop several times. (You could also loop over the rowIndex and use a while loop for each row.)</p>\n\n<p>The code could be further refactored but I hope this way it is easy to read.  </p>\n\n<pre><code>Sub ShiftCells()\n\n\nDim myWorkSheet As Worksheet\nSet myWorkSheet = Worksheets(\"Tabelle1\")\n\nDim maxRowIndex As Long\nmaxRowIndex = GetMaxRowIndex(myWorkSheet)\n\nDim rowIndex As Long\nDim columnIndex As Long\n\nDim leftCell As Range\nDim rightCell As Range\n\nFor Each Cell In Range(\"C2:F\" &amp; maxRowIndex)\n    If Cell.Value = \"\" Then\n       shiftedCell = True\n       rowIndex = Cell.Row\n       columnIndex = Cell.Column\n\n       Set leftCell = myWorkSheet.Cells(rowIndex, columnIndex)\n       Set rightCell = myWorkSheet.Cells(rowIndex, columnIndex + 1)\n\n       leftCell.Value = rightCell.Value\n       rightCell.Value = \"\"\n\n    End If\n\n\nNext Cell\n\n\nEnd Sub\n\nFunction GetMaxRowIndex(ByVal myWorkSheet As Worksheet) As Long\n    Dim numberofRowsInColumnC As Long\n    numberofRowsInColumnC = myWorkSheet.Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Dim numberofRowsInColumnD As Long\n    numberofRowsInColumnD = myWorkSheet.Cells(Rows.Count, \"D\").End(xlUp).Row\n\n    Dim numberofRowsInColumnE As Long\n    numberofRowsInColumnE = myWorkSheet.Cells(Rows.Count, \"E\").End(xlUp).Row\n\n    Dim numberofRowsInColumnF As Long\n    numberofRowsInColumnF = myWorkSheet.Cells(Rows.Count, \"F\").End(xlUp).Row\n\n    Dim maxNumberOfRows As Long\n    maxNumberOfRows = WorksheetFunction.Max(numberofRowsInColumnC, _\n                                                numberofRowsInColumnD, _\n                                                numberofRowsInColumnE, _\n                                                numberofRowsInColumnF _\n                                                )\n    GetMaxRowIndex = maxNumberOfRows\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "is_accepted": true, "score": 0, "last_activity_date": 1501122453, "last_edit_date": 1501122453, "creation_date": 1501119406, "answer_id": 45339928, "question_id": 45335944, "link": "https://stackoverflow.com/questions/45335944/excel-vba-shift-data-across-multiple-columns-to-a-single-column/45339928#45339928", "title": "Excel VBA - Shift data across multiple columns to a single column", "body": "<p>Change your \"For\" block to:</p>\n\n<pre><code>With ws1.UsedRange\n    lastRow = .Rows(.Rows.Count).Row\nEnd With\nFor Each cell In Range(\"C2:C\" &amp; lastRow)\n    If cell.Value = \"\" Then\n       thisRow = cell.Row\n       For Each horCell In Range(Cells(thisRow, \"D\"), Cells(thisRow, \"F\"))\n            If Not horCell.Value = \"\" Then\n                cell.Value = horCell.Value\n                Exit For\n            End If\n       Next horCell\n\n    End If\n\n\nNext cell\nRange(\"D:F\").EntireColumn.Delete\n</code></pre>\n\n<p>By cycling only through column C, you can loop through D-F only if C is blank, and when you find the one with data, it puts it in C.</p>\n\n<p>If you also need dynamic range on the number of columns, then do:</p>\n\n<pre><code>With ws1.UsedRange\n    lastRow = .Rows(.Rows.Count).Row\n    lastColumn = .Columns(.Columns.Count).Column\nEnd With\nFor Each cell In Range(\"C2:C\" &amp; lastRow)\n    If cell.Value = \"\" Then\n       thisRow = cell.Row\n       For Each horCell In Range(Cells(thisRow, \"D\"), Cells(thisRow, lastColumn))\n            If Not horCell.Value = \"\" Then\n                cell.Value = horCell.Value\n                Exit For\n            End If\n       Next horCell\n\n    End If\n\n\nNext cell\nRange(Cells(2, \"D\"), Cells(2, lastColumn)).EntireColumn.Delete\n</code></pre>\n\n<p>Or with a correct lastRow in your for loop \"to\" range, change your code to</p>\n\n<pre><code>If Not cell = \"\" then\n     ws1.range (\"C\" &amp; cell.Row).Value = cell.Value\n End if\n</code></pre>\n\n<p>You are looping through columns D-F, so \"cell\" is a cell in that range, not in column C.  You therefore want to test for the ones that are NOT empty and then put their values in the corresponding cell in column C. :-)</p>\n"}], "owner": {"reputation": 15, "user_id": 8138560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ff13b3ca376307503cce05dd1241e1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Audet", "link": "https://stackoverflow.com/users/8138560/n-audet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1509, "favorite_count": 0, "accepted_answer_id": 45339928, "answer_count": 2, "score": 0, "last_activity_date": 1501122453, "creation_date": 1501097588, "last_edit_date": 1501107598, "question_id": 45335944, "link": "https://stackoverflow.com/questions/45335944/excel-vba-shift-data-across-multiple-columns-to-a-single-column", "title": "Excel VBA - Shift data across multiple columns to a single column", "body": "<p>I have a macro right now that pulls data from a different sheet into a new sheet, then formats the data into a form I can use. The issue I have is that some of the PNs that I pull from the other sheet are in different cells for ease of viewing. (For example, the top level PN is in cell C2 and any parts that are a part of the part in C2 may be listed in D3, to show it's a sub-part).</p>\n\n<p>I need code that will shift all PNs across varying columns into a single column. Once all PNs are moved, the other columns should be deleted (D through F). The data ranges from column C to F. Depending on the table the macro pulls data from, the length of the data varies. The macro will need to be able to handle this. </p>\n\n<p>Here's an example of what my sheet looks like after my macro runs:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8rEQJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8rEQJ.png\" alt=\"Example_Data\"></a></p>\n\n<p>I'm trying to check column C for empty rows. If say C3 is empty, I then want to check D3 for text. If there is text, I want text in D3 to move to C3. If there is no text, check E3. Same process repeated. From what I've found online, I have this code so far (however, it doesn't run properly in my macro)...</p>\n\n<pre><code>'Copy PNs that are out of line and paste them in the correct column\nDim N As Long, i As Long, j As Long\n\nSet ws1 = Worksheets(\"KDLSA\")\n\nN = ws1.Cells(Rows.Count, \"C\").End(xlUp).Row\nj = 4\n\nFor Each cell In Range(\"D2:F\" &amp; ws1.Cells(Rows.Count, \"F\").End(xlUp).Row)\n\n\n    If cell.Value = \"\" Then 'if cell C is blank, I want to shift the text to fill column C\n        ws1.Range(\"C\" &amp; j).Value = ws1.Range(\"D\" &amp; cell.Row).Value 'copy PN in column E to column D - this needs to be more robust to cover my range of columns rather than just D and E\n        j = j + 1\n    End If\n\n\nNext cell\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1501098277, "post_id": 45335920, "comment_id": 77634147, "body": "Not sure what your question is as it sounds very basic. You may need to learn or re-learn VBA (sub, function, etc.) or how to integrate code in Access."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1501098587, "post_id": 45335920, "comment_id": 77634322, "body": "You need to put it in some procedure. Could be a button Click event. Review <a href=\"https://support.office.com/en-us/article/Introduction-to-Access-programming-25EDAEFE-E917-4608-8BA0-DAB7C75CBE0C?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "edited": false, "score": 0, "creation_date": 1501099476, "post_id": 45335920, "comment_id": 77634820, "body": "Have you considered a macro instead?"}, {"owner": {"reputation": 33, "user_id": 7763647, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1155833d38c022e0e5d2c031e72c628c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/7763647/cameron"}, "reply_to_user": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "edited": false, "score": 0, "creation_date": 1501159751, "post_id": 45335920, "comment_id": 77663476, "body": "@DonGeorge yes, that is what I did, I needed a fuction start and end then I needed to create a macro to call the procedure. I was able to get it to work"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7763647, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1155833d38c022e0e5d2c031e72c628c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/7763647/cameron"}, "is_accepted": false, "score": 0, "last_activity_date": 1501159903, "creation_date": 1501159903, "answer_id": 45351358, "question_id": 45335920, "link": "https://stackoverflow.com/questions/45335920/how-to-write-vba-in-access-to-run-change-queries/45351358#45351358", "title": "How to write VBA in Access to run change queries", "body": "<p>This is what needs to be added:</p>\n\n<pre><code> `Option Compare Database\n Option Explicit\n Function Queries()\n CurrentDb.Execute \"Query1\"\n CurrentDb.Execute \"Query2\"\n End Function\n`\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7763647, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1155833d38c022e0e5d2c031e72c628c?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/7763647/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501159903, "creation_date": 1501097534, "question_id": 45335920, "link": "https://stackoverflow.com/questions/45335920/how-to-write-vba-in-access-to-run-change-queries", "title": "How to write VBA in Access to run change queries", "body": "<p>I have a bunch of update and change queries that I want to run all at once in VBA. I am brand new to VBA so what do I need to write in a module in order to run it in the VBA window? All I could find was the following:</p>\n\n<p><code>CurrentDb.Execute \"Query1\"\n CurrentDb.Execute \"Query2\"</code></p>\n\n<p>What else needs to be added at the beginning and the end to get this to run?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1501097402, "post_id": 45335779, "comment_id": 77633639, "body": "The <code>Worksheet.Shapes</code> collection exposes all of the <code>Shape</code> objects within a <code>Worksheet</code> and the <code>Shape</code> object exposes it&#39;s <code>TopLeftCell</code> and <code>BottomRightCell</code>. Using this, it would be very easy to arrange all of the shapes in a column."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1501097573, "post_id": 45335779, "comment_id": 77633745, "body": "You can tell what type of shape a Shape object is by referencing its <code>AutoShapeType</code> property."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1501099380, "post_id": 45336286, "comment_id": 77634763, "body": "What kind of interview could possibly be asking for someone to write such a complicated (and somewhat useless program)? Nice job btw, tested and it works well!"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1501099505, "post_id": 45336286, "comment_id": 77634844, "body": "@dwirony I agree, it&#39;s pretty strange.  I think the point of the question though is to force the programmer to think outside the box and adapt to a challenge they&#39;ve likely never done before.  Possibly a good way to weed out those that simply can&#39;t code or those that give up before putting in enough thought to at least try to find a solution."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1501099604, "post_id": 45336286, "comment_id": 77634893, "body": "Very true. I gave it a shot but tapped out... I very rarely work with shapes in my line of excel work so I have no familiarity with any of the terms/types, I would&#39;ve been out of contention!"}, {"owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 0, "creation_date": 1501102373, "post_id": 45336286, "comment_id": 77636394, "body": "If they wanted to look at speed and simplicity of finding a solution. Record macro and drag the shapes to desired locations. It will be a solution within 1 minute . Question is how it would be received haha"}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1501178178, "post_id": 45336286, "comment_id": 77677234, "body": "@tigeravatar... Thanks for this wonderful code... I tried this code by inserting shapes within Excel... Its working fine.. However, it is placing rectangle before triangle... I am not sure if I did something wrong..."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1501178650, "post_id": 45336286, "comment_id": 77677479, "body": "@user3228901 As I specifically stated in my comments within the code:     <code>Sort order will be by the AutoShapeType numerical ID</code>, <code>Using this, shapes will be sorted in this order (incomplete list for brevity): Rectangle, Parallelogram, Trapezoid, Diamond, Rounded rectangle, Octagon, Isosceles triangle, Right triangle, Oval, Hexagon</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1501178730, "post_id": 45336286, "comment_id": 77677531, "body": "@user3228901 I also specifically stated this: <code>Note that you can use a Select Case to order shapes to a more customized list</code>.  I did not specifically put circles first, but that could easily be done.  I&#39;ll leave it to you to figure out how"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1501098986, "creation_date": 1501098986, "answer_id": 45336286, "question_id": 45335779, "link": "https://stackoverflow.com/questions/45335779/vba-need-to-sort-shapes/45336286#45336286", "title": "VBA: need to sort shapes", "body": "<p>It was an interesting challenge, so I did it.  Might as well post the result (commented for clarity):</p>\n\n<pre><code>Sub tgr()\n\n    'There are 184 total AutoShapeTypes\n    'See here for full list\n    'https://msdn.microsoft.com/VBA/Office-Shared-VBA/articles/msoautoshapetype-enumeration-office\n    Dim aShapeTypes(1 To 184) As String\n\n    Dim ws As Worksheet\n    Dim Shp As Shape\n    Dim i As Long, j As Long\n    Dim vShpName As Variant\n    Dim dLeftAlign As Double\n    Dim dTopAlign As Double\n    Dim dVerticalInterval As Double\n    Dim dHorizontalInterval As Double\n    Dim dPadding As Double\n\n    Set ws = ActiveWorkbook.ActiveSheet\n\n    'Sort order will be by the AutoShapeType numerical ID\n    'Using this, shapes will be sorted in this order (incomplete list for brevity):\n    '   Rectangle, Parallelogram, Trapezoid, Diamond, Rounded rectangle, Octagon, Isosceles triangle, Right triangle, Oval, Hexagon\n    'Note that you can use a Select Case to order shapes to a more customized list\n    'I use this method to put the -2 (indicates a combination of the other states) at the bottom of the sort order\n    For Each Shp In ws.Shapes\n        Select Case Shp.AutoShapeType\n            Case -2:    aShapeTypes(UBound(aShapeTypes)) = aShapeTypes(UBound(aShapeTypes)) &amp; \"||\" &amp; Shp.Name\n            Case Else:  aShapeTypes(Shp.AutoShapeType) = aShapeTypes(Shp.AutoShapeType) &amp; \"||\" &amp; Shp.Name\n        End Select\n    Next Shp\n\n    'Now that all shapes have been collected and put into their sort order, perform the actual sort operation\n    'Adjust the alignment and vertical veriables as desired\n    'The Padding variable is so that the shapes don't start at the very edge of the sheet (can bet set to 0 if that's fine)\n    'I have it currently set to sort the shapes vertically, but they can be sorted horizontally by uncommenting those lines and commenting out the vertical sort lines\n\n    dPadding = 10\n    dLeftAlign = 5\n    dTopAlign = 5\n    dVerticalInterval = 40\n    dHorizontalInterval = 40\n\n    j = 0\n    For i = LBound(aShapeTypes) To UBound(aShapeTypes)\n        If Len(aShapeTypes(i)) &gt; 0 Then\n            For Each vShpName In Split(Mid(aShapeTypes(i), 3), \"||\")\n                With ws.Shapes(vShpName)\n\n                    'Vertical Sort\n                    .Left = dLeftAlign\n                    .Top = j * dVerticalInterval + dPadding\n\n                    'Horizont Sort\n                    '.Top = dTopAlign\n                    '.Left = j * dHorizontalInterval + dPadding\n\n                End With\n                j = j + 1\n            Next vShpName\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1501098986, "creation_date": 1501097053, "question_id": 45335779, "link": "https://stackoverflow.com/questions/45335779/vba-need-to-sort-shapes", "title": "VBA: need to sort shapes", "body": "<p>Recently, in an interview I encountered a question in VBA. The question is:</p>\n\n<p>Write a program to sort the shapes in a worksheet, like for example : I have various shapes like circle, triangle, rectangle, pentagon... This needs to be sorted and placed one below the other. \nI tried with Shapes object and msoshapeRectangle method. But it didnt work.</p>\n\n<p>Could you please tell me is this possible to be done?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 1, "creation_date": 1501097037, "post_id": 45335719, "comment_id": 77633411, "body": "Check your spelling:  addCarriageReturns vs addCarraigeReturns"}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 1, "creation_date": 1501097050, "post_id": 45335719, "comment_id": 77633420, "body": "Turn on Option Explicit"}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "reply_to_user": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 0, "creation_date": 1501097296, "post_id": 45335719, "comment_id": 77633563, "body": "@GordonBell the spelling was it. Thanks."}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 0, "creation_date": 1501097459, "post_id": 45335719, "comment_id": 77633678, "body": "Save yourself the headaches, and never do VBA without &quot;Option Explicit&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 0, "creation_date": 1501097954, "post_id": 45335877, "comment_id": 77633973, "body": "Because apparently I&#39;m a masochist and do things the harder way. :)  I forgot that replace isn&#39;t destructive to the rest of the string, but only affects the part you specify."}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "reply_to_user": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 0, "creation_date": 1501268660, "post_id": 45335877, "comment_id": 77722928, "body": "Not to worry, happens to all of us. :)"}], "tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": true, "score": 1, "last_activity_date": 1501097382, "creation_date": 1501097382, "answer_id": 45335877, "question_id": 45335719, "link": "https://stackoverflow.com/questions/45335719/vba-function-not-returning-value/45335877#45335877", "title": "VBA Function not Returning Value", "body": "<p>I'm just curious, why do you want separate functions like this?  </p>\n\n<p>Can you just use:</p>\n\n<pre><code>line = Replace(line, \"SALE\", \"SALE\" &amp; Chr(13))\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1937, "favorite_count": 0, "accepted_answer_id": 45335877, "answer_count": 1, "score": 0, "last_activity_date": 1501097382, "creation_date": 1501096828, "question_id": 45335719, "link": "https://stackoverflow.com/questions/45335719/vba-function-not-returning-value", "title": "VBA Function not Returning Value", "body": "<p>I have a VBA code that's designed to search a CSV String and add Carriage Returns where they should exist. I've split it up into two seperate functions - one to search the string and put the index of where the CRs should go into an array and a second function to actually add the CRs.</p>\n\n<p>The issue I'm running into is that the value in the immediate window/in the watch window for the functions is correct within the function itself, but it assigns the result variable a blank string.</p>\n\n<pre><code>'*****************Import CSV**********************\n'Took this straight off the internet because it was reading Jet.com files as one single line\n'\nSub ImportCSVFile(filepath As String)\n\n    .....\n    line = SearchString(line, \"SALE\")\n    .....\n\nEnd Sub\n\n'****************Search String***************************\n    'This is search the string for something - It will then call a function to insert carriage returns\n\nFunction SearchString(source As String, target As String) As String\n\nDim i As Integer\nDim k As Integer\nDim myArray() As Variant\n\nDim resultString As String\n\nDo\n    i = i + 1\n    If Mid(source, i, Len(target)) = target Then\n        ReDim Preserve myArray(k)\n        myArray(k) = i\n        k = k + 1\n    End If\nDoEvents\nLoop Until i = Len(source)\n\nresultString = addCarriageReturns(source, myArray) 'resultString here is assigned a blank string\nSearchString = resultString\n\nEnd Function\n\n'***************Add Carraige Returns**************************\n'Cycle through the indices held in the array and place carriage returns into the string\n\n\nFunction addCarriageReturns(source As String, myArray As Variant) As String\n\nDim i As Integer\nDim resultString As String\n\nresultString = source\n\nFor i = 0 To UBound(myArray, 1)\n    resultString = Left(resultString, myArray(i) + i) &amp; Chr(13) &amp; Right(resultString, Len(resultString) - myArray(i) + i)\nNext i\n\naddCarraigeReturns = resultString 'The value of addCarriageReturn is correct in the immediate window here\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/s2cqa.png\" rel=\"nofollow noreferrer\">In the function the value is not blank</a>\n<a href=\"https://i.stack.imgur.com/AZ1Ff.png\" rel=\"nofollow noreferrer\">...but when it passes it back, it says the value is blank</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1501096560, "post_id": 45335603, "comment_id": 77633164, "body": "Have a look at the <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Split Function</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1501096657, "creation_date": 1501096657, "answer_id": 45335670, "question_id": 45335603, "link": "https://stackoverflow.com/questions/45335603/vba-returning-values-from-split-string/45335670#45335670", "title": "VBA Returning Values from Split String", "body": "<p>Try using the <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\"><code>Split</code> function</a> on your value:</p>\n\n<pre><code>Dim elements, ele  '' Declared implicitly as Variant type\n\nelements = Split(Linerange.Value, \"@\")\nFor Each ele in elements\n    Debug.Print ele\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1501096685, "creation_date": 1501096685, "answer_id": 45335678, "question_id": 45335603, "link": "https://stackoverflow.com/questions/45335603/vba-returning-values-from-split-string/45335678#45335678", "title": "VBA Returning Values from Split String", "body": "<pre><code>Dim vSplit As Variant\nvSplit=Split(Linerange.Value,\"@\")\n</code></pre>\n\n<p>You then have an array of <code>vSplit()</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8372079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214495332083618/picture?type=large", "display_name": "Justin Pinizzotto", "link": "https://stackoverflow.com/users/8372079/justin-pinizzotto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501096685, "creation_date": 1501096472, "last_edit_date": 1501096531, "question_id": 45335603, "link": "https://stackoverflow.com/questions/45335603/vba-returning-values-from-split-string", "title": "VBA Returning Values from Split String", "body": "<p>I am attempting to return and define the split values of a defined string. (in vba) The delimiter of the cell is \"@\". </p>\n\n<p>Here is an example: \"Element1@Element2@Element3@Element4\"</p>\n\n<p>I have been successful in doing this when it is only \"Element1@Element2\" using the following code:</p>\n\n<pre><code>Sheet1.Range(\"B1\").Value = Linerange.Value\n\nDim Element1 As String\nDim Element2 As String\n\nElement1 = Left(Linerange.Value, InStr(1, Linerange.Value, \"@\") - 2)\nElement2 = Right(Linerange.Value, Len(Linerange.Value) - InStr(1, Linerange.Value, \"@\") - 1)\n</code></pre>\n\n<p>Any idea how to approach this and define values for Element3 and Element4?</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1501096464, "post_id": 45335596, "comment_id": 77633107, "body": "<code>Cells(fRow + 1, 2).Formula = &quot;=SUM(B2:B&quot; &amp; fRow &amp; &quot;)&quot;</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501133721, "post_id": 45335596, "comment_id": 77645699, "body": "neither of the posted responses mentioned this ... in case you are a beginner ... do web search for &quot;how to concatenate strings in VBA&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "is_accepted": true, "score": 0, "last_activity_date": 1501096804, "creation_date": 1501096804, "answer_id": 45335710, "question_id": 45335596, "link": "https://stackoverflow.com/questions/45335596/how-to-pass-an-integer-variable-into-a-formula-using-vba/45335710#45335710", "title": "How to Pass an Integer Variable Into a Formula Using VBA", "body": "<p>The error is in the part</p>\n\n<pre><code>\"SUM(B2:B\"fRow\")\"\n</code></pre>\n\n<p>It should be </p>\n\n<pre><code>\"SUM(B2:B\" &amp; fRow &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 8098080, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7c5443ac2a244df008b66c55997f4d9b?s=128&d=identicon&r=PG&f=1", "display_name": "W.Harr", "link": "https://stackoverflow.com/users/8098080/w-harr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 45335710, "answer_count": 1, "score": 0, "last_activity_date": 1501096804, "creation_date": 1501096410, "question_id": 45335596, "link": "https://stackoverflow.com/questions/45335596/how-to-pass-an-integer-variable-into-a-formula-using-vba", "title": "How to Pass an Integer Variable Into a Formula Using VBA", "body": "<p>I'm currently trying to use an integer variable into a Sum formula using VBA. I've referenced <a href=\"https://stackoverflow.com/questions/11337510/sum-formula-vba\">this question</a> as well as <a href=\"https://stackoverflow.com/questions/37972695/how-to-pass-an-integer-variable-into-a-vba-formula\">this question</a> and implemented the subsequent recommendations but I'm still getting a Syntax error when I try to run the sub.  </p>\n\n<p>My code is the following:</p>\n\n<pre><code>Sub Sum_Column()\nDim fRow As Integer\nfRow = Cells(Rows.Count, 2).End(xlUp).Row\nCells(fRow + 1, 2).Formula = \"=SUM(B2:B\"fRow\")\"\nEnd Sub\n</code></pre>\n\n<p>Any help you can provide will be greatly appreciated. </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "is_accepted": true, "score": 1, "last_activity_date": 1501137169, "creation_date": 1501137169, "answer_id": 45342975, "question_id": 45335475, "link": "https://stackoverflow.com/questions/45335475/only-update-fields-that-have-formulas-in-microsoft-word/45342975#45342975", "title": "Only update fields that have formulas in Microsoft Word", "body": "<p>This is how you could do it.</p>\n\n<pre><code>Private WithEvents App As Word.Application\n\nPrivate Sub Document_Open()\n  Set App = Word.Application\n  UpdateSumFields\nEnd Sub\n\nPrivate Sub App_WindowSelectionChange(ByVal Sel As Selection)\n  UpdateSumFields\nEnd Sub\n\nPrivate Sub UpdateSumFields()\n    Dim field As field\n\n    For Each field In ActiveDocument.Fields\n        If CStr(field.Code) Like \"*=SUM(Sect1A3)*\" Then\n            field.Update\n        End If\n    Next field\nEnd Sub\n</code></pre>\n\n<p>Put whatever in the <code>like</code> statement. I'm sure there is a better way to make it more reusable. Maybe use an array with multiple fields you would like to update in one goal.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>Private Sub UpdateFieldExtended()\n    Dim field As field\n    Dim fieldCodePattern(1 To 5) As String\n\n    fieldCodePattern(1) = \"=SUM\"\n    fieldCodePattern(2) = \"TOC\"\n    fieldCodePattern(3) = \"REF\"\n    fieldCodePattern(4) = \"STYLEREF\"\n    fieldCodePattern(5) = \"DATE\"\n\n    For Each field In ActiveDocument.Fields\n        If IsInArray(CStr(field.Code), fieldCodePattern) Then\n            field.Update\n        End If\n    Next field\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    For i = 1 To UBound(arr)\n        If Trim(stringToBeFound) Like \"*\" + arr(i) + \"*\" Then\n            IsInArray = True\n            Exit For\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7674889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4H05C.jpg?s=128&g=1", "display_name": "jpears", "link": "https://stackoverflow.com/users/7674889/jpears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 45342975, "answer_count": 1, "score": 0, "last_activity_date": 1501137169, "creation_date": 1501096006, "question_id": 45335475, "link": "https://stackoverflow.com/questions/45335475/only-update-fields-that-have-formulas-in-microsoft-word", "title": "Only update fields that have formulas in Microsoft Word", "body": "<p>I have the following code:</p>\n\n<pre><code>Private WithEvents App As Word.Application\n\n\nPrivate Sub Document_Open()\n  Set App = Word.Application\n  ActiveDocument.Fields.Update\nEnd Sub\n\nPrivate Sub App_WindowSelectionChange(ByVal Sel As Selection)\n  ActiveDocument.Fields.Update\nEnd Sub\n</code></pre>\n\n<p>This code updates all fields in a Word template automatically. My question is, can it be altered to only update fields that contain formulas? For example, getting the value of bookmark Sect1 when the field receiving the information contains {=SUM(Sect1A3).</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "named-ranges"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501096174, "post_id": 45335468, "comment_id": 77632947, "body": "is your sheet named <code>Sheet 4</code> or <code>Sheet4</code> ?"}, {"owner": {"reputation": 1, "user_id": 8372026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750b73ce9351d4a127bb6e3cc4b9011?s=128&d=identicon&r=PG&f=1", "display_name": "1honeybadger", "link": "https://stackoverflow.com/users/8372026/1honeybadger"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501096293, "post_id": 45335468, "comment_id": 77633014, "body": "It&#39;s actually Sheet4. Now I get the error 1004: Application-defined or object-defined error."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501151738, "post_id": 45335468, "comment_id": 77657553, "body": "What, exactly, is the range on the worksheet to which you want the name to refer to?  Or is it an array and not a range?"}, {"owner": {"reputation": 1, "user_id": 8372026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750b73ce9351d4a127bb6e3cc4b9011?s=128&d=identicon&r=PG&f=1", "display_name": "1honeybadger", "link": "https://stackoverflow.com/users/8372026/1honeybadger"}, "edited": false, "score": 0, "creation_date": 1501155957, "post_id": 45335468, "comment_id": 77660562, "body": "It&#39;s a range. The ranges are different sizes, but they&#39;re separated by the range names which are bold."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8372026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750b73ce9351d4a127bb6e3cc4b9011?s=128&d=identicon&r=PG&f=1", "display_name": "1honeybadger", "link": "https://stackoverflow.com/users/8372026/1honeybadger"}, "is_accepted": true, "score": 0, "last_activity_date": 1501336573, "creation_date": 1501336573, "answer_id": 45390066, "question_id": 45335468, "link": "https://stackoverflow.com/questions/45335468/naming-many-ranges-of-variable-length/45390066#45390066", "title": "Naming Many Ranges of Variable Length", "body": "<p>I figured it out. I had to make a ton of replacements in names so they could be proper range names. The Range names are bold and the values are not.</p>\n\n<pre><code>Option Explicit\n\nSub Change_Name()\n\nDim Rng As Range\nDim cell As String\nDim RngName As String\nDim MyADD As Range\nSet MyADD = Nothing\nSheets(\"Sheet6\").Select\nRange(\"F1\").Activate\n\nSet Rng = Nothing\n\n While Not IsEmpty(ActiveCell.Value)\n\nIf ActiveCell.Font.Bold = True Then\n\nActiveCell.Replace \" \", \"\"\nActiveCell.Replace \"&amp;\", \"_\"\nActiveCell.Replace \"/\", \".\"\nActiveCell.Replace \"-\", \"\"\nActiveCell.Replace \"(\", \"_\"\nActiveCell.Replace \")\", \"_\"\nActiveCell.Replace \",\", \"_\"\nRngName = ActiveCell.Value\nSelection.Offset(1, 0).Select\n\n    While ActiveCell.Font.Bold = False And IsEmpty(ActiveCell.Value) = False\n\n        If Rng Is Nothing Then\n            Set Rng = Range(ActiveCell.Address)\n            Selection.Offset(1, 0).Select\n        Else\n            Set MyADD = Range(ActiveCell.Address)\n            Set Rng = Union(Rng, MyADD)\n            Selection.Offset(1, 0).Select\n        End If\n    Wend\n\n    ActiveWorkbook.Names.Add Name:=RngName, RefersTo:=Rng\n    Set Rng = Nothing\n\nEnd If\n  Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8372026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750b73ce9351d4a127bb6e3cc4b9011?s=128&d=identicon&r=PG&f=1", "display_name": "1honeybadger", "link": "https://stackoverflow.com/users/8372026/1honeybadger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 45390066, "answer_count": 1, "score": 0, "last_activity_date": 1501336573, "creation_date": 1501095982, "question_id": 45335468, "link": "https://stackoverflow.com/questions/45335468/naming-many-ranges-of-variable-length", "title": "Naming Many Ranges of Variable Length", "body": "<p>I've got a long list of values in a column that I want to make named ranges:</p>\n\n<ul>\n<li><strong>A1010 STANDARD FOUNDATIONS</strong></li>\n<li>A101001 WALL FOUNDATIONS</li>\n<li>A101001 COLUMN FOUNDATIONS &amp; PILE CAPS</li>\n<li><strong>A1020 SPECIAL FOUNDATIONS</strong></li>\n<li>A102001 PILE FOUNDATIONS</li>\n</ul>\n\n<p>Where the names of each range should be the bolded cells.</p>\n\n<p>This is what I've got so far, I'm sure it's clunky but it's mine (sort of); I've cobbled it together from other bits and pieces of code I've found in other questions. It's supposed to name a range with the bold text minus the spaces; then repeatedly delete the named range and add it again with each new non-bold string.</p>\n\n<p>When I try to run it, I get the error: Runtime error 9; subscript out of range.</p>\n\n<p>I think I'm hung on the \"RefersToR1C1\" thing, which I googled but it didn't make sense to me.</p>\n\n<pre><code>Sub Change_Name()\n\nDim RngName As String\nDim MyADD As String\n\nSheets(\"Sheet 4\").Select\nRange(\"C2\").Select\n\n While Not IsEmpty(ActiveCell.Value)\n\nIf ActiveCell.Font.Bold = True Then\n\nActiveCell.Replace \" \", \"\"\nRngName = ActiveCell.Value\n\nElse\n\nMyADD = ActiveWorkbook.Names(RngName).RefersToR1C1\nMyADD = MyADD &amp; \",\" &amp; CStr(ActiveCell)\nActiveWorkbook.Names(\"RngName\").Delete\nActiveWorkbook.Names.Add Name:=\"RngName\", RefersToR1C1:=MyADD\n\nEnd If\n\nSelection.Offset(1, 0).Select\n\nWend\n\nEnd Sub\n</code></pre>\n\n<p>I feel like I'm close, which is what I thought several hours ago. Any help is appreciated. I only know enough vba to break things and waste my time, so assume I know nothing.</p>\n"}, {"tags": ["vba", "visio"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5360416, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-6METsHDkgFw/AAAAAAAAAAI/AAAAAAAAAHU/v_WNov3JGTs/photo.jpg?sz=128", "display_name": "Cjust689", "link": "https://stackoverflow.com/users/5360416/cjust689"}, "edited": false, "score": 0, "creation_date": 1501112528, "post_id": 45336167, "comment_id": 77640207, "body": "thanks I wasn&#39;t aware .Value is not applicable.  I ended up using the following:<a href=\"https://msdn.microsoft.com/pt-br/subscriptions/ms427197.aspx\" rel=\"nofollow noreferrer\">avarFormulaArray</a>   According to the spec it grabs the formula of the cell. I may be stuck with my design as is. There&#39;s no context to find the value later on in my macro. I&#39;ve worked around this problem with some compromises."}], "tags": [], "owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "is_accepted": false, "score": 0, "last_activity_date": 1501106965, "last_edit_date": 1501106965, "creation_date": 1501098510, "answer_id": 45336167, "question_id": 45335418, "link": "https://stackoverflow.com/questions/45335418/vba-cant-return-value-from-cell-visio/45336167#45336167", "title": "VBA Can&#39;t return value from cell (Visio)", "body": "<p>In MS Visio haven't <strong>.Value</strong> !It have <strong>.Result</strong> \nWhat kind of data type you can use in this field ?</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 5360416, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-6METsHDkgFw/AAAAAAAAAAI/AAAAAAAAAHU/v_WNov3JGTs/photo.jpg?sz=128", "display_name": "Cjust689", "link": "https://stackoverflow.com/users/5360416/cjust689"}, "edited": false, "score": 0, "creation_date": 1501174541, "post_id": 45351806, "comment_id": 77675008, "body": "Thank you much John, this worked perfectly!!!  Just out of curiosity, what resources do you use for VB/VBA/VBscript. I&#39;m very new and have had trouble finding good resources especially those that refer to VBA in Visio. I am aware of Visio guy which has really bene the only comprehensive resource other than micorosoft., but microsoft lacks any &#39;community/ commentary&#39;  like what we find on stackoverflow etc...Thanks Again!"}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "reply_to_user": {"reputation": 73, "user_id": 5360416, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-6METsHDkgFw/AAAAAAAAAAI/AAAAAAAAAHU/v_WNov3JGTs/photo.jpg?sz=128", "display_name": "Cjust689", "link": "https://stackoverflow.com/users/5360416/cjust689"}, "edited": false, "score": 0, "creation_date": 1501183508, "post_id": 45351806, "comment_id": 77680218, "body": "Primarily I use the VBA macro recorder in Visio, which is by far the easiest way to learn all these things.  The next best is to keep searching stack overflow and asking questions when you can&#39;t find the answer.  The MSDN documentation for Visio Automation is pretty poor, but it at least sometimes tells you something useful.  You might want to get the Visio Developer&#39;s Survival Guide, which can be helpful.  I don&#39;t know if it&#39;s up to date, but the 2003 version holds up still."}], "tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": true, "score": 1, "last_activity_date": 1501161046, "creation_date": 1501161046, "answer_id": 45351806, "question_id": 45335418, "link": "https://stackoverflow.com/questions/45335418/vba-cant-return-value-from-cell-visio/45351806#45351806", "title": "VBA Can&#39;t return value from cell (Visio)", "body": "<p>Use .Result(visUnitCode) or .ResultIU() to get the value from a cell.</p>\n"}, {"tags": [], "owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "is_accepted": false, "score": 0, "last_activity_date": 1501220542, "last_edit_date": 1501220542, "creation_date": 1501194681, "answer_id": 45362055, "question_id": 45335418, "link": "https://stackoverflow.com/questions/45335418/vba-cant-return-value-from-cell-visio/45362055#45362055", "title": "VBA Can&#39;t return value from cell (Visio)", "body": "<p>Literature about Visio VBA:  </p>\n\n<blockquote>\n  <p><a href=\"http://flylib.com/books/en/2.268.1.1/1/\" rel=\"nofollow noreferrer\">Developing Microsoft Visio Solutions (Pro-Documentation)</a><br>\n  <a href=\"http://www.packtpub.com/sites/default/files/0141-chapter-2-understanding-the-microsoft-visio-object%20.pdf?utm_source=packtpub&amp;utm_medium=free&amp;utm_campaign=pdf\" rel=\"nofollow noreferrer\">Chapter No.2 \"Understanding the Microsoft Visio Object Model</a> from book <a href=\"https://www.packtpub.com/hardware-and-creative/microsoft-visio-2010-business-process-diagramming-and-validation\" rel=\"nofollow noreferrer\">Microsoft Visio 2010 Business Process Diagramming and Validation</a> by <a href=\"https://mvp.microsoft.com/en-us/PublicProfile/21090?fullName=David%20John%20Parker\" rel=\"nofollow noreferrer\">David John Parker</a><br>\n  <a href=\"http://www.packtpub.com/sites/default/files/9781782178002_Chapter-03.pdf?utm_source=packtpub&amp;utm_medium=free&amp;utm_campaign=pdf\" rel=\"nofollow noreferrer\">Chapter No. 3 Understanding the ShapeSheet\u2122</a> from book <a href=\"http://www.packtpub.com/microsoft-visio-2013-business-process-diagramming-and-validation\" rel=\"nofollow noreferrer\">Microsoft Visio 2013 Business Process Diagramming and Validation</a> by David John Parker</p>\n</blockquote>\n\n<p>Video:</p>\n\n<blockquote>\n  <p><a href=\"https://channel9.msdn.com/Blogs/MVP-Office-Dev/Visio-a-flyby-for-developers-Part-2\" rel=\"nofollow noreferrer\">Visio, a flyby for developers (Part 2)</a> by <a href=\"https://mvp.microsoft.com/en-us/PublicProfile/4020443?fullName=John%20%20Goldsmith\" rel=\"nofollow noreferrer\">John Goldsmith</a> / <a href=\"https://stackoverflow.com/users/683606/johngoldsmith\">John Goldsmith on Stackoverflow</a></p>\n</blockquote>\n"}], "owner": {"reputation": 73, "user_id": 5360416, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh5.googleusercontent.com/-6METsHDkgFw/AAAAAAAAAAI/AAAAAAAAAHU/v_WNov3JGTs/photo.jpg?sz=128", "display_name": "Cjust689", "link": "https://stackoverflow.com/users/5360416/cjust689"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "accepted_answer_id": 45351806, "answer_count": 3, "score": 0, "last_activity_date": 1501220542, "creation_date": 1501095818, "last_edit_date": 1501180036, "question_id": 45335418, "link": "https://stackoverflow.com/questions/45335418/vba-cant-return-value-from-cell-visio", "title": "VBA Can&#39;t return value from cell (Visio)", "body": "<p>I have a visio document with shapes and relevant shape data. Im attempting to pull data from these shapes.\nA few of the shape data fields are formulas (which display the correct value in Visio) however when getting those values I'm not sure how to return the value as a string.</p>\n\n<p>Here is the call:</p>\n\n<pre><code>avarFormulaArray(iCell) = \nshp.CellsSRC(Visio.VisSectionIndices.visSectionProp, iRow, \nVisio.VisCellIndices.visCustPropsValue).FormulaU\n</code></pre>\n\n<p>These easy answer is use <code>.Result</code> instead of <code>.FormulaU</code> however that won't work as it's not of the correct type (FormulaArray) which must be a formula. Not sure how to get around this at the moment.\nAny help is appreciated.</p>\n\n<p><strong>Solution using @JonFournier 's advice</strong></p>\n\n<pre><code>\"\"\"\" &amp; shp.CellsSRC(Visio.VisSectionIndices.visSectionProp, iRow, Visio.VisCellIndices.visCustPropsValue).ResultStr(Visio.VisUnitCodes.visNoCast) &amp; \"\"\"\"\n</code></pre>\n\n<p>The following snippet ensures no matter what is in the shape sheet cell the resulting value/string is returned.\n<code>.ResultStr(Visio.VisUnitCodes.visNoCast)</code></p>\n\n<p>The addition of the quotes appended to the beginning and end give me the result (value/string) as if it was returned using my original `.FormulaU' but will compute the formulas and return the values rather than the actual formula.</p>\n\n<p>The use of <code>.ResultU</code> or <code>.Result</code> will return 0 for everything that isn't a value thus strings wont work as they are returned as 0. </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6626170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59bc7c48a25770da4c3e9dde31fb28a9?s=128&d=identicon&r=PG&f=1", "display_name": "nehshere", "link": "https://stackoverflow.com/users/6626170/nehshere"}, "edited": false, "score": 0, "creation_date": 1501097341, "post_id": 45335496, "comment_id": 77633593, "body": "thanks for the formula. It works, but I noticed that when nothing from the lookup table matches, the formula just returns the same value as that in the cell from column V. Is there a way for it to return a blank cell if nothing from the lookup table matches.  For example, &#39;MAN:AMS&#39; should return a blank cell rather than returning &#39;MAN:AMS&#39;."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 6626170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59bc7c48a25770da4c3e9dde31fb28a9?s=128&d=identicon&r=PG&f=1", "display_name": "nehshere", "link": "https://stackoverflow.com/users/6626170/nehshere"}, "edited": false, "score": 0, "creation_date": 1501097794, "post_id": 45335496, "comment_id": 77633883, "body": "That specification was not in your original question, or did I miss something?"}, {"owner": {"reputation": 5, "user_id": 6626170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59bc7c48a25770da4c3e9dde31fb28a9?s=128&d=identicon&r=PG&f=1", "display_name": "nehshere", "link": "https://stackoverflow.com/users/6626170/nehshere"}, "edited": false, "score": 0, "creation_date": 1501098142, "post_id": 45335496, "comment_id": 77634067, "body": "No you didn&#39;t miss anything. My apologies as I just didn&#39;t realise it earlier. With the current formula it replaces one or both the codes in the cell in column V, if matched with the table. I would like to add another bit to it so that when none of the two codes match anything in the table, it should return a blank cell. Sorry for the extra work. Your help is really appreciated."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 6626170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59bc7c48a25770da4c3e9dde31fb28a9?s=128&d=identicon&r=PG&f=1", "display_name": "nehshere", "link": "https://stackoverflow.com/users/6626170/nehshere"}, "edited": false, "score": 0, "creation_date": 1501098243, "post_id": 45335496, "comment_id": 77634126, "body": "Then that is a new question, and deserves a new post.  try to figure it out on your own and post your attempts with your question when you get stuck.  It will involve an IF() formula.  This answered your posted question.  Please mark as correct."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1501096077, "creation_date": 1501096077, "answer_id": 45335496, "question_id": 45335333, "link": "https://stackoverflow.com/questions/45335333/multiple-substitue-or-replace-text-in-excel-using-a-table/45335496#45335496", "title": "Multiple substitue or replace text in excel using a table", "body": "<p>This will do as you ask:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(V2,LEFT(V2,3),IFERROR(VLOOKUP(LEFT(V2,3),R:S,2,FALSE),LEFT(V2,3))),RIGHT(SUBSTITUTE(V2,LEFT(V2,3),IFERROR(VLOOKUP(LEFT(V2,3),R:S,2,FALSE),LEFT(V2,3))),3),IFERROR(VLOOKUP(RIGHT(SUBSTITUTE(V2,LEFT(V2,3),IFERROR(VLOOKUP(LEFT(V2,3),R:S,2,FALSE),LEFT(V2,3))),3),R:S,2,FALSE),RIGHT(SUBSTITUTE(V2,LEFT(V2,3),IFERROR(VLOOKUP(LEFT(V2,3),R:S,2,FALSE),LEFT(V2,3))),3)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fFiSC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fFiSC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 6626170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59bc7c48a25770da4c3e9dde31fb28a9?s=128&d=identicon&r=PG&f=1", "display_name": "nehshere", "link": "https://stackoverflow.com/users/6626170/nehshere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1187, "favorite_count": 0, "accepted_answer_id": 45335496, "answer_count": 1, "score": 0, "last_activity_date": 1501248375, "creation_date": 1501095505, "last_edit_date": 1501096790, "question_id": 45335333, "link": "https://stackoverflow.com/questions/45335333/multiple-substitue-or-replace-text-in-excel-using-a-table", "title": "Multiple substitue or replace text in excel using a table", "body": "<p>I'd like to create a super substitute function in excel (if there is such a thing). For my needs, nesting is insufficient because my substitution list is long. </p>\n\n<p>What I'd like to do is have a named table with two columns for the function to use as a look-up for potential substitutions. The first column would contain the original text and the second would contain the replacement text. </p>\n\n<p><a href=\"https://i.stack.imgur.com/n9gY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n9gY7.png\" alt=\"Sample Data\"></a></p>\n\n<p>If we look at the above example, the columns R and S consists of my table, with column R as the original text that I wanted replaced with the equivalent row entry in column S, if found in my list. My data in column V is the list that I want to work on. I want the formula in column W to look at the equivalent entry in column V and lookup in the table for any matches within the text. If there is a match, then I want that text from column R replaced with the text in column S. In some cases there can be 2 matches, as with the top example of 'LHR:JFK' which should ideally get replaced to 'LON:NYC'.</p>\n\n<p>There are ways to do this with VBA but I would like to know if there is an Excel formula option for the same as I don't know where to begin with VBA.</p>\n\n<p>Your help is greatly appreciated.</p>\n\n<p>Thanks,\nNeha</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501135067, "post_id": 45335166, "comment_id": 77646229, "body": "that web page appears to have script errors ... internet explorer throws an error ... change your code to <code>.Visible = True</code>"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5484402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_K-nVZXaLVs/AAAAAAAAAAI/AAAAAAAAAJA/qCdlZNZAJRs/photo.jpg?sz=128", "display_name": "Arun Raj", "link": "https://stackoverflow.com/users/5484402/arun-raj"}, "reply_to_user": {"reputation": 59, "user_id": 4443525, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1b27c7aeeb9e2a103cffc5d7ee0ca16b?s=128&d=identicon&r=PG&f=1", "display_name": "MathHopeful", "link": "https://stackoverflow.com/users/4443525/mathhopeful"}, "edited": false, "score": 0, "creation_date": 1501135508, "post_id": 45335474, "comment_id": 77646408, "body": "You have used set to get the text property. Don&#39;t use set.  I have not used &quot;set&quot; for getting the value"}], "tags": [], "owner": {"reputation": 47, "user_id": 5484402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_K-nVZXaLVs/AAAAAAAAAAI/AAAAAAAAAJA/qCdlZNZAJRs/photo.jpg?sz=128", "display_name": "Arun Raj", "link": "https://stackoverflow.com/users/5484402/arun-raj"}, "is_accepted": false, "score": 1, "last_activity_date": 1501096002, "creation_date": 1501096002, "answer_id": 45335474, "question_id": 45335166, "link": "https://stackoverflow.com/questions/45335166/using-the-internet-explorer-object-to-scrape-information/45335474#45335474", "title": "Using the Internet Explorer object to scrape information?", "body": "<p>Try these lines of code </p>\n\n<p>testing = appIE.document.getElementsByClassName(\"quote-name\")(0).textContent</p>\n\n<p>Debug.Print (testing)</p>\n"}], "owner": {"reputation": 59, "user_id": 4443525, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1b27c7aeeb9e2a103cffc5d7ee0ca16b?s=128&d=identicon&r=PG&f=1", "display_name": "MathHopeful", "link": "https://stackoverflow.com/users/4443525/mathhopeful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501096002, "creation_date": 1501094924, "last_edit_date": 1531164843, "question_id": 45335166, "link": "https://stackoverflow.com/questions/45335166/using-the-internet-explorer-object-to-scrape-information", "title": "Using the Internet Explorer object to scrape information?", "body": "<p>I am attempting to scrape some information from a website. The link I am referencing is: <a href=\"https://web.tmxmoney.com/quote.php?qm_symbol=WEED\" rel=\"nofollow noreferrer\">https://web.tmxmoney.com/quote.php?qm_symbol=WEED</a></p>\n\n<p>I'm creating an Internet Explorer object with the following:</p>\n\n<pre><code>Dim appIE As Object\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nDim ticker As String\nticker = \"BRB\"\n\nWith appIE\n    .Navigate \"https://web.tmxmoney.com/quote.php?qm_symbol=\" &amp; ticker\n    .Visible = False\nEnd With\n\nDo While appIE.Busy\nLoop\n</code></pre>\n\n<p>I am then attempting to get the contents of a class with the following:</p>\n\n<pre><code>Set testing = appIE.document.getElementsByClassName(\"quote-name\")(0).textContent\nDebug.Print (testing)\n</code></pre>\n\n<p>However, I am receiving the error: <code>Type Mismatach</code>. The following code will run fine though: <code>appIE.document.getElementsByClassName(\"quote-name\")</code>.</p>\n\n<p>My desired content is the following and can run this fine in the IE console.</p>\n\n<pre><code>\"\n                    Brick Brewing Co. Limited\n                    Exchange: TSX Exchange |\n                                                        Jul 26, 2017, 2:46 PM EDT                                               \"\n</code></pre>\n\n<p>Any ideas on what might be wrong?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1501095066, "post_id": 45335159, "comment_id": 77632361, "body": "Try listing the fields instead of using <code>*</code>."}, {"owner": {"reputation": 1, "user_id": 8371941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e9e3c349f0bf0e06c49b1f88b0755f?s=128&d=identicon&r=PG&f=1", "display_name": "TRA", "link": "https://stackoverflow.com/users/8371941/tra"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1501148882, "post_id": 45335159, "comment_id": 77655384, "body": "Sadly that doesn&#39;t solve the Problem. But thanks for trying. ;)"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1501159524, "post_id": 45335159, "comment_id": 77663287, "body": "To be clear, when both queries have at least one record, or if query2 has at least one record, everything works as expected? It is only when query1 returns no records that the issue occurs? Can you provide the SQL for these queries? Have you tried replacing <code>query1</code> and <code>query2</code> with their full SQL code? That may give you a meaningful error."}, {"owner": {"reputation": 1, "user_id": 8371941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e9e3c349f0bf0e06c49b1f88b0755f?s=128&d=identicon&r=PG&f=1", "display_name": "TRA", "link": "https://stackoverflow.com/users/8371941/tra"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1501367354, "post_id": 45335159, "comment_id": 77750007, "body": "No, the UNION always failed even if there were results within query 2. After two days of testing I was fed up and moved the code to another machine. Worked there. So after exporting it on the new machine and transferring it to my PC everything was functioning as it should. So I guess it was a problem related to the frontend I was using. :/  But still a big &quot;Thank you!&quot; for your input. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8371941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e9e3c349f0bf0e06c49b1f88b0755f?s=128&d=identicon&r=PG&f=1", "display_name": "TRA", "link": "https://stackoverflow.com/users/8371941/tra"}, "is_accepted": true, "score": 0, "last_activity_date": 1501367616, "creation_date": 1501367616, "answer_id": 45394677, "question_id": 45335159, "link": "https://stackoverflow.com/questions/45335159/ms-access-sql-union-returns-empty-set/45394677#45394677", "title": "MS Access SQL - UNION Returns Empty Set", "body": "<p>After two days of testing I was fed up and moved the code to another machine. Worked there. So after exporting it on the new machine and transferring it to my PC everything was functioning as it should. So I guess it was a problem related to the frontend I was using.</p>\n\n<p>So if you run into smth. similar make sure that your project isn't corrupted in any way. (even if there aren't any errors shown by Access)</p>\n"}], "owner": {"reputation": 1, "user_id": 8371941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e9e3c349f0bf0e06c49b1f88b0755f?s=128&d=identicon&r=PG&f=1", "display_name": "TRA", "link": "https://stackoverflow.com/users/8371941/tra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 45394677, "answer_count": 1, "score": 0, "last_activity_date": 1501367616, "creation_date": 1501094901, "last_edit_date": 1501152534, "question_id": 45335159, "link": "https://stackoverflow.com/questions/45335159/ms-access-sql-union-returns-empty-set", "title": "MS Access SQL - UNION Returns Empty Set", "body": "<p>I ran into a strange behaviour within Access. I basically have two predefined  queries within my VBA-Project that are needed in different parts of the programm which are working fine.</p>\n\n<p>Now I need a query which returns both result-sets as one. So my go to Solution was to create a new query combining the other two queries. Just like:</p>\n\n<pre><code>SELECT * FROM query1\nUNION\nSELECT * FROM query2;\n</code></pre>\n\n<p>Both queries have the same layout in their result. But if the result of query1 is empty and query2 has some records in its result I receive an empty result from the code above. The other way (empty result for query2 - several results for query1) it is delivering me a complete result.</p>\n\n<p>I also tested the above code with the two queries switched. But the behaviour was the same. Same thing with UNION ALL.</p>\n\n<p>What could be the issue here?</p>\n\n<p>Edit: So, I did some further testing. The reason seems to be within query2. It can't even be unionized with itself. So if i try:</p>\n\n<pre><code>SELECT * FROM query2\nUNION ALL\nSELECT * FROM query2;\n</code></pre>\n\n<p>I again get an empty set. Same when i just use one field in the SELECT-part.</p>\n\n<p>Edit2: OK it gets better. The Dataset is empty but within the table-view of the query result i have all the data within the filters of the columns. But if I do a Count(rowname) I get a 0 in return.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1501099067, "post_id": 45335233, "comment_id": 77634591, "body": "this works great. What if I needed it to run at a specific time too? I&#39;m curious as to if that is possible"}, {"owner": {"reputation": 49, "user_id": 8355222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ac784eeb5c4be658e9b9c05ab34fce?s=128&d=identicon&r=PG", "display_name": "user8355222", "link": "https://stackoverflow.com/users/8355222/user8355222"}, "reply_to_user": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1501099800, "post_id": 45335233, "comment_id": 77634990, "body": "Thanks for your feedback. You can expand the if statement with a check of the time, as shown in this post: <a href=\"https://stackoverflow.com/a/8924251/8355222\">time operations</a>. If you want to start the macro at a specific time, look: <a href=\"https://stackoverflow.com/a/8915209/8355222\">how to schedule an excel macro</a>"}], "tags": [], "owner": {"reputation": 49, "user_id": 8355222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ac784eeb5c4be658e9b9c05ab34fce?s=128&d=identicon&r=PG", "display_name": "user8355222", "link": "https://stackoverflow.com/users/8355222/user8355222"}, "is_accepted": false, "score": 2, "last_activity_date": 1501095142, "creation_date": 1501095142, "answer_id": 45335233, "question_id": 45335107, "link": "https://stackoverflow.com/questions/45335107/microsoft-word-vba-expiration-date/45335233#45335233", "title": "Microsoft word VBA Expiration Date", "body": "<pre><code>If Weekday(Date) = 2 Then ... 'Monday\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1501095408, "creation_date": 1501095408, "answer_id": 45335305, "question_id": 45335107, "link": "https://stackoverflow.com/questions/45335107/microsoft-word-vba-expiration-date/45335305#45335305", "title": "Microsoft word VBA Expiration Date", "body": "<pre><code>Public Function FindMonday(dt As Date) As Date\n  Do Until WeekdayName(Weekday(dt)) = \"Monday\"\n    dt = DateAdd(\"d\", 1, dt)\n  Loop\n  FindMonday = dt\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1501236786, "creation_date": 1501236786, "answer_id": 45370759, "question_id": 45335107, "link": "https://stackoverflow.com/questions/45335107/microsoft-word-vba-expiration-date/45370759#45370759", "title": "Microsoft word VBA Expiration Date", "body": "<p><code>ExpirationDate = (Date + 7) - (Weekday(Date) - Weekday(vbMonday))</code></p>\n\n<p>This formula will always return the date of next Monday, as specified by \"+7\"\nYou don't need to declare the variable <code>Expirationdate</code>.</p>\n\n<p><code>If Date &lt; (Date + 7) - (Weekday(Date) - Weekday(vbMonday)) Then</code>\nwill do the job.</p>\n\n<p>Note that <code>Now</code> returns a date/time value whereas <code>Date</code> returns a date integer. If time is of the essence you would have to add it in. Add 0.5 to the above formula to fix the expiration time on next Monday, 12 noon.</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1501237505, "creation_date": 1501237505, "answer_id": 45371036, "question_id": 45335107, "link": "https://stackoverflow.com/questions/45335107/microsoft-word-vba-expiration-date/45371036#45371036", "title": "Microsoft word VBA Expiration Date", "body": "<p>I'd usually use this function:  </p>\n\n<pre><code>Public Function PreviousMonday(CurrentDate As Date) As Date\n    PreviousMonday = CurrentDate - Weekday(CurrentDate - 2)\nEnd Function\n</code></pre>\n\n<p>You can then call it as:<br>\n<code>PreviousMonday(Date())</code> - would return 24/07/2017 if entered today (28th).\n<code>PreviousMonday(CDATE(\"1 July 2017\"))</code> - would return 26/06/2017<br>\n<code>PreviousMonday(42430)</code> would return 29/02/2016 (42430 = 1st March 2016).</p>\n"}], "owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1501237505, "creation_date": 1501094695, "question_id": 45335107, "link": "https://stackoverflow.com/questions/45335107/microsoft-word-vba-expiration-date", "title": "Microsoft word VBA Expiration Date", "body": "<p>Looking to change this Microsoft Word VBA Code so that the expiration date is always every Monday of the week, not a specific date:</p>\n\n<pre><code>Sub MyMacro()\n\nExpirationDate = #6/1/2013#\nIf Now() &lt; ExpirationDate Then\n\n    'Rest of macro goes here\n\nEnd if\nEnd Sub\n</code></pre>\n\n<p>Any thoughts on how to do this would be great :) </p>\n"}, {"tags": ["python", "excel", "vba", "winapi", "pywin32"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501094754, "post_id": 45334926, "comment_id": 77632172, "body": "I&#39;m not familiar with python syntax, but in VBA you dont put quotes around the row number... Ex: <code>myWorksheet.Rows(10).EntireRow.Hidden = True</code>"}, {"owner": {"reputation": 61, "user_id": 2296691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0e74839556d3903598346644df63c1?s=128&d=identicon&r=PG&f=1", "display_name": "I Am Root", "link": "https://stackoverflow.com/users/2296691/i-am-root"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501095772, "post_id": 45334926, "comment_id": 77632751, "body": "Incidentally it is row 10 I need hidden! Spot on!  The Rows() method will take both either string or int in pywin"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1501095833, "creation_date": 1501095833, "answer_id": 45335421, "question_id": 45334926, "link": "https://stackoverflow.com/questions/45334926/hide-row-in-excel-not-working-pywin32/45335421#45335421", "title": "Hide row in excel not working - pywin32", "body": "<p>I'm not familiar with python syntax, but in VBA you dont put quotes around the row number... Ex: <code>myWorksheet.Rows(10).EntireRow.Hidden = True</code></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 2296691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0e74839556d3903598346644df63c1?s=128&d=identicon&r=PG&f=1", "display_name": "I Am Root", "link": "https://stackoverflow.com/users/2296691/i-am-root"}, "is_accepted": false, "score": 1, "last_activity_date": 1501096976, "creation_date": 1501096976, "answer_id": 45335753, "question_id": 45334926, "link": "https://stackoverflow.com/questions/45334926/hide-row-in-excel-not-working-pywin32/45335753#45335753", "title": "Hide row in excel not working - pywin32", "body": "<p>Turns out that a cell merge later in my program was undoing the hidden row - despite the fact that the merged cells were not in the hidden row. </p>\n"}], "owner": {"reputation": 61, "user_id": 2296691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0e74839556d3903598346644df63c1?s=128&d=identicon&r=PG&f=1", "display_name": "I Am Root", "link": "https://stackoverflow.com/users/2296691/i-am-root"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1501096976, "creation_date": 1501094029, "last_edit_date": 1501095718, "question_id": 45334926, "link": "https://stackoverflow.com/questions/45334926/hide-row-in-excel-not-working-pywin32", "title": "Hide row in excel not working - pywin32", "body": "<p>I am writing a small program in python with pywin32 that manipulates some data in excel and I want to hide a row in order to obscure a label on one of my pivot tables.</p>\n\n<p>According to MSDN the proper syntax is</p>\n\n<blockquote>\n  <p>Worksheet.Rows ('Row#').EntireRow.Hidden = True</p>\n</blockquote>\n\n<p>When I try this in my code nothing happens - no error, nor hidden row. I have tried every combination I can think of of ranges to try and feed it but it will not hide the row in the output files.</p>\n\n<p>Anyone know of a solution to this or if it is not handled by pywin?</p>\n\n<p>EDIT:</p>\n\n<p>Upon further debugging, I am finding that when I immediately check, the row's Hidden value is True but when I reach the save point the row is no longer hidden (another print reveals Hidden = False)</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1501094322, "post_id": 45334832, "comment_id": 77631954, "body": "You are looking at PodString, which is a String, while trying to use that as a Range.  You will need to define the range you want to work in.  Example, if PodString = fdsa, then Range(&quot;fdsa&quot;) would error out; if PodString were a range and = Range(&quot;A2:B2&quot;), then Range(PodString) = Range(&quot;A2:B2&quot;)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501095450, "post_id": 45334832, "comment_id": 77632563, "body": "Also when you start your sub, you declared <code>X</code> but never gave it a value. Why even use <code>x</code>?  What do you mean by <code>Range(podString)</code>? That&#39;s going to be a single number, no? Like <code>Range(3)</code>?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501095610, "post_id": 45334832, "comment_id": 77632661, "body": "@BruceWayne I have an answer going with a more significant list of questions... hoping to get some code going after the intent is made more clear.  This is... kind of rough to extrapolate intent of variables."}, {"owner": {"reputation": 7, "user_id": 8340743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace2b6cc1aa7b3df7851da906c0d0297?s=128&d=identicon&r=PG&f=1", "display_name": "JGenchi", "link": "https://stackoverflow.com/users/8340743/jgenchi"}, "edited": false, "score": 0, "creation_date": 1501106235, "post_id": 45334832, "comment_id": 77638185, "body": "Maybe I&#39;m using the syntax wrong. What is the correct method to call to select what&#39;s inside a cell? Cell or Range? Can I use variables in the parameter definitions of these two methods, and if so how? To start I just want to select a cell based on a variable. Then use what ever is in that cell for other values. Should I even be using vba or just the excel built in functions instead?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8340743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace2b6cc1aa7b3df7851da906c0d0297?s=128&d=identicon&r=PG&f=1", "display_name": "JGenchi", "link": "https://stackoverflow.com/users/8340743/jgenchi"}, "edited": false, "score": 0, "creation_date": 1501104846, "post_id": 45335345, "comment_id": 77637622, "body": "Thank you for taking the time to look at my code. I rushed to put it up and realized I had taken out some parts that were important. the point of the code is to do a for loop for every row, add a value in one row to another column of the same row depending on another value. Then to do a while loop and keep adding that number in the x row to subsequent y rows beneath it. If the accounts don&#39;t match or the dates are out of sync then exit the while loop and keep going with the x for loop. Hopefully that clears up some confusion. My main concern is just getting the .Range function to work."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8340743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace2b6cc1aa7b3df7851da906c0d0297?s=128&d=identicon&r=PG&f=1", "display_name": "JGenchi", "link": "https://stackoverflow.com/users/8340743/jgenchi"}, "edited": false, "score": 0, "creation_date": 1501158254, "post_id": 45335345, "comment_id": 77662300, "body": "@JGenchi Then the initial comment would stand (to your post).  You don&#39;t have ProdString qualified as a range, and it is not a range that you are using.  I will update my Answer to show what I mean."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8340743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace2b6cc1aa7b3df7851da906c0d0297?s=128&d=identicon&r=PG&f=1", "display_name": "JGenchi", "link": "https://stackoverflow.com/users/8340743/jgenchi"}, "edited": false, "score": 0, "creation_date": 1501159946, "post_id": 45335345, "comment_id": 77663634, "body": "@JGenchi Please see what I have below the Edit... I have corrected for your Range issue, but as mentioned, you might run into more issues with your chosen approach."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1501159839, "last_edit_date": 1501159839, "creation_date": 1501095545, "answer_id": 45335345, "question_id": 45334832, "link": "https://stackoverflow.com/questions/45334832/vba-excel-range-syntax-and-comparators/45335345#45335345", "title": "VBA Excel .Range syntax and comparators", "body": "<p>Planning to update with code, once I can figure out what is happening...</p>\n\n<hr>\n\n<p>Trying to build on my comment for you, using what I feel I can interpret from your code.</p>\n\n<p>I believe you're trying to loop through a range, though I am having trouble trying to place your x and y variables, based on where they are used.  I will try to deduce... assuming that you're checking through ProdString = x &amp; 3 to mean the third row, x is your column.  I am seeing comparisons for the specific string in I3 (Cells(3,9)), E3 (Cells(3,5)), O3 (Cells(3,15)), and Q3 (Cells(3,17)). </p>\n\n<p>I'm not seeing what ProdString is supposed to be... what are you comparing?</p>\n\n<p>I imagine you want something like (this is not sufficient code atm):</p>\n\n<pre><code>Dim ProdString as String, prod as String, x as Integer\n\nProdString = Cells(3,prod).Value\n\nIf Cells(3,9).Value=ProdString Then\n    prod = Cells(3,11).Value 'Getting lost at why prod us being used as such\n    Else\n    End If\n</code></pre>\n\n<p>I can't figure out what you're trying to add, since the Column = x, but you're using ranges later such as Range(\"D\" &amp; x).</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>After getting some clarification to my questions, I would have the following changes to your code (only bringing in the items I need to correct for the Range error:</p>\n\n<pre><code>Dim prod as String, x as Integer\n\nFor x = 2 to LastRow\n\n    If Cells(x,3).Value = \"I\" Then\n        prod = \"K\"\n        Else 'Only showing the one option to shorten my response\n        End If\n\nNext x\n</code></pre>\n\n<p>Note that ProdString is removed.  As written, it had no value.  The String of x&amp;3 is <em>not</em> a range, and cannot be used as a range, e.g., Range(ProdString).  If you want to loop through rows of a column, you can ignore using Range() and go via Cells() to make a simple approach.</p>\n\n<p>Specific to what is in this code, you are saying that the Value held within the cell being looped through has the value \"I\".  Without seeing the data, I can only assume that you are in fact only looking for the value \"I\", though the use of <strong>prod</strong> makes me think this is wrong.  I suspect you are trying to capture the column name/number, so you will need to look at that because if you're locked to column 3 and looping through rows, you would never see column \"I\".  I would recommend the following change for replacing <strong>prod</strong>:</p>\n\n<pre><code>Dim x as Integer, prod as Integer\n\nFor x = 2 to LastRow\n\n    If Cells(x,3).Value = \"I\" Then 'Ensure that this is truly supposed to be a value of I in the cell\n        prod=Cells(x,11).Value\n        Cells(x,11).Formula=Cells(x,4).Value+prod 'It looks like you're overwriting the cell in row x, column 11\n        Else \n        End If\n\nNext x\n</code></pre>\n\n<p>Let me know if this clears anything up.</p>\n"}], "owner": {"reputation": 7, "user_id": 8340743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace2b6cc1aa7b3df7851da906c0d0297?s=128&d=identicon&r=PG&f=1", "display_name": "JGenchi", "link": "https://stackoverflow.com/users/8340743/jgenchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501159839, "creation_date": 1501093751, "last_edit_date": 1501104698, "question_id": 45334832, "link": "https://stackoverflow.com/questions/45334832/vba-excel-range-syntax-and-comparators", "title": "VBA Excel .Range syntax and comparators", "body": "<p>first post here sorry if the formatting is really bad. Need some help with a VBA Excel file I'm working on. The code is below and a description underneath. Any help would be appreciated</p>\n\n<pre><code>Sub Main()\n\n' Declare all variables    \nDim LastRow As Long\nDim x As Long\nDim y As Long\nDim Date1 As Date\nDim Date2 As Date\nDim prod As String\nDim Add As Integer\nDim var1 As Integer\nDim var2 As Integer\nDim ProdString As String\n\n'Calculate the number of rows in the sheet, then run a for loop for every row.\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\nFor x = 2 To LastRow\ny = x\n\n'concatenate the current row number (x) and third column to a string (prod string), then check to see what letter is in that cell.  \n'Assign a letter to concatenate with variable 'x' to String Prod for the .Range Function\n\nProdString = x &amp; 3\n**If Range(ProdString).Value = \"I\" Then** \n    prod = \"K\"\nElseIf Application.ActiveSheet.Range(ProdString).Value = \"E\" Then\n    prod = \"L\"\nElseIf Application.ActiveSheet.Range(ProdString).Value = \"O\" Then\n    prod = \"M\"\nElseIf Application.ActiveSheet.Range(ProdString).Value = \"Q\" Then\n    prod = \"N\"\nElse: prod = \"O\"\nEnd If\n\n' Add two numbers together in two different cells and assign to the second cell\nvar1 = Application.ActiveSheet.Range(\"D\" &amp; x).Value\nvar2 = Application.ActiveSheet.Range(\"prod\" &amp; x).Value\nAdd = var1 + var2\nApplication.ActiveSheet.Range(\"prod\" &amp; x).Value = Add\n\n\n'While Loop to go through applicable date range from starting date to end date and add to those columns\nDo While True\n\nDate1 = Application.ActiveSheet.Range(y, 6).Value\nDate2 = Application.ActiveSheet.Range(y + 1, 6).Value\nIf Application.ActiveSheet.Range(y, 7).Value &lt;&gt; Application.ActiveSheet.Range(y + 1, 7) Then Exit Do\nIf Date1 &lt; Date2 Then Exit Do\n\nvar1 = Range(\"D\" &amp; x).Value\nvar2 = Range(\"prod\" &amp; y).Value\nAdd = var1 + var2\nRange(\"prod\" &amp; y).Value = Add\ny = y + 1\n\nLoop\n\nNext x\nEnd Sub\n</code></pre>\n\n<p>The Excel file I'm working with is one workbook, on one sheet with 10k rows and 15 columns. I'm trying to add a number in one column to another based on dates. But the current issue I'm having  is just trying to figure out the Bolded .Range function and why it won't work. I've tried preceding it with the specific workbook and pagename but I get global scope errors when I do. I just want to compare what is inside the cell at the specified range, and if it is a certain string assign a value to a different string value.\nThanks. </p>\n"}, {"tags": ["vba", "excel", "random"], "comments": [{"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 0, "creation_date": 1501093715, "post_id": 45334757, "comment_id": 77631623, "body": "Not the answer to your problem, but <code>Dim source, destination As Range</code> will make destination a range, but source as variant. You need <code>Dim source as Range, destination As Range</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1501098594, "post_id": 45334757, "comment_id": 77634327, "body": "A little formatting would go a long way here."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "edited": false, "score": 0, "creation_date": 1501172216, "post_id": 45336129, "comment_id": 77673536, "body": "Hi Rob.. Thank you for responding. I tried to put in your suggestion but it is not working. The problem is range can not get bigger. I have certain restrictions to get bigger range. To re-iterate, macro should pull three different names (mutually exclusive) from a range and put those three names in three different rows that are 5 rows apart."}, {"owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "reply_to_user": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "edited": false, "score": 0, "creation_date": 1501172523, "post_id": 45336129, "comment_id": 77673746, "body": "When I try to run your code (as given) I get one value in Cell B53 then the error message &quot;no more room in destination range. This is because your range is ONE cell, so one it has copied one thing, there is no more room. At the very least the range has to be B53:B63 to fit in three items of data, five cells apart."}, {"owner": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "edited": false, "score": 0, "creation_date": 1501172800, "post_id": 45336129, "comment_id": 77673899, "body": "Ok! I am using &quot;Call&quot; function in a separate macro to call this macro thrice so that I get three different names. I am new to VBA and the method I am using might be very primitive. Now I am realizing it will not work with this methodology. Is there a better way?"}, {"owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "reply_to_user": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "edited": false, "score": 0, "creation_date": 1501172957, "post_id": 45336129, "comment_id": 77674009, "body": "I realise you are calling it three times but, when I call it the second time, if the range is just &quot;B53&quot;, it will not add any more data. I don&#39;t really see the issue with making the range &quot;B53:B63&quot;, it will only change the three cells you want it to change."}], "tags": [], "owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "is_accepted": false, "score": 0, "last_activity_date": 1501098317, "creation_date": 1501098317, "answer_id": 45336129, "question_id": 45334757, "link": "https://stackoverflow.com/questions/45334757/output-random-numbers-in-three-different-rows/45336129#45336129", "title": "output random numbers in three different rows", "body": "<p>If I understand you correctly, if you change the line</p>\n\n<pre><code>For i = 1 To destination.Rows.Count\n</code></pre>\n\n<p>to</p>\n\n<pre><code>For i = 1 To destination.Rows.Count Step 5\n</code></pre>\n\n<p>this should work. Though when I tried it I also had to make the Destination range bigger than just \"B53\". I put in \"B53:B99\"</p>\n"}], "owner": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501098317, "creation_date": 1501093514, "question_id": 45334757, "link": "https://stackoverflow.com/questions/45334757/output-random-numbers-in-three-different-rows", "title": "output random numbers in three different rows", "body": "<p>I am working on random numbers VBA and the below code picks a name from sheet2 and copies to sheet 1 and I can repeat these steps to pick 3 different names from that list. This code does a fantastic job when all the three names are in three consecutive rows but fails to pick 3 different names when they are in row 5th, row 10th and row 15th. Can someone help me pick three different names and put them in rows that are 5 rows apart? (1st name in 1st row, 2nd name in 5th row and 3rd name in 15th row) I am new to VBA! </p>\n\n<pre><code>Sub DDQ1()\nApplication.ScreenUpdating = False\nDim source, destination As Range\nSet source = Sheets(\"sheet2\").Range(\"A60:A81\")\nSheets(\"sheet1\").Activate\nSet destination = ActiveSheet.Range(\"B53\")\nReDim randoms(1 To source.Rows.Count)\ndestrow = 0\nFor i = 1 To destination.Rows.Count\n If destination(i) = \"\" Then: destrow = i: Exit For\nNext i\nIf destrow = 0 Then: MsgBox \"no more room in destination range\": Exit Sub\nFor i = 1 To UBound(randoms): randoms(i) = Rnd(): Next i\nipick = 0: tries = 0\nDo While ipick = 0 And tries &lt; UBound(randoms)\ntries = tries + 1\nminrnd = WorksheetFunction.Min(randoms)\nFor i = 1 To UBound(randoms)\nIf randoms(i) = minrnd Then\n  picked_before = False\n  For j = 1 To destrow - 1\n    If source(i) = destination(j) Then: picked_before = True: randoms(i) =        2: Exit For\n  Next j\n  If Not picked_before Then: ipick = i\n  Exit For\nEnd If\nNext i\nLoop\nIf ipick = 0 Then: MsgBox \"no more unique name possible to pick\": Exit Sub\ndestination(destrow) = source(ipick)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "reference", "save"], "comments": [{"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1501098500, "post_id": 45334469, "comment_id": 77634279, "body": "Check out this link: <a href=\"https://stackoverflow.com/questions/35094057/copy-all-workbook-sheets-to-a-new-workbook-vba\">copy all workbook sheets to a new workbook VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1585171244, "post_id": 45336469, "comment_id": 107673430, "body": "This gives a &#39;subscript out of range&#39; error for me. I had to use <code>After</code> instead of <code>Before</code>. when copying to the new workbook."}], "tags": [], "owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "is_accepted": true, "score": 6, "last_activity_date": 1501100325, "last_edit_date": 1501100325, "creation_date": 1501099734, "answer_id": 45336469, "question_id": 45334469, "link": "https://stackoverflow.com/questions/45334469/how-do-i-save-a-worksheet-to-a-new-workbook/45336469#45336469", "title": "How do I save a worksheet to a new workbook?", "body": "<p>Here is a macro showing/doing what you are asking for. Change the workbook name as well as sheet name as needed: </p>\n\n<pre><code>Sub test()\nDim wb, wbnew As Workbook \nDim ws As Worksheet\nDim filename As String\n\nSet wb = Workbooks(2)  'Name of the workbook you are copying from\nSet ws = wb.Sheets(\"Sheet1\") 'Name of sheet you are copying\nfilename = ws.Range(\"A11\") &amp; \"_\" &amp; ws.Range(\"B11\")&amp; \".xlsm\"\n'adds new workbook\nSet wbnew = Workbooks.Add\nwb.Activate\n\n'copies sheet to new workbook\n    wb.Sheets(\"Sheet1\").Copy Before:=wbnew.Sheets(1)\n\n'Save as dialog box to save as excel file\nApplication.Dialogs(xlDialogSaveAs).Show filename\n\nwbnew.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8342310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005f814bbc3e3abd0025c5e6d97ced88?s=128&d=identicon&r=PG&f=1", "display_name": "MrDoe", "link": "https://stackoverflow.com/users/8342310/mrdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37447, "favorite_count": 1, "accepted_answer_id": 45336469, "answer_count": 1, "score": 2, "last_activity_date": 1590754350, "creation_date": 1501092452, "last_edit_date": 1585169849, "question_id": 45334469, "link": "https://stackoverflow.com/questions/45334469/how-do-i-save-a-worksheet-to-a-new-workbook", "title": "How do I save a worksheet to a new workbook?", "body": "<p>I am trying to save a single worksheet to a new workbook (VBA should create a new workbook).</p>\n\n<p>The code is running and the new workbook is popping up with the needed data and the save as dialogue window also opens but when I select the name and save the file it is no where to be found the the new workbook stays open as (Book1 or whatever auto populates).</p>\n\n<p>I would like for a Save As name to auto populate when the dialogue window opens and have it referencing to two cells (i.e. $A$11, $B$11) in the original workbook.</p>\n\n<p>Here is my VBA:</p>\n\n<pre><code>Option Explicit\n\nSub SaveConsolidatedDemandData()\n    ' Macro2 Macro\n    'Dim NameFile As Variant\n            'With Worksheets(\"SO1\")\n            'NameFile = .Range(\"M3\") &amp; \"_\" &amp; .Range(\"C11\") &amp; \"_\" &amp; .Range(\"B22\") &amp; \".xls\"\n    'End With\n\n    Application.ScreenUpdating = False\n    '\n    '\n        Sheets(\"Consolidation\").Select\n        Sheets(\"Consolidation\").Copy\n        Application.GetSaveAsFilename\n\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "is_accepted": true, "score": 2, "last_activity_date": 1501091964, "creation_date": 1501091964, "answer_id": 45334316, "question_id": 45334170, "link": "https://stackoverflow.com/questions/45334170/vba-keep-previous-cell-value-or-skip-if-vlookup-returns-n-a/45334316#45334316", "title": "Vba keep previous cell value or skip if vlookup returns N/A", "body": "<pre><code>For x = 2 To Ending\n  If isnumeric(Application.VLookup(Range(\"A\" &amp; x), Range(\"G3:H\" &amp; last), 2, False)) then\n  Range(\"D\" &amp; x).Value = Application.VLookup(Range(\"A\" &amp; x), Range(\"G3:H\" &amp; last), 2, False)\n  End if\n  Next x\nEnd Sub\n</code></pre>\n\n<p>Try that</p>\n"}], "owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 45334316, "answer_count": 1, "score": 0, "last_activity_date": 1501091964, "creation_date": 1501091465, "question_id": 45334170, "link": "https://stackoverflow.com/questions/45334170/vba-keep-previous-cell-value-or-skip-if-vlookup-returns-n-a", "title": "Vba keep previous cell value or skip if vlookup returns N/A", "body": "<p>I have a large data set of countries and their cost of living index. They need to be updated quarterly by copying a table from a website. </p>\n\n<p>I made a macro to vlookup the updated index and replace the old one, but some entries no longer exist in the updated one or are not included. It leaves the index cell with #N/A, but I rather just leave the old value.</p>\n\n<pre><code>'Varibles and format\nDim last As Integer\nDim Ending As Integer\nDim examin As Variant\nEnding = Cells(Rows.Count, \"A\").End(xlUp).Row\nlast = Range(\"G3\").SpecialCells(xlCellTypeLastCell).Row\nRange(\"F3:F\" &amp; last).ClearContents\nRange(\"I3:M\" &amp; last).ClearContents \n\n'Find &amp; Replace country names with correct from\nCells.Replace What:=\"United States\", Replacement:=\"USA\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"United Kingdom\", Replacement:=\"England\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"United Arab Emirates\", Replacement:=\"United_Arab_Emirates\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"Dominican Republic\", Replacement:=\"Dominican_Republic\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"South Africa\", Replacement:=\"South_Africa\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"Czech Republic\", Replacement:=\"Czech_Republic\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nCells.Replace What:=\"Costa Rica\", Replacement:=\"Costa_Rica\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\n\n'Vlookup updated index \nFor x = 2 To Ending\nRange(\"D\" &amp; x).Value = Application.VLookup(Range(\"A\" &amp; x), Range(\"G3:H\" &amp; last), 2, False)\nNext x\nEnd Sub\n</code></pre>\n\n<p>I read on this question \"How to keep previous excel cell value if VLOOKUP return with error\" that it was not an option, but there might be a different way.</p>\n\n<p>Here is what it looks like after I run it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/szM8M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/szM8M.png\" alt=\"Index Update\"></a></p>\n"}, {"tags": ["excel", "compiler-errors", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8371710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107353e503346544f57586192f97b3b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jarvis595", "link": "https://stackoverflow.com/users/8371710/jarvis595"}, "edited": false, "score": 0, "creation_date": 1501092333, "post_id": 45334154, "comment_id": 77630882, "body": "@Jarvis595 Please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1501091406, "creation_date": 1501091406, "answer_id": 45334154, "question_id": 45334093, "link": "https://stackoverflow.com/questions/45334093/complie-error-expected-separator-or/45334154#45334154", "title": "Complie error: Expected Separator or )", "body": "<p>the formula needs to be in quotes:</p>\n\n<pre><code>Range(\"A2:A100\").Formula = \"=MID(Table4[@Duration],FIND(\"\"m\"\",Table4[@Duration],1)-1,7)\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8371710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107353e503346544f57586192f97b3b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jarvis595", "link": "https://stackoverflow.com/users/8371710/jarvis595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 45334154, "answer_count": 1, "score": 1, "last_activity_date": 1501091406, "creation_date": 1501091169, "last_edit_date": 1531161705, "question_id": 45334093, "link": "https://stackoverflow.com/questions/45334093/complie-error-expected-separator-or", "title": "Complie error: Expected Separator or )", "body": "<p>I'm attempting to make a macro to insert a formula into a cell range that references a table on the page, but I'm getting the compile error. Can anyone give me a hand with this? It doesn't seem to like that I'm referencing a Table (or the @Duration part anyways, but this is necessary). I basically just need it to drop this formula string into the required cells.</p>\n\n<p>Code:</p>\n\n<pre><code>Range(\"A2:A100\").Formula = MID(Table4[@Duration],FIND(\"m\",Table4[@Duration],1)-1,7)\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "break", "mode"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501094442, "post_id": 45334003, "comment_id": 77632014, "body": "Do the values in <code>strPaths()</code> end with the backslash character? You seem to have left that part out of your post."}, {"owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501161055, "post_id": 45334003, "comment_id": 77664656, "body": "Indeed they do. Would that have some impact? The way they are formatted would be &quot;C:\\Folder\\Subfolder\\&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1501513179, "creation_date": 1501513179, "answer_id": 45419269, "question_id": 45334003, "link": "https://stackoverflow.com/questions/45334003/vba-design-mode-triggering-and-interrupting-program/45419269#45419269", "title": "VBA: Design Mode triggering and interrupting Program", "body": "<p>So I figured I would provide some update for this. </p>\n\n<p>I still haven't determined <em>exactly</em> what was causing this, but I think it might have been the simple fact that I was using my computer during code execution. </p>\n\n<p>Adding the following line stopped the recurrence of this error:</p>\n\n<pre><code>Application.Interactive = False\n' Code\nApplication.Interactive = True\n</code></pre>\n\n<p>I suspect that my addiction to refreshing web browsers with F5 was the likely culprit.</p>\n"}], "owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501513179, "creation_date": 1501090891, "question_id": 45334003, "link": "https://stackoverflow.com/questions/45334003/vba-design-mode-triggering-and-interrupting-program", "title": "VBA: Design Mode triggering and interrupting Program", "body": "<p>Has anyone encountered this issue? </p>\n\n<p>The program I am running is something like this:</p>\n\n<ol>\n<li>Find files in folder</li>\n<li>Open document from folder</li>\n<li>Read table into array</li>\n<li>Loop to 2 or 1</li>\n<li>Close document, set = nothing</li>\n<li>Write array to spreadsheet.</li>\n</ol>\n\n<p>In the course of my loop the documents I am opening end up triggering design mode for some reason. This causes a break in my program that exits the program, causing me to lose the progress my macro had made and start again.</p>\n\n<p>Is there any way for me to avoid this happening, or to possibly understand why? I don't believe that the documents themselves are in design mode when I am opening them, just that the functionality is being triggered for some reason.</p>\n\n<p>Here's the code for when I open the documents:</p>\n\n<pre><code>For f = LBound(strPaths) To UBound(strPaths)\n    Set Files = New Collection\n    dirpath = strPaths(f)\n    strFile = Dir(dirpath &amp; \"*.xls*\")     ' Record file into string.\n    Do While strFile &lt;&gt; \"\"\n        Files.Add strFile\n        strFile = Dir\n    Loop\n    numCSV = numCSV + Files.count\n    For Each strFile In Files\n        dirpath = strPaths(f)\n        wbkPath = dirpath &amp; strFile\n        If InStr(1, wbkPath, \"Bulk\") &gt; 0 Then GoTo NextFile\n        nrow = OpenDoc(wbkPath, wbkCSV)\n        If Not nrow &lt;= 1 Then\n            scopeArray(k) = PullScope(wbkCSV, wshPalette, strFile, roffset, nrow, x)\n            roffset = roffset + nrow\n            k = 1 + k\n            ReDim Preserve scopeArray(k)\n        End IfNextFile:\n    Next strFile\nNext f\n\nPublic Function OpenDoc(wbkPath, wbkCSV As Workbook) As Long\n    Dim r As Integer\n\n' With workbook still open, process.\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Set wbkCSV = Workbooks.Open(wbkPath)\n    Application.DisplayAlerts = True\n    Application.AskToUpdateLinks = True\n  '  On Error GoTo NextDoc\n    Set wshTemp = wbkCSV.Worksheets(1)\n\n    r = WorksheetFunction.CountA(wshTemp.Columns(6)) - 1\n If r &lt;= 1 Then\n    wbkCSV.Close\n    Set wbkCSV = Nothing\n End If\nOpenDoc = r\nEnd Function\n</code></pre>\n\n<p>Sincere thanks to any responses!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1501092856, "post_id": 45333971, "comment_id": 77631193, "body": "My recommendation would be to do it by pre-generating the results in a temporary table, instead of trying to do it on the OnFormat event. There are many limitations on what Access can and can&#39;t do during specific events that you can bypass that way. A big advantage of that is that you get to see exactly what your code generates without worrying if it is an Access event limitation that is causing the issue or a bug in your code."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1501093143, "post_id": 45333971, "comment_id": 77631362, "body": "To clarify, &#39;temporary&#39; table is actually permanent, the records are temporary. Records exist only for the process and are deleted when completed."}, {"owner": {"reputation": 25, "user_id": 8137662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f4441c9f54d27b36dabfeedecbc3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reid", "link": "https://stackoverflow.com/users/8137662/reid"}, "edited": false, "score": 0, "creation_date": 1501094772, "post_id": 45333971, "comment_id": 77632185, "body": "Thats a really good idea, thanks I&#39;ll give it a shot."}], "owner": {"reputation": 25, "user_id": 8137662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f4441c9f54d27b36dabfeedecbc3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reid", "link": "https://stackoverflow.com/users/8137662/reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501092330, "creation_date": 1501090765, "last_edit_date": 1592644375, "question_id": 45333971, "link": "https://stackoverflow.com/questions/45333971/filtering-information-in-a-report-using-vba-access-finding-the-next-avaliable", "title": "Filtering Information in A Report Using VBA-Access - Finding the next avaliable null field", "body": "<p>I'm trying to organize information in a report in a certain way\nI have 9 fields that will be used to store the label for the information\nand another 9 fields that store the actual value of the information.\nWhenever a field is full, I want it to place the information in the next available field. So that there will be no blank fields in between information.</p>\n<p>The issue is that when trying to run this code which triggers two functions,  it is not updating the report I referenced to in the two functions, nor is it pulling information from SpecSheetQuery, and I can't figure out why. My guess is that I'm not referencing the information correctly. I also have to figure out how to run this code individually on each record.</p>\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n Servings = DLookup(&quot;[servings]&quot;, &quot;SpecSheetQuery&quot;)\n Calories = DLookup(&quot;[calories]&quot;, &quot;SpecSheetQuery&quot;)\n\n\n If Not IsEmpty(Servings) Then\n  OpenSlot (&quot;Servings&quot;)\n  OpenFact (Servings)\n End If\n \n If Not IsEmpty(Calories) Then\n  OpenSlot (&quot;Calories&quot;)\n  OpenFact (Calories)\n End If\n\nEnd Sub\n</code></pre>\n<p>OpenSlot function, puts title/label of information into field1 ( which is a field on the report) on the first null/empty field. so that no space is left blank.</p>\n<pre><code>Option Compare Database\n\nOption Explicit\n\nPublic Function OpenSlot(Slot As String)\n\n\nDebug.Print Reports!SpecSheet!field1.Value\n\nIf Reports!SpecSheet!field1.Value = Null Then\n Debug.Print &quot;Slot1&quot;\n Slot = Reports!SpecSheet!field1.Value\nDebug.Print Reports!SpecSheet!field1.Value\n\nElseIf Reports!SpecSheet!field2.Value = Null Then\n Reports!SpecSheet!field2.Value = Slot\nEnd If\n\nEnd Function\n</code></pre>\n<p>OpenFact function, puts fact into nut1 ( which is a field on the report) on the first null/empty field. so that no space is left blank.</p>\n<pre><code>Public Function OpenFact(fact As String)\n\n\nIf Reports!SpecSheet!nut1.Value = Null Then\n Reports!SpecSheet!nut1.Value = fact\nDebug.Print Reports!SpecSheet!nut1.Value\n\nElseIf Reports!SpecSheet!nut2.Value = Null Then\n Reports!SpecSheet!nut2.Value = fact\nEnd If\n\nEnd Function\n</code></pre>\n<p>I'm trying to store this information into this report.\n<a href=\"https://i.stack.imgur.com/nS6ca.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nS6ca.png\" alt=\"enter image description here\" /></a></p>\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1501092809, "post_id": 45333855, "comment_id": 77631152, "body": "No, cannot &#39;move&#39; a record within a recordset. Tables are not spreadsheets."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1501093125, "post_id": 45333855, "comment_id": 77631352, "body": "Order By provides almost all of the sorts that a user may need, you can add a new column to your table that sorting that would provide you what you want without moving a record. In the form, you would not see the column data of course"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1501100693, "post_id": 45333855, "comment_id": 77635495, "body": "Adding more information added to your question would be useful.  If you want to organize jobs in a certain order, how did you plan on storing that order--do you already have a field for saving the order?  June7 is technically correct, but Ibo&#39;s answer could be expanded to provide a complete, useful answer.  Honestly, don&#39;t think of being &quot;stuck&quot; with OrderBy, rather learn and apply proper database/recordset concepts."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501135691, "post_id": 45333855, "comment_id": 77646490, "body": "moved from where to where ? ... different table ?"}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "is_accepted": true, "score": 2, "last_activity_date": 1501183183, "last_edit_date": 1501183183, "creation_date": 1501106125, "answer_id": 45338087, "question_id": 45333855, "link": "https://stackoverflow.com/questions/45333855/can-an-individual-record-in-a-recordset-be-moved/45338087#45338087", "title": "Can an individual record in a recordset be moved?", "body": "<p>The short answer is \"No\", the index of a record in a recordset cannot be directly updated.  The order of rows in a recordset can only be changed by either setting a different ORDER BY clause and requerying the database, or by setting the Recordset.Sort property or the Form.OrderBy property (when bound to a form).</p>\n\n<hr>\n\n<p>Let's assume that there is a <em>updatable</em> recordset field called [JobOrder].  The SQL source query can include a sort order like <code>... ORDER BY [JobOrder] ASC</code> which first sorts the data when it is retrieved from the database.  As a matter of fundamental database concept, it should be assumed that if no ORDER BY clause is specified that the database can return data in a random order.  (In practice that is not usually the case.  It will be sorted by some indexed primary key by default, but that should not be assumed if the order is important.)</p>\n\n<p>The form's (or subform's) sort order can be set and changed without requerying the data from the database again.  That is done by setting the OrderBy property and ensuring that <code>OrderByOn = True</code>.  (FYI: Unless you take measures to hide default tool ribbons (i.e. toolbars) and shortcut menus, this sort order can be altered by the user.)</p>\n\n<p>Now your VBA code can use various techniques to set the JobOrder values.  You could perhaps use the <code>Me.RecordsetClone</code> method to enumerate and update the values using the recordset object.  Using RecordsetClone will avoid certain side effects of updating the bound primary recordset.  Lastly, the following assumes that all records already have valid, unique JobOrder values, but it assumes that JobOrder is not <em>required</em> to be unique (since the swap technique temporarily sets two rows to the same value).  It's up to you to write your own clever implementation to guarantee that JobOrder values remain valid and unique.</p>\n\n<pre><code>Private Sub MoveCurrentUp()\n  Dim rs As Recordset2\n\n  Dim thisID As Long\n  Dim thisSort As Long\n  Dim previousID As Long\n  Dim previousSort As Long\n\n  On Error Resume Next\n  '* Error handling to avoid cases where recordset is empty\n  '* and/or the current record is not valid (i.e. new record)\n\n  If Not IsNull(Me.ID.Value) Then\n    thisID = Me.ID.Value\n    If Err.Number = 0 Then\n\n      On Error GoTo Catch\n      '* Any errors from this point should be\n      '* handled specifically rather than ignored\n\n      Set rs = Me.RecordsetClone\n\n      rs.FindFirst \"ID=\" &amp; thisID\n      If Not rs.NoMatch Then\n        thisSort = rs!JobOrder\n        rs.MovePrevious\n        If Not rs.BOF Then\n          previousID = rs!ID\n          previousSort = rs!JobOrder\n\n          rs.Edit\n          rs!JobOrder = thisSort\n          rs.Update\n\n          rs.MoveNext\n          rs.Edit\n          rs!JobOrder = previousSort\n          rs.Update\n\n          Set rs = Nothing\n          RefreshSort\n        End If\n      End If\n      Set rs = Nothing\n\n      Debug.Print Me.Sort\n    End If\n  End If\n\n  Exit Sub\nCatch:\n  MsgBox \"Error updating order.\" &amp; vbNewLine &amp; vbNewLine &amp; _\n    \"    \" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbOKOnly Or vbExclamation, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>Aferward, you would refresh the form's sort order with something like:</p>\n\n<pre><code>Private Sub RefreshSort(Optional restoreCurrentRecord As Boolean = True)\n  Dim rs As Recordset2\n  Dim saveID As Long\n  saveID = Me.ID.Value\n\n  Me.OrderBy = \"[JobOrder] ASC\"\n  Me.OrderByOn = True\n\n  If restoreCurrentRecord Then\n    Set rs = Me.RecordsetClone\n    rs.FindFirst \"ID=\" &amp; saveID\n    If Not rs.NoMatch Then\n      Me.Bookmark = rs.Bookmark\n    End If\n    Set rs = Nothing\n  End If\nEnd Sub\n</code></pre>\n\n<p>Or you could update rows using SQL queries, then call <code>Me.OrderByOn = False</code> then <code>Me.Requery</code> to force the entire recordset to be reloaded in the proper order (assuming the record source has a proper ORDER BY clause).  This technique has the benefit of wrapping all the changes in a transaction which can be committed or rolled back altogether, something you can't do with the bound form's recordset objects.</p>\n"}], "owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 45338087, "answer_count": 1, "score": 0, "last_activity_date": 1501183183, "creation_date": 1501090409, "last_edit_date": 1501182116, "question_id": 45333855, "link": "https://stackoverflow.com/questions/45333855/can-an-individual-record-in-a-recordset-be-moved", "title": "Can an individual record in a recordset be moved?", "body": "<p>I have a table subform containing jobs to be completed. I'm creating an algorithm in VBA to organize the jobs in the most efficient order to be completed.</p>\n\n<p>Is there a way to move an individual record in a recordset or am I stuck with OrderBy?</p>\n\n<p><strong>Edit:</strong>\nTo add some clarity, I want to be able to move a record to any other index in the same table. I intend to run my algorithm which will move the records into the order they are to be completed. Then each records' \"Process Date\" field is set to keep track of the order.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501090797, "post_id": 45333826, "comment_id": 77629935, "body": "This seems like a disaster from an implementation &amp; maintenance perspective, but it is possible using the Visual Basic for Applications Extensibility reference, which allows you to programmatically insert modules and manipulate code. <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">Here</a> is a good primer which shows you how to do it. If you get stuck with specific implementation details, please revise your question to narrow its scope. As currently asked, it&#39;s &quot;too broad&quot; :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501090909, "post_id": 45333826, "comment_id": 77630006, "body": "<a href=\"https://stackoverflow.com/a/44466940/1467082\">here</a> is an answer that also outlines basic function to add a code module. Instead, you&#39;d need to refer to the sheet&#39;s specific module, but that is not a huge diversion from that answer already."}, {"owner": {"reputation": 11, "user_id": 3870835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bbbd4fa7fc418f0aa7e7d142fc999ad?s=128&d=identicon&r=PG&f=1", "display_name": "l0aded", "link": "https://stackoverflow.com/users/3870835/l0aded"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501110799, "post_id": 45333826, "comment_id": 77639754, "body": "Thank you,  I will look into this solution and see if it works for my case."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501135915, "post_id": 45333826, "comment_id": 77646624, "body": "do you really need to have the code in all those workbooks? could you have the code in one &quot;master&quot; workbook and have it interact with all those workbooks?"}, {"owner": {"reputation": 11, "user_id": 3870835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bbbd4fa7fc418f0aa7e7d142fc999ad?s=128&d=identicon&r=PG&f=1", "display_name": "l0aded", "link": "https://stackoverflow.com/users/3870835/l0aded"}, "edited": false, "score": 0, "creation_date": 1501171719, "post_id": 45333826, "comment_id": 77673212, "body": "These are files on a cloud server that are constantly being accessed and modified so they have to work independently."}], "owner": {"reputation": 11, "user_id": 3870835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bbbd4fa7fc418f0aa7e7d142fc999ad?s=128&d=identicon&r=PG&f=1", "display_name": "l0aded", "link": "https://stackoverflow.com/users/3870835/l0aded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501090308, "creation_date": 1501090308, "question_id": 45333826, "link": "https://stackoverflow.com/questions/45333826/add-vba-code-to-all-worksheets-for-all-excel-workbooks-in-a-folder", "title": "Add VBA code to all worksheets for ALL excel workbooks in a folder?", "body": "<p>I searched but could not find any topics on this specific use case.</p>\n\n<p>I have developed code that I want to implement on multiple (>100) different excel files and was wondering if there is a way using VBA or other to add the VBA code to ALL worksheets in ALL excel workbooks in a specific folder. </p>\n\n<p>In addition,  I will need to enable Microsoft Internet Controls reference in all as well. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "printscreen"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1501091411, "post_id": 45333776, "comment_id": 77630316, "body": "You would have to use Wordbasic or API calls as explained here: <a href=\"http://wordmvp.com/FAQs/MacrosVBA/PrtSc.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/MacrosVBA/PrtSc.htm</a>"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501092436, "post_id": 45333776, "comment_id": 77630946, "body": "Thank you for helpful reference. I will extend my question as above."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1501094007, "post_id": 45333776, "comment_id": 77631782, "body": "Actually the accepted answer for the question you added a link to isn&#39;t exclusively targeted towards C# <i>or any other language</i>. It&#39;s only talking about the concept. If the last captured image <i>before minimizing</i> is good enough for you, you could use the approach mentioned in that answer (with the help of the article provided by braX). If not, I also don&#39;t think it&#39;s possible to take a real time screenshot of a minimized window <i>while it&#39;s minimized</i>."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1501125644, "post_id": 45333776, "comment_id": 77643250, "body": "My question extended too, as above. (III)"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1501135433, "post_id": 45333776, "comment_id": 77646376, "body": "Ahmed Abdelhameed- Are you know: How can showing numbers in a Lable on User-Form, with Persian (Arabic) digits? (I asked this question (Here) because of your name, as I had this question from last)"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1501135554, "post_id": 45333776, "comment_id": 77646433, "body": "I extended my question as above. (Part III)"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501135664, "creation_date": 1501090130, "last_edit_date": 1501135664, "question_id": 45333776, "link": "https://stackoverflow.com/questions/45333776/how-can-taking-print-screen-with-vba", "title": "How can taking Print Screen with VBA?", "body": "<p>(I)</p>\n\n<p>I need prepare print screen, with VBA. Are there any <code>function</code> for do that?</p>\n\n<p>I tried record macro in MS-Word and MS-Excel, but nothing recorded when pressing <code>Print Screen</code> key.</p>\n\n<p>Only <code>.Paste</code> method was recorded.</p>\n\n<p>(II)</p>\n\n<p>How can Print Screen minimized window? (since Windows task-bar can create a preview of a window even if it is minimized? <a href=\"https://stackoverflow.com/questions/1517512/how-can-i-print-screen-minimized-windows\">Effecting this question for C#</a>) , by VBA</p>\n\n<p>(III)</p>\n\n<p>How can I assign above copied picture by <code>PrtSc</code> that was stored in clipboard, to <code>Picture</code> property of <code>Image</code> control in <code>User-form</code>?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1501210299, "creation_date": 1501210299, "answer_id": 45364075, "question_id": 45333764, "link": "https://stackoverflow.com/questions/45333764/how-to-rename-multiple-pdf-files-used-excel-database-vba/45364075#45364075", "title": "How to rename multiple pdf files used excel database vba", "body": "<p>For the renaming part, consider this.</p>\n\n<pre><code>Sub RenameFiles()\n'Updateby20141124\nDim xDir As String\nDim xFile As String\nDim xRow As Long\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\nIf .Show = -1 Then\n    xDir = .SelectedItems(1)\n    xFile = Dir(xDir &amp; Application.PathSeparator &amp; \"*\")\n    Do Until xFile = \"\"\n        xRow = 0\n        On Error Resume Next\n        xRow = Application.Match(xFile, Range(\"A:A\"), 0)\n        If xRow &gt; 0 Then\n            Name xDir &amp; Application.PathSeparator &amp; xFile As _\n            xDir &amp; Application.PathSeparator &amp; Cells(xRow, \"B\").Value\n        End If\n        xFile = Dir\n    Loop\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/2339-excel-rename-files-in-a-folder.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/2339-excel-rename-files-in-a-folder.html</a></p>\n\n<p>Also, consider this.</p>\n\n<pre><code>Sub ListFiles()\nDim MyFolder As String\nDim MyFile As String\nDim j As Integer\nMyFolder = \"C:\\DealerExam\"\nMyFile = Dir(MyFolder &amp; \"\\*.*\")\na = 0\nDo While MyFile &lt;&gt; \"\"\n    a = a + 1\n    Cells(a, 1).Value = MyFile\n    MyFile = Dir\nLoop\nEnd Sub\n</code></pre>\n\n<p>This will list all the files in your directory starting in cell 'A1'</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 8371626, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7faed84941c32f83a8355fa84720dd89?s=128&d=identicon&r=PG&f=1", "display_name": "WillGreco", "link": "https://stackoverflow.com/users/8371626/willgreco"}, "is_accepted": false, "score": 0, "last_activity_date": 1501282374, "creation_date": 1501282374, "answer_id": 45383442, "question_id": 45333764, "link": "https://stackoverflow.com/questions/45333764/how-to-rename-multiple-pdf-files-used-excel-database-vba/45383442#45383442", "title": "How to rename multiple pdf files used excel database vba", "body": "<p>Thanks for the help</p>\n\n<p>It is a bit tense to change language since I study Java and started doing VBA.</p>\n\n<p>When I ran the code, I saw that it is necessary for the spreadsheet to have the old file name and the new one to insert the data, but there is no way to get it to just get the new data? And I've tried searching on how to make them as PDF without having to put the file extension in the worksheet.</p>\n\n<p>Sorry for the questions ... I do not have much contact with VBA.</p>\n\n<p>I thank you very much for helping me.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub RenameFiles()\r\n\r\nDim xDir As String\r\nDim xFile As String\r\nDim xRow As Long\r\nWith Application.FileDialog(msoFileDialogFolderPicker)\r\n    .AllowMultiSelect = False\r\nIf .Show = -1 Then\r\n    xDir = .SelectedItems(1)\r\n    xFile = Dir(xDir &amp; Application.PathSeparator &amp; \"*\")\r\n    Do Until xFile = \"\"\r\n        xRow = 0\r\n        On Error Resume Next\r\n        xRow = Application.Match(xFile, Range(\"A:A\"), 0)\r\n        If xRow &gt; 0 Then\r\n            Name xDir &amp; Application.PathSeparator &amp; xFile As _\r\n            xDir &amp; Application.PathSeparator &amp; Cells(xRow, \"B\").Value\r\n        End If\r\n        xFile = Dir\r\n    Loop\r\nEnd If\r\nEnd With\r\nEnd Sub\r\n\r\nSub ListFiles()\r\nDim MyFolder As String\r\nDim MyFile As String\r\nDim j As Integer\r\nMyFolder = \"C:\\Users\\AnaWill\\Desktop\\Holerites Folha\\Nova pasta\"\r\nMyFile = Dir(MyFolder &amp; \"\\*.*\")\r\na = 0\r\nDo While MyFile &lt;&gt; \"\"\r\n    a = a + 1\r\n    Cells(a, 2).Value = MyFile\r\n    MyFile = Dir\r\nLoop\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 29, "user_id": 8371626, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7faed84941c32f83a8355fa84720dd89?s=128&d=identicon&r=PG&f=1", "display_name": "WillGreco", "link": "https://stackoverflow.com/users/8371626/willgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5939, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1501282374, "creation_date": 1501090104, "last_edit_date": 1531164843, "question_id": 45333764, "link": "https://stackoverflow.com/questions/45333764/how-to-rename-multiple-pdf-files-used-excel-database-vba", "title": "How to rename multiple pdf files used excel database vba", "body": "<p>Thanks in advance for your help and comments.</p>\n\n<p>I have the following problem, but I do not know if it is possible ... I am trying to rename PDF files that are in the folder C: \\ ... I need to rename according to a worksheet that I have in excel that is ordered according to the pdf files .. I would like to rename with the spreadsheet data in excel?</p>\n\n<p>I have a code that I researched but it does not search my database, but it asks me to enter the name of each file</p>\n\n<p>Public Sub lsSelecionaArquivo()\n    Dim Caminho As String\n    Dim NomeBase As String</p>\n\n<pre><code>Caminho = InputBox(\"Informe o local dos arquivos a serem renomeados:\", \"Pasta\", \"C:\\TEMP\")\nNomeBase = InputBox(\"Informe o local dos arquivos a serem renomeados:\", \"Renomear\", \"\")\n\n\nlsRenomearArquivos Caminho, NomeBase\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Public Sub lsRenomearArquivos(Caminho As String, NomeBase As String)</p>\n\n<pre><code>Dim FSO As Object, Pasta As Object, Arquivo As Object, Arquivos As Object\nDim Linha As Long\nDim lSeq As Long\nDim lNovoNome As String\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nIf Not FSO.FolderExists(Caminho) Then\n    MsgBox \"A pasta &amp;#39;\" &amp; Caminho &amp; \"&amp;#39; n\u00e3o existe.\", vbCritical, \"Erro\"\n    Exit Sub\nEnd If\n\nlSeq = 1\n\nSet Pasta = FSO.GetFolder(Caminho)\nSet Arquivos = Pasta.Files\n\nCells(1, 1) = \"De\"\nCells(1, 2) = \"Para\"\n\nLinha = 2\n\nFor Each Arquivo In Arquivos\n\n    Cells(Linha, 1) = UCase$(Arquivo.Path)\n    lNovoNome = Caminho &amp; \"\\\" &amp; NomeBase &amp; lSeq &amp; Right(Arquivo, 4)\n    Name Arquivo.Path As lNovoNome\n\n    Cells(Linha, 2) = lNovoNome\n    lSeq = lSeq + 1\n    Linha = Linha + 1\n\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "centroid"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1501091203, "post_id": 45333719, "comment_id": 77630193, "body": "This is much too broad: <a href=\"https://en.wikipedia.org/wiki/Facility_location_problem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Facility_location_problem</a> If you want a command which can be used as a UDF (<code>=getCentroid</code>) you will have to 1) carefully formulate your problem (with much more detail than you give in the question), 2) decide on an algorithm to solve it, at least heuristically, and 3) implement your algorithm in VBA. Perhaps you can edit your question so that at least <code>1</code> above is done."}, {"owner": {"reputation": 201, "user_id": 5474002, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c0eb8a0f5cdff47c223b2bbaf498a78?s=128&d=identicon&r=PG&f=1", "display_name": "nola94", "link": "https://stackoverflow.com/users/5474002/nola94"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501091968, "post_id": 45333719, "comment_id": 77630650, "body": "@JohnColeman check my edit"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501092002, "post_id": 45333719, "comment_id": 77630673, "body": "Yes, that does help to clarify it."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501100263, "post_id": 45333719, "comment_id": 77635246, "body": "There is much about that code which is obscure (e.g. <code>lats = lats + Cells(i, 2)</code> -- why add latitudes together? There is no geometric motivation for doing so and the variable <code>lats</code> isn&#39;t even used anywhere in the rest of the code). I would consider throwing the code away and starting from scratch. It shouldn&#39;t be too hard to find pseudocode for computing the centroid of a discrete mass distribution on the surface of a sphere (where presumably the mass at a given location is the quantity there) and it shouldn&#39;t be too hard to code it in VBA. Might be easier than trying to decipher old code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501100631, "post_id": 45333719, "comment_id": 77635466, "body": "For example, this idea should be easy to implement: <a href=\"https://math.stackexchange.com/a/1907447/294695\">math.stackexchange.com/a/1907447/294695</a>"}, {"owner": {"reputation": 201, "user_id": 5474002, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c0eb8a0f5cdff47c223b2bbaf498a78?s=128&d=identicon&r=PG&f=1", "display_name": "nola94", "link": "https://stackoverflow.com/users/5474002/nola94"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501158953, "post_id": 45333719, "comment_id": 77662845, "body": "@JohnColeman This is what I&#39;ve been asking for. I do not know how to write a code that would do such a thing."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501253610, "post_id": 45333719, "comment_id": 77714538, "body": "How are you entering latitudes and longitudes? As DMS strings like <code>41&#176; 28\u2032 56\u2033 N, 81&#176; 40\u2032 11\u2033 W</code> or as decimal numbers like <code>41.482222, -81.669722</code>?"}, {"owner": {"reputation": 201, "user_id": 5474002, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c0eb8a0f5cdff47c223b2bbaf498a78?s=128&d=identicon&r=PG&f=1", "display_name": "nola94", "link": "https://stackoverflow.com/users/5474002/nola94"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501253916, "post_id": 45333719, "comment_id": 77714748, "body": "I am adding them like decimal points. Currently, that code only requires me to enter them both as positive rather than positive and negative."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501254201, "post_id": 45333719, "comment_id": 77714942, "body": "Then how do you distinguish between 45 degrees N and 45 degrees S if you don&#39;t use negative signs? Similar remarks hold for E and W."}, {"owner": {"reputation": 201, "user_id": 5474002, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c0eb8a0f5cdff47c223b2bbaf498a78?s=128&d=identicon&r=PG&f=1", "display_name": "nola94", "link": "https://stackoverflow.com/users/5474002/nola94"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501254666, "post_id": 45333719, "comment_id": 77715311, "body": "I believe the code was just made like that because all the coordinates are dealing with north america so it is easier to not have to worry about the negative sign every time."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501699498, "post_id": 45333719, "comment_id": 77898289, "body": "That makes sense. Furthermore, if all of the locations are in the same part of the earth than the distortion which comes from treating it as a sphere won&#39;t be too great, although I don&#39;t think that they will ever be negligible. Did the wrapper function I wrote in the last edit help out?"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1501266402, "last_edit_date": 1592644375, "creation_date": 1501169968, "answer_id": 45355322, "question_id": 45333719, "link": "https://stackoverflow.com/questions/45333719/warehouse-centroid-vba/45355322#45355322", "title": "Warehouse Centroid VBA", "body": "<p>Here is some code which handles the mathematical part of computing the weighted-centroid on the surface of the sphere:</p>\n<pre><code>'the following code assumes that A is a 4 column, 1-based, 2-dimensional array whose\n'first three columns are the x,y,z coordinats of a point on a sphere centered at the origin\n'and whose 4th column is the mass at that point\n'returns a 0-based variant array of the x,y,z coordinates of the centroid\n\nFunction SphericalCentroid(A As Variant) As Variant\n    Dim r As Double 'radius of sphere\n    Dim pm As Double 'point-mass\n    Dim m As Double 'total mass\n    Dim mxy As Double, mxz As Double, myz As Double 'moments about coordinate planes\n    Dim xbar As Double, ybar As Double, zbar As Double 'true centroid\n    Dim d As Double 'distance of true centroid from center -- used to project to surface\n    Dim i As Long, n As Long\n    \n    If TypeName(A) = &quot;Range&quot; Then A = A.Value\n    n = UBound(A)\n    r = Sqr(A(1, 1) ^ 2 + A(1, 2) ^ 2 + A(1, 3) ^ 2)\n    For i = 1 To n\n        pm = A(i, 4)\n        m = m + pm\n        myz = myz + pm * A(i, 1)\n        mxz = mxz + pm * A(i, 2)\n        mxy = mxy + pm * A(i, 3)\n    Next i\n    xbar = myz / m\n    ybar = mxz / m\n    zbar = mxy / m\n    d = Sqr(xbar ^ 2 + ybar ^ 2 + zbar ^ 2)\n    If d &lt; 0.001 * r Then 'located at the center -- return pole\n        SphericalCentroid = Array(0, 0, r)\n    Else\n        SphericalCentroid = Array(xbar * r / d, ybar * r / d, zbar * r / d)\n    End If\nEnd Function\n</code></pre>\n<p>The following screenshot shows how it could be used:</p>\n<p><a href=\"https://i.stack.imgur.com/fk67C.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fk67C.gif\" alt=\"enter image description here\" /></a></p>\n<p>In the above I used the array formula (<code>=SphericalCentroid(A2:D4)</code>) in cells <code>A5:C5</code>  (entered with <code>Ctrl + Shift + Enter</code>).</p>\n<p>The code first computes the center of mass in 3-dimensional space (which will locate it somewhere in the interior of the sphere) and then projects it onto the sphere itself.</p>\n<p>To use this for your problem, you would need to create a wrapper function which translates from latitude/longitude to Cartesian coordinates (approximating the earth as a sphere -- which does have its problems), invoking the above function, and then translating back to latitude/longitude.</p>\n<p><strong>On Edit</strong> For fun, I wrote a wrapper function:</p>\n<pre><code>'the following function takes a 3-column range, the first column is decimal latitude,\n'the second is decimal longitude (assuming in North America),\n'the third is number of shipments from that location\n'the return value is the decimal latitude and longitude of\n'the centroid\n\nFunction GetCentroid(data As Range) As Variant\n    Dim r As Double\n    Dim lat As Double, lon As Double\n    Dim x As Double, y As Double, z As Double\n    Dim A As Variant\n    Dim i As Long, n As Long\n    Dim centroid As Variant\n    \n    r = 3959 'radius of earth\n    n = data.Rows.Count\n    ReDim A(1 To n, 1 To 4)\n    \n    With Application.WorksheetFunction\n        For i = 1 To n\n            lat = .Radians(data.Cells(i, 1).Value)\n            lon = .Radians(data.Cells(i, 2).Value)\n            A(i, 1) = r * Cos(lat) * Cos(lon)\n            A(i, 2) = r * Cos(lat) * Sin(lon)\n            A(i, 3) = r * Sin(lat)\n            A(i, 4) = data.Cells(i, 3).Value\n        Next i\n        centroid = SphericalCentroid(A)\n        x = centroid(0)\n        y = centroid(1)\n        z = centroid(2)\n        lat = .Degrees(.Asin(z / r))\n        lon = .Degrees(.Atan2(x, y))\n    End With\n    GetCentroid = Array(lat, lon)\nEnd Function\n</code></pre>\n<p>Used like:</p>\n<p><a href=\"https://i.stack.imgur.com/n4h7M.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4h7M.gif\" alt=\"enter image description here\" /></a></p>\n<p>The three locations in the input list are at Cleveland, Cincinnati, and Pittsburgh respectively, and the returned centroid is in central Ohio (somewhat close to Zanesville -- which seems plausible enough).</p>\n<p>I doubt that it is anything better than a crude heuristic, but it gives a rough idea for where a good location would be.</p>\n"}], "owner": {"reputation": 201, "user_id": 5474002, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c0eb8a0f5cdff47c223b2bbaf498a78?s=128&d=identicon&r=PG&f=1", "display_name": "nola94", "link": "https://stackoverflow.com/users/5474002/nola94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501266402, "creation_date": 1501089965, "last_edit_date": 1501092471, "question_id": 45333719, "link": "https://stackoverflow.com/questions/45333719/warehouse-centroid-vba", "title": "Warehouse Centroid VBA", "body": "<p>I am trying to write a formula that takes into consideration 'n' amount of customers at 'x' address and how much they order ('q'). I would like for the formula to then print out the latitude/longitude of the best location that the 'centroid' warehouse should be.</p>\n\n<p>I would prefer for it to be a command such as <code>=getCentroid</code>.</p>\n\n<p>Thanks for any help.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Since some people might think that this is too broad or does not have enough information -- I will provide an old code I have.</p>\n\n<p>This code takes the latitudes and longitudes that I enter, and then considers the number of shipments and then proceeds to tell me where the new warehouse should be. It is so old, that I am not sure how it works.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim i As Integer\nDim j As Integer\nDim count As Integer\ni = 3\nj = 0\ncount = 3\ndtr = 0.0174533 'degrees to radians calculation\nRTD = 57.2958 'radians to degrees\nLatFactor = 69.172 'miles in 1 degree change in lat\n\n\n\n'Finds how many locations there are around whs as j\nDo While Cells(i, 2) &lt;&gt; \"\"\n    j = j + 1\n    lats = lats + Cells(i, 2)\n    Longs = Longs + Cells(i, 3)\n    i = i + 1\nLoop\n\n\n'Create arrays of lats and longs starting at  0\nDim lat() As Variant\nReDim lat(0 To j)\nDim lon() As Variant\nReDim lon(0 To j)\nFor x = 1 To j\n    lat(count - 3) = Cells(count, 2)\n    lon(count - 3) = Cells(count, 3)\n    count = count + 1\nNext\n\nR = 3959 'Radius of earth\nwhsLat = Cells(2, 2) 'Lattitude of Whs in NOT Radians\nwhsLon = Cells(2, 3) 'Lattitude of whs NOT in rads\nwhsLatr = Cells(2, 2) * dtr\nwhsLonr = Cells(2, 3) * dtr\n\n\n'Calculates distance from warehouse to location 1 as d\n'uses haversine formula-as crow flies\n\nDim Distances() As Variant\nReDim Distances(0 To j)\nFor x = 1 To j\n    Clat = lat(x - 1) * dtr\n    deltaLat = (lat(x - 1) - whsLat) * dtr\n    deltaLon = (lon(x - 1) - whsLon) * dtr\n    a = (Math.Sin(deltaLat / 2) * Math.Sin(deltaLat / 2)) +                \n(Math.Cos(whsLatr) * Math.Cos(Clat) * Math.Sin(deltaLon / 2) *         \nMath.Sin(deltaLon / 2))\n    c = 2 * Math.Atn((Math.Sqr(a) / Math.Sqr(1 - a)))\n    d = R * c\n    Distances(x - 1) = d 'distance values\n    Cells(x + 2, 13) = d\nNext\nTotalMiles = WorksheetFunction.Sum(Distances)\nstep = 1\n\n\n'Calculate optimum location using halves\n\nOlat = lat(0)\nOlon = lon(0)\nOLatr = lat(0) * dtr\nOLonr = lon(0) * dtr\nDlat = lat(1)\nDLatr = lat(1) * dtr\nDlon = lon(1)\nDlonr = lon(1) * dtr\nLatChange = (lat(1) - Olat) * dtr\nLonChange = (lon(1) - Olon) * dtr\n\n'Counting Variables for weight\ny = 3\nZ = 4\nShipSum = Cells(y, 4) + Cells(Z, 4)\nFor x = 1 To j - 1\nanew = (Math.Sin(LatChange / 2) * Math.Sin(LatChange / 2)) +     \n(Math.Cos(OLatr) * Math.Cos(DLatr) * Math.Sin(LonChange / 2) * \nMath.Sin(LonChange / 2))\ncnew = 2 * Math.Atn((Math.Sqr(anew) / Math.Sqr(1 - anew)))\ndnew = R * cnew\n'Calculate new lat and long\nhyp = dnew / 2 ' Total distance moved\nadj = Abs(LatFactor * (Dlat - Olat)) 'y distance\nDegree = WorksheetFunction.Acos(adj / dnew * dtr) 'degree from 90\nIf (Dlat - Olat) &gt; 0 Then NewLat = Olat + (Cells(Z, 4) / (ShipSum)) *         \nAbs(hyp / LatFactor * Math.Cos(Degree) * RTD) 'New lattitude if going up\nIf (Dlat - Olat) &lt; 0 Then NewLat = Olat - (Cells(Z, 4) / (ShipSum)) *     \nAbs(hyp / LatFactor * Math.Cos(Degree) * RTD) 'New Lattitude if going down\nOpp = (Dlon - Olon) * Math.Cos(NewLat * dtr) 'x distance adjusted for polar     \nflattening\nIf (Dlon - Olon &gt; 0) Then NewLon = Olon + (Cells(Z, 4) / (ShipSum)) *     \nAbs(Opp) 'new long\nIf (Dlon - Olon &lt; 0) Then NewLon = Olon - (Cells(Z, 4) / (ShipSum)) *     \nAbs(Opp)\nOlat = NewLat 'Setting new origin\nOlon = NewLon\nOLatr = NewLat * dtr\nOLonr = NewLon * dtr\nIf x &lt; j Then\n    Dlat = lat(x + 1) 'If there is another iteration, set new destination\n    DLatr = lat(x + 1) * dtr\n    Dlon = lon(x + 1)\n    Dlonr = lon(x + 1) * dtr\n    LatChange = (lat(x + 1) - Olat) * dtr\n    LonChange = (lon(x + 1) - Olon) * dtr\n    y = y + 1\n    Z = Z + 1\n    ShipSum = ShipSum + Cells(Z, 4)\nEnd If\nNext\n\nCells(3, 8) = NewLat\nCells(3, 9) = \"-\" &amp; NewLon\n\nwhsLat = NewLat 'Lattitude of New Whs in NOT Radians\nwhsLon = NewLon 'Lattitude of whs NOT in rads\nwhsLatr = NewLat * dtr\nwhsLonr = NewLon * dtr\n\n\n'Calculates distance from warehouse to location 1 as d\n'uses haversine formula-as crow flies\n\nDim NewDistances() As Variant\nReDim NewDistances(0 To j)\nFor x = 1 To j\n    Clat = lat(x - 1) * dtr\n    deltaLat = (lat(x - 1) - whsLat) * dtr\n    deltaLon = (lon(x - 1) - whsLon) * dtr\n    a = (Math.Sin(deltaLat / 2) * Math.Sin(deltaLat / 2)) +     \n(Math.Cos(whsLatr) * Math.Cos(Clat) * Math.Sin(deltaLon / 2) *     \nMath.Sin(deltaLon / 2))\n    c = 2 * Math.Atn((Math.Sqr(a) / Math.Sqr(1 - a)))\n    d = R * c\n    Cells(x + 2, 10) = d\n    NewDistances(x - 1) = d 'distance values\nNext\nNewTotalMiles = WorksheetFunction.Sum(NewDistances)\nCells(j + 3, 10) = NewTotalMiles\nWorksheets(\"Sheet1\").Range(\"K3:K100\").ClearContents\n\ni = 3\nDo While i &lt; 44\n    Cells(i, 11) = Cells(i, 10) * Cells(i, 4)\n    i = i + 1\nLoop\nCells(11, 11) = Cells(3, 11) + Cells(4, 11) + Cells(5, 11) + Cells(6, 11) +     \nCells(7, 11) + Cells(8, 11) + Cells(9, 11) + Cells(10, 11)\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 782, "user_id": 3712761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1aPMK.png?s=128&g=1", "display_name": "dashiell", "link": "https://stackoverflow.com/users/3712761/dashiell"}, "edited": false, "score": 0, "creation_date": 1501090040, "post_id": 45333687, "comment_id": 77629464, "body": "Potentially relevant: <a href=\"https://stackoverflow.com/questions/25400240/using-pandas-combining-merging-2-different-excel-files-sheets\" title=\"using pandas combining merging 2 different excel files sheets\">stackoverflow.com/questions/25400240/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 8371465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5a34bfa063eb7bea8ad1a497423cf7?s=128&d=identicon&r=PG&f=1", "display_name": "James Flanagin", "link": "https://stackoverflow.com/users/8371465/james-flanagin"}, "edited": false, "score": 0, "creation_date": 1501610950, "post_id": 45348961, "comment_id": 77850598, "body": "I keep on getting &quot;Missing&#39; in the third, fourth, fifth, etc. columns (depending on how many files I put). It just says &quot;missing&quot; instead of having the values from the tables."}], "tags": [], "owner": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "is_accepted": true, "score": 0, "last_activity_date": 1501612140, "last_edit_date": 1501612140, "creation_date": 1501153424, "answer_id": 45348961, "question_id": 45333687, "link": "https://stackoverflow.com/questions/45333687/combine-second-column-of-an-excel-spreadsheet/45348961#45348961", "title": "Combine Second Column of an Excel Spreadsheet", "body": "<blockquote>\n  <p><strong>Comment</strong>: I keep on getting \"Missing' in the third, fourth, fifth, etc. column  </p>\n</blockquote>\n\n<p>Add the following <code>print(...</code> and <strong>Edit your Question to show the Output</strong>:  </p>\n\n<pre><code>            for values in csv_reader:\n                # Init Header Order\n                header_keys.append(values['header'])\n                ws.append((values['header'], values['data']))\n            print('header_keys:{}'.format(header_keys)\n        else:\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>Question</strong>: ... combine the second column of all ... sort them so that they match up the 1st column</p>\n</blockquote>\n\n<p>The following is a <code>csv/openpyxl</code> Solution:<br>\nReading n CSV Files aggregate the Second Column sorted like in the First CSV File.  </p>\n\n<pre><code>from openpyxl import Workbook\nimport csv\n\nwb = Workbook()\nws = wb.worksheets[0]\n\nheader_keys = []\nfor n, fName in enumerate(['2874.csv', '2875.csv']):\n    with open(fName) as fh:\n        csv_reader = csv.DictReader(fh, fieldnames=['header', 'data'], delimiter='\\t')\n        if n == 0:\n            for values in csv_reader:\n                # Init Header Order\n                header_keys.append(values['header'])\n                ws.append((values['header'], values['data']))\n        else:\n            # Read all Data to Dict \n            data = {}\n            for values in csv_reader:\n                data[values['header']] = values['data']\n\n            # Write all Data in header_keys Order\n            column = n + 2\n            for row, key in enumerate(header_keys, 1):\n                try:\n                    ws.cell(row=row, column=column).value = data[key]\n                except:\n                    print('FAIL: Key \"{}\" not in Dict data'.format(key))\n                    ws.cell(row=row, column=column).value = 'MISSING'\n\nwb.save('result.xlsx')\n</code></pre>\n\n<p><strong><em>Tested with Python: 3.4.2 - openpyxl: 2.4.1 - LibreOffice: 4.3.3.2</em></strong></p>\n"}], "owner": {"reputation": 135, "user_id": 8371465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5a34bfa063eb7bea8ad1a497423cf7?s=128&d=identicon&r=PG&f=1", "display_name": "James Flanagin", "link": "https://stackoverflow.com/users/8371465/james-flanagin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 45348961, "answer_count": 1, "score": 0, "last_activity_date": 1501612140, "creation_date": 1501089850, "last_edit_date": 1531161705, "question_id": 45333687, "link": "https://stackoverflow.com/questions/45333687/combine-second-column-of-an-excel-spreadsheet", "title": "Combine Second Column of an Excel Spreadsheet", "body": "<p>I currently have about 100 excel files each with two columns. The first column contains the \"headers\" and the second column has the values. They each look something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NVkgs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NVkgs.png\" alt=\"ExcelSpreadsheet\"></a></p>\n\n<p>I want to combine these, so that there is one final excel file that contains the data from ALL of these; so that it will look something like this (just with way more columns):</p>\n\n<p><a href=\"https://i.stack.imgur.com/5GqTX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5GqTX.png\" alt=\"Combined (How it should look at the end, but with all 100 columns)\"></a></p>\n\n<p>The other problem also is that not all of the files have those headers in the same order. If you look at that \"Combined\" picture, for example, you'll see that those two items had common headers. However, in some of the other files, the header orders may be switched. For instance, \"GPU Variant\" may be before \"GPU Name\", etc.</p>\n\n<p>So essentially, here's what I need to do. Find a way to combine the second column of all of these spreadsheets, and then find a way to sort them so that they match up the 1st column.</p>\n\n<p>If there's a way to program a macro to do this, can someone guide me as to how to do it? Are there external programs that are already designed to do this? Excel VBA maybe? This is the code that I have right now, but I don't think this addresses it properly:</p>\n\n<pre><code>import xlwt\nimport xlrd\nimport os\nimport csv\n\n\ncurrent_file = xlwt.Workbook()\nwrite_table = current_file.add_sheet('sheet1', cell_overwrite_ok=True)\n\nkey_list = [u'GPU Name:', u'GPU Variant:', u'Architecture:', u'Process Size:', u'Transistors:', u'Die Size:', u'Released:']\nfor title_index, text in enumerate(key_list):\n    write_table.write(0, title_index, text)\n\n\nfile_list = ['2874.csv', '2875.csv']\n\ni = 1\nfor name in file_list:\n    data = xlrd.open_workbook(name)\n\ntable = data.sheets()[0]\nnrows = table.nrows\nfor row in range(nrows):\n    if row == 0:\n        continue\n    for index, context in enumerate(table.row_values(row)):\n        write_table.write(i, index, context)\n    i += 1\n\n\ncurrent_file.save(os.getcwd() + '/result.csv')\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1501089045, "post_id": 45333358, "comment_id": 77628811, "body": "ctl!Enabled = False"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1501089484, "post_id": 45333358, "comment_id": 77629124, "body": "I received the following runtime error: <code>Property let procedure not defined and property get procedure did not return an object</code>"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501089837, "post_id": 45333358, "comment_id": 77629340, "body": "What is the issue with your code?"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501089887, "post_id": 45333358, "comment_id": 77629371, "body": "The line <code>Ctl.Enabled = False</code> is raising errors"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501092168, "post_id": 45333358, "comment_id": 77630789, "body": "Is it possible some of the controls on your form don&#39;t have an Enabled property?"}, {"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1501096100, "post_id": 45333358, "comment_id": 77632911, "body": "Not all control types have an Enabled property. You will need to check that the control is of the correct type before changing the Enabled property. (e.g. Checkbox, Combobox, Textbox, Subform)"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501089867, "post_id": 45333671, "comment_id": 77629361, "body": "I&#39;m still receiving an error on the line <code>ctl.Enabled = False</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501089924, "post_id": 45333671, "comment_id": 77629389, "body": "@Steven I just full tested it and it ran fine, can you share the rest of the user_form code ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501090178, "post_id": 45333671, "comment_id": 77629552, "body": "@Steven try edited code, let me know what you are getting in the immediate window when you get your erro"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501090342, "post_id": 45333671, "comment_id": 77629654, "body": "<code>Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method.</code> I changed the Enabled property to Visible and it worked fine."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1501090150, "last_edit_date": 1501090150, "creation_date": 1501089799, "answer_id": 45333671, "question_id": 45333358, "link": "https://stackoverflow.com/questions/45333358/disabling-specific-controls-on-a-form/45333671#45333671", "title": "Disabling specific controls on a form", "body": "<p>Try the code below:</p>\n\n<pre><code>Dim ctl As Control\nFor Each ctl In Me.Controls\n    Debug.Print TypeName(ctl)\n    If TypeName(ctl) &lt;&gt; \"ComboBox\" Then ' &lt;-- check if control is not a Combo-Box\n        Debug.Print ctl.Name\n        If ctl.Name &lt;&gt; \"SrchVal\" Then\n            ctl.Enabled = False\n        End If\n    End If\nNext ctl\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594650964, "creation_date": 1501088883, "last_edit_date": 1594650964, "question_id": 45333358, "link": "https://stackoverflow.com/questions/45333358/disabling-specific-controls-on-a-form", "title": "Disabling specific controls on a form", "body": "<p>I've looked all over, even scoured documentation, and I'm having trouble finding an answer to a seemingly simple problem.</p>\n\n<pre><code>    Dim ctl As Control\nFor Each ctl In Me.Controls\n    If ctl.ControlType &lt;&gt; acComboBox Then\n        If ctl.Name &lt;&gt; \"SrchVal\" Then\n            ctl.Enabled = False\n        End If\n    End If\nNext ctl\n</code></pre>\n\n<p>I have a ton of textbox controls on my form which are being used for data entry. They should all be locked (disabled) until a certain button is clicked, an event I'll handle later.</p>\n\n<p>However, there are a few combo box controls and one text box control I don't want disable, titled <code>SrchVal</code>.</p>\n\n<p>I know that the Control object doesn't have an Enabled property, so how do I solve this?</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 698, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501092296, "creation_date": 1501088589, "last_edit_date": 1501092296, "question_id": 45333258, "link": "https://stackoverflow.com/questions/45333258/excel-vba-to-search-a-websites-search-box-and-click-a-link-button", "title": "Excel VBA to search a website&#39;s search box and click a link/button", "body": "<p>I'm using Excel VBA to log into a website, then type a .txt file name in a search box and click a button/link to search for it in the resulting second page. The resulting third page has an icon you have to click to download the file. Lastly I want to input the info in the .txt file to a new excel spreadsheet.</p>\n\n<p>My getLogin function works and I successfully log into the website. Stepping through with F8 I can see each line of code entering in my username and password values in the respective fields. I'm on the second page level where I want to search in a searchbox using a filename, but at</p>\n\n<pre><code>If Not FileN Is Nothing And FileN.Length &gt; 0 Then\n        FileN(0).Value = fileName \n</code></pre>\n\n<p>in the SearchFile function, when I step through it using F8, I see it keeps skipping FileN(0).Value = fileName and doesn't input the file name. The same happens for the link I click to search,</p>\n\n<pre><code>Set ElementCol = ie.document.getElementsByTagName(\"a\")\n    For Each l In ElementCol\n        If l.href = \"javascript:myFunction('/mailbox/jsp/MBIList.jsp')\" Then\n            l.Click\n</code></pre>\n\n<p>It doesn't enter the If Statement and therefore doesn't click it.</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub getComponents()\n\n   Dim WebAddressIn As String\n   Dim ie As Object\n\n   WebAddressIn = \"https://...\"\n\n   'get ie instance to work with that is logged in\n   Set ie = getLogin(WebAddressIn, \"usern\", \"pw\")\n\n    Do Until ie.readyState = 4\n    Loop\n\n     ie.Visible = True\n\n     Dim fileName As String\n     fileName = Format(Now(), \"yyyyMMdd\") &amp; \".TXT\"\n     Set ie = searchFile(fileName, ie)\n\nEnd Sub\n\nFunction searchFile(fileName As String, ie As Object)\nDim Doc As Object, lastRow As Long, tblTR As Object\n    Dim UserString As String\n    Dim FileN As Object ' MSHTML.IHTMLElement\n    Dim ElementCol As Object ' MSHTML.IHTMLElementCollection\n    Dim AllText As String\n\n    Do While ie.Busy\n    Loop\n\n    Set FileN = ie.document.getElementsByName(\"MsgNamePattern\")\n    If Not FileN Is Nothing And FileN.Length &gt; 0 Then\n        FileN(0).Value = fileName\n    End If\n\n    Do While ie.Busy\n    Loop\n\n    Set ElementCol = ie.document.getElementsByTagName(\"a\")\n    For Each l In ElementCol\n        If l.href = \"javascript:myFunction('/mailbox/jsp/MBIList.jsp')\" Then\n            l.Click\n    Exit For\n        End If\n    Next l\n\n    Do While ie.Busy\n    Loop\n\n    Set searchFile = ie\n    Set ie = Nothing\n\nEnd Function\n\nFunction getLogin(WebAddressIn As String, UserNameIn As String, PasswordIn As String)\nDim Doc As Object, lastRow As Long, tblTR As Object\n    Set ie = CreateObject(\"internetexplorer.application\")\n    ie.Visible = False\n    Dim UserString As String\n    Dim PWString As String\n    ie.Navigate2 WebAddressIn\n    ie.Visible = True\n\n    Dim UserN As Object ' MSHTML.IHTMLElement\n    Dim PW As Object ' MSHTML.IHTMLElement\n    Dim ElementCol As Object ' MSHTML.IHTMLElementCollection\n    Dim AllText As String\n\n    Do While ie.Busy\n    Loop\n\n    ' enter username and password in textboxes\n    Set UserN = ie.document.getElementsByName(\"userid\")\n    If Not UserN Is Nothing And UserN.Length &gt; 0 Then\n        ' fill in first element named \"username\", assumed to be the login name field\n        UserN(0).Value = UserNameIn\n    End If\n\n    Set PW = ie.document.getElementsByName(\"password\")\n    ' password\n    If Not PW Is Nothing And PW.Length &gt; 0 Then\n        ' fill in first element named \"password\", assumed to be the password field\n        PW(0).Value = PasswordIn\n    End If\n\n    Do While ie.Busy\n    Loop\n\n    'Clicks the Sign in button\n    Set ElementCol = ie.document.getElementsByName(\"submit\")\n    For Each btnInput In ElementCol\n        If btnInput.Value = \"*Sign In\" Then\n            btnInput.Click\n            Exit For\n        End If\n    Next btnInput\n\n    Do While ie.Busy\n    Loop\n\n     Set getLogin = ie\n    Set ie = Nothing\n\nEnd Function\n</code></pre>\n\n<p>And here's the relevant HTML code on this second resulting page:</p>\n\n<p>The Search Box - </p>\n\n<pre><code>&lt;input type=\"text\" name=\"MsgNamePattern\" size=\"20\" onblur=\"validateMessageName(this)\"&gt;\n</code></pre>\n\n<p>The link to search -</p>\n\n<pre><code>&lt;td align=\"center\" valign=\"center\"&gt; &lt;a href=\"javascript:myFunction('/mailbox/jsp/List.jsp')\" onmouseover=\"chgButton('Go','GoOver'); window.status=''; return true;\" onmouseout=\"chgButton('Go','GoOff'); window.status=''; return true;\" onmousedown=\"chgButton('Go','GoDown'); return true;\"&gt;&lt;img border=\"0\" src=\"/mailbox/images/go_off.gif\" vspace=\"7\" name=\"Go\" align=\"top\"&gt;&lt;/a&gt; \n                  &lt;/td&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501087929, "post_id": 45332833, "comment_id": 77628048, "body": "What&#39;s the problem with your current code?"}, {"owner": {"reputation": 23, "user_id": 8327677, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/59648af1bcf2f6080471bcbdc8764da0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Chiu", "link": "https://stackoverflow.com/users/8327677/kevin-chiu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501089590, "post_id": 45332833, "comment_id": 77629190, "body": "It would not go past cell.value = &quot;final EFT payment amount &quot;.. not sure if it&#39;s a syntax problem... sorry, I am still new to VBA"}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "edited": false, "score": 0, "creation_date": 1501100613, "post_id": 45334970, "comment_id": 77635458, "body": "<code>For Each Cell In Sheets(&quot;Payment Summary&quot;).Range(&quot;B:B&quot;)</code> appears in the original code, which is in implicit declaration."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1501094181, "creation_date": 1501094181, "answer_id": 45334970, "question_id": 45332833, "link": "https://stackoverflow.com/questions/45332833/look-through-all-files-in-all-subfolders-and-retrieve-data-from-one-cell-and-pas/45334970#45334970", "title": "Look through all files in ALL subfolders and retrieve data from one cell and paste on Master Workbook", "body": "<p>You arent defining what <code>Cell</code> is - put <code>Option Explicit</code> at the very top of your module and then try compiling and it will tell you the things you forgot to define. To define  it use</p>\n\n<p><code>Dim Cell as Range</code></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1501094658, "creation_date": 1501094658, "answer_id": 45335100, "question_id": 45332833, "link": "https://stackoverflow.com/questions/45332833/look-through-all-files-in-all-subfolders-and-retrieve-data-from-one-cell-and-pas/45335100#45335100", "title": "Look through all files in ALL subfolders and retrieve data from one cell and paste on Master Workbook", "body": "<p>Untested:</p>\n\n<pre><code>Sub PaymentFileMatching()\n\n\n    Const HostFolder As String = _\n             \"C:\\Users\\kxc8574\\Documents\\Payment Files\\Payment Files (Corrected)\\PE20170701\\\"\n\n    Dim i As Long\n    Dim FSO As Object, objFolder As Object, FileInFolder As Object\n    Dim wb As Workbook, Masterwb As Workbook, MasterSht As Worksheet, sht As Worksheet\n    Dim objSubFolder As Object, f As Range, fName As String\n\n    Set FSO = CreateObject(\"Scripting.filesystemobject\")\n    Set objFolder = FSO.GetFolder(HostFolder)\n\n    Set Masterwb = Workbooks(\"Master Template\")\n    Set MasterSht = Masterwb.Sheets(\"Sheet9\")\n\n    MasterSht.Activate\n    MasterSht.Cells(1, 1).Resize(1, 2).Value = Array(\"GROUPER\", \"EFT_AMOUNT\")\n\n    i = 2\n    For Each objSubFolder In objFolder.subfolders\n        For Each FileInFolder In objSubFolder.Files\n\n            fName = FileInFolder.Name\n            MasterSht.Cells(i, 1).Value = Left(fName, InStr(fName, \"PE 2017\") - 1)\n\n            Set wb = Workbooks.Open(objSubFolder &amp; \"\\\" &amp; fName)\n\n            For Each sht In wb.Worksheets\n                Set f = sht.Columns(2).Find(\"Final EFT Payment Amount\", , xlValues, xlWhole)\n                If Not f Is Nothing Then\n                    MasterSht.Cells(i, 2).Value = f.EntireRow.Cells(8).Value\n                    i = i + 1\n                    Exit For 'found the value...\n                End If\n                Set f = Nothing\n            Next sht\n\n            wb.Close False\n\n        Next FileInFolder\n    Next objSubFolder\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8327677, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/59648af1bcf2f6080471bcbdc8764da0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Chiu", "link": "https://stackoverflow.com/users/8327677/kevin-chiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501094658, "creation_date": 1501087099, "last_edit_date": 1501089530, "question_id": 45332833, "link": "https://stackoverflow.com/questions/45332833/look-through-all-files-in-all-subfolders-and-retrieve-data-from-one-cell-and-pas", "title": "Look through all files in ALL subfolders and retrieve data from one cell and paste on Master Workbook", "body": "<p>I want to create something that would loop through all the files from a directory with subfolders. Then, it would open each excel file and copy the total amount. The cell that contains the total is not always in a specific row, but column B of that row contains the text \" TOTAL AMOUNT\". The cell that contains the total is ALWAYS in column I. After it copies the cell, paste in the Master workbook ( the workbook the macro is running from ) in a new sheet in cell (i,2)</p>\n\n<p>Cell(1,1) and Cell(1,2) are headers. \"GROUPER\" and \"EFT_AMOUNT\"</p>\n\n<p>Here is what I have so far : </p>\n\n<pre><code>Sub PaymentFileMatching()\n\n\n    Dim HostFolder As String\n    Dim f As String, i As Long, arr, sht As Worksheet\n    Dim FSO As Object, objFolder As Object, FileInFolder As Object\n    Dim wb As Workbook, Masterwb As Workbook\n    Set sht = ActiveSheet\n    Set FSO = CreateObject(\"Scripting.filesystemobject\")\n\n    Dim objSubFolder As Object\n    HostFolder = \"C:\\Users\\kxc8574\\Documents\\Payment Files\\Payment Files (Corrected)\\PE20170701\\\"\n    Set objFolder = FSO.GetFolder(HostFolder)\n    Set Masterwb = Workbooks(\"Master Template\")\n    Sheets(\"Sheet9\").Activate\n    sht.Cells(1, 1).Resize(1, 2).Value = _\n                Array(\"GROUPER\", \"EFT_AMOUNT\")\n    i = 2\n    For Each objSubFolder In objFolder.subfolders\n        For Each FileInFolder In objSubFolder.Files\n            sht.Cells(i, 1).Value = Left(FileInFolder.Name, InStr(FileInFolder.Name, \"PE 2017\") - 1)\n            Set wb = Workbooks.Open(objSubFolder &amp; \"\\\" &amp; FileInFolder.Name)\n                For Each sht In Worksheets\n                    For Each Cell In Sheets(\"Payment Summary\").Range(\"B:B\")\n                        If Cell.Value = \"Final EFT Payment Amount\" Then\n                            matchRow = Cell.Row\n                            Cells(matchRow, 8).Copy\n                            Workbooks(\"Master Template\").Worksheets(\"Sheet9\").Cells(i, 2).PasteSpecial xlPasteValues\n                            i = i + 1\n                        End If\n                    Next Cell\n\n\n\n        Next FileInFolder\n    Next objSubFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 8359388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0502e7950f8d44974d31b3d9e2c42cc3?s=128&d=identicon&r=PG", "display_name": "ThatOneGuy", "link": "https://stackoverflow.com/users/8359388/thatoneguy"}, "reply_to_user": {"reputation": 37, "user_id": 7762906, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/853736d5fc12bbed91d6260cd367252c?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/7762906/king"}, "edited": false, "score": 0, "creation_date": 1501087313, "post_id": 45332834, "comment_id": 77627667, "body": "Awesome! For larger datasets, Value2 is faster.  Also, don&#39;t forget to accept my answer :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501087799, "post_id": 45332834, "comment_id": 77627962, "body": "I am curious if you actually tested <code>ActiveCell.Text = &quot;Total&quot;</code>? Because if you did, you would see right away that it fails because the <code>Text</code> property is read-only."}, {"owner": {"reputation": 88, "user_id": 8359388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0502e7950f8d44974d31b3d9e2c42cc3?s=128&d=identicon&r=PG", "display_name": "ThatOneGuy", "link": "https://stackoverflow.com/users/8359388/thatoneguy"}, "edited": false, "score": 0, "creation_date": 1501087988, "post_id": 45332834, "comment_id": 77628105, "body": "You are right in both that <code>.text</code> is read only and that I in fact did not test this (I am at work :(  )"}, {"owner": {"reputation": 37, "user_id": 7762906, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/853736d5fc12bbed91d6260cd367252c?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/7762906/king"}, "edited": false, "score": 0, "creation_date": 1501088669, "post_id": 45332834, "comment_id": 77628568, "body": "Yes <code>ActiveCell.Text = &quot;Total&quot;</code> didn&#39;t work but thankfully<code>ActiveCell.Value = &quot;Total&quot;</code>worked fine. Thanks again for prompt response:)"}], "tags": [], "owner": {"reputation": 88, "user_id": 8359388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0502e7950f8d44974d31b3d9e2c42cc3?s=128&d=identicon&r=PG", "display_name": "ThatOneGuy", "link": "https://stackoverflow.com/users/8359388/thatoneguy"}, "is_accepted": true, "score": 4, "last_activity_date": 1501088019, "last_edit_date": 1501088019, "creation_date": 1501087102, "answer_id": 45332834, "question_id": 45332799, "link": "https://stackoverflow.com/questions/45332799/insert-text-to-activecell-vba/45332834#45332834", "title": "Insert Text to Activecell VBA", "body": "<p>The method you are looking for is any of the following:</p>\n\n<p><code>ActiveCell.Value = \"Total\"\n ActiveCell.Value2 = \"Total\"</code></p>\n"}], "owner": {"reputation": 37, "user_id": 7762906, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/853736d5fc12bbed91d6260cd367252c?s=128&d=identicon&r=PG&f=1", "display_name": "King", "link": "https://stackoverflow.com/users/7762906/king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9467, "favorite_count": 0, "accepted_answer_id": 45332834, "answer_count": 1, "score": 1, "last_activity_date": 1501088019, "creation_date": 1501086985, "last_edit_date": 1531164843, "question_id": 45332799, "link": "https://stackoverflow.com/questions/45332799/insert-text-to-activecell-vba", "title": "Insert Text to Activecell VBA", "body": "<p>How do i insert a text named \"Total\" to a selected cell using VBA</p>\n\n<p>I used </p>\n\n<pre><code>Activecell.Name=\"Total\"\nSelection.Name=\"Total\"\n</code></pre>\n\n<p>But both of them is not working, is there any other way to do it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 1, "creation_date": 1501087650, "post_id": 45332768, "comment_id": 77627872, "body": "why you use there tag &#39;visio&#39; ?"}, {"owner": {"reputation": 10865, "user_id": 2933977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25308d33862d9b72e0b93160b1fd778c?s=128&d=identicon&r=PG", "display_name": "stdunbar", "link": "https://stackoverflow.com/users/2933977/stdunbar"}, "edited": false, "score": 0, "creation_date": 1501089271, "post_id": 45332768, "comment_id": 77628971, "body": "Can you show us what code you&#39;ve written to try to solve this?"}, {"owner": {"reputation": 11, "user_id": 8371365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d638df45e309a0881bfa123970bf75cb?s=128&d=identicon&r=PG&f=1", "display_name": "EMPI", "link": "https://stackoverflow.com/users/8371365/empi"}, "edited": false, "score": 0, "creation_date": 1501107873, "post_id": 45332768, "comment_id": 77638895, "body": "I would like to create a block diagram (&quot;Family tree&quot;) in Visio"}], "owner": {"reputation": 11, "user_id": 8371365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d638df45e309a0881bfa123970bf75cb?s=128&d=identicon&r=PG&f=1", "display_name": "EMPI", "link": "https://stackoverflow.com/users/8371365/empi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 850, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501107945, "creation_date": 1501086884, "last_edit_date": 1501107945, "question_id": 45332768, "link": "https://stackoverflow.com/questions/45332768/creating-a-product-tree-from-excel-bom", "title": "Creating a Product Tree from Excel BOM", "body": "<p>I have a standard Bill of Materials in Excel. The hierarchy is defined by the product level in column 1, column 2 and 3 are part number and product name respectively. </p>\n\n<p>Example:</p>\n\n<pre><code>+---+--------+--------------------+\n| 1 |   2    |         3          |\n+---+--------+--------------------+\n| 0 | 111111 | TOP LEVEL ASSEMBLY |\n|   |        |                    |\n| 1 | 123456 | ABC                |\n|   |        |                    |\n| 2 | 454444 | DEF                |\n|   |        |                    |\n| 2 | 533433 | GFG                |\n|   |        |                    |\n| 3 | 342333 | DFD                |\n|   |        |                    |\n| 3 | 234232 | FFD                |\n|   |        |                    |\n| 4 | 234343 | DSD                |\n|   |        |                    |\n| 3 | 322222 | DDS                |\n|   |        |                    |\n| 1 | 343433 | DFD                |\n+---+--------+--------------------+\n</code></pre>\n\n<p>If this was structured, it would look like this:</p>\n\n<pre><code>0 111111 TOP LEVEL ASSEMBLY\n      1 123456 ABC\n            2 454444 DEF\n            2 533433 GFG\n                 3 342333 DFD\n                 3 234232 FFD\n                       4 234343 DSD\n                 3 322222 DDS\n      1 343433 DFD\n</code></pre>\n\n<p>I am looking to have a macro create an actual family tree structure that would show the dependency of these items in Visio (with boxes and logical connections). So in this case, it would look something like this (except in block/arrow format).</p>\n\n<pre><code>                              **111111 TOP LEVEL ASSEMBLY**\n               123456 ABC                                     1 343433 DFD\n  454444 DEF         533433 GFG\n                  342333 DFD    234232 FFD         322222 DDS\n                                      234343 DSD\n</code></pre>\n\n<p>Any help will be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501087987, "post_id": 45332748, "comment_id": 77628104, "body": "Can you please clarify what this means: <code>set a range in the &quot;C&quot; column for 0 to MaxValue in increments of 0.1</code>? You want to define a range object in code? Or do you want to fill cells in increments of .1 until the max number? Or what?"}, {"owner": {"reputation": 23, "user_id": 8364663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c938275c69f7754840539a8d7e4319?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie", "link": "https://stackoverflow.com/users/8364663/kenzie"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501088022, "post_id": 45332748, "comment_id": 77628127, "body": "I want to fill the cells in increments of 0.1 to the max number."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8364663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c938275c69f7754840539a8d7e4319?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie", "link": "https://stackoverflow.com/users/8364663/kenzie"}, "edited": false, "score": 0, "creation_date": 1501093487, "post_id": 45333183, "comment_id": 77631516, "body": "I tried this code, and it only fills the cells to from 0.1 to 6.1, and I would like it to continue past 6.1 if the maximum of the &quot;R&quot; column is more than 6."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 23, "user_id": 8364663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c938275c69f7754840539a8d7e4319?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie", "link": "https://stackoverflow.com/users/8364663/kenzie"}, "edited": false, "score": 0, "creation_date": 1501094841, "post_id": 45333183, "comment_id": 77632226, "body": "this works for me. Although I did change <code>Loop Until dCounter = MaxValue</code> so it <i>stops</i> at max value. Ensure value in R is greater than 6 and it will produce max value. Otherwise, will be 6."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501094759, "last_edit_date": 1501094759, "creation_date": 1501088314, "answer_id": 45333183, "question_id": 45332748, "link": "https://stackoverflow.com/questions/45332748/finding-a-max-value-and-setting-the-range-equal-to-the-value/45333183#45333183", "title": "Finding a max value and setting the range equal to the value", "body": "<p>It's best to qualify your worksheet explicitly, but this will get a good start. See comments</p>\n\n<pre><code>Dim rng As Range\nSet rng = ws1.Range(\"R2:R6000\")\n\nDim MaxValue as Double\nMaxValue = Application.WorksheetFunction.Max(rng,6) 'this will force 6 or &gt;\n\nDim dCounter as Double\n\nDo \n\n    dCounter = dCounter + .1\n\n    'adjust this fill range to whatever you need        \n    Range(\"A\" &amp; Rows.Count).End(xlup).Offset(1).Value = dCounter\n\nLoop Until dCounter = MaxValue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": false, "score": 0, "last_activity_date": 1501089157, "creation_date": 1501089157, "answer_id": 45333439, "question_id": 45332748, "link": "https://stackoverflow.com/questions/45332748/finding-a-max-value-and-setting-the-range-equal-to-the-value/45333439#45333439", "title": "Finding a max value and setting the range equal to the value", "body": "<p>This code works for me:</p>\n\n<pre><code>Dim ws As Worksheet\nDim rng As Range\nDim MaxValue As Long\nDim NumberOfCells As Long\nDim i As Double\n\nFor Each ws In Worksheets\n    ws.Activate\n    Set rng = ws.Range(\"R2:R6000\")\n\n    MaxValue = Application.WorksheetFunction.Max(rng)\n\n    If Not MaxValue &gt; 6 Then\n        MaxValue = 6\n    End If\n\n    NumberOfCells = MaxValue / 0.1\n\n    Set rng = Nothing\n\n    i = 0\n    For Each rng In ws.Range(\"C1:C\" &amp; NumberOfCells + 1)\n        rng.Value = i\n        i = i + 0.1\n    Next rng\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8364663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c938275c69f7754840539a8d7e4319?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie", "link": "https://stackoverflow.com/users/8364663/kenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501094759, "creation_date": 1501086797, "last_edit_date": 1531164843, "question_id": 45332748, "link": "https://stackoverflow.com/questions/45332748/finding-a-max-value-and-setting-the-range-equal-to-the-value", "title": "Finding a max value and setting the range equal to the value", "body": "<p>I would like to find the max value in the \"R\" column of each of my worksheets.  If the MaxValue is greater than 6, I then was to set a range in the \"C\" column for 0 to MaxValue in increments of 0.1. If the MaxValue is less than 6 I want to set the range in the \"C\" column to 0 to 6 in 0.1 increments.</p>\n\n<pre><code>    Dim rng As Range\n    Set rng = ws1.Range(\"R2-R6000\")\n    MaxValue = Application.WorksheetFunction.Max(rng)\n    If MaxValue &gt; 6 Then\n    Lx = MaxValue\n    Else\n    Lx = 6\n    End If\n</code></pre>\n\n<p>I have attempted to set up the code, but I am very new to VBA so I am unsure of how to go about his task. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501099869, "post_id": 45332735, "comment_id": 77635027, "body": "Using the <code>.Clear</code> method of the <code>.Filters</code> property of a <code>FileDialog</code> object works, so all I can think is you didn&#39;t put the <code>With .Filters</code> within your <code>With yourObj3</code> block."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501100307, "post_id": 45336496, "comment_id": 77635262, "body": "P.S.  I suspect that the issue is really that the OP put the <code>With .Filters</code> outside the other <code>With</code> blocks, so VBA didn&#39;t know what the <code>.</code> in <code>.Filters</code> was referring to.  The code works whether it is a <code>Object</code> or a <code>FileDialog</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501100530, "post_id": 45336496, "comment_id": 77635394, "body": "I&#39;m <b>always</b> right!!  (Except when my wife says I&#39;m not.)"}, {"owner": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501104450, "post_id": 45336496, "comment_id": 77637469, "body": "Yes! Thank you VBobCat, worked wonderfully. @YowE3K you are correct, i put it under a different With block... doh!"}], "tags": [], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1501100082, "last_edit_date": 1501100082, "creation_date": 1501099836, "answer_id": 45336496, "question_id": 45332735, "link": "https://stackoverflow.com/questions/45332735/vba-excel-filedialog-to-set-reset-filters/45336496#45336496", "title": "VBA Excel FileDialog to set/reset filters", "body": "<p>This works in my environment. The only thing I made differently was to declare dialogs as <code>FileDialog</code> instead of <code>Object</code>.</p>\n\n<pre><code>Sub Test()\n    Dim myObj As FileDialog\n    Dim myDirString As String\n    Set myObj = Application.FileDialog(msoFileDialogFilePicker)\n    With myObj\n        .InitialFileName = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\"\n        .Filters.Clear\n        .Filters.Add \"Custom Excel Files\", \"*.xlsx, *.csv, *.xls\"\n        .FilterIndex = 1\n        .Show\n    End With\n    Dim yourObj3 As FileDialog\n    Dim yourDirString3 As String\n    Set yourObj3 = Application.FileDialog(msoFileDialogFilePicker)\n    With yourObj3\n        .InitialFileName = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\"\n        .Filters.Clear\n        .Filters.Add \"CSV Files\", \"*.csv\"\n        .FilterIndex = 1\n        .Show\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "is_accepted": false, "score": 1, "last_activity_date": 1565344357, "creation_date": 1565344357, "answer_id": 57427581, "question_id": 45332735, "link": "https://stackoverflow.com/questions/45332735/vba-excel-filedialog-to-set-reset-filters/57427581#57427581", "title": "VBA Excel FileDialog to set/reset filters", "body": "<p>Although it is not directly the answer to the specific <code>msoFileDialogFilePicker</code> from the OP (and googled this answer), I had the same problem with the <code>msoFileDialogSaveAs</code> dialog in Excel 2010 where errors are raised trying to modify the filters in any way because it <a href=\"https://analystcave.com/vba-application-filedialog-select-file/#crayon-5d3856b610c20541985699\" rel=\"nofollow noreferrer\">obviously is not supported</a> :-/</p>\n\n<blockquote>\n  <p>The <code>msoFileDialogSaveAs</code> dialog does NOT support file filters</p>\n</blockquote>\n"}], "owner": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19485, "favorite_count": 0, "accepted_answer_id": 45336496, "answer_count": 2, "score": 3, "last_activity_date": 1565344357, "creation_date": 1501086760, "last_edit_date": 1501099325, "question_id": 45332735, "link": "https://stackoverflow.com/questions/45332735/vba-excel-filedialog-to-set-reset-filters", "title": "VBA Excel FileDialog to set/reset filters", "body": "<p>I have a macro that asks a user to choose multiple files for data analysis. User selects a Excel or CSV file first (XLSX, XLS, CSV), then asks for a second file but CSV only. The intent of the tool is to combine the two data files into one.</p>\n\n<p>In one Sub, I ask the user to select any compatible XLSX, XLS, or CSV files using the FileDialog code:</p>\n\n<pre><code>Dim myObj As Object\nDim myDirString As String\nSet myObj = Application.FileDialog(msoFileDialogFilePicker)\nWith myObj\n    .InitialFileName = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\"\n    .Filters.Add \"Custom Excel Files\", \"*.xlsx, *.csv, *.xls\"\n    .FilterIndex = 1\n    If .Show = False Then MsgBox \"Please select Excel file.\", vbExclamation: Exit Sub\n    myDirString = .SelectedItems(1)\nEnd With\n</code></pre>\n\n<p>It seems to filter appropriately:</p>\n\n<p><a href=\"https://i.stack.imgur.com/whnIR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/whnIR.png\" alt=\"Custom Excel Files\"></a></p>\n\n<p>After this data analysis in complete, then the user runs a second sub to select another file, but it must be a CSV file only. So I use this code to request CSV:</p>\n\n<pre><code>Dim yourObj3 As Object\nDim yourDirString3 As String\nSet yourObj3 = Application.FileDialog(msoFileDialogFilePicker)\nWith yourObj3\n    .InitialFileName = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\"\n    .Filters.Add \"CSV Files\", \"*.csv\"\n    .FilterIndex = 1\n    If .Show = False Then MsgBox \"Please select CSV file.\", vbExclamation: Exit Sub\n    yourDirString3 = .SelectedItems(1)\nEnd With\n</code></pre>\n\n<p>The problem is the FileDialog box remembers the first filter (Custom XLS) and they need to click the drop down to see the appropriate filter for CSV only...</p>\n\n<p><a href=\"https://i.stack.imgur.com/S9Bw0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S9Bw0.png\" alt=\"Select CSV\"></a></p>\n\n<p>So this would certainly be confusing to the user...I'm guessing I need to \"clear\" our that first filter after the user completes the first macro. Any suggestions on that code to clear (or reset) the first filter?</p>\n\n<p>Tried adding this below it when I found what I thought was a similar question <a href=\"https://stackoverflow.com/questions/44270091/filedialog-persists-previous-filters\">FileDialog persists previous filters</a>:</p>\n\n<pre><code>With .Filters\n.Clear \nEnd With\n</code></pre>\n\n<p>But results in Compile error: Invalid or unqualified reference</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501086544, "post_id": 45332607, "comment_id": 77627200, "body": "how is the Data Validation List defined? Without seeing that it&#39;s hard to help here."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1501086556, "post_id": 45332607, "comment_id": 77627208, "body": "Did you edit the source range for the data validation?"}, {"owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "edited": false, "score": 0, "creation_date": 1501086971, "post_id": 45332607, "comment_id": 77627468, "body": "I have added an image of the data validation set up and my formula that generates the list."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501086987, "post_id": 45332607, "comment_id": 77627482, "body": "I suspect you are thinking that a value in drop down list will automatically change by itself. This will not happen even if the values in the list are dynamic. To change the value of a drop-down list, you have to manually go in and choose a new value. The only way to have it update &quot;automatically&quot; is through VBA code manipulation."}, {"owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "edited": false, "score": 0, "creation_date": 1501087066, "post_id": 45332607, "comment_id": 77627532, "body": "I assumed it would required VBA code and I am happy to use it but do not know how to go about it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1501087399, "post_id": 45332607, "comment_id": 77627728, "body": "@DanM - Looks like it is time to start looking into VBA tutorial."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 5484402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_K-nVZXaLVs/AAAAAAAAAAI/AAAAAAAAAJA/qCdlZNZAJRs/photo.jpg?sz=128", "display_name": "Arun Raj", "link": "https://stackoverflow.com/users/5484402/arun-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1501096822, "creation_date": 1501096822, "answer_id": 45335718, "question_id": 45332607, "link": "https://stackoverflow.com/questions/45332607/data-validation-drop-down-list-not-auto-updating/45335718#45335718", "title": "Data Validation drop down list not auto-updating", "body": "<p>Write an vba code in the background which will update the list whenever the work book is opening.\nStep 1: Write an vba code which adds data validation filer to the column based on the number of rows in parts list.\nStep 2: use workbook_open fn to run the macro whenever work book is opened</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1501148802, "creation_date": 1501148802, "answer_id": 45347099, "question_id": 45332607, "link": "https://stackoverflow.com/questions/45332607/data-validation-drop-down-list-not-auto-updating/45347099#45347099", "title": "Data Validation drop down list not auto-updating", "body": "<p>I managed to solve the problem.</p>\n\n<p>I found some VBA code online and made alterations where necessary. See code below with explanations including</p>\n\n<pre><code> Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n' Ensure all lists are made from tables and that these tables are named\n' in the Name Manager.\n' When creating your Data Validation List, instead of selecting a range\n' in 'Source', click within 'Source' and press 'F3'. Finally select your\n' tables name.\nDim strValidationList As String\nDim strVal As String\nDim lngNum As Long\n\nOn Error GoTo Nevermind\nstrValidationList = Mid(Target.Validation.Formula1, 2)\nstrVal = Target.Value\nlngNum = Application.WorksheetFunction.Match(strVal, ThisWorkbook.Names(strValidationList).RefersToRange, 0)\n\n' Converts table contents into a formula\nIf strVal &lt;&gt; \"\" And lngNum &gt; 0 Then\n    Application.EnableEvents = False\n    Target.Formula = \"=INDEX(\" &amp; strValidationList &amp; \", \" &amp; lngNum &amp; \")\"\nEnd If\n\nNevermind:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1072, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501148802, "creation_date": 1501086335, "last_edit_date": 1501086697, "question_id": 45332607, "link": "https://stackoverflow.com/questions/45332607/data-validation-drop-down-list-not-auto-updating", "title": "Data Validation drop down list not auto-updating", "body": "<p>I have a simple column of data on a WorkSheet (PartsList) which filters data from the its respective rows. On another WorkSheet (BoM) within the same WorkBook I am reference this column via a Data Validation 'List'. </p>\n\n<p>The issue that I am having is that when the data within the 'PartsList' WorkSheet is updated the information shown in the drop down list remains the same.</p>\n\n<p>As you can see in the image below, the drop down list hasn't updated the 'part#' although the 'Part Number' and 'Variant' column has.\n<a href=\"https://i.stack.imgur.com/26Ayv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/26Ayv.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/y8ykN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y8ykN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And here is the formula that generates the list:\n<a href=\"https://i.stack.imgur.com/8ESVX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8ESVX.jpg\" alt=\"enter image description here\"></a>\nIs there anyway of making the drop down list auto-update?</p>\n"}, {"tags": ["vba", "ms-access", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 332071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/df2aec2319fca35947746d12f80dff2d?s=128&d=identicon&r=PG", "display_name": "starskythehutch", "link": "https://stackoverflow.com/users/332071/starskythehutch"}, "edited": false, "score": 1, "creation_date": 1501663106, "post_id": 45332789, "comment_id": 77871808, "body": "I also had to add it in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Office\\Common without the version number."}, {"owner": {"reputation": 10379, "user_id": 263832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2096b47631d1c0690f7a149de682b19b?s=128&d=identicon&r=PG", "display_name": "xr280xr", "link": "https://stackoverflow.com/users/263832/xr280xr"}, "edited": false, "score": 0, "creation_date": 1527082485, "post_id": 45332789, "comment_id": 87992491, "body": "What&#39;s the point of <code>retValue = CoCreateGuid(guid)</code> if <code>retValue</code> is never returned or used other than the condition right below it?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 10379, "user_id": 263832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2096b47631d1c0690f7a149de682b19b?s=128&d=identicon&r=PG", "display_name": "xr280xr", "link": "https://stackoverflow.com/users/263832/xr280xr"}, "edited": false, "score": 0, "creation_date": 1527085184, "post_id": 45332789, "comment_id": 87994367, "body": "@xr280xr seems like a question for Microsoft, but I think the answer is &quot;the point of that variable is that it&#39;s used in the condition right below it&quot;. I&#39;ll agree the naming convention is a bit odd, but apart from that what reason would you expect it to be returned? And where else it would possibly be used, if not after its assignment, which is literally the last block of code in the function?"}, {"owner": {"reputation": 10379, "user_id": 263832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2096b47631d1c0690f7a149de682b19b?s=128&d=identicon&r=PG", "display_name": "xr280xr", "link": "https://stackoverflow.com/users/263832/xr280xr"}, "edited": false, "score": 1, "creation_date": 1527087100, "post_id": 45332789, "comment_id": 87995800, "body": "I was wrongly thinking the return value of <code>CoCreateGuid</code> was the created GUID. I thought returning 0 instead of a GUID might be a backwards/version compatibility thing. Read it in that context and you&#39;ll probably understand what I meant. What I missed is that <code>CoCreateGuid</code> is passed a pointer <code>guid</code> which gets set to the created GUID and that&#39;s used inside the conditional block. 0 is <code>S_OK</code> indicating the GUID was successfully created. Thanks for sharing this solution."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 10379, "user_id": 263832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2096b47631d1c0690f7a149de682b19b?s=128&d=identicon&r=PG", "display_name": "xr280xr", "link": "https://stackoverflow.com/users/263832/xr280xr"}, "edited": false, "score": 0, "creation_date": 1527087314, "post_id": 45332789, "comment_id": 87995966, "body": "Cheers @xr280xr based on what I&#39;d consider (somewhat) normal naming conventions, that&#39;s the same assumption I made and I had to step through it to see what&#39;s actually happening as well :)."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 19, "last_activity_date": 1516767609, "last_edit_date": 1516767609, "creation_date": 1501086953, "answer_id": 45332789, "question_id": 45332357, "link": "https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied/45332789#45332789", "title": "MS Access VBA Error: Run time error &#39;70&#39; Permission Denied", "body": "<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_win10/guid-run-time-error-70-permission-denied/c9ee4076-98af-4032-bc87-40ad7aa7cb38\" rel=\"noreferrer\">From Microsoft</a>:</p>\n\n<blockquote>\n  <p>This issue is by design, as of the July security updates. This control is blocked as a security measure to help prevent malicious code from running in Office applications. We are working on getting a knowledgebase article out with the recommended method. Until that KB is ready, I'll post the content here:</p>\n  \n  <p><strong>Workaround</strong>\n  The preferred method is to change the code to use Windows API CoCreateGuid (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms688568(v=vs.85).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms688568(v=vs.85).aspx</a>) instead of <code>CreateObject(\"Scriptlet.TypeLib\").Guid</code></p>\n</blockquote>\n\n<pre><code>' No VT_GUID available so must declare type GUID\nPrivate Type GUID_TYPE\n    Data1 As Long\n    Data2 As Integer\n    Data3 As Integer\n    Data4(7) As Byte\nEnd Type\nPrivate Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (Guid As GUID_TYPE) As LongPtr\nPrivate Declare PtrSafe Function StringFromGUID2 Lib \"ole32.dll\" (Guid As GUID_TYPE, ByVal lpStrGuid As LongPtr, ByVal cbMax As Long) As LongPtr\nFunction CreateGuidString()\n    Dim guid As GUID_TYPE\n    Dim strGuid As String\n    Dim retValue As LongPtr\n    Const guidLength As Long = 39 'registry GUID format with null terminator {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\n\n    retValue = CoCreateGuid(guid)\n    If retValue = 0 Then\n        strGuid = String$(guidLength, vbNullChar)\n        retValue = StringFromGUID2(guid, StrPtr(strGuid), guidLength)\n        If retValue = guidLength Then\n            ' valid GUID as a string\n            CreateGuidString = strGuid\n        End If\n    End if\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p><strong>Alternate Workaround</strong></p>\n  \n  <p>This will allow you to use <code>CreateObject(\"Scriptlet.TypeLib\")</code>however it will lessen the security protection added by the Office July 2017 security update.\n  You can set a registry key that will allow <code>Scriptlet.TypeLib</code> to instantiate inside of Office applications. When this registry key is set, Office will not block any use of this COM control.</p>\n  \n  <ul>\n  <li>Open Registry Editor.</li>\n  <li>Go to: Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\COM Compatibility{06290BD5-48AA-11D2-8432-006008C3FBFC}\n  \n  <ul>\n  <li>Note: you may need to search the registry to find the correct location under HKEY_LOCAL_MACHINE based on your installed Office version.</li>\n  </ul></li>\n  <li>Add ActivationFilterOverride</li>\n  <li>Set DWORD: 1</li>\n  </ul>\n  \n  <p><strong>Detailed Instructions:</strong></p>\n  \n  <ol>\n  <li>Click Start, click Run, type regedit in the Open box, and then click OK.\n  Locate and then click the following key in the registry:\n  HKEY_LOCAL_MACHINE</li>\n  <li>On the Edit menu, point to Find, and then enter the following in the Find What: text box:\n  COM Compatibility</li>\n  <li>Ensure Keys is selected, and Values and Data are deselected. Next select Match whole string only, click Find Next\n  Locate and then click the following key:\n  {06290BD5-48AA-11D2-8432-006008C3FBFC} Note: if the key is not present you will need to add it. On the Edit menu, point to New, and then click Key. Type in {06290BD5-48AA-11D2-8432-006008C3FBFC}</li>\n  <li>On the Edit menu, point to New, and then click DWORD (32-bit) Value</li>\n  <li>Type ActivationFilterOverride for the name of the DWORD, and then press Enter.</li>\n  <li>Right-click ActivationFilterOverride, and then click Modify.</li>\n  <li>In the Value data box, type 1 to enable the registry entry, and then click OK.</li>\n  <li>Note to disable the ActivationFilterOverride setting, type 0 (zero), and then click OK.</li>\n  <li>Exit Registry Editor, and then restart any open Office application.</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1571, "user_id": 3056160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rArx6.jpg?s=128&g=1", "display_name": "rchacko", "link": "https://stackoverflow.com/users/3056160/rchacko"}, "is_accepted": false, "score": 1, "last_activity_date": 1516849019, "creation_date": 1516849019, "answer_id": 48434913, "question_id": 45332357, "link": "https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied/48434913#48434913", "title": "MS Access VBA Error: Run time error &#39;70&#39; Permission Denied", "body": "<p>Since windows update taken out \"Scriptlet.TypeLib\", try the following:-</p>\n\n<pre><code>Declare Function CoCreateGuid Lib \"ole32\" (ByRef GUID As Byte) As Long\nPublic Function GenerateGUID() As String\n    Dim ID(0 To 15) As Byte\n    Dim N As Long\n    Dim GUID As String\n    Dim Res As Long\n    Res = CoCreateGuid(ID(0))\n\n    For N = 0 To 15\n        GUID = GUID &amp; IIf(ID(N) &lt; 16, \"0\", \"\") &amp; Hex$(ID(N))\n        If Len(GUID) = 8 Or Len(GUID) = 13 Or Len(GUID) = 18 Or Len(GUID) = 23 Then\n            GUID = GUID &amp; \"-\"\n        End If\n    Next N\n    GenerateGUID = GUID\nEnd Function\n</code></pre>\n\n<p>Alternatively,\nif you are connecting to SQL Server 2008 or higher, try to use the SQL NEWID() function instead.</p>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 3, "last_activity_date": 1539779323, "last_edit_date": 1539779323, "creation_date": 1539777755, "answer_id": 52854439, "question_id": 45332357, "link": "https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied/52854439#52854439", "title": "MS Access VBA Error: Run time error &#39;70&#39; Permission Denied", "body": "<p>In Access, we can suffice with this very short function to generate a GUID by leveraging <code>Application.StringFromGUID</code> to cast bytes to a GUID. It generates pretty verbose GUIDs, though, with the format <code>{guid {00000000-0000-0000-0000-000000000000}}</code>. </p>\n\n<pre><code>Declare PtrSafe Sub CoCreateGuid Lib \"ole32\" (ByVal GUID As LongPtr)\nPublic Function NewGUID() As String\n    Dim b(15) As Byte\n    CoCreateGUID VarPtr(b(0))\n    NewGUID = Application.StringFromGUID(b)\nEnd Function\n</code></pre>\n\n<p>You can strip away unwanted characters, for example by replacing the last line of this function with <code>NewGUID = Mid(Application.StringFromGUID(b), 8, 36)</code>. Then, the format will be <code>00000000-0000-0000-0000-000000000000</code></p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 10186832, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EjE4fYq6KIY/AAAAAAAAAAI/AAAAAAAAAe8/VYsbXTZyuU0/photo.jpg?sz=128", "display_name": "user10186832", "link": "https://stackoverflow.com/users/10186832/user10186832"}, "is_accepted": false, "score": 0, "last_activity_date": 1614198119, "creation_date": 1614198119, "answer_id": 66358299, "question_id": 45332357, "link": "https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied/66358299#66358299", "title": "MS Access VBA Error: Run time error &#39;70&#39; Permission Denied", "body": "<p>The accepted answer here does not work for me.</p>\n<p>However, the comment by Alex Bloom in another answer referencing C Pearsons answer works fine for Windows 10 and Microsoft 365</p>\n<p><a href=\"https://stackoverflow.com/questions/45082258/vba-set-typelib-createobjectscriptlet-typelib-permission-denied\">this answer</a></p>\n"}], "owner": {"reputation": 3437, "user_id": 240385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZEcfq.jpg?s=128&g=1", "display_name": "jason", "link": "https://stackoverflow.com/users/240385/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13531, "favorite_count": 6, "accepted_answer_id": 45332789, "answer_count": 4, "score": 9, "last_activity_date": 1614198119, "creation_date": 1501085628, "question_id": 45332357, "link": "https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied", "title": "MS Access VBA Error: Run time error &#39;70&#39; Permission Denied", "body": "<p>I believe this issue is a result of a recent update to MS Office/Access or Windows 10.  When I run this code:</p>\n\n<pre><code>Dim s As String\nWith CreateObject(\"Scriptlet.TypeLib\")\n    s = Left(.Guid, 9)\n   newguidx = Right(s, 8)\nEnd With\n</code></pre>\n\n<p>I get an error:  Permission Denied on the With Statement.  This is new only only cropped up after my admins updated our systems.  I have no option to roll back updates.  Anyone come across this and have a work around?</p>\n\n<p>OS:  Windows 7 Enterprise\nAccess Version: 2010</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7062450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/894bf4b66f7ec48723d0e2107db10652?s=128&d=identicon&r=PG&f=1", "display_name": "user7062450", "link": "https://stackoverflow.com/users/7062450/user7062450"}, "edited": false, "score": 0, "creation_date": 1501086254, "post_id": 45332436, "comment_id": 77627001, "body": "These are two different excel files. I&#39;m trying to copy the values from the &quot;Schedule.xls&quot; QF.IPP tab and paste them into &quot;ID_DOG.xls&quot;"}], "tags": [], "owner": {"reputation": 88, "user_id": 8359388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0502e7950f8d44974d31b3d9e2c42cc3?s=128&d=identicon&r=PG", "display_name": "ThatOneGuy", "link": "https://stackoverflow.com/users/8359388/thatoneguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501086745, "last_edit_date": 1501086745, "creation_date": 1501085816, "answer_id": 45332436, "question_id": 45332197, "link": "https://stackoverflow.com/questions/45332197/how-to-select-ranges-from-multiple-rows/45332436#45332436", "title": "How to select ranges from multiple rows", "body": "<p>There is no need to select, copy, and paste: you can change the values of cells directly.</p>\n\n<p><code>Workbooks(\"ID_DOG\").Sheets(\"QF.IPP\").Range(\"B47:G48\").value2 = Workbooks(\"Schedule\")Sheets(\"QF.IPP\").Range(\"E10:K10\").Value2</code></p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1501086226, "creation_date": 1501086226, "answer_id": 45332573, "question_id": 45332197, "link": "https://stackoverflow.com/questions/45332197/how-to-select-ranges-from-multiple-rows/45332573#45332573", "title": "How to select ranges from multiple rows", "body": "<p>You <em>can</em> paste a row into mutliple rows provided the same number of columns is preserved (that's why below I paste into columns \"B:H\" instead of \"B:G\"):</p>\n\n<pre><code>Workbooks(\"Schedule.xlsx\").Sheets(\"QF.IPP\").Range(\"E10:K10\").Copy\nWorkbooks(\"ID_DOG.xlsm\").ActiveSheet.Range(\"B47:H48\").PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7062450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/894bf4b66f7ec48723d0e2107db10652?s=128&d=identicon&r=PG&f=1", "display_name": "user7062450", "link": "https://stackoverflow.com/users/7062450/user7062450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 45332573, "answer_count": 2, "score": 0, "last_activity_date": 1501086745, "creation_date": 1501085224, "last_edit_date": 1531161705, "question_id": 45332197, "link": "https://stackoverflow.com/questions/45332197/how-to-select-ranges-from-multiple-rows", "title": "How to select ranges from multiple rows", "body": "<p>I want to copy the same thing into different rows in Excel. How can I simplify the code below so I can select multiple ranges?</p>\n\n<pre><code>Windows(\"Schedule.xlsx\").Activate\nSheets(\"QF.IPP\").Select\nRange(\"E10:K10\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"ID_DOG.xlsm\").Activate\nRange(\"B47:G47\").Select\nActiveSheet.Paste\n\nWindows(\"Schedule.xlsx\").Activate\nSheets(\"QF.IPP\").Select\nRange(\"E10:K10\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"ID_DOG.xlsm\").Activate\nRange(\"B48:G48\").Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501084281, "post_id": 45331486, "comment_id": 77625506, "body": "<a href=\"https://stackoverflow.com/questions/11254401/vba-how-to-test-for-object-equality-whether-two-variables-reference-the-same-o/11254505\" title=\"vba how to test for object equality whether two variables reference the same o\">stackoverflow.com/questions/11254401/&hellip;</a>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1501085376, "post_id": 45331486, "comment_id": 77626347, "body": "Yes they should be the same. Did you encounter cases where they&#39;re not?"}, {"owner": {"reputation": 4871, "user_id": 3474089, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9KTt4.png?s=128&g=1", "display_name": "abagshaw", "link": "https://stackoverflow.com/users/3474089/abagshaw"}, "edited": false, "score": 0, "creation_date": 1501089957, "post_id": 45331486, "comment_id": 77629413, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11254401/vba-how-to-test-for-object-equality-whether-two-variables-reference-the-same-o\">VBA: how to test for object equality (whether two variables reference the same object)</a>"}], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501102596, "creation_date": 1501083254, "last_edit_date": 1501102596, "question_id": 45331486, "link": "https://stackoverflow.com/questions/45331486/using-the-is-operator-vs-comparing-objptr-values", "title": "Using the &quot;Is&quot; operator vs. comparing ObjPtr values", "body": "<p>In VBA, is comparing two objects with the <code>Is</code> operator the same as comparing their <code>ObjPtr</code> values?</p>\n\n<p>That is, is this</p>\n\n<pre><code>obj1 Is obj2\n</code></pre>\n\n<p>... the same as this?</p>\n\n<pre><code>ObjPtr(obj1) = ObjPtr(obj2)\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8370750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b69e6c2dfec2e579fe9d77a01bb4d09?s=128&d=identicon&r=PG&f=1", "display_name": "James Bradfield", "link": "https://stackoverflow.com/users/8370750/james-bradfield"}, "edited": false, "score": 0, "creation_date": 1501489135, "post_id": 45331501, "comment_id": 77781593, "body": "nothing happens when it runs and no errors pop up after. I have tried to debug it but it just runs through the code. so cant work out what I have done wrong. Due to inexperience with coding I dont really know where to start"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 1, "user_id": 8370750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b69e6c2dfec2e579fe9d77a01bb4d09?s=128&d=identicon&r=PG&f=1", "display_name": "James Bradfield", "link": "https://stackoverflow.com/users/8370750/james-bradfield"}, "edited": false, "score": 0, "creation_date": 1502025498, "post_id": 45331501, "comment_id": 78024767, "body": "Well, set a breakpoint somewhere after start (F9). When hit, step through the code with F8."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 0, "last_activity_date": 1501083287, "creation_date": 1501083287, "answer_id": 45331501, "question_id": 45331101, "link": "https://stackoverflow.com/questions/45331101/booking-appointments-in-a-public-calendar-in-outlook-using-vba-excel/45331501#45331501", "title": "Booking Appointments in A Public Calendar in outlook Using VBA/Excel", "body": "<p>What is the error code or error message?\nAre you using <em>On Error Resume Next</em> to hide error messages? Do not!</p>\n"}], "owner": {"reputation": 1, "user_id": 8370750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b69e6c2dfec2e579fe9d77a01bb4d09?s=128&d=identicon&r=PG&f=1", "display_name": "James Bradfield", "link": "https://stackoverflow.com/users/8370750/james-bradfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501083287, "creation_date": 1501082225, "question_id": 45331101, "link": "https://stackoverflow.com/questions/45331101/booking-appointments-in-a-public-calendar-in-outlook-using-vba-excel", "title": "Booking Appointments in A Public Calendar in outlook Using VBA/Excel", "body": "<p>I was just wondering if anyone can help me. I am very new to coding and am trying to create a macro that books full day events in a shared outlook calendar. I have searched the depths of the internet and cant seem to find anything. </p>\n\n<p>I am trying to use the below code which picks up the from and to date in a range on the work book and book into the following shared calendar \"\\UK Public Folders\\Customer Services\\UK Customer Services Calendar\" in outlook but I am just not having any luck defining the folder path. can anyone help?</p>\n\n<pre><code>Option Explicit\n\nSub CreateOutlookAppointment()\n\nDim strCategory As String, strTopic As String, strLocation As String, strStartdate As String, strStarttime As String\nDim strEnddate As String, strEndtime As String, strDuration As String, bolWholeday As Boolean, bolReminder As Boolean, lngReminderMinutes As Long\nDim bolPlaysound As Boolean, strParticipants As String, bolRespondNecessary As Boolean, strNote As String\n\n\nDim strCategory As String, strTopic As String, strLocation As String, strStartdate As String, strStarttime As String\nDim strEnddate As String, strEndtime As String, strDuration As String, bolWholeday As Boolean, bolReminder As Boolean, lngReminderMinutes As Long\nDim bolPlaysound As Boolean, strParticipants As String, bolRespondNecessary As Boolean, strNote As String\n\nDim olApp As Object\nDim objCal As Object\nDim olCal As Object\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet objCal = olApp.Session.GetDefaultFolder(9)\nSet olCal = objCal.Items.Add(1)\n\n\n\n'=============================================================\n'Entries for appointment\n'=============================================================\nstrCategory = \"Holiday\"\nstrTopic = Range(\"Employee3\")\nstrLocation = \"\"\nstrStartdate = Range(\"FROM1\")\nstrStarttime = \"09:00\"\nstrEnddate = Range(\"FROM2\")\nstrEndtime = \"09:00\"\nstrDuration = \"60\"    'If duration of appointment necessary, remove comment for \"Duration\" below\nbolWholeday = True\nbolReminder = True\nlngReminderMinutes = 10\nbolPlaysound = True\nstrParticipants = Range(\"A8\").Value\nbolRespondNecessary = False\nstrNote = \"Your On Holiday\"\n'=============================================================\n\n'Create appointment\nWith olCal\n    .Categories = strCategory\n    .Subject = strTopic\n    .Location = strLocation\n    .Start = strStartdate &amp; \" \" &amp; strStarttime\n    .End = strEnddate &amp; \" \" &amp; strEndtime\n    '.Duration = strDuration   'If duration is given about, remove comment\n    .AllDayEvent = bolWholeday\n    .ReminderSet = bolReminder\n    .ReminderMinutesBeforeStart = lngReminderMinutes\n    .ReminderPlaySound = bolPlaysound\n    .Recipients.Add strParticipants\n    .ResponseRequested = bolRespondNecessary\n    .Body = strNote\n    .Display\nEnd With\n\nOn Error Resume Next\nSet olCal = Nothing\nSet olApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>any help would be greatly appreciated </p>\n\n<p>many thanks </p>\n\n<p>Jamie </p>\n"}, {"tags": ["vba", "ms-word", "comments", "selection", "clipboard"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8370792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f297af43dba84b9513a0c0a0ac903d?s=128&d=identicon&r=PG&f=1", "display_name": "Question", "link": "https://stackoverflow.com/users/8370792/question"}, "edited": false, "score": 0, "creation_date": 1501145875, "post_id": 45331753, "comment_id": 77653025, "body": "Thank you very much. I&#39;m using a different macro key. Thank you agan! Unfortunately, I can&#39;t vote for now (15 reps issue)."}, {"owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "reply_to_user": {"reputation": 3, "user_id": 8370792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f297af43dba84b9513a0c0a0ac903d?s=128&d=identicon&r=PG&f=1", "display_name": "Question", "link": "https://stackoverflow.com/users/8370792/question"}, "edited": false, "score": 0, "creation_date": 1501178701, "post_id": 45331753, "comment_id": 77677514, "body": "If my answer resolved your question, please <a href=\"https://stackoverflow.com/help/someone-answers\">accept</a> it."}], "tags": [], "owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "is_accepted": true, "score": 0, "last_activity_date": 1501083954, "creation_date": 1501083954, "answer_id": 45331753, "question_id": 45330769, "link": "https://stackoverflow.com/questions/45330769/how-is-it-possible-to-add-comment-via-macros-for-selected-region-of-words/45331753#45331753", "title": "How is it possible to add comment via macros for selected region of words?", "body": "<p>If you remove <code>Selection.Collapse</code>, the comment will apply to the entire selection.</p>\n\n<p>Suggested new subprocedure:</p>\n\n<pre><code>Sub Gray()\n\nSelection.Range.HighlightColorIndex = wdGray25\nSelection.Comments.Add _\nRange:=Selection.Range, Text:=\" review this\"\n\nEnd Sub\n</code></pre>\n\n<p>Text from the clipboard can be pulled in by calling a Windows API function. See <a href=\"https://stackoverflow.com/questions/5552299/how-to-copy-to-clipboard-using-access-vba\">this previous question</a> for more details.</p>\n\n<p>I recommend using a different shortcut than <kbd>Ctrl</kbd> + <kbd>V</kbd> to trigger your macro.</p>\n"}], "owner": {"reputation": 3, "user_id": 8370792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f297af43dba84b9513a0c0a0ac903d?s=128&d=identicon&r=PG&f=1", "display_name": "Question", "link": "https://stackoverflow.com/users/8370792/question"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 45331753, "answer_count": 1, "score": 0, "last_activity_date": 1501099206, "creation_date": 1501081366, "last_edit_date": 1501099206, "question_id": 45330769, "link": "https://stackoverflow.com/questions/45330769/how-is-it-possible-to-add-comment-via-macros-for-selected-region-of-words", "title": "How is it possible to add comment via macros for selected region of words?", "body": "<p>I'm trying to make a piece of code for adding a comment via a shortcut.</p>\n\n<p>I found a macro, but when I run the macro it all seems ok (accurate background highlighting with gray) except that the comment is added only to the last word in the selected group.</p>\n\n<p>Is it possible to have a comment not only for last word in a sentence but for entire selected group of words?</p>\n\n<p>P.S. Is it also possible to take text from clipboard and paste it directly without having to paste it manually (making cursor flashing in commentary, then ctrl+V)? Instead of <strong>review this</strong> value from a code.</p>\n\n<p>Thank you very much for any help.</p>\n\n<pre><code>Sub Gray()\n'\n' Gray\n'\n'\nOptions.DefaultHighlightColorIndex = wdGray25\nSelection.Range.HighlightColorIndex = wdGray25\nSelection.Collapse Direction:=wdCollapseEnd\nActiveDocument.Comments.Add _\nRange:=Selection.Range, Text:=\" review this\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "vba"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8342310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005f814bbc3e3abd0025c5e6d97ced88?s=128&d=identicon&r=PG&f=1", "display_name": "MrDoe", "link": "https://stackoverflow.com/users/8342310/mrdoe"}, "edited": false, "score": 1, "creation_date": 1501083447, "post_id": 45330799, "comment_id": 77624902, "body": "Thank you! This worked. I most likely will add in Compare Text to ensure it captures everything but this fixed my problem."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1501081451, "creation_date": 1501081451, "answer_id": 45330799, "question_id": 45330479, "link": "https://stackoverflow.com/questions/45330479/excel-vba-how-to-clear-all-contents-of-multiple-worksheets-using-a-lcase-iden/45330799#45330799", "title": "Excel VBA: How to clear all contents of multiple worksheets Using a `LCASE` Identifier", "body": "<blockquote>\n<pre><code>If LCase(Left(DemandData.Name, 6)) = \"Demand\" Then\n</code></pre>\n</blockquote>\n\n<p>The above statement will not match any worksheet, because the LHS is all lowercase and the RHS has an uppercase <code>D</code>. Replace <code>Demand</code> with lowercase <code>demand</code>.</p>\n\n<pre><code>If LCase(Left(DemandData.Name, 6)) = \"demand\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 8342310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005f814bbc3e3abd0025c5e6d97ced88?s=128&d=identicon&r=PG&f=1", "display_name": "MrDoe", "link": "https://stackoverflow.com/users/8342310/mrdoe"}, "edited": false, "score": 1, "creation_date": 1501083540, "post_id": 45331184, "comment_id": 77624976, "body": "Hi Vityata, Thank you I should have added this anyway. Thanks for the helpful response."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1501083739, "last_edit_date": 1501083739, "creation_date": 1501082437, "answer_id": 45331184, "question_id": 45330479, "link": "https://stackoverflow.com/questions/45330479/excel-vba-how-to-clear-all-contents-of-multiple-worksheets-using-a-lcase-iden/45331184#45331184", "title": "Excel VBA: How to clear all contents of multiple worksheets Using a `LCASE` Identifier", "body": "<p>These are 3 basic functions for edition of strings:</p>\n\n<p><code>LCase</code>, <code>UCase</code>, and <code>WorksheetFunction.Proper</code></p>\n\n<p>This is what they would return:</p>\n\n<pre><code>Demand Is Diamand\ndemand is diamand\nDEMAND IS DIAMAND\n</code></pre>\n\n<p>if you run them like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim strText As String\n\n    strText = \"demaNd is dIamand\"\n\n    Debug.Print WorksheetFunction.Proper(strText)\n    Debug.Print LCase(strText)\n    Debug.Print UCase(strText)\n\nEnd Sub\n</code></pre>\n\n<p>In order to compare the result of the functions, you should be comparing with similar string. Probably the most sure thing is to put the same string functions on both parts of the comparison. Like this:</p>\n\n<pre><code>LCase(Left(DemandData.name, 6)) = LCase(\"demand\") Then\n</code></pre>\n\n<hr>\n\n<p>In general, if you want to make sure that <code>Vit=VIT</code> then consider adding <code>Option Compare Text</code> on top of the module. Then this would be true:</p>\n\n<pre><code>Option Compare Text\nSub TestMe()\n    Debug.Print \"Vit\" = \"VIT\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8342310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005f814bbc3e3abd0025c5e6d97ced88?s=128&d=identicon&r=PG&f=1", "display_name": "MrDoe", "link": "https://stackoverflow.com/users/8342310/mrdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 45330799, "answer_count": 2, "score": 2, "last_activity_date": 1501083739, "creation_date": 1501080657, "last_edit_date": 1531164843, "question_id": 45330479, "link": "https://stackoverflow.com/questions/45330479/excel-vba-how-to-clear-all-contents-of-multiple-worksheets-using-a-lcase-iden", "title": "Excel VBA: How to clear all contents of multiple worksheets Using a `LCASE` Identifier", "body": "<p>Here is the vba I currently have. I am needing it to delete all data in any worksheet that starts with \"Demand\". The code is running but no data is being deleted. Any help is appreciated!! </p>\n\n<pre><code>Option Explicit\nSub ClearExcelContent()\n  Dim DemandData As Worksheet\n  For Each DemandData In ActiveWorkbook.Worksheets\n    If LCase(Left(DemandData.Name, 6)) = \"Demand\" Then\n      DemandData.Rows(\"2:\" &amp; Rows.Count).ClearContents\n    End If\n  Next DemandData\n  MsgBox \"All Demand Data has been Deleted from Consolidation Tab\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1501080762, "post_id": 45330467, "comment_id": 77622627, "body": "Then why not <code>For i = 1 To LR</code>? also where are you pasting after <code>.Copy</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1501081236, "post_id": 45330467, "comment_id": 77623054, "body": "Probably could use the <code>Range.Find</code> instead of brute force iteration..."}, {"owner": {"reputation": 13, "user_id": 8370024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16e7e324879fed01ea2d0224e38e11b?s=128&d=identicon&r=PG&f=1", "display_name": "genelec", "link": "https://stackoverflow.com/users/8370024/genelec"}, "edited": false, "score": 0, "creation_date": 1501083248, "post_id": 45330467, "comment_id": 77624737, "body": "The program is a little unique. The values in column C represent an ordered list of employees that have to be assigned work in the specific order from top to bottom with one work item at a time. The FALSE values represent employees who are present for work and TRUE represents employees who are absent. I want the code to look for the next FALSE on the list in sequence (next available employee). In my final worksheet, there will be 10 command buttons. The first will use For i = 2 to LR, the second will use For i = 3 to LR and so on until the last button where I will use For i = 1 to LR."}, {"owner": {"reputation": 13, "user_id": 8370024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16e7e324879fed01ea2d0224e38e11b?s=128&d=identicon&r=PG&f=1", "display_name": "genelec", "link": "https://stackoverflow.com/users/8370024/genelec"}, "edited": false, "score": 0, "creation_date": 1501083299, "post_id": 45330467, "comment_id": 77624773, "body": "The data that gets copied will be pasted into a different program outside of Excel."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8370024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16e7e324879fed01ea2d0224e38e11b?s=128&d=identicon&r=PG&f=1", "display_name": "genelec", "link": "https://stackoverflow.com/users/8370024/genelec"}, "edited": false, "score": 0, "creation_date": 1501091139, "post_id": 45331201, "comment_id": 77630147, "body": "That did it! Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1501082476, "creation_date": 1501082476, "answer_id": 45331201, "question_id": 45330467, "link": "https://stackoverflow.com/questions/45330467/for-loop-return-to-top-of-column/45331201#45331201", "title": "For Loop Return to Top of Column", "body": "<p>Declare some boolean variable: <code>Dim isFound As Boolean</code>, set it to false: <code>isFound = False</code>, if match is found, then set it to true: <code>isFound = True</code> (right after copying value). After <code>For</code> loop check if match was found <code>If isFound Then...</code> and check the remaining 5 cells: from <code>I1</code> to <code>I5</code> (because in preceding loop we checked the rest) or you can just add another loop which will go throguh <code>I</code> column.</p>\n"}], "owner": {"reputation": 13, "user_id": 8370024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16e7e324879fed01ea2d0224e38e11b?s=128&d=identicon&r=PG&f=1", "display_name": "genelec", "link": "https://stackoverflow.com/users/8370024/genelec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 45331201, "answer_count": 1, "score": 0, "last_activity_date": 1501082476, "creation_date": 1501080628, "last_edit_date": 1531164843, "question_id": 45330467, "link": "https://stackoverflow.com/questions/45330467/for-loop-return-to-top-of-column", "title": "For Loop Return to Top of Column", "body": "<p>I am an excel vba novice and I am trying to write some code to automate a specific task. I managed to find the code below and customized it to suite my needs. The code, activated by the command button, will look through column I for text FALSE starting with row 5. When it encounters a FALSE, it will stop and copy the cell in column C on the same row. </p>\n\n<p>The code works for that purpose, but I would like to take it a step further. If the code reaches the last filled cell in the I column without encountering a FALSE, I would like it to go back to the top of the column and search starting with I1. </p>\n\n<p>Is there a way to do something like this with a For Loop? I have been looking at Do Until and Do While loops but haven't seen an example that resembles what I am trying to do. </p>\n\n<p>Any assistance would be greatly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aml3m.jpg\" rel=\"nofollow noreferrer\">Picture of the Worksheet</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim LR As Long, i As Long\n    With Sheets(\"Sheet1\")\n        LR = .Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n        For i = 5 To LR\n            With .Range(\"I\" &amp; i)\n                If .Text = (\"FALSE\") Then\n                    .Offset(0, -6).Copy\n                Exit For\n                End If\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1501081878, "post_id": 45330438, "comment_id": 77623619, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/30403073/chart-axis-label-format-vba-settings\">chart axis label format vba settings</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 2, "last_activity_date": 1501082759, "last_edit_date": 1501082759, "creation_date": 1501081656, "answer_id": 45330889, "question_id": 45330438, "link": "https://stackoverflow.com/questions/45330438/changing-the-axis-of-chart-to-percentage/45330889#45330889", "title": "Changing the axis of chart to percentage", "body": "<p>Try this <code>cht.Axes(xlSecondary).TickLabels.NumberFormat = \"0.0%\"</code> instead of <code>cht.SeriesCollection(1).DataLabels.NumberFormat = \"0.0%\"</code></p>\n\n<p>Also, you can drop the <code>cht</code> inside of the <code>with</code> statement if you want.  It is redundant but shouldn't cause a problem with the code.</p>\n"}, {"tags": [], "owner": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "is_accepted": false, "score": 1, "last_activity_date": 1501082399, "creation_date": 1501082399, "answer_id": 45331167, "question_id": 45330438, "link": "https://stackoverflow.com/questions/45330438/changing-the-axis-of-chart-to-percentage/45331167#45331167", "title": "Changing the axis of chart to percentage", "body": "<p>I got the error on a different line so amended it as follows:</p>\n\n<pre><code>.ChartType = xlColumnClustered\ncht.SeriesCollection(1).ApplyDataLabels Type:=xlDataLabelsShowLabel, LegendKey:=False, AutoText:=True, HasLeaderLines:=False, ShowSeriesName:=False, ShowCategoryName:=False, ShowValue:=True, ShowPercentage:=True\ncht.SeriesCollection(1).DataLabels.NumberFormat = \"0.0%\"\n</code></pre>\n\n<p>And it works now ;)</p>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "accepted_answer_id": 45330889, "answer_count": 2, "score": 0, "last_activity_date": 1501082759, "creation_date": 1501080566, "question_id": 45330438, "link": "https://stackoverflow.com/questions/45330438/changing-the-axis-of-chart-to-percentage", "title": "Changing the axis of chart to percentage", "body": "<p>I have an sheet where I am generating the chart. I am generating Clustered Column Chart.I would like to change the  y-axis of the chart to percentage. \nI tried the below code and it gives me an error </p>\n\n<blockquote>\n  <p>object doesnot support this property or method.</p>\n</blockquote>\n\n<p>Could anyone tell, how I can change the axis. </p>\n\n<p>Any lead would be helpful </p>\n\n<pre><code>Sub chartResult()\nDim rng As Range\nDim cht As Object\nSet rng = ActiveSheet.Range(\"B2:H53\")\n'ThisWorkbook.Sheets(\"Result\").ChartObjects.Delete\nSet sh = ActiveSheet.Shapes.AddChart\nsh.Select\nSet cht = ActiveChart\nWith cht\n.SetSourceData Source:=rng\n.ChartType = xlColumnClustered\ncht.SeriesCollection(1).DataLabels = True\ncht.SeriesCollection(1).DataLabels.NumberFormat = \"0.0%\"\nEnd With\ncht.SeriesCollection(1).Format.Fill.ForeColor.RGB = RGB(72, 118, 255) '&lt;~~ Red\ncht.SeriesCollection(2).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\ncht.SeriesCollection(3).Format.Fill.ForeColor.RGB = RGB(0, 255, 0)\ncht.HasTitle = True\ncht.ChartTitle.Text = \"Result 2017\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1501080329, "post_id": 45330303, "comment_id": 77622274, "body": "So, in column A, you want to find a cell with only <code>-</code>, and then delete all rows above it? Then repeat for all worksheets in a workbook?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1501082341, "post_id": 45330303, "comment_id": 77623996, "body": "Like @BruceWayne I&#39;m not completely sure what it is that you are looking for. But if I understand your issue, here are a couple of things that might help: have a look at <code>offset</code> and also how to dynamically get the last row in your worksheet"}, {"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501086231, "post_id": 45330303, "comment_id": 77626979, "body": "Yes. I need to find in A column and repeat to all worksheets.@BruceWayne"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501086633, "post_id": 45332402, "comment_id": 77627258, "body": "&gt;Object variable or With block variable not set (Error 91)"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501086892, "post_id": 45332402, "comment_id": 77627419, "body": "Can you Debug your code and see in what line the error is showing up? But I&#39;m thinking the error is in the &quot;underline&quot; marks. Try removing them, and put the sentence in a single line. @ARGC"}, {"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501087213, "post_id": 45332402, "comment_id": 77627617, "body": "The line is showing up now is: Selection.Find(What:=&quot;-&quot;, After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501087888, "post_id": 45332402, "comment_id": 77628022, "body": "I changed it again. The both code worked very well around here. @ARGC"}, {"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501088106, "post_id": 45332402, "comment_id": 77628180, "body": "Didn&#39;t work. I run and it deleted all the other data. The macro just kept the data I didn&#39;t want xD @Rafael Matos"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501088291, "post_id": 45332402, "comment_id": 77628300, "body": "Are you sure it is the data that you want? You said that you want to remove all the data above the &quot;-&quot; character. And that is what this code is doing. @ARGC"}, {"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501088607, "post_id": 45332402, "comment_id": 77628523, "body": "Sorry, I meant below.. English is a little bit outdated."}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501089410, "post_id": 45332402, "comment_id": 77629060, "body": "I changed it again. @ARGC"}, {"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1501089635, "post_id": 45332402, "comment_id": 77629214, "body": "That&#39;s just perfect! Thank you!"}], "tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": true, "score": 0, "last_activity_date": 1501089393, "last_edit_date": 1501089393, "creation_date": 1501085756, "answer_id": 45332402, "question_id": 45330303, "link": "https://stackoverflow.com/questions/45330303/adjust-all-worksheets-with-the-same-layout/45332402#45332402", "title": "Adjust all worksheets with the same layout", "body": "<p>This works for me:</p>\n\n<pre><code>Sub Clean()\n    Dim ws As Worksheet\n    Dim Search As Range\n    Dim addr As String\n\n    For Each ws In Worksheets\n        ws.Activate\n\n        With ws.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=Range(\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .SetRange Cells\n            .Header = xlNo\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n\n\n        With ws.Range(\"A:A\")\n            Set Search = .Find(What:=\"-\", LookIn:=xlValues, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n\n            If Not Search Is Nothing Then\n                addr = Search.Address\n            Else\n                Exit Sub\n            End If\n        End With\n\n        Range(addr).Select\n        ActiveCell.Offset(1, 0).Select\n        Range(ActiveCell, ActiveCell.End(xlDown)).Select\n        Selection.EntireRow.Delete\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 45332402, "answer_count": 1, "score": 0, "last_activity_date": 1501089393, "creation_date": 1501080252, "last_edit_date": 1531161705, "question_id": 45330303, "link": "https://stackoverflow.com/questions/45330303/adjust-all-worksheets-with-the-same-layout", "title": "Adjust all worksheets with the same layout", "body": "<p>I'm trying to remove unwanted lines off all the worksheets. For example:\nI have multiples worksheets that I need to make a treatment that consist on finding a special character like \"-\" and remove everything that is above that line, and I mean exclude all lines.</p>\n\n<p>I'm stuck now.. I can't do it properly to apply to all my worksheets and the cell range is different each day.</p>\n\n<p>So far I could do..</p>\n\n<pre><code>Sub Clean()\n'\n' Clean Macro\n'\n\n'\n    Cells.Select\n    Selection.AutoFilter\n    ActiveWorkbook.Worksheets(\"Sheet1.txt\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1.txt\").AutoFilter.Sort.SortFields.Add Key _\n        :=Range(\"A1:A66723\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n        DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1.txt\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Columns(\"A:A\").Select\n    Selection.Find(What:=\"-\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    Range(\"A59044\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.EntireRow.Delete\n    Selection.End(xlUp).Select\n    Selection.End(xlUp).Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501080809, "post_id": 45330401, "comment_id": 77622674, "body": "Thanks, this is working. However when I run the macro it is asking me to select the wb file from a file explorer. Why is it doing this and not simply calculating the formula?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501081334, "post_id": 45330401, "comment_id": 77623131, "body": "@E_McAndrew is that workbook open or closed? Also what is the template.xlsx? You may need to open that or add the full path too."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501081548, "post_id": 45330401, "comment_id": 77623325, "body": "At the moment I have both workbooks open, I am hesitant to have the path as the path will change each month depending on the month (although it is probably possible to incorporate this)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501081642, "post_id": 45330401, "comment_id": 77623413, "body": "@E_McAndrew - Try <code>&quot;=IF(&#39;[wb]2 Claims&#39;!R8C5 =&#39;[Template.xlsx]Claims&#39;!R8C5,&quot;&quot;Correct&quot;&quot;,&quot;&quot;Incorrect&quot;&quot;)&quot;</code>  ...or maybe just <code>&#39;[Template]Claims&#39;!...</code>"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501081780, "post_id": 45330401, "comment_id": 77623532, "body": "Still doing the same thing, I&#39;m not too sure why as I have another macro which works in the same way, but it doesn&#39;t do this."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1501082081, "post_id": 45330401, "comment_id": 77623784, "body": "I guess the problem is that <code>wb</code> is a variable, not the actual name of the workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501082130, "post_id": 45330401, "comment_id": 77623826, "body": "@E_McAndrew - Can you post the rest of the relevant code? You may need: <code>&quot;=IF(&#39;[&quot; &amp; wb &amp; &quot;]2 Claims&#39;!R8C5 =[Template.xlsx]Claims!R8C5,&quot;&quot;Correct&quot;&quot;,&quot;&quot;Incorrect&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501082485, "post_id": 45330401, "comment_id": 77624116, "body": "I have added the entire script into my question, thanks. I didn&#39;t think any other parts were relevant but perhaps they are."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1501083061, "last_edit_date": 1501083061, "creation_date": 1501080477, "answer_id": 45330401, "question_id": 45330266, "link": "https://stackoverflow.com/questions/45330266/referencing-a-workbook-variable-in-if-formula/45330401#45330401", "title": "Referencing a Workbook variable in IF formula", "body": "<p>You need to tweak where the <code>'</code> are in the workbook reference:</p>\n\n<pre><code>\"=IF('[wb]2 Claims'!R8C5 =[Template.xlsx]Claims!R8C5,\"\"Correct\"\",\"\"Incorrect\"\")\"\n</code></pre>\n\n<p>Edit: Per your add'l code, you have <code>wb</code> as a variable. Try this instead</p>\n\n<pre><code>\"=IF('[\" &amp; wb.Name &amp; \"]2 Claims'!R8C5 =[Template.xlsx]Claims!R8C5,\"\"Correct\"\",\"\"Incorrect\"\")\"\n</code></pre>\n\n<p>(Note: you may or may not need the <code>.Name</code>)</p>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45330401, "answer_count": 1, "score": 0, "last_activity_date": 1501083061, "creation_date": 1501080187, "last_edit_date": 1501082447, "question_id": 45330266, "link": "https://stackoverflow.com/questions/45330266/referencing-a-workbook-variable-in-if-formula", "title": "Referencing a Workbook variable in IF formula", "body": "<p>I have a macro which is comparing numbers between two workbooks and outputting if it's correct or incorrect.\nOne of the workbooks is stored as a variable as it references last month in it's name. </p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks(\"Monthly Life Management Report \" &amp; Format(DateAdd(\"m\", -1, Date), \"mmmm yyyy\") &amp; \".xlsm\")\n</code></pre>\n\n<p>I am getting a application or object defined error when running the final part of the macro.</p>\n\n<pre><code> Range(\"E8\").Select\nActiveCell.FormulaR1C1 = _\n\"=IF([wb]'2 Claims'!R8C5 =[Template.xlsx]Claims!R8C5,\"\"Correct\"\",\"\"Incorrect\"\")\"\n</code></pre>\n\n<p>Entire Script</p>\n\n<pre><code>Sub Monthly_Life_Management()\n\n\nDim thisWb As Workbook\nSet thisWb = ActiveWorkbook\nWorkbooks.Add\nActiveWorkbook.SaveAs Filename:=thisWb.Path &amp; \"\\Validation_File_\" &amp; Format(Date, \"dd mm yy\") &amp; \".xls\"\n\n\nDim wb As Workbook\nSet wb = Workbooks(\"Monthly Life Management Report \" &amp; Format(DateAdd(\"m\", -1, Date), \"mmmm yyyy\") &amp; \".xlsm\")\n\n\n\n'Claims Tab\n wb.Activate\n Sheets(\"2 Claims\").Select\n\n Range(\"C2:C13\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Windows(\"Validation_File_\" &amp; Format(Date, \"dd mm yy\") &amp; \".xls\").Activate\n Range(\"C2\").Select\n ActiveSheet.Paste\n\n wb.Activate\n Sheets(\"2 Claims\").Select\n Range(\"D2:D13\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Windows(\"Validation_File_\" &amp; Format(Date, \"dd mm yy\") &amp; \".xls\").Activate\n Range(\"D2\").Select\n ActiveSheet.Paste\n\n wb.Activate\n Sheets(\"2 Claims\").Select\n Range(\"E7:G7\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Windows(\"Validation_File_\" &amp; Format(Date, \"dd mm yy\") &amp; \".xls\").Activate\n Range(\"E7\").Select\n ActiveSheet.Paste\n\n'Counts\n Range(\"E8\").Select\n ActiveCell.FormulaR1C1 = _\n\"=IF('[wb]2 Claims'!R8C5 ='[Template.xlsx]Claims'!R8C5,\"\"Correct\"\",\"\"Incorrect\"\")\"\n\n Cells.Select\n Selection.Copy\n Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "save-as", "hssfworkbook", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501080555, "post_id": 45330104, "comment_id": 77622442, "body": "What error are you getting? If you hit <code>Debug</code> is it highlighting that <code>Else: ...</code> row? Also, is it correctly saving as <code>newFile</code>, just not <code>&quot;New_Name&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8370622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f96742fa016cf487de792e1cd05318f?s=128&d=identicon&r=PG&f=1", "display_name": "Zach Schenk", "link": "https://stackoverflow.com/users/8370622/zach-schenk"}, "edited": false, "score": 0, "creation_date": 1501084678, "post_id": 45330929, "comment_id": 77625831, "body": "This is an improvement on my script... but for some reason, it fails to copy and paste the data. As in, I open up both Train10_June1 and New_name and neither have any of the data. I know the for loop and the if statement are working because they were working before..."}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8370622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f96742fa016cf487de792e1cd05318f?s=128&d=identicon&r=PG&f=1", "display_name": "Zach Schenk", "link": "https://stackoverflow.com/users/8370622/zach-schenk"}, "edited": false, "score": 0, "creation_date": 1501086120, "post_id": 45330929, "comment_id": 77626898, "body": "You need to clarify what you want. In your code, for the &quot;New_name.xls&quot; archive, your If-Else statement does nothing, but save the Workbooks(NewFile) with a new name. If you want to copy to both Excel files, you need to check again your If-Else statement."}], "tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": false, "score": 0, "last_activity_date": 1501082368, "last_edit_date": 1501082368, "creation_date": 1501081764, "answer_id": 45330929, "question_id": 45330104, "link": "https://stackoverflow.com/questions/45330104/opening-and-saving-new-workbooks-vba/45330929#45330929", "title": "Opening and Saving new Workbooks - VBA", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub DoStuff()\n    Dim CurrentFile As String\n    Dim NewFile As String\n    Dim i As Long\n    Dim wb As Workbook\n\n    CurrentFile = \"June_Files_macros_new.xlsm\"\n    NewFile = \"Train10_June01.xls\"\n\n    Set wb = Workbooks.Add\n    wb.SaveAs Workbooks(CurrentFile).Path &amp; \"\\\" &amp; NewFile\n\n    For i = 2 To 55\n        If Cells(i, 3) = Cells(i - 1, 3) And Cells(i, 13) = Cells(i - 1, 13) Then\n            Workbooks(CurrentFile).Sheets(\"Sheet1\").Rows(i).Copy Workbooks(NewFile).Worksheets(\"Sheet1\").Rows(i)\n        Else\n            Set wb = Workbooks(NewFile)\n            wb.SaveAs Workbooks(CurrentFile).Path &amp; \"\\\" &amp; \"New_name.xls\"\n            Exit For\n        End If\n    Next i\n\n End Sub\n</code></pre>\n\n<p>I put this block:</p>\n\n<pre><code>Else\n    Set wb = Workbooks(NewFile)\n    wb.SaveAs Workbooks(CurrentFile).Path &amp; \"\\\" &amp; \"New_name.xls\"\n    Exit For\n</code></pre>\n\n<p>Because every time the condition in your If gives a false response, it will try to save the Workbooks(NewFile) with the same name \"New_name.xls\" and this will give an error, since the Excel cannot save files with the same name. </p>\n\n<p>But I'm not sure what you've wanted with this Else condition.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8370622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f96742fa016cf487de792e1cd05318f?s=128&d=identicon&r=PG&f=1", "display_name": "Zach Schenk", "link": "https://stackoverflow.com/users/8370622/zach-schenk"}, "is_accepted": false, "score": 0, "last_activity_date": 1501190121, "creation_date": 1501190121, "answer_id": 45361142, "question_id": 45330104, "link": "https://stackoverflow.com/questions/45330104/opening-and-saving-new-workbooks-vba/45361142#45361142", "title": "Opening and Saving new Workbooks - VBA", "body": "<p>With your help, I managed to create something that did what I wanted to.\nThanks so much!!!</p>\n\n<pre><code>Private Sub DoStuff()\n\nApplication.DisplayAlerts = False\n\n'Create New Workbook\n\nDim Count As Integer\n\nCurrentFile = \"June_Files_macros_new.xlsm\"\nNewFile = \"Train\" &amp; CStr(Cells(2, 13)) &amp; \"_\" &amp; CStr(Cells(2, 3)) &amp; \".xls\"\n\nWorkbooks.Add\n\n\n'Save New Workbook\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; NewFile\n\n'Select top row of data and insert into spreadsheed!!!!!\nWorkbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(2).Copy\nWorkbooks(NewFile).Worksheets(\"Sheet1\").Rows(2).PasteSpecial xlPasteValues\n\n\nCount = 3\n\n\n\nFor i = 3 To 12802\n\n'if Date and Train Number are equal, Then copy and paste the i th row\n'else, save new file, create another new file, save\n\n    If Cells(i, 3) = Cells(i - 1, 3) And Cells(i, 13) = Cells(i - 1, 13) Then\n            Workbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(i).Copy\n            Workbooks(NewFile).Worksheets(\"Sheet1\").Rows(Count).PasteSpecial xlPasteValues\n            Count = Count + 1\n\n    Else: Workbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(1).Copy\n          Workbooks(NewFile).Worksheets(\"Sheet1\").Rows(1).PasteSpecial xlPasteValues\n          Workbooks(NewFile).SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; \"Train\" &amp; CStr(Cells(i - 1, 13)) &amp; \"_\" &amp; CStr(Cells(i - 1, 3)) &amp; \".xls\"\n          Workbooks(NewFile).Close\n\n          Workbooks.Add\n          NewFile = \"Train\" &amp; CStr(Cells(i, 13)) &amp; \"_\" &amp; CStr(Cells(i, 3)) &amp; \".xls\"\n          ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; NewFile\n\n          Workbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(i).Copy\n          Workbooks(NewFile).Worksheets(\"Sheet1\").Rows(2).PasteSpecial xlPasteValues\n\n          Count = 3\n   End If\n\nNext i\n\nWorkbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(1).Copy\nWorkbooks(NewFile).Worksheets(\"Sheet1\").Rows(1).PasteSpecial xlPasteValues\n\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; NewFile\n\nWorkbooks(NewFile).Close\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8370622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f96742fa016cf487de792e1cd05318f?s=128&d=identicon&r=PG&f=1", "display_name": "Zach Schenk", "link": "https://stackoverflow.com/users/8370622/zach-schenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5749, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501190121, "creation_date": 1501079799, "last_edit_date": 1531161705, "question_id": 45330104, "link": "https://stackoverflow.com/questions/45330104/opening-and-saving-new-workbooks-vba", "title": "Opening and Saving new Workbooks - VBA", "body": "<p>So I know there have been questions on this before, but none seem to explicitly solve the problems I'm having. Effectively what I'm trying to do is create a new workbook, copy and paste data into it, and then save that new workbook under a new filename. No matter what I do, I seem to get various types of error messages. </p>\n\n<p>Here is my code. Any help is very appreciated!</p>\n\n<pre><code>Private Sub DoStuff()\n\nCurrentFile = \"June_Files_macros_new.xlsm\"\nNewFile = \"Train10_June01.xls\"\n\nWorkbooks.Add\n\n\n'Save New Workbook\nActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; NewFile\n\nFor i = 2 To 55 \n    If Cells(i, 3) = Cells(i - 1, 3) And Cells(i, 13) = Cells(i - 1, 13) Then\n            Workbooks(CurrentFile).Worksheets(\"Sheet1\").Rows(i).Copy _\n            Workbooks(NewFile).Worksheets(\"Sheet1\").Rows(i)\n    Else: Workbooks(NewFile).SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; \"New_Name\"\n    End If    \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>It seems to me that the \"New_Name\" is causing all my problems, but I'm open to changing anything that will allow this to work.</p>\n\n<p>Thanks so much!\nZach</p>\n\n<p>ps I'm relatively new to VBA so please try to keep any explanations somewhat simple!</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "powerpoint", "filepath"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1501079745, "post_id": 45330054, "comment_id": 77621798, "body": "that&#39;s half the answer, what about <code>ppPres.Slides.Paste (ppPasteEnchancedMetafile)</code> ? you will get an error here as well if you don&#39;t refer to the slide number"}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 0, "creation_date": 1501079803, "post_id": 45330054, "comment_id": 77621846, "body": "Didn&#39;t work. Same error. I will post the rest of the code in case."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501079863, "post_id": 45330054, "comment_id": 77621891, "body": "Verify that <code>myFile</code> contains a valid file name."}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 0, "creation_date": 1501080037, "post_id": 45330054, "comment_id": 77622038, "body": "@BrianMStafford how does one do that?"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501080199, "post_id": 45330054, "comment_id": 77622170, "body": "Either step through the code and hover your cursor over <code>myFile</code>, or add a MsgBox to display the value of <code>myFile</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 1, "creation_date": 1501080258, "post_id": 45330054, "comment_id": 77622222, "body": "@JackArmstrong try <code>Set objPres = ppApp.Presentations.Open(myFile)</code> (since you are working from Excel)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501081244, "post_id": 45330054, "comment_id": 77623062, "body": "@BrianMStafford please update you answer, since it&#39;s marked with &quot;V&quot;, at least to give the correct answer :)"}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1501081338, "last_edit_date": 1501081338, "creation_date": 1501079670, "answer_id": 45330054, "question_id": 45329951, "link": "https://stackoverflow.com/questions/45329951/reading-file-paths-in-excel-vba/45330054#45330054", "title": "Reading File Paths in Excel VBA", "body": "<p>Change this line:</p>\n\n<pre><code>objPres = Presentations.Open(myFile)\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Set objPres = ppApp.Presentations.Open(myFile)\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 45330054, "answer_count": 1, "score": 1, "last_activity_date": 1501081338, "creation_date": 1501079458, "last_edit_date": 1501079910, "question_id": 45329951, "link": "https://stackoverflow.com/questions/45329951/reading-file-paths-in-excel-vba", "title": "Reading File Paths in Excel VBA", "body": "<p>I am creating a PowerPoint each week from some charts in Excel using VBA. However, the first slide needs to come from lasts week PowerPoint created. </p>\n\n<p>The file path and name are both variables because they have the date in their title. I am able to account for this and have checked it with the actual file's name. It looks the same to me. However when I try to Open the file I get the ActiveX error/Run-time error 429. Any ideas would be much appreciated</p>\n\n<pre><code>Sub CreateNewPres()\nDim ppApp As PowerPoint.Application\nDim ppPres As PowerPoint.Presentation\nDim objPres As PowerPoint.Presentation\nDim ppSlide As PowerPoint.Slide\nDim ppTextbox As PowerPoint.Shape\n\nSet ppApp = New PowerPoint.Application\nppApp.Visible = True\nppApp.Activate\n\nSet ppPres = ppApp.Presentations.Add\n\ntodayDate = Date\nmyTextDate = Format(todayDate, \"yyyy-mm-dd\")\nmyFilePath = \"C:\\Desktop\\Main\\\" &amp; myTextDate\nmyFileName = \"\\Meeting_\" &amp; myTextDate &amp; \".pptx\"\nmyFile = myFilePath &amp; myFileName\nobjPres=_\n   Presentations.Open(myFile)\n\nobjPres.Slides(1).Copy\nppPres.Slides.Paste (ppPasteEnchancedMetafile)\nSet ppTextbox = ppSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, _\n    Left:=0, Top:=0, Width:=30, Height:=10)\n    With myTextBox.TextFrame.TextRange.Text = todayDate\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1501080506, "post_id": 45329909, "comment_id": 77622404, "body": "As a suggestion, you should use <code>Option Explicit</code> to force yourself to declare all your variables."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501080566, "post_id": 45330253, "comment_id": 77622455, "body": "I tried similar way to make it; and still it complains about this Insert statement"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501080630, "post_id": 45330253, "comment_id": 77622501, "body": "Ohh sorry, I had not reviewed the query. Let me check and get back to you."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501081103, "post_id": 45330253, "comment_id": 77622907, "body": "It kinda confuses me that you state that you are inserting from one Excel sheet to another but I only see you writing a hard-coded row of values to your target workbook. Where is it that you are pulling from the source workbook? If you would query the whole sheet through a select, then you could drop it into a recordset and then write to target workbook."}, {"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501081832, "post_id": 45330253, "comment_id": 77623572, "body": "yes, I know it looks confusing. I have 2 excel files; 1st one is &quot;Tracker&quot; - it&#39;s my &quot;db&quot; with 3 tabs(names, tasks and ResourceTasks); I select based on date condition data from ResourceTasks and load it into &quot;Master&quot; excel file, after, if needed, user should be able to modify this selected data, and append it back to ResourceTasks tab; And Select part of this plan works fine; For now i&#39;m trying to make this Insert part to work"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501082409, "post_id": 45330253, "comment_id": 77624054, "body": "Can you show code where you select or pull data from Resource Tasks? Is that not a select already? Why don&#39;t you drop that select into a recordset and then write to target?"}, {"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501083721, "post_id": 45330253, "comment_id": 77625102, "body": "I added it to base post; I&#39;m not so familiar with this technology yet; Can you add some details to this idea with writing to target? Thanks"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1501087414, "last_edit_date": 1501087414, "creation_date": 1501080163, "answer_id": 45330253, "question_id": 45329909, "link": "https://stackoverflow.com/questions/45329909/insert-data-from-one-excel-file-to-another-one-using-adodb/45330253#45330253", "title": "insert data from one excel file to another one using ADODB", "body": "<p>You can achieve this running your query against a recordset and then copying it to your target range. Code would be like:</p>\n\n<pre><code>Public Sub InsertIntoTable()\n\n    Dim objConnection As Object\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n\n    objConnection.Open _\n        \"Provider = Microsoft.Jet.OLEDB.4.0; \" &amp; _\n        \"Data Source=C:\\Users\\User1\\Documents\\Excel files\\tracker.xls; Extended Properties=\"\"Excel 8.0;HDR=Yes\"\"\"\n\n    Dim mySQL As String\n    mySQL = \"INSERT INTO ResourceTasks (Name, Task, Date, Load) VALUES ('Name11', 'task2',\" &amp; CDate(\"24 / 5 / 2017\") &amp; \", 0.50)\"\n\n    Debug.Print mySQL\n\n    Dim rs As Object\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    rs.Open mySQL, objConnection\n\n    ThisWorkbook.Sheets(\"1\").Cells(1, 1).CopyFromRecordset Data:=rs\n\nEnd Sub\n</code></pre>\n\n<p>Regards</p>\n\n<p><strong>* EDIT *</strong>\nFrom post update from OC. Note that I am unfamiliar with command <code>clsDAL</code> so I have only edited copying recordset to range. If you are pulling all your rows into a recordset and just want to output it into a worksheet you can use the following:</p>\n\n<pre><code>Public Sub SearchNames()\n\n    Dim oResources As ADODB.Recordset\n    Dim oDal As New clsDAL\n\n    Set oResources = oDal.GetReadonlyRS(\"SELECT DISTINCT [Name] FROM [ResourceTasks$]\") 'where Date &gt;= **Drop date from selection here**  and Date &lt; **Drop date from selection here**  'where Active like TRUE \")\n\n    ThisWorkbook.Sheets(\"Master\").Range(\"A31\").CopyFromRecordset Data:=oResources\n    oResources.Close\n    Set oResources = Nothing\n\n    oDal.closeFile\n    Set oDal = Nothing\n\n    '! close connection and file\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501083468, "post_id": 45331234, "comment_id": 77624919, "body": "all 3 options were tasted before and there is no difference in result; Can I have some problem with drivers, or dll or whatever else MS related problems ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501084665, "post_id": 45331234, "comment_id": 77625822, "body": "@VladimirZaguzin what is <code>ResourceTasks</code>, a worksheet? then should be used as <code>[ResourceTasks$]</code>."}, {"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501086292, "post_id": 45331234, "comment_id": 77627035, "body": "yes, ResourceTasks is a worksheet in a workbook that i use as DB; for a moment I was like &quot;how could I miss it&quot; but even with this [ResourceTasks$] format, I still see the same error message"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1501084975, "last_edit_date": 1501084975, "creation_date": 1501082564, "answer_id": 45331234, "question_id": 45329909, "link": "https://stackoverflow.com/questions/45329909/insert-data-from-one-excel-file-to-another-one-using-adodb/45331234#45331234", "title": "insert data from one excel file to another one using ADODB", "body": "<p>I think you have a syntax problem with the <code>Date</code> field in the query.</p>\n\n<blockquote>\n  <p>&amp; CDate(\"24 / 5 / 2017\") &amp;...</p>\n</blockquote>\n\n<p>A date should be either enclosed with <code>#</code>, or, Excel-specific, can be passed as a number.</p>\n\n<p>First option:</p>\n\n<pre><code>... VALUES ('Name11', 'task2', #24/5/2017#, 0.50)\"\n'                              ^^^^^^^^^^^\n</code></pre>\n\n<p>Second option:</p>\n\n<pre><code>... VALUES ('Name11', 'task2',\" &amp; CDbl(DateSerial(2017, 5, 24)) &amp; \", 0.50)\"\n'                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Also if <code>ResourceTasks</code> is a worksheet, it should be referenced in the query as <code>[ResourceTasks$]</code></p>\n\n<pre><code>INSERT INTO [ResourceTasks$] VALUES...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "is_accepted": true, "score": 0, "last_activity_date": 1501615888, "creation_date": 1501615888, "answer_id": 45446231, "question_id": 45329909, "link": "https://stackoverflow.com/questions/45329909/insert-data-from-one-excel-file-to-another-one-using-adodb/45446231#45446231", "title": "insert data from one excel file to another one using ADODB", "body": "<p>so i found it's easier for me to AddNew than to Insert for some reason\nIt looks like this; hope it would help someone  </p>\n\n<pre><code>Public Function InsertNewRecord() As Boolean\n\nDim oTasks As ADODB.Recordset\nDim oDal As New clsDAL\n\nSet oTasks = oDal.GetUpdateableRS(\"SELECT * FROM [ResourceTasks$] WHERE Task=''\")\n\nWith oTasks\n    .AddNew\n        .Fields(\"Name\").Value = Sheets(\"Master\").ComboBox24.Value \n        .Fields(\"Task\").Value = Sheets(\"Master\").ComboBox25.Value \n        .Fields(\"Date\").Value = Sheets(\"Master\").ComboBox23.Value\n        .Fields(\"Load\").Value = Sheets(\"Master\").TextBox24.Value \n    .Update\n    .Close\nEnd With\n\nSet oTasks = oDal.GetUpdateableRS(\"SELECT Task FROM [Tasks$] WHERE Task=''\")\n\nWith oTasks\n    .AddNew\n        .Fields(\"Task\").Value = sTask\n    .Update\n    .Close\nEnd With\n\nSet oDal = Nothing\nSet oTasks = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3113, "favorite_count": 0, "accepted_answer_id": 45446231, "answer_count": 3, "score": 0, "last_activity_date": 1501615888, "creation_date": 1501079340, "last_edit_date": 1501083334, "question_id": 45329909, "link": "https://stackoverflow.com/questions/45329909/insert-data-from-one-excel-file-to-another-one-using-adodb", "title": "insert data from one excel file to another one using ADODB", "body": "<p>I'm trying to insert data from one excel file to another one using <code>adodb</code> and faced a problem with insert method. It gives me an error message like below: </p>\n\n<blockquote>\n  <p>Syntax error in INSERT INTO statement</p>\n</blockquote>\n\n<p>I tried different date formats, with and without quotes, also I tried different method with record sets and still got the same problem with this sql statement.\nCan someone help me to find out what's the problem?    </p>\n\n<pre><code>Public Sub InsertIntoTable() \n\nSet objConnection = CreateObject(\"ADODB.Connection\")\n\n\nobjConnection.Open _\n    \"Provider = Microsoft.Jet.OLEDB.4.0; \" &amp; _\n        \"Data Source=C:\\Users\\User1\\Documents\\Excel files\\tracker.xls; Extended Properties=\"\"Excel 8.0;HDR=Yes\"\"\"\n\n\nmySQL = \"INSERT INTO ResourceTasks (Name, Task, Date, Load) VALUES ('Name11', 'task2',\" &amp; CDate(\"24 / 5 / 2017\") &amp; \", 0.50)\"\n\nDebug.Print mySQL\n\nobjConnection.Execute mySQL\n\nEnd Sub\n</code></pre>\n\n<p>This code I use to get Name from ResourceTasks and load it into master page; with very similar functions I retrieve tasks, load and dates the only difference it's a formatting on the screen    </p>\n\n<p>I made my connection with next parameters : adOpenStatic, adLockReadOnly</p>\n\n<pre><code>Public Sub SearchNames()\n\nDim oResources As ADODB.Recordset\nDim oDal As New clsDAL\n\nWorksheets(\"Master\").Activate\n\nSet oResources = oDal.GetReadonlyRS(\"SELECT DISTINCT [Name] FROM [ResourceTasks$]\") 'where Date &gt;= **Drop date from selection here**  and Date &lt; **Drop date from selection here**  'where Active like TRUE \")\n\noResources.MoveFirst\n\n'get all record from record set one by one to 2nd table\n\nDo Until oResources.EOF\n    RowNumber = 30 + oResources.AbsolutePosition\n    Range(\"A\" &amp; RowNumber).Value = oResources.Fields(\"Name\").Value \n    oResources.MoveNext\nLoop\n\n'! get all record from record set one by one to 2nd table\n\n'Close connection and file\n\noResources.Close\n\nSet oResources = Nothing\n\noDal.closeFile\n\nSet oDal = Nothing\n\n'! close connection and file\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1501079422, "creation_date": 1501079422, "answer_id": 45329937, "question_id": 45329781, "link": "https://stackoverflow.com/questions/45329781/excel-get-value-between-characters-but-if-empty-copy-cell/45329937#45329937", "title": "Excel: get value between characters, but if empty copy cell?", "body": "<p>Try using <code>IFERROR()</code>?</p>\n\n<pre><code>=IFERROR(TRIM(LEFT(SUBSTITUTE(MID(G2;FIND(\"|\";SUBSTITUTE(G2;\"|\";\"|\";2))+1;LEN(G2));\"|\";REPT(\" \";LEN(G2)));LEN(G2))),TRIM(G2))\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 5660293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5f25266c471856a04bb7bd11f5558606?s=128&d=identicon&r=PG&f=1", "display_name": "RobbTe", "link": "https://stackoverflow.com/users/5660293/robbte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 45329937, "answer_count": 1, "score": 1, "last_activity_date": 1501079431, "creation_date": 1501079032, "last_edit_date": 1531161705, "question_id": 45329781, "link": "https://stackoverflow.com/questions/45329781/excel-get-value-between-characters-but-if-empty-copy-cell", "title": "Excel: get value between characters, but if empty copy cell?", "body": "<p>I am using the formula below to get a value between the the first and second \"|\".\nHowever sometimes there is no value. The formula will result in #VALUE!\nSo, is it possible to get the value between the first and second \"|\" character, but if there is no value, copy the whole cell?</p>\n\n<p>The formula i use is:    <code>=TRIM(LEFT(SUBSTITUTE(MID(B2;FIND(\"|\";SUBSTITUTE(B2;\"|\";\"|\";2))+1;LEN(B2));\"|\";REPT(\" \";LEN(B2)));LEN(B2)))</code></p>\n\n<p>The result i would like is:</p>\n\n<pre><code>|---------------------|------------------|\n|      Collected      |       Data       |\n|---------------------|------------------|\n|       Value 2       |  Value|Value 2   |\n|---------------------|------------------|\n|       Value         |      Value       |\n|---------------------|------------------|\n</code></pre>\n\n<p>I guess this needs a module?\nThanks a lot.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1501079828, "creation_date": 1501079828, "answer_id": 45330115, "question_id": 45329630, "link": "https://stackoverflow.com/questions/45329630/conditional-formatting-formula-vba/45330115#45330115", "title": "Conditional formatting formula/vba", "body": "<p>To achieve this with the help of the conditional formatting, follow these steps...</p>\n\n<ol>\n<li>Select the whole columns B:C.</li>\n<li>Home --> Conditional Formatting --> New Rule --> Use a formula to determine which cells to format --> in the box below \"Format values where this formula is true\", paste the formula given below</li>\n<li>Click on Format --> Font --> Choose the Bold italic and set the font color to red or as per your choice --> OK --> OK to finish.</li>\n</ol>\n\n<p><strong>Formula for conditional formatting:</strong></p>\n\n<pre><code>=AND(B1=\"x\",COUNTIFS($A:$A,$A1,B:B,\"x\")&gt;1)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 45330115, "answer_count": 1, "score": 0, "last_activity_date": 1576400808, "creation_date": 1501078680, "last_edit_date": 1576400808, "question_id": 45329630, "link": "https://stackoverflow.com/questions/45329630/conditional-formatting-formula-vba", "title": "Conditional formatting formula/vba", "body": "<p>I have the following table where people are in either group 1 or 2 or 3. </p>\n\n<p><a href=\"https://i.stack.imgur.com/cNJs0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cNJs0.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I want is to format (highlight) x differently when one person is in more than one group on one day. Is there any possibility to do this neatly without vba based on formulae only? If vba I do not have a nice idea how to approach this without simply browsing the entire table. How should I approach that?</p>\n"}, {"tags": ["vba", "excel", "merge", "split"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501092239, "post_id": 45329145, "comment_id": 77630832, "body": "Aren&#39;t merged cells fun?  I try to avoid them whenever possible.  With regard to the merging of <code>C4:E4</code>, all of the data will be in <code>C4</code> (the upper left cell of the merged area), so that&#39;s all you need to look at and figure out how you want to split it."}, {"owner": {"reputation": 13, "user_id": 8346356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c80ca1b4ccac19c049d7f3d6a26e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/8346356/mario"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501097543, "post_id": 45329145, "comment_id": 77633731, "body": "@RonRosenfeld -- Oh! I used the upper left cell for merged area for split and copied the code over while changing variable names and that worked! Thanks. Now, I am trying to figure out how to output the 4 columns that need to be merged to I can simply copy and replace the entire &quot;messy&quot; sub-selection of data. Any thoughts?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501098136, "post_id": 45329145, "comment_id": 77634060, "body": "It is not at all clear to me how you want to handle the results.  It is trivial to split the data in C4 by the LineFeed character, as you are doing.  I would suggest to avoid merged cells.  So I would make each a separate row; you&#39;ll have a bunch of blank columns, but you can deal with that by formatting.  And you may have to repeat entries in different rows, depending on how you want things to come out at the end; again, you should be able to make things appear as you wish by centering across cells (without merging) and by blanking out some entries (font the same color as background)."}], "answers": [{"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1501080001, "creation_date": 1501080001, "answer_id": 45330183, "question_id": 45329145, "link": "https://stackoverflow.com/questions/45329145/excel-macro-how-to-break-wrapped-text-into-rows-for-merged-columns/45330183#45330183", "title": "Excel macro - how to break wrapped text into rows for merged columns?", "body": "<p>I often find that the best approach is to first paste the data into Word, do some clean-up there, format it as a Word table, and then transfer it into Excel.  The reason is that Word has very powerful find/replace features which allow you to quickly convert a mess into something sensible. Since you didn't provide example data I could paste in, I randomly found a pdf on the web to show one approach. The key in this case was noticing that each column begins with a space followed by a digit. So I did a search for \" ^#\" (a space followed by 'any digit') and replaced it by \"^t\" (tab character). Next, I used Word's 'Convert to Table' feature, and after that the data table is ready for pasting into Excel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NGsp0.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NGsp0.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8346356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c80ca1b4ccac19c049d7f3d6a26e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/8346356/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 875, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501091366, "creation_date": 1501077588, "last_edit_date": 1501091366, "question_id": 45329145, "link": "https://stackoverflow.com/questions/45329145/excel-macro-how-to-break-wrapped-text-into-rows-for-merged-columns", "title": "Excel macro - how to break wrapped text into rows for merged columns?", "body": "<p>I have to import data from PDF to SAS, and one step involves converting the PDF data to excel spreadsheet before converting to text for simpler SAS import. Usually the PDF data converts fine into excel, with few errors. As I am trying to import older data, it is getting quite messy and some of the rows get wrapped in a single cell. I am trying to figure out if there is a macro possible which can help me fix this error in sheets without too much manual manipulation. I have never programmed in VBA before so I am quite new to excel macros.</p>\n\n<p>Here is the example of messy data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rvu8y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rvu8y.png\" alt=\"  \"></a></p>\n\n<p>Here is the example of normal data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V2x4k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V2x4k.png\" alt=\"  \"></a></p>\n\n<p>(*Note the data values in the two images are different, just for example formatting)</p>\n\n<p>I have tried working on a macro. For this, I copy the messy data into another sheet, and run the macro which outputs corrected data on a separate sheet, and then i copy the corrected data over the messy one in the original spreadsheet.\nAfter trying to code the macro, I was unable to figure out how to tell excel to take the data in columns C,D,E,F which are all merged into one cell and break that wrapped text, and so on for other merged columns (as shown in messy data image). \nHere is my current code that I got after watching some tutorials:</p>\n\n<pre><code>Sub Split_Text_to_Rows()\nDim splitVals1 As Variant\nDim splitVals2 As Variant\n\nDim totalVals As Long\n\nSet sh1 = ThisWorkbook.Sheets(2)\nSet sh2 = ThisWorkbook.Sheets(3)\n\nsh2.Cells.Clear\nlrow1 = sh1.Range(\"A65356\").End(xlUp).Row\n\nFor j = 1 To lrow1\n\nsplitVals1 = Split(sh1.Cells(j, 1), Chr(10))\nsplitVals2 = Split(sh1.Cells(j, 2), Chr(10))\n\n    For i = LBound(splitVals1) To UBound(splitVals1)\n        lrow2 = sh2.Range(\"A65356\").End(xlUp).Row\n        sh2.Cells(lrow2 + 1, 1) = splitVals1(i)\n    Next i\n\n    For k = LBound(splitVals2) To UBound(splitVals2)\n        lrow3 = sh2.Range(\"B65356\").End(xlUp).Row\n         sh2.Cells(lrow3 + 1, 2) = splitVals2(k)\n    Next k\n\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, my code is also quite messy. Although, I got the code to work for columns A and B, when I get to column C - \"Motor Vehicle Theft\" and so on, I am not sure how to separate that wrapped text since they are merged in columns C,D,E,F. I would also like to keep the columns I to Q as two merged rows even after macro splits 1 row into 2 (shown in normal data image) and then continue splitting cells till column Z.\nAny tips would be helpful! Please let me know if more information or clarification is needed. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501077048, "post_id": 45328889, "comment_id": 77619468, "body": "Is this workbook open when running this code ? Also, shouldn&#39;t previous month be June, not May ?"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501077109, "post_id": 45328889, "comment_id": 77619530, "body": "Yes the workbook is open, apologies yes June (I am using an older file for testing) I will rename now"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1501077299, "post_id": 45328889, "comment_id": 77619712, "body": "Replace <code>Windows</code> with <code>Workbooks</code>"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1501077388, "post_id": 45328889, "comment_id": 77619777, "body": "Same error @Tom"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1501077518, "post_id": 45328889, "comment_id": 77619908, "body": "Test the name and make sure the names match.  Add <code>msgbox &quot;Monthly Life Management Report &quot; &amp; Format(Date, &quot;mmm yyyy&quot;) &amp; &quot;.xlsm&quot;</code> before the line and verify that everything matches the name of the workbook, including the suffix."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1501077527, "post_id": 45328889, "comment_id": 77619914, "body": "Select the workbook that you want to activate (i.e. June 2017) and in the immediate window type <code>?ActiveWorkbook.Name</code> Then enter <code>?&quot;Monthly Life Management Report &quot; &amp; Format(Date, &quot;mmm yyyy&quot;) &amp; &quot;.xlsm&quot;</code> and make sure the two match"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501077537, "post_id": 45328889, "comment_id": 77619921, "body": "On the title bar of the relevant Window - does it say <i>Monthly Life Management Report Jul 2017.xlsm</i> or <i>Monthly Life Management Report Jul 2017</i>?  This part is the <code>Windows Caption</code> and for the <code>Windows(...)</code> to work it must be as it is in the caption - duplicate your screen and it would be  <i>Monthly Life Management Report Jul 2017.xlsm:1</i>"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1501077601, "post_id": 45329116, "comment_id": 77619974, "body": "Why set it to a variable?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501077641, "post_id": 45329116, "comment_id": 77620007, "body": "@E_McAndrew what is the exact name of your <code>Workbook</code> ?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1501077648, "post_id": 45329116, "comment_id": 77620015, "body": "Think you need <code>Format(DateAdd(&quot;m&quot;, -1, Date), &quot;mmmm yyyy&quot;)</code>"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501077933, "post_id": 45329116, "comment_id": 77620273, "body": "Thanks all that did it"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1501080329, "post_id": 45329116, "comment_id": 77622272, "body": "@ShaiRado and Tom I have a follow up question at <a href=\"https://stackoverflow.com/questions/45330266/referencing-a-workbook-variable-in-if-formula\" title=\"referencing a workbook variable in if formula\">stackoverflow.com/questions/45330266/&hellip;</a> which I think ye may know the answer to. Thanks for all ye&#39;re help."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1501077808, "last_edit_date": 1501077808, "creation_date": 1501077526, "answer_id": 45329116, "question_id": 45328889, "link": "https://stackoverflow.com/questions/45328889/activate-workbook-with-month-and-year-in-name/45329116#45329116", "title": "Activate Workbook With Month and Year in Name", "body": "<p>Try the code below:</p>\n\n<pre><code>Dim wb As Workbook\n\nSet wb = Workbooks(\"Monthly Life Management Report \" &amp; Format(DateAdd(\"m\", -1, Date), \"mmm yyyy\") &amp; \".xlsm\")\nwb.Activate\n</code></pre>\n\n<p><strong>Note</strong>: the name of the workbook should be saved as <code>\"Jun 2017\"</code> and not <code>\"June 2017\"</code>.</p>\n\n<p>If you have a full Month as the file name, then use the line below instead:</p>\n\n<pre><code>Set wb = Workbooks(\"Monthly Life Management Report \" &amp; Format(DateAdd(\"m\", -1, Date), \"mmmm yyyy\") &amp; \".xlsm\")\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 45329116, "answer_count": 1, "score": 2, "last_activity_date": 1501077808, "creation_date": 1501076928, "last_edit_date": 1501077119, "question_id": 45328889, "link": "https://stackoverflow.com/questions/45328889/activate-workbook-with-month-and-year-in-name", "title": "Activate Workbook With Month and Year in Name", "body": "<p>I am writing a VBA macro and I need to activate a workbook called Monthly Management Report June 2017 (the month will always be the previous month). \nI am using the following code </p>\n\n<pre><code>Windows(\"Monthly Life Management Report \" &amp; Format(Date, \"mmm yyyy\") &amp; \".xlsm\").Activate\n</code></pre>\n\n<p>But I am getting a Subscript out of range error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1501077055, "post_id": 45328740, "comment_id": 77619477, "body": "Why not use <code>For each ws in myworkbook.Worksheets</code> see <a href=\"https://stackoverflow.com/documentation/excel-vba/1144/loop-through-all-sheets-in-active-workbook/3685/retrieve-all-worksheets-names-in-active-workbook#t=201707261350060188819\">SO Excel documentation topic</a>"}, {"owner": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1501082955, "post_id": 45328740, "comment_id": 77624490, "body": "These are separate workbooks, not worksheets within a workbook. They all have a unique file name and path that is differentiated by the date. Notice the file name includes the date."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "edited": false, "score": 0, "creation_date": 1501082797, "post_id": 45328944, "comment_id": 77624363, "body": "This worked for the first pass through, but not the second. If there were two successive errors, then the second error would be raised but not the first. I used message boxes to make sure that Err.Clear had removed error 1004 but the error was still thrown."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "edited": false, "score": 0, "creation_date": 1501084009, "post_id": 45328944, "comment_id": 77625307, "body": "@Dan I&#39;m not seeing this behavior with the above code."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 2, "last_activity_date": 1501077074, "creation_date": 1501077074, "answer_id": 45328944, "question_id": 45328740, "link": "https://stackoverflow.com/questions/45328740/how-to-use-error-handling-to-skip-loop-iterations/45328944#45328944", "title": "How to Use Error Handling to Skip Loop Iterations", "body": "<p>Why not something like this:</p>\n\n<pre><code>Public Sub SkipLoop()\n   On Error Resume Next\n\n   Dim i As Integer\n   Dim wb As Workbook\n\n   For i = 1 To 100\n      Err.Clear\n      Set wb = Workbooks.Open(\"some file\")\n\n      If Err.Number = 0 Then\n         'do work on success\n      End If\n   Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501077430, "post_id": 45329003, "comment_id": 77619825, "body": "You need to use error handling because if the file is not found an error is thrown."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501077819, "post_id": 45329003, "comment_id": 77620171, "body": "I could&#39;ve sworn it would return <code>Nothing</code> if the filepath isnt found, but wrapped it in an error skip just in case (since the error will be handled by the logic check).\\"}, {"owner": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "edited": false, "score": 0, "creation_date": 1501082729, "post_id": 45329003, "comment_id": 77624310, "body": "I actually tried this as well, and I would get errors on the MyWorkbook Is Nothing check."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1501083895, "post_id": 45329003, "comment_id": 77625221, "body": "If MyWorkbook is declared properly there should be no way of getting an error."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 2, "last_activity_date": 1501077710, "last_edit_date": 1501077710, "creation_date": 1501077219, "answer_id": 45329003, "question_id": 45328740, "link": "https://stackoverflow.com/questions/45328740/how-to-use-error-handling-to-skip-loop-iterations/45329003#45329003", "title": "How to Use Error Handling to Skip Loop Iterations", "body": "<p>No need to use error handling for something like this. Just use smart logic to your advantage:</p>\n\n<pre><code>Dim MyWorkbook as Workbook\nfor i = 1 to x\n     'get ready for to open the workbook\n\n     On Error Resume Next\n     set myworkbook = workbooks.open(\"path\\myworkbook\" &amp; date)\n     On Error GoTo 0\n\n    If Not MyWorkbook Is Nothing Then\n        'do a bunch of stuff after I get the workbook\n    End if\nnext i\n</code></pre>\n\n<p>What this does is checks for 'Nothingness' of the object variable. If the object isnt set (wasnt found) the code within the If block wont run.</p>\n"}], "owner": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4104, "favorite_count": 0, "accepted_answer_id": 45329003, "answer_count": 2, "score": 0, "last_activity_date": 1501077710, "creation_date": 1501076488, "last_edit_date": 1531164843, "question_id": 45328740, "link": "https://stackoverflow.com/questions/45328740/how-to-use-error-handling-to-skip-loop-iterations", "title": "How to Use Error Handling to Skip Loop Iterations", "body": "<p>I have a for loop where near the top I expect to throw an error trying to set a variable equal to a workbook. The error is returned because the workbook may or may not exist. The for loop loops over many workbooks and any number of them may or may not exist. the loop looks something like this</p>\n\n<pre><code>for i = 1 to x\n     'get ready for to open the workbook\n\n     set = myworkbook = workbooks.open(\"path\\myworkbook\" &amp; date)\n\n     'do a bunch of stuff after I get the workbook\n\nnext i\n</code></pre>\n\n<p>this works all fine and dandy, but if the workbook doesn't exist, then I get an error. Now I have tried a handful of error handling techniques. Ideally what happens is that if the workbook isn't found, it skips right down to the bottom of the loop and just goes into the next i.</p>\n\n<p>I have used goto statements to just jump to the bottom of the line, but that only works once and on the second pass through when the workbook doesn't exist, that throws an error. I have tried err.Clear after the the goto line so that the new error can be caught. I have tried goto -1 to clear the error but that doesn't work either. I have tried a variety of resume next statements but if the error doesn't occur because the workbooks are found, then that throws an error which I can't seem to handle. I check the error number before it starts the error handling routine wrapping the variable setting line to make sure that it shows 0 but it still throws the error.</p>\n\n<p>There seem to be a lot of methods to solve this problem and I think I've tried them all. This isn't a unique problem I'm certain and I just need a push in the right direction. Thanks for any help you guys might provide.</p>\n\n<p>Just so you don't think I haven't tried whatever solution you think of first, here are some other questions I've read:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19039657/for-loop-how-to-skip-iterations\">For Loop, how to skip iterations</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/14158901/difference-between-on-error-goto-0-and-on-error-goto-1-vba/14159999#14159999\">Difference between &#39;on error goto 0&#39; and &#39;on error goto -1&#39; -- VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/15542747/on-error-goto-0-not-resetting-error-trapping\">On Error Goto 0 not resetting error trapping</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/330937/access-vba-is-it-possible-to-reset-error-handling\">Access VBA: Is it possible to reset error handling</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/5895908/continue-for-loop\">Continue For loop</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35372946/error-handling-only-works-once\">Error handling only works once</a></p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 1, "creation_date": 1501076477, "post_id": 45328539, "comment_id": 77619011, "body": "In order to help you, please post the vba code which is trying to call the stored procedure."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1501166635, "post_id": 45328539, "comment_id": 77669507, "body": "Please wrap the macro in <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/error-trapping\" rel=\"nofollow noreferrer\">error handling</a> even <a href=\"https://stackoverflow.com/questions/730414/determine-real-cause-of-odbc-failure-error-3146-with-ms-access\">dbengine error handling</a> to get a precise message of the issue."}, {"owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501174364, "post_id": 45328539, "comment_id": 77674898, "body": "Ok i have it working now.  The only issue now is it does not pass the second parameter.              &#39;    With cmd         .ActiveConnection = conn         .CommandType = adCmdStoredProc         .CommandText = &quot;AMC_GW_TESTSP&quot;         Set param = .CreateParameter(&quot;@Name&quot;, adVarChar, adParamInput, 20, Worksheets(&quot;Sheet2&quot;).Cells(2, &quot;C&quot;).Value)         .Parameters.Append param         Set param2 = .CreateParameter(&quot;@Phone&quot;, adVarChar, adParamInput, 12, Worksheets(&quot;Sheet2&quot;).Cells(2, &quot;D&quot;).Value)         .Parameters.Append param2       .Execute     End With&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501165032, "post_id": 45332779, "comment_id": 77668179, "body": "I have modified the code per your instructions, i believe.  I posted the code in the original question, as it will not let me copy into the comment.  I click the button and i do not get an error but it does not insert the christopher 0123456789 into the table either."}, {"owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501167232, "post_id": 45332779, "comment_id": 77670004, "body": "I am further into it now.  I get the error object is already in collection, Cannot append.  When debugging it takes me to the second parrameters.append"}, {"owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501167453, "post_id": 45332779, "comment_id": 77670188, "body": "Sorry for all the updates.  Figured out the problem the second append param needed to be param2.  SO it now inserts into my table!  Thanks, on to changing the christopher to a cell.  I am sure there will be questions to come.  i am going to try using cell c4 and d4 respectively for the name and phone"}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "reply_to_user": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501185890, "post_id": 45332779, "comment_id": 77681492, "body": "Sorry I&#39;ve been out all day.  Are you ok now?  If so, please mark the question as answered.  Otherwise, leave a comment and I&#39;ll look at it overnight - its 10pm here (I&#39;m in Germany) and I am tired!"}, {"owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501196774, "post_id": 45332779, "comment_id": 77685945, "body": "Thanks for asking!  Just got it all figured out.  Thanks for the help!!!!"}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "reply_to_user": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "edited": false, "score": 0, "creation_date": 1501214198, "post_id": 45332779, "comment_id": 77689968, "body": "There should be a tick (check mark) next to my answer,  which is currently greyed out. If you mouse click it, it will change colour. It is more than a little irritating from SO to make it grey, sInce all new users assume that something which is grey is disabled. They often think you need reputation before it becomes available. Glad to know that you are fixed. Have a good day. Jonathan"}], "tags": [], "owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "is_accepted": true, "score": 0, "last_activity_date": 1501086919, "creation_date": 1501086919, "answer_id": 45332779, "question_id": 45328539, "link": "https://stackoverflow.com/questions/45328539/insert-into-table-from-excel-via-vb-button-to-stored-procedure-with-variables/45332779#45332779", "title": "Insert Into Table from Excel via VB button to stored procedure with Variables", "body": "<p>I hope I did not scare you with a request for VBA Code</p>\n\n<p>To give you an idea of what you should have:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim conn As ADODB.Connection\nDim cmd As ADODB.Command\nDim connStr As String\nDim param As ADODB.Parameter\nDim param2 As ADODB.Parameter\n\n    connStr = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;\" &amp; _\n    \"Initial Catalog=dbname;Data Source=servername\"\n\n    Set conn = New ADODB.Connection\n    conn.ConnectionString = connStr\n    conn.Open\n\n    Set cmd = New ADODB.Command\n    With cmd\n        .ActiveConnection = conn\n        .CommandType = adCmdStoredProc\n        .CommandText = \"AMC_GW_TESTSP\"\n        Set param = .CreateParameter(\"@name\", adVarChar, adParamInput, 20, \"Christopher\")\n        .Parameters.Append param\n        Set param2 = .CreateParameter(\"@phone\", adVarChar, adParamInput, 12, \"0123456789\")\n        .Parameters.Append param\n\n      .Execute\n    End With\n    conn.Close\n    Set cmd = Nothing\n    Set conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Things that you will have to change.  Firstly the connection string (connStr).  You will need to provide database name in place of dbname and server in place of servername.  Also this string is assuming that you are using Windows Authentication for your SQL Server.  If not you need to remove Integrated Security=SSPI; and in its place supply User ID=myUser;Password=myPassword;.\nNext you will notice that the last parameter in the .CreateParameter function is a fixed string (\"Christopher\" and \"0123456789\").  In your case, they should be variables taken from cells in the spreadsheet.  Please, please make sure that these strings do not contain \";\" before trying to Execute.  </p>\n\n<p>I hope this helps, but feel free to contact me, if anything is less than clear!</p>\n\n<p>PS You will need to make sure under Tools References, that you have the highest version of Microsoft ActiveX Data Objects Library checked (mine is 6.1, but anything 2.0 or higher definitely works).</p>\n"}], "owner": {"reputation": 7, "user_id": 6018568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205894492703308/picture?type=large", "display_name": "Gene Wilson", "link": "https://stackoverflow.com/users/6018568/gene-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 45332779, "answer_count": 1, "score": 0, "last_activity_date": 1501166357, "creation_date": 1501076014, "last_edit_date": 1501166357, "question_id": 45328539, "link": "https://stackoverflow.com/questions/45328539/insert-into-table-from-excel-via-vb-button-to-stored-procedure-with-variables", "title": "Insert Into Table from Excel via VB button to stored procedure with Variables", "body": "<p>I have a simple table <code>AMC_GW_TESTTABLE</code> with two columns, <em>name</em> nvarchar(20) and <em>phone</em> nvarchar(12).  I also have a simple stored procedure with two variables.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>create procedure AMC_GW_TESTSP (@name nvarchar(20),\n                                @phone nvarchar(12)) as\ninsert into AMC_GW_Testtable (name,phone)\nvalues (@name, @Phone)\n</code></pre>\n\n<p>I have been able to get a button in Excel to create the command:</p>\n\n<pre><code>exec dbo.amc_gw_testsp 'fred' '620-555-1212'\n</code></pre>\n\n<p>But it does not execute it.  I copy this to my SSMS exactly like it and execute it and it works fine.  Any ideas?</p>\n\n<p>VBA code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Button1_Click()\n\n    Dim conn As ADODB.Connection\n    Dim cmd As ADODB.Command\n    Dim connStr As String\n    Dim param As ADODB.Parameter\n    Dim param2 As ADODB.Parameter\n\n    connStr = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;\" _\n              &amp; \"Initial Catalog=am_app);Data Source=bcu-sql-01\"\n\n    Set conn = New ADODB.Connection\n    conn.ConnectionString = connStr\n    conn.Open\n\n    Set cmd = New ADODB.Command\n    With cmd\n        .ActiveConnection = conn\n        .CommandType = adCmdStoredProc\n        .CommandText = \"AMC_GW_TESTSP\"\n        Set param = .CreateParameter(\"@name\", adVarChar, adParamInput, 20, \"Christopher\")\n        .Parameters.Append param\n        Set param2 = .CreateParameter(\"@phone\", adVarChar, adParamInput, 12, \"0123456789\")\n        .Parameters.Append param\n\n      .Execute\n    End With\n\n    conn.Close\n    Set cmd = Nothing\n    Set conn = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 2, "creation_date": 1501075920, "post_id": 45328373, "comment_id": 77618545, "body": "You don&#39;t need VBA to achieve this. You may use Conditional Formatting for that."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1501076137, "post_id": 45328373, "comment_id": 77618712, "body": "@sktneer I would like to do with vba ,Could you help please"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1501078244, "post_id": 45328373, "comment_id": 77620509, "body": "You can define/alter conditional formatting built in Excel using VBA."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1501077971, "post_id": 45328978, "comment_id": 77620301, "body": "I don&#39;t find any changes when I type in the value, it remains the same"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1501078291, "post_id": 45328978, "comment_id": 77620540, "body": "The code will track any changes you make in columns G:P starting from Row7."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1501078469, "post_id": 45328978, "comment_id": 77620697, "body": "And even if you make the changes as I described above, make sure that the corresponding cell in column P is not empty. Since the code is comparing the inputs from column G:P with the input in corresponding cells in column P, it will only compare if the column P is not empty."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1501077157, "creation_date": 1501077157, "answer_id": 45328978, "question_id": 45328373, "link": "https://stackoverflow.com/questions/45328373/looking-through-the-columns-and-highlighting-the-row/45328978#45328978", "title": "looking through the columns and highlighting the row.", "body": "<p>I would still do this with the help of conditional formatting though applied through VBA as you insisted.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nDim lr As Long\nDim rng As Range\nIf Target.Row &gt;= 7 And Not Intersect(Target, Range(\"G:P\")) Is Nothing Then\n    lr = Cells(Rows.Count, \"U\").End(xlUp).Row\n    Set rng = Range(\"G7:U\" &amp; lr)\n    With rng\n        .FormatConditions.Delete\n        .FormatConditions.Add Type:=xlExpression, Formula1:= _\n            \"=AND(ROW($G7)&gt;=7,G7&lt;&gt;\"\"\"\",$U7&lt;&gt;\"\"\"\",MAX($G7:$P7)&gt;=$U7)\"\n        .FormatConditions(rng.FormatConditions.Count).SetFirstPriority\n        .FormatConditions(1).Interior.Color = 65535\n        .FormatConditions(1).StopIfTrue = False\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": false, "score": 0, "last_activity_date": 1501079280, "creation_date": 1501079280, "answer_id": 45329883, "question_id": 45328373, "link": "https://stackoverflow.com/questions/45328373/looking-through-the-columns-and-highlighting-the-row/45329883#45329883", "title": "looking through the columns and highlighting the row.", "body": "<p>Try this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Cells(Target.Row, 22).Value = \"x\" Or Application.Max(Target.Rows) &lt; Cells(Target.Row, 21) Then\n        Cells(Target.Row, 1).EntireRow.Interior.Color = xlNone\n    Else\n        Cells(Target.Row, 1).EntireRow.Interior.Color = vbRed\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1501079280, "creation_date": 1501075580, "question_id": 45328373, "link": "https://stackoverflow.com/questions/45328373/looking-through-the-columns-and-highlighting-the-row", "title": "looking through the columns and highlighting the row.", "body": "<p>I have a sheet \"Data\" and I am having the columns from G to P filled with Price. I have another column U in the same sheet which has the maximum price. (target price).</p>\n\n<p>I now, would like to check through each rows, and if any one of the column between G to P has an price more than the target price in my column U, then I want to highlight the complete row with red. </p>\n\n<p>I tried a code like below, but it dint work. Can anyone suggest, how I can look into each of the column and compare to the target and highlight. It would be great if you can comment the lines of your code. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim i As Integer\n\nFor i = 7 To 16\n    If Cells(Target.Row, 21).Value &lt;= Cells(Target.Row, i).Value Then\n        Target.EntireRow.Interior.Color = vbRed\n    End If\nNext i\n\nFor i = 7 To 16\n    If Cells(Target.Row, 21).Value &gt; Cells(Target.Row, i).Value Then\n        Target.EntireRow.Interior.ColorIndex = xlNone\n    End If\nNext i\n\n    If Cells(Target.Row, 22).Value = \"x\" Then\n        Target.EntireRow.Interior.ColorIndex = xlNone\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sharepoint", "kill"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501085612, "post_id": 45328350, "comment_id": 77626508, "body": "What does it do instead of working?  In the second example does the <code>DeleteFile</code> line actually run?"}, {"owner": {"reputation": 1, "user_id": 7775058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e67fe4a4fa02165939fb0f11e24271e?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyDutch", "link": "https://stackoverflow.com/users/7775058/johnnydutch"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501223448, "post_id": 45328350, "comment_id": 77693363, "body": "nothing. But I found code that does work: <a href=\"https://stackoverflow.com/questions/12955831/deleting-sharepoint-files-using-xmlhttp\" title=\"deleting sharepoint files using xmlhttp\">stackoverflow.com/questions/12955831/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 7775058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e67fe4a4fa02165939fb0f11e24271e?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyDutch", "link": "https://stackoverflow.com/users/7775058/johnnydutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501076641, "creation_date": 1501075512, "last_edit_date": 1501076641, "question_id": 45328350, "link": "https://stackoverflow.com/questions/45328350/kill-statement-does-not-work-in-sharepoint", "title": "Kill statement does not work in Sharepoint", "body": "<p>Calculations kept by users are stored as \"ToCheck...\" on sharepoint. Once checked the file is than renamed to \"Checked...\". I am trying to delete the now superfluous \"ToCheck...\" file.\nFirst this code:\n    Dim spMap As Object, spPath As String</p>\n\n<pre><code>Set spMap = CreateObject(\"WScript.Network\")\nspMap.MapNetworkDrive \"X:\", spPath\nDoEvents\n\nKill (Pad &amp; Naam)\n</code></pre>\n\n<p>.\n.</p>\n\n<p>and later other code from internet (after ticking in tools/references MS scripting)</p>\n\n<pre><code>Dim fs As New Scripting.FileSystemObject\nWith fs\n    If .FileExists(yourfilepath) Then\n        .DeleteFile yourfilepath\n    End If\nEnd With\n.\n.\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1501078056, "last_edit_date": 1501078056, "creation_date": 1501076656, "answer_id": 45328800, "question_id": 45328329, "link": "https://stackoverflow.com/questions/45328329/vba-how-to-paste-rows-on-another-sheet-so-they-include-formulas/45328800#45328800", "title": "VBA How to paste rows on another sheet, so they include formulas?", "body": "<p>Use <code>PasteSpecial</code> with <code>xlFormulas</code></p>\n\n<pre><code>Sub TransferRows()\nDim lLRow As Long\n\n    With Sheets(\"Sheet1\")\n        lLRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(\"B:B\").AutoFilter Field:=1, Criteria1:=\"Cat\"\n        .Range(\"B2:B\" &amp; lLRow).SpecialCells(xlCellTypeVisible).EntireRow.Copy\n        Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlFormulas\n        .AutoFilterMode = False\n    End With\n End Sub\n</code></pre>\n\n<p>Sheet1</p>\n\n<p><a href=\"https://i.stack.imgur.com/K6HQ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K6HQ5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet2 Output after running</p>\n\n<p><a href=\"https://i.stack.imgur.com/aHYNt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aHYNt.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 45328800, "answer_count": 1, "score": 0, "last_activity_date": 1501078056, "creation_date": 1501075453, "question_id": 45328329, "link": "https://stackoverflow.com/questions/45328329/vba-how-to-paste-rows-on-another-sheet-so-they-include-formulas", "title": "VBA How to paste rows on another sheet, so they include formulas?", "body": "<p>I am trying to cut and paste rows from one sheet to the other based on criteria in column B of the sheet1. Problem is I need them to be pasted with formulas on the other sheet and not values. Also since it is filtered the data is not continuous so I cannot cut but merely copy and paste onto the other sheet.</p>\n\n<p>Please help. PS. I'm not using loop because there's too much data, hence the filtering.</p>\n\n<pre><code>Sub TransferRows()\nDim lLRow As Long\n\n    With Sheets(\"Sheet1\")\n        lLRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(\"B:B\").AutoFilter Field:=1, Criteria1:=\"Cat\"\n        .Range(\"B2:B\" &amp; lLRow).SpecialCells(xlCellTypeVisible).EntireRow.Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        .AutoFilterMode = False\n    End With\n End Sub\n</code></pre>\n\n<p>How to copy or (ideally) cut and paste only visible cells (filtered) with formulas, based on a value in aforementioned column to another sheet?</p>\n\n<p>Thanks\nWest</p>\n"}, {"tags": ["excel", "vba", "select", "keyword", "directory"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1501075514, "post_id": 45328207, "comment_id": 77618224, "body": "You are using Excel, did you know? What kind of check buttons do you want?"}, {"owner": {"reputation": 29, "user_id": 8263339, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43fee262f510040b6938ba151ba48d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Irene94", "link": "https://stackoverflow.com/users/8263339/irene94"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1501117020, "post_id": 45328207, "comment_id": 77641221, "body": "Thanks for your reply! Actually I did not specify the types of the check button, as long as there is an option button to let me choose the folder that I want to process..."}, {"owner": {"reputation": 29, "user_id": 8263339, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43fee262f510040b6938ba151ba48d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Irene94", "link": "https://stackoverflow.com/users/8263339/irene94"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1501124406, "post_id": 45328207, "comment_id": 77642964, "body": "I already success to import the folder according to the keyword by adding [If Left(UCase(SubFolder.Name), 5) = Range(&quot;E2&quot;) Then] code, but I still din&#39;t have idea how to add the option button...."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8437903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3bHwN.jpg?s=128&g=1", "display_name": "Bla2", "link": "https://stackoverflow.com/users/8437903/bla2"}, "reply_to_user": {"reputation": 29, "user_id": 8263339, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43fee262f510040b6938ba151ba48d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Irene94", "link": "https://stackoverflow.com/users/8263339/irene94"}, "edited": false, "score": 0, "creation_date": 1502353999, "post_id": 45584366, "comment_id": 78175443, "body": "you&#39;re welcome and well done but you perhaps can says How you&#39;ve done it ?"}], "tags": [], "owner": {"reputation": 61, "user_id": 8437903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3bHwN.jpg?s=128&g=1", "display_name": "Bla2", "link": "https://stackoverflow.com/users/8437903/bla2"}, "is_accepted": false, "score": 0, "last_activity_date": 1502264210, "creation_date": 1502264210, "answer_id": 45584366, "question_id": 45328207, "link": "https://stackoverflow.com/questions/45328207/filter-folder-name/45584366#45584366", "title": "Filter Folder Name", "body": "<p>What about put some 'x' on the line you want to treat and then add a form (like circle or Square) and right click on it then \"link to a macro\" (In french \"Affecter une macro\").\nThis macro should have to parse the 'x' and do the job with the path.</p>\n\n<p>If you really want something more visual, take a look at userform and more in treeview, they have CheckBoxes possible. (Add control Microsoft treeview Control, version Xx)</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 8263339, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43fee262f510040b6938ba151ba48d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Irene94", "link": "https://stackoverflow.com/users/8263339/irene94"}, "is_accepted": true, "score": 0, "last_activity_date": 1502419688, "creation_date": 1502419688, "answer_id": 45626168, "question_id": 45328207, "link": "https://stackoverflow.com/questions/45328207/filter-folder-name/45626168#45626168", "title": "Filter Folder Name", "body": "<p>For the filter folder name part, I used </p>\n\n<pre><code> For Each SubFolder In prntfld.SubFolders    \n     If Left(UCase(Folder.Name), 5) = Range(\"E2\") Then\n     'your code here\n     End If\nNext SubFolder\n</code></pre>\n\n<p>For Each loop will loop through all the subfolders in the selected folder, and If...Then syntax helps to filter the folder according to the keyword, from the code above, the keyword should enter at the Range E2.  </p>\n\n<p>For the checklist part, I used</p>\n\n<pre><code>    counter = counter + 1\n    Range(\"C\" &amp; counter).Value = \"Yes\"  'set the default value\n        With Range(\"C\" &amp; counter).Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlBetween, Formula1:=\"Yes,No\"\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .InputTitle = \"\"\n            .ErrorTitle = \"\"\n            .ErrorMessage = \"\"\n            .ShowInput = True\n            .ShowError = True\n        End With\n</code></pre>\n\n<p>Of course, this should put in a loop in order to ensure the number of counter will increase.\nHope this could helps someone that having the same problem!  </p>\n"}], "owner": {"reputation": 29, "user_id": 8263339, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/43fee262f510040b6938ba151ba48d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Irene94", "link": "https://stackoverflow.com/users/8263339/irene94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 45626168, "answer_count": 2, "score": 0, "last_activity_date": 1502419688, "creation_date": 1501075098, "question_id": 45328207, "link": "https://stackoverflow.com/questions/45328207/filter-folder-name", "title": "Filter Folder Name", "body": "<p>currently I am having a folder which contains many folders\nExample : \n<code>\nA01\nA02\nA03\nA04\nB01\nB02\nB03</code></p>\n\n<p>I need only folder A01 to A04 comes out when I enter \"A\" in range B3, and so when I enter \"B\", only folder B01 to B03 will be shown. Can the folder name and folder path show in a checklist? And only the folder which is ticked will be process(I have other code to process the data)/ import after \"OK\" is pressed.</p>\n\n<pre><code>Sub FolderNames()\nApplication.ScreenUpdating = False\nDim xPath As String\nDim xWs As Worksheet\nDim fso As Object, j As Long, folder1 As Object\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the folder\"\n    .Show\nEnd With\nOn Error Resume Next\nxPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1) &amp; \n\"\\\"\n'Application.Workbooks.Add\nSet xWs = Application.ActiveSheet\nxWs.Cells(1, 1).Value = xPath\nxWs.Cells(2, 1).Resize(1, 2).Value = Array(\"Path\", \"Name\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet folder1 = fso.getFolder(xPath)\ngetSubFolder folder1\nxWs.Cells(2, 1).Resize(1, 2).Interior.Color = RGB(194, 244, 238)\nxWs.Cells(2, 1).Resize(1, 2).EntireColumn.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\n\nSub getSubFolder(ByRef prntfld As Object)\nDim SubFolder As Object\nDim subfld As Object\nDim xRow As Long\nFor Each SubFolder In prntfld.SubFolders\nxRow = Range(\"A1\").End(xlDown).Row + 1\nCells(xRow, 1).Resize(1, 2).Value = Array(SubFolder.Path, SubFolder.Name)\nNext SubFolder\n\nEnd Sub\n</code></pre>\n\n<p>This is the code I have currently, it will show all the folder name and the folder path in cells but not checklist.\nAny help and advise is appreciated.\nThanks!</p>\n"}, {"tags": ["vba", "outlook", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1501210392, "creation_date": 1501210392, "answer_id": 45364091, "question_id": 45327812, "link": "https://stackoverflow.com/questions/45327812/using-body-activedocument-to-pull-in-only-a-portion-of-a-word-document/45364091#45364091", "title": "Using .body = ActiveDocument. to pull in only a portion of a Word document", "body": "<p>the <code>.Body</code> property contains a string. <code>ActiveDocument.Content</code> is a string which comprises the entire document. Technically, any smaller part of the document is also a string. Therefore you can pick any part of the document and assign it to the <code>.Body</code> property.\nThis link may help you pick the part of the document you wish to include in your email. <a href=\"https://stackoverflow.com/questions/45351308/vba-to-copy-text-from-excel-to-on-specific-location-in-wordfile\">VBA to copy text from excel to on specific location in wordfile</a>\nThe code to use would be</p>\n\n<pre><code>Dim Rng As Range\nDim Excerpt As String\n\n' Find the range with guidance from the above link\nExcerpt = Rng.Text\nEmailItem.Body = Excerpt\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593157456, "creation_date": 1501074111, "last_edit_date": 1593157456, "question_id": 45327812, "link": "https://stackoverflow.com/questions/45327812/using-body-activedocument-to-pull-in-only-a-portion-of-a-word-document", "title": "Using .body = ActiveDocument. to pull in only a portion of a Word document", "body": "<p>As you can see from the code (tied to a command button in a Word 2016 document) I have right now, the command button will:</p>\n\n<ol>\n<li>launch/display an email</li>\n<li>Adds ALL the document contents to the body of an email (via .Body = ActiveDocument.Content)</li>\n<li>Attach the Word doc</li>\n</ol>\n\n<p>Question: Is there a way to only pull in portions of the document content into the body? Basically, I have a form that will be filled out by employees. After (below) the form, there are some instructions on how to complete the form, some definitions, and other administrative information that I would rather NOT be pulled into the body of the email.</p>\n\n<p>Current code:</p>\n\n<pre><code>Dim OL   As Object\nDim EmailItem   As Object\nDim Doc   As Object\n\nApplication.ScreenUpdating = False\n\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\n\nDoc.Save\n\nWith EmailItem\n    .Subject = \"test subject line\"\n    .Body = ActiveDocument.Content\n    .To = \"myemail@email.com\"\n    .Importance = olImportanceNormal\n    .Attachments.Add Doc.FullName\n    .Display\nEnd With\n\nApplication.ScreenUpdating = True\n\nSet Doc = Nothing\nSet OL = Nothing\nSet EmailItem = Nothing\n</code></pre>\n"}, {"tags": ["vba", "web-scraping", "web-crawler"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1501075323, "post_id": 45327768, "comment_id": 77618082, "body": "First thing that comes to my mind is you can add the links to a dictionary. Before getting the output, check if they exist or not."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501075837, "post_id": 45327768, "comment_id": 77618473, "body": "Thanks Tehscript for your comment. I&#39;m not that familiar with dictionary usage. I did find a workaround but that is not what I want. Gonna paste a link in my post."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501083788, "post_id": 45327768, "comment_id": 77625144, "body": "Hi Tehscript, maintaining your suggestion I tried to use dictionary in my script and it is giving me perfect results. However the problem is I can&#39;t rearrange my script to give a better look. Here is a link FYC : &quot;<a href=\"https://www.dropbox.com/s/n3668q9da9u8qr4/Rmoving%20duplicates%20with%20dictionary%20in%20vba..txt?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/n3668q9da9u8qr4/&hellip;</a>&quot;"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501089101, "post_id": 45327768, "comment_id": 77628852, "body": "You don&#39;t have to loop two times. When you check if it exits or not in dictionary, you can both add the link to dictionary and write it to cell at the same time."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501089874, "post_id": 45327768, "comment_id": 77629364, "body": "This is the best I could think of  from my shallow knowledge &quot;<a href=\"https://www.dropbox.com/s/n3668q9da9u8qr4/Rmoving%20duplicates%20with%20dictionary%20in%20vba..txt?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/n3668q9da9u8qr4/&hellip;</a>&quot;"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501090422, "post_id": 45327768, "comment_id": 77629709, "body": "No, not like that. I can send it as an answer when I&#39;m home."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501090498, "post_id": 45327768, "comment_id": 77629759, "body": "Thanks Tehscript. Eagerly waiting for that very moment."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501096150, "post_id": 45327768, "comment_id": 77632932, "body": "The site &quot;<a href=\"https://yts.ag/browse-movies\" rel=\"nofollow noreferrer\">yts.ag/browse-movies</a>&quot; is not responding?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501096855, "post_id": 45327768, "comment_id": 77633316, "body": "There is an inverted comma coming along with that link. Try here: &quot;<a href=\"https://yts.ag/browse-movies\" rel=\"nofollow noreferrer\">yts.ag/browse-movies</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1501098369, "post_id": 45335805, "comment_id": 77634206, "body": "Thanks Tehscript. It works as you said. Btw, is it necessary to keep this part &quot;, &quot;whatever information you would like to store&quot;&quot;. I tried to take out but was having error. Thanks again."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1501099476, "post_id": 45335805, "comment_id": 77634819, "body": "Hehe. A dictionary consists of a key and a value. To demonstrate <code>dict = {&quot;numberofapples&quot;:30,&quot;yourname&quot;:&quot;SMth80&quot;,&quot;yourparsedwebsite&quot;&zwnj;&#8203;:&quot;https:&#47;&#47;yts.ag&#47;bro&zwnj;&#8203;wse-movies&quot;}</code>. In the above example, your key holds <code>post.href</code> and you can assign a value to this key. It might be <code>x</code>, it might be another information from the website related to <code>post.href</code>, or you can set it to any constant value like <code>1</code>, <code>&quot;Hello&quot;</code>, or <code>&quot;whatever information you would like to store&quot;</code>."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1501099479, "post_id": 45335805, "comment_id": 77634821, "body": "As long as you set it to something it is fine because a key has to have a value. The question is, are you going to use this value later on? For the time being, the part that interests you is the <code>Key</code>, not the <code>Value</code>. But later on your code, you might want to extract <code>Value</code> from the corresponding <code>Key</code>. I hope it helps."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1501101568, "post_id": 45335805, "comment_id": 77635970, "body": "Thanks for the clarity."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1501219180, "post_id": 45335805, "comment_id": 77691368, "body": "Hi Tehscript! In your spare time, please follow the link &quot;<a href=\"https://stackoverflow.com/questions/45362363/how-to-get-all-the-links-leading-to-the-next-page\" title=\"how to get all the links leading to the next page\">stackoverflow.com/questions/45362363/&hellip;</a>&quot;"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 1, "last_activity_date": 1501097129, "creation_date": 1501097129, "answer_id": 45335805, "question_id": 45327768, "link": "https://stackoverflow.com/questions/45327768/how-to-shake-off-duplicate-links-while-parsing-web-data/45335805#45335805", "title": "How to shake off duplicate links while parsing web-data?", "body": "<p>I couldn't make the site work. Anyways, the proper way to use dictionary to eliminate duplicates and write to cells inside the same loop should look something like this:</p>\n\n<pre><code>For Each Post In html.getElementsByClassName(\"tsc_pagination\")(0).getElementsByTagName(\"a\")\n    If InStr(Post.href, \"page\") &gt; 0 Then\n        If Not dict.Exists(Post.href) Then\n            dict.Add Post.href, \"whatever information you would like to store\"\n            x = x + 1\n            Cells(x, 1) = Post.href\n        End If\n    End If\nNext Post\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45335805, "answer_count": 1, "score": 1, "last_activity_date": 1501097129, "creation_date": 1501074013, "last_edit_date": 1501076082, "question_id": 45327768, "link": "https://stackoverflow.com/questions/45327768/how-to-shake-off-duplicate-links-while-parsing-web-data", "title": "How to shake off duplicate links while parsing web-data?", "body": "<p>I've written some script in vba to parse the links leading to the next page from a torrent site. My script is able to scrape them. However, the issue I'm facing is that couple of duplicate links coming along in the result. My question is whether there is any technique with which I can parse only the unique links?</p>\n\n<pre><code>Sub TorrentData()\n    Dim http As New XMLHTTP60, html As New HTMLDocument, post As Object\n\n    With http\n        .Open \"GET\", \"https://yts.ag/browse-movies\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    For Each post In html.getElementsByClassName(\"tsc_pagination\")(0).getElementsByTagName(\"a\")\n        If InStr(post, \"page\") &gt; 0 Then\n           x = x + 1: Cells(x, 1) = post.href\n        End If\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Partial picture of the scraped links:</p>\n\n<p><a href=\"https://i.stack.imgur.com/82dX8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/82dX8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Be sure to check the link before proceeding:\n\"<a href=\"https://www.dropbox.com/s/647x3m65u90a1bu/Description1.txt?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/647x3m65u90a1bu/Description1.txt?dl=0</a>\"</p>\n"}, {"tags": ["excel", "vba", "dynamic", "filtering", "highlight"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "edited": false, "score": 0, "creation_date": 1501147452, "post_id": 45328232, "comment_id": 77654259, "body": "Thank you for the code! This seems to work with my code, however, there is a slight issue. For me, the characters only become red IF I double click the cell (A1). I want to see this in action real time. Also, for some reason, if I delete the text the characters remain red. Any solution for these? :) Otherwise, really nice!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "edited": false, "score": 0, "creation_date": 1501343900, "post_id": 45328232, "comment_id": 77743033, "body": "@llorcs - to see action in &quot;real time&quot;, remove this line from the code:     <code>If Target &lt;&gt; Range(&quot;a1&quot;) Then Exit Sub</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "edited": false, "score": 0, "creation_date": 1501344722, "post_id": 45328232, "comment_id": 77743294, "body": "Concerning the empty cell, which makes all the values in red, there are about 10 ways to resolve this problem. One of them is to add <code>If strValue = vbNullString Then Exit Sub</code> in the code. I have added it. @llorcs"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1501344647, "last_edit_date": 1501344647, "creation_date": 1501075174, "answer_id": 45328232, "question_id": 45327507, "link": "https://stackoverflow.com/questions/45327507/dynamic-search-with-highlight-excel-vba/45328232#45328232", "title": "Dynamic Search with highlight - Excel VBA", "body": "<p>Consider something like this - Write in a worksheet the following:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Count &gt; 1 Then Exit Sub\n    If Target &lt;&gt; Range(\"a1\") Then Exit Sub\n    SelectAndChange (Target)\n\nEnd Sub\n\nPrivate Sub SelectAndChange(strValue As String)\n\n    Dim rngCell     As Range\n    Dim rngRange    As Range\n    Dim strLookFor  As String\n    Dim arrChar     As Variant\n    Dim lngCounter  As Long\n\n    If strValue = vbNullString Then Exit Sub\n\n    Application.EnableEvents = False\n\n    Set rngRange = Range(\"E1:E10\")\n    rngRange.Font.Color = vbBlack\n    strLookFor = Range(\"A1\").Value\n\n    For Each rngCell In rngRange\n        For lngCounter = 1 To Len(rngCell) - Len(strLookFor) + 1\n            If Mid(rngCell, lngCounter, Len(strLookFor)) = strLookFor Then\n                rngCell.Characters(lngCounter, Len(strLookFor)).Font.Color = vbRed\n            End If\n        Next lngCounter\n    Next rngCell\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>The values in <code>E1:E10</code> would be dependent from the value in <code>A1</code> like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aH62H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aH62H.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1612755879, "creation_date": 1501073400, "question_id": 45327507, "link": "https://stackoverflow.com/questions/45327507/dynamic-search-with-highlight-excel-vba", "title": "Dynamic Search with highlight - Excel VBA", "body": "<p>I would like to achieve the following:\nIn my excel sheet I have a set of data to which I've applied dynamic filtering by creating a \"Search box\".\nThe filtering itself works okay, no problems there, however, I would like to further improve it, by highlighting the text (that is entered into the search box) in the filtered rows in red.\nI am attaching a screenshot of what I would like to see in the final version.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4C03X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4C03X.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any idea how this can be entered into my current code?</p>\n\n<p>As always, any help is greatly appreciated!\nThank you!</p>\n\n<p>Below is the code I use for the dynamic filtering:</p>\n\n<pre><code>Private Sub TextBox1_Change()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n\nIf Len(TextBox1.Value) = 0 Then\n    Sheet1.AutoFilterMode = False\nElse\n    If Sheet1.AutoFilterMode = True Then\n        Sheet1.AutoFilterMode = False\n        End If\n\n    Sheet1.Range(\"B4:C\" &amp; Rows.Count).AutoFilter field:=1, Criteria1:=\"*\" &amp; TextBox1.Value &amp; \"*\"\n\n    End If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 3169822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYNsr.png?s=128&g=1", "display_name": "user3169822", "link": "https://stackoverflow.com/users/3169822/user3169822"}, "is_accepted": true, "score": 0, "last_activity_date": 1501088001, "creation_date": 1501088001, "answer_id": 45333104, "question_id": 45326850, "link": "https://stackoverflow.com/questions/45326850/save-file-created-by-javascript-ie-using-vba/45333104#45333104", "title": "Save File created by Javascript IE using vba", "body": "<p>I chose to use chrome and found that javascript sends information byurl, so I used the following logic</p>\n\n<pre><code>Sub test()\nDim chromePath, PN As String\nDim Linha As Integer\nchromePath = \"\"\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"\"\"\nLinha = 2\nCells(Linha, \"A\").Select\nDo While ActiveCell &lt;&gt; \"\"\n    PN = Cells(Linha, \"A\").Value\n    strURL = \"http://cdroyal4.cdzodiac.com/cgi-bin/wspd_cgi.sh/WService=wslive/wpt/function.r?funct=print.pl&amp;drawing-no=\" &amp; PN &amp; \"&amp;prelim=no&amp;rev=N%2FC&amp;filename=\" &amp; PN\n    Shell (chromePath &amp; strURL)\n    Linha = Linha + 1\n    Cells(Linha, \"A\").Select\nLoop\n\nMsgBox \"Complete\", vbInformation, \"Empresa\"\nEnd Sub\n</code></pre>\n\n<p>With Chrome the download is done automatically, resulting in the expected result.\nThanks to all who have reviewed</p>\n"}], "owner": {"reputation": 123, "user_id": 3169822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYNsr.png?s=128&g=1", "display_name": "user3169822", "link": "https://stackoverflow.com/users/3169822/user3169822"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 45333104, "answer_count": 1, "score": -1, "last_activity_date": 1501088001, "creation_date": 1501071650, "last_edit_date": 1501072076, "question_id": 45326850, "link": "https://stackoverflow.com/questions/45326850/save-file-created-by-javascript-ie-using-vba", "title": "Save File created by Javascript IE using vba", "body": "<p>I have a routine that logs in and calls a script from the page where you are logged in, but this report is available to save from the internet and I need it saved automatically without user intervention.</p>\n\n<pre><code>Sub ConnectWeb()\nDim ie As InternetExplorer\nDim C\nDim ULogin As Boolean, ieForm\nDim MyPass As String, MyLogin As String\nDim Linha As Integer\nDim PN As String\nMyLogin = Application.InputBox(\"Por Favor entre com o Login\", \"Empresa\", Default:=\"User\", Type:=2)\nMyPass = Application.InputBox(\"Por favor entre com a senha\", \"Empresa\", Default:=\"Password\", Type:=2)\n\nSet ie = New InternetExplorer\nie.Visible = True\nie.Navigate \"http://url\"\nDo Until ie.ReadyState = READYSTATE_COMPLETE\nLoop\nie.Document.all(\"cuser\").innerText = MyLogin\nie.Document.all(\"cpass\").innerText = MyPass\nie.Document.getElementById(\"cent\").Value = \"BR\"\n\nie.Document.forms(0).submit\nDo While ie.Busy\n   DoEvents\nLoop\n    PN = \"D515005-5304\"\n'JavaScript to create file\n    ie.Document.parentWindow.execScript (\"printPL('\" &amp; PN &amp;         \"','N%2FC','no')\")\n\n\nEnd Sub\n</code></pre>\n\n<p>After the Java script call appears the message with the file generated and the option of Internet Explorer Save, at the moment I need the file to be saved automatically, and preferably in a specific path.</p>\n\n<p>Since then, thanks for the help.</p>\n"}, {"tags": ["sql", "vba", "recordset"], "comments": [{"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1501073281, "post_id": 45326791, "comment_id": 77616445, "body": "<code>Insert Into NewTablename (column, column1, etc) Select column, column1 From OldTablename</code>"}, {"owner": {"reputation": 33, "user_id": 6256054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5478717a9605f5b6383f4d797a833c92?s=128&d=identicon&r=PG&f=1", "display_name": "Kushant Vyas", "link": "https://stackoverflow.com/users/6256054/kushant-vyas"}, "reply_to_user": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1501086512, "post_id": 45326791, "comment_id": 77627187, "body": "My old table is encrypted and divided in many tables and using an external tool I am able to query data but it is retrieved in this recordset. Now I want to create another table from this recordset. I can create table manually or using script, but how do I insert recordset in new table."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1501142909, "post_id": 45326791, "comment_id": 77651016, "body": "It depends a little bit on your setup. If you have access to <code>BULK INSERT</code>, then I suppose the fastest way would be to create a <code>CSV</code> file and insert from that. Otherwise, you could add your extracted data one row at a time."}], "owner": {"reputation": 33, "user_id": 6256054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5478717a9605f5b6383f4d797a833c92?s=128&d=identicon&r=PG&f=1", "display_name": "Kushant Vyas", "link": "https://stackoverflow.com/users/6256054/kushant-vyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501072822, "creation_date": 1501071517, "last_edit_date": 1501072822, "question_id": 45326791, "link": "https://stackoverflow.com/questions/45326791/add-recorddset-to-sql-table", "title": "Add recorddset to sql table", "body": "<p>I have a recordset and I want to copy this in new table in sql using VB Script. new table should be created as per recordset only. Someone has examples?</p>\n\n<p>I know how to create new table but how to copy entire recordset to this table. I have something like following code and my recordset is retrieved in oRs variable.</p>\n\n<pre><code>Set oRs = CreateObject(\"ADODB.Recordset\")\n\nSet oCom = CreateObject(\"ADODB.Command\")\n\noCom.CommandText = \"my command text\"\n\nSet oRs = oCom.Execute\n</code></pre>\n\n<p>Kbv.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1501072552, "post_id": 45326788, "comment_id": 77615827, "body": "do you have information in other cells in <code>Leave Records</code>?"}, {"owner": {"reputation": 7, "user_id": 3715883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a918f5caa8743896dd3257a39eaeb931?s=128&d=identicon&r=PG", "display_name": "Knargle", "link": "https://stackoverflow.com/users/3715883/knargle"}, "reply_to_user": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1501072827, "post_id": 45326788, "comment_id": 77616063, "body": "Yeah, I need it to select and copy ONLY column B, from B2 down to the first blank cell (not including the blank cell). @paulinhax"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 3715883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a918f5caa8743896dd3257a39eaeb931?s=128&d=identicon&r=PG", "display_name": "Knargle", "link": "https://stackoverflow.com/users/3715883/knargle"}, "edited": false, "score": 0, "creation_date": 1501074318, "post_id": 45327432, "comment_id": 77617243, "body": "Perfect! Thanks :)"}], "tags": [], "owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "is_accepted": true, "score": 0, "last_activity_date": 1501073183, "creation_date": 1501073183, "answer_id": 45327432, "question_id": 45326788, "link": "https://stackoverflow.com/questions/45326788/excel-vba-how-to-select-range-down-to-first-blank-cell/45327432#45327432", "title": "Excel VBA - How to select Range down to first blank cell", "body": "<p>If I understood it correctly, you can try something like this:</p>\n\n<pre><code>Sub CopyToFirstBlankCell()\nDim bookingWS As Worksheet, mainWS As Worksheet\nDim copyRng As Range\nDim lastrow As Long\n\nSet bookingWS = Sheets(\"Leaves Records\")\nSet mainWS = Sheets(\"Old Records\")\n\nlastrow = bookingWS.Cells(Rows.Count, \"B\").End(xlUp).Row\n\nSet copyRng = bookingWS.Range(\"B2:B\" &amp; lastrow)\n\nmainWS.Range(\"B2:B\" &amp; copyRng.Rows.Count + 1).Insert Shift:=xlDown\ncopyRng.Copy mainWS.Range(\"B2\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1501074118, "creation_date": 1501074118, "answer_id": 45327813, "question_id": 45326788, "link": "https://stackoverflow.com/questions/45326788/excel-vba-how-to-select-range-down-to-first-blank-cell/45327813#45327813", "title": "Excel VBA - How to select Range down to first blank cell", "body": "<p>Here's simple code that copies cells until it comes upon empty one :)</p>\n\n<pre><code>Dim i As Integer\ni = 2\nDo While Not IsEmpty(Sheets(\"Leaves Records\").Cells(i, 2)) 'it'll iterate through B column\n    Sheets(\"Old Records\").Cells(i, 2).Value = Sheets(\"Leaves Records\").Cells(i, 2).Value\n    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3715883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a918f5caa8743896dd3257a39eaeb931?s=128&d=identicon&r=PG", "display_name": "Knargle", "link": "https://stackoverflow.com/users/3715883/knargle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2221, "favorite_count": 0, "accepted_answer_id": 45327432, "answer_count": 2, "score": 0, "last_activity_date": 1501074118, "creation_date": 1501071512, "question_id": 45326788, "link": "https://stackoverflow.com/questions/45326788/excel-vba-how-to-select-range-down-to-first-blank-cell", "title": "Excel VBA - How to select Range down to first blank cell", "body": "<p>I'm struggling to write the code for a Macro on Excel. Any help greatly appreciated :)</p>\n\n<p>Currently my code selects the range C6:C10 in 'Leaves Records' and inserts at B2 in 'Old Records', shifting all cells down. I want to do exactly the same thing but instead of copying C6:C10, I want to copy ALL cells in 'Leaves Records' from B2 down to the first blank cell in Column B.</p>\n\n<p>This is the code I have (which copies C6:C10):</p>\n\n<pre><code>Sub CopyToFirstBlankCell()\nDim bookingWS As Worksheet, mainWS As Worksheet\nDim copyRng As Range\n\nSet bookingWS = Sheets(\"Leaves Records\")\nSet mainWS = Sheets(\"Old Records\")\nSet copyRng = bookingWS.Range(\"C6:C10\")\n\nmainWS.Range(\"B2:B\" &amp; copyRng.Rows.Count + 1).Insert Shift:=xlDown\ncopyRng.Copy mainWS.Range(\"B2\")\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501071072, "post_id": 45326514, "comment_id": 77614697, "body": "Change this ws.Range(&quot;Z&quot; &amp; i) = &quot;PSW Ontime&quot;  to Ucase(ws.Range(&quot;Z&quot; &amp; i)) = UCase(&quot;Ontime&quot;)  Check if that helps you"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501071190, "post_id": 45326514, "comment_id": 77614766, "body": "Or replace ws.Range(&quot;Z&quot; &amp; i) = &quot;PSW Ontime&quot; by Instr(Ucase(ws.Range(&quot;Z&quot; &amp; i)),Ucase(&quot;PSW Ontime&quot;) = True"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1501071382, "post_id": 45326514, "comment_id": 77614929, "body": "You are using the If and Else If incorrectly, according to your logical problem"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501071630, "post_id": 45326514, "comment_id": 77615091, "body": "@nishitdey can you show me an sample how to use ?"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1501071659, "post_id": 45326514, "comment_id": 77615113, "body": "@danieltakeshi how do I , Do it then ? any sample ?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1501071926, "post_id": 45326514, "comment_id": 77615338, "body": "<a href=\"https://stackoverflow.com/questions/637980/if-else-and-if-elseif\">stackoverflow.com/questions/637980/if-else-and-if-elseif</a> When you use: If (condition 1) Then (action1) ElseIf (condition2) Then (action 2) [...] ElseIf(condition n) Then (action n) End If, you are not making what you want, which is just: If (condition1 And condition2 And [...] condition n) Then (actions) End If"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501072027, "post_id": 45326514, "comment_id": 77615429, "body": "@Jenny change the if condition in the code inside the  FOR LOOP  If ws.Range(&quot;AA&quot; &amp; i) &lt;&gt; &quot;&quot; And  Instr(Ucase(ws.Range(&quot;Z&quot; &amp; i)),Ucase(&quot;PSW Ontime&quot;) = True Then"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501074380, "post_id": 45326514, "comment_id": 77617300, "body": "@nishitdey I get an error in the loop, &quot;next without for &quot;"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501074799, "post_id": 45326514, "comment_id": 77617641, "body": "@nishitdey I solved and got the output :) thank you"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501070774, "creation_date": 1501070774, "question_id": 45326514, "link": "https://stackoverflow.com/questions/45326514/counting-the-value-and-pasting-in-another-sheet-based-on-the-cases", "title": "Counting the value and pasting in another sheet based on the Cases", "body": "<p>I have sheet \"BW\" and another sheet \"Result\". The sheet result has an Table with the weeknumber in column A. </p>\n\n<p>I wanted to look for the weeknumber in sheet \"result\" and if the weeknumber is the same as the Weeknumber in my sheet \"BW\" in column \"AX\" then , I would like to count the number of \"1\"  in the sheet \"BW\" in column \"T\" and \"u\". </p>\n\n<p>But the problem is I have two cases for the counting of \"1\" in Column T and U</p>\n\n<ol>\n<li>The column AA should not be equal to null. </li>\n<li>The column Z should Contain \"Ontime\". </li>\n</ol>\n\n<p>If these two case satisfies, then I would like to look into the column T and U and wount count for the 1 in the column. </p>\n\n<p>I tried the code. But the case is not getting satisfied. Any lead would be helpful. </p>\n\n<pre><code>Sub results()\n\nDim i As Integer, j As Integer, cntT As Integer, cntu As Integer, ws As Worksheet\nSet ws = Sheets(\"Result\")\nSheets(\"BW\").Select\nFor i = 2 To WorksheetFunction.CountA(ws.Columns(1))\ncntT = 0\ncntu = 0\nIf ws.Range(\"A\" &amp; i) = Val(Format(Now, \"ww\")) Then Exit For\nNext i\n\nFor j = 5 To WorksheetFunction.CountA(Columns(50))\n\nIf ws.Range(\"AA\" &amp; i) &lt;&gt; \"\" And ws.Range(\"Z\" &amp; i) = \"PSW Ontime\" Then\nElseIf ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"T\" &amp; j) = 1 Then cntT = cntT + 1\nElseIf ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"U\" &amp; j) = 1 Then cntu = cntu + 1\n\nNext j\nIf cntT &lt;&gt; 0 Then ws.Range(\"B\" &amp; i) = cntT\nIf cntu &lt;&gt; 0 Then ws.Range(\"C\" &amp; i) = cntu\nIf cntT + cntu &lt;&gt; 0 Then\nws.Range(\"D\" &amp; i) = cntT + cntu\nws.Range(\"E\" &amp; i) = cntT / (cntT + cntu)\nws.Range(\"F\" &amp; i) = cntu / (cntT + cntu)\nEnd If\n\nws.Range(\"E\" &amp; i &amp; \":F\" &amp; i).NumberFormat = \"0%\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2F0RZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2F0RZ.png\" alt=\"This how my sheet &quot;BW&quot; look like. The first row is the column name reference. I would like to look for the column &quot;aX&quot; and then check for column &quot;AA&quot; and &quot;Z&quot; and then count the number of 1 in column T and U.\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ffjC1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ffjC1.png\" alt=\"This is the sample of my sheet2, it has an table. so it looks for the weeknumber in my sheet &quot;BW&quot; and if it is 30, then paste the count values in the columns accordingly\"></a></p>\n\n<p>Could someone help me , how I can introduce this case in my code. </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1501071251, "creation_date": 1501071251, "answer_id": 45326702, "question_id": 45326076, "link": "https://stackoverflow.com/questions/45326076/import-txt-to-a-worksheet-and-name-it-with-the-txt-file-name/45326702#45326702", "title": "Import *txt to a Worksheet and name it with the *txt file name", "body": "<p>Add a line of code after the add line</p>\n\n<pre><code>Set ws = Sheets.Add\nws.Name = strFile \nWith ws.QueryTables.Add(...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": true, "score": 0, "last_activity_date": 1501071283, "creation_date": 1501071283, "answer_id": 45326717, "question_id": 45326076, "link": "https://stackoverflow.com/questions/45326076/import-txt-to-a-worksheet-and-name-it-with-the-txt-file-name/45326717#45326717", "title": "Import *txt to a Worksheet and name it with the *txt file name", "body": "<p>After \"End With\", try that:</p>\n\n<pre><code>Set ws = ThisWorkbook.ActiveSheet\nws.Name = Left(srtFile, Len(srtFile) - Len(\".txt\"))\n\nsrtFile = Dir\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "is_accepted": false, "score": 0, "last_activity_date": 1501078564, "creation_date": 1501078564, "answer_id": 45329575, "question_id": 45326076, "link": "https://stackoverflow.com/questions/45326076/import-txt-to-a-worksheet-and-name-it-with-the-txt-file-name/45329575#45329575", "title": "Import *txt to a Worksheet and name it with the *txt file name", "body": "<p>Final code:    </p>\n\n<pre><code>Dim strFile As String\nDim ws As Worksheet\nstrFile = Dir(\"A:\\REPORTS\\2017\\*.txt\")\nDo While strFile &lt;&gt; vbNullString\nSet ws = Sheets.Add\nws.Name = strFile\nWith ws.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; \"A:\\REPORTS\\2017\\\" &amp; strFile, Destination:=Range(\"$A$1\"))\n        .Name = strFile\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 65001\n        .TextFileStartRow = 1\n        .TextFileParseType = xlFixedWidth\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 9)\n        .TextFileFixedColumnWidths = Array(14, 10, 6, 11, 43, 15, 33, 14, 1, 14, 16, 4, 13, 11, _\n        11, 10)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\nEnd With\nstrFile = Dir\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 45326717, "answer_count": 3, "score": 0, "last_activity_date": 1501078564, "creation_date": 1501069702, "last_edit_date": 1531161705, "question_id": 45326076, "link": "https://stackoverflow.com/questions/45326076/import-txt-to-a-worksheet-and-name-it-with-the-txt-file-name", "title": "Import *txt to a Worksheet and name it with the *txt file name", "body": "<p>I'm trying to make a macro that could import *txt files from a folder and I did it. Now I'm stuck on this:</p>\n\n<p>I need to name the worksheets with the same name as the *txt file. The actual code is importing as default names for new worksheets.</p>\n\n<pre><code>Sub ImportTXT()\n\n    Dim strFile As String\n    Dim ws As Worksheet\n    strFile = Dir(\"A:\\REPORTS\\2017\\*.txt\")\n    Do While strFile &lt;&gt; vbNullString\n    Set ws = Sheets.Add\n    With ws.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; \"A:\\REPORTS\\2017\\\" &amp; strFile, Destination:=Range(\"$A$1\"))\n            .Name = strFile\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 65001\n            .TextFileStartRow = 1\n            .TextFileParseType = xlFixedWidth\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = False\n            .TextFileTabDelimiter = True\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileColumnDataTypes = Array(9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 9)\n            .TextFileFixedColumnWidths = Array(14, 10, 6, 11, 43, 15, 33, 14, 1, 14, 16, 4, 13, 11, _\n            11, 10)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n    End With\n    strFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501070037, "post_id": 45326074, "comment_id": 77613980, "body": "so you want to find the smallest MIN? how do you calculate the MIN with these three variables?"}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501070310, "post_id": 45326074, "comment_id": 77614164, "body": "I just want to return the MIN, which is the last Column in the second image. So, for example (in the first image I put in client ID 111111, Currency EUR, and DE) I need this to return min 30."}, {"owner": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501070763, "post_id": 45326074, "comment_id": 77614483, "body": "do you already have code? can you post it?"}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501070867, "post_id": 45326074, "comment_id": 77614543, "body": "@AmirKrasnic edited, however code isn&#39;t necessary here. I&#39;m trying to do it through Excel functions."}, {"owner": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501071211, "post_id": 45326074, "comment_id": 77614784, "body": "I still do not get what you really want to do here, where in your code do you want the MIN to be returned and to where shall it be returned?"}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 449, "user_id": 7546121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e55c02d408dc1be17781f80be1fbec?s=128&d=identicon&r=PG&f=1", "display_name": "Amir Schnell", "link": "https://stackoverflow.com/users/7546121/amir-schnell"}, "edited": false, "score": 0, "creation_date": 1501071361, "post_id": 45326074, "comment_id": 77614912, "body": "@AmirKrasnic In this example I&#39;m not using VBA. I simply want to return the MIN from the Table in the second image by using the (Client ID, Currency, and Market) variables that are inputed in Table (first image). I tried using Index/Match and Vlookup, but since there are many different variables, it doesn&#39;t go through."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501071510, "post_id": 45326074, "comment_id": 77615007, "body": "Can you share the workbook template?"}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501072210, "post_id": 45326074, "comment_id": 77615547, "body": "@nishitdey <a href=\"https://drive.google.com/file/d/0B4sKjkAZVkt6YzVSUHFwQnRFVk0/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B4sKjkAZVkt6YzVSUHFwQnRFVk0/&hellip;</a>"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501076453, "post_id": 45326074, "comment_id": 77618988, "body": "@Nikoljs : Sheet cannot be accessed"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501077194, "post_id": 45326074, "comment_id": 77619606, "body": "YOu can use the database for this, it will be much easier"}], "owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501072254, "creation_date": 1501069700, "last_edit_date": 1501072254, "question_id": 45326074, "link": "https://stackoverflow.com/questions/45326074/vba-multiple-variable-search", "title": "VBA multiple variable search", "body": "<p>I'm trying to search through a large table that has many cases and return a value for it [I've tried Index/Match and Vlookup, but since there are many different Market variables, I can't get it to work]</p>\n\n<p>Template Link <a href=\"https://drive.google.com/file/d/0B4sKjkAZVkt6YzVSUHFwQnRFVk0/view?usp=sharing\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<p>Here is the main-input Excel table. The important factors in this table are \"Client ID, Currency, Market\" (input by user).</p>\n\n<p><a href=\"https://i.stack.imgur.com/WhXLL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WhXLL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Using these three variables, I want to search through this list, and return the MIN value in the main-input table. <strong>As you can see, there are certain cases where 2/3 of the variables are the same.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/tiTCB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tiTCB.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub komisijas_calc_Click()\n\n'Declare the variables\nDim klienta_nr As Long\nDim ISIN As String\nDim Cena As Double\nDim Skaits As Double\nDim Komisija As Double\nDim vk As String\nDim Summa As Double\nDim kSheet As Worksheet\n\nDim lngFirstRow As Long: lngFirstRow = 2\nDim lngLastRow  As Long\nDim lngCol      As Long: lngCol = 2\nDim lngCounter  As Long\nDim lngKom As Long: lngKom = 11\n\n\n\n\nSet kSheet = ThisWorkbook.Sheets(\"spec_klienti\")\n\n\nWith Worksheets(1)\n    lngLastRow = .Cells(.Rows.Count, lngCol).End(xlUp).Row\n\n    For lngCounter = lngFirstRow To lngLastRow\n\n    klienta_nr = Range(\"B\" &amp; lngCounter).Value\n    ISIN = Range(\"E\" &amp; lngCounter).Value\n    Cena = Range(\"H\" &amp; lngCounter).Value\n    Skaits = Range(\"I\" &amp; lngCounter).Value\n    vk = Range(\"D\" &amp; lngCounter).Value\n    Summa = Cena * Skaits\n\n\nSelect Case klienta_nr\n\n\n\n    Case 1\n                '(V\u0101cija, Francija, N\u012bderlandes, It\u0101lija, \u012arija) - 30 EUR MIN\n                If klienta_nr = 1 And (Left(ISIN, 2) = \"DE\" Or Left(ISIN, 2) = \"FR\" Or Left(ISIN, 2) = \"NL\" Or Left(ISIN, 2) = \"IT\" Or Left(ISIN, 2) = \"IE\") Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                If klienta_nr = 636092 And Komisija &lt;= 30 Then\n                    .Cells(lngCounter, lngKom) = 30\n                        End If\n\n\n                If klienta_nr = 1 And (Left(ISIN, 2) &lt;&gt; \"DE\" Or Left(ISIN, 2) &lt;&gt; \"FR\" Or Left(ISIN, 2) &lt;&gt; \"NL\" Or Left(ISIN, 2) &lt;&gt; \"IT\" Or Left(ISIN, 2) &lt;&gt; \"IE\") Then\n                    Komisija = Summa * 0.003\n                    If Komisija &gt;= 40 Then\n                        .Cells(lngCounter, lngKom) = 40\n                            End If\n                        End If\n\n\n    Case 2\n                '(V\u0101cija, Francija, N\u012bderlandes, It\u0101lija, \u012arija) - 30 EUR MIN\n                If klienta_nr = 2 And (Left(ISIN, 2) = \"DE\" Or Left(ISIN, 2) = \"FR\" Or Left(ISIN, 2) = \"NL\" Or Left(ISIN, 2) = \"IT\" Or Left(ISIN, 2) = \"IE\") Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                'Set 30 EUR Min\n                If klienta_nr = 2 And Komisija &lt;= 30 Then\n                    .Cells(lngCounter, lngKom) = 30\n                        End If\n\n                If klienta_nr = 2 And (Left(ISIN, 2) &lt;&gt; \"DE\" Or Left(ISIN, 2) &lt;&gt; \"FR\" Or Left(ISIN, 2) &lt;&gt; \"NL\" Or Left(ISIN, 2) &lt;&gt; \"IT\" Or Left(ISIN, 2) &lt;&gt; \"IE\") Then\n                    GoTo AllElseFails\n                        End If\n\n\nCase Else\n\n     AllElseFails:\n\n              'IP2, 0.03% komisija, 40 EUR/USD Max\n                If Right(vk, 1) = 1 Or Right(vk, 1) = 8 Then\n                    Komisija = Summa * 0.003\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n              'IP1, 0.1% komisija, 40 EUR/USD Max\n                If Right(vk, 1) = 7 Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                'Komisija MAX is 40, so anything &gt;=40 equals 40\n                If Komisija &gt;= 40 Then\n                    .Cells(lngCounter, lngKom) = 40\n                        End If\n            'End If\n  End Select\n Next lngCounter\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1501070808, "post_id": 45326012, "comment_id": 77614513, "body": "I suggest that you put some <code>debug.print Now &amp; &quot; : place in code&quot;</code> absolutely everywhere to understand where it lags exactly"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1501071359, "post_id": 45326012, "comment_id": 77614910, "body": "@ThomasG I appreciate what you are saying, I could use <code>vba.Timer</code> to find the lag, and (painful as it is) I might go back and do that - but I already have a solution... I just don&#39;t understand why the solution works, nor why pressing the Esc key speeds up the code."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1501071683, "post_id": 45326012, "comment_id": 77615135, "body": "I dont understand either and it&#39;s precisely to try to understand it that you should know on which instruction(s) it lags. Timer wont be any help here"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1501072703, "post_id": 45326012, "comment_id": 77615963, "body": "Point taken. Lemme revert back to my old code and not use Timer... um BTW why won&#39;t timer help (Returns a Single representing the number of seconds elapsed since midnight. SyntaxTimerRemarks In Microsoft Windows the Timer function returns fractional portions of a second)?"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 1, "creation_date": 1501073340, "post_id": 45326012, "comment_id": 77616498, "body": "using Timer here will be painfull as you need more instructions for each print. Doing a <code>Debug.print Now [place of code]</code> is much simpler and sufficient. its done in a couple of seconds"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1501073586, "post_id": 45326012, "comment_id": 77616703, "body": "Maybe the message loop is getting too heavy or is locked by another thread. Try to add some <code>Application.DoEvents</code> to see if it changes anything."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1501075547, "post_id": 45326012, "comment_id": 77618250, "body": "Just out of curiosity, are you running on mac?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 1, "creation_date": 1501075653, "post_id": 45326012, "comment_id": 77618334, "body": "No, Win10 Word 64"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1501928199, "post_id": 45326012, "comment_id": 78001946, "body": "This question is intriguing as it is yet to be resolved.  Allow me to direct you to a performance profiler class from another SO Q&amp;A <a href=\"https://stackoverflow.com/questions/31383177/vba-queryperformancecounter-not-working#answer-31387007\" title=\"vba queryperformancecounter not working%23answer 31387007\">stackoverflow.com/questions/31383177/&hellip;</a> .  So profile your code and then post the offending lines of code (you haven&#39;t posted any genuine code as far as I can see).  The above timer has resolution of milliseconds far far superior to intrinsic VBA profiling."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1501930039, "post_id": 45326012, "comment_id": 78002426, "body": "@SMeaden thanks for that... I&#39;ve not forgotten this question, just distracted.  I will time the code and post back :)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1502035275, "post_id": 45326012, "comment_id": 78027755, "body": "@ThomasG using timer was not so painful ;) pls see updates :)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1502035354, "post_id": 45326012, "comment_id": 78027784, "body": "@FlorentB. there are some doEvents in the code already, also the new results from the timer suggest a fairly consistent delay in code execution... this is the result of many incremental delays - thanks for your thoughts :)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502035438, "post_id": 45326012, "comment_id": 78027812, "body": "@SMeaden thanks for the link.  I ended up modifying a stack class that I had previously implemented - somehow that seemed easier; but I will check out the performance class as well, cheers."}], "answers": [{"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 1, "creation_date": 1502147248, "post_id": 45556434, "comment_id": 78073915, "body": "thanks for your thoughts - in MS Word there is (to the best of my knowledge) no equivalent to Application.EnableEvents &amp; Application.Calculation.  As far as screen updating goes, that is already disabled and furthermore screen updates are prevented via API: Private Declare PtrSafe Function LockWindowUpdate Lib &quot;user32&quot; (ByVal hWndLock As LongPtr) As LongPtr  Appreciate pulling this thread could expose the issue    BUT   what I&#39;m most interested in is the &#39;why&#39;... I&#39;ll update the question a bit more in light of the recent test results already posted... Cheers,"}], "tags": [], "owner": {"reputation": 95, "user_id": 5623340, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ie4QZ_RBv5g/AAAAAAAAAAI/AAAAAAAAAE8/0iQs2SlT8pw/photo.jpg?sz=128", "display_name": "Terry Field", "link": "https://stackoverflow.com/users/5623340/terry-field"}, "is_accepted": false, "score": 0, "last_activity_date": 1502143861, "creation_date": 1502143861, "answer_id": 45556434, "question_id": 45326012, "link": "https://stackoverflow.com/questions/45326012/why-does-vba-code-run-faster-when-called-from-a-standard-module-instead-of-a-us/45556434#45556434", "title": "Why does VBA code run faster when called from a standard module (instead of a userform)?", "body": "<p>Just pulling the thread on @Florent Bs comment, have you tried seeing what you can disable prior to running the macros in the click event?  Things like</p>\n\n<pre><code>Application.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'code\nModule1.Macro1\nModule1.Macro2\nModule1.Macro3\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>Just to see if things are any quicker?  There might be other commands to cancel other things that people can add.</p>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1781, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1593936155, "creation_date": 1501069528, "last_edit_date": 1593936155, "question_id": 45326012, "link": "https://stackoverflow.com/questions/45326012/why-does-vba-code-run-faster-when-called-from-a-standard-module-instead-of-a-us", "title": "Why does VBA code run faster when called from a standard module (instead of a userform)?", "body": "<h1>Alternate Title: Why does pressing <kbd>Esc</kbd> make my MS-Word macro run faster</h1>\n\n<p>While waiting for some code to run I stumbled across something interesting.</p>\n\n<p>Code runs slow... press <kbd>Esc</kbd> code runs fast. Example:</p>\n\n<ul>\n<li>press <kbd>Esc</kbd> immediately after execution - <strong>2 sec</strong> to complete </li>\n<li>don't press <kbd>Esc</kbd> at all - up to <strong>30 sec</strong> to complete</li>\n</ul>\n\n<p>To me this makes no sense.  It turns out other people have noticed similar behavior, for example:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/44423308/pausing-vba-and-re-running-it-causes-faster-execution\">Pausing VBA and re-running it causes faster execution</a></p></li>\n<li><p><a href=\"http://www.vbforums.com/showthread.php?490446-ESC-key-while-running-macros\" rel=\"nofollow noreferrer\">http://www.vbforums.com/showthread.php?490446-ESC-key-while-running-macros</a></p></li>\n<li><p><a href=\"https://www.excelforum.com/excel-programming-vba-macros/617300-vba-code-runs-slow-until-i-push-esc.html\" rel=\"nofollow noreferrer\">https://www.excelforum.com/excel-programming-vba-macros/617300-vba-code-runs-slow-until-i-push-esc.html</a></p></li>\n</ul>\n\n<p>And they have found various solutions or workarounds. <strong>However</strong>, these posts are for MS-Excel; which it seems has different behavior for the <kbd>Esc</kbd> key. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa214566(office.11).aspx\" rel=\"nofollow noreferrer\">In MS-Excel pressing the <kbd>Esc</kbd> key</a> can (depending on the setting of Application.EnableCancleKey) interrupt code or raise an error (Err 18), or do nothing.  On the other hand <strong><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/application-enablecancelkey-property-word\" rel=\"nofollow noreferrer\">in MS Word no such thing happens</a></strong>, instead Application.EnableCancleKey alters the behavior of <kbd>Ctrl</kbd> + <kbd>Pause</kbd>.  Yet despite this, pressing the <kbd>Esc</kbd> speeds up the code execution dramatically.</p>\n\n<p>That difference aside, my question relates more to the placement of code in a userform. For example in my Userform:</p>\n\n<pre><code>Private Sub Cmd_Click()\n\n    Module1.Macro1\n    Module1.Macro2\n    Module1.Macro3\n\nEnd Sub\n</code></pre>\n\n<p>Tested on a 64 bit version of Word 2010, using the structure above is significantly slower than this:</p>\n\n<p>Userform:</p>\n\n<pre><code>Private Sub Cmd_Click()\n\n    Module1.RunMacro123\n\nEnd Sub\n</code></pre>\n\n<p>Standard Module:</p>\n\n<pre><code>Private Sub RunMacro123()\n\n    Module1.Macro1\n    Module1.Macro2\n    Module1.Macro3\n\nEnd Sub\n</code></pre>\n\n<p><strong>I should note the following:</strong></p>\n\n<ol>\n<li>This is most apparent in the 64 bit version of MS Word, the 32 bit version seems to run quite fast with the original code (I'm yet to test with the revised code)</li>\n<li>Like the author in the first link I am not using the selection object etc.</li>\n<li>I'm more interested any insights as to why the speed of code execution is so influenced by:\n\n<ul>\n<li>pressing <kbd>Esc</kbd>  </li>\n<li>moving the calls from the userform to a standard module </li>\n</ul></li>\n<li>Macro1, Macro2 &amp; Macro3 create and edit document styles and (FWIW) involve reading INI files many times</li>\n</ol>\n\n<p><strong><em>On a side note</em></strong>, in a hair-brained attempt at being clever I tried using sendKeys to send the <kbd>Esc</kbd> key but it has no affect. </p>\n\n<h1>Edit - Results of timing the code:</h1>\n\n<p>I ended up using the timer function to time the code, I had already implemented a stack class which was adapted from here: <a href=\"http://www.tek-tips.com/viewthread.cfm?qid=1468970\" rel=\"nofollow noreferrer\">http://www.tek-tips.com/viewthread.cfm?qid=1468970</a></p>\n\n<p>I added an 'absolute' timer (<code>debug.print timer - startTime</code>) to the call stack such that the time between each push was recorded and the timer was reset (<code>startTime = timer</code>) at each pop. Doing this made comparing times easier in NotePad++ </p>\n\n<p>This allowed me to determine that a sub that applies styles to a document was taking ~0.04 seconds to apply the style (NB value returned by the timer = seconds past midnight).</p>\n\n<p>The image below shows an example of the code timing results. Basically, as far as I can tell, the delay in code execution comes from many incremental delays all associated with the same basic task.\n<a href=\"https://i.stack.imgur.com/c6rBI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c6rBI.png\" alt=\"Comparing code execution times in NotePad++\"></a></p>\n\n<p>Because of the way the timer works with the call stack I had to test the code <code>getStyleElement</code> to make sure it was not contributing significantly to the extra time. I did this by timing the code directly and was able to confirm that it was consistently fast to run. </p>\n\n<p>Examining the rest of the code confirmed that the issue was with <code>applyStyleFormat</code> (which calls <code>getStyleElement</code>). </p>\n\n<p>The styles are applied to the document - the code structure includes a With block and For Loop; something like this:</p>\n\n<pre><code>For i = 1 to Styles.Count\n    With aDocument.Styles(i)\n        .Font.??? = Something\n        ' or .Paragraph.??? = Something\n    End With\nNext i\n</code></pre>\n\n<p>I'm no clearer as to why the code runs faster from outside of the userform, or after pressing <kbd>Esc</kbd> but it does and it seems to have something to do with modifying styles...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1501068465, "post_id": 45325592, "comment_id": 77612765, "body": "Why are you adding an exact dupliacte of a post you opened an hour ago ? I gave you an answer right here : <a href=\"https://stackoverflow.com/questions/45324117/object-required-error-when-trying-to-get-endxldown-1-row\" title=\"object required error when trying to get endxldown 1 row\">stackoverflow.com/questions/45324117/&hellip;</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 4, "creation_date": 1501068522, "post_id": 45325592, "comment_id": 77612810, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45324117/object-required-error-when-trying-to-get-endxldown-1-row\">Object required error when trying to get End(xlDown) + 1 row</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501068893, "post_id": 45325592, "comment_id": 77613113, "body": "@ShaiRado Actually, this seems more like a follow-up question. He seems to be using <code>xlDown</code> but needing the standard <code>xlUp</code> from the bottom of the spreadsheet trick."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501068950, "post_id": 45325592, "comment_id": 77613144, "body": "@JohnColeman ok, so he should at least acknowledge or give some feedback to comments (and answer) given to him in his previous post."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1501069009, "post_id": 45325592, "comment_id": 77613195, "body": "@ShaiRado Agreed. They should even consider accepting the other answer (which answered the immediate question)."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1501070413, "post_id": 45326164, "comment_id": 77614231, "body": "<code>Set nextRange = nextRange.Cells(nextRange.Rows.Count, 1)</code> is more robust since it won&#39;t fail if later on you decide to add or delete a header row. Magic numbers like &quot;3&quot; are a bit of a red flag."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501070794, "post_id": 45326164, "comment_id": 77614505, "body": "@John Coleman, Thanks, but now all my files are very similar in their structure, so I&#39;m using those numbers for now, since I&#39;m wary of adding any new factors (like functions) to the code which might fail or give bugs. Future readers would know to replace my numbers with theirs, I hope."}], "tags": [], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "is_accepted": false, "score": 0, "last_activity_date": 1501070885, "last_edit_date": 1501070885, "creation_date": 1501069915, "answer_id": 45326164, "question_id": 45325592, "link": "https://stackoverflow.com/questions/45325592/excel-vba-select-the-last-lines-cell-of-the-selected-range/45326164#45326164", "title": "Excel vba select the last line&#39;s cell of the selected range", "body": "<pre><code>   Set nextRange = resultWorkbook.Worksheets(\"1\").Range(\"A3:F3\", _\n        resultWorkbook.Worksheets(\"1\").Range(\"A3\").End(xlDown)).Offset(1, 0)\n   Set nextRange = resultWorkbook.Worksheets(\"1\").Cells(nextRange.Rows.Count + 3, 1)\n</code></pre>\n\n<p>Solved it for me (I have 3 upper rows that are not included in this selection, so be wary of using the exact number for your case).</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501070885, "creation_date": 1501068401, "question_id": 45325592, "link": "https://stackoverflow.com/questions/45325592/excel-vba-select-the-last-lines-cell-of-the-selected-range", "title": "Excel vba select the last line&#39;s cell of the selected range", "body": "<p>I have this code that opens first workbook, second workbook, copies a range from the first one and pastes it into the second one. I want to make it select the cell right after the pasted range in the second workbook, but it selects the pasted range + the line after it, while I only need a first free cell in column A to be selected.</p>\n\n<pre><code>  Sub tes()\n        '**VARIABLES**\n        Dim folderPath As String\n        folderPath = \"Y:\\plan_graphs\\final\\mich_alco_test\\files\\\"\n        Dim fileTitle As String\n        fileTitle = \"5.xlsx\"\n\n        Dim dataWorkbook As Workbook\n        Set dataWorkbook = Application.Workbooks.Open(folderPath &amp; fileTitle)\n\n        Dim copyRange As Range\n        Set copyRange = dataWorkbook.Worksheets(\"List\").Range(\"A3:F3\", Range(\"A3\").End(xlDown))\n\n\n        Dim resultWorkbook As Workbook\n        Set resultWorkbook = Application.Workbooks.Open(\"Y:\\plan_graphs\\final\\mich_alco_test\\result.xlsx\")\n\n        copyRange.Copy\n        resultWorkbook.Worksheets(\"1\").Range(\"A3\").PasteSpecial Paste:=xlPasteFormulas\n\n        'GET THE LAST RANGE\n        Dim nextRange As Range\n        Set nextRange = resultWorkbook.Worksheets(\"1\").Range(\"A3:F3\", _\n        resultWorkbook.Worksheets(\"1\").Range(\"A3\").End(xlDown)).Offset(1, 0)\n        nextRange.Select\nEnd Sub\n</code></pre>\n\n<p>How would I do that? I imagine it still has something to do with <code>xlDown</code> but can't figure out what.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1024, "user_id": 6590026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4b79ef46b6629bc726f5064d9e405d22?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/6590026/seth"}, "edited": false, "score": 0, "creation_date": 1501071213, "post_id": 45329407, "comment_id": 77620438, "body": "Could you maybe take a screenshot? For me it&#39;s not really whenever you&#39;re struggling with structuring your code, setting up your environment and what environment you&#39;re actually using. Depending on the focus this might also be better suited for StackOverflow."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1501079873, "post_id": 45329407, "comment_id": 77621898, "body": "What you probably want are either separate or subordinate Namespaces. Everything in VBA is in the same namespace, which turns out to be aggravatingly messy, especially once you learn how to use a structured namespace environment.  Here&#39;s a starting point: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/program-structure/namespaces\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/programming-gui&zwnj;&#8203;de/&hellip;</a>"}, {"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "edited": false, "score": 0, "creation_date": 1501179670, "post_id": 45329407, "comment_id": 77678060, "body": "Hi Seth and RBarryYoung - thank you both for the responses. Barry, I read that page and it appears to be a lot more complex than I believe my problem to be so I may have misled by using the term &#39;structuring&#39;. In the image I added, basically I&#39;m trying to achieve in Visual Studio, what I&#39;ve shown in VBA: - In VBA I have modules to help me keep different &quot;topics&quot; of code separate - In VS, I seem to have to stick it all within &#39;Public Class Ribbon1&#39; So the question is, how can I separate the code into modules in Visual Studio?"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1501078147, "question_id": 1234608}, "owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529031901, "creation_date": 1501067120, "last_edit_date": 1592644375, "question_id": 45329407, "link": "https://stackoverflow.com/questions/45329407/vsto-visual-studio-code-structuring", "title": "VSTO - visual studio code structuring", "body": "<p>I'm new to .NET from an extensive VBA background. I'm building an Excel add-in and have been struggling to find any guidance on line about control of code structure and layout in visual studio.</p>\n<p>Comparing to the VBA environment, what I want to do is have different modules for the different components (e.g. one module with all the calculation subs, one module with all the formatting subs, one module with all the custom charting subs, etc.) but cannot find any guidance on how to set this up.</p>\n<p>I've put the skeleton of the ribbon tab in, with some icons etc. and VS has automatically created tabs as follows:</p>\n<ul>\n<li>Ribbon1.Designer.vb, which appears to house setup code - adding groups and buttons etc.</li>\n<li>Ribbon1.vb, which now contains a few subs I've written in 'Public Class Ribbon 1'. This is the bit I want to &quot;modularise&quot;.</li>\n</ul>\n<p>I have tried creating another public class which didn't work, and a few other things. I also saw mention of &quot;sub classes&quot; though could not find any instructions/examples and couldn't get this going myself (or if I need to specify inheritance from one to another?).</p>\n<p>From a user friendliness perspective for me, one tab in VS per category of subs would be the ideal but I'm amateur so definitely open to learning how to structure it all properly. Yes, I wish I had software engineering training!</p>\n<h3>Screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/99hvi.jpg\" alt=\"Screenshot\" /></p>\n"}, {"tags": ["sql", "vba", "duplicates", "spreadsheet", "move"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1501071664, "creation_date": 1501071664, "answer_id": 45326856, "question_id": 45324761, "link": "https://stackoverflow.com/questions/45324761/vba-to-move-duplicated-rows-from-one-sheet-to-another/45326856#45326856", "title": "Vba to move duplicated rows from one sheet to another", "body": "<p>I think this will do what you want.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win006_4.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win006_4.htm</a></p>\n\n<pre><code>The range for the code example below looks like this\nColumn A : Header in A1 = Country, A2:A? = Country names\nColumn B : Header in B1 = Name, B2:B? = Names\nColumn C : Header in C1 = Gender, C2:C? = F or M\nColumn D : Header in D1 = Birthday, D2:D? = Dates\n\n\n\nSub Copy_To_Worksheets()\n'Note: This macro use the function LastRow\n    Dim My_Range As Range\n    Dim FieldNum As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim ws2 As Worksheet\n    Dim Lrow As Long\n    Dim cell As Range\n    Dim CCount As Long\n    Dim WSNew As Worksheet\n    Dim ErrNum As Long\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'This example filters on the first column in the range(change the field if needed)\n    'In this case the range starts in A so Field:=1 is column A, 2 = column B, ......\n    FieldNum = 1\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Add a worksheet to copy the a unique list and add the CriteriaRange\n    Set ws2 = Worksheets.Add\n\n    With ws2\n        'first we copy the Unique data from the filter field to ws2\n        My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"A1\"), Unique:=True\n\n        'loop through the unique list in ws2 and filter/copy to a new sheet\n        Lrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For Each cell In .Range(\"A2:A\" &amp; Lrow)\n\n            'Filter the range\n            My_Range.AutoFilter Field:=FieldNum, Criteria1:=\"=\" &amp; _\n             Replace(Replace(Replace(cell.Value, \"~\", \"~~\"), \"*\", \"~*\"), \"?\", \"~?\")\n\n            'Check if there are no more then 8192 areas(limit of areas)\n            CCount = 0\n            On Error Resume Next\n            CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible) _\n                     .Areas(1).Cells.Count\n            On Error GoTo 0\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 areas for the value : \" &amp; cell.Value _\n                     &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n                     &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n                       vbOKOnly, \"Split in worksheets\"\n            Else\n                'Add a new worksheet\n                Set WSNew = Worksheets.Add(After:=Sheets(Sheets.Count))\n                On Error Resume Next\n                WSNew.Name = cell.Value\n                If Err.Number &gt; 0 Then\n                    ErrNum = ErrNum + 1\n                    WSNew.Name = \"Error_\" &amp; Format(ErrNum, \"0000\")\n                    Err.Clear\n                End If\n                On Error GoTo 0\n\n                'Copy the visible data to the new worksheet\n                My_Range.SpecialCells(xlCellTypeVisible).Copy\n                With WSNew.Range(\"A1\")\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                    .Select\n                End With\n            End If\n\n            'Show all data in the range\n            My_Range.AutoFilter Field:=FieldNum\n\n        Next cell\n\n        'Delete the ws2 sheet\n        On Error Resume Next\n        Application.DisplayAlerts = False\n        .Delete\n        Application.DisplayAlerts = True\n        On Error GoTo 0\n\n    End With\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    If ErrNum &gt; 0 Then\n        MsgBox \"Rename every WorkSheet name that start with \"\"Error_\"\" manually\" _\n             &amp; vbNewLine &amp; \"There are characters in the name that are not allowed\" _\n             &amp; vbNewLine &amp; \"in a sheet name or the worksheet already exist.\"\n    End If\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5369755, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c58b9eed96e308bc49b9d16e98aa7f9f?s=128&d=identicon&r=PG&f=1", "display_name": "Kavitha", "link": "https://stackoverflow.com/users/5369755/kavitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501071664, "creation_date": 1501066163, "question_id": 45324761, "link": "https://stackoverflow.com/questions/45324761/vba-to-move-duplicated-rows-from-one-sheet-to-another", "title": "Vba to move duplicated rows from one sheet to another", "body": "<p>I am looking for code to move duplicated rows from one sheet to another sheet, I am trying to do with sql query not getting how to move the values to another sheet.</p>\n\n<p>much appreciated for any help.</p>\n"}, {"tags": ["excel", "tablecolumn", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501066990, "post_id": 45324740, "comment_id": 77611628, "body": "what exactly is <code>vDb</code> ? is it a <code>Worksheet</code> ? <code>Range</code> ? not so clear."}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501067042, "post_id": 45324740, "comment_id": 77611669, "body": "Its a range (wbTarget.Sheets(Sheet.Name).Range(&quot;b3:i102&quot;))"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501067230, "post_id": 45324740, "comment_id": 77611808, "body": "Are you copying and pasting betwen 2 workbooks ? or only <code>wbTarget</code> ?"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501067279, "post_id": 45324740, "comment_id": 77611847, "body": "I&#39;m copying and pasting between 2 workbooks."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501067429, "post_id": 45324740, "comment_id": 77611969, "body": "and you want to add a column in <code>wbTarget</code> or in the pastes sheet <code>sht1</code> ?"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1501067475, "post_id": 45324740, "comment_id": 77612010, "body": "i want to paste the new column in sht1"}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1501072133, "post_id": 45325451, "comment_id": 77615491, "body": "This works but its not dynamic. Is there a way to assign &quot;Total&quot; to each table which is copied? because this code will be put in a loop on many files. Upvote for the effort though!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1501067986, "creation_date": 1501067986, "answer_id": 45325451, "question_id": 45324740, "link": "https://stackoverflow.com/questions/45324740/excel-vba-add-column-to-right-and-fill-with-text/45325451#45325451", "title": "Excel VBA - add column to right and fill with text", "body": "<p>Add the code line below at the end of your current code:</p>\n\n<pre><code>' adding \"TOTAL\" to last column on the right\nsht1.Range(\"A1\").Offset(, UBound(vDB, 2)).Resize(UBound(vDB, 1) + 1, 1).Value2 = \"TOTAL\"\n</code></pre>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 45325451, "answer_count": 1, "score": 0, "last_activity_date": 1501075513, "creation_date": 1501066100, "last_edit_date": 1531164843, "question_id": 45324740, "link": "https://stackoverflow.com/questions/45324740/excel-vba-add-column-to-right-and-fill-with-text", "title": "Excel VBA - add column to right and fill with text", "body": "<p>I want to edit my existing code (below), which copies and pastes tables between 2 workbooks, to do the following:</p>\n\n<ol>\n<li>Add new column to the right of \"vDB\" (at the end) which is a copy of a table from wbTarget</li>\n<li>Populate the entire column with the text \"TOTAL\" </li>\n<li><p>then paste it to another workbook called \"sht1\"</p>\n\n<pre><code>Dim vDB As Variant\nDim sht1 As Worksheet\nDim wbTarget As Workbook \n\n'if sheet name is \"TOTAL\" then...\nIf \"TOTAL\" = Sheet.Name Then\n\n    'copy a given range from the target workbook\n    vDB = wbTarget.Sheets(Sheet.Name).Range(\"b3:i102\")\n\n    'paste that range under existing data in the master workbook\n    sht1.Range(\"a\" &amp; Rows.Count).End(xlUp)(2).Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n\nEnd If\n</code></pre></li>\n</ol>\n\n<p>My failed attempt:</p>\n\n<pre><code>    Dim vDB As Variant\n    Dim sht1 As Worksheet\n    Dim wbTarget As Workbook \n\n    If \"TOTAL\" = Sheet.Name Then\n\n        vDB = wbTarget.Sheets(Sheet.Name).Range(\"b3:i102\")\n\n        With vDB\n        .ListColumns.Add\n        x = .ListColumns.Count\n        .Range(2, x) = \"Total\"\n        End With\n\n        sht1.Range(\"a\" &amp; Rows.Count).End(xlUp)(2).Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n\n    End If\n</code></pre>\n\n<p>I get a \"Object required\" error. Any suggestions? I'm fairly new to vba...</p>\n"}, {"tags": ["vba", "excel", "hook", "setwindowshookex"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1501066933, "post_id": 45324586, "comment_id": 77611588, "body": "You need to review your declarations - not everything should be a <code>LongPtr</code>. Those that are should be <code>LongPtr</code> and not <code>LongPrt</code>."}, {"owner": {"reputation": 11, "user_id": 8369325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867a4dce9e6e16a3d901ae8aa2365ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rafavb", "link": "https://stackoverflow.com/users/8369325/rafavb"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1501070496, "post_id": 45324586, "comment_id": 77614297, "body": "Sorry for my ignorance, but which ones wouldn&#39;t be LongPtr? It is the first time that I code for 64 bit. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8369325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867a4dce9e6e16a3d901ae8aa2365ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rafavb", "link": "https://stackoverflow.com/users/8369325/rafavb"}, "edited": false, "score": 0, "creation_date": 1501073450, "post_id": 45327241, "comment_id": 77616602, "body": "Thanks!. Actually, it doesn&#39;t really work. The code enters in an unstoppable loop once I pull a key. I am not able to see the error, after readying information and many codes about hooks, setwindowsex, callnexthookex, etc. All the samples codes look so simple but I can&#39;t make it work"}, {"owner": {"reputation": 11, "user_id": 8369325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867a4dce9e6e16a3d901ae8aa2365ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rafavb", "link": "https://stackoverflow.com/users/8369325/rafavb"}, "edited": false, "score": 0, "creation_date": 1501227614, "post_id": 45327241, "comment_id": 77695808, "body": "Hi again,I have made a bit of improvement and this code works almost fine, but there are a couple of problems: When I run the code, the function doesn&#39;t return the key that I am pulling so nothing is written and the &quot;NewProc_64&quot; function is run twice:"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1501072688, "creation_date": 1501072688, "answer_id": 45327241, "question_id": 45324586, "link": "https://stackoverflow.com/questions/45324586/using-setwindowshookex-in-excel-2010/45327241#45327241", "title": "Using SetWindowsHookEx. in Excel 2010", "body": "<p>The correct declarations for 64bit would be:</p>\n\n<pre><code>Public Declare PtrSafe Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As LongPtr) As Long\nPublic Declare PtrSafe Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" (ByVal idHook As Long, ByVal lpFn As LongPtr, ByVal hmod As LongPtr, ByVal dwThreadId As Long) As LongPtr\nPublic Declare PtrSafe Function CallNextHookEx Lib \"user32\" (ByVal hHook As LongPtr, ByVal nCode As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\nPublic Declare PtrSafe Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal lpModuleName As String) As LongPtr\nPublic Declare PtrSafe Function GetCurrentThreadId Lib \"kernel32\" () As Long\nPublic Declare PtrSafe Function GetKeyState Lib \"user32\" (ByVal nVirtKey As Long) As Integer\nPrivate Declare Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" (ByVal hDlg As LongPtr, ByVal nIDDlgItem As Long, ByVal wMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As LongPtr, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\n</code></pre>\n\n<p>I can't actually see how the code you posted would run at all on 64bit.</p>\n"}], "owner": {"reputation": 11, "user_id": 8369325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6867a4dce9e6e16a3d901ae8aa2365ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rafavb", "link": "https://stackoverflow.com/users/8369325/rafavb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2414, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1501072688, "creation_date": 1501065693, "last_edit_date": 1531164843, "question_id": 45324586, "link": "https://stackoverflow.com/questions/45324586/using-setwindowshookex-in-excel-2010", "title": "Using SetWindowsHookEx. in Excel 2010", "body": "<p>This function is getting me crazy! I am trying to use SetWindwosHookEx to avoid some keystrokes from the user, but I can't make it work properly.</p>\n\n<p>I have been looking around many code on the web but I don't understand why it is not working for me. Firstly, it was because I was using Excel 2010 (64 bit) and my code wasn't for it, but now I don't know.</p>\n\n<p>Basically, I have created a simple code which shows me a message when I pull \"g\" but what it is happening is Excel crashes when a pull any key. It doesn't crash when I run the code step by step but if I pull \"g\" the message appears three times!</p>\n\n<p>This is my code:</p>\n\n<pre><code>#If Win64 Then\n\nPublic Declare PtrSafe Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As LongPtr) As LongPtr\nPublic Declare PtrSafe Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" (ByVal idHook As LongPtr, ByVal lpFn As LongPtr, ByVal hmod As LongPtr, ByVal dwThreadId As LongPtr) As LongPrt\nPublic Declare PtrSafe Function CallNextHookEx Lib \"user32\" (ByVal hHook As LongPtr, ByVal nCode As LongPtr, ByVal wParam As LongPtr, lParam As Any) As LongPtr\nPublic Declare PtrSafe Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal lpModuleName As String) As LongPtr\nPublic Declare PtrSafe Function GetCurrentThreadId Lib \"kernel32\" () As LongPtr\nPublic Declare PtrSafe Function GetKeyState Lib \"user32\" (ByVal nVirtKey As LongPtr) As Integer\nPrivate hWndPPT As LongPtr\nPrivate HookHandle As LongPtr\n\n'ADICIONAL\nPrivate Declare Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" (ByVal hDlg As LongPrt, ByVal nIDDlgItem As LongPtr, ByVal wMsg As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As LongPtr, ByVal lpClassName As String, ByVal nMaxCount As LongPtr) As LongPtr\n\n\n\n#Else\nPublic Declare Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As Long) As Long\nPublic Declare Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" (ByVal idHook As Long, ByVal lpFn As Long, ByVal hmod As Long, ByVal dwThreadId As Long) As Long\nPublic Declare Function CallNextHookEx Lib \"user32\" (ByVal hHook As Long, ByVal nCode As Long, ByVal wParam As Long, lParam As Any) As Long\nPublic Declare Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal lpModuleName As String) As Long\nPublic Declare Function GetCurrentThreadId Lib \"kernel32\" () As Long\nPublic Declare Function GetKeyState Lib \"user32\" (ByVal nVirtKey As Long) As Integer\nPrivate hWndPPT As Long\nPrivate HookHandle As Long\n\n'ADICIONAL\nPrivate Declare Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" (ByVal hDlg As Long, ByVal nIDDlgItem As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\n\n#End If\n\n\n\n'Constants to be used in our API functions\n'Private Const EM_SETPASSWORDCHAR = &amp;HCC\n'Private Const WH_CBT = 5\nPrivate Const WH_KEYBOARD = 2\n'Private Const HCBT_ACTIVATE = 5\nPrivate Const HC_ACTION = 0\n\n'Private hHook As Long\n\n\nPublic Sub RemoveHook()\n    UnhookWindowsHookEx (HookHandle)\nEnd Sub\n\nSub SetHook()\n#If Win64 Then\nDim lThreadID As LongPtr\nDim lngModHwnd As LongPtr\n#Else\nDim lThreadID As Long\nDim lngModHwnd As Long\n#End If\n\nlThreadID = GetCurrentThreadId\nlngModHwnd = GetModuleHandle(vbNullString)\n\n'Set a local hook\nHookHandle = SetWindowsHookEx(WH_KEYBOARD, AddressOf NewProc, 0, lThreadID)\nEnd Sub\n\nPublic Function NewProc(ByVal lngCode As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n\n    If lngCode &lt; HC_ACTION Then\n      NewProc = CallNextHookEx(HookHandle, lngCode, wParam, lParam)\n      Exit Function\n    End If\n\n    If wParam = 71 Then\n        'MsgBox \"g\"\n        'NewProc = 1\n        wParam = 70\n        'Exit Function\n    End If\n\n    'This line will ensure that any other hooks that may be in place are\n    'called correctly.\n    CallNextHookEx HookHandle, lngCode, wParam, lParam\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1501064698, "post_id": 45324117, "comment_id": 77610072, "body": "You need to first <code>Set nextRange</code> without <code>.Select</code> and then select with <code>nextRange.Select</code>"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1501064763, "post_id": 45324117, "comment_id": 77610120, "body": "Is your worksheet called <code>1</code> or are you trying to get the first worksheet?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501065393, "post_id": 45324117, "comment_id": 77610564, "body": "Aside from what other people have said (Setting &amp; Selecting in same row).  If <code>A4</code> downwards is empty this would return <code>$A$3:$F$1048576</code> and then try and move down a row off the bottom of the sheet causing an error.  As you said in your other question though -  <i>it looks like all my files have no empty cells in A column</i> so all should be good... until you reach that one file that doesn&#39;t follow the rules."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1501064774, "creation_date": 1501064774, "answer_id": 45324272, "question_id": 45324117, "link": "https://stackoverflow.com/questions/45324117/object-required-error-when-trying-to-get-endxldown-1-row/45324272#45324272", "title": "Object required error when trying to get End(xlDown) + 1 row", "body": "<p>You can't <code>Set</code> the range and <code>Select</code> it in the same line, try the code section below:</p>\n\n<pre><code>copyRange.Copy\n\nWith resultWorkbook.Worksheets(\"1\")\n    .Range(\"A3\").PasteSpecial Paste:=xlPasteFormulas\n\n    Dim nextRange As Range\n    Set nextRange = .Range(\"A3\").End(xlDown).Offset(1, 0) ' set the Range first\n\n    nextRange.Select ' &lt;-- select the Range\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 45324272, "answer_count": 1, "score": 0, "last_activity_date": 1501064774, "creation_date": 1501064406, "question_id": 45324117, "link": "https://stackoverflow.com/questions/45324117/object-required-error-when-trying-to-get-endxldown-1-row", "title": "Object required error when trying to get End(xlDown) + 1 row", "body": "<p>I have this code that opens first workbook, second workbook, copies a range from the first one and pastes it into the second one. I want to make it select the cell right after the pasted range in the second workbook, but it failes with <code>Object required</code> error.</p>\n\n<pre><code>Sub tes()\n        '**VARIABLES**\n        Dim folderPath As String\n        folderPath = \"Y:\\plan_graphs\\final\\mich_alco_test\\files\\\"\n        Dim fileTitle As String\n        fileTitle = \"5.xlsx\"\n\n        Dim dataWorkbook As Workbook\n        Set dataWorkbook = Application.Workbooks.Open(folderPath &amp; fileTitle)\n\n        Dim copyRange As Range\n        Set copyRange = dataWorkbook.Worksheets(\"List1\").Range(\"A3:F3\", Range(\"A3\").End(xlDown))\n\n\n        Dim resultWorkbook As Workbook\n        Set resultWorkbook = Application.Workbooks.Open(\"Y:\\plan_graphs\\final\\mich_alco_test\\result.xlsx\")\n\n        copyRange.Copy\n        resultWorkbook.Worksheets(\"1\").Range(\"A3\").PasteSpecial Paste:=xlPasteFormulas\n\n        Dim nextRange As Range\n        Set nextRange = resultWorkbook.Worksheets(\"1\").Range(\"A3:F3\", _\n        resultWorkbook.Worksheets(\"1\").Range(\"A3\").End(xlDown)).Offset(1, 0).Select\n\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "range"], "comments": [{"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1501067197, "post_id": 45323814, "comment_id": 77611787, "body": "@TimWilkinson that is what I have:  <code>OP_wb.Sheets(&quot;Optic Main&quot;).Activate  Range(&quot;C1&quot;).End(xlDown).Offset(1, 0).Activate  ActiveCell.FormulaR1C1 = &quot;=RC[1]-14&quot;</code>"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1501073468, "post_id": 45323814, "comment_id": 77616616, "body": "here is where i stuck now: <code>Dim FirstRow As Range Dim LastRow As Range   Set FirstRow = Range(&quot;C1&quot;).End(xlDown).Offset(1, 0) Set LastRow = Range(&quot;E1&quot;).End(xlDown).Offset(0, -2)                Range(FirstRow, LastRow).FormulaR1C1 = &quot;=(RC4-14)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "is_accepted": true, "score": 0, "last_activity_date": 1501149888, "creation_date": 1501149888, "answer_id": 45347551, "question_id": 45323814, "link": "https://stackoverflow.com/questions/45323814/excel-vba-code-for-simple-formula-between-cells/45347551#45347551", "title": "Excel VBA code for simple formula between cells", "body": "<p>try this:</p>\n\n<p>1.</p>\n\n<pre><code>Set FirstRow = Range(\"C1\").End(xlDown).Offset(1, 0)\nSet lastrow = Range(\"E1\").End(xlDown).Offset(0, -2)\n\nRange(\"E1\").End(xlDown).Offset(0, -2).Select\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Range(FirstRow, lastrow).FormulaR1C1 = \"=(c4-14)\"\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>Selection.AutoFill Destination:=ActiveCell.Range(\"A1:A\" &amp; lastrow)\n</code></pre>\n\n<p>hope this helps</p>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 1, "accepted_answer_id": 45347551, "answer_count": 1, "score": 0, "last_activity_date": 1526286112, "creation_date": 1501063647, "last_edit_date": 1526286112, "question_id": 45323814, "link": "https://stackoverflow.com/questions/45323814/excel-vba-code-for-simple-formula-between-cells", "title": "Excel VBA code for simple formula between cells", "body": "<p><a href=\"https://i.stack.imgur.com/Ys0wu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ys0wu.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need a code for these orders:</p>\n\n<ol>\n<li>Go to first blanks cell in column C.</li>\n<li>Calculat the number in column D minus 14 and do it as long there is a number right to the cell in D (there is blanks in column D)</li>\n<li>Copy the result in column C and paste it as values to Column B.\nnote: I need it to stay in original rows.</li>\n</ol>\n\n<p>`    OP_wb.Sheets(\"Optic Main\").Activate \n    Dim FirstRow As Range \n    Dim LastRow As Range\n    Set FirstRow = Range(\"C1\").End(xlDown).Offset(1, 0)</p>\n\n<pre><code>Range(\"E1\").End(xlDown).Offset(0, -2).Select\nRange(FirstRow, LastRow).FormulaR1C1 = \"=(c4-14)\"`\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501067312, "post_id": 45323804, "comment_id": 77611874, "body": "A formula for <b>Base</b> that looks only at the <b>Dr</b> column might be: <code>=SUMPRODUCT((A2=Sheet1!$A$2:$A$7)*(LEFT(Sheet1!$B$2:$B$7)={&quot;&zwnj;&#8203;6&quot;,&quot;7&quot;})*Sheet1!$C$2&zwnj;&#8203;:$C$7)</code> where your data is on <code>Sheet1</code> and your unique list of <b>NrDoc</b> starts in <code>A2</code>.  You should be able to expand this to your other requirements.  If you want a total VBA solution, I would set up a user defined object to collect all the data.  I&#39;ll check back later when I am back at my computer."}, {"owner": {"reputation": 1, "user_id": 8369114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f20b441f4a77efd2686f6abe985814?s=128&d=identicon&r=PG&f=1", "display_name": "Robokiples", "link": "https://stackoverflow.com/users/8369114/robokiples"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501067867, "post_id": 45323804, "comment_id": 77612307, "body": "Thank you Ron,  I&#39;m new in VbA although for me it seems to me that the better option would be to trace all the columns on the database as arrays, but for this is any way I could define a column as array, so than I can later on reference easier the Sumifs?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501068009, "post_id": 45323804, "comment_id": 77612422, "body": "If you are going to use formulas, I would use dynamic named ranges for your database columns or, (my preference for the formula solution), would be to make it a Table, and use structured references to the columns."}, {"owner": {"reputation": 1, "user_id": 8369114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f20b441f4a77efd2686f6abe985814?s=128&d=identicon&r=PG&f=1", "display_name": "Robokiples", "link": "https://stackoverflow.com/users/8369114/robokiples"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501068623, "post_id": 45323804, "comment_id": 77612878, "body": "Is there any way to define a column as an array through VbA?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501068835, "post_id": 45323804, "comment_id": 77613058, "body": "Go to Chip Pearson&#39;s web site. Lots of info about VBA arrays and worksheet ranges."}, {"owner": {"reputation": 1, "user_id": 8369114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f20b441f4a77efd2686f6abe985814?s=128&d=identicon&r=PG&f=1", "display_name": "Robokiples", "link": "https://stackoverflow.com/users/8369114/robokiples"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1501069030, "post_id": 45323804, "comment_id": 77613216, "body": "Thank you very much for all the help."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1501072861, "post_id": 45323804, "comment_id": 77616087, "body": "How are you calculating VAT?"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1501073586, "creation_date": 1501073586, "answer_id": 45327602, "question_id": 45323804, "link": "https://stackoverflow.com/questions/45323804/vba-transpose-unique-values-and-sums/45327602#45327602", "title": "VBA || Transpose unique values and Sums", "body": "<p>Using @RonRosenfeld formula from comments, following might be helpful:</p>\n\n<pre><code>Sub Demo()\n\n    Dim lastRow As Long, lastCol As Long, currLR As Long\n    Dim rng As Range, rngWH As Range\n    Dim srcSht As Worksheet\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Set srcSht = Sheets(\"Sheet1\")   'set data sheet here\n    With srcSht\n        lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row 'last row with data in sheet\n        Set rng = .Range(\"A1:A\" &amp; lastRow)                'range for filter\n        Set rngWH = .Range(\"A2:A\" &amp; lastRow)              'range for formulas\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column + 2 'column to display data\n        rng.AdvancedFilter Action:=xlFilterCopy, copytoRange:=.Cells(1, lastCol), unique:=True\n        currLR = .Cells(.Rows.Count, lastCol).End(xlUp).Row 'unique nr. doc count\n        lastCol = lastCol + 1\n\n        'formula for Base\n        .Cells(1, lastCol).Value = \"Base\"\n        .Range(.Cells(2, lastCol), .Cells(currLR, lastCol)).Formula = _\n            \"=SUMPRODUCT((\" &amp; .Cells(2, lastCol - 1).Address(False, False) &amp; \"=\" &amp; rngWH.Address &amp; \")*(LEFT(\" &amp; rngWH.Offset(, 1).Address &amp; \")={\"\"6\"\",\"\"7\"\"})*(\" &amp; rngWH.Offset(, 2).Address &amp; \"))\"\n\n        'formula for Vat\n        .Cells(1, lastCol + 1).Value = \"VAT\"\n        'enter formula here for VAT\n\n        'formula for Total\n        .Cells(1, lastCol + 2).Value = \"Total\"\n        .Range(.Cells(2, lastCol + 2), .Cells(currLR, lastCol + 2)).Formula = _\n            \"=SUMIF(\" &amp; rngWH.Address &amp; \",\" &amp; .Cells(2, lastCol - 1).Address(False, False) &amp; \",\" &amp; rngWH.Offset(, 3).Address &amp; \")\"\n\n        .Range(.Cells(2, lastCol), .Cells(currLR, lastCol + 2)).Value = .Range(.Cells(2, lastCol), .Cells(currLR, lastCol + 2)).Value\n    End With\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1501089002, "creation_date": 1501089002, "answer_id": 45333383, "question_id": 45323804, "link": "https://stackoverflow.com/questions/45323804/vba-transpose-unique-values-and-sums/45333383#45333383", "title": "VBA || Transpose unique values and Sums", "body": "<p>For a \"pure\" VBA solution, I would </p>\n\n<ul>\n<li>create a user defined object which as the properties of  Nr.Doc, Acct, VAT, Base and Total.</li>\n<li>Base, as you wrote, we detect by checking the first digit of the account</li>\n<li>VAT will be any amount in the Dr column that does not start with 6 or 7</li>\n<li>Total will be the values in the Cr column.</li>\n</ul>\n\n<p>If your rules are different, by setting things up like this, they can be easily changed, as the code is almost self-documenting.</p>\n\n<p>For the UDO, we enter a class module and rename it cDoc. \nAlso, I chose to use early-binding so we set a reference to Microsoft Scripting Runtime.  If you want to change it to late-binding as you do in your posted code, feel free to do that.  It can be easier if you are distributing the file; but I prefer to have the Intellisense available when I am coding.</p>\n\n<h2>Class Module</h2>\n\n<pre><code>Option Explicit\n'Rename this module \"cDoc\"\nPrivate pDocNum As String\nPrivate pAcct As String\nPrivate pBase As Currency\nPrivate pVAT As Currency\nPrivate pTotal As Currency\n\nPublic Property Get Acct() As String\n    Acct = pAcct\nEnd Property\nPublic Property Let Acct(Value As String)\n    pAcct = Value\nEnd Property\n\nPublic Property Get Base() As Currency\n    Base = pBase\nEnd Property\nPublic Property Let Base(Value As Currency)\n    pBase = Value\nEnd Property\n\nPublic Property Get VAT() As Currency\n    VAT = pVAT\nEnd Property\nPublic Property Let VAT(Value As Currency)\n    pVAT = Value\nEnd Property\n\nPublic Property Get Total() As Currency\n    Total = pTotal\nEnd Property\nPublic Property Let Total(Value As Currency)\n    pTotal = Value\nEnd Property\n\nPublic Property Get DocNum() As String\n    DocNum = pDocNum\nEnd Property\nPublic Property Let DocNum(Value As String)\n    pDocNum = Value\nEnd Property\n</code></pre>\n\n<h2>Regular Module</h2>\n\n<pre><code>Option Explicit\n'Set Reference to Microsoft Scripting Runtime\n'   you can change this to late binding if everything works\n\nSub ReOrganizeTable()\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n    Dim dDoc As Dictionary, cD As cDoc\n    Dim I As Long\n    Dim V As Variant\n\n'Set source and results worksheets\n'Read source data into variant array\n\nSet wsSrc = Worksheets(\"sheet1\")\nWith wsSrc\n    vSrc = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(columnsize:=4)\nEnd With\n\nOn Error Resume Next\nSet wsRes = Worksheets(\"Results\")\n    Select Case Err.Number\n        Case 9\n            Set wsRes = Worksheets.Add(after:=wsSrc)\n            wsRes.Name = \"Results\"\n        Case Is &lt;&gt; 0\n            Debug.Print Err.Number, Err.Description\n            Stop\n    End Select\nOn Error GoTo 0\nSet rRes = wsRes.Cells(1, 1)\n\n'Gather and organize the data\nSet dDoc = New Dictionary\nFor I = 2 To UBound(vSrc, 1)\n    Set cD = New cDoc\n    With cD\n        .DocNum = vSrc(I, 1)\n        .Acct = CStr(vSrc(I, 2))\n        Select Case Left(.Acct, 1)\n            Case 6, 7\n                .Base = vSrc(I, 3)\n            Case Else\n                .VAT = vSrc(I, 3)\n        End Select\n        .Total = vSrc(I, 4)\n\n        If Not dDoc.Exists(.DocNum) Then\n            dDoc.Add Key:=.DocNum, Item:=cD\n        Else\n            dDoc(.DocNum).Base = dDoc(.DocNum).Base + .Base\n            dDoc(.DocNum).VAT = dDoc(.DocNum).VAT + .VAT\n            dDoc(.DocNum).Total = dDoc(.DocNum).Total + .Total\n        End If\n    End With\nNext I\n\n'Size results array\nReDim vRes(0 To dDoc.Count, 1 To 4)\n\n'Headers\nvRes(0, 1) = \"Nr Doc\"\nvRes(0, 2) = \"Base\"\nvRes(0, 3) = \"VAT\"\nvRes(0, 4) = \"Total\"\n\n'Populate the data area\nI = 0\nFor Each V In dDoc.Keys\n    I = I + 1\n    Set cD = dDoc(V)\n    With cD\n        vRes(I, 1) = .DocNum\n        vRes(I, 2) = .Base\n        vRes(I, 3) = .VAT\n        vRes(I, 4) = .Total\n    End With\nNext V\n\n'write and format the results\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    With .Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<h2>Results</h2>\n\n<p>Using your original posted data</p>\n\n<p><a href=\"https://i.stack.imgur.com/A3Tfn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A3Tfn.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8369114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f20b441f4a77efd2686f6abe985814?s=128&d=identicon&r=PG&f=1", "display_name": "Robokiples", "link": "https://stackoverflow.com/users/8369114/robokiples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501089002, "creation_date": 1501063619, "last_edit_date": 1501064213, "question_id": 45323804, "link": "https://stackoverflow.com/questions/45323804/vba-transpose-unique-values-and-sums", "title": "VBA || Transpose unique values and Sums", "body": "<p>I'm currently trying to make a map that transposes unique values from a column and populate this new list with some parameters from another table,</p>\n\n<p><a href=\"https://i.stack.imgur.com/ELqPU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ELqPU.png\" alt=\"Table\"></a></p>\n\n<p>the result on this map should be the following </p>\n\n<p><a href=\"https://i.stack.imgur.com/GIVRB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GIVRB.png\" alt=\"List\"></a></p>\n\n<p>I've already have the code for the unique values as follows:</p>\n\n<pre><code>Dim d As Object\nDim c As Variant\nDim i As Long\nDim lr As Long\n\nSet d = CreateObject(\"Scripting.Dictionary\")\n    lr = Cells(Rows.Count, 9).End(xlUp).Row\n    c = Range(\"B2:B\" &amp; lr)\n    For i = 1 To UBound(c, 1)\n    d(c(i, 1)) = 1\n\n    Next i\nRange(\"AK2\").Resize(d.Count) = Application.Transpose(d.keys)\n</code></pre>\n\n<p>Although for filling the amounts on the columns Base and VAT I'm having some issues trying to think on the formula, basically for \"Base\" the value should be the total by Document Nr of the accounts starting with 6*,7* which are a result of Dr - Cr.</p>\n\n<p>I know it may sound a bit confusing, but if anyone could please help me I would be much appreciated.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1501086847, "post_id": 45323792, "comment_id": 77627392, "body": "Which office are you running? Is there anything that have tried you can share?"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1501142947, "post_id": 45323792, "comment_id": 77651036, "body": "I&#39;m using Office 2013 and have edited my question to include a first attempt, gathering what I can from other resources. I miss excel VBA. Outlook seems so strange in comparison."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1501172395, "post_id": 45323792, "comment_id": 77673659, "body": "Dim intCount As Long"}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1501143100, "post_id": 45338435, "comment_id": 77651137, "body": "The deletion code runs smoothly and I have put a call in to trigger it after every email that is deleted from the mailbox. I know it&#39;s inefficient but the first time I run this it will probably delete about 100k emails, and they won&#39;t fit in my deleted items ^_^  I have edited my answer to include my first attempt. I am struggling to understand the method you stated as online documentation is not very friendly and other code examples are very varied in its use."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1501182279, "post_id": 45338435, "comment_id": 77679560, "body": "You seem to be using GetSharedDefaultFolder correctly; are you certain you have edit/delete rights in that user&#39;s Inbox? BTW, change intCount to a Long, as an Integer in VBA has maximum value of 32767"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1501226482, "post_id": 45338435, "comment_id": 77695111, "body": "It took me a while to understand it after hunting for a couple examples. The MSDN site also takes forever and a day to load on my work network for some reason too. But it seems like you and niton were correct about the interger! As soon as I changed it to Long I was able to step through the entire thing just fine. Thanks very much."}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": true, "score": 2, "last_activity_date": 1501107922, "creation_date": 1501107922, "answer_id": 45338435, "question_id": 45323792, "link": "https://stackoverflow.com/questions/45323792/outlook-vba-permanently-delete-old-emails-from-shared-mailbox/45338435#45338435", "title": "Outlook VBA Permanently Delete Old Emails From Shared Mailbox", "body": "<p>You can use the NameSpace.GetSharedDefaultFolder method to get at the Inbox to delete items.  However, if the items are in another folder you will need Full Mailbox access to that mailbox or write permissions on the specific folders.  In those cases you will need to find the folders in that mailbox IF that mailbox has also been added to the current Outlook profile.  Then you can access the folders from the matching Store object in NameSpace.Stores (e.g. via Store.GetDefaultFolder or .GetRootFolder, then \"walk\" through Folder.Folders collections).</p>\n\n<p>Regardless, there is on way to permanently delete an email immediately in the Outlook Object Model.  But you can delete it twice if you find it again in the Deleted Items folder.</p>\n\n<p>See also:\n<a href=\"https://msdn.microsoft.com/en-us/library/bb960906(v=office.12).aspx\" rel=\"nofollow noreferrer\">How to: Delete All Items and Subfolders in the Deleted Items Folder</a></p>\n"}], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "accepted_answer_id": 45338435, "answer_count": 1, "score": 1, "last_activity_date": 1593342410, "creation_date": 1501063603, "last_edit_date": 1593342410, "question_id": 45323792, "link": "https://stackoverflow.com/questions/45323792/outlook-vba-permanently-delete-old-emails-from-shared-mailbox", "title": "Outlook VBA Permanently Delete Old Emails From Shared Mailbox", "body": "<p>I have an issue where I need to permanently delete emails from a shared mailbox that are older than a certain age.</p>\n\n<p>Unfortunately, the AutoArchive function does not affect the shared mailbox, and every time I try to run a rule to do this, it fails and does not take any action. I've been having to manually clear hundreds of emails from this mailbox which takes an absolute age (when you have over 300k sitting in there...), as it fills up my own deleted items when I do.</p>\n\n<p>I am very well versed in Excel VBA but I have no clue how Outlook likes to handle things. I've been searching for a way to do this but I have yet to find anything reliable that I can use that is well annotated to teach me.</p>\n\n<p>Has anybody else ever had to do the same thing? I can't be the only one who wants to do this?</p>\n\n<p>Edit:\nI've been chopping up random bits of code I've found to try and achieve this. I have access to 6 other shared mailboxes within my department. I've been looking at the GetSharedDefaultFolder function but it is not very well explained and normally errors when my bodged attempt runs. I am not sure what it wants in the recipient function, as I have tried the mailbox name and address. The MS online resources aren't very helpful in this case:</p>\n\n<p>Edit 2:</p>\n\n<p>I have edited my code to the below. In this version I get an Overflow error on the line For intCount = olSharedBox.Items.Count To 1 Step -1\nSince there are over 300k emails in that box I think it is now looking at the right thing but not sure of a way around it. Is it not possible to get the current number from the pre-counted figure that appears next to the inbox?</p>\n\n<pre><code>Sub DeleteOldSharedMail()\n\nDim olApp As Outlook.Application\nDim olNS As Outlook.NameSpace\nDim olMailItem As Outlook.MailItem\nDim objVariant As Variant\nDim lngMovedItems As Long\nDim intCount As Integer\nDim intDateDiff As Integer\nDim olSharedBox As Folder\nDim mbOwner As Outlook.Recipient\n\n\nSet olApp = Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet mbOwner = olNS.CreateRecipient(\"mailbox@email.com\")\nSet olSharedBox = olNS.GetSharedDefaultFolder(mbOwner, olFolderInbox)\n\nFor intCount = olSharedBox.Items.Count To 1 Step -1\n    Set objVariant = olSharedBox.Items.Item(intCount)\n    DoEvents\n    If objVariant.Class = olMail Then\n\n         intDateDiff = DateDiff(\"d\", objVariant.SentOn, Now)\n\n        ' Set number of days\n        If intDateDiff &gt; 180 Then\n          objVariant.Delete\n          Call ClearDeletedFolder ' Working. Will change to call every 100 emails deleted after first run.\n\n          'count the # of items moved\n           lngMovedItems = lngMovedItems + 1\n\n        ' No need to run the IF statement on the rest of the mailbox assuming the macro runs from oldest to newest.\n        'Else: GoTo Marker\n\n        End If\n    End If\nNext\n\n' Display the number of items that were moved.\nMarker:\nMsgBox \"Moved \" &amp; lngMovedItems &amp; \" messages(s).\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8369191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d40dfcf09e90e590a5ea88cfcd89b6?s=128&d=identicon&r=PG&f=1", "display_name": "Demo", "link": "https://stackoverflow.com/users/8369191/demo"}, "edited": false, "score": 0, "creation_date": 1501065474, "post_id": 45324202, "comment_id": 77610626, "body": "Thanks for the tip buddy. small issue .. first cell of the 9th row to be copied is a reference to a cell in 6th row. Instead of copying the value for first cell of 9th row it indicates #REF error in the copied sheet.  can you also suggest a way around for same."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 3, "user_id": 8369191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d40dfcf09e90e590a5ea88cfcd89b6?s=128&d=identicon&r=PG&f=1", "display_name": "Demo", "link": "https://stackoverflow.com/users/8369191/demo"}, "edited": false, "score": 0, "creation_date": 1501069483, "post_id": 45324202, "comment_id": 77613565, "body": "At the end of line <code>Range(&quot;A65536&quot;).End(xlUp).Offset(1, 0).PasteSpecial</code> add <code>xlPasteValues</code>."}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1501064612, "creation_date": 1501064612, "answer_id": 45324202, "question_id": 45323784, "link": "https://stackoverflow.com/questions/45323784/i-want-to-merge-data-from-multiple-excel-workbooks-in-a-folder-into-single-excel/45324202#45324202", "title": "I want to merge data from multiple excel workbooks in a folder into single excel sheet", "body": "<p>The problem is in this line</p>\n\n<pre><code>Range(\"A9:IV\" &amp; Range(\"A10\").End(xlUp).Row).Copy\n</code></pre>\n\n<p>more strictly in this part</p>\n\n<pre><code>Range(\"A10\").End(xlUp).Row\n</code></pre>\n\n<p>which says \"From cell A10 go up to the cell where block of data ends and take row number of this cell\". In your case it means 6.</p>\n\n<p>Use this instead and you'll be fine</p>\n\n<pre><code>Range(\"A9:IV9\").Copy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1501071841, "creation_date": 1501071841, "answer_id": 45326921, "question_id": 45323784, "link": "https://stackoverflow.com/questions/45323784/i-want-to-merge-data-from-multiple-excel-workbooks-in-a-folder-into-single-excel/45326921#45326921", "title": "I want to merge data from multiple excel workbooks in a folder into single excel sheet", "body": "<p>This should do what you want.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6FsWY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6FsWY.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8369191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d40dfcf09e90e590a5ea88cfcd89b6?s=128&d=identicon&r=PG&f=1", "display_name": "Demo", "link": "https://stackoverflow.com/users/8369191/demo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 45324202, "answer_count": 2, "score": 0, "last_activity_date": 1501071841, "creation_date": 1501063578, "last_edit_date": 1531164843, "question_id": 45323784, "link": "https://stackoverflow.com/questions/45323784/i-want-to-merge-data-from-multiple-excel-workbooks-in-a-folder-into-single-excel", "title": "I want to merge data from multiple excel workbooks in a folder into single excel sheet", "body": "<p>I have to pick single row (row 9) data (out of 5 rows (row 6-10) of data in each file) from multiple excel files. all these files are in single folder and the consolidation file is one level up in file structure. Below given code copies 4 (row 6-9) rows. Please help:</p>\n\n<p>Code being used is given below:</p>\n\n<pre><code>Sub Auto_Open()\n    'MsgBox \"Welcome to ANALYSIS TABS\"\n    'End Sub\n\n    'Sub simpleXlsMerger()\n    Dim bookList As Workbook\n    Dim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\n\n    MsgBox \"Welcome to Merging Platform...\"\n\n    Application.ScreenUpdating = True\n    Set mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    'change folder path of excel files here\n    Set dirObj = mergeObj.Getfolder(\"C:\\Users\\00508069\\Desktop\\New folder\\data\")\n    Set filesObj = dirObj.Files\n    For Each everyObj In filesObj\n    Set bookList = Workbooks.Open(everyObj)\n\n    'change \"A2\" with cell reference of start point for every files here\n    'for example \"B3:IV\" to merge all files start from columns B and rows 3\n    'If you're files using more than IV column, change it to the latest column\n    'Also change \"A\" column on \"A65536\" to the same column as start point\n\n    Range(\"A9:IV\" &amp; Range(\"A10\").End(xlUp).Row).Copy\n\n    ThisWorkbook.Worksheets(1).Activate\n\n    'Do not change the following column. It's not the same column as above\n    Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\n\n\n    Application.CutCopyMode = False\n    bookList.Close\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "forms", "listbox"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1501064124, "post_id": 45323704, "comment_id": 77609658, "body": "Please don&#39;t put your code in a snippet, as it can&#39;t run there is no need for it. Just format is as code by indenting with 4 spaces."}, {"owner": {"reputation": 1, "user_id": 8369178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6b6e9d64650b5c1a16e7542f0f72b9?s=128&d=identicon&r=PG&f=1", "display_name": "D.Tailleur", "link": "https://stackoverflow.com/users/8369178/d-tailleur"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1501064471, "post_id": 45323704, "comment_id": 77609913, "body": "ok I changed that, any idea to solve my issue ?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1501064708, "post_id": 45323704, "comment_id": 77610079, "body": "Well first of all this only seams to be a small part of the code, at least the declarations are missing. So please provide a MCVE (<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>). Also this code doesn&#39;t work isn&#39;t a propper question. What happens when you run it, what error message is shown. That should be a great way to start fixing your code, as you can google the error mesage and deduct the problem from that."}, {"owner": {"reputation": 1, "user_id": 8369178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6b6e9d64650b5c1a16e7542f0f72b9?s=128&d=identicon&r=PG&f=1", "display_name": "D.Tailleur", "link": "https://stackoverflow.com/users/8369178/d-tailleur"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1501065470, "post_id": 45323704, "comment_id": 77610624, "body": "there is no error message, when I double click on an element of the list it just does nothing."}, {"owner": {"reputation": 1, "user_id": 8369178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6b6e9d64650b5c1a16e7542f0f72b9?s=128&d=identicon&r=PG&f=1", "display_name": "D.Tailleur", "link": "https://stackoverflow.com/users/8369178/d-tailleur"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1501065581, "post_id": 45323704, "comment_id": 77610689, "body": "and yes, indeed, there is no declaration because there is no declaration needed. I just putted a ListBox and a TextBox in my UserForm, that&#39;s all"}, {"owner": {"reputation": 1, "user_id": 8369178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6b6e9d64650b5c1a16e7542f0f72b9?s=128&d=identicon&r=PG&f=1", "display_name": "D.Tailleur", "link": "https://stackoverflow.com/users/8369178/d-tailleur"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1501065677, "post_id": 45323704, "comment_id": 77610747, "body": "if I post this on stackoverflow today it is because I didn&#39;t found a solution to my issue on the internet"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 9068671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1a4237f7beac529e5e42ac69d1049?s=128&d=identicon&r=PG&f=1", "display_name": "DC Holmes", "link": "https://stackoverflow.com/users/9068671/dc-holmes"}, "is_accepted": false, "score": 5, "last_activity_date": 1535374286, "creation_date": 1535374286, "answer_id": 52039801, "question_id": 45323704, "link": "https://stackoverflow.com/questions/45323704/double-click-event-on-the-items-of-the-listbox-of-a-userform-vba/52039801#52039801", "title": "Double Click Event on the items of the ListBox of a Userform VBA", "body": "<p>The name of the Event Handler you are looking for is Listbox1_DblClick.  Try this:</p>\n\n<pre><code>Private Sub Listbox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n  With Me.ListBox1\n    For i = 0 To .ListCount - 1\n      If .Selected(i) Then\n        Me.TextBox1.Value = .List(i, 0)\n        Exit For\n      End If\n    Next\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8369178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6b6e9d64650b5c1a16e7542f0f72b9?s=128&d=identicon&r=PG&f=1", "display_name": "D.Tailleur", "link": "https://stackoverflow.com/users/8369178/d-tailleur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13718, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535374286, "creation_date": 1501063414, "last_edit_date": 1501065752, "question_id": 45323704, "link": "https://stackoverflow.com/questions/45323704/double-click-event-on-the-items-of-the-listbox-of-a-userform-vba", "title": "Double Click Event on the items of the ListBox of a Userform VBA", "body": "<p>I am trying to do a small \"save as\" interface on excel using vba, so that I can save some of the information that i have putted in my sheet in another sheet. I am almost done with it and it looks like this: <a href=\"https://i.stack.imgur.com/XBKSj.png\" rel=\"nofollow noreferrer\">click here to see my Save As interface</a></p>\n\n<p>My problem is that I want to put an event on double clicking on one of the elements of my list, let's say SoCs2. On double click, I want the string \"SoCs2\" to appear in the textbox below. </p>\n\n<p>I tried something like that:</p>\n\n<pre><code>Private Sub Listbox1_BeforeDoubleClick(ByVal Cancel As MSForms.ReturnBoolean)\n\nWith Me.ListBox1\n     For i = 0 To .ListCount - 1\n       If .Selected(i) Then\n         Me.TextBox1.Value = .List(i, 0)\n         Exit For\n       End If\n     Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>My ListBox is called ListBox1 and my TextBox is called TextBox1.\nUnfortunately, this code doesn't work: when I double click on one of the items of my ListBox, it does absolutely nothing.\nCan somebody help me with this issue ? </p>\n"}, {"tags": ["vba", "excel", "text-files"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501075193, "post_id": 45326300, "comment_id": 77617979, "body": "Thank you kindly for this code!!! Much appreciated. It is working perfectly apart from one thing regarding my text files. This code does not seem to find the line breaks in my text files, instead treating the text as one continuous line. In my initial code you will see that I had to define a separator (Sep) as &#39;vbLf&#39; which I was able to use to show the line breaks in the text files. Is there a simple way of incorporating this back into the code?"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501075659, "post_id": 45326300, "comment_id": 77618342, "body": "I didn&#39;t understand why you need to find the line breaks. I ran your code and it did the same as mine: treated every line as a single text and put the whole line in a single cell. @Jon"}, {"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501077288, "post_id": 45326300, "comment_id": 77619703, "body": "Hi Rafael, the issue is that for my text files it cannot find where each line of the text files ends and rather treats the whole file as one very long line. I&#39;m not sure why this happens, I am guessing it&#39;s some kind of character encoding unix line endings something or other with my text files that the code doesn&#39;t pick up.  The link below talks about this very issue. <a href=\"https://www.mrexcel.com/forum/excel-questions/787225-vba-reading-text-file-parsing-line-breaks-carriage-returns.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501079493, "post_id": 45326300, "comment_id": 77621592, "body": "@Jon I re-edited the code. Since I don&#39;t have the right text file like you, I&#39;m not sure if it will works out. But you can try."}, {"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501081658, "post_id": 45326300, "comment_id": 77623428, "body": "Thanks so much Rafael. that now works perfectly for me. Much appreciated :)"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501081876, "post_id": 45326300, "comment_id": 77623617, "body": "@Jon You&#39;re welcome. Just hit this answer as useful, please."}, {"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501153208, "post_id": 45326300, "comment_id": 77658662, "body": "Done. One thing I have noticed since is that it no longer reads the number beside &quot;CELL_DATA&quot; and use that number to copy the correct number of values beneath it. Instead it just copies everything beneath the line &quot;LOOKUP_TABLE default&quot;. :/"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501159502, "post_id": 45326300, "comment_id": 77663272, "body": "@Jon You could debug the program and see what the value of NumberOfData are getting."}, {"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501597123, "post_id": 45326300, "comment_id": 77841931, "body": "Not sure how to return the value of NumberOfData that the code is finding :/"}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "reply_to_user": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501668475, "post_id": 45326300, "comment_id": 77875744, "body": "@Jon You can use the Watch to see the values of your variables. To use that, choose the menu Debug and then select &quot;Add Watch&quot;. In the dialog box, put the name of the variable you want do watch and then debug your code using <code>F8</code>."}, {"owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "edited": false, "score": 0, "creation_date": 1501836331, "post_id": 45326300, "comment_id": 77964936, "body": "Thanks Rafael. I&#39;m not the most competent with VBA. FYI I found a typo to one of the NumberOfData variables which cause the issue. Sorted now :)"}], "tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": true, "score": 0, "last_activity_date": 1501839446, "last_edit_date": 1501839446, "creation_date": 1501070263, "answer_id": 45326300, "question_id": 45323594, "link": "https://stackoverflow.com/questions/45323594/copy-specific-lines-from-text-files-into-excel/45326300#45326300", "title": "Copy specific lines from text files into excel", "body": "<p>Give this a try:</p>\n\n<pre><code>Dim RowNdx As Integer\nDim ColNdx As Integer\nDim TempVal As String\nDim WholeLine As String\nDim Pos As Integer\nDim NextPos As Long\nDim SaveColNdx As Integer\nDim SaveRowNdx As Long\nDim FoundData As Boolean\nDim NumberOfData As Long\n\nFName = \"E:\\zdump\\\"\nMyFile = Dir(FName &amp; \"*.txt\")\nSep = vbLf\n\nColNdx = ActiveCell.Column\nRowNdx = ActiveCell.Row\nSaveRowNdx = RowNdx\n\nDo While MyFile &lt;&gt; \"\"\n    Open (FName &amp; MyFile) For Input As #1\n\n    While Not EOF(1)\n        Line Input #1, WholeLine\n\n        If Right(WholeLine, 1) &lt;&gt; Sep Then\n            WholeLine = WholeLine &amp; Sep\n        End If\n        Pos = 1\n        NextPos = InStr(Pos, WholeLine, Sep)\n        While NextPos &gt;= 1\n            TempVal = Mid(WholeLine, Pos, NextPos - Pos)\n\n            If FoundData = False Then\n                If InStr(TempVal, \"CELL_DATA\") Then\n                    NumberOfData = Val(Right(TempVal, Len(TempVal) - Len(Left(TempVal, Len(\"CELL_DATA\") + 1))))\n                End If\n\n                If InStr(TempVal, \"LOOKUP_TABLE default\") &lt;&gt; 0 Then\n                    FoundData = True\n                End If\n\n                Pos = NextPos + 1\n                NextPos = InStr(Pos, WholeLine, Sep)\n            Else\n                If NumberOfData &lt;&gt; 0 Then\n                    Cells(RowNdx, ColNdx).Value = TempVal\n                    Pos = NextPos + 1\n                    RowNdx = RowNdx + 1\n                    NextPos = InStr(Pos, WholeLine, Sep)\n                    NumberOfData = NumberOfData - 1\n                End If\n            End If\n        Wend\n\n    Wend\n    Close #1\n    FoundData = False\n    ColNdx = ColNdx + 1\n    Cells(SaveRowNdx, ColNdx).Activate\n    RowNdx = SaveRowNdx\n    MyFile = Dir()\n    'Debug.Print Text\nLoop\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8344317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IeStz.jpg?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/8344317/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3567, "favorite_count": 0, "accepted_answer_id": 45326300, "answer_count": 1, "score": 0, "last_activity_date": 1501839446, "creation_date": 1501063140, "last_edit_date": 1501063309, "question_id": 45323594, "link": "https://stackoverflow.com/questions/45323594/copy-specific-lines-from-text-files-into-excel", "title": "Copy specific lines from text files into excel", "body": "<p>I have developed the below code to open a large number of text files (within the same folder) and copy everything from each file into excel (one cell for each line of text file &amp; one row for each text file).</p>\n\n<p>However, I do not require all of the data from the text files and it is slowing down the process. The text files are in following format:</p>\n\n<pre><code>DATASET UNSTRUCTURED_GRID\nPOINTS 5 float\n0.096853 0.000000 0.111997\n0.096853 -0.003500 0.111997\n0.096890 0.000000 0.084015\n0.096853 -0.003500 0.111997\n0.096890 -0.003500 0.084015\nCELL_DATA 5\nSCALARS pressure float 1\nLOOKUP_TABLE default\n-0.000000\n-0.000000\n-3.000000\n-2.000000\n-6.000000\n</code></pre>\n\n<p>The data that I need to copy from this file is the second batch of numbers (below \"LOOKUP_TABLE default\"). The number of lines in this example is five (as stated on line starting \"CELL_DATA\" but this number can change from file to file.</p>\n\n<p>In summary, I'm looking my code to only copy this last batch of numbers into excel instead of everything but I'm at a loss on how to tackle this.</p>\n\n<p>Any help or advice would be greatly appreciated.</p>\n\n<p>Sub ImportTextFile()</p>\n\n<pre><code>Dim RowNdx As Integer\nDim ColNdx As Integer\nDim TempVal As String\nDim WholeLine As String\nDim Pos As Integer\nDim NextPos As Long\nDim SaveColNdx As Integer\n\nFName = \"E:\\zdump\\\"\nMyFile = Dir(FName &amp; \"*.txt\")\nSep = vbLf\n\nSaveColNdx = ActiveCell.Column\nRowNdx = ActiveCell.Row\n\nDo While MyFile &lt;&gt; \"\"\n    Open (FName &amp; MyFile) For Input As #1\n\n    While Not EOF(1)\n        Line Input #1, WholeLine\n        If Right(WholeLine, 1) &lt;&gt; Sep Then\n            WholeLine = WholeLine &amp; Sep\n        End If\n        ColNdx = SaveColNdx\n        Pos = 1\n        NextPos = InStr(Pos, WholeLine, Sep)\n        While NextPos &gt;= 1\n            TempVal = Mid(WholeLine, Pos, NextPos - Pos)\n            Cells(RowNdx, ColNdx).Value = TempVal\n            Pos = NextPos + 1\n            ColNdx = ColNdx + 1\n            NextPos = InStr(Pos, WholeLine, Sep)\n        Wend\n        RowNdx = RowNdx + 1\n    Wend\n    Close #1\n    MyFile = Dir()\n    Debug.Print text\nLoop End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1501063179, "creation_date": 1501063179, "answer_id": 45323611, "question_id": 45323422, "link": "https://stackoverflow.com/questions/45323422/creating-service-agreement-for-a-macro-with-vba/45323611#45323611", "title": "Creating Service Agreement for a Macro with VBA", "body": "<p>In general, something like this may be of use:</p>\n\n<ul>\n<li>add a database</li>\n<li>read something from it</li>\n<li>if the value is not read, give a nasty msgbox and close the workbook w/o saving</li>\n<li>write in the db the date first time the user uses the VBA tool</li>\n<li>check if there are 6 months after this date</li>\n<li>if there are 6 months -> ask for renual with a nasty msgbox and close the workbook w/o saving</li>\n</ul>\n"}], "owner": {"reputation": 111, "user_id": 8317463, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/decd2d9e32857ddb62b76a87eecdd1b5?s=128&d=identicon&r=PG&f=1", "display_name": "RBK", "link": "https://stackoverflow.com/users/8317463/rbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 45323611, "answer_count": 1, "score": 0, "last_activity_date": 1501063179, "creation_date": 1501062744, "last_edit_date": 1531164843, "question_id": 45323422, "link": "https://stackoverflow.com/questions/45323422/creating-service-agreement-for-a-macro-with-vba", "title": "Creating Service Agreement for a Macro with VBA", "body": "<p>I want to create an SLA for a macro.\nFor example, I have created a functionality with help of Excel VBA.\nMacro gets executed whenever trying to execute within 6 months.\nIf we try to execute that macro after 6 months it should not work, rather it should ask for renewal or so. </p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501063023, "post_id": 45323418, "comment_id": 77608779, "body": "1. Are you sure you have object named &quot;Chart 1&quot; in your sheet? If you use non-English version of Excel, this name can be in your language and you have to change it in code. 2. Did you changed anything in code from linked question? If so, can you provide it?"}, {"owner": {"reputation": 9, "user_id": 8368905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwZaTLlpS-I/AAAAAAAAAAI/AAAAAAAAASE/7u6yhGG4IOA/photo.jpg?sz=128", "display_name": "Muhmood Zubair", "link": "https://stackoverflow.com/users/8368905/muhmood-zubair"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501064977, "post_id": 45323418, "comment_id": 77610277, "body": "@EganWolf Wolf thanks very much for your response. Really appreciate it.  1. Yes, i&#39;m sure I have an object named &quot;Chart 1&quot; in the sheet. 2. No, I changed nothing of the codes."}, {"owner": {"reputation": 9, "user_id": 8368905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwZaTLlpS-I/AAAAAAAAAAI/AAAAAAAAASE/7u6yhGG4IOA/photo.jpg?sz=128", "display_name": "Muhmood Zubair", "link": "https://stackoverflow.com/users/8368905/muhmood-zubair"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501065573, "post_id": 45323418, "comment_id": 77610685, "body": "I have tried running the codes in another workbook. Now there&#39;s no error in that line. But after running the macro nothing happens to the overlapping data labels."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501069322, "post_id": 45323418, "comment_id": 77613443, "body": "You can debug your code by opening VBA editor, putting text cursor somewhere within the code and pressing F8 to run it line by line (more info in <a href=\"https://stackoverflow.com/documentation/excel-vba/861/debugging-and-troubleshooting#t=201707261141084903658\">docs</a>). It should let you find out what is wrong."}, {"owner": {"reputation": 9, "user_id": 8368905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwZaTLlpS-I/AAAAAAAAAAI/AAAAAAAAASE/7u6yhGG4IOA/photo.jpg?sz=128", "display_name": "Muhmood Zubair", "link": "https://stackoverflow.com/users/8368905/muhmood-zubair"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501130963, "post_id": 45323418, "comment_id": 77644759, "body": "@EganWolf thanks again. Tried pressing F8 and now it shows error in the following three lines.        Sub MoveLabels()          Set sh = ActiveSheet          Set ch = sh.ChartObjects(&quot;Chart 1&quot;).Chart"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501135076, "post_id": 45323418, "comment_id": 77646231, "body": "Are you aware that linked answer doesn&#39;t change anything if just copied and run? You need to implement some strategy to move labels for every <code>&#39; Overlap!</code> comment."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1501135334, "post_id": 45323418, "comment_id": 77646332, "body": "Did you check if sheet under <code>sh</code> variable is a proper sheet? It takes <code>ActiveSheet</code>, that means the sheet that is visible in your Excel."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8368905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwZaTLlpS-I/AAAAAAAAAAI/AAAAAAAAASE/7u6yhGG4IOA/photo.jpg?sz=128", "display_name": "Muhmood Zubair", "link": "https://stackoverflow.com/users/8368905/muhmood-zubair"}, "edited": false, "score": 0, "creation_date": 1501129783, "post_id": 45329815, "comment_id": 77644347, "body": "thanks for the reply. But it does not work. Still shows error in that line and in subsequent lines."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1501079112, "creation_date": 1501079112, "answer_id": 45329815, "question_id": 45323418, "link": "https://stackoverflow.com/questions/45323418/run-time-error-while-running-vba-code-for-moving-overlapping-chart-data-labels/45329815#45329815", "title": "Run-time error while running VBA code for moving overlapping chart data labels", "body": "<p>Try like this:</p>\n\n<pre><code>Set ch = activesheet.ChartObjects(1).Chart\n</code></pre>\n\n<p>It should work. It refers the first chart in the ActiveSheet. If you have <code>N</code> charts, delete all of them but one, it would refer to it.</p>\n"}], "owner": {"reputation": 9, "user_id": 8368905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwZaTLlpS-I/AAAAAAAAAAI/AAAAAAAAASE/7u6yhGG4IOA/photo.jpg?sz=128", "display_name": "Muhmood Zubair", "link": "https://stackoverflow.com/users/8368905/muhmood-zubair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501079112, "creation_date": 1501062738, "last_edit_date": 1531164843, "question_id": 45323418, "link": "https://stackoverflow.com/questions/45323418/run-time-error-while-running-vba-code-for-moving-overlapping-chart-data-labels", "title": "Run-time error while running VBA code for moving overlapping chart data labels", "body": "<p>Referring to Chris Nielsen's answer in this link:  <a href=\"https://stackoverflow.com/questions/8770429/excel-macro-to-fix-overlapping-data-labels-in-line-chart\">link</a></p>\n\n<p>I'm totally a novice in VBA coding. Just searching for a solution for moving overlapping data labels for my work which could save me a huge amount of time.</p>\n\n<p>But when running the 1st code i.e. MovingLabels() a problem occurs in the following line.</p>\n\n<pre><code>Set ch = sh.ChartObjects(\"Chart 1\").Chart\n</code></pre>\n\n<p>Would really appreciate if anyone can help. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1501064934, "post_id": 45323268, "comment_id": 77610248, "body": "You say you want to shift by one <b>column</b> each time, but going from <code>B3</code> to <code>B4</code> is  shifting the <b>row</b>. Could you please clarify? Do you eventually want each <b>vertical</b> block of 51 cells in sheet1 to be on its own <b>row</b> in sheet2? This is perhaps confused by the fact you&#39;ve used the word &quot;transpose&quot; which implies flipping columns to rows"}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1501065299, "post_id": 45323268, "comment_id": 77610492, "body": "Sorry that was a typo on my part, I&#39;ll amend the question. Essentially what I want to do is take each vertical block of cells and line them up side by side on the output page - So actually transpose was also the incorrect term."}], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 5173968, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf7dc9eca18773aa93d70a2e1f0a0c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5173968/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1504428651, "last_edit_date": 1504428651, "creation_date": 1501063379, "answer_id": 45323694, "question_id": 45323268, "link": "https://stackoverflow.com/questions/45323268/excel-vba-looping-reshape-column-into-table/45323694#45323694", "title": "Excel VBA looping: reshape column into table", "body": "<p>Just made this example which has values 1 through 7 populated on the first 7 rows of column A. This code effectively loops through each of the values, and transposes horizontally so all values are on a single row (1).</p>\n\n<pre><code>Dim rng As Range\nDim crng As Range\nStatic value As Integer\n\nSet rng = ActiveSheet.Range(\"A1\", Range(\"A1\").End(xlDown))\n\n    For Each crng In rng.Cells\n        ActiveSheet.Range(\"A1\").Offset(0, value).value = crng.value\n        If value &lt;&gt; 0 Then\n            crng.value = \"\"\n        End If\n        value = value + 1\n    Next crng\n</code></pre>\n\n<p>First we grab the required range and then iterate through each cell. Then using the <code>offset</code> method and an incrementing integer, we can assign their values horizontally to a single row. </p>\n\n<p>It's worth noting that this would work when trying to transpose both vertically and horizontally. The key is the <code>offset(column, row)</code>.</p>\n\n<p>Just adjust where you place your incrementing Integer. </p>\n\n<p>Hope this helps. </p>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1501065772, "post_id": 45323705, "comment_id": 77610814, "body": "I couldn&#39;t get this code to work with a 1D range input &amp; some destination... however you should also see the OP&#39;s edit as they clarified that the word &quot;transpose&quot; was a mistype and I&#39;m not sure how relevant this is any more"}, {"owner": {"reputation": 210, "user_id": 8205970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa718bc0e864734c74c657e23b8f555a?s=128&d=identicon&r=PG&f=1", "display_name": "B Slater", "link": "https://stackoverflow.com/users/8205970/b-slater"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1501068242, "post_id": 45323705, "comment_id": 77612587, "body": "Hi, fixed it so that it works in those cases. I probably should&#39;ve put more effort into reading the OP&#39;s code to know what he wanted, cheers!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1501068311, "post_id": 45323705, "comment_id": 77612642, "body": "Nice one, glad your code could be edited to work for this case :)"}], "tags": [], "owner": {"reputation": 210, "user_id": 8205970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa718bc0e864734c74c657e23b8f555a?s=128&d=identicon&r=PG&f=1", "display_name": "B Slater", "link": "https://stackoverflow.com/users/8205970/b-slater"}, "is_accepted": false, "score": 0, "last_activity_date": 1501068160, "last_edit_date": 1501068160, "creation_date": 1501063417, "answer_id": 45323705, "question_id": 45323268, "link": "https://stackoverflow.com/questions/45323268/excel-vba-looping-reshape-column-into-table/45323705#45323705", "title": "Excel VBA looping: reshape column into table", "body": "<p>When dealing with your worksheets in excel, each time you reference them adds overhead and slows down the code, what you want to do is take all of the info off your spreadsheet into an array then use <code>Application.Transpose</code> to transpose it for you.</p>\n\n<p>You can then use 'Resize' to make sure your destination range is the same size and set the values.</p>\n\n<pre><code>Sub CopyAndTransRange(src As Range, dest As Range)\n    Dim arr As Variant                          'Needs to be a variant to take cell values\n    arr = Application.Transpose(src.Value)      'Set to array of values\n\n    On Error GoTo eh1dim                        'Capture error from vertical 1D range\n    dest.Resize( _\n        UBound(arr, 1) - LBound(arr, 1) + 1, _\n        UBound(arr, 2) - LBound(arr, 2) + 1 _\n    ) = arr                                     'Set destination to array\nExit Sub\neh1dim:\n    dest.Resize( _\n        1, _\n        UBound(arr) - LBound(arr) + 1 _\n    ) = arr                                     'Set row to 1D array\nEnd Sub\n</code></pre>\n\n<p>Note, Application.Transpose will fall over with some arrays in weird circumstances like if there is more than 255 characters in a string in the given array, for those situations you can write your own Transpose function to flip the array for you.</p>\n\n<p>Edit:</p>\n\n<p>When you feed a vertical 1-dimensional range and transpose it, VBA converts it to a 1-dimensional array, I've rewritten so it captures the error when this happens then adjusts accordingly.</p>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1501066231, "post_id": 45324534, "comment_id": 77611127, "body": "I also have a value in column C which I would like to put into cell B2 on the output page, it needs offset down by 42 each time. I think I should be able to follow your method to do this also?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1501066329, "post_id": 45324534, "comment_id": 77611180, "body": "I have included a method to loop until the original column&#39;s value is empty, it&#39;s a crude way to avoid using <code>nblocks</code> and loop until the end. Yes it sounds like you should be able to change the value of <code>blocksize</code> to 42 and use similar logic."}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1501068481, "post_id": 45324534, "comment_id": 77612775, "body": "Thanks for that - really appreciate it! I&#39;ve had a crack at doing it for the names but drawing a blank, if I add my attempt to the question would you mind having a quick look to see where I&#39;m going wrong?"}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1501068688, "post_id": 45324534, "comment_id": 77612936, "body": "Thanks! I&#39;ve just tacked it onto the end of the op, its actually down 51 as well, not 42."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 1, "last_activity_date": 1501069445, "last_edit_date": 1501069445, "creation_date": 1501065520, "answer_id": 45324534, "question_id": 45323268, "link": "https://stackoverflow.com/questions/45323268/excel-vba-looping-reshape-column-into-table/45324534#45324534", "title": "Excel VBA looping: reshape column into table", "body": "<p>Your logic seems alright, this code will create a <code>51 x n</code> table, lining up each vertical block of 51 cells in its own column.</p>\n\n<p>Note, it's <em>much</em> quicker to assign the <code>.Value</code> than copying and pasting, if you need formats too then you could copy/paste or similarly set format properties equal.</p>\n\n<pre><code>Sub ColumnToTable()\n    ' Assign first block to range, using easily changable parameters\n    ' Remember to \"Dim\" all of your variables, using colon for line continuation\n    Dim blocksize As Long: blocksize = 51\n    Dim firstrow As Long:  firstrow = 262\n    Dim rng As Range\n    Set rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"L\" &amp; firstrow &amp; \":L\" &amp; firstrow + blocksize - 1)\n    ' tablestart is the upper left corner of the \"pasted\" table\n    Dim tablestart As Range: Set tablestart = ThisWorkbook.Sheets(\"Sheet2\").Range(\"B3\")\n    Dim i As Long                      ' Looping variable i\n    Dim nblocks As Long: nblocks = 10  ' We're going to loop nblocks number of times\n    For i = 0 To nblocks - 1\n        ' Do the actual value copying, using Resize to set the number of rows\n        ' and using Offset to move down the original values and along the \"pasted\" columns\n        tablestart.Offset(0, i).Resize(blocksize, 1).Value = _\n                                                      rng.Offset(blocksize * i, 0).Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Set the <code>nblocks</code> value to suit your needs, this is the number of resulting columns in your output table. You could get it dynamically by knowing the number of rows in the original column. Or you could use some <code>while</code> logic, careful to make sure that it does eventually exit of course!</p>\n\n<pre><code>Dim i As Long: i = 0\nDo While rng.Offset(blocksize*i, 0).Cells(1).Value &lt;&gt; \"\"\n    tablestart.Offset(0, i).Resize(blocksize, 1).Value = rng.Offset(blocksize * i, 0).Value\n    i = i + 1\nLoop\n</code></pre>\n\n<hr>\n\n<p>Edit: to get your column headings, keep in mind that the column headings are only 1 cell, so:</p>\n\n<pre><code>' Change this:\nSet rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C\" &amp; firstrow &amp; blocksize - 1)\n' To this:\nSet rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C\" &amp; firstrow)\n</code></pre>\n\n<p>Tip: <code>+</code> is used for adding numerical values, whilst <code>&amp;</code> is used for concatenating stings.</p>\n\n<p>Now when you're looping, you don't need the <code>Resize</code>, because you are only assigning 1 cell's value to 1 other cell. Resulting sub:</p>\n\n<pre><code>Sub NameToTable()\n    Dim blocksize As Long: blocksize = 51\n    Dim firstrow As Long:  firstrow = 258\n    Dim rng As Range    \n    Set rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C\" &amp; firstrow)   \n    Dim tablestart As Range: Set tablestart = ThisWorkbook.Sheets(\"Sheet2\").Range(\"B2\")\n    Dim i As Long: i = 0\n    Do While rng.Offset(blocksize*i, 0).Value &lt;&gt; \"\"\n        tablestart.Offset(0, i).Value = rng.Offset(blocksize * i, 0).Value\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 45324534, "answer_count": 3, "score": 1, "last_activity_date": 1504428651, "creation_date": 1501062341, "last_edit_date": 1501069706, "question_id": 45323268, "link": "https://stackoverflow.com/questions/45323268/excel-vba-looping-reshape-column-into-table", "title": "Excel VBA looping: reshape column into table", "body": "<p>I have not used VBA for sometime so am very rusty... What I have is a number of records stored vertically (in a single column) and I want to use VBA to stack them side by side (into a table). </p>\n\n<p>My general thoughts about how this would flow: </p>\n\n<ol>\n<li>Start at first range </li>\n<li>Copy data  </li>\n<li>Paste data in cell B3 of output page (just named Sheet2) </li>\n<li>Loop back to previous range and offset by 51 rows</li>\n<li>Copy data </li>\n<li>Paste data in cell C3 of output page (offset by 1 column each time)</li>\n</ol>\n\n<p>My attempt so far:         </p>\n\n<pre><code>    Sub Macro1()        \n        FiftyOne = 51 ' Offset by 51 rows for every chunk\n        StartRange = \"L262:L303\" ' Start at this range of data to copy, each chunk is identical in size\n        OutputRange = B3 ' Paste in output at B3, but need to offset by one column each time     \n\n        Range(StartRange).Offset(FiftyOne, 0).Select\n        Selection.Copy\n\n        Sheets(\"Sheet2\").Select\n        Range(\"B3\").Offset(0, 1).Select\n        ActiveSheet.Paste    \n    End Sub\n</code></pre>\n\n<p>I know this is a rather lame attempt to tackle this flow, but I am really struggling with how to loop through this. I would appreciate some advice on how to do this, or a better approach to the general flow. </p>\n\n<hr>\n\n<p><strong>Edit</strong> after accepting Wolfie's answer:</p>\n\n<p>I want to assign column headings, by getting the values from C258 and looping down (in a similar way to before) 51 rows at a time, to paste into row 2 of sheet2 (B2, C2, ...).</p>\n\n<p>Here is my current attempt:</p>\n\n<pre><code>Sub NameToTable()\n    ' Assign first block to range, using easily changable parameters\n    ' Remember to \"Dim\" all of your variables, using colon for line continuation\n\n    Dim blocksize As Long: blocksize = 51\n    Dim firstrow As Long:  firstrow = 258\n    Dim rng As Range\n\n    Set rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C\" &amp; firstrow &amp; blocksize - 1)\n    ' tablestart is the upper left corner of the \"pasted\" table\n\n\n\n    Dim tablestart As Range: Set tablestart = ThisWorkbook.Sheets(\"Sheet2\").Range(\"B2\")\n    Dim i As Long                      ' Looping variable i\n    Dim nblocks As Long: nblocks = 10  ' We're going to loop nblocks number of times\n\n    For i = 0 To nblocks - 1\n        ' Do the actual value copying, using Resize to set the number of rows\n        ' and using Offset to move down the original values and along the \"pasted\" columns\n        tablestart.Offset(0, i).Resize(blocksize, 1).Value = _\n                                                      rng.Offset(blocksize * i, 0).Value\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1501062171, "post_id": 45323101, "comment_id": 77608114, "body": "@Mrig The error is still there..."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501063151, "post_id": 45323428, "comment_id": 77608892, "body": "I added <code>dataWorkbook.Activate</code> but it still fails("}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501063347, "post_id": 45323428, "comment_id": 77609035, "body": "Your code worked. Now I&#39;m completely confused. Thank you for your answer though, but it&#39;s very very weird."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501063677, "post_id": 45323428, "comment_id": 77609289, "body": "I have a more complicated code that first opens a <code>resultWorkbook</code> outside the loop, then opens one of the files in a folder, copies-pastes the range to <code>resultWorkbook</code>, saves <code>resultWorkbook</code>, loops to the next file. So the <code>resultWorkbook</code> never closes there is always opened before the file, and <code>dataWorkbook.Activate</code> doesn&#39;t help there."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501063795, "post_id": 45323428, "comment_id": 77609388, "body": "@Ans - start debugging line by line of your code and check is happening. Try to simplify it, it should work."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1501062754, "creation_date": 1501062754, "answer_id": 45323428, "question_id": 45323101, "link": "https://stackoverflow.com/questions/45323101/application-defined-or-object-defined-error-when-opening-a-second-workbook/45323428#45323428", "title": "Application defined or object-defined error when opening a second workbook", "body": "<p>Try like this:</p>\n\n<pre><code>Option Explicit\n\n Sub TestMe()\n\n    Dim folderPath      As String\n    Dim dataWorkbook    As Workbook\n    Dim resultWorkbook  As Workbook\n    Dim copyRange       As Range\n\n    folderPath = \"C:\\Users\\USER_CHANGE\\Desktop\\\"\n    Set dataWorkbook = Application.Workbooks.Open(folderPath &amp; \"5.xlsx\")\n    Set resultWorkbook = Application.Workbooks.Open(folderPath &amp; \"6.xlsx\")\n\n    dataWorkbook.Activate\n    Set copyRange = dataWorkbook.Worksheets(1).Range(\"A3:F3\", Range(\"A3\").End(xlDown))\n\n    copyRange.Copy\n    resultWorkbook.Worksheets(1).Range(\"A3\").PasteSpecial Paste:=xlPasteFormulas\n\n    dataWorkbook.Close True\n    resultWorkbook.Close True\n\nEnd Sub\n</code></pre>\n\n<p>I have changed a bit the folderPath and I have added a <code>dataWorkbook.Activate</code>, for the copying and pasting. There are other ways around, to avoid the activation, but it works. At the end, I close both workbooks and I save the changes.</p>\n\n<p>Furthermore, <code>Worksheets</code> are refered by index.</p>\n"}, {"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501063785, "post_id": 45323668, "comment_id": 77609381, "body": "Thanks. But why though it would result in an error? So even if looks at <code>resultWorkbook</code> and takes it&#39;s <code>Range</code>, what&#39;s so wrong with it to throw an error?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1501063929, "post_id": 45323668, "comment_id": 77609492, "body": "It&#39;s because you&#39;re telling it to create a range from two different sheets across two different workbooks.  The range <code>A1:F3</code> must be on the same sheet - you&#39;re telling it to start at <code>A1</code> on the <code>List</code> sheet and end at <code>F3</code> on whichever sheet is active."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1501064218, "post_id": 45323668, "comment_id": 77609726, "body": "You may also want to change the code that finds the last cell.  If A4 downwards is empty <code>copyRange</code> will refer to <code>$A$3:$F$1048576</code>.  If you use <code>.Range(&quot;A3:F3&quot;, .Cells(.Rows.Count, 1).End(xlUp))</code> then it will refer to <code>$A$1:$F$3</code> and you can check if the first row is less than 3 then there&#39;s no valid data."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1501064390, "post_id": 45323668, "comment_id": 77609850, "body": "Thanks I might consider this, but for now it looks like all my files have no empty cells in A column - in valid range."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1501063310, "creation_date": 1501063310, "answer_id": 45323668, "question_id": 45323101, "link": "https://stackoverflow.com/questions/45323101/application-defined-or-object-defined-error-when-opening-a-second-workbook/45323668#45323668", "title": "Application defined or object-defined error when opening a second workbook", "body": "<p>It depends which workbook you have active when you run the code.<br>\nThis line of code potentially looks at two different workbooks:<br>\n<code>Set copyRange = dataWorkbook.Worksheets(\"List\").Range(\"A3:F3\", Range(\"A3\").End(xlDown))</code>.   </p>\n\n<p><code>dataWorkbook.Worksheets(\"List\").Range(\"A3:F3\"</code> - this always looks at the <code>List</code> sheet in the <code>dataWorkbook</code>.  </p>\n\n<p><code>Range(\"A3\").End(xlDown)</code> - this always looks at the currently activesheet which is in <code>resultWorkBook</code> when those lines aren't commented out.</p>\n\n<p>Use:<br>\n<code>Set copyRange = dataWorkbook.Worksheets(\"List\").Range(\"A3:F3\", dataWorkbook.Worksheets(\"List\").Range(\"A3\").End(xlDown))</code>  </p>\n\n<p>or  </p>\n\n<pre><code>With dataWorkbook.Worksheets(\"List\")\n    Set copyRange = .Range(\"A3:F3\", .Range(\"A3\").End(xlDown))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501063310, "creation_date": 1501061948, "last_edit_date": 1501062892, "question_id": 45323101, "link": "https://stackoverflow.com/questions/45323101/application-defined-or-object-defined-error-when-opening-a-second-workbook", "title": "Application defined or object-defined error when opening a second workbook", "body": "<p>I have this code where I open 1st workbook, then open the 2nd workbook, copy a range from the 1st workbook and paste it in the 2nd workbook. </p>\n\n<pre><code> Sub test()\n        '**VARIABLES**\n        Dim folderPath As String\n        folderPath = \"Y:\\plan_graphs\\final\\mich_alco_test\\files\\\"\n        Dim fileTitle As String\n        fileTitle = \"5.xlsx\"\n\n        Dim dataWorkbook As Workbook\n        Set dataWorkbook = Application.Workbooks.Open(folderPath &amp; fileTitle)\n\n        'Dim resultWorkbook As Workbook\n        'Set resultWorkbook = Application.Workbooks.Open(\"Y:\\plan_graphs\\final\\mich_alco_test\\result.xlsx\")\n\n        Dim copyRange As Range\n        Set copyRange = dataWorkbook.Worksheets(\"List1\").Range(\"A3:F3\", Range(\"A3\").End(xlDown))\n\n        copyRange.Copy\n        'resultWorkbook.Worksheets(\"1\").Range(\"A3\").PasteSpecial Paste:=xlPasteFormulas\n\n\nEnd Sub\n</code></pre>\n\n<p>But I get the <code>Application defined or object-defined error</code> error on line</p>\n\n<pre><code>Set copyRange = dataWorkbook.Worksheets(\"List\").Range(\"A3:F3\", Range(\"A3\").End(xlDown))     \n</code></pre>\n\n<p>When I comment the lines related to the second workbook, no error happens. Why does this error happen?</p>\n\n<p><strong>EDIT</strong>: The interesting thing is, that if I define and set the <code>copyRange</code> <strong>before</strong> opening the 2nd workbook, it works fine... I'm really curious of what about opening the 2nd file messes the <code>copyRange</code> and why opening that file later helps.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1501061540, "post_id": 45322820, "comment_id": 77607620, "body": "<code>=SUMIF(A:A,B2,C:C)</code> and fill down."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2403016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5f6b0d45dd7be8385d2219a7dbe147d5?s=128&d=identicon&r=PG", "display_name": "Dale Swire", "link": "https://stackoverflow.com/users/2403016/dale-swire"}, "edited": false, "score": 1, "creation_date": 1501061890, "post_id": 45322958, "comment_id": 77607911, "body": "Ah thank you for your help. This methods shorter than one I just figured out. I managed to get it to Count the cells If the range in column A matches the data in column B but only If the Range in Column D is greater than 0."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1501061581, "creation_date": 1501061581, "answer_id": 45322958, "question_id": 45322820, "link": "https://stackoverflow.com/questions/45322820/summing-up-a-column-based-on-multiple-criterion/45322958#45322958", "title": "Summing up a column based on multiple Criterion", "body": "<p>You can use</p>\n\n<pre><code>=SUMPRODUCT(($C$1:$C$8)*($A$1:$A$8=B1))\n</code></pre>\n\n<p>Drag/Copy down as required. Change range as needed. See image for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0AbP7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0AbP7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 2403016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5f6b0d45dd7be8385d2219a7dbe147d5?s=128&d=identicon&r=PG", "display_name": "Dale Swire", "link": "https://stackoverflow.com/users/2403016/dale-swire"}, "is_accepted": false, "score": 0, "last_activity_date": 1501062144, "creation_date": 1501062144, "answer_id": 45323187, "question_id": 45322820, "link": "https://stackoverflow.com/questions/45322820/summing-up-a-column-based-on-multiple-criterion/45323187#45323187", "title": "Summing up a column based on multiple Criterion", "body": "<p>Anyone looking for another method aside from the above SUMIF method:</p>\n\n<p>If its all on the Same sheet:</p>\n\n<pre><code>Cells(I, \"C\").Value = Application.CountIfs(Range(\"B:B\"), Cells;\n(I, \"A\").Value, Range(\"D:D\"), \"1\")\n</code></pre>\n\n<p>If its on multiple sheets:</p>\n\n<pre><code>Sheets(\"SheetName\").Cells(I, \"C\").Value = \nApplication.CountIfs(Sheets(\"SheetName\").Range(\"B:B\"), Sheets(\"SheetName\");\n.Cells(I, \"A\").Value, Sheets(\"SheetName\").Range(\"D:D\"), \"1\")\n</code></pre>\n\n<p>There is probably a neater way of doing it. You could set a variable for the sheet names rather than typing Sheets(\"Sheetname\") over and over.</p>\n"}], "owner": {"reputation": 15, "user_id": 2403016, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5f6b0d45dd7be8385d2219a7dbe147d5?s=128&d=identicon&r=PG", "display_name": "Dale Swire", "link": "https://stackoverflow.com/users/2403016/dale-swire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 45322958, "answer_count": 2, "score": 0, "last_activity_date": 1501062144, "creation_date": 1501061253, "last_edit_date": 1531164843, "question_id": 45322820, "link": "https://stackoverflow.com/questions/45322820/summing-up-a-column-based-on-multiple-criterion", "title": "Summing up a column based on multiple Criterion", "body": "<p>Basically</p>\n\n<p>Column 1 contains many names,<br>\nColumn 2 contains the Unique version of those many names,<br>\nColumn 3 contains either 1 or 0</p>\n\n<p>I want to sum the values in Column 3 based on Column 1 matching Column 2</p>\n\n<p>EG</p>\n\n<pre><code>A        B        C\nVBA     VBA       1\nVBA     XY        0\nXY      ZX        1\nZX                1\nXY                1\nVBA               0\nXY                1\nZX                1\n</code></pre>\n\n<p>So I want it to produce a 4th column equal in length to Column B as follows</p>\n\n<pre><code>VBA    1\nXY     3\nZX     2\n</code></pre>\n\n<p>I've tried a few different ways and I just cant seem to get it to work.\nAny help would be much appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1501062470, "post_id": 45322623, "comment_id": 77608348, "body": "This would be better on <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a> as the code works. You just want to improve it."}, {"owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501066852, "post_id": 45322623, "comment_id": 77611536, "body": "I don&#39;t know if I need to rework the project through VBA or if I could just do it through Excel functions."}], "owner": {"reputation": 193, "user_id": 8263733, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6eb98e00c94692c3161249a1fd016593?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolajs", "link": "https://stackoverflow.com/users/8263733/nikolajs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501064193, "creation_date": 1501060756, "last_edit_date": 1501064193, "question_id": 45322623, "link": "https://stackoverflow.com/questions/45322623/simplifying-vba-code", "title": "Simplifying VBA Code", "body": "<p>I wrote a fully working VBA macro that goes through inputed client ID's and returns the specified commission fee for that client.</p>\n\n<p>The code 100% works, however I need to have it so that my boss is able to easily add new clients with their special commission %'s to the list, without having to go through the VBA code.</p>\n\n<p>How can I make a simplified VBA macro or just type an Excel function to do exactly what my code below does, but make it versitile to the special klient table?</p>\n\n<p><strong>The main Excel table looks like this:</strong>\n<a href=\"https://i.stack.imgur.com/sPZFD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sPZFD.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The table with the special klients, commission fees, currency, markets, looks like this:</strong>\n<a href=\"https://i.stack.imgur.com/Ymz9R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ymz9R.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub komisijas_calc_Click()\n\n'Declare the variables\nDim klienta_nr As Long\nDim ISIN As String\nDim Cena As Double\nDim Skaits As Double\nDim Komisija As Double\nDim vk As String\nDim Summa As Double\nDim kSheet As Worksheet\n\nDim lngFirstRow As Long: lngFirstRow = 2\nDim lngLastRow  As Long\nDim lngCol      As Long: lngCol = 2\nDim lngCounter  As Long\nDim lngKom As Long: lngKom = 11\n\n\n\n\nSet kSheet = ThisWorkbook.Sheets(\"spec_klienti\")\n\n\nWith Worksheets(1)\n    lngLastRow = .Cells(.Rows.Count, lngCol).End(xlUp).Row\n\n    For lngCounter = lngFirstRow To lngLastRow\n\n    klienta_nr = Range(\"B\" &amp; lngCounter).Value\n    ISIN = Range(\"E\" &amp; lngCounter).Value\n    Cena = Range(\"H\" &amp; lngCounter).Value\n    Skaits = Range(\"I\" &amp; lngCounter).Value\n    vk = Range(\"D\" &amp; lngCounter).Value\n    Summa = Cena * Skaits\n\n\nSelect Case klienta_nr\n\n\n\n    Case 111111\n                '(V\u0101cija, Francija, N\u012bderlandes, It\u0101lija, \u012arija) - 30 EUR MIN\n                If klienta_nr = 111111 And (Left(ISIN, 2) = \"DE\" Or Left(ISIN, 2) = \"FR\" Or Left(ISIN, 2) = \"NL\" Or Left(ISIN, 2) = \"IT\" Or Left(ISIN, 2) = \"IE\") Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                If klienta_nr = 111111 And Komisija &lt;= 30 Then\n                    .Cells(lngCounter, lngKom) = 30\n                        End If\n\n\n                If klienta_nr = 1111111 And (Left(ISIN, 2) &lt;&gt; \"DE\" Or Left(ISIN, 2) &lt;&gt; \"FR\" Or Left(ISIN, 2) &lt;&gt; \"NL\" Or Left(ISIN, 2) &lt;&gt; \"IT\" Or Left(ISIN, 2) &lt;&gt; \"IE\") Then\n                    Komisija = Summa * 0.003\n                    If Komisija &gt;= 40 Then\n                        .Cells(lngCounter, lngKom) = 40\n                            End If\n                        End If\n\n\n    Case 2222222\n                '(V\u0101cija, Francija, N\u012bderlandes, It\u0101lija, \u012arija) - 30 EUR MIN\n                If klienta_nr = 222222 And (Left(ISIN, 2) = \"DE\" Or Left(ISIN, 2) = \"FR\" Or Left(ISIN, 2) = \"NL\" Or Left(ISIN, 2) = \"IT\" Or Left(ISIN, 2) = \"IE\") Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                'Set 30 EUR Min\n                If klienta_nr = 2222222 And Komisija &lt;= 30 Then\n                    .Cells(lngCounter, lngKom) = 30\n                        End If\n\n                If klienta_nr = 2 And (Left(ISIN, 2) &lt;&gt; \"DE\" Or Left(ISIN, 2) &lt;&gt; \"FR\" Or Left(ISIN, 2) &lt;&gt; \"NL\" Or Left(ISIN, 2) &lt;&gt; \"IT\" Or Left(ISIN, 2) &lt;&gt; \"IE\") Then\n                    GoTo AllElseFails\n                        End If\n\n\nCase Else\n\nAllElseFails:\n\n              'IP2, 0.03% komisija, 40 EUR/USD Max\n                If Right(vk, 1) = 1 Or Right(vk, 1) = 8 Then\n                    Komisija = Summa * 0.003\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n              'IP1, 0.1% komisija, 40 EUR/USD Max\n                If Right(vk, 1) = 7 Then\n                    Komisija = Summa * 0.01\n                    .Cells(lngCounter, lngKom) = Komisija\n                        End If\n                'Komisija MAX is 40, so anything &gt;=40 equals 40\n                If Komisija &gt;= 40 Then\n                    .Cells(lngCounter, lngKom) = 40\n                        End If\n            'End If\n     End Select\n   Next lngCounter\n  End With\nEnd Sub\n</code></pre>\n"}]